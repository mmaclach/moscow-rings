(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports={
  "api_token": "pk.eyJ1IjoidzhyIiwiYSI6InBWVUZaSDAifQ.lQUJXO6rqqAiKRR6VW8TEg"
}

},{}],2:[function(require,module,exports){
"use strict";

exports["default"] = function (obj) {
  return obj && obj.__esModule ? obj : {
    "default": obj
  };
};

exports.__esModule = true;
},{}],3:[function(require,module,exports){
"use strict";

exports["default"] = function (obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};

    if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }

    newObj["default"] = obj;
    return newObj;
  }
};

exports.__esModule = true;
},{}],4:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('is-array')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50
Buffer.poolSize = 8192 // not used by this implementation

var rootParent = {}

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Safari 5-7 lacks support for changing the `Object.prototype.constructor` property
 *     on objects.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

function typedArraySupport () {
  function Bar () {}
  try {
    var arr = new Uint8Array(1)
    arr.foo = function () { return 42 }
    arr.constructor = Bar
    return arr.foo() === 42 && // typed array instances can be augmented
        arr.constructor === Bar && // constructor can be set
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

/**
 * Class: Buffer
 * =============
 *
 * The Buffer constructor returns instances of `Uint8Array` that are augmented
 * with function properties for all the node `Buffer` API functions. We use
 * `Uint8Array` so that square bracket notation works as expected -- it returns
 * a single octet.
 *
 * By augmenting the instances, we can avoid modifying the `Uint8Array`
 * prototype.
 */
function Buffer (arg) {
  if (!(this instanceof Buffer)) {
    // Avoid going through an ArgumentsAdaptorTrampoline in the common case.
    if (arguments.length > 1) return new Buffer(arg, arguments[1])
    return new Buffer(arg)
  }

  this.length = 0
  this.parent = undefined

  // Common case.
  if (typeof arg === 'number') {
    return fromNumber(this, arg)
  }

  // Slightly less common case.
  if (typeof arg === 'string') {
    return fromString(this, arg, arguments.length > 1 ? arguments[1] : 'utf8')
  }

  // Unusual.
  return fromObject(this, arg)
}

function fromNumber (that, length) {
  that = allocate(that, length < 0 ? 0 : checked(length) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < length; i++) {
      that[i] = 0
    }
  }
  return that
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') encoding = 'utf8'

  // Assumption: byteLength() return value is always < kMaxLength.
  var length = byteLength(string, encoding) | 0
  that = allocate(that, length)

  that.write(string, encoding)
  return that
}

function fromObject (that, object) {
  if (Buffer.isBuffer(object)) return fromBuffer(that, object)

  if (isArray(object)) return fromArray(that, object)

  if (object == null) {
    throw new TypeError('must start with number, buffer, array or string')
  }

  if (typeof ArrayBuffer !== 'undefined') {
    if (object.buffer instanceof ArrayBuffer) {
      return fromTypedArray(that, object)
    }
    if (object instanceof ArrayBuffer) {
      return fromArrayBuffer(that, object)
    }
  }

  if (object.length) return fromArrayLike(that, object)

  return fromJsonObject(that, object)
}

function fromBuffer (that, buffer) {
  var length = checked(buffer.length) | 0
  that = allocate(that, length)
  buffer.copy(that, 0, 0, length)
  return that
}

function fromArray (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

// Duplicate of fromArray() to keep fromArray() monomorphic.
function fromTypedArray (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  // Truncating the elements is probably not what people expect from typed
  // arrays with BYTES_PER_ELEMENT > 1 but it's compatible with the behavior
  // of the old Buffer constructor.
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array) {
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    array.byteLength
    that = Buffer._augment(new Uint8Array(array))
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromTypedArray(that, new Uint8Array(array))
  }
  return that
}

function fromArrayLike (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

// Deserialize { type: 'Buffer', data: [1,2,3,...] } into a Buffer object.
// Returns a zero-length buffer for inputs that don't conform to the spec.
function fromJsonObject (that, object) {
  var array
  var length = 0

  if (object.type === 'Buffer' && isArray(object.data)) {
    array = object.data
    length = checked(array.length) | 0
  }
  that = allocate(that, length)

  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
}

function allocate (that, length) {
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = Buffer._augment(new Uint8Array(length))
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that.length = length
    that._isBuffer = true
  }

  var fromPool = length !== 0 && length <= Buffer.poolSize >>> 1
  if (fromPool) that.parent = rootParent

  return that
}

function checked (length) {
  // Note: cannot use `length < kMaxLength` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (subject, encoding) {
  if (!(this instanceof SlowBuffer)) return new SlowBuffer(subject, encoding)

  var buf = new Buffer(subject, encoding)
  delete buf.parent
  return buf
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  var i = 0
  var len = Math.min(x, y)
  while (i < len) {
    if (a[i] !== b[i]) break

    ++i
  }

  if (i !== len) {
    x = a[i]
    y = b[i]
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'binary':
    case 'base64':
    case 'raw':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) throw new TypeError('list argument must be an Array of Buffers.')

  if (list.length === 0) {
    return new Buffer(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; i++) {
      length += list[i].length
    }
  }

  var buf = new Buffer(length)
  var pos = 0
  for (i = 0; i < list.length; i++) {
    var item = list[i]
    item.copy(buf, pos)
    pos += item.length
  }
  return buf
}

function byteLength (string, encoding) {
  if (typeof string !== 'string') string = '' + string

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'binary':
      // Deprecated
      case 'raw':
      case 'raws':
        return len
      case 'utf8':
      case 'utf-8':
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

// pre-set for values that may exist in the future
Buffer.prototype.length = undefined
Buffer.prototype.parent = undefined

function slowToString (encoding, start, end) {
  var loweredCase = false

  start = start | 0
  end = end === undefined || end === Infinity ? this.length : end | 0

  if (!encoding) encoding = 'utf8'
  if (start < 0) start = 0
  if (end > this.length) end = this.length
  if (end <= start) return ''

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'binary':
        return binarySlice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return 0
  return Buffer.compare(this, b)
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset) {
  if (byteOffset > 0x7fffffff) byteOffset = 0x7fffffff
  else if (byteOffset < -0x80000000) byteOffset = -0x80000000
  byteOffset >>= 0

  if (this.length === 0) return -1
  if (byteOffset >= this.length) return -1

  // Negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = Math.max(this.length + byteOffset, 0)

  if (typeof val === 'string') {
    if (val.length === 0) return -1 // special case: looking for empty string always fails
    return String.prototype.indexOf.call(this, val, byteOffset)
  }
  if (Buffer.isBuffer(val)) {
    return arrayIndexOf(this, val, byteOffset)
  }
  if (typeof val === 'number') {
    if (Buffer.TYPED_ARRAY_SUPPORT && Uint8Array.prototype.indexOf === 'function') {
      return Uint8Array.prototype.indexOf.call(this, val, byteOffset)
    }
    return arrayIndexOf(this, [ val ], byteOffset)
  }

  function arrayIndexOf (arr, val, byteOffset) {
    var foundIndex = -1
    for (var i = 0; byteOffset + i < arr.length; i++) {
      if (arr[byteOffset + i] === val[foundIndex === -1 ? 0 : i - foundIndex]) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === val.length) return byteOffset + foundIndex
      } else {
        foundIndex = -1
      }
    }
    return -1
  }

  throw new TypeError('val must be string, number or Buffer')
}

// `get` is deprecated
Buffer.prototype.get = function get (offset) {
  console.log('.get() is deprecated. Access using array indexes instead.')
  return this.readUInt8(offset)
}

// `set` is deprecated
Buffer.prototype.set = function set (v, offset) {
  console.log('.set() is deprecated. Access using array indexes instead.')
  return this.writeUInt8(v, offset)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new Error('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; i++) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) throw new Error('Invalid hex string')
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function binaryWrite (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    var swap = encoding
    encoding = offset
    offset = length | 0
    length = swap
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'binary':
        return binaryWrite(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function binarySlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; i++) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = Buffer._augment(this.subarray(start, end))
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; i++) {
      newBuf[i] = this[i + start]
    }
  }

  if (newBuf.length) newBuf.parent = this.parent || this

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('buffer must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('value is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; i++) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; i++) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = value < 0 ? 1 : 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = value < 0 ? 1 : 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (value > max || value < min) throw new RangeError('value is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('index out of range')
  if (offset < 0) throw new RangeError('index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; i--) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; i++) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    target._set(this.subarray(start, start + len), targetStart)
  }

  return len
}

// fill(value, start=0, end=buffer.length)
Buffer.prototype.fill = function fill (value, start, end) {
  if (!value) value = 0
  if (!start) start = 0
  if (!end) end = this.length

  if (end < start) throw new RangeError('end < start')

  // Fill 0 bytes; we're done
  if (end === start) return
  if (this.length === 0) return

  if (start < 0 || start >= this.length) throw new RangeError('start out of bounds')
  if (end < 0 || end > this.length) throw new RangeError('end out of bounds')

  var i
  if (typeof value === 'number') {
    for (i = start; i < end; i++) {
      this[i] = value
    }
  } else {
    var bytes = utf8ToBytes(value.toString())
    var len = bytes.length
    for (i = start; i < end; i++) {
      this[i] = bytes[i % len]
    }
  }

  return this
}

/**
 * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.
 * Added in Node 0.12. Only available in browsers that support ArrayBuffer.
 */
Buffer.prototype.toArrayBuffer = function toArrayBuffer () {
  if (typeof Uint8Array !== 'undefined') {
    if (Buffer.TYPED_ARRAY_SUPPORT) {
      return (new Buffer(this)).buffer
    } else {
      var buf = new Uint8Array(this.length)
      for (var i = 0, len = buf.length; i < len; i += 1) {
        buf[i] = this[i]
      }
      return buf.buffer
    }
  } else {
    throw new TypeError('Buffer.toArrayBuffer not supported in this browser')
  }
}

// HELPER FUNCTIONS
// ================

var BP = Buffer.prototype

/**
 * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods
 */
Buffer._augment = function _augment (arr) {
  arr.constructor = Buffer
  arr._isBuffer = true

  // save reference to original Uint8Array set method before overwriting
  arr._set = arr.set

  // deprecated
  arr.get = BP.get
  arr.set = BP.set

  arr.write = BP.write
  arr.toString = BP.toString
  arr.toLocaleString = BP.toString
  arr.toJSON = BP.toJSON
  arr.equals = BP.equals
  arr.compare = BP.compare
  arr.indexOf = BP.indexOf
  arr.copy = BP.copy
  arr.slice = BP.slice
  arr.readUIntLE = BP.readUIntLE
  arr.readUIntBE = BP.readUIntBE
  arr.readUInt8 = BP.readUInt8
  arr.readUInt16LE = BP.readUInt16LE
  arr.readUInt16BE = BP.readUInt16BE
  arr.readUInt32LE = BP.readUInt32LE
  arr.readUInt32BE = BP.readUInt32BE
  arr.readIntLE = BP.readIntLE
  arr.readIntBE = BP.readIntBE
  arr.readInt8 = BP.readInt8
  arr.readInt16LE = BP.readInt16LE
  arr.readInt16BE = BP.readInt16BE
  arr.readInt32LE = BP.readInt32LE
  arr.readInt32BE = BP.readInt32BE
  arr.readFloatLE = BP.readFloatLE
  arr.readFloatBE = BP.readFloatBE
  arr.readDoubleLE = BP.readDoubleLE
  arr.readDoubleBE = BP.readDoubleBE
  arr.writeUInt8 = BP.writeUInt8
  arr.writeUIntLE = BP.writeUIntLE
  arr.writeUIntBE = BP.writeUIntBE
  arr.writeUInt16LE = BP.writeUInt16LE
  arr.writeUInt16BE = BP.writeUInt16BE
  arr.writeUInt32LE = BP.writeUInt32LE
  arr.writeUInt32BE = BP.writeUInt32BE
  arr.writeIntLE = BP.writeIntLE
  arr.writeIntBE = BP.writeIntBE
  arr.writeInt8 = BP.writeInt8
  arr.writeInt16LE = BP.writeInt16LE
  arr.writeInt16BE = BP.writeInt16BE
  arr.writeInt32LE = BP.writeInt32LE
  arr.writeInt32BE = BP.writeInt32BE
  arr.writeFloatLE = BP.writeFloatLE
  arr.writeFloatBE = BP.writeFloatBE
  arr.writeDoubleLE = BP.writeDoubleLE
  arr.writeDoubleBE = BP.writeDoubleBE
  arr.fill = BP.fill
  arr.inspect = BP.inspect
  arr.toArrayBuffer = BP.toArrayBuffer

  return arr
}

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; i++) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00 | 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; i++) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":5,"ieee754":6,"is-array":7}],5:[function(require,module,exports){
var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';

;(function (exports) {
	'use strict';

  var Arr = (typeof Uint8Array !== 'undefined')
    ? Uint8Array
    : Array

	var PLUS   = '+'.charCodeAt(0)
	var SLASH  = '/'.charCodeAt(0)
	var NUMBER = '0'.charCodeAt(0)
	var LOWER  = 'a'.charCodeAt(0)
	var UPPER  = 'A'.charCodeAt(0)
	var PLUS_URL_SAFE = '-'.charCodeAt(0)
	var SLASH_URL_SAFE = '_'.charCodeAt(0)

	function decode (elt) {
		var code = elt.charCodeAt(0)
		if (code === PLUS ||
		    code === PLUS_URL_SAFE)
			return 62 // '+'
		if (code === SLASH ||
		    code === SLASH_URL_SAFE)
			return 63 // '/'
		if (code < NUMBER)
			return -1 //no match
		if (code < NUMBER + 10)
			return code - NUMBER + 26 + 26
		if (code < UPPER + 26)
			return code - UPPER
		if (code < LOWER + 26)
			return code - LOWER + 26
	}

	function b64ToByteArray (b64) {
		var i, j, l, tmp, placeHolders, arr

		if (b64.length % 4 > 0) {
			throw new Error('Invalid string. Length must be a multiple of 4')
		}

		// the number of equal signs (place holders)
		// if there are two placeholders, than the two characters before it
		// represent one byte
		// if there is only one, then the three characters before it represent 2 bytes
		// this is just a cheap hack to not do indexOf twice
		var len = b64.length
		placeHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0

		// base64 is 4/3 + up to two characters of the original data
		arr = new Arr(b64.length * 3 / 4 - placeHolders)

		// if there are placeholders, only get up to the last complete 4 chars
		l = placeHolders > 0 ? b64.length - 4 : b64.length

		var L = 0

		function push (v) {
			arr[L++] = v
		}

		for (i = 0, j = 0; i < l; i += 4, j += 3) {
			tmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))
			push((tmp & 0xFF0000) >> 16)
			push((tmp & 0xFF00) >> 8)
			push(tmp & 0xFF)
		}

		if (placeHolders === 2) {
			tmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)
			push(tmp & 0xFF)
		} else if (placeHolders === 1) {
			tmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)
			push((tmp >> 8) & 0xFF)
			push(tmp & 0xFF)
		}

		return arr
	}

	function uint8ToBase64 (uint8) {
		var i,
			extraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes
			output = "",
			temp, length

		function encode (num) {
			return lookup.charAt(num)
		}

		function tripletToBase64 (num) {
			return encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)
		}

		// go through the array every three bytes, we'll deal with trailing stuff later
		for (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {
			temp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
			output += tripletToBase64(temp)
		}

		// pad the end with zeros, but make sure to not forget the extra bytes
		switch (extraBytes) {
			case 1:
				temp = uint8[uint8.length - 1]
				output += encode(temp >> 2)
				output += encode((temp << 4) & 0x3F)
				output += '=='
				break
			case 2:
				temp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])
				output += encode(temp >> 10)
				output += encode((temp >> 4) & 0x3F)
				output += encode((temp << 2) & 0x3F)
				output += '='
				break
		}

		return output
	}

	exports.toByteArray = b64ToByteArray
	exports.fromByteArray = uint8ToBase64
}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))

},{}],6:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],7:[function(require,module,exports){

/**
 * isArray
 */

var isArray = Array.isArray;

/**
 * toString
 */

var str = Object.prototype.toString;

/**
 * Whether or not the given `val`
 * is an array.
 *
 * example:
 *
 *        isArray([]);
 *        // > true
 *        isArray(arguments);
 *        // > false
 *        isArray('');
 *        // > false
 *
 * @param {mixed} val
 * @return {bool}
 */

module.exports = isArray || function (val) {
  return !! val && '[object Array]' == str.call(val);
};

},{}],8:[function(require,module,exports){
(function(window) {
	var HAS_HASHCHANGE = (function() {
		var doc_mode = window.documentMode;
		return ('onhashchange' in window) &&
			(doc_mode === undefined || doc_mode > 7);
	})();

	L.Hash = function(map) {
		this.onHashChange = L.Util.bind(this.onHashChange, this);

		if (map) {
			this.init(map);
		}
	};

	L.Hash.parseHash = function(hash) {
		if(hash.indexOf('#') === 0) {
			hash = hash.substr(1);
		}
		var args = hash.split("/");
		if (args.length == 3) {
			var zoom = parseInt(args[0], 10),
			lat = parseFloat(args[1]),
			lon = parseFloat(args[2]);
			if (isNaN(zoom) || isNaN(lat) || isNaN(lon)) {
				return false;
			} else {
				return {
					center: new L.LatLng(lat, lon),
					zoom: zoom
				};
			}
		} else {
			return false;
		}
	};

	L.Hash.formatHash = function(map) {
		var center = map.getCenter(),
		    zoom = map.getZoom(),
		    precision = Math.max(0, Math.ceil(Math.log(zoom) / Math.LN2));

		return "#" + [zoom,
			center.lat.toFixed(precision),
			center.lng.toFixed(precision)
		].join("/");
	},

	L.Hash.prototype = {
		map: null,
		lastHash: null,

		parseHash: L.Hash.parseHash,
		formatHash: L.Hash.formatHash,

		init: function(map) {
			this.map = map;

			// reset the hash
			this.lastHash = null;
			this.onHashChange();

			if (!this.isListening) {
				this.startListening();
			}
		},

		removeFrom: function(map) {
			if (this.changeTimeout) {
				clearTimeout(this.changeTimeout);
			}

			if (this.isListening) {
				this.stopListening();
			}

			this.map = null;
		},

		onMapMove: function() {
			// bail if we're moving the map (updating from a hash),
			// or if the map is not yet loaded

			if (this.movingMap || !this.map._loaded) {
				return false;
			}

			var hash = this.formatHash(this.map);
			if (this.lastHash != hash) {
				location.replace(hash);
				this.lastHash = hash;
			}
		},

		movingMap: false,
		update: function() {
			var hash = location.hash;
			if (hash === this.lastHash) {
				return;
			}
			var parsed = this.parseHash(hash);
			if (parsed) {
				this.movingMap = true;

				this.map.setView(parsed.center, parsed.zoom);

				this.movingMap = false;
			} else {
				this.onMapMove(this.map);
			}
		},

		// defer hash change updates every 100ms
		changeDefer: 100,
		changeTimeout: null,
		onHashChange: function() {
			// throttle calls to update() so that they only happen every
			// `changeDefer` ms
			if (!this.changeTimeout) {
				var that = this;
				this.changeTimeout = setTimeout(function() {
					that.update();
					that.changeTimeout = null;
				}, this.changeDefer);
			}
		},

		isListening: false,
		hashChangeInterval: null,
		startListening: function() {
			this.map.on("moveend", this.onMapMove, this);

			if (HAS_HASHCHANGE) {
				L.DomEvent.addListener(window, "hashchange", this.onHashChange);
			} else {
				clearInterval(this.hashChangeInterval);
				this.hashChangeInterval = setInterval(this.onHashChange, 50);
			}
			this.isListening = true;
		},

		stopListening: function() {
			this.map.off("moveend", this.onMapMove, this);

			if (HAS_HASHCHANGE) {
				L.DomEvent.removeListener(window, "hashchange", this.onHashChange);
			} else {
				clearInterval(this.hashChangeInterval);
			}
			this.isListening = false;
		}
	};
	L.hash = function(map) {
		return new L.Hash(map);
	};
	L.Map.prototype.addHash = function() {
		this._hash = L.hash(this);
	};
	L.Map.prototype.removeHash = function() {
		this._hash.removeFrom();
	};
})(window);

},{}],9:[function(require,module,exports){
var sphereKnn = require('sphere-knn');

module.exports = function(layer) {
    'use strict';

    if (!(layer instanceof L.GeoJSON)) throw new Error('must be L.GeoJSON');

    var points = [];

    layer.eachLayer(collectPoints);

    function collectPoints(l) {
        points = points.concat(reformat(flat(l.feature.geometry.coordinates), l));
    }

    var sknn = sphereKnn(points);

    sknn.nearest = function(p, n, max_distance) {
        if (p instanceof L.LatLng) p = [p.lng, p.lat];
        return sknn(p[1], p[0], n, max_distance);
    };

    sknn.nearestLayer = function(p, n, max_distance) {
        if (p instanceof L.LatLng) p = [p.lng, p.lat];
        return collapse(sknn(p[1], p[0], n, max_distance));
    };

    return sknn;
};

function collapse(results) {
    var l = [], included = {};
    for (var i = 0; i < results.length; i++) {
        if (included[L.stamp(results[i].layer)] == undefined) {
            l.push(results[i]);
            included[L.stamp(results[i].layer)] = true;
        }
    }
    return l;
}

function reformat(coords, layer) {
    var l = [];
    for (var i = 0; i < coords.length; i++) {
        l.push({ lon: coords[i][0], lat: coords[i][1], layer: layer });
    }
    return l;
}

function flat(coords) {
    var i = 0, j = 0, k = 0, l = [];
    if (typeof coords[0] === 'object' &&
        typeof coords[0][0] === 'object' &&
        typeof coords[0][0][0] === 'object') {
        for (;i < coords.length; i++) {
            for (;j < coords[i].length; j++) {
                for (;k < coords[i][j].length; k++) l.push(coords[i][j][k]);
            }
        }
        return l;
    } else if (typeof coords[0] === 'object' &&
        typeof coords[0][0] === 'object') {
        for (;i < coords.length; i++) {
            for (;j < coords[i].length; j++) l.push(coords[i][j]);
        }
        return l;
    } else if (typeof coords[0] === 'object') {
        return coords;
    } else {
        return [coords];
    }
}

},{"sphere-knn":10}],10:[function(require,module,exports){
var spherekd = require("./lib/spherekd")

module.exports = function(points) {
  /* Inflate the toad! */
  var root = spherekd.build(points)

  /* Lurch off into the sunset! */
  return function(lat, lon, n, max) {
    return spherekd.lookup(lat, lon, root, n, max)
  }
}

},{"./lib/spherekd":13}],11:[function(require,module,exports){
function defaultComparator(a, b) {
  return a - b
}

exports.search = function(item, array, comparator) {
  if(!comparator)
    comparator = defaultComparator

  var low  = 0,
      high = array.length - 1,
      mid, comp

  while(low <= high) {
    mid  = (low + high) >>> 1
    comp = comparator(array[mid], item)

    if(comp < 0)
      low = mid + 1

    else if(comp > 0)
      high = mid - 1

    else
      return mid
  }

  return -(low + 1)
}

exports.insert = function(item, array, comparator) {
  var i = exports.search(item, array, comparator)

  if(i < 0)
    i = -(i + 1)

  array.splice(i, 0, item)
}

},{}],12:[function(require,module,exports){
var binary = require("./binary")

function Node(axis, split, left, right) {
  this.axis  = axis
  this.split = split
  this.left  = left
  this.right = right
}

function distance(a, b) {
  var i = Math.min(a.length, b.length),
      d = 0,
      k

  while(i--) {
    k  = b[i] - a[i]
    d += k * k
  }

  return d
}

function byDistance(a, b) {
  return a.dist - b.dist
}

function buildrec(array, depth) {
  /* This should only happen if you request a kd-tree with zero elements. */
  if(array.length === 0)
    return null

  /* If there's only one item, then it's a leaf node! */
  if(array.length === 1)
    return array[0]

  /* Uh oh. Well, we have to partition the data set and recurse. Start by
   * finding the bounding box of the given points; whichever side is the
   * longest is the one we'll use for the splitting plane. */
  var axis = depth % array[0].position.length

  /* Sort the points along the splitting plane. */
  /* FIXME: For very large trees, it would be faster to use some sort of median
   * finding and partitioning algorithm. It'd also be a lot more complicated. */
  array.sort(function(a, b) {
    return a.position[axis] - b.position[axis]
  })

  /* Find the median point. It's position is going to be the location of the
   * splitting plane. */
  var i = Math.floor(array.length * 0.5)

  /* Split, recurse, yadda yadda. */
  ++depth

  return new Node(
    axis,
    array[i].position[axis],
    buildrec(array.slice(0, i), depth),
    buildrec(array.slice(i   ), depth)
  )
}

function build(array) {
  return buildrec(array, 0)
}

function lookup(position, node, n, max) {
  if(!(max > 0))
    max = Number.POSITIVE_INFINITY

  var array = []

  /* Degenerate cases. */
  if(node === null || n <= 0)
    return array

  var stack = [node, 0],
      dist, i

  while(stack.length) {
    dist = stack.pop()
    node = stack.pop()

    /* If this subtree is further away than we care about, then skip it. */
    if(dist > max)
      continue

    /* If we've already found enough locations, and the furthest one is closer
     * than this subtree possibly could be, just skip the subtree. */
    if(array.length === n && array[array.length - 1].dist < dist * dist)
      continue

    /* Iterate all the way down the tree, adding nodes that we need to remember
     * to visit later onto the stack. */
    while(node instanceof Node) {
      if(position[node.axis] < node.split) {
        stack.push(node.right, node.split - position[node.axis])
        node = node.left
      }

      else {
        stack.push(node.left, position[node.axis] - node.split)
        node = node.right
      }
    }

    /* Once we've hit a leaf node, insert it into the array of candidates,
     * making sure to keep the array in sorted order. */
    dist = distance(position, node.position)
    if(dist <= max * max)
      binary.insert({object: node, dist: dist}, array, byDistance)

    /* If the array's too long, cull it. */
    if(array.length > n)
      array.pop()
  }

  /* Strip candidate wrapper objects. */
  i = array.length

  while(i--)
    array[i] = array[i].object

  return array
}

exports.build  = build
exports.lookup = lookup

},{"./binary":11}],13:[function(require,module,exports){
var kd               = require("./kd"),
    rad              = Math.PI / 180,
    invEarthDiameter = 1 / 12742018 /* meters */

function spherical2cartesian(lat, lon) {
  lat *= rad
  lon *= rad
  var cos = Math.cos(lat)
  return [cos * Math.cos(lon), Math.sin(lat), cos * Math.sin(lon)]
}

function Position(object) {
  var lat, lon;

  /* Find latitude. */
  if(object.hasOwnProperty("lat"))
    lat = object.lat;

  else if(object.hasOwnProperty("latitude"))
    lat = object.latitude;

  else if(object.hasOwnProperty("location") &&
          Array.isArray(object.location) &&
          object.location.length === 2)
    lat = object.location[0];

  /* Find longitude. */
  if(object.hasOwnProperty("lon"))
    lon = object.lon;

  else if(object.hasOwnProperty("longitude"))
    lon = object.longitude;

  else if(object.hasOwnProperty("lng"))
    lon = object.lng;

  else if(object.hasOwnProperty("long"))
    lon = object.long;

  else if(object.hasOwnProperty("location") &&
          Array.isArray(object.location) &&
          object.location.length === 2)
    lon = object.location[1];

  /* Finally, set this object's properties. */
  this.object = object;
  this.position = spherical2cartesian(lat, lon);
}

function build(array) {
  var i   = array.length,
      out = new Array(i)

  while(i--)
    out[i] = new Position(array[i])

  return kd.build(out)
}

function lookup(lat, lon, node, n, max) {
  var array = kd.lookup(
        spherical2cartesian(lat, lon),
        node,
        n,
        max > 0 ? 2 * Math.sin(max * invEarthDiameter) : undefined
      ),
      i     = array.length

  /* Strip off position wrapper objects. */
  while(i--)
    array[i] = array[i].object

  return array
}

exports.build  = build
exports.lookup = lookup

},{"./kd":12}],14:[function(require,module,exports){
/**
 * Copyright (c) 2011-2014 Felix Gnass
 * Licensed under the MIT license
 * http://spin.js.org/
 *
 * Example:
    var opts = {
      lines: 12             // The number of lines to draw
    , length: 7             // The length of each line
    , width: 5              // The line thickness
    , radius: 10            // The radius of the inner circle
    , scale: 1.0            // Scales overall size of the spinner
    , corners: 1            // Roundness (0..1)
    , color: '#000'         // #rgb or #rrggbb
    , opacity: 1/4          // Opacity of the lines
    , rotate: 0             // Rotation offset
    , direction: 1          // 1: clockwise, -1: counterclockwise
    , speed: 1              // Rounds per second
    , trail: 100            // Afterglow percentage
    , fps: 20               // Frames per second when using setTimeout()
    , zIndex: 2e9           // Use a high z-index by default
    , className: 'spinner'  // CSS class to assign to the element
    , top: '50%'            // center vertically
    , left: '50%'           // center horizontally
    , shadow: false         // Whether to render a shadow
    , hwaccel: false        // Whether to use hardware acceleration (might be buggy)
    , position: 'absolute'  // Element positioning
    }
    var target = document.getElementById('foo')
    var spinner = new Spinner(opts).spin(target)
 */
;(function (root, factory) {

  /* CommonJS */
  if (typeof module == 'object' && module.exports) module.exports = factory()

  /* AMD module */
  else if (typeof define == 'function' && define.amd) define(factory)

  /* Browser global */
  else root.Spinner = factory()
}(this, function () {
  "use strict"

  var prefixes = ['webkit', 'Moz', 'ms', 'O'] /* Vendor prefixes */
    , animations = {} /* Animation rules keyed by their name */
    , useCssAnimations /* Whether to use CSS animations or setTimeout */
    , sheet /* A stylesheet to hold the @keyframe or VML rules. */

  /**
   * Utility function to create elements. If no tag name is given,
   * a DIV is created. Optionally properties can be passed.
   */
  function createEl (tag, prop) {
    var el = document.createElement(tag || 'div')
      , n

    for (n in prop) el[n] = prop[n]
    return el
  }

  /**
   * Appends children and returns the parent.
   */
  function ins (parent /* child1, child2, ...*/) {
    for (var i = 1, n = arguments.length; i < n; i++) {
      parent.appendChild(arguments[i])
    }

    return parent
  }

  /**
   * Creates an opacity keyframe animation rule and returns its name.
   * Since most mobile Webkits have timing issues with animation-delay,
   * we create separate rules for each line/segment.
   */
  function addAnimation (alpha, trail, i, lines) {
    var name = ['opacity', trail, ~~(alpha * 100), i, lines].join('-')
      , start = 0.01 + i/lines * 100
      , z = Math.max(1 - (1-alpha) / trail * (100-start), alpha)
      , prefix = useCssAnimations.substring(0, useCssAnimations.indexOf('Animation')).toLowerCase()
      , pre = prefix && '-' + prefix + '-' || ''

    if (!animations[name]) {
      sheet.insertRule(
        '@' + pre + 'keyframes ' + name + '{' +
        '0%{opacity:' + z + '}' +
        start + '%{opacity:' + alpha + '}' +
        (start+0.01) + '%{opacity:1}' +
        (start+trail) % 100 + '%{opacity:' + alpha + '}' +
        '100%{opacity:' + z + '}' +
        '}', sheet.cssRules.length)

      animations[name] = 1
    }

    return name
  }

  /**
   * Tries various vendor prefixes and returns the first supported property.
   */
  function vendor (el, prop) {
    var s = el.style
      , pp
      , i

    prop = prop.charAt(0).toUpperCase() + prop.slice(1)
    if (s[prop] !== undefined) return prop
    for (i = 0; i < prefixes.length; i++) {
      pp = prefixes[i]+prop
      if (s[pp] !== undefined) return pp
    }
  }

  /**
   * Sets multiple style properties at once.
   */
  function css (el, prop) {
    for (var n in prop) {
      el.style[vendor(el, n) || n] = prop[n]
    }

    return el
  }

  /**
   * Fills in default values.
   */
  function merge (obj) {
    for (var i = 1; i < arguments.length; i++) {
      var def = arguments[i]
      for (var n in def) {
        if (obj[n] === undefined) obj[n] = def[n]
      }
    }
    return obj
  }

  /**
   * Returns the line color from the given string or array.
   */
  function getColor (color, idx) {
    return typeof color == 'string' ? color : color[idx % color.length]
  }

  // Built-in defaults

  var defaults = {
    lines: 12             // The number of lines to draw
  , length: 7             // The length of each line
  , width: 5              // The line thickness
  , radius: 10            // The radius of the inner circle
  , scale: 1.0            // Scales overall size of the spinner
  , corners: 1            // Roundness (0..1)
  , color: '#000'         // #rgb or #rrggbb
  , opacity: 1/4          // Opacity of the lines
  , rotate: 0             // Rotation offset
  , direction: 1          // 1: clockwise, -1: counterclockwise
  , speed: 1              // Rounds per second
  , trail: 100            // Afterglow percentage
  , fps: 20               // Frames per second when using setTimeout()
  , zIndex: 2e9           // Use a high z-index by default
  , className: 'spinner'  // CSS class to assign to the element
  , top: '50%'            // center vertically
  , left: '50%'           // center horizontally
  , shadow: false         // Whether to render a shadow
  , hwaccel: false        // Whether to use hardware acceleration (might be buggy)
  , position: 'absolute'  // Element positioning
  }

  /** The constructor */
  function Spinner (o) {
    this.opts = merge(o || {}, Spinner.defaults, defaults)
  }

  // Global defaults that override the built-ins:
  Spinner.defaults = {}

  merge(Spinner.prototype, {
    /**
     * Adds the spinner to the given target element. If this instance is already
     * spinning, it is automatically removed from its previous target b calling
     * stop() internally.
     */
    spin: function (target) {
      this.stop()

      var self = this
        , o = self.opts
        , el = self.el = createEl(null, {className: o.className})

      css(el, {
        position: o.position
      , width: 0
      , zIndex: o.zIndex
      , left: o.left
      , top: o.top
      })

      if (target) {
        target.insertBefore(el, target.firstChild || null)
      }

      el.setAttribute('role', 'progressbar')
      self.lines(el, self.opts)

      if (!useCssAnimations) {
        // No CSS animation support, use setTimeout() instead
        var i = 0
          , start = (o.lines - 1) * (1 - o.direction) / 2
          , alpha
          , fps = o.fps
          , f = fps / o.speed
          , ostep = (1 - o.opacity) / (f * o.trail / 100)
          , astep = f / o.lines

        ;(function anim () {
          i++
          for (var j = 0; j < o.lines; j++) {
            alpha = Math.max(1 - (i + (o.lines - j) * astep) % f * ostep, o.opacity)

            self.opacity(el, j * o.direction + start, alpha, o)
          }
          self.timeout = self.el && setTimeout(anim, ~~(1000 / fps))
        })()
      }
      return self
    }

    /**
     * Stops and removes the Spinner.
     */
  , stop: function () {
      var el = this.el
      if (el) {
        clearTimeout(this.timeout)
        if (el.parentNode) el.parentNode.removeChild(el)
        this.el = undefined
      }
      return this
    }

    /**
     * Internal method that draws the individual lines. Will be overwritten
     * in VML fallback mode below.
     */
  , lines: function (el, o) {
      var i = 0
        , start = (o.lines - 1) * (1 - o.direction) / 2
        , seg

      function fill (color, shadow) {
        return css(createEl(), {
          position: 'absolute'
        , width: o.scale * (o.length + o.width) + 'px'
        , height: o.scale * o.width + 'px'
        , background: color
        , boxShadow: shadow
        , transformOrigin: 'left'
        , transform: 'rotate(' + ~~(360/o.lines*i + o.rotate) + 'deg) translate(' + o.scale*o.radius + 'px' + ',0)'
        , borderRadius: (o.corners * o.scale * o.width >> 1) + 'px'
        })
      }

      for (; i < o.lines; i++) {
        seg = css(createEl(), {
          position: 'absolute'
        , top: 1 + ~(o.scale * o.width / 2) + 'px'
        , transform: o.hwaccel ? 'translate3d(0,0,0)' : ''
        , opacity: o.opacity
        , animation: useCssAnimations && addAnimation(o.opacity, o.trail, start + i * o.direction, o.lines) + ' ' + 1 / o.speed + 's linear infinite'
        })

        if (o.shadow) ins(seg, css(fill('#000', '0 0 4px #000'), {top: '2px'}))
        ins(el, ins(seg, fill(getColor(o.color, i), '0 0 1px rgba(0,0,0,.1)')))
      }
      return el
    }

    /**
     * Internal method that adjusts the opacity of a single line.
     * Will be overwritten in VML fallback mode below.
     */
  , opacity: function (el, i, val) {
      if (i < el.childNodes.length) el.childNodes[i].style.opacity = val
    }

  })


  function initVML () {

    /* Utility function to create a VML tag */
    function vml (tag, attr) {
      return createEl('<' + tag + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', attr)
    }

    // No CSS transforms but VML support, add a CSS rule for VML elements:
    sheet.addRule('.spin-vml', 'behavior:url(#default#VML)')

    Spinner.prototype.lines = function (el, o) {
      var r = o.scale * (o.length + o.width)
        , s = o.scale * 2 * r

      function grp () {
        return css(
          vml('group', {
            coordsize: s + ' ' + s
          , coordorigin: -r + ' ' + -r
          })
        , { width: s, height: s }
        )
      }

      var margin = -(o.width + o.length) * o.scale * 2 + 'px'
        , g = css(grp(), {position: 'absolute', top: margin, left: margin})
        , i

      function seg (i, dx, filter) {
        ins(
          g
        , ins(
            css(grp(), {rotation: 360 / o.lines * i + 'deg', left: ~~dx})
          , ins(
              css(
                vml('roundrect', {arcsize: o.corners})
              , { width: r
                , height: o.scale * o.width
                , left: o.scale * o.radius
                , top: -o.scale * o.width >> 1
                , filter: filter
                }
              )
            , vml('fill', {color: getColor(o.color, i), opacity: o.opacity})
            , vml('stroke', {opacity: 0}) // transparent stroke to fix color bleeding upon opacity change
            )
          )
        )
      }

      if (o.shadow)
        for (i = 1; i <= o.lines; i++) {
          seg(i, -2, 'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)')
        }

      for (i = 1; i <= o.lines; i++) seg(i)
      return ins(el, g)
    }

    Spinner.prototype.opacity = function (el, i, val, o) {
      var c = el.firstChild
      o = o.shadow && o.lines || 0
      if (c && i + o < c.childNodes.length) {
        c = c.childNodes[i + o]; c = c && c.firstChild; c = c && c.firstChild
        if (c) c.opacity = val
      }
    }
  }

  if (typeof document !== 'undefined') {
    sheet = (function () {
      var el = createEl('style', {type : 'text/css'})
      ins(document.getElementsByTagName('head')[0], el)
      return el.sheet || el.styleSheet
    }())

    var probe = css(createEl('group'), {behavior: 'url(#default#VML)'})

    if (!vendor(probe, 'transform') && probe.adj) initVML()
    else useCssAnimations = vendor(probe, 'animation')
  }

  return Spinner

}));

},{}],15:[function(require,module,exports){
/**
 * Turf is a modular GIS engine written in JavaScript. It performs geospatial
 * processing tasks with GeoJSON data and can be run on a server or in a browser.
 *
 * @module turf
 * @summary GIS For Web Maps
 */
module.exports = {
  isolines: require('turf-isolines'),
  merge: require('turf-merge'),
  convex: require('turf-convex'),
  within: require('turf-within'),
  concave: require('turf-concave'),
  count: require('turf-count'),
  erase: require('turf-erase'),
  variance: require('turf-variance'),
  deviation: require('turf-deviation'),
  median: require('turf-median'),
  min: require('turf-min'),
  max: require('turf-max'),
  aggregate: require('turf-aggregate'),
  flip: require('turf-flip'),
  simplify: require('turf-simplify'),
  sum: require('turf-sum'),
  average: require('turf-average'),
  bezier: require('turf-bezier'),
  tag: require('turf-tag'),
  size: require('turf-size'),
  sample: require('turf-sample'),
  jenks: require('turf-jenks'),
  quantile: require('turf-quantile'),
  envelope: require('turf-envelope'),
  square: require('turf-square'),
  midpoint: require('turf-midpoint'),
  buffer: require('turf-buffer'),
  center: require('turf-center'),
  centroid: require('turf-centroid'),
  combine: require('turf-combine'),
  distance: require('turf-distance'),
  explode: require('turf-explode'),
  extent: require('turf-extent'),
  bboxPolygon: require('turf-bbox-polygon'),
  featurecollection: require('turf-featurecollection'),
  filter: require('turf-filter'),
  inside: require('turf-inside'),
  intersect: require('turf-intersect'),
  linestring: require('turf-linestring'),
  nearest: require('turf-nearest'),
  planepoint: require('turf-planepoint'),
  point: require('turf-point'),
  polygon: require('turf-polygon'),
  random: require('turf-random'),
  reclass: require('turf-reclass'),
  remove: require('turf-remove'),
  tin: require('turf-tin'),
  union: require('turf-union'),
  bearing: require('turf-bearing'),
  destination: require('turf-destination'),
  kinks: require('turf-kinks'),
  pointOnSurface: require('turf-point-on-surface'),
  area: require('turf-area'),
  along: require('turf-along'),
  lineDistance: require('turf-line-distance'),
  lineSlice: require('turf-line-slice'),
  pointOnLine: require('turf-point-on-line'),
  pointGrid: require('turf-point-grid'),
  squareGrid: require('turf-square-grid'),
  triangleGrid: require('turf-triangle-grid'),
  hexGrid: require('turf-hex-grid')
};

},{"turf-aggregate":16,"turf-along":17,"turf-area":18,"turf-average":21,"turf-bbox-polygon":22,"turf-bearing":23,"turf-bezier":24,"turf-buffer":26,"turf-center":31,"turf-centroid":32,"turf-combine":34,"turf-concave":35,"turf-convex":36,"turf-count":66,"turf-destination":67,"turf-deviation":68,"turf-distance":70,"turf-envelope":72,"turf-erase":73,"turf-explode":78,"turf-extent":80,"turf-featurecollection":82,"turf-filter":83,"turf-flip":84,"turf-hex-grid":85,"turf-inside":86,"turf-intersect":87,"turf-isolines":93,"turf-jenks":95,"turf-kinks":97,"turf-line-distance":98,"turf-line-slice":99,"turf-linestring":100,"turf-max":101,"turf-median":102,"turf-merge":103,"turf-midpoint":105,"turf-min":106,"turf-nearest":107,"turf-planepoint":108,"turf-point":112,"turf-point-grid":109,"turf-point-on-line":110,"turf-point-on-surface":111,"turf-polygon":113,"turf-quantile":114,"turf-random":116,"turf-reclass":118,"turf-remove":119,"turf-sample":120,"turf-simplify":121,"turf-size":123,"turf-square":125,"turf-square-grid":124,"turf-sum":126,"turf-tag":127,"turf-tin":128,"turf-triangle-grid":129,"turf-union":130,"turf-variance":135,"turf-within":137}],16:[function(require,module,exports){
var average = require('turf-average');
var sum = require('turf-sum');
var median = require('turf-median');
var min = require('turf-min');
var max = require('turf-max');
var deviation = require('turf-deviation');
var variance = require('turf-variance');
var count = require('turf-count');
var operations = {};
operations.average = average;
operations.sum = sum;
operations.median = median;
operations.min = min;
operations.max = max;
operations.deviation = deviation;
operations.variance = variance;
operations.count = count;

/**
* Calculates a series of aggregations for a set of {@link Point} features within a set of {@link Polygon} features. Sum, average, count, min, max, and deviation are supported.
*
* @module turf/aggregate
* @category aggregation
* @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
* @param {FeatureCollection} points a FeatureCollection of {@link Point} features
* @param {Array} aggregations an array of aggregation objects
* @return {FeatureCollection} a FeatureCollection of {@link Polygon} features with properties listed as `outField` values in `aggregations`
* @example
* var polygons = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [1.669921, 48.632908],
*           [1.669921, 49.382372],
*           [3.636474, 49.382372],
*           [3.636474, 48.632908],
*           [1.669921, 48.632908]
*         ]]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [2.230224, 47.85003],
*           [2.230224, 48.611121],
*           [4.361572, 48.611121],
*           [4.361572, 47.85003],
*           [2.230224, 47.85003]
*         ]]
*       }
*     }
*   ]
* };
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [2.054443,49.138596]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [3.065185,48.850258]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [2.329101,48.79239]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [2.614746,48.334343]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [3.416748,48.056053]
*       }
*     }
*   ]
* };
* var aggregations = [
*   {
*     aggregation: 'sum',
*     inField: 'population',
*     outField: 'pop_sum'
*   },
*   {
*     aggregation: 'average',
*     inField: 'population',
*     outField: 'pop_avg'
*   },
*   {
*     aggregation: 'median',
*     inField: 'population',
*     outField: 'pop_median'
*   },
*   {
*     aggregation: 'min',
*     inField: 'population',
*     outField: 'pop_min'
*   },
*   {
*     aggregation: 'max',
*     inField: 'population',
*     outField: 'pop_max'
*   },
*   {
*     aggregation: 'deviation',
*     inField: 'population',
*     outField: 'pop_deviation'
*   },
*   {
*     aggregation: 'variance',
*     inField: 'population',
*     outField: 'pop_variance'
*   },
*   {
*     aggregation: 'count',
*     inField: '',
*     outField: 'point_count'
*   }
* ];
*
* var aggregated = turf.aggregate(
*   polygons, points, aggregations);
*
* var result = turf.featurecollection(
*   points.features.concat(aggregated.features));
*
* //=result
*/

module.exports = function(polygons, points, aggregations){
  for (var i = 0, len = aggregations.length; i < len; i++) {
    var agg = aggregations[i],
      operation = agg.aggregation,
      unrecognizedError;

    if (isAggregationOperation(operation)) {
      if (operation === 'count') {
        polygons = operations[operation](polygons, points, agg.outField);
      } else {
        polygons = operations[operation](polygons, points, agg.inField, agg.outField);
      }
    } else {
      throw new Error('"'+ operation +'" is not a recognized aggregation operation.');
    }
  }

  return polygons;
};

function isAggregationOperation(operation) {
  return operation === 'average' ||
    operation === 'sum' ||
    operation === 'median' ||
    operation === 'min' ||
    operation === 'max' ||
    operation === 'deviation' ||
    operation === 'variance' ||
    operation === 'count';
}

},{"turf-average":21,"turf-count":66,"turf-deviation":68,"turf-max":101,"turf-median":102,"turf-min":106,"turf-sum":126,"turf-variance":135}],17:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');
var bearing = require('turf-bearing');
var destination = require('turf-destination');

/**
 * Takes a {@link LineString} feature and returns a {@link Point} feature at a specified distance along a line.
 *
 * @module turf/along
 * @category measurement
 * @param {LineString} line a LineString feature
 * @param {Number} distance distance along the line
 * @param {String} [units=miles] can be degrees, radians, miles, or kilometers
 * @return {Point} Point along the line at `distance` distance
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 *
 * var along = turf.along(line, 1, 'miles');
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [line, along]
 * };
 *
 * //=result
 */
module.exports = function (line, dist, units) {
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  var travelled = 0;
  for(var i = 0; i < coords.length; i++) {
    if (dist >= travelled && i === coords.length - 1) break;
    else if(travelled >= dist) {
      var overshot = dist - travelled;
      if(!overshot) return point(coords[i]);
      else {
        var direction = bearing(point(coords[i]), point(coords[i-1])) - 180;
        var interpolated = destination(point(coords[i]), overshot, direction, units);
        return interpolated;
      }
    }
    else {
      travelled += distance(point(coords[i]), point(coords[i+1]), units);
    }
  }
  return point(coords[coords.length - 1]);
}

},{"turf-bearing":23,"turf-destination":67,"turf-distance":70,"turf-point":112}],18:[function(require,module,exports){
var geometryArea = require('geojson-area').geometry;

/**
 * Takes a {@link GeoJSON} feature or {@link FeatureCollection} of any type and returns the area of that feature
 * in square meters.
 *
 * @module turf/area
 * @category measurement
 * @param {GeoJSON} input a {@link Feature} or {@link FeatureCollection} of any type
 * @return {Number} area in square meters
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-67.031021, 10.458102],
 *           [-67.031021, 10.53372],
 *           [-66.929397, 10.53372],
 *           [-66.929397, 10.458102],
 *           [-67.031021, 10.458102]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-66.919784, 10.397325],
 *           [-66.919784, 10.513467],
 *           [-66.805114, 10.513467],
 *           [-66.805114, 10.397325],
 *           [-66.919784, 10.397325]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 *
 * var area = turf.area(polygons);
 *
 * //=area
 */
module.exports = function(_) {
    if (_.type === 'FeatureCollection') {
        for (var i = 0, sum = 0; i < _.features.length; i++) {
            if (_.features[i].geometry) {
                sum += geometryArea(_.features[i].geometry);
            }
        }
        return sum;
    } else if (_.type === 'Feature') {
        return geometryArea(_.geometry);
    } else {
        return geometryArea(_);
    }
};

},{"geojson-area":19}],19:[function(require,module,exports){
var wgs84 = require('wgs84');

module.exports.geometry = geometry;
module.exports.ring = ringArea;

function geometry(_) {
    var area = 0, i;
    switch (_.type) {
        case 'Polygon':
            return polygonArea(_.coordinates);
        case 'MultiPolygon':
            for (i = 0; i < _.coordinates.length; i++) {
                area += polygonArea(_.coordinates[i]);
            }
            return area;
        case 'Point':
        case 'MultiPoint':
        case 'LineString':
        case 'MultiLineString':
            return 0;
        case 'GeometryCollection':
            for (i = 0; i < _.geometries.length; i++) {
                area += geometry(_.geometries[i]);
            }
            return area;
    }
}

function polygonArea(coords) {
    var area = 0;
    if (coords && coords.length > 0) {
        area += Math.abs(ringArea(coords[0]));
        for (var i = 1; i < coords.length; i++) {
            area -= Math.abs(ringArea(coords[i]));
        }
    }
    return area;
}

/**
 * Calculate the approximate area of the polygon were it projected onto
 *     the earth.  Note that this area will be positive if ring is oriented
 *     clockwise, otherwise it will be negative.
 *
 * Reference:
 * Robert. G. Chamberlain and William H. Duquette, "Some Algorithms for
 *     Polygons on a Sphere", JPL Publication 07-03, Jet Propulsion
 *     Laboratory, Pasadena, CA, June 2007 http://trs-new.jpl.nasa.gov/dspace/handle/2014/40409
 *
 * Returns:
 * {float} The approximate signed geodesic area of the polygon in square
 *     meters.
 */

function ringArea(coords) {
    var area = 0;

    if (coords.length > 2) {
        var p1, p2;
        for (var i = 0; i < coords.length - 1; i++) {
            p1 = coords[i];
            p2 = coords[i + 1];
            area += rad(p2[0] - p1[0]) * (2 + Math.sin(rad(p1[1])) + Math.sin(rad(p2[1])));
        }

        area = area * wgs84.RADIUS * wgs84.RADIUS / 2;
    }

    return area;
}

function rad(_) {
    return _ * Math.PI / 180;
}

},{"wgs84":20}],20:[function(require,module,exports){
module.exports.RADIUS = 6378137;
module.exports.FLATTENING = 1/298.257223563;
module.exports.POLAR_RADIUS = 6356752.3142;

},{}],21:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the average value of a field for a set of {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/average
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} field the field in the `points` features from which to pull values to average
 * @param {string} outputField the field in the `polygons` FeatureCollection to put results of the averages
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features with the value of `outField` set to the calculated average
 * @example
* var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [10.666351, 59.890659],
 *           [10.666351, 59.936784],
 *           [10.762481, 59.936784],
 *           [10.762481, 59.890659],
 *           [10.666351, 59.890659]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [10.764541, 59.889281],
 *           [10.764541, 59.937128],
 *           [10.866165, 59.937128],
 *           [10.866165, 59.889281],
 *           [10.764541, 59.889281]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.724029, 59.926807]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.715789, 59.904778]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.746002, 59.908566]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.806427, 59.908910]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.79544, 59.931624]
 *       }
 *     }
 *   ]
 * };
 *
 * var averaged = turf.average(
 *  polygons, points, 'population', 'pop_avg');
 *
 * var resultFeatures = points.features.concat(
 *   averaged.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField, done){
  polyFC.features.forEach(function(poly){
    if(!poly.properties) poly.properties = {};
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) values.push(pt.properties[inField]);
    });
    poly.properties[outField] = average(values);
  });

  return polyFC;
}

function average(values) {
  var sum = 0;
  for (var i = 0; i < values.length; i++) {
    sum += values[i];
  }
  return sum / values.length;
}

},{"turf-inside":86}],22:[function(require,module,exports){
var polygon = require('turf-polygon');

/**
 * Takes a bbox and returns the equivalent {@link Polygon} feature.
 *
 * @module turf/bbox-polygon
 * @category measurement
 * @param {Array<number>} bbox an Array of bounding box coordinates in the form: ```[xLow, yLow, xHigh, yHigh]```
 * @return {Polygon} a Polygon representation of the bounding box
 * @example
 * var bbox = [0, 0, 10, 10];
 *
 * var poly = turf.bboxPolygon(bbox);
 *
 * //=poly
 */

module.exports = function(bbox){
  var lowLeft = [bbox[0], bbox[1]];
  var topLeft = [bbox[0], bbox[3]];
  var topRight = [bbox[2], bbox[3]];
  var lowRight = [bbox[2], bbox[1]];

  var poly = polygon([[
    lowLeft,
    lowRight,
    topRight,
    topLeft,
    lowLeft
  ]]);
  return poly;
}

},{"turf-polygon":113}],23:[function(require,module,exports){
//http://en.wikipedia.org/wiki/Haversine_formula
//http://www.movable-type.co.uk/scripts/latlong.html

/**
 * Takes two {@link Point} features and finds the bearing between them.
 *
 * @module turf/bearing
 * @category measurement
 * @param {Point} start starting Point
 * @param {Point} end ending Point
 * @category measurement
 * @returns {Number} bearing in decimal degrees
 * @example
 * var point1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": '#f00'
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.343, 39.984]
 *   }
 * };
 * var point2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": '#0f0'
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.534, 39.123]
 *   }
 * };
 *
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [point1, point2]
 * };
 *
 * //=points
 *
 * var bearing = turf.bearing(point1, point2);
 *
 * //=bearing
 */
module.exports = function (point1, point2) {
    var coordinates1 = point1.geometry.coordinates;
    var coordinates2 = point2.geometry.coordinates;

    var lon1 = toRad(coordinates1[0]);
    var lon2 = toRad(coordinates2[0]);
    var lat1 = toRad(coordinates1[1]);
    var lat2 = toRad(coordinates2[1]);
    var a = Math.sin(lon2 - lon1) * Math.cos(lat2);
    var b = Math.cos(lat1) * Math.sin(lat2) -
        Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon2 - lon1);

    var bearing = toDeg(Math.atan2(a, b));

    return bearing;
};

function toRad(degree) {
    return degree * Math.PI / 180;
}

function toDeg(radian) {
    return radian * 180 / Math.PI;
}

},{}],24:[function(require,module,exports){
var linestring = require('turf-linestring');
var Spline = require('./spline.js');

/**
 * Takes a {@link LineString} feature and returns a curved version of the line
 * by applying a [Bezier spline](http://en.wikipedia.org/wiki/B%C3%A9zier_spline)
 * algorithm.
 *
 * The bezier spline implementation is by [Leszek Rybicki](http://leszek.rybicki.cc/).
 *
 * @module turf/bezier
 * @category transformation
 * @param {LineString} line the input LineString
 * @param {number} [resolution=10000] time in milliseconds between points
 * @param {number} [sharpness=0.85] a measure of how curvy the path should be between splines
 * @returns {LineString} curved line
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {
 *     "stroke": "#f00"
 *   },
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-76.091308, 18.427501],
 *       [-76.695556, 18.729501],
 *       [-76.552734, 19.40443],
 *       [-74.61914, 19.134789],
 *       [-73.652343, 20.07657],
 *       [-73.157958, 20.210656]
 *     ]
 *   }
 * };
 *
 * var curved = turf.bezier(line);
 * curved.properties = { stroke: '#0f0' };
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [line, curved]
 * };
 *
 * //=result
 */
module.exports = function(line, resolution, sharpness){
  var lineOut = linestring([]);

  lineOut.properties = line.properties;
  var pts = line.geometry.coordinates.map(function(pt){
    return {x: pt[0], y: pt[1]};
  });

  var spline = new Spline({
    points: pts,
    duration: resolution,
    sharpness: sharpness
  });
  for (var i=0; i<spline.duration; i+=10) {
    var pos = spline.pos(i);
    if (Math.floor(i/100)%2===0) {
        lineOut.geometry.coordinates.push([pos.x, pos.y]);
    }
  }

  return lineOut;
};

},{"./spline.js":25,"turf-linestring":100}],25:[function(require,module,exports){
 /**
   * BezierSpline
   * http://leszekr.github.com/
   *
   * @copyright
   * Copyright (C) 2012 Leszek Rybicki.
   *
   * @license
   * This file is part of BezierSpline
   *
   * BezierSpline is free software: you can redistribute it and/or modify
   * it under the terms of the GNU Lesser General Public License as published by
   * the Free Software Foundation, either version 3 of the License, or
   * (at your option) any later version.
   *
   * BezierSpline is distributed in the hope that it will be useful,
   * but WITHOUT ANY WARRANTY; without even the implied warranty of
   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   * GNU General Public License for more details.
   *
   * You should have received a copy of the GNU General Public License
   * along with BezierSpline.  If not, see <http://www.gnu.org/copyleft/lesser.html>.
   */

  /*
  Usage:

    var spline = new Spline({
      points: array_of_control_points,
      duration: time_in_miliseconds,
      sharpness: how_curvy,
      stepLength: distance_between_points_to_cache
    });

  */
var Spline = function(options){
    this.points = options.points || [];
    this.duration = options.duration || 10000;
    this.sharpness = options.sharpness || 0.85;
    this.centers = [];
    this.controls = [];
    this.stepLength = options.stepLength || 60;
    this.length = this.points.length;
    this.delay = 0;
    // this is to ensure compatibility with the 2d version
    for(var i=0; i<this.length; i++) this.points[i].z = this.points[i].z || 0;
    for(var i=0; i<this.length-1; i++){
      var p1 = this.points[i];
      var p2 = this.points[i+1];
      this.centers.push({x:(p1.x+p2.x)/2, y:(p1.y+p2.y)/2, z:(p1.z+p2.z)/2});
    }
    this.controls.push([this.points[0],this.points[0]]);
    for(var i=0; i<this.centers.length-1; i++){
      var p1 = this.centers[i];
      var p2 = this.centers[i+1];
      var dx = this.points[i+1].x-(this.centers[i].x+this.centers[i+1].x)/2;
      var dy = this.points[i+1].y-(this.centers[i].y+this.centers[i+1].y)/2;
      var dz = this.points[i+1].z-(this.centers[i].y+this.centers[i+1].z)/2;
      this.controls.push([{
        x:(1.0-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i].x+dx),
        y:(1.0-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i].y+dy),
        z:(1.0-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i].z+dz)},
      {
        x:(1.0-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i+1].x+dx),
        y:(1.0-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i+1].y+dy),
        z:(1.0-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i+1].z+dz)}]);
    }
    this.controls.push([this.points[this.length-1],this.points[this.length-1]]);
    this.steps = this.cacheSteps(this.stepLength);
    return this;
  };

  /*
    Caches an array of equidistant (more or less) points on the curve.
  */
  Spline.prototype.cacheSteps = function(mindist){
    var steps = [];
    var laststep = this.pos(0);
    steps.push(0);
    for(var t=0; t<this.duration; t+=10){
      var step = this.pos(t);
      var dist = Math.sqrt((step.x-laststep.x)*(step.x-laststep.x)+(step.y-laststep.y)*(step.y-laststep.y)+(step.z-laststep.z)*(step.z-laststep.z));
      if(dist>mindist){
        steps.push(t);
        laststep = step;
      }
    }
    return steps;
  };

  /*
    returns angle and speed in the given point in the curve
  */
  Spline.prototype.vector = function(t){
    var p1 = this.pos(t+10);
    var p2 = this.pos(t-10);
    return {
      angle:180*Math.atan2(p1.y-p2.y, p1.x-p2.x)/3.14,
      speed:Math.sqrt((p2.x-p1.x)*(p2.x-p1.x)+(p2.y-p1.y)*(p2.y-p1.y)+(p2.z-p1.z)*(p2.z-p1.z))
    };
  };

  /*
    Gets the position of the point, given time.

    WARNING: The speed is not constant. The time it takes between control points is constant.

    For constant speed, use Spline.steps[i];
  */
  Spline.prototype.pos = function(time){

    function bezier(t, p1, c1, c2, p2){
      var B = function(t) {
        var t2=t*t, t3=t2*t;
        return [(t3),(3*t2*(1-t)),(3*t*(1-t)*(1-t)),((1-t)*(1-t)*(1-t))]
      }
      var b = B(t)
      var pos = {
        x : p2.x * b[0] + c2.x * b[1] +c1.x * b[2] + p1.x * b[3],
        y : p2.y * b[0] + c2.y * b[1] +c1.y * b[2] + p1.y * b[3],
        z : p2.z * b[0] + c2.z * b[1] +c1.z * b[2] + p1.z * b[3]
      }
      return pos;
    }
    var t = time-this.delay;
    if(t<0) t=0;
    if(t>this.duration) t=this.duration-1;
    //t = t-this.delay;
    var t2 = (t)/this.duration;
    if(t2>=1) return this.points[this.length-1];

    var n = Math.floor((this.points.length-1)*t2);
    var t1 = (this.length-1)*t2-n;
    return bezier(t1,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1]);
  }

  module.exports = Spline;

},{}],26:[function(require,module,exports){
// http://stackoverflow.com/questions/839899/how-do-i-calculate-a-point-on-a-circles-circumference
// radians = degrees * (pi/180)
// https://github.com/bjornharrtell/jsts/blob/master/examples/buffer.html

var featurecollection = require('turf-featurecollection');
var polygon = require('turf-polygon');
var combine = require('turf-combine');
var jsts = require('jsts');

/**
* Calculates a buffer for a {@link Point}, {@link LineString}, or {@link Polygon} {@link Feature}/{@link FeatureCollection} for a given radius. Units supported are miles, kilometers, and degrees.
*
* @module turf/buffer
* @category transformation
* @param {FeatureCollection} feature a Feature or FeatureCollection of any type
* @param {Number} distance distance to draw the buffer
* @param {String} unit 'miles' or 'kilometers'
* @return {FeatureCollection} a FeatureCollection containing {@link Polygon} features representing buffers
*
* @example
* var pt = {
*   "type": "Feature",
*   "properties": {},
*   "geometry": {
*     "type": "Point",
*     "coordinates": [-90.548630, 14.616599]
*   }
* };
* var unit = 'miles';
*
* var buffered = turf.buffer(pt, 500, unit);
*
* var resultFeatures = buffered.features.concat(pt);
* var result = {
*   "type": "FeatureCollection",
*   "features": resultFeatures
* };
*
* //=result
*/

module.exports = function(feature, radius, units){
  var buffered;

  switch(units){
    case 'miles':
      radius = radius / 69.047;
      break
    case 'feet':
      radius = radius / 364568.0;
      break
    case 'kilometers':
      radius = radius / 111.12;
      break
    case 'meters':
      radius = radius / 111120.0;
      break
    case 'degrees':
      break
  }

  if(feature.type === 'FeatureCollection'){
    var multi = combine(feature);
    multi.properties = {};
    buffered = bufferOp(multi, radius);
    return buffered;
  }
  else{
    buffered = bufferOp(feature, radius);
    return buffered;
  }
}

var bufferOp = function(feature, radius){
  var reader = new jsts.io.GeoJSONReader();
  var geom = reader.read(JSON.stringify(feature.geometry));
  var buffered = geom.buffer(radius);
  var parser = new jsts.io.GeoJSONParser();
  buffered = parser.write(buffered);

  if(buffered.type === 'MultiPolygon'){
    buffered = {
      type: 'Feature',
      geometry: buffered,
      properties: {}
    };
    buffered = featurecollection([buffered]);
  }
  else{
    buffered = featurecollection([polygon(buffered.coordinates)]);
  }

  return buffered;
}

},{"jsts":27,"turf-combine":34,"turf-featurecollection":82,"turf-polygon":113}],27:[function(require,module,exports){
require('javascript.util');
var jsts = require('./lib/jsts');
module.exports = jsts

},{"./lib/jsts":28,"javascript.util":30}],28:[function(require,module,exports){
/* The JSTS Topology Suite is a collection of JavaScript classes that
implement the fundamental operations required to validate a given
geo-spatial data set to a known topological specification.

Copyright (C) 2011 The Authors

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA */
jsts={version:'0.15.0',algorithm:{distance:{},locate:{}},error:{},geom:{util:{}},geomgraph:{index:{}},index:{bintree:{},chain:{},kdtree:{},quadtree:{},strtree:{}},io:{},noding:{snapround:{}},operation:{buffer:{},distance:{},overlay:{snap:{}},polygonize:{},predicate:{},relate:{},union:{},valid:{}},planargraph:{},simplify:{},triangulate:{quadedge:{}},util:{}};if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
jsts.abstractFunc=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.error={};jsts.error.IllegalArgumentError=function(message){this.name='IllegalArgumentError';this.message=message;};jsts.error.IllegalArgumentError.prototype=new Error();jsts.error.TopologyError=function(message,pt){this.name='TopologyError';this.message=pt?message+' [ '+pt+' ]':message;};jsts.error.TopologyError.prototype=new Error();jsts.error.AbstractMethodInvocationError=function(){this.name='AbstractMethodInvocationError';this.message='Abstract method called, should be implemented in subclass.';};jsts.error.AbstractMethodInvocationError.prototype=new Error();jsts.error.NotImplementedError=function(){this.name='NotImplementedError';this.message='This method has not yet been implemented.';};jsts.error.NotImplementedError.prototype=new Error();jsts.error.NotRepresentableError=function(message){this.name='NotRepresentableError';this.message=message;};jsts.error.NotRepresentableError.prototype=new Error();jsts.error.LocateFailureError=function(message){this.name='LocateFailureError';this.message=message;};jsts.error.LocateFailureError.prototype=new Error();if(typeof module!=="undefined")module.exports=jsts;jsts.geom.GeometryFilter=function(){};jsts.geom.GeometryFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.PolygonExtracter=function(comps){this.comps=comps;};jsts.geom.util.PolygonExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PolygonExtracter.prototype.comps=null;jsts.geom.util.PolygonExtracter.getPolygons=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Polygon){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection){geom.apply(new jsts.geom.util.PolygonExtracter(list));}
return list;};jsts.geom.util.PolygonExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Polygon)
this.comps.push(geom);};jsts.io.WKTParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.regExes={'typeStr':/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,'emptyTypeStr':/^\s*(\w+)\s*EMPTY\s*$/,'spaces':/\s+/,'parenComma':/\)\s*,\s*\(/,'doubleParenComma':/\)\s*\)\s*,\s*\(\s*\(/,'trimParens':/^\s*\(?(.*?)\)?\s*$/};};jsts.io.WKTParser.prototype.read=function(wkt){var geometry,type,str;wkt=wkt.replace(/[\n\r]/g,' ');var matches=this.regExes.typeStr.exec(wkt);if(wkt.search('EMPTY')!==-1){matches=this.regExes.emptyTypeStr.exec(wkt);matches[2]=undefined;}
if(matches){type=matches[1].toLowerCase();str=matches[2];if(this.parse[type]){geometry=this.parse[type].apply(this,[str]);}}
if(geometry===undefined)
throw new Error('Could not parse WKT '+wkt);return geometry;};jsts.io.WKTParser.prototype.write=function(geometry){return this.extractGeometry(geometry);};jsts.io.WKTParser.prototype.extractGeometry=function(geometry){var type=geometry.CLASS_NAME.split('.')[2].toLowerCase();if(!this.extract[type]){return null;}
var wktType=type.toUpperCase();var data;if(geometry.isEmpty()){data=wktType+' EMPTY';}else{data=wktType+'('+this.extract[type].apply(this,[geometry])+')';}
return data;};jsts.io.WKTParser.prototype.extract={'coordinate':function(coordinate){return coordinate.x+' '+coordinate.y;},'point':function(point){return point.coordinate.x+' '+point.coordinate.y;},'multipoint':function(multipoint){var array=[];for(var i=0,len=multipoint.geometries.length;i<len;++i){array.push('('+
this.extract.point.apply(this,[multipoint.geometries[i]])+')');}
return array.join(',');},'linestring':function(linestring){var array=[];for(var i=0,len=linestring.points.length;i<len;++i){array.push(this.extract.coordinate.apply(this,[linestring.points[i]]));}
return array.join(',');},'multilinestring':function(multilinestring){var array=[];for(var i=0,len=multilinestring.geometries.length;i<len;++i){array.push('('+
this.extract.linestring.apply(this,[multilinestring.geometries[i]])+')');}
return array.join(',');},'polygon':function(polygon){var array=[];array.push('('+this.extract.linestring.apply(this,[polygon.shell])+')');for(var i=0,len=polygon.holes.length;i<len;++i){array.push('('+this.extract.linestring.apply(this,[polygon.holes[i]])+')');}
return array.join(',');},'multipolygon':function(multipolygon){var array=[];for(var i=0,len=multipolygon.geometries.length;i<len;++i){array.push('('+this.extract.polygon.apply(this,[multipolygon.geometries[i]])+')');}
return array.join(',');},'geometrycollection':function(collection){var array=[];for(var i=0,len=collection.geometries.length;i<len;++i){array.push(this.extractGeometry.apply(this,[collection.geometries[i]]));}
return array.join(',');}};jsts.io.WKTParser.prototype.parse={'point':function(str){if(str===undefined){return this.geometryFactory.createPoint(null);}
var coords=str.trim().split(this.regExes.spaces);return this.geometryFactory.createPoint(new jsts.geom.Coordinate(coords[0],coords[1]));},'multipoint':function(str){if(str===undefined){return this.geometryFactory.createMultiPoint(null);}
var point;var points=str.trim().split(',');var components=[];for(var i=0,len=points.length;i<len;++i){point=points[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.point.apply(this,[point]));}
return this.geometryFactory.createMultiPoint(components);},'linestring':function(str){if(str===undefined){return this.geometryFactory.createLineString(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLineString(components);},'linearring':function(str){if(str===undefined){return this.geometryFactory.createLinearRing(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLinearRing(components);},'multilinestring':function(str){if(str===undefined){return this.geometryFactory.createMultiLineString(null);}
var line;var lines=str.trim().split(this.regExes.parenComma);var components=[];for(var i=0,len=lines.length;i<len;++i){line=lines[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.linestring.apply(this,[line]));}
return this.geometryFactory.createMultiLineString(components);},'polygon':function(str){if(str===undefined){return this.geometryFactory.createPolygon(null);}
var ring,linestring,linearring;var rings=str.trim().split(this.regExes.parenComma);var shell;var holes=[];for(var i=0,len=rings.length;i<len;++i){ring=rings[i].replace(this.regExes.trimParens,'$1');linestring=this.parse.linestring.apply(this,[ring]);linearring=this.geometryFactory.createLinearRing(linestring.points);if(i===0){shell=linearring;}else{holes.push(linearring);}}
return this.geometryFactory.createPolygon(shell,holes);},'multipolygon':function(str){if(str===undefined){return this.geometryFactory.createMultiPolygon(null);}
var polygon;var polygons=str.trim().split(this.regExes.doubleParenComma);var components=[];for(var i=0,len=polygons.length;i<len;++i){polygon=polygons[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(components);},'geometrycollection':function(str){if(str===undefined){return this.geometryFactory.createGeometryCollection(null);}
str=str.replace(/,\s*([A-Za-z])/g,'|$1');var wktArray=str.trim().split('|');var components=[];for(var i=0,len=wktArray.length;i<len;++i){components.push(jsts.io.WKTParser.prototype.read.apply(this,[wktArray[i]]));}
return this.geometryFactory.createGeometryCollection(components);}};jsts.index.ItemVisitor=function(){};jsts.index.ItemVisitor.prototype.visitItem=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.CGAlgorithms=function(){};jsts.algorithm.CGAlgorithms.CLOCKWISE=-1;jsts.algorithm.CGAlgorithms.RIGHT=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE=1;jsts.algorithm.CGAlgorithms.LEFT=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.CGAlgorithms.COLLINEAR=0;jsts.algorithm.CGAlgorithms.STRAIGHT=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.CGAlgorithms.orientationIndex=function(p1,p2,q){var dx1,dy1,dx2,dy2;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dx2=q.x-p2.x;dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.algorithm.CGAlgorithms.isPointInRing=function(p,ring){return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.CGAlgorithms.locatePointInRing=function(p,ring){return jsts.algorithm.RayCrossingCounter.locatePointInRing(p,ring);};jsts.algorithm.CGAlgorithms.isOnLine=function(p,pt){var lineIntersector,i,il,p0,p1;lineIntersector=new jsts.algorithm.RobustLineIntersector();for(i=1,il=pt.length;i<il;i++){p0=pt[i-1];p1=pt[i];lineIntersector.computeIntersection(p,p0,p1);if(lineIntersector.hasIntersection()){return true;}}
return false;};jsts.algorithm.CGAlgorithms.isCCW=function(ring){var nPts,hiPt,hiIndex,p,iPrev,iNext,prev,next,i,disc,isCCW;nPts=ring.length-1;if(nPts<3){throw new jsts.IllegalArgumentError('Ring has fewer than 3 points, so orientation cannot be determined');}
hiPt=ring[0];hiIndex=0;i=1;for(i;i<=nPts;i++){p=ring[i];if(p.y>hiPt.y){hiPt=p;hiIndex=i;}}
iPrev=hiIndex;do{iPrev=iPrev-1;if(iPrev<0){iPrev=nPts;}}while(ring[iPrev].equals2D(hiPt)&&iPrev!==hiIndex);iNext=hiIndex;do{iNext=(iNext+1)%nPts;}while(ring[iNext].equals2D(hiPt)&&iNext!==hiIndex);prev=ring[iPrev];next=ring[iNext];if(prev.equals2D(hiPt)||next.equals2D(hiPt)||prev.equals2D(next)){return false;}
disc=jsts.algorithm.CGAlgorithms.computeOrientation(prev,hiPt,next);isCCW=false;if(disc===0){isCCW=(prev.x>next.x);}else{isCCW=(disc>0);}
return isCCW;};jsts.algorithm.CGAlgorithms.computeOrientation=function(p1,p2,q){return jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q);};jsts.algorithm.CGAlgorithms.distancePointLine=function(p,A,B){if(!(A instanceof jsts.geom.Coordinate)){jsts.algorithm.CGAlgorithms.distancePointLine2.apply(this,arguments);}
if(A.x===B.x&&A.y===B.y){return p.distance(A);}
var r,s;r=((p.x-A.x)*(B.x-A.x)+(p.y-A.y)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));if(r<=0.0){return p.distance(A);}
if(r>=1.0){return p.distance(B);}
s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular=function(p,A,B){var s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLine2=function(p,line){var minDistance,i,il,dist;if(line.length===0){throw new jsts.error.IllegalArgumentError('Line array must contain at least one vertex');}
minDistance=p.distance(line[0]);for(i=0,il=line.length-1;i<il;i++){dist=jsts.algorithm.CGAlgorithms.distancePointLine(p,line[i],line[i+1]);if(dist<minDistance){minDistance=dist;}}
return minDistance;};jsts.algorithm.CGAlgorithms.distanceLineLine=function(A,B,C,D){if(A.equals(B)){return jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D);}
if(C.equals(D)){return jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B);}
var r_top,r_bot,s_top,s_bot,s,r;r_top=(A.y-C.y)*(D.x-C.x)-(A.x-C.x)*(D.y-C.y);r_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);s_top=(A.y-C.y)*(B.x-A.x)-(A.x-C.x)*(B.y-A.y);s_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);if((r_bot===0)||(s_bot===0)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
s=s_top/s_bot;r=r_top/r_bot;if((r<0)||(r>1)||(s<0)||(s>1)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
return 0.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){if(ring.length<3){return 0.0;}
var sum,i,il,bx,by,cx,cy;sum=0.0;for(i=0,il=ring.length-1;i<il;i++){bx=ring[i].x;by=ring[i].y;cx=ring[i+1].x;cy=ring[i+1].y;sum+=(bx+cx)*(cy-by);}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){var n,sum,p,bx,by,i,cx,cy;n=ring.length;if(n<3){return 0.0;}
sum=0.0;p=ring[0];bx=p.x;by=p.y;for(i=1;i<n;i++){p=ring[i];cx=p.x;cy=p.y;sum+=(bx+cx)*(cy-by);bx=cx;by=cy;}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.computeLength=function(pts){var n=pts.length,len,x0,y0,x1,y1,dx,dy,p,i,il;if(n<=1){return 0.0;}
len=0.0;p=pts[0];x0=p.x;y0=p.y;i=1,il=n;for(i;i<n;i++){p=pts[i];x1=p.x;y1=p.y;dx=x1-x0;dy=y1-y0;len+=Math.sqrt(dx*dx+dy*dy);x0=x1;y0=y1;}
return len;};jsts.algorithm.CGAlgorithms.length=function(){};jsts.algorithm.Angle=function(){};jsts.algorithm.Angle.PI_TIMES_2=2.0*Math.PI;jsts.algorithm.Angle.PI_OVER_2=Math.PI/2.0;jsts.algorithm.Angle.PI_OVER_4=Math.PI/4.0;jsts.algorithm.Angle.COUNTERCLOCKWISE=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.Angle.CLOCKWISE=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.Angle.NONE=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.Angle.toDegrees=function(radians){return(radians*180)/Math.PI;};jsts.algorithm.Angle.toRadians=function(angleDegrees){return(angleDegrees*Math.PI)/180.0;};jsts.algorithm.Angle.angle=function(){if(arguments.length===1){return jsts.algorithm.Angle.angleFromOrigo(arguments[0]);}else{return jsts.algorithm.Angle.angleBetweenCoords(arguments[0],arguments[1]);}};jsts.algorithm.Angle.angleBetweenCoords=function(p0,p1){var dx,dy;dx=p1.x-p0.x;dy=p1.y-p0.y;return Math.atan2(dy,dx);};jsts.algorithm.Angle.angleFromOrigo=function(p){return Math.atan2(p.y,p.x);};jsts.algorithm.Angle.isAcute=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod>0;};jsts.algorithm.Angle.isObtuse=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod<0;};jsts.algorithm.Angle.angleBetween=function(tip1,tail,tip2){var a1,a2;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);return jsts.algorithm.Angle.diff(a1,a2);};jsts.algorithm.Angle.angleBetweenOriented=function(tip1,tail,tip2){var a1,a2,angDel;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);angDel=a2-a1;if(angDel<=-Math.PI){return angDel+jsts.algorithm.Angle.PI_TIMES_2;}
if(angDel>Math.PI){return angDel-jsts.algorithm.Angle.PI_TIMES_2;}
return angDel;};jsts.algorithm.Angle.interiorAngle=function(p0,p1,p2){var anglePrev,angleNext;anglePrev=jsts.algorithm.Angle.angle(p1,p0);angleNext=jsts.algorithm.Angle.angle(p1,p2);return Math.abs(angleNext-anglePrev);};jsts.algorithm.Angle.getTurn=function(ang1,ang2){var crossproduct=Math.sin(ang2-ang1);if(crossproduct>0){return jsts.algorithm.Angle.COUNTERCLOCKWISE;}
if(crossproduct<0){return jsts.algorithm.Angle.CLOCKWISE;}
return jsts.algorithm.Angle.NONE;};jsts.algorithm.Angle.normalize=function(angle){while(angle>Math.PI){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
while(angle<=-Math.PI){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
return angle;};jsts.algorithm.Angle.normalizePositive=function(angle){if(angle<0.0){while(angle<0.0){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle=0.0;}}
else{while(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle<0.0){angle=0.0;}}
return angle;};jsts.algorithm.Angle.diff=function(ang1,ang2){var delAngle;if(ang1<ang2){delAngle=ang2-ang1;}else{delAngle=ang1-ang2;}
if(delAngle>Math.PI){delAngle=(2*Math.PI)-delAngle;}
return delAngle;};jsts.geom.GeometryComponentFilter=function(){};jsts.geom.GeometryComponentFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.LinearComponentExtracter=function(lines,isForcedToLineString){this.lines=lines;this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype=new jsts.geom.GeometryComponentFilter();jsts.geom.util.LinearComponentExtracter.prototype.lines=null;jsts.geom.util.LinearComponentExtracter.prototype.isForcedToLineString=false;jsts.geom.util.LinearComponentExtracter.getLines=function(geoms,lines){if(arguments.length==1){return jsts.geom.util.LinearComponentExtracter.getLines5.apply(this,arguments);}
else if(arguments.length==2&&typeof lines==='boolean'){return jsts.geom.util.LinearComponentExtracter.getLines6.apply(this,arguments);}
else if(arguments.length==2&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines3.apply(this,arguments);}
else if(arguments.length==3&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines4.apply(this,arguments);}
else if(arguments.length==3){return jsts.geom.util.LinearComponentExtracter.getLines2.apply(this,arguments);}
for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines3(g,lines);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines2=function(geoms,lines,forceToLineString){for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines4(g,lines,forceToLineString);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines3=function(geom,lines){if(geom instanceof LineString){lines.add(geom);}else{geom.apply(new jsts.geom.util.LinearComponentExtracter(lines));}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines4=function(geom,lines,forceToLineString){geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.getLines5=function(geom){return jsts.geom.util.LinearComponentExtracter.getLines6(geom,false);};jsts.geom.util.LinearComponentExtracter.getLines6=function(geom,forceToLineString){var lines=[];geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.prototype.setForceToLineString=function(isForcedToLineString){this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype.filter=function(geom){if(this.isForcedToLineString&&geom instanceof jsts.geom.LinearRing){var line=geom.getFactory().createLineString(geom.getCoordinateSequence());this.lines.push(line);return;}
if(geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.LinearRing)
this.lines.push(geom);};jsts.geom.Location=function(){};jsts.geom.Location.INTERIOR=0;jsts.geom.Location.BOUNDARY=1;jsts.geom.Location.EXTERIOR=2;jsts.geom.Location.NONE=-1;jsts.geom.Location.toLocationSymbol=function(locationValue){switch(locationValue){case jsts.geom.Location.EXTERIOR:return'e';case jsts.geom.Location.BOUNDARY:return'b';case jsts.geom.Location.INTERIOR:return'i';case jsts.geom.Location.NONE:return'-';}
throw new jsts.IllegalArgumentError('Unknown location value: '+
locationValue);};(function(){jsts.io.GeoJSONReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONReader.prototype.read=function(geoJson){var geometry=this.parser.read(geoJson);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.GeoJSONReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};})();jsts.geom.Geometry=function(factory){this.factory=factory;};jsts.geom.Geometry.prototype.envelope=null;jsts.geom.Geometry.prototype.factory=null;jsts.geom.Geometry.prototype.getGeometryType=function(){return'Geometry';};jsts.geom.Geometry.hasNonEmptyElements=function(geometries){var i;for(i=0;i<geometries.length;i++){if(!geometries[i].isEmpty()){return true;}}
return false;};jsts.geom.Geometry.hasNullElements=function(array){var i;for(i=0;i<array.length;i++){if(array[i]===null){return true;}}
return false;};jsts.geom.Geometry.prototype.getFactory=function(){if(this.factory===null||this.factory===undefined){this.factory=new jsts.geom.GeometryFactory();}
return this.factory;};jsts.geom.Geometry.prototype.getNumGeometries=function(){return 1;};jsts.geom.Geometry.prototype.getGeometryN=function(n){return this;};jsts.geom.Geometry.prototype.getPrecisionModel=function(){return this.getFactory().getPrecisionModel();};jsts.geom.Geometry.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getCoordinates=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getNumPoints=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.isSimple=function(){this.checkNotGeometryCollection(this);var op=new jsts.operation.IsSimpleOp(this);return op.isSimple();};jsts.geom.Geometry.prototype.isValid=function(){var isValidOp=new jsts.operation.valid.IsValidOp(this);return isValidOp.isValid();};jsts.geom.Geometry.prototype.isEmpty=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.distance=function(g){return jsts.operation.distance.DistanceOp.distance(this,g);};jsts.geom.Geometry.prototype.isWithinDistance=function(geom,distance){var envDist=this.getEnvelopeInternal().distance(geom.getEnvelopeInternal());if(envDist>distance){return false;}
return DistanceOp.isWithinDistance(this,geom,distance);};jsts.geom.Geometry.prototype.isRectangle=function(){return false;};jsts.geom.Geometry.prototype.getArea=function(){return 0.0;};jsts.geom.Geometry.prototype.getLength=function(){return 0.0;};jsts.geom.Geometry.prototype.getCentroid=function(){if(this.isEmpty()){return null;}
var cent;var centPt=null;var dim=this.getDimension();if(dim===0){cent=new jsts.algorithm.CentroidPoint();cent.add(this);centPt=cent.getCentroid();}else if(dim===1){cent=new jsts.algorithm.CentroidLine();cent.add(this);centPt=cent.getCentroid();}else{cent=new jsts.algorithm.CentroidArea();cent.add(this);centPt=cent.getCentroid();}
return this.createPointFromInternalCoord(centPt,this);};jsts.geom.Geometry.prototype.getInteriorPoint=function(){var intPt;var interiorPt=null;var dim=this.getDimension();if(dim===0){intPt=new jsts.algorithm.InteriorPointPoint(this);interiorPt=intPt.getInteriorPoint();}else if(dim===1){intPt=new jsts.algorithm.InteriorPointLine(this);interiorPt=intPt.getInteriorPoint();}else{intPt=new jsts.algorithm.InteriorPointArea(this);interiorPt=intPt.getInteriorPoint();}
return this.createPointFromInternalCoord(interiorPt,this);};jsts.geom.Geometry.prototype.getDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundary=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundaryDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal());};jsts.geom.Geometry.prototype.getEnvelopeInternal=function(){if(this.envelope===null){this.envelope=this.computeEnvelopeInternal();}
return this.envelope;};jsts.geom.Geometry.prototype.disjoint=function(g){return!this.intersects(g);};jsts.geom.Geometry.prototype.touches=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isTouches(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.intersects=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(this,g);}
if(g.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(g,this);}
return this.relate(g).isIntersects();};jsts.geom.Geometry.prototype.crosses=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isCrosses(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.within=function(g){return g.contains(this);};jsts.geom.Geometry.prototype.contains=function(g){if(!this.getEnvelopeInternal().contains(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleContains.contains(this,g);}
return this.relate(g).isContains();};jsts.geom.Geometry.prototype.overlaps=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isOverlaps(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.covers=function(g){if(!this.getEnvelopeInternal().covers(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return true;}
return this.relate(g).isCovers();};jsts.geom.Geometry.prototype.coveredBy=function(g){return g.covers(this);};jsts.geom.Geometry.prototype.relate=function(g,intersectionPattern){if(arguments.length===1){return this.relate2.apply(this,arguments);}
return this.relate2(g).matches(intersectionPattern);};jsts.geom.Geometry.prototype.relate2=function(g){this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(g);return jsts.operation.relate.RelateOp.relate(this,g);};jsts.geom.Geometry.prototype.equalsTopo=function(g){if(!this.getEnvelopeInternal().equals(g.getEnvelopeInternal())){return false;}
return this.relate(g).isEquals(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.equals=function(o){if(o instanceof jsts.geom.Geometry||o instanceof jsts.geom.LinearRing||o instanceof jsts.geom.Polygon||o instanceof jsts.geom.GeometryCollection||o instanceof jsts.geom.MultiPoint||o instanceof jsts.geom.MultiLineString||o instanceof jsts.geom.MultiPolygon){return this.equalsExact(o);}
return false;};jsts.geom.Geometry.prototype.buffer=function(distance,quadrantSegments,endCapStyle){var params=new jsts.operation.buffer.BufferParameters(quadrantSegments,endCapStyle)
return jsts.operation.buffer.BufferOp.bufferOp2(this,distance,params);};jsts.geom.Geometry.prototype.convexHull=function(){return new jsts.algorithm.ConvexHull(this).getConvexHull();};jsts.geom.Geometry.prototype.intersection=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(this.isGeometryCollection(this)){var g2=other;}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.INTERSECTION);};jsts.geom.Geometry.prototype.union=function(other){if(arguments.length===0){return jsts.operation.union.UnaryUnionOp.union(this);}
if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.UNION);};jsts.geom.Geometry.prototype.difference=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.DIFFERENCE);};jsts.geom.Geometry.prototype.symDifference=function(other){if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE);};jsts.geom.Geometry.prototype.equalsExact=function(other,tolerance){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.equalsNorm=function(g){if(g===null||g===undefined)
return false;return this.norm().equalsExact(g.norm());};jsts.geom.Geometry.prototype.apply=function(filter){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.clone=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.normalize=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.norm=function(){var copy=this.clone();copy.normalize();return copy;};jsts.geom.Geometry.prototype.compareTo=function(o){var other=o;if(this.getClassSortIndex()!==other.getClassSortIndex()){return this.getClassSortIndex()-other.getClassSortIndex();}
if(this.isEmpty()&&other.isEmpty()){return 0;}
if(this.isEmpty()){return-1;}
if(other.isEmpty()){return 1;}
return this.compareToSameClass(o);};jsts.geom.Geometry.prototype.isEquivalentClass=function(other){if(this instanceof jsts.geom.Point&&other instanceof jsts.geom.Point){return true;}else if(this instanceof jsts.geom.LineString&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.LinearRing&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.Polygon&&(other instanceof jsts.geom.Polygon)){return true;}else if(this instanceof jsts.geom.MultiPoint&&(other instanceof jsts.geom.MultiPoint)){return true;}else if(this instanceof jsts.geom.MultiLineString&&(other instanceof jsts.geom.MultiLineString)){return true;}else if(this instanceof jsts.geom.MultiPolygon&&(other instanceof jsts.geom.MultiPolygon)){return true;}else if(this instanceof jsts.geom.GeometryCollection&&(other instanceof jsts.geom.GeometryCollection)){return true;}
return false;};jsts.geom.Geometry.prototype.checkNotGeometryCollection=function(g){if(g.isGeometryCollectionBase()){throw new jsts.error.IllegalArgumentError('This method does not support GeometryCollection');}};jsts.geom.Geometry.prototype.isGeometryCollection=function(){return(this instanceof jsts.geom.GeometryCollection);};jsts.geom.Geometry.prototype.isGeometryCollectionBase=function(){return(this.CLASS_NAME==='jsts.geom.GeometryCollection');};jsts.geom.Geometry.prototype.computeEnvelopeInternal=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compareToSameClass=function(o){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compare=function(a,b){var i=a.iterator();var j=b.iterator();while(i.hasNext()&&j.hasNext()){var aElement=i.next();var bElement=j.next();var comparison=aElement.compareTo(bElement);if(comparison!==0){return comparison;}}
if(i.hasNext()){return 1;}
if(j.hasNext()){return-1;}
return 0;};jsts.geom.Geometry.prototype.equal=function(a,b,tolerance){if(tolerance===undefined||tolerance===null||tolerance===0){return a.equals(b);}
return a.distance(b)<=tolerance;};jsts.geom.Geometry.prototype.getClassSortIndex=function(){var sortedClasses=[jsts.geom.Point,jsts.geom.MultiPoint,jsts.geom.LineString,jsts.geom.LinearRing,jsts.geom.MultiLineString,jsts.geom.Polygon,jsts.geom.MultiPolygon,jsts.geom.GeometryCollection];for(var i=0;i<sortedClasses.length;i++){if(this instanceof sortedClasses[i])
return i;}
jsts.util.Assert.shouldNeverReachHere('Class not supported: '+this);return-1;};jsts.geom.Geometry.prototype.toString=function(){return new jsts.io.WKTWriter().write(this);};jsts.geom.Geometry.prototype.createPointFromInternalCoord=function(coord,exemplar){exemplar.getPrecisionModel().makePrecise(coord);return exemplar.getFactory().createPoint(coord);};(function(){jsts.geom.Coordinate=function(x,y){if(typeof x==='number'){this.x=x;this.y=y;}else if(x instanceof jsts.geom.Coordinate){this.x=parseFloat(x.x);this.y=parseFloat(x.y);}else if(x===undefined||x===null){this.x=0;this.y=0;}else if(typeof x==='string'){this.x=parseFloat(x);this.y=parseFloat(y);}};jsts.geom.Coordinate.prototype.setCoordinate=function(other){this.x=other.x;this.y=other.y;};jsts.geom.Coordinate.prototype.clone=function(){return new jsts.geom.Coordinate(this.x,this.y);};jsts.geom.Coordinate.prototype.distance=function(p){var dx=this.x-p.x;var dy=this.y-p.y;return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Coordinate.prototype.equals2D=function(other){if(this.x!==other.x){return false;}
if(this.y!==other.y){return false;}
return true;};jsts.geom.Coordinate.prototype.equals=function(other){if(!other instanceof jsts.geom.Coordinate||other===undefined){return false;}
return this.equals2D(other);};jsts.geom.Coordinate.prototype.compareTo=function(other){if(this.x<other.x){return-1;}
if(this.x>other.x){return 1;}
if(this.y<other.y){return-1;}
if(this.y>other.y){return 1;}
return 0;};jsts.geom.Coordinate.prototype.toString=function(){return'('+this.x+', '+this.y+')';};})();jsts.geom.Envelope=function(){jsts.geom.Envelope.prototype.init.apply(this,arguments);};jsts.geom.Envelope.prototype.minx=null;jsts.geom.Envelope.prototype.maxx=null;jsts.geom.Envelope.prototype.miny=null;jsts.geom.Envelope.prototype.maxy=null;jsts.geom.Envelope.prototype.init=function(){if(typeof arguments[0]==='number'&&arguments.length===4){this.initFromValues(arguments[0],arguments[1],arguments[2],arguments[3]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===1){this.initFromCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===2){this.initFromCoordinates(arguments[0],arguments[1]);}else if(arguments[0]instanceof jsts.geom.Envelope&&arguments.length===1){this.initFromEnvelope(arguments[0]);}else{this.setToNull();}};jsts.geom.Envelope.prototype.initFromValues=function(x1,x2,y1,y2){if(x1<x2){this.minx=x1;this.maxx=x2;}else{this.minx=x2;this.maxx=x1;}
if(y1<y2){this.miny=y1;this.maxy=y2;}else{this.miny=y2;this.maxy=y1;}};jsts.geom.Envelope.prototype.initFromCoordinates=function(p1,p2){this.initFromValues(p1.x,p2.x,p1.y,p2.y);};jsts.geom.Envelope.prototype.initFromCoordinate=function(p){this.initFromValues(p.x,p.x,p.y,p.y);};jsts.geom.Envelope.prototype.initFromEnvelope=function(env){this.minx=env.minx;this.maxx=env.maxx;this.miny=env.miny;this.maxy=env.maxy;};jsts.geom.Envelope.prototype.setToNull=function(){this.minx=0;this.maxx=-1;this.miny=0;this.maxy=-1;};jsts.geom.Envelope.prototype.isNull=function(){return this.maxx<this.minx;};jsts.geom.Envelope.prototype.getHeight=function(){if(this.isNull()){return 0;}
return this.maxy-this.miny;};jsts.geom.Envelope.prototype.getWidth=function(){if(this.isNull()){return 0;}
return this.maxx-this.minx;};jsts.geom.Envelope.prototype.getMinX=function(){return this.minx;};jsts.geom.Envelope.prototype.getMaxX=function(){return this.maxx;};jsts.geom.Envelope.prototype.getMinY=function(){return this.miny;};jsts.geom.Envelope.prototype.getMaxY=function(){return this.maxy;};jsts.geom.Envelope.prototype.getArea=function(){return this.getWidth()*this.getHeight();};jsts.geom.Envelope.prototype.expandToInclude=function(){if(arguments[0]instanceof jsts.geom.Coordinate){this.expandToIncludeCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Envelope){this.expandToIncludeEnvelope(arguments[0]);}else{this.expandToIncludeValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandToIncludeCoordinate=function(p){this.expandToIncludeValues(p.x,p.y);};jsts.geom.Envelope.prototype.expandToIncludeValues=function(x,y){if(this.isNull()){this.minx=x;this.maxx=x;this.miny=y;this.maxy=y;}else{if(x<this.minx){this.minx=x;}
if(x>this.maxx){this.maxx=x;}
if(y<this.miny){this.miny=y;}
if(y>this.maxy){this.maxy=y;}}};jsts.geom.Envelope.prototype.expandToIncludeEnvelope=function(other){if(other.isNull()){return;}
if(this.isNull()){this.minx=other.getMinX();this.maxx=other.getMaxX();this.miny=other.getMinY();this.maxy=other.getMaxY();}else{if(other.minx<this.minx){this.minx=other.minx;}
if(other.maxx>this.maxx){this.maxx=other.maxx;}
if(other.miny<this.miny){this.miny=other.miny;}
if(other.maxy>this.maxy){this.maxy=other.maxy;}}};jsts.geom.Envelope.prototype.expandBy=function(){if(arguments.length===1){this.expandByDistance(arguments[0]);}else{this.expandByDistances(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandByDistance=function(distance){this.expandByDistances(distance,distance);};jsts.geom.Envelope.prototype.expandByDistances=function(deltaX,deltaY){if(this.isNull()){return;}
this.minx-=deltaX;this.maxx+=deltaX;this.miny-=deltaY;this.maxy+=deltaY;if(this.minx>this.maxx||this.miny>this.maxy){this.setToNull();}};jsts.geom.Envelope.prototype.translate=function(transX,transY){if(this.isNull()){return;}
this.init(this.minx+transX,this.maxx+transX,this.miny+transY,this.maxy+transY);};jsts.geom.Envelope.prototype.centre=function(){if(this.isNull()){return null;}
return new jsts.geom.Coordinate((this.minx+this.maxx)/2.0,(this.miny+this.maxy)/2.0);};jsts.geom.Envelope.prototype.intersection=function(env){if(this.isNull()||env.isNull()||!this.intersects(env)){return new jsts.geom.Envelope();}
var intMinX=this.minx>env.minx?this.minx:env.minx;var intMinY=this.miny>env.miny?this.miny:env.miny;var intMaxX=this.maxx<env.maxx?this.maxx:env.maxx;var intMaxY=this.maxy<env.maxy?this.maxy:env.maxy;return new jsts.geom.Envelope(intMinX,intMaxX,intMinY,intMaxY);};jsts.geom.Envelope.prototype.intersects=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.intersectsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.intersectsCoordinate(arguments[0]);}else{return this.intersectsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.intersectsEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
var result=!(other.minx>this.maxx||other.maxx<this.minx||other.miny>this.maxy||other.maxy<this.miny);return result;};jsts.geom.Envelope.prototype.intersectsCoordinate=function(p){return this.intersectsValues(p.x,p.y);};jsts.geom.Envelope.prototype.intersectsValues=function(x,y){if(this.isNull()){return false;}
return!(x>this.maxx||x<this.minx||y>this.maxy||y<this.miny);};jsts.geom.Envelope.prototype.contains=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.containsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.containsCoordinate(arguments[0]);}else{return this.containsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.containsEnvelope=function(other){return this.coversEnvelope(other);};jsts.geom.Envelope.prototype.containsCoordinate=function(p){return this.coversCoordinate(p);};jsts.geom.Envelope.prototype.containsValues=function(x,y){return this.coversValues(x,y);};jsts.geom.Envelope.prototype.covers=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.coversEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.coversCoordinate(arguments[0]);}else{return this.coversValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.coversValues=function(x,y){if(this.isNull()){return false;}
return x>=this.minx&&x<=this.maxx&&y>=this.miny&&y<=this.maxy;};jsts.geom.Envelope.prototype.coversCoordinate=function(p){return this.coversValues(p.x,p.y);};jsts.geom.Envelope.prototype.coversEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
return other.minx>=this.minx&&other.maxx<=this.maxx&&other.miny>=this.miny&&other.maxy<=this.maxy;};jsts.geom.Envelope.prototype.distance=function(env){if(this.intersects(env)){return 0;}
var dx=0.0;if(this.maxx<env.minx){dx=env.minx-this.maxx;}
if(this.minx>env.maxx){dx=this.minx-env.maxx;}
var dy=0.0;if(this.maxy<env.miny){dy=env.miny-this.maxy;}
if(this.miny>env.maxy){dy=this.miny-env.maxy;}
if(dx===0.0){return dy;}
if(dy===0.0){return dx;}
return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Envelope.prototype.equals=function(other){if(this.isNull()){return other.isNull();}
return this.maxx===other.maxx&&this.maxy===other.maxy&&this.minx===other.minx&&this.miny===other.miny;};jsts.geom.Envelope.prototype.toString=function(){return'Env['+this.minx+' : '+this.maxx+', '+this.miny+' : '+
this.maxy+']';};jsts.geom.Envelope.intersects=function(p1,p2,q){if(arguments.length===4){return jsts.geom.Envelope.intersectsEnvelope(arguments[0],arguments[1],arguments[2],arguments[3]);}
var xc1=p1.x<p2.x?p1.x:p2.x;var xc2=p1.x>p2.x?p1.x:p2.x;var yc1=p1.y<p2.y?p1.y:p2.y;var yc2=p1.y>p2.y?p1.y:p2.y;if(((q.x>=xc1)&&(q.x<=xc2))&&((q.y>=yc1)&&(q.y<=yc2))){return true;}
return false;};jsts.geom.Envelope.intersectsEnvelope=function(p1,p2,q1,q2){var minq=Math.min(q1.x,q2.x);var maxq=Math.max(q1.x,q2.x);var minp=Math.min(p1.x,p2.x);var maxp=Math.max(p1.x,p2.x);if(minp>maxq){return false;}
if(maxp<minq){return false;}
minq=Math.min(q1.y,q2.y);maxq=Math.max(q1.y,q2.y);minp=Math.min(p1.y,p2.y);maxp=Math.max(p1.y,p2.y);if(minp>maxq){return false;}
if(maxp<minq){return false;}
return true;};jsts.geom.Envelope.prototype.clone=function(){return new jsts.geom.Envelope(this.minx,this.maxx,this.miny,this.maxy);};jsts.geom.util.GeometryCombiner=function(geoms){this.geomFactory=jsts.geom.util.GeometryCombiner.extractFactory(geoms);this.inputGeoms=geoms;};jsts.geom.util.GeometryCombiner.combine=function(geoms){if(arguments.length>1)return this.combine2.apply(this,arguments);var combiner=new jsts.geom.util.GeometryCombiner(geoms);return combiner.combine();};jsts.geom.util.GeometryCombiner.combine2=function(){var arrayList=new javascript.util.ArrayList();Array.prototype.slice.call(arguments).forEach(function(a){arrayList.add(a);});var combiner=new jsts.geom.util.GeometryCombiner(arrayList);return combiner.combine();};jsts.geom.util.GeometryCombiner.prototype.geomFactory=null;jsts.geom.util.GeometryCombiner.prototype.skipEmpty=false;jsts.geom.util.GeometryCombiner.prototype.inputGeoms;jsts.geom.util.GeometryCombiner.extractFactory=function(geoms){if(geoms.isEmpty())return null;return geoms.iterator().next().getFactory();};jsts.geom.util.GeometryCombiner.prototype.combine=function(){var elems=new javascript.util.ArrayList(),i;for(i=this.inputGeoms.iterator();i.hasNext();){var g=i.next();this.extractElements(g,elems);}
if(elems.size()===0){if(this.geomFactory!==null){return this.geomFactory.createGeometryCollection(null);}
return null;}
return this.geomFactory.buildGeometry(elems);};jsts.geom.util.GeometryCombiner.prototype.extractElements=function(geom,elems){if(geom===null){return;}
for(var i=0;i<geom.getNumGeometries();i++){var elemGeom=geom.getGeometryN(i);if(this.skipEmpty&&elemGeom.isEmpty()){continue;}
elems.add(elemGeom);}};jsts.geom.PrecisionModel=function(modelType){if(typeof modelType==='number'){this.modelType=jsts.geom.PrecisionModel.FIXED;this.scale=modelType;return;}
this.modelType=modelType||jsts.geom.PrecisionModel.FLOATING;if(this.modelType===jsts.geom.PrecisionModel.FIXED){this.scale=1.0;}};jsts.geom.PrecisionModel.FLOATING='FLOATING';jsts.geom.PrecisionModel.FIXED='FIXED';jsts.geom.PrecisionModel.FLOATING_SINGLE='FLOATING_SINGLE';jsts.geom.PrecisionModel.prototype.scale=null;jsts.geom.PrecisionModel.prototype.modelType=null;jsts.geom.PrecisionModel.prototype.isFloating=function(){return this.modelType===jsts.geom.PrecisionModel.FLOATING||this.modelType===jsts.geom.PrecisionModel.FLOATING_SINLGE;};jsts.geom.PrecisionModel.prototype.getScale=function(){return this.scale;};jsts.geom.PrecisionModel.prototype.getType=function(){return this.modelType;};jsts.geom.PrecisionModel.prototype.equals=function(other){return true;if(!(other instanceof jsts.geom.PrecisionModel)){return false;}
var otherPrecisionModel=other;return this.modelType===otherPrecisionModel.modelType&&this.scale===otherPrecisionModel.scale;};jsts.geom.PrecisionModel.prototype.makePrecise=function(val){if(val instanceof jsts.geom.Coordinate){this.makePrecise2(val);return;}
if(isNaN(val))
return val;if(this.modelType===jsts.geom.PrecisionModel.FIXED){return Math.round(val*this.scale)/this.scale;}
return val;};jsts.geom.PrecisionModel.prototype.makePrecise2=function(coord){if(this.modelType===jsts.geom.PrecisionModel.FLOATING)
return;coord.x=this.makePrecise(coord.x);coord.y=this.makePrecise(coord.y);};jsts.geom.PrecisionModel.prototype.compareTo=function(o){var other=o;return 0;};jsts.geom.CoordinateFilter=function(){};jsts.geom.CoordinateFilter.prototype.filter=function(coord){throw new jsts.error.AbstractMethodInvocationError();};jsts.simplify.DouglasPeuckerLineSimplifier=function(pts){this.pts=pts;this.seg=new jsts.geom.LineSegment();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.pts=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.usePt=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerLineSimplifier.simplify=function(pts,distanceTolerance){var simp=new jsts.simplify.DouglasPeuckerLineSimplifier(pts);simp.setDistanceTolerance(distanceTolerance);return simp.simplify();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplify=function(){this.usePt=[];for(var i=0;i<this.pts.length;i++){this.usePt[i]=true;}
this.simplifySection(0,this.pts.length-1);var coordList=new jsts.geom.CoordinateList();for(var j=0;j<this.pts.length;j++){if(this.usePt[j]){coordList.add(new jsts.geom.Coordinate(this.pts[j]));}}
return coordList.toCoordinateArray();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.seg=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplifySection=function(i,j){if(i+1==j){return;}
this.seg.p0=this.pts[i];this.seg.p1=this.pts[j];var maxDistance=-1.0;var maxIndex=i;for(var k=i+1;k<j;k++){var distance=this.seg.distance(this.pts[k]);if(distance>maxDistance){maxDistance=distance;maxIndex=k;}}
if(maxDistance<=this.distanceTolerance){for(var l=i+1;l<j;l++){this.usePt[l]=false;}}else{this.simplifySection(i,maxIndex);this.simplifySection(maxIndex,j);}};jsts.geomgraph.EdgeIntersection=function(coord,segmentIndex,dist){this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.dist=dist;};jsts.geomgraph.EdgeIntersection.prototype.coord=null;jsts.geomgraph.EdgeIntersection.prototype.segmentIndex=null;jsts.geomgraph.EdgeIntersection.prototype.dist=null;jsts.geomgraph.EdgeIntersection.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.EdgeIntersection.prototype.getSegmentIndex=function(){return this.segmentIndex;};jsts.geomgraph.EdgeIntersection.prototype.getDistance=function(){return this.dist;};jsts.geomgraph.EdgeIntersection.prototype.compareTo=function(other){return this.compare(other.segmentIndex,other.dist);};jsts.geomgraph.EdgeIntersection.prototype.compare=function(segmentIndex,dist){if(this.segmentIndex<segmentIndex)
return-1;if(this.segmentIndex>segmentIndex)
return 1;if(this.dist<dist)
return-1;if(this.dist>dist)
return 1;return 0;};jsts.geomgraph.EdgeIntersection.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&this.dist===0.0)
return true;if(this.segmentIndex===maxSegmentIndex)
return true;return false;};jsts.geomgraph.EdgeIntersection.prototype.toString=function(){return''+this.segmentIndex+this.dist;};(function(){var EdgeIntersection=jsts.geomgraph.EdgeIntersection;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeIntersectionList=function(edge){this.nodeMap=new TreeMap();this.edge=edge;};jsts.geomgraph.EdgeIntersectionList.prototype.nodeMap=null;jsts.geomgraph.EdgeIntersectionList.prototype.edge=null;jsts.geomgraph.EdgeIntersectionList.prototype.isIntersection=function(pt){for(var it=this.iterator();it.hasNext();){var ei=it.next();if(ei.coord.equals(pt)){return true;}}
return false;};jsts.geomgraph.EdgeIntersectionList.prototype.add=function(intPt,segmentIndex,dist){var eiNew=new EdgeIntersection(intPt,segmentIndex,dist);var ei=this.nodeMap.get(eiNew);if(ei!==null){return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.geomgraph.EdgeIntersectionList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.geomgraph.EdgeIntersectionList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0.0);this.add(this.edge.pts[maxSegIndex],maxSegIndex,0.0);};jsts.geomgraph.EdgeIntersectionList.prototype.addSplitEdges=function(edgeList)
{this.addEndpoints();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.geomgraph.EdgeIntersectionList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.pts[ei1.segmentIndex];var useIntPt1=ei1.dist>0.0||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.pts[i];}
if(useIntPt1)pts[ipt]=ei1.coord;return new jsts.geomgraph.Edge(pts,new jsts.geomgraph.Label(this.edge.label));};})();(function(){var AssertionFailedException=function(message){this.message=message;};AssertionFailedException.prototype=new Error();AssertionFailedException.prototype.name='AssertionFailedException';jsts.util.AssertionFailedException=AssertionFailedException;})();(function(){var AssertionFailedException=jsts.util.AssertionFailedException;jsts.util.Assert=function(){};jsts.util.Assert.isTrue=function(assertion,message){if(!assertion){if(message===null){throw new AssertionFailedException();}else{throw new AssertionFailedException(message);}}};jsts.util.Assert.equals=function(expectedValue,actualValue,message){if(!actualValue.equals(expectedValue)){throw new AssertionFailedException('Expected '+expectedValue+' but encountered '+actualValue+
(message!=null?': '+message:''));}};jsts.util.Assert.shouldNeverReachHere=function(message){throw new AssertionFailedException('Should never reach here'+
(message!=null?': '+message:''));};})();(function(){var Location=jsts.geom.Location;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.relate.RelateComputer=function(arg){this.li=new jsts.algorithm.RobustLineIntersector();this.ptLocator=new jsts.algorithm.PointLocator();this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());this.isolatedEdges=new ArrayList();this.arg=arg;};jsts.operation.relate.RelateComputer.prototype.li=null;jsts.operation.relate.RelateComputer.prototype.ptLocator=null;jsts.operation.relate.RelateComputer.prototype.arg=null;jsts.operation.relate.RelateComputer.prototype.nodes=null;jsts.operation.relate.RelateComputer.prototype.im=null;jsts.operation.relate.RelateComputer.prototype.isolatedEdges=null;jsts.operation.relate.RelateComputer.prototype.invalidPoint=null;jsts.operation.relate.RelateComputer.prototype.computeIM=function(){var im=new jsts.geom.IntersectionMatrix();im.set(Location.EXTERIOR,Location.EXTERIOR,2);if(!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal())){this.computeDisjointIM(im);return im;}
this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);var intersector=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,false);this.computeIntersectionNodes(0);this.computeIntersectionNodes(1);this.copyNodesAndLabels(0);this.copyNodesAndLabels(1);this.labelIsolatedNodes();this.computeProperIntersectionIM(intersector,im);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var ee0=eeBuilder.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(ee0);var ee1=eeBuilder.computeEdgeEnds(this.arg[1].getEdgeIterator());this.insertEdgeEnds(ee1);this.labelNodeEdges();this.labelIsolatedEdges(0,1);this.labelIsolatedEdges(1,0);this.updateIM(im);return im;};jsts.operation.relate.RelateComputer.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateComputer.prototype.computeProperIntersectionIM=function(intersector,im){var dimA=this.arg[0].getGeometry().getDimension();var dimB=this.arg[1].getGeometry().getDimension();var hasProper=intersector.hasProperIntersection();var hasProperInterior=intersector.hasProperInteriorIntersection();if(dimA===2&&dimB===2){if(hasProper)
im.setAtLeast('212101212');}
else if(dimA===2&&dimB===1){if(hasProper)
im.setAtLeast('FFF0FFFF2');if(hasProperInterior)
im.setAtLeast('1FFFFF1FF');}else if(dimA===1&&dimB===2){if(hasProper)
im.setAtLeast('F0FFFFFF2');if(hasProperInterior)
im.setAtLeast('1F1FFFFFF');}
else if(dimA===1&&dimB===1){if(hasProperInterior)
im.setAtLeast('0FFFFFFFF');}};jsts.operation.relate.RelateComputer.prototype.copyNodesAndLabels=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateComputer.prototype.computeIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.labelIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.find(ei.coord);if(n.getLabel().isNull(argIndex)){if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.computeDisjointIM=function(im){var ga=this.arg[0].getGeometry();if(!ga.isEmpty()){im.set(Location.INTERIOR,Location.EXTERIOR,ga.getDimension());im.set(Location.BOUNDARY,Location.EXTERIOR,ga.getBoundaryDimension());}
var gb=this.arg[1].getGeometry();if(!gb.isEmpty()){im.set(Location.EXTERIOR,Location.INTERIOR,gb.getDimension());im.set(Location.EXTERIOR,Location.BOUNDARY,gb.getBoundaryDimension());}};jsts.operation.relate.RelateComputer.prototype.labelNodeEdges=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.getEdges().computeLabelling(this.arg);}};jsts.operation.relate.RelateComputer.prototype.updateIM=function(im){for(var ei=this.isolatedEdges.iterator();ei.hasNext();){var e=ei.next();e.updateIM(im);}
for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.updateIM(im);node.updateIMFromEdges(im);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdges=function(thisIndex,targetIndex){for(var ei=this.arg[thisIndex].getEdgeIterator();ei.hasNext();){var e=ei.next();if(e.isIsolated()){this.labelIsolatedEdge(e,targetIndex,this.arg[targetIndex].getGeometry());this.isolatedEdges.add(e);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdge=function(e,targetIndex,target){if(target.getDimension()>0){var loc=this.ptLocator.locate(e.getCoordinate(),target);e.getLabel().setAllLocations(targetIndex,loc);}else{e.getLabel().setAllLocations(targetIndex,Location.EXTERIOR);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNodes=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();Assert.isTrue(label.getGeometryCount()>0,'node with empty label found');if(n.isIsolated()){if(label.isNull(0))
this.labelIsolatedNode(n,0);else
this.labelIsolatedNode(n,1);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setAllLocations(targetIndex,loc);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.GraphComponent=function(label){this.label=label;};jsts.geomgraph.GraphComponent.prototype.label=null;jsts.geomgraph.GraphComponent.prototype._isInResult=false;jsts.geomgraph.GraphComponent.prototype._isCovered=false;jsts.geomgraph.GraphComponent.prototype._isCoveredSet=false;jsts.geomgraph.GraphComponent.prototype._isVisited=false;jsts.geomgraph.GraphComponent.prototype.getLabel=function(){return this.label;};jsts.geomgraph.GraphComponent.prototype.setLabel=function(label){if(arguments.length===2){this.setLabel2.apply(this,arguments);return;}
this.label=label;};jsts.geomgraph.GraphComponent.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.GraphComponent.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.GraphComponent.prototype.setCovered=function(isCovered){this._isCovered=isCovered;this._isCoveredSet=true;};jsts.geomgraph.GraphComponent.prototype.isCovered=function(){return this._isCovered;};jsts.geomgraph.GraphComponent.prototype.isCoveredSet=function(){return this._isCoveredSet;};jsts.geomgraph.GraphComponent.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.GraphComponent.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.computeIM=function(im){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.isIsolated=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.updateIM=function(im){Assert.isTrue(this.label.getGeometryCount()>=2,'found partial label');this.computeIM(im);};})();jsts.geomgraph.Node=function(coord,edges){this.coord=coord;this.edges=edges;this.label=new jsts.geomgraph.Label(0,jsts.geom.Location.NONE);};jsts.geomgraph.Node.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Node.prototype.coord=null;jsts.geomgraph.Node.prototype.edges=null;jsts.geomgraph.Node.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.Node.prototype.setLabel2=function(argIndex,onLocation){if(this.label===null){this.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
this.label.setLocation(argIndex,onLocation);};jsts.geomgraph.Node.prototype.setLabelBoundary=function(argIndex){var loc=jsts.geom.Location.NONE;if(this.label!==null)
loc=this.label.getLocation(argIndex);var newLoc;switch(loc){case jsts.geom.Location.BOUNDARY:newLoc=jsts.geom.Location.INTERIOR;break;case jsts.geom.Location.INTERIOR:newLoc=jsts.geom.Location.BOUNDARY;break;default:newLoc=jsts.geom.Location.BOUNDARY;break;}
this.label.setLocation(argIndex,newLoc);};jsts.geomgraph.Node.prototype.add=function(e){this.edges.insert(e);e.setNode(this);};jsts.geomgraph.Node.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.Node.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.Node.prototype.isIncidentEdgeInResult=function(){for(var it=this.getEdges().getEdges().iterator();it.hasNext();){var de=it.next();if(de.getEdge().isInResult())
return true;}
return false;};jsts.geom.Point=function(coordinate,factory){this.factory=factory;if(coordinate===undefined)
return;this.coordinate=coordinate;};jsts.geom.Point.prototype=new jsts.geom.Geometry();jsts.geom.Point.constructor=jsts.geom.Point;jsts.geom.Point.CLASS_NAME='jsts.geom.Point';jsts.geom.Point.prototype.coordinate=null;jsts.geom.Point.prototype.getX=function(){return this.coordinate.x;};jsts.geom.Point.prototype.getY=function(){return this.coordinate.y;};jsts.geom.Point.prototype.getCoordinate=function(){return this.coordinate;};jsts.geom.Point.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.getCoordinateSequence=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.isEmpty=function(){return this.coordinate===null;};jsts.geom.Point.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.equal(other.getCoordinate(),this.getCoordinate(),tolerance);};jsts.geom.Point.prototype.getNumPoints=function(){return this.isEmpty()?0:1;};jsts.geom.Point.prototype.isSimple=function(){return true;};jsts.geom.Point.prototype.getBoundary=function(){return new jsts.geom.GeometryCollection(null);};jsts.geom.Point.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
return new jsts.geom.Envelope(this.coordinate);};jsts.geom.Point.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){if(this.isEmpty()){return;}
filter.filter(this.getCoordinate());}};jsts.geom.Point.prototype.clone=function(){return new jsts.geom.Point(this.coordinate.clone(),this.factory);};jsts.geom.Point.prototype.getDimension=function(){return 0;};jsts.geom.Point.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.Point.prototype.reverse=function(){return this.clone();};jsts.geom.Point.prototype.isValid=function(){if(!jsts.operation.valid.IsValidOp.isValid(this.getCoordinate())){return false;}
return true;};jsts.geom.Point.prototype.normalize=function(){};jsts.geom.Point.prototype.compareToSameClass=function(other){var point=other;return this.getCoordinate().compareTo(point.getCoordinate());};jsts.geom.Point.prototype.getGeometryType=function(){return'Point';};jsts.geom.Point.prototype.hashCode=function(){return'Point_'+this.coordinate.hashCode();};jsts.geom.Point.prototype.CLASS_NAME='jsts.geom.Point';jsts.geom.Dimension=function(){};jsts.geom.Dimension.P=0;jsts.geom.Dimension.L=1;jsts.geom.Dimension.A=2;jsts.geom.Dimension.FALSE=-1;jsts.geom.Dimension.TRUE=-2;jsts.geom.Dimension.DONTCARE=-3;jsts.geom.Dimension.toDimensionSymbol=function(dimensionValue){switch(dimensionValue){case jsts.geom.Dimension.FALSE:return'F';case jsts.geom.Dimension.TRUE:return'T';case jsts.geom.Dimension.DONTCARE:return'*';case jsts.geom.Dimension.P:return'0';case jsts.geom.Dimension.L:return'1';case jsts.geom.Dimension.A:return'2';}
throw new jsts.IllegalArgumentError('Unknown dimension value: '+
dimensionValue);};jsts.geom.Dimension.toDimensionValue=function(dimensionSymbol){switch(dimensionSymbol.toUpperCase()){case'F':return jsts.geom.Dimension.FALSE;case'T':return jsts.geom.Dimension.TRUE;case'*':return jsts.geom.Dimension.DONTCARE;case'0':return jsts.geom.Dimension.P;case'1':return jsts.geom.Dimension.L;case'2':return jsts.geom.Dimension.A;}
throw new jsts.error.IllegalArgumentError('Unknown dimension symbol: '+
dimensionSymbol);};(function(){var Dimension=jsts.geom.Dimension;jsts.geom.LineString=function(points,factory){this.factory=factory;this.points=points||[];};jsts.geom.LineString.prototype=new jsts.geom.Geometry();jsts.geom.LineString.constructor=jsts.geom.LineString;jsts.geom.LineString.prototype.points=null;jsts.geom.LineString.prototype.getCoordinates=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateSequence=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateN=function(n){return this.points[n];};jsts.geom.LineString.prototype.getCoordinate=function(){if(this.isEmpty()){return null;}
return this.getCoordinateN(0);};jsts.geom.LineString.prototype.getDimension=function(){return 1;};jsts.geom.LineString.prototype.getBoundaryDimension=function(){if(this.isClosed()){return Dimension.FALSE;}
return 0;};jsts.geom.LineString.prototype.isEmpty=function(){return this.points.length===0;};jsts.geom.LineString.prototype.getNumPoints=function(){return this.points.length;};jsts.geom.LineString.prototype.getPointN=function(n){return this.getFactory().createPoint(this.points[n]);};jsts.geom.LineString.prototype.getStartPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(0);};jsts.geom.LineString.prototype.getEndPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(this.getNumPoints()-1);};jsts.geom.LineString.prototype.isClosed=function(){if(this.isEmpty()){return false;}
return this.getCoordinateN(0).equals2D(this.getCoordinateN(this.points.length-1));};jsts.geom.LineString.prototype.isRing=function(){return this.isClosed()&&this.isSimple();};jsts.geom.LineString.prototype.getGeometryType=function(){return'LineString';};jsts.geom.LineString.prototype.getLength=function(){return jsts.algorithm.CGAlgorithms.computeLength(this.points);};jsts.geom.LineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.LineString.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
var env=new jsts.geom.Envelope();this.points.forEach(function(component){env.expandToInclude(component);});return env;};jsts.geom.LineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.points.length!==other.points.length){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.points.reduce(function(equal,point,i){return equal&&jsts.geom.Geometry.prototype.equal(point,other.points[i],tolerance);});};jsts.geom.LineString.prototype.isEquivalentClass=function(other){return other instanceof jsts.geom.LineString;};jsts.geom.LineString.prototype.compareToSameClass=function(o){var line=o;var i=0,il=this.points.length;var j=0,jl=line.points.length;while(i<il&&j<jl){var comparison=this.points[i].compareTo(line.points[j]);if(comparison!==0){return comparison;}
i++;j++;}
if(i<il){return 1;}
if(j<jl){return-1;}
return 0;};jsts.geom.LineString.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.points.length;i<len;i++){filter.filter(this.points[i]);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.LineString.prototype.apply2=function(filter){if(this.points.length===0)
return;for(var i=0;i<this.points.length;i++){filter.filter(this.points,i);if(filter.isDone())
break;}
if(filter.isGeometryChanged()){}};jsts.geom.LineString.prototype.clone=function(){var points=[];for(var i=0,len=this.points.length;i<len;i++){points.push(this.points[i].clone());}
return this.factory.createLineString(points);};jsts.geom.LineString.prototype.normalize=function(){var i,il,j,ci,cj,len;len=this.points.length;il=parseInt(len/2);for(i=0;i<il;i++){j=len-1-i;ci=this.points[i];cj=this.points[j];if(!ci.equals(cj)){if(ci.compareTo(cj)>0){this.points.reverse();}
return;}}};jsts.geom.LineString.prototype.CLASS_NAME='jsts.geom.LineString';})();(function(){jsts.geom.Polygon=function(shell,holes,factory){this.shell=shell||factory.createLinearRing(null);this.holes=holes||[];this.factory=factory;};jsts.geom.Polygon.prototype=new jsts.geom.Geometry();jsts.geom.Polygon.constructor=jsts.geom.Polygon;jsts.geom.Polygon.prototype.getCoordinate=function(){return this.shell.getCoordinate();};jsts.geom.Polygon.prototype.getCoordinates=function(){if(this.isEmpty()){return[];}
var coordinates=[];var k=-1;var shellCoordinates=this.shell.getCoordinates();for(var x=0;x<shellCoordinates.length;x++){k++;coordinates[k]=shellCoordinates[x];}
for(var i=0;i<this.holes.length;i++){var childCoordinates=this.holes[i].getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.Polygon.prototype.getNumPoints=function(){var numPoints=this.shell.getNumPoints();for(var i=0;i<this.holes.length;i++){numPoints+=this.holes[i].getNumPoints();}
return numPoints;};jsts.geom.Polygon.prototype.isEmpty=function(){return this.shell.isEmpty();};jsts.geom.Polygon.prototype.isRectangle=function(){if(this.getNumInteriorRing()!=0)return false;if(this.shell==null)return false;if(this.shell.getNumPoints()!=5)return false;var seq=this.shell.getCoordinateSequence();var env=this.getEnvelopeInternal();for(var i=0;i<5;i++){var x=seq[i].x;if(!(x==env.getMinX()||x==env.getMaxX()))return false;var y=seq[i].y;if(!(y==env.getMinY()||y==env.getMaxY()))return false;}
var prevX=seq[0].x;var prevY=seq[0].y;for(var i=1;i<=4;i++){var x=seq[i].x;var y=seq[i].y;var xChanged=x!=prevX;var yChanged=y!=prevY;if(xChanged==yChanged)
return false;prevX=x;prevY=y;}
return true;};jsts.geom.Polygon.prototype.getExteriorRing=function(){return this.shell;};jsts.geom.Polygon.prototype.getInteriorRingN=function(n){return this.holes[n];};jsts.geom.Polygon.prototype.getNumInteriorRing=function(){return this.holes.length;};jsts.geom.Polygon.prototype.getArea=function(){var area=0.0;area+=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.shell.getCoordinateSequence()));for(var i=0;i<this.holes.length;i++){area-=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.holes[i].getCoordinateSequence()));}
return area;};jsts.geom.Polygon.prototype.getLength=function(){var len=0.0;len+=this.shell.getLength();for(var i=0;i<this.holes.length;i++){len+=this.holes[i].getLength();}
return len;};jsts.geom.Polygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var rings=[];rings[0]=this.shell.clone();for(var i=0,len=this.holes.length;i<len;i++){rings[i+1]=this.holes[i].clone();}
if(rings.length<=1)
return rings[0];return this.getFactory().createMultiLineString(rings);};jsts.geom.Polygon.prototype.computeEnvelopeInternal=function(){return this.shell.getEnvelopeInternal();};jsts.geom.Polygon.prototype.getDimension=function(){return 2;};jsts.geom.Polygon.prototype.getBoundaryDimension=function(){return 1;};jsts.geom.Polygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
if(this.isEmpty()!==other.isEmpty()){return false;}
if(!this.shell.equalsExact(other.shell,tolerance)){return false;}
if(this.holes.length!==other.holes.length){return false;}
if(this.holes.length!==other.holes.length){return false;}
for(var i=0;i<this.holes.length;i++){if(!(this.holes[i]).equalsExact(other.holes[i],tolerance)){return false;}}
return true;};jsts.geom.Polygon.prototype.compareToSameClass=function(o){return this.shell.compareToSameClass(o.shell);};jsts.geom.Polygon.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.GeometryFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.Polygon.prototype.apply2=function(filter){this.shell.apply(filter);if(!filter.isDone()){for(var i=0;i<this.holes.length;i++){this.holes[i].apply(filter);if(filter.isDone())
break;}}
if(filter.isGeometryChanged()){}};jsts.geom.Polygon.prototype.clone=function(){var holes=[];for(var i=0,len=this.holes.length;i<len;i++){holes.push(this.holes[i].clone());}
return this.factory.createPolygon(this.shell.clone(),holes);};jsts.geom.Polygon.prototype.normalize=function(){this.normalize2(this.shell,true);for(var i=0,len=this.holes.length;i<len;i++){this.normalize2(this.holes[i],false);}
this.holes.sort();};jsts.geom.Polygon.prototype.normalize2=function(ring,clockwise){if(ring.isEmpty()){return;}
var uniqueCoordinates=ring.points.slice(0,ring.points.length-1);var minCoordinate=jsts.geom.CoordinateArrays.minCoordinate(ring.points);jsts.geom.CoordinateArrays.scroll(uniqueCoordinates,minCoordinate);ring.points=uniqueCoordinates.concat();ring.points[uniqueCoordinates.length]=uniqueCoordinates[0];if(jsts.algorithm.CGAlgorithms.isCCW(ring.points)===clockwise){ring.points.reverse();}};jsts.geom.Polygon.prototype.getGeometryType=function(){return'Polygon';};jsts.geom.Polygon.prototype.CLASS_NAME='jsts.geom.Polygon';})();(function(){var Geometry=jsts.geom.Geometry;var TreeSet=javascript.util.TreeSet;var Arrays=javascript.util.Arrays;jsts.geom.GeometryCollection=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.GeometryCollection.prototype=new Geometry();jsts.geom.GeometryCollection.constructor=jsts.geom.GeometryCollection;jsts.geom.GeometryCollection.prototype.isEmpty=function(){for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.isEmpty()){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.getArea=function(){var area=0.0;for(var i=0,len=this.geometries.length;i<len;i++){area+=this.getGeometryN(i).getArea();}
return area;};jsts.geom.GeometryCollection.prototype.getLength=function(){var length=0.0;for(var i=0,len=this.geometries.length;i<len;i++){length+=this.getGeometryN(i).getLength();}
return length;};jsts.geom.GeometryCollection.prototype.getCoordinate=function(){if(this.isEmpty())
return null;return this.getGeometryN(0).getCoordinate();};jsts.geom.GeometryCollection.prototype.getCoordinates=function(){var coordinates=[];var k=-1;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);var childCoordinates=geometry.getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.GeometryCollection.prototype.getNumGeometries=function(){return this.geometries.length;};jsts.geom.GeometryCollection.prototype.getGeometryN=function(n){var geometry=this.geometries[n];if(geometry instanceof jsts.geom.Coordinate){geometry=new jsts.geom.Point(geometry);}
return geometry;};jsts.geom.GeometryCollection.prototype.getNumPoints=function(n){var numPoints=0;for(var i=0;i<this.geometries.length;i++){numPoints+=this.geometries[i].getNumPoints();}
return numPoints;}
jsts.geom.GeometryCollection.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.geometries.length!==other.geometries.length){return false;}
for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.equalsExact(other.getGeometryN(i),tolerance)){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.clone=function(){var geometries=[];for(var i=0,len=this.geometries.length;i<len;i++){geometries.push(this.geometries[i].clone());}
return this.factory.createGeometryCollection(geometries);};jsts.geom.GeometryCollection.prototype.normalize=function(){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).normalize();}
this.geometries.sort();};jsts.geom.GeometryCollection.prototype.compareToSameClass=function(o){var theseElements=new TreeSet(Arrays.asList(this.geometries));var otherElements=new TreeSet(Arrays.asList(o.geometries));return this.compare(theseElements,otherElements);};jsts.geom.GeometryCollection.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.GeometryCollection.prototype.apply2=function(filter){if(this.geometries.length==0)
return;for(var i=0;i<this.geometries.length;i++){this.geometries[i].apply(filter);if(filter.isDone()){break;}}
if(filter.isGeometryChanged()){}};jsts.geom.GeometryCollection.prototype.getDimension=function(){var dimension=jsts.geom.Dimension.FALSE;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);dimension=Math.max(dimension,geometry.getDimension());}
return dimension;};jsts.geom.GeometryCollection.prototype.computeEnvelopeInternal=function(){var envelope=new jsts.geom.Envelope();for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);envelope.expandToInclude(geometry.getEnvelopeInternal());}
return envelope;};jsts.geom.GeometryCollection.prototype.CLASS_NAME='jsts.geom.GeometryCollection';})();jsts.algorithm.Centroid=function(geometry){this.areaBasePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.areasum2=0;this.cg3=new jsts.geom.Coordinate();this.lineCentSum=new jsts.geom.Coordinate();this.totalLength=0;this.ptCount=0;this.ptCentSum=new jsts.geom.Coordinate();this.add(geometry);};jsts.algorithm.Centroid.getCentroid=function(geometry){var cent=new jsts.algorithm.Centroid(geometry);return cent.getCentroid();};jsts.algorithm.Centroid.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;};jsts.algorithm.Centroid.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.Centroid.prototype.add=function(geom){if(geom.isEmpty()){return;}
if(geom instanceof jsts.geom.Point){this.addPoint(geom.getCoordinate());}else if(geom instanceof jsts.geom.LineString){this.addLineSegments(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){this.addPolygon(geom);}else if(geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){this.add(geom.getGeometryN(i));}}};jsts.algorithm.Centroid.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else if(this.totalLength>0){cent.x=this.lineCentSum.x/this.totalLength;cent.y=this.lineCentSum.y/this.totalLength;}else if(this.ptCount>0){cent.x=this.ptCentSum.x/this.ptCount;cent.y=this.ptCentSum.y/this.ptCount;}else{return null;}
return cent;};jsts.algorithm.Centroid.prototype.setBasePoint=function(basePt){if(this.areaBasePt===null){this.areaBasePt=basePt;}};jsts.algorithm.Centroid.prototype.addPolygon=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.Centroid.prototype.addShell=function(pts){if(pts.length>0){this.setBasePoint(pts[0]);}
var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1:-1;jsts.algorithm.Centroid.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.Centroid.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.Centroid.prototype.addLineSegments=function(pts){var lineLen=0;for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);if(segmentLen===0){continue;}
lineLen+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.lineCentSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.lineCentSum.y+=segmentLen*midy;}
this.totalLength+=lineLen;if(lineLen===0&&pts.length>0){this.addPoint(pts[0]);}};jsts.algorithm.Centroid.prototype.addPoint=function(pt){this.ptCount+=1;this.ptCentSum.x+=pt.x;this.ptCentSum.y+=pt.y;};(function(){var EdgeRing=function(factory){this.deList=new javascript.util.ArrayList();this.factory=factory;};EdgeRing.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var it=shellList.iterator();it.hasNext();){var tryShell=it.next();var tryRing=tryShell.getRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!=null)
minEnv=minShell.getRing().getEnvelopeInternal();var isContained=false;if(tryEnv.equals(testEnv))
continue;testPt=jsts.geom.CoordinateArrays.ptNotInList(testRing.getCoordinates(),tryRing.getCoordinates());if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};EdgeRing.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(!isInList(testPt,pts))
return testPt;}
return null;};EdgeRing.isInList=function(pt,pts){for(var i=0;i<pts.length;i++){if(pt.equals(pts[i]))
return true;}
return false;}
EdgeRing.prototype.factory=null;EdgeRing.prototype.deList=null;EdgeRing.prototype.ring=null;EdgeRing.prototype.ringPts=null;EdgeRing.prototype.holes=null;EdgeRing.prototype.add=function(de){this.deList.add(de);};EdgeRing.prototype.isHole=function(){var ring=this.getRing();return jsts.algorithm.CGAlgorithms.isCCW(ring.getCoordinates());};EdgeRing.prototype.addHole=function(hole){if(this.holes==null)
this.holes=new javascript.util.ArrayList();this.holes.add(hole);};EdgeRing.prototype.getPolygon=function(){var holeLR=null;if(this.holes!=null){holeLR=[];for(var i=0;i<this.holes.size();i++){holeLR[i]=this.holes.get(i);}}
var poly=this.factory.createPolygon(this.ring,holeLR);return poly;};EdgeRing.prototype.isValid=function(){this.getCoordinates();if(this.ringPts.length<=3)
return false;this.getRing();return this.ring.isValid();};EdgeRing.prototype.getCoordinates=function(){if(this.ringPts==null){var coordList=new jsts.geom.CoordinateList();for(var i=this.deList.iterator();i.hasNext();){var de=i.next();var edge=de.getEdge();EdgeRing.addEdge(edge.getLine().getCoordinates(),de.getEdgeDirection(),coordList);}
this.ringPts=coordList.toCoordinateArray();}
return this.ringPts;};EdgeRing.prototype.getLineString=function(){this.getCoordinates();return this.factory.createLineString(this.ringPts);};EdgeRing.prototype.getRing=function(){if(this.ring!=null)
return this.ring;this.getCoordinates();if(this.ringPts.length<3)
console.log(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts);}catch(ex){console.log(this.ringPts);}
return this.ring;};EdgeRing.addEdge=function(coords,isForward,coordList){if(isForward){for(var i=0;i<coords.length;i++){coordList.add(coords[i],false);}}else{for(var i=coords.length-1;i>=0;i--){coordList.add(coords[i],false);}}};jsts.operation.polygonize.EdgeRing=EdgeRing;})();(function(){var GraphComponent=function(){};GraphComponent.setVisited=function(i,visited){while(i.hasNext()){var comp=i.next();comp.setVisited(visited);}};GraphComponent.setMarked=function(i,marked){while(i.hasNext()){var comp=i.next();comp.setMarked(marked);}};GraphComponent.getComponentWithVisitedState=function(i,visitedState){while(i.hasNext()){var comp=i.next();if(comp.isVisited()==visitedState)
return comp;}
return null;};GraphComponent.prototype._isMarked=false;GraphComponent.prototype._isVisited=false;GraphComponent.prototype.data;GraphComponent.prototype.isVisited=function(){return this._isVisited;};GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};GraphComponent.prototype.isMarked=function(){return this._isMarked;};GraphComponent.prototype.setMarked=function(isMarked){this._isMarked=isMarked;};GraphComponent.prototype.setContext=function(data){this.data=data;};GraphComponent.prototype.getContext=function(){return data;};GraphComponent.prototype.setData=function(data){this.data=data;};GraphComponent.prototype.getData=function(){return data;};GraphComponent.prototype.isRemoved=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.planargraph.GraphComponent=GraphComponent;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var Edge=function(de0,de1){if(de0===undefined){return;}
this.setDirectedEdges(de0,de1);};Edge.prototype=new GraphComponent();Edge.prototype.dirEdge=null;Edge.prototype.setDirectedEdges=function(de0,de1){this.dirEdge=[de0,de1];de0.setEdge(this);de1.setEdge(this);de0.setSym(de1);de1.setSym(de0);de0.getFromNode().addOutEdge(de0);de1.getFromNode().addOutEdge(de1);};Edge.prototype.getDirEdge=function(i){if(i instanceof jsts.planargraph.Node){this.getDirEdge2(i);}
return this.dirEdge[i];};Edge.prototype.getDirEdge2=function(fromNode){if(this.dirEdge[0].getFromNode()==fromNode)
return this.dirEdge[0];if(this.dirEdge[1].getFromNode()==fromNode)
return this.dirEdge[1];return null;};Edge.prototype.getOppositeNode=function(node){if(this.dirEdge[0].getFromNode()==node)
return this.dirEdge[0].getToNode();if(this.dirEdge[1].getFromNode()==node)
return this.dirEdge[1].getToNode();return null;};Edge.prototype.remove=function(){this.dirEdge=null;};Edge.prototype.isRemoved=function(){return dirEdge==null;};jsts.planargraph.Edge=Edge;})();jsts.operation.polygonize.PolygonizeEdge=function(line){this.line=line;};jsts.operation.polygonize.PolygonizeEdge.prototype=new jsts.planargraph.Edge();jsts.operation.polygonize.PolygonizeEdge.prototype.line=null;jsts.operation.polygonize.PolygonizeEdge.prototype.getLine=function(){return this.line;};(function(){var ArrayList=javascript.util.ArrayList;var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdge=function(from,to,directionPt,edgeDirection){if(from===undefined){return;}
this.from=from;this.to=to;this.edgeDirection=edgeDirection;this.p0=from.getCoordinate();this.p1=directionPt;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(dx,dy);this.angle=Math.atan2(dy,dx);};DirectedEdge.prototype=new GraphComponent();DirectedEdge.toEdges=function(dirEdges){var edges=new ArrayList();for(var i=dirEdges.iterator();i.hasNext();){edges.add((i.next()).parentEdge);}
return edges;};DirectedEdge.prototype.parentEdge=null;DirectedEdge.prototype.from=null;DirectedEdge.prototype.to=null;DirectedEdge.prototype.p0=null;DirectedEdge.prototype.p1=null;DirectedEdge.prototype.sym=null;DirectedEdge.prototype.edgeDirection=null;DirectedEdge.prototype.quadrant=null;DirectedEdge.prototype.angle=null;DirectedEdge.prototype.getEdge=function(){return this.parentEdge;};DirectedEdge.prototype.setEdge=function(parentEdge){this.parentEdge=parentEdge;};DirectedEdge.prototype.getQuadrant=function(){return this.quadrant;};DirectedEdge.prototype.getDirectionPt=function(){return this.p1;};DirectedEdge.prototype.getEdgeDirection=function(){return this.edgeDirection;};DirectedEdge.prototype.getFromNode=function(){return this.from;};DirectedEdge.prototype.getToNode=function(){return this.to;};DirectedEdge.prototype.getCoordinate=function(){return this.from.getCoordinate();};DirectedEdge.prototype.getAngle=function(){return this.angle;};DirectedEdge.prototype.getSym=function(){return this.sym;};DirectedEdge.prototype.setSym=function(sym){this.sym=sym;};DirectedEdge.prototype.remove=function(){this.sym=null;this.parentEdge=null;};DirectedEdge.prototype.isRemoved=function(){return this.parentEdge==null;};DirectedEdge.prototype.compareTo=function(obj){var de=obj;return this.compareDirection(de);};DirectedEdge.prototype.compareDirection=function(e){if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.planargraph.DirectedEdge=DirectedEdge;})();(function(){var DirectedEdge=jsts.planargraph.DirectedEdge;var PolygonizeDirectedEdge=function(from,to,directionPt,edgeDirection){DirectedEdge.apply(this,arguments);};PolygonizeDirectedEdge.prototype=new DirectedEdge();PolygonizeDirectedEdge.prototype.edgeRing=null;PolygonizeDirectedEdge.prototype.next=null;PolygonizeDirectedEdge.prototype.label=-1;PolygonizeDirectedEdge.prototype.getLabel=function(){return this.label;};PolygonizeDirectedEdge.prototype.setLabel=function(label){this.label=label;};PolygonizeDirectedEdge.prototype.getNext=function(){return this.next;};PolygonizeDirectedEdge.prototype.setNext=function(next){this.next=next;};PolygonizeDirectedEdge.prototype.isInRing=function(){return this.edgeRing!=null;};PolygonizeDirectedEdge.prototype.setRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.operation.polygonize.PolygonizeDirectedEdge=PolygonizeDirectedEdge;})();(function(){var ArrayList=javascript.util.ArrayList;var DirectedEdgeStar=function(){this.outEdges=new ArrayList();};DirectedEdgeStar.prototype.outEdges=null;DirectedEdgeStar.prototype.sorted=false;DirectedEdgeStar.prototype.add=function(de){this.outEdges.add(de);this.sorted=false;};DirectedEdgeStar.prototype.remove=function(de){this.outEdges.remove(de);};DirectedEdgeStar.prototype.iterator=function(){this.sortEdges();return this.outEdges.iterator();};DirectedEdgeStar.prototype.getDegree=function(){return this.outEdges.size();};DirectedEdgeStar.prototype.getCoordinate=function(){var it=iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};DirectedEdgeStar.prototype.getEdges=function(){this.sortEdges();return this.outEdges;};DirectedEdgeStar.prototype.sortEdges=function(){if(!this.sorted){var array=this.outEdges.toArray();array.sort(function(a,b){return a.compareTo(b);});this.outEdges=javascript.util.Arrays.asList(array);this.sorted=true;}};DirectedEdgeStar.prototype.getIndex=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.getIndex2(edge);}else if(typeof(edge)==='number'){return this.getIndex3(edge);}
this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de.getEdge()==edge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex2=function(dirEdge){this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de==dirEdge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex3=function(i){var modi=toInt(i%this.outEdges.size());if(modi<0)
modi+=this.outEdges.size();return modi;};DirectedEdgeStar.prototype.getNextEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i+1));};DirectedEdgeStar.prototype.getNextCWEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i-1));};jsts.planargraph.DirectedEdgeStar=DirectedEdgeStar;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdgeStar=jsts.planargraph.DirectedEdgeStar;var Node=function(pt,deStar){this.pt=pt;this.deStar=deStar||new DirectedEdgeStar();};Node.prototype=new GraphComponent();Node.getEdgesBetween=function(node0,node1){var edges0=DirectedEdge.toEdges(node0.getOutEdges().getEdges());var commonEdges=new javascript.util.HashSet(edges0);var edges1=DirectedEdge.toEdges(node1.getOutEdges().getEdges());commonEdges.retainAll(edges1);return commonEdges;};Node.prototype.pt=null;Node.prototype.deStar=null;Node.prototype.getCoordinate=function(){return this.pt;};Node.prototype.addOutEdge=function(de){this.deStar.add(de);};Node.prototype.getOutEdges=function(){return this.deStar;};Node.prototype.getDegree=function(){return this.deStar.getDegree();};Node.prototype.getIndex=function(edge){return this.deStar.getIndex(edge);};Node.prototype.remove=function(de){if(de===undefined){return this.remove2();}
this.deStar.remove(de);};Node.prototype.remove2=function(){this.pt=null;};Node.prototype.isRemoved=function(){return this.pt==null;};jsts.planargraph.Node=Node;})();(function(){var NodeMap=function(){this.nodeMap=new javascript.util.TreeMap();};NodeMap.prototype.nodeMap=null;NodeMap.prototype.add=function(n){this.nodeMap.put(n.getCoordinate(),n);return n;};NodeMap.prototype.remove=function(pt){return this.nodeMap.remove(pt);};NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};NodeMap.prototype.iterator=function(){return this.nodeMap.values().iterator();};NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.planargraph.NodeMap=NodeMap;})();(function(){var ArrayList=javascript.util.ArrayList;var PlanarGraph=function(){this.edges=new javascript.util.HashSet();this.dirEdges=new javascript.util.HashSet();this.nodeMap=new jsts.planargraph.NodeMap();};PlanarGraph.prototype.edges=null;PlanarGraph.prototype.dirEdges=null;PlanarGraph.prototype.nodeMap=null;PlanarGraph.prototype.findNode=function(pt){return this.nodeMap.find(pt);};PlanarGraph.prototype.add=function(node){if(node instanceof jsts.planargraph.Edge){return this.add2(node);}else if(node instanceof jsts.planargraph.DirectedEdge){return this.add3(node);}
this.nodeMap.add(node);};PlanarGraph.prototype.add2=function(edge){this.edges.add(edge);this.add(edge.getDirEdge(0));this.add(edge.getDirEdge(1));};PlanarGraph.prototype.add3=function(dirEdge){this.dirEdges.add(dirEdge);};PlanarGraph.prototype.nodeIterator=function(){return this.nodeMap.iterator();};PlanarGraph.prototype.contains=function(e){if(e instanceof jsts.planargraph.DirectedEdge){return this.contains2(e);}
return this.edges.contains(e);};PlanarGraph.prototype.contains2=function(de){return this.dirEdges.contains(de);};PlanarGraph.prototype.getNodes=function(){return this.nodeMap.values();};PlanarGraph.prototype.dirEdgeIterator=function(){return this.dirEdges.iterator();};PlanarGraph.prototype.edgeIterator=function(){return this.edges.iterator();};PlanarGraph.prototype.getEdges=function(){return this.edges;};PlanarGraph.prototype.remove=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.remove2(edge);}
this.remove(edge.getDirEdge(0));this.remove(edge.getDirEdge(1));this.edges.remove(edge);this.edge.remove();};PlanarGraph.prototype.remove2=function(de){if(de instanceof jsts.planargraph.Node){return this.remove3(de);}
var sym=de.getSym();if(sym!=null)
sym.setSym(null);de.getFromNode().remove(de);de.remove();this.dirEdges.remove(de);};PlanarGraph.prototype.remove3=function(node){var outEdges=node.getOutEdges().getEdges();for(var i=outEdges.iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym!=null)
this.remove(sym);this.dirEdges.remove(de);var edge=de.getEdge();if(edge!=null){this.edges.remove(edge);}}
this.nodeMap.remove(node.getCoordinate());node.remove();};PlanarGraph.prototype.findNodesOfDegree=function(degree){var nodesFound=new ArrayList();for(var i=this.nodeIterator();i.hasNext();){var node=i.next();if(node.getDegree()==degree)
nodesFound.add(node);}
return nodesFound;};jsts.planargraph.PlanarGraph=PlanarGraph;})();(function(){var ArrayList=javascript.util.ArrayList;var Stack=javascript.util.Stack;var HashSet=javascript.util.HashSet;var Assert=jsts.util.Assert;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeEdge=jsts.operation.polygonize.PolygonizeEdge;var PolygonizeDirectedEdge=jsts.operation.polygonize.PolygonizeDirectedEdge;var PlanarGraph=jsts.planargraph.PlanarGraph;var Node=jsts.planargraph.Node;var PolygonizeGraph=function(factory){PlanarGraph.apply(this);this.factory=factory;};PolygonizeGraph.prototype=new PlanarGraph();PolygonizeGraph.getDegreeNonDeleted=function(node){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(!de.isMarked())
degree++;}
return degree;};PolygonizeGraph.getDegree=function(node,label){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(de.getLabel()==label)
degree++;}
return degree;};PolygonizeGraph.deleteAllEdges=function(node){var edges=node.getOutEdges().getEdges();for(var i=edges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);}};PolygonizeGraph.prototype.factory=null;PolygonizeGraph.prototype.addEdge=function(line){if(line.isEmpty()){return;}
var linePts=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(linePts.length<2){return;}
var startPt=linePts[0];var endPt=linePts[linePts.length-1];var nStart=this.getNode(startPt);var nEnd=this.getNode(endPt);var de0=new PolygonizeDirectedEdge(nStart,nEnd,linePts[1],true);var de1=new PolygonizeDirectedEdge(nEnd,nStart,linePts[linePts.length-2],false);var edge=new PolygonizeEdge(line);edge.setDirectedEdges(de0,de1);this.add(edge);};PolygonizeGraph.prototype.getNode=function(pt){var node=this.findNode(pt);if(node==null){node=new Node(pt);this.add(node);}
return node;};PolygonizeGraph.prototype.computeNextCWEdges=function(){for(var iNode=this.nodeIterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCWEdges(node);}};PolygonizeGraph.prototype.convertMaximalToMinimalEdgeRings=function(ringEdges){for(var i=ringEdges.iterator();i.hasNext();){var de=i.next();var label=de.getLabel();var intNodes=PolygonizeGraph.findIntersectionNodes(de,label);if(intNodes==null)
continue;for(var iNode=intNodes.iterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCCWEdges(node,label);}}};PolygonizeGraph.findIntersectionNodes=function(startDE,label){var de=startDE;var intNodes=null;do{var node=de.getFromNode();if(PolygonizeGraph.getDegree(node,label)>1){if(intNodes==null)
intNodes=new ArrayList();intNodes.add(node);}
de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return intNodes;};PolygonizeGraph.prototype.getEdgeRings=function(){this.computeNextCWEdges();PolygonizeGraph.label(this.dirEdges,-1);var maximalRings=PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(maximalRings);var edgeRingList=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.isInRing())
continue;var er=this.findEdgeRing(de);edgeRingList.add(er);}
return edgeRingList;};PolygonizeGraph.findLabeledEdgeRings=function(dirEdges){var edgeRingStarts=new ArrayList();var currLabel=1;for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.getLabel()>=0)
continue;edgeRingStarts.add(de);var edges=PolygonizeGraph.findDirEdgesInRing(de);PolygonizeGraph.label(edges,currLabel);currLabel++;}
return edgeRingStarts;};PolygonizeGraph.prototype.deleteCutEdges=function(){this.computeNextCWEdges();PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);var cutLines=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;var sym=de.getSym();if(de.getLabel()==sym.getLabel()){de.setMarked(true);sym.setMarked(true);var e=de.getEdge();cutLines.add(e.getLine());}}
return cutLines;};PolygonizeGraph.label=function(dirEdges,label){for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();de.setLabel(label);}};PolygonizeGraph.computeNextCWEdges=function(node){var deStar=node.getOutEdges();var startDE=null;var prevDE=null;for(var i=deStar.getEdges().iterator();i.hasNext();){var outDE=i.next();if(outDE.isMarked())
continue;if(startDE==null)
startDE=outDE;if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(outDE);}
prevDE=outDE;}
if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(startDE);}};PolygonizeGraph.computeNextCCWEdges=function(node,label){var deStar=node.getOutEdges();var firstOutDE=null;var prevInDE=null;var edges=deStar.getEdges();for(var i=edges.size()-1;i>=0;i--){var de=edges.get(i);var sym=de.getSym();var outDE=null;if(de.getLabel()==label)
outDE=de;var inDE=null;if(sym.getLabel()==label)
inDE=sym;if(outDE==null&&inDE==null)
continue;if(inDE!=null){prevInDE=inDE;}
if(outDE!=null){if(prevInDE!=null){prevInDE.setNext(outDE);prevInDE=null;}
if(firstOutDE==null)
firstOutDE=outDE;}}
if(prevInDE!=null){Assert.isTrue(firstOutDE!=null);prevInDE.setNext(firstOutDE);}};PolygonizeGraph.findDirEdgesInRing=function(startDE){var de=startDE;var edges=new ArrayList();do{edges.add(de);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return edges;};PolygonizeGraph.prototype.findEdgeRing=function(startDE){var de=startDE;var er=new EdgeRing(this.factory);do{er.add(de);de.setRing(er);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return er;};PolygonizeGraph.prototype.deleteDangles=function(){var nodesToRemove=this.findNodesOfDegree(1);var dangleLines=new HashSet();var nodeStack=new Stack();for(var i=nodesToRemove.iterator();i.hasNext();){nodeStack.push(i.next());}
while(!nodeStack.isEmpty()){var node=nodeStack.pop();PolygonizeGraph.deleteAllEdges(node);var nodeOutEdges=node.getOutEdges().getEdges();for(var i=nodeOutEdges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);var e=de.getEdge();dangleLines.add(e.getLine());var toNode=de.getToNode();if(PolygonizeGraph.getDegreeNonDeleted(toNode)==1)
nodeStack.push(toNode);}}
return dangleLines;};PolygonizeGraph.prototype.computeDepthParity=function(){while(true){var de=null;if(de==null)
return;this.computeDepthParity(de);}};PolygonizeGraph.prototype.computeDepthParity=function(de){};jsts.operation.polygonize.PolygonizeGraph=PolygonizeGraph;})();jsts.index.strtree.Interval=function(){var other;if(arguments.length===1){other=arguments[0];return jsts.index.strtree.Interval(other.min,other.max);}else if(arguments.length===2){jsts.util.Assert.isTrue(this.min<=this.max);this.min=arguments[0];this.max=arguments[1];}};jsts.index.strtree.Interval.prototype.min=null;jsts.index.strtree.Interval.prototype.max=null;jsts.index.strtree.Interval.prototype.getCentre=function(){return(this.min+this.max)/2;};jsts.index.strtree.Interval.prototype.expandToInclude=function(other){this.max=Math.max(this.max,other.max);this.min=Math.min(this.min,other.min);return this;};jsts.index.strtree.Interval.prototype.intersects=function(other){return!(other.min>this.max||other.max<this.min);};jsts.index.strtree.Interval.prototype.equals=function(o){if(!(o instanceof jsts.index.strtree.Interval)){return false;}
other=o;return this.min===other.min&&this.max===other.max;};jsts.geom.GeometryFactory=function(precisionModel){this.precisionModel=precisionModel||new jsts.geom.PrecisionModel();};jsts.geom.GeometryFactory.prototype.precisionModel=null;jsts.geom.GeometryFactory.prototype.getPrecisionModel=function(){return this.precisionModel;};jsts.geom.GeometryFactory.prototype.createPoint=function(coordinate){var point=new jsts.geom.Point(coordinate,this);return point;};jsts.geom.GeometryFactory.prototype.createLineString=function(coordinates){var lineString=new jsts.geom.LineString(coordinates,this);return lineString;};jsts.geom.GeometryFactory.prototype.createLinearRing=function(coordinates){var linearRing=new jsts.geom.LinearRing(coordinates,this);return linearRing;};jsts.geom.GeometryFactory.prototype.createPolygon=function(shell,holes){var polygon=new jsts.geom.Polygon(shell,holes,this);return polygon;};jsts.geom.GeometryFactory.prototype.createMultiPoint=function(points){if(points&&points[0]instanceof jsts.geom.Coordinate){var converted=[];var i;for(i=0;i<points.length;i++){converted.push(this.createPoint(points[i]));}
points=converted;}
return new jsts.geom.MultiPoint(points,this);};jsts.geom.GeometryFactory.prototype.createMultiLineString=function(lineStrings){return new jsts.geom.MultiLineString(lineStrings,this);};jsts.geom.GeometryFactory.prototype.createMultiPolygon=function(polygons){return new jsts.geom.MultiPolygon(polygons,this);};jsts.geom.GeometryFactory.prototype.buildGeometry=function(geomList){var geomClass=null;var isHeterogeneous=false;var hasGeometryCollection=false;for(var i=geomList.iterator();i.hasNext();){var geom=i.next();var partClass=geom.CLASS_NAME;if(geomClass===null){geomClass=partClass;}
if(!(partClass===geomClass)){isHeterogeneous=true;}
if(geom.isGeometryCollectionBase())
hasGeometryCollection=true;}
if(geomClass===null){return this.createGeometryCollection(null);}
if(isHeterogeneous||hasGeometryCollection){return this.createGeometryCollection(geomList.toArray());}
var geom0=geomList.get(0);var isCollection=geomList.size()>1;if(isCollection){if(geom0 instanceof jsts.geom.Polygon){return this.createMultiPolygon(geomList.toArray());}else if(geom0 instanceof jsts.geom.LineString){return this.createMultiLineString(geomList.toArray());}else if(geom0 instanceof jsts.geom.Point){return this.createMultiPoint(geomList.toArray());}
jsts.util.Assert.shouldNeverReachHere('Unhandled class: '+geom0);}
return geom0;};jsts.geom.GeometryFactory.prototype.createGeometryCollection=function(geometries){return new jsts.geom.GeometryCollection(geometries,this);};jsts.geom.GeometryFactory.prototype.toGeometry=function(envelope){if(envelope.isNull()){return this.createPoint(null);}
if(envelope.getMinX()===envelope.getMaxX()&&envelope.getMinY()===envelope.getMaxY()){return this.createPoint(new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()));}
if(envelope.getMinX()===envelope.getMaxX()||envelope.getMinY()===envelope.getMaxY()){return this.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY())]);}
return this.createPolygon(this.createLinearRing([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY())]),null);};jsts.geomgraph.NodeFactory=function(){};jsts.geomgraph.NodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,null);};(function(){jsts.geomgraph.Position=function(){};jsts.geomgraph.Position.ON=0;jsts.geomgraph.Position.LEFT=1;jsts.geomgraph.Position.RIGHT=2;jsts.geomgraph.Position.opposite=function(position){if(position===jsts.geomgraph.Position.LEFT){return jsts.geomgraph.Position.RIGHT;}
if(position===jsts.geomgraph.Position.RIGHT){return jsts.geomgraph.Position.LEFT;}
return position;};})();jsts.geomgraph.TopologyLocation=function(){this.location=[];if(arguments.length===3){var on=arguments[0];var left=arguments[1];var right=arguments[2];this.init(3);this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;}else if(arguments[0]instanceof jsts.geomgraph.TopologyLocation){var gl=arguments[0];this.init(gl.location.length);if(gl!=null){for(var i=0;i<this.location.length;i++){this.location[i]=gl.location[i];}}}else if(typeof arguments[0]==='number'){var on=arguments[0];this.init(1);this.location[jsts.geomgraph.Position.ON]=on;}else if(arguments[0]instanceof Array){var location=arguments[0];this.init(location.length);}};jsts.geomgraph.TopologyLocation.prototype.location=null;jsts.geomgraph.TopologyLocation.prototype.init=function(size){this.location[size-1]=null;this.setAllLocations(jsts.geom.Location.NONE);};jsts.geomgraph.TopologyLocation.prototype.get=function(posIndex){if(posIndex<this.location.length)
return this.location[posIndex];return jsts.geom.Location.NONE;};jsts.geomgraph.TopologyLocation.prototype.isNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]!==jsts.geom.Location.NONE)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.isAnyNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
return true;}
return false;};jsts.geomgraph.TopologyLocation.prototype.isEqualOnSide=function(le,locIndex){return this.location[locIndex]==le.location[locIndex];};jsts.geomgraph.TopologyLocation.prototype.isArea=function(){return this.location.length>1;};jsts.geomgraph.TopologyLocation.prototype.isLine=function(){return this.location.length===1;};jsts.geomgraph.TopologyLocation.prototype.flip=function(){if(this.location.length<=1)
return;var temp=this.location[jsts.geomgraph.Position.LEFT];this.location[jsts.geomgraph.Position.LEFT]=this.location[jsts.geomgraph.Position.RIGHT];this.location[jsts.geomgraph.Position.RIGHT]=temp;};jsts.geomgraph.TopologyLocation.prototype.setAllLocations=function(locValue){for(var i=0;i<this.location.length;i++){this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setAllLocationsIfNull=function(locValue){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setLocation=function(locIndex,locValue){if(locValue!==undefined){this.location[locIndex]=locValue;}else{this.setLocation(jsts.geomgraph.Position.ON,locIndex);}};jsts.geomgraph.TopologyLocation.prototype.getLocations=function(){return location;};jsts.geomgraph.TopologyLocation.prototype.setLocations=function(on,left,right){this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;};jsts.geomgraph.TopologyLocation.prototype.allPositionsEqual=function(loc){for(var i=0;i<this.location.length;i++){if(this.location[i]!==loc)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.merge=function(gl){if(gl.location.length>this.location.length){var newLoc=[];newLoc[jsts.geomgraph.Position.ON]=this.location[jsts.geomgraph.Position.ON];newLoc[jsts.geomgraph.Position.LEFT]=jsts.geom.Location.NONE;newLoc[jsts.geomgraph.Position.RIGHT]=jsts.geom.Location.NONE;this.location=newLoc;}
for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE&&i<gl.location.length)
this.location[i]=gl.location[i];}};jsts.geomgraph.Label=function(){this.elt=[];var geomIndex,onLoc,leftLoc,lbl,rightLoc;if(arguments.length===4){geomIndex=arguments[0];onLoc=arguments[1];leftLoc=arguments[2];rightLoc=arguments[3];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[geomIndex].setLocations(onLoc,leftLoc,rightLoc);}else if(arguments.length===3){onLoc=arguments[0];leftLoc=arguments[1];rightLoc=arguments[2];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);}else if(arguments.length===2){geomIndex=arguments[0];onLoc=arguments[1];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[geomIndex].setLocation(onLoc);}else if(arguments[0]instanceof jsts.geomgraph.Label){lbl=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(lbl.elt[0]);this.elt[1]=new jsts.geomgraph.TopologyLocation(lbl.elt[1]);}else if(typeof arguments[0]==='number'){onLoc=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc);}};jsts.geomgraph.Label.toLineLabel=function(label){var i,lineLabel=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(i=0;i<2;i++){lineLabel.setLocation(i,label.getLocation(i));}
return lineLabel;};jsts.geomgraph.Label.prototype.elt=null;jsts.geomgraph.Label.prototype.flip=function(){this.elt[0].flip();this.elt[1].flip();};jsts.geomgraph.Label.prototype.getLocation=function(geomIndex,posIndex){if(arguments.length==1){return this.getLocation2.apply(this,arguments);}
return this.elt[geomIndex].get(posIndex);};jsts.geomgraph.Label.prototype.getLocation2=function(geomIndex){return this.elt[geomIndex].get(jsts.geomgraph.Position.ON);};jsts.geomgraph.Label.prototype.setLocation=function(geomIndex,posIndex,location){if(arguments.length==2){this.setLocation2.apply(this,arguments);return;}
this.elt[geomIndex].setLocation(posIndex,location);};jsts.geomgraph.Label.prototype.setLocation2=function(geomIndex,location){this.elt[geomIndex].setLocation(jsts.geomgraph.Position.ON,location);};jsts.geomgraph.Label.prototype.setAllLocations=function(geomIndex,location){this.elt[geomIndex].setAllLocations(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull=function(geomIndex,location){if(arguments.length==1){this.setAllLocationsIfNull2.apply(this,arguments);return;}
this.elt[geomIndex].setAllLocationsIfNull(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull2=function(location){this.setAllLocationsIfNull(0,location);this.setAllLocationsIfNull(1,location);};jsts.geomgraph.Label.prototype.merge=function(lbl){var i;for(i=0;i<2;i++){if(this.elt[i]===null&&lbl.elt[i]!==null){this.elt[i]=new jsts.geomgraph.TopologyLocation(lbl.elt[i]);}else{this.elt[i].merge(lbl.elt[i]);}}};jsts.geomgraph.Label.prototype.getGeometryCount=function(){var count=0;if(!this.elt[0].isNull()){count++;}
if(!this.elt[1].isNull()){count++;}
return count;};jsts.geomgraph.Label.prototype.isNull=function(geomIndex){return this.elt[geomIndex].isNull();};jsts.geomgraph.Label.prototype.isAnyNull=function(geomIndex){return this.elt[geomIndex].isAnyNull();};jsts.geomgraph.Label.prototype.isArea=function(){if(arguments.length==1){return this.isArea2(arguments[0]);}
return this.elt[0].isArea()||this.elt[1].isArea();};jsts.geomgraph.Label.prototype.isArea2=function(geomIndex){return this.elt[geomIndex].isArea();};jsts.geomgraph.Label.prototype.isLine=function(geomIndex){return this.elt[geomIndex].isLine();};jsts.geomgraph.Label.prototype.isEqualOnSide=function(lbl,side){return this.elt[0].isEqualOnSide(lbl.elt[0],side)&&this.elt[1].isEqualOnSide(lbl.elt[1],side);};jsts.geomgraph.Label.prototype.allPositionsEqual=function(geomIndex,loc){return this.elt[geomIndex].allPositionsEqual(loc);};jsts.geomgraph.Label.prototype.toLine=function(geomIndex){if(this.elt[geomIndex].isArea()){this.elt[geomIndex]=new jsts.geomgraph.TopologyLocation(this.elt[geomIndex].location[0]);}};jsts.geomgraph.EdgeRing=function(start,geometryFactory){this.edges=[];this.pts=[];this.holes=[];this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);this.geometryFactory=geometryFactory;if(start){this.computePoints(start);this.computeRing();}};jsts.geomgraph.EdgeRing.prototype.startDe=null;jsts.geomgraph.EdgeRing.prototype.maxNodeDegree=-1;jsts.geomgraph.EdgeRing.prototype.edges=null;jsts.geomgraph.EdgeRing.prototype.pts=null;jsts.geomgraph.EdgeRing.prototype.label=null;jsts.geomgraph.EdgeRing.prototype.ring=null;jsts.geomgraph.EdgeRing.prototype._isHole=null;jsts.geomgraph.EdgeRing.prototype.shell=null;jsts.geomgraph.EdgeRing.prototype.holes=null;jsts.geomgraph.EdgeRing.prototype.geometryFactory=null;jsts.geomgraph.EdgeRing.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.EdgeRing.prototype.isHole=function(){return this._isHole;};jsts.geomgraph.EdgeRing.prototype.getCoordinate=function(i){return this.pts[i];};jsts.geomgraph.EdgeRing.prototype.getLinearRing=function(){return this.ring;};jsts.geomgraph.EdgeRing.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeRing.prototype.isShell=function(){return this.shell===null;};jsts.geomgraph.EdgeRing.prototype.getShell=function(){return this.shell;};jsts.geomgraph.EdgeRing.prototype.setShell=function(shell){this.shell=shell;if(shell!==null)
shell.addHole(this);};jsts.geomgraph.EdgeRing.prototype.addHole=function(ring){this.holes.push(ring);};jsts.geomgraph.EdgeRing.prototype.toPolygon=function(geometryFactory){var holeLR=[];for(var i=0;i<this.holes.length;i++){holeLR[i]=this.holes[i].getLinearRing();}
var poly=this.geometryFactory.createPolygon(this.getLinearRing(),holeLR);return poly;};jsts.geomgraph.EdgeRing.prototype.computeRing=function(){if(this.ring!==null)
return;var coord=[];for(var i=0;i<this.pts.length;i++){coord[i]=this.pts[i];}
this.ring=this.geometryFactory.createLinearRing(coord);this._isHole=jsts.algorithm.CGAlgorithms.isCCW(this.ring.getCoordinates());};jsts.geomgraph.EdgeRing.prototype.getNext=function(de){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.setEdgeRing=function(de,er){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeRing.prototype.computePoints=function(start){this.startDe=start;var de=start;var isFirstEdge=true;do{if(de===null)
throw new jsts.error.TopologyError('Found null DirectedEdge');if(de.getEdgeRing()===this)
throw new jsts.error.TopologyError('Directed Edge visited twice during ring-building at '+
de.getCoordinate());this.edges.push(de);var label=de.getLabel();jsts.util.Assert.isTrue(label.isArea());this.mergeLabel(label);this.addPoints(de.getEdge(),de.isForward(),isFirstEdge);isFirstEdge=false;this.setEdgeRing(de,this);de=this.getNext(de);}while(de!==this.startDe);};jsts.geomgraph.EdgeRing.prototype.getMaxNodeDegree=function(){if(this.maxNodeDegree<0)
this.computeMaxNodeDegree();return this.maxNodeDegree;};jsts.geomgraph.EdgeRing.prototype.computeMaxNodeDegree=function(){this.maxNodeDegree=0;var de=this.startDe;do{var node=de.getNode();var degree=node.getEdges().getOutgoingDegree(this);if(degree>this.maxNodeDegree)
this.maxNodeDegree=degree;de=this.getNext(de);}while(de!==this.startDe);this.maxNodeDegree*=2;};jsts.geomgraph.EdgeRing.prototype.setInResult=function(){var de=this.startDe;do{de.getEdge().setInResult(true);de=de.getNext();}while(de!=this.startDe);};jsts.geomgraph.EdgeRing.prototype.mergeLabel=function(deLabel){this.mergeLabel2(deLabel,0);this.mergeLabel2(deLabel,1);};jsts.geomgraph.EdgeRing.prototype.mergeLabel2=function(deLabel,geomIndex){var loc=deLabel.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(loc==jsts.geom.Location.NONE)
return;if(this.label.getLocation(geomIndex)===jsts.geom.Location.NONE){this.label.setLocation(geomIndex,loc);return;}};jsts.geomgraph.EdgeRing.prototype.addPoints=function(edge,isForward,isFirstEdge){var edgePts=edge.getCoordinates();if(isForward){var startIndex=1;if(isFirstEdge)
startIndex=0;for(var i=startIndex;i<edgePts.length;i++){this.pts.push(edgePts[i]);}}else{var startIndex=edgePts.length-2;if(isFirstEdge)
startIndex=edgePts.length-1;for(var i=startIndex;i>=0;i--){this.pts.push(edgePts[i]);}}};jsts.geomgraph.EdgeRing.prototype.containsPoint=function(p){var shell=this.getLinearRing();var env=shell.getEnvelopeInternal();if(!env.contains(p))
return false;if(!jsts.algorithm.CGAlgorithms.isPointInRing(p,shell.getCoordinates()))
return false;for(var i=0;i<this.holes.length;i++){var hole=this.holes[i];if(hole.containsPoint(p))
return false;}
return true;};(function(){jsts.geom.LinearRing=function(points,factory){jsts.geom.LineString.apply(this,arguments);};jsts.geom.LinearRing.prototype=new jsts.geom.LineString();jsts.geom.LinearRing.constructor=jsts.geom.LinearRing;jsts.geom.LinearRing.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.LinearRing.prototype.isSimple=function(){return true;};jsts.geom.LinearRing.prototype.getGeometryType=function(){return'LinearRing';};jsts.geom.LinearRing.MINIMUM_VALID_SIZE=4;jsts.geom.LinearRing.prototype.CLASS_NAME='jsts.geom.LinearRing';})();jsts.index.strtree.Boundable=function(){};jsts.index.strtree.Boundable.prototype.getBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode=function(level){this.level=level;this.childBoundables=[];};jsts.index.strtree.AbstractNode.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.AbstractNode.constructor=jsts.index.strtree.AbstractNode;jsts.index.strtree.AbstractNode.prototype.childBoundables=null;jsts.index.strtree.AbstractNode.prototype.bounds=null;jsts.index.strtree.AbstractNode.prototype.level=null;jsts.index.strtree.AbstractNode.prototype.getChildBoundables=function(){return this.childBoundables;};jsts.index.strtree.AbstractNode.prototype.computeBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode.prototype.getBounds=function(){if(this.bounds===null){this.bounds=this.computeBounds();}
return this.bounds;};jsts.index.strtree.AbstractNode.prototype.getLevel=function(){return this.level;};jsts.index.strtree.AbstractNode.prototype.addChildBoundable=function(childBoundable){this.childBoundables.push(childBoundable);};(function(){jsts.noding.Noder=function(){};jsts.noding.Noder.prototype.computeNodes=jsts.abstractFunc;jsts.noding.Noder.prototype.getNodedSubstrings=jsts.abstractFunc;})();(function(){var Noder=jsts.noding.Noder;jsts.noding.SinglePassNoder=function(){};jsts.noding.SinglePassNoder.prototype=new Noder();jsts.noding.SinglePassNoder.constructor=jsts.noding.SinglePassNoder;jsts.noding.SinglePassNoder.prototype.segInt=null;jsts.noding.SinglePassNoder.prototype.setSegmentIntersector=function(segInt){this.segInt=segInt;};})();jsts.index.SpatialIndex=function(){};jsts.index.SpatialIndex.prototype.insert=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.query=function(searchEnv,visitor){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.remove=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree=function(nodeCapacity){if(nodeCapacity===undefined)
return;this.itemBoundables=[];jsts.util.Assert.isTrue(nodeCapacity>1,'Node capacity must be greater than 1');this.nodeCapacity=nodeCapacity;};jsts.index.strtree.AbstractSTRtree.IntersectsOp=function(){};jsts.index.strtree.AbstractSTRtree.IntersectsOp.prototype.intersects=function(aBounds,bBounds){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.root=null;jsts.index.strtree.AbstractSTRtree.prototype.built=false;jsts.index.strtree.AbstractSTRtree.prototype.itemBoundables=null;jsts.index.strtree.AbstractSTRtree.prototype.nodeCapacity=null;jsts.index.strtree.AbstractSTRtree.prototype.build=function(){jsts.util.Assert.isTrue(!this.built);this.root=this.itemBoundables.length===0?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1);this.built=true;};jsts.index.strtree.AbstractSTRtree.prototype.createNode=function(level){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var parentBoundables=[];parentBoundables.push(this.createNode(newLevel));var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.getComparator());for(var i=0;i<sortedChildBoundables.length;i++){var childBoundable=sortedChildBoundables[i];if(this.lastNode(parentBoundables).getChildBoundables().length===this.getNodeCapacity()){parentBoundables.push(this.createNode(newLevel));}
this.lastNode(parentBoundables).addChildBoundable(childBoundable);}
return parentBoundables;};jsts.index.strtree.AbstractSTRtree.prototype.lastNode=function(nodes){return nodes[nodes.length-1];};jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles=function(a,b){return a>b?1:a<b?-1:0;};jsts.index.strtree.AbstractSTRtree.prototype.createHigherLevels=function(boundablesOfALevel,level){jsts.util.Assert.isTrue(!(boundablesOfALevel.length===0));var parentBoundables=this.createParentBoundables(boundablesOfALevel,level+1);if(parentBoundables.length===1){return parentBoundables[0];}
return this.createHigherLevels(parentBoundables,level+1);};jsts.index.strtree.AbstractSTRtree.prototype.getRoot=function(){if(!this.built)
this.build();return this.root;};jsts.index.strtree.AbstractSTRtree.prototype.getNodeCapacity=function(){return this.nodeCapacity;};jsts.index.strtree.AbstractSTRtree.prototype.size=function(){if(arguments.length===1){return this.size2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.size2(root);};jsts.index.strtree.AbstractSTRtree.prototype.size2=function(node){var size=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){size+=this.size(childBoundable);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){size+=1;}}
return size;};jsts.index.strtree.AbstractSTRtree.prototype.depth=function(){if(arguments.length===1){return this.depth2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.depth2(root);};jsts.index.strtree.AbstractSTRtree.prototype.depth2=function(){var maxChildDepth=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var childDepth=this.depth(childBoundable);if(childDepth>maxChildDepth)
maxChildDepth=childDepth;}}
return maxChildDepth+1;};jsts.index.strtree.AbstractSTRtree.prototype.insert=function(bounds,item){jsts.util.Assert.isTrue(!this.built,'Cannot insert items into an STR packed R-tree after it has been built.');this.itemBoundables.push(new jsts.index.strtree.ItemBoundable(bounds,item));};jsts.index.strtree.AbstractSTRtree.prototype.query=function(searchBounds){if(arguments.length>1){this.query2.apply(this,arguments);}
if(!this.built){this.build();}
var matches=[];if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);return matches;}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query3(searchBounds,this.root,matches);}
return matches;};jsts.index.strtree.AbstractSTRtree.prototype.query2=function(searchBounds,visitor){if(arguments.length>2){this.query3.apply(this,arguments);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query4(searchBounds,this.root,visitor);}};jsts.index.strtree.AbstractSTRtree.prototype.query3=function(searchBounds,node,matches){if(!(arguments[2]instanceof Array)){this.query4.apply(this,arguments);}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query3(searchBounds,childBoundable,matches);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){matches.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.query4=function(searchBounds,node,visitor){var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query4(searchBounds,childBoundable,visitor);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){visitor.visitItem(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.getIntersectsOp=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree=function(){if(arguments.length===1){return this.itemsTree2.apply(this,arguments);}
if(!this.built){this.build();}
var valuesTree=this.itemsTree2(this.root);if(valuesTree===null)
return[];return valuesTree;};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree2=function(node){var valuesTreeForNode=[];var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var valuesTreeForChild=this.itemsTree(childBoundable);if(valuesTreeForChild!=null)
valuesTreeForNode.push(valuesTreeForChild);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){valuesTreeForNode.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}
if(valuesTreeForNode.length<=0)
return null;return valuesTreeForNode;};jsts.index.strtree.AbstractSTRtree.prototype.remove=function(searchBounds,item){if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()==null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){return this.remove2(searchBounds,this.root,item);}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.remove2=function(searchBounds,node,item){var found=this.removeItem(node,item);if(found)
return true;var childToPrune=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){found=this.remove(searchBounds,childBoundable,item);if(found){childToPrune=childBoundable;break;}}}
if(childToPrune!=null){if(childToPrune.getChildBoundables().length===0){childBoundables.splice(childBoundables.indexOf(childToPrune),1);}}
return found;};jsts.index.strtree.AbstractSTRtree.prototype.removeItem=function(node,item){var childToRemove=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.ItemBoundable){if(childBoundable.getItem()===item)
childToRemove=childBoundable;}}
if(childToRemove!==null){childBoundables.splice(childBoundables.indexOf(childToRemove),1);return true;}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel=function(level){if(arguments.length>1){this.boundablesAtLevel2.apply(this,arguments);return;}
var boundables=[];this.boundablesAtLevel2(level,this.root,boundables);return boundables;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel2=function(level,top,boundables){jsts.util.Assert.isTrue(level>-2);if(top.getLevel()===level){boundables.add(top);return;}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var boundable=childBoundables[i];if(boundable instanceof jsts.index.strtree.AbstractNode){this.boundablesAtLevel(level,boundable,boundables);}else{jsts.util.Assert.isTrue(boundable instanceof jsts.index.strtree.ItemBoundable);if(level===-1){boundables.add(boundable);}}}
return;};jsts.index.strtree.AbstractSTRtree.prototype.getComparator=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.STRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.STRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.STRtree.constructor=jsts.index.strtree.STRtree;jsts.index.strtree.STRtree.prototype.xComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreX(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreX(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.yComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreY(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreY(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.centreX=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinX(),e.getMaxX());};jsts.index.strtree.STRtree.prototype.centreY=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinY(),e.getMaxY());};jsts.index.strtree.STRtree.prototype.avg=function(a,b){return(a+b)/2.0;};jsts.index.strtree.STRtree.prototype.intersectsOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.STRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var minLeafCount=Math.ceil(childBoundables.length/this.getNodeCapacity());var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.xComparator);var verticalSlices=this.verticalSlices(sortedChildBoundables,Math.ceil(Math.sqrt(minLeafCount)));return this.createParentBoundablesFromVerticalSlices(verticalSlices,newLevel);};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlices=function(verticalSlices,newLevel){jsts.util.Assert.isTrue(verticalSlices.length>0);var parentBoundables=[];for(var i=0;i<verticalSlices.length;i++){parentBoundables=parentBoundables.concat(this.createParentBoundablesFromVerticalSlice(verticalSlices[i],newLevel));}
return parentBoundables;};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlice=function(childBoundables,newLevel){return jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables.call(this,childBoundables,newLevel);};jsts.index.strtree.STRtree.prototype.verticalSlices=function(childBoundables,sliceCount){var sliceCapacity=Math.ceil(childBoundables.length/sliceCount);var slices=[];var i=0,boundablesAddedToSlice,childBoundable;for(var j=0;j<sliceCount;j++){slices[j]=[];boundablesAddedToSlice=0;while(i<childBoundables.length&&boundablesAddedToSlice<sliceCapacity){childBoundable=childBoundables[i++];slices[j].push(childBoundable);boundablesAddedToSlice++;}}
return slices;};jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY=10;jsts.index.strtree.STRtree.prototype.createNode=function(level){var abstractNode=new jsts.index.strtree.AbstractNode(level);abstractNode.computeBounds=function(){var bounds=null;var childBoundables=this.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.geom.Envelope(childBoundable.getBounds());}else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return abstractNode;};jsts.index.strtree.STRtree.prototype.getIntersectsOp=function(){return this.intersectsOp;};jsts.index.strtree.STRtree.prototype.insert=function(itemEnv,item){if(itemEnv.isNull()){return;}
jsts.index.strtree.AbstractSTRtree.prototype.insert.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.query=function(searchEnv,visitor){return jsts.index.strtree.AbstractSTRtree.prototype.query.apply(this,arguments);};jsts.index.strtree.STRtree.prototype.remove=function(itemEnv,item){return jsts.index.strtree.AbstractSTRtree.prototype.remove.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.size=function(){return jsts.index.strtree.AbstractSTRtree.prototype.size.call(this);};jsts.index.strtree.STRtree.prototype.depth=function(){return jsts.index.strtree.AbstractSTRtree.prototype.depth.call(this);};jsts.index.strtree.STRtree.prototype.getComparator=function(){return this.yComparator;};jsts.index.strtree.STRtree.prototype.nearestNeighbour=function(itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),this.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour2=function(env,item,itemDist){var bnd=new jsts.index.strtree.ItemBoundable(env,item);var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),bnd,itemDist);return this.nearestNeighbour4(bp)[0];};jsts.index.strtree.STRtree.prototype.nearestNeighbour3=function(tree,itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),tree.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour4=function(initBndPair){return this.nearestNeighbour5(initBndPair,Double.POSITIVE_INFINITY);};jsts.index.strtree.STRtree.prototype.nearestNeighbour5=function(initBndPair,maxDistance){var distanceLowerBound=maxDistance;var minPair=null;var priQ=[];priQ.push(initBndPair);while(!priQ.isEmpty()&&distanceLowerBound>0.0){var bndPair=priQ.pop();var currentDistance=bndPair.getDistance();if(currentDistance>=distanceLowerBound)
break;if(bndPair.isLeaves()){distanceLowerBound=currentDistance;minPair=bndPair;}else{bndPair.expandToQueue(priQ,distanceLowerBound);}}
return[minPair.getBoundable(0).getItem(),minPair.getBoundable(1).getItem()];};jsts.noding.SegmentString=function(){};jsts.noding.SegmentString.prototype.getData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.setData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.size=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinate=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinates=jsts.abstractFunc;jsts.noding.SegmentString.prototype.isClosed=jsts.abstractFunc;jsts.noding.NodableSegmentString=function(){};jsts.noding.NodableSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.NodableSegmentString.prototype.addIntersection=jsts.abstractFunc;jsts.noding.NodedSegmentString=function(pts,data){this.nodeList=new jsts.noding.SegmentNodeList(this);this.pts=pts;this.data=data;};jsts.noding.NodedSegmentString.prototype=new jsts.noding.NodableSegmentString();jsts.noding.NodedSegmentString.constructor=jsts.noding.NodedSegmentString;jsts.noding.NodedSegmentString.getNodedSubstrings=function(segStrings){if(arguments.length===2){jsts.noding.NodedSegmentString.getNodedSubstrings2.apply(this,arguments);return;}
var resultEdgelist=new javascript.util.ArrayList();jsts.noding.NodedSegmentString.getNodedSubstrings2(segStrings,resultEdgelist);return resultEdgelist;};jsts.noding.NodedSegmentString.getNodedSubstrings2=function(segStrings,resultEdgelist){for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();ss.getNodeList().addSplitEdges(resultEdgelist);}};jsts.noding.NodedSegmentString.prototype.nodeList=null;jsts.noding.NodedSegmentString.prototype.pts=null;jsts.noding.NodedSegmentString.prototype.data=null;jsts.noding.NodedSegmentString.prototype.getData=function(){return this.data;};jsts.noding.NodedSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.NodedSegmentString.prototype.getNodeList=function(){return this.nodeList;};jsts.noding.NodedSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.NodedSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.NodedSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.NodedSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.NodedSegmentString.prototype.getSegmentOctant=function(index){if(index===this.pts.length-1)
return-1;return this.safeOctant(this.getCoordinate(index),this.getCoordinate(index+1));};jsts.noding.NodedSegmentString.prototype.safeOctant=function(p0,p1){if(p0.equals2D(p1))
return 0;return jsts.noding.Octant.octant(p0,p1);};jsts.noding.NodedSegmentString.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.noding.NodedSegmentString.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){if(li instanceof jsts.geom.Coordinate){this.addIntersection2.apply(this,arguments);return;}
var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));this.addIntersection2(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersection2=function(intPt,segmentIndex){this.addIntersectionNode(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersectionNode=function(intPt,segmentIndex){var normalizedSegmentIndex=segmentIndex;var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;}}
var ei=this.nodeList.add(intPt,normalizedSegmentIndex);return ei;};jsts.noding.NodedSegmentString.prototype.toString=function(){var geometryFactory=new jsts.geom.GeometryFactory();return new jsts.io.WKTWriter().write(geometryFactory.createLineString(this.pts));};jsts.index.chain.MonotoneChainBuilder=function(){};jsts.index.chain.MonotoneChainBuilder.toIntArray=function(list){var array=[];for(var i=0;i<list.length;i++){array[i]=list[i];}
return array;};jsts.index.chain.MonotoneChainBuilder.getChains=function(pts){if(arguments.length===2){return jsts.index.chain.MonotoneChainBuilder.getChains2.apply(this,arguments);}
return jsts.index.chain.MonotoneChainBuilder.getChains2(pts,null);};jsts.index.chain.MonotoneChainBuilder.getChains2=function(pts,context){var mcList=[];var startIndex=jsts.index.chain.MonotoneChainBuilder.getChainStartIndices(pts);for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.index.chain.MonotoneChain(pts,startIndex[i],startIndex[i+1],context);mcList.push(mc);}
return mcList;};jsts.index.chain.MonotoneChainBuilder.getChainStartIndices=function(pts){var start=0;var startIndexList=[];startIndexList.push(start);do{var last=jsts.index.chain.MonotoneChainBuilder.findChainEnd(pts,start);startIndexList.push(last);start=last;}while(start<pts.length-1);var startIndex=jsts.index.chain.MonotoneChainBuilder.toIntArray(startIndexList);return startIndex;};jsts.index.chain.MonotoneChainBuilder.findChainEnd=function(pts,start){var safeStart=start;while(safeStart<pts.length-1&&pts[safeStart].equals2D(pts[safeStart+1])){safeStart++;}
if(safeStart>=pts.length-1){return pts.length-1;}
var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[safeStart],pts[safeStart+1]);var last=start+1;while(last<pts.length){if(!pts[last-1].equals2D(pts[last])){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!==chainQuad)
break;}
last++;}
return last-1;};jsts.algorithm.LineIntersector=function(){this.inputLines=[[],[]];this.intPt=[null,null];this.pa=this.intPt[0];this.pb=this.intPt[1];this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.NO_INTERSECTION=0;jsts.algorithm.LineIntersector.POINT_INTERSECTION=1;jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION=2;jsts.algorithm.LineIntersector.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.algorithm.LineIntersector.prototype.getEndpoint=function(segmentIndex,ptIndex){return this.inputLines[segmentIndex][ptIndex];};jsts.algorithm.LineIntersector.computeEdgeDistance=function(p,p0,p1){var dx=Math.abs(p1.x-p0.x);var dy=Math.abs(p1.y-p0.y);var dist=-1.0;if(p.equals(p0)){dist=0.0;}else if(p.equals(p1)){if(dx>dy){dist=dx;}else{dist=dy;}}else{var pdx=Math.abs(p.x-p0.x);var pdy=Math.abs(p.y-p0.y);if(dx>dy){dist=pdx;}else{dist=pdy;}
if(dist===0.0&&!p.equals(p0)){dist=Math.max(pdx,pdy);}}
if(dist===0.0&&!p.equals(p0)){throw new jsts.error.IllegalArgumentError('Bad distance calculation');}
return dist;};jsts.algorithm.LineIntersector.nonRobustComputeEdgeDistance=function(p,p1,p2){var dx=p.x-p1.x;var dy=p.y-p1.y;var dist=Math.sqrt(dx*dx+dy*dy);if(!(dist===0.0&&!p.equals(p1))){throw new jsts.error.IllegalArgumentError('Invalid distance calculation');}
return dist;};jsts.algorithm.LineIntersector.prototype.result=null;jsts.algorithm.LineIntersector.prototype.inputLines=null;jsts.algorithm.LineIntersector.prototype.intPt=null;jsts.algorithm.LineIntersector.prototype.intLineIndex=null;jsts.algorithm.LineIntersector.prototype._isProper=null;jsts.algorithm.LineIntersector.prototype.pa=null;jsts.algorithm.LineIntersector.prototype.pb=null;jsts.algorithm.LineIntersector.prototype.precisionModel=null;jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p,p1,p2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isCollinear=function(){return this.result===jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p1,p2,p3,p4){this.inputLines[0][0]=p1;this.inputLines[0][1]=p2;this.inputLines[1][0]=p3;this.inputLines[1][1]=p4;this.result=this.computeIntersect(p1,p2,p3,p4);};jsts.algorithm.LineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper;};jsts.algorithm.LineIntersector.prototype.hasIntersection=function(){return this.result!==jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.getIntersectionNum=function(){return this.result;};jsts.algorithm.LineIntersector.prototype.getIntersection=function(intIndex){return this.intPt[intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(){if(this.intLineIndex===null){this.intLineIndex=[[],[]];this.computeIntLineIndex(0);this.computeIntLineIndex(1);}};jsts.algorithm.LineIntersector.prototype.isIntersection=function(pt){var i;for(i=0;i<this.result;i++){if(this.intPt[i].equals2D(pt)){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection=function(){if(arguments.length===1){return this.isInteriorIntersection2.apply(this,arguments);}
if(this.isInteriorIntersection(0)){return true;}
if(this.isInteriorIntersection(1)){return true;}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection2=function(inputLineIndex){var i;for(i=0;i<this.result;i++){if(!(this.intPt[i].equals2D(this.inputLines[inputLineIndex][0])||this.intPt[i].equals2D(this.inputLines[inputLineIndex][1]))){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isProper=function(){return this.hasIntersection()&&this._isProper;};jsts.algorithm.LineIntersector.prototype.getIntersectionAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intPt[intLineIndex[segmentIndex][intIndex]];};jsts.algorithm.LineIntersector.prototype.getIndexAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intLineIndex[segmentIndex][intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(segmentIndex){var dist0=this.getEdgeDistance(segmentIndex,0);var dist1=this.getEdgeDistance(segmentIndex,1);if(dist0>dist1){this.intLineIndex[segmentIndex][0]=0;this.intLineIndex[segmentIndex][1]=1;}else{this.intLineIndex[segmentIndex][0]=1;this.intLineIndex[segmentIndex][1]=0;}};jsts.algorithm.LineIntersector.prototype.getEdgeDistance=function(segmentIndex,intIndex){var dist=jsts.algorithm.LineIntersector.computeEdgeDistance(this.intPt[intIndex],this.inputLines[segmentIndex][0],this.inputLines[segmentIndex][1]);return dist;};jsts.algorithm.RobustLineIntersector=function(){jsts.algorithm.RobustLineIntersector.prototype.constructor.call(this);};jsts.algorithm.RobustLineIntersector.prototype=new jsts.algorithm.LineIntersector();jsts.algorithm.RobustLineIntersector.prototype.computeIntersection=function(p,p1,p2){if(arguments.length===4){jsts.algorithm.LineIntersector.prototype.computeIntersection.apply(this,arguments);return;}
this._isProper=false;if(jsts.geom.Envelope.intersects(p1,p2,p)){if((jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,p)===0)&&(jsts.algorithm.CGAlgorithms.orientationIndex(p2,p1,p)===0)){this._isProper=true;if(p.equals(p1)||p.equals(p2)){this._isProper=false;}
this.result=jsts.algorithm.LineIntersector.POINT_INTERSECTION;return;}}
this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){this._isProper=false;if(!jsts.geom.Envelope.intersects(p1,p2,q1,q2)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Pq1=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q1);var Pq2=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q2);if((Pq1>0&&Pq2>0)||(Pq1<0&&Pq2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Qp1=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p1);var Qp2=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p2);if((Qp1>0&&Qp2>0)||(Qp1<0&&Qp2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var collinear=Pq1===0&&Pq2===0&&Qp1===0&&Qp2===0;if(collinear){return this.computeCollinearIntersection(p1,p2,q1,q2);}
if(Pq1===0||Pq2===0||Qp1===0||Qp2===0){this._isProper=false;if(p1.equals2D(q1)||p1.equals2D(q2)){this.intPt[0]=p1;}else if(p2.equals2D(q1)||p2.equals2D(q2)){this.intPt[0]=p2;}
else if(Pq1===0){this.intPt[0]=new jsts.geom.Coordinate(q1);}else if(Pq2===0){this.intPt[0]=new jsts.geom.Coordinate(q2);}else if(Qp1===0){this.intPt[0]=new jsts.geom.Coordinate(p1);}else if(Qp2===0){this.intPt[0]=new jsts.geom.Coordinate(p2);}}else{this._isProper=true;this.intPt[0]=this.intersection(p1,p2,q1,q2);}
return jsts.algorithm.LineIntersector.POINT_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeCollinearIntersection=function(p1,p2,q1,q2){var p1q1p2=jsts.geom.Envelope.intersects(p1,p2,q1);var p1q2p2=jsts.geom.Envelope.intersects(p1,p2,q2);var q1p1q2=jsts.geom.Envelope.intersects(q1,q2,p1);var q1p2q2=jsts.geom.Envelope.intersects(q1,q2,p2);if(p1q1p2&&p1q2p2){this.intPt[0]=q1;this.intPt[1]=q2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(q1p1q2&&q1p2q2){this.intPt[0]=p1;this.intPt[1]=p2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p1q2){this.intPt[0]=q1;this.intPt[1]=p1;return q1.equals(p1)&&!p1q2p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p2q2){this.intPt[0]=q1;this.intPt[1]=p2;return q1.equals(p2)&&!p1q2p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p1q2){this.intPt[0]=q2;this.intPt[1]=p1;return q2.equals(p1)&&!p1q1p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p2q2){this.intPt[0]=q2;this.intPt[1]=p2;return q2.equals(p2)&&!p1q1p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
return jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.intersection=function(p1,p2,q1,q2){var intPt=this.intersectionWithNormalization(p1,p2,q1,q2);if(!this.isInSegmentEnvelopes(intPt)){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}
if(this.precisionModel!==null){this.precisionModel.makePrecise(intPt);}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.intersectionWithNormalization=function(p1,p2,q1,q2){var n1=new jsts.geom.Coordinate(p1);var n2=new jsts.geom.Coordinate(p2);var n3=new jsts.geom.Coordinate(q1);var n4=new jsts.geom.Coordinate(q2);var normPt=new jsts.geom.Coordinate();this.normalizeToEnvCentre(n1,n2,n3,n4,normPt);var intPt=this.safeHCoordinateIntersection(n1,n2,n3,n4);intPt.x+=normPt.x;intPt.y+=normPt.y;return intPt;};jsts.algorithm.RobustLineIntersector.prototype.safeHCoordinateIntersection=function(p1,p2,q1,q2){var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(p1,p2,q1,q2);}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}else{throw e;}}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToMinimum=function(n1,n2,n3,n4,normPt){normPt.x=this.smallestInAbsValue(n1.x,n2.x,n3.x,n4.x);normPt.y=this.smallestInAbsValue(n1.y,n2.y,n3.y,n4.y);n1.x-=normPt.x;n1.y-=normPt.y;n2.x-=normPt.x;n2.y-=normPt.y;n3.x-=normPt.x;n3.y-=normPt.y;n4.x-=normPt.x;n4.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToEnvCentre=function(n00,n01,n10,n11,normPt){var minX0=n00.x<n01.x?n00.x:n01.x;var minY0=n00.y<n01.y?n00.y:n01.y;var maxX0=n00.x>n01.x?n00.x:n01.x;var maxY0=n00.y>n01.y?n00.y:n01.y;var minX1=n10.x<n11.x?n10.x:n11.x;var minY1=n10.y<n11.y?n10.y:n11.y;var maxX1=n10.x>n11.x?n10.x:n11.x;var maxY1=n10.y>n11.y?n10.y:n11.y;var intMinX=minX0>minX1?minX0:minX1;var intMaxX=maxX0<maxX1?maxX0:maxX1;var intMinY=minY0>minY1?minY0:minY1;var intMaxY=maxY0<maxY1?maxY0:maxY1;var intMidX=(intMinX+intMaxX)/2.0;var intMidY=(intMinY+intMaxY)/2.0;normPt.x=intMidX;normPt.y=intMidY;n00.x-=normPt.x;n00.y-=normPt.y;n01.x-=normPt.x;n01.y-=normPt.y;n10.x-=normPt.x;n10.y-=normPt.y;n11.x-=normPt.x;n11.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.smallestInAbsValue=function(x1,x2,x3,x4){var x=x1;var xabs=Math.abs(x);if(Math.abs(x2)<xabs){x=x2;xabs=Math.abs(x2);}
if(Math.abs(x3)<xabs){x=x3;xabs=Math.abs(x3);}
if(Math.abs(x4)<xabs){x=x4;}
return x;};jsts.algorithm.RobustLineIntersector.prototype.isInSegmentEnvelopes=function(intPt){var env0=new jsts.geom.Envelope(this.inputLines[0][0],this.inputLines[0][1]);var env1=new jsts.geom.Envelope(this.inputLines[1][0],this.inputLines[1][1]);return env0.contains(intPt)&&env1.contains(intPt);};jsts.algorithm.HCoordinate=function(){this.x=0.0;this.y=0.0;this.w=1.0;if(arguments.length===1){this.initFrom1Coordinate(arguments[0]);}else if(arguments.length===2&&arguments[0]instanceof jsts.geom.Coordinate){this.initFrom2Coordinates(arguments[0],arguments[1]);}else if(arguments.length===2&&arguments[0]instanceof jsts.algorithm.HCoordinate){this.initFrom2HCoordinates(arguments[0],arguments[1]);}else if(arguments.length===2){this.initFromXY(arguments[0],arguments[1]);}else if(arguments.length===3){this.initFromXYW(arguments[0],arguments[1],arguments[2]);}else if(arguments.length===4){this.initFromXYW(arguments[0],arguments[1],arguments[2],arguments[3]);}};jsts.algorithm.HCoordinate.intersection=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw,x,y,w,xInt,yInt;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;x=py*qw-qy*pw;y=qx*pw-px*qw;w=px*qy-qx*py;xInt=x/w;yInt=y/w;if(!isFinite(xInt)||!isFinite(yInt)){throw new jsts.error.NotRepresentableError();}
return new jsts.geom.Coordinate(xInt,yInt);};jsts.algorithm.HCoordinate.prototype.initFrom1Coordinate=function(p){this.x=p.x;this.y=p.y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom2Coordinates=function(p1,p2){this.x=p1.y-p2.y;this.y=p2.x-p1.x;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFrom2HCoordinates=function(p1,p2){this.x=p1.y*p2.w-p2.y*p1.w;this.y=p2.x*p1.w-p1.x*p2.w;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFromXYW=function(x,y,w){this.x=x;this.y=y;this.w=w;};jsts.algorithm.HCoordinate.prototype.initFromXY=function(x,y){this.x=x;this.y=y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom4Coordinates=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;this.x=py*qw-qy*pw;this.y=qx*pw-px*qw;this.w=px*qy-qx*py;};jsts.algorithm.HCoordinate.prototype.getX=function(){var a=this.x/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getY=function(){var a=this.y/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getCoordinate=function(){var p=new jsts.geom.Coordinate();p.x=this.getX();p.y=this.getY();return p;};jsts.geom.LineSegment=function(){if(arguments.length===0){this.p0=new jsts.geom.Coordinate();this.p1=new jsts.geom.Coordinate();}else if(arguments.length===1){this.p0=arguments[0].p0;this.p1=arguments[0].p1;}else if(arguments.length===2){this.p0=arguments[0];this.p1=arguments[1];}else if(arguments.length===4){this.p0=new jsts.geom.Coordinate(arguments[0],arguments[1]);this.p1=new jsts.geom.Coordinate(arguments[2],arguments[3]);}};jsts.geom.LineSegment.prototype.p0=null;jsts.geom.LineSegment.prototype.p1=null;jsts.geom.LineSegment.midPoint=function(p0,p1){return new jsts.geom.Coordinate((p0.x+p1.x)/2,(p0.y+p1.y)/2);};jsts.geom.LineSegment.prototype.getCoordinate=function(i){if(i===0)return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.getLength=function(){return this.p0.distance(this.p1);};jsts.geom.LineSegment.prototype.isHorizontal=function(){return this.p0.y===this.p1.y;};jsts.geom.LineSegment.prototype.isVertical=function(){return this.p0.x===this.p1.x;};jsts.geom.LineSegment.prototype.orientationIndex=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.orientationIndex1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.orientationIndex2(arg);}};jsts.geom.LineSegment.prototype.orientationIndex1=function(seg){var orient0=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p0);var orient1=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p1);if(orient0>=0&&orient1>=0){return Math.max(orient0,orient1);}
if(orient0<=0&&orient1<=0){return Math.max(orient0,orient1);}
return 0;};jsts.geom.LineSegment.prototype.orientationIndex2=function(p){return jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,p);};jsts.geom.LineSegment.prototype.reverse=function(){var temp=this.p0;this.p0=this.p1;this.p1=temp;};jsts.geom.LineSegment.prototype.normalize=function(){if(this.p1.compareTo(this.p0)<0)this.reverse();};jsts.geom.LineSegment.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x);};jsts.geom.LineSegment.prototype.midPoint=function(){return jsts.geom.LineSegment.midPoint(this.p0,this.p1);};jsts.geom.LineSegment.prototype.distance=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.distance1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.distance2(arg);}};jsts.geom.LineSegment.prototype.distance1=function(ls){return jsts.algorithm.CGAlgorithms.distanceLineLine(this.p0,this.p1,ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.distance2=function(p){return jsts.algorithm.CGAlgorithms.distancePointLine(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.pointAlong=function(segmentLengthFraction){var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);coord.y=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.pointAlongOffset=function(segmentLengthFraction,offsetDistance){var segx=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);var segy=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=0;var uy=0;if(offsetDistance!==0){if(len<=0){throw"Cannot compute offset from zero-length line segment";}
ux=offsetDistance*dx/len;uy=offsetDistance*dy/len;}
var offsetx=segx-uy;var offsety=segy+ux;var coord=new jsts.geom.Coordinate(offsetx,offsety);return coord;};jsts.geom.LineSegment.prototype.projectionFactor=function(p){if(p.equals(this.p0))
return 0.0;if(p.equals(this.p1))
return 1.0;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len2=dx*dx+dy*dy;var r=((p.x-this.p0.x)*dx+(p.y-this.p0.y)*dy)/len2;return r;};jsts.geom.LineSegment.prototype.segmentFraction=function(inputPt){var segFrac=this.projectionFactor(inputPt);if(segFrac<0){segFrac=0;}else if(segFrac>1||isNaN(segFrac)){segFrac=1;}
return segFrac;};jsts.geom.LineSegment.prototype.project=function(arg){if(arg instanceof jsts.geom.Coordinate){return this.project1(arg);}else if(arg instanceof jsts.geom.LineSegment){return this.project2(arg);}};jsts.geom.LineSegment.prototype.project1=function(p){if(p.equals(this.p0)||p.equals(this.p1)){return new jsts.geom.Coordinate(p);}
var r=this.projectionFactor(p);var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+r*(this.p1.x-this.p0.x);coord.y=this.p0.y+r*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.project2=function(seg){var pf0=this.projectionFactor(seg.p0);var pf1=this.projectionFactor(seg.p1);if(pf0>=1&&pf1>=1)return null;if(pf0<=0&&pf1<=0)return null;var newp0=this.project(seg.p0);if(pf0<0)newp0=p0;if(pf0>1)newp0=p1;var newp1=this.project(seg.p1);if(pf1<0.0)newp1=p0;if(pf1>1.0)newp1=p1;return new jsts.geom.LineSegment(newp0,newp1);};jsts.geom.LineSegment.prototype.closestPoint=function(p){var factor=this.projectionFactor(p);if(factor>0&&factor<1){return this.project(p);}
var dist0=this.p0.distance(p);var dist1=this.p1.distance(p);if(dist0<dist1)
return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.closestPoints=function(line){var intPt=this.intersection(line);if(intPt!==null){return[intPt,intPt];}
var closestPt=[];var minDistance=Number.MAX_VALUE;var dist;var close00=this.closestPoint(line.p0);minDistance=close00.distance(line.p0);closestPt[0]=close00;closestPt[1]=line.p0;var close01=this.closestPoint(line.p1);dist=close01.distance(line.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=close01;closestPt[1]=line.p1;}
var close10=line.closestPoint(this.p0);dist=close10.distance(this.p0);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p0;closestPt[1]=close10;}
var close11=line.closestPoint(this.p1);dist=close11.distance(this.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p1;closestPt[1]=close11;}
return closestPt;};jsts.geom.LineSegment.prototype.intersection=function(line){var li=new jsts.algorithm.RobustLineIntersector();li.computeIntersection(this.p0,this.p1,line.p0,line.p1);if(li.hasIntersection())
return li.getIntersection(0);return null;};jsts.geom.LineSegment.prototype.setCoordinates=function(ls){if(ls instanceof jsts.geom.Coordinate){this.setCoordinates2.apply(this,arguments);return;}
this.setCoordinates2(ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.setCoordinates2=function(p0,p1){this.p0.x=p0.x;this.p0.y=p0.y;this.p1.x=p1.x;this.p1.y=p1.y;};jsts.geom.LineSegment.prototype.distancePerpendicular=function(p){return jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.lineIntersection=function(line){try{var intPt=jsts.algorithm.HCoordinate.intersection(this.p0,this.p1,line.p0,line.p1);return intPt;}catch(ex){}
return null;};jsts.geom.LineSegment.prototype.toGeometry=function(geomFactory){return geomFactory.createLineString([this.p0,this.p1]);};jsts.geom.LineSegment.prototype.equals=function(o){if(!(o instanceof jsts.geom.LineSegment)){return false;}
return this.p0.equals(o.p0)&&this.p1.equals(o.p1);};jsts.geom.LineSegment.prototype.compareTo=function(o){var comp0=this.p0.compareTo(o.p0);if(comp0!==0)return comp0;return this.p1.compareTo(o.p1);};jsts.geom.LineSegment.prototype.equalsTopo=function(other){return this.p0.equals(other.p0)&&this.p1.equals(other.p1)||this.p0.equals(other.p1)&&this.p1.equals(other.p0);};jsts.geom.LineSegment.prototype.toString=function(){return"LINESTRING("+
this.p0.x+" "+this.p0.y
+", "+
this.p1.x+" "+this.p1.y+")";};jsts.index.chain.MonotoneChainOverlapAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.tempEnv2=new jsts.geom.Envelope();this.overlapSeg1=new jsts.geom.LineSegment();this.overlapSeg2=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){this.mc1.getLineSegment(start1,this.overlapSeg1);this.mc2.getLineSegment(start2,this.overlapSeg2);this.overlap2(this.overlapSeg1,this.overlapSeg2);};jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap2=function(seg1,seg2){};(function(){var MonotoneChainOverlapAction=jsts.index.chain.MonotoneChainOverlapAction;var SinglePassNoder=jsts.noding.SinglePassNoder;var STRtree=jsts.index.strtree.STRtree;var NodedSegmentString=jsts.noding.NodedSegmentString;var MonotoneChainBuilder=jsts.index.chain.MonotoneChainBuilder;var SegmentOverlapAction=function(si){this.si=si;};SegmentOverlapAction.prototype=new MonotoneChainOverlapAction();SegmentOverlapAction.constructor=SegmentOverlapAction;SegmentOverlapAction.prototype.si=null;SegmentOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){var ss1=mc1.getContext();var ss2=mc2.getContext();this.si.processIntersections(ss1,start1,ss2,start2);};jsts.noding.MCIndexNoder=function(){this.monoChains=[];this.index=new STRtree();};jsts.noding.MCIndexNoder.prototype=new SinglePassNoder();jsts.noding.MCIndexNoder.constructor=jsts.noding.MCIndexNoder;jsts.noding.MCIndexNoder.prototype.monoChains=null;jsts.noding.MCIndexNoder.prototype.index=null;jsts.noding.MCIndexNoder.prototype.idCounter=0;jsts.noding.MCIndexNoder.prototype.nodedSegStrings=null;jsts.noding.MCIndexNoder.prototype.nOverlaps=0;jsts.noding.MCIndexNoder.prototype.getMonotoneChains=function(){return this.monoChains;};jsts.noding.MCIndexNoder.prototype.getIndex=function(){return this.index;};jsts.noding.MCIndexNoder.prototype.getNodedSubstrings=function(){return NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.MCIndexNoder.prototype.computeNodes=function(inputSegStrings){this.nodedSegStrings=inputSegStrings;for(var i=inputSegStrings.iterator();i.hasNext();){this.add(i.next());}
this.intersectChains();};jsts.noding.MCIndexNoder.prototype.intersectChains=function(){var overlapAction=new SegmentOverlapAction(this.segInt);for(var i=0;i<this.monoChains.length;i++){var queryChain=this.monoChains[i];var overlapChains=this.index.query(queryChain.getEnvelope());for(var j=0;j<overlapChains.length;j++){var testChain=overlapChains[j];if(testChain.getId()>queryChain.getId()){queryChain.computeOverlaps(testChain,overlapAction);this.nOverlaps++;}
if(this.segInt.isDone())
return;}}};jsts.noding.MCIndexNoder.prototype.add=function(segStr){var segChains=MonotoneChainBuilder.getChains(segStr.getCoordinates(),segStr);for(var i=0;i<segChains.length;i++){var mc=segChains[i];mc.setId(this.idCounter++);this.index.insert(mc.getEnvelope(),mc);this.monoChains.push(mc);}};})();jsts.simplify.LineSegmentIndex=function(){this.index=new jsts.index.quadtree.Quadtree();};jsts.simplify.LineSegmentIndex.prototype.index=null;jsts.simplify.LineSegmentIndex.prototype.add=function(line){if(line instanceof jsts.geom.LineSegment){this.add2(line);return;}
var segs=line.getSegments();for(var i=0;i<segs.length;i++){var seg=segs[i];this.add2(seg);}};jsts.simplify.LineSegmentIndex.prototype.add2=function(seg){this.index.insert(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.remove=function(seg){this.index.remove(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.query=function(querySeg){var env=new jsts.geom.Envelope(querySeg.p0,querySeg.p1);var visitor=new jsts.simplify.LineSegmentIndex.LineSegmentVisitor(querySeg);this.index.query(env,visitor);var itemsFound=visitor.getItems();return itemsFound;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor=function(querySeg){this.items=[];this.querySeg=querySeg;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype=new jsts.index.ItemVisitor();jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.querySeg=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.items=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.visitItem=function(item){var seg=item;if(jsts.geom.Envelope.intersects(seg.p0,seg.p1,this.querySeg.p0,this.querySeg.p1))
this.items.push(item);};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.getItems=function(){return this.items;};jsts.geomgraph.EdgeEndStar=function(){this.edgeMap=new javascript.util.TreeMap();this.edgeList=null;this.ptInAreaLocation=[jsts.geom.Location.NONE,jsts.geom.Location.NONE];};jsts.geomgraph.EdgeEndStar.prototype.edgeMap=null;jsts.geomgraph.EdgeEndStar.prototype.edgeList=null;jsts.geomgraph.EdgeEndStar.prototype.ptInAreaLocation=null;jsts.geomgraph.EdgeEndStar.prototype.insert=function(e){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.EdgeEndStar.prototype.insertEdgeEnd=function(e,obj){this.edgeMap.put(e,obj);this.edgeList=null;};jsts.geomgraph.EdgeEndStar.prototype.getCoordinate=function(){var it=this.iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};jsts.geomgraph.EdgeEndStar.prototype.getDegree=function(){return this.edgeMap.size();};jsts.geomgraph.EdgeEndStar.prototype.iterator=function(){return this.getEdges().iterator();};jsts.geomgraph.EdgeEndStar.prototype.getEdges=function(){if(this.edgeList===null){this.edgeList=new javascript.util.ArrayList(this.edgeMap.values());}
return this.edgeList;};jsts.geomgraph.EdgeEndStar.prototype.getNextCW=function(ee){this.getEdges();var i=this.edgeList.indexOf(ee);var iNextCW=i-1;if(i===0)
iNextCW=this.edgeList.length-1;return this.edgeList[iNextCW];};jsts.geomgraph.EdgeEndStar.prototype.computeLabelling=function(geomGraph){this.computeEdgeEndLabels(geomGraph[0].getBoundaryNodeRule());this.propagateSideLabels(0);this.propagateSideLabels(1);var hasDimensionalCollapseEdge=[false,false];for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isLine(geomi)&&label.getLocation(geomi)===jsts.geom.Location.BOUNDARY)
hasDimensionalCollapseEdge[geomi]=true;}}
for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isAnyNull(geomi)){var loc=jsts.geom.Location.NONE;if(hasDimensionalCollapseEdge[geomi]){loc=jsts.geom.Location.EXTERIOR;}else{var p=e.getCoordinate();loc=this.getLocation(geomi,p,geomGraph);}
label.setAllLocationsIfNull(geomi,loc);}}}};jsts.geomgraph.EdgeEndStar.prototype.computeEdgeEndLabels=function(boundaryNodeRule){for(var it=this.iterator();it.hasNext();){var ee=it.next();ee.computeLabel(boundaryNodeRule);}};jsts.geomgraph.EdgeEndStar.prototype.getLocation=function(geomIndex,p,geom){if(this.ptInAreaLocation[geomIndex]===jsts.geom.Location.NONE){this.ptInAreaLocation[geomIndex]=jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom[geomIndex].getGeometry());}
return this.ptInAreaLocation[geomIndex];};jsts.geomgraph.EdgeEndStar.prototype.isAreaLabelsConsistent=function(geomGraph){this.computeEdgeEndLabels(geomGraph.getBoundaryNodeRule());return this.checkAreaLabelsConsistent(0);};jsts.geomgraph.EdgeEndStar.prototype.checkAreaLabelsConsistent=function(geomIndex){var edges=this.getEdges();if(edges.size()<=0)
return true;var lastEdgeIndex=edges.size()-1;var startLabel=edges.get(lastEdgeIndex).getLabel();var startLoc=startLabel.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);jsts.util.Assert.isTrue(startLoc!=jsts.geom.Location.NONE,'Found unlabelled area edge');var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();jsts.util.Assert.isTrue(label.isArea(geomIndex),'Found non-area edge');var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(leftLoc===rightLoc){return false;}
if(rightLoc!==currLoc){return false;}
currLoc=leftLoc;}
return true;};jsts.geomgraph.EdgeEndStar.prototype.propagateSideLabels=function(geomIndex){var startLoc=jsts.geom.Location.NONE;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.isArea(geomIndex)&&label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)!==jsts.geom.Location.NONE)
startLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);}
if(startLoc===jsts.geom.Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.getLocation(geomIndex,jsts.geomgraph.Position.ON)===jsts.geom.Location.NONE)
label.setLocation(geomIndex,jsts.geomgraph.Position.ON,currLoc);if(label.isArea(geomIndex)){var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(rightLoc!==jsts.geom.Location.NONE){if(rightLoc!==currLoc)
throw new jsts.error.TopologyError('side location conflict',e.getCoordinate());if(leftLoc===jsts.geom.Location.NONE){jsts.util.Assert.shouldNeverReachHere('found single null side (at '+
e.getCoordinate()+')');}
currLoc=leftLoc;}else{jsts.util.Assert.isTrue(label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)===jsts.geom.Location.NONE,'found single null side');label.setLocation(geomIndex,jsts.geomgraph.Position.RIGHT,currLoc);label.setLocation(geomIndex,jsts.geomgraph.Position.LEFT,currLoc);}}}};jsts.geomgraph.EdgeEndStar.prototype.findIndex=function(eSearch){this.iterator();for(var i=0;i<this.edgeList.size();i++){var e=this.edgeList.get(i);if(e===eSearch)
return i;}
return-1;};jsts.operation.relate.EdgeEndBundleStar=function(){jsts.geomgraph.EdgeEndStar.apply(this,arguments);};jsts.operation.relate.EdgeEndBundleStar.prototype=new jsts.geomgraph.EdgeEndStar();jsts.operation.relate.EdgeEndBundleStar.prototype.insert=function(e){var eb=this.edgeMap.get(e);if(eb===null){eb=new jsts.operation.relate.EdgeEndBundle(e);this.insertEdgeEnd(e,eb);}
else{eb.insert(e);}};jsts.operation.relate.EdgeEndBundleStar.prototype.updateIM=function(im){for(var it=this.iterator();it.hasNext();){var esb=it.next();esb.updateIM(im);}};jsts.index.ArrayListVisitor=function(){this.items=[];};jsts.index.ArrayListVisitor.prototype.visitItem=function(item){this.items.push(item);};jsts.index.ArrayListVisitor.prototype.getItems=function(){return this.items;};jsts.algorithm.distance.DistanceToPoint=function(){};jsts.algorithm.distance.DistanceToPoint.computeDistance=function(geom,pt,ptDist){if(geom instanceof jsts.geom.LineString){jsts.algorithm.distance.DistanceToPoint.computeDistance2(geom,pt,ptDist);}else if(geom instanceof jsts.geom.Polygon){jsts.algorithm.distance.DistanceToPoint.computeDistance4(geom,pt,ptDist);}else if(geom instanceof jsts.geom.GeometryCollection){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);jsts.algorithm.distance.DistanceToPoint.computeDistance(g,pt,ptDist);}}else{ptDist.setMinimum(geom.getCoordinate(),pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance2=function(line,pt,ptDist){var tempSegment=new jsts.geom.LineSegment();var coords=line.getCoordinates();for(var i=0;i<coords.length-1;i++){tempSegment.setCoordinates(coords[i],coords[i+1]);var closestPt=tempSegment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance3=function(segment,pt,ptDist){var closestPt=segment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);};jsts.algorithm.distance.DistanceToPoint.computeDistance4=function(poly,pt,ptDist){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getExteriorRing(),pt,ptDist);for(var i=0;i<poly.getNumInteriorRing();i++){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getInteriorRingN(i),pt,ptDist);}};jsts.index.strtree.ItemBoundable=function(bounds,item){this.bounds=bounds;this.item=item;};jsts.index.strtree.ItemBoundable.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.ItemBoundable.constructor=jsts.index.strtree.ItemBoundable;jsts.index.strtree.ItemBoundable.prototype.bounds=null;jsts.index.strtree.ItemBoundable.prototype.item=null;jsts.index.strtree.ItemBoundable.prototype.getBounds=function(){return this.bounds;};jsts.index.strtree.ItemBoundable.prototype.getItem=function(){return this.item;};(function(){var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeList=function(){this.edges=new ArrayList();this.ocaMap=new TreeMap();};jsts.geomgraph.EdgeList.prototype.edges=null;jsts.geomgraph.EdgeList.prototype.ocaMap=null;jsts.geomgraph.EdgeList.prototype.add=function(e){this.edges.add(e);var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());this.ocaMap.put(oca,e);};jsts.geomgraph.EdgeList.prototype.addAll=function(edgeColl){for(var i=edgeColl.iterator();i.hasNext();){this.add(i.next());}};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.findEqualEdge=function(e){var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());var matchEdge=this.ocaMap.get(oca);return matchEdge;};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.iterator=function(){return this.edges.iterator();};jsts.geomgraph.EdgeList.prototype.get=function(i){return this.edges.get(i);};jsts.geomgraph.EdgeList.prototype.findEdgeIndex=function(e){for(var i=0;i<this.edges.size();i++){if(this.edges.get(i).equals(e))
return i;}
return-1;};})();jsts.operation.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.geom=null;jsts.operation.IsSimpleOp.prototype.isClosedEndpointsInInterior=true;jsts.operation.IsSimpleOp.prototype.nonSimpleLocation=null;jsts.operation.IsSimpleOp.prototype.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.isSimple=function(){this.nonSimpleLocation=null;if(this.geom instanceof jsts.geom.LineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiLineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiPoint){return this.isSimpleMultiPoint(this.geom);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleMultiPoint=function(mp){if(mp.isEmpty())
return true;var points=[];for(var i=0;i<mp.getNumGeometries();i++){var pt=mp.getGeometryN(i);var p=pt.getCoordinate();for(var j=0;j<points.length;j++){var point=points[j];if(p.equals2D(point)){this.nonSimpleLocation=p;return false;}}
points.push(p);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleLinearGeometry=function(geom){if(geom.isEmpty())
return true;var graph=new jsts.geomgraph.GeometryGraph(0,geom);var li=new jsts.algorithm.RobustLineIntersector();var si=graph.computeSelfNodes(li,true);if(!si.hasIntersection())
return true;if(si.hasProperIntersection()){this.nonSimpleLocation=si.getProperIntersectionPoint();return false;}
if(this.hasNonEndpointIntersection(graph))
return false;if(this.isClosedEndpointsInInterior){if(this.hasClosedEndpointIntersection(graph))
return false;}
return true;};jsts.operation.IsSimpleOp.prototype.hasNonEndpointIntersection=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();if(!ei.isEndPoint(maxSegmentIndex)){this.nonSimpleLocation=ei.getCoordinate();return true;}}}
return false;};jsts.operation.IsSimpleOp.prototype.hasClosedEndpointIntersection=function(graph){var endPoints=new javascript.util.TreeMap();for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();var isClosed=e.isClosed();var p0=e.getCoordinate(0);this.addEndpoint(endPoints,p0,isClosed);var p1=e.getCoordinate(e.getNumPoints()-1);this.addEndpoint(endPoints,p1,isClosed);}
for(var i=endPoints.values().iterator();i.hasNext();){var eiInfo=i.next();if(eiInfo.isClosed&&eiInfo.degree!=2){this.nonSimpleLocation=eiInfo.getCoordinate();return true;}}
return false;};jsts.operation.IsSimpleOp.EndpointInfo=function(pt){this.pt=pt;this.isClosed=false;this.degree=0;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.pt=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.isClosed=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.degree=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.getCoordinate=function(){return this.pt;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.addEndpoint=function(isClosed){this.degree++;this.isClosed=this.isClosed||isClosed;};jsts.operation.IsSimpleOp.prototype.addEndpoint=function(endPoints,p,isClosed){var eiInfo=endPoints.get(p);if(eiInfo===null){eiInfo=new jsts.operation.IsSimpleOp.EndpointInfo(p);endPoints.put(p,eiInfo);}
eiInfo.addEndpoint(isClosed);};(function(){var LineStringSnapper=function(){this.snapTolerance=0.0;this.seg=new jsts.geom.LineSegment();this.allowSnappingToSourceVertices=false;this.isClosed=false;this.srcPts=[];if(arguments[0]instanceof jsts.geom.LineString){this.initFromLine.apply(this,arguments);}else{this.initFromPoints.apply(this,arguments);}};LineStringSnapper.prototype.initFromLine=function(srcLine,snapTolerance){this.initFromPoints(srcLine.getCoordinates(),snapTolerance);};LineStringSnapper.prototype.initFromPoints=function(srcPts,snapTolerance){this.srcPts=srcPts;this.isClosed=this.calcIsClosed(srcPts);this.snapTolerance=snapTolerance;};LineStringSnapper.prototype.setAllowSnappingToSourceVertices=function(allowSnappingToSourceVertices){this.allowSnappingToSourceVertices=allowSnappingToSourceVertices;};LineStringSnapper.prototype.calcIsClosed=function(pts){if(pts.length<=1){return false;}
return pts[0].equals(pts[pts.length-1]);};LineStringSnapper.prototype.snapTo=function(snapPts){var coordList=new jsts.geom.CoordinateList(this.srcPts);this.snapVertices(coordList,snapPts);this.snapSegments(coordList,snapPts);return coordList.toCoordinateArray();};LineStringSnapper.prototype.snapVertices=function(srcCoords,snapPts){var end=this.isClosed?srcCoords.size()-1:srcCoords.size(),i=0,srcPt,snapVert;for(i;i<end;i++){srcPt=srcCoords.get(i);snapVert=this.findSnapForVertex(srcPt,snapPts);if(snapVert!==null){srcCoords.set(i,new jsts.geom.Coordinate(snapVert));if(i===0&&this.isClosed)
srcCoords.set(srcCoords.size()-1,new jsts.geom.Coordinate(snapVert));}}};LineStringSnapper.prototype.findSnapForVertex=function(pt,snapPts){var i=0,il=snapPts.length;for(i=0;i<il;i++){if(pt.equals(snapPts[i])){return null;}
if(pt.distance(snapPts[i])<this.snapTolerance){return snapPts[i];}}
return null;};LineStringSnapper.prototype.snapSegments=function(srcCoords,snapPts){if(snapPts.length===0){return;}
var distinctPtCount=snapPts.length,i,snapPt,index;if(snapPts.length>1&&snapPts[0].equals2D(snapPts[snapPts.length-1])){distinctPtCount=snapPts.length-1;}
i=0;for(i;i<distinctPtCount;i++){snapPt=snapPts[i];index=this.findSegmentIndexToSnap(snapPt,srcCoords);if(index>=0){srcCoords.add(index+1,new jsts.geom.Coordinate(snapPt),false);}}};LineStringSnapper.prototype.findSegmentIndexToSnap=function(snapPt,srcCoords){var minDist=Number.MAX_VALUE,snapIndex=-1,i=0,dist;for(i;i<srcCoords.size()-1;i++){this.seg.p0=srcCoords.get(i);this.seg.p1=srcCoords.get(i+1);if(this.seg.p0.equals(snapPt)||this.seg.p1.equals(snapPt)){if(this.allowSnappingToSourceVertices){continue;}else{return-1;}}
dist=this.seg.distance(snapPt);if(dist<this.snapTolerance&&dist<minDist){minDist=dist;snapIndex=i;}}
return snapIndex;};jsts.operation.overlay.snap.LineStringSnapper=LineStringSnapper;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryComponentFilter=jsts.geom.GeometryComponentFilter;var LineString=jsts.geom.LineString;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeGraph=jsts.operation.polygonize.PolygonizeGraph;var Polygonizer=function(){var that=this;var LineStringAdder=function(){};LineStringAdder.prototype=new GeometryComponentFilter();LineStringAdder.prototype.filter=function(g){if(g instanceof LineString)
that.add(g);};this.lineStringAdder=new LineStringAdder();this.dangles=new ArrayList();this.cutEdges=new ArrayList();this.invalidRingLines=new ArrayList();};Polygonizer.prototype.lineStringAdder=null;Polygonizer.prototype.graph=null;Polygonizer.prototype.dangles=null;Polygonizer.prototype.cutEdges=null;Polygonizer.prototype.invalidRingLines=null;Polygonizer.prototype.holeList=null;Polygonizer.prototype.shellList=null;Polygonizer.prototype.polyList=null;Polygonizer.prototype.add=function(geomList){if(geomList instanceof jsts.geom.LineString){return this.add3(geomList);}else if(geomList instanceof jsts.geom.Geometry){return this.add2(geomList);}
for(var i=geomList.iterator();i.hasNext();){var geometry=i.next();this.add2(geometry);}};Polygonizer.prototype.add2=function(g){g.apply(this.lineStringAdder);};Polygonizer.prototype.add3=function(line){if(this.graph==null)
this.graph=new PolygonizeGraph(line.getFactory());this.graph.addEdge(line);};Polygonizer.prototype.getPolygons=function(){this.polygonize();return this.polyList;};Polygonizer.prototype.getDangles=function(){this.polygonize();return this.dangles;};Polygonizer.prototype.getCutEdges=function(){this.polygonize();return this.cutEdges;};Polygonizer.prototype.getInvalidRingLines=function(){this.polygonize();return this.invalidRingLines;};Polygonizer.prototype.polygonize=function(){if(this.polyList!=null)
return;this.polyList=new ArrayList();if(this.graph==null)
return;this.dangles=this.graph.deleteDangles();this.cutEdges=this.graph.deleteCutEdges();var edgeRingList=this.graph.getEdgeRings();var validEdgeRingList=new ArrayList();this.invalidRingLines=new ArrayList();this.findValidRings(edgeRingList,validEdgeRingList,this.invalidRingLines);this.findShellsAndHoles(validEdgeRingList);Polygonizer.assignHolesToShells(this.holeList,this.shellList);this.polyList=new ArrayList();for(var i=this.shellList.iterator();i.hasNext();){var er=i.next();this.polyList.add(er.getPolygon());}};Polygonizer.prototype.findValidRings=function(edgeRingList,validEdgeRingList,invalidRingList){for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isValid())
validEdgeRingList.add(er);else
invalidRingList.add(er.getLineString());}};Polygonizer.prototype.findShellsAndHoles=function(edgeRingList){this.holeList=new ArrayList();this.shellList=new ArrayList();for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isHole())
this.holeList.add(er);else
this.shellList.add(er);}};Polygonizer.assignHolesToShells=function(holeList,shellList){for(var i=holeList.iterator();i.hasNext();){var holeER=i.next();Polygonizer.assignHoleToShell(holeER,shellList);}};Polygonizer.assignHoleToShell=function(holeER,shellList){var shell=EdgeRing.findEdgeRingContaining(holeER,shellList);if(shell!=null)
shell.addHole(holeER.getRing());};jsts.operation.polygonize.Polygonizer=Polygonizer;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryTransformer=function(){};GeometryTransformer.prototype.inputGeom=null;GeometryTransformer.prototype.factory=null;GeometryTransformer.prototype.pruneEmptyGeometry=true;GeometryTransformer.prototype.preserveGeometryCollectionType=true;GeometryTransformer.prototype.preserveCollections=false;GeometryTransformer.prototype.reserveType=false;GeometryTransformer.prototype.getInputGeometry=function(){return this.inputGeom;};GeometryTransformer.prototype.transform=function(inputGeom){this.inputGeom=inputGeom;this.factory=inputGeom.getFactory();if(inputGeom instanceof jsts.geom.Point)
return this.transformPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPoint)
return this.transformMultiPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.LinearRing)
return this.transformLinearRing(inputGeom,null);if(inputGeom instanceof jsts.geom.LineString)
return this.transformLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiLineString)
return this.transformMultiLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.Polygon)
return this.transformPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPolygon)
return this.transformMultiPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.GeometryCollection)
return this.transformGeometryCollection(inputGeom,null);throw new jsts.error.IllegalArgumentException('Unknown Geometry subtype: '+
inputGeom.getClass().getName());};GeometryTransformer.prototype.createCoordinateSequence=function(coords){return this.factory.getCoordinateSequenceFactory().create(coords);};GeometryTransformer.prototype.copy=function(seq){return seq.clone();};GeometryTransformer.prototype.transformCoordinates=function(coords,parent){return this.copy(coords);};GeometryTransformer.prototype.transformPoint=function(geom,parent){return this.factory.createPoint(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiPoint=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPoint(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformLinearRing=function(geom,parent){var seq=this.transformCoordinates(geom.getCoordinateSequence(),geom);var seqSize=seq.length;if(seqSize>0&&seqSize<4&&!this.preserveType)
return this.factory.createLineString(seq);return this.factory.createLinearRing(seq);};GeometryTransformer.prototype.transformLineString=function(geom,parent){return this.factory.createLineString(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiLineString=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformLineString(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformPolygon=function(geom,parent){var isAllValidLinearRings=true;var shell=this.transformLinearRing(geom.getExteriorRing(),geom);if(shell==null||!(shell instanceof jsts.geom.LinearRing)||shell.isEmpty())
isAllValidLinearRings=false;var holes=new ArrayList();for(var i=0;i<geom.getNumInteriorRing();i++){var hole=this.transformLinearRing(geom.getInteriorRingN(i),geom);if(hole==null||hole.isEmpty()){continue;}
if(!(hole instanceof jsts.geom.LinearRing))
isAllValidLinearRings=false;holes.add(hole);}
if(isAllValidLinearRings)
return this.factory.createPolygon(shell,holes.toArray());else{var components=new ArrayList();if(shell!=null)
components.add(shell);components.addAll(holes);return this.factory.buildGeometry(components);}};GeometryTransformer.prototype.transformMultiPolygon=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPolygon(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformGeometryCollection=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transform(geom.getGeometryN(i));if(transformGeom==null)
continue;if(this.pruneEmptyGeometry&&transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
if(this.preserveGeometryCollectionType)
return this.factory.createGeometryCollection(GeometryFactory.toGeometryArray(transGeomList));return this.factory.buildGeometry(transGeomList);};jsts.geom.util.GeometryTransformer=GeometryTransformer;})();(function(){var LineStringSnapper=jsts.operation.overlay.snap.LineStringSnapper;var PrecisionModel=jsts.geom.PrecisionModel;var TreeSet=javascript.util.TreeSet;var SnapTransformer=function(snapTolerance,snapPts,isSelfSnap){this.snapTolerance=snapTolerance;this.snapPts=snapPts;this.isSelfSnap=isSelfSnap||false;};SnapTransformer.prototype=new jsts.geom.util.GeometryTransformer();SnapTransformer.prototype.snapTolerance=null;SnapTransformer.prototype.snapPts=null;SnapTransformer.prototype.isSelfSnap=false;SnapTransformer.prototype.transformCoordinates=function(coords,parent){var srcPts=coords;var newPts=this.snapLine(srcPts,this.snapPts);return newPts;};SnapTransformer.prototype.snapLine=function(srcPts,snapPts){var snapper=new LineStringSnapper(srcPts,this.snapTolerance);snapper.setAllowSnappingToSourceVertices(this.isSelfSnap);return snapper.snapTo(snapPts);};var GeometrySnapper=function(srcGeom){this.srcGeom=srcGeom;};GeometrySnapper.SNAP_PRECISION_FACTOR=1e-9;GeometrySnapper.computeOverlaySnapTolerance=function(g){if(arguments.length===2){return GeometrySnapper.computeOverlaySnapTolerance2.apply(this,arguments);}
var snapTolerance=this.computeSizeBasedSnapTolerance(g);var pm=g.getPrecisionModel();if(pm.getType()==PrecisionModel.FIXED){var fixedSnapTol=(1/pm.getScale())*2/1.415;if(fixedSnapTol>snapTolerance)
snapTolerance=fixedSnapTol;}
return snapTolerance;};GeometrySnapper.computeSizeBasedSnapTolerance=function(g){var env=g.getEnvelopeInternal();var minDimension=Math.min(env.getHeight(),env.getWidth());var snapTol=minDimension*GeometrySnapper.SNAP_PRECISION_FACTOR;return snapTol;};GeometrySnapper.computeOverlaySnapTolerance2=function(g0,g1){return Math.min(this.computeOverlaySnapTolerance(g0),this.computeOverlaySnapTolerance(g1));};GeometrySnapper.snap=function(g0,g1,snapTolerance){var snapGeom=[];var snapper0=new GeometrySnapper(g0);snapGeom[0]=snapper0.snapTo(g1,snapTolerance);var snapper1=new GeometrySnapper(g1);snapGeom[1]=snapper1.snapTo(snapGeom[0],snapTolerance);return snapGeom;};GeometrySnapper.snapToSelf=function(g0,snapTolerance,cleanResult){var snapper0=new GeometrySnapper(g0);return snapper0.snapToSelf(snapTolerance,cleanResult);};GeometrySnapper.prototype.srcGeom=null;GeometrySnapper.prototype.snapTo=function(snapGeom,snapTolerance){var snapPts=this.extractTargetCoordinates(snapGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts);return snapTrans.transform(this.srcGeom);};GeometrySnapper.prototype.snapToSelf=function(snapTolerance,cleanResult){var snapPts=this.extractTargetCoordinates(srcGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts,true);var snappedGeom=snapTrans.transform(srcGeom);var result=snappedGeom;if(cleanResult&&result instanceof Polygonal){result=snappedGeom.buffer(0);}
return result;};GeometrySnapper.prototype.extractTargetCoordinates=function(g){var ptSet=new TreeSet();var pts=g.getCoordinates();for(var i=0;i<pts.length;i++){ptSet.add(pts[i]);}
return ptSet.toArray();};GeometrySnapper.prototype.computeSnapTolerance=function(ringPts){var minSegLen=this.computeMinimumSegmentLength(ringPts);var snapTol=minSegLen/10;return snapTol;};GeometrySnapper.prototype.computeMinimumSegmentLength=function(pts){var minSegLen=Number.MAX_VALUE;for(var i=0;i<pts.length-1;i++){var segLen=pts[i].distance(pts[i+1]);if(segLen<minSegLen)
minSegLen=segLen;}
return minSegLen;};jsts.operation.overlay.snap.GeometrySnapper=GeometrySnapper;})();jsts.algorithm.PointLocator=function(boundaryRule){this.boundaryRule=boundaryRule?boundaryRule:jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;};jsts.algorithm.PointLocator.prototype.boundaryRule=null;jsts.algorithm.PointLocator.prototype.isIn=null;jsts.algorithm.PointLocator.prototype.numBoundaries=null;jsts.algorithm.PointLocator.prototype.intersects=function(p,geom){return this.locate(p,geom)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(geom instanceof jsts.geom.Point){return this.locate2(p,geom);}else if(geom instanceof jsts.geom.LineString){return this.locate3(p,geom);}else if(geom instanceof jsts.geom.Polygon){return this.locate4(p,geom);}
this.isIn=false;this.numBoundaries=0;this.computeLocation(p,geom);if(this.boundaryRule.isInBoundary(this.numBoundaries))
return jsts.geom.Location.BOUNDARY;if(this.numBoundaries>0||this.isIn)
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.computeLocation=function(p,geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon){this.updateLocationInfo(this.locate(p,geom));}else if(geom instanceof jsts.geom.MultiLineString){var ml=geom;for(var i=0;i<ml.getNumGeometries();i++){var l=ml.getGeometryN(i);this.updateLocationInfo(this.locate(p,l));}}else if(geom instanceof jsts.geom.MultiPolygon){var mpoly=geom;for(var i=0;i<mpoly.getNumGeometries();i++){var poly=mpoly.getGeometryN(i);this.updateLocationInfo(this.locate(p,poly));}}else if(geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){var part=geom.getGeometryN(i);if(part!==geom){this.computeLocation(p,part);}}}};jsts.algorithm.PointLocator.prototype.updateLocationInfo=function(loc){if(loc===jsts.geom.Location.INTERIOR)
this.isIn=true;if(loc===jsts.geom.Location.BOUNDARY)
this.numBoundaries++;};jsts.algorithm.PointLocator.prototype.locate2=function(p,pt){var ptCoord=pt.getCoordinate();if(ptCoord.equals2D(p))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate3=function(p,l){if(!l.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;var pt=l.getCoordinates();if(!l.isClosed()){if(p.equals(pt[0])||p.equals(pt[pt.length-1])){return jsts.geom.Location.BOUNDARY;}}
if(jsts.algorithm.CGAlgorithms.isOnLine(p,pt))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locateInPolygonRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring.getCoordinates());};jsts.algorithm.PointLocator.prototype.locate4=function(p,poly){if(poly.isEmpty())
return jsts.geom.Location.EXTERIOR;var shell=poly.getExteriorRing();var shellLoc=this.locateInPolygonRing(p,shell);if(shellLoc===jsts.geom.Location.EXTERIOR)
return jsts.geom.Location.EXTERIOR;if(shellLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);var holeLoc=this.locateInPolygonRing(p,hole);if(holeLoc===jsts.geom.Location.INTERIOR)
return jsts.geom.Location.EXTERIOR;if(holeLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;}
return jsts.geom.Location.INTERIOR;};(function(){var Location=jsts.geom.Location;var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.NodeMap=function(nodeFactory){this.nodeMap=new TreeMap();this.nodeFact=nodeFactory;};jsts.geomgraph.NodeMap.prototype.nodeMap=null;jsts.geomgraph.NodeMap.prototype.nodeFact=null;jsts.geomgraph.NodeMap.prototype.addNode=function(arg){var node,coord;if(arg instanceof jsts.geom.Coordinate){coord=arg;node=this.nodeMap.get(coord);if(node===null){node=this.nodeFact.createNode(coord);this.nodeMap.put(coord,node);}
return node;}else if(arg instanceof jsts.geomgraph.Node){var n=arg;coord=n.getCoordinate();node=this.nodeMap.get(coord);if(node===null){this.nodeMap.put(coord,n);return n;}
node.mergeLabel(n);return node;}};jsts.geomgraph.NodeMap.prototype.add=function(e){var p=e.getCoordinate();var n=this.addNode(p);n.add(e);};jsts.geomgraph.NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};jsts.geomgraph.NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.geomgraph.NodeMap.prototype.iterator=function(){return this.values().iterator();};jsts.geomgraph.NodeMap.prototype.getBoundaryNodes=function(geomIndex){var bdyNodes=new ArrayList();for(var i=this.iterator();i.hasNext();){var node=i.next();if(node.getLabel().getLocation(geomIndex)===Location.BOUNDARY){bdyNodes.add(node);}}
return bdyNodes;};})();(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.PlanarGraph=function(nodeFactory){this.edges=new ArrayList();this.edgeEndList=new ArrayList();this.nodes=new jsts.geomgraph.NodeMap(nodeFactory||new jsts.geomgraph.NodeFactory());};jsts.geomgraph.PlanarGraph.prototype.edges=null;jsts.geomgraph.PlanarGraph.prototype.nodes=null;jsts.geomgraph.PlanarGraph.prototype.edgeEndList=null;jsts.geomgraph.PlanarGraph.linkResultDirectedEdges=function(nodes){for(var nodeit=nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.getEdgeIterator=function(){return this.edges.iterator();};jsts.geomgraph.PlanarGraph.prototype.getEdgeEnds=function(){return this.edgeEndList;};jsts.geomgraph.PlanarGraph.prototype.isBoundaryNode=function(geomIndex,coord){var node=this.nodes.find(coord);if(node===null)
return false;var label=node.getLabel();if(label!==null&&label.getLocation(geomIndex)===jsts.geom.Location.BOUNDARY)
return true;return false;};jsts.geomgraph.PlanarGraph.prototype.insertEdge=function(e){this.edges.add(e);};jsts.geomgraph.PlanarGraph.prototype.add=function(e){this.nodes.add(e);this.edgeEndList.add(e);};jsts.geomgraph.PlanarGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};jsts.geomgraph.PlanarGraph.prototype.getNodes=function(){return this.nodes.values();};jsts.geomgraph.PlanarGraph.prototype.addNode=function(node){return this.nodes.addNode(node);};jsts.geomgraph.PlanarGraph.prototype.addEdges=function(edgesToAdd){for(var it=edgesToAdd.iterator();it.hasNext();){var e=it.next();this.edges.add(e);var de1=new jsts.geomgraph.DirectedEdge(e,true);var de2=new jsts.geomgraph.DirectedEdge(e,false);de1.setSym(de2);de2.setSym(de1);this.add(de1);this.add(de2);}};jsts.geomgraph.PlanarGraph.prototype.linkResultDirectedEdges=function(){for(var nodeit=this.nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.findEdgeInSameDirection=function(p0,p1){var i=0,il=this.edges.size(),e,eCoord;for(i;i<il;i++){e=this.edges.get(i);eCoord=e.getCoordinates();if(this.matchInSameDirection(p0,p1,eCoord[0],eCoord[1])){return e;}
if(this.matchInSameDirection(p0,p1,eCoord[eCoord.length-1],eCoord[eCoord.length-2])){return e;}}
return null;};jsts.geomgraph.PlanarGraph.prototype.matchInSameDirection=function(p0,p1,ep0,ep1){if(!p0.equals(ep0)){return false;}
if(jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,ep1)===jsts.algorithm.CGAlgorithms.COLLINEAR&&jsts.geomgraph.Quadrant.quadrant(p0,p1)===jsts.geomgraph.Quadrant.quadrant(ep0,ep1)){return true;}
return false;};jsts.geomgraph.PlanarGraph.prototype.findEdgeEnd=function(e){for(var i=this.getEdgeEnds().iterator();i.hasNext();){var ee=i.next();if(ee.getEdge()===e){return ee;}}
return null;};})();jsts.noding.SegmentIntersector=function(){};jsts.noding.SegmentIntersector.prototype.processIntersections=jsts.abstractFunc;jsts.noding.SegmentIntersector.prototype.isDone=jsts.abstractFunc;(function(){var SegmentIntersector=jsts.noding.SegmentIntersector;var ArrayList=javascript.util.ArrayList;jsts.noding.InteriorIntersectionFinder=function(li){this.li=li;this.intersections=new ArrayList();this.interiorIntersection=null;};jsts.noding.InteriorIntersectionFinder.prototype=new SegmentIntersector();jsts.noding.InteriorIntersectionFinder.constructor=jsts.noding.InteriorIntersectionFinder;jsts.noding.InteriorIntersectionFinder.prototype.findAllIntersections=false;jsts.noding.InteriorIntersectionFinder.prototype.isCheckEndSegmentsOnly=false;jsts.noding.InteriorIntersectionFinder.prototype.li=null;jsts.noding.InteriorIntersectionFinder.prototype.interiorIntersection=null;jsts.noding.InteriorIntersectionFinder.prototype.intSegments=null;jsts.noding.InteriorIntersectionFinder.prototype.intersections=null;jsts.noding.InteriorIntersectionFinder.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersections=function(){return intersections;};jsts.noding.InteriorIntersectionFinder.prototype.setCheckEndSegmentsOnly=function(isCheckEndSegmentsOnly){this.isCheckEndSegmentsOnly=isCheckEndSegmentsOnly;}
jsts.noding.InteriorIntersectionFinder.prototype.hasIntersection=function(){return this.interiorIntersection!=null;};jsts.noding.InteriorIntersectionFinder.prototype.getInteriorIntersection=function(){return this.interiorIntersection;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersectionSegments=function(){return this.intSegments;};jsts.noding.InteriorIntersectionFinder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(this.hasIntersection())
return;if(e0==e1&&segIndex0==segIndex1)
return;if(this.isCheckEndSegmentsOnly){var isEndSegPresent=this.isEndSegment(e0,segIndex0)||isEndSegment(e1,segIndex1);if(!isEndSegPresent)
return;}
var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){this.intSegments=[];this.intSegments[0]=p00;this.intSegments[1]=p01;this.intSegments[2]=p10;this.intSegments[3]=p11;this.interiorIntersection=this.li.getIntersection(0);this.intersections.add(this.interiorIntersection);}}};jsts.noding.InteriorIntersectionFinder.prototype.isEndSegment=function(segStr,index){if(index==0)
return true;if(index>=segStr.size()-2)
return true;return false;};jsts.noding.InteriorIntersectionFinder.prototype.isDone=function(){if(this.findAllIntersections)
return false;return this.interiorIntersection!=null;};})();(function(){var RobustLineIntersector=jsts.algorithm.RobustLineIntersector;var InteriorIntersectionFinder=jsts.noding.InteriorIntersectionFinder;var MCIndexNoder=jsts.noding.MCIndexNoder;jsts.noding.FastNodingValidator=function(segStrings){this.li=new RobustLineIntersector();this.segStrings=segStrings;};jsts.noding.FastNodingValidator.prototype.li=null;jsts.noding.FastNodingValidator.prototype.segStrings=null;jsts.noding.FastNodingValidator.prototype.findAllIntersections=false;jsts.noding.FastNodingValidator.prototype.segInt=null;jsts.noding.FastNodingValidator.prototype._isValid=true;jsts.noding.FastNodingValidator.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.FastNodingValidator.prototype.getIntersections=function(){return segInt.getIntersections();};jsts.noding.FastNodingValidator.prototype.isValid=function(){this.execute();return this._isValid;};jsts.noding.FastNodingValidator.prototype.getErrorMessage=function(){if(this._isValid)
return'no intersections found';var intSegs=this.segInt.getIntersectionSegments();return'found non-noded intersection between '+
jsts.io.WKTWriter.toLineString(intSegs[0],intSegs[1])+' and '+
jsts.io.WKTWriter.toLineString(intSegs[2],intSegs[3]);};jsts.noding.FastNodingValidator.prototype.checkValid=function(){this.execute();if(!this._isValid)
throw new jsts.error.TopologyError(this.getErrorMessage(),this.segInt.getInteriorIntersection());};jsts.noding.FastNodingValidator.prototype.execute=function(){if(this.segInt!=null)
return;this.checkInteriorIntersections();};jsts.noding.FastNodingValidator.prototype.checkInteriorIntersections=function(){this._isValid=true;this.segInt=new InteriorIntersectionFinder(this.li);this.segInt.setFindAllIntersections(this.findAllIntersections);var noder=new MCIndexNoder();noder.setSegmentIntersector(this.segInt);noder.computeNodes(this.segStrings);if(this.segInt.hasIntersection()){this._isValid=false;return;}};})();(function(){jsts.noding.BasicSegmentString=function(pts,data){this.pts=pts;this.data=data;};jsts.noding.BasicSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.BasicSegmentString.prototype.pts=null;jsts.noding.BasicSegmentString.prototype.data=null;jsts.noding.BasicSegmentString.prototype.getData=function(){return this.data;}
jsts.noding.BasicSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.BasicSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.BasicSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.BasicSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.BasicSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.BasicSegmentString.prototype.getSegmentOctant=function(index){if(index==this.pts.length-1)
return-1;return jsts.noding.Octant.octant(this.getCoordinate(index),this.getCoordinate(index+1));};})();(function(){var FastNodingValidator=jsts.noding.FastNodingValidator;var BasicSegmentString=jsts.noding.BasicSegmentString;var ArrayList=javascript.util.ArrayList;jsts.geomgraph.EdgeNodingValidator=function(edges){this.nv=new FastNodingValidator(jsts.geomgraph.EdgeNodingValidator.toSegmentStrings(edges));};jsts.geomgraph.EdgeNodingValidator.checkValid=function(edges){var validator=new jsts.geomgraph.EdgeNodingValidator(edges);validator.checkValid();};jsts.geomgraph.EdgeNodingValidator.toSegmentStrings=function(edges){var segStrings=new ArrayList();for(var i=edges.iterator();i.hasNext();){var e=i.next();segStrings.add(new BasicSegmentString(e.getCoordinates(),e));}
return segStrings;};jsts.geomgraph.EdgeNodingValidator.prototype.nv=null;jsts.geomgraph.EdgeNodingValidator.prototype.checkValid=function(){this.nv.checkValid();};})();jsts.operation.GeometryGraphOperation=function(g0,g1,boundaryNodeRule){this.li=new jsts.algorithm.RobustLineIntersector();this.arg=[];if(g0===undefined){return;}
if(g1===undefined){this.setComputationPrecision(g0.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0);return;}
boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(g0.getPrecisionModel().compareTo(g1.getPrecisionModel())>=0)
this.setComputationPrecision(g0.getPrecisionModel());else
this.setComputationPrecision(g1.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0,boundaryNodeRule);this.arg[1]=new jsts.geomgraph.GeometryGraph(1,g1,boundaryNodeRule);};jsts.operation.GeometryGraphOperation.prototype.li=null;jsts.operation.GeometryGraphOperation.prototype.resultPrecisionModel=null;jsts.operation.GeometryGraphOperation.prototype.arg=null;jsts.operation.GeometryGraphOperation.prototype.getArgGeometry=function(i){return arg[i].getGeometry();};jsts.operation.GeometryGraphOperation.prototype.setComputationPrecision=function(pm){this.resultPrecisionModel=pm;this.li.setPrecisionModel(this.resultPrecisionModel);};jsts.operation.overlay.OverlayNodeFactory=function(){};jsts.operation.overlay.OverlayNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.overlay.OverlayNodeFactory.constructor=jsts.operation.overlay.OverlayNodeFactory;jsts.operation.overlay.OverlayNodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,new jsts.geomgraph.DirectedEdgeStar());};jsts.operation.overlay.PolygonBuilder=function(geometryFactory){this.shellList=[];this.geometryFactory=geometryFactory;};jsts.operation.overlay.PolygonBuilder.prototype.geometryFactory=null;jsts.operation.overlay.PolygonBuilder.prototype.shellList=null;jsts.operation.overlay.PolygonBuilder.prototype.add=function(graph){if(arguments.length===2){this.add2.apply(this,arguments);return;}
this.add2(graph.getEdgeEnds(),graph.getNodes());};jsts.operation.overlay.PolygonBuilder.prototype.add2=function(dirEdges,nodes){jsts.geomgraph.PlanarGraph.linkResultDirectedEdges(nodes);var maxEdgeRings=this.buildMaximalEdgeRings(dirEdges);var freeHoleList=[];var edgeRings=this.buildMinimalEdgeRings(maxEdgeRings,this.shellList,freeHoleList);this.sortShellsAndHoles(edgeRings,this.shellList,freeHoleList);this.placeFreeHoles(this.shellList,freeHoleList);};jsts.operation.overlay.PolygonBuilder.prototype.getPolygons=function(){var resultPolyList=this.computePolygons(this.shellList);return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.buildMaximalEdgeRings=function(dirEdges){var maxEdgeRings=[];for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getLabel().isArea()){if(de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);maxEdgeRings.push(er);er.setInResult();}}}
return maxEdgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.buildMinimalEdgeRings=function(maxEdgeRings,shellList,freeHoleList){var edgeRings=[];for(var i=0;i<maxEdgeRings.length;i++){var er=maxEdgeRings[i];if(er.getMaxNodeDegree()>2){er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var shell=this.findShell(minEdgeRings);if(shell!==null){this.placePolygonHoles(shell,minEdgeRings);shellList.push(shell);}else{freeHoleList=freeHoleList.concat(minEdgeRings);}}else{edgeRings.push(er);}}
return edgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.findShell=function(minEdgeRings){var shellCount=0;var shell=null;for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(!er.isHole()){shell=er;shellCount++;}}
jsts.util.Assert.isTrue(shellCount<=1,'found two shells in MinimalEdgeRing list');return shell;};jsts.operation.overlay.PolygonBuilder.prototype.placePolygonHoles=function(shell,minEdgeRings){for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(er.isHole()){er.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.sortShellsAndHoles=function(edgeRings,shellList,freeHoleList){for(var i=0;i<edgeRings.length;i++){var er=edgeRings[i];if(er.isHole()){freeHoleList.push(er);}else{shellList.push(er);}}};jsts.operation.overlay.PolygonBuilder.prototype.placeFreeHoles=function(shellList,freeHoleList){for(var i=0;i<freeHoleList.length;i++){var hole=freeHoleList[i];if(hole.getShell()==null){var shell=this.findEdgeRingContaining(hole,shellList);if(shell===null)
throw new jsts.error.TopologyError('unable to assign hole to a shell',hole.getCoordinate(0));hole.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getLinearRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var i=0;i<shellList.length;i++){var tryShell=shellList[i];var tryRing=tryShell.getLinearRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!==null)
minEnv=minShell.getLinearRing().getEnvelopeInternal();var isContained=false;if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};jsts.operation.overlay.PolygonBuilder.prototype.computePolygons=function(shellList){var resultPolyList=new javascript.util.ArrayList();for(var i=0;i<shellList.length;i++){var er=shellList[i];var poly=er.toPolygon(this.geometryFactory);resultPolyList.add(poly);}
return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.containsPoint=function(p){for(var i=0;i<this.shellList.length;i++){var er=this.shellList[i];if(er.containsPoint(p))
return true;}
return false;};(function(){var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;var LineBuilder=function(op,geometryFactory,ptLocator){this.lineEdgesList=new ArrayList();this.resultLineList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;this.ptLocator=ptLocator;};LineBuilder.prototype.op=null;LineBuilder.prototype.geometryFactory=null;LineBuilder.prototype.ptLocator=null;LineBuilder.prototype.lineEdgesList=null;LineBuilder.prototype.resultLineList=null;LineBuilder.prototype.build=function(opCode){this.findCoveredLineEdges();this.collectLines(opCode);this.buildLines(opCode);return this.resultLineList;};LineBuilder.prototype.findCoveredLineEdges=function(){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().findCoveredLineEdges();}
for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();var e=de.getEdge();if(de.isLineEdge()&&!e.isCoveredSet()){var isCovered=this.op.isCoveredByA(de.getCoordinate());e.setCovered(isCovered);}}};LineBuilder.prototype.collectLines=function(opCode){for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();this.collectLineEdge(de,opCode,this.lineEdgesList);this.collectBoundaryTouchEdge(de,opCode,this.lineEdgesList);}};LineBuilder.prototype.collectLineEdge=function(de,opCode,edges){var label=de.getLabel();var e=de.getEdge();if(de.isLineEdge()){if(!de.isVisited()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&!e.isCovered()){edges.add(e);de.setVisitedEdge(true);}}};LineBuilder.prototype.collectBoundaryTouchEdge=function(de,opCode,edges){var label=de.getLabel();if(de.isLineEdge())
return;if(de.isVisited())
return;if(de.isInteriorAreaEdge())
return;if(de.getEdge().isInResult())
return;Assert.isTrue(!(de.isInResult()||de.getSym().isInResult())||!de.getEdge().isInResult());if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){edges.add(de.getEdge());de.setVisitedEdge(true);}};LineBuilder.prototype.buildLines=function(opCode){for(var it=this.lineEdgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();var line=this.geometryFactory.createLineString(e.getCoordinates());this.resultLineList.add(line);e.setInResult(true);}};LineBuilder.prototype.labelIsolatedLines=function(edgesList){for(var it=edgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(e.isIsolated()){if(label.isNull(0))
this.labelIsolatedLine(e,0);else
this.labelIsolatedLine(e,1);}}};LineBuilder.prototype.labelIsolatedLine=function(e,targetIndex){var loc=ptLocator.locate(e.getCoordinate(),op.getArgGeometry(targetIndex));e.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.LineBuilder=LineBuilder;})();(function(){var ArrayList=javascript.util.ArrayList;var PointBuilder=function(op,geometryFactory,ptLocator){this.resultPointList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;};PointBuilder.prototype.op=null;PointBuilder.prototype.geometryFactory=null;PointBuilder.prototype.resultPointList=null;PointBuilder.prototype.build=function(opCode){this.extractNonCoveredResultNodes(opCode);return this.resultPointList;};PointBuilder.prototype.extractNonCoveredResultNodes=function(opCode){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var n=nodeit.next();if(n.isInResult())
continue;if(n.isIncidentEdgeInResult())
continue;if(n.getEdges().getDegree()===0||opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){var label=n.getLabel();if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)){this.filterCoveredNodeToPoint(n);}}}};PointBuilder.prototype.filterCoveredNodeToPoint=function(n){var coord=n.getCoordinate();if(!this.op.isCoveredByLA(coord)){var pt=this.geometryFactory.createPoint(coord);this.resultPointList.add(pt);}};jsts.operation.overlay.PointBuilder=PointBuilder;})();(function(){var PointLocator=jsts.algorithm.PointLocator;var Location=jsts.geom.Location;var EdgeList=jsts.geomgraph.EdgeList;var Label=jsts.geomgraph.Label;var PlanarGraph=jsts.geomgraph.PlanarGraph;var Position=jsts.geomgraph.Position;var EdgeNodingValidator=jsts.geomgraph.EdgeNodingValidator;var GeometryGraphOperation=jsts.operation.GeometryGraphOperation;var OverlayNodeFactory=jsts.operation.overlay.OverlayNodeFactory;var PolygonBuilder=jsts.operation.overlay.PolygonBuilder;var LineBuilder=jsts.operation.overlay.LineBuilder;var PointBuilder=jsts.operation.overlay.PointBuilder;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.overlay.OverlayOp=function(g0,g1){this.ptLocator=new PointLocator();this.edgeList=new EdgeList();this.resultPolyList=new ArrayList();this.resultLineList=new ArrayList();this.resultPointList=new ArrayList();GeometryGraphOperation.call(this,g0,g1);this.graph=new PlanarGraph(new OverlayNodeFactory());this.geomFact=g0.getFactory();};jsts.operation.overlay.OverlayOp.prototype=new GeometryGraphOperation();jsts.operation.overlay.OverlayOp.constructor=jsts.operation.overlay.OverlayOp;jsts.operation.overlay.OverlayOp.INTERSECTION=1;jsts.operation.overlay.OverlayOp.UNION=2;jsts.operation.overlay.OverlayOp.DIFFERENCE=3;jsts.operation.overlay.OverlayOp.SYMDIFFERENCE=4;jsts.operation.overlay.OverlayOp.overlayOp=function(geom0,geom1,opCode){var gov=new jsts.operation.overlay.OverlayOp(geom0,geom1);var geomOv=gov.getResultGeometry(opCode);return geomOv;}
jsts.operation.overlay.OverlayOp.isResultOfOp=function(label,opCode){if(arguments.length===3){return jsts.operation.overlay.OverlayOp.isResultOfOp2.apply(this,arguments);}
var loc0=label.getLocation(0);var loc1=label.getLocation(1);return jsts.operation.overlay.OverlayOp.isResultOfOp2(loc0,loc1,opCode);}
jsts.operation.overlay.OverlayOp.isResultOfOp2=function(loc0,loc1,opCode){if(loc0==Location.BOUNDARY)
loc0=Location.INTERIOR;if(loc1==Location.BOUNDARY)
loc1=Location.INTERIOR;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:return loc0==Location.INTERIOR&&loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.UNION:return loc0==Location.INTERIOR||loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.DIFFERENCE:return loc0==Location.INTERIOR&&loc1!=Location.INTERIOR;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:return(loc0==Location.INTERIOR&&loc1!=Location.INTERIOR)||(loc0!=Location.INTERIOR&&loc1==Location.INTERIOR);}
return false;}
jsts.operation.overlay.OverlayOp.prototype.ptLocator=null;jsts.operation.overlay.OverlayOp.prototype.geomFact=null;jsts.operation.overlay.OverlayOp.prototype.resultGeom=null;jsts.operation.overlay.OverlayOp.prototype.graph=null;jsts.operation.overlay.OverlayOp.prototype.edgeList=null;jsts.operation.overlay.OverlayOp.prototype.resultPolyList=null;jsts.operation.overlay.OverlayOp.prototype.resultLineList=null;jsts.operation.overlay.OverlayOp.prototype.resultPointList=null;jsts.operation.overlay.OverlayOp.prototype.getResultGeometry=function(funcCode){this.computeOverlay(funcCode);return this.resultGeom;}
jsts.operation.overlay.OverlayOp.prototype.getGraph=function(){return this.graph;}
jsts.operation.overlay.OverlayOp.prototype.computeOverlay=function(opCode){this.copyPoints(0);this.copyPoints(1);this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);this.arg[0].computeEdgeIntersections(this.arg[1],this.li,true);var baseSplitEdges=new ArrayList();this.arg[0].computeSplitEdges(baseSplitEdges);this.arg[1].computeSplitEdges(baseSplitEdges);var splitEdges=baseSplitEdges;this.insertUniqueEdges(baseSplitEdges);this.computeLabelsFromDepths();this.replaceCollapsedEdges();EdgeNodingValidator.checkValid(this.edgeList.getEdges());this.graph.addEdges(this.edgeList.getEdges());this.computeLabelling();this.labelIncompleteNodes();this.findResultAreaEdges(opCode);this.cancelDuplicateResultEdges();var polyBuilder=new PolygonBuilder(this.geomFact);polyBuilder.add(this.graph);this.resultPolyList=polyBuilder.getPolygons();var lineBuilder=new LineBuilder(this,this.geomFact,this.ptLocator);this.resultLineList=lineBuilder.build(opCode);var pointBuilder=new PointBuilder(this,this.geomFact,this.ptLocator);this.resultPointList=pointBuilder.build(opCode);this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,opCode);}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdges=function(edges){for(var i=edges.iterator();i.hasNext();){var e=i.next();this.insertUniqueEdge(e);}}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!==null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new Label(e.getLabel());labelToMerge.flip();}
var depth=existingEdge.getDepth();if(depth.isNull()){depth.add(existingLabel);}
depth.add(labelToMerge);existingLabel.merge(labelToMerge);}else{this.edgeList.add(e);}};jsts.operation.overlay.OverlayOp.prototype.computeLabelsFromDepths=function(){for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();var lbl=e.getLabel();var depth=e.getDepth();if(!depth.isNull()){depth.normalize();for(var i=0;i<2;i++){if(!lbl.isNull(i)&&lbl.isArea()&&!depth.isNull(i)){if(depth.getDelta(i)==0){lbl.toLine(i);}else{Assert.isTrue(!depth.isNull(i,Position.LEFT),'depth of LEFT side has not been initialized');lbl.setLocation(i,Position.LEFT,depth.getLocation(i,Position.LEFT));Assert.isTrue(!depth.isNull(i,Position.RIGHT),'depth of RIGHT side has not been initialized');lbl.setLocation(i,Position.RIGHT,depth.getLocation(i,Position.RIGHT));}}}}}}
jsts.operation.overlay.OverlayOp.prototype.replaceCollapsedEdges=function(){var newEdges=new ArrayList();for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();if(e.isCollapsed()){it.remove();newEdges.add(e.getCollapsedEdge());}}
this.edgeList.addAll(newEdges);}
jsts.operation.overlay.OverlayOp.prototype.copyPoints=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.graph.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}}
jsts.operation.overlay.OverlayOp.prototype.computeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().computeLabelling(this.arg);}
this.mergeSymLabels();this.updateNodeLabelling();}
jsts.operation.overlay.OverlayOp.prototype.mergeSymLabels=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().mergeSymLabels();}}
jsts.operation.overlay.OverlayOp.prototype.updateNodeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();var lbl=node.getEdges().getLabel();node.getLabel().merge(lbl);}}
jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNodes=function(){var nodeCount=0;for(var ni=this.graph.getNodes().iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();if(n.isIsolated()){nodeCount++;if(label.isNull(0))
this.labelIncompleteNode(n,0);else
this.labelIncompleteNode(n,1);}
n.getEdges().updateLabelling(label);}};jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.OverlayOp.prototype.findResultAreaEdges=function(opCode){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var label=de.getLabel();if(label.isArea()&&!de.isInteriorAreaEdge()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label.getLocation(0,Position.RIGHT),label.getLocation(1,Position.RIGHT),opCode)){de.setInResult(true);}}};jsts.operation.overlay.OverlayOp.prototype.cancelDuplicateResultEdges=function(){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var sym=de.getSym();if(de.isInResult()&&sym.isInResult()){de.setInResult(false);sym.setInResult(false);}}};jsts.operation.overlay.OverlayOp.prototype.isCoveredByLA=function(coord){if(this.isCovered(coord,this.resultLineList))
return true;if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCoveredByA=function(coord){if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCovered=function(coord,geomList){for(var it=geomList.iterator();it.hasNext();){var geom=it.next();var loc=this.ptLocator.locate(coord,geom);if(loc!=Location.EXTERIOR)
return true;}
return false;};jsts.operation.overlay.OverlayOp.prototype.computeGeometry=function(resultPointList,resultLineList,resultPolyList,opcode){var geomList=new ArrayList();geomList.addAll(resultPointList);geomList.addAll(resultLineList);geomList.addAll(resultPolyList);return this.geomFact.buildGeometry(geomList);};jsts.operation.overlay.OverlayOp.prototype.createEmptyResult=function(opCode){var result=null;switch(resultDimension(opCode,this.arg[0].getGeometry(),this.arg[1].getGeometry())){case-1:result=geomFact.createGeometryCollection();break;case 0:result=geomFact.createPoint(null);break;case 1:result=geomFact.createLineString(null);break;case 2:result=geomFact.createPolygon(null,null);break;}
return result;};jsts.operation.overlay.OverlayOp.prototype.resultDimension=function(opCode,g0,g1){var dim0=g0.getDimension();var dim1=g1.getDimension();var resultDimension=-1;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:resultDimension=Math.min(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.UNION:resultDimension=Math.max(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.DIFFERENCE:resultDimension=dim0;break;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:resultDimension=Math.max(dim0,dim1);break;}
return resultDimension;};})();(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var GeometrySnapper=jsts.operation.overlay.snap.GeometrySnapper;var SnapOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;this.computeSnapTolerance();};SnapOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapOverlayOp.intersection=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapOverlayOp.union=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.UNION);};SnapOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapOverlayOp.prototype.geom=null;SnapOverlayOp.prototype.snapTolerance=null;SnapOverlayOp.prototype.computeSnapTolerance=function(){this.snapTolerance=GeometrySnapper.computeOverlaySnapTolerance(this.geom[0],this.geom[1]);};SnapOverlayOp.prototype.getResultGeometry=function(opCode){var prepGeom=this.snap(this.geom);var result=OverlayOp.overlayOp(prepGeom[0],prepGeom[1],opCode);return this.prepareResult(result);};SnapOverlayOp.prototype.selfSnap=function(geom){var snapper0=new GeometrySnapper(geom);var snapGeom=snapper0.snapTo(geom,this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.snap=function(geom){var remGeom=geom;var snapGeom=GeometrySnapper.snap(remGeom[0],remGeom[1],this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.prepareResult=function(geom){return geom;};SnapOverlayOp.prototype.cbr=null;SnapOverlayOp.prototype.removeCommonBits=function(geom){this.cbr=new jsts.precision.CommonBitsRemover();this.cbr.add(this.geom[0]);this.cbr.add(this.geom[1]);var remGeom=[];remGeom[0]=cbr.removeCommonBits(this.geom[0].clone());remGeom[1]=cbr.removeCommonBits(this.geom[1].clone());return remGeom;};jsts.operation.overlay.snap.SnapOverlayOp=SnapOverlayOp;})();jsts.geomgraph.index.EdgeSetIntersector=function(){};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.SimpleMCSweepLineIntersector=function(){this.events=[];};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.events=null;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.addList2(edges,null);}else{this.addList(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.addList2(edges0,edges0);this.addList2(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.addList.apply(this,arguments);return;}
var mce=edge.getMonotoneChainEdge();var startIndex=mce.getStartIndexes();for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.geomgraph.index.MonotoneChain(mce,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(mce.getMinX(i),mc,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(mce.getMaxX(i),insertEvent));}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList=function(edges){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edge);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edgeSet);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var mc0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var mc1=ev1.getObject();if(!ev0.isSameLabel(ev1)){mc0.computeIntersections(mc1,si);this.nOverlaps++;}}}};jsts.algorithm.locate.SimplePointInAreaLocator=function(geom){this.geom=geom;};jsts.algorithm.locate.SimplePointInAreaLocator.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,geom))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint=function(p,geom){if(geom instanceof jsts.geom.Polygon){return jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon(p,geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){for(var i=0;i<geom.geometries.length;i++){var g2=geom.geometries[i];if(g2!==geom)
if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,g2))
return true;}}
return false;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon=function(p,poly){if(poly.isEmpty())
return false;var shell=poly.getExteriorRing();if(!jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,shell))
return false;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);if(jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,hole))
return false;}
return true;};jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return false;return jsts.algorithm.CGAlgorithms.isPointInRing(p,ring.getCoordinates());};jsts.algorithm.locate.SimplePointInAreaLocator.prototype.geom=null;jsts.algorithm.locate.SimplePointInAreaLocator.prototype.locate=function(p){return jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEndStar=jsts.geomgraph.EdgeEndStar;var Assert=jsts.util.Assert;jsts.geomgraph.DirectedEdgeStar=function(){jsts.geomgraph.EdgeEndStar.call(this);};jsts.geomgraph.DirectedEdgeStar.prototype=new EdgeEndStar();jsts.geomgraph.DirectedEdgeStar.constructor=jsts.geomgraph.DirectedEdgeStar;jsts.geomgraph.DirectedEdgeStar.prototype.resultAreaEdgeList=null;jsts.geomgraph.DirectedEdgeStar.prototype.label=null;jsts.geomgraph.DirectedEdgeStar.prototype.insert=function(ee){var de=ee;this.insertEdgeEnd(de,de);};jsts.geomgraph.DirectedEdgeStar.prototype.getLabel=function(){return this.label;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult())
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(er){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.getEdgeRing()===er)
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getRightmostEdge=function(){var edges=this.getEdges();var size=edges.size();if(size<1)
return null;var de0=edges.get(0);if(size==1)
return de0;var deLast=edges.get(size-1);var quad0=de0.getQuadrant();var quad1=deLast.getQuadrant();if(jsts.geomgraph.Quadrant.isNorthern(quad0)&&jsts.geomgraph.Quadrant.isNorthern(quad1))
return de0;else if(!jsts.geomgraph.Quadrant.isNorthern(quad0)&&!jsts.geomgraph.Quadrant.isNorthern(quad1))
return deLast;else{var nonHorizontalEdge=null;if(de0.getDy()!=0)
return de0;else if(deLast.getDy()!=0)
return deLast;}
Assert.shouldNeverReachHere('found two horizontal edges incident on node');return null;};jsts.geomgraph.DirectedEdgeStar.prototype.computeLabelling=function(geom){EdgeEndStar.prototype.computeLabelling.call(this,geom);this.label=new jsts.geomgraph.Label(Location.NONE);for(var it=this.iterator();it.hasNext();){var ee=it.next();var e=ee.getEdge();var eLabel=e.getLabel();for(var i=0;i<2;i++){var eLoc=eLabel.getLocation(i);if(eLoc===Location.INTERIOR||eLoc===Location.BOUNDARY)
this.label.setLocation(i,Location.INTERIOR);}}};jsts.geomgraph.DirectedEdgeStar.prototype.mergeSymLabels=function(){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.merge(de.getSym().getLabel());}};jsts.geomgraph.DirectedEdgeStar.prototype.updateLabelling=function(nodeLabel){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.setAllLocationsIfNull(0,nodeLabel.getLocation(0));label.setAllLocationsIfNull(1,nodeLabel.getLocation(1));}};jsts.geomgraph.DirectedEdgeStar.prototype.getResultAreaEdges=function(){if(this.resultAreaEdgeList!==null)
return this.resultAreaEdgeList;this.resultAreaEdgeList=new javascript.util.ArrayList();for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult()||de.getSym().isInResult())
this.resultAreaEdgeList.add(de);}
return this.resultAreaEdgeList;};jsts.geomgraph.DirectedEdgeStar.prototype.SCANNING_FOR_INCOMING=1;jsts.geomgraph.DirectedEdgeStar.prototype.LINKING_TO_OUTGOING=2;jsts.geomgraph.DirectedEdgeStar.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=0;i<this.resultAreaEdgeList.size();i++){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(!nextOut.getLabel().isArea())
continue;if(firstOut===null&&nextOut.isInResult())
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(!nextIn.isInResult())
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!nextOut.isInResult())
continue;incoming.setNext(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){if(firstOut===null)
throw new jsts.error.TopologyError('no outgoing dirEdge found',this.getCoordinate());Assert.isTrue(firstOut.isInResult(),'unable to link last incoming dirEdge');incoming.setNext(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkMinimalDirectedEdges=function(er){var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=this.resultAreaEdgeList.size()-1;i>=0;i--){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(firstOut===null&&nextOut.getEdgeRing()===er)
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(nextIn.getEdgeRing()!=er)
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(nextOut.getEdgeRing()!==er)
continue;incoming.setNextMin(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){Assert.isTrue(firstOut!==null,'found null for first outgoing dirEdge');Assert.isTrue(firstOut.getEdgeRing()===er,'unable to link last incoming dirEdge');incoming.setNextMin(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkAllDirectedEdges=function(){this.getEdges();var prevOut=null;var firstIn=null;for(var i=this.edgeList.size()-1;i>=0;i--){var nextOut=this.edgeList.get(i);var nextIn=nextOut.getSym();if(firstIn===null)
firstIn=nextIn;if(prevOut!==null)
nextIn.setNext(prevOut);prevOut=nextOut;}
firstIn.setNext(prevOut);};jsts.geomgraph.DirectedEdgeStar.prototype.findCoveredLineEdges=function(){var startLoc=Location.NONE;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(!nextOut.isLineEdge()){if(nextOut.isInResult()){startLoc=Location.INTERIOR;break;}
if(nextIn.isInResult()){startLoc=Location.EXTERIOR;break;}}}
if(startLoc===Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(nextOut.isLineEdge()){nextOut.getEdge().setCovered(currLoc===Location.INTERIOR);}else{if(nextOut.isInResult())
currLoc=Location.EXTERIOR;if(nextIn.isInResult())
currLoc=Location.INTERIOR;}}};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths=function(de){if(arguments.length===2){this.computeDepths2.apply(this,arguments);return;}
var edgeIndex=this.findIndex(de);var label=de.getLabel();var startDepth=de.getDepth(Position.LEFT);var targetLastDepth=de.getDepth(Position.RIGHT);var nextDepth=this.computeDepths2(edgeIndex+1,this.edgeList.size(),startDepth);var lastDepth=this.computeDepths2(0,edgeIndex,nextDepth);if(lastDepth!=targetLastDepth)
throw new jsts.error.TopologyError('depth mismatch at '+
de.getCoordinate());};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths2=function(startIndex,endIndex,startDepth){var currDepth=startDepth;for(var i=startIndex;i<endIndex;i++){var nextDe=this.edgeList.get(i);var label=nextDe.getLabel();nextDe.setEdgeDepths(Position.RIGHT,currDepth);currDepth=nextDe.getDepth(Position.LEFT);}
return currDepth;};})();jsts.algorithm.CentroidLine=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidLine.prototype.centSum=null;jsts.algorithm.CentroidLine.prototype.totalLength=0.0;jsts.algorithm.CentroidLine.prototype.add=function(geom){if(geom instanceof Array){this.add2.apply(this,arguments);return;}
if(geom instanceof jsts.geom.LineString){this.add(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){var poly=geom;this.add(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.add(poly.getInteriorRingN(i).getCoordinates());}}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidLine.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;return cent;};jsts.algorithm.CentroidLine.prototype.add2=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.index.IntervalSize=function(){};jsts.index.IntervalSize.MIN_BINARY_EXPONENT=-50;jsts.index.IntervalSize.isZeroWidth=function(min,max){var width=max-min;if(width===0.0){return true;}
var maxAbs,scaledInterval,level;maxAbs=Math.max(Math.abs(min),Math.abs(max));scaledInterval=width/maxAbs;level=jsts.index.DoubleBits.exponent(scaledInterval);return level<=jsts.index.IntervalSize.MIN_BINARY_EXPONENT;};jsts.geomgraph.index.SimpleEdgeSetIntersector=function(){};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
this.nOverlaps=0;for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges.iterator();i1.hasNext();){var edge1=i1.next();if(testAllSegments||edge0!=edge1)
this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.nOverlaps=0;for(var i0=edges0.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges1.iterator();i1.hasNext();){var edge1=i1.next();this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersects=function(e0,e1,si){var pts0=e0.getCoordinates();var pts1=e1.getCoordinates();var i0,i1;for(i0=0;i0<pts0.length-1;i0++){for(i1=0;i1<pts1.length-1;i1++){si.addIntersections(e0,i0,e1,i1);}}};jsts.geomgraph.Edge=function(pts,label){this.pts=pts;this.label=label;this.eiList=new jsts.geomgraph.EdgeIntersectionList(this);this.depth=new jsts.geomgraph.Depth();};jsts.geomgraph.Edge.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Edge.constructor=jsts.geomgraph.Edge;jsts.geomgraph.Edge.updateIM=function(label,im){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.ON),label.getLocation(1,jsts.geomgraph.Position.ON),1);if(label.isArea()){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.LEFT),label.getLocation(1,jsts.geomgraph.Position.LEFT),2);im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.RIGHT),label.getLocation(1,jsts.geomgraph.Position.RIGHT),2);}};jsts.geomgraph.Edge.prototype.pts=null;jsts.geomgraph.Edge.prototype.env=null;jsts.geomgraph.Edge.prototype.name=null;jsts.geomgraph.Edge.prototype.mce=null;jsts.geomgraph.Edge.prototype._isIsolated=true;jsts.geomgraph.Edge.prototype.depth=null;jsts.geomgraph.Edge.prototype.depthDelta=0;jsts.geomgraph.Edge.prototype.eiList=null;jsts.geomgraph.Edge.prototype.getNumPoints=function(){return this.pts.length;};jsts.geomgraph.Edge.prototype.getEnvelope=function(){if(this.env===null){this.env=new jsts.geom.Envelope();for(var i=0;i<this.pts.length;i++){this.env.expandToInclude(pts[i]);}}
return env;};jsts.geomgraph.Edge.prototype.getDepth=function(){return this.depth;};jsts.geomgraph.Edge.prototype.getDepthDelta=function(){return this.depthDelta;};jsts.geomgraph.Edge.prototype.setDepthDelta=function(depthDelta){this.depthDelta=depthDelta;};jsts.geomgraph.Edge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.Edge.prototype.getCoordinate=function(i){if(i===undefined){if(this.pts.length>0){return this.pts[0];}else{return null;}}
return this.pts[i];};jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.setIsolated=function(isIsolated){this._isIsolated=isIsolated;};jsts.geomgraph.Edge.prototype.isIsolated=function(){return this._isIsolated;};jsts.geomgraph.Edge.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.geomgraph.Edge.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));var normalizedSegmentIndex=segmentIndex;var dist=li.getEdgeDistance(geomIndex,intIndex);var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;dist=0.0;}}
var ei=this.eiList.add(intPt,normalizedSegmentIndex,dist);};jsts.geomgraph.Edge.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1;};jsts.geomgraph.Edge.prototype.getEdgeIntersectionList=function(){return this.eiList;};jsts.geomgraph.Edge.prototype.getMonotoneChainEdge=function(){if(this.mce==null){this.mce=new jsts.geomgraph.index.MonotoneChainEdge(this);}
return this.mce;};jsts.geomgraph.Edge.prototype.isClosed=function()
{return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.isCollapsed=function()
{if(!this.label.isArea())return false;if(this.pts.length!=3)return false;if(this.pts[0].equals(this.pts[2]))return true;return false;};jsts.geomgraph.Edge.prototype.getCollapsedEdge=function()
{var newPts=[];newPts[0]=this.pts[0];newPts[1]=this.pts[1];var newe=new jsts.geomgraph.Edge(newPts,jsts.geomgraph.Label.toLineLabel(this.label));return newe;};jsts.geomgraph.Edge.prototype.computeIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.geomgraph.Edge.prototype.isPointwiseEqual=function(e)
{if(this.pts.length!=e.pts.length)return false;for(var i=0;i<this.pts.length;i++){if(!this.pts[i].equals2D(e.pts[i])){return false;}}
return true;};jsts.noding.Octant=function(){throw jsts.error.AbstractMethodInvocationError();};jsts.noding.Octant.octant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.noding.Octant.octant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for point ( '+dx+', '+dy+' )');var adx=Math.abs(dx);var ady=Math.abs(dy);if(dx>=0){if(dy>=0){if(adx>=ady)
return 0;else
return 1;}
else{if(adx>=ady)
return 7;else
return 6;}}
else{if(dy>=0){if(adx>=ady)
return 3;else
return 2;}
else{if(adx>=ady)
return 4;else
return 5;}}};jsts.noding.Octant.octant2=function(p0,p1){var dx=p1.x-p0.x;var dy=p1.y-p0.y;if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for two identical points '+p0);return jsts.noding.Octant.octant(dx,dy);};jsts.operation.union.UnionInteracting=function(g0,g1){this.g0=g0;this.g1=g1;this.geomFactory=g0.getFactory();this.interacts0=[];this.interacts1=[];};jsts.operation.union.UnionInteracting.union=function(g0,g1){var uue=new jsts.operation.union.UnionInteracting(g0,g1);return uue.union();};jsts.operation.union.UnionInteracting.prototype.geomFactory=null;jsts.operation.union.UnionInteracting.prototype.g0=null;jsts.operation.union.UnionInteracting.prototype.g1=null;jsts.operation.union.UnionInteracting.prototype.interacts0=null;jsts.operation.union.UnionInteracting.prototype.interacts1=null;jsts.operation.union.UnionInteracting.prototype.union=function(){this.computeInteracting();var int0=this.extractElements(this.g0,this.interacts0,true);var int1=this.extractElements(this.g1,this.interacts1,true);if(int0.isEmpty()||int1.isEmpty()){}
var union=in0.union(int1);var disjoint0=this.extractElements(this.g0,this.interacts0,false);var disjoint1=this.extractElements(this.g1,this.interacts1,false);var overallUnion=jsts.geom.util.GeometryCombiner.combine(union,disjoint0,disjoint1);return overallUnion;};jsts.operation.union.UnionInteracting.prototype.bufferUnion=function(g0,g1){var factory=g0.getFactory();var gColl=factory.createGeometryCollection([g0,g1]);var unionAll=gColl.buffer(0.0);return unionAll;};jsts.operation.union.UnionInteracting.prototype.computeInteracting=function(elem0){if(!elem0){for(var i=0,l=this.g0.getNumGeometries();i<l;i++){var elem=this.g0.getGeometryN(i);this.interacts0[i]=this.computeInteracting(elem);}}
else{var interactsWithAny=false;for(var i=0,l=g1.getNumGeometries();i<l;i++){var elem1=this.g1.getGeometryN(i);var interacts=elem1.getEnvelopeInternal().intersects(elem0.getEnvelopeInternal());if(interacts){this.interacts1[i]=true;interactsWithAny=true;}}
return interactsWithAny;}};jsts.operation.union.UnionInteracting.prototype.extractElements=function(geom,interacts,isInteracting){var extractedGeoms=[];for(var i=0,l=geom.getNumGeometries();i<l;i++){var elem=geom.getGeometryN(i);if(interacts[i]===isInteracting){extractedGeoms.push(elem);}}
return this.geomFactory.buildGeometry(extractedGeoms);};jsts.triangulate.quadedge.TrianglePredicate=function(){};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNonRobust=function(a,b,c,p){var isInCircle=(a.x*a.x+a.y*a.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(b,c,p)-
(b.x*b.x+b.y*b.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,c,p)+
(c.x*c.x+c.y*c.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,p)-
(p.x*p.x+p.y*p.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,c)>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,disc;adx=a.x-p.x;ady=a.y-p.y;bdx=b.x-p.x;bdy=b.y-p.y;cdx=c.x-p.x;cdy=c.y-p.y;abdet=adx*bdy-bdx*ady;bcdet=bdx*cdy-cdx*bdy;cadet=cdx*ady-adx*cdy;alift=adx*adx+ady*ady;blift=bdx*bdx+bdy*bdy;clift=cdx*cdx+cdy*cdy;disc=alift*bcdet+blift*cadet+clift*abdet;return disc>0;};jsts.triangulate.quadedge.TrianglePredicate.triArea=function(a,b,c){return(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust=function(a,b,c,p){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized(a,b,c,p);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDSlow=function(a,b,c,p){var px,py,ax,ay,bx,by,cx,cy,aTerm,bTerm,cTerm,pTerm,sum,isInCircle;px=jsts.math.DD.valueOf(p.x);py=jsts.math.DD.valueOf(p.y);ax=jsts.math.DD.valueOf(a.x);ay=jsts.math.DD.valueOf(a.y);bx=jsts.math.DD.valueOf(b.x);by=jsts.math.DD.valueOf(b.y);cx=jsts.math.DD.valueOf(c.x);cy=jsts.math.DD.valueOf(c.y);aTerm=(ax.multiply(ax).add(ay.multiply(ay))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(bx,by,cx,cy,px,py));bTerm=(bx.multiply(bx).add(by.multiply(by))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,cx,cy,px,py));cTerm=(cx.multiply(cx).add(cy.multiply(cy))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,px,py));pTerm=(px.multiply(px).add(py.multiply(py))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,cx,cy));sum=aTerm.subtract(bTerm).add(cTerm).subtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow=function(ax,ay,bx,by,cx,cy){return(bx.subtract(ax).multiply(cy.subtract(ay)).subtract(by.subtract(ay).multiply(cx.subtract(ax))));};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDFast=function(a,b,c,p){var aTerm,bTerm,cTerm,pTerm,sum,isInCircle;aTerm=(jsts.math.DD.sqr(a.x).selfAdd(jsts.math.DD.sqr(a.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(b,c,p));bTerm=(jsts.math.DD.sqr(b.x).selfAdd(jsts.math.DD.sqr(b.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,c,p));cTerm=(jsts.math.DD.sqr(c.x).selfAdd(jsts.math.DD.sqr(c.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,p));pTerm=(jsts.math.DD.sqr(p.x).selfAdd(jsts.math.DD.sqr(p.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,c));sum=aTerm.selfSubtract(bTerm).selfAdd(cTerm).selfSubtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast=function(a,b,c){var t1,t2;t1=jsts.math.DD.valueOf(b.x).selfSubtract(a.x).selfMultiply(jsts.math.DD.valueOf(c.y).selfSubtract(a.y));t2=jsts.math.DD.valueOf(b.y).selSubtract(a.y).selfMultiply(jsts.math.DD.valueOf(c.x).selfSubtract(a.x));return t1.selfSubtract(t2);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,sum,isInCircle;adx=jsts.math.DD.valueOf(a.x).selfSubtract(p.x);ady=jsts.math.DD.valueOf(a.y).selfSubtract(p.y);bdx=jsts.math.DD.valueOf(b.x).selfSubtract(p.x);bdx=jsts.math.DD.valueOf(b.y).selfSubtract(p.y);cdx=jsts.math.DD.valueOf(c.x).selfSubtract(p.x);cdx=jsts.math.DD.valueOf(c.y).selfSubtract(p.y);abdet=adx.multiply(bdy).selfSubtract(bdx.multiply(ady));bcdet=bdx.multiply(cdy).selfSubtract(cdx.multiply(bdy));cadet=cdx.multiply(ady).selfSubtract(adx.multiply(cdy));alift=adx.multiply(adx).selfAdd(ady.multiply(ady));blift=bdx.multiply(bdx).selfAdd(bdy.multiply(bdy));clift=cdx.multiply(cdx).selfAdd(cdy.multiply(cdy));sum=alift.selfMultiply(bcdet).selfAdd(blift.selfMultiply(cadet)).selfAdd(clift.selfMultiply(abdet));isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleCC=function(a,b,c,p){var cc,ccRadius,pRadiusDiff;cc=jsts.geom.Triangle.circumcentre(a,b,c);ccRadius=a.distance(cc);pRadiusDiff=p.distance(cc)-ccRadius;return pRadiusDiff<=0;};jsts.operation.union.PointGeometryUnion=function(pointGeom,otherGeom){this.pointGeom=pointGeom;this.otherGeom=otherGeom;this.geomFact=otherGeom.getFactory();};jsts.operation.union.PointGeometryUnion.union=function(pointGeom,otherGeom){var unioner=new jsts.operation.union.PointGeometryUnion(pointGeom,otherGeom);return unioner.union();};jsts.operation.union.PointGeometryUnion.prototype.pointGeom=null;jsts.operation.union.PointGeometryUnion.prototype.otherGeom=null;jsts.operation.union.PointGeometryUnion.prototype.geomFact=null;jsts.operation.union.PointGeometryUnion.prototype.union=function(){var locator=new jsts.algorithm.PointLocator();var exteriorCoords=[];for(var i=0,l=this.pointGeom.getNumGeometries();i<l;i++){var point=this.pointGeom.getGeometryN(i);var coord=point.getCoordinate();var loc=locator.locate(coord,this.otherGeom);if(loc===jsts.geom.Location.EXTERIOR){var include=true;for(var j=exteriorCoords.length;i--;){if(exteriorCoords[j].equals(coord)){include=false;break;}}
if(include){exteriorCoords.push(coord);}}}
exteriorCoords.sort(function(x,y){return x.compareTo(y);});if(exteriorCoords.length===0){return this.otherGeom;}
var ptComp=null;var coords=jsts.geom.CoordinateArrays.toCoordinateArray(exteriorCoords);if(coords.length===1){ptComp=this.geomFact.createPoint(coords[0]);}
else{ptComp=this.geomFact.createMultiPoint(coords);}
return jsts.geom.util.GeometryCombiner.combine(ptComp,this.otherGeom);};jsts.noding.IntersectionFinderAdder=function(li){this.li=li;this.interiorIntersections=new javascript.util.ArrayList();};jsts.noding.IntersectionFinderAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionFinderAdder.constructor=jsts.noding.IntersectionFinderAdder;jsts.noding.IntersectionFinderAdder.prototype.li=null;jsts.noding.IntersectionFinderAdder.prototype.interiorIntersections=null;jsts.noding.IntersectionFinderAdder.prototype.getInteriorIntersections=function(){return this.interiorIntersections;};jsts.noding.IntersectionFinderAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){for(var intIndex=0;intIndex<this.li.getIntersectionNum();intIndex++){this.interiorIntersections.add(this.li.getIntersection(intIndex));}
e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}}};jsts.noding.IntersectionFinderAdder.prototype.isDone=function(){return false;};jsts.noding.snapround.MCIndexSnapRounder=function(pm){this.pm=pm;this.li=new jsts.algorithm.RobustLineIntersector();this.li.setPrecisionModel(pm);this.scaleFactor=pm.getScale();};jsts.noding.snapround.MCIndexSnapRounder.prototype=new jsts.noding.Noder();jsts.noding.snapround.MCIndexSnapRounder.constructor=jsts.noding.snapround.MCIndexSnapRounder;jsts.noding.snapround.MCIndexSnapRounder.prototype.pm=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.li=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.scaleFactor=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.noder=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.pointSnapper=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.nodedSegStrings=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.getNodedSubstrings=function(){return jsts.noding.NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeNodes=function(inputSegmentStrings){this.nodedSegStrings=inputSegmentStrings;this.noder=new jsts.noding.MCIndexNoder();this.pointSnapper=new jsts.noding.snapround.MCIndexPointSnapper(this.noder.getIndex());this.snapRound(inputSegmentStrings,this.li);};jsts.noding.snapround.MCIndexSnapRounder.prototype.snapRound=function(segStrings,li){var intersections=this.findInteriorIntersections(segStrings,li);this.computeIntersectionSnaps(intersections);this.computeVertexSnaps(segStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.findInteriorIntersections=function(segStrings,li){var intFinderAdder=new jsts.noding.IntersectionFinderAdder(li);this.noder.setSegmentIntersector(intFinderAdder);this.noder.computeNodes(segStrings);return intFinderAdder.getInteriorIntersections();};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeIntersectionSnaps=function(snapPts){for(var it=snapPts.iterator();it.hasNext();){var snapPt=it.next();var hotPixel=new jsts.noding.snapround.HotPixel(snapPt,this.scaleFactor,this.li);this.pointSnapper.snap(hotPixel);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps=function(edges){if(edges instanceof jsts.noding.NodedSegmentString){this.computeVertexSnaps2.apply(this,arguments);return;}
for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();this.computeVertexSnaps(edge0);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps2=function(e){var pts0=e.getCoordinates();for(var i=0;i<pts0.length-1;i++){var hotPixel=new jsts.noding.snapround.HotPixel(pts0[i],this.scaleFactor,this.li);var isNodeAdded=this.pointSnapper.snap(hotPixel,e,i);if(isNodeAdded){e.addIntersection(pts0[i],i);}}};jsts.operation.valid.ConnectedInteriorTester=function(geomGraph){this.geomGraph=geomGraph;this.geometryFactory=new jsts.geom.GeometryFactory();this.disconnectedRingcoord=null;};jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint=function(coord,pt){var i=0,il=coord.length;for(i;i<il;i++){if(!coord[i].equals(pt))
return coord[i];}
return null;};jsts.operation.valid.ConnectedInteriorTester.prototype.getCoordinate=function(){return this.disconnectedRingcoord;};jsts.operation.valid.ConnectedInteriorTester.prototype.isInteriorsConnected=function(){var splitEdges=new javascript.util.ArrayList();this.geomGraph.computeSplitEdges(splitEdges);var graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());graph.addEdges(splitEdges);this.setInteriorEdgesInResult(graph);graph.linkResultDirectedEdges();var edgeRings=this.buildEdgeRings(graph.getEdgeEnds());this.visitShellInteriors(this.geomGraph.getGeometry(),graph);return!this.hasUnvisitedShellEdge(edgeRings);};jsts.operation.valid.ConnectedInteriorTester.prototype.setInteriorEdgesInResult=function(graph){var it=graph.getEdgeEnds().iterator(),de;while(it.hasNext()){de=it.next();if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){de.setInResult(true);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.buildEdgeRings=function(dirEdges){var edgeRings=new javascript.util.ArrayList();for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var i=0,il=minEdgeRings.length;for(i;i<il;i++){edgeRings.add(minEdgeRings[i]);}}}
return edgeRings;};jsts.operation.valid.ConnectedInteriorTester.prototype.visitShellInteriors=function(g,graph){if(g instanceof jsts.geom.Polygon){var p=g;this.visitInteriorRing(p.getExteriorRing(),graph);}
if(g instanceof jsts.geom.MultiPolygon){var mp=g;for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);this.visitInteriorRing(p.getExteriorRing(),graph);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.visitInteriorRing=function(ring,graph){var pts=ring.getCoordinates();var pt0=pts[0];var pt1=jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint(pts,pt0);var e=graph.findEdgeInSameDirection(pt0,pt1);var de=graph.findEdgeEnd(e);var intDe=null;if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de;}else if(de.getSym().getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de.getSym();}
this.visitLinkedDirectedEdges(intDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.visitLinkedDirectedEdges=function(start){var startDe=start;var de=start;do{de.setVisited(true);de=de.getNext();}while(de!=startDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.hasUnvisitedShellEdge=function(edgeRings){for(var i=0;i<edgeRings.size();i++){var er=edgeRings.get(i);if(er.isHole()){continue;}
var edges=er.getEdges();var de=edges[0];if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)!=jsts.geom.Location.INTERIOR){continue;}
for(var j=0;j<edges.length;j++){de=edges[j];if(!de.isVisited()){disconnectedRingcoord=de.getCoordinate();return true;}}}
return false;};jsts.algorithm.InteriorPointLine=function(geometry){this.centroid;this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.addInterior(geometry);if(this.interiorPoint==null){this.addEndpoints(geometry);}};jsts.algorithm.InteriorPointLine.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointLine.prototype.addInterior=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addInteriorCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addInterior(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addInteriorCoord=function(pts){for(var i=1;i<pts.length-1;i++){this.add(pts[i]);}};jsts.algorithm.InteriorPointLine.prototype.addEndpoints=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addEndpointsCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addEndpoints(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addEndpointsCoord=function(pts){this.add(pts[0]);this.add(pts[pts.length-1]);};jsts.algorithm.InteriorPointLine.prototype.add=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.index.chain.MonotoneChainSelectAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.selectedSegment=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainSelectAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainSelectAction.prototype.selectedSegment=null;jsts.index.chain.MonotoneChainSelectAction.prototype.select=function(mc,start){mc.getLineSegment(start,this.selectedSegment);this.select2(this.selectedSegment);};jsts.index.chain.MonotoneChainSelectAction.prototype.select2=function(seg){};jsts.algorithm.MCPointInRing=function(ring){this.ring=ring;this.tree=null;this.crossings=0;this.interval=new jsts.index.bintree.Interval();this.buildIndex();};jsts.algorithm.MCPointInRing.MCSelecter=function(p,parent){this.parent=parent;this.p=p;};jsts.algorithm.MCPointInRing.MCSelecter.prototype=new jsts.index.chain.MonotoneChainSelectAction;jsts.algorithm.MCPointInRing.MCSelecter.prototype.constructor=jsts.algorithm.MCPointInRing.MCSelecter;jsts.algorithm.MCPointInRing.MCSelecter.prototype.select2=function(ls){this.parent.testLineSegment.apply(this.parent,[this.p,ls]);};jsts.algorithm.MCPointInRing.prototype.buildIndex=function(){this.tree=new jsts.index.bintree.Bintree();var pts=jsts.geom.CoordinateArrays.removeRepeatedPoints(this.ring.getCoordinates());var mcList=jsts.index.chain.MonotoneChainBuilder.getChains(pts);for(var i=0;i<mcList.length;i++){var mc=mcList[i];var mcEnv=mc.getEnvelope();this.interval.min=mcEnv.getMinY();this.interval.max=mcEnv.getMaxY();this.tree.insert(this.interval,mc);}};jsts.algorithm.MCPointInRing.prototype.isInside=function(pt){this.crossings=0;var rayEnv=new jsts.geom.Envelope(-Number.MAX_VALUE,Number.MAX_VALUE,pt.y,pt.y);this.interval.min=pt.y;this.interval.max=pt.y;var segs=this.tree.query(this.interval);var mcSelecter=new jsts.algorithm.MCPointInRing.MCSelecter(pt,this);for(var i=segs.iterator();i.hasNext();){var mc=i.next();this.testMonotoneChain(rayEnv,mcSelecter,mc);}
if((this.crossings%2)==1){return true;}
return false;};jsts.algorithm.MCPointInRing.prototype.testMonotoneChain=function(rayEnv,mcSelecter,mc){mc.select(rayEnv,mcSelecter);};jsts.algorithm.MCPointInRing.prototype.testLineSegment=function(p,seg){var xInt,x1,y1,x2,y2,p1,p2;p1=seg.p0;p2=seg.p1;x1=p1.x-p.x;y1=p1.y-p.y;x2=p2.x-p.x;y2=p2.y-p.y;if(((y1>0)&&(y2<=0))||((y2>0)&&(y1<=0))){xInt=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2)/(y2-y1);if(0.0<xInt){this.crossings++;}}};jsts.operation.valid.TopologyValidationError=function(errorType,pt){this.errorType=errorType;this.pt=null;if(pt!=null){this.pt=pt.clone();}};jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL=2;jsts.operation.valid.TopologyValidationError.NESTED_HOLES=3;jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR=4;jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION=5;jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION=6;jsts.operation.valid.TopologyValidationError.NESTED_SHELLS=7;jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS=8;jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS=9;jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE=10;jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED=11;jsts.operation.valid.TopologyValidationError.prototype.errMsg=['Topology Validation Error','Repeated Point','Hole lies outside shell','Holes are nested','Interior is disconnected','Self-intersection','Ring Self-intersection','Nested shells','Duplicate Rings','Too few distinct points in geometry component','Invalid Coordinate','Ring is not closed'];jsts.operation.valid.TopologyValidationError.prototype.getCoordinate=function(){return this.pt;};jsts.operation.valid.TopologyValidationError.prototype.getErrorType=function(){return this.errorType;};jsts.operation.valid.TopologyValidationError.prototype.getMessage=function(){return this.errMsg[this.errorType];};jsts.operation.valid.TopologyValidationError.prototype.toString=function(){var locStr='';if(this.pt!=null){locStr=' at or near point '+this.pt;return this.getMessage()+locStr;}
return locStr;};(function(){jsts.geom.MultiPolygon=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiPolygon.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPolygon.constructor=jsts.geom.MultiPolygon;jsts.geom.MultiPolygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var allRings=[];for(var i=0;i<this.geometries.length;i++){var polygon=this.geometries[i];var rings=polygon.getBoundary();for(var j=0;j<rings.getNumGeometries();j++){allRings.push(rings.getGeometryN(j));}}
return this.getFactory().createMultiLineString(allRings);};jsts.geom.MultiPolygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPolygon.prototype.CLASS_NAME='jsts.geom.MultiPolygon';})();jsts.geom.CoordinateSequenceFilter=function(){};jsts.geom.CoordinateSequenceFilter.prototype.filter=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isDone=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isGeometryChanged=jsts.abstractFunc;(function(){var Interval=function(){this.min=0.0;this.max=0.0;if(arguments.length===1){var interval=arguments[0];this.init(interval.min,interval.max);}else if(arguments.length===2){this.init(arguments[0],arguments[1]);}};Interval.prototype.init=function(min,max){this.min=min;this.max=max;if(min>max){this.min=max;this.max=min;}};Interval.prototype.getMin=function(){return this.min;};Interval.prototype.getMax=function(){return this.max;};Interval.prototype.getWidth=function(){return(this.max-this.min);};Interval.prototype.expandToInclude=function(interval){if(interval.max>this.max){this.max=interval.max;}
if(interval.min<this.min){this.min=interval.min;}};Interval.prototype.overlaps=function(){if(arguments.length===1){return this.overlapsInterval.apply(this,arguments);}else{return this.overlapsMinMax.apply(this,arguments);}};Interval.prototype.overlapsInterval=function(interval){return this.overlaps(interval.min,interval.max);};Interval.prototype.overlapsMinMax=function(min,max){if(this.min>max||this.max<min){return false;}
return true;};Interval.prototype.contains=function(){var interval;if(arguments[0]instanceof jsts.index.bintree.Interval){interval=arguments[0];return this.containsMinMax(interval.min,interval.max);}else if(arguments.length===1){return this.containsPoint(arguments[0]);}else{return this.containsMinMax(arguments[0],arguments[1]);}};Interval.prototype.containsMinMax=function(min,max){return(min>=this.min&&max<=this.max);};Interval.prototype.containsPoint=function(p){return(p>=this.min&&p<=this.max);};jsts.index.bintree.Interval=Interval;})();jsts.index.DoubleBits=function(){};jsts.index.DoubleBits.powerOf2=function(exp){return Math.pow(2,exp);};jsts.index.DoubleBits.exponent=function(d){return jsts.index.DoubleBits.CVTFWD(64,d)-1023;};jsts.index.DoubleBits.CVTFWD=function(NumW,Qty){var Sign,Expo,Mant,Bin,nb01='';var Inf={32:{d:0x7F,c:0x80,b:0,a:0},64:{d:0x7FF0,c:0,b:0,a:0}};var ExW={32:8,64:11}[NumW],MtW=NumW-ExW-1;if(!Bin){Sign=Qty<0||1/Qty<0;if(!isFinite(Qty)){Bin=Inf[NumW];if(Sign){Bin.d+=1<<(NumW/4-1);}
Expo=Math.pow(2,ExW)-1;Mant=0;}}
if(!Bin){Expo={32:127,64:1023}[NumW];Mant=Math.abs(Qty);while(Mant>=2){Expo++;Mant/=2;}
while(Mant<1&&Expo>0){Expo--;Mant*=2;}
if(Expo<=0){Mant/=2;nb01='Zero or Denormal';}
if(NumW===32&&Expo>254){nb01='Too big for Single';Bin={d:Sign?0xFF:0x7F,c:0x80,b:0,a:0};Expo=Math.pow(2,ExW)-1;Mant=0;}}
return Expo;};(function(){var DoubleBits=jsts.index.DoubleBits;var Interval=jsts.index.bintree.Interval;var Key=function(interval){this.pt=0.0;this.level=0;this.computeKey(interval);};Key.computeLevel=function(interval){var dx=interval.getWidth(),level;level=DoubleBits.exponent(dx)+1;return level;};Key.prototype.getPoint=function(){return this.pt;};Key.prototype.getLevel=function(){return this.level;};Key.prototype.getInterval=function(){return this.interval;};Key.prototype.computeKey=function(itemInterval){this.level=Key.computeLevel(itemInterval);this.interval=new Interval();this.computeInterval(this.level,itemInterval);while(!this.interval.contains(itemInterval)){this.level+=1;this.computeInterval(this.level,itemInterval);}};Key.prototype.computeInterval=function(level,itemInterval){var size=DoubleBits.powerOf2(level);this.pt=Math.floor(itemInterval.getMin()/size)*size;this.interval.init(this.pt,this.pt+size);};jsts.index.bintree.Key=Key;})();jsts.operation.buffer.SubgraphDepthLocater=function(subgraphs){this.subgraphs=[];this.seg=new jsts.geom.LineSegment();this.subgraphs=subgraphs;};jsts.operation.buffer.SubgraphDepthLocater.prototype.subgraphs=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.seg=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.getDepth=function(p){var stabbedSegments=this.findStabbedSegments(p);if(stabbedSegments.length===0)
return 0;stabbedSegments.sort();var ds=stabbedSegments[0];return ds.leftDepth;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments=function(stabbingRayLeftPt){if(arguments.length===3){this.findStabbedSegments2.apply(this,arguments);return;}
var stabbedSegments=[];for(var i=0;i<this.subgraphs.length;i++){var bsg=this.subgraphs[i];var env=bsg.getEnvelope();if(stabbingRayLeftPt.y<env.getMinY()||stabbingRayLeftPt.y>env.getMaxY())
continue;this.findStabbedSegments2(stabbingRayLeftPt,bsg.getDirectedEdges(),stabbedSegments);}
return stabbedSegments;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments2=function(stabbingRayLeftPt,dirEdges,stabbedSegments){if(arguments[1]instanceof jsts.geomgraph.DirectedEdge){this.findStabbedSegments3(stabbingRayLeftPt,dirEdges,stabbedSegments);return;}
for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.findStabbedSegments3(stabbingRayLeftPt,de,stabbedSegments);}};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments3=function(stabbingRayLeftPt,dirEdge,stabbedSegments){var pts=dirEdge.getEdge().getCoordinates();for(var i=0;i<pts.length-1;i++){this.seg.p0=pts[i];this.seg.p1=pts[i+1];if(this.seg.p0.y>this.seg.p1.y)
this.seg.reverse();var maxx=Math.max(this.seg.p0.x,this.seg.p1.x);if(maxx<stabbingRayLeftPt.x)
continue;if(this.seg.isHorizontal())
continue;if(stabbingRayLeftPt.y<this.seg.p0.y||stabbingRayLeftPt.y>this.seg.p1.y)
continue;if(jsts.algorithm.CGAlgorithms.computeOrientation(this.seg.p0,this.seg.p1,stabbingRayLeftPt)===jsts.algorithm.CGAlgorithms.RIGHT)
continue;var depth=dirEdge.getDepth(jsts.geomgraph.Position.LEFT);if(!this.seg.p0.equals(pts[i]))
depth=dirEdge.getDepth(jsts.geomgraph.Position.RIGHT);var ds=new jsts.operation.buffer.SubgraphDepthLocater.DepthSegment(this.seg,depth);stabbedSegments.push(ds);}};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment=function(seg,depth){this.upwardSeg=new jsts.geom.LineSegment(seg);this.leftDepth=depth;};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.upwardSeg=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.leftDepth=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareTo=function(obj){var other=obj;var orientIndex=this.upwardSeg.orientationIndex(other.upwardSeg);if(orientIndex===0)
orientIndex=-1*other.upwardSeg.orientationIndex(upwardSeg);if(orientIndex!==0)
return orientIndex;return this.compareX(this.upwardSeg,other.upwardSeg);};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareX=function(seg0,seg1){var compare0=seg0.p0.compareTo(seg1.p0);if(compare0!==0)
return compare0;return seg0.p1.compareTo(seg1.p1);};jsts.noding.snapround.HotPixel=function(pt,scaleFactor,li){this.corner=[];this.originalPt=pt;this.pt=pt;this.scaleFactor=scaleFactor;this.li=li;if(this.scaleFactor!==1.0){this.pt=new jsts.geom.Coordinate(this.scale(pt.x),this.scale(pt.y));this.p0Scaled=new jsts.geom.Coordinate();this.p1Scaled=new jsts.geom.Coordinate();}
this.initCorners(this.pt);};jsts.noding.snapround.HotPixel.prototype.li=null;jsts.noding.snapround.HotPixel.prototype.pt=null;jsts.noding.snapround.HotPixel.prototype.originalPt=null;jsts.noding.snapround.HotPixel.prototype.ptScaled=null;jsts.noding.snapround.HotPixel.prototype.p0Scaled=null;jsts.noding.snapround.HotPixel.prototype.p1Scaled=null;jsts.noding.snapround.HotPixel.prototype.scaleFactor=undefined;jsts.noding.snapround.HotPixel.prototype.minx=undefined;jsts.noding.snapround.HotPixel.prototype.maxx=undefined;jsts.noding.snapround.HotPixel.prototype.miny=undefined;jsts.noding.snapround.HotPixel.prototype.maxy=undefined;jsts.noding.snapround.HotPixel.prototype.corner=null;jsts.noding.snapround.HotPixel.prototype.safeEnv=null;jsts.noding.snapround.HotPixel.prototype.getCoordinate=function(){return this.originalPt;};jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR=0.75;jsts.noding.snapround.HotPixel.prototype.getSafeEnvelope=function(){if(this.safeEnv===null){var safeTolerance=jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new jsts.geom.Envelope(this.originalPt.x-safeTolerance,this.originalPt.x+safeTolerance,this.originalPt.y-safeTolerance,this.originalPt.y+safeTolerance);}
return this.safeEnv;};jsts.noding.snapround.HotPixel.prototype.initCorners=function(pt){var tolerance=0.5;this.minx=pt.x-tolerance;this.maxx=pt.x+tolerance;this.miny=pt.y-tolerance;this.maxy=pt.y+tolerance;this.corner[0]=new jsts.geom.Coordinate(this.maxx,this.maxy);this.corner[1]=new jsts.geom.Coordinate(this.minx,this.maxy);this.corner[2]=new jsts.geom.Coordinate(this.minx,this.miny);this.corner[3]=new jsts.geom.Coordinate(this.maxx,this.miny);};jsts.noding.snapround.HotPixel.prototype.scale=function(val){return Math.round(val*this.scaleFactor);};jsts.noding.snapround.HotPixel.prototype.intersects=function(p0,p1){if(this.scaleFactor===1.0)
return this.intersectsScaled(p0,p1);this.copyScaled(p0,this.p0Scaled);this.copyScaled(p1,this.p1Scaled);return this.intersectsScaled(this.p0Scaled,this.p1Scaled);};jsts.noding.snapround.HotPixel.prototype.copyScaled=function(p,pScaled){pScaled.x=this.scale(p.x);pScaled.y=this.scale(p.y);};jsts.noding.snapround.HotPixel.prototype.intersectsScaled=function(p0,p1){var segMinx=Math.min(p0.x,p1.x);var segMaxx=Math.max(p0.x,p1.x);var segMiny=Math.min(p0.y,p1.y);var segMaxy=Math.max(p0.y,p1.y);var isOutsidePixelEnv=this.maxx<segMinx||this.minx>segMaxx||this.maxy<segMiny||this.miny>segMaxy;if(isOutsidePixelEnv)
return false;var intersects=this.intersectsToleranceSquare(p0,p1);jsts.util.Assert.isTrue(!(isOutsidePixelEnv&&intersects),'Found bad envelope test');return intersects;};jsts.noding.snapround.HotPixel.prototype.intersectsToleranceSquare=function(p0,p1){var intersectsLeft=false;var intersectsBottom=false;this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.isProper())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsLeft=true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsBottom=true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.isProper())
return true;if(intersectsLeft&&intersectsBottom)
return true;if(p0.equals(this.pt))
return true;if(p1.equals(this.pt))
return true;return false;};jsts.noding.snapround.HotPixel.prototype.intersectsPixelClosure=function(p0,p1){this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.hasIntersection())
return true;return false;};jsts.noding.snapround.HotPixel.prototype.addSnappedNode=function(segStr,segIndex){var p0=segStr.getCoordinate(segIndex);var p1=segStr.getCoordinate(segIndex+1);if(this.intersects(p0,p1)){segStr.addIntersection(this.getCoordinate(),segIndex);return true;}
return false;};jsts.operation.buffer.BufferInputLineSimplifier=function(inputLine){this.inputLine=inputLine;};jsts.operation.buffer.BufferInputLineSimplifier.simplify=function(inputLine,distanceTol){var simp=new jsts.operation.buffer.BufferInputLineSimplifier(inputLine);return simp.simplify(distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.INIT=0;jsts.operation.buffer.BufferInputLineSimplifier.DELETE=1;jsts.operation.buffer.BufferInputLineSimplifier.KEEP=1;jsts.operation.buffer.BufferInputLineSimplifier.prototype.inputLine=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.distanceTol=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeleted=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.angleOrientation=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.operation.buffer.BufferInputLineSimplifier.prototype.simplify=function(distanceTol){this.distanceTol=Math.abs(distanceTol);if(distanceTol<0)
this.angleOrientation=jsts.algorithm.CGAlgorithms.CLOCKWISE;this.isDeleted=[];this.isDeleted.length=this.inputLine.length;var isChanged=false;do{isChanged=this.deleteShallowConcavities();}while(isChanged);return this.collapseLine();};jsts.operation.buffer.BufferInputLineSimplifier.prototype.deleteShallowConcavities=function(){var index=1;var maxIndex=this.inputLine.length-1;var midIndex=this.findNextNonDeletedIndex(index);var lastIndex=this.findNextNonDeletedIndex(midIndex);var isChanged=false;while(lastIndex<this.inputLine.length){var isMiddleVertexDeleted=false;if(this.isDeletable(index,midIndex,lastIndex,this.distanceTol)){this.isDeleted[midIndex]=jsts.operation.buffer.BufferInputLineSimplifier.DELETE;isMiddleVertexDeleted=true;isChanged=true;}
if(isMiddleVertexDeleted)
index=lastIndex;else
index=midIndex;midIndex=this.findNextNonDeletedIndex(index);lastIndex=this.findNextNonDeletedIndex(midIndex);}
return isChanged;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.findNextNonDeletedIndex=function(index){var next=index+1;while(next<this.inputLine.length&&this.isDeleted[next]===jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
next++;return next;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.collapseLine=function(){var coordList=[];for(var i=0;i<this.inputLine.length;i++){if(this.isDeleted[i]!==jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
coordList.push(this.inputLine[i]);}
return coordList;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeletable=function(i0,i1,i2,distanceTol){var p0=this.inputLine[i0];var p1=this.inputLine[i1];var p2=this.inputLine[i2];if(!this.isConcave(p0,p1,p2))
return false;if(!this.isShallow(p0,p1,p2,distanceTol))
return false;return this.isShallowSampled(p0,p1,i0,i2,distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowConcavity=function(p0,p1,p2,distanceTol){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isAngleToSimplify=(orientation===this.angleOrientation);if(!isAngleToSimplify)
return false;var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK=10;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowSampled=function(p0,p2,i0,i2,distanceTol){var inc=parseInt((i2-i0)/jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK);if(inc<=0)
inc=1;for(var i=i0;i<i2;i+=inc){if(!this.isShallow(p0,p2,this.inputLine[i],distanceTol))
return false;}
return true;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallow=function(p0,p1,p2,distanceTol){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isConcave=function(p0,p1,p2){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isConcave=(orientation===this.angleOrientation);return isConcave;};jsts.geomgraph.index.SweepLineEvent=function(x,obj,label){if(!(obj instanceof jsts.geomgraph.index.SweepLineEvent)){this.eventType=jsts.geomgraph.index.SweepLineEvent.INSERT;this.label=label;this.xValue=x;this.obj=obj;return;}
this.eventType=jsts.geomgraph.index.SweepLineEvent.DELETE;this.xValue=x;this.insertEvent=obj;};jsts.geomgraph.index.SweepLineEvent.INSERT=1;jsts.geomgraph.index.SweepLineEvent.DELETE=2;jsts.geomgraph.index.SweepLineEvent.prototype.label=null;jsts.geomgraph.index.SweepLineEvent.prototype.xValue=null;jsts.geomgraph.index.SweepLineEvent.prototype.eventType=null;jsts.geomgraph.index.SweepLineEvent.prototype.insertEvent=null;jsts.geomgraph.index.SweepLineEvent.prototype.deleteEventIndex=null;jsts.geomgraph.index.SweepLineEvent.prototype.obj=null;jsts.geomgraph.index.SweepLineEvent.prototype.isInsert=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.INSERT;};jsts.geomgraph.index.SweepLineEvent.prototype.isDelete=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.DELETE;};jsts.geomgraph.index.SweepLineEvent.prototype.getInsertEvent=function(){return this.insertEvent;};jsts.geomgraph.index.SweepLineEvent.prototype.getDeleteEventIndex=function(){return this.deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.setDeleteEventIndex=function(deleteEventIndex){this.deleteEventIndex=deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.getObject=function(){return this.obj;};jsts.geomgraph.index.SweepLineEvent.prototype.isSameLabel=function(ev){if(this.label==null){return false;}
return this.label==ev.label;};jsts.geomgraph.index.SweepLineEvent.prototype.compareTo=function(pe){if(this.xValue<pe.xValue){return-1;}
if(this.xValue>pe.xValue){return 1;}
if(this.eventType<pe.eventType){return-1;}
if(this.eventType>pe.eventType){return 1;}
return 0;};jsts.geom.CoordinateList=function(coord,allowRepeated){this.array=[];allowRepeated=(allowRepeated===undefined)?true:allowRepeated;if(coord!==undefined){this.add(coord,allowRepeated);}};jsts.geom.CoordinateList.prototype=new javascript.util.ArrayList();jsts.geom.CoordinateList.prototype.iterator=null;jsts.geom.CoordinateList.prototype.remove=null;jsts.geom.CoordinateList.prototype.get=function(i){return this.array[i];};jsts.geom.CoordinateList.prototype.set=function(i,e){var o=this.array[i];this.array[i]=e;return o;};jsts.geom.CoordinateList.prototype.size=function(){return this.array.length;};jsts.geom.CoordinateList.prototype.add=function(){if(arguments.length>1){return this.addCoordinates.apply(this,arguments);}else{return this.array.push(arguments[0]);}};jsts.geom.CoordinateList.prototype.addCoordinates=function(coord,allowRepeated,direction){if(coord instanceof jsts.geom.Coordinate){return this.addCoordinate.apply(this,arguments);}else if(typeof coord==='number'){return this.insertCoordinate.apply(this,arguments);}
direction=direction||true;if(direction){for(var i=0;i<coord.length;i++){this.addCoordinate(coord[i],allowRepeated);}}else{for(var i=coord.length-1;i>=0;i--){this.addCoordinate(coord[i],allowRepeated);}}
return true;};jsts.geom.CoordinateList.prototype.addCoordinate=function(coord,allowRepeated){if(!allowRepeated){if(this.size()>=1){var last=this.get(this.size()-1);if(last.equals2D(coord))return;}}
this.add(coord);};jsts.geom.CoordinateList.prototype.insertCoordinate=function(index,coord,allowRepeated){if(!allowRepeated){var before=index>0?index-1:-1;if(before!==-1&&this.get(before).equals2D(coord)){return;}
var after=index<this.size()-1?index+1:-1;if(after!==-1&&this.get(after).equals2D(coord)){return;}}
this.array.splice(index,0,coord);};jsts.geom.CoordinateList.prototype.closeRing=function(){if(this.size()>0){this.addCoordinate(new jsts.geom.Coordinate(this.get(0)),false);}};jsts.geom.CoordinateList.prototype.toArray=function(){return this.array;};jsts.geom.CoordinateList.prototype.toCoordinateArray=function(){return this.array;};jsts.operation.buffer.OffsetSegmentGenerator=function(precisionModel,bufParams,distance){this.seg0=new jsts.geom.LineSegment();this.seg1=new jsts.geom.LineSegment();this.offset0=new jsts.geom.LineSegment();this.offset1=new jsts.geom.LineSegment();this.precisionModel=precisionModel;this.bufParams=bufParams;this.li=new jsts.algorithm.RobustLineIntersector();this.filletAngleQuantum=Math.PI/2.0/bufParams.getQuadrantSegments();if(this.bufParams.getQuadrantSegments()>=8&&this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.closingSegLengthFactor=jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR;}
this.init(distance);};jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-6;jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR=80;jsts.operation.buffer.OffsetSegmentGenerator.prototype.maxCurveSegmentError=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.filletAngleQuantum=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.closingSegLengthFactor=1;jsts.operation.buffer.OffsetSegmentGenerator.prototype.segList=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.distance=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.bufParams=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.li=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s2=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.side=0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=false;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=function(){return this.hasNarrowConcaveAngle;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.init=function(distance){this.distance=distance;this.maxCurveSegmentError=this.distance*(1-Math.cos(this.filletAngleQuantum/2.0));this.segList=new jsts.operation.buffer.OffsetSegmentString();this.segList.setPrecisionModel(this.precisionModel);this.segList.setMinimumVertexDistance(this.distance*jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.initSideSegments=function(s1,s2,side){this.s1=s1;this.s2=s2;this.side=side;this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.getCoordinates=function(){return this.segList.getCoordinates();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.closeRing=function(){this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addSegments=function(pt,isForward){this.segList.addPts(pt,isForward);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFirstSegment=function(){this.segList.addPt(this.offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLastSegment=function(){this.segList.addPt(this.offset1.p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addNextSegment=function(p,addStartPoint){this.s0=this.s1;this.s1=this.s2;this.s2=p;this.seg0.setCoordinates(this.s0,this.s1);this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0);this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);if(this.s1.equals(this.s2))
return;var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.s0,this.s1,this.s2);var outsideTurn=(orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE&&this.side===jsts.geomgraph.Position.LEFT)||(orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE&&this.side===jsts.geomgraph.Position.RIGHT);if(orientation==0){this.addCollinear(addStartPoint);}else if(outsideTurn){this.addOutsideTurn(orientation,addStartPoint);}else{this.addInsideTurn(orientation,addStartPoint);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addCollinear=function(addStartPoint){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2);var numInt=this.li.getIntersectionNum();if(numInt>=2){if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL||this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.segList.addPt(this.offset1.p0);}else{this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addOutsideTurn=function(orientation,addStartPoint){if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR){this.segList.addPt(this.offset0.p1);return;}
if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance);}else if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL){this.addBevelJoin(this.offset0,this.offset1);}else{if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,orientation,this.distance);this.segList.addPt(this.offset1.p0);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addInsideTurn=function(orientation,addStartPoint){this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1);if(this.li.hasIntersection()){this.segList.addPt(this.li.getIntersection(0));}else{this.hasNarrowConcaveAngle=true;if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR){this.segList.addPt(this.offset0.p1);}else{this.segList.addPt(this.offset0.p1);if(this.closingSegLengthFactor>0){var mid0=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid0);var mid1=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid1);}else{this.segList.addPt(this.s1);}
this.segList.addPt(this.offset1.p0);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.computeOffsetSegment=function(seg,side,distance,offset){var sideSign=side===jsts.geomgraph.Position.LEFT?1:-1;var dx=seg.p1.x-seg.p0.x;var dy=seg.p1.y-seg.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=sideSign*distance*dx/len;var uy=sideSign*distance*dy/len;offset.p0.x=seg.p0.x-uy;offset.p0.y=seg.p0.y+ux;offset.p1.x=seg.p1.x-uy;offset.p1.y=seg.p1.y+ux;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLineEndCap=function(p0,p1){var seg=new jsts.geom.LineSegment(p0,p1);var offsetL=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.LEFT,this.distance,offsetL);var offsetR=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.RIGHT,this.distance,offsetR);var dx=p1.x-p0.x;var dy=p1.y-p0.y;var angle=Math.atan2(dy,dx);switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:this.segList.addPt(offsetL.p1);this.addFillet(p1,angle+Math.PI/2,angle-Math.PI/2,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_FLAT:this.segList.addPt(offsetL.p1);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:var squareCapSideOffset=new jsts.geom.Coordinate();squareCapSideOffset.x=Math.abs(this.distance)*Math.cos(angle);squareCapSideOffset.y=Math.abs(this.distance)*Math.sin(angle);var squareCapLOffset=new jsts.geom.Coordinate(offsetL.p1.x+
squareCapSideOffset.x,offsetL.p1.y+squareCapSideOffset.y);var squareCapROffset=new jsts.geom.Coordinate(offsetR.p1.x+
squareCapSideOffset.x,offsetR.p1.y+squareCapSideOffset.y);this.segList.addPt(squareCapLOffset);this.segList.addPt(squareCapROffset);break;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addMitreJoin=function(p,offset0,offset1,distance){var isMitreWithinLimit=true;var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(offset0.p0,offset0.p1,offset1.p0,offset1.p1);var mitreRatio=distance<=0.0?1.0:intPt.distance(p)/Math.abs(distance);if(mitreRatio>this.bufParams.getMitreLimit())
this.isMitreWithinLimit=false;}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=new jsts.geom.Coordinate(0,0);this.isMitreWithinLimit=false;}}
if(isMitreWithinLimit){this.segList.addPt(intPt);}else{this.addLimitedMitreJoin(offset0,offset1,distance,bufParams.getMitreLimit());}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLimitedMitreJoin=function(offset0,offset1,distance,mitreLimit){var basePt=this.seg0.p1;var ang0=jsts.algorithm.Angle.angle(basePt,this.seg0.p0);var ang1=jsts.algorithm.Angle.angle(basePt,this.seg1.p1);var angDiff=jsts.algorithm.Angle.angleBetweenOriented(this.seg0.p0,basePt,this.seg1.p1);var angDiffHalf=angDiff/2;var midAng=jsts.algorithm.Angle.normalize(ang0+angDiffHalf);var mitreMidAng=jsts.algorithm.Angle.normalize(midAng+Math.PI);var mitreDist=mitreLimit*distance;var bevelDelta=mitreDist*Math.abs(Math.sin(angDiffHalf));var bevelHalfLen=distance-bevelDelta;var bevelMidX=basePt.x+mitreDist*Math.cos(mitreMidAng);var bevelMidY=basePt.y+mitreDist*Math.sin(mitreMidAng);var bevelMidPt=new jsts.geom.Coordinate(bevelMidX,bevelMidY);var mitreMidLine=new jsts.geom.LineSegment(basePt,bevelMidPt);var bevelEndLeft=mitreMidLine.pointAlongOffset(1.0,bevelHalfLen);var bevelEndRight=mitreMidLine.pointAlongOffset(1.0,-bevelHalfLen);if(this.side==jsts.geomgraph.Position.LEFT){this.segList.addPt(bevelEndLeft);this.segList.addPt(bevelEndRight);}else{this.segList.addPt(bevelEndRight);this.segList.addPt(bevelEndLeft);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addBevelJoin=function(offset0,offset1){this.segList.addPt(offset0.p1);this.segList.addPt(offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet=function(p,p0,p1,direction,radius){if(!(p1 instanceof jsts.geom.Coordinate)){this.addFillet2.apply(this,arguments);return;}
var dx0=p0.x-p.x;var dy0=p0.y-p.y;var startAngle=Math.atan2(dy0,dx0);var dx1=p1.x-p.x;var dy1=p1.y-p.y;var endAngle=Math.atan2(dy1,dx1);if(direction===jsts.algorithm.CGAlgorithms.CLOCKWISE){if(startAngle<=endAngle)
startAngle+=2.0*Math.PI;}else{if(startAngle>=endAngle)
startAngle-=2.0*Math.PI;}
this.segList.addPt(p0);this.addFillet(p,startAngle,endAngle,direction,radius);this.segList.addPt(p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet2=function(p,startAngle,endAngle,direction,radius){var directionFactor=direction===jsts.algorithm.CGAlgorithms.CLOCKWISE?-1:1;var totalAngle=Math.abs(startAngle-endAngle);var nSegs=parseInt((totalAngle/this.filletAngleQuantum+0.5));if(nSegs<1)
return;var initAngle,currAngleInc;initAngle=0.0;currAngleInc=totalAngle/nSegs;var currAngle=initAngle;var pt=new jsts.geom.Coordinate();while(currAngle<totalAngle){var angle=startAngle+directionFactor*currAngle;pt.x=p.x+radius*Math.cos(angle);pt.y=p.y+radius*Math.sin(angle);this.segList.addPt(pt);currAngle+=currAngleInc;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createCircle=function(p){var pt=new jsts.geom.Coordinate(p.x+this.distance,p.y);this.segList.addPt(pt);this.addFillet(p,0.0,2.0*Math.PI,-1,this.distance);this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createSquare=function(p){this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y+distance));this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y+distance));this.segList.closeRing();};jsts.operation.overlay.MaximalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MaximalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MaximalEdgeRing.constructor=jsts.operation.overlay.MaximalEdgeRing;jsts.operation.overlay.MaximalEdgeRing.prototype.getNext=function(de)
{return de.getNext();};jsts.operation.overlay.MaximalEdgeRing.prototype.setEdgeRing=function(de,er)
{de.setEdgeRing(er);};jsts.operation.overlay.MaximalEdgeRing.prototype.linkDirectedEdgesForMinimalEdgeRings=function()
{var de=this.startDe;do{var node=de.getNode();node.getEdges().linkMinimalDirectedEdges(this);de=de.getNext();}while(de!=this.startDe);};jsts.operation.overlay.MaximalEdgeRing.prototype.buildMinimalRings=function()
{var minEdgeRings=[];var de=this.startDe;do{if(de.getMinEdgeRing()===null){var minEr=new jsts.operation.overlay.MinimalEdgeRing(de,this.geometryFactory);minEdgeRings.push(minEr);}
de=de.getNext();}while(de!=this.startDe);return minEdgeRings;};jsts.algorithm.CentroidPoint=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidPoint.prototype.ptCount=0;jsts.algorithm.CentroidPoint.prototype.centSum=null;jsts.algorithm.CentroidPoint.prototype.add=function(geom){if(geom instanceof jsts.geom.Point){this.add2(geom.getCoordinate());}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidPoint.prototype.add2=function(pt){this.ptCount+=1;this.centSum.x+=pt.x;this.centSum.y+=pt.y;};jsts.algorithm.CentroidPoint.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.ptCount;cent.y=this.centSum.y/this.ptCount;return cent;};jsts.operation.distance.ConnectedElementLocationFilter=function(locations){this.locations=locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype=new jsts.geom.GeometryFilter();jsts.operation.distance.ConnectedElementLocationFilter.prototype.locations=null;jsts.operation.distance.ConnectedElementLocationFilter.getLocations=function(geom){var locations=[];geom.apply(new jsts.operation.distance.ConnectedElementLocationFilter(locations));return locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon)
this.locations.push(new jsts.operation.distance.GeometryLocation(geom,0,geom.getCoordinate()));};jsts.geomgraph.index.MonotoneChainEdge=function(e){this.e=e;this.pts=e.getCoordinates();var mcb=new jsts.geomgraph.index.MonotoneChainIndexer();this.startIndex=mcb.getChainStartIndices(this.pts);};jsts.geomgraph.index.MonotoneChainEdge.prototype.e=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.pts=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.startIndex=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.env1=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.env2=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getStartIndexes=function(){return this.startIndex;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMinX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMaxX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersects=function(mce,si){for(var i=0;i<this.startIndex.length-1;i++){for(var j=0;j<mce.startIndex.length-1;j++){this.computeIntersectsForChain(i,mce,j,si);}}};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain=function(chainIndex0,mce,chainIndex1,si){this.computeIntersectsForChain2(this.startIndex[chainIndex0],this.startIndex[chainIndex0+1],mce,mce.startIndex[chainIndex1],mce.startIndex[chainIndex1+1],si);};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain2=function(start0,end0,mce,start1,end1,ei){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mce.pts[start1];var p11=mce.pts[end1];if(end0-start0==1&&end1-start1==1){ei.addIntersections(this.e,start0,mce.e,start1);return;}
this.env1.init(p00,p01);this.env2.init(p10,p11);if(!this.env1.intersects(this.env2)){return;}
var mid0=Math.floor((start0+end0)/2);var mid1=Math.floor((start1+end1)/2);if(start0<mid0){if(start1<mid1){this.computeIntersectsForChain2(start0,mid0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(start0,mid0,mce,mid1,end1,ei);}}
if(mid0<end0){if(start1<mid1){this.computeIntersectsForChain2(mid0,end0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(mid0,end0,mce,mid1,end1,ei);}}};(function(){var ArrayList=javascript.util.ArrayList;jsts.operation.relate.EdgeEndBuilder=function(){};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds=function(edges){if(arguments.length==2){this.computeEdgeEnds2.apply(this,arguments);return;}
var l=new ArrayList();for(var i=edges;i.hasNext();){var e=i.next();this.computeEdgeEnds2(e,l);}
return l;};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds2=function(edge,l){var eiList=edge.getEdgeIntersectionList();eiList.addEndpoints();var it=eiList.iterator();var eiPrev=null;var eiCurr=null;if(!it.hasNext())
return;var eiNext=it.next();do{eiPrev=eiCurr;eiCurr=eiNext;eiNext=null;if(it.hasNext())
eiNext=it.next();if(eiCurr!==null){this.createEdgeEndForPrev(edge,l,eiCurr,eiPrev);this.createEdgeEndForNext(edge,l,eiCurr,eiNext);}}while(eiCurr!==null);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForPrev=function(edge,l,eiCurr,eiPrev){var iPrev=eiCurr.segmentIndex;if(eiCurr.dist===0.0){if(iPrev===0)
return;iPrev--;}
var pPrev=edge.getCoordinate(iPrev);if(eiPrev!==null&&eiPrev.segmentIndex>=iPrev)
pPrev=eiPrev.coord;var label=new jsts.geomgraph.Label(edge.getLabel());label.flip();var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pPrev,label);l.add(e);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForNext=function(edge,l,eiCurr,eiNext){var iNext=eiCurr.segmentIndex+1;if(iNext>=edge.getNumPoints()&&eiNext===null)
return;var pNext=edge.getCoordinate(iNext);if(eiNext!==null&&eiNext.segmentIndex===eiCurr.segmentIndex)
pNext=eiNext.coord;var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pNext,new jsts.geomgraph.Label(edge.getLabel()));l.add(e);};})();(function(){var ArrayList=javascript.util.ArrayList;var TreeSet=javascript.util.TreeSet;var CoordinateFilter=jsts.geom.CoordinateFilter;jsts.util.UniqueCoordinateArrayFilter=function(){this.treeSet=new TreeSet();this.list=new ArrayList();};jsts.util.UniqueCoordinateArrayFilter.prototype=new CoordinateFilter();jsts.util.UniqueCoordinateArrayFilter.prototype.treeSet=null;jsts.util.UniqueCoordinateArrayFilter.prototype.list=null;jsts.util.UniqueCoordinateArrayFilter.prototype.getCoordinates=function(){return this.list.toArray();};jsts.util.UniqueCoordinateArrayFilter.prototype.filter=function(coord){if(!this.treeSet.contains(coord)){this.list.add(coord);this.treeSet.add(coord);}};})();(function(){var CGAlgorithms=jsts.algorithm.CGAlgorithms;var UniqueCoordinateArrayFilter=jsts.util.UniqueCoordinateArrayFilter;var Assert=jsts.util.Assert;var Stack=javascript.util.Stack;var ArrayList=javascript.util.ArrayList;var Arrays=javascript.util.Arrays;var RadialComparator=function(origin){this.origin=origin;};RadialComparator.prototype.origin=null;RadialComparator.prototype.compare=function(o1,o2){var p1=o1;var p2=o2;return RadialComparator.polarCompare(this.origin,p1,p2);};RadialComparator.polarCompare=function(o,p,q){var dxp=p.x-o.x;var dyp=p.y-o.y;var dxq=q.x-o.x;var dyq=q.y-o.y;var orient=CGAlgorithms.computeOrientation(o,p,q);if(orient==CGAlgorithms.COUNTERCLOCKWISE)
return 1;if(orient==CGAlgorithms.CLOCKWISE)
return-1;var op=dxp*dxp+dyp*dyp;var oq=dxq*dxq+dyq*dyq;if(op<oq){return-1;}
if(op>oq){return 1;}
return 0;};jsts.algorithm.ConvexHull=function(){if(arguments.length===1){var geometry=arguments[0];this.inputPts=jsts.algorithm.ConvexHull.extractCoordinates(geometry);this.geomFactory=geometry.getFactory();}else{this.pts=arguments[0];this.geomFactory=arguments[1];}};jsts.algorithm.ConvexHull.prototype.geomFactory=null;jsts.algorithm.ConvexHull.prototype.inputPts=null;jsts.algorithm.ConvexHull.extractCoordinates=function(geom){var filter=new UniqueCoordinateArrayFilter();geom.apply(filter);return filter.getCoordinates();};jsts.algorithm.ConvexHull.prototype.getConvexHull=function(){if(this.inputPts.length==0){return this.geomFactory.createGeometryCollection(null);}
if(this.inputPts.length==1){return this.geomFactory.createPoint(this.inputPts[0]);}
if(this.inputPts.length==2){return this.geomFactory.createLineString(this.inputPts);}
var reducedPts=this.inputPts;if(this.inputPts.length>50){reducedPts=this.reduce(this.inputPts);}
var sortedPts=this.preSort(reducedPts);var cHS=this.grahamScan(sortedPts);var cH=cHS.toArray();return this.lineOrPolygon(cH);};jsts.algorithm.ConvexHull.prototype.reduce=function(inputPts){var polyPts=this.computeOctRing(inputPts);if(polyPts==null)
return this.inputPts;var reducedSet=new javascript.util.TreeSet();for(var i=0;i<polyPts.length;i++){reducedSet.add(polyPts[i]);}
for(var i=0;i<inputPts.length;i++){if(!CGAlgorithms.isPointInRing(inputPts[i],polyPts)){reducedSet.add(inputPts[i]);}}
var reducedPts=reducedSet.toArray();if(reducedPts.length<3)
return this.padArray3(reducedPts);return reducedPts;};jsts.algorithm.ConvexHull.prototype.padArray3=function(pts){var pad=[];for(var i=0;i<pad.length;i++){if(i<pts.length){pad[i]=pts[i];}else
pad[i]=pts[0];}
return pad;};jsts.algorithm.ConvexHull.prototype.preSort=function(pts){var t;for(var i=1;i<pts.length;i++){if((pts[i].y<pts[0].y)||((pts[i].y==pts[0].y)&&(pts[i].x<pts[0].x))){t=pts[0];pts[0]=pts[i];pts[i]=t;}}
Arrays.sort(pts,1,pts.length,new RadialComparator(pts[0]));return pts;};jsts.algorithm.ConvexHull.prototype.grahamScan=function(c){var p;var ps=new Stack();p=ps.push(c[0]);p=ps.push(c[1]);p=ps.push(c[2]);for(var i=3;i<c.length;i++){p=ps.pop();while(!ps.empty()&&CGAlgorithms.computeOrientation(ps.peek(),p,c[i])>0){p=ps.pop();}
p=ps.push(p);p=ps.push(c[i]);}
p=ps.push(c[0]);return ps;};jsts.algorithm.ConvexHull.prototype.isBetween=function(c1,c2,c3){if(CGAlgorithms.computeOrientation(c1,c2,c3)!==0){return false;}
if(c1.x!=c3.x){if(c1.x<=c2.x&&c2.x<=c3.x){return true;}
if(c3.x<=c2.x&&c2.x<=c1.x){return true;}}
if(c1.y!=c3.y){if(c1.y<=c2.y&&c2.y<=c3.y){return true;}
if(c3.y<=c2.y&&c2.y<=c1.y){return true;}}
return false;};jsts.algorithm.ConvexHull.prototype.computeOctRing=function(inputPts){var octPts=this.computeOctPts(inputPts);var coordList=new jsts.geom.CoordinateList();coordList.add(octPts,false);if(coordList.size()<3){return null;}
coordList.closeRing();return coordList.toCoordinateArray();};jsts.algorithm.ConvexHull.prototype.computeOctPts=function(inputPts){var pts=[];for(var j=0;j<8;j++){pts[j]=inputPts[0];}
for(var i=1;i<inputPts.length;i++){if(inputPts[i].x<pts[0].x){pts[0]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y<pts[1].x-pts[1].y){pts[1]=inputPts[i];}
if(inputPts[i].y>pts[2].y){pts[2]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y>pts[3].x+pts[3].y){pts[3]=inputPts[i];}
if(inputPts[i].x>pts[4].x){pts[4]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y>pts[5].x-pts[5].y){pts[5]=inputPts[i];}
if(inputPts[i].y<pts[6].y){pts[6]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y<pts[7].x+pts[7].y){pts[7]=inputPts[i];}}
return pts;};jsts.algorithm.ConvexHull.prototype.lineOrPolygon=function(coordinates){coordinates=this.cleanRing(coordinates);if(coordinates.length==3){return this.geomFactory.createLineString([coordinates[0],coordinates[1]]);}
var linearRing=this.geomFactory.createLinearRing(coordinates);return this.geomFactory.createPolygon(linearRing,null);};jsts.algorithm.ConvexHull.prototype.cleanRing=function(original){Assert.equals(original[0],original[original.length-1]);var cleanedRing=new ArrayList();var previousDistinctCoordinate=null;for(var i=0;i<=original.length-2;i++){var currentCoordinate=original[i];var nextCoordinate=original[i+1];if(currentCoordinate.equals(nextCoordinate)){continue;}
if(previousDistinctCoordinate!=null&&this.isBetween(previousDistinctCoordinate,currentCoordinate,nextCoordinate)){continue;}
cleanedRing.add(currentCoordinate);previousDistinctCoordinate=currentCoordinate;}
cleanedRing.add(original[original.length-1]);var cleanedRingCoordinates=[];return cleanedRing.toArray(cleanedRingCoordinates);};})();jsts.algorithm.MinimumDiameter=function(inputGeom,isConvex){this.convexHullPts=null;this.minBaseSeg=new jsts.geom.LineSegment();this.minWidthPt=null;this.minPtIndex=0;this.minWidth=0;jsts.algorithm.MinimumDiameter.inputGeom=inputGeom;jsts.algorithm.MinimumDiameter.isConvex=isConvex||false;};jsts.algorithm.MinimumDiameter.inputGeom=null;jsts.algorithm.MinimumDiameter.isConvex=false;jsts.algorithm.MinimumDiameter.nextIndex=function(pts,index){index++;if(index>=pts.length){index=0;}
return index;};jsts.algorithm.MinimumDiameter.computeC=function(a,b,p){return a*p.y-b*p.x;};jsts.algorithm.MinimumDiameter.computeSegmentForLine=function(a,b,c){var p0;var p1;if(Math.abs(b)>Math.abs(a)){p0=new jsts.geom.Coordinate(0,c/b);p1=new jsts.geom.Coordinate(1,c/b-a/b);}
else{p0=new jsts.geom.Coordinate(c/a,0);p1=new jsts.geom.Coordinate(c/a-b/a,1);}
return new jsts.geom.LineSegment(p0,p1);};jsts.algorithm.MinimumDiameter.prototype.getLength=function(){this.computeMinimumDiameter();return this.minWidth;};jsts.algorithm.MinimumDiameter.prototype.getWidthCoordinate=function(){this.computeMinimumDiameter();return this.minWidthPt;};jsts.algorithm.MinimumDiameter.prototype.getSupportingSegment=function(){this.computeMinimumDiameter();var coord=[this.minBaseSeg.p0,this.minBaseSeg.p1];return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(coord);};jsts.algorithm.MinimumDiameter.prototype.getDiameter=function(){this.computeMinimumDiameter();if(this.minWidthPt===null){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(null);}
var basePt=this.minBaseSeg.project(this.minWidthPt);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString([basePt,this.minWidthPt]);};jsts.algorithm.MinimumDiameter.prototype.computeMinimumDiameter=function(){if(this.minWidthPt!==null){return;}
if(jsts.algorithm.MinimumDiameter.isConvex)
this.computeWidthConvex(jsts.algorithm.MinimumDiameter.inputGeom);else{var convexGeom=new jsts.algorithm.ConvexHull(jsts.algorithm.MinimumDiameter.inputGeom).getConvexHull();this.computeWidthConvex(convexGeom);}};jsts.algorithm.MinimumDiameter.prototype.computeWidthConvex=function(convexGeom){if(convexGeom instanceof jsts.geom.Polygon){this.convexHullPts=convexGeom.getExteriorRing().getCoordinates();}else{this.convexHullPts=convexGeom.getCoordinates();}
if(this.convexHullPts.length===0){this.minWidth=0;this.minWidthPt=null;this.minBaseSeg=null;}else if(this.convexHullPts.length===1){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[0];}else if(this.convexHullPts.length===2||this.convexHullPts.length===3){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[1];}else{this.computeConvexRingMinDiameter(this.convexHullPts);}};jsts.algorithm.MinimumDiameter.prototype.computeConvexRingMinDiameter=function(pts){this.minWidth=Number.MAX_VALUE;var currMaxIndex=1;var seg=new jsts.geom.LineSegment();for(var i=0;i<pts.length-1;i++){seg.p0=pts[i];seg.p1=pts[i+1];currMaxIndex=this.findMaxPerpDistance(pts,seg,currMaxIndex);}};jsts.algorithm.MinimumDiameter.prototype.findMaxPerpDistance=function(pts,seg,startIndex){var maxPerpDistance=seg.distancePerpendicular(pts[startIndex]);var nextPerpDistance=maxPerpDistance;var maxIndex=startIndex;var nextIndex=maxIndex;while(nextPerpDistance>=maxPerpDistance){maxPerpDistance=nextPerpDistance;maxIndex=nextIndex;nextIndex=jsts.algorithm.MinimumDiameter.nextIndex(pts,maxIndex);nextPerpDistance=seg.distancePerpendicular(pts[nextIndex]);}
if(maxPerpDistance<this.minWidth){this.minPtIndex=maxIndex;this.minWidth=maxPerpDistance;this.minWidthPt=pts[this.minPtIndex];this.minBaseSeg=new jsts.geom.LineSegment(seg);}
return maxIndex;};jsts.algorithm.MinimumDiameter.prototype.getMinimumRectangle=function(){this.computeMinimumDiameter();if(this.minWidth===0){if(this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPoint(this.minBaseSeg.p0);}
return this.minBaseSeg.toGeometry(jsts.algorithm.MinimumDiameter.inputGeom.getFactory());}
var dx=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x;var dy=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y;var minPara=Number.MAX_VALUE;var maxPara=-Number.MAX_VALUE;var minPerp=Number.MAX_VALUE;var maxPerp=-Number.MAX_VALUE;for(var i=0;i<this.convexHullPts.length;i++){var paraC=jsts.algorithm.MinimumDiameter.computeC(dx,dy,this.convexHullPts[i]);if(paraC>maxPara)maxPara=paraC;if(paraC<minPara)minPara=paraC;var perpC=jsts.algorithm.MinimumDiameter.computeC(-dy,dx,this.convexHullPts[i]);if(perpC>maxPerp)maxPerp=perpC;if(perpC<minPerp)minPerp=perpC;}
var maxPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,maxPerp);var minPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,minPerp);var maxParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,maxPara);var minParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,minPara);var p0=maxParaLine.lineIntersection(maxPerpLine);var p1=minParaLine.lineIntersection(maxPerpLine);var p2=minParaLine.lineIntersection(minPerpLine);var p3=maxParaLine.lineIntersection(minPerpLine);var shell=jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLinearRing([p0,p1,p2,p3,p0]);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPolygon(shell,null);};(function(){jsts.io.GeoJSONParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.geometryTypes=['Point','MultiPoint','LineString','MultiLineString','Polygon','MultiPolygon'];};jsts.io.GeoJSONParser.prototype.read=function(json){var obj;if(typeof json==='string'){obj=JSON.parse(json);}else{obj=json;}
var type=obj.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
if(this.geometryTypes.indexOf(type)!=-1){return this.parse[type].apply(this,[obj.coordinates]);}else if(type==='GeometryCollection'){return this.parse[type].apply(this,[obj.geometries]);}
return this.parse[type].apply(this,[obj]);};jsts.io.GeoJSONParser.prototype.parse={'Feature':function(obj){var feature={};for(var key in obj){feature[key]=obj[key];}
if(obj.geometry){var type=obj.geometry.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
feature.geometry=this.read(obj.geometry);}
if(obj.bbox){feature.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return feature;},'FeatureCollection':function(obj){var featureCollection={};if(obj.features){featureCollection.features=[];for(var i=0;i<obj.features.length;++i){featureCollection.features.push(this.read(obj.features[i]));}}
if(obj.bbox){featureCollection.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return featureCollection;},'coordinates':function(array){var coordinates=[];for(var i=0;i<array.length;++i){var sub=array[i];coordinates.push(new jsts.geom.Coordinate(sub[0],sub[1]));}
return coordinates;},'bbox':function(array){return this.geometryFactory.createLinearRing([new jsts.geom.Coordinate(array[0],array[1]),new jsts.geom.Coordinate(array[2],array[1]),new jsts.geom.Coordinate(array[2],array[3]),new jsts.geom.Coordinate(array[0],array[3]),new jsts.geom.Coordinate(array[0],array[1])]);},'Point':function(array){var coordinate=new jsts.geom.Coordinate(array[0],array[1]);return this.geometryFactory.createPoint(coordinate);},'MultiPoint':function(array){var points=[];for(var i=0;i<array.length;++i){points.push(this.parse.Point.apply(this,[array[i]]));}
return this.geometryFactory.createMultiPoint(points);},'LineString':function(array){var coordinates=this.parse.coordinates.apply(this,[array]);return this.geometryFactory.createLineString(coordinates);},'MultiLineString':function(array){var lineStrings=[];for(var i=0;i<array.length;++i){lineStrings.push(this.parse.LineString.apply(this,[array[i]]));}
return this.geometryFactory.createMultiLineString(lineStrings);},'Polygon':function(array){var shellCoordinates=this.parse.coordinates.apply(this,[array[0]]);var shell=this.geometryFactory.createLinearRing(shellCoordinates);var holes=[];for(var i=1;i<array.length;++i){var hole=array[i];var coordinates=this.parse.coordinates.apply(this,[hole]);var linearRing=this.geometryFactory.createLinearRing(coordinates);holes.push(linearRing);}
return this.geometryFactory.createPolygon(shell,holes);},'MultiPolygon':function(array){var polygons=[];for(var i=0;i<array.length;++i){var polygon=array[i];polygons.push(this.parse.Polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(polygons);},'GeometryCollection':function(array){var geometries=[];for(var i=0;i<array.length;++i){var geometry=array[i];geometries.push(this.read(geometry));}
return this.geometryFactory.createGeometryCollection(geometries);}};jsts.io.GeoJSONParser.prototype.write=function(geometry){var type=geometry.CLASS_NAME.slice(10);if(!this.extract[type]){throw new Error('Geometry is not supported');}
return this.extract[type].apply(this,[geometry]);};jsts.io.GeoJSONParser.prototype.extract={'coordinate':function(coordinate){return[coordinate.x,coordinate.y];},'Point':function(point){var array=this.extract.coordinate.apply(this,[point.coordinate]);return{type:'Point',coordinates:array};},'MultiPoint':function(multipoint){var array=[];for(var i=0;i<multipoint.geometries.length;++i){var point=multipoint.geometries[i];var geoJson=this.extract.Point.apply(this,[point]);array.push(geoJson.coordinates);}
return{type:'MultiPoint',coordinates:array};},'LineString':function(linestring){var array=[];for(var i=0;i<linestring.points.length;++i){var coordinate=linestring.points[i];array.push(this.extract.coordinate.apply(this,[coordinate]));}
return{type:'LineString',coordinates:array};},'MultiLineString':function(multilinestring){var array=[];for(var i=0;i<multilinestring.geometries.length;++i){var linestring=multilinestring.geometries[i];var geoJson=this.extract.LineString.apply(this,[linestring]);array.push(geoJson.coordinates);}
return{type:'MultiLineString',coordinates:array};},'Polygon':function(polygon){var array=[];var shellGeoJson=this.extract.LineString.apply(this,[polygon.shell]);array.push(shellGeoJson.coordinates);for(var i=0;i<polygon.holes.length;++i){var hole=polygon.holes[i];var holeGeoJson=this.extract.LineString.apply(this,[hole]);array.push(holeGeoJson.coordinates);}
return{type:'Polygon',coordinates:array};},'MultiPolygon':function(multipolygon){var array=[];for(var i=0;i<multipolygon.geometries.length;++i){var polygon=multipolygon.geometries[i];var geoJson=this.extract.Polygon.apply(this,[polygon]);array.push(geoJson.coordinates);}
return{type:'MultiPolygon',coordinates:array};},'GeometryCollection':function(collection){var array=[];for(var i=0;i<collection.geometries.length;++i){var geometry=collection.geometries[i];var type=geometry.CLASS_NAME.slice(10);array.push(this.extract[type].apply(this,[geometry]));}
return{type:'GeometryCollection',geometries:array};}};})();jsts.triangulate.quadedge.Vertex=function(){if(arguments.length===1){this.initFromCoordinate(arguments[0]);}else{this.initFromXY(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.LEFT=0;jsts.triangulate.quadedge.Vertex.RIGHT=1;jsts.triangulate.quadedge.Vertex.BEYOND=2;jsts.triangulate.quadedge.Vertex.BEHIND=3;jsts.triangulate.quadedge.Vertex.BETWEEN=4;jsts.triangulate.quadedge.Vertex.ORIGIN=5;jsts.triangulate.quadedge.Vertex.DESTINATION=6;jsts.triangulate.quadedge.Vertex.prototype.initFromXY=function(x,y){this.p=new jsts.geom.Coordinate(x,y);};jsts.triangulate.quadedge.Vertex.prototype.initFromCoordinate=function(_p){this.p=new jsts.geom.Coordinate(_p);};jsts.triangulate.quadedge.Vertex.prototype.getX=function(){return this.p.x;};jsts.triangulate.quadedge.Vertex.prototype.getY=function(){return this.p.y;};jsts.triangulate.quadedge.Vertex.prototype.getZ=function(){return this.p.z;};jsts.triangulate.quadedge.Vertex.prototype.setZ=function(z){this.p.z=z;};jsts.triangulate.quadedge.Vertex.prototype.getCoordinate=function(){return this.p;};jsts.triangulate.quadedge.Vertex.prototype.toString=function(){return'POINT ('+this.p.x+' '+this.p.y+')';};jsts.triangulate.quadedge.Vertex.prototype.equals=function(){if(arguments.length===1){return this.equalsExact(arguments[0]);}else{return this.equalsWithTolerance(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.prototype.equalsExact=function(other){return(this.p.x===other.getX()&&this.p.y===other.getY());};jsts.triangulate.quadedge.Vertex.prototype.equalsWithTolerance=function(other,tolerance){return(this.p.distance(other.getCoordinate())<tolerance);};jsts.triangulate.quadedge.Vertex.prototype.classify=function(p0,p1){var p2,a,b,sa;p2=this;a=p1.sub(p0);b=p2.sub(p0);sa=a.crossProduct(b);if(sa>0.0){return jsts.triangulate.quadedge.Vertex.LEFT;}
if(sa<0.0){return jsts.triangulate.quadedge.Vertex.RIGHT;}
if((a.getX()*b.getX()<0.0)||(a.getY()*b.getY()<0.0)){return jsts.triangulate.quadedge.Vertex.BEHIND;}
if(a.magn()<b.magn()){return jsts.triangulate.quadedge.Vertex.BEYOND;}
if(p0.equals(p2)){return jsts.triangulate.quadedge.Vertex.ORIGIN;}
if(p1.equals(p2)){return jsts.triangulate.quadedge.Vertex.DESTINATION;}
return jsts.triangulate.quadedge.Vertex.BETWEEN;};jsts.triangulate.quadedge.Vertex.prototype.crossProduct=function(v){return((this.p.x*v.getY())-(this.p.y*v.getX()));};jsts.triangulate.quadedge.Vertex.prototype.dot=function(v){return((this.p.x*v.getX())+(this.p.y*v.getY()));};jsts.triangulate.quadedge.Vertex.prototype.times=function(c){return new jsts.triangulate.quadedge.Vertex(c*this.p.x,c*this.p.y);};jsts.triangulate.quadedge.Vertex.prototype.sum=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x+v.getX(),this.p.y+
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.sub=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x-v.getX(),this.p.y-
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.magn=function(){return(Math.sqrt((this.p.x*this.p.x)+(this.p.y*this.p.y)));};jsts.triangulate.quadedge.Vertex.prototype.cross=function(){return new Vertex(this.p.y,-this.p.x);};jsts.triangulate.quadedge.Vertex.prototype.isInCircle=function(a,b,c){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust(a.p,b.p,c.p,this.p);};jsts.triangulate.quadedge.Vertex.prototype.isCCW=function(b,c){return((b.p.x-this.p.x)*(c.p.y-this.p.y)-(b.p.y-this.p.y)*(c.p.x-this.p.x)>0);};jsts.triangulate.quadedge.Vertex.prototype.rightOf=function(e){return this.isCCW(e.dest(),e.orig());};jsts.triangulate.quadedge.Vertex.prototype.leftOf=function(e){return this.isCCW(e.orig(),e.dest());};jsts.triangulate.quadedge.Vertex.prototype.bisector=function(a,b){var dx,dy,l1,l2;dx=b.getX()-a.getX();dy=b.getY()-a.getY();l1=new jsts.algorithm.HCoordinate(a.getX()+(dx/2.0),a.getY()+
(dy/2.0),1.0);l2=new jsts.algorithm.HCoordinate(a.getX()-dy+(dx/2.0),a.getY()+
dx+(dy/2.0),1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.triangulate.quadedge.Vertex.prototype.distance=function(v1,v2){return v1.p.distance(v2.p);};jsts.triangulate.quadedge.Vertex.prototype.circumRadiusRatio=function(b,c){var x,radius,edgeLength,el;x=this.circleCenter(b,c);radius=this.distance(x,b);edgeLength=this.distance(this,b);el=this.distance(b,c);if(el<edgeLength){edgeLength=el;}
el=this.distance(c,this);if(el<edgeLength){edgeLength=el;}
return radius/edgeLength;};jsts.triangulate.quadedge.Vertex.prototype.midPoint=function(a){var xm,ym;xm=(this.p.x+a.getX())/2.0;ym=(this.p.y+a.getY())/2.0;return new jsts.triangulate.quadedge.Vertex(xm,ym);};jsts.triangulate.quadedge.Vertex.prototype.circleCenter=function(b,c){var a,cab,cbc,hcc,cc;a=new jsts.triangulate.quadedge.Vertex(this.getX(),this.getY());cab=this.bisector(a,b);cbc=this.bisector(b,c);hcc=new jsts.algorithm.HCoordinate(cab,cbc);cc=null;try{cc=new jsts.triangulate.quadedge.Vertex(hcc.getX(),hcc.getY());}catch(err){}
return cc;};jsts.operation.valid.IsValidOp=function(parentGeometry){this.parentGeometry=parentGeometry;this.isSelfTouchingRingFormingHoleValid=false;this.validErr=null;};jsts.operation.valid.IsValidOp.isValid=function(arg){if(arguments[0]instanceof jsts.geom.Coordinate){if(isNaN(arg.x)){return false;}
if(!isFinite(arg.x)&&!isNaN(arg.x)){return false;}
if(isNaN(arg.y)){return false;}
if(!isFinite(arg.y)&&!isNaN(arg.y)){return false;}
return true;}else{var isValidOp=new jsts.operation.valid.IsValidOp(arg);return isValidOp.isValid();}};jsts.operation.valid.IsValidOp.findPtNotNode=function(testCoords,searchRing,graph){var searchEdge=graph.findEdge(searchRing);var eiList=searchEdge.getEdgeIntersectionList();for(var i=0;i<testCoords.length;i++){var pt=testCoords[i];if(!eiList.isIntersection(pt)){return pt;}}
return null;};jsts.operation.valid.IsValidOp.prototype.setSelfTouchingRingFormingHoleValid=function(isValid){this.isSelfTouchingRingFormingHoleValid=isValid;};jsts.operation.valid.IsValidOp.prototype.isValid=function(){this.checkValid(this.parentGeometry);return this.validErr==null;};jsts.operation.valid.IsValidOp.prototype.getValidationError=function(){this.checkValid(this.parentGeometry);return this.validErr;};jsts.operation.valid.IsValidOp.prototype.checkValid=function(g){this.validErr=null;if(g.isEmpty()){return;}
if(g instanceof jsts.geom.Point){this.checkValidPoint(g);}else if(g instanceof jsts.geom.MultiPoint){this.checkValidMultiPoint(g);}else if(g instanceof jsts.geom.LinearRing){this.checkValidLinearRing(g);}else if(g instanceof jsts.geom.LineString){this.checkValidLineString(g);}else if(g instanceof jsts.geom.Polygon){this.checkValidPolygon(g);}else if(g instanceof jsts.geom.MultiPolygon){this.checkValidMultiPolygon(g);}else if(g instanceof jsts.geom.GeometryCollection){this.checkValidGeometryCollection(g);}else{throw g.constructor;}};jsts.operation.valid.IsValidOp.prototype.checkValidPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidLineString=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidLinearRing=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
this.checkClosedRing(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
var li=new jsts.algorithm.RobustLineIntersector();graph.computeSelfNodes(li,true);this.checkNoSelfIntersectingRings(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidPolygon=function(g){this.checkInvalidCoordinates(g);if(this.validErr!=null){return;}
this.checkClosedRings(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
this.checkHolesInShell(g,graph);if(this.validErr!=null){return;}
this.checkHolesNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPolygon=function(g){var il=g.getNumGeometries();for(var i=0;i<il;i++){var p=g.getGeometryN(i);this.checkInvalidCoordinates(p);if(this.validErr!=null){return;}
this.checkClosedRings(p);if(this.validErr!=null){return;}}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesInShell(p,graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesNotNested(p,graph);if(this.validErr!=null){return;}}
this.checkShellsNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidGeometryCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.checkValid(g);if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkInvalidCoordinates=function(arg){if(arg instanceof jsts.geom.Polygon){var poly=arg;this.checkInvalidCoordinates(poly.getExteriorRing().getCoordinates());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkInvalidCoordinates(poly.getInteriorRingN(i).getCoordinates());if(this.validErr!=null){return;}}}else{var coords=arg;for(var i=0;i<coords.length;i++){if(!jsts.operation.valid.IsValidOp.isValid(coords[i])){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE,coords[i]);return;}}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRings=function(poly){this.checkClosedRing(poly.getExteriorRing());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkClosedRing(poly.getInteriorRingN(i));if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRing=function(ring){if(!ring.isClosed()){var pt=null;if(ring.getNumPoints()>=1){pt=ring.getCoordinateN(0);}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED,pt);}};jsts.operation.valid.IsValidOp.prototype.checkTooFewPoints=function(graph){if(graph.hasTooFewPoints){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS,graph.getInvalidPoint());return;}};jsts.operation.valid.IsValidOp.prototype.checkConsistentArea=function(graph){var cat=new jsts.operation.valid.ConsistentAreaTester(graph);var isValidArea=cat.isNodeConsistentArea();if(!isValidArea){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION,cat.getInvalidPoint());return;}
if(cat.hasDuplicateRings()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS,cat.getInvalidPoint());}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRings=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();this.checkNoSelfIntersectingRing(e.getEdgeIntersectionList());if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRing=function(eiList){var nodeSet=[];var isFirst=true;for(var i=eiList.iterator();i.hasNext();){var ei=i.next();if(isFirst){isFirst=false;continue;}
if(nodeSet.indexOf(ei.coord)>=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION,ei.coord);return;}else{nodeSet.push(ei.coord);}}};jsts.operation.valid.IsValidOp.prototype.checkHolesInShell=function(p,graph){var shell=p.getExteriorRing();var pir=new jsts.algorithm.MCPointInRing(shell);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(hole.getCoordinates(),shell,graph);if(holePt==null){return;}
var outside=!pir.isInside(holePt);if(outside){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL,holePt);return;}}};jsts.operation.valid.IsValidOp.prototype.checkHolesNotNested=function(p,graph){var nestedTester=new jsts.operation.valid.IndexedNestedRingTester(graph);for(var i=0;i<p.getNumInteriorRing();i++){var innerHole=p.getInteriorRingN(i);nestedTester.add(innerHole);}
var isNonNested=nestedTester.isNonNested();if(!isNonNested){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_HOLES,nestedTester.getNestedPoint());}};jsts.operation.valid.IsValidOp.prototype.checkShellsNotNested=function(mp,graph){for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);var shell=p.getExteriorRing();for(var j=0;j<mp.getNumGeometries();j++){if(i==j){continue;}
var p2=mp.getGeometryN(j);this.checkShellNotNested(shell,p2,graph);if(this.validErr!=null){return;}}}};jsts.operation.valid.IsValidOp.prototype.checkShellNotNested=function(shell,p,graph){var shellPts=shell.getCoordinates();var polyShell=p.getExteriorRing();var polyPts=polyShell.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,polyShell,graph);if(shellPt==null){return;}
var insidePolyShell=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,polyPts);if(!insidePolyShell){return;}
if(p.getNumInteriorRing()<=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,shellPt);return;}
var badNestedPt=null;for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);badNestedPt=this.checkShellInsideHole(shell,hole,graph);if(badNestedPt==null){return;}}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,badNestedPt);};jsts.operation.valid.IsValidOp.prototype.checkShellInsideHole=function(shell,hole,graph){var shellPts=shell.getCoordinates();var holePts=hole.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,hole,graph);if(shellPt!=null){var insideHole=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,holePts);if(!insideHole){return shellPt;}}
var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(holePts,shell,graph);if(holePt!=null){var insideShell=jsts.algorithm.CGAlgorithms.isPointInRing(holePt,shellPts);if(insideShell){return holePt;}
return null;}
jsts.util.Assert.shouldNeverReachHere('points in shell and hole appear to be equal');return null;};jsts.operation.valid.IsValidOp.prototype.checkConnectedInteriors=function(graph){var cit=new jsts.operation.valid.ConnectedInteriorTester(graph);if(!cit.isInteriorsConnected()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR,cit.getCoordinate());}};jsts.algorithm.RobustDeterminant=function(){};jsts.algorithm.RobustDeterminant.signOfDet2x2=function(x1,y1,x2,y2){var sign,swap,k,count;count=0;sign=1;if((x1===0.0)||(y2===0.0)){if((y1===0.0)||(x2===0.0)){return 0;}
else if(y1>0){if(x2>0){return-sign;}
else{return sign;}}
else{if(x2>0){return sign;}
else{return-sign;}}}
if((y1===0.0)||(x2===0.0)){if(y2>0){if(x1>0){return sign;}
else{return-sign;}}
else{if(x1>0){return-sign;}
else{return sign;}}}
if(0.0<y1){if(0.0<y2){if(y1>y2){sign=-sign;swap=x1;x1=x2;x2=swap;swap=y1;y1=y2;y2=swap;}}
else{if(y1<=-y2){sign=-sign;x2=-x2;y2=-y2;}
else{swap=x1;x1=-x2;x2=swap;swap=y1;y1=-y2;y2=swap;}}}
else{if(0.0<y2){if(-y1<=y2){sign=-sign;x1=-x1;y1=-y1;}
else{swap=-x1;x1=x2;x2=swap;swap=-y1;y1=y2;y2=swap;}}
else{if(y1>=y2){x1=-x1;y1=-y1;x2=-x2;y2=-y2;}
else{sign=-sign;swap=-x1;x1=-x2;x2=swap;swap=-y1;y1=-y2;y2=swap;}}}
if(0.0<x1){if(0.0<x2){if(x1>x2){return sign;}}
else{return sign;}}
else{if(0.0<x2){return-sign;}
else{if(x1>=x2){sign=-sign;x1=-x1;x2=-x2;}
else{return-sign;}}}
while(true){count=count+1;k=Math.floor(x2/x1);x2=x2-k*x1;y2=y2-k*y1;if(y2<0.0){return-sign;}
if(y2>y1){return sign;}
if(x1>x2+x2){if(y1<y2+y2){return sign;}}
else{if(y1>y2+y2){return-sign;}
else{x2=x1-x2;y2=y1-y2;sign=-sign;}}
if(y2===0.0){if(x2===0.0){return 0;}
else{return-sign;}}
if(x2===0.0){return sign;}
k=Math.floor(x1/x2);x1=x1-k*x2;y1=y1-k*y2;if(y1<0.0){return sign;}
if(y1>y2){return-sign;}
if(x2>x1+x1){if(y2<y1+y1){return-sign;}}
else{if(y2>y1+y1){return sign;}
else{x1=x2-x1;y1=y2-y1;sign=-sign;}}
if(y1===0.0){if(x1===0.0){return 0;}
else{return sign;}}
if(x1===0.0){return-sign;}}};jsts.algorithm.RobustDeterminant.orientationIndex=function(p1,p2,q){var dx1=p2.x-p1.x;var dy1=p2.y-p1.y;var dx2=q.x-p2.x;var dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.index.quadtree.NodeBase=function(){this.subnode=new Array(4);this.subnode[0]=null;this.subnode[1]=null;this.subnode[2]=null;this.subnode[3]=null;this.items=[];};jsts.index.quadtree.NodeBase.prototype.getSubnodeIndex=function(env,centre){var subnodeIndex=-1;if(env.getMinX()>=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=3;}
if(env.getMaxY()<=centre.y){subnodeIndex=1;}}
if(env.getMaxX()<=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=2;}
if(env.getMaxY()<=centre.y){subnodeIndex=0;}}
return subnodeIndex;};jsts.index.quadtree.NodeBase.prototype.getItems=function(){return this.items;};jsts.index.quadtree.NodeBase.prototype.hasItems=function(){return(this.items.length>0);};jsts.index.quadtree.NodeBase.prototype.add=function(item){this.items.push(item);};jsts.index.quadtree.NodeBase.prototype.remove=function(itemEnv,item){if(!this.isSearchMatch(itemEnv)){return false;}
var found=false,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemEnv,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
if(this.items.indexOf(item)!==-1){for(var i=this.items.length-1;i>=0;i--){if(this.items[i]===item){this.items.splice(i,1);}}
found=true;}
return found;};jsts.index.quadtree.NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};jsts.index.quadtree.NodeBase.prototype.hasChildren=function(){var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){return true;}}
return false;};jsts.index.quadtree.NodeBase.prototype.isEmpty=function(){var isEmpty=true;if(this.items.length>0){isEmpty=false;}
var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){if(!this.subnode[i].isEmpty()){isEmpty=false;}}}
return isEmpty;};jsts.index.quadtree.NodeBase.prototype.addAllItems=function(resultItems){resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItems(resultItems);}}
return resultItems;};jsts.index.quadtree.NodeBase.prototype.addAllItemsFromOverlapping=function(searchEnv,resultItems){if(!this.isSearchMatch(searchEnv)){return;}
resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItemsFromOverlapping(searchEnv,resultItems);}}};jsts.index.quadtree.NodeBase.prototype.visit=function(searchEnv,visitor){if(!this.isSearchMatch(searchEnv)){return;}
this.visitItems(searchEnv,visitor);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){this.subnode[i].visit(searchEnv,visitor);}}};jsts.index.quadtree.NodeBase.prototype.visitItems=function(env,visitor){var i=0,il=this.items.length;for(i;i<il;i++){visitor.visitItem(this.items[i]);}};jsts.index.quadtree.NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,sqd;for(i;i<4;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};jsts.index.quadtree.NodeBase.prototype.size=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.length;};jsts.index.quadtree.NodeBase.prototype.getNodeCount=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+1;};jsts.index.quadtree.Node=function(env,level){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.env=env;this.level=level;this.centre=new jsts.geom.Coordinate();this.centre.x=(env.getMinX()+env.getMaxX())/2;this.centre.y=(env.getMinY()+env.getMaxY())/2;};jsts.index.quadtree.Node.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Node.createNode=function(env){var key,node;key=new jsts.index.quadtree.Key(env);node=new jsts.index.quadtree.Node(key.getEnvelope(),key.getLevel());return node;};jsts.index.quadtree.Node.createExpanded=function(node,addEnv){var expandEnv=new jsts.geom.Envelope(addEnv),largerNode;if(node!==null){expandEnv.expandToInclude(node.env);}
largerNode=jsts.index.quadtree.Node.createNode(expandEnv);if(node!==null){largerNode.insertNode(node);}
return largerNode;};jsts.index.quadtree.Node.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Node.prototype.isSearchMatch=function(searchEnv){return this.env.intersects(searchEnv);};jsts.index.quadtree.Node.prototype.getNode=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex!==-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchEnv);}else{return this;}};jsts.index.quadtree.Node.prototype.find=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchEnv);}
return this;};jsts.index.quadtree.Node.prototype.insertNode=function(node){var index=this.getSubnodeIndex(node.env,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insertNode(node);this.subnode[index]=childNode;}};jsts.index.quadtree.Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};jsts.index.quadtree.Node.prototype.createSubnode=function(index){var minx=0.0,maxx=0.0,miny=0.0,maxy=0.0,sqEnv,node;switch(index){case 0:minx=this.env.getMinX();maxx=this.centre.x;miny=this.env.getMinY();maxy=this.centre.y;break;case 1:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.env.getMinY();maxy=this.centre.y;break;case 2:minx=this.env.getMinX();maxx=this.centre.x;miny=this.centre.y;maxy=this.env.getMaxY();break;case 3:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.centre.y;maxy=this.env.getMaxY();break;}
sqEnv=new jsts.geom.Envelope(minx,maxx,miny,maxy);node=new jsts.index.quadtree.Node(sqEnv,this.level-1);return node;};(function(){jsts.triangulate.quadedge.QuadEdge=function(){this.rot=null;this.vertex=null;this.next=null;this.data=null;};var QuadEdge=jsts.triangulate.quadedge.QuadEdge;jsts.triangulate.quadedge.QuadEdge.makeEdge=function(o,d){var q0,q1,q2,q3,base;q0=new QuadEdge();q1=new QuadEdge();q2=new QuadEdge();q3=new QuadEdge();q0.rot=q1;q1.rot=q2;q2.rot=q3;q3.rot=q0;q0.setNext(q0);q1.setNext(q3);q2.setNext(q2);q3.setNext(q1);base=q0;base.setOrig(o);base.setDest(d);return base;};jsts.triangulate.quadedge.QuadEdge.connect=function(a,b){var e=QuadEdge.makeEdge(a.dest(),b.orig());QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b);return e;};jsts.triangulate.quadedge.QuadEdge.splice=function(a,b){var alpha,beta,t1,t2,t3,t4;alpha=a.oNext().rot;beta=b.oNext().rot;t1=b.oNext();t2=a.oNext();t3=beta.oNext();t4=alpha.oNext();a.setNext(t1);b.setNext(t2);alpha.setNext(t3);beta.setNext(t4);};jsts.triangulate.quadedge.QuadEdge.swap=function(e){var a,b;a=e.oPrev();b=e.sym().oPrev();QuadEdge.splice(e,a);QuadEdge.splice(e.sym(),b);QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b.lNext());e.setOrig(a.dest());e.setDest(b.dest());};jsts.triangulate.quadedge.QuadEdge.prototype.getPrimary=function(){if(this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0){return this;}
else{return this.sym();}};jsts.triangulate.quadedge.QuadEdge.prototype.setData=function(data){this.data=data;};jsts.triangulate.quadedge.QuadEdge.prototype.getData=function(){return this.data;};jsts.triangulate.quadedge.QuadEdge.prototype.delete_jsts=function(){this.rot=null;};jsts.triangulate.quadedge.QuadEdge.prototype.isLive=function(){return this.rot!==null;};jsts.triangulate.quadedge.QuadEdge.prototype.setNext=function(next){this.next=next;};jsts.triangulate.quadedge.QuadEdge.prototype.invRot=function(){return this.rot.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.sym=function(){return this.rot.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.oNext=function(){return this.next;};jsts.triangulate.quadedge.QuadEdge.prototype.oPrev=function(){return this.rot.next.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.dNext=function(){return this.sym().oNext().sym();};jsts.triangulate.quadedge.QuadEdge.prototype.dPrev=function(){return this.invRot().oNext().invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.lNext=function(){return this.invRot().oNext().rot;};jsts.triangulate.quadedge.QuadEdge.prototype.lPrev=function(){return this.next.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.rNext=function(){return this.rot.next.invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.rPrev=function(){return this.sym().oNext();};jsts.triangulate.quadedge.QuadEdge.prototype.setOrig=function(o){this.vertex=o;};jsts.triangulate.quadedge.QuadEdge.prototype.setDest=function(d){this.sym().setOrig(d);};jsts.triangulate.quadedge.QuadEdge.prototype.orig=function(){return this.vertex;};jsts.triangulate.quadedge.QuadEdge.prototype.dest=function(){return this.sym().orig();};jsts.triangulate.quadedge.QuadEdge.prototype.getLength=function(){return this.orig().getCoordinate().distance(dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.equalsNonOriented=function(qe){if(this.equalsOriented(qe)){return true;}
if(this.equalsOriented(qe.sym())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.equalsOriented=function(qe){if(this.orig().getCoordinate().equals2D(qe.orig().getCoordinate())&&this.dest().getCoordinate().equals2D(qe.dest().getCoordinate())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.toLineSegment=function()
{return new jsts.geom.LineSegment(this.vertex.getCoordinate(),this.dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.toString=function(){var p0,p1;p0=this.vertex.getCoordinate();p1=this.dest().getCoordinate();return jsts.io.WKTWriter.toLineString(p0,p1);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.EdgeEnd=function(edge,p0,p1,label){this.edge=edge;if(p0&&p1){this.init(p0,p1);}
if(label){this.label=label||null;}};jsts.geomgraph.EdgeEnd.prototype.edge=null;jsts.geomgraph.EdgeEnd.prototype.label=null;jsts.geomgraph.EdgeEnd.prototype.node=null;jsts.geomgraph.EdgeEnd.prototype.p0=null;jsts.geomgraph.EdgeEnd.prototype.p1=null;jsts.geomgraph.EdgeEnd.prototype.dx=null;jsts.geomgraph.EdgeEnd.prototype.dy=null;jsts.geomgraph.EdgeEnd.prototype.quadrant=null;jsts.geomgraph.EdgeEnd.prototype.init=function(p0,p1){this.p0=p0;this.p1=p1;this.dx=p1.x-p0.x;this.dy=p1.y-p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(this.dx,this.dy);Assert.isTrue(!(this.dx===0&&this.dy===0),'EdgeEnd with identical endpoints found');};jsts.geomgraph.EdgeEnd.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.EdgeEnd.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeEnd.prototype.getCoordinate=function(){return this.p0;};jsts.geomgraph.EdgeEnd.prototype.getDirectedCoordinate=function(){return this.p1;};jsts.geomgraph.EdgeEnd.prototype.getQuadrant=function(){return this.quadrant;};jsts.geomgraph.EdgeEnd.prototype.getDx=function(){return this.dx;};jsts.geomgraph.EdgeEnd.prototype.getDy=function(){return this.dy;};jsts.geomgraph.EdgeEnd.prototype.setNode=function(node){this.node=node;};jsts.geomgraph.EdgeEnd.prototype.getNode=function(){return this.node;};jsts.geomgraph.EdgeEnd.prototype.compareTo=function(e){return this.compareDirection(e);};jsts.geomgraph.EdgeEnd.prototype.compareDirection=function(e){if(this.dx===e.dx&&this.dy===e.dy)
return 0;if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.geomgraph.EdgeEnd.prototype.computeLabel=function(boundaryNodeRule){};})();jsts.operation.buffer.RightmostEdgeFinder=function(){};jsts.operation.buffer.RightmostEdgeFinder.prototype.minIndex=-1;jsts.operation.buffer.RightmostEdgeFinder.prototype.minCoord=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.minDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.orientedDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.getEdge=function(){return this.orientedDe;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getCoordinate=function(){return this.minCoord;};jsts.operation.buffer.RightmostEdgeFinder.prototype.findEdge=function(dirEdgeList){for(var i=dirEdgeList.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.checkForRightmostCoordinate(de);}
jsts.util.Assert.isTrue(this.minIndex!==0||this.minCoord.equals(this.minDe.getCoordinate()),'inconsistency in rightmost processing');if(this.minIndex===0){this.findRightmostEdgeAtNode();}else{this.findRightmostEdgeAtVertex();}
this.orientedDe=this.minDe;var rightmostSide=this.getRightmostSide(this.minDe,this.minIndex);if(rightmostSide==jsts.geomgraph.Position.LEFT){this.orientedDe=this.minDe.getSym();}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtNode=function(){var node=this.minDe.getNode();var star=node.getEdges();this.minDe=star.getRightmostEdge();if(!this.minDe.isForward()){this.minDe=this.minDe.getSym();this.minIndex=this.minDe.getEdge().getCoordinates().length-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtVertex=function(){var pts=this.minDe.getEdge().getCoordinates();jsts.util.Assert.isTrue(this.minIndex>0&&this.minIndex<pts.length,'rightmost point expected to be interior vertex of edge');var pPrev=pts[this.minIndex-1];var pNext=pts[this.minIndex+1];var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.minCoord,pNext,pPrev);var usePrev=false;if(pPrev.y<this.minCoord.y&&pNext.y<this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE){usePrev=true;}else if(pPrev.y>this.minCoord.y&&pNext.y>this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE){usePrev=true;}
if(usePrev){this.minIndex=this.minIndex-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.checkForRightmostCoordinate=function(de){var coord=de.getEdge().getCoordinates();for(var i=0;i<coord.length-1;i++){if(this.minCoord===null||coord[i].x>this.minCoord.x){this.minDe=de;this.minIndex=i;this.minCoord=coord[i];}}};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSide=function(de,index){var side=this.getRightmostSideOfSegment(de,index);if(side<0)
side=this.getRightmostSideOfSegment(de,index-1);if(side<0){this.minCoord=null;this.checkForRightmostCoordinate(de);}
return side;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSideOfSegment=function(de,i){var e=de.getEdge();var coord=e.getCoordinates();if(i<0||i+1>=coord.length)
return-1;if(coord[i].y==coord[i+1].y)
return-1;var pos=jsts.geomgraph.Position.LEFT;if(coord[i].y<coord[i+1].y)
pos=jsts.geomgraph.Position.RIGHT;return pos;};(function(){jsts.triangulate.IncrementalDelaunayTriangulator=function(subdiv){this.subdiv=subdiv;this.isUsingTolerance=subdiv.getTolerance()>0.0;};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSites=function(vertices){var i=0,il=vertices.length,v;for(i;i<il;i++){v=vertices[i];this.insertSite(v);}};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSite=function(v){var e,base,startEdge,t;e=this.subdiv.locate(v);if(this.subdiv.isVertexOfEdge(e,v)){return e;}
else if(this.subdiv.isOnEdge(e,v.getCoordinate())){e=e.oPrev();this.subdiv.delete_jsts(e.oNext());}
base=this.subdiv.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.subdiv.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);do{t=e.oPrev();if(t.dest().rightOf(e)&&v.isInCircle(e.orig(),t.dest(),e.dest())){jsts.triangulate.quadedge.QuadEdge.swap(e);e=e.oPrev();}else if(e.oNext()==startEdge){return base;}else{e=e.oNext().lPrev();}}while(true);};}());jsts.algorithm.CentroidArea=function(){this.basePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.centSum=new jsts.geom.Coordinate();this.cg3=new jsts.geom.Coordinate();};jsts.algorithm.CentroidArea.prototype.basePt=null;jsts.algorithm.CentroidArea.prototype.triangleCent3=null;jsts.algorithm.CentroidArea.prototype.areasum2=0;jsts.algorithm.CentroidArea.prototype.cg3=null;jsts.algorithm.CentroidArea.prototype.centSum=null;jsts.algorithm.CentroidArea.prototype.totalLength=0.0;jsts.algorithm.CentroidArea.prototype.add=function(geom){if(geom instanceof jsts.geom.Polygon){var poly=geom;this.setBasePoint(poly.getExteriorRing().getCoordinateN(0));this.add3(poly);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}else if(geom instanceof Array){this.add2(geom);}};jsts.algorithm.CentroidArea.prototype.add2=function(ring){this.setBasePoint(ring[0]);this.addShell(ring);};jsts.algorithm.CentroidArea.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0.0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else{cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;}
return cent;};jsts.algorithm.CentroidArea.prototype.setBasePoint=function(basePt){if(this.basePt==null)
this.basePt=basePt;};jsts.algorithm.CentroidArea.prototype.add3=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.CentroidArea.prototype.addShell=function(pts){var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1.0:-1.0;jsts.algorithm.CentroidArea.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.CentroidArea.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.CentroidArea.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;return;};jsts.algorithm.CentroidArea.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.CentroidArea.prototype.addLinearSegments=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.geomgraph.index.SweepLineSegment=function(edge,ptIndex){this.edge=edge;this.ptIndex=ptIndex;this.pts=edge.getCoordinates();};jsts.geomgraph.index.SweepLineSegment.prototype.edge=null;jsts.geomgraph.index.SweepLineSegment.prototype.pts=null;jsts.geomgraph.index.SweepLineSegment.prototype.ptIndex=null;jsts.geomgraph.index.SweepLineSegment.prototype.getMinX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.getMaxX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.computeIntersections=function(ss,si){si.addIntersections(this.edge,this.ptIndex,ss.edge,ss.ptIndex);};jsts.index.quadtree.Root=function(){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.origin=new jsts.geom.Coordinate(0.0,0.0);};jsts.index.quadtree.Root.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Root.prototype.insert=function(itemEnv,item){var index=this.getSubnodeIndex(itemEnv,this.origin);if(index===-1){this.add(item);return;}
var node=this.subnode[index];if(node===null||!node.getEnvelope().contains(itemEnv)){var largerNode=jsts.index.quadtree.Node.createExpanded(node,itemEnv);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemEnv,item);};jsts.index.quadtree.Root.prototype.insertContained=function(tree,itemEnv,item){var isZeroX,isZeroY,node;isZeroX=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinX(),itemEnv.getMaxX());isZeroY=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinY(),itemEnv.getMaxY());if(isZeroX||isZeroY){node=tree.find(itemEnv);}else{node=tree.getNode(itemEnv);}
node.add(item);};jsts.index.quadtree.Root.prototype.isSearchMatch=function(searchEnv){return true;};jsts.geomgraph.index.MonotoneChainIndexer=function(){};jsts.geomgraph.index.MonotoneChainIndexer.toIntArray=function(list){var array=[];for(var i=list.iterator();i.hasNext();){var element=i.next();array.push(element);}
return array;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.getChainStartIndices=function(pts){var start=0;var startIndexList=new javascript.util.ArrayList();startIndexList.add(start);do{var last=this.findChainEnd(pts,start);startIndexList.add(last);start=last;}while(start<pts.length-1);var startIndex=jsts.geomgraph.index.MonotoneChainIndexer.toIntArray(startIndexList);return startIndex;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.findChainEnd=function(pts,start){var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[start],pts[start+1]);var last=start+1;while(last<pts.length){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!=chainQuad){break;}
last++;}
return last-1;};jsts.noding.IntersectionAdder=function(li){this.li=li;};jsts.noding.IntersectionAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionAdder.constructor=jsts.noding.IntersectionAdder;jsts.noding.IntersectionAdder.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.noding.IntersectionAdder.prototype._hasIntersection=false;jsts.noding.IntersectionAdder.prototype.hasProper=false;jsts.noding.IntersectionAdder.prototype.hasProperInterior=false;jsts.noding.IntersectionAdder.prototype.hasInterior=false;jsts.noding.IntersectionAdder.prototype.properIntersectionPoint=null;jsts.noding.IntersectionAdder.prototype.li=null;jsts.noding.IntersectionAdder.prototype.isSelfIntersection=null;jsts.noding.IntersectionAdder.prototype.numIntersections=0;jsts.noding.IntersectionAdder.prototype.numInteriorIntersections=0;jsts.noding.IntersectionAdder.prototype.numProperIntersections=0;jsts.noding.IntersectionAdder.prototype.numTests=0;jsts.noding.IntersectionAdder.prototype.getLineIntersector=function(){return this.li;};jsts.noding.IntersectionAdder.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.noding.IntersectionAdder.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.noding.IntersectionAdder.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.noding.IntersectionAdder.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.noding.IntersectionAdder.prototype.hasInteriorIntersection=function(){return this.hasInterior;};jsts.noding.IntersectionAdder.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0==e1){if(this.li.getIntersectionNum()==1){if(jsts.noding.IntersectionAdder.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.size()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.noding.IntersectionAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){this.numIntersections++;if(this.li.isInteriorIntersection()){this.numInteriorIntersections++;this.hasInterior=true;}
if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);if(this.li.isProper()){this.numProperIntersections++;this.hasProper=true;this.hasProperInterior=true;}}}};jsts.noding.IntersectionAdder.prototype.isDone=function(){return false;};jsts.operation.union.CascadedPolygonUnion=function(polys){this.inputPolys=polys;};jsts.operation.union.CascadedPolygonUnion.union=function(polys){var op=new jsts.operation.union.CascadedPolygonUnion(polys);return op.union();};jsts.operation.union.CascadedPolygonUnion.prototype.inputPolys;jsts.operation.union.CascadedPolygonUnion.prototype.geomFactory=null;jsts.operation.union.CascadedPolygonUnion.prototype.STRTREE_NODE_CAPACITY=4;jsts.operation.union.CascadedPolygonUnion.prototype.union=function(){if(this.inputPolys.length===0){return null;}
this.geomFactory=this.inputPolys[0].getFactory();var index=new jsts.index.strtree.STRtree(this.STRTREE_NODE_CAPACITY);for(var i=0,l=this.inputPolys.length;i<l;i++){var item=this.inputPolys[i];index.insert(item.getEnvelopeInternal(),item);}
var itemTree=index.itemsTree();var unionAll=this.unionTree(itemTree);return unionAll;};jsts.operation.union.CascadedPolygonUnion.prototype.unionTree=function(geomTree){var geoms=this.reduceToGeometries(geomTree);var union=this.binaryUnion(geoms);return union;};jsts.operation.union.CascadedPolygonUnion.prototype.binaryUnion=function(geoms,start,end){start=start||0;end=end||geoms.length;if(end-start<=1){var g0=this.getGeometry(geoms,start);return this.unionSafe(g0,null);}
else if(end-start===2){return this.unionSafe(this.getGeometry(geoms,start),this.getGeometry(geoms,start+1));}
else{var mid=parseInt((end+start)/2);var g0=this.binaryUnion(geoms,start,mid);var g1=this.binaryUnion(geoms,mid,end);return this.unionSafe(g0,g1);}};jsts.operation.union.CascadedPolygonUnion.prototype.getGeometry=function(list,index){if(index>=list.length){return null;}
return list[index];};jsts.operation.union.CascadedPolygonUnion.prototype.reduceToGeometries=function(geomTree){var geoms=[];for(var i=0,l=geomTree.length;i<l;i++){var o=geomTree[i],geom=null;if(o instanceof Array){geom=this.unionTree(o);}
else if(o instanceof jsts.geom.Geometry){geom=o;}
geoms.push(geom);}
return geoms;};jsts.operation.union.CascadedPolygonUnion.prototype.unionSafe=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g0===null){return g1.clone();}
if(g1===null){return g0.clone();}
return this.unionOptimized(g0,g1);};jsts.operation.union.CascadedPolygonUnion.prototype.unionOptimized=function(g0,g1){var g0Env=g0.getEnvelopeInternal(),g1Env=g1.getEnvelopeInternal();if(!g0Env.intersects(g1Env)){var combo=jsts.geom.util.GeometryCombiner.combine(g0,g1);return combo;}
if(g0.getNumGeometries<=1&&g1.getNumGeometries<=1){return this.unionActual(g0,g1);}
var commonEnv=g0Env.intersection(g1Env);return this.unionUsingEnvelopeIntersection(g0,g1,commonEnv);};jsts.operation.union.CascadedPolygonUnion.prototype.unionUsingEnvelopeIntersection=function(g0,g1,common){var disjointPolys=new javascript.util.ArrayList();var g0Int=this.extractByEnvelope(common,g0,disjointPolys);var g1Int=this.extractByEnvelope(common,g1,disjointPolys);var union=this.unionActual(g0Int,g1Int);disjointPolys.add(union);var overallUnion=jsts.geom.util.GeometryCombiner.combine(disjointPolys);return overallUnion;};jsts.operation.union.CascadedPolygonUnion.prototype.extractByEnvelope=function(env,geom,disjointGeoms){var intersectingGeoms=new javascript.util.ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var elem=geom.getGeometryN(i);if(elem.getEnvelopeInternal().intersects(env)){intersectingGeoms.add(elem);}
else{disjointGeoms.add(elem);}}
return this.geomFactory.buildGeometry(intersectingGeoms);};jsts.operation.union.CascadedPolygonUnion.prototype.unionActual=function(g0,g1){return g0.union(g1);};(function(){jsts.geom.MultiPoint=function(points,factory){this.geometries=points||[];this.factory=factory;};jsts.geom.MultiPoint.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPoint.constructor=jsts.geom.MultiPoint;jsts.geom.MultiPoint.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null);};jsts.geom.MultiPoint.prototype.getGeometryN=function(n){return this.geometries[n];};jsts.geom.MultiPoint.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPoint.prototype.CLASS_NAME='jsts.geom.MultiPoint';})();jsts.operation.buffer.OffsetCurveBuilder=function(precisionModel,bufParams){this.precisionModel=precisionModel;this.bufParams=bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.distance=0.0;jsts.operation.buffer.OffsetCurveBuilder.prototype.precisionModel=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.bufParams=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.getBufferParameters=function(){return this.bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getLineCurve=function(inputPts,distance){this.distance=distance;if(this.distance<0.0&&!this.bufParams.isSingleSided())
return null;if(this.distance==0.0)
return null;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{if(this.bufParams.isSingleSided()){var isRightSide=distance<0.0;this.computeSingleSidedBufferCurve(inputPts,isRightSide,segGen);}else
this.computeLineBufferCurve(inputPts,segGen);}
var lineCoord=segGen.getCoordinates();return lineCoord;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getRingCurve=function(inputPts,side,distance){this.distance=distance;if(inputPts.length<=2)
return this.getLineCurve(inputPts,distance);if(this.distance==0.0){return jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates(inputPts);}
var segGen=this.getSegGen(this.distance);this.computeRingBufferCurve(inputPts,side,segGen);return segGen.getCoordinates();};jsts.operation.buffer.OffsetCurveBuilder.prototype.getOffsetCurve=function(inputPts,distance){this.distance=distance;if(this.distance===0.0)
return null;var isRightSide=this.distance<0.0;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{this.computeOffsetCurve(inputPts,isRightSide,segGen);}
var curvePts=segGen.getCoordinates();if(isRightSide)
curvePts.reverse();return curvePts;};jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates=function(pts){var copy=[];for(var i=0;i<pts.length;i++){copy.push(pts[i].clone());}
return copy;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getSegGen=function(distance){return new jsts.operation.buffer.OffsetSegmentGenerator(this.precisionModel,this.bufParams,distance);};jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR=100.0;jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance=function(bufDistance){return bufDistance/jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR;};jsts.operation.buffer.OffsetCurveBuilder.prototype.computePointCurve=function(pt,segGen){switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:segGen.createCircle(pt);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:segGen.createSquare(pt);break;}};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeLineBufferCurve=function(inputPts,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp1[n1-1],simp1[n1]);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp2[1],simp2[0]);segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeSingleSidedBufferCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){segGen.addSegments(inputPts,true);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{segGen.addSegments(inputPts,false);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeOffsetCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeRingBufferCurve=function(inputPts,side,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(side===jsts.geomgraph.Position.RIGHT)
distTol=-distTol;var simp=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n=simp.length-1;segGen.initSideSegments(simp[n-1],simp[0],side);for(var i=1;i<=n;i++){var addStartPoint=i!==1;segGen.addNextSegment(simp[i],addStartPoint);}
segGen.closeRing();};(function(){var HotPixelSnapAction=function(hotPixel,parentEdge,vertexIndex){this.hotPixel=hotPixel;this.parentEdge=parentEdge;this.vertexIndex=vertexIndex;};HotPixelSnapAction.prototype=new jsts.index.chain.MonotoneChainSelectAction();HotPixelSnapAction.constructor=HotPixelSnapAction;HotPixelSnapAction.prototype.hotPixel=null;HotPixelSnapAction.prototype.parentEdge=null;HotPixelSnapAction.prototype.vertexIndex=null;HotPixelSnapAction.prototype._isNodeAdded=false;HotPixelSnapAction.prototype.isNodeAdded=function(){return this._isNodeAdded;};HotPixelSnapAction.prototype.select=function(mc,startIndex){var ss=mc.getContext();if(this.parentEdge!==null){if(ss===this.parentEdge&&startIndex===this.vertexIndex)
return;}
this._isNodeAdded=this.hotPixel.addSnappedNode(ss,startIndex);};jsts.noding.snapround.MCIndexPointSnapper=function(index){this.index=index;};jsts.noding.snapround.MCIndexPointSnapper.prototype.index=null;jsts.noding.snapround.MCIndexPointSnapper.prototype.snap=function(hotPixel,parentEdge,vertexIndex){if(arguments.length===1){this.snap2.apply(this,arguments);return;}
var pixelEnv=hotPixel.getSafeEnvelope();var hotPixelSnapAction=new HotPixelSnapAction(hotPixel,parentEdge,vertexIndex);this.index.query(pixelEnv,{visitItem:function(testChain){testChain.select(pixelEnv,hotPixelSnapAction);}});return hotPixelSnapAction.isNodeAdded();};jsts.noding.snapround.MCIndexPointSnapper.prototype.snap2=function(hotPixel){return this.snap(hotPixel,null,-1);};})();(function(){var NodeBase=function(){this.items=new javascript.util.ArrayList();this.subnode=[null,null];};NodeBase.getSubnodeIndex=function(interval,centre){var subnodeIndex=-1;if(interval.min>=centre){subnodeIndex=1;}
if(interval.max<=centre){subnodeIndex=0;}
return subnodeIndex;};NodeBase.prototype.getItems=function(){return this.items;};NodeBase.prototype.add=function(item){this.items.add(item);};NodeBase.prototype.addAllItems=function(items){items.addAll(this.items);var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){this.subnode[i].addAllItems(items);}}
return items;};NodeBase.prototype.addAllItemsFromOverlapping=function(interval,resultItems){if(interval!==null&&!this.isSearchMatch(interval)){return;}
resultItems.addAll(this.items);if(this.subnode[0]!==null){this.subnode[0].addAllItemsFromOverlapping(interval,resultItems);}
if(this.subnode[1]!==null){this.subnode[1].addAllItemsFromOverlapping(interval,resultItems);}};NodeBase.prototype.remove=function(itemInterval,item){if(!this.isSearchMatch(itemInterval)){return false;}
var found=false,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemInterval,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
found=this.items.remove(item);return found;};NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};NodeBase.prototype.hasChildren=function(){var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){return true;}}
return false;};NodeBase.prototype.hasItems=function(){return!this.items.isEmpty();};NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,il=2,sqd;for(i;i<il;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};NodeBase.prototype.size=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.size();};NodeBase.prototype.nodeSize=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].nodeSize();}}
return subSize+1;};jsts.index.bintree.NodeBase=NodeBase;})();(function(){var NodeBase=jsts.index.bintree.NodeBase;var Key=jsts.index.bintree.Key;var Interval=jsts.index.bintree.Interval;var Node=function(interval,level){this.items=new javascript.util.ArrayList();this.subnode=[null,null];this.interval=interval;this.level=level;this.centre=(interval.getMin()+interval.getMax())/2;};Node.prototype=new NodeBase();Node.constructor=Node;Node.createNode=function(itemInterval){var key,node;key=new Key(itemInterval);node=new Node(key.getInterval(),key.getLevel());return node;};Node.createExpanded=function(node,addInterval){var expandInt,largerNode;expandInt=new Interval(addInterval);if(node!==null){expandInt.expandToInclude(node.interval);}
largerNode=Node.createNode(expandInt);if(node!==null){largerNode.insert(node);}
return largerNode;};Node.prototype.getInterval=function(){return this.interval;};Node.prototype.isSearchMatch=function(itemInterval){return itemInterval.overlaps(this.interval);};Node.prototype.getNode=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex!=-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchInterval);}else{return this;}};Node.prototype.find=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchInterval);}
return this;};Node.prototype.insert=function(node){var index=NodeBase.getSubnodeIndex(node.interval,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insert(node);this.subnode[index]=childNode;}};Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};Node.prototype.createSubnode=function(index){var min,max,subInt,node;min=0.0;max=0.0;switch(index){case 0:min=this.interval.getMin();max=this.centre;break;case 1:min=this.centre;max=this.interval.getMax();break;}
subInt=new Interval(min,max);node=new Node(subInt,this.level-1);return node;};jsts.index.bintree.Node=Node;})();(function(){var Node=jsts.index.bintree.Node;var NodeBase=jsts.index.bintree.NodeBase;var Root=function(){this.subnode=[null,null];this.items=new javascript.util.ArrayList();};Root.prototype=new jsts.index.bintree.NodeBase();Root.constructor=Root;Root.origin=0.0;Root.prototype.insert=function(itemInterval,item){var index=NodeBase.getSubnodeIndex(itemInterval,Root.origin),node,largerNode;if(index===-1){this.add(item);return;}
node=this.subnode[index];if(node===null||!node.getInterval().contains(itemInterval)){largerNode=Node.createExpanded(node,itemInterval);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemInterval,item);};Root.prototype.insertContained=function(tree,itemInterval,item){var isZeroArea,node;isZeroArea=jsts.index.IntervalSize.isZeroWidth(itemInterval.getMin(),itemInterval.getMax());node=isZeroArea?tree.find(itemInterval):tree.getNode(itemInterval);node.add(item);};Root.prototype.isSearchMatch=function(interval){return true;};jsts.index.bintree.Root=Root;})();jsts.geomgraph.Quadrant=function(){};jsts.geomgraph.Quadrant.NE=0;jsts.geomgraph.Quadrant.NW=1;jsts.geomgraph.Quadrant.SW=2;jsts.geomgraph.Quadrant.SE=3;jsts.geomgraph.Quadrant.quadrant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.geomgraph.Quadrant.quadrant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for point ( '+dx+', '+dy+' )');if(dx>=0.0){if(dy>=0.0)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(dy>=0.0)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.quadrant2=function(p0,p1){if(p1.x===p0.x&&p1.y===p0.y)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for two identical points '+p0);if(p1.x>=p0.x){if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.isOpposite=function(quad1,quad2){if(quad1===quad2)
return false;var diff=(quad1-quad2+4)%4;if(diff===2)
return true;return false;};jsts.geomgraph.Quadrant.commonHalfPlane=function(quad1,quad2){if(quad1===quad2)
return quad1;var diff=(quad1-quad2+4)%4;if(diff===2)
return-1;var min=(quad1<quad2)?quad1:quad2;var max=(quad1>quad2)?quad1:quad2;if(min===0&&max===3)
return 3;return min;};jsts.geomgraph.Quadrant.isInHalfPlane=function(quad,halfPlane){if(halfPlane===jsts.geomgraph.Quadrant.SE){return quad===jsts.geomgraph.Quadrant.SE||quad===jsts.geomgraph.Quadrant.SW;}
return quad===halfPlane||quad===halfPlane+1;};jsts.geomgraph.Quadrant.isNorthern=function(quad){return quad===jsts.geomgraph.Quadrant.NE||quad===jsts.geomgraph.Quadrant.NW;};jsts.operation.valid.ConsistentAreaTester=function(geomGraph){this.geomGraph=geomGraph;this.li=new jsts.algorithm.RobustLineIntersector();this.nodeGraph=new jsts.operation.relate.RelateNodeGraph();this.invalidPoint=null;};jsts.operation.valid.ConsistentAreaTester.prototype.getInvalidPoint=function(){return this.invalidPoint;};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeConsistentArea=function(){var intersector=this.geomGraph.computeSelfNodes(this.li,true);if(intersector.hasProperIntersection()){this.invalidPoint=intersector.getProperIntersectionPoint();return false;}
this.nodeGraph.build(this.geomGraph);return this.isNodeEdgeAreaLabelsConsistent();};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeEdgeAreaLabelsConsistent=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();if(!node.getEdges().isAreaLabelsConsistent(this.geomGraph)){this.invalidPoint=node.getCoordinate().clone();return false;}}
return true;};jsts.operation.valid.ConsistentAreaTester.prototype.hasDuplicateRings=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();for(var i=node.getEdges().iterator();i.hasNext();){var eeb=i.next();if(eeb.getEdgeEnds().length>1){invalidPoint=eeb.getEdge().getCoordinate(0);return true;}}}
return false;};jsts.operation.relate.RelateNode=function(coord,edges){jsts.geomgraph.Node.apply(this,arguments);};jsts.operation.relate.RelateNode.prototype=new jsts.geomgraph.Node();jsts.operation.relate.RelateNode.prototype.computeIM=function(im){im.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0);};jsts.operation.relate.RelateNode.prototype.updateIMFromEdges=function(im){this.edges.updateIM(im);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEnd=jsts.geomgraph.EdgeEnd;jsts.geomgraph.DirectedEdge=function(edge,isForward){EdgeEnd.call(this,edge);this.depth=[0,-999,-999];this._isForward=isForward;if(isForward){this.init(edge.getCoordinate(0),edge.getCoordinate(1));}else{var n=edge.getNumPoints()-1;this.init(edge.getCoordinate(n),edge.getCoordinate(n-1));}
this.computeDirectedLabel();};jsts.geomgraph.DirectedEdge.prototype=new EdgeEnd();jsts.geomgraph.DirectedEdge.constructor=jsts.geomgraph.DirectedEdge;jsts.geomgraph.DirectedEdge.depthFactor=function(currLocation,nextLocation){if(currLocation===Location.EXTERIOR&&nextLocation===Location.INTERIOR)
return 1;else if(currLocation===Location.INTERIOR&&nextLocation===Location.EXTERIOR)
return-1;return 0;};jsts.geomgraph.DirectedEdge.prototype._isForward=null;jsts.geomgraph.DirectedEdge.prototype._isInResult=false;jsts.geomgraph.DirectedEdge.prototype._isVisited=false;jsts.geomgraph.DirectedEdge.prototype.sym=null;jsts.geomgraph.DirectedEdge.prototype.next=null;jsts.geomgraph.DirectedEdge.prototype.nextMin=null;jsts.geomgraph.DirectedEdge.prototype.edgeRing=null;jsts.geomgraph.DirectedEdge.prototype.minEdgeRing=null;jsts.geomgraph.DirectedEdge.prototype.depth=null;jsts.geomgraph.DirectedEdge.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.DirectedEdge.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.DirectedEdge.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.DirectedEdge.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.DirectedEdge.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.DirectedEdge.prototype.setEdgeRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.geomgraph.DirectedEdge.prototype.getEdgeRing=function(){return this.edgeRing;};jsts.geomgraph.DirectedEdge.prototype.setMinEdgeRing=function(minEdgeRing){this.minEdgeRing=minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getMinEdgeRing=function(){return this.minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getDepth=function(position){return this.depth[position];};jsts.geomgraph.DirectedEdge.prototype.setDepth=function(position,depthVal){if(this.depth[position]!==-999){if(this.depth[position]!==depthVal)
throw new jsts.error.TopologyError('assigned depths do not match',this.getCoordinate());}
this.depth[position]=depthVal;};jsts.geomgraph.DirectedEdge.prototype.getDepthDelta=function(){var depthDelta=this.edge.getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;return depthDelta;};jsts.geomgraph.DirectedEdge.prototype.setVisitedEdge=function(isVisited){this.setVisited(isVisited);this.sym.setVisited(isVisited);};jsts.geomgraph.DirectedEdge.prototype.getSym=function(){return this.sym;};jsts.geomgraph.DirectedEdge.prototype.isForward=function(){return this._isForward;};jsts.geomgraph.DirectedEdge.prototype.setSym=function(de){this.sym=de;};jsts.geomgraph.DirectedEdge.prototype.getNext=function(){return this.next;};jsts.geomgraph.DirectedEdge.prototype.setNext=function(next){this.next=next;};jsts.geomgraph.DirectedEdge.prototype.getNextMin=function(){return this.nextMin;};jsts.geomgraph.DirectedEdge.prototype.setNextMin=function(nextMin){this.nextMin=nextMin;};jsts.geomgraph.DirectedEdge.prototype.isLineEdge=function(){var isLine=this.label.isLine(0)||this.label.isLine(1);var isExteriorIfArea0=!this.label.isArea(0)||this.label.allPositionsEqual(0,Location.EXTERIOR);var isExteriorIfArea1=!this.label.isArea(1)||this.label.allPositionsEqual(1,Location.EXTERIOR);return isLine&&isExteriorIfArea0&&isExteriorIfArea1;};jsts.geomgraph.DirectedEdge.prototype.isInteriorAreaEdge=function(){var isInteriorAreaEdge=true;for(var i=0;i<2;i++){if(!(this.label.isArea(i)&&this.label.getLocation(i,Position.LEFT)===Location.INTERIOR&&this.label.getLocation(i,Position.RIGHT)===Location.INTERIOR)){isInteriorAreaEdge=false;}}
return isInteriorAreaEdge;};jsts.geomgraph.DirectedEdge.prototype.computeDirectedLabel=function(){this.label=new jsts.geomgraph.Label(this.edge.getLabel());if(!this._isForward)
this.label.flip();};jsts.geomgraph.DirectedEdge.prototype.setEdgeDepths=function(position,depth){var depthDelta=this.getEdge().getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;var directionFactor=1;if(position===Position.LEFT)
directionFactor=-1;var oppositePos=Position.opposite(position);var delta=depthDelta*directionFactor;var oppositeDepth=depth+delta;this.setDepth(position,depth);this.setDepth(oppositePos,oppositeDepth);};})();jsts.operation.distance.DistanceOp=function(g0,g1,terminateDistance){this.ptLocator=new jsts.algorithm.PointLocator();this.geom=[];this.geom[0]=g0;this.geom[1]=g1;this.terminateDistance=terminateDistance;};jsts.operation.distance.DistanceOp.prototype.geom=null;jsts.operation.distance.DistanceOp.prototype.terminateDistance=0.0;jsts.operation.distance.DistanceOp.prototype.ptLocator=null;jsts.operation.distance.DistanceOp.prototype.minDistanceLocation=null;jsts.operation.distance.DistanceOp.prototype.minDistance=Number.MAX_VALUE;jsts.operation.distance.DistanceOp.distance=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.distance();};jsts.operation.distance.DistanceOp.isWithinDistance=function(g0,g1,distance){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,distance);return distOp.distance()<=distance;};jsts.operation.distance.DistanceOp.nearestPoints=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.nearestPoints();};jsts.operation.distance.DistanceOp.prototype.distance=function(){if(this.geom[0]===null||this.geom[1]===null)
throw new jsts.error.IllegalArgumentError('null geometries are not supported');if(this.geom[0].isEmpty()||this.geom[1].isEmpty())
return 0.0;this.computeMinDistance();return this.minDistance;};jsts.operation.distance.DistanceOp.prototype.nearestPoints=function(){this.computeMinDistance();var nearestPts=[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()];return nearestPts;};jsts.operation.distance.DistanceOp.prototype.nearestLocations=function(){this.computeMinDistance();return this.minDistanceLocation;};jsts.operation.distance.DistanceOp.prototype.updateMinDistance=function(locGeom,flip){if(locGeom[0]===null)
return;if(flip){this.minDistanceLocation[0]=locGeom[1];this.minDistanceLocation[1]=locGeom[0];}else{this.minDistanceLocation[0]=locGeom[0];this.minDistanceLocation[1]=locGeom[1];}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance=function(){if(arguments.length>0){this.computeMinDistance2.apply(this,arguments);return;}
if(this.minDistanceLocation!==null)
return;this.minDistanceLocation=[];this.computeContainmentDistance();if(this.minDistance<=this.terminateDistance)
return;this.computeFacetDistance();};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance=function(){if(arguments.length===2){this.computeContainmentDistance2.apply(this,arguments);return;}else if(arguments.length===3&&(!arguments[0]instanceof jsts.operation.distance.GeometryLocation)){this.computeContainmentDistance3.apply(this,arguments);return;}else if(arguments.length===3){this.computeContainmentDistance4.apply(this,arguments);return;}
var locPtPoly=[];this.computeContainmentDistance2(0,locPtPoly);if(this.minDistance<=this.terminateDistance)
return;this.computeContainmentDistance2(1,locPtPoly);};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance2=function(polyGeomIndex,locPtPoly){var locationsIndex=1-polyGeomIndex;var polys=jsts.geom.util.PolygonExtracter.getPolygons(this.geom[polyGeomIndex]);if(polys.length>0){var insideLocs=jsts.operation.distance.ConnectedElementLocationFilter.getLocations(this.geom[locationsIndex]);this.computeContainmentDistance3(insideLocs,polys,locPtPoly);if(this.minDistance<=this.terminateDistance){this.minDistanceLocation[locationsIndex]=locPtPoly[0];this.minDistanceLocation[polyGeomIndex]=locPtPoly[1];return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance3=function(locs,polys,locPtPoly){for(var i=0;i<locs.length;i++){var loc=locs[i];for(var j=0;j<polys.length;j++){this.computeContainmentDistance4(loc,polys[j],locPtPoly);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance4=function(ptLoc,poly,locPtPoly){var pt=ptLoc.getCoordinate();if(jsts.geom.Location.EXTERIOR!==this.ptLocator.locate(pt,poly)){this.minDistance=0.0;locPtPoly[0]=ptLoc;locPtPoly[1]=new jsts.operation.distance.GeometryLocation(poly,pt);return;}};jsts.operation.distance.DistanceOp.prototype.computeFacetDistance=function(){var locGeom=[];var lines0=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[0]);var lines1=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[1]);var pts0=jsts.geom.util.PointExtracter.getPoints(this.geom[0]);var pts1=jsts.geom.util.PointExtracter.getPoints(this.geom[1]);this.computeMinDistanceLines(lines0,lines1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines0,pts1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines1,pts0,locGeom);this.updateMinDistance(locGeom,true);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistancePoints(pts0,pts1,locGeom);this.updateMinDistance(locGeom,false);};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLines=function(lines0,lines1,locGeom){for(var i=0;i<lines0.length;i++){var line0=lines0[i];for(var j=0;j<lines1.length;j++){var line1=lines1[j];this.computeMinDistance(line0,line1,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistancePoints=function(points0,points1,locGeom){for(var i=0;i<points0.length;i++){var pt0=points0[i];for(var j=0;j<points1.length;j++){var pt1=points1[j];var dist=pt0.getCoordinate().distance(pt1.getCoordinate());if(dist<this.minDistance){this.minDistance=dist;locGeom[0]=new jsts.operation.distance.GeometryLocation(pt0,0,pt0.getCoordinate());locGeom[1]=new jsts.operation.distance.GeometryLocation(pt1,0,pt1.getCoordinate());}
if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLinesPoints=function(lines,points,locGeom){for(var i=0;i<lines.length;i++){var line=lines[i];for(var j=0;j<points.length;j++){var pt=points[j];this.computeMinDistance(line,pt,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance2=function(line0,line1,locGeom){if(line1 instanceof jsts.geom.Point){this.computeMinDistance3(line0,line1,locGeom);return;}
if(line0.getEnvelopeInternal().distance(line1.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line0.getCoordinates();var coord1=line1.getCoordinates();for(var i=0;i<coord0.length-1;i++){for(var j=0;j<coord1.length-1;j++){var dist=jsts.algorithm.CGAlgorithms.distanceLineLine(coord0[i],coord0[i+1],coord1[j],coord1[j+1]);if(dist<this.minDistance){this.minDistance=dist;var seg0=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var seg1=new jsts.geom.LineSegment(coord1[j],coord1[j+1]);var closestPt=seg0.closestPoints(seg1);locGeom[0]=new jsts.operation.distance.GeometryLocation(line0,i,closestPt[0]);locGeom[1]=new jsts.operation.distance.GeometryLocation(line1,j,closestPt[1]);}
if(this.minDistance<=this.terminateDistance){return;}}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance3=function(line,pt,locGeom){if(line.getEnvelopeInternal().distance(pt.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line.getCoordinates();var coord=pt.getCoordinate();for(var i=0;i<coord0.length-1;i++){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(coord,coord0[i],coord0[i+1]);if(dist<this.minDistance){this.minDistance=dist;var seg=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var segClosestPoint=seg.closestPoint(coord);locGeom[0]=new jsts.operation.distance.GeometryLocation(line,i,segClosestPoint);locGeom[1]=new jsts.operation.distance.GeometryLocation(pt,0,coord);}
if(this.minDistance<=this.terminateDistance){return;}}};jsts.index.strtree.SIRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||10;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.SIRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.SIRtree.constructor=jsts.index.strtree.SIRtree;jsts.index.strtree.SIRtree.prototype.comperator={compare:function(o1,o2){return o1.getBounds().getCentre()-o2.getBounds().getCentre();}};jsts.index.strtree.SIRtree.prototype.intersectionOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.SIRtree.prototype.createNode=function(level){var AbstractNode=function(level){jsts.index.strtree.AbstractNode.apply(this,arguments);};AbstractNode.prototype=new jsts.index.strtree.AbstractNode();AbstractNode.constructor=AbstractNode;AbstractNode.prototype.computeBounds=function(){var bounds=null,childBoundables=this.getChildBoundables(),childBoundable;for(var i=0,l=childBoundables.length;i<l;i++){childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.index.strtree.Interval(childBoundable.getBounds());}
else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return AbstractNode;};jsts.index.strtree.SIRtree.prototype.insert=function(x1,x2,item){jsts.index.strtree.AbstractSTRtree.prototype.insert(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)),item);};jsts.index.strtree.SIRtree.prototype.query=function(x1,x2){x2=x2||x1;jsts.index.strtree.AbstractSTRtree.prototype.query(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)));};jsts.index.strtree.SIRtree.prototype.getIntersectsOp=function(){return this.intersectionOp;};jsts.index.strtree.SIRtree.prototype.getComparator=function(){return this.comperator;};jsts.simplify.DouglasPeuckerSimplifier=function(inputGeom){this.inputGeom=inputGeom;this.isEnsureValidTopology=true;};jsts.simplify.DouglasPeuckerSimplifier.prototype.inputGeom=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.isEnsureValidTopology=null;jsts.simplify.DouglasPeuckerSimplifier.simplify=function(geom,distanceTolerance){var tss=new jsts.simplify.DouglasPeuckerSimplifier(geom);tss.setDistanceTolerance(distanceTolerance);return tss.getResultGeometry();};jsts.simplify.DouglasPeuckerSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){if(distanceTolerance<0.0){throw"Tolerance must be non-negative";}
this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerSimplifier.prototype.setEnsureValid=function(isEnsureValidTopology){this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DouglasPeuckerSimplifier.prototype.getResultGeometry=function(){if(this.inputGeom.isEmpty()){return this.inputGeom.clone();}
return(new jsts.simplify.DPTransformer(this.distanceTolerance,this.isEnsureValidTopology)).transform(this.inputGeom);};(function(){jsts.operation.predicate.RectangleContains=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleContains.contains=function(rectangle,b){var rc=new jsts.operation.predicate.RectangleContains(rectangle);return rc.contains(b);}
jsts.operation.predicate.RectangleContains.prototype.rectEnv=null;jsts.operation.predicate.RectangleContains.prototype.contains=function(geom){if(!this.rectEnv.contains(geom.getEnvelopeInternal()))
return false;if(this.isContainedInBoundary(geom))
return false;return true;}
jsts.operation.predicate.RectangleContains.prototype.isContainedInBoundary=function(geom){if(geom instanceof jsts.geom.Polygon)return false;if(geom instanceof jsts.geom.Point)return this.isPointContainedInBoundary(geom.getCoordinate());if(geom instanceof jsts.geom.LineString)return this.isLineStringContainedInBoundary(geom);for(var i=0;i<geom.getNumGeometries();i++){var comp=geom.getGeometryN(i);if(!this.isContainedInBoundary(comp))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isPointContainedInBoundary=function(pt){return pt.x==this.rectEnv.getMinX()||pt.x==this.rectEnv.getMaxX()||pt.y==this.rectEnv.getMinY()||pt.y==this.rectEnv.getMaxY();}
jsts.operation.predicate.RectangleContains.prototype.isLineStringContainedInBoundary=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length-1;i++){var p0=seq[i];var p1=seq[i+1];if(!this.isLineSegmentContainedInBoundary(p0,p1))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isLineSegmentContainedInBoundary=function(p0,p1){if(p0.equals(p1))
return this.isPointContainedInBoundary(p0);if(p0.x==p1.x){if(p0.x==this.rectEnv.getMinX()||p0.x==this.rectEnv.getMaxX())
return true;}
else if(p0.y==p1.y){if(p0.y==this.rectEnv.getMinY()||p0.y==this.rectEnv.getMaxY())
return true;}
return false;}})();(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;jsts.geomgraph.Depth=function(){this.depth=[[],[]];for(var i=0;i<2;i++){for(var j=0;j<3;j++){this.depth[i][j]=jsts.geomgraph.Depth.NULL_VALUE;}}};jsts.geomgraph.Depth.NULL_VALUE=-1;jsts.geomgraph.Depth.depthAtLocation=function(location){if(location===Location.EXTERIOR)
return 0;if(location===Location.INTERIOR)
return 1;return jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.depth=null;jsts.geomgraph.Depth.prototype.getDepth=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex];};jsts.geomgraph.Depth.prototype.setDepth=function(geomIndex,posIndex,depthValue){this.depth[geomIndex][posIndex]=depthValue;};jsts.geomgraph.Depth.prototype.getLocation=function(geomIndex,posIndex){if(this.depth[geomIndex][posIndex]<=0)
return Location.EXTERIOR;return Location.INTERIOR;};jsts.geomgraph.Depth.prototype.add=function(geomIndex,posIndex,location){if(location===Location.INTERIOR)
this.depth[geomIndex][posIndex]++;};jsts.geomgraph.Depth.prototype.isNull=function(){if(arguments.length>0){return this.isNull2.apply(this,arguments);}
for(var i=0;i<2;i++){for(var j=0;j<3;j++){if(this.depth[i][j]!==jsts.geomgraph.Depth.NULL_VALUE)
return false;}}
return true;};jsts.geomgraph.Depth.prototype.isNull2=function(geomIndex){if(arguments.length>1){return this.isNull3.apply(this,arguments);}
return this.depth[geomIndex][1]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.isNull3=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.add=function(lbl){for(var i=0;i<2;i++){for(var j=1;j<3;j++){var loc=lbl.getLocation(i,j);if(loc===Location.EXTERIOR||loc===Location.INTERIOR){if(this.isNull(i,j)){this.depth[i][j]=jsts.geomgraph.Depth.depthAtLocation(loc);}else
this.depth[i][j]+=jsts.geomgraph.Depth.depthAtLocation(loc);}}}};jsts.geomgraph.Depth.prototype.getDelta=function(geomIndex){return this.depth[geomIndex][Position.RIGHT]-
this.depth[geomIndex][Position.LEFT];};jsts.geomgraph.Depth.prototype.normalize=function(){for(var i=0;i<2;i++){if(!this.isNull(i)){var minDepth=this.depth[i][1];if(this.depth[i][2]<minDepth)
minDepth=this.depth[i][2];if(minDepth<0)
minDepth=0;for(var j=1;j<3;j++){var newValue=0;if(this.depth[i][j]>minDepth)
newValue=1;this.depth[i][j]=newValue;}}}};jsts.geomgraph.Depth.prototype.toString=function(){return'A: '+this.depth[0][1]+','+this.depth[0][2]+' B: '+
this.depth[1][1]+','+this.depth[1][2];};})();jsts.algorithm.BoundaryNodeRule=function(){};jsts.algorithm.BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.Mod2BoundaryNodeRule=function(){};jsts.algorithm.Mod2BoundaryNodeRule.prototype=new jsts.algorithm.BoundaryNodeRule();jsts.algorithm.Mod2BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){return boundaryCount%2===1;};jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE=new jsts.algorithm.Mod2BoundaryNodeRule();jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE=jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;jsts.operation.distance.GeometryLocation=function(component,segIndex,pt){this.component=component;this.segIndex=segIndex;this.pt=pt;};jsts.operation.distance.GeometryLocation.INSIDE_AREA=-1;jsts.operation.distance.GeometryLocation.prototype.component=null;jsts.operation.distance.GeometryLocation.prototype.segIndex=null;jsts.operation.distance.GeometryLocation.prototype.pt=null;jsts.operation.distance.GeometryLocation.prototype.getGeometryComponent=function(){return this.component;};jsts.operation.distance.GeometryLocation.prototype.getSegmentIndex=function(){return this.segIndex;};jsts.operation.distance.GeometryLocation.prototype.getCoordinate=function(){return this.pt;};jsts.operation.distance.GeometryLocation.prototype.isInsideArea=function(){return this.segIndex===jsts.operation.distance.GeometryLocation.INSIDE_AREA;};jsts.geom.util.PointExtracter=function(pts){this.pts=pts;};jsts.geom.util.PointExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PointExtracter.prototype.pts=null;jsts.geom.util.PointExtracter.getPoints=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Point){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.PointExtracter(list));}
return list;};jsts.geom.util.PointExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point)
this.pts.push(geom);};(function(){var Location=jsts.geom.Location;jsts.operation.relate.RelateNodeGraph=function(){this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());};jsts.operation.relate.RelateNodeGraph.prototype.nodes=null;jsts.operation.relate.RelateNodeGraph.prototype.build=function(geomGraph){this.computeIntersectionNodes(geomGraph,0);this.copyNodesAndLabels(geomGraph,0);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var eeList=eeBuilder.computeEdgeEnds(geomGraph.getEdgeIterator());this.insertEdgeEnds(eeList);};jsts.operation.relate.RelateNodeGraph.prototype.computeIntersectionNodes=function(geomGraph,argIndex){for(var edgeIt=geomGraph.getEdgeIterator();edgeIt.hasNext();){var e=edgeIt.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateNodeGraph.prototype.copyNodesAndLabels=function(geomGraph,argIndex){for(var nodeIt=geomGraph.getNodeIterator();nodeIt.hasNext();){var graphNode=nodeIt.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateNodeGraph.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateNodeGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};})();jsts.geomgraph.index.SimpleSweepLineIntersector=function(){};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.events=[];jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.nOverlaps=null;jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.add(edges,null);}else{this.add(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.add(edges0,edges0);this.add(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.add2.apply(this,arguments);return;}
var pts=edge.getCoordinates();for(var i=0;i<pts.length-1;i++){var ss=new jsts.geomgraph.index.SweepLineSegment(edge,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(ss.getMinX(),ss,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(ss.getMaxX(),insertEvent));}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();if(edgeSet){this.add(edge,edgeSet);}else{this.add(edge,edge);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var ss0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var ss1=ev1.getObject();if(!ev0.isSameLabel(ev1)){ss0.computeIntersections(ss1,si);this.nOverlaps++;}}}}
jsts.triangulate.VoronoiDiagramBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;this.clipEnv=null;this.diagramEnv=null;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesByGeometry(arg);}else{this.setSitesByArray(arg);}};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByArray=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setClipEnvelope=function(clipEnv){this.clipEnv=clipEnv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setTolerance=function(tolerance)
{this.tolerance=tolerance;};jsts.triangulate.VoronoiDiagramBuilder.prototype.create=function(){if(this.subdiv!==null){return;}
var siteEnv,expandBy,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);this.diagramEnv=siteEnv;expandBy=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(expandBy);if(this.clipEnv!==null){this.diagramEnv.expandToInclude(this.clipEnv);}
vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);};jsts.triangulate.VoronoiDiagramBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.getDiagram=function(geomFact){this.create();var polys=this.subdiv.getVoronoiDiagram(geomFact);return this.clipGeometryCollection(polys,this.diagramEnv);};jsts.triangulate.VoronoiDiagramBuilder.prototype.clipGeometryCollection=function(geom,clipEnv){var clipPoly,clipped,i,il,g,result;clipPoly=geom.getFactory().toGeometry(clipEnv);clipped=[];i=0,il=geom.getNumGeometries();for(i;i<il;i++){g=geom.getGeometryN(i);result=null;if(clipEnv.contains(g.getEnvelopeInternal())){result=g;}
else if(clipEnv.intersects(g.getEnvelopeInternal())){result=clipPoly.intersection(g);}
if(result!==null&&!result.isEmpty()){clipped.push(result);}}
return geom.getFactory().createGeometryCollection(clipped);};jsts.operation.valid.IndexedNestedRingTester=function(graph){this.graph=graph;this.rings=new javascript.util.ArrayList();this.totalEnv=new jsts.geom.Envelope();this.index=null;this.nestedPt=null;};jsts.operation.valid.IndexedNestedRingTester.prototype.getNestedPoint=function(){return this.nestedPt;};jsts.operation.valid.IndexedNestedRingTester.prototype.add=function(ring){this.rings.add(ring);this.totalEnv.expandToInclude(ring.getEnvelopeInternal());};jsts.operation.valid.IndexedNestedRingTester.prototype.isNonNested=function(){this.buildIndex();for(var i=0;i<this.rings.size();i++){var innerRing=this.rings.get(i);var innerRingPts=innerRing.getCoordinates();var results=this.index.query(innerRing.getEnvelopeInternal());for(var j=0;j<results.length;j++){var searchRing=results[j];var searchRingPts=searchRing.getCoordinates();if(innerRing==searchRing){continue;}
if(!innerRing.getEnvelopeInternal().intersects(searchRing.getEnvelopeInternal())){continue;}
var innerRingPt=jsts.operation.valid.IsValidOp.findPtNotNode(innerRingPts,searchRing,this.graph);if(innerRingPt==null){continue;}
var isInside=jsts.algorithm.CGAlgorithms.isPointInRing(innerRingPt,searchRingPts);if(isInside){this.nestedPt=innerRingPt;return false;}}}
return true;};jsts.operation.valid.IndexedNestedRingTester.prototype.buildIndex=function(){this.index=new jsts.index.strtree.STRtree();for(var i=0;i<this.rings.size();i++){var ring=this.rings.get(i);var env=ring.getEnvelopeInternal();this.index.insert(env,ring);}};jsts.geomgraph.index.MonotoneChain=function(mce,chainIndex){this.mce=mce;this.chainIndex=chainIndex;};jsts.geomgraph.index.MonotoneChain.prototype.mce=null;jsts.geomgraph.index.MonotoneChain.prototype.chainIndex=null;jsts.geomgraph.index.MonotoneChain.prototype.computeIntersections=function(mc,si){this.mce.computeIntersectsForChain(this.chainIndex,mc.mce,mc.chainIndex,si);};jsts.noding.SegmentNode=function(segString,coord,segmentIndex,segmentOctant){this.segString=segString;this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.segmentOctant=segmentOctant;this._isInterior=!coord.equals2D(segString.getCoordinate(segmentIndex));};jsts.noding.SegmentNode.prototype.segString=null;jsts.noding.SegmentNode.prototype.coord=null;jsts.noding.SegmentNode.prototype.segmentIndex=null;jsts.noding.SegmentNode.prototype.segmentOctant=null;jsts.noding.SegmentNode.prototype._isInterior=null;jsts.noding.SegmentNode.prototype.getCoordinate=function(){return this.coord;};jsts.noding.SegmentNode.prototype.isInterior=function(){return this._isInterior;};jsts.noding.SegmentNode.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&!this._isInterior)return true;if(this.segmentIndex===this.maxSegmentIndex)return true;return false;};jsts.noding.SegmentNode.prototype.compareTo=function(obj){var other=obj;if(this.segmentIndex<other.segmentIndex)return-1;if(this.segmentIndex>other.segmentIndex)return 1;if(this.coord.equals2D(other.coord))return 0;return jsts.noding.SegmentPointComparator.compare(this.segmentOctant,this.coord,other.coord);};(function(){jsts.io.GeoJSONWriter=function(){this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONWriter.prototype.write=function(geometry){var geoJson=this.parser.write(geometry);return geoJson;};})();jsts.io.OpenLayersParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();};jsts.io.OpenLayersParser.prototype.read=function(geometry){if(geometry.CLASS_NAME==='OpenLayers.Geometry.Point'){return this.convertFromPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LineString'){return this.convertFromLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LinearRing'){return this.convertFromLinearRing(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Polygon'){return this.convertFromPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPoint'){return this.convertFromMultiPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiLineString'){return this.convertFromMultiLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPolygon'){return this.convertFromMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Collection'){return this.convertFromCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertFromPoint=function(point){return this.geometryFactory.createPoint(new jsts.geom.Coordinate(point.x,point.y));};jsts.io.OpenLayersParser.prototype.convertFromLineString=function(lineString){var i;var coordinates=[];for(i=0;i<lineString.components.length;i++){coordinates.push(new jsts.geom.Coordinate(lineString.components[i].x,lineString.components[i].y));}
return this.geometryFactory.createLineString(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromLinearRing=function(linearRing){var i;var coordinates=[];for(i=0;i<linearRing.components.length;i++){coordinates.push(new jsts.geom.Coordinate(linearRing.components[i].x,linearRing.components[i].y));}
return this.geometryFactory.createLinearRing(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromPolygon=function(polygon){var i;var shell=null;var holes=[];for(i=0;i<polygon.components.length;i++){var linearRing=this.convertFromLinearRing(polygon.components[i]);if(i===0){shell=linearRing;}else{holes.push(linearRing);}}
return this.geometryFactory.createPolygon(shell,holes);};jsts.io.OpenLayersParser.prototype.convertFromMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.components.length;i++){points.push(this.convertFromPoint(multiPoint.components[i]));}
return this.geometryFactory.createMultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertFromMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.components.length;i++){lineStrings.push(this.convertFromLineString(multiLineString.components[i]));}
return this.geometryFactory.createMultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertFromMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.components.length;i++){polygons.push(this.convertFromPolygon(multiPolygon.components[i]));}
return this.geometryFactory.createMultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertFromCollection=function(collection){var i;var geometries=[];for(i=0;i<collection.components.length;i++){geometries.push(this.read(collection.components[i]));}
return this.geometryFactory.createGeometryCollection(geometries);};jsts.io.OpenLayersParser.prototype.write=function(geometry){if(geometry.CLASS_NAME==='jsts.geom.Point'){return this.convertToPoint(geometry.coordinate);}else if(geometry.CLASS_NAME==='jsts.geom.LineString'){return this.convertToLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.LinearRing'){return this.convertToLinearRing(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.Polygon'){return this.convertToPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPoint'){return this.convertToMultiPoint(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiLineString'){return this.convertToMultiLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPolygon'){return this.convertToMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.GeometryCollection'){return this.convertToCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertToPoint=function(coordinate){return new OpenLayers.Geometry.Point(coordinate.x,coordinate.y);};jsts.io.OpenLayersParser.prototype.convertToLineString=function(lineString){var i;var points=[];for(i=0;i<lineString.points.length;i++){var coordinate=lineString.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LineString(points);};jsts.io.OpenLayersParser.prototype.convertToLinearRing=function(linearRing){var i;var points=[];for(i=0;i<linearRing.points.length;i++){var coordinate=linearRing.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LinearRing(points);};jsts.io.OpenLayersParser.prototype.convertToPolygon=function(polygon){var i;var rings=[];rings.push(this.convertToLinearRing(polygon.shell));for(i=0;i<polygon.holes.length;i++){var ring=polygon.holes[i];rings.push(this.convertToLinearRing(ring));}
return new OpenLayers.Geometry.Polygon(rings);};jsts.io.OpenLayersParser.prototype.convertToMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.geometries.length;i++){var coordinate=multiPoint.geometries[i].coordinate;points.push(new OpenLayers.Geometry.Point(coordinate.x,coordinate.y));}
return new OpenLayers.Geometry.MultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertToMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.geometries.length;i++){lineStrings.push(this.convertToLineString(multiLineString.geometries[i]));}
return new OpenLayers.Geometry.MultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertToMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.geometries.length;i++){polygons.push(this.convertToPolygon(multiPolygon.geometries[i]));}
return new OpenLayers.Geometry.MultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertToCollection=function(geometryCollection){var i;var geometries=[];for(i=0;i<geometryCollection.geometries.length;i++){var geometry=geometryCollection.geometries[i];var geometryOpenLayers=this.write(geometry);geometries.push(geometryOpenLayers);}
return new OpenLayers.Geometry.Collection(geometries);};jsts.index.quadtree.Quadtree=function(){this.root=new jsts.index.quadtree.Root();this.minExtent=1.0;};jsts.index.quadtree.Quadtree.ensureExtent=function(itemEnv,minExtent){var minx,maxx,miny,maxy;minx=itemEnv.getMinX();maxx=itemEnv.getMaxX();miny=itemEnv.getMinY();maxy=itemEnv.getMaxY();if(minx!==maxx&&miny!==maxy){return itemEnv;}
if(minx===maxx){minx=minx-(minExtent/2.0);maxx=minx+(minExtent/2.0);}
if(miny===maxy){miny=miny-(minExtent/2.0);maxy=miny+(minExtent/2.0);}
return new jsts.geom.Envelope(minx,maxx,miny,maxy);};jsts.index.quadtree.Quadtree.prototype.depth=function(){return this.root.depth();};jsts.index.quadtree.Quadtree.prototype.size=function(){return this.root.size();};jsts.index.quadtree.Quadtree.prototype.insert=function(itemEnv,item){this.collectStats(itemEnv);var insertEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);this.root.insert(insertEnv,item);};jsts.index.quadtree.Quadtree.prototype.remove=function(itemEnv,item){var posEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);return this.root.remove(posEnv,item);};jsts.index.quadtree.Quadtree.prototype.query=function(){if(arguments.length===1){return jsts.index.quadtree.Quadtree.prototype.queryByEnvelope.apply(this,arguments);}else{jsts.index.quadtree.Quadtree.prototype.queryWithVisitor.apply(this,arguments);}};jsts.index.quadtree.Quadtree.prototype.queryByEnvelope=function(searchEnv){var visitor=new jsts.index.ArrayListVisitor();this.query(searchEnv,visitor);return visitor.getItems();};jsts.index.quadtree.Quadtree.prototype.queryWithVisitor=function(searchEnv,visitor){this.root.visit(searchEnv,visitor);};jsts.index.quadtree.Quadtree.prototype.queryAll=function(){var foundItems=[];foundItems=this.root.addAllItems(foundItems);return foundItems;};jsts.index.quadtree.Quadtree.prototype.collectStats=function(itemEnv){var delX=itemEnv.getWidth();if(delX<this.minExtent&&delX>0.0){this.minExtent=delX;}
var delY=itemEnv.getHeight();if(delY<this.minExtent&&delY>0.0){this.minExtent=delY;}};jsts.operation.relate.RelateNodeFactory=function(){};jsts.operation.relate.RelateNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.relate.RelateNodeFactory.prototype.createNode=function(coord){return new jsts.operation.relate.RelateNode(coord,new jsts.operation.relate.EdgeEndBundleStar());};jsts.index.quadtree.Key=function(itemEnv){this.pt=new jsts.geom.Coordinate();this.level=0;this.env=null;this.computeKey(itemEnv);};jsts.index.quadtree.Key.computeQuadLevel=function(env){var dx,dy,dMax,level;dx=env.getWidth();dy=env.getHeight();dMax=dx>dy?dx:dy;level=jsts.index.DoubleBits.exponent(dMax)+1;return level;};jsts.index.quadtree.Key.prototype.getPoint=function(){return this.pt;};jsts.index.quadtree.Key.prototype.getLevel=function(){return this.level;};jsts.index.quadtree.Key.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Key.prototype.getCentre=function(){var x,y;x=(this.env.getMinX()+this.env.getMaxX())/2;y=(this.env.getMinY()+this.env.getMaxY())/2;return new jsts.geom.Coordinate(x,y);};jsts.index.quadtree.Key.prototype.computeKey=function(){if(arguments[0]instanceof jsts.geom.Envelope){this.computeKeyFromEnvelope(arguments[0]);}else{this.computeKeyFromLevel(arguments[0],arguments[1]);}};jsts.index.quadtree.Key.prototype.computeKeyFromEnvelope=function(env){this.level=jsts.index.quadtree.Key.computeQuadLevel(env);this.env=new jsts.geom.Envelope();this.computeKey(this.level,env);while(!this.env.contains(env)){this.level+=1;this.computeKey(this.level,env);}};jsts.index.quadtree.Key.prototype.computeKeyFromLevel=function(level,env){var quadSize=jsts.index.DoubleBits.powerOf2(level);this.pt.x=Math.floor(env.getMinX()/quadSize)*quadSize;this.pt.y=Math.floor(env.getMinY()/quadSize)*quadSize;this.env.init(this.pt.x,this.pt.x+quadSize,this.pt.y,this.pt.y+
quadSize);};jsts.geom.CoordinateArrays=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.CoordinateArrays.copyDeep=function(){if(arguments.length===1){return jsts.geom.CoordinateArrays.copyDeep1(arguments[0]);}else if(arguments.length===5){jsts.geom.CoordinateArrays.copyDeep2(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);}};jsts.geom.CoordinateArrays.copyDeep1=function(coordinates){var copy=[];for(var i=0;i<coordinates.length;i++){copy[i]=new jsts.geom.Coordinate(coordinates[i]);}
return copy;};jsts.geom.CoordinateArrays.copyDeep2=function(src,srcStart,dest,destStart,length){for(var i=0;i<length;i++){dest[destStart+i]=new jsts.geom.Coordinate(src[srcStart+i]);}};jsts.geom.CoordinateArrays.removeRepeatedPoints=function(coord){var coordList;if(!this.hasRepeatedPoints(coord)){return coord;}
coordList=new jsts.geom.CoordinateList(coord,false);return coordList.toCoordinateArray();};jsts.geom.CoordinateArrays.hasRepeatedPoints=function(coord){var i;for(i=1;i<coord.length;i++){if(coord[i-1].equals(coord[i])){return true;}}
return false;};jsts.geom.CoordinateArrays.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(jsts.geom.CoordinateArrays.indexOf(testPt,pts)<0)
return testPt;}
return null;};jsts.geom.CoordinateArrays.increasingDirection=function(pts){for(var i=0;i<parseInt(pts.length/2);i++){var j=pts.length-1-i;var comp=pts[i].compareTo(pts[j]);if(comp!=0)
return comp;}
return 1;};jsts.geom.CoordinateArrays.minCoordinate=function(coordinates){var minCoord=null;for(var i=0;i<coordinates.length;i++){if(minCoord===null||minCoord.compareTo(coordinates[i])>0){minCoord=coordinates[i];}}
return minCoord;};jsts.geom.CoordinateArrays.scroll=function(coordinates,firstCoordinate){var i=jsts.geom.CoordinateArrays.indexOf(firstCoordinate,coordinates);if(i<0)
return;var newCoordinates=coordinates.slice(i).concat(coordinates.slice(0,i));for(i=0;i<newCoordinates.length;i++){coordinates[i]=newCoordinates[i];}};jsts.geom.CoordinateArrays.indexOf=function(coordinate,coordinates){for(var i=0;i<coordinates.length;i++){if(coordinate.equals(coordinates[i])){return i;}}
return-1;};jsts.operation.overlay.MinimalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MinimalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MinimalEdgeRing.constructor=jsts.operation.overlay.MinimalEdgeRing;jsts.operation.overlay.MinimalEdgeRing.prototype.getNext=function(de){return de.getNextMin();};jsts.operation.overlay.MinimalEdgeRing.prototype.setEdgeRing=function(de,er){de.setMinEdgeRing(er);};jsts.triangulate.DelaunayTriangulationBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;};jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates=function(geom){if(geom===undefined||geom===null){return new jsts.geom.CoordinateList([],false).toArray();}
var coords=geom.getCoordinates();return jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.unique=function(coords){coords.sort(function(a,b){return a.compareTo(b);});var coordList=new jsts.geom.CoordinateList(coords,false);return coordList.toArray();};jsts.triangulate.DelaunayTriangulationBuilder.toVertices=function(coords){var verts=new Array(coords.length),i=0,il=coords.length,coord;for(i;i<il;i++){coord=coords[i];verts[i]=new jsts.triangulate.quadedge.Vertex(coord);}
return verts;};jsts.triangulate.DelaunayTriangulationBuilder.envelope=function(coords){var env=new jsts.geom.Envelope(),i=0,il=coords.length;for(i;i<il;i++){env.expandToInclude(coords[i]);}
return env;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesFromGeometry(arg);}else{this.setSitesFromCollection(arg);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromCollection=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setTolerance=function(tolerance){this.tolerance=tolerance;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.create=function(){if(this.subdiv===null){var siteEnv,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getEdges=function(geomFact){this.create();return this.subdiv.getEdges(geomFact);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getTriangles=function(geomFact){this.create();return this.subdiv.getTriangles(geomFact);};jsts.algorithm.RayCrossingCounter=function(p){this.p=p;};jsts.algorithm.RayCrossingCounter.locatePointInRing=function(p,ring){var counter=new jsts.algorithm.RayCrossingCounter(p);for(var i=1;i<ring.length;i++){var p1=ring[i];var p2=ring[i-1];counter.countSegment(p1,p2);if(counter.isOnSegment())
return counter.getLocation();}
return counter.getLocation();};jsts.algorithm.RayCrossingCounter.prototype.p=null;jsts.algorithm.RayCrossingCounter.prototype.crossingCount=0;jsts.algorithm.RayCrossingCounter.prototype.isPointOnSegment=false;jsts.algorithm.RayCrossingCounter.prototype.countSegment=function(p1,p2){if(p1.x<this.p.x&&p2.x<this.p.x)
return;if(this.p.x==p2.x&&this.p.y===p2.y){this.isPointOnSegment=true;return;}
if(p1.y===this.p.y&&p2.y===this.p.y){var minx=p1.x;var maxx=p2.x;if(minx>maxx){minx=p2.x;maxx=p1.x;}
if(this.p.x>=minx&&this.p.x<=maxx){this.isPointOnSegment=true;}
return;}
if(((p1.y>this.p.y)&&(p2.y<=this.p.y))||((p2.y>this.p.y)&&(p1.y<=this.p.y))){var x1=p1.x-this.p.x;var y1=p1.y-this.p.y;var x2=p2.x-this.p.x;var y2=p2.y-this.p.y;var xIntSign=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2);if(xIntSign===0.0){this.isPointOnSegment=true;return;}
if(y2<y1)
xIntSign=-xIntSign;if(xIntSign>0.0){this.crossingCount++;}}};jsts.algorithm.RayCrossingCounter.prototype.isOnSegment=function(){return jsts.geom.isPointOnSegment;};jsts.algorithm.RayCrossingCounter.prototype.getLocation=function(){if(this.isPointOnSegment)
return jsts.geom.Location.BOUNDARY;if((this.crossingCount%2)===1){return jsts.geom.Location.INTERIOR;}
return jsts.geom.Location.EXTERIOR;};jsts.algorithm.RayCrossingCounter.prototype.isPointInPolygon=function(){return this.getLocation()!==jsts.geom.Location.EXTERIOR;};jsts.operation.BoundaryOp=function(geom,bnRule){this.geom=geom;this.geomFact=geom.getFactory();this.bnRule=bnRule||jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;};jsts.operation.BoundaryOp.prototype.geom=null;jsts.operation.BoundaryOp.prototype.geomFact=null;jsts.operation.BoundaryOp.prototype.bnRule=null;jsts.operation.BoundaryOp.prototype.getBoundary=function(){if(this.geom instanceof jsts.geom.LineString)return this.boundaryLineString(this.geom);if(this.geom instanceof jsts.geom.MultiLineString)return this.boundaryMultiLineString(this.geom);return this.geom.getBoundary();};jsts.operation.BoundaryOp.prototype.getEmptyMultiPoint=function(){return this.geomFact.createMultiPoint(null);};jsts.operation.BoundaryOp.prototype.boundaryMultiLineString=function(mLine){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
var bdyPts=this.computeBoundaryCoordinates(mLine);if(bdyPts.length==1){return this.geomFact.createPoint(bdyPts[0]);}
return this.geomFact.createMultiPoint(bdyPts);};jsts.operation.BoundaryOp.prototype.endpoints=null;jsts.operation.BoundaryOp.prototype.computeBoundaryCoordinates=function(mLine){var i,line,endpoint,bdyPts=[];this.endpoints=[];for(i=0;i<mLine.getNumGeometries();i++){line=mLine.getGeometryN(i);if(line.getNumPoints()==0)
continue;this.addEndpoint(line.getCoordinateN(0));this.addEndpoint(line.getCoordinateN(line.getNumPoints()-1));}
for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(this.bnRule.isInBoundary(endpoint.count)){bdyPts.push(endpoint.coordinate);}}
return bdyPts;};jsts.operation.BoundaryOp.prototype.addEndpoint=function(pt){var i,endpoint,found=false;for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(endpoint.coordinate.equals(pt)){found=true;break;}}
if(!found){endpoint={};endpoint.coordinate=pt;endpoint.count=0;this.endpoints.push(endpoint);}
endpoint.count++;};jsts.operation.BoundaryOp.prototype.boundaryLineString=function(line){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
if(line.isClosed()){var closedEndpointOnBoundary=this.bnRule.isInBoundary(2);if(closedEndpointOnBoundary){return line.getStartPoint();}
else{return this.geomFact.createMultiPoint(null);}}
return this.geomFact.createMultiPoint([line.getStartPoint(),line.getEndPoint()]);};jsts.operation.buffer.OffsetCurveSetBuilder=function(inputGeom,distance,curveBuilder){this.inputGeom=inputGeom;this.distance=distance;this.curveBuilder=curveBuilder;this.curveList=new javascript.util.ArrayList();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.inputGeom=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.distance=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveBuilder=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveList=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.getCurves=function(){this.add(this.inputGeom);return this.curveList;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCurve=function(coord,leftLoc,rightLoc){if(coord==null||coord.length<2)
return;var e=new jsts.noding.NodedSegmentString(coord,new jsts.geomgraph.Label(0,jsts.geom.Location.BOUNDARY,leftLoc,rightLoc));this.curveList.add(e);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.add=function(g){if(g.isEmpty())
return;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPoint=function(p){if(this.distance<=0.0)
return;var coord=p.getCoordinates();var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addLineString=function(line){if(this.distance<=0.0&&!this.curveBuilder.getBufferParameters().isSingleSided())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygon=function(p){var offsetDistance=this.distance;var offsetSide=jsts.geomgraph.Position.LEFT;if(this.distance<0.0){offsetDistance=-this.distance;offsetSide=jsts.geomgraph.Position.RIGHT;}
var shell=p.getExteriorRing();var shellCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(shell.getCoordinates());if(this.distance<0.0&&this.isErodedCompletely(shell,this.distance))
return;if(this.distance<=0.0&&shellCoord.length<3)
return;this.addPolygonRing(shellCoord,offsetDistance,offsetSide,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holeCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(hole.getCoordinates());if(this.distance>0.0&&this.isErodedCompletely(hole,-this.distance))
continue;this.addPolygonRing(holeCoord,offsetDistance,jsts.geomgraph.Position.opposite(offsetSide),jsts.geom.Location.INTERIOR,jsts.geom.Location.EXTERIOR);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygonRing=function(coord,offsetDistance,side,cwLeftLoc,cwRightLoc){if(offsetDistance==0.0&&coord.length<jsts.geom.LinearRing.MINIMUM_VALID_SIZE)
return;var leftLoc=cwLeftLoc;var rightLoc=cwRightLoc;if(coord.length>=jsts.geom.LinearRing.MINIMUM_VALID_SIZE&&jsts.algorithm.CGAlgorithms.isCCW(coord)){leftLoc=cwRightLoc;rightLoc=cwLeftLoc;side=jsts.geomgraph.Position.opposite(side);}
var curve=this.curveBuilder.getRingCurve(coord,side,offsetDistance);this.addCurve(curve,leftLoc,rightLoc);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isErodedCompletely=function(ring,bufferDistance){var ringCoord=ring.getCoordinates();var minDiam=0.0;if(ringCoord.length<4)
return bufferDistance<0;if(ringCoord.length==4)
return this.isTriangleErodedCompletely(ringCoord,bufferDistance);var env=ring.getEnvelopeInternal();var envMinDimension=Math.min(env.getHeight(),env.getWidth());if(bufferDistance<0.0&&2*Math.abs(bufferDistance)>envMinDimension)
return true;return false;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isTriangleErodedCompletely=function(triangleCoord,bufferDistance){var tri=new jsts.geom.Triangle(triangleCoord[0],triangleCoord[1],triangleCoord[2]);var inCentre=tri.inCentre();var distToCentre=jsts.algorithm.CGAlgorithms.distancePointLine(inCentre,tri.p0,tri.p1);return distToCentre<Math.abs(bufferDistance);};jsts.operation.buffer.BufferSubgraph=function(){this.dirEdgeList=new javascript.util.ArrayList();this.nodes=new javascript.util.ArrayList();this.finder=new jsts.operation.buffer.RightmostEdgeFinder();};jsts.operation.buffer.BufferSubgraph.prototype.finder=null;jsts.operation.buffer.BufferSubgraph.prototype.dirEdgeList=null;jsts.operation.buffer.BufferSubgraph.prototype.nodes=null;jsts.operation.buffer.BufferSubgraph.prototype.rightMostCoord=null;jsts.operation.buffer.BufferSubgraph.prototype.env=null;jsts.operation.buffer.BufferSubgraph.prototype.getDirectedEdges=function(){return this.dirEdgeList;};jsts.operation.buffer.BufferSubgraph.prototype.getNodes=function(){return this.nodes;};jsts.operation.buffer.BufferSubgraph.prototype.getEnvelope=function(){if(this.env===null){var edgeEnv=new jsts.geom.Envelope();for(var it=this.dirEdgeList.iterator();it.hasNext();){var dirEdge=it.next();var pts=dirEdge.getEdge().getCoordinates();for(var j=0;j<pts.length-1;j++){edgeEnv.expandToInclude(pts[j]);}}
this.env=edgeEnv;}
return this.env;};jsts.operation.buffer.BufferSubgraph.prototype.getRightmostCoordinate=function(){return this.rightMostCoord;};jsts.operation.buffer.BufferSubgraph.prototype.create=function(node){this.addReachable(node);this.finder.findEdge(this.dirEdgeList);this.rightMostCoord=this.finder.getCoordinate();};jsts.operation.buffer.BufferSubgraph.prototype.addReachable=function(startNode){var nodeStack=[];nodeStack.push(startNode);while(nodeStack.length!==0){var node=nodeStack.pop();this.add(node,nodeStack);}};jsts.operation.buffer.BufferSubgraph.prototype.add=function(node,nodeStack){node.setVisited(true);this.nodes.add(node);for(var i=node.getEdges().iterator();i.hasNext();){var de=i.next();this.dirEdgeList.add(de);var sym=de.getSym();var symNode=sym.getNode();if(!symNode.isVisited())
nodeStack.push(symNode);}};jsts.operation.buffer.BufferSubgraph.prototype.clearVisitedEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();de.setVisited(false);}};jsts.operation.buffer.BufferSubgraph.prototype.computeDepth=function(outsideDepth){this.clearVisitedEdges();var de=this.finder.getEdge();var n=de.getNode();var label=de.getLabel();de.setEdgeDepths(jsts.geomgraph.Position.RIGHT,outsideDepth);this.copySymDepths(de);this.computeDepths(de);};jsts.operation.buffer.BufferSubgraph.prototype.computeDepths=function(startEdge){var nodesVisited=[];var nodeQueue=[];var startNode=startEdge.getNode();nodeQueue.push(startNode);nodesVisited.push(startNode);startEdge.setVisited(true);while(nodeQueue.length!==0){var n=nodeQueue.shift();nodesVisited.push(n);this.computeNodeDepth(n);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym.isVisited())
continue;var adjNode=sym.getNode();if(nodesVisited.indexOf(adjNode)===-1){nodeQueue.push(adjNode);nodesVisited.push(adjNode);}}}};jsts.operation.buffer.BufferSubgraph.prototype.computeNodeDepth=function(n){var startEdge=null;for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();if(de.isVisited()||de.getSym().isVisited()){startEdge=de;break;}}
if(startEdge==null)
throw new jsts.error.TopologyError('unable to find edge to compute depths at '+n.getCoordinate());n.getEdges().computeDepths(startEdge);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();de.setVisited(true);this.copySymDepths(de);}};jsts.operation.buffer.BufferSubgraph.prototype.copySymDepths=function(de){var sym=de.getSym();sym.setDepth(jsts.geomgraph.Position.LEFT,de.getDepth(jsts.geomgraph.Position.RIGHT));sym.setDepth(jsts.geomgraph.Position.RIGHT,de.getDepth(jsts.geomgraph.Position.LEFT));};jsts.operation.buffer.BufferSubgraph.prototype.findResultEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();if(de.getDepth(jsts.geomgraph.Position.RIGHT)>=1&&de.getDepth(jsts.geomgraph.Position.LEFT)<=0&&!de.isInteriorAreaEdge()){de.setInResult(true);}}};jsts.operation.buffer.BufferSubgraph.prototype.compareTo=function(o){var graph=o;if(this.rightMostCoord.x<graph.rightMostCoord.x){return-1;}
if(this.rightMostCoord.x>graph.rightMostCoord.x){return 1;}
return 0;};jsts.simplify.DPTransformer=function(distanceTolerance,isEnsureValidTopology){this.distanceTolerance=distanceTolerance;this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DPTransformer.prototype=new jsts.geom.util.GeometryTransformer();jsts.simplify.DPTransformer.prototype.distanceTolerance=null;jsts.simplify.DPTransformer.prototype.isEnsureValidTopology=null;jsts.simplify.DPTransformer.prototype.transformCoordinates=function(coords,parent){var inputPts=coords;var newPts=null;if(inputPts.length==0){newPts=[];}else{newPts=jsts.simplify.DouglasPeuckerLineSimplifier.simplify(inputPts,this.distanceTolerance);}
return newPts;};jsts.simplify.DPTransformer.prototype.transformPolygon=function(geom,parent){if(geom.isEmpty()){return null;}
var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformPolygon.apply(this,arguments);if(parent instanceof jsts.geom.MultiPolygon){return rawGeom;}
return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.transformLinearRing=function(geom,parent){var removeDegenerateRings=parent instanceof jsts.geom.Polygon;var simpResult=jsts.geom.util.GeometryTransformer.prototype.transformLinearRing.apply(this,arguments);if(removeDegenerateRings&&!(simpResult instanceof jsts.geom.LinearRing)){return null;}
return simpResult;};jsts.simplify.DPTransformer.prototype.transformMultiPolygon=function(geom,parent){var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformMultiPolygon.apply(this,arguments);return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.createValidArea=function(rawAreaGeom){if(this.isEnsureValidTopology){return rawAreaGeom.buffer(0.0);}
return rawAreaGeom;};jsts.geom.util.GeometryExtracter=function(clz,comps){this.clz=clz;this.comps=comps;};jsts.geom.util.GeometryExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.GeometryExtracter.prototype.clz=null;jsts.geom.util.GeometryExtracter.prototype.comps=null;jsts.geom.util.GeometryExtracter.extract=function(geom,clz,list){list=list||new javascript.util.ArrayList();if(geom instanceof clz){list.add(geom);}
else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.GeometryExtracter(clz,list));}
return list;};jsts.geom.util.GeometryExtracter.prototype.filter=function(geom){if(this.clz===null||geom instanceof this.clz){this.comps.add(geom);}};(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapOverlayOp=jsts.operation.overlay.snap.SnapOverlayOp;var SnapIfNeededOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;};SnapIfNeededOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapIfNeededOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapIfNeededOverlayOp.intersection=function(g0,g1){return overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapIfNeededOverlayOp.union=function(g0,g1){return overlayOp(g0,g1,OverlayOp.UNION);};SnapIfNeededOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapIfNeededOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapIfNeededOverlayOp.prototype.geom=null;SnapIfNeededOverlayOp.prototype.getResultGeometry=function(opCode){var result=null;var isSuccess=false;var savedException=null;try{result=OverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);var isValid=true;if(isValid)
isSuccess=true;}catch(ex){savedException=ex;}
if(!isSuccess){try{result=SnapOverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);}catch(ex){throw savedException;}}
return result;};jsts.operation.overlay.snap.SnapIfNeededOverlayOp=SnapIfNeededOverlayOp;})();(function(){var GeometryExtracter=jsts.geom.util.GeometryExtracter;var CascadedPolygonUnion=jsts.operation.union.CascadedPolygonUnion;var PointGeometryUnion=jsts.operation.union.PointGeometryUnion;var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapIfNeededOverlayOp=jsts.operation.overlay.snap.SnapIfNeededOverlayOp;var ArrayList=javascript.util.ArrayList;jsts.operation.union.UnaryUnionOp=function(geoms,geomFact){this.polygons=new ArrayList();this.lines=new ArrayList();this.points=new ArrayList();if(geomFact){this.geomFact=geomFact;}
this.extract(geoms);};jsts.operation.union.UnaryUnionOp.union=function(geoms,geomFact){var op=new jsts.operation.union.UnaryUnionOp(geoms,geomFact);return op.union();};jsts.operation.union.UnaryUnionOp.prototype.polygons=null;jsts.operation.union.UnaryUnionOp.prototype.lines=null;jsts.operation.union.UnaryUnionOp.prototype.points=null;jsts.operation.union.UnaryUnionOp.prototype.geomFact=null;jsts.operation.union.UnaryUnionOp.prototype.extract=function(geoms){if(geoms instanceof ArrayList){for(var i=geoms.iterator();i.hasNext();){var geom=i.next();this.extract(geom);}}else{if(this.geomFact===null){this.geomFact=geoms.getFactory();}
GeometryExtracter.extract(geoms,jsts.geom.Polygon,this.polygons);GeometryExtracter.extract(geoms,jsts.geom.LineString,this.lines);GeometryExtracter.extract(geoms,jsts.geom.Point,this.points);}};jsts.operation.union.UnaryUnionOp.prototype.union=function(){if(this.geomFact===null){return null;}
var unionPoints=null;if(this.points.size()>0){var ptGeom=this.geomFact.buildGeometry(this.points);unionPoints=this.unionNoOpt(ptGeom);}
var unionLines=null;if(this.lines.size()>0){var lineGeom=this.geomFact.buildGeometry(this.lines);unionLines=this.unionNoOpt(lineGeom);}
var unionPolygons=null;if(this.polygons.size()>0){unionPolygons=CascadedPolygonUnion.union(this.polygons);}
var unionLA=this.unionWithNull(unionLines,unionPolygons);var union=null;if(unionPoints===null){union=unionLA;}else if(unionLA===null){union=unionPoints;}else{union=PointGeometryUnion(unionPoints,unionLA);}
if(union===null){return this.geomFact.createGeometryCollection(null);}
return union;};jsts.operation.union.UnaryUnionOp.prototype.unionWithNull=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g1===null){return g0;}
if(g0===null){return g1;}
return g0.union(g1);};jsts.operation.union.UnaryUnionOp.prototype.unionNoOpt=function(g0){var empty=this.geomFact.createPoint(null);return SnapIfNeededOverlayOp.overlayOp(g0,empty,OverlayOp.UNION);};}());jsts.index.kdtree.KdNode=function(){this.left=null;this.right=null;this.count=1;if(arguments.length===2){this.initializeFromCoordinate.apply(this,arguments[0],arguments[1]);}else if(arguments.length===3){this.initializeFromXY.apply(this,arguments[0],arguments[1],arguments[2]);}};jsts.index.kdtree.KdNode.prototype.initializeFromXY=function(x,y,data){this.p=new jsts.geom.Coordinate(x,y);this.data=data;};jsts.index.kdtree.KdNode.prototype.initializeFromCoordinate=function(p,data){this.p=p;this.data=data;};jsts.index.kdtree.KdNode.prototype.getX=function(){return this.p.x;};jsts.index.kdtree.KdNode.prototype.getY=function(){return this.p.y;};jsts.index.kdtree.KdNode.prototype.getCoordinate=function(){return this.p;};jsts.index.kdtree.KdNode.prototype.getData=function(){return this.data;};jsts.index.kdtree.KdNode.prototype.getLeft=function(){return this.left;};jsts.index.kdtree.KdNode.prototype.getRight=function(){return this.right;};jsts.index.kdtree.KdNode.prototype.increment=function(){this.count+=1;};jsts.index.kdtree.KdNode.prototype.getCount=function(){return this.count;};jsts.index.kdtree.KdNode.prototype.isRepeated=function(){return count>1;};jsts.index.kdtree.KdNode.prototype.setLeft=function(left){this.left=left;};jsts.index.kdtree.KdNode.prototype.setRight=function(right){this.right=right;};jsts.algorithm.InteriorPointPoint=function(geometry){this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.add(geometry);};jsts.algorithm.InteriorPointPoint.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Point){this.addPoint(geometry.getCoordinate());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointPoint.prototype.addPoint=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.algorithm.InteriorPointPoint.prototype.getInteriorPoint=function(){return this.interiorPoint;};(function(){jsts.geom.MultiLineString=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiLineString.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiLineString.constructor=jsts.geom.MultiLineString;jsts.geom.MultiLineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.MultiLineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiLineString.prototype.CLASS_NAME='jsts.geom.MultiLineString';})();(function(){var Interval=jsts.index.bintree.Interval;var Root=jsts.index.bintree.Root;var Bintree=function(){this.root=new Root();this.minExtent=1.0;};Bintree.ensureExtent=function(itemInterval,minExtent){var min,max;min=itemInterval.getMin();max=itemInterval.getMax();if(min!==max){return itemInterval;}
if(min===max){min=min-(minExtent/2.0);max=min+(minExtent/2.0);}
return new Interval(min,max);};Bintree.prototype.depth=function(){if(this.root!==null){return this.root.depth();}
return 0;};Bintree.prototype.size=function(){if(this.root!==null){return this.root.size();}
return 0;};Bintree.prototype.nodeSize=function(){if(this.root!==null){return this.root.nodeSize();}
return 0;};Bintree.prototype.insert=function(itemInterval,item){this.collectStats(itemInterval);var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);this.root.insert(insertInterval,item);};Bintree.prototype.remove=function(itemInterval,item){var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);return this.root.remove(insertInterval,item);};Bintree.prototype.iterator=function(){var foundItems=new javascript.util.ArrayList();this.root.addAllItems(foundItems);return foundItems.iterator();};Bintree.prototype.query=function(){if(arguments.length===2){this.queryAndAdd(arguments[0],arguments[1]);}else{var x=arguments[0];if(!x instanceof Interval){x=new Interval(x,x);}
return this.queryInterval(x);}};Bintree.prototype.queryInterval=function(interval){var foundItems=new javascript.util.ArrayList();this.query(interval,foundItems);return foundItems;};Bintree.prototype.queryAndAdd=function(interval,foundItems){this.root.addAllItemsFromOverlapping(interval,foundItems);};Bintree.prototype.collectStats=function(interval){var del=interval.getWidth();if(del<this.minExtent&&del>0.0){this.minExtent=del;}};jsts.index.bintree.Bintree=Bintree;})();jsts.algorithm.InteriorPointArea=function(geometry){this.factory;this.interiorPoint=null;this.maxWidth=0;this.factory=geometry.getFactory();this.add(geometry);};jsts.algorithm.InteriorPointArea.avg=function(a,b){return(a+b)/2;};jsts.algorithm.InteriorPointArea.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointArea.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Polygon){this.addPolygon(geometry);}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointArea.prototype.addPolygon=function(geometry){if(geometry.isEmpty()){return;}
var intPt;var width=0;var bisector=this.horizontalBisector(geometry);if(bisector.getLength()==0.0){width=0;intPt=bisector.getCoordinate();}else{var intersections=bisector.intersection(geometry);var widestIntersection=this.widestGeometry(intersections);width=widestIntersection.getEnvelopeInternal().getWidth();intPt=this.centre(widestIntersection.getEnvelopeInternal());}
if(this.interiorPoint==null||width>this.maxWidth){this.interiorPoint=intPt;this.maxWidth=width;}};jsts.algorithm.InteriorPointArea.prototype.widestGeometry=function(obj){if(obj instanceof jsts.geom.GeometryCollection){var gc=obj;if(gc.isEmpty()){return gc;}
var widestGeometry=gc.getGeometryN(0);for(var i=1;i<gc.getNumGeometries();i++){if(gc.getGeometryN(i).getEnvelopeInternal().getWidth()>widestGeometry.getEnvelopeInternal().getWidth()){widestGeometry=gc.getGeometryN(i);}}
return widestGeometry;}else if(obj instanceof jsts.geom.Geometry){return obj;}};jsts.algorithm.InteriorPointArea.prototype.horizontalBisector=function(geometry){var envelope=geometry.getEnvelopeInternal();var bisectY=jsts.algorithm.SafeBisectorFinder.getBisectorY(geometry);return this.factory.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),bisectY),new jsts.geom.Coordinate(envelope.getMaxX(),bisectY)]);};jsts.algorithm.InteriorPointArea.prototype.centre=function(envelope){return new jsts.geom.Coordinate(jsts.algorithm.InteriorPointArea.avg(envelope.getMinX(),envelope.getMaxX()),jsts.algorithm.InteriorPointArea.avg(envelope.getMinY(),envelope.getMaxY()));};jsts.algorithm.SafeBisectorFinder=function(poly){this.poly;this.centreY;this.hiY=Number.MAX_VALUE;this.loY=-Number.MAX_VALUE;this.poly=poly;this.hiY=poly.getEnvelopeInternal().getMaxY();this.loY=poly.getEnvelopeInternal().getMinY();this.centreY=jsts.algorithm.InteriorPointArea.avg(this.loY,this.hiY);};jsts.algorithm.SafeBisectorFinder.getBisectorY=function(poly){var finder=new jsts.algorithm.SafeBisectorFinder(poly);return finder.getBisectorY();};jsts.algorithm.SafeBisectorFinder.prototype.getBisectorY=function(){this.process(this.poly.getExteriorRing());for(var i=0;i<this.poly.getNumInteriorRing();i++){this.process(this.poly.getInteriorRingN(i));}
var bisectY=jsts.algorithm.InteriorPointArea.avg(this.hiY,this.loY);return bisectY;};jsts.algorithm.SafeBisectorFinder.prototype.process=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length;i++){var y=seq[i].y;this.updateInterval(y);}};jsts.algorithm.SafeBisectorFinder.prototype.updateInterval=function(y){if(y<=this.centreY){if(y>this.loY){this.loY=y;}}else if(y>this.centreY){if(y<this.hiY){this.hiY=y;}}};jsts.operation.buffer.BufferParameters=function(quadrantSegments,endCapStyle,joinStyle,mitreLimit){if(quadrantSegments)
this.setQuadrantSegments(quadrantSegments);if(endCapStyle)
this.setEndCapStyle(endCapStyle);if(joinStyle)
this.setJoinStyle(joinStyle);if(mitreLimit)
this.setMitreLimit(mitreLimit);};jsts.operation.buffer.BufferParameters.CAP_ROUND=1;jsts.operation.buffer.BufferParameters.CAP_FLAT=2;jsts.operation.buffer.BufferParameters.CAP_SQUARE=3;jsts.operation.buffer.BufferParameters.JOIN_ROUND=1;jsts.operation.buffer.BufferParameters.JOIN_MITRE=2;jsts.operation.buffer.BufferParameters.JOIN_BEVEL=3;jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS=8;jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT=5.0;jsts.operation.buffer.BufferParameters.prototype.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;jsts.operation.buffer.BufferParameters.prototype.endCapStyle=jsts.operation.buffer.BufferParameters.CAP_ROUND;jsts.operation.buffer.BufferParameters.prototype.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_ROUND;jsts.operation.buffer.BufferParameters.prototype.mitreLimit=jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT;jsts.operation.buffer.BufferParameters.prototype._isSingleSided=false;jsts.operation.buffer.BufferParameters.prototype.getQuadrantSegments=function(){return this.quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadrantSegments){this.quadrantSegments=quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadSegs){this.quadrantSegments=quadSegs;if(this.quadrantSegments===0)
this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_BEVEL;if(this.quadrantSegments<0){this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_MITRE;this.mitreLimit=Math.abs(this.quadrantSegments);}
if(quadSegs<=0){this.quadrantSegments=1;}
if(this.joinStyle!==jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;}};jsts.operation.buffer.BufferParameters.bufferDistanceError=function(quadSegs){var alpha=Math.PI/2.0/quadSegs;return 1-Math.cos(alpha/2.0);};jsts.operation.buffer.BufferParameters.prototype.getEndCapStyle=function(){return this.endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.setEndCapStyle=function(endCapStyle){this.endCapStyle=endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.getJoinStyle=function(){return this.joinStyle;};jsts.operation.buffer.BufferParameters.prototype.setJoinStyle=function(joinStyle){this.joinStyle=joinStyle;};jsts.operation.buffer.BufferParameters.prototype.getMitreLimit=function(){return this.mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setMitreLimit=function(mitreLimit){this.mitreLimit=mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setSingleSided=function(isSingleSided){this._isSingleSided=isSingleSided;};jsts.operation.buffer.BufferParameters.prototype.isSingleSided=function(){return this._isSingleSided;};(function(){jsts.geom.util.ShortCircuitedGeometryVisitor=function(){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=false;jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.applyTo=function(geom){for(var i=0;i<geom.getNumGeometries()&&!this.isDone;i++){var element=geom.getGeometryN(i);if(!(element instanceof jsts.geom.GeometryCollection)){this.visit(element);if(this.isDone()){this.isDone=true;return;}}
else
this.applyTo(element);}}
jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.visit=function(element){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=function(){};})();(function(){var EnvelopeIntersectsVisitor=function(rectEnv){this.rectEnv=rectEnv;};EnvelopeIntersectsVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();EnvelopeIntersectsVisitor.constructor=EnvelopeIntersectsVisitor;EnvelopeIntersectsVisitor.prototype.rectEnv=null;EnvelopeIntersectsVisitor.prototype.intersects=false;EnvelopeIntersectsVisitor.prototype.intersects=function(){return this.intersects;}
EnvelopeIntersectsVisitor.prototype.visit=function(element){var elementEnv=element.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv)){return;}
if(this.rectEnv.contains(elementEnv)){this.intersects=true;return;}
if(elementEnv.getMinX()>=rectEnv.getMinX()&&elementEnv.getMaxX()<=rectEnv.getMaxX()){this.intersects=true;return;}
if(elementEnv.getMinY()>=rectEnv.getMinY()&&elementEnv.getMaxY()<=rectEnv.getMaxY()){this.intersects=true;return;}}
EnvelopeIntersectsVisitor.prototype.isDone=function(){return this.intersects==true;}
var GeometryContainsPointVisitor=function(rectangle){this.rectSeq=rectangle.getExteriorRing().getCoordinateSequence();this.rectEnv=rectangle.getEnvelopeInternal();};GeometryContainsPointVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();GeometryContainsPointVisitor.constructor=GeometryContainsPointVisitor;GeometryContainsPointVisitor.prototype.rectSeq=null;GeometryContainsPointVisitor.prototype.rectEnv=null;GeometryContainsPointVisitor.prototype.containsPoint=false;GeometryContainsPointVisitor.prototype.containsPoint=function(){return this.containsPoint;}
GeometryContainsPointVisitor.prototype.visit=function(geom){if(!(geom instanceof jsts.geom.Polygon))
return;var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var rectPt=new jsts.geom.Coordinate();for(var i=0;i<4;i++){this.rectSeq.getCoordinate(i,rectPt);if(!elementEnv.contains(rectPt))
continue;if(SimplePointInAreaLocator.containsPointInPolygon(rectPt,geom)){this.containsPoint=true;return;}}}
GeometryContainsPointVisitor.prototype.isDone=function(){return this.containsPoint==true;}
var RectangleIntersectsSegmentVisitor=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();this.rectIntersector=new RectangleLineIntersector(rectEnv);};RectangleIntersectsSegmentVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();RectangleIntersectsSegmentVisitor.constructor=RectangleIntersectsSegmentVisitor;RectangleIntersectsSegmentVisitor.prototype.rectEnv=null;RectangleIntersectsSegmentVisitor.prototype.rectIntersector=null;RectangleIntersectsSegmentVisitor.prototype.hasIntersection=false;RectangleIntersectsSegmentVisitor.prototype.p0=null;RectangleIntersectsSegmentVisitor.prototype.p1=null;RectangleIntersectsSegmentVisitor.prototype.intersects=function(){return this.hasIntersection;}
RectangleIntersectsSegmentVisitor.prototype.visit=function(geom){var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var lines=LinearComponentExtracter.getLines(geom);this.checkIntersectionWithLineStrings(lines);}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithLineStrings=function(lines){for(var i=lines.iterator();i.hasNext();){var testLine=i.next();this.checkIntersectionWithSegments(testLine);if(this.hasIntersection)
return;}}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithSegments=function(testLine){var seq1=testLine.getCoordinateSequence();for(var j=1;j<seq1.length;j++){this.p0=seq1[j-1];this.p1=seq1[j];if(rectIntersector.intersects(p0,p1)){this.hasIntersection=true;return;}}}
RectangleIntersectsSegmentVisitor.prototype.isDone=function(){return this.hasIntersection==true;}
jsts.operation.predicate.RectangleIntersects=function(rectangle){this.rectangle=rectangle;this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleIntersects.intersects=function(rectangle,b){var rp=new jsts.operation.predicate.RectangleIntersects(rectangle);return rp.intersects(b);}
jsts.operation.predicate.RectangleIntersects.prototype.rectangle=null;jsts.operation.predicate.RectangleIntersects.prototype.rectEnv=null;jsts.operation.predicate.RectangleIntersects.prototype.intersects=function(geom){if(!this.rectEnv.intersects(geom.getEnvelopeInternal()))
return false;var visitor=new EnvelopeIntersectsVisitor(this.rectEnv);visitor.applyTo(geom);if(visitor.intersects())
return true;var ecpVisitor=new GeometryContainsPointVisitor(rectangle);ecpVisitor.applyTo(geom);if(ecpVisitor.containsPoint())
return true;var riVisitor=new RectangleIntersectsSegmentVisitor(rectangle);riVisitor.applyTo(geom);if(riVisitor.intersects())
return true;return false;}})();jsts.operation.buffer.BufferBuilder=function(bufParams){this.bufParams=bufParams;this.edgeList=new jsts.geomgraph.EdgeList();};jsts.operation.buffer.BufferBuilder.depthDelta=function(label){var lLoc=label.getLocation(0,jsts.geomgraph.Position.LEFT);var rLoc=label.getLocation(0,jsts.geomgraph.Position.RIGHT);if(lLoc===jsts.geom.Location.INTERIOR&&rLoc===jsts.geom.Location.EXTERIOR)
return 1;else if(lLoc===jsts.geom.Location.EXTERIOR&&rLoc===jsts.geom.Location.INTERIOR)
return-1;return 0;};jsts.operation.buffer.BufferBuilder.prototype.bufParams=null;jsts.operation.buffer.BufferBuilder.prototype.workingPrecisionModel=null;jsts.operation.buffer.BufferBuilder.prototype.workingNoder=null;jsts.operation.buffer.BufferBuilder.prototype.geomFact=null;jsts.operation.buffer.BufferBuilder.prototype.graph=null;jsts.operation.buffer.BufferBuilder.prototype.edgeList=null;jsts.operation.buffer.BufferBuilder.prototype.setWorkingPrecisionModel=function(pm){this.workingPrecisionModel=pm;};jsts.operation.buffer.BufferBuilder.prototype.setNoder=function(noder){this.workingNoder=noder;};jsts.operation.buffer.BufferBuilder.prototype.buffer=function(g,distance){var precisionModel=this.workingPrecisionModel;if(precisionModel===null)
precisionModel=g.getPrecisionModel();this.geomFact=g.getFactory();var curveBuilder=new jsts.operation.buffer.OffsetCurveBuilder(precisionModel,this.bufParams);var curveSetBuilder=new jsts.operation.buffer.OffsetCurveSetBuilder(g,distance,curveBuilder);var bufferSegStrList=curveSetBuilder.getCurves();if(bufferSegStrList.size()<=0){return this.createEmptyResultGeometry();}
this.computeNodedEdges(bufferSegStrList,precisionModel);this.graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());this.graph.addEdges(this.edgeList.getEdges());var subgraphList=this.createSubgraphs(this.graph);var polyBuilder=new jsts.operation.overlay.PolygonBuilder(this.geomFact);this.buildSubgraphs(subgraphList,polyBuilder);var resultPolyList=polyBuilder.getPolygons();if(resultPolyList.size()<=0){return this.createEmptyResultGeometry();}
var resultGeom=this.geomFact.buildGeometry(resultPolyList);return resultGeom;};jsts.operation.buffer.BufferBuilder.prototype.getNoder=function(precisionModel){if(this.workingNoder!==null)
return this.workingNoder;var noder=new jsts.noding.MCIndexNoder();var li=new jsts.algorithm.RobustLineIntersector();li.setPrecisionModel(precisionModel);noder.setSegmentIntersector(new jsts.noding.IntersectionAdder(li));return noder;};jsts.operation.buffer.BufferBuilder.prototype.computeNodedEdges=function(bufferSegStrList,precisionModel){var noder=this.getNoder(precisionModel);noder.computeNodes(bufferSegStrList);var nodedSegStrings=noder.getNodedSubstrings();for(var i=nodedSegStrings.iterator();i.hasNext();){var segStr=i.next();var oldLabel=segStr.getData();var edge=new jsts.geomgraph.Edge(segStr.getCoordinates(),new jsts.geomgraph.Label(oldLabel));this.insertUniqueEdge(edge);}};jsts.operation.buffer.BufferBuilder.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!=null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new jsts.geomgraph.Label(e.getLabel());labelToMerge.flip();}
existingLabel.merge(labelToMerge);var mergeDelta=jsts.operation.buffer.BufferBuilder.depthDelta(labelToMerge);var existingDelta=existingEdge.getDepthDelta();var newDelta=existingDelta+mergeDelta;existingEdge.setDepthDelta(newDelta);}else{this.edgeList.add(e);e.setDepthDelta(jsts.operation.buffer.BufferBuilder.depthDelta(e.getLabel()));}};jsts.operation.buffer.BufferBuilder.prototype.createSubgraphs=function(graph){var subgraphList=[];for(var i=graph.getNodes().iterator();i.hasNext();){var node=i.next();if(!node.isVisited()){var subgraph=new jsts.operation.buffer.BufferSubgraph();subgraph.create(node);subgraphList.push(subgraph);}}
var compare=function(a,b){return a.compareTo(b);};subgraphList.sort(compare);subgraphList.reverse();return subgraphList;};jsts.operation.buffer.BufferBuilder.prototype.buildSubgraphs=function(subgraphList,polyBuilder){var processedGraphs=[];for(var i=0;i<subgraphList.length;i++){var subgraph=subgraphList[i];var p=subgraph.getRightmostCoordinate();var locater=new jsts.operation.buffer.SubgraphDepthLocater(processedGraphs);var outsideDepth=locater.getDepth(p);subgraph.computeDepth(outsideDepth);subgraph.findResultEdges();processedGraphs.push(subgraph);polyBuilder.add(subgraph.getDirectedEdges(),subgraph.getNodes());}};jsts.operation.buffer.BufferBuilder.convertSegStrings=function(it){var fact=new jsts.geom.GeometryFactory();var lines=new javascript.util.ArrayList();while(it.hasNext()){var ss=it.next();var line=fact.createLineString(ss.getCoordinates());lines.add(line);}
return fact.buildGeometry(lines);};jsts.operation.buffer.BufferBuilder.prototype.createEmptyResultGeometry=function(){var emptyGeom=this.geomFact.createPolygon(null,null);return emptyGeom;};jsts.noding.SegmentPointComparator=function(){};jsts.noding.SegmentPointComparator.compare=function(octant,p0,p1){if(p0.equals2D(p1))
return 0;var xSign=jsts.noding.SegmentPointComparator.relativeSign(p0.x,p1.x);var ySign=jsts.noding.SegmentPointComparator.relativeSign(p0.y,p1.y);switch(octant){case 0:return jsts.noding.SegmentPointComparator.compareValue(xSign,ySign);case 1:return jsts.noding.SegmentPointComparator.compareValue(ySign,xSign);case 2:return jsts.noding.SegmentPointComparator.compareValue(ySign,-xSign);case 3:return jsts.noding.SegmentPointComparator.compareValue(-xSign,ySign);case 4:return jsts.noding.SegmentPointComparator.compareValue(-xSign,-ySign);case 5:return jsts.noding.SegmentPointComparator.compareValue(-ySign,-xSign);case 6:return jsts.noding.SegmentPointComparator.compareValue(-ySign,xSign);case 7:return jsts.noding.SegmentPointComparator.compareValue(xSign,-ySign);}
return 0;};jsts.noding.SegmentPointComparator.relativeSign=function(x0,x1){if(x0<x1)
return-1;if(x0>x1)
return 1;return 0;};jsts.noding.SegmentPointComparator.compareValue=function(compareSign0,compareSign1){if(compareSign0<0)
return-1;if(compareSign0>0)
return 1;if(compareSign1<0)
return-1;if(compareSign1>0)
return 1;return 0;};jsts.operation.relate.RelateOp=function(){jsts.operation.GeometryGraphOperation.apply(this,arguments);this._relate=new jsts.operation.relate.RelateComputer(this.arg);};jsts.operation.relate.RelateOp.prototype=new jsts.operation.GeometryGraphOperation();jsts.operation.relate.RelateOp.relate=function(a,b,boundaryNodeRule){var relOp=new jsts.operation.relate.RelateOp(a,b,boundaryNodeRule);var im=relOp.getIntersectionMatrix();return im;};jsts.operation.relate.RelateOp.prototype._relate=null;jsts.operation.relate.RelateOp.prototype.getIntersectionMatrix=function(){return this._relate.computeIM();};jsts.index.chain.MonotoneChain=function(pts,start,end,context){this.pts=pts;this.start=start;this.end=end;this.context=context;};jsts.index.chain.MonotoneChain.prototype.pts=null;jsts.index.chain.MonotoneChain.prototype.start=null;jsts.index.chain.MonotoneChain.prototype.end=null;jsts.index.chain.MonotoneChain.prototype.env=null;jsts.index.chain.MonotoneChain.prototype.context=null;jsts.index.chain.MonotoneChain.prototype.id=null;jsts.index.chain.MonotoneChain.prototype.setId=function(id){this.id=id;};jsts.index.chain.MonotoneChain.prototype.getId=function(){return this.id;};jsts.index.chain.MonotoneChain.prototype.getContext=function(){return this.context;};jsts.index.chain.MonotoneChain.prototype.getEnvelope=function(){if(this.env==null){var p0=this.pts[this.start];var p1=this.pts[this.end];this.env=new jsts.geom.Envelope(p0,p1);}
return this.env;};jsts.index.chain.MonotoneChain.prototype.getStartIndex=function(){return this.start;};jsts.index.chain.MonotoneChain.prototype.getEndIndex=function(){return this.end;};jsts.index.chain.MonotoneChain.prototype.getLineSegment=function(index,ls){ls.p0=this.pts[index];ls.p1=this.pts[index+1];};jsts.index.chain.MonotoneChain.prototype.getCoordinates=function(){var coord=[];var index=0;for(var i=this.start;i<=this.end;i++){coord[index++]=this.pts[i];}
return coord;};jsts.index.chain.MonotoneChain.prototype.select=function(searchEnv,mcs){this.computeSelect2(searchEnv,this.start,this.end,mcs);};jsts.index.chain.MonotoneChain.prototype.computeSelect2=function(searchEnv,start0,end0,mcs){var p0=this.pts[start0];var p1=this.pts[end0];mcs.tempEnv1.init(p0,p1);if(end0-start0===1){mcs.select(this,start0);return;}
if(!searchEnv.intersects(mcs.tempEnv1))
return;var mid=parseInt((start0+end0)/2);if(start0<mid){this.computeSelect2(searchEnv,start0,mid,mcs);}
if(mid<end0){this.computeSelect2(searchEnv,mid,end0,mcs);}};jsts.index.chain.MonotoneChain.prototype.computeOverlaps=function(mc,mco){if(arguments.length===6){return this.computeOverlaps2.apply(this,arguments);}
this.computeOverlaps2(this.start,this.end,mc,mc.start,mc.end,mco);};jsts.index.chain.MonotoneChain.prototype.computeOverlaps2=function(start0,end0,mc,start1,end1,mco){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mc.pts[start1];var p11=mc.pts[end1];if(end0-start0===1&&end1-start1===1){mco.overlap(this,start0,mc,start1);return;}
mco.tempEnv1.init(p00,p01);mco.tempEnv2.init(p10,p11);if(!mco.tempEnv1.intersects(mco.tempEnv2))
return;var mid0=parseInt((start0+end0)/2);var mid1=parseInt((start1+end1)/2);if(start0<mid0){if(start1<mid1)
this.computeOverlaps2(start0,mid0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(start0,mid0,mc,mid1,end1,mco);}
if(mid0<end0){if(start1<mid1)
this.computeOverlaps2(mid0,end0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(mid0,end0,mc,mid1,end1,mco);}};(function(){var Location=jsts.geom.Location;var Dimension=jsts.geom.Dimension;jsts.geom.IntersectionMatrix=function(elements){var other=elements;if(elements===undefined||elements===null){this.matrix=[[],[],[]];this.setAll(Dimension.FALSE);}else if(typeof elements==='string'){this.set(elements);}else if(other instanceof jsts.geom.IntersectionMatrix){this.matrix[Location.INTERIOR][Location.INTERIOR]=other.matrix[Location.INTERIOR][Location.INTERIOR];this.matrix[Location.INTERIOR][Location.BOUNDARY]=other.matrix[Location.INTERIOR][Location.BOUNDARY];this.matrix[Location.INTERIOR][Location.EXTERIOR]=other.matrix[Location.INTERIOR][Location.EXTERIOR];this.matrix[Location.BOUNDARY][Location.INTERIOR]=other.matrix[Location.BOUNDARY][Location.INTERIOR];this.matrix[Location.BOUNDARY][Location.BOUNDARY]=other.matrix[Location.BOUNDARY][Location.BOUNDARY];this.matrix[Location.BOUNDARY][Location.EXTERIOR]=other.matrix[Location.BOUNDARY][Location.EXTERIOR];this.matrix[Location.EXTERIOR][Location.INTERIOR]=other.matrix[Location.EXTERIOR][Location.INTERIOR];this.matrix[Location.EXTERIOR][Location.BOUNDARY]=other.matrix[Location.EXTERIOR][Location.BOUNDARY];this.matrix[Location.EXTERIOR][Location.EXTERIOR]=other.matrix[Location.EXTERIOR][Location.EXTERIOR];}};jsts.geom.IntersectionMatrix.prototype.matrix=null;jsts.geom.IntersectionMatrix.prototype.add=function(im){var i,j;for(i=0;i<3;i++){for(j=0;j<3;j++){this.setAtLeast(i,j,im.get(i,j));}}};jsts.geom.IntersectionMatrix.matches=function(actualDimensionValue,requiredDimensionSymbol){if(typeof actualDimensionValue==='string'){return jsts.geom.IntersectionMatrix.matches2.call(this,arguments);}
if(requiredDimensionSymbol==='*'){return true;}
if(requiredDimensionSymbol==='T'&&(actualDimensionValue>=0||actualDimensionValue===Dimension.TRUE)){return true;}
if(requiredDimensionSymbol==='F'&&actualDimensionValue===Dimension.FALSE){return true;}
if(requiredDimensionSymbol==='0'&&actualDimensionValue===Dimension.P){return true;}
if(requiredDimensionSymbol==='1'&&actualDimensionValue===Dimension.L){return true;}
if(requiredDimensionSymbol==='2'&&actualDimensionValue===Dimension.A){return true;}
return false;};jsts.geom.IntersectionMatrix.matches2=function(actualDimensionSymbols,requiredDimensionSymbols){var m=new jsts.geom.IntersectionMatrix(actualDimensionSymbols);return m.matches(requiredDimensionSymbols);};jsts.geom.IntersectionMatrix.prototype.set=function(row,column,dimensionValue){if(typeof row==='string'){this.set2(row);return;}
this.matrix[row][column]=dimensionValue;};jsts.geom.IntersectionMatrix.prototype.set2=function(dimensionSymbols){for(var i=0;i<dimensionSymbols.length();i++){var row=i/3;var col=i%3;this.matrix[row][col]=Dimension.toDimensionValue(dimensionSymbols.charAt(i));}};jsts.geom.IntersectionMatrix.prototype.setAtLeast=function(row,column,minimumDimensionValue){if(arguments.length===1){this.setAtLeast2(arguments[0]);return;}
if(this.matrix[row][column]<minimumDimensionValue){this.matrix[row][column]=minimumDimensionValue;}};jsts.geom.IntersectionMatrix.prototype.setAtLeastIfValid=function(row,column,minimumDimensionValue){if(row>=0&&column>=0){this.setAtLeast(row,column,minimumDimensionValue);}};jsts.geom.IntersectionMatrix.prototype.setAtLeast2=function(minimumDimensionSymbols){var i;for(i=0;i<minimumDimensionSymbols.length;i++){var row=parseInt(i/3);var col=parseInt(i%3);this.setAtLeast(row,col,jsts.geom.Dimension.toDimensionValue(minimumDimensionSymbols.charAt(i)));}};jsts.geom.IntersectionMatrix.prototype.setAll=function(dimensionValue){var ai,bi;for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){this.matrix[ai][bi]=dimensionValue;}}};jsts.geom.IntersectionMatrix.prototype.get=function(row,column){return this.matrix[row][column];};jsts.geom.IntersectionMatrix.prototype.isDisjoint=function(){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.BOUNDARY]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isIntersects=function(){return!this.isDisjoint();};jsts.geom.IntersectionMatrix.prototype.isTouches=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA>dimensionOfGeometryB){return this.isTouches(dimensionOfGeometryB,dimensionOfGeometryA);}
if((dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&(jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T'));}
return false;};jsts.geom.IntersectionMatrix.prototype.isCrosses=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T');}
if((dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.L)){return jsts.geom.IntersectionMatrix.matches(matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]===0;}
return false;};jsts.geom.IntersectionMatrix.prototype.isWithin=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.INTERIOR][Location.EXTERIOR]==Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isContains=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCovers=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCoveredBy=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isEquals=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA!==dimensionOfGeometryB){return false;}
return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isOverlaps=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB===Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB===Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]==1&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
return false;};jsts.geom.IntersectionMatrix.prototype.matches=function(requiredDimensionSymbols){if(requiredDimensionSymbols.length!=9){throw new jsts.error.IllegalArgumentException('Should be length 9: '+
requiredDimensionSymbols);}
for(var ai=0;ai<3;ai++){for(var bi=0;bi<3;bi++){if(!jsts.geom.IntersectionMatrix.matches(this.matrix[ai][bi],requiredDimensionSymbols.charAt(3*ai+bi))){return false;}}}
return true;};jsts.geom.IntersectionMatrix.prototype.transpose=function(){var temp=matrix[1][0];this.matrix[1][0]=this.matrix[0][1];this.matrix[0][1]=temp;temp=this.matrix[2][0];this.matrix[2][0]=this.matrix[0][2];this.matrix[0][2]=temp;temp=this.matrix[2][1];this.matrix[2][1]=this.matrix[1][2];this.matrix[1][2]=temp;return this;};jsts.geom.IntersectionMatrix.prototype.toString=function(){var ai,bi,buf='';for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){buf+=Dimension.toDimensionSymbol(this.matrix[ai][bi]);}}
return buf;};})();jsts.triangulate.quadedge.LastFoundQuadEdgeLocator=function(subdiv){this.subdiv=subdiv;this.lastEdge=null;this.init();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.init=function(){this.lastEdge=this.findEdge();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.findEdge=function(){var edges=this.subdiv.getEdges();return edges[0];};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.locate=function(v){if(!this.lastEdge.isLive()){this.init();}
var e=this.subdiv.locateFromEdge(v,this.lastEdge);this.lastEdge=e;return e;};jsts.noding.SegmentNodeList=function(edge){this.nodeMap=new javascript.util.TreeMap();this.edge=edge;};jsts.noding.SegmentNodeList.prototype.nodeMap=null;jsts.noding.SegmentNodeList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.noding.SegmentNodeList.prototype.edge=null;jsts.noding.SegmentNodeList.prototype.getEdge=function(){return this.edge;};jsts.noding.SegmentNodeList.prototype.add=function(intPt,segmentIndex){var eiNew=new jsts.noding.SegmentNode(this.edge,intPt,segmentIndex,this.edge.getSegmentOctant(segmentIndex));var ei=this.nodeMap.get(eiNew);if(ei!==null){jsts.util.Assert.isTrue(ei.coord.equals2D(intPt),'Found equal nodes with different coordinates');return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.noding.SegmentNodeList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0);this.add(this.edge.getCoordinate(maxSegIndex),maxSegIndex);};jsts.noding.SegmentNodeList.prototype.addCollapsedNodes=function(){var collapsedVertexIndexes=[];this.findCollapsesFromInsertedNodes(collapsedVertexIndexes);this.findCollapsesFromExistingVertices(collapsedVertexIndexes);for(var i=0;i<collapsedVertexIndexes.length;i++){var vertexIndex=collapsedVertexIndexes[i];this.add(this.edge.getCoordinate(vertexIndex),vertexIndex);}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromExistingVertices=function(collapsedVertexIndexes){for(var i=0;i<this.edge.size()-2;i++){var p0=this.edge.getCoordinate(i);var p1=this.edge.getCoordinate(i+1);var p2=this.edge.getCoordinate(i+2);if(p0.equals2D(p2)){collapsedVertexIndexes.push(i+1);}}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromInsertedNodes=function(collapsedVertexIndexes){var collapsedVertexIndex=[null];var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var isCollapsed=this.findCollapseIndex(eiPrev,ei,collapsedVertexIndex);if(isCollapsed)
collapsedVertexIndexes.push(collapsedVertexIndex[0]);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.findCollapseIndex=function(ei0,ei1,collapsedVertexIndex){if(!ei0.coord.equals2D(ei1.coord))
return false;var numVerticesBetween=ei1.segmentIndex-ei0.segmentIndex;if(!ei1.isInterior()){numVerticesBetween--;}
if(numVerticesBetween===1){collapsedVertexIndex[0]=ei0.segmentIndex+1;return true;}
return false;};jsts.noding.SegmentNodeList.prototype.addSplitEdges=function(edgeList){this.addEndpoints();this.addCollapsedNodes();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.checkSplitEdgesCorrectness=function(splitEdges){var edgePts=edge.getCoordinates();var split0=splitEdges[0];var pt0=split0.getCoordinate(0);if(!pt0.equals2D(edgePts[0]))
throw new Error('bad split edge start point at '+pt0);var splitn=splitEdges[splitEdges.length-1];var splitnPts=splitn.getCoordinates();var ptn=splitnPts[splitnPts.length-1];if(!ptn.equals2D(edgePts[edgePts.length-1]))
throw new Error('bad split edge end point at '+ptn);};jsts.noding.SegmentNodeList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.getCoordinate(ei1.segmentIndex);var useIntPt1=ei1.isInterior()||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.getCoordinate(i);}
if(useIntPt1)
pts[ipt]=ei1.coord;return new jsts.noding.NodedSegmentString(pts,this.edge.getData());};jsts.io.WKTWriter=function(){this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTWriter.prototype.write=function(geometry){var wkt=this.parser.write(geometry);return wkt;};jsts.io.WKTWriter.toLineString=function(p0,p1){if(arguments.length!==2){throw new jsts.error.NotImplementedError();}
return'LINESTRING ( '+p0.x+' '+p0.y+', '+p1.x+' '+p1.y+' )';};jsts.io.WKTReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTReader.prototype.read=function(wkt){var geometry=this.parser.read(wkt);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.WKTReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision=function(env,tolerance){this.tolerance=tolerance;this.edgeCoincidenceTolerance=tolerance/jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR;this.visitedKey=0;this.quadEdges=[];this.startingEdge;this.tolerance;this.edgeCoincidenceTolerance;this.frameEnv;this.locator=null;this.seg=new jsts.geom.LineSegment();this.triEdges=new Array(3);this.frameVertex=new Array(3);this.createFrame(env);this.startingEdge=this.initSubdiv();this.locator=new jsts.triangulate.quadedge.LastFoundQuadEdgeLocator(this);};jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR=1000;jsts.triangulate.quadedge.QuadEdgeSubdivision.getTriangleEdges=function(startQE,triEdge){triEdge[0]=startQE;triEdge[1]=triEdge[0].lNext();triEdge[2]=triEdge[1].lNext();if(triEdge[2].lNext()!=triEdge[0]){throw new jsts.IllegalArgumentError('Edges do not form a triangle');}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.createFrame=function(env){var deltaX,deltaY,offset;deltaX=env.getWidth();deltaY=env.getHeight();offset=0.0;if(deltaX>deltaY){offset=deltaX*10.0;}else{offset=deltaY*10.0;}
this.frameVertex[0]=new jsts.triangulate.quadedge.Vertex((env.getMaxX()+env.getMinX())/2.0,env.getMaxY()
+offset);this.frameVertex[1]=new jsts.triangulate.quadedge.Vertex(env.getMinX()-offset,env.getMinY()-offset);this.frameVertex[2]=new jsts.triangulate.quadedge.Vertex(env.getMaxX()+offset,env.getMinY()-offset);this.frameEnv=new jsts.geom.Envelope(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate());this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate());};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.initSubdiv=function(){var ea,eb,ec;ea=this.makeEdge(this.frameVertex[0],this.frameVertex[1]);eb=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);jsts.triangulate.quadedge.QuadEdge.splice(ea.sym(),eb);ec=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);jsts.triangulate.quadedge.QuadEdge.splice(eb.sym(),ec);jsts.triangulate.quadedge.QuadEdge.splice(ec.sym(),ea);return ea;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTolerance=function(){return this.tolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEnvelope=function(){return new jsts.geom.Envelope(this.frameEnv);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdges=function(){if(arguments.length>0){return this.getEdgesByFactory(arguments[0]);}else{return this.quadEdges;}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.setLocator=function(locator){this.locator=locator;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.makeEdge=function(o,d){var q=jsts.triangulate.quadedge.QuadEdge.makeEdge(o,d);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.connect=function(a,b){var q=jsts.triangulate.quadedge.QuadEdge.connect(a,b);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.delete_jsts=function(e){jsts.triangulate.quadedge.QuadEdge.splice(e,e.oPrev());jsts.triangulate.quadedge.QuadEdge.splice(e.sym(),e.sym().oPrev());var eSym,eRot,eRotSym;e.eSym=e.sym();eRot=e.rot;eRotSym=e.rot.sym();var idx=this.quadEdges.indexOf(e);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRot);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRotSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
e.delete_jsts();eSym.delete_jsts();eRot.delete_jsts();eRotSym.delete_jsts();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateFromEdge=function(v,startEdge){var iter=0,maxIter=this.quadEdges.length,e;e=startEdge;while(true){iter++;if(iter>maxIter){throw new jsts.error.LocateFailureError(e.toLineSegment());}
if((v.equals(e.orig()))||(v.equals(e.dest()))){break;}else if(v.rightOf(e)){e=e.sym();}else if(!v.rightOf(e.oNext())){e=e.oNext();}else if(!v.rightOf(e.dPrev())){e=e.dPrev();}else{break;}}
return e;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locate=function(){if(arguments.length===1){if(arguments[0]instanceof jsts.triangulate.quadedge.Vertex){return this.locateByVertex(arguments[0]);}else{return this.locateByCoordinate(arguments[0]);}}else{return this.locateByCoordinates(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByVertex=function(v){return this.locator.locate(v);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinate=function(p){return this.locator.locate(new jsts.triangulate.quadedge.Vertex(p));};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinates=function(p0,p1){var e,base,locEdge;var e=this.locator.locate(new jsts.triangulate.quadedge.Vertex(p0));if(e===null){return null;}
base=e;if(e.dest().getCoordinate().equals2D(p0)){base=e.sym();}
locEdge=base;do{if(locEdge.dest().getCoordinate().equals2D(p1)){return locEdge;}
locEdge=locEdge.oNext();}while(locEdge!=base);return null;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.insertSite=function(v){var e,base,startEdge;e=this.locate(v);if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return e;}
base=this.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);return startEdge;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameEdge=function(e){if(this.isFrameVertex(e.orig())||this.isFrameVertex(e.dest())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameBorderEdge=function(e){var leftTri,rightTri,vLeftTriOther,vRightTriOther;leftTri=new Array(3);this.getTriangleEdges(e,leftTri);rightTri=new Array(3);this.getTriangleEdges(e.sym(),rightTri);vLeftTriOther=e.lNext().dest();if(this.isFrameVertex(vLeftTriOther)){return true;}
vRightTriOther=e.sym().lNext().dest();if(this.isFrameVertex(vRightTriOther)){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameVertex=function(v){if(v.equals(this.frameVertex[0])){return true;}
if(v.equals(this.frameVertex[1])){return true;}
if(v.equals(this.frameVertex[2])){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isOnEdge=function(e,p){this.seg.setCoordinates(e.orig().getCoordinate(),e.dest().getCoordinate());var dist=this.seg.distance(p);return dist<this.edgeCoincidenceTolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isVertexOfEdge=function(e,v){if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertices=function(includeFrame)
{var vertices=[],i,il,qe,v,vd;i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(includeFrame||!this.isFrameVertex(v)){vertices.push(v);}
vd=qe.dest();if(includeFrame||!this.isFrameVertex(vd)){vertices.push(vd);}}
return vertices;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertexUniqueEdges=function(includeFrame)
{var edges,visitedVertices,i,il,qe,v,qd,vd;edges=[];visitedVertices=[];i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(visitedVertices.indexOf(v)===-1){visitedVertices.push(v);if(includeFrame||!this.isFrameVertex(v)){edges.push(qe);}}
qd=qe.sym();vd=qd.orig();if(visitedVertices.indexOf(vd)===-1){visitedVertices.push(vd);if(includeFrame||!this.isFrameVertex(vd)){edges.push(qd);}}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getPrimaryEdges=function(includeFrame){this.visitedKey++;var edges,edgeStack,visitedEdges,edge,priQE;edges=[];edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){priQE=edge.getPrimary();if(includeFrame||!this.isFrameEdge(priQE)){edges.push(priQE);}
edgeStack.push(edge.oNext());edgeStack.push(edge.sym().oNext());visitedEdges.push(edge);visitedEdges.push(edge.sym());}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.visitTriangles=function(triVisitor,includeFrame){this.visitedKey++;var edgeStack,visitedEdges,edge,triEdges;edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){triEdges=this.fetchTriangleToVisit(edge,edgeStack,includeFrame,visitedEdges);if(triEdges!==null)
triVisitor.visit(triEdges);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.fetchTriangleToVisit=function(edge,edgeStack,includeFrame,visitedEdges){var curr,edgeCount,isFrame,sym;curr=edge;edgeCount=0;isFrame=false;do{this.triEdges[edgeCount]=curr;if(this.isFrameEdge(curr)){isFrame=true;}
sym=curr.sym();if(visitedEdges.indexOf(sym)===-1){edgeStack.push(sym);}
visitedEdges.push(curr);edgeCount++;curr=curr.lNext();}while(curr!==edge);if(isFrame&&!includeFrame){return null;}
return this.triEdges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleEdges=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleEdgesListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleEdges();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleVertices=function(includeFrame){var visitor=new TriangleVertexListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleVertices();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleCoordinates=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleCoordinatesVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangles();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdgesByFactory=function(geomFact){var quadEdges,edges,i,il,qe,coords;quadEdges=this.getPrimaryEdges(false);edges=[];i=0;il=quadEdges.length;for(i;i<il;i++){qe=quadEdges[i];coords=[];coords[0]=(qe.orig().getCoordinate());coords[1]=(qe.dest().getCoordinate());edges[i]=geomFact.createLineString(coords);}
return geomFact.createMultiLineString(edges);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangles=function(geomFact){var triPtsList,tris,triPt,i,il;triPtsList=this.getTriangleCoordinates(false);tris=new Array(triPtsList.length);i=0,il=triPtsList.length;for(i;i<il;i++){triPt=triPtsList[i];tris[i]=geomFact.createPolygon(geomFact.createLinearRing(triPt,null));}
return geomFact.createGeometryCollection(tris);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiDiagram=function(geomFact)
{var vorCells=this.getVoronoiCellPolygons(geomFact);return geomFact.createGeometryCollection(vorCells);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygons=function(geomFact)
{this.visitTriangles(new jsts.triangulate.quadedge.TriangleCircumcentreVisitor(),true);var cells,edges,i,il,qe;cells=[];edges=this.getVertexUniqueEdges(false);i=0,il=edges.length;for(i;i<il;i++){qe=edges[i];cells.push(this.getVoronoiCellPolygon(qe,geomFact));}
return cells;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygon=function(qe,geomFact)
{var cellPts,startQe,cc,coordList,cellPoly,v;cellPts=[];startQE=qe;do{cc=qe.rot.orig().getCoordinate();cellPts.push(cc);qe=qe.oPrev();}while(qe!==startQE);coordList=new jsts.geom.CoordinateList([],false);coordList.add(cellPts,false);coordList.closeRing();if(coordList.size()<4){coordList.add(coordList.get(coordList.size()-1),true);}
cellPoly=geomFact.createPolygon(geomFact.createLinearRing(coordList.toArray()),null);v=startQE.orig();return cellPoly;};jsts.triangulate.quadedge.TriangleCircumcentreVisitor=function(){};jsts.triangulate.quadedge.TriangleCircumcentreVisitor.prototype.visit=function(triEdges){var a,b,c,cc,ccVertex,i;a=triEdges[0].orig().getCoordinate();b=triEdges[1].orig().getCoordinate();c=triEdges[2].orig().getCoordinate();cc=jsts.geom.Triangle.circumcentre(a,b,c);ccVertex=new jsts.triangulate.quadedge.Vertex(cc);i=0;for(i;i<3;i++){triEdges[i].rot.setOrig(ccVertex);}};jsts.triangulate.quadedge.TriangleEdgesListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.visit=function(triEdges){var clone=triEdges.concat();this.triList.push(clone);};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.getTriangleEdges=function(){return this.triList;};jsts.triangulate.quadedge.TriangleVertexListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.visit=function(triEdges){var vertices=[];vertices.push(trieEdges[0].orig());vertices.push(trieEdges[1].orig());vertices.push(trieEdges[2].orig());this.triList.push(vertices);};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.getTriangleVertices=function(){return this.triList;};jsts.triangulate.quadedge.TriangleCoordinatesVisitor=function(){this.coordList=new jsts.geom.CoordinateList([],false);this.triCoords=[];};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.visit=function(triEdges){this.coordList=new jsts.geom.CoordinateList([],false);var i=0,v,pts;for(i;i<3;i++){v=triEdges[i].orig();this.coordList.add(v.getCoordinate());}
if(this.coordList.size()>0){this.coordList.closeRing();pts=this.coordList.toArray();if(pts.length!==4){return;}
this.triCoords.push(pts);}};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.getTriangles=function(){return this.triCoords;};jsts.operation.relate.EdgeEndBundle=function(){this.edgeEnds=[];var e=arguments[0]instanceof jsts.geomgraph.EdgeEnd?arguments[0]:arguments[1];var edge=e.getEdge();var coord=e.getCoordinate();var dirCoord=e.getDirectedCoordinate();var label=new jsts.geomgraph.Label(e.getLabel());jsts.geomgraph.EdgeEnd.call(this,edge,coord,dirCoord,label);this.insert(e);};jsts.operation.relate.EdgeEndBundle.prototype=new jsts.geomgraph.EdgeEnd();jsts.operation.relate.EdgeEndBundle.prototype.edgeEnds=null;jsts.operation.relate.EdgeEndBundle.prototype.getLabel=function(){return this.label;};jsts.operation.relate.EdgeEndBundle.prototype.getEdgeEnds=function(){return this.edgeEnds;};jsts.operation.relate.EdgeEndBundle.prototype.insert=function(e){this.edgeEnds.push(e);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabel=function(boundaryNodeRule){var isArea=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea())
isArea=true;}
if(isArea)
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);else
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(var i=0;i<2;i++){this.computeLabelOn(i,boundaryNodeRule);if(isArea)
this.computeLabelSides(i);}};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelOn=function(geomIndex,boundaryNodeRule){var boundaryCount=0;var foundInterior=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];var loc=e.getLabel().getLocation(geomIndex);if(loc==jsts.geom.Location.BOUNDARY)
boundaryCount++;if(loc==jsts.geom.Location.INTERIOR)
foundInterior=true;}
var loc=jsts.geom.Location.NONE;if(foundInterior)
loc=jsts.geom.Location.INTERIOR;if(boundaryCount>0){loc=jsts.geomgraph.GeometryGraph.determineBoundary(boundaryNodeRule,boundaryCount);}
this.label.setLocation(geomIndex,loc);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSides=function(geomIndex){this.computeLabelSide(geomIndex,jsts.geomgraph.Position.LEFT);this.computeLabelSide(geomIndex,jsts.geomgraph.Position.RIGHT);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSide=function(geomIndex,side){for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea()){var loc=e.getLabel().getLocation(geomIndex,side);if(loc===jsts.geom.Location.INTERIOR){this.label.setLocation(geomIndex,side,jsts.geom.Location.INTERIOR);return;}else if(loc===jsts.geom.Location.EXTERIOR)
this.label.setLocation(geomIndex,side,jsts.geom.Location.EXTERIOR);}}};jsts.operation.relate.EdgeEndBundle.prototype.updateIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.index.kdtree.KdTree=function(tolerance){var tol=0.0;if(tolerance!==undefined){tol=tolerance;}
this.root=null;this.last=null;this.numberOfNodes=0;this.tolerance=tol;};jsts.index.kdtree.KdTree.prototype.insert=function(){if(arguments.length===1){return this.insertCoordinate.apply(this,arguments[0]);}else{return this.insertWithData.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.insertCoordinate=function(p){return this.insertWithData(p,null);};jsts.index.kdtree.KdTree.prototype.insertWithData=function(p,data){if(this.root===null){this.root=new jsts.index.kdtree.KdNode(p,data);return this.root;}
var currentNode=this.root,leafNode=this.root,isOddLevel=true,isLessThan=true;while(currentNode!==last){if(isOddLevel){isLessThan=p.x<currentNode.getX();}else{isLessThan=p.y<currentNode.getY();}
leafNode=currentNode;if(isLessThan){currentNode=currentNode.getLeft();}else{currentNode=currentNode.getRight();}
if(currentNode!==null){var isInTolerance=p.distance(currentNode.getCoordinate())<=this.tolerance;if(isInTolerance){currentNode.increment();return currentNode;}}
isOddLevel=!isOddLevel;}
this.numberOfNodes=numberOfNodes+1;var node=new jsts.index.kdtree.KdNode(p,data);node.setLeft(this.last);node.setRight(this.last);if(isLessThan){leafNode.setLeft(node);}else{leafNode.setRight(node);}
return node;};jsts.index.kdtree.KdTree.prototype.queryNode=function(currentNode,bottomNode,queryEnv,odd,result){if(currentNode===bottomNode){return;}
var min,max,discriminant;if(odd){min=queryEnv.getMinX();max=queryEnv.getMaxX();discriminant=currentNode.getX();}else{min=queryEnv.getMinY();max=queryEnv.getMaxY();discriminant=currentNode.getY();}
var searchLeft=min<discriminant;var searchRight=discriminant<=max;if(searchLeft){this.queryNode(currentNode.getLeft(),bottomNode,queryEnv,!odd,result);}
if(queryEnv.contains(currentNode.getCoordinate())){result.add(currentNode);}
if(searchRight){this.queryNode(currentNode.getRight(),bottomNode,queryEnv,!odd,result);}};jsts.index.kdtree.KdTree.prototype.query=function(){if(arguments.length===1){return this.queryByEnvelope.apply(this,arguments[0]);}else{return this.queryWithArray.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.queryByEnvelope=function(queryEnv){var result=[];this.queryNode(this.root,this.last,queryEnv,true,result);return result;};jsts.index.kdtree.KdTree.prototype.queryWithArray=function(queryEnv,result){this.queryNode(this.root,this.last,queryEnv,true,result);};jsts.geom.Triangle=function(p0,p1,p2){this.p0=p0;this.p1=p1;this.p2=p2;};jsts.geom.Triangle.isAcute=function(a,b,c){if(!jsts.algorithm.Angle.isAcute(a,b,c)){return false;}
if(!jsts.algorithm.Angle.isAcute(b,c,a)){return false;}
if(!jsts.algorithm.Angle.isAcute(c,a,b)){return false;}
return true;};jsts.geom.Triangle.perpendicularBisector=function(a,b){var dx,dy,l1,l2;dx=b.x-a.x;dy=b.y-a.y;l1=new jsts.algorithm.HCoordinate(a.x+dx/2.0,a.y+dy/2.0,1.0);l2=new jsts.algorithm.HCoordinate(a.x-dy+dx/2.0,a.y+dx+dy/2.0,1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.geom.Triangle.circumcentre=function(a,b,c){var cx,cy,ax,ay,bx,by,denom,numx,numy,ccx,ccy;cx=c.x;cy=c.y;ax=a.x-cx;ay=a.y-cy;bx=b.x-cx;by=b.y-cy;denom=2*jsts.geom.Triangle.det(ax,ay,bx,by);numx=jsts.geom.Triangle.det(ay,ax*ax+ay*ay,by,bx*bx+by*by);numy=jsts.geom.Triangle.det(ax,ax*ax+ay*ay,bx,bx*bx+by*by);ccx=cx-numx/denom;ccy=cy+numy/denom;return new jsts.geom.Coordinate(ccx,ccy);};jsts.geom.Triangle.det=function(m00,m01,m10,m11){return m00*m11-m01*m10;};jsts.geom.Triangle.inCentre=function(a,b,c){var len0,len1,len2,circum,inCentreX,inCentreY;len0=b.distance(c);len1=a.distance(c);len2=a.distance(b);circum=len0+len1+len2;inCentreX=(len0*a.x+len1*b.x+len2*c.x)/circum;inCentreY=(len0*a.y+len1*b.y+len2*c.y)/circum;return new jsts.geom.Coordinate(inCentreX,inCentreY);};jsts.geom.Triangle.centroid=function(a,b,c){var x,y;x=(a.x+b.x+c.x)/3;y=(a.y+b.y+c.y)/3;return new jsts.geom.Coordinate(x,y);};jsts.geom.Triangle.longestSideLength=function(a,b,c){var lenAB,lenBC,lenCA,maxLen;lenAB=a.distance(b);lenBC=b.distance(c);lenCA=c.distance(a);maxLen=lenAB;if(lenBC>maxLen){maxLen=lenBC;}
if(lenCA>maxLen){maxLen=lenCA;}
return maxLen;};jsts.geom.Triangle.angleBisector=function(a,b,c){var len0,len2,frac,dx,dy,splitPt;len0=b.distance(a);len2=b.distance(c);frac=len0/(len0+len2);dx=c.x-a.x;dy=c.y-a.y;splitPt=new jsts.geom.Coordinate(a.x+frac*dx,a.y+frac*dy);return splitPt;};jsts.geom.Triangle.area=function(a,b,c){return Math.abs(((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0);};jsts.geom.Triangle.signedArea=function(a,b,c){return((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0;};jsts.geom.Triangle.prototype.inCentre=function(){return jsts.geom.Triangle.inCentre(this.p0,this.p1,this.p2);};jsts.noding.OrientedCoordinateArray=function(pts){this.pts=pts;this._orientation=jsts.noding.OrientedCoordinateArray.orientation(pts);};jsts.noding.OrientedCoordinateArray.prototype.pts=null;jsts.noding.OrientedCoordinateArray.prototype._orientation=undefined;jsts.noding.OrientedCoordinateArray.orientation=function(pts){return jsts.geom.CoordinateArrays.increasingDirection(pts)===1;};jsts.noding.OrientedCoordinateArray.prototype.compareTo=function(o1){var oca=o1;var comp=jsts.noding.OrientedCoordinateArray.compareOriented(this.pts,this._orientation,oca.pts,oca._orientation);return comp;};jsts.noding.OrientedCoordinateArray.compareOriented=function(pts1,orientation1,pts2,orientation2){var dir1=orientation1?1:-1;var dir2=orientation2?1:-1;var limit1=orientation1?pts1.length:-1;var limit2=orientation2?pts2.length:-1;var i1=orientation1?0:pts1.length-1;var i2=orientation2?0:pts2.length-1;var comp=0;while(true){var compPt=pts1[i1].compareTo(pts2[i2]);if(compPt!==0)
return compPt;i1+=dir1;i2+=dir2;var done1=i1===limit1;var done2=i2===limit2;if(done1&&!done2)
return-1;if(!done1&&done2)
return 1;if(done1&&done2)
return 0;}};jsts.algorithm.CentralEndpointIntersector=function(p00,p01,p10,p11){this.pts=[p00,p01,p10,p11];this.compute();};jsts.algorithm.CentralEndpointIntersector.getIntersection=function(p00,p01,p10,p11){var intor=new jsts.algorithm.CentralEndpointIntersector(p00,p01,p10,p11);return intor.getIntersection();};jsts.algorithm.CentralEndpointIntersector.prototype.pts=null;jsts.algorithm.CentralEndpointIntersector.prototype.intPt=null;jsts.algorithm.CentralEndpointIntersector.prototype.compute=function(){var centroid=jsts.algorithm.CentralEndpointIntersector.average(this.pts);this.intPt=this.findNearestPoint(centroid,this.pts);};jsts.algorithm.CentralEndpointIntersector.prototype.getIntersection=function(){return this.intPt;};jsts.algorithm.CentralEndpointIntersector.average=function(pts){var avg=new jsts.geom.Coordinate();var i,n=pts.length;for(i=0;i<n;i++){avg.x+=pts[i].x;avg.y+=pts[i].y;}
if(n>0){avg.x/=n;avg.y/=n;}
return avg;};jsts.algorithm.CentralEndpointIntersector.prototype.findNearestPoint=function(p,pts){var minDist=Number.MAX_VALUE;var i,result=null,dist;for(i=0;i<pts.length;i++){dist=p.distance(pts[i]);if(dist<minDist){minDist=dist;result=pts[i];}}
return result;};jsts.operation.buffer.BufferOp=function(g,bufParams){this.argGeom=g;this.bufParams=bufParams?bufParams:new jsts.operation.buffer.BufferParameters();};jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS=12;jsts.operation.buffer.BufferOp.precisionScaleFactor=function(g,distance,maxPrecisionDigits){var env=g.getEnvelopeInternal();var envSize=Math.max(env.getHeight(),env.getWidth());var expandByDistance=distance>0.0?distance:0.0;var bufEnvSize=envSize+2*expandByDistance;var bufEnvLog10=(Math.log(bufEnvSize)/Math.log(10)+1.0);var minUnitLog10=bufEnvLog10-maxPrecisionDigits;var scaleFactor=Math.pow(10.0,-minUnitLog10);return scaleFactor;};jsts.operation.buffer.BufferOp.bufferOp=function(g,distance){if(arguments.length>2){return jsts.operation.buffer.BufferOp.bufferOp2.apply(this,arguments);}
var gBuf=new jsts.operation.buffer.BufferOp(g);var geomBuf=gBuf.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp2=function(g,distance,params){if(arguments.length>3){return jsts.operation.buffer.BufferOp.bufferOp3.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g,params);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp3=function(g,distance,quadrantSegments){if(arguments.length>4){return jsts.operation.buffer.BufferOp.bufferOp4.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp4=function(g,distance,quadrantSegments,endCapStyle){var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);bufOp.setEndCapStyle(endCapStyle);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.prototype.argGeom=null;jsts.operation.buffer.BufferOp.prototype.distance=null;jsts.operation.buffer.BufferOp.prototype.bufParams=null;jsts.operation.buffer.BufferOp.prototype.resultGeometry=null;jsts.operation.buffer.BufferOp.prototype.setEndCapStyle=function(endCapStyle){this.bufParams.setEndCapStyle(endCapStyle);};jsts.operation.buffer.BufferOp.prototype.setQuadrantSegments=function(quadrantSegments){this.bufParams.setQuadrantSegments(quadrantSegments);};jsts.operation.buffer.BufferOp.prototype.getResultGeometry=function(dist){this.distance=dist;this.computeGeometry();return this.resultGeometry;};jsts.operation.buffer.BufferOp.prototype.computeGeometry=function(){this.bufferOriginalPrecision();if(this.resultGeometry!==null){return;}
var argPM=this.argGeom.getPrecisionModel();if(argPM.getType()===jsts.geom.PrecisionModel.FIXED){this.bufferFixedPrecision(argPM);}else{this.bufferReducedPrecision();}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision=function(){var precDigits;var saveException=null;for(precDigits=jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS;precDigits>=0;precDigits--){try{this.bufferReducedPrecision2(precDigits);}catch(ex){saveException=ex;}
if(this.resultGeometry!==null){return;}}
throw saveException;};jsts.operation.buffer.BufferOp.prototype.bufferOriginalPrecision=function(){try{var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);}catch(e){}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision2=function(precisionDigits){var sizeBasedScaleFactor=jsts.operation.buffer.BufferOp.precisionScaleFactor(this.argGeom,this.distance,precisionDigits);var fixedPM=new jsts.geom.PrecisionModel(sizeBasedScaleFactor);this.bufferFixedPrecision(fixedPM);};jsts.operation.buffer.BufferOp.prototype.bufferFixedPrecision=function(fixedPM){var noder=new jsts.noding.ScaledNoder(new jsts.noding.snapround.MCIndexSnapRounder(new jsts.geom.PrecisionModel(1.0)),fixedPM.getScale());var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);bufBuilder.setWorkingPrecisionModel(fixedPM);bufBuilder.setNoder(noder);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var Assert=jsts.util.Assert;jsts.geomgraph.GeometryGraph=function(argIndex,parentGeom,boundaryNodeRule){jsts.geomgraph.PlanarGraph.call(this);this.lineEdgeMap=new javascript.util.HashMap();this.ptLocator=new jsts.algorithm.PointLocator();this.argIndex=argIndex;this.parentGeom=parentGeom;this.boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(parentGeom!==null){this.add(parentGeom);}};jsts.geomgraph.GeometryGraph.prototype=new jsts.geomgraph.PlanarGraph();jsts.geomgraph.GeometryGraph.constructor=jsts.geomgraph.GeometryGraph;jsts.geomgraph.GeometryGraph.prototype.createEdgeSetIntersector=function(){return new jsts.geomgraph.index.SimpleMCSweepLineIntersector();};jsts.geomgraph.GeometryGraph.determineBoundary=function(boundaryNodeRule,boundaryCount){return boundaryNodeRule.isInBoundary(boundaryCount)?Location.BOUNDARY:Location.INTERIOR;};jsts.geomgraph.GeometryGraph.prototype.parentGeom=null;jsts.geomgraph.GeometryGraph.prototype.lineEdgeMap=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodeRule=null;jsts.geomgraph.GeometryGraph.prototype.useBoundaryDeterminationRule=true;jsts.geomgraph.GeometryGraph.prototype.argIndex=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodes=null;jsts.geomgraph.GeometryGraph.prototype.hasTooFewPoints=false;jsts.geomgraph.GeometryGraph.prototype.invalidPoint=null;jsts.geomgraph.GeometryGraph.prototype.areaPtLocator=null;jsts.geomgraph.GeometryGraph.prototype.ptLocator=null;jsts.geomgraph.GeometryGraph.prototype.getGeometry=function(){return this.parentGeom;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodes=function(){if(this.boundaryNodes===null)
this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex);return this.boundaryNodes;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodeRule=function(){return this.boundaryNodeRule;};jsts.geomgraph.GeometryGraph.prototype.findEdge=function(line){return this.lineEdgeMap.get(line);};jsts.geomgraph.GeometryGraph.prototype.computeSplitEdges=function(edgelist){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();e.eiList.addSplitEdges(edgelist);}}
jsts.geomgraph.GeometryGraph.prototype.add=function(g){if(g.isEmpty()){return;}
if(g instanceof jsts.geom.MultiPolygon)
this.useBoundaryDeterminationRule=false;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError('Geometry type not supported.');};jsts.geomgraph.GeometryGraph.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.geomgraph.GeometryGraph.prototype.addEdge=function(e){this.insertEdge(e);var coord=e.getCoordinates();this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);this.insertPoint(this.argIndex,coord[coord.length-1],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPoint=function(p){var coord=p.getCoordinate();this.insertPoint(this.argIndex,coord,Location.INTERIOR);};jsts.geomgraph.GeometryGraph.prototype.addLineString=function(line){var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(coord.length<2){this.hasTooFewPoints=true;this.invalidPoint=coords[0];return;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.INTERIOR));this.lineEdgeMap.put(line,e);this.insertEdge(e);Assert.isTrue(coord.length>=2,'found LineString with single point');this.insertBoundaryPoint(this.argIndex,coord[0]);this.insertBoundaryPoint(this.argIndex,coord[coord.length-1]);};jsts.geomgraph.GeometryGraph.prototype.addPolygonRing=function(lr,cwLeft,cwRight){if(lr.isEmpty())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(lr.getCoordinates());if(coord.length<4){this.hasTooFewPoints=true;this.invalidPoint=coord[0];return;}
var left=cwLeft;var right=cwRight;if(jsts.algorithm.CGAlgorithms.isCCW(coord)){left=cwRight;right=cwLeft;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.BOUNDARY,left,right));this.lineEdgeMap.put(lr,e);this.insertEdge(e);this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPolygon=function(p){this.addPolygonRing(p.getExteriorRing(),Location.EXTERIOR,Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);this.addPolygonRing(hole,Location.INTERIOR,Location.EXTERIOR);}};jsts.geomgraph.GeometryGraph.prototype.computeEdgeIntersections=function(g,li,includeProper){var si=new jsts.geomgraph.index.SegmentIntersector(li,includeProper,true);si.setBoundaryNodes(this.getBoundaryNodes(),g.getBoundaryNodes());var esi=this.createEdgeSetIntersector();esi.computeIntersections(this.edges,g.edges,si);return si;};jsts.geomgraph.GeometryGraph.prototype.computeSelfNodes=function(li,computeRingSelfNodes){var si=new jsts.geomgraph.index.SegmentIntersector(li,true,false);var esi=this.createEdgeSetIntersector();if(!computeRingSelfNodes&&(this.parentGeom instanceof jsts.geom.LinearRing||this.parentGeom instanceof jsts.geom.Polygon||this.parentGeom instanceof jsts.geom.MultiPolygon)){esi.computeIntersections(this.edges,si,false);}else{esi.computeIntersections(this.edges,si,true);}
this.addSelfIntersectionNodes(this.argIndex);return si;};jsts.geomgraph.GeometryGraph.prototype.insertPoint=function(argIndex,coord,onLocation){var n=this.nodes.addNode(coord);var lbl=n.getLabel();if(lbl==null){n.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
lbl.setLocation(argIndex,onLocation);};jsts.geomgraph.GeometryGraph.prototype.insertBoundaryPoint=function(argIndex,coord){var n=this.nodes.addNode(coord);var lbl=n.getLabel();var boundaryCount=1;var loc=Location.NONE;if(lbl!==null)
loc=lbl.getLocation(argIndex,Position.ON);if(loc===Location.BOUNDARY)
boundaryCount++;var newLoc=jsts.geomgraph.GeometryGraph.determineBoundary(this.boundaryNodeRule,boundaryCount);lbl.setLocation(argIndex,newLoc);};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNodes=function(argIndex){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.eiList.iterator();eiIt.hasNext();){var ei=eiIt.next();this.addSelfIntersectionNode(argIndex,ei.coord,eLoc);}}};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNode=function(argIndex,coord,loc){if(this.isBoundaryNode(argIndex,coord))
return;if(loc===Location.BOUNDARY&&this.useBoundaryDeterminationRule)
this.insertBoundaryPoint(argIndex,coord);else
this.insertPoint(argIndex,coord,loc);};jsts.geomgraph.GeometryGraph.prototype.getInvalidPoint=function(){return this.invalidPoint;};})();jsts.operation.buffer.OffsetSegmentString=function(){this.ptList=[];};jsts.operation.buffer.OffsetSegmentString.prototype.ptList=null;jsts.operation.buffer.OffsetSegmentString.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentString.prototype.minimimVertexDistance=0.0;jsts.operation.buffer.OffsetSegmentString.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.operation.buffer.OffsetSegmentString.prototype.setMinimumVertexDistance=function(minimimVertexDistance){this.minimimVertexDistance=minimimVertexDistance;};jsts.operation.buffer.OffsetSegmentString.prototype.addPt=function(pt){var bufPt=new jsts.geom.Coordinate(pt);this.precisionModel.makePrecise(bufPt);if(this.isRedundant(bufPt))
return;this.ptList.push(bufPt);};jsts.operation.buffer.OffsetSegmentString.prototype.addPts=function(pt,isForward){if(isForward){for(var i=0;i<pt.length;i++){this.addPt(pt[i]);}}else{for(var i=pt.length-1;i>=0;i--){this.addPt(pt[i]);}}};jsts.operation.buffer.OffsetSegmentString.prototype.isRedundant=function(pt){if(this.ptList.length<1)
return false;var lastPt=this.ptList[this.ptList.length-1];var ptDist=pt.distance(lastPt);if(ptDist<this.minimimVertexDistance)
return true;return false;};jsts.operation.buffer.OffsetSegmentString.prototype.closeRing=function(){if(this.ptList.length<1)
return;var startPt=new jsts.geom.Coordinate(this.ptList[0]);var lastPt=this.ptList[this.ptList.length-1];var last2Pt=null;if(this.ptList.length>=2)
last2Pt=this.ptList[this.ptList.length-2];if(startPt.equals(lastPt))
return;this.ptList.push(startPt);};jsts.operation.buffer.OffsetSegmentString.prototype.reverse=function(){};jsts.operation.buffer.OffsetSegmentString.prototype.getCoordinates=function(){return this.ptList;};jsts.algorithm.distance.PointPairDistance=function(){this.pt=[new jsts.geom.Coordinate(),new jsts.geom.Coordinate()];};jsts.algorithm.distance.PointPairDistance.prototype.pt=null;jsts.algorithm.distance.PointPairDistance.prototype.distance=NaN;jsts.algorithm.distance.PointPairDistance.prototype.isNull=true;jsts.algorithm.distance.PointPairDistance.prototype.initialize=function(p0,p1,distance){if(p0===undefined){this.isNull=true;return;}
this.pt[0].setCoordinate(p0);this.pt[1].setCoordinate(p1);this.distance=distance!==undefined?distance:p0.distance(p1);this.isNull=false;};jsts.algorithm.distance.PointPairDistance.prototype.getDistance=function(){return this.distance;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinates=function(){return this.pt;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinate=function(i){return this.pt[i];};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum=function(ptDist){if(arguments.length===2){this.setMaximum2.apply(this,arguments);return;}
this.setMaximum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist>this.distance)
this.initialize(p0,p1,dist);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum=function(ptDist){if(arguments.length===2){this.setMinimum2.apply(this,arguments);return;}
this.setMinimum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist<this.distance)
this.initialize(p0,p1,dist);};(function(){var PointPairDistance=jsts.algorithm.distance.PointPairDistance;var DistanceToPoint=jsts.algorithm.distance.DistanceToPoint;var MaxPointDistanceFilter=function(geom){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.euclideanDist=new DistanceToPoint();this.geom=geom;};MaxPointDistanceFilter.prototype=new jsts.geom.CoordinateFilter();MaxPointDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.euclideanDist=new DistanceToPoint();MaxPointDistanceFilter.prototype.geom;MaxPointDistanceFilter.prototype.filter=function(pt){this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);};MaxPointDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};var MaxDensifiedByFractionDistanceFilter=function(geom,fraction){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.geom=geom;this.numSubSegs=Math.round(1.0/fraction);};MaxDensifiedByFractionDistanceFilter.prototype=new jsts.geom.CoordinateSequenceFilter();MaxDensifiedByFractionDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.geom;MaxDensifiedByFractionDistanceFilter.prototype.numSubSegs=0;MaxDensifiedByFractionDistanceFilter.prototype.filter=function(seq,index){if(index==0)
return;var p0=seq[index-1];var p1=seq[index];var delx=(p1.x-p0.x)/this.numSubSegs;var dely=(p1.y-p0.y)/this.numSubSegs;for(var i=0;i<this.numSubSegs;i++){var x=p0.x+i*delx;var y=p0.y+i*dely;var pt=new jsts.geom.Coordinate(x,y);this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);}};MaxDensifiedByFractionDistanceFilter.prototype.isGeometryChanged=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.isDone=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};jsts.algorithm.distance.DiscreteHausdorffDistance=function(g0,g1){this.g0=g0;this.g1=g1;this.ptDist=new jsts.algorithm.distance.PointPairDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g0=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g1=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.ptDist=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.densifyFrac=0.0;jsts.algorithm.distance.DiscreteHausdorffDistance.distance=function(g0,g1,densifyFrac){var dist=new jsts.algorithm.distance.DiscreteHausdorffDistance(g0,g1);if(densifyFrac!==undefined)
dist.setDensifyFraction(densifyFrac);return dist.distance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.setDensifyFraction=function(densifyFrac){if(densifyFrac>1.0||densifyFrac<=0.0)
throw new jsts.error.IllegalArgumentError('Fraction is not in range (0.0 - 1.0]');this.densifyFrac=densifyFrac;};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.distance=function(){this.compute(this.g0,this.g1);return ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.orientedDistance=function(){this.computeOrientedDistance(this.g0,this.g1,this.ptDist);return this.ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.getCoordinates=function(){return ptDist.getCoordinates();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.compute=function(g0,g1){this.computeOrientedDistance(g0,g1,this.ptDist);this.computeOrientedDistance(g1,g0,this.ptDist);};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.computeOrientedDistance=function(discreteGeom,geom,ptDist){var distFilter=new MaxPointDistanceFilter(geom);discreteGeom.apply(distFilter);ptDist.setMaximum(distFilter.getMaxPointDistance());if(this.densifyFrac>0){var fracFilter=new MaxDensifiedByFractionDistanceFilter(geom,this.densifyFrac);discreteGeom.apply(fracFilter);ptDist.setMaximum(fracFilter.getMaxPointDistance());}};})();jsts.algorithm.MinimumBoundingCircle=function(geom){this.input=null;this.extremalPts=null;this.centre=null;this.radius=0;this.input=geom;};jsts.algorithm.MinimumBoundingCircle.prototype.getCircle=function(){this.compute();if(this.centre===null){return this.input.getFactory().createPolygon(null,null);}
var centrePoint=this.input.getFactory().createPoint(this.centre);if(this.radius===0){return centrePoint;}
return centrePoint.buffer(this.radius);};jsts.algorithm.MinimumBoundingCircle.prototype.getExtremalPoints=function(){this.compute();return this.extremalPts;};jsts.algorithm.MinimumBoundingCircle.prototype.getCentre=function(){this.compute();return this.centre;};jsts.algorithm.MinimumBoundingCircle.prototype.getRadius=function(){this.compute();return this.radius;};jsts.algorithm.MinimumBoundingCircle.prototype.computeCentre=function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new jsts.geom.Coordinate((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=jsts.geom.Triangle.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2]);break;}};jsts.algorithm.MinimumBoundingCircle.prototype.compute=function(){if(this.extremalPts!==null){return;}
this.computeCirclePoints();this.computeCentre();if(this.centre!==null){this.radius=this.centre.distance(this.extremalPts[0]);}};jsts.algorithm.MinimumBoundingCircle.prototype.computeCirclePoints=function(){if(this.input.isEmpty()){this.extremalPts=[];return;}
var pts;if(this.input.getNumPoints()===1){pts=this.input.getCoordinates();this.extremalPts=[new jsts.geom.Coordinate(pts[0])];return;}
var convexHull=this.input.convexHull();var hullPts=convexHull.getCoordinates();pts=hullPts;if(hullPts[0].equals2D(hullPts[hullPts.length-1])){pts=[];jsts.geom.CoordinateArrays.copyDeep(hullPts,0,pts,0,hullPts.length-1);}
if(pts.length<=2){this.extremalPts=jsts.geom.CoordinateArrays.copyDeep(pts);return;}
var P=jsts.algorithm.MinimumBoundingCircle.lowestPoint(pts);var Q=jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX(pts,P);for(var i=0;i<pts.length;i++){var R=jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment(pts,P,Q);if(jsts.algorithm.Angle.isObtuse(P,R,Q)){this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q)];return;}
if(jsts.algorithm.Angle.isObtuse(R,P,Q)){P=R;continue;}
if(jsts.algorithm.Angle.isObtuse(R,Q,P)){Q=R;continue;}
this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q),new jsts.geom.Coordinate(R)];return;}
throw new Error("Logic failure in Minimum Bounding Circle algorithm!");};jsts.algorithm.MinimumBoundingCircle.lowestPoint=function(pts){var min=pts[0];for(var i=1;i<pts.length;i++){if(pts[i].y<min.y){min=pts[i];}}
return min;};jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX=function(pts,P){var minSin=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;var dx=p.x-P.x;var dy=p.y-P.y;if(dy<0)dy=-dy;var len=Math.sqrt(dx*dx+dy*dy);var sin=dy/len;if(sin<minSin){minSin=sin;minAngPt=p;}}
return minAngPt;};jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment=function(pts,P,Q){var minAng=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;if(p===Q)continue;var ang=jsts.algorithm.Angle.angleBetween(P,p,Q);if(ang<minAng){minAng=ang;minAngPt=p;}}
return minAngPt;};jsts.noding.ScaledNoder=function(noder,scaleFactor,offsetX,offsetY){this.offsetX=offsetX?offsetX:0;this.offsetY=offsetY?offsetY:0;this.noder=noder;this.scaleFactor=scaleFactor;this.isScaled=!this.isIntegerPrecision();};jsts.noding.ScaledNoder.prototype=new jsts.noding.Noder();jsts.noding.ScaledNoder.constructor=jsts.noding.ScaledNoder;jsts.noding.ScaledNoder.prototype.noder=null;jsts.noding.ScaledNoder.prototype.scaleFactor=undefined;jsts.noding.ScaledNoder.prototype.offsetX=undefined;jsts.noding.ScaledNoder.prototype.offsetY=undefined;jsts.noding.ScaledNoder.prototype.isScaled=false;jsts.noding.ScaledNoder.prototype.isIntegerPrecision=function(){return this.scaleFactor===1.0;};jsts.noding.ScaledNoder.prototype.getNodedSubstrings=function(){var splitSS=this.noder.getNodedSubstrings();if(this.isScaled)
this.rescale(splitSS);return splitSS;};jsts.noding.ScaledNoder.prototype.computeNodes=function(inputSegStrings){var intSegStrings=inputSegStrings;if(this.isScaled)
intSegStrings=this.scale(inputSegStrings);this.noder.computeNodes(intSegStrings);};jsts.noding.ScaledNoder.prototype.scale=function(segStrings){if(segStrings instanceof Array){return this.scale2(segStrings);}
var transformed=new javascript.util.ArrayList();for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();transformed.add(new jsts.noding.NodedSegmentString(this.scale(ss.getCoordinates()),ss.getData()));}
return transformed;};jsts.noding.ScaledNoder.prototype.scale2=function(pts){var roundPts=[];for(var i=0;i<pts.length;i++){roundPts[i]=new jsts.geom.Coordinate(Math.round((pts[i].x-this.offsetX)*this.scaleFactor),Math.round((pts[i].y-this.offsetY)*this.scaleFactor));}
var roundPtsNoDup=jsts.geom.CoordinateArrays.removeRepeatedPoints(roundPts);return roundPtsNoDup;};jsts.noding.ScaledNoder.prototype.rescale=function(segStrings){if(segStrings instanceof Array){this.rescale2(segStrings);return;}
for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();this.rescale(ss.getCoordinates());}};jsts.noding.ScaledNoder.prototype.rescale2=function(pts){for(var i=0;i<pts.length;i++){pts[i].x=pts[i].x/this.scaleFactor+this.offsetX;pts[i].y=pts[i].y/this.scaleFactor+this.offsetY;}};(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.index.SegmentIntersector=function(li,includeProper,recordIsolated){this.li=li;this.includeProper=includeProper;this.recordIsolated=recordIsolated;};jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.geomgraph.index.SegmentIntersector.prototype._hasIntersection=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProper=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInterior=false;jsts.geomgraph.index.SegmentIntersector.prototype.properIntersectionPoint=null;jsts.geomgraph.index.SegmentIntersector.prototype.li=null;jsts.geomgraph.index.SegmentIntersector.prototype.includeProper=null;jsts.geomgraph.index.SegmentIntersector.prototype.recordIsolated=null;jsts.geomgraph.index.SegmentIntersector.prototype.isSelfIntersection=null;jsts.geomgraph.index.SegmentIntersector.prototype.numIntersections=0;jsts.geomgraph.index.SegmentIntersector.prototype.numTests=0;jsts.geomgraph.index.SegmentIntersector.prototype.bdyNodes=null;jsts.geomgraph.index.SegmentIntersector.prototype.setBoundaryNodes=function(bdyNodes0,bdyNodes1){this.bdyNodes=[];this.bdyNodes[0]=bdyNodes0;this.bdyNodes[1]=bdyNodes1;};jsts.geomgraph.index.SegmentIntersector.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.geomgraph.index.SegmentIntersector.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.geomgraph.index.SegmentIntersector.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0===e1){if(this.li.getIntersectionNum()===1){if(jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.getNumPoints()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.geomgraph.index.SegmentIntersector.prototype.addIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.recordIsolated){e0.setIsolated(false);e1.setIsolated(false);}
this.numIntersections++;if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;if(this.includeProper||!this.li.isProper()){e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}
if(this.li.isProper()){this.properIntersectionPoint=this.li.getIntersection(0).clone();this.hasProper=true;if(!this.isBoundaryPoint(this.li,this.bdyNodes))
this.hasProperInterior=true;}}}};jsts.geomgraph.index.SegmentIntersector.prototype.isBoundaryPoint=function(li,bdyNodes){if(bdyNodes===null)
return false;if(bdyNodes instanceof Array){if(this.isBoundaryPoint(li,bdyNodes[0]))
return true;if(this.isBoundaryPoint(li,bdyNodes[1]))
return true;return false;}else{for(var i=bdyNodes.iterator();i.hasNext();){var node=i.next();var pt=node.getCoordinate();if(li.isIntersection(pt))
return true;}
return false;}};})();
},{}],29:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],30:[function(require,module,exports){
require('./dist/javascript.util-node.min.js');

},{"./dist/javascript.util-node.min.js":29}],31:[function(require,module,exports){
var extent = require('turf-extent'),
    point = require('turf-point');

/**
 * Takes a {@link FeatureCollection} of any type and returns the absolute center point of all features.
 *
 * @module turf/center
 * @category measurement
 * @param {FeatureCollection} features a FeatureCollection of any type
 * @return {Point} a Point feature at the
 * absolute center point of all input features
 * @example
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.522259, 35.4691]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.502754, 35.463455]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.508269, 35.463245]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.516809, 35.465779]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.515372, 35.467072]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.509363, 35.463053]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.511123, 35.466601]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.518547, 35.469327]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.519706, 35.469659]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.517839, 35.466998]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.508678, 35.464942]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.514914, 35.463453]
 *       }
 *     }
 *   ]
 * };
 *
 * var centerPt = turf.center(features);
 * centerPt.properties['marker-size'] = 'large';
 * centerPt.properties['marker-color'] = '#000';
 *
 * var resultFeatures = features.features.concat(centerPt);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(layer, done){
  var ext = extent(layer);
  var x = (ext[0] + ext[2])/2;
  var y = (ext[1] + ext[3])/2;
  return point([x, y]);
};

},{"turf-extent":80,"turf-point":112}],32:[function(require,module,exports){
var each = require('turf-meta').coordEach;
var point = require('turf-point');

/**
 * Takes a {@link Feature} or {@link FeatureCollection} of any type and calculates the centroid using the arithmetic mean of all vertices.
 * This lessens the effect of small islands and artifacts when calculating
 * the centroid of a set of polygons.
 *
 * @module turf/centroid
 * @category measurement
 * @param {GeoJSON} features a {@link Feature} or FeatureCollection of any type
 * @return {Point} a Point feature at the centroid of the input feature(s)
 * @example
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [105.818939,21.004714],
 *       [105.818939,21.061754],
 *       [105.890007,21.061754],
 *       [105.890007,21.004714],
 *       [105.818939,21.004714]
 *     ]]
 *   }
 * };
 *
 * var centroidPt = turf.centroid(poly);
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [poly, centroidPt]
 * };
 *
 * //=result
 */
module.exports = function(features){
  var xSum = 0, ySum = 0, len = 0;
  each(features, function(coord) {
    xSum += coord[0];
    ySum += coord[1];
    len++;
  }, true);
  return point([xSum / len, ySum / len]);
};

},{"turf-meta":33,"turf-point":112}],33:[function(require,module,exports){
/**
 * Lazily iterate over coordinates in any GeoJSON object, similar to
 * Array.forEach.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (value)
 * @param {boolean=} excludeWrapCoord whether or not to include
 * the final coordinate of LinearRings that wraps the ring in its iteration.
 * @example
 * var point = { type: 'Point', coordinates: [0, 0] };
 * coordEach(point, function(coords) {
 *   // coords is equal to [0, 0]
 * });
 */
function coordEach(layer, callback, excludeWrapCoord) {
  var i, j, k, g, geometry, stopG, coords,
    geometryMaybeCollection,
    wrapShrink = 0,
    isGeometryCollection,
    isFeatureCollection = layer.type === 'FeatureCollection',
    isFeature = layer.type === 'Feature',
    stop = isFeatureCollection ? layer.features.length : 1;

  // This logic may look a little weird. The reason why it is that way
  // is because it's trying to be fast. GeoJSON supports multiple kinds
  // of objects at its root: FeatureCollection, Features, Geometries.
  // This function has the responsibility of handling all of them, and that
  // means that some of the `for` loops you see below actually just don't apply
  // to certain inputs. For instance, if you give this just a
  // Point geometry, then both loops are short-circuited and all we do
  // is gradually rename the input until it's called 'geometry'.
  //
  // This also aims to allocate as few resources as possible: just a
  // few numbers and booleans, rather than any temporary arrays as would
  // be required with the normalization approach.
  for (i = 0; i < stop; i++) {

    geometryMaybeCollection = (isFeatureCollection ? layer.features[i].geometry :
        (isFeature ? layer.geometry : layer));
    isGeometryCollection = geometryMaybeCollection.type === 'GeometryCollection';
    stopG = isGeometryCollection ? geometryMaybeCollection.geometries.length : 1;

    for (g = 0; g < stopG; g++) {

      geometry = isGeometryCollection ?
          geometryMaybeCollection.geometries[g] : geometryMaybeCollection;
      coords = geometry.coordinates;

      wrapShrink = (excludeWrapCoord &&
        (geometry.type === 'Polygon' || geometry.type === 'MultiPolygon')) ?
        1 : 0;

      if (geometry.type === 'Point') {
        callback(coords);
      } else if (geometry.type === 'LineString' || geometry.type === 'MultiPoint') {
        for (j = 0; j < coords.length; j++) callback(coords[j]);
      } else if (geometry.type === 'Polygon' || geometry.type === 'MultiLineString') {
        for (j = 0; j < coords.length; j++)
          for (k = 0; k < coords[j].length - wrapShrink; k++)
            callback(coords[j][k]);
      } else if (geometry.type === 'MultiPolygon') {
        for (j = 0; j < coords.length; j++)
          for (k = 0; k < coords[j].length; k++)
            for (l = 0; l < coords[j][k].length - wrapShrink; l++)
              callback(coords[j][k][l]);
      } else {
        throw new Error('Unknown Geometry Type');
      }
    }
  }
}
module.exports.coordEach = coordEach;

/**
 * Lazily reduce coordinates in any GeoJSON object into a single value,
 * similar to how Array.reduce works. However, in this case we lazily run
 * the reduction, so an array of all coordinates is unnecessary.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (memo, value) and returns
 * a new memo
 * @param {boolean=} excludeWrapCoord whether or not to include
 * the final coordinate of LinearRings that wraps the ring in its iteration.
 * @param {*} memo the starting value of memo: can be any type.
 */
function coordReduce(layer, callback, memo, excludeWrapCoord) {
  coordEach(layer, function(coord) {
    memo = callback(memo, coord);
  }, excludeWrapCoord);
  return memo;
}
module.exports.coordReduce = coordReduce;

/**
 * Lazily iterate over property objects in any GeoJSON object, similar to
 * Array.forEach.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (value)
 * @example
 * var point = { type: 'Feature', geometry: null, properties: { foo: 1 } };
 * propEach(point, function(props) {
 *   // props is equal to { foo: 1}
 * });
 */
function propEach(layer, callback) {
  var i;
  switch (layer.type) {
      case 'FeatureCollection':
        features = layer.features;
        for (i = 0; i < layer.features.length; i++) {
            callback(layer.features[i].properties);
        }
        break;
      case 'Feature':
        callback(layer.properties);
        break;
  }
}
module.exports.propEach = propEach;

/**
 * Lazily reduce properties in any GeoJSON object into a single value,
 * similar to how Array.reduce works. However, in this case we lazily run
 * the reduction, so an array of all properties is unnecessary.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (memo, coord) and returns
 * a new memo
 * @param {*} memo the starting value of memo: can be any type.
 */
function propReduce(layer, callback, memo) {
  propEach(layer, function(prop) {
    memo = callback(memo, prop);
  });
  return memo;
}
module.exports.propReduce = propReduce;

},{}],34:[function(require,module,exports){
/**
 * Combines a {@link FeatureCollection} of {@link Point}, {@link LineString}, or {@link Polygon} features into {@link MultiPoint}, {@link MultiLineString}, or {@link MultiPolygon} features.
 *
 * @module turf/combine
 * @category misc
 * @param {FeatureCollection} fc a FeatureCollection of any type
 * @return {FeatureCollection} a FeatureCollection of corresponding type to input
 * @example
 * var fc = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [19.026432, 47.49134]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [19.074497, 47.509548]
 *       }
 *     }
 *   ]
 * };
 *
 * var combined = turf.combine(fc);
 *
 * //=combined
 */

module.exports = function(fc) {
  var type = fc.features[0].geometry.type;
  var geometries = fc.features.map(function(f) {
    return f.geometry;
  });

  switch (type) {
    case 'Point':
      return {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiPoint',
          coordinates: pluckCoods(geometries)
        }
      };
    case 'LineString':
      return {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiLineString',
          coordinates: pluckCoods(geometries)
        }
      };
    case 'Polygon':
      return {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiPolygon',
          coordinates: pluckCoods(geometries)
        }
      };
    default:
      return fc;
  }
};

function pluckCoods(multi){
  return multi.map(function(geom){
    return geom.coordinates;
  });
}

},{}],35:[function(require,module,exports){
// 1. run tin on points
// 2. calculate lenth of all edges and area of all triangles
// 3. remove triangles that fail the max length test
// 4. buffer the results slightly
// 5. merge the results
var t = {};
t.tin = require('turf-tin');
t.merge = require('turf-merge');
t.distance = require('turf-distance');
t.point = require('turf-point');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and
 * returns a concave hull.
 *
 * Internally, this implements
 * a [Monotone chain algorithm](http://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#JavaScript).
 *
 * @module turf/concave
 * @category transformation
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {number} maxEdge the size of an edge necessary for part of the
 * hull to become concave (in miles)
 * @param {String} units used for maxEdge distance (miles or kilometers)
 * @returns {Feature} a {@link Polygon} feature
 * @throws {Error} if maxEdge parameter is missing
 * @example
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.601226, 44.642643]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.591442, 44.651436]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.580799, 44.648749]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.573589, 44.641788]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.587665, 44.64533]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.595218, 44.64765]
 *       }
 *     }
 *   ]
 * };
 *
 * var hull = turf.concave(points, 1, 'miles');
 *
 * var resultFeatures = points.features.concat(hull);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */


module.exports = function(points, maxEdge, units) {
  if (typeof maxEdge !== 'number') throw new Error('maxEdge parameter is required');
  if (typeof units !== 'string') throw new Error('units parameter is required');

  var tinPolys = t.tin(points);
  var filteredPolys = tinPolys.features.filter(filterTriangles);
  tinPolys.features = filteredPolys;

  function filterTriangles(triangle) {
    var pt1 = t.point(triangle.geometry.coordinates[0][0]);
    var pt2 = t.point(triangle.geometry.coordinates[0][1]);
    var pt3 = t.point(triangle.geometry.coordinates[0][2]);
    var dist1 = t.distance(pt1, pt2, units);
    var dist2 = t.distance(pt2, pt3, units);
    var dist3 = t.distance(pt1, pt3, units);
    return (dist1 <= maxEdge && dist2 <= maxEdge && dist3 <= maxEdge);
  }

  return t.merge(tinPolys);
};

},{"turf-distance":70,"turf-merge":103,"turf-point":112,"turf-tin":128}],36:[function(require,module,exports){
var each = require('turf-meta').coordEach,
    convexHull = require('convex-hull'),
    polygon = require('turf-polygon');

/**
 * Takes any {@link GeoJSON} object and returns a
 * [convex hull](http://en.wikipedia.org/wiki/Convex_hull) polygon.
 *
 * Internally this uses
 * the [convex-hull](https://github.com/mikolalysenko/convex-hull) module that
 * implements a [monotone chain hull](http://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain).
 *
 * @module turf/convex
 * @category transformation
 * @param {GeoJSON} input any GeoJSON object
 * @returns {Feature} a {@link Polygon} feature
 * @example
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.195312, 43.755225]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.404052, 43.8424511]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.579833, 43.659924]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.360107, 43.516688]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.14038, 43.588348]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.195312, 43.755225]
 *       }
 *     }
 *   ]
 * };
 *
 * var hull = turf.convex(points);
 *
 * var resultFeatures = points.features.concat(hull);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(fc) {
  var points = [];
  each(fc, function(coord) { points.push(coord); });
  var hull = convexHull(points);
  var ring = [];
  for (var i = 0; i < hull.length; i++) {
      ring.push(points[hull[i][0]]);
  }
  ring.push(points[hull[hull.length - 1][1]]);
  return polygon([ring]);
};

},{"convex-hull":37,"turf-meta":65,"turf-polygon":113}],37:[function(require,module,exports){
"use strict"

var convexHull1d = require('./lib/ch1d')
var convexHull2d = require('./lib/ch2d')
var convexHullnd = require('./lib/chnd')

module.exports = convexHull

function convexHull(points) {
  var n = points.length
  if(n === 0) {
    return []
  } else if(n === 1) {
    return [[0]]
  }
  var d = points[0].length
  if(d === 0) {
    return []
  } else if(d === 1) {
    return convexHull1d(points)
  } else if(d === 2) {
    return convexHull2d(points)
  }
  return convexHullnd(points, d)
}
},{"./lib/ch1d":38,"./lib/ch2d":39,"./lib/chnd":40}],38:[function(require,module,exports){
"use strict"

module.exports = convexHull1d

function convexHull1d(points) {
  var lo = 0
  var hi = 0
  for(var i=1; i<points.length; ++i) {
    if(points[i][0] < points[lo][0]) {
      lo = i
    }
    if(points[i][0] > points[hi][0]) {
      hi = i
    }
  }
  if(lo < hi) {
    return [[lo], [hi]]
  } else if(lo > hi) {
    return [[hi], [lo]]
  } else {
    return [[lo]]
  }
}
},{}],39:[function(require,module,exports){
'use strict'

module.exports = convexHull2D

var monotoneHull = require('monotone-convex-hull-2d')

function convexHull2D(points) {
  var hull = monotoneHull(points)
  var h = hull.length
  if(h <= 2) {
    return []
  }
  var edges = new Array(h)
  var a = hull[h-1]
  for(var i=0; i<h; ++i) {
    var b = hull[i]
    edges[i] = [a,b]
    a = b
  }
  return edges
}

},{"monotone-convex-hull-2d":58}],40:[function(require,module,exports){
'use strict'

module.exports = convexHullnD

var ich = require('incremental-convex-hull')
var aff = require('affine-hull')

function permute(points, front) {
  var n = points.length
  var npoints = new Array(n)
  for(var i=0; i<front.length; ++i) {
    npoints[i] = points[front[i]]
  }
  var ptr = front.length
  for(var i=0; i<n; ++i) {
    if(front.indexOf(i) < 0) {
      npoints[ptr++] = points[i]
    }
  }
  return npoints
}

function invPermute(cells, front) {
  var nc = cells.length
  var nf = front.length
  for(var i=0; i<nc; ++i) {
    var c = cells[i]
    for(var j=0; j<c.length; ++j) {
      var x = c[j]
      if(x < nf) {
        c[j] = front[x]
      } else {
        x = x - nf
        for(var k=0; k<nf; ++k) {
          if(x >= front[k]) {
            x += 1
          }
        }
        c[j] = x
      }
    }
  }
  return cells
}

function convexHullnD(points, d) {
  try {
    return ich(points, true)
  } catch(e) {
    //If point set is degenerate, try to find a basis and rerun it
    var ah = aff(points)
    if(ah.length <= d) {
      //No basis, no try
      return []
    }
    var npoints = permute(points, ah)
    var nhull   = ich(npoints, true)
    return invPermute(nhull, ah)
  }
}
},{"affine-hull":41,"incremental-convex-hull":48}],41:[function(require,module,exports){
'use strict'

module.exports = affineHull

var orient = require('robust-orientation')

function linearlyIndependent(points, d) {
  var nhull = new Array(d+1)
  for(var i=0; i<points.length; ++i) {
    nhull[i] = points[i]
  }
  for(var i=0; i<=points.length; ++i) {
    for(var j=points.length; j<=d; ++j) {
      var x = new Array(d)
      for(var k=0; k<d; ++k) {
        x[k] = Math.pow(j+1-i, k)
      }
      nhull[j] = x
    }
    var o = orient.apply(void 0, nhull)
    if(o) {
      return true
    }
  }
  return false
}

function affineHull(points) {
  var n = points.length
  if(n === 0) {
    return []
  }
  if(n === 1) {
    return [0]
  }
  var d = points[0].length
  var frame = [ points[0] ]
  var index = [ 0 ]
  for(var i=1; i<n; ++i) {
    frame.push(points[i])
    if(!linearlyIndependent(frame, d)) {
      frame.pop()
      continue
    }
    index.push(i)
    if(index.length === d+1) {
      return index
    }
  }
  return index
}
},{"robust-orientation":47}],42:[function(require,module,exports){
"use strict"

module.exports = fastTwoSum

function fastTwoSum(a, b, result) {
	var x = a + b
	var bv = x - a
	var av = x - bv
	var br = b - bv
	var ar = a - av
	if(result) {
		result[0] = ar + br
		result[1] = x
		return result
	}
	return [ar+br, x]
}
},{}],43:[function(require,module,exports){
"use strict"

var twoProduct = require("two-product")
var twoSum = require("two-sum")

module.exports = scaleLinearExpansion

function scaleLinearExpansion(e, scale) {
  var n = e.length
  if(n === 1) {
    var ts = twoProduct(e[0], scale)
    if(ts[0]) {
      return ts
    }
    return [ ts[1] ]
  }
  var g = new Array(2 * n)
  var q = [0.1, 0.1]
  var t = [0.1, 0.1]
  var count = 0
  twoProduct(e[0], scale, q)
  if(q[0]) {
    g[count++] = q[0]
  }
  for(var i=1; i<n; ++i) {
    twoProduct(e[i], scale, t)
    var pq = q[1]
    twoSum(pq, t[0], q)
    if(q[0]) {
      g[count++] = q[0]
    }
    var a = t[1]
    var b = q[1]
    var x = a + b
    var bv = x - a
    var y = b - bv
    q[1] = x
    if(y) {
      g[count++] = y
    }
  }
  if(q[1]) {
    g[count++] = q[1]
  }
  if(count === 0) {
    g[count++] = 0.0
  }
  g.length = count
  return g
}
},{"two-product":46,"two-sum":42}],44:[function(require,module,exports){
"use strict"

module.exports = robustSubtract

//Easy case: Add two scalars
function scalarScalar(a, b) {
  var x = a + b
  var bv = x - a
  var av = x - bv
  var br = b - bv
  var ar = a - av
  var y = ar + br
  if(y) {
    return [y, x]
  }
  return [x]
}

function robustSubtract(e, f) {
  var ne = e.length|0
  var nf = f.length|0
  if(ne === 1 && nf === 1) {
    return scalarScalar(e[0], -f[0])
  }
  var n = ne + nf
  var g = new Array(n)
  var count = 0
  var eptr = 0
  var fptr = 0
  var abs = Math.abs
  var ei = e[eptr]
  var ea = abs(ei)
  var fi = -f[fptr]
  var fa = abs(fi)
  var a, b
  if(ea < fa) {
    b = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    b = fi
    fptr += 1
    if(fptr < nf) {
      fi = -f[fptr]
      fa = abs(fi)
    }
  }
  if((eptr < ne && ea < fa) || (fptr >= nf)) {
    a = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    a = fi
    fptr += 1
    if(fptr < nf) {
      fi = -f[fptr]
      fa = abs(fi)
    }
  }
  var x = a + b
  var bv = x - a
  var y = b - bv
  var q0 = y
  var q1 = x
  var _x, _bv, _av, _br, _ar
  while(eptr < ne && fptr < nf) {
    if(ea < fa) {
      a = ei
      eptr += 1
      if(eptr < ne) {
        ei = e[eptr]
        ea = abs(ei)
      }
    } else {
      a = fi
      fptr += 1
      if(fptr < nf) {
        fi = -f[fptr]
        fa = abs(fi)
      }
    }
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
  }
  while(eptr < ne) {
    a = ei
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
    }
  }
  while(fptr < nf) {
    a = fi
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    } 
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    fptr += 1
    if(fptr < nf) {
      fi = -f[fptr]
    }
  }
  if(q0) {
    g[count++] = q0
  }
  if(q1) {
    g[count++] = q1
  }
  if(!count) {
    g[count++] = 0.0  
  }
  g.length = count
  return g
}
},{}],45:[function(require,module,exports){
"use strict"

module.exports = linearExpansionSum

//Easy case: Add two scalars
function scalarScalar(a, b) {
  var x = a + b
  var bv = x - a
  var av = x - bv
  var br = b - bv
  var ar = a - av
  var y = ar + br
  if(y) {
    return [y, x]
  }
  return [x]
}

function linearExpansionSum(e, f) {
  var ne = e.length|0
  var nf = f.length|0
  if(ne === 1 && nf === 1) {
    return scalarScalar(e[0], f[0])
  }
  var n = ne + nf
  var g = new Array(n)
  var count = 0
  var eptr = 0
  var fptr = 0
  var abs = Math.abs
  var ei = e[eptr]
  var ea = abs(ei)
  var fi = f[fptr]
  var fa = abs(fi)
  var a, b
  if(ea < fa) {
    b = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    b = fi
    fptr += 1
    if(fptr < nf) {
      fi = f[fptr]
      fa = abs(fi)
    }
  }
  if((eptr < ne && ea < fa) || (fptr >= nf)) {
    a = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    a = fi
    fptr += 1
    if(fptr < nf) {
      fi = f[fptr]
      fa = abs(fi)
    }
  }
  var x = a + b
  var bv = x - a
  var y = b - bv
  var q0 = y
  var q1 = x
  var _x, _bv, _av, _br, _ar
  while(eptr < ne && fptr < nf) {
    if(ea < fa) {
      a = ei
      eptr += 1
      if(eptr < ne) {
        ei = e[eptr]
        ea = abs(ei)
      }
    } else {
      a = fi
      fptr += 1
      if(fptr < nf) {
        fi = f[fptr]
        fa = abs(fi)
      }
    }
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
  }
  while(eptr < ne) {
    a = ei
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
    }
  }
  while(fptr < nf) {
    a = fi
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    } 
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    fptr += 1
    if(fptr < nf) {
      fi = f[fptr]
    }
  }
  if(q0) {
    g[count++] = q0
  }
  if(q1) {
    g[count++] = q1
  }
  if(!count) {
    g[count++] = 0.0  
  }
  g.length = count
  return g
}
},{}],46:[function(require,module,exports){
"use strict"

module.exports = twoProduct

var SPLITTER = +(Math.pow(2, 27) + 1.0)

function twoProduct(a, b, result) {
  var x = a * b

  var c = SPLITTER * a
  var abig = c - a
  var ahi = c - abig
  var alo = a - ahi

  var d = SPLITTER * b
  var bbig = d - b
  var bhi = d - bbig
  var blo = b - bhi

  var err1 = x - (ahi * bhi)
  var err2 = err1 - (alo * bhi)
  var err3 = err2 - (ahi * blo)

  var y = alo * blo - err3

  if(result) {
    result[0] = y
    result[1] = x
    return result
  }

  return [ y, x ]
}
},{}],47:[function(require,module,exports){
"use strict"

var twoProduct = require("two-product")
var robustSum = require("robust-sum")
var robustScale = require("robust-scale")
var robustSubtract = require("robust-subtract")

var NUM_EXPAND = 5

var EPSILON     = 1.1102230246251565e-16
var ERRBOUND3   = (3.0 + 16.0 * EPSILON) * EPSILON
var ERRBOUND4   = (7.0 + 56.0 * EPSILON) * EPSILON

function cofactor(m, c) {
  var result = new Array(m.length-1)
  for(var i=1; i<m.length; ++i) {
    var r = result[i-1] = new Array(m.length-1)
    for(var j=0,k=0; j<m.length; ++j) {
      if(j === c) {
        continue
      }
      r[k++] = m[i][j]
    }
  }
  return result
}

function matrix(n) {
  var result = new Array(n)
  for(var i=0; i<n; ++i) {
    result[i] = new Array(n)
    for(var j=0; j<n; ++j) {
      result[i][j] = ["m", j, "[", (n-i-1), "]"].join("")
    }
  }
  return result
}

function sign(n) {
  if(n & 1) {
    return "-"
  }
  return ""
}

function generateSum(expr) {
  if(expr.length === 1) {
    return expr[0]
  } else if(expr.length === 2) {
    return ["sum(", expr[0], ",", expr[1], ")"].join("")
  } else {
    var m = expr.length>>1
    return ["sum(", generateSum(expr.slice(0, m)), ",", generateSum(expr.slice(m)), ")"].join("")
  }
}

function determinant(m) {
  if(m.length === 2) {
    return [["sum(prod(", m[0][0], ",", m[1][1], "),prod(-", m[0][1], ",", m[1][0], "))"].join("")]
  } else {
    var expr = []
    for(var i=0; i<m.length; ++i) {
      expr.push(["scale(", generateSum(determinant(cofactor(m, i))), ",", sign(i), m[0][i], ")"].join(""))
    }
    return expr
  }
}

function orientation(n) {
  var pos = []
  var neg = []
  var m = matrix(n)
  var args = []
  for(var i=0; i<n; ++i) {
    if((i&1)===0) {
      pos.push.apply(pos, determinant(cofactor(m, i)))
    } else {
      neg.push.apply(neg, determinant(cofactor(m, i)))
    }
    args.push("m" + i)
  }
  var posExpr = generateSum(pos)
  var negExpr = generateSum(neg)
  var funcName = "orientation" + n + "Exact"
  var code = ["function ", funcName, "(", args.join(), "){var p=", posExpr, ",n=", negExpr, ",d=sub(p,n);\
return d[d.length-1];};return ", funcName].join("")
  var proc = new Function("sum", "prod", "scale", "sub", code)
  return proc(robustSum, twoProduct, robustScale, robustSubtract)
}

var orientation3Exact = orientation(3)
var orientation4Exact = orientation(4)

var CACHED = [
  function orientation0() { return 0 },
  function orientation1() { return 0 },
  function orientation2(a, b) { 
    return b[0] - a[0]
  },
  function orientation3(a, b, c) {
    var l = (a[1] - c[1]) * (b[0] - c[0])
    var r = (a[0] - c[0]) * (b[1] - c[1])
    var det = l - r
    var s
    if(l > 0) {
      if(r <= 0) {
        return det
      } else {
        s = l + r
      }
    } else if(l < 0) {
      if(r >= 0) {
        return det
      } else {
        s = -(l + r)
      }
    } else {
      return det
    }
    var tol = ERRBOUND3 * s
    if(det >= tol || det <= -tol) {
      return det
    }
    return orientation3Exact(a, b, c)
  },
  function orientation4(a,b,c,d) {
    var adx = a[0] - d[0]
    var bdx = b[0] - d[0]
    var cdx = c[0] - d[0]
    var ady = a[1] - d[1]
    var bdy = b[1] - d[1]
    var cdy = c[1] - d[1]
    var adz = a[2] - d[2]
    var bdz = b[2] - d[2]
    var cdz = c[2] - d[2]
    var bdxcdy = bdx * cdy
    var cdxbdy = cdx * bdy
    var cdxady = cdx * ady
    var adxcdy = adx * cdy
    var adxbdy = adx * bdy
    var bdxady = bdx * ady
    var det = adz * (bdxcdy - cdxbdy) 
            + bdz * (cdxady - adxcdy)
            + cdz * (adxbdy - bdxady)
    var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz)
                  + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz)
                  + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz)
    var tol = ERRBOUND4 * permanent
    if ((det > tol) || (-det > tol)) {
      return det
    }
    return orientation4Exact(a,b,c,d)
  }
]

function slowOrient(args) {
  var proc = CACHED[args.length]
  if(!proc) {
    proc = CACHED[args.length] = orientation(args.length)
  }
  return proc.apply(undefined, args)
}

function generateOrientationProc() {
  while(CACHED.length <= NUM_EXPAND) {
    CACHED.push(orientation(CACHED.length))
  }
  var args = []
  var procArgs = ["slow"]
  for(var i=0; i<=NUM_EXPAND; ++i) {
    args.push("a" + i)
    procArgs.push("o" + i)
  }
  var code = [
    "function getOrientation(", args.join(), "){switch(arguments.length){case 0:case 1:return 0;"
  ]
  for(var i=2; i<=NUM_EXPAND; ++i) {
    code.push("case ", i, ":return o", i, "(", args.slice(0, i).join(), ");")
  }
  code.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation")
  procArgs.push(code.join(""))

  var proc = Function.apply(undefined, procArgs)
  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED))
  for(var i=0; i<=NUM_EXPAND; ++i) {
    module.exports[i] = CACHED[i]
  }
}

generateOrientationProc()
},{"robust-scale":43,"robust-subtract":44,"robust-sum":45,"two-product":46}],48:[function(require,module,exports){
"use strict"

//High level idea:
// 1. Use Clarkson's incremental construction to find convex hull
// 2. Point location in triangulation by jump and walk

module.exports = incrementalConvexHull

var orient = require("robust-orientation")
var compareCell = require("simplicial-complex").compareCells

function compareInt(a, b) {
  return a - b
}

function Simplex(vertices, adjacent, boundary) {
  this.vertices = vertices
  this.adjacent = adjacent
  this.boundary = boundary
  this.lastVisited = -1
}

Simplex.prototype.flip = function() {
  var t = this.vertices[0]
  this.vertices[0] = this.vertices[1]
  this.vertices[1] = t
  var u = this.adjacent[0]
  this.adjacent[0] = this.adjacent[1]
  this.adjacent[1] = u
}

function GlueFacet(vertices, cell, index) {
  this.vertices = vertices
  this.cell = cell
  this.index = index
}

function compareGlue(a, b) {
  return compareCell(a.vertices, b.vertices)
}

function bakeOrient(d) {
  var code = ["function orient(){var tuple=this.tuple;return test("]
  for(var i=0; i<=d; ++i) {
    if(i > 0) {
      code.push(",")
    }
    code.push("tuple[", i, "]")
  }
  code.push(")}return orient")
  var proc = new Function("test", code.join(""))
  var test = orient[d+1]
  if(!test) {
    test = orient
  }
  return proc(test)
}

var BAKED = []

function Triangulation(dimension, vertices, simplices) {
  this.dimension = dimension
  this.vertices = vertices
  this.simplices = simplices
  this.interior = simplices.filter(function(c) {
    return !c.boundary
  })

  this.tuple = new Array(dimension+1)
  for(var i=0; i<=dimension; ++i) {
    this.tuple[i] = this.vertices[i]
  }

  var o = BAKED[dimension]
  if(!o) {
    o = BAKED[dimension] = bakeOrient(dimension)
  }
  this.orient = o
}

var proto = Triangulation.prototype

//Degenerate situation where we are on boundary, but coplanar to face
proto.handleBoundaryDegeneracy = function(cell, point) {
  var d = this.dimension
  var n = this.vertices.length - 1
  var tuple = this.tuple
  var verts = this.vertices

  //Dumb solution: Just do dfs from boundary cell until we find any peak, or terminate
  var toVisit = [ cell ]
  cell.lastVisited = -n
  while(toVisit.length > 0) {
    cell = toVisit.pop()
    var cellVerts = cell.vertices
    var cellAdj = cell.adjacent
    for(var i=0; i<=d; ++i) {
      var neighbor = cellAdj[i]
      if(!neighbor.boundary || neighbor.lastVisited <= -n) {
        continue
      }
      var nv = neighbor.vertices
      for(var j=0; j<=d; ++j) {
        var vv = nv[j]
        if(vv < 0) {
          tuple[j] = point
        } else {
          tuple[j] = verts[vv]
        }
      }
      var o = this.orient()
      if(o > 0) {
        return neighbor
      }
      neighbor.lastVisited = -n
      if(o === 0) {
        toVisit.push(neighbor)
      }
    }
  }
  return null
}

proto.walk = function(point, random) {
  //Alias local properties
  var n = this.vertices.length - 1
  var d = this.dimension
  var verts = this.vertices
  var tuple = this.tuple

  //Compute initial jump cell
  var initIndex = random ? (this.interior.length * Math.random())|0 : (this.interior.length-1)
  var cell = this.interior[ initIndex ]

  //Start walking
outerLoop:
  while(!cell.boundary) {
    var cellVerts = cell.vertices
    var cellAdj = cell.adjacent

    for(var i=0; i<=d; ++i) {
      tuple[i] = verts[cellVerts[i]]
    }
    cell.lastVisited = n

    //Find farthest adjacent cell
    for(var i=0; i<=d; ++i) {
      var neighbor = cellAdj[i]
      if(neighbor.lastVisited >= n) {
        continue
      }
      var prev = tuple[i]
      tuple[i] = point
      var o = this.orient()
      tuple[i] = prev
      if(o < 0) {
        cell = neighbor
        continue outerLoop
      } else {
        if(!neighbor.boundary) {
          neighbor.lastVisited = n
        } else {
          neighbor.lastVisited = -n
        }
      }
    }
    return
  }

  return cell
}

proto.addPeaks = function(point, cell) {
  var n = this.vertices.length - 1
  var d = this.dimension
  var verts = this.vertices
  var tuple = this.tuple
  var interior = this.interior
  var simplices = this.simplices

  //Walking finished at boundary, time to add peaks
  var tovisit = [ cell ]

  //Stretch initial boundary cell into a peak
  cell.lastVisited = n
  cell.vertices[cell.vertices.indexOf(-1)] = n
  cell.boundary = false
  interior.push(cell)

  //Record a list of all new boundaries created by added peaks so we can glue them together when we are all done
  var glueFacets = []

  //Do a traversal of the boundary walking outward from starting peak
  while(tovisit.length > 0) {
    //Pop off peak and walk over adjacent cells
    var cell = tovisit.pop()
    var cellVerts = cell.vertices
    var cellAdj = cell.adjacent
    var indexOfN = cellVerts.indexOf(n)
    if(indexOfN < 0) {
      continue
    }

    for(var i=0; i<=d; ++i) {
      if(i === indexOfN) {
        continue
      }

      //For each boundary neighbor of the cell
      var neighbor = cellAdj[i]
      if(!neighbor.boundary || neighbor.lastVisited >= n) {
        continue
      }

      var nv = neighbor.vertices

      //Test if neighbor is a peak
      if(neighbor.lastVisited !== -n) {      
        //Compute orientation of p relative to each boundary peak
        var indexOfNeg1 = 0
        for(var j=0; j<=d; ++j) {
          if(nv[j] < 0) {
            indexOfNeg1 = j
            tuple[j] = point
          } else {
            tuple[j] = verts[nv[j]]
          }
        }
        var o = this.orient()

        //Test if neighbor cell is also a peak
        if(o > 0) {
          nv[indexOfNeg1] = n
          neighbor.boundary = false
          interior.push(neighbor)
          tovisit.push(neighbor)
          neighbor.lastVisited = n
          continue
        } else {
          neighbor.lastVisited = -n
        }
      }

      var na = neighbor.adjacent

      //Otherwise, replace neighbor with new face
      var vverts = cellVerts.slice()
      var vadj = cellAdj.slice()
      var ncell = new Simplex(vverts, vadj, true)
      simplices.push(ncell)

      //Connect to neighbor
      var opposite = na.indexOf(cell)
      if(opposite < 0) {
        continue
      }
      na[opposite] = ncell
      vadj[indexOfN] = neighbor

      //Connect to cell
      vverts[i] = -1
      vadj[i] = cell
      cellAdj[i] = ncell

      //Flip facet
      ncell.flip()

      //Add to glue list
      for(var j=0; j<=d; ++j) {
        var uu = vverts[j]
        if(uu < 0 || uu === n) {
          continue
        }
        var nface = new Array(d-1)
        var nptr = 0
        for(var k=0; k<=d; ++k) {
          var vv = vverts[k]
          if(vv < 0 || k === j) {
            continue
          }
          nface[nptr++] = vv
        }
        glueFacets.push(new GlueFacet(nface, ncell, j))
      }
    }
  }

  //Glue boundary facets together
  glueFacets.sort(compareGlue)

  for(var i=0; i+1<glueFacets.length; i+=2) {
    var a = glueFacets[i]
    var b = glueFacets[i+1]
    var ai = a.index
    var bi = b.index
    if(ai < 0 || bi < 0) {
      continue
    }
    a.cell.adjacent[a.index] = b.cell
    b.cell.adjacent[b.index] = a.cell
  }
}

proto.insert = function(point, random) {
  //Add point
  var verts = this.vertices
  verts.push(point)

  var cell = this.walk(point, random)
  if(!cell) {
    return
  }

  //Alias local properties
  var d = this.dimension
  var tuple = this.tuple

  //Degenerate case: If point is coplanar to cell, then walk until we find a non-degenerate boundary
  for(var i=0; i<=d; ++i) {
    var vv = cell.vertices[i]
    if(vv < 0) {
      tuple[i] = point
    } else {
      tuple[i] = verts[vv]
    }
  }
  var o = this.orient(tuple)
  if(o < 0) {
    return
  } else if(o === 0) {
    cell = this.handleBoundaryDegeneracy(cell, point)
    if(!cell) {
      return
    }
  }

  //Add peaks
  this.addPeaks(point, cell)
}

//Extract all boundary cells
proto.boundary = function() {
  var d = this.dimension
  var boundary = []
  var cells = this.simplices
  var nc = cells.length
  for(var i=0; i<nc; ++i) {
    var c = cells[i]
    if(c.boundary) {
      var bcell = new Array(d)
      var cv = c.vertices
      var ptr = 0
      var parity = 0
      for(var j=0; j<=d; ++j) {
        if(cv[j] >= 0) {
          bcell[ptr++] = cv[j]
        } else {
          parity = j&1
        }
      }
      if(parity === (d&1)) {
        var t = bcell[0]
        bcell[0] = bcell[1]
        bcell[1] = t
      }
      boundary.push(bcell)
    }
  }
  return boundary
}

function incrementalConvexHull(points, randomSearch) {
  var n = points.length
  if(n === 0) {
    throw new Error("Must have at least d+1 points")
  }
  var d = points[0].length
  if(n <= d) {
    throw new Error("Must input at least d+1 points")
  }

  //FIXME: This could be degenerate, but need to select d+1 non-coplanar points to bootstrap process
  var initialSimplex = points.slice(0, d+1)

  //Make sure initial simplex is positively oriented
  var o = orient.apply(void 0, initialSimplex)
  if(o === 0) {
    throw new Error("Input not in general position")
  }
  var initialCoords = new Array(d+1)
  for(var i=0; i<=d; ++i) {
    initialCoords[i] = i
  }
  if(o < 0) {
    initialCoords[0] = 1
    initialCoords[1] = 0
  }

  //Create initial topological index, glue pointers together (kind of messy)
  var initialCell = new Simplex(initialCoords, new Array(d+1), false)
  var boundary = initialCell.adjacent
  var list = new Array(d+2)
  for(var i=0; i<=d; ++i) {
    var verts = initialCoords.slice()
    for(var j=0; j<=d; ++j) {
      if(j === i) {
        verts[j] = -1
      }
    }
    var t = verts[0]
    verts[0] = verts[1]
    verts[1] = t
    var cell = new Simplex(verts, new Array(d+1), true)
    boundary[i] = cell
    list[i] = cell
  }
  list[d+1] = initialCell
  for(var i=0; i<=d; ++i) {
    var verts = boundary[i].vertices
    var adj = boundary[i].adjacent
    for(var j=0; j<=d; ++j) {
      var v = verts[j]
      if(v < 0) {
        adj[j] = initialCell
        continue
      }
      for(var k=0; k<=d; ++k) {
        if(boundary[k].vertices.indexOf(v) < 0) {
          adj[j] = boundary[k]
        }
      }
    }
  }

  //Initialize triangles
  var triangles = new Triangulation(d, initialSimplex, list)

  //Insert remaining points
  var useRandom = !!randomSearch
  for(var i=d+1; i<n; ++i) {
    triangles.insert(points[i], useRandom)
  }
  
  //Extract boundary cells
  return triangles.boundary()
}
},{"robust-orientation":54,"simplicial-complex":57}],49:[function(require,module,exports){
arguments[4][42][0].apply(exports,arguments)
},{"dup":42}],50:[function(require,module,exports){
arguments[4][43][0].apply(exports,arguments)
},{"dup":43,"two-product":53,"two-sum":49}],51:[function(require,module,exports){
arguments[4][44][0].apply(exports,arguments)
},{"dup":44}],52:[function(require,module,exports){
arguments[4][45][0].apply(exports,arguments)
},{"dup":45}],53:[function(require,module,exports){
arguments[4][46][0].apply(exports,arguments)
},{"dup":46}],54:[function(require,module,exports){
arguments[4][47][0].apply(exports,arguments)
},{"dup":47,"robust-scale":50,"robust-subtract":51,"robust-sum":52,"two-product":53}],55:[function(require,module,exports){
/**
 * Bit twiddling hacks for JavaScript.
 *
 * Author: Mikola Lysenko
 *
 * Ported from Stanford bit twiddling hack library:
 *    http://graphics.stanford.edu/~seander/bithacks.html
 */

"use strict"; "use restrict";

//Number of bits in an integer
var INT_BITS = 32;

//Constants
exports.INT_BITS  = INT_BITS;
exports.INT_MAX   =  0x7fffffff;
exports.INT_MIN   = -1<<(INT_BITS-1);

//Returns -1, 0, +1 depending on sign of x
exports.sign = function(v) {
  return (v > 0) - (v < 0);
}

//Computes absolute value of integer
exports.abs = function(v) {
  var mask = v >> (INT_BITS-1);
  return (v ^ mask) - mask;
}

//Computes minimum of integers x and y
exports.min = function(x, y) {
  return y ^ ((x ^ y) & -(x < y));
}

//Computes maximum of integers x and y
exports.max = function(x, y) {
  return x ^ ((x ^ y) & -(x < y));
}

//Checks if a number is a power of two
exports.isPow2 = function(v) {
  return !(v & (v-1)) && (!!v);
}

//Computes log base 2 of v
exports.log2 = function(v) {
  var r, shift;
  r =     (v > 0xFFFF) << 4; v >>>= r;
  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;
  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;
  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;
  return r | (v >> 1);
}

//Computes log base 10 of v
exports.log10 = function(v) {
  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :
          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :
          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;
}

//Counts number of bits
exports.popCount = function(v) {
  v = v - ((v >>> 1) & 0x55555555);
  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);
  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;
}

//Counts number of trailing zeros
function countTrailingZeros(v) {
  var c = 32;
  v &= -v;
  if (v) c--;
  if (v & 0x0000FFFF) c -= 16;
  if (v & 0x00FF00FF) c -= 8;
  if (v & 0x0F0F0F0F) c -= 4;
  if (v & 0x33333333) c -= 2;
  if (v & 0x55555555) c -= 1;
  return c;
}
exports.countTrailingZeros = countTrailingZeros;

//Rounds to next power of 2
exports.nextPow2 = function(v) {
  v += v === 0;
  --v;
  v |= v >>> 1;
  v |= v >>> 2;
  v |= v >>> 4;
  v |= v >>> 8;
  v |= v >>> 16;
  return v + 1;
}

//Rounds down to previous power of 2
exports.prevPow2 = function(v) {
  v |= v >>> 1;
  v |= v >>> 2;
  v |= v >>> 4;
  v |= v >>> 8;
  v |= v >>> 16;
  return v - (v>>>1);
}

//Computes parity of word
exports.parity = function(v) {
  v ^= v >>> 16;
  v ^= v >>> 8;
  v ^= v >>> 4;
  v &= 0xf;
  return (0x6996 >>> v) & 1;
}

var REVERSE_TABLE = new Array(256);

(function(tab) {
  for(var i=0; i<256; ++i) {
    var v = i, r = i, s = 7;
    for (v >>>= 1; v; v >>>= 1) {
      r <<= 1;
      r |= v & 1;
      --s;
    }
    tab[i] = (r << s) & 0xff;
  }
})(REVERSE_TABLE);

//Reverse bits in a 32 bit word
exports.reverse = function(v) {
  return  (REVERSE_TABLE[ v         & 0xff] << 24) |
          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |
          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |
           REVERSE_TABLE[(v >>> 24) & 0xff];
}

//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes
exports.interleave2 = function(x, y) {
  x &= 0xFFFF;
  x = (x | (x << 8)) & 0x00FF00FF;
  x = (x | (x << 4)) & 0x0F0F0F0F;
  x = (x | (x << 2)) & 0x33333333;
  x = (x | (x << 1)) & 0x55555555;

  y &= 0xFFFF;
  y = (y | (y << 8)) & 0x00FF00FF;
  y = (y | (y << 4)) & 0x0F0F0F0F;
  y = (y | (y << 2)) & 0x33333333;
  y = (y | (y << 1)) & 0x55555555;

  return x | (y << 1);
}

//Extracts the nth interleaved component
exports.deinterleave2 = function(v, n) {
  v = (v >>> n) & 0x55555555;
  v = (v | (v >>> 1))  & 0x33333333;
  v = (v | (v >>> 2))  & 0x0F0F0F0F;
  v = (v | (v >>> 4))  & 0x00FF00FF;
  v = (v | (v >>> 16)) & 0x000FFFF;
  return (v << 16) >> 16;
}


//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes
exports.interleave3 = function(x, y, z) {
  x &= 0x3FF;
  x  = (x | (x<<16)) & 4278190335;
  x  = (x | (x<<8))  & 251719695;
  x  = (x | (x<<4))  & 3272356035;
  x  = (x | (x<<2))  & 1227133513;

  y &= 0x3FF;
  y  = (y | (y<<16)) & 4278190335;
  y  = (y | (y<<8))  & 251719695;
  y  = (y | (y<<4))  & 3272356035;
  y  = (y | (y<<2))  & 1227133513;
  x |= (y << 1);
  
  z &= 0x3FF;
  z  = (z | (z<<16)) & 4278190335;
  z  = (z | (z<<8))  & 251719695;
  z  = (z | (z<<4))  & 3272356035;
  z  = (z | (z<<2))  & 1227133513;
  
  return x | (z << 2);
}

//Extracts nth interleaved component of a 3-tuple
exports.deinterleave3 = function(v, n) {
  v = (v >>> n)       & 1227133513;
  v = (v | (v>>>2))   & 3272356035;
  v = (v | (v>>>4))   & 251719695;
  v = (v | (v>>>8))   & 4278190335;
  v = (v | (v>>>16))  & 0x3FF;
  return (v<<22)>>22;
}

//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)
exports.nextCombination = function(v) {
  var t = v | (v - 1);
  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));
}


},{}],56:[function(require,module,exports){
"use strict"; "use restrict";

module.exports = UnionFind;

function UnionFind(count) {
  this.roots = new Array(count);
  this.ranks = new Array(count);
  
  for(var i=0; i<count; ++i) {
    this.roots[i] = i;
    this.ranks[i] = 0;
  }
}

var proto = UnionFind.prototype

Object.defineProperty(proto, "length", {
  "get": function() {
    return this.roots.length
  }
})

proto.makeSet = function() {
  var n = this.roots.length;
  this.roots.push(n);
  this.ranks.push(0);
  return n;
}

proto.find = function(x) {
  var x0 = x
  var roots = this.roots;
  while(roots[x] !== x) {
    x = roots[x]
  }
  while(roots[x0] !== x) {
    var y = roots[x0]
    roots[x0] = x
    x0 = y
  }
  return x;
}

proto.link = function(x, y) {
  var xr = this.find(x)
    , yr = this.find(y);
  if(xr === yr) {
    return;
  }
  var ranks = this.ranks
    , roots = this.roots
    , xd    = ranks[xr]
    , yd    = ranks[yr];
  if(xd < yd) {
    roots[xr] = yr;
  } else if(yd < xd) {
    roots[yr] = xr;
  } else {
    roots[yr] = xr;
    ++ranks[xr];
  }
}
},{}],57:[function(require,module,exports){
"use strict"; "use restrict";

var bits      = require("bit-twiddle")
  , UnionFind = require("union-find")

//Returns the dimension of a cell complex
function dimension(cells) {
  var d = 0
    , max = Math.max
  for(var i=0, il=cells.length; i<il; ++i) {
    d = max(d, cells[i].length)
  }
  return d-1
}
exports.dimension = dimension

//Counts the number of vertices in faces
function countVertices(cells) {
  var vc = -1
    , max = Math.max
  for(var i=0, il=cells.length; i<il; ++i) {
    var c = cells[i]
    for(var j=0, jl=c.length; j<jl; ++j) {
      vc = max(vc, c[j])
    }
  }
  return vc+1
}
exports.countVertices = countVertices

//Returns a deep copy of cells
function cloneCells(cells) {
  var ncells = new Array(cells.length)
  for(var i=0, il=cells.length; i<il; ++i) {
    ncells[i] = cells[i].slice(0)
  }
  return ncells
}
exports.cloneCells = cloneCells

//Ranks a pair of cells up to permutation
function compareCells(a, b) {
  var n = a.length
    , t = a.length - b.length
    , min = Math.min
  if(t) {
    return t
  }
  switch(n) {
    case 0:
      return 0;
    case 1:
      return a[0] - b[0];
    case 2:
      var d = a[0]+a[1]-b[0]-b[1]
      if(d) {
        return d
      }
      return min(a[0],a[1]) - min(b[0],b[1])
    case 3:
      var l1 = a[0]+a[1]
        , m1 = b[0]+b[1]
      d = l1+a[2] - (m1+b[2])
      if(d) {
        return d
      }
      var l0 = min(a[0], a[1])
        , m0 = min(b[0], b[1])
        , d  = min(l0, a[2]) - min(m0, b[2])
      if(d) {
        return d
      }
      return min(l0+a[2], l1) - min(m0+b[2], m1)
    
    //TODO: Maybe optimize n=4 as well?
    
    default:
      var as = a.slice(0)
      as.sort()
      var bs = b.slice(0)
      bs.sort()
      for(var i=0; i<n; ++i) {
        t = as[i] - bs[i]
        if(t) {
          return t
        }
      }
      return 0
  }
}
exports.compareCells = compareCells

function compareZipped(a, b) {
  return compareCells(a[0], b[0])
}

//Puts a cell complex into normal order for the purposes of findCell queries
function normalize(cells, attr) {
  if(attr) {
    var len = cells.length
    var zipped = new Array(len)
    for(var i=0; i<len; ++i) {
      zipped[i] = [cells[i], attr[i]]
    }
    zipped.sort(compareZipped)
    for(var i=0; i<len; ++i) {
      cells[i] = zipped[i][0]
      attr[i] = zipped[i][1]
    }
    return cells
  } else {
    cells.sort(compareCells)
    return cells
  }
}
exports.normalize = normalize

//Removes all duplicate cells in the complex
function unique(cells) {
  if(cells.length === 0) {
    return []
  }
  var ptr = 1
    , len = cells.length
  for(var i=1; i<len; ++i) {
    var a = cells[i]
    if(compareCells(a, cells[i-1])) {
      if(i === ptr) {
        ptr++
        continue
      }
      cells[ptr++] = a
    }
  }
  cells.length = ptr
  return cells
}
exports.unique = unique;

//Finds a cell in a normalized cell complex
function findCell(cells, c) {
  var lo = 0
    , hi = cells.length-1
    , r  = -1
  while (lo <= hi) {
    var mid = (lo + hi) >> 1
      , s   = compareCells(cells[mid], c)
    if(s <= 0) {
      if(s === 0) {
        r = mid
      }
      lo = mid + 1
    } else if(s > 0) {
      hi = mid - 1
    }
  }
  return r
}
exports.findCell = findCell;

//Builds an index for an n-cell.  This is more general than dual, but less efficient
function incidence(from_cells, to_cells) {
  var index = new Array(from_cells.length)
  for(var i=0, il=index.length; i<il; ++i) {
    index[i] = []
  }
  var b = []
  for(var i=0, n=to_cells.length; i<n; ++i) {
    var c = to_cells[i]
    var cl = c.length
    for(var k=1, kn=(1<<cl); k<kn; ++k) {
      b.length = bits.popCount(k)
      var l = 0
      for(var j=0; j<cl; ++j) {
        if(k & (1<<j)) {
          b[l++] = c[j]
        }
      }
      var idx=findCell(from_cells, b)
      if(idx < 0) {
        continue
      }
      while(true) {
        index[idx++].push(i)
        if(idx >= from_cells.length || compareCells(from_cells[idx], b) !== 0) {
          break
        }
      }
    }
  }
  return index
}
exports.incidence = incidence

//Computes the dual of the mesh.  This is basically an optimized version of buildIndex for the situation where from_cells is just the list of vertices
function dual(cells, vertex_count) {
  if(!vertex_count) {
    return incidence(unique(skeleton(cells, 0)), cells, 0)
  }
  var res = new Array(vertex_count)
  for(var i=0; i<vertex_count; ++i) {
    res[i] = []
  }
  for(var i=0, len=cells.length; i<len; ++i) {
    var c = cells[i]
    for(var j=0, cl=c.length; j<cl; ++j) {
      res[c[j]].push(i)
    }
  }
  return res
}
exports.dual = dual

//Enumerates all cells in the complex
function explode(cells) {
  var result = []
  for(var i=0, il=cells.length; i<il; ++i) {
    var c = cells[i]
      , cl = c.length|0
    for(var j=1, jl=(1<<cl); j<jl; ++j) {
      var b = []
      for(var k=0; k<cl; ++k) {
        if((j >>> k) & 1) {
          b.push(c[k])
        }
      }
      result.push(b)
    }
  }
  return normalize(result)
}
exports.explode = explode

//Enumerates all of the n-cells of a cell complex
function skeleton(cells, n) {
  if(n < 0) {
    return []
  }
  var result = []
    , k0     = (1<<(n+1))-1
  for(var i=0; i<cells.length; ++i) {
    var c = cells[i]
    for(var k=k0; k<(1<<c.length); k=bits.nextCombination(k)) {
      var b = new Array(n+1)
        , l = 0
      for(var j=0; j<c.length; ++j) {
        if(k & (1<<j)) {
          b[l++] = c[j]
        }
      }
      result.push(b)
    }
  }
  return normalize(result)
}
exports.skeleton = skeleton;

//Computes the boundary of all cells, does not remove duplicates
function boundary(cells) {
  var res = []
  for(var i=0,il=cells.length; i<il; ++i) {
    var c = cells[i]
    for(var j=0,cl=c.length; j<cl; ++j) {
      var b = new Array(c.length-1)
      for(var k=0, l=0; k<cl; ++k) {
        if(k !== j) {
          b[l++] = c[k]
        }
      }
      res.push(b)
    }
  }
  return normalize(res)
}
exports.boundary = boundary;

//Computes connected components for a dense cell complex
function connectedComponents_dense(cells, vertex_count) {
  var labels = new UnionFind(vertex_count)
  for(var i=0; i<cells.length; ++i) {
    var c = cells[i]
    for(var j=0; j<c.length; ++j) {
      for(var k=j+1; k<c.length; ++k) {
        labels.link(c[j], c[k])
      }
    }
  }
  var components = []
    , component_labels = labels.ranks
  for(var i=0; i<component_labels.length; ++i) {
    component_labels[i] = -1
  }
  for(var i=0; i<cells.length; ++i) {
    var l = labels.find(cells[i][0])
    if(component_labels[l] < 0) {
      component_labels[l] = components.length
      components.push([cells[i].slice(0)])
    } else {
      components[component_labels[l]].push(cells[i].slice(0))
    }
  }
  return components
}

//Computes connected components for a sparse graph
function connectedComponents_sparse(cells) {
  var vertices  = unique(normalize(skeleton(cells, 0)))
    , labels    = new UnionFind(vertices.length)
  for(var i=0; i<cells.length; ++i) {
    var c = cells[i]
    for(var j=0; j<c.length; ++j) {
      var vj = findCell(vertices, [c[j]])
      for(var k=j+1; k<c.length; ++k) {
        labels.link(vj, findCell(vertices, [c[k]]))
      }
    }
  }
  var components        = []
    , component_labels  = labels.ranks
  for(var i=0; i<component_labels.length; ++i) {
    component_labels[i] = -1
  }
  for(var i=0; i<cells.length; ++i) {
    var l = labels.find(findCell(vertices, [cells[i][0]]));
    if(component_labels[l] < 0) {
      component_labels[l] = components.length
      components.push([cells[i].slice(0)])
    } else {
      components[component_labels[l]].push(cells[i].slice(0))
    }
  }
  return components
}

//Computes connected components for a cell complex
function connectedComponents(cells, vertex_count) {
  if(vertex_count) {
    return connectedComponents_dense(cells, vertex_count)
  }
  return connectedComponents_sparse(cells)
}
exports.connectedComponents = connectedComponents

},{"bit-twiddle":55,"union-find":56}],58:[function(require,module,exports){
'use strict'

module.exports = monotoneConvexHull2D

var orient = require('robust-orientation')[3]

function monotoneConvexHull2D(points) {
  var n = points.length

  if(n < 3) {
    var result = new Array(n)
    for(var i=0; i<n; ++i) {
      result[i] = i
    }

    if(n === 2 &&
       points[0][0] === points[1][0] &&
       points[0][1] === points[1][1]) {
      return [0]
    }

    return result
  }

  //Sort point indices along x-axis
  var sorted = new Array(n)
  for(var i=0; i<n; ++i) {
    sorted[i] = i
  }
  sorted.sort(function(a,b) {
    var d = points[a][0]-points[b][0]
    if(d) {
      return d
    }
    return points[a][1] - points[b][1]
  })

  //Construct upper and lower hulls
  var lower = [sorted[0], sorted[1]]
  var upper = [sorted[0], sorted[1]]

  for(var i=2; i<n; ++i) {
    var idx = sorted[i]
    var p   = points[idx]

    //Insert into lower list
    var m = lower.length
    while(m > 1 && orient(
        points[lower[m-2]], 
        points[lower[m-1]], 
        p) <= 0) {
      m -= 1
      lower.pop()
    }
    lower.push(idx)

    //Insert into upper list
    m = upper.length
    while(m > 1 && orient(
        points[upper[m-2]], 
        points[upper[m-1]], 
        p) >= 0) {
      m -= 1
      upper.pop()
    }
    upper.push(idx)
  }

  //Merge lists together
  var result = new Array(upper.length + lower.length - 2)
  var ptr    = 0
  for(var i=0, nl=lower.length; i<nl; ++i) {
    result[ptr++] = lower[i]
  }
  for(var j=upper.length-2; j>0; --j) {
    result[ptr++] = upper[j]
  }

  //Return result
  return result
}
},{"robust-orientation":64}],59:[function(require,module,exports){
arguments[4][42][0].apply(exports,arguments)
},{"dup":42}],60:[function(require,module,exports){
arguments[4][43][0].apply(exports,arguments)
},{"dup":43,"two-product":63,"two-sum":59}],61:[function(require,module,exports){
arguments[4][44][0].apply(exports,arguments)
},{"dup":44}],62:[function(require,module,exports){
arguments[4][45][0].apply(exports,arguments)
},{"dup":45}],63:[function(require,module,exports){
arguments[4][46][0].apply(exports,arguments)
},{"dup":46}],64:[function(require,module,exports){
arguments[4][47][0].apply(exports,arguments)
},{"dup":47,"robust-scale":60,"robust-subtract":61,"robust-sum":62,"two-product":63}],65:[function(require,module,exports){
arguments[4][33][0].apply(exports,arguments)
},{"dup":33}],66:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a {@link FeatureCollection} of {@link Polygon} features and calculates the number of points that fall within the set of polygons.
 *
 * @module turf/count
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {String} countField a field to append to the attributes of the Polygon features representing Point counts
 * @return {FeatureCollection} a FeatureCollection of Polygon features with `countField` appended
 * @example
* var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-112.072391,46.586591],
 *           [-112.072391,46.61761],
 *           [-112.028102,46.61761],
 *           [-112.028102,46.586591],
 *           [-112.072391,46.586591]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-112.023983,46.570426],
 *           [-112.023983,46.615016],
 *           [-111.966133,46.615016],
 *           [-111.966133,46.570426],
 *           [-112.023983,46.570426]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-112.0372, 46.608058]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-112.045955, 46.596264]
 *       }
 *     }
 *   ]
 * };
 *
 * var counted = turf.count(polygons, points, 'pt_count');
 *
 * var resultFeatures = points.features.concat(counted.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(polyFC, ptFC, outField, done){
  for (var i = 0; i < polyFC.features.length; i++) {
    var poly = polyFC.features[i];
    if(!poly.properties) poly.properties = {};
    var values = 0;
    for (var j = 0; j < ptFC.features.length; j++) {
      var pt = ptFC.features[j];
      if (inside(pt, poly)) {
        values++;
      }
    }
    poly.properties[outField] = values;
  }

  return polyFC;
};

},{"turf-inside":86}],67:[function(require,module,exports){
//http://en.wikipedia.org/wiki/Haversine_formula
//http://www.movable-type.co.uk/scripts/latlong.html
var point = require('turf-point');

/**
 * Takes a {@link Point} feature and calculates the location of a destination point given a distance in degrees, radians, miles, or kilometers; and bearing in degrees. This uses the [Haversine formula](http://en.wikipedia.org/wiki/Haversine_formula) to account for global curvature.
 *
 * @module turf/destination
 * @category measurement
 * @param {Point} start a Point feature at the starting point
 * @param {Number} distance distance from the starting point
 * @param {Number} bearing ranging from -180 to 180
 * @param {String} units miles, kilometers, degrees, or radians
 * @returns {Point} a Point feature at the destination
 * @example
 * var point = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.343, 39.984]
 *   }
 * };
 * var distance = 50;
 * var bearing = 90;
 * var units = 'miles';
 *
 * var destination = turf.destination(point, distance, bearing, units);
 * destination.properties['marker-color'] = '#f00';
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [point, destination]
 * };
 *
 * //=result
 */
module.exports = function (point1, distance, bearing, units) {
    var coordinates1 = point1.geometry.coordinates;
    var longitude1 = toRad(coordinates1[0]);
    var latitude1 = toRad(coordinates1[1]);
    var bearing_rad = toRad(bearing);

    var R = 0;
    switch (units) {
    case 'miles':
        R = 3960;
        break
    case 'kilometers':
        R = 6373;
        break
    case 'degrees':
        R = 57.2957795;
        break
    case 'radians':
        R = 1;
        break
    }

    var latitude2 = Math.asin(Math.sin(latitude1) * Math.cos(distance / R) +
        Math.cos(latitude1) * Math.sin(distance / R) * Math.cos(bearing_rad));
    var longitude2 = longitude1 + Math.atan2(Math.sin(bearing_rad) * Math.sin(distance / R) * Math.cos(latitude1),
        Math.cos(distance / R) - Math.sin(latitude1) * Math.sin(latitude2));

    return point([toDeg(longitude2), toDeg(latitude2)]);
};

function toRad(degree) {
    return degree * Math.PI / 180;
}

function toDeg(rad) {
    return rad * 180 / Math.PI;
}

},{"turf-point":112}],68:[function(require,module,exports){
var ss = require('simple-statistics');
var inside = require('turf-inside');

/**
 * Calculates the standard deviation value of a field for points within a set of polygons.
 *
 * @module turf/deviation
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {String} inField the field in `points` from which to aggregate
 * @param {String} outField the field to append to `polygons` representing deviation
 * @return {FeatureCollection} a FeatureCollection of Polygon features with appended field representing deviation
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.807159, 30.270335],
 *           [-97.807159, 30.369913],
 *           [-97.612838, 30.369913],
 *           [-97.612838, 30.270335],
 *           [-97.807159, 30.270335]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.825698, 30.175405],
 *           [-97.825698, 30.264404],
 *           [-97.630691, 30.264404],
 *           [-97.630691, 30.175405],
 *           [-97.825698, 30.175405]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 500
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.709655, 30.311245]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 400
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.766647, 30.345028]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.765274, 30.294646]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 500
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.753601, 30.216355]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.667083, 30.208047]
 *       }
 *     }
 *   ]
 * };
 *
 * var inField = "population";
 * var outField = "pop_deviation";
 *
 * var deviated = turf.deviation(
 *   polygons, points, inField, outField);
 *
 * var resultFeatures = points.features.concat(
 *   deviated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(polyFC, ptFC, inField, outField, done){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = ss.standard_deviation(values);
  })

  return polyFC;
}

},{"simple-statistics":69,"turf-inside":86}],69:[function(require,module,exports){
/* global module */
// # simple-statistics
//
// A simple, literate statistics system. The code below uses the
// [Javascript module pattern](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth),
// eventually assigning `simple-statistics` to `ss` in browsers or the
// `exports` object for node.js
(function() {
    var ss = {};

    if (typeof module !== 'undefined') {
        // Assign the `ss` object to exports, so that you can require
        // it in [node.js](http://nodejs.org/)
        module.exports = ss;
    } else {
        // Otherwise, in a browser, we assign `ss` to the window object,
        // so you can simply refer to it as `ss`.
        this.ss = ss;
    }

    // # [Linear Regression](http://en.wikipedia.org/wiki/Linear_regression)
    //
    // [Simple linear regression](http://en.wikipedia.org/wiki/Simple_linear_regression)
    // is a simple way to find a fitted line
    // between a set of coordinates.
    function linear_regression() {
        var linreg = {},
            data = [];

        // Assign data to the model. Data is assumed to be an array.
        linreg.data = function(x) {
            if (!arguments.length) return data;
            data = x.slice();
            return linreg;
        };

        // Calculate the slope and y-intercept of the regression line
        // by calculating the least sum of squares
        linreg.mb = function() {
            var m, b;

            // Store data length in a local variable to reduce
            // repeated object property lookups
            var data_length = data.length;

            //if there's only one point, arbitrarily choose a slope of 0
            //and a y-intercept of whatever the y of the initial point is
            if (data_length === 1) {
                m = 0;
                b = data[0][1];
            } else {
                // Initialize our sums and scope the `m` and `b`
                // variables that define the line.
                var sum_x = 0, sum_y = 0,
                    sum_xx = 0, sum_xy = 0;

                // Use local variables to grab point values
                // with minimal object property lookups
                var point, x, y;

                // Gather the sum of all x values, the sum of all
                // y values, and the sum of x^2 and (x*y) for each
                // value.
                //
                // In math notation, these would be SS_x, SS_y, SS_xx, and SS_xy
                for (var i = 0; i < data_length; i++) {
                    point = data[i];
                    x = point[0];
                    y = point[1];

                    sum_x += x;
                    sum_y += y;

                    sum_xx += x * x;
                    sum_xy += x * y;
                }

                // `m` is the slope of the regression line
                m = ((data_length * sum_xy) - (sum_x * sum_y)) /
                    ((data_length * sum_xx) - (sum_x * sum_x));

                // `b` is the y-intercept of the line.
                b = (sum_y / data_length) - ((m * sum_x) / data_length);
            }

            // Return both values as an object.
            return { m: m, b: b };
        };

        // a shortcut for simply getting the slope of the regression line
        linreg.m = function() {
            return linreg.mb().m;
        };

        // a shortcut for simply getting the y-intercept of the regression
        // line.
        linreg.b = function() {
            return linreg.mb().b;
        };

        // ## Fitting The Regression Line
        //
        // This is called after `.data()` and returns the
        // equation `y = f(x)` which gives the position
        // of the regression line at each point in `x`.
        linreg.line = function() {

            // Get the slope, `m`, and y-intercept, `b`, of the line.
            var mb = linreg.mb(),
                m = mb.m,
                b = mb.b;

            // Return a function that computes a `y` value for each
            // x value it is given, based on the values of `b` and `a`
            // that we just computed.
            return function(x) {
                return b + (m * x);
            };
        };

        return linreg;
    }

    // # [R Squared](http://en.wikipedia.org/wiki/Coefficient_of_determination)
    //
    // The r-squared value of data compared with a function `f`
    // is the sum of the squared differences between the prediction
    // and the actual value.
    function r_squared(data, f) {
        if (data.length < 2) return 1;

        // Compute the average y value for the actual
        // data set in order to compute the
        // _total sum of squares_
        var sum = 0, average;
        for (var i = 0; i < data.length; i++) {
            sum += data[i][1];
        }
        average = sum / data.length;

        // Compute the total sum of squares - the
        // squared difference between each point
        // and the average of all points.
        var sum_of_squares = 0;
        for (var j = 0; j < data.length; j++) {
            sum_of_squares += Math.pow(average - data[j][1], 2);
        }

        // Finally estimate the error: the squared
        // difference between the estimate and the actual data
        // value at each point.
        var err = 0;
        for (var k = 0; k < data.length; k++) {
            err += Math.pow(data[k][1] - f(data[k][0]), 2);
        }

        // As the error grows larger, its ratio to the
        // sum of squares increases and the r squared
        // value grows lower.
        return 1 - (err / sum_of_squares);
    }


    // # [Bayesian Classifier](http://en.wikipedia.org/wiki/Naive_Bayes_classifier)
    //
    // This is a naïve bayesian classifier that takes
    // singly-nested objects.
    function bayesian() {
        // The `bayes_model` object is what will be exposed
        // by this closure, with all of its extended methods, and will
        // have access to all scope variables, like `total_count`.
        var bayes_model = {},
            // The number of items that are currently
            // classified in the model
            total_count = 0,
            // Every item classified in the model
            data = {};

        // ## Train
        // Train the classifier with a new item, which has a single
        // dimension of Javascript literal keys and values.
        bayes_model.train = function(item, category) {
            // If the data object doesn't have any values
            // for this category, create a new object for it.
            if (!data[category]) data[category] = {};

            // Iterate through each key in the item.
            for (var k in item) {
                var v = item[k];
                // Initialize the nested object `data[category][k][item[k]]`
                // with an object of keys that equal 0.
                if (data[category][k] === undefined) data[category][k] = {};
                if (data[category][k][v] === undefined) data[category][k][v] = 0;

                // And increment the key for this key/value combination.
                data[category][k][item[k]]++;
            }
            // Increment the number of items classified
            total_count++;
        };

        // ## Score
        // Generate a score of how well this item matches all
        // possible categories based on its attributes
        bayes_model.score = function(item) {
            // Initialize an empty array of odds per category.
            var odds = {}, category;
            // Iterate through each key in the item,
            // then iterate through each category that has been used
            // in previous calls to `.train()`
            for (var k in item) {
                var v = item[k];
                for (category in data) {
                    // Create an empty object for storing key - value combinations
                    // for this category.
                    if (odds[category] === undefined) odds[category] = {};

                    // If this item doesn't even have a property, it counts for nothing,
                    // but if it does have the property that we're looking for from
                    // the item to categorize, it counts based on how popular it is
                    // versus the whole population.
                    if (data[category][k]) {
                        odds[category][k + '_' + v] = (data[category][k][v] || 0) / total_count;
                    } else {
                        odds[category][k + '_' + v] = 0;
                    }
                }
            }

            // Set up a new object that will contain sums of these odds by category
            var odds_sums = {};

            for (category in odds) {
                // Tally all of the odds for each category-combination pair -
                // the non-existence of a category does not add anything to the
                // score.
                for (var combination in odds[category]) {
                    if (odds_sums[category] === undefined) odds_sums[category] = 0;
                    odds_sums[category] += odds[category][combination];
                }
            }

            return odds_sums;
        };

        // Return the completed model.
        return bayes_model;
    }

    // # sum
    //
    // is simply the result of adding all numbers
    // together, starting from zero.
    //
    // This runs on `O(n)`, linear time in respect to the array
    function sum(x) {
        var value = 0;
        for (var i = 0; i < x.length; i++) {
            value += x[i];
        }
        return value;
    }

    // # mean
    //
    // is the sum over the number of values
    //
    // This runs on `O(n)`, linear time in respect to the array
    function mean(x) {
        // The mean of no numbers is null
        if (x.length === 0) return null;

        return sum(x) / x.length;
    }

    // # geometric mean
    //
    // a mean function that is more useful for numbers in different
    // ranges.
    //
    // this is the nth root of the input numbers multiplied by each other
    //
    // This runs on `O(n)`, linear time in respect to the array
    function geometric_mean(x) {
        // The mean of no numbers is null
        if (x.length === 0) return null;

        // the starting value.
        var value = 1;

        for (var i = 0; i < x.length; i++) {
            // the geometric mean is only valid for positive numbers
            if (x[i] <= 0) return null;

            // repeatedly multiply the value by each number
            value *= x[i];
        }

        return Math.pow(value, 1 / x.length);
    }


    // # harmonic mean
    //
    // a mean function typically used to find the average of rates
    //
    // this is the reciprocal of the arithmetic mean of the reciprocals
    // of the input numbers
    //
    // This runs on `O(n)`, linear time in respect to the array
    function harmonic_mean(x) {
        // The mean of no numbers is null
        if (x.length === 0) return null;

        var reciprocal_sum = 0;

        for (var i = 0; i < x.length; i++) {
            // the harmonic mean is only valid for positive numbers
            if (x[i] <= 0) return null;

            reciprocal_sum += 1 / x[i];
        }

        // divide n by the the reciprocal sum
        return x.length / reciprocal_sum;
    }

    // root mean square (RMS)
    //
    // a mean function used as a measure of the magnitude of a set
    // of numbers, regardless of their sign
    //
    // this is the square root of the mean of the squares of the 
    // input numbers
    //
    // This runs on `O(n)`, linear time in respect to the array
    function root_mean_square(x) {
        if (x.length === 0) return null;

        var sum_of_squares = 0;
        for (var i = 0; i < x.length; i++) {
            sum_of_squares += Math.pow(x[i], 2);
        }

        return Math.sqrt(sum_of_squares / x.length);
    }

    // # min
    //
    // This is simply the minimum number in the set.
    //
    // This runs on `O(n)`, linear time in respect to the array
    function min(x) {
        var value;
        for (var i = 0; i < x.length; i++) {
            // On the first iteration of this loop, min is
            // undefined and is thus made the minimum element in the array
            if (x[i] < value || value === undefined) value = x[i];
        }
        return value;
    }

    // # max
    //
    // This is simply the maximum number in the set.
    //
    // This runs on `O(n)`, linear time in respect to the array
    function max(x) {
        var value;
        for (var i = 0; i < x.length; i++) {
            // On the first iteration of this loop, max is
            // undefined and is thus made the maximum element in the array
            if (x[i] > value || value === undefined) value = x[i];
        }
        return value;
    }

    // # [variance](http://en.wikipedia.org/wiki/Variance)
    //
    // is the sum of squared deviations from the mean
    //
    // depends on `mean()`
    function variance(x) {
        // The variance of no numbers is null
        if (x.length === 0) return null;

        var mean_value = mean(x),
            deviations = [];

        // Make a list of squared deviations from the mean.
        for (var i = 0; i < x.length; i++) {
            deviations.push(Math.pow(x[i] - mean_value, 2));
        }

        // Find the mean value of that list
        return mean(deviations);
    }

    // # [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)
    //
    // is just the square root of the variance.
    //
    // depends on `variance()`
    function standard_deviation(x) {
        // The standard deviation of no numbers is null
        if (x.length === 0) return null;

        return Math.sqrt(variance(x));
    }

    // The sum of deviations to the Nth power.
    // When n=2 it's the sum of squared deviations.
    // When n=3 it's the sum of cubed deviations.
    //
    // depends on `mean()`
    function sum_nth_power_deviations(x, n) {
        var mean_value = mean(x),
            sum = 0;

        for (var i = 0; i < x.length; i++) {
            sum += Math.pow(x[i] - mean_value, n);
        }

        return sum;
    }

    // # [variance](http://en.wikipedia.org/wiki/Variance)
    //
    // is the sum of squared deviations from the mean
    //
    // depends on `sum_nth_power_deviations`
    function sample_variance(x) {
        // The variance of no numbers is null
        if (x.length <= 1) return null;

        var sum_squared_deviations_value = sum_nth_power_deviations(x, 2);

        // Find the mean value of that list
        return sum_squared_deviations_value / (x.length - 1);
    }

    // # [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)
    //
    // is just the square root of the variance.
    //
    // depends on `sample_variance()`
    function sample_standard_deviation(x) {
        // The standard deviation of no numbers is null
        if (x.length <= 1) return null;

        return Math.sqrt(sample_variance(x));
    }

    // # [covariance](http://en.wikipedia.org/wiki/Covariance)
    //
    // sample covariance of two datasets:
    // how much do the two datasets move together?
    // x and y are two datasets, represented as arrays of numbers.
    //
    // depends on `mean()`
    function sample_covariance(x, y) {

        // The two datasets must have the same length which must be more than 1
        if (x.length <= 1 || x.length != y.length){
            return null;
        }

        // determine the mean of each dataset so that we can judge each
        // value of the dataset fairly as the difference from the mean. this
        // way, if one dataset is [1, 2, 3] and [2, 3, 4], their covariance
        // does not suffer because of the difference in absolute values
        var xmean = mean(x),
            ymean = mean(y),
            sum = 0;

        // for each pair of values, the covariance increases when their
        // difference from the mean is associated - if both are well above
        // or if both are well below
        // the mean, the covariance increases significantly.
        for (var i = 0; i < x.length; i++){
            sum += (x[i] - xmean) * (y[i] - ymean);
        }

        // the covariance is weighted by the length of the datasets.
        return sum / (x.length - 1);
    }

    // # [correlation](http://en.wikipedia.org/wiki/Correlation_and_dependence)
    //
    // Gets a measure of how correlated two datasets are, between -1 and 1
    //
    // depends on `sample_standard_deviation()` and `sample_covariance()`
    function sample_correlation(x, y) {
        var cov = sample_covariance(x, y),
            xstd = sample_standard_deviation(x),
            ystd = sample_standard_deviation(y);

        if (cov === null || xstd === null || ystd === null) {
            return null;
        }

        return cov / xstd / ystd;
    }

    // # [median](http://en.wikipedia.org/wiki/Median)
    //
    // The middle number of a list. This is often a good indicator of 'the middle'
    // when there are outliers that skew the `mean()` value.
    function median(x) {
        // The median of an empty list is null
        if (x.length === 0) return null;

        // Sorting the array makes it easy to find the center, but
        // use `.slice()` to ensure the original array `x` is not modified
        var sorted = x.slice().sort(function (a, b) { return a - b; });

        // If the length of the list is odd, it's the central number
        if (sorted.length % 2 === 1) {
            return sorted[(sorted.length - 1) / 2];
        // Otherwise, the median is the average of the two numbers
        // at the center of the list
        } else {
            var a = sorted[(sorted.length / 2) - 1];
            var b = sorted[(sorted.length / 2)];
            return (a + b) / 2;
        }
    }

    // # [mode](http://bit.ly/W5K4Yt)
    //
    // The mode is the number that appears in a list the highest number of times.
    // There can be multiple modes in a list: in the event of a tie, this
    // algorithm will return the most recently seen mode.
    //
    // This implementation is inspired by [science.js](https://github.com/jasondavies/science.js/blob/master/src/stats/mode.js)
    //
    // This runs on `O(n)`, linear time in respect to the array
    function mode(x) {

        // Handle edge cases:
        // The median of an empty list is null
        if (x.length === 0) return null;
        else if (x.length === 1) return x[0];

        // Sorting the array lets us iterate through it below and be sure
        // that every time we see a new number it's new and we'll never
        // see the same number twice
        var sorted = x.slice().sort(function (a, b) { return a - b; });

        // This assumes it is dealing with an array of size > 1, since size
        // 0 and 1 are handled immediately. Hence it starts at index 1 in the
        // array.
        var last = sorted[0],
            // store the mode as we find new modes
            value,
            // store how many times we've seen the mode
            max_seen = 0,
            // how many times the current candidate for the mode
            // has been seen
            seen_this = 1;

        // end at sorted.length + 1 to fix the case in which the mode is
        // the highest number that occurs in the sequence. the last iteration
        // compares sorted[i], which is undefined, to the highest number
        // in the series
        for (var i = 1; i < sorted.length + 1; i++) {
            // we're seeing a new number pass by
            if (sorted[i] !== last) {
                // the last number is the new mode since we saw it more
                // often than the old one
                if (seen_this > max_seen) {
                    max_seen = seen_this;
                    value = last;
                }
                seen_this = 1;
                last = sorted[i];
            // if this isn't a new number, it's one more occurrence of
            // the potential mode
            } else { seen_this++; }
        }
        return value;
    }

    // # [t-test](http://en.wikipedia.org/wiki/Student's_t-test)
    //
    // This is to compute a one-sample t-test, comparing the mean
    // of a sample to a known value, x.
    //
    // in this case, we're trying to determine whether the
    // population mean is equal to the value that we know, which is `x`
    // here. usually the results here are used to look up a
    // [p-value](http://en.wikipedia.org/wiki/P-value), which, for
    // a certain level of significance, will let you determine that the
    // null hypothesis can or cannot be rejected.
    //
    // Depends on `standard_deviation()` and `mean()`
    function t_test(sample, x) {
        // The mean of the sample
        var sample_mean = mean(sample);

        // The standard deviation of the sample
        var sd = standard_deviation(sample);

        // Square root the length of the sample
        var rootN = Math.sqrt(sample.length);

        // Compute the known value against the sample,
        // returning the t value
        return (sample_mean - x) / (sd / rootN);
    }

    // # [2-sample t-test](http://en.wikipedia.org/wiki/Student's_t-test)
    //
    // This is to compute two sample t-test.
    // Tests whether "mean(X)-mean(Y) = difference", (
    // in the most common case, we often have `difference == 0` to test if two samples
    // are likely to be taken from populations with the same mean value) with
    // no prior knowledge on standard deviations of both samples
    // other than the fact that they have the same standard deviation.
    //
    // Usually the results here are used to look up a
    // [p-value](http://en.wikipedia.org/wiki/P-value), which, for
    // a certain level of significance, will let you determine that the
    // null hypothesis can or cannot be rejected.
    //
    // `diff` can be omitted if it equals 0.
    //
    // [This is used to confirm or deny](http://www.monarchlab.org/Lab/Research/Stats/2SampleT.aspx)
    // a null hypothesis that the two populations that have been sampled into
    // `sample_x` and `sample_y` are equal to each other.
    //
    // Depends on `sample_variance()` and `mean()`
    function t_test_two_sample(sample_x, sample_y, difference) {
        var n = sample_x.length,
            m = sample_y.length;

        // If either sample doesn't actually have any values, we can't
        // compute this at all, so we return `null`.
        if (!n || !m) return null ;

        // default difference (mu) is zero
        if (!difference) difference = 0;

        var meanX = mean(sample_x),
            meanY = mean(sample_y);

        var weightedVariance = ((n - 1) * sample_variance(sample_x) +
            (m - 1) * sample_variance(sample_y)) / (n + m - 2);

        return (meanX - meanY - difference) /
            Math.sqrt(weightedVariance * (1 / n + 1 / m));
    }

    // # chunk
    //
    // Split an array into chunks of a specified size. This function
    // has the same behavior as [PHP's array_chunk](http://php.net/manual/en/function.array-chunk.php)
    // function, and thus will insert smaller-sized chunks at the end if
    // the input size is not divisible by the chunk size.
    //
    // `sample` is expected to be an array, and `chunkSize` a number.
    // The `sample` array can contain any kind of data.
    function chunk(sample, chunkSize) {

        // a list of result chunks, as arrays in an array
        var output = [];

        // `chunkSize` must be zero or higher - otherwise the loop below,
        // in which we call `start += chunkSize`, will loop infinitely.
        // So, we'll detect and return null in that case to indicate
        // invalid input.
        if (chunkSize <= 0) {
            return null;
        }

        // `start` is the index at which `.slice` will start selecting
        // new array elements
        for (var start = 0; start < sample.length; start += chunkSize) {

            // for each chunk, slice that part of the array and add it
            // to the output. The `.slice` function does not change
            // the original array.
            output.push(sample.slice(start, start + chunkSize));
        }
        return output;
    }

    // # shuffle_in_place
    //
    // A [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)
    // in-place - which means that it will change the order of the original
    // array by reference.
    function shuffle_in_place(sample, randomSource) {

        // a custom random number source can be provided if you want to use
        // a fixed seed or another random number generator, like
        // [random-js](https://www.npmjs.org/package/random-js)
        randomSource = randomSource || Math.random;

        // store the current length of the sample to determine
        // when no elements remain to shuffle.
        var length = sample.length;

        // temporary is used to hold an item when it is being
        // swapped between indices.
        var temporary;

        // The index to swap at each stage.
        var index;

        // While there are still items to shuffle
        while (length > 0) {
            // chose a random index within the subset of the array
            // that is not yet shuffled
            index = Math.floor(randomSource() * length--);

            // store the value that we'll move temporarily
            temporary = sample[length];

            // swap the value at `sample[length]` with `sample[index]`
            sample[length] = sample[index];
            sample[index] = temporary;
        }

        return sample;
    }

    // # shuffle
    //
    // A [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)
    // is a fast way to create a random permutation of a finite set.
    function shuffle(sample, randomSource) {
        // slice the original array so that it is not modified
        sample = sample.slice();

        // and then shuffle that shallow-copied array, in place
        return shuffle_in_place(sample.slice(), randomSource);
    }

    // # sample
    //
    // Create a [simple random sample](http://en.wikipedia.org/wiki/Simple_random_sample)
    // from a given array of `n` elements.
    function sample(array, n, randomSource) {
        // shuffle the original array using a fisher-yates shuffle
        var shuffled = shuffle(array, randomSource);

        // and then return a subset of it - the first `n` elements.
        return shuffled.slice(0, n);
    }

    // # quantile
    //
    // This is a population quantile, since we assume to know the entire
    // dataset in this library. Thus I'm trying to follow the
    // [Quantiles of a Population](http://en.wikipedia.org/wiki/Quantile#Quantiles_of_a_population)
    // algorithm from wikipedia.
    //
    // Sample is a one-dimensional array of numbers,
    // and p is either a decimal number from 0 to 1 or an array of decimal
    // numbers from 0 to 1.
    // In terms of a k/q quantile, p = k/q - it's just dealing with fractions or dealing
    // with decimal values.
    // When p is an array, the result of the function is also an array containing the appropriate
    // quantiles in input order
    function quantile(sample, p) {

        // We can't derive quantiles from an empty list
        if (sample.length === 0) return null;

        // Sort a copy of the array. We'll need a sorted array to index
        // the values in sorted order.
        var sorted = sample.slice().sort(function (a, b) { return a - b; });

        if (p.length) {
            // Initialize the result array
            var results = [];
            // For each requested quantile
            for (var i = 0; i < p.length; i++) {
                results[i] = quantile_sorted(sorted, p[i]);
            }
            return results;
        } else {
            return quantile_sorted(sorted, p);
        }
    }

    // # quantile
    //
    // This is the internal implementation of quantiles: when you know
    // that the order is sorted, you don't need to re-sort it, and the computations
    // are much faster.
    function quantile_sorted(sample, p) {
        var idx = (sample.length) * p;
        if (p < 0 || p > 1) {
            return null;
        } else if (p === 1) {
            // If p is 1, directly return the last element
            return sample[sample.length - 1];
        } else if (p === 0) {
            // If p is 0, directly return the first element
            return sample[0];
        } else if (idx % 1 !== 0) {
            // If p is not integer, return the next element in array
            return sample[Math.ceil(idx) - 1];
        } else if (sample.length % 2 === 0) {
            // If the list has even-length, we'll take the average of this number
            // and the next value, if there is one
            return (sample[idx - 1] + sample[idx]) / 2;
        } else {
            // Finally, in the simple case of an integer value
            // with an odd-length list, return the sample value at the index.
            return sample[idx];
        }
    }

    // # [Interquartile range](http://en.wikipedia.org/wiki/Interquartile_range)
    //
    // A measure of statistical dispersion, or how scattered, spread, or
    // concentrated a distribution is. It's computed as the difference between
    // the third quartile and first quartile.
    function iqr(sample) {
        // We can't derive quantiles from an empty list
        if (sample.length === 0) return null;

        // Interquartile range is the span between the upper quartile,
        // at `0.75`, and lower quartile, `0.25`
        return quantile(sample, 0.75) - quantile(sample, 0.25);
    }

    // # [Median Absolute Deviation](http://en.wikipedia.org/wiki/Median_absolute_deviation)
    //
    // The Median Absolute Deviation (MAD) is a robust measure of statistical
    // dispersion. It is more resilient to outliers than the standard deviation.
    function mad(x) {
        // The mad of nothing is null
        if (!x || x.length === 0) return null;

        var median_value = median(x),
            median_absolute_deviations = [];

        // Make a list of absolute deviations from the median
        for (var i = 0; i < x.length; i++) {
            median_absolute_deviations.push(Math.abs(x[i] - median_value));
        }

        // Find the median value of that list
        return median(median_absolute_deviations);
    }

    // ## Compute Matrices for Jenks
    //
    // Compute the matrices required for Jenks breaks. These matrices
    // can be used for any classing of data with `classes <= n_classes`
    function jenksMatrices(data, n_classes) {

        // in the original implementation, these matrices are referred to
        // as `LC` and `OP`
        //
        // * lower_class_limits (LC): optimal lower class limits
        // * variance_combinations (OP): optimal variance combinations for all classes
        var lower_class_limits = [],
            variance_combinations = [],
            // loop counters
            i, j,
            // the variance, as computed at each step in the calculation
            variance = 0;

        // Initialize and fill each matrix with zeroes
        for (i = 0; i < data.length + 1; i++) {
            var tmp1 = [], tmp2 = [];
            // despite these arrays having the same values, we need
            // to keep them separate so that changing one does not change
            // the other
            for (j = 0; j < n_classes + 1; j++) {
                tmp1.push(0);
                tmp2.push(0);
            }
            lower_class_limits.push(tmp1);
            variance_combinations.push(tmp2);
        }

        for (i = 1; i < n_classes + 1; i++) {
            lower_class_limits[1][i] = 1;
            variance_combinations[1][i] = 0;
            // in the original implementation, 9999999 is used but
            // since Javascript has `Infinity`, we use that.
            for (j = 2; j < data.length + 1; j++) {
                variance_combinations[j][i] = Infinity;
            }
        }

        for (var l = 2; l < data.length + 1; l++) {

            // `SZ` originally. this is the sum of the values seen thus
            // far when calculating variance.
            var sum = 0,
                // `ZSQ` originally. the sum of squares of values seen
                // thus far
                sum_squares = 0,
                // `WT` originally. This is the number of
                w = 0,
                // `IV` originally
                i4 = 0;

            // in several instances, you could say `Math.pow(x, 2)`
            // instead of `x * x`, but this is slower in some browsers
            // introduces an unnecessary concept.
            for (var m = 1; m < l + 1; m++) {

                // `III` originally
                var lower_class_limit = l - m + 1,
                    val = data[lower_class_limit - 1];

                // here we're estimating variance for each potential classing
                // of the data, for each potential number of classes. `w`
                // is the number of data points considered so far.
                w++;

                // increase the current sum and sum-of-squares
                sum += val;
                sum_squares += val * val;

                // the variance at this point in the sequence is the difference
                // between the sum of squares and the total x 2, over the number
                // of samples.
                variance = sum_squares - (sum * sum) / w;

                i4 = lower_class_limit - 1;

                if (i4 !== 0) {
                    for (j = 2; j < n_classes + 1; j++) {
                        // if adding this element to an existing class
                        // will increase its variance beyond the limit, break
                        // the class at this point, setting the `lower_class_limit`
                        // at this point.
                        if (variance_combinations[l][j] >=
                            (variance + variance_combinations[i4][j - 1])) {
                            lower_class_limits[l][j] = lower_class_limit;
                            variance_combinations[l][j] = variance +
                                variance_combinations[i4][j - 1];
                        }
                    }
                }
            }

            lower_class_limits[l][1] = 1;
            variance_combinations[l][1] = variance;
        }

        // return the two matrices. for just providing breaks, only
        // `lower_class_limits` is needed, but variances can be useful to
        // evaluate goodness of fit.
        return {
            lower_class_limits: lower_class_limits,
            variance_combinations: variance_combinations
        };
    }

    // ## Pull Breaks Values for Jenks
    //
    // the second part of the jenks recipe: take the calculated matrices
    // and derive an array of n breaks.
    function jenksBreaks(data, lower_class_limits, n_classes) {

        var k = data.length,
            kclass = [],
            countNum = n_classes;

        // the calculation of classes will never include the upper
        // bound, so we need to explicitly set it
        kclass[n_classes] = data[data.length - 1];

        // the lower_class_limits matrix is used as indices into itself
        // here: the `k` variable is reused in each iteration.
        while (countNum > 0) {
            kclass[countNum - 1] = data[lower_class_limits[k][countNum] - 1];
            k = lower_class_limits[k][countNum] - 1;
            countNum--;
        }

        return kclass;
    }

    // # [Jenks natural breaks optimization](http://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization)
    //
    // Implementations: [1](http://danieljlewis.org/files/2010/06/Jenks.pdf) (python),
    // [2](https://github.com/vvoovv/djeo-jenks/blob/master/main.js) (buggy),
    // [3](https://github.com/simogeo/geostats/blob/master/lib/geostats.js#L407) (works)
    //
    // Depends on `jenksBreaks()` and `jenksMatrices()`
    function jenks(data, n_classes) {

        if (n_classes > data.length) return null;

        // sort data in numerical order, since this is expected
        // by the matrices function
        data = data.slice().sort(function (a, b) { return a - b; });

        // get our basic matrices
        var matrices = jenksMatrices(data, n_classes),
            // we only need lower class limits here
            lower_class_limits = matrices.lower_class_limits;

        // extract n_classes out of the computed matrices
        return jenksBreaks(data, lower_class_limits, n_classes);

    }

    // # [Skewness](http://en.wikipedia.org/wiki/Skewness)
    //
    // A measure of the extent to which a probability distribution of a
    // real-valued random variable "leans" to one side of the mean.
    // The skewness value can be positive or negative, or even undefined.
    //
    // Implementation is based on the adjusted Fisher-Pearson standardized
    // moment coefficient, which is the version found in Excel and several
    // statistical packages including Minitab, SAS and SPSS.
    //
    // Depends on `sum_nth_power_deviations()` and `sample_standard_deviation`
    function sample_skewness(x) {
        // The skewness of less than three arguments is null
        if (x.length < 3) return null;

        var n = x.length,
            cubed_s = Math.pow(sample_standard_deviation(x), 3),
            sum_cubed_deviations = sum_nth_power_deviations(x, 3);

        return n * sum_cubed_deviations / ((n - 1) * (n - 2) * cubed_s);
    }

    // # Standard Normal Table
    // A standard normal table, also called the unit normal table or Z table,
    // is a mathematical table for the values of Φ (phi), which are the values of
    // the cumulative distribution function of the normal distribution.
    // It is used to find the probability that a statistic is observed below,
    // above, or between values on the standard normal distribution, and by
    // extension, any normal distribution.
    //
    // The probabilities are taken from http://en.wikipedia.org/wiki/Standard_normal_table
    // The table used is the cumulative, and not cumulative from 0 to mean
    // (even though the latter has 5 digits precision, instead of 4).
    var standard_normal_table = [
        /*  z      0.00    0.01    0.02    0.03    0.04    0.05    0.06    0.07    0.08    0.09 */
        /* 0.0 */
        0.5000, 0.5040, 0.5080, 0.5120, 0.5160, 0.5199, 0.5239, 0.5279, 0.5319, 0.5359,
        /* 0.1 */
        0.5398, 0.5438, 0.5478, 0.5517, 0.5557, 0.5596, 0.5636, 0.5675, 0.5714, 0.5753,
        /* 0.2 */
        0.5793, 0.5832, 0.5871, 0.5910, 0.5948, 0.5987, 0.6026, 0.6064, 0.6103, 0.6141,
        /* 0.3 */
        0.6179, 0.6217, 0.6255, 0.6293, 0.6331, 0.6368, 0.6406, 0.6443, 0.6480, 0.6517,
        /* 0.4 */
        0.6554, 0.6591, 0.6628, 0.6664, 0.6700, 0.6736, 0.6772, 0.6808, 0.6844, 0.6879,
        /* 0.5 */
        0.6915, 0.6950, 0.6985, 0.7019, 0.7054, 0.7088, 0.7123, 0.7157, 0.7190, 0.7224,
        /* 0.6 */
        0.7257, 0.7291, 0.7324, 0.7357, 0.7389, 0.7422, 0.7454, 0.7486, 0.7517, 0.7549,
        /* 0.7 */
        0.7580, 0.7611, 0.7642, 0.7673, 0.7704, 0.7734, 0.7764, 0.7794, 0.7823, 0.7852,
        /* 0.8 */
        0.7881, 0.7910, 0.7939, 0.7967, 0.7995, 0.8023, 0.8051, 0.8078, 0.8106, 0.8133,
        /* 0.9 */
        0.8159, 0.8186, 0.8212, 0.8238, 0.8264, 0.8289, 0.8315, 0.8340, 0.8365, 0.8389,
        /* 1.0 */
        0.8413, 0.8438, 0.8461, 0.8485, 0.8508, 0.8531, 0.8554, 0.8577, 0.8599, 0.8621,
        /* 1.1 */
        0.8643, 0.8665, 0.8686, 0.8708, 0.8729, 0.8749, 0.8770, 0.8790, 0.8810, 0.8830,
        /* 1.2 */
        0.8849, 0.8869, 0.8888, 0.8907, 0.8925, 0.8944, 0.8962, 0.8980, 0.8997, 0.9015,
        /* 1.3 */
        0.9032, 0.9049, 0.9066, 0.9082, 0.9099, 0.9115, 0.9131, 0.9147, 0.9162, 0.9177,
        /* 1.4 */
        0.9192, 0.9207, 0.9222, 0.9236, 0.9251, 0.9265, 0.9279, 0.9292, 0.9306, 0.9319,
        /* 1.5 */
        0.9332, 0.9345, 0.9357, 0.9370, 0.9382, 0.9394, 0.9406, 0.9418, 0.9429, 0.9441,
        /* 1.6 */
        0.9452, 0.9463, 0.9474, 0.9484, 0.9495, 0.9505, 0.9515, 0.9525, 0.9535, 0.9545,
        /* 1.7 */
        0.9554, 0.9564, 0.9573, 0.9582, 0.9591, 0.9599, 0.9608, 0.9616, 0.9625, 0.9633,
        /* 1.8 */
        0.9641, 0.9649, 0.9656, 0.9664, 0.9671, 0.9678, 0.9686, 0.9693, 0.9699, 0.9706,
        /* 1.9 */
        0.9713, 0.9719, 0.9726, 0.9732, 0.9738, 0.9744, 0.9750, 0.9756, 0.9761, 0.9767,
        /* 2.0 */
        0.9772, 0.9778, 0.9783, 0.9788, 0.9793, 0.9798, 0.9803, 0.9808, 0.9812, 0.9817,
        /* 2.1 */
        0.9821, 0.9826, 0.9830, 0.9834, 0.9838, 0.9842, 0.9846, 0.9850, 0.9854, 0.9857,
        /* 2.2 */
        0.9861, 0.9864, 0.9868, 0.9871, 0.9875, 0.9878, 0.9881, 0.9884, 0.9887, 0.9890,
        /* 2.3 */
        0.9893, 0.9896, 0.9898, 0.9901, 0.9904, 0.9906, 0.9909, 0.9911, 0.9913, 0.9916,
        /* 2.4 */
        0.9918, 0.9920, 0.9922, 0.9925, 0.9927, 0.9929, 0.9931, 0.9932, 0.9934, 0.9936,
        /* 2.5 */
        0.9938, 0.9940, 0.9941, 0.9943, 0.9945, 0.9946, 0.9948, 0.9949, 0.9951, 0.9952,
        /* 2.6 */
        0.9953, 0.9955, 0.9956, 0.9957, 0.9959, 0.9960, 0.9961, 0.9962, 0.9963, 0.9964,
        /* 2.7 */
        0.9965, 0.9966, 0.9967, 0.9968, 0.9969, 0.9970, 0.9971, 0.9972, 0.9973, 0.9974,
        /* 2.8 */
        0.9974, 0.9975, 0.9976, 0.9977, 0.9977, 0.9978, 0.9979, 0.9979, 0.9980, 0.9981,
        /* 2.9 */
        0.9981, 0.9982, 0.9982, 0.9983, 0.9984, 0.9984, 0.9985, 0.9985, 0.9986, 0.9986,
        /* 3.0 */
        0.9987, 0.9987, 0.9987, 0.9988, 0.9988, 0.9989, 0.9989, 0.9989, 0.9990, 0.9990
    ];

    // # [Gaussian error function](http://en.wikipedia.org/wiki/Error_function)
    //
    // The error_function(x/(sd * Math.sqrt(2))) is the probability that a value in a
    // normal distribution with standard deviation sd is within x of the mean.
    //
    // This function returns a numerical approximation to the exact value.
    function error_function(x) {
        var t = 1 / (1 + 0.5 * Math.abs(x));
        var tau = t * Math.exp(-Math.pow(x, 2) -
            1.26551223 +
            1.00002368 * t +
            0.37409196 * Math.pow(t, 2) +
            0.09678418 * Math.pow(t, 3) -
            0.18628806 * Math.pow(t, 4) +
            0.27886807 * Math.pow(t, 5) -
            1.13520398 * Math.pow(t, 6) +
            1.48851587 * Math.pow(t, 7) -
            0.82215223 * Math.pow(t, 8) +
            0.17087277 * Math.pow(t, 9));
        if (x >= 0) {
            return 1 - tau;
        } else {
            return tau - 1;
        }
    }

    // # [Cumulative Standard Normal Probability](http://en.wikipedia.org/wiki/Standard_normal_table)
    //
    // Since probability tables cannot be
    // printed for every normal distribution, as there are an infinite variety
    // of normal distributions, it is common practice to convert a normal to a
    // standard normal and then use the standard normal table to find probabilities.
    //
    // You can use .5 + .5 * error_function(x / Math.sqrt(2)) to calculate the probability
    // instead of looking it up in a table.
    function cumulative_std_normal_probability(z) {

        // Calculate the position of this value.
        var absZ = Math.abs(z),
            // Each row begins with a different
            // significant digit: 0.5, 0.6, 0.7, and so on. Each value in the table
            // corresponds to a range of 0.01 in the input values, so the value is
            // multiplied by 100.
            index = Math.min(Math.round(absZ * 100), standard_normal_table.length - 1);

        // The index we calculate must be in the table as a positive value,
        // but we still pay attention to whether the input is positive
        // or negative, and flip the output value as a last step.
        if (z >= 0) {
            return standard_normal_table[index];
        } else {
            // due to floating-point arithmetic, values in the table with
            // 4 significant figures can nevertheless end up as repeating
            // fractions when they're computed here.
            return +(1 - standard_normal_table[index]).toFixed(4);
        }
    }

    // # [Z-Score, or Standard Score](http://en.wikipedia.org/wiki/Standard_score)
    //
    // The standard score is the number of standard deviations an observation
    // or datum is above or below the mean. Thus, a positive standard score
    // represents a datum above the mean, while a negative standard score
    // represents a datum below the mean. It is a dimensionless quantity
    // obtained by subtracting the population mean from an individual raw
    // score and then dividing the difference by the population standard
    // deviation.
    //
    // The z-score is only defined if one knows the population parameters;
    // if one only has a sample set, then the analogous computation with
    // sample mean and sample standard deviation yields the
    // Student's t-statistic.
    function z_score(x, mean, standard_deviation) {
        return (x - mean) / standard_deviation;
    }

    // We use `ε`, epsilon, as a stopping criterion when we want to iterate
    // until we're "close enough".
    var epsilon = 0.0001;

    // # [Factorial](https://en.wikipedia.org/wiki/Factorial)
    //
    // A factorial, usually written n!, is the product of all positive
    // integers less than or equal to n. Often factorial is implemented
    // recursively, but this iterative approach is significantly faster
    // and simpler.
    function factorial(n) {

        // factorial is mathematically undefined for negative numbers
        if (n < 0 ) { return null; }

        // typically you'll expand the factorial function going down, like
        // 5! = 5 * 4 * 3 * 2 * 1. This is going in the opposite direction,
        // counting from 2 up to the number in question, and since anything
        // multiplied by 1 is itself, the loop only needs to start at 2.
        var accumulator = 1;
        for (var i = 2; i <= n; i++) {
            // for each number up to and including the number `n`, multiply
            // the accumulator my that number.
            accumulator *= i;
        }
        return accumulator;
    }

    // # Bernoulli Distribution
    //
    // The [Bernoulli distribution](http://en.wikipedia.org/wiki/Bernoulli_distribution)
    // is the probability discrete
    // distribution of a random variable which takes value 1 with success
    // probability `p` and value 0 with failure
    // probability `q` = 1 - `p`. It can be used, for example, to represent the
    // toss of a coin, where "1" is defined to mean "heads" and "0" is defined
    // to mean "tails" (or vice versa). It is
    // a special case of a Binomial Distribution
    // where `n` = 1.
    function bernoulli_distribution(p) {
        // Check that `p` is a valid probability (0 ≤ p ≤ 1)
        if (p < 0 || p > 1 ) { return null; }

        return binomial_distribution(1, p);
    }

    // # Binomial Distribution
    //
    // The [Binomial Distribution](http://en.wikipedia.org/wiki/Binomial_distribution) is the discrete probability
    // distribution of the number of successes in a sequence of n independent yes/no experiments, each of which yields
    // success with probability `probability`. Such a success/failure experiment is also called a Bernoulli experiment or
    // Bernoulli trial; when trials = 1, the Binomial Distribution is a Bernoulli Distribution.
    function binomial_distribution(trials, probability) {
        // Check that `p` is a valid probability (0 ≤ p ≤ 1),
        // that `n` is an integer, strictly positive.
        if (probability < 0 || probability > 1 ||
            trials <= 0 || trials % 1 !== 0) {
            return null;
        }

        // a [probability mass function](https://en.wikipedia.org/wiki/Probability_mass_function)
        function probability_mass(x, trials, probability) {
            return factorial(trials) /
                (factorial(x) * factorial(trials - x)) *
                (Math.pow(probability, x) * Math.pow(1 - probability, trials - x));
        }

        // We initialize `x`, the random variable, and `accumulator`, an accumulator
        // for the cumulative distribution function to 0. `distribution_functions`
        // is the object we'll return with the `probability_of_x` and the
        // `cumulative_probability_of_x`, as well as the calculated mean &
        // variance. We iterate until the `cumulative_probability_of_x` is
        // within `epsilon` of 1.0.
        var x = 0,
            cumulative_probability = 0,
            cells = {};

        // This algorithm iterates through each potential outcome,
        // until the `cumulative_probability` is very close to 1, at
        // which point we've defined the vast majority of outcomes
        do {
            cells[x] = probability_mass(x, trials, probability);
            cumulative_probability += cells[x];
            x++;
        // when the cumulative_probability is nearly 1, we've calculated
        // the useful range of this distribution
        } while (cumulative_probability < 1 - epsilon);

        return cells;
    }

    // # Poisson Distribution
    //
    // The [Poisson Distribution](http://en.wikipedia.org/wiki/Poisson_distribution)
    // is a discrete probability distribution that expresses the probability
    // of a given number of events occurring in a fixed interval of time
    // and/or space if these events occur with a known average rate and
    // independently of the time since the last event.
    //
    // The Poisson Distribution is characterized by the strictly positive
    // mean arrival or occurrence rate, `λ`.
    function poisson_distribution(lambda) {
        // Check that lambda is strictly positive
        if (lambda <= 0) { return null; }

        // our current place in the distribution
        var x = 0,
            // and we keep track of the current cumulative probability, in
            // order to know when to stop calculating chances.
            cumulative_probability = 0,
            // the calculated cells to be returned
            cells = {};

        // a [probability mass function](https://en.wikipedia.org/wiki/Probability_mass_function)
        function probability_mass(x, lambda) {
            return (Math.pow(Math.E, -lambda) * Math.pow(lambda, x)) /
                factorial(x);
        }

        // This algorithm iterates through each potential outcome,
        // until the `cumulative_probability` is very close to 1, at
        // which point we've defined the vast majority of outcomes
        do {
            cells[x] = probability_mass(x, lambda);
            cumulative_probability += cells[x];
            x++;
        // when the cumulative_probability is nearly 1, we've calculated
        // the useful range of this distribution
        } while (cumulative_probability < 1 - epsilon);

        return cells;
    }

    // # Percentage Points of the χ2 (Chi-Squared) Distribution
    // The [χ2 (Chi-Squared) Distribution](http://en.wikipedia.org/wiki/Chi-squared_distribution) is used in the common
    // chi-squared tests for goodness of fit of an observed distribution to a theoretical one, the independence of two
    // criteria of classification of qualitative data, and in confidence interval estimation for a population standard
    // deviation of a normal distribution from a sample standard deviation.
    //
    // Values from Appendix 1, Table III of William W. Hines & Douglas C. Montgomery, "Probability and Statistics in
    // Engineering and Management Science", Wiley (1980).
    var chi_squared_distribution_table = {
        1: { 0.995:  0.00, 0.99:  0.00, 0.975:  0.00, 0.95:  0.00, 0.9:  0.02, 0.5:  0.45, 0.1:  2.71, 0.05:  3.84, 0.025:  5.02, 0.01:  6.63, 0.005:  7.88 },
        2: { 0.995:  0.01, 0.99:  0.02, 0.975:  0.05, 0.95:  0.10, 0.9:  0.21, 0.5:  1.39, 0.1:  4.61, 0.05:  5.99, 0.025:  7.38, 0.01:  9.21, 0.005: 10.60 },
        3: { 0.995:  0.07, 0.99:  0.11, 0.975:  0.22, 0.95:  0.35, 0.9:  0.58, 0.5:  2.37, 0.1:  6.25, 0.05:  7.81, 0.025:  9.35, 0.01: 11.34, 0.005: 12.84 },
        4: { 0.995:  0.21, 0.99:  0.30, 0.975:  0.48, 0.95:  0.71, 0.9:  1.06, 0.5:  3.36, 0.1:  7.78, 0.05:  9.49, 0.025: 11.14, 0.01: 13.28, 0.005: 14.86 },
        5: { 0.995:  0.41, 0.99:  0.55, 0.975:  0.83, 0.95:  1.15, 0.9:  1.61, 0.5:  4.35, 0.1:  9.24, 0.05: 11.07, 0.025: 12.83, 0.01: 15.09, 0.005: 16.75 },
        6: { 0.995:  0.68, 0.99:  0.87, 0.975:  1.24, 0.95:  1.64, 0.9:  2.20, 0.5:  5.35, 0.1: 10.65, 0.05: 12.59, 0.025: 14.45, 0.01: 16.81, 0.005: 18.55 },
        7: { 0.995:  0.99, 0.99:  1.25, 0.975:  1.69, 0.95:  2.17, 0.9:  2.83, 0.5:  6.35, 0.1: 12.02, 0.05: 14.07, 0.025: 16.01, 0.01: 18.48, 0.005: 20.28 },
        8: { 0.995:  1.34, 0.99:  1.65, 0.975:  2.18, 0.95:  2.73, 0.9:  3.49, 0.5:  7.34, 0.1: 13.36, 0.05: 15.51, 0.025: 17.53, 0.01: 20.09, 0.005: 21.96 },
        9: { 0.995:  1.73, 0.99:  2.09, 0.975:  2.70, 0.95:  3.33, 0.9:  4.17, 0.5:  8.34, 0.1: 14.68, 0.05: 16.92, 0.025: 19.02, 0.01: 21.67, 0.005: 23.59 },
        10: { 0.995:  2.16, 0.99:  2.56, 0.975:  3.25, 0.95:  3.94, 0.9:  4.87, 0.5:  9.34, 0.1: 15.99, 0.05: 18.31, 0.025: 20.48, 0.01: 23.21, 0.005: 25.19 },
        11: { 0.995:  2.60, 0.99:  3.05, 0.975:  3.82, 0.95:  4.57, 0.9:  5.58, 0.5: 10.34, 0.1: 17.28, 0.05: 19.68, 0.025: 21.92, 0.01: 24.72, 0.005: 26.76 },
        12: { 0.995:  3.07, 0.99:  3.57, 0.975:  4.40, 0.95:  5.23, 0.9:  6.30, 0.5: 11.34, 0.1: 18.55, 0.05: 21.03, 0.025: 23.34, 0.01: 26.22, 0.005: 28.30 },
        13: { 0.995:  3.57, 0.99:  4.11, 0.975:  5.01, 0.95:  5.89, 0.9:  7.04, 0.5: 12.34, 0.1: 19.81, 0.05: 22.36, 0.025: 24.74, 0.01: 27.69, 0.005: 29.82 },
        14: { 0.995:  4.07, 0.99:  4.66, 0.975:  5.63, 0.95:  6.57, 0.9:  7.79, 0.5: 13.34, 0.1: 21.06, 0.05: 23.68, 0.025: 26.12, 0.01: 29.14, 0.005: 31.32 },
        15: { 0.995:  4.60, 0.99:  5.23, 0.975:  6.27, 0.95:  7.26, 0.9:  8.55, 0.5: 14.34, 0.1: 22.31, 0.05: 25.00, 0.025: 27.49, 0.01: 30.58, 0.005: 32.80 },
        16: { 0.995:  5.14, 0.99:  5.81, 0.975:  6.91, 0.95:  7.96, 0.9:  9.31, 0.5: 15.34, 0.1: 23.54, 0.05: 26.30, 0.025: 28.85, 0.01: 32.00, 0.005: 34.27 },
        17: { 0.995:  5.70, 0.99:  6.41, 0.975:  7.56, 0.95:  8.67, 0.9: 10.09, 0.5: 16.34, 0.1: 24.77, 0.05: 27.59, 0.025: 30.19, 0.01: 33.41, 0.005: 35.72 },
        18: { 0.995:  6.26, 0.99:  7.01, 0.975:  8.23, 0.95:  9.39, 0.9: 10.87, 0.5: 17.34, 0.1: 25.99, 0.05: 28.87, 0.025: 31.53, 0.01: 34.81, 0.005: 37.16 },
        19: { 0.995:  6.84, 0.99:  7.63, 0.975:  8.91, 0.95: 10.12, 0.9: 11.65, 0.5: 18.34, 0.1: 27.20, 0.05: 30.14, 0.025: 32.85, 0.01: 36.19, 0.005: 38.58 },
        20: { 0.995:  7.43, 0.99:  8.26, 0.975:  9.59, 0.95: 10.85, 0.9: 12.44, 0.5: 19.34, 0.1: 28.41, 0.05: 31.41, 0.025: 34.17, 0.01: 37.57, 0.005: 40.00 },
        21: { 0.995:  8.03, 0.99:  8.90, 0.975: 10.28, 0.95: 11.59, 0.9: 13.24, 0.5: 20.34, 0.1: 29.62, 0.05: 32.67, 0.025: 35.48, 0.01: 38.93, 0.005: 41.40 },
        22: { 0.995:  8.64, 0.99:  9.54, 0.975: 10.98, 0.95: 12.34, 0.9: 14.04, 0.5: 21.34, 0.1: 30.81, 0.05: 33.92, 0.025: 36.78, 0.01: 40.29, 0.005: 42.80 },
        23: { 0.995:  9.26, 0.99: 10.20, 0.975: 11.69, 0.95: 13.09, 0.9: 14.85, 0.5: 22.34, 0.1: 32.01, 0.05: 35.17, 0.025: 38.08, 0.01: 41.64, 0.005: 44.18 },
        24: { 0.995:  9.89, 0.99: 10.86, 0.975: 12.40, 0.95: 13.85, 0.9: 15.66, 0.5: 23.34, 0.1: 33.20, 0.05: 36.42, 0.025: 39.36, 0.01: 42.98, 0.005: 45.56 },
        25: { 0.995: 10.52, 0.99: 11.52, 0.975: 13.12, 0.95: 14.61, 0.9: 16.47, 0.5: 24.34, 0.1: 34.28, 0.05: 37.65, 0.025: 40.65, 0.01: 44.31, 0.005: 46.93 },
        26: { 0.995: 11.16, 0.99: 12.20, 0.975: 13.84, 0.95: 15.38, 0.9: 17.29, 0.5: 25.34, 0.1: 35.56, 0.05: 38.89, 0.025: 41.92, 0.01: 45.64, 0.005: 48.29 },
        27: { 0.995: 11.81, 0.99: 12.88, 0.975: 14.57, 0.95: 16.15, 0.9: 18.11, 0.5: 26.34, 0.1: 36.74, 0.05: 40.11, 0.025: 43.19, 0.01: 46.96, 0.005: 49.65 },
        28: { 0.995: 12.46, 0.99: 13.57, 0.975: 15.31, 0.95: 16.93, 0.9: 18.94, 0.5: 27.34, 0.1: 37.92, 0.05: 41.34, 0.025: 44.46, 0.01: 48.28, 0.005: 50.99 },
        29: { 0.995: 13.12, 0.99: 14.26, 0.975: 16.05, 0.95: 17.71, 0.9: 19.77, 0.5: 28.34, 0.1: 39.09, 0.05: 42.56, 0.025: 45.72, 0.01: 49.59, 0.005: 52.34 },
        30: { 0.995: 13.79, 0.99: 14.95, 0.975: 16.79, 0.95: 18.49, 0.9: 20.60, 0.5: 29.34, 0.1: 40.26, 0.05: 43.77, 0.025: 46.98, 0.01: 50.89, 0.005: 53.67 },
        40: { 0.995: 20.71, 0.99: 22.16, 0.975: 24.43, 0.95: 26.51, 0.9: 29.05, 0.5: 39.34, 0.1: 51.81, 0.05: 55.76, 0.025: 59.34, 0.01: 63.69, 0.005: 66.77 },
        50: { 0.995: 27.99, 0.99: 29.71, 0.975: 32.36, 0.95: 34.76, 0.9: 37.69, 0.5: 49.33, 0.1: 63.17, 0.05: 67.50, 0.025: 71.42, 0.01: 76.15, 0.005: 79.49 },
        60: { 0.995: 35.53, 0.99: 37.48, 0.975: 40.48, 0.95: 43.19, 0.9: 46.46, 0.5: 59.33, 0.1: 74.40, 0.05: 79.08, 0.025: 83.30, 0.01: 88.38, 0.005: 91.95 },
        70: { 0.995: 43.28, 0.99: 45.44, 0.975: 48.76, 0.95: 51.74, 0.9: 55.33, 0.5: 69.33, 0.1: 85.53, 0.05: 90.53, 0.025: 95.02, 0.01: 100.42, 0.005: 104.22 },
        80: { 0.995: 51.17, 0.99: 53.54, 0.975: 57.15, 0.95: 60.39, 0.9: 64.28, 0.5: 79.33, 0.1: 96.58, 0.05: 101.88, 0.025: 106.63, 0.01: 112.33, 0.005: 116.32 },
        90: { 0.995: 59.20, 0.99: 61.75, 0.975: 65.65, 0.95: 69.13, 0.9: 73.29, 0.5: 89.33, 0.1: 107.57, 0.05: 113.14, 0.025: 118.14, 0.01: 124.12, 0.005: 128.30 },
        100: { 0.995: 67.33, 0.99: 70.06, 0.975: 74.22, 0.95: 77.93, 0.9: 82.36, 0.5: 99.33, 0.1: 118.50, 0.05: 124.34, 0.025: 129.56, 0.01: 135.81, 0.005: 140.17 }
    };

    // # χ2 (Chi-Squared) Goodness-of-Fit Test
    //
    // The [χ2 (Chi-Squared) Goodness-of-Fit Test](http://en.wikipedia.org/wiki/Goodness_of_fit#Pearson.27s_chi-squared_test)
    // uses a measure of goodness of fit which is the sum of differences between observed and expected outcome frequencies
    // (that is, counts of observations), each squared and divided by the number of observations expected given the
    // hypothesized distribution. The resulting χ2 statistic, `chi_squared`, can be compared to the chi-squared distribution
    // to determine the goodness of fit. In order to determine the degrees of freedom of the chi-squared distribution, one
    // takes the total number of observed frequencies and subtracts the number of estimated parameters. The test statistic
    // follows, approximately, a chi-square distribution with (k − c) degrees of freedom where `k` is the number of non-empty
    // cells and `c` is the number of estimated parameters for the distribution.
    function chi_squared_goodness_of_fit(data, distribution_type, significance) {
        // Estimate from the sample data, a weighted mean.
        var input_mean = mean(data),
            // Calculated value of the χ2 statistic.
            chi_squared = 0,
            // Degrees of freedom, calculated as (number of class intervals -
            // number of hypothesized distribution parameters estimated - 1)
            degrees_of_freedom,
            // Number of hypothesized distribution parameters estimated, expected to be supplied in the distribution test.
            // Lose one degree of freedom for estimating `lambda` from the sample data.
            c = 1,
            // The hypothesized distribution.
            // Generate the hypothesized distribution.
            hypothesized_distribution = distribution_type(input_mean),
            observed_frequencies = [],
            expected_frequencies = [],
            k;

        // Create an array holding a histogram from the sample data, of
        // the form `{ value: numberOfOcurrences }`
        for (var i = 0; i < data.length; i++) {
            if (observed_frequencies[data[i]] === undefined) {
                observed_frequencies[data[i]] = 0;
            }
            observed_frequencies[data[i]]++;
        }

        // The histogram we created might be sparse - there might be gaps
        // between values. So we iterate through the histogram, making
        // sure that instead of undefined, gaps have 0 values.
        for (i = 0; i < observed_frequencies.length; i++) {
            if (observed_frequencies[i] === undefined) {
                observed_frequencies[i] = 0;
            }
        }

        // Create an array holding a histogram of expected data given the
        // sample size and hypothesized distribution.
        for (k in hypothesized_distribution) {
            if (k in observed_frequencies) {
                expected_frequencies[k] = hypothesized_distribution[k] * data.length;
            }
        }

        // Working backward through the expected frequencies, collapse classes
        // if less than three observations are expected for a class.
        // This transformation is applied to the observed frequencies as well.
        for (k = expected_frequencies.length - 1; k >= 0; k--) {
            if (expected_frequencies[k] < 3) {
                expected_frequencies[k - 1] += expected_frequencies[k];
                expected_frequencies.pop();

                observed_frequencies[k - 1] += observed_frequencies[k];
                observed_frequencies.pop();
            }
        }

        // Iterate through the squared differences between observed & expected
        // frequencies, accumulating the `chi_squared` statistic.
        for (k = 0; k < observed_frequencies.length; k++) {
            chi_squared += Math.pow(
                observed_frequencies[k] - expected_frequencies[k], 2) /
                expected_frequencies[k];
        }

        // Calculate degrees of freedom for this test and look it up in the
        // `chi_squared_distribution_table` in order to
        // accept or reject the goodness-of-fit of the hypothesized distribution.
        degrees_of_freedom = observed_frequencies.length - c - 1;
        return chi_squared_distribution_table[degrees_of_freedom][significance] < chi_squared;
    }

    // # Mixin
    //
    // Mixin simple_statistics to a single Array instance if provided
    // or the Array native object if not. This is an optional
    // feature that lets you treat simple_statistics as a native feature
    // of Javascript.
    function mixin(array) {
        var support = !!(Object.defineProperty && Object.defineProperties);
        if (!support) throw new Error('without defineProperty, simple-statistics cannot be mixed in');

        // only methods which work on basic arrays in a single step
        // are supported
        var arrayMethods = ['median', 'standard_deviation', 'sum',
            'sample_skewness',
            'mean', 'min', 'max', 'quantile', 'geometric_mean',
            'harmonic_mean', 'root_mean_square'];

        // create a closure with a method name so that a reference
        // like `arrayMethods[i]` doesn't follow the loop increment
        function wrap(method) {
            return function() {
                // cast any arguments into an array, since they're
                // natively objects
                var args = Array.prototype.slice.apply(arguments);
                // make the first argument the array itself
                args.unshift(this);
                // return the result of the ss method
                return ss[method].apply(ss, args);
            };
        }

        // select object to extend
        var extending;
        if (array) {
            // create a shallow copy of the array so that our internal
            // operations do not change it by reference
            extending = array.slice();
        } else {
            extending = Array.prototype;
        }

        // for each array function, define a function that gets
        // the array as the first argument.
        // We use [defineProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)
        // because it allows these properties to be non-enumerable:
        // `for (var in x)` loops will not run into problems with this
        // implementation.
        for (var i = 0; i < arrayMethods.length; i++) {
            Object.defineProperty(extending, arrayMethods[i], {
                value: wrap(arrayMethods[i]),
                configurable: true,
                enumerable: false,
                writable: true
            });
        }

        return extending;
    }

    ss.linear_regression = linear_regression;
    ss.standard_deviation = standard_deviation;
    ss.r_squared = r_squared;
    ss.median = median;
    ss.mean = mean;
    ss.mode = mode;
    ss.min = min;
    ss.max = max;
    ss.sum = sum;
    ss.quantile = quantile;
    ss.quantile_sorted = quantile_sorted;
    ss.iqr = iqr;
    ss.mad = mad;

    ss.chunk = chunk;
    ss.shuffle = shuffle;
    ss.shuffle_in_place = shuffle_in_place;

    ss.sample = sample;

    ss.sample_covariance = sample_covariance;
    ss.sample_correlation = sample_correlation;
    ss.sample_variance = sample_variance;
    ss.sample_standard_deviation = sample_standard_deviation;
    ss.sample_skewness = sample_skewness;

    ss.geometric_mean = geometric_mean;
    ss.harmonic_mean = harmonic_mean;
    ss.root_mean_square = root_mean_square;
    ss.variance = variance;
    ss.t_test = t_test;
    ss.t_test_two_sample = t_test_two_sample;

    // jenks
    ss.jenksMatrices = jenksMatrices;
    ss.jenksBreaks = jenksBreaks;
    ss.jenks = jenks;

    ss.bayesian = bayesian;

    // Distribution-related methods
    ss.epsilon = epsilon; // We make ε available to the test suite.
    ss.factorial = factorial;
    ss.bernoulli_distribution = bernoulli_distribution;
    ss.binomial_distribution = binomial_distribution;
    ss.poisson_distribution = poisson_distribution;
    ss.chi_squared_goodness_of_fit = chi_squared_goodness_of_fit;

    // Normal distribution
    ss.z_score = z_score;
    ss.cumulative_std_normal_probability = cumulative_std_normal_probability;
    ss.standard_normal_table = standard_normal_table;
    ss.error_function = error_function;

    // Alias this into its common name
    ss.average = mean;
    ss.interquartile_range = iqr;
    ss.mixin = mixin;
    ss.median_absolute_deviation = mad;
    ss.rms = root_mean_square;
    ss.erf = error_function;

})(this);

},{}],70:[function(require,module,exports){
var invariant = require('turf-invariant');
//http://en.wikipedia.org/wiki/Haversine_formula
//http://www.movable-type.co.uk/scripts/latlong.html

/**
 * Takes two {@link Point} features and calculates
 * the distance between them in degress, radians,
 * miles, or kilometers. This uses the
 * [Haversine formula](http://en.wikipedia.org/wiki/Haversine_formula)
 * to account for global curvature.
 *
 * @module turf/distance
 * @category measurement
 * @param {Feature} from origin point
 * @param {Feature} to destination point
 * @param {String} [units=kilometers] can be degrees, radians, miles, or kilometers
 * @return {Number} distance between the two points
 * @example
 * var point1 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.343, 39.984]
 *   }
 * };
 * var point2 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.534, 39.123]
 *   }
 * };
 * var units = "miles";
 *
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [point1, point2]
 * };
 *
 * //=points
 *
 * var distance = turf.distance(point1, point2, units);
 *
 * //=distance
 */
module.exports = function(point1, point2, units){
  invariant.featureOf(point1, 'Point', 'distance');
  invariant.featureOf(point2, 'Point', 'distance');
  var coordinates1 = point1.geometry.coordinates;
  var coordinates2 = point2.geometry.coordinates;

  var dLat = toRad(coordinates2[1] - coordinates1[1]);
  var dLon = toRad(coordinates2[0] - coordinates1[0]);
  var lat1 = toRad(coordinates1[1]);
  var lat2 = toRad(coordinates2[1]);
  var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
          Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2);
  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

  var R;
  switch(units){
    case 'miles':
      R = 3960;
      break;
    case 'kilometers':
      R = 6373;
      break;
    case 'degrees':
      R = 57.2957795;
      break;
    case 'radians':
      R = 1;
      break;
    case undefined:
      R = 6373;
      break;
    default:
      throw new Error('unknown option given to "units"');
  }

  var distance = R * c;
  return distance;
};

function toRad(degree) {
  return degree * Math.PI / 180;
}

},{"turf-invariant":71}],71:[function(require,module,exports){
module.exports.geojsonType = geojsonType;
module.exports.collectionOf = collectionOf;
module.exports.featureOf = featureOf;

/**
 * Enforce expectations about types of GeoJSON objects for Turf.
 *
 * @alias geojsonType
 * @param {GeoJSON} value any GeoJSON object
 * @param {string} type expected GeoJSON type
 * @param {String} name name of calling function
 * @throws Error if value is not the expected type.
 */
function geojsonType(value, type, name) {
    if (!type || !name) throw new Error('type and name required');

    if (!value || value.type !== type) {
        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + value.type);
    }
}

/**
 * Enforce expectations about types of {@link Feature} inputs for Turf.
 * Internally this uses {@link geojsonType} to judge geometry types.
 *
 * @alias featureOf
 * @param {Feature} feature a feature with an expected geometry type
 * @param {string} type expected GeoJSON type
 * @param {String} name name of calling function
 * @throws Error if value is not the expected type.
 */
function featureOf(value, type, name) {
    if (!name) throw new Error('.featureOf() requires a name');
    if (!value || value.type !== 'Feature' || !value.geometry) {
        throw new Error('Invalid input to ' + name + ', Feature with geometry required');
    }
    if (!value.geometry || value.geometry.type !== type) {
        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + value.geometry.type);
    }
}

/**
 * Enforce expectations about types of {@link FeatureCollection} inputs for Turf.
 * Internally this uses {@link geojsonType} to judge geometry types.
 *
 * @alias collectionOf
 * @param {FeatureCollection} featurecollection a featurecollection for which features will be judged
 * @param {string} type expected GeoJSON type
 * @param {String} name name of calling function
 * @throws Error if value is not the expected type.
 */
function collectionOf(value, type, name) {
    if (!name) throw new Error('.collectionOf() requires a name');
    if (!value || value.type !== 'FeatureCollection') {
        throw new Error('Invalid input to ' + name + ', FeatureCollection required');
    }
    for (var i = 0; i < value.features.length; i++) {
        var feature = value.features[i];
        if (!feature || feature.type !== 'Feature' || !feature.geometry) {
            throw new Error('Invalid input to ' + name + ', Feature with geometry required');
        }
        if (!feature.geometry || feature.geometry.type !== type) {
            throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + feature.geometry.type);
        }
    }
}

},{}],72:[function(require,module,exports){
var extent = require('turf-extent');
var bboxPolygon = require('turf-bbox-polygon');

/**
 * Takes a {@link Feature} or {@link FeatureCollection} and returns a rectangular {@link Polygon} feature that encompasses all vertices.
 *
 * @module turf/envelope
 * @category measurement
 * @param {FeatureCollection} fc a FeatureCollection of any type
 * @return {Polygon} a rectangular Polygon feature that encompasses all vertices
 * @example
 * var fc = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "name": "Location A"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-75.343, 39.984]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "name": "Location B"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-75.833, 39.284]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "name": "Location C"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-75.534, 39.123]
 *       }
 *     }
 *   ]
 * };
 *
 * var enveloped = turf.envelope(fc);
 *
 * var resultFeatures = fc.features.concat(enveloped);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(features, done){
  var bbox = extent(features);
  var poly = bboxPolygon(bbox);
  return poly;
}

},{"turf-bbox-polygon":22,"turf-extent":80}],73:[function(require,module,exports){
// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html
var jsts = require('jsts');

/**
 * Finds the difference between two polygons by clipping the second
 * polygon from the first.
 *
 * @module turf/erase
 * @category transformation
 * @param {Polygon} poly1 input Polygon feaure
 * @param {Polygon} poly2 Polygon feature to erase from `poly1`
 * @return {Polygon} a Polygon feature showing the area of `poly1` excluding the area of `poly2`
 * @example
 * var poly1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-46.738586, -23.596711],
 *       [-46.738586, -23.458207],
 *       [-46.560058, -23.458207],
 *       [-46.560058, -23.596711],
 *       [-46.738586, -23.596711]
 *     ]]
 *   }
 * };
 * var poly2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#00f"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-46.650009, -23.631314],
 *       [-46.650009, -23.5237],
 *       [-46.509246, -23.5237],
 *       [-46.509246, -23.631314],
 *       [-46.650009, -23.631314]
 *     ]]
 *   }
 * };
 *
 * var erased = turf.erase(poly1, poly2);
 * erased.properties.fill = '#f00';
 *
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [poly1, poly2]
 * };
 *
 * //=polygons
 *
 * //=erased
 */

module.exports = function(p1, p2, done){
  var poly1 = JSON.parse(JSON.stringify(p1));
  var poly2 = JSON.parse(JSON.stringify(p2));
  if(poly1.type !== 'Feature') {
    poly1 = {
      type: 'Feature',
      properties: {},
      geometry: poly1
    };
  }
  if(poly2.type !== 'Feature') {
    poly2 = {
      type: 'Feature',
      properties: {},
      geometry: poly2
    };
  }

  var reader = new jsts.io.GeoJSONReader();
  var a = reader.read(JSON.stringify(poly1.geometry));
  var b = reader.read(JSON.stringify(poly2.geometry));
  var erased = a.difference(b);
  var parser = new jsts.io.GeoJSONParser();
  erased = parser.write(erased);

  poly1.geometry = erased;

  if (poly1.geometry.type === 'GeometryCollection' && poly1.geometry.geometries.length === 0) {
    return;
  } else {
    return {
      type: 'Feature',
      properties: poly1.properties,
      geometry: erased
    };
  }
};

},{"jsts":74}],74:[function(require,module,exports){
arguments[4][27][0].apply(exports,arguments)
},{"./lib/jsts":75,"dup":27,"javascript.util":77}],75:[function(require,module,exports){
arguments[4][28][0].apply(exports,arguments)
},{"dup":28}],76:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],77:[function(require,module,exports){
arguments[4][30][0].apply(exports,arguments)
},{"./dist/javascript.util-node.min.js":76,"dup":30}],78:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');
var each = require('turf-meta').coordEach;
var point = require('turf-point');

/**
 * Takes any {@link GeoJSON} object and return all positions as
 * a {@link FeatureCollection} of {@link Point} features.
 *
 * @module turf/explode
 * @category misc
 * @param {GeoJSON} input input features
 * @return {FeatureCollection} a FeatureCollection of {@link Point} features representing the exploded input features
 * @throws {Error} if it encounters an unknown geometry type
 * @example
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [177.434692, -17.77517],
 *       [177.402076, -17.779093],
 *       [177.38079, -17.803937],
 *       [177.40242, -17.826164],
 *       [177.438468, -17.824857],
 *       [177.454948, -17.796746],
 *       [177.434692, -17.77517]
 *     ]]
 *   }
 * };
 *
 * var points = turf.explode(poly);
 *
 * //=poly
 *
 * //=points
 */
module.exports = function(layer) {
  var points = [];
  each(layer, function(coord) {
    points.push(point(coord));
  });
  return featureCollection(points);
};

},{"turf-featurecollection":82,"turf-meta":79,"turf-point":112}],79:[function(require,module,exports){
arguments[4][33][0].apply(exports,arguments)
},{"dup":33}],80:[function(require,module,exports){
var each = require('turf-meta').coordEach;

/**
 * Takes any {@link GeoJSON} object, calculates the extent of all input features, and returns a bounding box.
 *
 * @module turf/extent
 * @category measurement
 * @param {GeoJSON} input any valid GeoJSON Object
 * @return {Array<number>} the bounding box of `input` given
 * as an array in WSEN order (west, south, east, north)
 * @example
 * var input = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.175329, 22.2524]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.170007, 22.267969]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.200649, 22.274641]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.186744, 22.265745]
 *       }
 *     }
 *   ]
 * };
 *
 * var bbox = turf.extent(input);
 *
 * var bboxPolygon = turf.bboxPolygon(bbox);
 *
 * var resultFeatures = input.features.concat(bboxPolygon);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(layer) {
    var extent = [Infinity, Infinity, -Infinity, -Infinity];
    each(layer, function(coord) {
      if (extent[0] > coord[0]) extent[0] = coord[0];
      if (extent[1] > coord[1]) extent[1] = coord[1];
      if (extent[2] < coord[0]) extent[2] = coord[0];
      if (extent[3] < coord[1]) extent[3] = coord[1];
    });
    return extent;
};

},{"turf-meta":81}],81:[function(require,module,exports){
arguments[4][33][0].apply(exports,arguments)
},{"dup":33}],82:[function(require,module,exports){
/**
 * Takes one or more {@link Feature|Features} and creates a {@link FeatureCollection}
 *
 * @module turf/featurecollection
 * @category helper
 * @param {Feature} features input Features
 * @returns {FeatureCollection} a FeatureCollection of input features
 * @example
 * var features = [
 *  turf.point([-75.343, 39.984], {name: 'Location A'}),
 *  turf.point([-75.833, 39.284], {name: 'Location B'}),
 *  turf.point([-75.534, 39.123], {name: 'Location C'})
 * ];
 *
 * var fc = turf.featurecollection(features);
 *
 * //=fc
 */
module.exports = function(features){
  return {
    type: "FeatureCollection",
    features: features
  };
};

},{}],83:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} and filters it by a given property and value
 *
 * @module turf/filter
 * @category data
 * @param {FeatureCollection} features input FeatureCollection of any type
 * @param {String} key the property on which to filter
 * @param {String} value the value of that property on which to filter
 * @return {FeatureCollection} a filtered collection with only features that match input `key` and `value`
 * @example
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "oak"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.581777, 44.260875]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "birch"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.570018, 44.260691]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "oak"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.576284, 44.257925]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "redwood"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.56916, 44.254605]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "maple"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.581691, 44.24858]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "oak"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.583837, 44.255773]
 *       }
 *     }
 *   ]
 * };
 *
 * var key = "species";
 * var value = "oak";
 *
 * var filtered = turf.filter(features, key, value);
 *
 * //=features
 *
 * //=filtered
 */
module.exports = function(collection, key, val) {
  var newFC = featureCollection([]);
  for(var i = 0; i < collection.features.length; i++) {
    if(collection.features[i].properties[key] === val) {
      newFC.features.push(collection.features[i]);
    }
  }
  return newFC;
};

},{"turf-featurecollection":82}],84:[function(require,module,exports){
/**
 * Takes a {@link GeoJSON} object of any type and flips all of its coordinates
 * from `[x, y]` to `[y, x]`.
 *
 * @module turf/flip
 * @category misc
 * @param {GeoJSON} input input GeoJSON object
 * @returns {GeoJSON} a GeoJSON object of the same type as `input` with flipped coordinates
 * @example
 * var serbia = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [20.566406, 43.421008]
 *   }
 * };
 *
 * //=serbia
 *
 * var saudiArabia = turf.flip(serbia);
 *
 * //=saudiArabia
 */
module.exports = flipAny;

function flipAny(_) {
    // ensure that we don't modify features in-place and changes to the
    // output do not change the previous feature, including changes to nested
    // properties.
    var input = JSON.parse(JSON.stringify(_));
    switch (input.type) {
        case 'FeatureCollection':
            for (var i = 0; i < input.features.length; i++)
                flipGeometry(input.features[i].geometry);
            return input;
        case 'Feature':
            flipGeometry(input.geometry);
            return input;
        default:
            flipGeometry(input);
            return input;
    }
}

function flipGeometry(geometry) {
    var coords = geometry.coordinates;
    switch(geometry.type) {
      case 'Point':
        flip0(coords);
        break;
      case 'LineString':
      case 'MultiPoint':
        flip1(coords);
        break;
      case 'Polygon':
      case 'MultiLineString':
        flip2(coords);
        break;
      case 'MultiPolygon':
        flip3(coords);
        break;
      case 'GeometryCollection':
        geometry.geometries.forEach(flipGeometry);
        break;
    }
}

function flip0(coord) {
    coord.reverse();
}

function flip1(coords) {
  for(var i = 0; i < coords.length; i++) coords[i].reverse();
}

function flip2(coords) {
  for(var i = 0; i < coords.length; i++)
    for(var j = 0; j < coords[i].length; j++) coords[i][j].reverse();
}

function flip3(coords) {
  for(var i = 0; i < coords.length; i++)
    for(var j = 0; j < coords[i].length; j++)
      for(var k = 0; k < coords[i][j].length; k++) coords[i][j][k].reverse();
}

},{}],85:[function(require,module,exports){
var point = require('turf-point');
var polygon = require('turf-polygon');
var distance = require('turf-distance');
var featurecollection = require('turf-featurecollection');

/**
 * Takes a bounding box and a cell size in degrees and returns a {@link FeatureCollection} of flat-topped
 * hexagons ({@link Polygon} features) aligned in an "odd-q" vertical grid as
 * described in [Hexagonal Grids](http://www.redblobgames.com/grids/hexagons/)
 *
 * @module turf/hex-grid
 * @category interpolation
 * @param {Array<number>} bbox bounding box in [minX, minY, maxX, maxY] order
 * @param {Number} cellWidth width of cell in specified units
 * @param {String} units used in calculating cellWidth ('miles' or 'kilometers')
 * @return {FeatureCollection} units used in calculating cellWidth ('miles' or 'kilometers')
 * @example
 * var bbox = [-96,31,-84,40];
 * var cellWidth = 50;
 * var units = 'miles';
 *
 * var hexgrid = turf.hexGrid(bbox, cellWidth, units);
 *
 * //=hexgrid
 */

//Precompute cosines and sines of angles used in hexagon creation
// for performance gain
var cosines = [];
var sines = [];
for (var i = 0; i < 6; i++) {
  var angle = 2 * Math.PI/6 * i;
  cosines.push(Math.cos(angle));
  sines.push(Math.sin(angle));
}

module.exports = function hexgrid(bbox, cell, units) {
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);
  var radius = cellWidth / 2;

  var hex_width = radius * 2;
  var hex_height = Math.sqrt(3)/2 * hex_width;

  var box_width = bbox[2] - bbox[0];
  var box_height = bbox[3] - bbox[1];

  var x_interval = 3/4 * hex_width;
  var y_interval = hex_height;

  var x_span = box_width / (hex_width - radius/2);
  var x_count = Math.ceil(x_span);
  if (Math.round(x_span) === x_count) {
    x_count++;
  }

  var x_adjust = ((x_count * x_interval - radius/2) - box_width)/2 - radius/2;

  var y_count = Math.ceil(box_height / hex_height);

  var y_adjust = (box_height - y_count * hex_height)/2;

  var hasOffsetY = y_count * hex_height - box_height > hex_height/2;
  if (hasOffsetY) {
    y_adjust -= hex_height/4;
  }

  var fc = featurecollection([]);
  for (var x = 0; x < x_count; x++) {
    for (var y = 0; y <= y_count; y++) {

      var isOdd = x % 2 === 1;
      if (y === 0 && isOdd) {
        continue;
      }

      if (y === 0 && hasOffsetY) {
        continue;
      }

      var center_x = x * x_interval + bbox[0] - x_adjust;
      var center_y = y * y_interval + bbox[1] + y_adjust;

      if (isOdd) {
        center_y -= hex_height/2;
      }
      fc.features.push(hexagon([center_x, center_y], radius));
    }
  }

  return fc;
};

//Center should be [x, y]
function hexagon(center, radius) {
  var vertices = [];
  for (var i = 0; i < 6; i++) {
    var x = center[0] + radius * cosines[i];
    var y = center[1] + radius * sines[i];
    vertices.push([x,y]);
  }
  //first and last vertex must be the same
  vertices.push(vertices[0]);
  return polygon([vertices]);
}
},{"turf-distance":70,"turf-featurecollection":82,"turf-point":112,"turf-polygon":113}],86:[function(require,module,exports){
// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule
// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js
// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html

/**
 * Takes a {@link Point} feature and a {@link Polygon} feature and determines if the Point resides inside the Polygon. The Polygon can
 * be convex or concave. The function accepts any valid Polygon or {@link MultiPolygon}
 * and accounts for holes.
 *
 * @module turf/inside
 * @category joins
 * @param {Point} point a Point feature
 * @param {Polygon} polygon a Polygon feature
 * @return {Boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon
 * @example
 * var pt1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#f00"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.467285, 40.75766]
 *   }
 * };
 * var pt2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.873779, 40.647303]
 *   }
 * };
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-112.074279, 40.52215],
 *       [-112.074279, 40.853293],
 *       [-111.610107, 40.853293],
 *       [-111.610107, 40.52215],
 *       [-112.074279, 40.52215]
 *     ]]
 *   }
 * };
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [pt1, pt2, poly]
 * };
 *
 * //=features
 *
 * var isInside1 = turf.inside(pt1, poly);
 * //=isInside1
 *
 * var isInside2 = turf.inside(pt2, poly);
 * //=isInside2
 */
module.exports = function(point, polygon) {
  var polys = polygon.geometry.coordinates;
  var pt = [point.geometry.coordinates[0], point.geometry.coordinates[1]];
  // normalize to multipolygon
  if(polygon.geometry.type === 'Polygon') polys = [polys];

  var insidePoly = false;
  var i = 0;
  while (i < polys.length && !insidePoly) {
    // check if it is in the outer ring first
    if(inRing(pt, polys[i][0])) {
      var inHole = false;
      var k = 1;
      // check for the point in any of the holes
      while(k < polys[i].length && !inHole) {
        if(inRing(pt, polys[i][k])) {
          inHole = true;
        }
        k++;
      }
      if(!inHole) insidePoly = true;
    }
    i++;
  }
  return insidePoly;
}

// pt is [x,y] and ring is [[x,y], [x,y],..]
function inRing (pt, ring) {
  var isInside = false;
  for (var i = 0, j = ring.length - 1; i < ring.length; j = i++) {
    var xi = ring[i][0], yi = ring[i][1];
    var xj = ring[j][0], yj = ring[j][1];
    
    var intersect = ((yi > pt[1]) != (yj > pt[1]))
        && (pt[0] < (xj - xi) * (pt[1] - yi) / (yj - yi) + xi);
    if (intersect) isInside = !isInside;
  }
  return isInside;
}


},{}],87:[function(require,module,exports){
// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html
var jsts = require('jsts');
var featurecollection = require('turf-featurecollection');

/**
 * Takes two {@link Polygon} features and finds their intersection.
 *
 * @module turf/intersect
 * @category transformation
 * @param {Polygon} poly1 the first Polygon
 * @param {Polygon} poly2 the second Polygon
 * @return {Polygon} a Polygon feature representing the area where `poly1` and `poly2` overlap
 * @example
 * var poly1 = turf.polygon([[
 *  [-122.801742, 45.48565],
 *  [-122.801742, 45.60491],
 *  [-122.584762, 45.60491],
 *  [-122.584762, 45.48565],
 *  [-122.801742, 45.48565]
 * ]]);
 * poly1.properties.fill = '#0f0';
 * var poly2 = turf.polygon([[
 *  [-122.520217, 45.535693],
 *  [-122.64038, 45.553967],
 *  [-122.720031, 45.526554],
 *  [-122.669906, 45.507309],
 *  [-122.723464, 45.446643],
 *  [-122.532577, 45.408574],
 *  [-122.487258, 45.477466],
 *  [-122.520217, 45.535693]
 * ]]);
 * poly2.properties.fill = '#00f';
 * var polygons = turf.featurecollection([poly1, poly2]);
 *
 * var intersection = turf.intersect(poly1, poly2);
 *
 * //=polygons
 *
 * //=intersection
 */
module.exports = function(poly1, poly2){
  var geom1;
  if(poly1.type === 'Feature') geom1 = poly1.geometry;
  else geom1 = poly1;
  if(poly2.type === 'Feature') geom2 = poly2.geometry;
  else geom2 = poly2;
  var reader = new jsts.io.GeoJSONReader();
  var a = reader.read(JSON.stringify(geom1));
  var b = reader.read(JSON.stringify(geom2));
  var intersection = a.intersection(b);
  var parser = new jsts.io.GeoJSONParser();

  intersection = parser.write(intersection);
  if(intersection.type === 'GeometryCollection' && intersection.geometries.length === 0) {
    return;
  } else {
    return {
      type: 'Feature',
      properties: {},
      geometry: intersection
    };
  }
};

},{"jsts":88,"turf-featurecollection":82}],88:[function(require,module,exports){
arguments[4][27][0].apply(exports,arguments)
},{"./lib/jsts":89,"dup":27,"javascript.util":91}],89:[function(require,module,exports){
arguments[4][28][0].apply(exports,arguments)
},{"dup":28}],90:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],91:[function(require,module,exports){
arguments[4][30][0].apply(exports,arguments)
},{"./dist/javascript.util-node.min.js":90,"dup":30}],92:[function(require,module,exports){
/**
 * Copyright (c) 2010, Jason Davies.
 *
 * All rights reserved.  This code is based on Bradley White's Java version,
 * which is in turn based on Nicholas Yue's C++ version, which in turn is based
 * on Paul D. Bourke's original Fortran version.  See below for the respective
 * copyright notices.
 *
 * See http://local.wasp.uwa.edu.au/~pbourke/papers/conrec/ for the original
 * paper by Paul D. Bourke.
 *
 * The vector conversion code is based on http://apptree.net/conrec.htm by
 * Graham Cox.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of the <organization> nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/*
 * Copyright (c) 1996-1997 Nicholas Yue
 *
 * This software is copyrighted by Nicholas Yue. This code is based on Paul D.
 * Bourke's CONREC.F routine.
 *
 * The authors hereby grant permission to use, copy, and distribute this
 * software and its documentation for any purpose, provided that existing
 * copyright notices are retained in all copies and that this notice is
 * included verbatim in any distributions. Additionally, the authors grant
 * permission to modify this software and its documentation for any purpose,
 * provided that such modifications are not distributed without the explicit
 * consent of the authors and that existing copyright notices are retained in
 * all copies. Some of the algorithms implemented by this software are
 * patented, observe all applicable patent law.
 *
 * IN NO EVENT SHALL THE AUTHORS OR DISTRIBUTORS BE LIABLE TO ANY PARTY FOR
 * DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT
 * OF THE USE OF THIS SOFTWARE, ITS DOCUMENTATION, OR ANY DERIVATIVES THEREOF,
 * EVEN IF THE AUTHORS HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * THE AUTHORS AND DISTRIBUTORS SPECIFICALLY DISCLAIM ANY WARRANTIES,
 * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.  THIS SOFTWARE IS
 * PROVIDED ON AN "AS IS" BASIS, AND THE AUTHORS AND DISTRIBUTORS HAVE NO
 * OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR
 * MODIFICATIONS.
 */


  module.exports = Conrec;

  var EPSILON = 1e-10;

  function pointsEqual(a, b) {
    var x = a.x - b.x, y = a.y - b.y;
    return x * x + y * y < EPSILON;
  }

  function reverseList(list) {
    var pp = list.head;

    while (pp) {
      // swap prev/next pointers
      var temp = pp.next;
      pp.next = pp.prev;
      pp.prev = temp;

      // continue through the list
      pp = temp;
    }

    // swap head/tail pointers
    var temp = list.head;
    list.head = list.tail;
    list.tail = temp;
  }

  function ContourBuilder(level) {
    this.level = level;
    this.s = null;
    this.count = 0;
  }
  ContourBuilder.prototype.remove_seq = function(list) {
    // if list is the first item, static ptr s is updated
    if (list.prev) {
      list.prev.next = list.next;
    } else {
      this.s = list.next;
    }

    if (list.next) {
      list.next.prev = list.prev;
    }
    --this.count;
  }
  ContourBuilder.prototype.addSegment = function(a, b) {
    var ss = this.s;
    var ma = null;
    var mb = null;
    var prependA = false;
    var prependB = false;

    while (ss) {
      if (ma == null) {
        // no match for a yet
        if (pointsEqual(a, ss.head.p)) {
          ma = ss;
          prependA = true;
        } else if (pointsEqual(a, ss.tail.p)) {
          ma = ss;
        }
      }
      if (mb == null) {
        // no match for b yet
        if (pointsEqual(b, ss.head.p)) {
          mb = ss;
          prependB = true;
        } else if (pointsEqual(b, ss.tail.p)) {
          mb = ss;
        }
      }
      // if we matched both no need to continue searching
      if (mb != null && ma != null) {
        break;
      } else {
        ss = ss.next;
      }
    }

    // c is the case selector based on which of ma and/or mb are set
    var c = ((ma != null) ? 1 : 0) | ((mb != null) ? 2 : 0);

    switch(c) {
      case 0:   // both unmatched, add as new sequence
        var aa = {p: a, prev: null};
        var bb = {p: b, next: null};
        aa.next = bb;
        bb.prev = aa;

        // create sequence element and push onto head of main list. The order
        // of items in this list is unimportant
        ma = {head: aa, tail: bb, next: this.s, prev: null, closed: false};
        if (this.s) {
          this.s.prev = ma;
        }
        this.s = ma;

        ++this.count;    // not essential - tracks number of unmerged sequences
      break;

      case 1:   // a matched, b did not - thus b extends sequence ma
        var pp = {p: b};

        if (prependA) {
          pp.next = ma.head;
          pp.prev = null;
          ma.head.prev = pp;
          ma.head = pp;
        } else {
          pp.next = null;
          pp.prev = ma.tail;
          ma.tail.next = pp;
          ma.tail = pp;
        }
      break;

      case 2:   // b matched, a did not - thus a extends sequence mb
        var pp = {p: a};

        if (prependB) {
          pp.next = mb.head;
          pp.prev = null;
          mb.head.prev = pp;
          mb.head = pp;
        } else {
          pp.next = null;
          pp.prev = mb.tail;
          mb.tail.next = pp;
          mb.tail = pp;
        }
      break;

      case 3:   // both matched, can merge sequences
        // if the sequences are the same, do nothing, as we are simply closing this path (could set a flag)

        if (ma === mb) {
          var pp = {p: ma.tail.p, next: ma.head, prev: null};
          ma.head.prev = pp;
          ma.head = pp;
          ma.closed = true;
          break;
        }

        // there are 4 ways the sequence pair can be joined. The current setting of prependA and
        // prependB will tell us which type of join is needed. For head/head and tail/tail joins
        // one sequence needs to be reversed
        switch((prependA ? 1 : 0) | (prependB ? 2 : 0)) {
          case 0:   // tail-tail
            // reverse ma and append to mb
            reverseList(ma);
            // fall through to head/tail case
          case 1:   // head-tail
            // ma is appended to mb and ma discarded
            mb.tail.next = ma.head;
            ma.head.prev = mb.tail;
            mb.tail = ma.tail;

            //discard ma sequence record
            this.remove_seq(ma);
          break;

          case 3:   // head-head
            // reverse ma and append mb to it
            reverseList(ma);
            // fall through to tail/head case
          case 2:   // tail-head
            // mb is appended to ma and mb is discarded
            ma.tail.next = mb.head;
            mb.head.prev = ma.tail;
            ma.tail = mb.tail;

            //discard mb sequence record
            this.remove_seq(mb);
        break;
      }
    }
  }

  /**
   * Implements CONREC.
   *
   * @param {function} drawContour function for drawing contour.  Defaults to a
   *                               custom "contour builder", which populates the
   *                               contours property.
   */
  function Conrec(drawContour) {
    if (!drawContour) {
      var c = this;
      c.contours = {};
      /**
       * drawContour - interface for implementing the user supplied method to
       * render the countours.
       *
       * Draws a line between the start and end coordinates.
       *
       * @param startX    - start coordinate for X
       * @param startY    - start coordinate for Y
       * @param endX      - end coordinate for X
       * @param endY      - end coordinate for Y
       * @param contourLevel - Contour level for line.
       */
      this.drawContour = function(startX, startY, endX, endY, contourLevel, k) {
        var cb = c.contours[k];
        if (!cb) {
          cb = c.contours[k] = new ContourBuilder(contourLevel);
        }
        cb.addSegment({x: startX, y: startY}, {x: endX, y: endY});
      }
      this.contourList = function() {
        var l = [];
        var a = c.contours;
        for (var k in a) {
          var s = a[k].s;
          var level = a[k].level;
          while (s) {
            var h = s.head;
            var l2 = [];
            l2.level = level;
            l2.k = k;
            while (h && h.p) {
              l2.push(h.p);
              h = h.next;
            }
            l.push(l2);
            s = s.next;
          }
        }
        l.sort(function(a, b) { return a.k - b.k });
        return l;
      }
    } else {
      this.drawContour = drawContour;
    }
    this.h  = new Array(5);
    this.sh = new Array(5);
    this.xh = new Array(5);
    this.yh = new Array(5);
  }

  /**
   * contour is a contouring subroutine for rectangularily spaced data
   *
   * It emits calls to a line drawing subroutine supplied by the user which
   * draws a contour map corresponding to real*4data on a randomly spaced
   * rectangular grid. The coordinates emitted are in the same units given in
   * the x() and y() arrays.
   *
   * Any number of contour levels may be specified but they must be in order of
   * increasing value.
   *
   *
   * @param {number[][]} d - matrix of data to contour
   * @param {number} ilb,iub,jlb,jub - index bounds of data matrix
   *
   *             The following two, one dimensional arrays (x and y) contain
   *             the horizontal and vertical coordinates of each sample points.
   * @param {number[]} x  - data matrix column coordinates
   * @param {number[]} y  - data matrix row coordinates
   * @param {number} nc   - number of contour levels
   * @param {number[]} z  - contour levels in increasing order.
   */
  Conrec.prototype.contour = function(d, ilb, iub, jlb, jub, x, y, nc, z) {
    var h = this.h, sh = this.sh, xh = this.xh, yh = this.yh;
    var drawContour = this.drawContour;
    this.contours = {};

    /** private */
    var xsect = function(p1, p2){
      return (h[p2]*xh[p1]-h[p1]*xh[p2])/(h[p2]-h[p1]);
    }

    var ysect = function(p1, p2){
      return (h[p2]*yh[p1]-h[p1]*yh[p2])/(h[p2]-h[p1]);
    }
    var m1;
    var m2;
    var m3;
    var case_value;
    var dmin;
    var dmax;
    var x1 = 0.0;
    var x2 = 0.0;
    var y1 = 0.0;
    var y2 = 0.0;

    // The indexing of im and jm should be noted as it has to start from zero
    // unlike the fortran counter part
    var im = [0, 1, 1, 0];
    var jm = [0, 0, 1, 1];

    // Note that castab is arranged differently from the FORTRAN code because
    // Fortran and C/C++ arrays are transposed of each other, in this case
    // it is more tricky as castab is in 3 dimensions
    var castab = [
      [
        [0, 0, 8], [0, 2, 5], [7, 6, 9]
      ],
      [
        [0, 3, 4], [1, 3, 1], [4, 3, 0]
      ],
      [
        [9, 6, 7], [5, 2, 0], [8, 0, 0]
      ]
    ];

    for (var j=(jub-1);j>=jlb;j--) {
      for (var i=ilb;i<=iub-1;i++) {
        var temp1, temp2;
        temp1 = Math.min(d[i][j],d[i][j+1]);
        temp2 = Math.min(d[i+1][j],d[i+1][j+1]);
        dmin  = Math.min(temp1,temp2);
        temp1 = Math.max(d[i][j],d[i][j+1]);
        temp2 = Math.max(d[i+1][j],d[i+1][j+1]);
        dmax  = Math.max(temp1,temp2);

        if (dmax>=z[0]&&dmin<=z[nc-1]) {
          for (var k=0;k<nc;k++) {
            if (z[k]>=dmin&&z[k]<=dmax) {
              for (var m=4;m>=0;m--) {
                if (m>0) {
                  // The indexing of im and jm should be noted as it has to
                  // start from zero
                  h[m] = d[i+im[m-1]][j+jm[m-1]]-z[k];
                  xh[m] = x[i+im[m-1]];
                  yh[m] = y[j+jm[m-1]];
                } else {
                  h[0] = 0.25*(h[1]+h[2]+h[3]+h[4]);
                  xh[0]=0.5*(x[i]+x[i+1]);
                  yh[0]=0.5*(y[j]+y[j+1]);
                }
                if (h[m]>EPSILON) {
                  sh[m] = 1;
                } else if (h[m]<-EPSILON) {
                  sh[m] = -1;
                } else
                  sh[m] = 0;
              }
              //
              // Note: at this stage the relative heights of the corners and the
              // centre are in the h array, and the corresponding coordinates are
              // in the xh and yh arrays. The centre of the box is indexed by 0
              // and the 4 corners by 1 to 4 as shown below.
              // Each triangle is then indexed by the parameter m, and the 3
              // vertices of each triangle are indexed by parameters m1,m2,and
              // m3.
              // It is assumed that the centre of the box is always vertex 2
              // though this isimportant only when all 3 vertices lie exactly on
              // the same contour level, in which case only the side of the box
              // is drawn.
              //
              //
              //      vertex 4 +-------------------+ vertex 3
              //               | \               / |
              //               |   \    m-3    /   |
              //               |     \       /     |
              //               |       \   /       |
              //               |  m=2    X   m=2   |       the centre is vertex 0
              //               |       /   \       |
              //               |     /       \     |
              //               |   /    m=1    \   |
              //               | /               \ |
              //      vertex 1 +-------------------+ vertex 2
              //
              //
              //
              //               Scan each triangle in the box
              //
              for (m=1;m<=4;m++) {
                m1 = m;
                m2 = 0;
                if (m!=4) {
                    m3 = m+1;
                } else {
                    m3 = 1;
                }
                case_value = castab[sh[m1]+1][sh[m2]+1][sh[m3]+1];
                if (case_value!=0) {
                  switch (case_value) {
                    case 1: // Line between vertices 1 and 2
                      x1=xh[m1];
                      y1=yh[m1];
                      x2=xh[m2];
                      y2=yh[m2];
                      break;
                    case 2: // Line between vertices 2 and 3
                      x1=xh[m2];
                      y1=yh[m2];
                      x2=xh[m3];
                      y2=yh[m3];
                      break;
                    case 3: // Line between vertices 3 and 1
                      x1=xh[m3];
                      y1=yh[m3];
                      x2=xh[m1];
                      y2=yh[m1];
                      break;
                    case 4: // Line between vertex 1 and side 2-3
                      x1=xh[m1];
                      y1=yh[m1];
                      x2=xsect(m2,m3);
                      y2=ysect(m2,m3);
                      break;
                    case 5: // Line between vertex 2 and side 3-1
                      x1=xh[m2];
                      y1=yh[m2];
                      x2=xsect(m3,m1);
                      y2=ysect(m3,m1);
                      break;
                    case 6: //  Line between vertex 3 and side 1-2
                      x1=xh[m3];
                      y1=yh[m3];
                      x2=xsect(m1,m2);
                      y2=ysect(m1,m2);
                      break;
                    case 7: // Line between sides 1-2 and 2-3
                      x1=xsect(m1,m2);
                      y1=ysect(m1,m2);
                      x2=xsect(m2,m3);
                      y2=ysect(m2,m3);
                      break;
                    case 8: // Line between sides 2-3 and 3-1
                      x1=xsect(m2,m3);
                      y1=ysect(m2,m3);
                      x2=xsect(m3,m1);
                      y2=ysect(m3,m1);
                      break;
                    case 9: // Line between sides 3-1 and 1-2
                      x1=xsect(m3,m1);
                      y1=ysect(m3,m1);
                      x2=xsect(m1,m2);
                      y2=ysect(m1,m2);
                      break;
                    default:
                      break;
                  }
                  // Put your processing code here and comment out the printf
                  //printf("%f %f %f %f %f\n",x1,y1,x2,y2,z[k]);
                  drawContour(x1,y1,x2,y2,z[k],k);
                }
              }
            }
          }
        }
      }
    }
  }

},{}],93:[function(require,module,exports){
//https://github.com/jasondavies/conrec.js
//http://stackoverflow.com/questions/263305/drawing-a-topographical-map
var tin = require('turf-tin');
var inside = require('turf-inside');
var grid = require('turf-grid');
var extent = require('turf-extent');
var planepoint = require('turf-planepoint');
var featurecollection = require('turf-featurecollection');
var linestring = require('turf-linestring');
var square = require('turf-square');
var Conrec = require('./conrec');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features with z-values and an array of
 * value breaks and generates [isolines](http://en.wikipedia.org/wiki/Isoline).
 *
 * @module turf/isolines
 * @category interpolation
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} z the property name in `points` from which z-values will be pulled
 * @param {number} resolution resolution of the underlying grid
 * @param {number[]} breaks where to draw contours
 * @returns {FeatureCollection} a FeatureCollection of {@link LineString} features representing isolines
 * @example
 * // create random points with random
 * // z-values in their properties
 * var points = turf.random('point', 100, {
 *   bbox: [0, 30, 20, 50]
 * });
 * for (var i = 0; i < points.features.length; i++) {
 *   points.features[i].properties.z = Math.random() * 10;
 * }
 * var breaks = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
 * var isolined = turf.isolines(points, 'z', 15, breaks);
 * //=isolined
 */
module.exports = function(points, z, resolution, breaks, done){
  var tinResult = tin(points, z);
  var extentBBox = extent(points);
  var squareBBox = square(extentBBox);
  var gridResult = grid(squareBBox, resolution);
  var data = [];

  for (var i = 0; i < gridResult.features.length; i++) {
    var pt = gridResult.features[i];
    for (var j = 0; j < tinResult.features.length; j++) {
      var triangle = tinResult.features[j];
      if (inside(pt, triangle)) {
        pt.properties = {};
        pt.properties[z] = planepoint(pt, triangle);
      }
    }
  }

  var depth = Math.sqrt(gridResult.features.length);
  for (var x=0; x<depth; x++){
    var xGroup = gridResult.features.slice(x * depth, (x + 1) * depth);
    var xFlat = [];
    xGroup.forEach(function(verticalPoint){
      if(verticalPoint.properties){
        xFlat.push(verticalPoint.properties[z]);
      } else{
        xFlat.push(0);
      }
    });
    data.push(xFlat);
  }
  var interval = (squareBBox[2] - squareBBox[0]) / depth;
  var xCoordinates = [];
  var yCoordinates = [];
  for (var x = 0; x < depth; x++) {
    xCoordinates.push(x * interval + squareBBox[0]);
    yCoordinates.push(x * interval + squareBBox[1]);
  }

  var c = new Conrec();
  c.contour(data, 0, resolution, 0, resolution, xCoordinates, yCoordinates, breaks.length, breaks);
  var contourList = c.contourList();

  var fc = featurecollection([]);
  contourList.forEach(function(c){
    if(c.length > 2){
      var polyCoordinates = [];
      c.forEach(function(coord){
        polyCoordinates.push([coord.x, coord.y]);
      });
      var poly = linestring(polyCoordinates);
      poly.properties = {};
      poly.properties[z] = c.level;

      fc.features.push(poly);
    }
  });

  return fc;
}




},{"./conrec":92,"turf-extent":80,"turf-featurecollection":82,"turf-grid":94,"turf-inside":86,"turf-linestring":100,"turf-planepoint":108,"turf-square":125,"turf-tin":128}],94:[function(require,module,exports){
var point = require('turf-point');

/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Point} features in a grid.
 *
 * @module turf/grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} depth how many cells to output
 * @return {FeatureCollection} grid as FeatureCollection with {@link Point} features
 * @example
 * var extent = [-70.823364, -33.553984, -70.473175, -33.302986];
 * var depth = 10;
 *
 * var grid = turf.grid(extent, depth);
 *
 * //=grid
 */
module.exports = function(extents, depth) {
  var xmin = extents[0];
  var ymin = extents[1];
  var xmax = extents[2];
  var ymax = extents[3];
  var interval = (xmax - xmin) / depth;
  var coords = [];
  var fc = {
    type: 'FeatureCollection',
    features: []
  };

  for (var x=0; x<=depth; x++){
    for (var y=0;y<=depth; y++){
      fc.features.push(point([(x * interval) + xmin, (y * interval) + ymin]));
    }
  }
  return fc;
}

},{"turf-point":112}],95:[function(require,module,exports){
var ss = require('simple-statistics');

/**
* Takes a {@FeatureCollection} of any type and returns an array of the [Jenks Natural breaks](http://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization)
* for a given property
* @module turf/jenks
* @param {FeatureCollection} input a FeatureCollection of any type
* @param {string} field the property in `input` on which to calculate Jenks natural breaks
* @param {number} numberOfBreaks number of classes in which to group the data
* @return {Array<number>} the break number for each class plus the minimum and maximum values
* @example
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.859733, 40.400424]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.83879, 40.401209]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.817848, 40.376889]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.840507, 40.386043]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.854583, 40.37532]
*       }
*     }
*   ]
* };
*
* var breaks = turf.jenks(points, 'population', 3);
*
* //=breaks
*/
module.exports = function(fc, field, num){
  var vals = [];
  var breaks = [];

  fc.features.forEach(function(feature){
    if(feature.properties[field]!==undefined){
      vals.push(feature.properties[field]);
    }
  });
  breaks = ss.jenks(vals, num);

  return breaks;
};

},{"simple-statistics":96}],96:[function(require,module,exports){
arguments[4][69][0].apply(exports,arguments)
},{"dup":69}],97:[function(require,module,exports){
/**
 * Takes a {@link Polygon} feature and returns a {@link FeatureCollection} of {@link Point} features at all self-intersections.
 *
 * @module turf/kinks
 * @category misc
 * @param {Polygon} polygon a Polygon feature
 * @returns {FeatureCollection} a FeatureCollection of {@link Point} features representing self-intersections
 * @example
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-12.034835, 8.901183],
 *       [-12.060413, 8.899826],
 *       [-12.03638, 8.873199],
 *       [-12.059383, 8.871418],
 *       [-12.034835, 8.901183]
 *     ]]
 *   }
 * };
 * 
 * var kinks = turf.kinks(poly);
 *
 * var resultFeatures = kinks.intersections.features.concat(poly);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

var polygon = require('turf-polygon');
var point = require('turf-point');
var fc = require('turf-featurecollection');

module.exports = function(polyIn) {
  var poly;
  var results = {intersections: fc([]), fixed: null};
  if (polyIn.type === 'Feature') {
    poly = polyIn.geometry;
  } else {
    poly = polyIn;
  }
  var intersectionHash = {};
  poly.coordinates.forEach(function(ring1){
    poly.coordinates.forEach(function(ring2){
      for(var i = 0; i < ring1.length-1; i++) {
        for(var k = 0; k < ring2.length-1; k++) {
          var intersection = lineIntersects(ring1[i][0],ring1[i][1],ring1[i+1][0],ring1[i+1][1],
            ring2[k][0],ring2[k][1],ring2[k+1][0],ring2[k+1][1]);
          if(intersection) {
            results.intersections.features.push(point([intersection[0], intersection[1]]));
          }
        }
      }
    })
  })
  return results;
}


// modified from http://jsfiddle.net/justin_c_rounds/Gd2S2/light/
function lineIntersects(line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY) {
  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point
  var denominator, a, b, numerator1, numerator2, result = {
    x: null,
    y: null,
    onLine1: false,
    onLine2: false
  };
  denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY));
  if (denominator == 0) {
    if(result.x != null && result.y != null) {
      return result;
    } else {
      return false;
    }
  }
  a = line1StartY - line2StartY;
  b = line1StartX - line2StartX;
  numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b);
  numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b);
  a = numerator1 / denominator;
  b = numerator2 / denominator;

  // if we cast these lines infinitely in both directions, they intersect here:
  result.x = line1StartX + (a * (line1EndX - line1StartX));
  result.y = line1StartY + (a * (line1EndY - line1StartY));

  // if line1 is a segment and line2 is infinite, they intersect if:
  if (a > 0 && a < 1) {
    result.onLine1 = true;
  }
  // if line2 is a segment and line1 is infinite, they intersect if:
  if (b > 0 && b < 1) {
    result.onLine2 = true;
  }
  // if line1 and line2 are segments, they intersect if both of the above are true
  if(result.onLine1 && result.onLine2){
    return [result.x, result.y];
  }
  else {
    return false;
  }
}

},{"turf-featurecollection":82,"turf-point":112,"turf-polygon":113}],98:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');

/**
 * Takes a {@link LineString} feature and measures its length in the specified units.
 *
 * @module turf/line-distance
 * @category measurement
 * @param {LineString} Line to measure
 * @param {String} [units=miles] can be degrees, radians, miles, or kilometers
 * @return {Number} length of the LineString
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 *
 * var length = turf.lineDistance(line, 'miles');
 *
 * //=line
 *
 * //=length
 */

module.exports = function (line, units) {
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  var travelled = 0;
  for(var i = 0; i < coords.length - 1; i++) {
    travelled += distance(point(coords[i]), point(coords[i+1]), units);
  }
  return travelled;
}

},{"turf-distance":70,"turf-point":112}],99:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');
var linestring = require('turf-linestring');
var bearing = require('turf-bearing');
var destination = require('turf-destination');

/**
 * Slices a LineString at start and stop Points
 *
 * @module turf/line-slice
 *
 * @param {Point} Point to start the slice
 * @param {Point} Point to stop the slice
 * @param {LineString} Line to slice
 * @return {LineString} Sliced LineString
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 * var start = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-77.029609, 38.881946]
 *   }
 * };
 * var stop = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-77.021884, 38.889563]
 *   }
 * };
 * 
 * var sliced = turf.lineSlice(start, stop, line);
 *
 * //=line
 *
 * //=sliced
 */

module.exports = function (startPt, stopPt, line) {  
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  var startVertex = pointOnLine(startPt, coords);
  var stopVertex = pointOnLine(stopPt, coords);
  var ends;
  if(startVertex.properties.index <= stopVertex.properties.index) {
    ends = [startVertex, stopVertex];
  } else {
    ends = [stopVertex, startVertex];
  }
  var clipLine = linestring([ends[0].geometry.coordinates], {});
  for(var i = ends[0].properties.index+1; i < ends[1].properties.index+1; i++) {
    clipLine.geometry.coordinates.push(coords[i]);
  }
  clipLine.geometry.coordinates.push(ends[1].geometry.coordinates);
  return clipLine;
}

function pointOnLine (pt, coords) {
  var units = 'miles'
  var closestPt = point([Infinity, Infinity], {dist: Infinity});
  for(var i = 0; i < coords.length - 1; i++) {
    var start = point(coords[i])
    var stop = point(coords[i+1])
    //start
    start.properties.dist = distance(pt, start, units);
    //stop
    stop.properties.dist = distance(pt, stop, units);
    //perpendicular
    var direction = bearing(start, stop)
    var perpendicularPt = destination(pt, 1000 , direction + 90, units) // 1000 = gross
    var intersect = lineIntersects(
      pt.geometry.coordinates[0],
      pt.geometry.coordinates[1],
      perpendicularPt.geometry.coordinates[0],
      perpendicularPt.geometry.coordinates[1],
      start.geometry.coordinates[0],
      start.geometry.coordinates[1],
      stop.geometry.coordinates[0],
      stop.geometry.coordinates[1]
      );
    if(!intersect) {
      perpendicularPt = destination(pt, 1000 , direction - 90, units) // 1000 = gross
      intersect = lineIntersects(
        pt.geometry.coordinates[0],
        pt.geometry.coordinates[1],
        perpendicularPt.geometry.coordinates[0],
        perpendicularPt.geometry.coordinates[1],
        start.geometry.coordinates[0],
        start.geometry.coordinates[1],
        stop.geometry.coordinates[0],
        stop.geometry.coordinates[1]
        );
    }
    perpendicularPt.properties.dist = Infinity;
    var intersectPt;
    if(intersect) {
      var intersectPt = point(intersect);
      intersectPt.properties.dist = distance(pt, intersectPt, units);
    }
    
    if(start.properties.dist < closestPt.properties.dist) {
      closestPt = start;
      closestPt.properties.index = i;
    }
    if(stop.properties.dist < closestPt.properties.dist) {
     closestPt = stop;
     closestPt.properties.index = i;
    }
    if(intersectPt && intersectPt.properties.dist < closestPt.properties.dist){ 
      closestPt = intersectPt;
      closestPt.properties.index = i;
    }
  }
  
  return closestPt;
}

// modified from http://jsfiddle.net/justin_c_rounds/Gd2S2/light/
function lineIntersects(line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY) {
  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point
  var denominator, a, b, numerator1, numerator2, result = {
    x: null,
    y: null,
    onLine1: false,
    onLine2: false
  };
  denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY));
  if (denominator == 0) {
    if(result.x != null && result.y != null) {
      return result;
    } else {
      return false;
    }
  }
  a = line1StartY - line2StartY;
  b = line1StartX - line2StartX;
  numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b);
  numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b);
  a = numerator1 / denominator;
  b = numerator2 / denominator;

  // if we cast these lines infinitely in both directions, they intersect here:
  result.x = line1StartX + (a * (line1EndX - line1StartX));
  result.y = line1StartY + (a * (line1EndY - line1StartY));

  // if line1 is a segment and line2 is infinite, they intersect if:
  if (a > 0 && a < 1) {
    result.onLine1 = true;
  }
  // if line2 is a segment and line1 is infinite, they intersect if:
  if (b > 0 && b < 1) {
    result.onLine2 = true;
  }
  // if line1 and line2 are segments, they intersect if both of the above are true
  if(result.onLine1 && result.onLine2){
    return [result.x, result.y];
  }
  else {
    return false;
  }
}

},{"turf-bearing":23,"turf-destination":67,"turf-distance":70,"turf-linestring":100,"turf-point":112}],100:[function(require,module,exports){
/**
 * Creates a {@link LineString} {@link Feature} based on a
 * coordinate array. Properties can be added optionally.
 *
 * @module turf/linestring
 * @category helper
 * @param {Array<Array<Number>>} coordinates an array of Positions
 * @param {Object} properties an Object of key-value pairs to add as properties
 * @return {LineString} a LineString feature
 * @throws {Error} if no coordinates are passed
 * @example
 * var linestring1 = turf.linestring([
 *	[-21.964416, 64.148203],
 *	[-21.956176, 64.141316],
 *	[-21.93901, 64.135924],
 *	[-21.927337, 64.136673]
 * ]);
 * var linestring2 = turf.linestring([
 *	[-21.929054, 64.127985],
 *	[-21.912918, 64.134726],
 *	[-21.916007, 64.141016],
 * 	[-21.930084, 64.14446]
 * ], {name: 'line 1', distance: 145});
 *
 * //=linestring1
 *
 * //=linestring2
 */
module.exports = function(coordinates, properties){
  if (!coordinates) {
      throw new Error('No coordinates passed');
  }
  return {
    "type": "Feature",
    "geometry": {
      "type": "LineString",
      "coordinates": coordinates
    },
    "properties": properties || {}
  };
};

},{}],101:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the maximum value of a field for a set of {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/max
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} inField the field in input data to analyze
 * @param {string} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField` values
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [101.551437, 3.150114],
 *           [101.551437, 3.250208],
 *           [101.742324, 3.250208],
 *           [101.742324, 3.150114],
 *           [101.551437, 3.150114]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [101.659927, 3.011612],
 *           [101.659927, 3.143944],
 *           [101.913986, 3.143944],
 *           [101.913986, 3.011612],
 *           [101.659927, 3.011612]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.56105, 3.213874]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.709365, 3.211817]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.645507, 3.169311]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.708679, 3.071266]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.826782, 3.081551]
 *       }
 *     }
 *   ]
 * };
 *
 * var aggregated = turf.max(
 *   polygons, points, 'population', 'max');
 *
 * var resultFeatures = points.features.concat(
 *   aggregated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = max(values);
  });

  return polyFC;
}

function max(x) {
    var value;
    for (var i = 0; i < x.length; i++) {
        // On the first iteration of this loop, max is
        // undefined and is thus made the maximum element in the array
        if (x[i] > value || value === undefined) value = x[i];
    }
    return value;
}

},{"turf-inside":86}],102:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the median value of a field for a set of {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/median
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} inField the field in input data to analyze
 * @param {string} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField` values
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [18.400039, -33.970697],
 *           [18.400039, -33.818518],
 *           [18.665771, -33.818518],
 *           [18.665771, -33.970697],
 *           [18.400039, -33.970697]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [18.538742, -34.050383],
 *           [18.538742, -33.98721],
 *           [18.703536, -33.98721],
 *           [18.703536, -34.050383],
 *           [18.538742, -34.050383]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.514022, -33.860152]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.48999, -33.926269]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.583374, -33.905755]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.591613, -34.024778]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.653411, -34.017949]
 *       }
 *     }
 *   ]
 * };
 *
 * var medians = turf.median(
 *  polygons, points, 'population', 'median');
 *
 * var resultFeatures = points.features.concat(
 *   medians.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = median(values);
  });

  return polyFC;
};

function median(x) {
    // The median of an empty list is null
    if (x.length === 0) return null;

    // Sorting the array makes it easy to find the center, but
    // use `.slice()` to ensure the original array `x` is not modified
    var sorted = x.slice().sort(function (a, b) { return a - b; });

    // If the length of the list is odd, it's the central number
    if (sorted.length % 2 === 1) {
        return sorted[(sorted.length - 1) / 2];
    // Otherwise, the median is the average of the two numbers
    // at the center of the list
    } else {
        var a = sorted[(sorted.length / 2) - 1];
        var b = sorted[(sorted.length / 2)];
        return (a + b) / 2;
    }
}

},{"turf-inside":86}],103:[function(require,module,exports){
var clone = require('clone');
var union = require('turf-union');

/**
 * Takes a {@link FeatureCollection} of {@link Polygon} features and returns a single merged
 * polygon feature. If the input Polygon features are not contiguous, this function returns a {@link MultiPolygon} feature.
 * @module turf/merge
 * @category transformation
 * @param {FeatureCollection} fc a FeatureCollection of {@link Polygon} features
 * @return {Feature} a {@link Polygon} or {@link MultiPolygon} feature
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "fill": "#0f0"
 *       },
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [9.994812, 53.549487],
 *           [10.046997, 53.598209],
 *           [10.117721, 53.531737],
 *           [9.994812, 53.549487]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "fill": "#00f"
 *       },
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [10.000991, 53.50418],
 *           [10.03807, 53.562539],
 *           [9.926834, 53.551731],
 *           [10.000991, 53.50418]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 *
 * var merged = turf.merge(polygons);
 *
 * //=polygons
 *
 * //=merged
 */
module.exports = function(polygons, done){

  var merged = clone(polygons.features[0]),
    features = polygons.features;

  for (var i = 0, len = features.length; i < len; i++) {
    var poly = features[i];

    if(poly.geometry){
      merged = union(merged, poly);
    }
  }

  return merged;
};

},{"clone":104,"turf-union":130}],104:[function(require,module,exports){
(function (Buffer){
'use strict';

function objectToString(o) {
  return Object.prototype.toString.call(o);
}

// shim for Node's 'util' package
// DO NOT REMOVE THIS! It is required for compatibility with EnderJS (http://enderjs.com/).
var util = {
  isArray: function (ar) {
    return Array.isArray(ar) || (typeof ar === 'object' && objectToString(ar) === '[object Array]');
  },
  isDate: function (d) {
    return typeof d === 'object' && objectToString(d) === '[object Date]';
  },
  isRegExp: function (re) {
    return typeof re === 'object' && objectToString(re) === '[object RegExp]';
  },
  getRegExpFlags: function (re) {
    var flags = '';
    re.global && (flags += 'g');
    re.ignoreCase && (flags += 'i');
    re.multiline && (flags += 'm');
    return flags;
  }
};


if (typeof module === 'object')
  module.exports = clone;

/**
 * Clones (copies) an Object using deep copying.
 *
 * This function supports circular references by default, but if you are certain
 * there are no circular references in your object, you can save some CPU time
 * by calling clone(obj, false).
 *
 * Caution: if `circular` is false and `parent` contains circular references,
 * your program may enter an infinite loop and crash.
 *
 * @param `parent` - the object to be cloned
 * @param `circular` - set to true if the object to be cloned may contain
 *    circular references. (optional - true by default)
 * @param `depth` - set to a number if the object is only to be cloned to
 *    a particular depth. (optional - defaults to Infinity)
 * @param `prototype` - sets the prototype to be used when cloning an object.
 *    (optional - defaults to parent prototype).
*/

function clone(parent, circular, depth, prototype) {
  // maintain two arrays for circular references, where corresponding parents
  // and children have the same index
  var allParents = [];
  var allChildren = [];

  var useBuffer = typeof Buffer != 'undefined';

  if (typeof circular == 'undefined')
    circular = true;

  if (typeof depth == 'undefined')
    depth = Infinity;

  // recurse this function so we don't reset allParents and allChildren
  function _clone(parent, depth) {
    // cloning null always returns null
    if (parent === null)
      return null;

    if (depth == 0)
      return parent;

    var child;
    var proto;
    if (typeof parent != 'object') {
      return parent;
    }

    if (util.isArray(parent)) {
      child = [];
    } else if (util.isRegExp(parent)) {
      child = new RegExp(parent.source, util.getRegExpFlags(parent));
      if (parent.lastIndex) child.lastIndex = parent.lastIndex;
    } else if (util.isDate(parent)) {
      child = new Date(parent.getTime());
    } else if (useBuffer && Buffer.isBuffer(parent)) {
      child = new Buffer(parent.length);
      parent.copy(child);
      return child;
    } else {
      if (typeof prototype == 'undefined') {
        proto = Object.getPrototypeOf(parent);
        child = Object.create(proto);
      }
      else {
        child = Object.create(prototype);
        proto = prototype;
      }
    }

    if (circular) {
      var index = allParents.indexOf(parent);

      if (index != -1) {
        return allChildren[index];
      }
      allParents.push(parent);
      allChildren.push(child);
    }

    for (var i in parent) {
      var attrs;
      if (proto) {
        attrs = Object.getOwnPropertyDescriptor(proto, i);
      }
      
      if (attrs && attrs.set == null) {
        continue;
      }
      child[i] = _clone(parent[i], depth - 1);
    }

    return child;
  }

  return _clone(parent, depth);
}

/**
 * Simple flat clone using prototype, accepts only objects, usefull for property
 * override on FLAT configuration object (no nested props).
 *
 * USE WITH CAUTION! This may not behave as you wish if you do not know how this
 * works.
 */
clone.clonePrototype = function(parent) {
  if (parent === null)
    return null;

  var c = function () {};
  c.prototype = parent;
  return new c();
};

}).call(this,require("buffer").Buffer)

},{"buffer":4}],105:[function(require,module,exports){
// http://cs.selu.edu/~rbyrd/math/midpoint/
// ((x1+x2)/2), ((y1+y2)/2)
var point = require('turf-point');

/**
 * Takes two {@link Point} features and returns a Point midway between the two.
 *
 * @module turf/midpoint
 * @category measurement
 * @param {Point} pt1 first point
 * @param {Point} pt2 second point
 * @return {Point} a point between the two
 * @example
 * var pt1 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [144.834823, -37.771257]
 *   }
 * };
 * var pt2 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [145.14244, -37.830937]
 *   }
 * };
 *
 * var midpointed = turf.midpoint(pt1, pt2);
 * midpointed.properties['marker-color'] = '#f00';
 *
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [pt1, pt2, midpointed]
 * };
 *
 * //=result
 */
module.exports = function(point1, point2) {
  if (point1 === null || point2 === null){
    throw new Error('Less than two points passed.');
  }

  var x1 = point1.geometry.coordinates[0];
  var x2 = point2.geometry.coordinates[0];
  var y1 = point1.geometry.coordinates[1];
  var y2 = point2.geometry.coordinates[1];

  var x3 = x1 + x2;
  var midX = x3/2;
  var y3 = y1 + y2;
  var midY = y3/2;

  return point([midX, midY]);
};

},{"turf-point":112}],106:[function(require,module,exports){
var inside = require('turf-inside');

/**
* Calculates the minimum value of a field for {@link Point} features within a set of {@link Polygon} features.
*
* @module turf/min
* @category aggregation
* @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
* @param {FeatureCollection} points a FeatureCollection of {@link Point} features
* @param {string} inField the field in input data to analyze
* @param {string} outField the field in which to store results
* @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
* with properties listed as `outField` values
* @example
* var polygons = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [72.809658, 18.961818],
*           [72.809658, 18.974805],
*           [72.827167, 18.974805],
*           [72.827167, 18.961818],
*           [72.809658, 18.961818]
*         ]]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [72.820987, 18.947043],
*           [72.820987, 18.95922],
*           [72.841243, 18.95922],
*           [72.841243, 18.947043],
*           [72.820987, 18.947043]
*         ]]
*       }
*     }
*   ]
* };
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.814464, 18.971396]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.820043, 18.969772]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.817296, 18.964253]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.83575, 18.954837]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.828197, 18.95094]
*       }
*     }
*   ]
* };
*
* var minimums = turf.min(
*   polygons, points, 'population', 'min');
*
* var resultFeatures = points.features.concat(
*   minimums.features);
* var result = {
*   "type": "FeatureCollection",
*   "features": resultFeatures
* };
*
* //=result
*/
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = min(values);
  });

  return polyFC;
};

function min(x) {
    var value;
    for (var i = 0; i < x.length; i++) {
        // On the first iteration of this loop, min is
        // undefined and is thus made the minimum element in the array
        if (x[i] < value || value === undefined) value = x[i];
    }
    return value;
}

},{"turf-inside":86}],107:[function(require,module,exports){
var distance = require('turf-distance');

/**
 * Takes a {@link Point} feature and a {@link FeatureCollection} of Point features and returns the Point feature from the FeatureCollection closest to the input point.
 *
 * @module turf/nearest
 * @category classification
 * @param {Point} point the reference point
 * @param {FeatureCollection} against a FeatureCollection of Point features
 * @return {Feature} the closest Point feature in `against` to `point`
 * @example
 * var point = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [28.965797, 41.010086]
 *   }
 * };
 * var against = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [28.973865, 41.011122]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [28.948459, 41.024204]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [28.938674, 41.013324]
 *       }
 *     }
 *   ]
 * };
 *
 * var nearest = turf.nearest(point, against);
 * nearest.properties['marker-color'] = '#f00';
 *
 * var resultFeatures = against.features.concat(point);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(targetPoint, points){
  var nearestPoint;
  var count = 0;
  var dist = Infinity;
  points.features.forEach(function(pt){
    if(!nearestPoint){
      nearestPoint = pt;
      var dist = distance(targetPoint, pt, 'miles');
      nearestPoint.properties.distance = dist;
    }
    else{
      var dist = distance(targetPoint, pt, 'miles');
      if(dist < nearestPoint.properties.distance){
        nearestPoint = pt;
        nearestPoint.properties.distance = dist;
      }
    }
  });
  delete nearestPoint.properties.distance;
  return nearestPoint;
}

},{"turf-distance":70}],108:[function(require,module,exports){
/**
 * Takes a triangular plane as a {@link Polygon} feature
 * and a {@link Point} feature within that triangle and returns the z-value
 * at that point. The Polygon needs to have properties `a`, `b`, and `c`
 * that define the values at its three corners.
 *
 * @module turf/planepoint
 * @category interpolation
 * @param {Point} interpolatedPoint the Point for which a z-value will be calculated
 * @param {Polygon} triangle a Polygon feature with three vertices
 * @return {number} the z-value for `interpolatedPoint`
 * @example
 * var point = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.3221, 39.529]
 *   }
 * };
 * var point = turf.point([-75.3221, 39.529]);
 * // triangle is a polygon with "a", "b",
 * // and "c" values representing
 * // the values of the coordinates in order.
 * var triangle = {
 *   "type": "Feature",
 *   "properties": {
 *     "a": 11,
 *     "b": 122,
 *     "c": 44
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-75.1221, 39.57],
 *       [-75.58, 39.18],
 *       [-75.97, 39.86],
 *       [-75.1221, 39.57]
 *     ]]
 *   }
 * };
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [triangle, point]
 * };
 *
 * var zValue = turf.planepoint(point, triangle);
 *
 * //=features
 *
 * //=zValue
 */
module.exports = function(point, triangle){
  var x = point.geometry.coordinates[0],
      y = point.geometry.coordinates[1],
      x1 = triangle.geometry.coordinates[0][0][0],
      y1 = triangle.geometry.coordinates[0][0][1],
      z1 = triangle.properties.a,
      x2 = triangle.geometry.coordinates[0][1][0],
      y2 = triangle.geometry.coordinates[0][1][1],
      z2 = triangle.properties.b,
      x3 = triangle.geometry.coordinates[0][2][0],
      y3 = triangle.geometry.coordinates[0][2][1],
      z3 = triangle.properties.c;

  var z = (z3 * (x-x1) * (y-y2) + z1 * (x-x2) * (y-y3) + z2 * (x-x3) * (y-y1) -
      z2 * (x-x1) * (y-y3) - z3 * (x-x2) * (y-y1) - z1 * (x-x3) * (y-y2)) /
      ((x-x1) * (y-y2) + (x-x2) * (y-y3) +(x-x3) * (y-y1) -
       (x-x1) * (y-y3) - (x-x2) * (y-y1) - (x-x3) * (y-y2));

  return z;
};

},{}],109:[function(require,module,exports){
var point = require('turf-point');
var featurecollection = require('turf-featurecollection');
var distance = require('turf-distance');
/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Point} features in a grid.
 *
 * @module turf/point-grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} depth how many cells to output
 * @return {FeatureCollection} grid as FeatureCollection with {@link Point} features
 * @example
 * var extent = [-70.823364, -33.553984, -70.473175, -33.302986];
 * var depth = 10;
 *
 * var grid = turf.pointGrid(extent, depth);
 *
 * //=grid
 */
module.exports = function (bbox, cell, units) {
  var fc = featurecollection([]);
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);

  var currentX = bbox[0];
  while (currentX <= bbox[2]) {
    var currentY = bbox[1];
    while (currentY <= bbox[3]) {
      fc.features.push(point([currentX, currentY]));

      currentY += cellHeight;
    }
    currentX += cellWidth;
  }
  
  return fc;
}
},{"turf-distance":70,"turf-featurecollection":82,"turf-point":112}],110:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');
var linestring = require('turf-linestring');
var bearing = require('turf-bearing');
var destination = require('turf-destination');

/**
 * Takes a Point and a LineString and calculates the closest Point on the LineString
 *
 * @module turf/point-on-line
 *
 * @param {LineString} Line to snap to
 * @param {Point} Point to snap from
 * @return {Point} Closest Point on the Line
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 * var pt = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-77.037076, 38.884017]
 *   }
 * };
 * 
 * var snapped = turf.pointOnLine(line, pt);
 * snapped.properties['marker-color'] = '#00f'
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [line, pt, snapped]
 * };
 *
 * //=result
 */

module.exports = function (line, pt) {  
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  return pointOnLine(pt, coords);
}

function pointOnLine (pt, coords) {
  var units = 'miles'
  var closestPt = point([Infinity, Infinity], {dist: Infinity});
  for(var i = 0; i < coords.length - 1; i++) {
    var start = point(coords[i])
    var stop = point(coords[i+1])
    //start
    start.properties.dist = distance(pt, start, units);
    //stop
    stop.properties.dist = distance(pt, stop, units);
    //perpendicular
    var direction = bearing(start, stop)
    var perpendicularPt = destination(pt, 1000 , direction + 90, units) // 1000 = gross
    var intersect = lineIntersects(
      pt.geometry.coordinates[0],
      pt.geometry.coordinates[1],
      perpendicularPt.geometry.coordinates[0],
      perpendicularPt.geometry.coordinates[1],
      start.geometry.coordinates[0],
      start.geometry.coordinates[1],
      stop.geometry.coordinates[0],
      stop.geometry.coordinates[1]
      );
    if(!intersect) {
      perpendicularPt = destination(pt, 1000 , direction - 90, units) // 1000 = gross
      intersect = lineIntersects(
        pt.geometry.coordinates[0],
        pt.geometry.coordinates[1],
        perpendicularPt.geometry.coordinates[0],
        perpendicularPt.geometry.coordinates[1],
        start.geometry.coordinates[0],
        start.geometry.coordinates[1],
        stop.geometry.coordinates[0],
        stop.geometry.coordinates[1]
        );
    }
    perpendicularPt.properties.dist = Infinity;
    var intersectPt;
    if(intersect) {
      var intersectPt = point(intersect);
      intersectPt.properties.dist = distance(pt, intersectPt, units);
    }
    
    if(start.properties.dist < closestPt.properties.dist) {
      closestPt = start;
      closestPt.properties.index = i;
    }
    if(stop.properties.dist < closestPt.properties.dist) {
     closestPt = stop;
     closestPt.properties.index = i;
    }
    if(intersectPt && intersectPt.properties.dist < closestPt.properties.dist){ 
      closestPt = intersectPt;
      closestPt.properties.index = i;
    }
  }
  
  return closestPt;
}

// modified from http://jsfiddle.net/justin_c_rounds/Gd2S2/light/
function lineIntersects(line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY) {
  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point
  var denominator, a, b, numerator1, numerator2, result = {
    x: null,
    y: null,
    onLine1: false,
    onLine2: false
  };
  denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY));
  if (denominator == 0) {
    if(result.x != null && result.y != null) {
      return result;
    } else {
      return false;
    }
  }
  a = line1StartY - line2StartY;
  b = line1StartX - line2StartX;
  numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b);
  numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b);
  a = numerator1 / denominator;
  b = numerator2 / denominator;

  // if we cast these lines infinitely in both directions, they intersect here:
  result.x = line1StartX + (a * (line1EndX - line1StartX));
  result.y = line1StartY + (a * (line1EndY - line1StartY));

  // if line1 is a segment and line2 is infinite, they intersect if:
  if (a > 0 && a < 1) {
    result.onLine1 = true;
  }
  // if line2 is a segment and line1 is infinite, they intersect if:
  if (b > 0 && b < 1) {
    result.onLine2 = true;
  }
  // if line1 and line2 are segments, they intersect if both of the above are true
  if(result.onLine1 && result.onLine2){
    return [result.x, result.y];
  }
  else {
    return false;
  }
}

},{"turf-bearing":23,"turf-destination":67,"turf-distance":70,"turf-linestring":100,"turf-point":112}],111:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');
var centroid = require('turf-center');
var distance = require('turf-distance');
var inside = require('turf-inside');
var explode = require('turf-explode');

/**
 * Finds a {@link Point} guaranteed to be on the surface of
 * {@link GeoJSON} object.
 *
 * * Given a {@link Polygon}, the point will be in the area of the polygon
 * * Given a {@link LineString}, the point will be along the string
 * * Given a {@link Point}, the point will the same as the input
 *
 * @module turf/point-on-surface
 * @category measurement
 * @param {GeoJSON} input any GeoJSON object
 * @returns {Feature} a point on the surface of `input`
 * @example
 * // create a random polygon
 * var polygon = turf.random('polygon');
 *
 * //=polygon
 *
 * var pointOnPolygon = turf.pointOnSurface(polygon);
 *
* var resultFeatures = polygon.features.concat(pointOnPolygon);
* var result = {
*   "type": "FeatureCollection",
*   "features": resultFeatures
* };
 *
 * //=result
 */
module.exports = function(fc) {
  // normalize
  if(fc.type != 'FeatureCollection') {
    if(fc.type != 'Feature') {
      fc = {
        type: 'Feature',
        geometry: fc,
        properties: {}
      };
    }
    fc = featureCollection([fc]);
  }

  //get centroid
  var cent = centroid(fc);

  // check to see if centroid is on surface
  var onSurface = false;
  var i = 0;
  while(!onSurface && i < fc.features.length) {
    var geom = fc.features[i].geometry;
    if (geom.type === 'Point') {
      if (cent.geometry.coordinates[0] === geom.coordinates[0] &&
        cent.geometry.coordinates[1] === geom.coordinates[1]) {
        onSurface = true;
      }
    } else if(geom.type === 'MultiPoint') {
      var onMultiPoint = false;
      var k = 0;
      while(!onMultiPoint && k < geom.coordinates.length) {
        if (cent.geometry.coordinates[0] === geom.coordinates[k][0] &&
          cent.geometry.coordinates[1] === geom.coordinates[k][1]) {
          onSurface = true;
          onMultiPoint = true;
        }
        k++;
      }
    } else if(geom.type === 'LineString') {
      var onLine = false;
      var k = 0;
      while(!onLine && k < geom.coordinates.length - 1) {
        var x = cent.geometry.coordinates[0];
        var y = cent.geometry.coordinates[1];
        var x1 = geom.coordinates[k][0];
        var y1 = geom.coordinates[k][1];
        var x2 = geom.coordinates[k+1][0];
        var y2 = geom.coordinates[k+1][1];
        if(pointOnSegment(x, y, x1, y1, x2, y2)) {
          onLine = true;
          onSurface = true;
        }
        k++;
      }
    } else if(geom.type === 'MultiLineString') {
      var onMultiLine = false;
      var j = 0;
      while(!onMultiLine && j < geom.coordinates.length) {
        var onLine = false;
        var k = 0;
        var line = geom.coordinates[j];
        while(!onLine && k < line.length - 1) {
          var x = cent.geometry.coordinates[0];
          var y = cent.geometry.coordinates[1];
          var x1 = line[k][0];
          var y1 = line[k][1];
          var x2 = line[k+1][0];
          var y2 = line[k+1][1];
          if(pointOnSegment(x, y, x1, y1, x2, y2)) {
            onLine = true;
            onSurface = true;
          }
          k++;
        }
        j++;
      }
    } else if(geom.type === 'Polygon' || geom.type === 'MultiPolygon') {
      var f = {
        type: 'Feature',
        geometry: geom,
        properties: {}
      };
      if(inside(cent, f)) {
        onSurface = true;
      }
    }
    i++;
  }
  if(onSurface) {
    return cent;
  } else {
    var vertices = featureCollection([]);
    for(var i = 0; i < fc.features.length; i++) {
      vertices.features = vertices.features.concat(explode(fc.features[i]).features);
    }
    var closestVertex;
    var closestDistance = Infinity;
    for(var i = 0; i < vertices.features.length; i++) {
      var dist = distance(cent, vertices.features[i], 'miles');
      if(dist < closestDistance) {
        closestDistance = dist;
        closestVertex = vertices.features[i];
      }
    }
    return closestVertex;
  }
};

function pointOnSegment (x, y, x1, y1, x2, y2) {
  var ab = Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));
  var ap = Math.sqrt((x-x1)*(x-x1)+(y-y1)*(y-y1));
  var pb = Math.sqrt((x2-x)*(x2-x)+(y2-y)*(y2-y));
  if(ab === ap + pb) {
    return true;
  }
}

},{"turf-center":31,"turf-distance":70,"turf-explode":78,"turf-featurecollection":82,"turf-inside":86}],112:[function(require,module,exports){
/**
 * Takes coordinates and properties (optional) and returns a new {@link Point} feature.
 *
 * @module turf/point
 * @category helper
 * @param {number} longitude position west to east in decimal degrees
 * @param {number} latitude position south to north in decimal degrees
 * @param {Object} properties an Object that is used as the {@link Feature}'s
 * properties
 * @return {Point} a Point feature
 * @example
 * var pt1 = turf.point([-75.343, 39.984]);
 *
 * //=pt1
 */
var isArray = Array.isArray || function(arg) {
  return Object.prototype.toString.call(arg) === '[object Array]';
};
module.exports = function(coordinates, properties) {
  if (!isArray(coordinates)) throw new Error('Coordinates must be an array');
  if (coordinates.length < 2) throw new Error('Coordinates must be at least 2 numbers long');
  return {
    type: "Feature",
    geometry: {
      type: "Point",
      coordinates: coordinates
    },
    properties: properties || {}
  };
};

},{}],113:[function(require,module,exports){
/**
 * Takes an array of LinearRings and optionally an {@link Object} with properties and returns a GeoJSON {@link Polygon} feature.
 *
 * @module turf/polygon
 * @category helper
 * @param {Array<Array<Number>>} rings an array of LinearRings
 * @param {Object} properties an optional properties object
 * @return {Polygon} a Polygon feature
 * @throws {Error} throw an error if a LinearRing of the polygon has too few positions
 * or if a LinearRing of the Polygon does not have matching Positions at the
 * beginning & end.
 * @example
 * var polygon = turf.polygon([[
 *  [-2.275543, 53.464547],
 *  [-2.275543, 53.489271],
 *  [-2.215118, 53.489271],
 *  [-2.215118, 53.464547],
 *  [-2.275543, 53.464547]
 * ]], { name: 'poly1', population: 400});
 *
 * //=polygon
 */
module.exports = function(coordinates, properties){

  if (coordinates === null) throw new Error('No coordinates passed');

  for (var i = 0; i < coordinates.length; i++) {
    var ring = coordinates[i];
    for (var j = 0; j < ring[ring.length - 1].length; j++) {
      if (ring.length < 4) {
        throw new Error('Each LinearRing of a Polygon must have 4 or more Positions.');
      }
      if (ring[ring.length - 1][j] !== ring[0][j]) {
        throw new Error('First and last Position are not equivalent.');
      }
    }
  }

  var polygon = {
    "type": "Feature",
    "geometry": {
      "type": "Polygon",
      "coordinates": coordinates
    },
    "properties": properties
  };

  if (!polygon.properties) {
    polygon.properties = {};
  }

  return polygon;
};

},{}],114:[function(require,module,exports){
var ss = require('simple-statistics');

/**
* Takes a {@link FeatureCollection}, a property name, and a set of percentiles and returns a quantile array.
* @module turf/quantile
* @category classification
* @param {FeatureCollection} input a FeatureCollection of any type
* @param {String} field the property in `input` from which to retrieve quantile values
* @param {Array<number>} percentiles an Array of percentiles on which to calculate quantile values
* @return {Array<number>} an array of the break values
* @example
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 5
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [5, 5]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 40
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [1, 3]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 80
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [14, 2]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 90
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13, 1]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [19, 7]
*       }
*     }
*   ]
* };
*
* var breaks = turf.quantile(
*   points, 'population', [25, 50, 75, 99]);
*
* //=breaks
*/
module.exports = function(fc, field, percentiles){
  var vals = [];
  var quantiles = [];

  fc.features.forEach(function(feature){
    vals.push(feature.properties[field]);
  });
  percentiles.forEach(function(percentile){
    quantiles.push(ss.quantile(vals, percentile * 0.01));
  });
  return quantiles;
};

},{"simple-statistics":115}],115:[function(require,module,exports){
arguments[4][69][0].apply(exports,arguments)
},{"dup":69}],116:[function(require,module,exports){
var random = require('geojson-random');

/**
 * Generates random {@link GeoJSON} data, including {@link Point|Points} and {@link Polygon|Polygons}, for testing
 * and experimentation.
 *
 * @module turf/random
 * @category data
 * @param {String} [type='point'] type of features desired: 'points' or 'polygons'
 * @param {Number} [count=1] how many geometries should be generated.
 * @param {Object} options options relevant to the feature desired. Can include:
 * @param {Array<number>} options.bbox a bounding box inside of which geometries
 * are placed. In the case of {@link Point} features, they are guaranteed to be within this bounds,
 * while {@link Polygon} features have their centroid within the bounds.
 * @param {Number} [options.num_vertices=10] options.vertices the number of vertices added
 * to polygon features.
 * @param {Number} [options.max_radial_length=10] the total number of decimal
 * degrees longitude or latitude that a polygon can extent outwards to
 * from its center.
 * @return {FeatureCollection} generated random features
 * @example
 * var points = turf.random('points', 100, {
 *   bbox: [-70, 40, -60, 60]
 * });
 *
 * //=points
 *
 * var polygons = turf.random('polygons', 4, {
 *   bbox: [-70, 40, -60, 60]
 * });
 *
 * //=polygons
 */
module.exports = function(type, count, options) {
    options = options || {};
    count = count || 1;
    switch (type) {
        case 'point':
        case 'points':
        case undefined:
            return random.point(count, options.bbox);
        case 'polygon':
        case 'polygons':
            return random.polygon(
                count,
                options.num_vertices,
                options.max_radial_length,
                options.bbox);
        default:
            throw new Error('Unknown type given: valid options are points and polygons');
    }
};

},{"geojson-random":117}],117:[function(require,module,exports){
module.exports = function() {
    throw new Error('call .point() or .polygon() instead');
};

function position(bbox) {
    if (bbox) return coordInBBBOX(bbox);
    else return [lon(), lat()];
}

module.exports.position = position;

module.exports.point = function(count, bbox) {
    var features = [];
    for (i = 0; i < count; i++) {
        features.push(feature(bbox ? point(position(bbox)) : point()));
    }
    return collection(features);
};

module.exports.polygon = function(count, num_vertices, max_radial_length, bbox) {
    if (typeof num_vertices !== 'number') num_vertices = 10;
    if (typeof max_radial_length !== 'number') max_radial_length = 10;
    var features = [];
    for (i = 0; i < count; i++) {
        var vertices = [],
            circle_offsets = Array.apply(null,
                new Array(num_vertices + 1)).map(Math.random);

        circle_offsets.forEach(sumOffsets);
        circle_offsets.forEach(scaleOffsets);
        vertices[vertices.length - 1] = vertices[0]; // close the ring

        // center the polygon around something
        vertices = vertices.map(vertexToCoordinate(position(bbox)));
        features.push(feature(polygon([vertices])));
    }

    function sumOffsets(cur, index, arr) {
        arr[index] = (index > 0) ? cur + arr[index - 1] : cur;
    }

    function scaleOffsets(cur, index) {
        cur = cur * 2 * Math.PI / circle_offsets[circle_offsets.length - 1];
        var radial_scaler = Math.random();
        vertices.push([
            radial_scaler * max_radial_length * Math.sin(cur),
            radial_scaler * max_radial_length * Math.cos(cur)
        ]);
    }

    return collection(features);
};


function vertexToCoordinate(hub) {
    return function(cur, index) { return [cur[0] + hub[0], cur[1] + hub[1]]; };
}

function rnd() { return Math.random() - 0.5; }
function lon() { return rnd() * 360; }
function lat() { return rnd() * 180; }

function point(coordinates) {
    return {
        type: 'Point',
        coordinates: coordinates || [lon(), lat()]
    };
}

function coordInBBBOX(bbox) {
    return [
        (Math.random() * (bbox[2] - bbox[0])) + bbox[0],
        (Math.random() * (bbox[3] - bbox[1])) + bbox[1]];
}

function pointInBBBOX() {
    return {
        type: 'Point',
        coordinates: [lon(), lat()]
    };
}

function polygon(coordinates) {
    return {
        type: 'Polygon',
        coordinates: coordinates
    };
}

function feature(geom) {
    return {
        type: 'Feature',
        geometry: geom,
        properties: {}
    };
}

function collection(f) {
    return {
        type: 'FeatureCollection',
        features: f
    };
}

},{}],118:[function(require,module,exports){
var featurecollection = require('turf-featurecollection');
var reclass = require('./index.js');

/**
 * Takes a {@link FeatureCollection}, an input field, an output field, and
 * an array of translations and outputs an identical FeatureCollection with
 * the output field property populated.
* @module turf/reclass
* @category classification
* @param {FeatureCollection} input a FeatureCollection of any type
* @param {string} inField the field to translate
* @param {string} outField the field in which to store translated results
* @param {Array<number>} translations an array of translations
* @return {FeatureCollection} a FeatureCollection with identical geometries to `input` but with `outField` populated.
* @example
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.170547, 32.888669]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.182048, 32.889533]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.17398, 32.882182]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.174324, 32.895011]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.185825, 32.884344]
*       }
*     }
*   ]
* };
* // 0 to 200 will map to "small", 200 to 400 will map to "medium", 400 to 600 will map to "large"
* var translations = [
*   [0, 200, "small"],
*   [200, 400, "medium"],
*   [400, 600, "large"]
* ];
*
* var reclassed = turf.reclass(
*   points, 'population', 'size', translations);
*
* //=reclassed
*
*/
module.exports = function(fc, inField, outField, translations, done){
  var reclassed = featurecollection([]);

  fc.features.forEach(function(feature){
    var reclassedFeature;
    var found = false;
    for(var i = 0; i < translations.length; i++){
      if(feature.properties[inField] >= translations[i][0] && feature.properties[inField] <= translations[i][1]) {
        feature.properties[outField] = translations[i][2];
      }
    }
    reclassed.features.push(feature);
  });

  return reclassed;
};

},{"./index.js":118,"turf-featurecollection":82}],119:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} of any type, a property, and a value and
 * returns a FeatureCollection with features matching that
 * property-value pair removed.
 *
 * @module turf/remove
 * @category data
 * @param {FeatureCollection} features a FeatureCollection of any type
 * @param {String} property the property to filter
 * @param {String} value the value to filter
 * @return {FeatureCollection} the resulting FeatureCollection without features that match the property-value pair
 * @example
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#00f'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.235004, 5.551918]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#f00'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.209598, 5.56439]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#00f'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.197753, 5.556018]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#000'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.217323, 5.549526]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#0f0'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.211315, 5.543887]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#00f'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.202217, 5.547134]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#0f0'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.231227, 5.56644]
 *       }
 *     }
 *   ]
 * };
 *
 * //=points
 *
 * var filtered = turf.remove(points, 'marker-color', '#00f');
 *
 * //=filtered
*/
module.exports = function(collection, key, val) {
  var newFC = featureCollection([]);
  for(var i = 0; i < collection.features.length; i++) {
    if(collection.features[i].properties[key] != val) {
      newFC.features.push(collection.features[i]);
    }
  }
  return newFC;
};

},{"turf-featurecollection":82}],120:[function(require,module,exports){
// http://stackoverflow.com/questions/11935175/sampling-a-random-subset-from-an-array
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} and returns a FeatureCollection with given number of {@link Feature|features} at random.
 *
 * @module turf/sample
 * @category data
 * @param {FeatureCollection} features a FeatureCollection of any type
 * @param {number} n number of features to select
 * @return {FeatureCollection} a FeatureCollection with `n` features
 * @example
 * var points = turf.random('points', 1000);
 *
 * //=points
 *
 * var sample = turf.sample(points, 10);
 *
 * //=sample
 */
module.exports = function(fc, num){
  var outFC = featureCollection(getRandomSubarray(fc.features, num));
  return outFC;
};

function getRandomSubarray(arr, size) {
  var shuffled = arr.slice(0), i = arr.length, min = i - size, temp, index;
  while (i-- > min) {
      index = Math.floor((i + 1) * Math.random());
      temp = shuffled[index];
      shuffled[index] = shuffled[i];
      shuffled[i] = temp;
  }
  return shuffled.slice(min);
}

},{"turf-featurecollection":82}],121:[function(require,module,exports){
var simplify = require('simplify-js');

/**
 * Takes a {@link LineString} or {@link Polygon} feature and returns a simplified version. Internally uses [simplify-js](http://mourner.github.io/simplify-js/) to perform simplification.
 *
 * @module turf/simplify
 * @category transformation
 * @param {Feature} feature a {@link LineString} or {@link Polygon} feature to be simplified
 * @param {number} tolerance simplification tolerance
 * @param {boolean} highQuality whether or not to spend more time to create
 * a higher-quality simplification with a different algorithm
 * @return {Feature} a simplified feature
 * @example
  * var feature = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-70.603637, -33.399918],
 *       [-70.614624, -33.395332],
 *       [-70.639343, -33.392466],
 *       [-70.659942, -33.394759],
 *       [-70.683975, -33.404504],
 *       [-70.697021, -33.419406],
 *       [-70.701141, -33.434306],
 *       [-70.700454, -33.446339],
 *       [-70.694274, -33.458369],
 *       [-70.682601, -33.465816],
 *       [-70.668869, -33.472117],
 *       [-70.646209, -33.473835],
 *       [-70.624923, -33.472117],
 *       [-70.609817, -33.468107],
 *       [-70.595397, -33.458369],
 *       [-70.587158, -33.442901],
 *       [-70.587158, -33.426283],
 *       [-70.590591, -33.414248],
 *       [-70.594711, -33.406224],
 *       [-70.603637, -33.399918]
 *     ]]
 *   }
 * };

 * var tolerance = 0.01;
 *
 * var simplified = turf.simplify(
 *  feature, tolerance, false);
 *
 * //=feature
 *
 * //=simplified
 */
module.exports = function(feature, tolerance, highQuality){
  if(feature.geometry.type === 'LineString') {
    var line = {
      type: 'LineString',
      coordinates: []
    };
    var pts = feature.geometry.coordinates.map(function(coord) {
      return {x: coord[0], y: coord[1]};
    });
    line.coordinates = simplify(pts, tolerance, highQuality).map(function(coords){
      return [coords.x, coords.y];
    });
    
    return simpleFeature(line, feature.properties);
  } else if(feature.geometry.type === 'Polygon') {
    var poly = {
      type: 'Polygon',
      coordinates: []
    };
    feature.geometry.coordinates.forEach(function(ring){
      var pts = ring.map(function(coord) {
        return {x: coord[0], y: coord[1]};
      });
      var simpleRing = simplify(pts, tolerance, highQuality).map(function(coords){
        return [coords.x, coords.y];
      });
      poly.coordinates.push(simpleRing);
    });
    return simpleFeature(poly, feature.properties)
  }
}

function simpleFeature (geom, properties) {
  return {
    type: 'Feature',
    geometry: geom,
    properties: properties
  };
}

},{"simplify-js":122}],122:[function(require,module,exports){
/*
 (c) 2013, Vladimir Agafonkin
 Simplify.js, a high-performance JS polyline simplification library
 mourner.github.io/simplify-js
*/

(function () { 'use strict';

// to suit your point format, run search/replace for '.x' and '.y';
// for 3D version, see 3d branch (configurability would draw significant performance overhead)

// square distance between 2 points
function getSqDist(p1, p2) {

    var dx = p1.x - p2.x,
        dy = p1.y - p2.y;

    return dx * dx + dy * dy;
}

// square distance from a point to a segment
function getSqSegDist(p, p1, p2) {

    var x = p1.x,
        y = p1.y,
        dx = p2.x - x,
        dy = p2.y - y;

    if (dx !== 0 || dy !== 0) {

        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);

        if (t > 1) {
            x = p2.x;
            y = p2.y;

        } else if (t > 0) {
            x += dx * t;
            y += dy * t;
        }
    }

    dx = p.x - x;
    dy = p.y - y;

    return dx * dx + dy * dy;
}
// rest of the code doesn't care about point format

// basic distance-based simplification
function simplifyRadialDist(points, sqTolerance) {

    var prevPoint = points[0],
        newPoints = [prevPoint],
        point;

    for (var i = 1, len = points.length; i < len; i++) {
        point = points[i];

        if (getSqDist(point, prevPoint) > sqTolerance) {
            newPoints.push(point);
            prevPoint = point;
        }
    }

    if (prevPoint !== point) newPoints.push(point);

    return newPoints;
}

// simplification using optimized Douglas-Peucker algorithm with recursion elimination
function simplifyDouglasPeucker(points, sqTolerance) {

    var len = points.length,
        MarkerArray = typeof Uint8Array !== 'undefined' ? Uint8Array : Array,
        markers = new MarkerArray(len),
        first = 0,
        last = len - 1,
        stack = [],
        newPoints = [],
        i, maxSqDist, sqDist, index;

    markers[first] = markers[last] = 1;

    while (last) {

        maxSqDist = 0;

        for (i = first + 1; i < last; i++) {
            sqDist = getSqSegDist(points[i], points[first], points[last]);

            if (sqDist > maxSqDist) {
                index = i;
                maxSqDist = sqDist;
            }
        }

        if (maxSqDist > sqTolerance) {
            markers[index] = 1;
            stack.push(first, index, index, last);
        }

        last = stack.pop();
        first = stack.pop();
    }

    for (i = 0; i < len; i++) {
        if (markers[i]) newPoints.push(points[i]);
    }

    return newPoints;
}

// both algorithms combined for awesome performance
function simplify(points, tolerance, highestQuality) {

    var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;

    points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);
    points = simplifyDouglasPeucker(points, sqTolerance);

    return points;
}

// export as AMD module / Node module / browser or worker variable
if (typeof define === 'function' && define.amd) define(function() { return simplify; });
else if (typeof module !== 'undefined') module.exports = simplify;
else if (typeof self !== 'undefined') self.simplify = simplify;
else window.simplify = simplify;

})();

},{}],123:[function(require,module,exports){
/**
 * Takes a bounding box and returns a new bounding box with a size expanded or contracted
 * by a factor of X.
 *
 * @module turf/size
 * @category measurement
 * @param {Array<number>} bbox a bounding box
 * @param {number} factor the ratio of the new bbox to the input bbox
 * @return {Array<number>} the resized bbox
 * @example
 * var bbox = [0, 0, 10, 10]
 *
 * var resized = turf.size(bbox, 2);
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     turf.bboxPolygon(bbox),
 *     turf.bboxPolygon(resized)
 *   ]
 * };
 *
 * //=features
 */
module.exports = function(bbox, factor){
  var currentXDistance = (bbox[2] - bbox[0]);
  var currentYDistance = (bbox[3] - bbox[1]);
  var newXDistance = currentXDistance * factor;
  var newYDistance = currentYDistance * factor;
  var xChange = newXDistance - currentXDistance;
  var yChange = newYDistance - currentYDistance;

  var lowX = bbox[0] - (xChange / 2);
  var lowY = bbox[1] - (yChange / 2);
  var highX = (xChange / 2) + bbox[2];
  var highY = (yChange / 2) + bbox[3];

  var sized = [lowX, lowY, highX, highY];
  return sized;
}

},{}],124:[function(require,module,exports){
var featurecollection = require('turf-featurecollection');
var point = require('turf-point');
var polygon = require('turf-polygon');
var distance = require('turf-distance');

/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Polygon} features in a grid.
 *
 * @module turf/square-grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} cellWidth width of each cell
 * @param {String} units units to use for cellWidth
 * @return {FeatureCollection} grid as FeatureCollection with {@link Polygon} features
 * @example
 * var extent = [-77.3876953125,38.71980474264239,-76.9482421875,39.027718840211605];
 * var cellWidth = 10;
 * var units = 'miles';
 *
 * var squareGrid = turf.squareGrid(extent, cellWidth, units);
 *
 * //=squareGrid
 */
module.exports = function (bbox, cell, units) {
  var fc = featurecollection([]);
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);

  var currentX = bbox[0];
  while (currentX <= bbox[2]) {
    var currentY = bbox[1];
    while (currentY <= bbox[3]) {
      var cellPoly = polygon([[
          [currentX, currentY],
          [currentX, currentY+cellHeight],
          [currentX+cellWidth, currentY+cellHeight],
          [currentX+cellWidth, currentY],
          [currentX, currentY]
        ]]);
      fc.features.push(cellPoly);

      currentY += cellHeight;
    }
    currentX += cellWidth;
  }
  
  return fc;
}

},{"turf-distance":70,"turf-featurecollection":82,"turf-point":112,"turf-polygon":113}],125:[function(require,module,exports){
var midpoint = require('turf-midpoint');
var point = require('turf-point');
var distance = require('turf-distance');

/**
 * Takes a bounding box and calculates the minimum square bounding box that would contain the input.
 *
 * @module turf/square
 * @category measurement
 * @param {Array<number>} bbox a bounding box
 * @return {Array<number>} a square surrounding `bbox`
 * @example
 * var bbox = [-20,-20,-15,0];
 *
 * var squared = turf.square(bbox);
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     turf.bboxPolygon(bbox),
 *     turf.bboxPolygon(squared)
 *   ]
 * };
 *
 * //=features
 */
module.exports = function(bbox){
  var squareBbox = [0,0,0,0];
  var lowLeft = point([bbox[0], bbox[1]]);
  var topLeft = point([bbox[0], bbox[3]]);
  var topRight = point([bbox[2], bbox[3]]);
  var lowRight = point([bbox[2], bbox[1]]);

  var horizontalDistance = distance(lowLeft, lowRight, 'miles');
  var verticalDistance = distance(lowLeft, topLeft, 'miles');
  if(horizontalDistance >= verticalDistance){
    squareBbox[0] = bbox[0];
    squareBbox[2] = bbox[2];
    var verticalMidpoint = midpoint(lowLeft, topLeft);
    squareBbox[1] = verticalMidpoint.geometry.coordinates[1] - ((bbox[2] - bbox[0]) / 2);
    squareBbox[3] = verticalMidpoint.geometry.coordinates[1] + ((bbox[2] - bbox[0]) / 2);
    return squareBbox;
  }
  else {
    squareBbox[1] = bbox[1];
    squareBbox[3] = bbox[3];
    var horzontalMidpoint = midpoint(lowLeft, lowRight);
    squareBbox[0] = horzontalMidpoint.geometry.coordinates[0] - ((bbox[3] - bbox[1]) / 2);
    squareBbox[2] = horzontalMidpoint.geometry.coordinates[0] + ((bbox[3] - bbox[1]) / 2);
    return squareBbox;
  }
}


},{"turf-distance":70,"turf-midpoint":105,"turf-point":112}],126:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the sum of a field for {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/sum
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {String} inField the field in input data to analyze
 * @param {String} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField`
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-87.990188, 43.026486],
 *           [-87.990188, 43.062115],
 *           [-87.913284, 43.062115],
 *           [-87.913284, 43.026486],
 *           [-87.990188, 43.026486]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-87.973709, 42.962452],
 *           [-87.973709, 43.014689],
 *           [-87.904014, 43.014689],
 *           [-87.904014, 42.962452],
 *           [-87.973709, 42.962452]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.974052, 43.049321]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.957229, 43.037277]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.931137, 43.048568]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.963409, 42.99611]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.94178, 42.974762]
 *       }
 *     }
 *   ]
 * };
 *
 * var aggregated = turf.sum(
 *   polygons, points, 'population', 'sum');
 *
 * var resultFeatures = points.features.concat(
 *   aggregated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = sum(values);
  });

  return polyFC;
};

function sum(x) {
    var value = 0;
    for (var i = 0; i < x.length; i++) {
        value += x[i];
    }
    return value;
}

},{"turf-inside":86}],127:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a FeatureCollection of {@link Polygon} features and performs a spatial join.
 *
 * @module turf/tag
 * @category joins
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {String} polyId property in `polygons` to add to joined Point features
 * @param {String} containingPolyId property in `points` in which to store joined property from `polygons
 * @return {FeatureCollection} a FeatureCollection of point features
 * @example
 * var bbox = [0, 0, 50, 50];
 * // create a triangular grid of polygons
 * var triangleGrid = turf.tin(turf.grid(bbox, 10));
 * triangleGrid.features.forEach(function(f) {
 *   f.properties.fill = '#' +
 *     (~~(Math.random() * 16)).toString(16) +
 *     (~~(Math.random() * 16)).toString(16) +
 *     (~~(Math.random() * 16)).toString(16);
 *   f.properties.stroke = 0;
 *   f.properties['fill-opacity'] = 1;
 * });
 * var randomPoints = turf.random('point', 30, {
 *   bbox: bbox
 * });
 * var both = turf.featurecollection(
 *   triangleGrid.features.concat(randomPoints.features));
 *
 * //=both
 *
 * var tagged = turf.tag(randomPoints, triangleGrid,
 *                       'fill', 'marker-color');
 *
 * //=tagged
 */
module.exports = function(points, polygons, field, outField){
  // prevent mutations
  points = JSON.parse(JSON.stringify(points));
  polygons = JSON.parse(JSON.stringify(polygons));
  points.features.forEach(function(pt) {
    if (!pt.properties) {
      pt.properties = {};
    }
    polygons.features.forEach(function(poly) {
      if (pt.properties[outField] === undefined) {
        var isInside = inside(pt, poly);
        if (isInside) {
          pt.properties[outField] = poly.properties[field];
        }
      }
    });
  });
  return points;
};

},{"turf-inside":86}],128:[function(require,module,exports){
//http://en.wikipedia.org/wiki/Delaunay_triangulation
//https://github.com/ironwallaby/delaunay
var polygon = require('turf-polygon');
var featurecollection = require('turf-featurecollection');

/**
 * Takes a set of points and the name of a z-value property and
 * creates a [Triangulated Irregular Network](http://en.wikipedia.org/wiki/Triangulated_irregular_network),
 * or a TIN for short, returned as a collection of Polygons. These are often used
 * for developing elevation contour maps or stepped heat visualizations.
 *
 * This triangulates the points, as well as adds properties called `a`, `b`,
 * and `c` representing the value of the given `propertyName` at each of
 * the points that represent the corners of the triangle.
 *
 * @module turf/tin
 * @category interpolation
 * @param {FeatureCollection} points - a GeoJSON FeatureCollection containing
 * Features with {@link Point} geometries
 * @param {string=} propertyName - name of the property from which to pull z values.
 * This is optional: if not given, then there will be no extra data added to the derived triangles.
 * @return {FeatureCollection} TIN output
 * @example
 * // generate some random point data
 * var points = turf.random('points', 30, {
 *   bbox: [50, 30, 70, 50]
 * });
 * //=points
 * // add a random property to each point between 0 and 9
 * for (var i = 0; i < points.features.length; i++) {
 *   points.features[i].properties.z = ~~(Math.random() * 9);
 * }
 * var tin = turf.tin(points, 'z')
 * for (var i = 0; i < tin.features.length; i++) {
 *   var properties  = tin.features[i].properties;
 *   // roughly turn the properties of each
 *   // triangle into a fill color
 *   // so we can visualize the result
 *   properties.fill = '#' + properties.a +
 *     properties.b + properties.c;
 * }
 * //=tin
 */
module.exports = function(points, z) {
  //break down points
  return featurecollection(triangulate(points.features.map(function(p) {
    var point = {
      x: p.geometry.coordinates[0],
      y: p.geometry.coordinates[1]
    };
    if (z) point.z = p.properties[z];
    return point;
  })).map(function(triangle) {
    return polygon([[
        [triangle.a.x, triangle.a.y],
        [triangle.b.x, triangle.b.y],
        [triangle.c.x, triangle.c.y],
        [triangle.a.x, triangle.a.y]
    ]], {
        a: triangle.a.z,
        b: triangle.b.z,
        c: triangle.c.z
      });
  }));
};

function Triangle(a, b, c) {
  this.a = a;
  this.b = b;
  this.c = c;

  var A = b.x - a.x,
    B = b.y - a.y,
    C = c.x - a.x,
    D = c.y - a.y,
    E = A * (a.x + b.x) + B * (a.y + b.y),
    F = C * (a.x + c.x) + D * (a.y + c.y),
    G = 2 * (A * (c.y - b.y) - B * (c.x - b.x)),
    minx, miny, dx, dy;

  // If the points of the triangle are collinear, then just find the
  // extremes and use the midpoint as the center of the circumcircle.
  if (Math.abs(G) < 0.000001) {
    minx = Math.min(a.x, b.x, c.x);
    miny = Math.min(a.y, b.y, c.y);
    dx = (Math.max(a.x, b.x, c.x) - minx) * 0.5;
    dy = (Math.max(a.y, b.y, c.y) - miny) * 0.5;

    this.x = minx + dx;
    this.y = miny + dy;
    this.r = dx * dx + dy * dy;
  } else {
    this.x = (D * E - B * F) / G;
    this.y = (A * F - C * E) / G;
    dx = this.x - a.x;
    dy = this.y - a.y;
    this.r = dx * dx + dy * dy;
  }
}

function byX(a, b) {
  return b.x - a.x;
}

function dedup(edges) {
  var j = edges.length,
    a, b, i, m, n;

  outer:
  while (j) {
    b = edges[--j];
    a = edges[--j];
    i = j;
    while (i) {
      n = edges[--i];
      m = edges[--i];
      if ((a === m && b === n) || (a === n && b === m)) {
        edges.splice(j, 2);
        edges.splice(i, 2);
        j -= 2;
        continue outer;
      }
    }
  }
}

function triangulate(vertices) {
  // Bail if there aren't enough vertices to form any triangles.
  if (vertices.length < 3)
    return [];

    // Ensure the vertex array is in order of descending X coordinate
    // (which is needed to ensure a subquadratic runtime), and then find
    // the bounding box around the points. 
  vertices.sort(byX);

  var i = vertices.length - 1,
    xmin = vertices[i].x,
    xmax = vertices[0].x,
    ymin = vertices[i].y,
    ymax = ymin;

  while (i--) {
    if (vertices[i].y < ymin)
      ymin = vertices[i].y;
    if (vertices[i].y > ymax)
      ymax = vertices[i].y;
  }

  //Find a supertriangle, which is a triangle that surrounds all the
  //vertices. This is used like something of a sentinel value to remove
  //cases in the main algorithm, and is removed before we return any
  // results.
 
  // Once found, put it in the "open" list. (The "open" list is for
  // triangles who may still need to be considered; the "closed" list is
  // for triangles which do not.)
  var dx = xmax - xmin,
    dy = ymax - ymin,
    dmax = (dx > dy) ? dx : dy,
    xmid = (xmax + xmin) * 0.5,
    ymid = (ymax + ymin) * 0.5,
    open = [
      new Triangle({
        x: xmid - 20 * dmax,
        y: ymid - dmax,
        __sentinel: true
      },
      {
        x: xmid,
        y: ymid + 20 * dmax,
        __sentinel: true
      },
      {
        x: xmid + 20 * dmax,
        y: ymid - dmax,
        __sentinel: true
      }
    )],
    closed = [],
    edges = [],
    j, a, b;

    // Incrementally add each vertex to the mesh.
  i = vertices.length;
  while (i--) {
    // For each open triangle, check to see if the current point is
    // inside it's circumcircle. If it is, remove the triangle and add
    // it's edges to an edge list.
    edges.length = 0;
    j = open.length;
    while (j--) {
      // If this point is to the right of this triangle's circumcircle,
      // then this triangle should never get checked again. Remove it
      // from the open list, add it to the closed list, and skip.
      dx = vertices[i].x - open[j].x;
      if (dx > 0 && dx * dx > open[j].r) {
        closed.push(open[j]);
        open.splice(j, 1);
        continue;
      }

      // If not, skip this triangle.
      dy = vertices[i].y - open[j].y;
      if (dx * dx + dy * dy > open[j].r)
        continue;

      // Remove the triangle and add it's edges to the edge list.
      edges.push(
        open[j].a, open[j].b,
        open[j].b, open[j].c,
        open[j].c, open[j].a
      );
      open.splice(j, 1);
    }

    // Remove any doubled edges.
    dedup(edges);

    // Add a new triangle for each edge.
    j = edges.length;
    while (j) {
      b = edges[--j];
      a = edges[--j];
      open.push(new Triangle(a, b, vertices[i]));
    }
  }

  // Copy any remaining open triangles to the closed list, and then
  // remove any triangles that share a vertex with the supertriangle.
  Array.prototype.push.apply(closed, open);

  i = closed.length;
  while (i--)
  if (closed[i].a.__sentinel ||
      closed[i].b.__sentinel ||
      closed[i].c.__sentinel)
      closed.splice(i, 1);

  return closed;
}

},{"turf-featurecollection":82,"turf-polygon":113}],129:[function(require,module,exports){
var featurecollection = require('turf-featurecollection');
var point = require('turf-point');
var polygon = require('turf-polygon');
var distance = require('turf-distance');

/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Polygon} features in a grid.
 *
 * @module turf/triangle-grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} cellWidth width of each cell
 * @param {String} units units to use for cellWidth
 * @return {FeatureCollection} grid as FeatureCollection with {@link Polygon} features
 * @example
 * var extent = [-77.3876953125,38.71980474264239,-76.9482421875,39.027718840211605];
 * var cellWidth = 10;
 * var units = 'miles';
 *
 * var triangleGrid = turf.triangleGrid(extent, cellWidth, units);
 *
 * //=triangleGrid
 */
module.exports = function (bbox, cell, units) {
  var fc = featurecollection([]);
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);

  var xi = 0;
  var currentX = bbox[0];
  while (currentX <= bbox[2]) {
    var yi = 0;
    var currentY = bbox[1];
    while (currentY <= bbox[3]) {
      if(xi%2===0 && yi%2===0) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY+cellHeight]
          ]]);
        fc.features.push(cell2);
      } else if(xi%2===0 && yi%2===1) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX, currentY]
          ]]);
        fc.features.push(cell2);
      } else if(yi%2===0 && xi%2===1) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell2);
      } else if(yi%2===1 && xi%2===1) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY+cellHeight]
          ]]);
        fc.features.push(cell2);
      }
      currentY += cellHeight;
      yi++;
    }
    xi++;
    currentX += cellWidth;
  }
  return fc;
};


},{"turf-distance":70,"turf-featurecollection":82,"turf-point":112,"turf-polygon":113}],130:[function(require,module,exports){
// look here for help http://svn.osgeo.org/grass/grass/branches/releasebranch_6_4/vector/v.overlay/main.c
//must be array of polygons

// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html

var jsts = require('jsts');

/**
 * Takes two {@link Polygon} features and returnes a combined {@link Polygon} feature. If the input Polygon features are not contiguous, this function returns a {@link MultiPolygon} feature.
 *
 * @module turf/union
 * @category transformation
 * @param {Polygon} poly1 an input Polygon
 * @param {Polygon} poly2 another input Polygon
 * @return {Feature} a combined {@link Polygon} or {@link MultiPolygon} feature
 * @example
 * var poly1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-82.574787, 35.594087],
 *       [-82.574787, 35.615581],
 *       [-82.545261, 35.615581],
 *       [-82.545261, 35.594087],
 *       [-82.574787, 35.594087]
 *     ]]
 *   }
 * };
 * var poly2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#00f"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-82.560024, 35.585153],
 *       [-82.560024, 35.602602],
 *       [-82.52964, 35.602602],
 *       [-82.52964, 35.585153],
 *       [-82.560024, 35.585153]
 *     ]]
 *   }
 * };
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [poly1, poly2]
 * };
 *
 * var union = turf.union(poly1, poly2);
 *
 * //=polygons
 *
 * //=union
 */
module.exports = function(poly1, poly2){
  var reader = new jsts.io.GeoJSONReader();
  var a = reader.read(JSON.stringify(poly1.geometry));
  var b = reader.read(JSON.stringify(poly2.geometry));
  var union = a.union(b);
  var parser = new jsts.io.GeoJSONParser();

  union = parser.write(union);
  return {
    type: 'Feature',
    geometry: union,
    properties: poly1.properties
  };
}

},{"jsts":131}],131:[function(require,module,exports){
arguments[4][27][0].apply(exports,arguments)
},{"./lib/jsts":132,"dup":27,"javascript.util":134}],132:[function(require,module,exports){
arguments[4][28][0].apply(exports,arguments)
},{"dup":28}],133:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],134:[function(require,module,exports){
arguments[4][30][0].apply(exports,arguments)
},{"./dist/javascript.util-node.min.js":133,"dup":30}],135:[function(require,module,exports){
var ss = require('simple-statistics');
var inside = require('turf-inside');

/**
 * Calculates the variance value of a field for {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/variance
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} inField the field in input data to analyze
 * @param {string} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField`
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.414398, 37.684092],
 *           [-97.414398, 37.731353],
 *           [-97.332344, 37.731353],
 *           [-97.332344, 37.684092],
 *           [-97.414398, 37.684092]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.333717, 37.606072],
 *           [-97.333717, 37.675397],
 *           [-97.237586, 37.675397],
 *           [-97.237586, 37.606072],
 *           [-97.333717, 37.606072]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.401351, 37.719676]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.355346, 37.706639]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.387962, 37.70012]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.301788, 37.66507]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.265052, 37.643325]
 *       }
 *     }
 *   ]
 * };
 *
 * var aggregated = turf.variance(
 *   polygons, points, 'population', 'variance');
 *
 * var resultFeatures = points.features.concat(
 *   aggregated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function (polyFC, ptFC, inField, outField) {
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = ss.variance(values);
  });

  return polyFC;
};

},{"simple-statistics":136,"turf-inside":86}],136:[function(require,module,exports){
arguments[4][69][0].apply(exports,arguments)
},{"dup":69}],137:[function(require,module,exports){
var inside = require('turf-inside');
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a FeatureCollection of {@link Polygon} features and returns a FeatureCollection of Point features representing all points that fall within a collection of polygons.
 *
 * @module turf/within
 * @category joins
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @return {FeatureCollection} a collection of all points that land
 * within at least one polygon
 * @example
 * var searchWithin = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-46.653,-23.543],
 *           [-46.634,-23.5346],
 *           [-46.613,-23.543],
 *           [-46.614,-23.559],
 *           [-46.631,-23.567],
 *           [-46.653,-23.560],
 *           [-46.653,-23.543]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6318, -23.5523]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6246, -23.5325]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6062, -23.5513]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.663, -23.554]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.643, -23.557]
 *       }
 *     }
 *   ]
 * };
 *
 * var ptsWithin = turf.within(points, searchWithin);
 *
 * //=points
 *
 * //=searchWithin
 *
 * //=ptsWithin
 */
module.exports = function(ptFC, polyFC){
  var pointsWithin = featureCollection([]);
  for (var i = 0; i < polyFC.features.length; i++) {
    for (var j = 0; j < ptFC.features.length; j++) {
      var isInside = inside(ptFC.features[j], polyFC.features[i]);
      if(isInside){
        pointsWithin.features.push(ptFC.features[j]);
      }
    }
  }
  return pointsWithin;
};

},{"turf-featurecollection":82,"turf-inside":86}],138:[function(require,module,exports){
"use strict";
var window = require("global/window")
var once = require("once")
var parseHeaders = require("parse-headers")



module.exports = createXHR
createXHR.XMLHttpRequest = window.XMLHttpRequest || noop
createXHR.XDomainRequest = "withCredentials" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest


function isEmpty(obj){
    for(var i in obj){
        if(obj.hasOwnProperty(i)) return false
    }
    return true
}

function createXHR(options, callback) {
    function readystatechange() {
        if (xhr.readyState === 4) {
            loadFunc()
        }
    }

    function getBody() {
        // Chrome with requestType=blob throws errors arround when even testing access to responseText
        var body = undefined

        if (xhr.response) {
            body = xhr.response
        } else if (xhr.responseType === "text" || !xhr.responseType) {
            body = xhr.responseText || xhr.responseXML
        }

        if (isJson) {
            try {
                body = JSON.parse(body)
            } catch (e) {}
        }

        return body
    }

    var failureResponse = {
                body: undefined,
                headers: {},
                statusCode: 0,
                method: method,
                url: uri,
                rawRequest: xhr
            }

    function errorFunc(evt) {
        clearTimeout(timeoutTimer)
        if(!(evt instanceof Error)){
            evt = new Error("" + (evt || "Unknown XMLHttpRequest Error") )
        }
        evt.statusCode = 0
        callback(evt, failureResponse)
    }

    // will load the data & process the response in a special response object
    function loadFunc() {
        if (aborted) return
        var status
        clearTimeout(timeoutTimer)
        if(options.useXDR && xhr.status===undefined) {
            //IE8 CORS GET successful response doesn't have a status field, but body is fine
            status = 200
        } else {
            status = (xhr.status === 1223 ? 204 : xhr.status)
        }
        var response = failureResponse
        var err = null

        if (status !== 0){
            response = {
                body: getBody(),
                statusCode: status,
                method: method,
                headers: {},
                url: uri,
                rawRequest: xhr
            }
            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE
                response.headers = parseHeaders(xhr.getAllResponseHeaders())
            }
        } else {
            err = new Error("Internal XMLHttpRequest Error")
        }
        callback(err, response, response.body)

    }

    if (typeof options === "string") {
        options = { uri: options }
    }

    options = options || {}
    if(typeof callback === "undefined"){
        throw new Error("callback argument missing")
    }
    callback = once(callback)

    var xhr = options.xhr || null

    if (!xhr) {
        if (options.cors || options.useXDR) {
            xhr = new createXHR.XDomainRequest()
        }else{
            xhr = new createXHR.XMLHttpRequest()
        }
    }

    var key
    var aborted
    var uri = xhr.url = options.uri || options.url
    var method = xhr.method = options.method || "GET"
    var body = options.body || options.data
    var headers = xhr.headers = options.headers || {}
    var sync = !!options.sync
    var isJson = false
    var timeoutTimer

    if ("json" in options) {
        isJson = true
        headers["accept"] || headers["Accept"] || (headers["Accept"] = "application/json") //Don't override existing accept header declared by user
        if (method !== "GET" && method !== "HEAD") {
            headers["content-type"] || headers["Content-Type"] || (headers["Content-Type"] = "application/json") //Don't override existing accept header declared by user
            body = JSON.stringify(options.json)
        }
    }

    xhr.onreadystatechange = readystatechange
    xhr.onload = loadFunc
    xhr.onerror = errorFunc
    // IE9 must have onprogress be set to a unique function.
    xhr.onprogress = function () {
        // IE must die
    }
    xhr.ontimeout = errorFunc
    xhr.open(method, uri, !sync, options.username, options.password)
    //has to be after open
    if(!sync) {
        xhr.withCredentials = !!options.withCredentials
    }
    // Cannot set timeout with sync request
    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly
    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent
    if (!sync && options.timeout > 0 ) {
        timeoutTimer = setTimeout(function(){
            aborted=true//IE9 may still call readystatechange
            xhr.abort("timeout")
            var e = new Error("XMLHttpRequest timeout")
            e.code = "ETIMEDOUT"
            errorFunc(e)
        }, options.timeout )
    }

    if (xhr.setRequestHeader) {
        for(key in headers){
            if(headers.hasOwnProperty(key)){
                xhr.setRequestHeader(key, headers[key])
            }
        }
    } else if (options.headers && !isEmpty(options.headers)) {
        throw new Error("Headers cannot be set on an XDomainRequest object")
    }

    if ("responseType" in options) {
        xhr.responseType = options.responseType
    }

    if ("beforeSend" in options &&
        typeof options.beforeSend === "function"
    ) {
        options.beforeSend(xhr)
    }

    xhr.send(body)

    return xhr


}

function noop() {}

},{"global/window":139,"once":140,"parse-headers":144}],139:[function(require,module,exports){
(function (global){
if (typeof window !== "undefined") {
    module.exports = window;
} else if (typeof global !== "undefined") {
    module.exports = global;
} else if (typeof self !== "undefined"){
    module.exports = self;
} else {
    module.exports = {};
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],140:[function(require,module,exports){
module.exports = once

once.proto = once(function () {
  Object.defineProperty(Function.prototype, 'once', {
    value: function () {
      return once(this)
    },
    configurable: true
  })
})

function once (fn) {
  var called = false
  return function () {
    if (called) return
    called = true
    return fn.apply(this, arguments)
  }
}

},{}],141:[function(require,module,exports){
var isFunction = require('is-function')

module.exports = forEach

var toString = Object.prototype.toString
var hasOwnProperty = Object.prototype.hasOwnProperty

function forEach(list, iterator, context) {
    if (!isFunction(iterator)) {
        throw new TypeError('iterator must be a function')
    }

    if (arguments.length < 3) {
        context = this
    }
    
    if (toString.call(list) === '[object Array]')
        forEachArray(list, iterator, context)
    else if (typeof list === 'string')
        forEachString(list, iterator, context)
    else
        forEachObject(list, iterator, context)
}

function forEachArray(array, iterator, context) {
    for (var i = 0, len = array.length; i < len; i++) {
        if (hasOwnProperty.call(array, i)) {
            iterator.call(context, array[i], i, array)
        }
    }
}

function forEachString(string, iterator, context) {
    for (var i = 0, len = string.length; i < len; i++) {
        // no such thing as a sparse string.
        iterator.call(context, string.charAt(i), i, string)
    }
}

function forEachObject(object, iterator, context) {
    for (var k in object) {
        if (hasOwnProperty.call(object, k)) {
            iterator.call(context, object[k], k, object)
        }
    }
}

},{"is-function":142}],142:[function(require,module,exports){
module.exports = isFunction

var toString = Object.prototype.toString

function isFunction (fn) {
  var string = toString.call(fn)
  return string === '[object Function]' ||
    (typeof fn === 'function' && string !== '[object RegExp]') ||
    (typeof window !== 'undefined' &&
     // IE8 and below
     (fn === window.setTimeout ||
      fn === window.alert ||
      fn === window.confirm ||
      fn === window.prompt))
};

},{}],143:[function(require,module,exports){

exports = module.exports = trim;

function trim(str){
  return str.replace(/^\s*|\s*$/g, '');
}

exports.left = function(str){
  return str.replace(/^\s*/, '');
};

exports.right = function(str){
  return str.replace(/\s*$/, '');
};

},{}],144:[function(require,module,exports){
var trim = require('trim')
  , forEach = require('for-each')
  , isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    }

module.exports = function (headers) {
  if (!headers)
    return {}

  var result = {}

  forEach(
      trim(headers).split('\n')
    , function (row) {
        var index = row.indexOf(':')
          , key = trim(row.slice(0, index)).toLowerCase()
          , value = trim(row.slice(index + 1))

        if (typeof(result[key]) === 'undefined') {
          result[key] = value
        } else if (isArray(result[key])) {
          result[key].push(value)
        } else {
          result[key] = [ result[key], value ]
        }
      }
  )

  return result
}
},{"for-each":141,"trim":143}],145:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
    value: true
});
var COLORS = {
    0: '#f51a1a', // red square
    1: '#a21aff', // kremlin,
    2: '#b34b00', // boulevard
    3: '#18dbff', // garden ring
    4: '#ff1518', // third ring
    5: '#88fa60' // MKAD
};

exports['default'] = COLORS;
module.exports = exports['default'];

},{}],146:[function(require,module,exports){
(function (global){
'use strict';

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _interopRequireWildcard = require('babel-runtime/helpers/interop-require-wildcard')['default'];

var _xhr = require('xhr');

var _xhr2 = _interopRequireDefault(_xhr);

var _spinJs = require('spin.js');

var Spinner = _interopRequireWildcard(_spinJs);

var _configJson = require('../config.json');

var config = _interopRequireWildcard(_configJson);

var _colors = require('./colors');

var COLORS = _interopRequireWildcard(_colors);

var _leafletKnn = require('leaflet-knn');

var _leafletKnn2 = _interopRequireDefault(_leafletKnn);

var _turf = require('turf');

var _turf2 = _interopRequireDefault(_turf);

require('leaflet-hash');

var L = global.L || require('leaflet');

console.log(_leafletKnn2['default']);

var MAP_STYLE = 'mapbox.dark';
var LINE_WIDTH = 4;

var map = global.map = L.map(document.querySelector('.map'));
var hash = L.hash(map);
var index = undefined,
    gj = undefined,
    geojson = undefined;

var tiles = L.tileLayer('https://api.mapbox.com/v4/' + MAP_STYLE + '/{z}/{x}/{y}.png?access_token=' + config.api_token, {
  attribution: 'Mapbox &copy; OSM contributors'
}).addTo(map);

(0, _xhr2['default'])({
  url: 'data/data.json'
}, function (err, req, data) {
  if (!err) {
    geojson = data = JSON.parse(data);
    gj = L.geoJson(data, {
      style: function style(feature) {
        return {
          color: COLORS[feature.properties.id],
          weight: LINE_WIDTH / (feature.properties.id + 1),
          fillOpacity: 0.1,
          clickable: false
        };
      }
    });
    var bounds = gj.getBounds();
    map.fitBounds(bounds, { padding: [20, 20] });
    gj.addTo(map);
    index = (0, _leafletKnn2['default'])(gj);
  }
});

var marker = undefined;

map.on('click', function (evt) {
  if (!marker) {
    marker = L.marker(evt.latlng).addTo(map);
  } else {
    marker.setLatLng(evt.latlng);
  }
  var nearest = index.nearest(evt.latlng);
  console.log(nearest);
});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../config.json":1,"./colors":145,"babel-runtime/helpers/interop-require-default":2,"babel-runtime/helpers/interop-require-wildcard":3,"leaflet":"leaflet","leaflet-hash":8,"leaflet-knn":9,"spin.js":14,"turf":15,"xhr":138}]},{},[146])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjb25maWcuanNvbiIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvaW50ZXJvcC1yZXF1aXJlLWRlZmF1bHQuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2ludGVyb3AtcmVxdWlyZS13aWxkY2FyZC5qcyIsIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnVmZmVyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvbGliL2I2NC5qcyIsIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9idWZmZXIvbm9kZV9tb2R1bGVzL2llZWU3NTQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnVmZmVyL25vZGVfbW9kdWxlcy9pcy1hcnJheS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9sZWFmbGV0LWhhc2gvbGVhZmxldC1oYXNoLmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL25vZGVfbW9kdWxlcy9zcGhlcmUta25uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL25vZGVfbW9kdWxlcy9zcGhlcmUta25uL2xpYi9iaW5hcnkuanMiLCJub2RlX21vZHVsZXMvbGVhZmxldC1rbm4vbm9kZV9tb2R1bGVzL3NwaGVyZS1rbm4vbGliL2tkLmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL25vZGVfbW9kdWxlcy9zcGhlcmUta25uL2xpYi9zcGhlcmVrZC5qcyIsIm5vZGVfbW9kdWxlcy9zcGluLmpzL3NwaW4uanMiLCJub2RlX21vZHVsZXMvdHVyZi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWFnZ3JlZ2F0ZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWFsb25nL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYXJlYS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWFyZWEvbm9kZV9tb2R1bGVzL2dlb2pzb24tYXJlYS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWFyZWEvbm9kZV9tb2R1bGVzL2dlb2pzb24tYXJlYS9ub2RlX21vZHVsZXMvd2dzODQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1hdmVyYWdlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYmJveC1wb2x5Z29uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYmVhcmluZy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWJlemllci9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWJlemllci9zcGxpbmUuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvbGliL2pzdHMuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvbm9kZV9tb2R1bGVzL2phdmFzY3JpcHQudXRpbC9kaXN0L2phdmFzY3JpcHQudXRpbC1ub2RlLm1pbi5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWJ1ZmZlci9ub2RlX21vZHVsZXMvanN0cy9ub2RlX21vZHVsZXMvamF2YXNjcmlwdC51dGlsL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY2VudGVyL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY2VudHJvaWQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jZW50cm9pZC9ub2RlX21vZHVsZXMvdHVyZi1tZXRhL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29tYmluZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbmNhdmUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvbm9kZV9tb2R1bGVzL2NvbnZleC1odWxsL2NoLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9saWIvY2gxZC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbGliL2NoMmQuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvbm9kZV9tb2R1bGVzL2NvbnZleC1odWxsL2xpYi9jaG5kLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvYWZmaW5lLWh1bGwvYWZmLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvYWZmaW5lLWh1bGwvbm9kZV9tb2R1bGVzL3JvYnVzdC1vcmllbnRhdGlvbi9ub2RlX21vZHVsZXMvcm9idXN0LXNjYWxlL25vZGVfbW9kdWxlcy90d28tc3VtL3R3by1zdW0uanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvbm9kZV9tb2R1bGVzL2NvbnZleC1odWxsL25vZGVfbW9kdWxlcy9hZmZpbmUtaHVsbC9ub2RlX21vZHVsZXMvcm9idXN0LW9yaWVudGF0aW9uL25vZGVfbW9kdWxlcy9yb2J1c3Qtc2NhbGUvcm9idXN0LXNjYWxlLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvYWZmaW5lLWh1bGwvbm9kZV9tb2R1bGVzL3JvYnVzdC1vcmllbnRhdGlvbi9ub2RlX21vZHVsZXMvcm9idXN0LXN1YnRyYWN0L3JvYnVzdC1kaWZmLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvYWZmaW5lLWh1bGwvbm9kZV9tb2R1bGVzL3JvYnVzdC1vcmllbnRhdGlvbi9ub2RlX21vZHVsZXMvcm9idXN0LXN1bS9yb2J1c3Qtc3VtLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvYWZmaW5lLWh1bGwvbm9kZV9tb2R1bGVzL3JvYnVzdC1vcmllbnRhdGlvbi9ub2RlX21vZHVsZXMvdHdvLXByb2R1Y3QvdHdvLXByb2R1Y3QuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvbm9kZV9tb2R1bGVzL2NvbnZleC1odWxsL25vZGVfbW9kdWxlcy9hZmZpbmUtaHVsbC9ub2RlX21vZHVsZXMvcm9idXN0LW9yaWVudGF0aW9uL29yaWVudGF0aW9uLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvaW5jcmVtZW50YWwtY29udmV4LWh1bGwvaWNoLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvaW5jcmVtZW50YWwtY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL3NpbXBsaWNpYWwtY29tcGxleC9ub2RlX21vZHVsZXMvYml0LXR3aWRkbGUvdHdpZGRsZS5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2luY3JlbWVudGFsLWNvbnZleC1odWxsL25vZGVfbW9kdWxlcy9zaW1wbGljaWFsLWNvbXBsZXgvbm9kZV9tb2R1bGVzL3VuaW9uLWZpbmQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvbm9kZV9tb2R1bGVzL2NvbnZleC1odWxsL25vZGVfbW9kdWxlcy9pbmNyZW1lbnRhbC1jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvc2ltcGxpY2lhbC1jb21wbGV4L3RvcG9sb2d5LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvbW9ub3RvbmUtY29udmV4LWh1bGwtMmQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb3VudC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWRlc3RpbmF0aW9uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZGV2aWF0aW9uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZGV2aWF0aW9uL25vZGVfbW9kdWxlcy9zaW1wbGUtc3RhdGlzdGljcy9zcmMvc2ltcGxlX3N0YXRpc3RpY3MuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1kaXN0YW5jZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWRpc3RhbmNlL25vZGVfbW9kdWxlcy90dXJmLWludmFyaWFudC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWVudmVsb3BlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZXJhc2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1lcmFzZS9ub2RlX21vZHVsZXMvanN0cy9ub2RlX21vZHVsZXMvamF2YXNjcmlwdC51dGlsL2Rpc3QvamF2YXNjcmlwdC51dGlsLW5vZGUubWluLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZXhwbG9kZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWV4dGVudC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWZlYXR1cmVjb2xsZWN0aW9uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZmlsdGVyL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZmxpcC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWhleC1ncmlkL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtaW5zaWRlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtaW50ZXJzZWN0L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtaW50ZXJzZWN0L25vZGVfbW9kdWxlcy9qc3RzL25vZGVfbW9kdWxlcy9qYXZhc2NyaXB0LnV0aWwvZGlzdC9qYXZhc2NyaXB0LnV0aWwtbm9kZS5taW4uanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1pc29saW5lcy9jb25yZWMuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1pc29saW5lcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWlzb2xpbmVzL25vZGVfbW9kdWxlcy90dXJmLWdyaWQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1qZW5rcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWtpbmtzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtbGluZS1kaXN0YW5jZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWxpbmUtc2xpY2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1saW5lc3RyaW5nL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtbWF4L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtbWVkaWFuL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtbWVyZ2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1tZXJnZS9ub2RlX21vZHVsZXMvY2xvbmUvY2xvbmUuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1taWRwb2ludC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLW1pbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLW5lYXJlc3QvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1wbGFuZXBvaW50L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcG9pbnQtZ3JpZC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXBvaW50LW9uLWxpbmUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1wb2ludC1vbi1zdXJmYWNlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcG9pbnQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1wb2x5Z29uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcXVhbnRpbGUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1yYW5kb20vaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1yYW5kb20vbm9kZV9tb2R1bGVzL2dlb2pzb24tcmFuZG9tL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcmVjbGFzcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXJlbW92ZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXNhbXBsZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXNpbXBsaWZ5L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtc2ltcGxpZnkvbm9kZV9tb2R1bGVzL3NpbXBsaWZ5LWpzL3NpbXBsaWZ5LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtc2l6ZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXNxdWFyZS1ncmlkL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtc3F1YXJlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtc3VtL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtdGFnL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtdGluL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtdHJpYW5nbGUtZ3JpZC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXVuaW9uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtdW5pb24vbm9kZV9tb2R1bGVzL2pzdHMvbm9kZV9tb2R1bGVzL2phdmFzY3JpcHQudXRpbC9kaXN0L2phdmFzY3JpcHQudXRpbC1ub2RlLm1pbi5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXZhcmlhbmNlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtd2l0aGluL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3hoci9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy94aHIvbm9kZV9tb2R1bGVzL2dsb2JhbC93aW5kb3cuanMiLCJub2RlX21vZHVsZXMveGhyL25vZGVfbW9kdWxlcy9vbmNlL29uY2UuanMiLCJub2RlX21vZHVsZXMveGhyL25vZGVfbW9kdWxlcy9wYXJzZS1oZWFkZXJzL25vZGVfbW9kdWxlcy9mb3ItZWFjaC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy94aHIvbm9kZV9tb2R1bGVzL3BhcnNlLWhlYWRlcnMvbm9kZV9tb2R1bGVzL2Zvci1lYWNoL25vZGVfbW9kdWxlcy9pcy1mdW5jdGlvbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy94aHIvbm9kZV9tb2R1bGVzL3BhcnNlLWhlYWRlcnMvbm9kZV9tb2R1bGVzL3RyaW0vaW5kZXguanMiLCJub2RlX21vZHVsZXMveGhyL25vZGVfbW9kdWxlcy9wYXJzZS1oZWFkZXJzL3BhcnNlLWhlYWRlcnMuanMiLCIvVXNlcnMvdzhyL1Byb2plY3RzL21vc2Nvdy1yaW5ncy9zcmMvY29sb3JzLmpzIiwiL1VzZXJzL3c4ci9Qcm9qZWN0cy9tb3Njb3ctcmluZ3Mvc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN4Z0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6WEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5RkE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNXFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzFDQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7OztBQzdiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7OztBQ2hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDamlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQ2hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbGdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDaEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNoSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQ3pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUMvSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM3TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUM5QkEsSUFBTSxNQUFNLEdBQUc7QUFDWCxLQUFDLEVBQUUsU0FBUztBQUNaLEtBQUMsRUFBRSxTQUFTO0FBQ1osS0FBQyxFQUFFLFNBQVM7QUFDWixLQUFDLEVBQUUsU0FBUztBQUNaLEtBQUMsRUFBRSxTQUFTO0FBQ1osS0FBQyxFQUFFLFNBQVM7Q0FDZixDQUFBOztxQkFFYyxNQUFNOzs7Ozs7Ozs7OzttQkNQTCxLQUFLOzs7O3NCQUNJLFNBQVM7O0lBQXRCLE9BQU87OzBCQUNLLGdCQUFnQjs7SUFBNUIsTUFBTTs7c0JBQ00sVUFBVTs7SUFBdEIsTUFBTTs7MEJBQ0ssYUFBYTs7OztvQkFDbkIsTUFBTTs7OztRQUNoQixjQUFjOztBQVJyQixJQUFNLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQzs7QUFVekMsT0FBTyxDQUFDLEdBQUcseUJBQVksQ0FBQzs7QUFFeEIsSUFBTSxTQUFTLEdBQUcsYUFBYSxDQUFDO0FBQ2hDLElBQU0sVUFBVSxHQUFHLENBQUMsQ0FBQzs7QUFFckIsSUFBSSxHQUFHLEdBQUcsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUM3RCxJQUFJLElBQUksR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZCLElBQUksS0FBSyxZQUFBO0lBQUUsRUFBRSxZQUFBO0lBQUUsT0FBTyxZQUFBLENBQUM7O0FBRXZCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQ3JCLDRCQUE0QixHQUM1QixTQUFTLEdBQ1QsZ0NBQWdDLEdBQ2hDLE1BQU0sQ0FBQyxTQUFTLEVBQUU7QUFDaEIsYUFBVyxFQUFFLGdDQUFnQztDQUM5QyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDOztBQUVoQixzQkFBSTtBQUNGLEtBQUcsRUFBRSxnQkFBZ0I7Q0FDdEIsRUFBRSxVQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFLO0FBQ3JCLE1BQUksQ0FBQyxHQUFHLEVBQUU7QUFDUixXQUFPLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDbEMsTUFBRSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFO0FBQ25CLFdBQUssRUFBRSxlQUFDLE9BQU8sRUFBSztBQUNsQixlQUFPO0FBQ0wsZUFBSyxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztBQUNwQyxnQkFBTSxFQUFFLFVBQVUsSUFBSSxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUEsQUFBQztBQUNoRCxxQkFBVyxFQUFFLEdBQUc7QUFDaEIsbUJBQVMsRUFBRSxLQUFLO1NBQ2pCLENBQUE7T0FDRjtLQUNGLENBQUMsQ0FBQztBQUNILFFBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQztBQUM1QixPQUFHLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxFQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUM7QUFDM0MsTUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNkLFNBQUssR0FBRyw2QkFBVyxFQUFFLENBQUMsQ0FBQztHQUN4QjtDQUNGLENBQUMsQ0FBQzs7QUFFSCxJQUFJLE1BQU0sWUFBQSxDQUFDOztBQUVYLEdBQUcsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLFVBQUMsR0FBRyxFQUFLO0FBQ3ZCLE1BQUksQ0FBQyxNQUFNLEVBQUU7QUFDWCxVQUFNLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0dBQzFDLE1BQU07QUFDTCxVQUFNLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztHQUM5QjtBQUNELE1BQUksT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3hDLFNBQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7Q0FDdEIsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIm1vZHVsZS5leHBvcnRzPXtcbiAgXCJhcGlfdG9rZW5cIjogXCJway5leUoxSWpvaWR6aHlJaXdpWVNJNkluQldWVVphU0RBaWZRLmxRVUpYTzZycXFBaUtSUjZWVzhURWdcIlxufVxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDoge1xuICAgIFwiZGVmYXVsdFwiOiBvYmpcbiAgfTtcbn07XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZnVuY3Rpb24gKG9iaikge1xuICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbmV3T2JqID0ge307XG5cbiAgICBpZiAob2JqICE9IG51bGwpIHtcbiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgbmV3T2JqW1wiZGVmYXVsdFwiXSA9IG9iajtcbiAgICByZXR1cm4gbmV3T2JqO1xuICB9XG59O1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOyIsIi8qIVxuICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+XG4gKiBAbGljZW5zZSAgTUlUXG4gKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovXG5cbnZhciBiYXNlNjQgPSByZXF1aXJlKCdiYXNlNjQtanMnKVxudmFyIGllZWU3NTQgPSByZXF1aXJlKCdpZWVlNzU0JylcbnZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXMtYXJyYXknKVxuXG5leHBvcnRzLkJ1ZmZlciA9IEJ1ZmZlclxuZXhwb3J0cy5TbG93QnVmZmVyID0gU2xvd0J1ZmZlclxuZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUyA9IDUwXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxudmFyIHJvb3RQYXJlbnQgPSB7fVxuXG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuXG4gKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy5cbiAqXG4gKiBOb3RlOlxuICpcbiAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsXG4gKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguXG4gKlxuICogICAtIFNhZmFyaSA1LTcgbGFja3Mgc3VwcG9ydCBmb3IgY2hhbmdpbmcgdGhlIGBPYmplY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yYCBwcm9wZXJ0eVxuICogICAgIG9uIG9iamVjdHMuXG4gKlxuICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2ZcbiAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy5cblxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXlcbiAqIGdldCB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uLCB3aGljaCBpcyBzbG93ZXIgYnV0IGJlaGF2ZXMgY29ycmVjdGx5LlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUICE9PSB1bmRlZmluZWRcbiAgPyBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVFxuICA6IHR5cGVkQXJyYXlTdXBwb3J0KClcblxuZnVuY3Rpb24gdHlwZWRBcnJheVN1cHBvcnQgKCkge1xuICBmdW5jdGlvbiBCYXIgKCkge31cbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSlcbiAgICBhcnIuZm9vID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfVxuICAgIGFyci5jb25zdHJ1Y3RvciA9IEJhclxuICAgIHJldHVybiBhcnIuZm9vKCkgPT09IDQyICYmIC8vIHR5cGVkIGFycmF5IGluc3RhbmNlcyBjYW4gYmUgYXVnbWVudGVkXG4gICAgICAgIGFyci5jb25zdHJ1Y3RvciA9PT0gQmFyICYmIC8vIGNvbnN0cnVjdG9yIGNhbiBiZSBzZXRcbiAgICAgICAgdHlwZW9mIGFyci5zdWJhcnJheSA9PT0gJ2Z1bmN0aW9uJyAmJiAvLyBjaHJvbWUgOS0xMCBsYWNrIGBzdWJhcnJheWBcbiAgICAgICAgYXJyLnN1YmFycmF5KDEsIDEpLmJ5dGVMZW5ndGggPT09IDAgLy8gaWUxMCBoYXMgYnJva2VuIGBzdWJhcnJheWBcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbmZ1bmN0aW9uIGtNYXhMZW5ndGggKCkge1xuICByZXR1cm4gQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgICA/IDB4N2ZmZmZmZmZcbiAgICA6IDB4M2ZmZmZmZmZcbn1cblxuLyoqXG4gKiBDbGFzczogQnVmZmVyXG4gKiA9PT09PT09PT09PT09XG4gKlxuICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBhcmUgYXVnbWVudGVkXG4gKiB3aXRoIGZ1bmN0aW9uIHByb3BlcnRpZXMgZm9yIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBBUEkgZnVuY3Rpb25zLiBXZSB1c2VcbiAqIGBVaW50OEFycmF5YCBzbyB0aGF0IHNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0IHJldHVybnNcbiAqIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIEJ5IGF1Z21lbnRpbmcgdGhlIGluc3RhbmNlcywgd2UgY2FuIGF2b2lkIG1vZGlmeWluZyB0aGUgYFVpbnQ4QXJyYXlgXG4gKiBwcm90b3R5cGUuXG4gKi9cbmZ1bmN0aW9uIEJ1ZmZlciAoYXJnKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBCdWZmZXIpKSB7XG4gICAgLy8gQXZvaWQgZ29pbmcgdGhyb3VnaCBhbiBBcmd1bWVudHNBZGFwdG9yVHJhbXBvbGluZSBpbiB0aGUgY29tbW9uIGNhc2UuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSByZXR1cm4gbmV3IEJ1ZmZlcihhcmcsIGFyZ3VtZW50c1sxXSlcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcihhcmcpXG4gIH1cblxuICB0aGlzLmxlbmd0aCA9IDBcbiAgdGhpcy5wYXJlbnQgPSB1bmRlZmluZWRcblxuICAvLyBDb21tb24gY2FzZS5cbiAgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIGZyb21OdW1iZXIodGhpcywgYXJnKVxuICB9XG5cbiAgLy8gU2xpZ2h0bHkgbGVzcyBjb21tb24gY2FzZS5cbiAgaWYgKHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZyb21TdHJpbmcodGhpcywgYXJnLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6ICd1dGY4JylcbiAgfVxuXG4gIC8vIFVudXN1YWwuXG4gIHJldHVybiBmcm9tT2JqZWN0KHRoaXMsIGFyZylcbn1cblxuZnVuY3Rpb24gZnJvbU51bWJlciAodGhhdCwgbGVuZ3RoKSB7XG4gIHRoYXQgPSBhbGxvY2F0ZSh0aGF0LCBsZW5ndGggPCAwID8gMCA6IGNoZWNrZWQobGVuZ3RoKSB8IDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGF0W2ldID0gMFxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tU3RyaW5nICh0aGF0LCBzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykgZW5jb2RpbmcgPSAndXRmOCdcblxuICAvLyBBc3N1bXB0aW9uOiBieXRlTGVuZ3RoKCkgcmV0dXJuIHZhbHVlIGlzIGFsd2F5cyA8IGtNYXhMZW5ndGguXG4gIHZhciBsZW5ndGggPSBieXRlTGVuZ3RoKHN0cmluZywgZW5jb2RpbmcpIHwgMFxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuXG4gIHRoYXQud3JpdGUoc3RyaW5nLCBlbmNvZGluZylcbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqZWN0KSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqZWN0KSkgcmV0dXJuIGZyb21CdWZmZXIodGhhdCwgb2JqZWN0KVxuXG4gIGlmIChpc0FycmF5KG9iamVjdCkpIHJldHVybiBmcm9tQXJyYXkodGhhdCwgb2JqZWN0KVxuXG4gIGlmIChvYmplY3QgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ211c3Qgc3RhcnQgd2l0aCBudW1iZXIsIGJ1ZmZlciwgYXJyYXkgb3Igc3RyaW5nJylcbiAgfVxuXG4gIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKG9iamVjdC5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgcmV0dXJuIGZyb21UeXBlZEFycmF5KHRoYXQsIG9iamVjdClcbiAgICB9XG4gICAgaWYgKG9iamVjdCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICByZXR1cm4gZnJvbUFycmF5QnVmZmVyKHRoYXQsIG9iamVjdClcbiAgICB9XG4gIH1cblxuICBpZiAob2JqZWN0Lmxlbmd0aCkgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqZWN0KVxuXG4gIHJldHVybiBmcm9tSnNvbk9iamVjdCh0aGF0LCBvYmplY3QpXG59XG5cbmZ1bmN0aW9uIGZyb21CdWZmZXIgKHRoYXQsIGJ1ZmZlcikge1xuICB2YXIgbGVuZ3RoID0gY2hlY2tlZChidWZmZXIubGVuZ3RoKSB8IDBcbiAgdGhhdCA9IGFsbG9jYXRlKHRoYXQsIGxlbmd0aClcbiAgYnVmZmVyLmNvcHkodGhhdCwgMCwgMCwgbGVuZ3RoKVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXkgKHRoYXQsIGFycmF5KSB7XG4gIHZhciBsZW5ndGggPSBjaGVja2VkKGFycmF5Lmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBhbGxvY2F0ZSh0aGF0LCBsZW5ndGgpXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTVcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG4vLyBEdXBsaWNhdGUgb2YgZnJvbUFycmF5KCkgdG8ga2VlcCBmcm9tQXJyYXkoKSBtb25vbW9ycGhpYy5cbmZ1bmN0aW9uIGZyb21UeXBlZEFycmF5ICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuICAvLyBUcnVuY2F0aW5nIHRoZSBlbGVtZW50cyBpcyBwcm9iYWJseSBub3Qgd2hhdCBwZW9wbGUgZXhwZWN0IGZyb20gdHlwZWRcbiAgLy8gYXJyYXlzIHdpdGggQllURVNfUEVSX0VMRU1FTlQgPiAxIGJ1dCBpdCdzIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3JcbiAgLy8gb2YgdGhlIG9sZCBCdWZmZXIgY29uc3RydWN0b3IuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTVcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlCdWZmZXIgKHRoYXQsIGFycmF5KSB7XG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlLCBmb3IgYmVzdCBwZXJmb3JtYW5jZVxuICAgIGFycmF5LmJ5dGVMZW5ndGhcbiAgICB0aGF0ID0gQnVmZmVyLl9hdWdtZW50KG5ldyBVaW50OEFycmF5KGFycmF5KSlcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgdGhhdCA9IGZyb21UeXBlZEFycmF5KHRoYXQsIG5ldyBVaW50OEFycmF5KGFycmF5KSlcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuLy8gRGVzZXJpYWxpemUgeyB0eXBlOiAnQnVmZmVyJywgZGF0YTogWzEsMiwzLC4uLl0gfSBpbnRvIGEgQnVmZmVyIG9iamVjdC5cbi8vIFJldHVybnMgYSB6ZXJvLWxlbmd0aCBidWZmZXIgZm9yIGlucHV0cyB0aGF0IGRvbid0IGNvbmZvcm0gdG8gdGhlIHNwZWMuXG5mdW5jdGlvbiBmcm9tSnNvbk9iamVjdCAodGhhdCwgb2JqZWN0KSB7XG4gIHZhciBhcnJheVxuICB2YXIgbGVuZ3RoID0gMFxuXG4gIGlmIChvYmplY3QudHlwZSA9PT0gJ0J1ZmZlcicgJiYgaXNBcnJheShvYmplY3QuZGF0YSkpIHtcbiAgICBhcnJheSA9IG9iamVjdC5kYXRhXG4gICAgbGVuZ3RoID0gY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB9XG4gIHRoYXQgPSBhbGxvY2F0ZSh0aGF0LCBsZW5ndGgpXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICBCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlXG4gIEJ1ZmZlci5fX3Byb3RvX18gPSBVaW50OEFycmF5XG59XG5cbmZ1bmN0aW9uIGFsbG9jYXRlICh0aGF0LCBsZW5ndGgpIHtcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IEJ1ZmZlci5fYXVnbWVudChuZXcgVWludDhBcnJheShsZW5ndGgpKVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aFxuICAgIHRoYXQuX2lzQnVmZmVyID0gdHJ1ZVxuICB9XG5cbiAgdmFyIGZyb21Qb29sID0gbGVuZ3RoICE9PSAwICYmIGxlbmd0aCA8PSBCdWZmZXIucG9vbFNpemUgPj4+IDFcbiAgaWYgKGZyb21Qb29sKSB0aGF0LnBhcmVudCA9IHJvb3RQYXJlbnRcblxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHtcbiAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwga01heExlbmd0aGAgaGVyZSBiZWNhdXNlIHRoYXQgZmFpbHMgd2hlblxuICAvLyBsZW5ndGggaXMgTmFOICh3aGljaCBpcyBvdGhlcndpc2UgY29lcmNlZCB0byB6ZXJvLilcbiAgaWYgKGxlbmd0aCA+PSBrTWF4TGVuZ3RoKCkpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byBhbGxvY2F0ZSBCdWZmZXIgbGFyZ2VyIHRoYW4gbWF4aW11bSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAnc2l6ZTogMHgnICsga01heExlbmd0aCgpLnRvU3RyaW5nKDE2KSArICcgYnl0ZXMnKVxuICB9XG4gIHJldHVybiBsZW5ndGggfCAwXG59XG5cbmZ1bmN0aW9uIFNsb3dCdWZmZXIgKHN1YmplY3QsIGVuY29kaW5nKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBTbG93QnVmZmVyKSkgcmV0dXJuIG5ldyBTbG93QnVmZmVyKHN1YmplY3QsIGVuY29kaW5nKVxuXG4gIHZhciBidWYgPSBuZXcgQnVmZmVyKHN1YmplY3QsIGVuY29kaW5nKVxuICBkZWxldGUgYnVmLnBhcmVudFxuICByZXR1cm4gYnVmXG59XG5cbkJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7XG4gIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpXG59XG5cbkJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYSwgYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIG11c3QgYmUgQnVmZmVycycpXG4gIH1cblxuICBpZiAoYSA9PT0gYikgcmV0dXJuIDBcblxuICB2YXIgeCA9IGEubGVuZ3RoXG4gIHZhciB5ID0gYi5sZW5ndGhcblxuICB2YXIgaSA9IDBcbiAgdmFyIGxlbiA9IE1hdGgubWluKHgsIHkpXG4gIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgaWYgKGFbaV0gIT09IGJbaV0pIGJyZWFrXG5cbiAgICArK2lcbiAgfVxuXG4gIGlmIChpICE9PSBsZW4pIHtcbiAgICB4ID0gYVtpXVxuICAgIHkgPSBiW2ldXG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlICdoZXgnOlxuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICBjYXNlICdhc2NpaSc6XG4gICAgY2FzZSAnYmluYXJ5JzpcbiAgICBjYXNlICdiYXNlNjQnOlxuICAgIGNhc2UgJ3Jhdyc6XG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkge1xuICBpZiAoIWlzQXJyYXkobGlzdCkpIHRocm93IG5ldyBUeXBlRXJyb3IoJ2xpc3QgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzLicpXG5cbiAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG5ldyBCdWZmZXIoMClcbiAgfVxuXG4gIHZhciBpXG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGxlbmd0aCA9IDBcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgbGVuZ3RoICs9IGxpc3RbaV0ubGVuZ3RoXG4gICAgfVxuICB9XG5cbiAgdmFyIGJ1ZiA9IG5ldyBCdWZmZXIobGVuZ3RoKVxuICB2YXIgcG9zID0gMFxuICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgIHZhciBpdGVtID0gbGlzdFtpXVxuICAgIGl0ZW0uY29weShidWYsIHBvcylcbiAgICBwb3MgKz0gaXRlbS5sZW5ndGhcbiAgfVxuICByZXR1cm4gYnVmXG59XG5cbmZ1bmN0aW9uIGJ5dGVMZW5ndGggKHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSBzdHJpbmcgPSAnJyArIHN0cmluZ1xuXG4gIHZhciBsZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChsZW4gPT09IDApIHJldHVybiAwXG5cbiAgLy8gVXNlIGEgZm9yIGxvb3AgdG8gYXZvaWQgcmVjdXJzaW9uXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgLy8gRGVwcmVjYXRlZFxuICAgICAgY2FzZSAncmF3JzpcbiAgICAgIGNhc2UgJ3Jhd3MnOlxuICAgICAgICByZXR1cm4gbGVuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gbGVuICogMlxuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGxlbiA+Pj4gMVxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGhcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoIC8vIGFzc3VtZSB1dGY4XG4gICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5CdWZmZXIuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGhcblxuLy8gcHJlLXNldCBmb3IgdmFsdWVzIHRoYXQgbWF5IGV4aXN0IGluIHRoZSBmdXR1cmVcbkJ1ZmZlci5wcm90b3R5cGUubGVuZ3RoID0gdW5kZWZpbmVkXG5CdWZmZXIucHJvdG90eXBlLnBhcmVudCA9IHVuZGVmaW5lZFxuXG5mdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7XG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG5cbiAgc3RhcnQgPSBzdGFydCB8IDBcbiAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgfHwgZW5kID09PSBJbmZpbml0eSA/IHRoaXMubGVuZ3RoIDogZW5kIHwgMFxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG4gIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmIChlbmQgPD0gc3RhcnQpIHJldHVybiAnJ1xuXG4gIHdoaWxlICh0cnVlKSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGJpbmFyeVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwXG4gIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJ1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpXG4gIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIGVxdWFscyAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYikgPT09IDBcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7XG4gIHZhciBzdHIgPSAnJ1xuICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFU1xuICBpZiAodGhpcy5sZW5ndGggPiAwKSB7XG4gICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJylcbiAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnXG4gIH1cbiAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPidcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gMFxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYilcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gaW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0KSB7XG4gIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikgYnl0ZU9mZnNldCA9IDB4N2ZmZmZmZmZcbiAgZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSBieXRlT2Zmc2V0ID0gLTB4ODAwMDAwMDBcbiAgYnl0ZU9mZnNldCA+Pj0gMFxuXG4gIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xXG4gIGlmIChieXRlT2Zmc2V0ID49IHRoaXMubGVuZ3RoKSByZXR1cm4gLTFcblxuICAvLyBOZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IE1hdGgubWF4KHRoaXMubGVuZ3RoICsgYnl0ZU9mZnNldCwgMClcblxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAodmFsLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xIC8vIHNwZWNpYWwgY2FzZTogbG9va2luZyBmb3IgZW1wdHkgc3RyaW5nIGFsd2F5cyBmYWlsc1xuICAgIHJldHVybiBTdHJpbmcucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0aGlzLCB2YWwsIGJ5dGVPZmZzZXQpXG4gIH1cbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQpXG4gIH1cbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwodGhpcywgdmFsLCBieXRlT2Zmc2V0KVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXlJbmRleE9mKHRoaXMsIFsgdmFsIF0sIGJ5dGVPZmZzZXQpXG4gIH1cblxuICBmdW5jdGlvbiBhcnJheUluZGV4T2YgKGFyciwgdmFsLCBieXRlT2Zmc2V0KSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAodmFyIGkgPSAwOyBieXRlT2Zmc2V0ICsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGFycltieXRlT2Zmc2V0ICsgaV0gPT09IHZhbFtmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleF0pIHtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaVxuICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWwubGVuZ3RoKSByZXR1cm4gYnl0ZU9mZnNldCArIGZvdW5kSW5kZXhcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvdW5kSW5kZXggPSAtMVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTFcbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpXG59XG5cbi8vIGBnZXRgIGlzIGRlcHJlY2F0ZWRcbkJ1ZmZlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gZ2V0IChvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5nZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLnJlYWRVSW50OChvZmZzZXQpXG59XG5cbi8vIGBzZXRgIGlzIGRlcHJlY2F0ZWRcbkJ1ZmZlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gc2V0ICh2LCBvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5zZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLndyaXRlVUludDgodiwgb2Zmc2V0KVxufVxuXG5mdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDBcbiAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKCFsZW5ndGgpIHtcbiAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgfSBlbHNlIHtcbiAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKVxuICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHtcbiAgICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICAgIH1cbiAgfVxuXG4gIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzXG4gIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBoZXggc3RyaW5nJylcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWRcbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiB1dGY4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBhc2NpaVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIoYXNjaWlUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGJpbmFyeVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBiYXNlNjRXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGJhc2U2NFRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gdWNzMldyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmMTZsZVRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykge1xuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKVxuICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICBlbmNvZGluZyA9ICd1dGY4J1xuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZylcbiAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgIGVuY29kaW5nID0gb2Zmc2V0XG4gICAgbGVuZ3RoID0gdGhpcy5sZW5ndGhcbiAgICBvZmZzZXQgPSAwXG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pXG4gIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkge1xuICAgIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgICBpZiAoaXNGaW5pdGUobGVuZ3RoKSkge1xuICAgICAgbGVuZ3RoID0gbGVuZ3RoIHwgMFxuICAgICAgaWYgKGVuY29kaW5nID09PSB1bmRlZmluZWQpIGVuY29kaW5nID0gJ3V0ZjgnXG4gICAgfSBlbHNlIHtcbiAgICAgIGVuY29kaW5nID0gbGVuZ3RoXG4gICAgICBsZW5ndGggPSB1bmRlZmluZWRcbiAgICB9XG4gIC8vIGxlZ2FjeSB3cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXQsIGxlbmd0aCkgLSByZW1vdmUgaW4gdjAuMTNcbiAgfSBlbHNlIHtcbiAgICB2YXIgc3dhcCA9IGVuY29kaW5nXG4gICAgZW5jb2RpbmcgPSBvZmZzZXRcbiAgICBvZmZzZXQgPSBsZW5ndGggfCAwXG4gICAgbGVuZ3RoID0gc3dhcFxuICB9XG5cbiAgdmFyIHJlbWFpbmluZyA9IHRoaXMubGVuZ3RoIC0gb2Zmc2V0XG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCB8fCBsZW5ndGggPiByZW1haW5pbmcpIGxlbmd0aCA9IHJlbWFpbmluZ1xuXG4gIGlmICgoc3RyaW5nLmxlbmd0aCA+IDAgJiYgKGxlbmd0aCA8IDAgfHwgb2Zmc2V0IDwgMCkpIHx8IG9mZnNldCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ2F0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzJylcbiAgfVxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBiaW5hcnlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZVxuICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCdWZmZXInLFxuICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSlcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG4gIHZhciByZXMgPSBbXVxuXG4gIHZhciBpID0gc3RhcnRcbiAgd2hpbGUgKGkgPCBlbmQpIHtcbiAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldXG4gICAgdmFyIGNvZGVQb2ludCA9IG51bGxcbiAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDRcbiAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gM1xuICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyXG4gICAgICA6IDFcblxuICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHtcbiAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnRcblxuICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkge1xuICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3Rikge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHtcbiAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGFcbiAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGVcbiAgICAgIGNvZGVQb2ludCA9IDB4RkZGRFxuICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDFcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikge1xuICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSlcbiAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwXG4gICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApXG4gICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRlxuICAgIH1cblxuICAgIHJlcy5wdXNoKGNvZGVQb2ludClcbiAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2VcbiAgfVxuXG4gIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKVxufVxuXG4vLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGhcbi8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy5cbi8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHlcbnZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMFxuXG5mdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHtcbiAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoXG4gIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKClcbiAgfVxuXG4gIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgXCJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWRcIi5cbiAgdmFyIHJlcyA9ICcnXG4gIHZhciBpID0gMFxuICB3aGlsZSAoaSA8IGxlbikge1xuICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFxuICAgICAgU3RyaW5nLFxuICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKVxuICAgIClcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RilcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGJpbmFyeVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHJldCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSlcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGhcblxuICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW5cblxuICB2YXIgb3V0ID0gJydcbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKVxuICB9XG4gIHJldHVybiBvdXRcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpXG4gIHZhciByZXMgPSAnJ1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpXG4gIH1cbiAgcmV0dXJuIHJlc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gc2xpY2UgKHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIHN0YXJ0ID0gfn5zdGFydFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IH5+ZW5kXG5cbiAgaWYgKHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ICs9IGxlblxuICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7XG4gICAgc3RhcnQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCAwKSB7XG4gICAgZW5kICs9IGxlblxuICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwXG4gIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7XG4gICAgZW5kID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgdmFyIG5ld0J1ZlxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBuZXdCdWYgPSBCdWZmZXIuX2F1Z21lbnQodGhpcy5zdWJhcnJheShzdGFydCwgZW5kKSlcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydFxuICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZClcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyBpKyspIHtcbiAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfVxuXG4gIGlmIChuZXdCdWYubGVuZ3RoKSBuZXdCdWYucGFyZW50ID0gdGhpcy5wYXJlbnQgfHwgdGhpc1xuXG4gIHJldHVybiBuZXdCdWZcbn1cblxuLypcbiAqIE5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYnVmZmVyIGlzbid0IHRyeWluZyB0byB3cml0ZSBvdXQgb2YgYm91bmRzLlxuICovXG5mdW5jdGlvbiBjaGVja09mZnNldCAob2Zmc2V0LCBleHQsIGxlbmd0aCkge1xuICBpZiAoKG9mZnNldCAlIDEpICE9PSAwIHx8IG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCcpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG4gIH1cblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdXG4gIHZhciBtdWwgPSAxXG4gIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIHRoaXNbb2Zmc2V0XVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgOCkgfCB0aGlzW29mZnNldCArIDFdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICtcbiAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArXG4gICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgIHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XVxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludEJFID0gZnVuY3Rpb24gcmVhZEludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoXG4gIHZhciBtdWwgPSAxXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV1cbiAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pXG4gIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIDFdIHwgKHRoaXNbb2Zmc2V0XSA8PCA4KVxuICByZXR1cm4gKHZhbCAmIDB4ODAwMCkgPyB2YWwgfCAweEZGRkYwMDAwIDogdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdKSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0QkUgPSBmdW5jdGlvbiByZWFkRmxvYXRCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpXG59XG5cbmZ1bmN0aW9uIGNoZWNrSW50IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignYnVmZmVyIG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCd2YWx1ZSBpcyBvdXQgb2YgYm91bmRzJylcbiAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdpbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludExFID0gZnVuY3Rpb24gd3JpdGVVSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSwgMClcblxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludEJFID0gZnVuY3Rpb24gd3JpdGVVSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSwgMClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxXG4gIHZhciBtdWwgPSAxXG4gIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDggPSBmdW5jdGlvbiB3cml0ZVVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4ZmYsIDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSlcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MTYgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmICsgdmFsdWUgKyAxXG4gIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgMik7IGkgPCBqOyBpKyspIHtcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgJiAoMHhmZiA8PCAoOCAqIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpKSkpID4+PlxuICAgICAgKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkgKiA4XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MzIgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDQpOyBpIDwgajsgaSsrKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlID4+PiAobGl0dGxlRW5kaWFuID8gaSA6IDMgLSBpKSAqIDgpICYgMHhmZlxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gd3JpdGVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKVxuXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpXG4gIH1cblxuICB2YXIgaSA9IDBcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHN1YiA9IHZhbHVlIDwgMCA/IDEgOiAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gdmFsdWUgPCAwID8gMSA6IDBcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDFcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHg3ZmZmZmZmZiwgLTB4ODAwMDAwMDApXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndmFsdWUgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignaW5kZXggb3V0IG9mIHJhbmdlJylcbiAgaWYgKG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdpbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5mdW5jdGlvbiB3cml0ZUZsb2F0IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDQsIDMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgsIC0zLjQwMjgyMzQ2NjM4NTI4ODZlKzM4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDIzLCA0KVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdEJFID0gZnVuY3Rpb24gd3JpdGVGbG9hdEJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbmZ1bmN0aW9uIHdyaXRlRG91YmxlIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDgsIDEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4LCAtMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgpXG4gIH1cbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgNTIsIDgpXG4gIHJldHVybiBvZmZzZXQgKyA4XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVMRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydClcbn1cblxuLy8gY29weSh0YXJnZXRCdWZmZXIsIHRhcmdldFN0YXJ0PTAsIHNvdXJjZVN0YXJ0PTAsIHNvdXJjZUVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gY29weSAodGFyZ2V0LCB0YXJnZXRTdGFydCwgc3RhcnQsIGVuZCkge1xuICBpZiAoIXN0YXJ0KSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgJiYgZW5kICE9PSAwKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAodGFyZ2V0U3RhcnQgPj0gdGFyZ2V0Lmxlbmd0aCkgdGFyZ2V0U3RhcnQgPSB0YXJnZXQubGVuZ3RoXG4gIGlmICghdGFyZ2V0U3RhcnQpIHRhcmdldFN0YXJ0ID0gMFxuICBpZiAoZW5kID4gMCAmJiBlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICAvLyBDb3B5IDAgYnl0ZXM7IHdlJ3JlIGRvbmVcbiAgaWYgKGVuZCA9PT0gc3RhcnQpIHJldHVybiAwXG4gIGlmICh0YXJnZXQubGVuZ3RoID09PSAwIHx8IHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnNcbiAgaWYgKHRhcmdldFN0YXJ0IDwgMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJylcbiAgfVxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKVxuXG4gIC8vIEFyZSB3ZSBvb2I/XG4gIGlmIChlbmQgPiB0aGlzLmxlbmd0aCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCA8IGVuZCAtIHN0YXJ0KSB7XG4gICAgZW5kID0gdGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0ICsgc3RhcnRcbiAgfVxuXG4gIHZhciBsZW4gPSBlbmQgLSBzdGFydFxuICB2YXIgaVxuXG4gIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkge1xuICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZFxuICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIGlmIChsZW4gPCAxMDAwIHx8ICFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIGFzY2VuZGluZyBjb3B5IGZyb20gc3RhcnRcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRhcmdldC5fc2V0KHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSwgdGFyZ2V0U3RhcnQpXG4gIH1cblxuICByZXR1cm4gbGVuXG59XG5cbi8vIGZpbGwodmFsdWUsIHN0YXJ0PTAsIGVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsdWUsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCF2YWx1ZSkgdmFsdWUgPSAwXG4gIGlmICghc3RhcnQpIHN0YXJ0ID0gMFxuICBpZiAoIWVuZCkgZW5kID0gdGhpcy5sZW5ndGhcblxuICBpZiAoZW5kIDwgc3RhcnQpIHRocm93IG5ldyBSYW5nZUVycm9yKCdlbmQgPCBzdGFydCcpXG5cbiAgLy8gRmlsbCAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm5cbiAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm5cblxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChlbmQgPCAwIHx8IGVuZCA+IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignZW5kIG91dCBvZiBib3VuZHMnKVxuXG4gIHZhciBpXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgdGhpc1tpXSA9IHZhbHVlXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IHV0ZjhUb0J5dGVzKHZhbHVlLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIHRoaXNbaV0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBgQXJyYXlCdWZmZXJgIHdpdGggdGhlICpjb3BpZWQqIG1lbW9yeSBvZiB0aGUgYnVmZmVyIGluc3RhbmNlLlxuICogQWRkZWQgaW4gTm9kZSAwLjEyLiBPbmx5IGF2YWlsYWJsZSBpbiBicm93c2VycyB0aGF0IHN1cHBvcnQgQXJyYXlCdWZmZXIuXG4gKi9cbkJ1ZmZlci5wcm90b3R5cGUudG9BcnJheUJ1ZmZlciA9IGZ1bmN0aW9uIHRvQXJyYXlCdWZmZXIgKCkge1xuICBpZiAodHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgICByZXR1cm4gKG5ldyBCdWZmZXIodGhpcykpLmJ1ZmZlclxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5sZW5ndGgpXG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYnVmLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIGJ1ZltpXSA9IHRoaXNbaV1cbiAgICAgIH1cbiAgICAgIHJldHVybiBidWYuYnVmZmVyXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0J1ZmZlci50b0FycmF5QnVmZmVyIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyJylcbiAgfVxufVxuXG4vLyBIRUxQRVIgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09XG5cbnZhciBCUCA9IEJ1ZmZlci5wcm90b3R5cGVcblxuLyoqXG4gKiBBdWdtZW50IGEgVWludDhBcnJheSAqaW5zdGFuY2UqIChub3QgdGhlIFVpbnQ4QXJyYXkgY2xhc3MhKSB3aXRoIEJ1ZmZlciBtZXRob2RzXG4gKi9cbkJ1ZmZlci5fYXVnbWVudCA9IGZ1bmN0aW9uIF9hdWdtZW50IChhcnIpIHtcbiAgYXJyLmNvbnN0cnVjdG9yID0gQnVmZmVyXG4gIGFyci5faXNCdWZmZXIgPSB0cnVlXG5cbiAgLy8gc2F2ZSByZWZlcmVuY2UgdG8gb3JpZ2luYWwgVWludDhBcnJheSBzZXQgbWV0aG9kIGJlZm9yZSBvdmVyd3JpdGluZ1xuICBhcnIuX3NldCA9IGFyci5zZXRcblxuICAvLyBkZXByZWNhdGVkXG4gIGFyci5nZXQgPSBCUC5nZXRcbiAgYXJyLnNldCA9IEJQLnNldFxuXG4gIGFyci53cml0ZSA9IEJQLndyaXRlXG4gIGFyci50b1N0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0xvY2FsZVN0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0pTT04gPSBCUC50b0pTT05cbiAgYXJyLmVxdWFscyA9IEJQLmVxdWFsc1xuICBhcnIuY29tcGFyZSA9IEJQLmNvbXBhcmVcbiAgYXJyLmluZGV4T2YgPSBCUC5pbmRleE9mXG4gIGFyci5jb3B5ID0gQlAuY29weVxuICBhcnIuc2xpY2UgPSBCUC5zbGljZVxuICBhcnIucmVhZFVJbnRMRSA9IEJQLnJlYWRVSW50TEVcbiAgYXJyLnJlYWRVSW50QkUgPSBCUC5yZWFkVUludEJFXG4gIGFyci5yZWFkVUludDggPSBCUC5yZWFkVUludDhcbiAgYXJyLnJlYWRVSW50MTZMRSA9IEJQLnJlYWRVSW50MTZMRVxuICBhcnIucmVhZFVJbnQxNkJFID0gQlAucmVhZFVJbnQxNkJFXG4gIGFyci5yZWFkVUludDMyTEUgPSBCUC5yZWFkVUludDMyTEVcbiAgYXJyLnJlYWRVSW50MzJCRSA9IEJQLnJlYWRVSW50MzJCRVxuICBhcnIucmVhZEludExFID0gQlAucmVhZEludExFXG4gIGFyci5yZWFkSW50QkUgPSBCUC5yZWFkSW50QkVcbiAgYXJyLnJlYWRJbnQ4ID0gQlAucmVhZEludDhcbiAgYXJyLnJlYWRJbnQxNkxFID0gQlAucmVhZEludDE2TEVcbiAgYXJyLnJlYWRJbnQxNkJFID0gQlAucmVhZEludDE2QkVcbiAgYXJyLnJlYWRJbnQzMkxFID0gQlAucmVhZEludDMyTEVcbiAgYXJyLnJlYWRJbnQzMkJFID0gQlAucmVhZEludDMyQkVcbiAgYXJyLnJlYWRGbG9hdExFID0gQlAucmVhZEZsb2F0TEVcbiAgYXJyLnJlYWRGbG9hdEJFID0gQlAucmVhZEZsb2F0QkVcbiAgYXJyLnJlYWREb3VibGVMRSA9IEJQLnJlYWREb3VibGVMRVxuICBhcnIucmVhZERvdWJsZUJFID0gQlAucmVhZERvdWJsZUJFXG4gIGFyci53cml0ZVVJbnQ4ID0gQlAud3JpdGVVSW50OFxuICBhcnIud3JpdGVVSW50TEUgPSBCUC53cml0ZVVJbnRMRVxuICBhcnIud3JpdGVVSW50QkUgPSBCUC53cml0ZVVJbnRCRVxuICBhcnIud3JpdGVVSW50MTZMRSA9IEJQLndyaXRlVUludDE2TEVcbiAgYXJyLndyaXRlVUludDE2QkUgPSBCUC53cml0ZVVJbnQxNkJFXG4gIGFyci53cml0ZVVJbnQzMkxFID0gQlAud3JpdGVVSW50MzJMRVxuICBhcnIud3JpdGVVSW50MzJCRSA9IEJQLndyaXRlVUludDMyQkVcbiAgYXJyLndyaXRlSW50TEUgPSBCUC53cml0ZUludExFXG4gIGFyci53cml0ZUludEJFID0gQlAud3JpdGVJbnRCRVxuICBhcnIud3JpdGVJbnQ4ID0gQlAud3JpdGVJbnQ4XG4gIGFyci53cml0ZUludDE2TEUgPSBCUC53cml0ZUludDE2TEVcbiAgYXJyLndyaXRlSW50MTZCRSA9IEJQLndyaXRlSW50MTZCRVxuICBhcnIud3JpdGVJbnQzMkxFID0gQlAud3JpdGVJbnQzMkxFXG4gIGFyci53cml0ZUludDMyQkUgPSBCUC53cml0ZUludDMyQkVcbiAgYXJyLndyaXRlRmxvYXRMRSA9IEJQLndyaXRlRmxvYXRMRVxuICBhcnIud3JpdGVGbG9hdEJFID0gQlAud3JpdGVGbG9hdEJFXG4gIGFyci53cml0ZURvdWJsZUxFID0gQlAud3JpdGVEb3VibGVMRVxuICBhcnIud3JpdGVEb3VibGVCRSA9IEJQLndyaXRlRG91YmxlQkVcbiAgYXJyLmZpbGwgPSBCUC5maWxsXG4gIGFyci5pbnNwZWN0ID0gQlAuaW5zcGVjdFxuICBhcnIudG9BcnJheUJ1ZmZlciA9IEJQLnRvQXJyYXlCdWZmZXJcblxuICByZXR1cm4gYXJyXG59XG5cbnZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcXC8wLTlBLVphLXotX10vZ1xuXG5mdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7XG4gIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcXG4gYW5kIFxcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdFxuICBzdHIgPSBzdHJpbmd0cmltKHN0cikucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpXG4gIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJydcbiAgaWYgKHN0ci5sZW5ndGggPCAyKSByZXR1cm4gJydcbiAgLy8gTm9kZSBhbGxvd3MgZm9yIG5vbi1wYWRkZWQgYmFzZTY0IHN0cmluZ3MgKG1pc3NpbmcgdHJhaWxpbmcgPT09KSwgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHdoaWxlIChzdHIubGVuZ3RoICUgNCAhPT0gMCkge1xuICAgIHN0ciA9IHN0ciArICc9J1xuICB9XG4gIHJldHVybiBzdHJcbn1cblxuZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7XG4gIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKClcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJylcbn1cblxuZnVuY3Rpb24gdG9IZXggKG4pIHtcbiAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpXG4gIHJldHVybiBuLnRvU3RyaW5nKDE2KVxufVxuXG5mdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykge1xuICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5XG4gIHZhciBjb2RlUG9pbnRcbiAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGhcbiAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsXG4gIHZhciBieXRlcyA9IFtdXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGNvZGVQb2ludCA9IHN0cmluZy5jaGFyQ29kZUF0KGkpXG5cbiAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50XG4gICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHtcbiAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHtcbiAgICAgICAgLy8gbm8gbGVhZCB5ZXRcbiAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikge1xuICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWxcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHtcbiAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkXG4gICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHZhbGlkIGxlYWRcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3dcbiAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHtcbiAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnRcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXJcbiAgICAgIGNvZGVQb2ludCA9IGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDAgfCAweDEwMDAwXG4gICAgfSBlbHNlIGlmIChsZWFkU3Vycm9nYXRlKSB7XG4gICAgICAvLyB2YWxpZCBibXAgY2hhciwgYnV0IGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICB9XG5cbiAgICBsZWFkU3Vycm9nYXRlID0gbnVsbFxuXG4gICAgLy8gZW5jb2RlIHV0ZjhcbiAgICBpZiAoY29kZVBvaW50IDwgMHg4MCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAxKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKGNvZGVQb2ludClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4ODAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgfCAweEMwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMDAwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAzKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHhDIHwgMHhFMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gNCkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4MTIgfCAweEYwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHhDICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvZGUgcG9pbnQnKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBieXRlc1xufVxuXG5mdW5jdGlvbiBhc2NpaVRvQnl0ZXMgKHN0cikge1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi5cbiAgICBieXRlQXJyYXkucHVzaChzdHIuY2hhckNvZGVBdChpKSAmIDB4RkYpXG4gIH1cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiB1dGYxNmxlVG9CeXRlcyAoc3RyLCB1bml0cykge1xuICB2YXIgYywgaGksIGxvXG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVha1xuXG4gICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkpXG4gICAgaGkgPSBjID4+IDhcbiAgICBsbyA9IGMgJSAyNTZcbiAgICBieXRlQXJyYXkucHVzaChsbylcbiAgICBieXRlQXJyYXkucHVzaChoaSlcbiAgfVxuXG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyAoc3RyKSB7XG4gIHJldHVybiBiYXNlNjQudG9CeXRlQXJyYXkoYmFzZTY0Y2xlYW4oc3RyKSlcbn1cblxuZnVuY3Rpb24gYmxpdEJ1ZmZlciAoc3JjLCBkc3QsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoKGkgKyBvZmZzZXQgPj0gZHN0Lmxlbmd0aCkgfHwgKGkgPj0gc3JjLmxlbmd0aCkpIGJyZWFrXG4gICAgZHN0W2kgKyBvZmZzZXRdID0gc3JjW2ldXG4gIH1cbiAgcmV0dXJuIGlcbn1cbiIsInZhciBsb29rdXAgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7XG5cbjsoZnVuY3Rpb24gKGV4cG9ydHMpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG4gIHZhciBBcnIgPSAodHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnKVxuICAgID8gVWludDhBcnJheVxuICAgIDogQXJyYXlcblxuXHR2YXIgUExVUyAgID0gJysnLmNoYXJDb2RlQXQoMClcblx0dmFyIFNMQVNIICA9ICcvJy5jaGFyQ29kZUF0KDApXG5cdHZhciBOVU1CRVIgPSAnMCcuY2hhckNvZGVBdCgwKVxuXHR2YXIgTE9XRVIgID0gJ2EnLmNoYXJDb2RlQXQoMClcblx0dmFyIFVQUEVSICA9ICdBJy5jaGFyQ29kZUF0KDApXG5cdHZhciBQTFVTX1VSTF9TQUZFID0gJy0nLmNoYXJDb2RlQXQoMClcblx0dmFyIFNMQVNIX1VSTF9TQUZFID0gJ18nLmNoYXJDb2RlQXQoMClcblxuXHRmdW5jdGlvbiBkZWNvZGUgKGVsdCkge1xuXHRcdHZhciBjb2RlID0gZWx0LmNoYXJDb2RlQXQoMClcblx0XHRpZiAoY29kZSA9PT0gUExVUyB8fFxuXHRcdCAgICBjb2RlID09PSBQTFVTX1VSTF9TQUZFKVxuXHRcdFx0cmV0dXJuIDYyIC8vICcrJ1xuXHRcdGlmIChjb2RlID09PSBTTEFTSCB8fFxuXHRcdCAgICBjb2RlID09PSBTTEFTSF9VUkxfU0FGRSlcblx0XHRcdHJldHVybiA2MyAvLyAnLydcblx0XHRpZiAoY29kZSA8IE5VTUJFUilcblx0XHRcdHJldHVybiAtMSAvL25vIG1hdGNoXG5cdFx0aWYgKGNvZGUgPCBOVU1CRVIgKyAxMClcblx0XHRcdHJldHVybiBjb2RlIC0gTlVNQkVSICsgMjYgKyAyNlxuXHRcdGlmIChjb2RlIDwgVVBQRVIgKyAyNilcblx0XHRcdHJldHVybiBjb2RlIC0gVVBQRVJcblx0XHRpZiAoY29kZSA8IExPV0VSICsgMjYpXG5cdFx0XHRyZXR1cm4gY29kZSAtIExPV0VSICsgMjZcblx0fVxuXG5cdGZ1bmN0aW9uIGI2NFRvQnl0ZUFycmF5IChiNjQpIHtcblx0XHR2YXIgaSwgaiwgbCwgdG1wLCBwbGFjZUhvbGRlcnMsIGFyclxuXG5cdFx0aWYgKGI2NC5sZW5ndGggJSA0ID4gMCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0Jylcblx0XHR9XG5cblx0XHQvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKVxuXHRcdC8vIGlmIHRoZXJlIGFyZSB0d28gcGxhY2Vob2xkZXJzLCB0aGFuIHRoZSB0d28gY2hhcmFjdGVycyBiZWZvcmUgaXRcblx0XHQvLyByZXByZXNlbnQgb25lIGJ5dGVcblx0XHQvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXNcblx0XHQvLyB0aGlzIGlzIGp1c3QgYSBjaGVhcCBoYWNrIHRvIG5vdCBkbyBpbmRleE9mIHR3aWNlXG5cdFx0dmFyIGxlbiA9IGI2NC5sZW5ndGhcblx0XHRwbGFjZUhvbGRlcnMgPSAnPScgPT09IGI2NC5jaGFyQXQobGVuIC0gMikgPyAyIDogJz0nID09PSBiNjQuY2hhckF0KGxlbiAtIDEpID8gMSA6IDBcblxuXHRcdC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YVxuXHRcdGFyciA9IG5ldyBBcnIoYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzKVxuXG5cdFx0Ly8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuXHRcdGwgPSBwbGFjZUhvbGRlcnMgPiAwID8gYjY0Lmxlbmd0aCAtIDQgOiBiNjQubGVuZ3RoXG5cblx0XHR2YXIgTCA9IDBcblxuXHRcdGZ1bmN0aW9uIHB1c2ggKHYpIHtcblx0XHRcdGFycltMKytdID0gdlxuXHRcdH1cblxuXHRcdGZvciAoaSA9IDAsIGogPSAwOyBpIDwgbDsgaSArPSA0LCBqICs9IDMpIHtcblx0XHRcdHRtcCA9IChkZWNvZGUoYjY0LmNoYXJBdChpKSkgPDwgMTgpIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAxKSkgPDwgMTIpIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAyKSkgPDwgNikgfCBkZWNvZGUoYjY0LmNoYXJBdChpICsgMykpXG5cdFx0XHRwdXNoKCh0bXAgJiAweEZGMDAwMCkgPj4gMTYpXG5cdFx0XHRwdXNoKCh0bXAgJiAweEZGMDApID4+IDgpXG5cdFx0XHRwdXNoKHRtcCAmIDB4RkYpXG5cdFx0fVxuXG5cdFx0aWYgKHBsYWNlSG9sZGVycyA9PT0gMikge1xuXHRcdFx0dG1wID0gKGRlY29kZShiNjQuY2hhckF0KGkpKSA8PCAyKSB8IChkZWNvZGUoYjY0LmNoYXJBdChpICsgMSkpID4+IDQpXG5cdFx0XHRwdXNoKHRtcCAmIDB4RkYpXG5cdFx0fSBlbHNlIGlmIChwbGFjZUhvbGRlcnMgPT09IDEpIHtcblx0XHRcdHRtcCA9IChkZWNvZGUoYjY0LmNoYXJBdChpKSkgPDwgMTApIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAxKSkgPDwgNCkgfCAoZGVjb2RlKGI2NC5jaGFyQXQoaSArIDIpKSA+PiAyKVxuXHRcdFx0cHVzaCgodG1wID4+IDgpICYgMHhGRilcblx0XHRcdHB1c2godG1wICYgMHhGRilcblx0XHR9XG5cblx0XHRyZXR1cm4gYXJyXG5cdH1cblxuXHRmdW5jdGlvbiB1aW50OFRvQmFzZTY0ICh1aW50OCkge1xuXHRcdHZhciBpLFxuXHRcdFx0ZXh0cmFCeXRlcyA9IHVpbnQ4Lmxlbmd0aCAlIDMsIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzXG5cdFx0XHRvdXRwdXQgPSBcIlwiLFxuXHRcdFx0dGVtcCwgbGVuZ3RoXG5cblx0XHRmdW5jdGlvbiBlbmNvZGUgKG51bSkge1xuXHRcdFx0cmV0dXJuIGxvb2t1cC5jaGFyQXQobnVtKVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7XG5cdFx0XHRyZXR1cm4gZW5jb2RlKG51bSA+PiAxOCAmIDB4M0YpICsgZW5jb2RlKG51bSA+PiAxMiAmIDB4M0YpICsgZW5jb2RlKG51bSA+PiA2ICYgMHgzRikgKyBlbmNvZGUobnVtICYgMHgzRilcblx0XHR9XG5cblx0XHQvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyXG5cdFx0Zm9yIChpID0gMCwgbGVuZ3RoID0gdWludDgubGVuZ3RoIC0gZXh0cmFCeXRlczsgaSA8IGxlbmd0aDsgaSArPSAzKSB7XG5cdFx0XHR0ZW1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKVxuXHRcdFx0b3V0cHV0ICs9IHRyaXBsZXRUb0Jhc2U2NCh0ZW1wKVxuXHRcdH1cblxuXHRcdC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcblx0XHRzd2l0Y2ggKGV4dHJhQnl0ZXMpIHtcblx0XHRcdGNhc2UgMTpcblx0XHRcdFx0dGVtcCA9IHVpbnQ4W3VpbnQ4Lmxlbmd0aCAtIDFdXG5cdFx0XHRcdG91dHB1dCArPSBlbmNvZGUodGVtcCA+PiAyKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKCh0ZW1wIDw8IDQpICYgMHgzRilcblx0XHRcdFx0b3V0cHV0ICs9ICc9PSdcblx0XHRcdFx0YnJlYWtcblx0XHRcdGNhc2UgMjpcblx0XHRcdFx0dGVtcCA9ICh1aW50OFt1aW50OC5sZW5ndGggLSAyXSA8PCA4KSArICh1aW50OFt1aW50OC5sZW5ndGggLSAxXSlcblx0XHRcdFx0b3V0cHV0ICs9IGVuY29kZSh0ZW1wID4+IDEwKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKCh0ZW1wID4+IDQpICYgMHgzRilcblx0XHRcdFx0b3V0cHV0ICs9IGVuY29kZSgodGVtcCA8PCAyKSAmIDB4M0YpXG5cdFx0XHRcdG91dHB1dCArPSAnPSdcblx0XHRcdFx0YnJlYWtcblx0XHR9XG5cblx0XHRyZXR1cm4gb3V0cHV0XG5cdH1cblxuXHRleHBvcnRzLnRvQnl0ZUFycmF5ID0gYjY0VG9CeXRlQXJyYXlcblx0ZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gdWludDhUb0Jhc2U2NFxufSh0eXBlb2YgZXhwb3J0cyA9PT0gJ3VuZGVmaW5lZCcgPyAodGhpcy5iYXNlNjRqcyA9IHt9KSA6IGV4cG9ydHMpKVxuIiwiZXhwb3J0cy5yZWFkID0gZnVuY3Rpb24gKGJ1ZmZlciwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG1cbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBuQml0cyA9IC03XG4gIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDBcbiAgdmFyIGQgPSBpc0xFID8gLTEgOiAxXG4gIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldXG5cbiAgaSArPSBkXG5cbiAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgcyA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gZUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIG0gPSBlICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpXG4gIGUgPj49ICgtbkJpdHMpXG4gIG5CaXRzICs9IG1MZW5cbiAgZm9yICg7IG5CaXRzID4gMDsgbSA9IG0gKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge31cblxuICBpZiAoZSA9PT0gMCkge1xuICAgIGUgPSAxIC0gZUJpYXNcbiAgfSBlbHNlIGlmIChlID09PSBlTWF4KSB7XG4gICAgcmV0dXJuIG0gPyBOYU4gOiAoKHMgPyAtMSA6IDEpICogSW5maW5pdHkpXG4gIH0gZWxzZSB7XG4gICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKVxuICAgIGUgPSBlIC0gZUJpYXNcbiAgfVxuICByZXR1cm4gKHMgPyAtMSA6IDEpICogbSAqIE1hdGgucG93KDIsIGUgLSBtTGVuKVxufVxuXG5leHBvcnRzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtLCBjXG4gIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxXG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxXG4gIHZhciBlQmlhcyA9IGVNYXggPj4gMVxuICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApXG4gIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSlcbiAgdmFyIGQgPSBpc0xFID8gMSA6IC0xXG4gIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwXG5cbiAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSlcblxuICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkge1xuICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMFxuICAgIGUgPSBlTWF4XG4gIH0gZWxzZSB7XG4gICAgZSA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpXG4gICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgZS0tXG4gICAgICBjICo9IDJcbiAgICB9XG4gICAgaWYgKGUgKyBlQmlhcyA+PSAxKSB7XG4gICAgICB2YWx1ZSArPSBydCAvIGNcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpXG4gICAgfVxuICAgIGlmICh2YWx1ZSAqIGMgPj0gMikge1xuICAgICAgZSsrXG4gICAgICBjIC89IDJcbiAgICB9XG5cbiAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHtcbiAgICAgIG0gPSAwXG4gICAgICBlID0gZU1heFxuICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IGUgKyBlQmlhc1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gdmFsdWUgKiBNYXRoLnBvdygyLCBlQmlhcyAtIDEpICogTWF0aC5wb3coMiwgbUxlbilcbiAgICAgIGUgPSAwXG4gICAgfVxuICB9XG5cbiAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCkge31cblxuICBlID0gKGUgPDwgbUxlbikgfCBtXG4gIGVMZW4gKz0gbUxlblxuICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGUgJiAweGZmLCBpICs9IGQsIGUgLz0gMjU2LCBlTGVuIC09IDgpIHt9XG5cbiAgYnVmZmVyW29mZnNldCArIGkgLSBkXSB8PSBzICogMTI4XG59XG4iLCJcbi8qKlxuICogaXNBcnJheVxuICovXG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcblxuLyoqXG4gKiB0b1N0cmluZ1xuICovXG5cbnZhciBzdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vKipcbiAqIFdoZXRoZXIgb3Igbm90IHRoZSBnaXZlbiBgdmFsYFxuICogaXMgYW4gYXJyYXkuXG4gKlxuICogZXhhbXBsZTpcbiAqXG4gKiAgICAgICAgaXNBcnJheShbXSk7XG4gKiAgICAgICAgLy8gPiB0cnVlXG4gKiAgICAgICAgaXNBcnJheShhcmd1bWVudHMpO1xuICogICAgICAgIC8vID4gZmFsc2VcbiAqICAgICAgICBpc0FycmF5KCcnKTtcbiAqICAgICAgICAvLyA+IGZhbHNlXG4gKlxuICogQHBhcmFtIHttaXhlZH0gdmFsXG4gKiBAcmV0dXJuIHtib29sfVxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gaXNBcnJheSB8fCBmdW5jdGlvbiAodmFsKSB7XG4gIHJldHVybiAhISB2YWwgJiYgJ1tvYmplY3QgQXJyYXldJyA9PSBzdHIuY2FsbCh2YWwpO1xufTtcbiIsIihmdW5jdGlvbih3aW5kb3cpIHtcblx0dmFyIEhBU19IQVNIQ0hBTkdFID0gKGZ1bmN0aW9uKCkge1xuXHRcdHZhciBkb2NfbW9kZSA9IHdpbmRvdy5kb2N1bWVudE1vZGU7XG5cdFx0cmV0dXJuICgnb25oYXNoY2hhbmdlJyBpbiB3aW5kb3cpICYmXG5cdFx0XHQoZG9jX21vZGUgPT09IHVuZGVmaW5lZCB8fCBkb2NfbW9kZSA+IDcpO1xuXHR9KSgpO1xuXG5cdEwuSGFzaCA9IGZ1bmN0aW9uKG1hcCkge1xuXHRcdHRoaXMub25IYXNoQ2hhbmdlID0gTC5VdGlsLmJpbmQodGhpcy5vbkhhc2hDaGFuZ2UsIHRoaXMpO1xuXG5cdFx0aWYgKG1hcCkge1xuXHRcdFx0dGhpcy5pbml0KG1hcCk7XG5cdFx0fVxuXHR9O1xuXG5cdEwuSGFzaC5wYXJzZUhhc2ggPSBmdW5jdGlvbihoYXNoKSB7XG5cdFx0aWYoaGFzaC5pbmRleE9mKCcjJykgPT09IDApIHtcblx0XHRcdGhhc2ggPSBoYXNoLnN1YnN0cigxKTtcblx0XHR9XG5cdFx0dmFyIGFyZ3MgPSBoYXNoLnNwbGl0KFwiL1wiKTtcblx0XHRpZiAoYXJncy5sZW5ndGggPT0gMykge1xuXHRcdFx0dmFyIHpvb20gPSBwYXJzZUludChhcmdzWzBdLCAxMCksXG5cdFx0XHRsYXQgPSBwYXJzZUZsb2F0KGFyZ3NbMV0pLFxuXHRcdFx0bG9uID0gcGFyc2VGbG9hdChhcmdzWzJdKTtcblx0XHRcdGlmIChpc05hTih6b29tKSB8fCBpc05hTihsYXQpIHx8IGlzTmFOKGxvbikpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRjZW50ZXI6IG5ldyBMLkxhdExuZyhsYXQsIGxvbiksXG5cdFx0XHRcdFx0em9vbTogem9vbVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9O1xuXG5cdEwuSGFzaC5mb3JtYXRIYXNoID0gZnVuY3Rpb24obWFwKSB7XG5cdFx0dmFyIGNlbnRlciA9IG1hcC5nZXRDZW50ZXIoKSxcblx0XHQgICAgem9vbSA9IG1hcC5nZXRab29tKCksXG5cdFx0ICAgIHByZWNpc2lvbiA9IE1hdGgubWF4KDAsIE1hdGguY2VpbChNYXRoLmxvZyh6b29tKSAvIE1hdGguTE4yKSk7XG5cblx0XHRyZXR1cm4gXCIjXCIgKyBbem9vbSxcblx0XHRcdGNlbnRlci5sYXQudG9GaXhlZChwcmVjaXNpb24pLFxuXHRcdFx0Y2VudGVyLmxuZy50b0ZpeGVkKHByZWNpc2lvbilcblx0XHRdLmpvaW4oXCIvXCIpO1xuXHR9LFxuXG5cdEwuSGFzaC5wcm90b3R5cGUgPSB7XG5cdFx0bWFwOiBudWxsLFxuXHRcdGxhc3RIYXNoOiBudWxsLFxuXG5cdFx0cGFyc2VIYXNoOiBMLkhhc2gucGFyc2VIYXNoLFxuXHRcdGZvcm1hdEhhc2g6IEwuSGFzaC5mb3JtYXRIYXNoLFxuXG5cdFx0aW5pdDogZnVuY3Rpb24obWFwKSB7XG5cdFx0XHR0aGlzLm1hcCA9IG1hcDtcblxuXHRcdFx0Ly8gcmVzZXQgdGhlIGhhc2hcblx0XHRcdHRoaXMubGFzdEhhc2ggPSBudWxsO1xuXHRcdFx0dGhpcy5vbkhhc2hDaGFuZ2UoKTtcblxuXHRcdFx0aWYgKCF0aGlzLmlzTGlzdGVuaW5nKSB7XG5cdFx0XHRcdHRoaXMuc3RhcnRMaXN0ZW5pbmcoKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0cmVtb3ZlRnJvbTogZnVuY3Rpb24obWFwKSB7XG5cdFx0XHRpZiAodGhpcy5jaGFuZ2VUaW1lb3V0KSB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNoYW5nZVRpbWVvdXQpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGhpcy5pc0xpc3RlbmluZykge1xuXHRcdFx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcoKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5tYXAgPSBudWxsO1xuXHRcdH0sXG5cblx0XHRvbk1hcE1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gYmFpbCBpZiB3ZSdyZSBtb3ZpbmcgdGhlIG1hcCAodXBkYXRpbmcgZnJvbSBhIGhhc2gpLFxuXHRcdFx0Ly8gb3IgaWYgdGhlIG1hcCBpcyBub3QgeWV0IGxvYWRlZFxuXG5cdFx0XHRpZiAodGhpcy5tb3ZpbmdNYXAgfHwgIXRoaXMubWFwLl9sb2FkZWQpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgaGFzaCA9IHRoaXMuZm9ybWF0SGFzaCh0aGlzLm1hcCk7XG5cdFx0XHRpZiAodGhpcy5sYXN0SGFzaCAhPSBoYXNoKSB7XG5cdFx0XHRcdGxvY2F0aW9uLnJlcGxhY2UoaGFzaCk7XG5cdFx0XHRcdHRoaXMubGFzdEhhc2ggPSBoYXNoO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRtb3ZpbmdNYXA6IGZhbHNlLFxuXHRcdHVwZGF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaGFzaCA9IGxvY2F0aW9uLmhhc2g7XG5cdFx0XHRpZiAoaGFzaCA9PT0gdGhpcy5sYXN0SGFzaCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR2YXIgcGFyc2VkID0gdGhpcy5wYXJzZUhhc2goaGFzaCk7XG5cdFx0XHRpZiAocGFyc2VkKSB7XG5cdFx0XHRcdHRoaXMubW92aW5nTWFwID0gdHJ1ZTtcblxuXHRcdFx0XHR0aGlzLm1hcC5zZXRWaWV3KHBhcnNlZC5jZW50ZXIsIHBhcnNlZC56b29tKTtcblxuXHRcdFx0XHR0aGlzLm1vdmluZ01hcCA9IGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5vbk1hcE1vdmUodGhpcy5tYXApO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHQvLyBkZWZlciBoYXNoIGNoYW5nZSB1cGRhdGVzIGV2ZXJ5IDEwMG1zXG5cdFx0Y2hhbmdlRGVmZXI6IDEwMCxcblx0XHRjaGFuZ2VUaW1lb3V0OiBudWxsLFxuXHRcdG9uSGFzaENoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyB0aHJvdHRsZSBjYWxscyB0byB1cGRhdGUoKSBzbyB0aGF0IHRoZXkgb25seSBoYXBwZW4gZXZlcnlcblx0XHRcdC8vIGBjaGFuZ2VEZWZlcmAgbXNcblx0XHRcdGlmICghdGhpcy5jaGFuZ2VUaW1lb3V0KSB7XG5cdFx0XHRcdHZhciB0aGF0ID0gdGhpcztcblx0XHRcdFx0dGhpcy5jaGFuZ2VUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR0aGF0LnVwZGF0ZSgpO1xuXHRcdFx0XHRcdHRoYXQuY2hhbmdlVGltZW91dCA9IG51bGw7XG5cdFx0XHRcdH0sIHRoaXMuY2hhbmdlRGVmZXIpO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRpc0xpc3RlbmluZzogZmFsc2UsXG5cdFx0aGFzaENoYW5nZUludGVydmFsOiBudWxsLFxuXHRcdHN0YXJ0TGlzdGVuaW5nOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMubWFwLm9uKFwibW92ZWVuZFwiLCB0aGlzLm9uTWFwTW92ZSwgdGhpcyk7XG5cblx0XHRcdGlmIChIQVNfSEFTSENIQU5HRSkge1xuXHRcdFx0XHRMLkRvbUV2ZW50LmFkZExpc3RlbmVyKHdpbmRvdywgXCJoYXNoY2hhbmdlXCIsIHRoaXMub25IYXNoQ2hhbmdlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwodGhpcy5oYXNoQ2hhbmdlSW50ZXJ2YWwpO1xuXHRcdFx0XHR0aGlzLmhhc2hDaGFuZ2VJbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMub25IYXNoQ2hhbmdlLCA1MCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmlzTGlzdGVuaW5nID0gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0c3RvcExpc3RlbmluZzogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLm1hcC5vZmYoXCJtb3ZlZW5kXCIsIHRoaXMub25NYXBNb3ZlLCB0aGlzKTtcblxuXHRcdFx0aWYgKEhBU19IQVNIQ0hBTkdFKSB7XG5cdFx0XHRcdEwuRG9tRXZlbnQucmVtb3ZlTGlzdGVuZXIod2luZG93LCBcImhhc2hjaGFuZ2VcIiwgdGhpcy5vbkhhc2hDaGFuZ2UpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbCh0aGlzLmhhc2hDaGFuZ2VJbnRlcnZhbCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmlzTGlzdGVuaW5nID0gZmFsc2U7XG5cdFx0fVxuXHR9O1xuXHRMLmhhc2ggPSBmdW5jdGlvbihtYXApIHtcblx0XHRyZXR1cm4gbmV3IEwuSGFzaChtYXApO1xuXHR9O1xuXHRMLk1hcC5wcm90b3R5cGUuYWRkSGFzaCA9IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX2hhc2ggPSBMLmhhc2godGhpcyk7XG5cdH07XG5cdEwuTWFwLnByb3RvdHlwZS5yZW1vdmVIYXNoID0gZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faGFzaC5yZW1vdmVGcm9tKCk7XG5cdH07XG59KSh3aW5kb3cpO1xuIiwidmFyIHNwaGVyZUtubiA9IHJlcXVpcmUoJ3NwaGVyZS1rbm4nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihsYXllcikge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmICghKGxheWVyIGluc3RhbmNlb2YgTC5HZW9KU09OKSkgdGhyb3cgbmV3IEVycm9yKCdtdXN0IGJlIEwuR2VvSlNPTicpO1xuXG4gICAgdmFyIHBvaW50cyA9IFtdO1xuXG4gICAgbGF5ZXIuZWFjaExheWVyKGNvbGxlY3RQb2ludHMpO1xuXG4gICAgZnVuY3Rpb24gY29sbGVjdFBvaW50cyhsKSB7XG4gICAgICAgIHBvaW50cyA9IHBvaW50cy5jb25jYXQocmVmb3JtYXQoZmxhdChsLmZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpLCBsKSk7XG4gICAgfVxuXG4gICAgdmFyIHNrbm4gPSBzcGhlcmVLbm4ocG9pbnRzKTtcblxuICAgIHNrbm4ubmVhcmVzdCA9IGZ1bmN0aW9uKHAsIG4sIG1heF9kaXN0YW5jZSkge1xuICAgICAgICBpZiAocCBpbnN0YW5jZW9mIEwuTGF0TG5nKSBwID0gW3AubG5nLCBwLmxhdF07XG4gICAgICAgIHJldHVybiBza25uKHBbMV0sIHBbMF0sIG4sIG1heF9kaXN0YW5jZSk7XG4gICAgfTtcblxuICAgIHNrbm4ubmVhcmVzdExheWVyID0gZnVuY3Rpb24ocCwgbiwgbWF4X2Rpc3RhbmNlKSB7XG4gICAgICAgIGlmIChwIGluc3RhbmNlb2YgTC5MYXRMbmcpIHAgPSBbcC5sbmcsIHAubGF0XTtcbiAgICAgICAgcmV0dXJuIGNvbGxhcHNlKHNrbm4ocFsxXSwgcFswXSwgbiwgbWF4X2Rpc3RhbmNlKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBza25uO1xufTtcblxuZnVuY3Rpb24gY29sbGFwc2UocmVzdWx0cykge1xuICAgIHZhciBsID0gW10sIGluY2x1ZGVkID0ge307XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpbmNsdWRlZFtMLnN0YW1wKHJlc3VsdHNbaV0ubGF5ZXIpXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGwucHVzaChyZXN1bHRzW2ldKTtcbiAgICAgICAgICAgIGluY2x1ZGVkW0wuc3RhbXAocmVzdWx0c1tpXS5sYXllcildID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbDtcbn1cblxuZnVuY3Rpb24gcmVmb3JtYXQoY29vcmRzLCBsYXllcikge1xuICAgIHZhciBsID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbC5wdXNoKHsgbG9uOiBjb29yZHNbaV1bMF0sIGxhdDogY29vcmRzW2ldWzFdLCBsYXllcjogbGF5ZXIgfSk7XG4gICAgfVxuICAgIHJldHVybiBsO1xufVxuXG5mdW5jdGlvbiBmbGF0KGNvb3Jkcykge1xuICAgIHZhciBpID0gMCwgaiA9IDAsIGsgPSAwLCBsID0gW107XG4gICAgaWYgKHR5cGVvZiBjb29yZHNbMF0gPT09ICdvYmplY3QnICYmXG4gICAgICAgIHR5cGVvZiBjb29yZHNbMF1bMF0gPT09ICdvYmplY3QnICYmXG4gICAgICAgIHR5cGVvZiBjb29yZHNbMF1bMF1bMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAoO2kgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoO2ogPCBjb29yZHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKDtrIDwgY29vcmRzW2ldW2pdLmxlbmd0aDsgaysrKSBsLnB1c2goY29vcmRzW2ldW2pdW2tdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb29yZHNbMF0gPT09ICdvYmplY3QnICYmXG4gICAgICAgIHR5cGVvZiBjb29yZHNbMF1bMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAoO2kgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoO2ogPCBjb29yZHNbaV0ubGVuZ3RoOyBqKyspIGwucHVzaChjb29yZHNbaV1bal0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvb3Jkc1swXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgcmV0dXJuIGNvb3JkcztcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gW2Nvb3Jkc107XG4gICAgfVxufVxuIiwidmFyIHNwaGVyZWtkID0gcmVxdWlyZShcIi4vbGliL3NwaGVyZWtkXCIpXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnRzKSB7XG4gIC8qIEluZmxhdGUgdGhlIHRvYWQhICovXG4gIHZhciByb290ID0gc3BoZXJla2QuYnVpbGQocG9pbnRzKVxuXG4gIC8qIEx1cmNoIG9mZiBpbnRvIHRoZSBzdW5zZXQhICovXG4gIHJldHVybiBmdW5jdGlvbihsYXQsIGxvbiwgbiwgbWF4KSB7XG4gICAgcmV0dXJuIHNwaGVyZWtkLmxvb2t1cChsYXQsIGxvbiwgcm9vdCwgbiwgbWF4KVxuICB9XG59XG4iLCJmdW5jdGlvbiBkZWZhdWx0Q29tcGFyYXRvcihhLCBiKSB7XG4gIHJldHVybiBhIC0gYlxufVxuXG5leHBvcnRzLnNlYXJjaCA9IGZ1bmN0aW9uKGl0ZW0sIGFycmF5LCBjb21wYXJhdG9yKSB7XG4gIGlmKCFjb21wYXJhdG9yKVxuICAgIGNvbXBhcmF0b3IgPSBkZWZhdWx0Q29tcGFyYXRvclxuXG4gIHZhciBsb3cgID0gMCxcbiAgICAgIGhpZ2ggPSBhcnJheS5sZW5ndGggLSAxLFxuICAgICAgbWlkLCBjb21wXG5cbiAgd2hpbGUobG93IDw9IGhpZ2gpIHtcbiAgICBtaWQgID0gKGxvdyArIGhpZ2gpID4+PiAxXG4gICAgY29tcCA9IGNvbXBhcmF0b3IoYXJyYXlbbWlkXSwgaXRlbSlcblxuICAgIGlmKGNvbXAgPCAwKVxuICAgICAgbG93ID0gbWlkICsgMVxuXG4gICAgZWxzZSBpZihjb21wID4gMClcbiAgICAgIGhpZ2ggPSBtaWQgLSAxXG5cbiAgICBlbHNlXG4gICAgICByZXR1cm4gbWlkXG4gIH1cblxuICByZXR1cm4gLShsb3cgKyAxKVxufVxuXG5leHBvcnRzLmluc2VydCA9IGZ1bmN0aW9uKGl0ZW0sIGFycmF5LCBjb21wYXJhdG9yKSB7XG4gIHZhciBpID0gZXhwb3J0cy5zZWFyY2goaXRlbSwgYXJyYXksIGNvbXBhcmF0b3IpXG5cbiAgaWYoaSA8IDApXG4gICAgaSA9IC0oaSArIDEpXG5cbiAgYXJyYXkuc3BsaWNlKGksIDAsIGl0ZW0pXG59XG4iLCJ2YXIgYmluYXJ5ID0gcmVxdWlyZShcIi4vYmluYXJ5XCIpXG5cbmZ1bmN0aW9uIE5vZGUoYXhpcywgc3BsaXQsIGxlZnQsIHJpZ2h0KSB7XG4gIHRoaXMuYXhpcyAgPSBheGlzXG4gIHRoaXMuc3BsaXQgPSBzcGxpdFxuICB0aGlzLmxlZnQgID0gbGVmdFxuICB0aGlzLnJpZ2h0ID0gcmlnaHRcbn1cblxuZnVuY3Rpb24gZGlzdGFuY2UoYSwgYikge1xuICB2YXIgaSA9IE1hdGgubWluKGEubGVuZ3RoLCBiLmxlbmd0aCksXG4gICAgICBkID0gMCxcbiAgICAgIGtcblxuICB3aGlsZShpLS0pIHtcbiAgICBrICA9IGJbaV0gLSBhW2ldXG4gICAgZCArPSBrICoga1xuICB9XG5cbiAgcmV0dXJuIGRcbn1cblxuZnVuY3Rpb24gYnlEaXN0YW5jZShhLCBiKSB7XG4gIHJldHVybiBhLmRpc3QgLSBiLmRpc3Rcbn1cblxuZnVuY3Rpb24gYnVpbGRyZWMoYXJyYXksIGRlcHRoKSB7XG4gIC8qIFRoaXMgc2hvdWxkIG9ubHkgaGFwcGVuIGlmIHlvdSByZXF1ZXN0IGEga2QtdHJlZSB3aXRoIHplcm8gZWxlbWVudHMuICovXG4gIGlmKGFycmF5Lmxlbmd0aCA9PT0gMClcbiAgICByZXR1cm4gbnVsbFxuXG4gIC8qIElmIHRoZXJlJ3Mgb25seSBvbmUgaXRlbSwgdGhlbiBpdCdzIGEgbGVhZiBub2RlISAqL1xuICBpZihhcnJheS5sZW5ndGggPT09IDEpXG4gICAgcmV0dXJuIGFycmF5WzBdXG5cbiAgLyogVWggb2guIFdlbGwsIHdlIGhhdmUgdG8gcGFydGl0aW9uIHRoZSBkYXRhIHNldCBhbmQgcmVjdXJzZS4gU3RhcnQgYnlcbiAgICogZmluZGluZyB0aGUgYm91bmRpbmcgYm94IG9mIHRoZSBnaXZlbiBwb2ludHM7IHdoaWNoZXZlciBzaWRlIGlzIHRoZVxuICAgKiBsb25nZXN0IGlzIHRoZSBvbmUgd2UnbGwgdXNlIGZvciB0aGUgc3BsaXR0aW5nIHBsYW5lLiAqL1xuICB2YXIgYXhpcyA9IGRlcHRoICUgYXJyYXlbMF0ucG9zaXRpb24ubGVuZ3RoXG5cbiAgLyogU29ydCB0aGUgcG9pbnRzIGFsb25nIHRoZSBzcGxpdHRpbmcgcGxhbmUuICovXG4gIC8qIEZJWE1FOiBGb3IgdmVyeSBsYXJnZSB0cmVlcywgaXQgd291bGQgYmUgZmFzdGVyIHRvIHVzZSBzb21lIHNvcnQgb2YgbWVkaWFuXG4gICAqIGZpbmRpbmcgYW5kIHBhcnRpdGlvbmluZyBhbGdvcml0aG0uIEl0J2QgYWxzbyBiZSBhIGxvdCBtb3JlIGNvbXBsaWNhdGVkLiAqL1xuICBhcnJheS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gYS5wb3NpdGlvbltheGlzXSAtIGIucG9zaXRpb25bYXhpc11cbiAgfSlcblxuICAvKiBGaW5kIHRoZSBtZWRpYW4gcG9pbnQuIEl0J3MgcG9zaXRpb24gaXMgZ29pbmcgdG8gYmUgdGhlIGxvY2F0aW9uIG9mIHRoZVxuICAgKiBzcGxpdHRpbmcgcGxhbmUuICovXG4gIHZhciBpID0gTWF0aC5mbG9vcihhcnJheS5sZW5ndGggKiAwLjUpXG5cbiAgLyogU3BsaXQsIHJlY3Vyc2UsIHlhZGRhIHlhZGRhLiAqL1xuICArK2RlcHRoXG5cbiAgcmV0dXJuIG5ldyBOb2RlKFxuICAgIGF4aXMsXG4gICAgYXJyYXlbaV0ucG9zaXRpb25bYXhpc10sXG4gICAgYnVpbGRyZWMoYXJyYXkuc2xpY2UoMCwgaSksIGRlcHRoKSxcbiAgICBidWlsZHJlYyhhcnJheS5zbGljZShpICAgKSwgZGVwdGgpXG4gIClcbn1cblxuZnVuY3Rpb24gYnVpbGQoYXJyYXkpIHtcbiAgcmV0dXJuIGJ1aWxkcmVjKGFycmF5LCAwKVxufVxuXG5mdW5jdGlvbiBsb29rdXAocG9zaXRpb24sIG5vZGUsIG4sIG1heCkge1xuICBpZighKG1heCA+IDApKVxuICAgIG1heCA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWVxuXG4gIHZhciBhcnJheSA9IFtdXG5cbiAgLyogRGVnZW5lcmF0ZSBjYXNlcy4gKi9cbiAgaWYobm9kZSA9PT0gbnVsbCB8fCBuIDw9IDApXG4gICAgcmV0dXJuIGFycmF5XG5cbiAgdmFyIHN0YWNrID0gW25vZGUsIDBdLFxuICAgICAgZGlzdCwgaVxuXG4gIHdoaWxlKHN0YWNrLmxlbmd0aCkge1xuICAgIGRpc3QgPSBzdGFjay5wb3AoKVxuICAgIG5vZGUgPSBzdGFjay5wb3AoKVxuXG4gICAgLyogSWYgdGhpcyBzdWJ0cmVlIGlzIGZ1cnRoZXIgYXdheSB0aGFuIHdlIGNhcmUgYWJvdXQsIHRoZW4gc2tpcCBpdC4gKi9cbiAgICBpZihkaXN0ID4gbWF4KVxuICAgICAgY29udGludWVcblxuICAgIC8qIElmIHdlJ3ZlIGFscmVhZHkgZm91bmQgZW5vdWdoIGxvY2F0aW9ucywgYW5kIHRoZSBmdXJ0aGVzdCBvbmUgaXMgY2xvc2VyXG4gICAgICogdGhhbiB0aGlzIHN1YnRyZWUgcG9zc2libHkgY291bGQgYmUsIGp1c3Qgc2tpcCB0aGUgc3VidHJlZS4gKi9cbiAgICBpZihhcnJheS5sZW5ndGggPT09IG4gJiYgYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV0uZGlzdCA8IGRpc3QgKiBkaXN0KVxuICAgICAgY29udGludWVcblxuICAgIC8qIEl0ZXJhdGUgYWxsIHRoZSB3YXkgZG93biB0aGUgdHJlZSwgYWRkaW5nIG5vZGVzIHRoYXQgd2UgbmVlZCB0byByZW1lbWJlclxuICAgICAqIHRvIHZpc2l0IGxhdGVyIG9udG8gdGhlIHN0YWNrLiAqL1xuICAgIHdoaWxlKG5vZGUgaW5zdGFuY2VvZiBOb2RlKSB7XG4gICAgICBpZihwb3NpdGlvbltub2RlLmF4aXNdIDwgbm9kZS5zcGxpdCkge1xuICAgICAgICBzdGFjay5wdXNoKG5vZGUucmlnaHQsIG5vZGUuc3BsaXQgLSBwb3NpdGlvbltub2RlLmF4aXNdKVxuICAgICAgICBub2RlID0gbm9kZS5sZWZ0XG4gICAgICB9XG5cbiAgICAgIGVsc2Uge1xuICAgICAgICBzdGFjay5wdXNoKG5vZGUubGVmdCwgcG9zaXRpb25bbm9kZS5heGlzXSAtIG5vZGUuc3BsaXQpXG4gICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyogT25jZSB3ZSd2ZSBoaXQgYSBsZWFmIG5vZGUsIGluc2VydCBpdCBpbnRvIHRoZSBhcnJheSBvZiBjYW5kaWRhdGVzLFxuICAgICAqIG1ha2luZyBzdXJlIHRvIGtlZXAgdGhlIGFycmF5IGluIHNvcnRlZCBvcmRlci4gKi9cbiAgICBkaXN0ID0gZGlzdGFuY2UocG9zaXRpb24sIG5vZGUucG9zaXRpb24pXG4gICAgaWYoZGlzdCA8PSBtYXggKiBtYXgpXG4gICAgICBiaW5hcnkuaW5zZXJ0KHtvYmplY3Q6IG5vZGUsIGRpc3Q6IGRpc3R9LCBhcnJheSwgYnlEaXN0YW5jZSlcblxuICAgIC8qIElmIHRoZSBhcnJheSdzIHRvbyBsb25nLCBjdWxsIGl0LiAqL1xuICAgIGlmKGFycmF5Lmxlbmd0aCA+IG4pXG4gICAgICBhcnJheS5wb3AoKVxuICB9XG5cbiAgLyogU3RyaXAgY2FuZGlkYXRlIHdyYXBwZXIgb2JqZWN0cy4gKi9cbiAgaSA9IGFycmF5Lmxlbmd0aFxuXG4gIHdoaWxlKGktLSlcbiAgICBhcnJheVtpXSA9IGFycmF5W2ldLm9iamVjdFxuXG4gIHJldHVybiBhcnJheVxufVxuXG5leHBvcnRzLmJ1aWxkICA9IGJ1aWxkXG5leHBvcnRzLmxvb2t1cCA9IGxvb2t1cFxuIiwidmFyIGtkICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiLi9rZFwiKSxcbiAgICByYWQgICAgICAgICAgICAgID0gTWF0aC5QSSAvIDE4MCxcbiAgICBpbnZFYXJ0aERpYW1ldGVyID0gMSAvIDEyNzQyMDE4IC8qIG1ldGVycyAqL1xuXG5mdW5jdGlvbiBzcGhlcmljYWwyY2FydGVzaWFuKGxhdCwgbG9uKSB7XG4gIGxhdCAqPSByYWRcbiAgbG9uICo9IHJhZFxuICB2YXIgY29zID0gTWF0aC5jb3MobGF0KVxuICByZXR1cm4gW2NvcyAqIE1hdGguY29zKGxvbiksIE1hdGguc2luKGxhdCksIGNvcyAqIE1hdGguc2luKGxvbildXG59XG5cbmZ1bmN0aW9uIFBvc2l0aW9uKG9iamVjdCkge1xuICB2YXIgbGF0LCBsb247XG5cbiAgLyogRmluZCBsYXRpdHVkZS4gKi9cbiAgaWYob2JqZWN0Lmhhc093blByb3BlcnR5KFwibGF0XCIpKVxuICAgIGxhdCA9IG9iamVjdC5sYXQ7XG5cbiAgZWxzZSBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsYXRpdHVkZVwiKSlcbiAgICBsYXQgPSBvYmplY3QubGF0aXR1ZGU7XG5cbiAgZWxzZSBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsb2NhdGlvblwiKSAmJlxuICAgICAgICAgIEFycmF5LmlzQXJyYXkob2JqZWN0LmxvY2F0aW9uKSAmJlxuICAgICAgICAgIG9iamVjdC5sb2NhdGlvbi5sZW5ndGggPT09IDIpXG4gICAgbGF0ID0gb2JqZWN0LmxvY2F0aW9uWzBdO1xuXG4gIC8qIEZpbmQgbG9uZ2l0dWRlLiAqL1xuICBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsb25cIikpXG4gICAgbG9uID0gb2JqZWN0LmxvbjtcblxuICBlbHNlIGlmKG9iamVjdC5oYXNPd25Qcm9wZXJ0eShcImxvbmdpdHVkZVwiKSlcbiAgICBsb24gPSBvYmplY3QubG9uZ2l0dWRlO1xuXG4gIGVsc2UgaWYob2JqZWN0Lmhhc093blByb3BlcnR5KFwibG5nXCIpKVxuICAgIGxvbiA9IG9iamVjdC5sbmc7XG5cbiAgZWxzZSBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsb25nXCIpKVxuICAgIGxvbiA9IG9iamVjdC5sb25nO1xuXG4gIGVsc2UgaWYob2JqZWN0Lmhhc093blByb3BlcnR5KFwibG9jYXRpb25cIikgJiZcbiAgICAgICAgICBBcnJheS5pc0FycmF5KG9iamVjdC5sb2NhdGlvbikgJiZcbiAgICAgICAgICBvYmplY3QubG9jYXRpb24ubGVuZ3RoID09PSAyKVxuICAgIGxvbiA9IG9iamVjdC5sb2NhdGlvblsxXTtcblxuICAvKiBGaW5hbGx5LCBzZXQgdGhpcyBvYmplY3QncyBwcm9wZXJ0aWVzLiAqL1xuICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgdGhpcy5wb3NpdGlvbiA9IHNwaGVyaWNhbDJjYXJ0ZXNpYW4obGF0LCBsb24pO1xufVxuXG5mdW5jdGlvbiBidWlsZChhcnJheSkge1xuICB2YXIgaSAgID0gYXJyYXkubGVuZ3RoLFxuICAgICAgb3V0ID0gbmV3IEFycmF5KGkpXG5cbiAgd2hpbGUoaS0tKVxuICAgIG91dFtpXSA9IG5ldyBQb3NpdGlvbihhcnJheVtpXSlcblxuICByZXR1cm4ga2QuYnVpbGQob3V0KVxufVxuXG5mdW5jdGlvbiBsb29rdXAobGF0LCBsb24sIG5vZGUsIG4sIG1heCkge1xuICB2YXIgYXJyYXkgPSBrZC5sb29rdXAoXG4gICAgICAgIHNwaGVyaWNhbDJjYXJ0ZXNpYW4obGF0LCBsb24pLFxuICAgICAgICBub2RlLFxuICAgICAgICBuLFxuICAgICAgICBtYXggPiAwID8gMiAqIE1hdGguc2luKG1heCAqIGludkVhcnRoRGlhbWV0ZXIpIDogdW5kZWZpbmVkXG4gICAgICApLFxuICAgICAgaSAgICAgPSBhcnJheS5sZW5ndGhcblxuICAvKiBTdHJpcCBvZmYgcG9zaXRpb24gd3JhcHBlciBvYmplY3RzLiAqL1xuICB3aGlsZShpLS0pXG4gICAgYXJyYXlbaV0gPSBhcnJheVtpXS5vYmplY3RcblxuICByZXR1cm4gYXJyYXlcbn1cblxuZXhwb3J0cy5idWlsZCAgPSBidWlsZFxuZXhwb3J0cy5sb29rdXAgPSBsb29rdXBcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDExLTIwMTQgRmVsaXggR25hc3NcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogaHR0cDovL3NwaW4uanMub3JnL1xuICpcbiAqIEV4YW1wbGU6XG4gICAgdmFyIG9wdHMgPSB7XG4gICAgICBsaW5lczogMTIgICAgICAgICAgICAgLy8gVGhlIG51bWJlciBvZiBsaW5lcyB0byBkcmF3XG4gICAgLCBsZW5ndGg6IDcgICAgICAgICAgICAgLy8gVGhlIGxlbmd0aCBvZiBlYWNoIGxpbmVcbiAgICAsIHdpZHRoOiA1ICAgICAgICAgICAgICAvLyBUaGUgbGluZSB0aGlja25lc3NcbiAgICAsIHJhZGl1czogMTAgICAgICAgICAgICAvLyBUaGUgcmFkaXVzIG9mIHRoZSBpbm5lciBjaXJjbGVcbiAgICAsIHNjYWxlOiAxLjAgICAgICAgICAgICAvLyBTY2FsZXMgb3ZlcmFsbCBzaXplIG9mIHRoZSBzcGlubmVyXG4gICAgLCBjb3JuZXJzOiAxICAgICAgICAgICAgLy8gUm91bmRuZXNzICgwLi4xKVxuICAgICwgY29sb3I6ICcjMDAwJyAgICAgICAgIC8vICNyZ2Igb3IgI3JyZ2diYlxuICAgICwgb3BhY2l0eTogMS80ICAgICAgICAgIC8vIE9wYWNpdHkgb2YgdGhlIGxpbmVzXG4gICAgLCByb3RhdGU6IDAgICAgICAgICAgICAgLy8gUm90YXRpb24gb2Zmc2V0XG4gICAgLCBkaXJlY3Rpb246IDEgICAgICAgICAgLy8gMTogY2xvY2t3aXNlLCAtMTogY291bnRlcmNsb2Nrd2lzZVxuICAgICwgc3BlZWQ6IDEgICAgICAgICAgICAgIC8vIFJvdW5kcyBwZXIgc2Vjb25kXG4gICAgLCB0cmFpbDogMTAwICAgICAgICAgICAgLy8gQWZ0ZXJnbG93IHBlcmNlbnRhZ2VcbiAgICAsIGZwczogMjAgICAgICAgICAgICAgICAvLyBGcmFtZXMgcGVyIHNlY29uZCB3aGVuIHVzaW5nIHNldFRpbWVvdXQoKVxuICAgICwgekluZGV4OiAyZTkgICAgICAgICAgIC8vIFVzZSBhIGhpZ2ggei1pbmRleCBieSBkZWZhdWx0XG4gICAgLCBjbGFzc05hbWU6ICdzcGlubmVyJyAgLy8gQ1NTIGNsYXNzIHRvIGFzc2lnbiB0byB0aGUgZWxlbWVudFxuICAgICwgdG9wOiAnNTAlJyAgICAgICAgICAgIC8vIGNlbnRlciB2ZXJ0aWNhbGx5XG4gICAgLCBsZWZ0OiAnNTAlJyAgICAgICAgICAgLy8gY2VudGVyIGhvcml6b250YWxseVxuICAgICwgc2hhZG93OiBmYWxzZSAgICAgICAgIC8vIFdoZXRoZXIgdG8gcmVuZGVyIGEgc2hhZG93XG4gICAgLCBod2FjY2VsOiBmYWxzZSAgICAgICAgLy8gV2hldGhlciB0byB1c2UgaGFyZHdhcmUgYWNjZWxlcmF0aW9uIChtaWdodCBiZSBidWdneSlcbiAgICAsIHBvc2l0aW9uOiAnYWJzb2x1dGUnICAvLyBFbGVtZW50IHBvc2l0aW9uaW5nXG4gICAgfVxuICAgIHZhciB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9vJylcbiAgICB2YXIgc3Bpbm5lciA9IG5ldyBTcGlubmVyKG9wdHMpLnNwaW4odGFyZ2V0KVxuICovXG47KGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG5cbiAgLyogQ29tbW9uSlMgKi9cbiAgaWYgKHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpXG5cbiAgLyogQU1EIG1vZHVsZSAqL1xuICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgZGVmaW5lKGZhY3RvcnkpXG5cbiAgLyogQnJvd3NlciBnbG9iYWwgKi9cbiAgZWxzZSByb290LlNwaW5uZXIgPSBmYWN0b3J5KClcbn0odGhpcywgZnVuY3Rpb24gKCkge1xuICBcInVzZSBzdHJpY3RcIlxuXG4gIHZhciBwcmVmaXhlcyA9IFsnd2Via2l0JywgJ01veicsICdtcycsICdPJ10gLyogVmVuZG9yIHByZWZpeGVzICovXG4gICAgLCBhbmltYXRpb25zID0ge30gLyogQW5pbWF0aW9uIHJ1bGVzIGtleWVkIGJ5IHRoZWlyIG5hbWUgKi9cbiAgICAsIHVzZUNzc0FuaW1hdGlvbnMgLyogV2hldGhlciB0byB1c2UgQ1NTIGFuaW1hdGlvbnMgb3Igc2V0VGltZW91dCAqL1xuICAgICwgc2hlZXQgLyogQSBzdHlsZXNoZWV0IHRvIGhvbGQgdGhlIEBrZXlmcmFtZSBvciBWTUwgcnVsZXMuICovXG5cbiAgLyoqXG4gICAqIFV0aWxpdHkgZnVuY3Rpb24gdG8gY3JlYXRlIGVsZW1lbnRzLiBJZiBubyB0YWcgbmFtZSBpcyBnaXZlbixcbiAgICogYSBESVYgaXMgY3JlYXRlZC4gT3B0aW9uYWxseSBwcm9wZXJ0aWVzIGNhbiBiZSBwYXNzZWQuXG4gICAqL1xuICBmdW5jdGlvbiBjcmVhdGVFbCAodGFnLCBwcm9wKSB7XG4gICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcgfHwgJ2RpdicpXG4gICAgICAsIG5cblxuICAgIGZvciAobiBpbiBwcm9wKSBlbFtuXSA9IHByb3Bbbl1cbiAgICByZXR1cm4gZWxcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBlbmRzIGNoaWxkcmVuIGFuZCByZXR1cm5zIHRoZSBwYXJlbnQuXG4gICAqL1xuICBmdW5jdGlvbiBpbnMgKHBhcmVudCAvKiBjaGlsZDEsIGNoaWxkMiwgLi4uKi8pIHtcbiAgICBmb3IgKHZhciBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChhcmd1bWVudHNbaV0pXG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmVudFxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb3BhY2l0eSBrZXlmcmFtZSBhbmltYXRpb24gcnVsZSBhbmQgcmV0dXJucyBpdHMgbmFtZS5cbiAgICogU2luY2UgbW9zdCBtb2JpbGUgV2Via2l0cyBoYXZlIHRpbWluZyBpc3N1ZXMgd2l0aCBhbmltYXRpb24tZGVsYXksXG4gICAqIHdlIGNyZWF0ZSBzZXBhcmF0ZSBydWxlcyBmb3IgZWFjaCBsaW5lL3NlZ21lbnQuXG4gICAqL1xuICBmdW5jdGlvbiBhZGRBbmltYXRpb24gKGFscGhhLCB0cmFpbCwgaSwgbGluZXMpIHtcbiAgICB2YXIgbmFtZSA9IFsnb3BhY2l0eScsIHRyYWlsLCB+fihhbHBoYSAqIDEwMCksIGksIGxpbmVzXS5qb2luKCctJylcbiAgICAgICwgc3RhcnQgPSAwLjAxICsgaS9saW5lcyAqIDEwMFxuICAgICAgLCB6ID0gTWF0aC5tYXgoMSAtICgxLWFscGhhKSAvIHRyYWlsICogKDEwMC1zdGFydCksIGFscGhhKVxuICAgICAgLCBwcmVmaXggPSB1c2VDc3NBbmltYXRpb25zLnN1YnN0cmluZygwLCB1c2VDc3NBbmltYXRpb25zLmluZGV4T2YoJ0FuaW1hdGlvbicpKS50b0xvd2VyQ2FzZSgpXG4gICAgICAsIHByZSA9IHByZWZpeCAmJiAnLScgKyBwcmVmaXggKyAnLScgfHwgJydcblxuICAgIGlmICghYW5pbWF0aW9uc1tuYW1lXSkge1xuICAgICAgc2hlZXQuaW5zZXJ0UnVsZShcbiAgICAgICAgJ0AnICsgcHJlICsgJ2tleWZyYW1lcyAnICsgbmFtZSArICd7JyArXG4gICAgICAgICcwJXtvcGFjaXR5OicgKyB6ICsgJ30nICtcbiAgICAgICAgc3RhcnQgKyAnJXtvcGFjaXR5OicgKyBhbHBoYSArICd9JyArXG4gICAgICAgIChzdGFydCswLjAxKSArICcle29wYWNpdHk6MX0nICtcbiAgICAgICAgKHN0YXJ0K3RyYWlsKSAlIDEwMCArICcle29wYWNpdHk6JyArIGFscGhhICsgJ30nICtcbiAgICAgICAgJzEwMCV7b3BhY2l0eTonICsgeiArICd9JyArXG4gICAgICAgICd9Jywgc2hlZXQuY3NzUnVsZXMubGVuZ3RoKVxuXG4gICAgICBhbmltYXRpb25zW25hbWVdID0gMVxuICAgIH1cblxuICAgIHJldHVybiBuYW1lXG4gIH1cblxuICAvKipcbiAgICogVHJpZXMgdmFyaW91cyB2ZW5kb3IgcHJlZml4ZXMgYW5kIHJldHVybnMgdGhlIGZpcnN0IHN1cHBvcnRlZCBwcm9wZXJ0eS5cbiAgICovXG4gIGZ1bmN0aW9uIHZlbmRvciAoZWwsIHByb3ApIHtcbiAgICB2YXIgcyA9IGVsLnN0eWxlXG4gICAgICAsIHBwXG4gICAgICAsIGlcblxuICAgIHByb3AgPSBwcm9wLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcHJvcC5zbGljZSgxKVxuICAgIGlmIChzW3Byb3BdICE9PSB1bmRlZmluZWQpIHJldHVybiBwcm9wXG4gICAgZm9yIChpID0gMDsgaSA8IHByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBwcCA9IHByZWZpeGVzW2ldK3Byb3BcbiAgICAgIGlmIChzW3BwXSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gcHBcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0cyBtdWx0aXBsZSBzdHlsZSBwcm9wZXJ0aWVzIGF0IG9uY2UuXG4gICAqL1xuICBmdW5jdGlvbiBjc3MgKGVsLCBwcm9wKSB7XG4gICAgZm9yICh2YXIgbiBpbiBwcm9wKSB7XG4gICAgICBlbC5zdHlsZVt2ZW5kb3IoZWwsIG4pIHx8IG5dID0gcHJvcFtuXVxuICAgIH1cblxuICAgIHJldHVybiBlbFxuICB9XG5cbiAgLyoqXG4gICAqIEZpbGxzIGluIGRlZmF1bHQgdmFsdWVzLlxuICAgKi9cbiAgZnVuY3Rpb24gbWVyZ2UgKG9iaikge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGVmID0gYXJndW1lbnRzW2ldXG4gICAgICBmb3IgKHZhciBuIGluIGRlZikge1xuICAgICAgICBpZiAob2JqW25dID09PSB1bmRlZmluZWQpIG9ialtuXSA9IGRlZltuXVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqXG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbGluZSBjb2xvciBmcm9tIHRoZSBnaXZlbiBzdHJpbmcgb3IgYXJyYXkuXG4gICAqL1xuICBmdW5jdGlvbiBnZXRDb2xvciAoY29sb3IsIGlkeCkge1xuICAgIHJldHVybiB0eXBlb2YgY29sb3IgPT0gJ3N0cmluZycgPyBjb2xvciA6IGNvbG9yW2lkeCAlIGNvbG9yLmxlbmd0aF1cbiAgfVxuXG4gIC8vIEJ1aWx0LWluIGRlZmF1bHRzXG5cbiAgdmFyIGRlZmF1bHRzID0ge1xuICAgIGxpbmVzOiAxMiAgICAgICAgICAgICAvLyBUaGUgbnVtYmVyIG9mIGxpbmVzIHRvIGRyYXdcbiAgLCBsZW5ndGg6IDcgICAgICAgICAgICAgLy8gVGhlIGxlbmd0aCBvZiBlYWNoIGxpbmVcbiAgLCB3aWR0aDogNSAgICAgICAgICAgICAgLy8gVGhlIGxpbmUgdGhpY2tuZXNzXG4gICwgcmFkaXVzOiAxMCAgICAgICAgICAgIC8vIFRoZSByYWRpdXMgb2YgdGhlIGlubmVyIGNpcmNsZVxuICAsIHNjYWxlOiAxLjAgICAgICAgICAgICAvLyBTY2FsZXMgb3ZlcmFsbCBzaXplIG9mIHRoZSBzcGlubmVyXG4gICwgY29ybmVyczogMSAgICAgICAgICAgIC8vIFJvdW5kbmVzcyAoMC4uMSlcbiAgLCBjb2xvcjogJyMwMDAnICAgICAgICAgLy8gI3JnYiBvciAjcnJnZ2JiXG4gICwgb3BhY2l0eTogMS80ICAgICAgICAgIC8vIE9wYWNpdHkgb2YgdGhlIGxpbmVzXG4gICwgcm90YXRlOiAwICAgICAgICAgICAgIC8vIFJvdGF0aW9uIG9mZnNldFxuICAsIGRpcmVjdGlvbjogMSAgICAgICAgICAvLyAxOiBjbG9ja3dpc2UsIC0xOiBjb3VudGVyY2xvY2t3aXNlXG4gICwgc3BlZWQ6IDEgICAgICAgICAgICAgIC8vIFJvdW5kcyBwZXIgc2Vjb25kXG4gICwgdHJhaWw6IDEwMCAgICAgICAgICAgIC8vIEFmdGVyZ2xvdyBwZXJjZW50YWdlXG4gICwgZnBzOiAyMCAgICAgICAgICAgICAgIC8vIEZyYW1lcyBwZXIgc2Vjb25kIHdoZW4gdXNpbmcgc2V0VGltZW91dCgpXG4gICwgekluZGV4OiAyZTkgICAgICAgICAgIC8vIFVzZSBhIGhpZ2ggei1pbmRleCBieSBkZWZhdWx0XG4gICwgY2xhc3NOYW1lOiAnc3Bpbm5lcicgIC8vIENTUyBjbGFzcyB0byBhc3NpZ24gdG8gdGhlIGVsZW1lbnRcbiAgLCB0b3A6ICc1MCUnICAgICAgICAgICAgLy8gY2VudGVyIHZlcnRpY2FsbHlcbiAgLCBsZWZ0OiAnNTAlJyAgICAgICAgICAgLy8gY2VudGVyIGhvcml6b250YWxseVxuICAsIHNoYWRvdzogZmFsc2UgICAgICAgICAvLyBXaGV0aGVyIHRvIHJlbmRlciBhIHNoYWRvd1xuICAsIGh3YWNjZWw6IGZhbHNlICAgICAgICAvLyBXaGV0aGVyIHRvIHVzZSBoYXJkd2FyZSBhY2NlbGVyYXRpb24gKG1pZ2h0IGJlIGJ1Z2d5KVxuICAsIHBvc2l0aW9uOiAnYWJzb2x1dGUnICAvLyBFbGVtZW50IHBvc2l0aW9uaW5nXG4gIH1cblxuICAvKiogVGhlIGNvbnN0cnVjdG9yICovXG4gIGZ1bmN0aW9uIFNwaW5uZXIgKG8pIHtcbiAgICB0aGlzLm9wdHMgPSBtZXJnZShvIHx8IHt9LCBTcGlubmVyLmRlZmF1bHRzLCBkZWZhdWx0cylcbiAgfVxuXG4gIC8vIEdsb2JhbCBkZWZhdWx0cyB0aGF0IG92ZXJyaWRlIHRoZSBidWlsdC1pbnM6XG4gIFNwaW5uZXIuZGVmYXVsdHMgPSB7fVxuXG4gIG1lcmdlKFNwaW5uZXIucHJvdG90eXBlLCB7XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgc3Bpbm5lciB0byB0aGUgZ2l2ZW4gdGFyZ2V0IGVsZW1lbnQuIElmIHRoaXMgaW5zdGFuY2UgaXMgYWxyZWFkeVxuICAgICAqIHNwaW5uaW5nLCBpdCBpcyBhdXRvbWF0aWNhbGx5IHJlbW92ZWQgZnJvbSBpdHMgcHJldmlvdXMgdGFyZ2V0IGIgY2FsbGluZ1xuICAgICAqIHN0b3AoKSBpbnRlcm5hbGx5LlxuICAgICAqL1xuICAgIHNwaW46IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgIHRoaXMuc3RvcCgpXG5cbiAgICAgIHZhciBzZWxmID0gdGhpc1xuICAgICAgICAsIG8gPSBzZWxmLm9wdHNcbiAgICAgICAgLCBlbCA9IHNlbGYuZWwgPSBjcmVhdGVFbChudWxsLCB7Y2xhc3NOYW1lOiBvLmNsYXNzTmFtZX0pXG5cbiAgICAgIGNzcyhlbCwge1xuICAgICAgICBwb3NpdGlvbjogby5wb3NpdGlvblxuICAgICAgLCB3aWR0aDogMFxuICAgICAgLCB6SW5kZXg6IG8uekluZGV4XG4gICAgICAsIGxlZnQ6IG8ubGVmdFxuICAgICAgLCB0b3A6IG8udG9wXG4gICAgICB9KVxuXG4gICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUoZWwsIHRhcmdldC5maXJzdENoaWxkIHx8IG51bGwpXG4gICAgICB9XG5cbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgncm9sZScsICdwcm9ncmVzc2JhcicpXG4gICAgICBzZWxmLmxpbmVzKGVsLCBzZWxmLm9wdHMpXG5cbiAgICAgIGlmICghdXNlQ3NzQW5pbWF0aW9ucykge1xuICAgICAgICAvLyBObyBDU1MgYW5pbWF0aW9uIHN1cHBvcnQsIHVzZSBzZXRUaW1lb3V0KCkgaW5zdGVhZFxuICAgICAgICB2YXIgaSA9IDBcbiAgICAgICAgICAsIHN0YXJ0ID0gKG8ubGluZXMgLSAxKSAqICgxIC0gby5kaXJlY3Rpb24pIC8gMlxuICAgICAgICAgICwgYWxwaGFcbiAgICAgICAgICAsIGZwcyA9IG8uZnBzXG4gICAgICAgICAgLCBmID0gZnBzIC8gby5zcGVlZFxuICAgICAgICAgICwgb3N0ZXAgPSAoMSAtIG8ub3BhY2l0eSkgLyAoZiAqIG8udHJhaWwgLyAxMDApXG4gICAgICAgICAgLCBhc3RlcCA9IGYgLyBvLmxpbmVzXG5cbiAgICAgICAgOyhmdW5jdGlvbiBhbmltICgpIHtcbiAgICAgICAgICBpKytcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG8ubGluZXM7IGorKykge1xuICAgICAgICAgICAgYWxwaGEgPSBNYXRoLm1heCgxIC0gKGkgKyAoby5saW5lcyAtIGopICogYXN0ZXApICUgZiAqIG9zdGVwLCBvLm9wYWNpdHkpXG5cbiAgICAgICAgICAgIHNlbGYub3BhY2l0eShlbCwgaiAqIG8uZGlyZWN0aW9uICsgc3RhcnQsIGFscGhhLCBvKVxuICAgICAgICAgIH1cbiAgICAgICAgICBzZWxmLnRpbWVvdXQgPSBzZWxmLmVsICYmIHNldFRpbWVvdXQoYW5pbSwgfn4oMTAwMCAvIGZwcykpXG4gICAgICAgIH0pKClcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZWxmXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RvcHMgYW5kIHJlbW92ZXMgdGhlIFNwaW5uZXIuXG4gICAgICovXG4gICwgc3RvcDogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGVsID0gdGhpcy5lbFxuICAgICAgaWYgKGVsKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpXG4gICAgICAgIGlmIChlbC5wYXJlbnROb2RlKSBlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKVxuICAgICAgICB0aGlzLmVsID0gdW5kZWZpbmVkXG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEludGVybmFsIG1ldGhvZCB0aGF0IGRyYXdzIHRoZSBpbmRpdmlkdWFsIGxpbmVzLiBXaWxsIGJlIG92ZXJ3cml0dGVuXG4gICAgICogaW4gVk1MIGZhbGxiYWNrIG1vZGUgYmVsb3cuXG4gICAgICovXG4gICwgbGluZXM6IGZ1bmN0aW9uIChlbCwgbykge1xuICAgICAgdmFyIGkgPSAwXG4gICAgICAgICwgc3RhcnQgPSAoby5saW5lcyAtIDEpICogKDEgLSBvLmRpcmVjdGlvbikgLyAyXG4gICAgICAgICwgc2VnXG5cbiAgICAgIGZ1bmN0aW9uIGZpbGwgKGNvbG9yLCBzaGFkb3cpIHtcbiAgICAgICAgcmV0dXJuIGNzcyhjcmVhdGVFbCgpLCB7XG4gICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZSdcbiAgICAgICAgLCB3aWR0aDogby5zY2FsZSAqIChvLmxlbmd0aCArIG8ud2lkdGgpICsgJ3B4J1xuICAgICAgICAsIGhlaWdodDogby5zY2FsZSAqIG8ud2lkdGggKyAncHgnXG4gICAgICAgICwgYmFja2dyb3VuZDogY29sb3JcbiAgICAgICAgLCBib3hTaGFkb3c6IHNoYWRvd1xuICAgICAgICAsIHRyYW5zZm9ybU9yaWdpbjogJ2xlZnQnXG4gICAgICAgICwgdHJhbnNmb3JtOiAncm90YXRlKCcgKyB+figzNjAvby5saW5lcyppICsgby5yb3RhdGUpICsgJ2RlZykgdHJhbnNsYXRlKCcgKyBvLnNjYWxlKm8ucmFkaXVzICsgJ3B4JyArICcsMCknXG4gICAgICAgICwgYm9yZGVyUmFkaXVzOiAoby5jb3JuZXJzICogby5zY2FsZSAqIG8ud2lkdGggPj4gMSkgKyAncHgnXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIGZvciAoOyBpIDwgby5saW5lczsgaSsrKSB7XG4gICAgICAgIHNlZyA9IGNzcyhjcmVhdGVFbCgpLCB7XG4gICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZSdcbiAgICAgICAgLCB0b3A6IDEgKyB+KG8uc2NhbGUgKiBvLndpZHRoIC8gMikgKyAncHgnXG4gICAgICAgICwgdHJhbnNmb3JtOiBvLmh3YWNjZWwgPyAndHJhbnNsYXRlM2QoMCwwLDApJyA6ICcnXG4gICAgICAgICwgb3BhY2l0eTogby5vcGFjaXR5XG4gICAgICAgICwgYW5pbWF0aW9uOiB1c2VDc3NBbmltYXRpb25zICYmIGFkZEFuaW1hdGlvbihvLm9wYWNpdHksIG8udHJhaWwsIHN0YXJ0ICsgaSAqIG8uZGlyZWN0aW9uLCBvLmxpbmVzKSArICcgJyArIDEgLyBvLnNwZWVkICsgJ3MgbGluZWFyIGluZmluaXRlJ1xuICAgICAgICB9KVxuXG4gICAgICAgIGlmIChvLnNoYWRvdykgaW5zKHNlZywgY3NzKGZpbGwoJyMwMDAnLCAnMCAwIDRweCAjMDAwJyksIHt0b3A6ICcycHgnfSkpXG4gICAgICAgIGlucyhlbCwgaW5zKHNlZywgZmlsbChnZXRDb2xvcihvLmNvbG9yLCBpKSwgJzAgMCAxcHggcmdiYSgwLDAsMCwuMSknKSkpXG4gICAgICB9XG4gICAgICByZXR1cm4gZWxcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbCBtZXRob2QgdGhhdCBhZGp1c3RzIHRoZSBvcGFjaXR5IG9mIGEgc2luZ2xlIGxpbmUuXG4gICAgICogV2lsbCBiZSBvdmVyd3JpdHRlbiBpbiBWTUwgZmFsbGJhY2sgbW9kZSBiZWxvdy5cbiAgICAgKi9cbiAgLCBvcGFjaXR5OiBmdW5jdGlvbiAoZWwsIGksIHZhbCkge1xuICAgICAgaWYgKGkgPCBlbC5jaGlsZE5vZGVzLmxlbmd0aCkgZWwuY2hpbGROb2Rlc1tpXS5zdHlsZS5vcGFjaXR5ID0gdmFsXG4gICAgfVxuXG4gIH0pXG5cblxuICBmdW5jdGlvbiBpbml0Vk1MICgpIHtcblxuICAgIC8qIFV0aWxpdHkgZnVuY3Rpb24gdG8gY3JlYXRlIGEgVk1MIHRhZyAqL1xuICAgIGZ1bmN0aW9uIHZtbCAodGFnLCBhdHRyKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRWwoJzwnICsgdGFnICsgJyB4bWxucz1cInVybjpzY2hlbWFzLW1pY3Jvc29mdC5jb206dm1sXCIgY2xhc3M9XCJzcGluLXZtbFwiPicsIGF0dHIpXG4gICAgfVxuXG4gICAgLy8gTm8gQ1NTIHRyYW5zZm9ybXMgYnV0IFZNTCBzdXBwb3J0LCBhZGQgYSBDU1MgcnVsZSBmb3IgVk1MIGVsZW1lbnRzOlxuICAgIHNoZWV0LmFkZFJ1bGUoJy5zcGluLXZtbCcsICdiZWhhdmlvcjp1cmwoI2RlZmF1bHQjVk1MKScpXG5cbiAgICBTcGlubmVyLnByb3RvdHlwZS5saW5lcyA9IGZ1bmN0aW9uIChlbCwgbykge1xuICAgICAgdmFyIHIgPSBvLnNjYWxlICogKG8ubGVuZ3RoICsgby53aWR0aClcbiAgICAgICAgLCBzID0gby5zY2FsZSAqIDIgKiByXG5cbiAgICAgIGZ1bmN0aW9uIGdycCAoKSB7XG4gICAgICAgIHJldHVybiBjc3MoXG4gICAgICAgICAgdm1sKCdncm91cCcsIHtcbiAgICAgICAgICAgIGNvb3Jkc2l6ZTogcyArICcgJyArIHNcbiAgICAgICAgICAsIGNvb3Jkb3JpZ2luOiAtciArICcgJyArIC1yXG4gICAgICAgICAgfSlcbiAgICAgICAgLCB7IHdpZHRoOiBzLCBoZWlnaHQ6IHMgfVxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIHZhciBtYXJnaW4gPSAtKG8ud2lkdGggKyBvLmxlbmd0aCkgKiBvLnNjYWxlICogMiArICdweCdcbiAgICAgICAgLCBnID0gY3NzKGdycCgpLCB7cG9zaXRpb246ICdhYnNvbHV0ZScsIHRvcDogbWFyZ2luLCBsZWZ0OiBtYXJnaW59KVxuICAgICAgICAsIGlcblxuICAgICAgZnVuY3Rpb24gc2VnIChpLCBkeCwgZmlsdGVyKSB7XG4gICAgICAgIGlucyhcbiAgICAgICAgICBnXG4gICAgICAgICwgaW5zKFxuICAgICAgICAgICAgY3NzKGdycCgpLCB7cm90YXRpb246IDM2MCAvIG8ubGluZXMgKiBpICsgJ2RlZycsIGxlZnQ6IH5+ZHh9KVxuICAgICAgICAgICwgaW5zKFxuICAgICAgICAgICAgICBjc3MoXG4gICAgICAgICAgICAgICAgdm1sKCdyb3VuZHJlY3QnLCB7YXJjc2l6ZTogby5jb3JuZXJzfSlcbiAgICAgICAgICAgICAgLCB7IHdpZHRoOiByXG4gICAgICAgICAgICAgICAgLCBoZWlnaHQ6IG8uc2NhbGUgKiBvLndpZHRoXG4gICAgICAgICAgICAgICAgLCBsZWZ0OiBvLnNjYWxlICogby5yYWRpdXNcbiAgICAgICAgICAgICAgICAsIHRvcDogLW8uc2NhbGUgKiBvLndpZHRoID4+IDFcbiAgICAgICAgICAgICAgICAsIGZpbHRlcjogZmlsdGVyXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICAsIHZtbCgnZmlsbCcsIHtjb2xvcjogZ2V0Q29sb3Ioby5jb2xvciwgaSksIG9wYWNpdHk6IG8ub3BhY2l0eX0pXG4gICAgICAgICAgICAsIHZtbCgnc3Ryb2tlJywge29wYWNpdHk6IDB9KSAvLyB0cmFuc3BhcmVudCBzdHJva2UgdG8gZml4IGNvbG9yIGJsZWVkaW5nIHVwb24gb3BhY2l0eSBjaGFuZ2VcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgaWYgKG8uc2hhZG93KVxuICAgICAgICBmb3IgKGkgPSAxOyBpIDw9IG8ubGluZXM7IGkrKykge1xuICAgICAgICAgIHNlZyhpLCAtMiwgJ3Byb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5CbHVyKHBpeGVscmFkaXVzPTIsbWFrZXNoYWRvdz0xLHNoYWRvd29wYWNpdHk9LjMpJylcbiAgICAgICAgfVxuXG4gICAgICBmb3IgKGkgPSAxOyBpIDw9IG8ubGluZXM7IGkrKykgc2VnKGkpXG4gICAgICByZXR1cm4gaW5zKGVsLCBnKVxuICAgIH1cblxuICAgIFNwaW5uZXIucHJvdG90eXBlLm9wYWNpdHkgPSBmdW5jdGlvbiAoZWwsIGksIHZhbCwgbykge1xuICAgICAgdmFyIGMgPSBlbC5maXJzdENoaWxkXG4gICAgICBvID0gby5zaGFkb3cgJiYgby5saW5lcyB8fCAwXG4gICAgICBpZiAoYyAmJiBpICsgbyA8IGMuY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgYyA9IGMuY2hpbGROb2Rlc1tpICsgb107IGMgPSBjICYmIGMuZmlyc3RDaGlsZDsgYyA9IGMgJiYgYy5maXJzdENoaWxkXG4gICAgICAgIGlmIChjKSBjLm9wYWNpdHkgPSB2YWxcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHNoZWV0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBlbCA9IGNyZWF0ZUVsKCdzdHlsZScsIHt0eXBlIDogJ3RleHQvY3NzJ30pXG4gICAgICBpbnMoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXSwgZWwpXG4gICAgICByZXR1cm4gZWwuc2hlZXQgfHwgZWwuc3R5bGVTaGVldFxuICAgIH0oKSlcblxuICAgIHZhciBwcm9iZSA9IGNzcyhjcmVhdGVFbCgnZ3JvdXAnKSwge2JlaGF2aW9yOiAndXJsKCNkZWZhdWx0I1ZNTCknfSlcblxuICAgIGlmICghdmVuZG9yKHByb2JlLCAndHJhbnNmb3JtJykgJiYgcHJvYmUuYWRqKSBpbml0Vk1MKClcbiAgICBlbHNlIHVzZUNzc0FuaW1hdGlvbnMgPSB2ZW5kb3IocHJvYmUsICdhbmltYXRpb24nKVxuICB9XG5cbiAgcmV0dXJuIFNwaW5uZXJcblxufSkpO1xuIiwiLyoqXG4gKiBUdXJmIGlzIGEgbW9kdWxhciBHSVMgZW5naW5lIHdyaXR0ZW4gaW4gSmF2YVNjcmlwdC4gSXQgcGVyZm9ybXMgZ2Vvc3BhdGlhbFxuICogcHJvY2Vzc2luZyB0YXNrcyB3aXRoIEdlb0pTT04gZGF0YSBhbmQgY2FuIGJlIHJ1biBvbiBhIHNlcnZlciBvciBpbiBhIGJyb3dzZXIuXG4gKlxuICogQG1vZHVsZSB0dXJmXG4gKiBAc3VtbWFyeSBHSVMgRm9yIFdlYiBNYXBzXG4gKi9cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc29saW5lczogcmVxdWlyZSgndHVyZi1pc29saW5lcycpLFxuICBtZXJnZTogcmVxdWlyZSgndHVyZi1tZXJnZScpLFxuICBjb252ZXg6IHJlcXVpcmUoJ3R1cmYtY29udmV4JyksXG4gIHdpdGhpbjogcmVxdWlyZSgndHVyZi13aXRoaW4nKSxcbiAgY29uY2F2ZTogcmVxdWlyZSgndHVyZi1jb25jYXZlJyksXG4gIGNvdW50OiByZXF1aXJlKCd0dXJmLWNvdW50JyksXG4gIGVyYXNlOiByZXF1aXJlKCd0dXJmLWVyYXNlJyksXG4gIHZhcmlhbmNlOiByZXF1aXJlKCd0dXJmLXZhcmlhbmNlJyksXG4gIGRldmlhdGlvbjogcmVxdWlyZSgndHVyZi1kZXZpYXRpb24nKSxcbiAgbWVkaWFuOiByZXF1aXJlKCd0dXJmLW1lZGlhbicpLFxuICBtaW46IHJlcXVpcmUoJ3R1cmYtbWluJyksXG4gIG1heDogcmVxdWlyZSgndHVyZi1tYXgnKSxcbiAgYWdncmVnYXRlOiByZXF1aXJlKCd0dXJmLWFnZ3JlZ2F0ZScpLFxuICBmbGlwOiByZXF1aXJlKCd0dXJmLWZsaXAnKSxcbiAgc2ltcGxpZnk6IHJlcXVpcmUoJ3R1cmYtc2ltcGxpZnknKSxcbiAgc3VtOiByZXF1aXJlKCd0dXJmLXN1bScpLFxuICBhdmVyYWdlOiByZXF1aXJlKCd0dXJmLWF2ZXJhZ2UnKSxcbiAgYmV6aWVyOiByZXF1aXJlKCd0dXJmLWJlemllcicpLFxuICB0YWc6IHJlcXVpcmUoJ3R1cmYtdGFnJyksXG4gIHNpemU6IHJlcXVpcmUoJ3R1cmYtc2l6ZScpLFxuICBzYW1wbGU6IHJlcXVpcmUoJ3R1cmYtc2FtcGxlJyksXG4gIGplbmtzOiByZXF1aXJlKCd0dXJmLWplbmtzJyksXG4gIHF1YW50aWxlOiByZXF1aXJlKCd0dXJmLXF1YW50aWxlJyksXG4gIGVudmVsb3BlOiByZXF1aXJlKCd0dXJmLWVudmVsb3BlJyksXG4gIHNxdWFyZTogcmVxdWlyZSgndHVyZi1zcXVhcmUnKSxcbiAgbWlkcG9pbnQ6IHJlcXVpcmUoJ3R1cmYtbWlkcG9pbnQnKSxcbiAgYnVmZmVyOiByZXF1aXJlKCd0dXJmLWJ1ZmZlcicpLFxuICBjZW50ZXI6IHJlcXVpcmUoJ3R1cmYtY2VudGVyJyksXG4gIGNlbnRyb2lkOiByZXF1aXJlKCd0dXJmLWNlbnRyb2lkJyksXG4gIGNvbWJpbmU6IHJlcXVpcmUoJ3R1cmYtY29tYmluZScpLFxuICBkaXN0YW5jZTogcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpLFxuICBleHBsb2RlOiByZXF1aXJlKCd0dXJmLWV4cGxvZGUnKSxcbiAgZXh0ZW50OiByZXF1aXJlKCd0dXJmLWV4dGVudCcpLFxuICBiYm94UG9seWdvbjogcmVxdWlyZSgndHVyZi1iYm94LXBvbHlnb24nKSxcbiAgZmVhdHVyZWNvbGxlY3Rpb246IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKSxcbiAgZmlsdGVyOiByZXF1aXJlKCd0dXJmLWZpbHRlcicpLFxuICBpbnNpZGU6IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyksXG4gIGludGVyc2VjdDogcmVxdWlyZSgndHVyZi1pbnRlcnNlY3QnKSxcbiAgbGluZXN0cmluZzogcmVxdWlyZSgndHVyZi1saW5lc3RyaW5nJyksXG4gIG5lYXJlc3Q6IHJlcXVpcmUoJ3R1cmYtbmVhcmVzdCcpLFxuICBwbGFuZXBvaW50OiByZXF1aXJlKCd0dXJmLXBsYW5lcG9pbnQnKSxcbiAgcG9pbnQ6IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKSxcbiAgcG9seWdvbjogcmVxdWlyZSgndHVyZi1wb2x5Z29uJyksXG4gIHJhbmRvbTogcmVxdWlyZSgndHVyZi1yYW5kb20nKSxcbiAgcmVjbGFzczogcmVxdWlyZSgndHVyZi1yZWNsYXNzJyksXG4gIHJlbW92ZTogcmVxdWlyZSgndHVyZi1yZW1vdmUnKSxcbiAgdGluOiByZXF1aXJlKCd0dXJmLXRpbicpLFxuICB1bmlvbjogcmVxdWlyZSgndHVyZi11bmlvbicpLFxuICBiZWFyaW5nOiByZXF1aXJlKCd0dXJmLWJlYXJpbmcnKSxcbiAgZGVzdGluYXRpb246IHJlcXVpcmUoJ3R1cmYtZGVzdGluYXRpb24nKSxcbiAga2lua3M6IHJlcXVpcmUoJ3R1cmYta2lua3MnKSxcbiAgcG9pbnRPblN1cmZhY2U6IHJlcXVpcmUoJ3R1cmYtcG9pbnQtb24tc3VyZmFjZScpLFxuICBhcmVhOiByZXF1aXJlKCd0dXJmLWFyZWEnKSxcbiAgYWxvbmc6IHJlcXVpcmUoJ3R1cmYtYWxvbmcnKSxcbiAgbGluZURpc3RhbmNlOiByZXF1aXJlKCd0dXJmLWxpbmUtZGlzdGFuY2UnKSxcbiAgbGluZVNsaWNlOiByZXF1aXJlKCd0dXJmLWxpbmUtc2xpY2UnKSxcbiAgcG9pbnRPbkxpbmU6IHJlcXVpcmUoJ3R1cmYtcG9pbnQtb24tbGluZScpLFxuICBwb2ludEdyaWQ6IHJlcXVpcmUoJ3R1cmYtcG9pbnQtZ3JpZCcpLFxuICBzcXVhcmVHcmlkOiByZXF1aXJlKCd0dXJmLXNxdWFyZS1ncmlkJyksXG4gIHRyaWFuZ2xlR3JpZDogcmVxdWlyZSgndHVyZi10cmlhbmdsZS1ncmlkJyksXG4gIGhleEdyaWQ6IHJlcXVpcmUoJ3R1cmYtaGV4LWdyaWQnKVxufTtcbiIsInZhciBhdmVyYWdlID0gcmVxdWlyZSgndHVyZi1hdmVyYWdlJyk7XG52YXIgc3VtID0gcmVxdWlyZSgndHVyZi1zdW0nKTtcbnZhciBtZWRpYW4gPSByZXF1aXJlKCd0dXJmLW1lZGlhbicpO1xudmFyIG1pbiA9IHJlcXVpcmUoJ3R1cmYtbWluJyk7XG52YXIgbWF4ID0gcmVxdWlyZSgndHVyZi1tYXgnKTtcbnZhciBkZXZpYXRpb24gPSByZXF1aXJlKCd0dXJmLWRldmlhdGlvbicpO1xudmFyIHZhcmlhbmNlID0gcmVxdWlyZSgndHVyZi12YXJpYW5jZScpO1xudmFyIGNvdW50ID0gcmVxdWlyZSgndHVyZi1jb3VudCcpO1xudmFyIG9wZXJhdGlvbnMgPSB7fTtcbm9wZXJhdGlvbnMuYXZlcmFnZSA9IGF2ZXJhZ2U7XG5vcGVyYXRpb25zLnN1bSA9IHN1bTtcbm9wZXJhdGlvbnMubWVkaWFuID0gbWVkaWFuO1xub3BlcmF0aW9ucy5taW4gPSBtaW47XG5vcGVyYXRpb25zLm1heCA9IG1heDtcbm9wZXJhdGlvbnMuZGV2aWF0aW9uID0gZGV2aWF0aW9uO1xub3BlcmF0aW9ucy52YXJpYW5jZSA9IHZhcmlhbmNlO1xub3BlcmF0aW9ucy5jb3VudCA9IGNvdW50O1xuXG4vKipcbiogQ2FsY3VsYXRlcyBhIHNlcmllcyBvZiBhZ2dyZWdhdGlvbnMgZm9yIGEgc2V0IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgd2l0aGluIGEgc2V0IG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcy4gU3VtLCBhdmVyYWdlLCBjb3VudCwgbWluLCBtYXgsIGFuZCBkZXZpYXRpb24gYXJlIHN1cHBvcnRlZC5cbipcbiogQG1vZHVsZSB0dXJmL2FnZ3JlZ2F0ZVxuKiBAY2F0ZWdvcnkgYWdncmVnYXRpb25cbiogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuKiBAcGFyYW0ge0FycmF5fSBhZ2dyZWdhdGlvbnMgYW4gYXJyYXkgb2YgYWdncmVnYXRpb24gb2JqZWN0c1xuKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgd2l0aCBwcm9wZXJ0aWVzIGxpc3RlZCBhcyBgb3V0RmllbGRgIHZhbHVlcyBpbiBgYWdncmVnYXRpb25zYFxuKiBAZXhhbXBsZVxuKiB2YXIgcG9seWdvbnMgPSB7XG4qICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiogICBcImZlYXR1cmVzXCI6IFtcbiogICAgIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4qICAgICAgICAgICBbMS42Njk5MjEsIDQ4LjYzMjkwOF0sXG4qICAgICAgICAgICBbMS42Njk5MjEsIDQ5LjM4MjM3Ml0sXG4qICAgICAgICAgICBbMy42MzY0NzQsIDQ5LjM4MjM3Ml0sXG4qICAgICAgICAgICBbMy42MzY0NzQsIDQ4LjYzMjkwOF0sXG4qICAgICAgICAgICBbMS42Njk5MjEsIDQ4LjYzMjkwOF1cbiogICAgICAgICBdXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuKiAgICAgICAgICAgWzIuMjMwMjI0LCA0Ny44NTAwM10sXG4qICAgICAgICAgICBbMi4yMzAyMjQsIDQ4LjYxMTEyMV0sXG4qICAgICAgICAgICBbNC4zNjE1NzIsIDQ4LjYxMTEyMV0sXG4qICAgICAgICAgICBbNC4zNjE1NzIsIDQ3Ljg1MDAzXSxcbiogICAgICAgICAgIFsyLjIzMDIyNCwgNDcuODUwMDNdXG4qICAgICAgICAgXV1cbiogICAgICAgfVxuKiAgICAgfVxuKiAgIF1cbiogfTtcbiogdmFyIHBvaW50cyA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuKiAgIFwiZmVhdHVyZXNcIjogW1xuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzIuMDU0NDQzLDQ5LjEzODU5Nl1cbiogICAgICAgfVxuKiAgICAgfSxcbiogICAgIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA2MDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFszLjA2NTE4NSw0OC44NTAyNThdXG4qICAgICAgIH1cbiogICAgIH0sXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMTAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMi4zMjkxMDEsNDguNzkyMzldXG4qICAgICAgIH1cbiogICAgIH0sXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMi42MTQ3NDYsNDguMzM0MzQzXVxuKiAgICAgICB9XG4qICAgICB9LFxuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDMwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzMuNDE2NzQ4LDQ4LjA1NjA1M11cbiogICAgICAgfVxuKiAgICAgfVxuKiAgIF1cbiogfTtcbiogdmFyIGFnZ3JlZ2F0aW9ucyA9IFtcbiogICB7XG4qICAgICBhZ2dyZWdhdGlvbjogJ3N1bScsXG4qICAgICBpbkZpZWxkOiAncG9wdWxhdGlvbicsXG4qICAgICBvdXRGaWVsZDogJ3BvcF9zdW0nXG4qICAgfSxcbiogICB7XG4qICAgICBhZ2dyZWdhdGlvbjogJ2F2ZXJhZ2UnLFxuKiAgICAgaW5GaWVsZDogJ3BvcHVsYXRpb24nLFxuKiAgICAgb3V0RmllbGQ6ICdwb3BfYXZnJ1xuKiAgIH0sXG4qICAge1xuKiAgICAgYWdncmVnYXRpb246ICdtZWRpYW4nLFxuKiAgICAgaW5GaWVsZDogJ3BvcHVsYXRpb24nLFxuKiAgICAgb3V0RmllbGQ6ICdwb3BfbWVkaWFuJ1xuKiAgIH0sXG4qICAge1xuKiAgICAgYWdncmVnYXRpb246ICdtaW4nLFxuKiAgICAgaW5GaWVsZDogJ3BvcHVsYXRpb24nLFxuKiAgICAgb3V0RmllbGQ6ICdwb3BfbWluJ1xuKiAgIH0sXG4qICAge1xuKiAgICAgYWdncmVnYXRpb246ICdtYXgnLFxuKiAgICAgaW5GaWVsZDogJ3BvcHVsYXRpb24nLFxuKiAgICAgb3V0RmllbGQ6ICdwb3BfbWF4J1xuKiAgIH0sXG4qICAge1xuKiAgICAgYWdncmVnYXRpb246ICdkZXZpYXRpb24nLFxuKiAgICAgaW5GaWVsZDogJ3BvcHVsYXRpb24nLFxuKiAgICAgb3V0RmllbGQ6ICdwb3BfZGV2aWF0aW9uJ1xuKiAgIH0sXG4qICAge1xuKiAgICAgYWdncmVnYXRpb246ICd2YXJpYW5jZScsXG4qICAgICBpbkZpZWxkOiAncG9wdWxhdGlvbicsXG4qICAgICBvdXRGaWVsZDogJ3BvcF92YXJpYW5jZSdcbiogICB9LFxuKiAgIHtcbiogICAgIGFnZ3JlZ2F0aW9uOiAnY291bnQnLFxuKiAgICAgaW5GaWVsZDogJycsXG4qICAgICBvdXRGaWVsZDogJ3BvaW50X2NvdW50J1xuKiAgIH1cbiogXTtcbipcbiogdmFyIGFnZ3JlZ2F0ZWQgPSB0dXJmLmFnZ3JlZ2F0ZShcbiogICBwb2x5Z29ucywgcG9pbnRzLCBhZ2dyZWdhdGlvbnMpO1xuKlxuKiB2YXIgcmVzdWx0ID0gdHVyZi5mZWF0dXJlY29sbGVjdGlvbihcbiogICBwb2ludHMuZmVhdHVyZXMuY29uY2F0KGFnZ3JlZ2F0ZWQuZmVhdHVyZXMpKTtcbipcbiogLy89cmVzdWx0XG4qL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlnb25zLCBwb2ludHMsIGFnZ3JlZ2F0aW9ucyl7XG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhZ2dyZWdhdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICB2YXIgYWdnID0gYWdncmVnYXRpb25zW2ldLFxuICAgICAgb3BlcmF0aW9uID0gYWdnLmFnZ3JlZ2F0aW9uLFxuICAgICAgdW5yZWNvZ25pemVkRXJyb3I7XG5cbiAgICBpZiAoaXNBZ2dyZWdhdGlvbk9wZXJhdGlvbihvcGVyYXRpb24pKSB7XG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnY291bnQnKSB7XG4gICAgICAgIHBvbHlnb25zID0gb3BlcmF0aW9uc1tvcGVyYXRpb25dKHBvbHlnb25zLCBwb2ludHMsIGFnZy5vdXRGaWVsZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwb2x5Z29ucyA9IG9wZXJhdGlvbnNbb3BlcmF0aW9uXShwb2x5Z29ucywgcG9pbnRzLCBhZ2cuaW5GaWVsZCwgYWdnLm91dEZpZWxkKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdcIicrIG9wZXJhdGlvbiArJ1wiIGlzIG5vdCBhIHJlY29nbml6ZWQgYWdncmVnYXRpb24gb3BlcmF0aW9uLicpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwb2x5Z29ucztcbn07XG5cbmZ1bmN0aW9uIGlzQWdncmVnYXRpb25PcGVyYXRpb24ob3BlcmF0aW9uKSB7XG4gIHJldHVybiBvcGVyYXRpb24gPT09ICdhdmVyYWdlJyB8fFxuICAgIG9wZXJhdGlvbiA9PT0gJ3N1bScgfHxcbiAgICBvcGVyYXRpb24gPT09ICdtZWRpYW4nIHx8XG4gICAgb3BlcmF0aW9uID09PSAnbWluJyB8fFxuICAgIG9wZXJhdGlvbiA9PT0gJ21heCcgfHxcbiAgICBvcGVyYXRpb24gPT09ICdkZXZpYXRpb24nIHx8XG4gICAgb3BlcmF0aW9uID09PSAndmFyaWFuY2UnIHx8XG4gICAgb3BlcmF0aW9uID09PSAnY291bnQnO1xufVxuIiwidmFyIGRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xudmFyIGJlYXJpbmcgPSByZXF1aXJlKCd0dXJmLWJlYXJpbmcnKTtcbnZhciBkZXN0aW5hdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZGVzdGluYXRpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBMaW5lU3RyaW5nfSBmZWF0dXJlIGFuZCByZXR1cm5zIGEge0BsaW5rIFBvaW50fSBmZWF0dXJlIGF0IGEgc3BlY2lmaWVkIGRpc3RhbmNlIGFsb25nIGEgbGluZS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvYWxvbmdcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtMaW5lU3RyaW5nfSBsaW5lIGEgTGluZVN0cmluZyBmZWF0dXJlXG4gKiBAcGFyYW0ge051bWJlcn0gZGlzdGFuY2UgZGlzdGFuY2UgYWxvbmcgdGhlIGxpbmVcbiAqIEBwYXJhbSB7U3RyaW5nfSBbdW5pdHM9bWlsZXNdIGNhbiBiZSBkZWdyZWVzLCByYWRpYW5zLCBtaWxlcywgb3Iga2lsb21ldGVyc1xuICogQHJldHVybiB7UG9pbnR9IFBvaW50IGFsb25nIHRoZSBsaW5lIGF0IGBkaXN0YW5jZWAgZGlzdGFuY2VcbiAqIEBleGFtcGxlXG4gKiB2YXIgbGluZSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIkxpbmVTdHJpbmdcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtcbiAqICAgICAgIFstNzcuMDMxNjY5LCAzOC44Nzg2MDVdLFxuICogICAgICAgWy03Ny4wMjk2MDksIDM4Ljg4MTk0Nl0sXG4gKiAgICAgICBbLTc3LjAyMDMzOSwgMzguODg0MDg0XSxcbiAqICAgICAgIFstNzcuMDI1NjYxLCAzOC44ODU4MjFdLFxuICogICAgICAgWy03Ny4wMjE4ODQsIDM4Ljg4OTU2M10sXG4gKiAgICAgICBbLTc3LjAxOTgyNCwgMzguODkyMzY4XVxuICogICAgIF1cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgYWxvbmcgPSB0dXJmLmFsb25nKGxpbmUsIDEsICdtaWxlcycpO1xuICpcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW2xpbmUsIGFsb25nXVxuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobGluZSwgZGlzdCwgdW5pdHMpIHtcbiAgdmFyIGNvb3JkcztcbiAgaWYobGluZS50eXBlID09PSAnRmVhdHVyZScpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgaWYobGluZS50eXBlID09PSAnTGluZVN0cmluZycpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgdGhyb3cgbmV3IEVycm9yKCdpbnB1dCBtdXN0IGJlIGEgTGluZVN0cmluZyBGZWF0dXJlIG9yIEdlb21ldHJ5Jyk7XG5cbiAgdmFyIHRyYXZlbGxlZCA9IDA7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoZGlzdCA+PSB0cmF2ZWxsZWQgJiYgaSA9PT0gY29vcmRzLmxlbmd0aCAtIDEpIGJyZWFrO1xuICAgIGVsc2UgaWYodHJhdmVsbGVkID49IGRpc3QpIHtcbiAgICAgIHZhciBvdmVyc2hvdCA9IGRpc3QgLSB0cmF2ZWxsZWQ7XG4gICAgICBpZighb3ZlcnNob3QpIHJldHVybiBwb2ludChjb29yZHNbaV0pO1xuICAgICAgZWxzZSB7XG4gICAgICAgIHZhciBkaXJlY3Rpb24gPSBiZWFyaW5nKHBvaW50KGNvb3Jkc1tpXSksIHBvaW50KGNvb3Jkc1tpLTFdKSkgLSAxODA7XG4gICAgICAgIHZhciBpbnRlcnBvbGF0ZWQgPSBkZXN0aW5hdGlvbihwb2ludChjb29yZHNbaV0pLCBvdmVyc2hvdCwgZGlyZWN0aW9uLCB1bml0cyk7XG4gICAgICAgIHJldHVybiBpbnRlcnBvbGF0ZWQ7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdHJhdmVsbGVkICs9IGRpc3RhbmNlKHBvaW50KGNvb3Jkc1tpXSksIHBvaW50KGNvb3Jkc1tpKzFdKSwgdW5pdHMpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcG9pbnQoY29vcmRzW2Nvb3Jkcy5sZW5ndGggLSAxXSk7XG59XG4iLCJ2YXIgZ2VvbWV0cnlBcmVhID0gcmVxdWlyZSgnZ2VvanNvbi1hcmVhJykuZ2VvbWV0cnk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgR2VvSlNPTn0gZmVhdHVyZSBvciB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIGFueSB0eXBlIGFuZCByZXR1cm5zIHRoZSBhcmVhIG9mIHRoYXQgZmVhdHVyZVxuICogaW4gc3F1YXJlIG1ldGVycy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvYXJlYVxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0dlb0pTT059IGlucHV0IGEge0BsaW5rIEZlYXR1cmV9IG9yIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2YgYW55IHR5cGVcbiAqIEByZXR1cm4ge051bWJlcn0gYXJlYSBpbiBzcXVhcmUgbWV0ZXJzXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHlnb25zID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy02Ny4wMzEwMjEsIDEwLjQ1ODEwMl0sXG4gKiAgICAgICAgICAgWy02Ny4wMzEwMjEsIDEwLjUzMzcyXSxcbiAqICAgICAgICAgICBbLTY2LjkyOTM5NywgMTAuNTMzNzJdLFxuICogICAgICAgICAgIFstNjYuOTI5Mzk3LCAxMC40NTgxMDJdLFxuICogICAgICAgICAgIFstNjcuMDMxMDIxLCAxMC40NTgxMDJdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstNjYuOTE5Nzg0LCAxMC4zOTczMjVdLFxuICogICAgICAgICAgIFstNjYuOTE5Nzg0LCAxMC41MTM0NjddLFxuICogICAgICAgICAgIFstNjYuODA1MTE0LCAxMC41MTM0NjddLFxuICogICAgICAgICAgIFstNjYuODA1MTE0LCAxMC4zOTczMjVdLFxuICogICAgICAgICAgIFstNjYuOTE5Nzg0LCAxMC4zOTczMjVdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBhcmVhID0gdHVyZi5hcmVhKHBvbHlnb25zKTtcbiAqXG4gKiAvLz1hcmVhXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oXykge1xuICAgIGlmIChfLnR5cGUgPT09ICdGZWF0dXJlQ29sbGVjdGlvbicpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHN1bSA9IDA7IGkgPCBfLmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoXy5mZWF0dXJlc1tpXS5nZW9tZXRyeSkge1xuICAgICAgICAgICAgICAgIHN1bSArPSBnZW9tZXRyeUFyZWEoXy5mZWF0dXJlc1tpXS5nZW9tZXRyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1bTtcbiAgICB9IGVsc2UgaWYgKF8udHlwZSA9PT0gJ0ZlYXR1cmUnKSB7XG4gICAgICAgIHJldHVybiBnZW9tZXRyeUFyZWEoXy5nZW9tZXRyeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGdlb21ldHJ5QXJlYShfKTtcbiAgICB9XG59O1xuIiwidmFyIHdnczg0ID0gcmVxdWlyZSgnd2dzODQnKTtcblxubW9kdWxlLmV4cG9ydHMuZ2VvbWV0cnkgPSBnZW9tZXRyeTtcbm1vZHVsZS5leHBvcnRzLnJpbmcgPSByaW5nQXJlYTtcblxuZnVuY3Rpb24gZ2VvbWV0cnkoXykge1xuICAgIHZhciBhcmVhID0gMCwgaTtcbiAgICBzd2l0Y2ggKF8udHlwZSkge1xuICAgICAgICBjYXNlICdQb2x5Z29uJzpcbiAgICAgICAgICAgIHJldHVybiBwb2x5Z29uQXJlYShfLmNvb3JkaW5hdGVzKTtcbiAgICAgICAgY2FzZSAnTXVsdGlQb2x5Z29uJzpcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBfLmNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJlYSArPSBwb2x5Z29uQXJlYShfLmNvb3JkaW5hdGVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcmVhO1xuICAgICAgICBjYXNlICdQb2ludCc6XG4gICAgICAgIGNhc2UgJ011bHRpUG9pbnQnOlxuICAgICAgICBjYXNlICdMaW5lU3RyaW5nJzpcbiAgICAgICAgY2FzZSAnTXVsdGlMaW5lU3RyaW5nJzpcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICBjYXNlICdHZW9tZXRyeUNvbGxlY3Rpb24nOlxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IF8uZ2VvbWV0cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGFyZWEgKz0gZ2VvbWV0cnkoXy5nZW9tZXRyaWVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcmVhO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcG9seWdvbkFyZWEoY29vcmRzKSB7XG4gICAgdmFyIGFyZWEgPSAwO1xuICAgIGlmIChjb29yZHMgJiYgY29vcmRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgYXJlYSArPSBNYXRoLmFicyhyaW5nQXJlYShjb29yZHNbMF0pKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZWEgLT0gTWF0aC5hYnMocmluZ0FyZWEoY29vcmRzW2ldKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFyZWE7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBhcHByb3hpbWF0ZSBhcmVhIG9mIHRoZSBwb2x5Z29uIHdlcmUgaXQgcHJvamVjdGVkIG9udG9cbiAqICAgICB0aGUgZWFydGguICBOb3RlIHRoYXQgdGhpcyBhcmVhIHdpbGwgYmUgcG9zaXRpdmUgaWYgcmluZyBpcyBvcmllbnRlZFxuICogICAgIGNsb2Nrd2lzZSwgb3RoZXJ3aXNlIGl0IHdpbGwgYmUgbmVnYXRpdmUuXG4gKlxuICogUmVmZXJlbmNlOlxuICogUm9iZXJ0LiBHLiBDaGFtYmVybGFpbiBhbmQgV2lsbGlhbSBILiBEdXF1ZXR0ZSwgXCJTb21lIEFsZ29yaXRobXMgZm9yXG4gKiAgICAgUG9seWdvbnMgb24gYSBTcGhlcmVcIiwgSlBMIFB1YmxpY2F0aW9uIDA3LTAzLCBKZXQgUHJvcHVsc2lvblxuICogICAgIExhYm9yYXRvcnksIFBhc2FkZW5hLCBDQSwgSnVuZSAyMDA3IGh0dHA6Ly90cnMtbmV3LmpwbC5uYXNhLmdvdi9kc3BhY2UvaGFuZGxlLzIwMTQvNDA0MDlcbiAqXG4gKiBSZXR1cm5zOlxuICoge2Zsb2F0fSBUaGUgYXBwcm94aW1hdGUgc2lnbmVkIGdlb2Rlc2ljIGFyZWEgb2YgdGhlIHBvbHlnb24gaW4gc3F1YXJlXG4gKiAgICAgbWV0ZXJzLlxuICovXG5cbmZ1bmN0aW9uIHJpbmdBcmVhKGNvb3Jkcykge1xuICAgIHZhciBhcmVhID0gMDtcblxuICAgIGlmIChjb29yZHMubGVuZ3RoID4gMikge1xuICAgICAgICB2YXIgcDEsIHAyO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIHAxID0gY29vcmRzW2ldO1xuICAgICAgICAgICAgcDIgPSBjb29yZHNbaSArIDFdO1xuICAgICAgICAgICAgYXJlYSArPSByYWQocDJbMF0gLSBwMVswXSkgKiAoMiArIE1hdGguc2luKHJhZChwMVsxXSkpICsgTWF0aC5zaW4ocmFkKHAyWzFdKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXJlYSA9IGFyZWEgKiB3Z3M4NC5SQURJVVMgKiB3Z3M4NC5SQURJVVMgLyAyO1xuICAgIH1cblxuICAgIHJldHVybiBhcmVhO1xufVxuXG5mdW5jdGlvbiByYWQoXykge1xuICAgIHJldHVybiBfICogTWF0aC5QSSAvIDE4MDtcbn1cbiIsIm1vZHVsZS5leHBvcnRzLlJBRElVUyA9IDYzNzgxMzc7XG5tb2R1bGUuZXhwb3J0cy5GTEFUVEVOSU5HID0gMS8yOTguMjU3MjIzNTYzO1xubW9kdWxlLmV4cG9ydHMuUE9MQVJfUkFESVVTID0gNjM1Njc1Mi4zMTQyO1xuIiwidmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0aGUgYXZlcmFnZSB2YWx1ZSBvZiBhIGZpZWxkIGZvciBhIHNldCBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIHdpdGhpbiBhIHNldCBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2F2ZXJhZ2VcbiAqIEBjYXRlZ29yeSBhZ2dyZWdhdGlvblxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCB0aGUgZmllbGQgaW4gdGhlIGBwb2ludHNgIGZlYXR1cmVzIGZyb20gd2hpY2ggdG8gcHVsbCB2YWx1ZXMgdG8gYXZlcmFnZVxuICogQHBhcmFtIHtzdHJpbmd9IG91dHB1dEZpZWxkIHRoZSBmaWVsZCBpbiB0aGUgYHBvbHlnb25zYCBGZWF0dXJlQ29sbGVjdGlvbiB0byBwdXQgcmVzdWx0cyBvZiB0aGUgYXZlcmFnZXNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcyB3aXRoIHRoZSB2YWx1ZSBvZiBgb3V0RmllbGRgIHNldCB0byB0aGUgY2FsY3VsYXRlZCBhdmVyYWdlXG4gKiBAZXhhbXBsZVxuKiB2YXIgcG9seWdvbnMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbMTAuNjY2MzUxLCA1OS44OTA2NTldLFxuICogICAgICAgICAgIFsxMC42NjYzNTEsIDU5LjkzNjc4NF0sXG4gKiAgICAgICAgICAgWzEwLjc2MjQ4MSwgNTkuOTM2Nzg0XSxcbiAqICAgICAgICAgICBbMTAuNzYyNDgxLCA1OS44OTA2NTldLFxuICogICAgICAgICAgIFsxMC42NjYzNTEsIDU5Ljg5MDY1OV1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWzEwLjc2NDU0MSwgNTkuODg5MjgxXSxcbiAqICAgICAgICAgICBbMTAuNzY0NTQxLCA1OS45MzcxMjhdLFxuICogICAgICAgICAgIFsxMC44NjYxNjUsIDU5LjkzNzEyOF0sXG4gKiAgICAgICAgICAgWzEwLjg2NjE2NSwgNTkuODg5MjgxXSxcbiAqICAgICAgICAgICBbMTAuNzY0NTQxLCA1OS44ODkyODFdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMC43MjQwMjksIDU5LjkyNjgwN11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjcxNTc4OSwgNTkuOTA0Nzc4XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAuNzQ2MDAyLCA1OS45MDg1NjZdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMC44MDY0MjcsIDU5LjkwODkxMF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMzAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjc5NTQ0LCA1OS45MzE2MjRdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBhdmVyYWdlZCA9IHR1cmYuYXZlcmFnZShcbiAqICBwb2x5Z29ucywgcG9pbnRzLCAncG9wdWxhdGlvbicsICdwb3BfYXZnJyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChcbiAqICAgYXZlcmFnZWQuZmVhdHVyZXMpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5RkMsIHB0RkMsIGluRmllbGQsIG91dEZpZWxkLCBkb25lKXtcbiAgcG9seUZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocG9seSl7XG4gICAgaWYoIXBvbHkucHJvcGVydGllcykgcG9seS5wcm9wZXJ0aWVzID0ge307XG4gICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgIHB0RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwdCl7XG4gICAgICBpZiAoaW5zaWRlKHB0LCBwb2x5KSkgdmFsdWVzLnB1c2gocHQucHJvcGVydGllc1tpbkZpZWxkXSk7XG4gICAgfSk7XG4gICAgcG9seS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IGF2ZXJhZ2UodmFsdWVzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHBvbHlGQztcbn1cblxuZnVuY3Rpb24gYXZlcmFnZSh2YWx1ZXMpIHtcbiAgdmFyIHN1bSA9IDA7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgc3VtICs9IHZhbHVlc1tpXTtcbiAgfVxuICByZXR1cm4gc3VtIC8gdmFsdWVzLmxlbmd0aDtcbn1cbiIsInZhciBwb2x5Z29uID0gcmVxdWlyZSgndHVyZi1wb2x5Z29uJyk7XG5cbi8qKlxuICogVGFrZXMgYSBiYm94IGFuZCByZXR1cm5zIHRoZSBlcXVpdmFsZW50IHtAbGluayBQb2x5Z29ufSBmZWF0dXJlLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9iYm94LXBvbHlnb25cbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBiYm94IGFuIEFycmF5IG9mIGJvdW5kaW5nIGJveCBjb29yZGluYXRlcyBpbiB0aGUgZm9ybTogYGBgW3hMb3csIHlMb3csIHhIaWdoLCB5SGlnaF1gYGBcbiAqIEByZXR1cm4ge1BvbHlnb259IGEgUG9seWdvbiByZXByZXNlbnRhdGlvbiBvZiB0aGUgYm91bmRpbmcgYm94XG4gKiBAZXhhbXBsZVxuICogdmFyIGJib3ggPSBbMCwgMCwgMTAsIDEwXTtcbiAqXG4gKiB2YXIgcG9seSA9IHR1cmYuYmJveFBvbHlnb24oYmJveCk7XG4gKlxuICogLy89cG9seVxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYmJveCl7XG4gIHZhciBsb3dMZWZ0ID0gW2Jib3hbMF0sIGJib3hbMV1dO1xuICB2YXIgdG9wTGVmdCA9IFtiYm94WzBdLCBiYm94WzNdXTtcbiAgdmFyIHRvcFJpZ2h0ID0gW2Jib3hbMl0sIGJib3hbM11dO1xuICB2YXIgbG93UmlnaHQgPSBbYmJveFsyXSwgYmJveFsxXV07XG5cbiAgdmFyIHBvbHkgPSBwb2x5Z29uKFtbXG4gICAgbG93TGVmdCxcbiAgICBsb3dSaWdodCxcbiAgICB0b3BSaWdodCxcbiAgICB0b3BMZWZ0LFxuICAgIGxvd0xlZnRcbiAgXV0pO1xuICByZXR1cm4gcG9seTtcbn1cbiIsIi8vaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9IYXZlcnNpbmVfZm9ybXVsYVxuLy9odHRwOi8vd3d3Lm1vdmFibGUtdHlwZS5jby51ay9zY3JpcHRzL2xhdGxvbmcuaHRtbFxuXG4vKipcbiAqIFRha2VzIHR3byB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIGFuZCBmaW5kcyB0aGUgYmVhcmluZyBiZXR3ZWVuIHRoZW0uXG4gKlxuICogQG1vZHVsZSB0dXJmL2JlYXJpbmdcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtQb2ludH0gc3RhcnQgc3RhcnRpbmcgUG9pbnRcbiAqIEBwYXJhbSB7UG9pbnR9IGVuZCBlbmRpbmcgUG9pbnRcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHJldHVybnMge051bWJlcn0gYmVhcmluZyBpbiBkZWNpbWFsIGRlZ3JlZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnQxID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJtYXJrZXItY29sb3JcIjogJyNmMDAnXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjM0MywgMzkuOTg0XVxuICogICB9XG4gKiB9O1xuICogdmFyIHBvaW50MiA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwibWFya2VyLWNvbG9yXCI6ICcjMGYwJ1xuICogICB9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogWy03NS41MzQsIDM5LjEyM11cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtwb2ludDEsIHBvaW50Ml1cbiAqIH07XG4gKlxuICogLy89cG9pbnRzXG4gKlxuICogdmFyIGJlYXJpbmcgPSB0dXJmLmJlYXJpbmcocG9pbnQxLCBwb2ludDIpO1xuICpcbiAqIC8vPWJlYXJpbmdcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAocG9pbnQxLCBwb2ludDIpIHtcbiAgICB2YXIgY29vcmRpbmF0ZXMxID0gcG9pbnQxLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICAgIHZhciBjb29yZGluYXRlczIgPSBwb2ludDIuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG5cbiAgICB2YXIgbG9uMSA9IHRvUmFkKGNvb3JkaW5hdGVzMVswXSk7XG4gICAgdmFyIGxvbjIgPSB0b1JhZChjb29yZGluYXRlczJbMF0pO1xuICAgIHZhciBsYXQxID0gdG9SYWQoY29vcmRpbmF0ZXMxWzFdKTtcbiAgICB2YXIgbGF0MiA9IHRvUmFkKGNvb3JkaW5hdGVzMlsxXSk7XG4gICAgdmFyIGEgPSBNYXRoLnNpbihsb24yIC0gbG9uMSkgKiBNYXRoLmNvcyhsYXQyKTtcbiAgICB2YXIgYiA9IE1hdGguY29zKGxhdDEpICogTWF0aC5zaW4obGF0MikgLVxuICAgICAgICBNYXRoLnNpbihsYXQxKSAqIE1hdGguY29zKGxhdDIpICogTWF0aC5jb3MobG9uMiAtIGxvbjEpO1xuXG4gICAgdmFyIGJlYXJpbmcgPSB0b0RlZyhNYXRoLmF0YW4yKGEsIGIpKTtcblxuICAgIHJldHVybiBiZWFyaW5nO1xufTtcblxuZnVuY3Rpb24gdG9SYWQoZGVncmVlKSB7XG4gICAgcmV0dXJuIGRlZ3JlZSAqIE1hdGguUEkgLyAxODA7XG59XG5cbmZ1bmN0aW9uIHRvRGVnKHJhZGlhbikge1xuICAgIHJldHVybiByYWRpYW4gKiAxODAgLyBNYXRoLlBJO1xufVxuIiwidmFyIGxpbmVzdHJpbmcgPSByZXF1aXJlKCd0dXJmLWxpbmVzdHJpbmcnKTtcbnZhciBTcGxpbmUgPSByZXF1aXJlKCcuL3NwbGluZS5qcycpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIExpbmVTdHJpbmd9IGZlYXR1cmUgYW5kIHJldHVybnMgYSBjdXJ2ZWQgdmVyc2lvbiBvZiB0aGUgbGluZVxuICogYnkgYXBwbHlpbmcgYSBbQmV6aWVyIHNwbGluZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9CJUMzJUE5emllcl9zcGxpbmUpXG4gKiBhbGdvcml0aG0uXG4gKlxuICogVGhlIGJlemllciBzcGxpbmUgaW1wbGVtZW50YXRpb24gaXMgYnkgW0xlc3playBSeWJpY2tpXShodHRwOi8vbGVzemVrLnJ5Ymlja2kuY2MvKS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvYmV6aWVyXG4gKiBAY2F0ZWdvcnkgdHJhbnNmb3JtYXRpb25cbiAqIEBwYXJhbSB7TGluZVN0cmluZ30gbGluZSB0aGUgaW5wdXQgTGluZVN0cmluZ1xuICogQHBhcmFtIHtudW1iZXJ9IFtyZXNvbHV0aW9uPTEwMDAwXSB0aW1lIGluIG1pbGxpc2Vjb25kcyBiZXR3ZWVuIHBvaW50c1xuICogQHBhcmFtIHtudW1iZXJ9IFtzaGFycG5lc3M9MC44NV0gYSBtZWFzdXJlIG9mIGhvdyBjdXJ2eSB0aGUgcGF0aCBzaG91bGQgYmUgYmV0d2VlbiBzcGxpbmVzXG4gKiBAcmV0dXJucyB7TGluZVN0cmluZ30gY3VydmVkIGxpbmVcbiAqIEBleGFtcGxlXG4gKiB2YXIgbGluZSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwic3Ryb2tlXCI6IFwiI2YwMFwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIkxpbmVTdHJpbmdcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtcbiAqICAgICAgIFstNzYuMDkxMzA4LCAxOC40Mjc1MDFdLFxuICogICAgICAgWy03Ni42OTU1NTYsIDE4LjcyOTUwMV0sXG4gKiAgICAgICBbLTc2LjU1MjczNCwgMTkuNDA0NDNdLFxuICogICAgICAgWy03NC42MTkxNCwgMTkuMTM0Nzg5XSxcbiAqICAgICAgIFstNzMuNjUyMzQzLCAyMC4wNzY1N10sXG4gKiAgICAgICBbLTczLjE1Nzk1OCwgMjAuMjEwNjU2XVxuICogICAgIF1cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgY3VydmVkID0gdHVyZi5iZXppZXIobGluZSk7XG4gKiBjdXJ2ZWQucHJvcGVydGllcyA9IHsgc3Ryb2tlOiAnIzBmMCcgfTtcbiAqXG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtsaW5lLCBjdXJ2ZWRdXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxpbmUsIHJlc29sdXRpb24sIHNoYXJwbmVzcyl7XG4gIHZhciBsaW5lT3V0ID0gbGluZXN0cmluZyhbXSk7XG5cbiAgbGluZU91dC5wcm9wZXJ0aWVzID0gbGluZS5wcm9wZXJ0aWVzO1xuICB2YXIgcHRzID0gbGluZS5nZW9tZXRyeS5jb29yZGluYXRlcy5tYXAoZnVuY3Rpb24ocHQpe1xuICAgIHJldHVybiB7eDogcHRbMF0sIHk6IHB0WzFdfTtcbiAgfSk7XG5cbiAgdmFyIHNwbGluZSA9IG5ldyBTcGxpbmUoe1xuICAgIHBvaW50czogcHRzLFxuICAgIGR1cmF0aW9uOiByZXNvbHV0aW9uLFxuICAgIHNoYXJwbmVzczogc2hhcnBuZXNzXG4gIH0pO1xuICBmb3IgKHZhciBpPTA7IGk8c3BsaW5lLmR1cmF0aW9uOyBpKz0xMCkge1xuICAgIHZhciBwb3MgPSBzcGxpbmUucG9zKGkpO1xuICAgIGlmIChNYXRoLmZsb29yKGkvMTAwKSUyPT09MCkge1xuICAgICAgICBsaW5lT3V0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzLnB1c2goW3Bvcy54LCBwb3MueV0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBsaW5lT3V0O1xufTtcbiIsIiAvKipcbiAgICogQmV6aWVyU3BsaW5lXG4gICAqIGh0dHA6Ly9sZXN6ZWtyLmdpdGh1Yi5jb20vXG4gICAqXG4gICAqIEBjb3B5cmlnaHRcbiAgICogQ29weXJpZ2h0IChDKSAyMDEyIExlc3playBSeWJpY2tpLlxuICAgKlxuICAgKiBAbGljZW5zZVxuICAgKiBUaGlzIGZpbGUgaXMgcGFydCBvZiBCZXppZXJTcGxpbmVcbiAgICpcbiAgICogQmV6aWVyU3BsaW5lIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAgICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gICAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yXG4gICAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gICAqXG4gICAqIEJlemllclNwbGluZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICAgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICAgKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlXG4gICAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gICAqXG4gICAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG4gICAqIGFsb25nIHdpdGggQmV6aWVyU3BsaW5lLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9jb3B5bGVmdC9sZXNzZXIuaHRtbD4uXG4gICAqL1xuXG4gIC8qXG4gIFVzYWdlOlxuXG4gICAgdmFyIHNwbGluZSA9IG5ldyBTcGxpbmUoe1xuICAgICAgcG9pbnRzOiBhcnJheV9vZl9jb250cm9sX3BvaW50cyxcbiAgICAgIGR1cmF0aW9uOiB0aW1lX2luX21pbGlzZWNvbmRzLFxuICAgICAgc2hhcnBuZXNzOiBob3dfY3VydnksXG4gICAgICBzdGVwTGVuZ3RoOiBkaXN0YW5jZV9iZXR3ZWVuX3BvaW50c190b19jYWNoZVxuICAgIH0pO1xuXG4gICovXG52YXIgU3BsaW5lID0gZnVuY3Rpb24ob3B0aW9ucyl7XG4gICAgdGhpcy5wb2ludHMgPSBvcHRpb25zLnBvaW50cyB8fCBbXTtcbiAgICB0aGlzLmR1cmF0aW9uID0gb3B0aW9ucy5kdXJhdGlvbiB8fCAxMDAwMDtcbiAgICB0aGlzLnNoYXJwbmVzcyA9IG9wdGlvbnMuc2hhcnBuZXNzIHx8IDAuODU7XG4gICAgdGhpcy5jZW50ZXJzID0gW107XG4gICAgdGhpcy5jb250cm9scyA9IFtdO1xuICAgIHRoaXMuc3RlcExlbmd0aCA9IG9wdGlvbnMuc3RlcExlbmd0aCB8fCA2MDtcbiAgICB0aGlzLmxlbmd0aCA9IHRoaXMucG9pbnRzLmxlbmd0aDtcbiAgICB0aGlzLmRlbGF5ID0gMDtcbiAgICAvLyB0aGlzIGlzIHRvIGVuc3VyZSBjb21wYXRpYmlsaXR5IHdpdGggdGhlIDJkIHZlcnNpb25cbiAgICBmb3IodmFyIGk9MDsgaTx0aGlzLmxlbmd0aDsgaSsrKSB0aGlzLnBvaW50c1tpXS56ID0gdGhpcy5wb2ludHNbaV0ueiB8fCAwO1xuICAgIGZvcih2YXIgaT0wOyBpPHRoaXMubGVuZ3RoLTE7IGkrKyl7XG4gICAgICB2YXIgcDEgPSB0aGlzLnBvaW50c1tpXTtcbiAgICAgIHZhciBwMiA9IHRoaXMucG9pbnRzW2krMV07XG4gICAgICB0aGlzLmNlbnRlcnMucHVzaCh7eDoocDEueCtwMi54KS8yLCB5OihwMS55K3AyLnkpLzIsIHo6KHAxLnorcDIueikvMn0pO1xuICAgIH1cbiAgICB0aGlzLmNvbnRyb2xzLnB1c2goW3RoaXMucG9pbnRzWzBdLHRoaXMucG9pbnRzWzBdXSk7XG4gICAgZm9yKHZhciBpPTA7IGk8dGhpcy5jZW50ZXJzLmxlbmd0aC0xOyBpKyspe1xuICAgICAgdmFyIHAxID0gdGhpcy5jZW50ZXJzW2ldO1xuICAgICAgdmFyIHAyID0gdGhpcy5jZW50ZXJzW2krMV07XG4gICAgICB2YXIgZHggPSB0aGlzLnBvaW50c1tpKzFdLngtKHRoaXMuY2VudGVyc1tpXS54K3RoaXMuY2VudGVyc1tpKzFdLngpLzI7XG4gICAgICB2YXIgZHkgPSB0aGlzLnBvaW50c1tpKzFdLnktKHRoaXMuY2VudGVyc1tpXS55K3RoaXMuY2VudGVyc1tpKzFdLnkpLzI7XG4gICAgICB2YXIgZHogPSB0aGlzLnBvaW50c1tpKzFdLnotKHRoaXMuY2VudGVyc1tpXS55K3RoaXMuY2VudGVyc1tpKzFdLnopLzI7XG4gICAgICB0aGlzLmNvbnRyb2xzLnB1c2goW3tcbiAgICAgICAgeDooMS4wLXRoaXMuc2hhcnBuZXNzKSp0aGlzLnBvaW50c1tpKzFdLngrdGhpcy5zaGFycG5lc3MqKHRoaXMuY2VudGVyc1tpXS54K2R4KSxcbiAgICAgICAgeTooMS4wLXRoaXMuc2hhcnBuZXNzKSp0aGlzLnBvaW50c1tpKzFdLnkrdGhpcy5zaGFycG5lc3MqKHRoaXMuY2VudGVyc1tpXS55K2R5KSxcbiAgICAgICAgejooMS4wLXRoaXMuc2hhcnBuZXNzKSp0aGlzLnBvaW50c1tpKzFdLnordGhpcy5zaGFycG5lc3MqKHRoaXMuY2VudGVyc1tpXS56K2R6KX0sXG4gICAgICB7XG4gICAgICAgIHg6KDEuMC10aGlzLnNoYXJwbmVzcykqdGhpcy5wb2ludHNbaSsxXS54K3RoaXMuc2hhcnBuZXNzKih0aGlzLmNlbnRlcnNbaSsxXS54K2R4KSxcbiAgICAgICAgeTooMS4wLXRoaXMuc2hhcnBuZXNzKSp0aGlzLnBvaW50c1tpKzFdLnkrdGhpcy5zaGFycG5lc3MqKHRoaXMuY2VudGVyc1tpKzFdLnkrZHkpLFxuICAgICAgICB6OigxLjAtdGhpcy5zaGFycG5lc3MpKnRoaXMucG9pbnRzW2krMV0ueit0aGlzLnNoYXJwbmVzcyoodGhpcy5jZW50ZXJzW2krMV0ueitkeil9XSk7XG4gICAgfVxuICAgIHRoaXMuY29udHJvbHMucHVzaChbdGhpcy5wb2ludHNbdGhpcy5sZW5ndGgtMV0sdGhpcy5wb2ludHNbdGhpcy5sZW5ndGgtMV1dKTtcbiAgICB0aGlzLnN0ZXBzID0gdGhpcy5jYWNoZVN0ZXBzKHRoaXMuc3RlcExlbmd0aCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLypcbiAgICBDYWNoZXMgYW4gYXJyYXkgb2YgZXF1aWRpc3RhbnQgKG1vcmUgb3IgbGVzcykgcG9pbnRzIG9uIHRoZSBjdXJ2ZS5cbiAgKi9cbiAgU3BsaW5lLnByb3RvdHlwZS5jYWNoZVN0ZXBzID0gZnVuY3Rpb24obWluZGlzdCl7XG4gICAgdmFyIHN0ZXBzID0gW107XG4gICAgdmFyIGxhc3RzdGVwID0gdGhpcy5wb3MoMCk7XG4gICAgc3RlcHMucHVzaCgwKTtcbiAgICBmb3IodmFyIHQ9MDsgdDx0aGlzLmR1cmF0aW9uOyB0Kz0xMCl7XG4gICAgICB2YXIgc3RlcCA9IHRoaXMucG9zKHQpO1xuICAgICAgdmFyIGRpc3QgPSBNYXRoLnNxcnQoKHN0ZXAueC1sYXN0c3RlcC54KSooc3RlcC54LWxhc3RzdGVwLngpKyhzdGVwLnktbGFzdHN0ZXAueSkqKHN0ZXAueS1sYXN0c3RlcC55KSsoc3RlcC56LWxhc3RzdGVwLnopKihzdGVwLnotbGFzdHN0ZXAueikpO1xuICAgICAgaWYoZGlzdD5taW5kaXN0KXtcbiAgICAgICAgc3RlcHMucHVzaCh0KTtcbiAgICAgICAgbGFzdHN0ZXAgPSBzdGVwO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RlcHM7XG4gIH07XG5cbiAgLypcbiAgICByZXR1cm5zIGFuZ2xlIGFuZCBzcGVlZCBpbiB0aGUgZ2l2ZW4gcG9pbnQgaW4gdGhlIGN1cnZlXG4gICovXG4gIFNwbGluZS5wcm90b3R5cGUudmVjdG9yID0gZnVuY3Rpb24odCl7XG4gICAgdmFyIHAxID0gdGhpcy5wb3ModCsxMCk7XG4gICAgdmFyIHAyID0gdGhpcy5wb3ModC0xMCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFuZ2xlOjE4MCpNYXRoLmF0YW4yKHAxLnktcDIueSwgcDEueC1wMi54KS8zLjE0LFxuICAgICAgc3BlZWQ6TWF0aC5zcXJ0KChwMi54LXAxLngpKihwMi54LXAxLngpKyhwMi55LXAxLnkpKihwMi55LXAxLnkpKyhwMi56LXAxLnopKihwMi56LXAxLnopKVxuICAgIH07XG4gIH07XG5cbiAgLypcbiAgICBHZXRzIHRoZSBwb3NpdGlvbiBvZiB0aGUgcG9pbnQsIGdpdmVuIHRpbWUuXG5cbiAgICBXQVJOSU5HOiBUaGUgc3BlZWQgaXMgbm90IGNvbnN0YW50LiBUaGUgdGltZSBpdCB0YWtlcyBiZXR3ZWVuIGNvbnRyb2wgcG9pbnRzIGlzIGNvbnN0YW50LlxuXG4gICAgRm9yIGNvbnN0YW50IHNwZWVkLCB1c2UgU3BsaW5lLnN0ZXBzW2ldO1xuICAqL1xuICBTcGxpbmUucHJvdG90eXBlLnBvcyA9IGZ1bmN0aW9uKHRpbWUpe1xuXG4gICAgZnVuY3Rpb24gYmV6aWVyKHQsIHAxLCBjMSwgYzIsIHAyKXtcbiAgICAgIHZhciBCID0gZnVuY3Rpb24odCkge1xuICAgICAgICB2YXIgdDI9dCp0LCB0Mz10Mip0O1xuICAgICAgICByZXR1cm4gWyh0MyksKDMqdDIqKDEtdCkpLCgzKnQqKDEtdCkqKDEtdCkpLCgoMS10KSooMS10KSooMS10KSldXG4gICAgICB9XG4gICAgICB2YXIgYiA9IEIodClcbiAgICAgIHZhciBwb3MgPSB7XG4gICAgICAgIHggOiBwMi54ICogYlswXSArIGMyLnggKiBiWzFdICtjMS54ICogYlsyXSArIHAxLnggKiBiWzNdLFxuICAgICAgICB5IDogcDIueSAqIGJbMF0gKyBjMi55ICogYlsxXSArYzEueSAqIGJbMl0gKyBwMS55ICogYlszXSxcbiAgICAgICAgeiA6IHAyLnogKiBiWzBdICsgYzIueiAqIGJbMV0gK2MxLnogKiBiWzJdICsgcDEueiAqIGJbM11cbiAgICAgIH1cbiAgICAgIHJldHVybiBwb3M7XG4gICAgfVxuICAgIHZhciB0ID0gdGltZS10aGlzLmRlbGF5O1xuICAgIGlmKHQ8MCkgdD0wO1xuICAgIGlmKHQ+dGhpcy5kdXJhdGlvbikgdD10aGlzLmR1cmF0aW9uLTE7XG4gICAgLy90ID0gdC10aGlzLmRlbGF5O1xuICAgIHZhciB0MiA9ICh0KS90aGlzLmR1cmF0aW9uO1xuICAgIGlmKHQyPj0xKSByZXR1cm4gdGhpcy5wb2ludHNbdGhpcy5sZW5ndGgtMV07XG5cbiAgICB2YXIgbiA9IE1hdGguZmxvb3IoKHRoaXMucG9pbnRzLmxlbmd0aC0xKSp0Mik7XG4gICAgdmFyIHQxID0gKHRoaXMubGVuZ3RoLTEpKnQyLW47XG4gICAgcmV0dXJuIGJlemllcih0MSx0aGlzLnBvaW50c1tuXSx0aGlzLmNvbnRyb2xzW25dWzFdLHRoaXMuY29udHJvbHNbbisxXVswXSx0aGlzLnBvaW50c1tuKzFdKTtcbiAgfVxuXG4gIG1vZHVsZS5leHBvcnRzID0gU3BsaW5lO1xuIiwiLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84Mzk4OTkvaG93LWRvLWktY2FsY3VsYXRlLWEtcG9pbnQtb24tYS1jaXJjbGVzLWNpcmN1bWZlcmVuY2Vcbi8vIHJhZGlhbnMgPSBkZWdyZWVzICogKHBpLzE4MClcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9iam9ybmhhcnJ0ZWxsL2pzdHMvYmxvYi9tYXN0ZXIvZXhhbXBsZXMvYnVmZmVyLmh0bWxcblxudmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xudmFyIHBvbHlnb24gPSByZXF1aXJlKCd0dXJmLXBvbHlnb24nKTtcbnZhciBjb21iaW5lID0gcmVxdWlyZSgndHVyZi1jb21iaW5lJyk7XG52YXIganN0cyA9IHJlcXVpcmUoJ2pzdHMnKTtcblxuLyoqXG4qIENhbGN1bGF0ZXMgYSBidWZmZXIgZm9yIGEge0BsaW5rIFBvaW50fSwge0BsaW5rIExpbmVTdHJpbmd9LCBvciB7QGxpbmsgUG9seWdvbn0ge0BsaW5rIEZlYXR1cmV9L3tAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gZm9yIGEgZ2l2ZW4gcmFkaXVzLiBVbml0cyBzdXBwb3J0ZWQgYXJlIG1pbGVzLCBraWxvbWV0ZXJzLCBhbmQgZGVncmVlcy5cbipcbiogQG1vZHVsZSB0dXJmL2J1ZmZlclxuKiBAY2F0ZWdvcnkgdHJhbnNmb3JtYXRpb25cbiogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gZmVhdHVyZSBhIEZlYXR1cmUgb3IgRmVhdHVyZUNvbGxlY3Rpb24gb2YgYW55IHR5cGVcbiogQHBhcmFtIHtOdW1iZXJ9IGRpc3RhbmNlIGRpc3RhbmNlIHRvIGRyYXcgdGhlIGJ1ZmZlclxuKiBAcGFyYW0ge1N0cmluZ30gdW5pdCAnbWlsZXMnIG9yICdraWxvbWV0ZXJzJ1xuKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBjb250YWluaW5nIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcyByZXByZXNlbnRpbmcgYnVmZmVyc1xuKlxuKiBAZXhhbXBsZVxuKiB2YXIgcHQgPSB7XG4qICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiogICBcImdlb21ldHJ5XCI6IHtcbiogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTAuNTQ4NjMwLCAxNC42MTY1OTldXG4qICAgfVxuKiB9O1xuKiB2YXIgdW5pdCA9ICdtaWxlcyc7XG4qXG4qIHZhciBidWZmZXJlZCA9IHR1cmYuYnVmZmVyKHB0LCA1MDAsIHVuaXQpO1xuKlxuKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBidWZmZXJlZC5mZWF0dXJlcy5jb25jYXQocHQpO1xuKiB2YXIgcmVzdWx0ID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4qICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuKiB9O1xuKlxuKiAvLz1yZXN1bHRcbiovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmVhdHVyZSwgcmFkaXVzLCB1bml0cyl7XG4gIHZhciBidWZmZXJlZDtcblxuICBzd2l0Y2godW5pdHMpe1xuICAgIGNhc2UgJ21pbGVzJzpcbiAgICAgIHJhZGl1cyA9IHJhZGl1cyAvIDY5LjA0NztcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAnZmVldCc6XG4gICAgICByYWRpdXMgPSByYWRpdXMgLyAzNjQ1NjguMDtcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAna2lsb21ldGVycyc6XG4gICAgICByYWRpdXMgPSByYWRpdXMgLyAxMTEuMTI7XG4gICAgICBicmVha1xuICAgIGNhc2UgJ21ldGVycyc6XG4gICAgICByYWRpdXMgPSByYWRpdXMgLyAxMTExMjAuMDtcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAnZGVncmVlcyc6XG4gICAgICBicmVha1xuICB9XG5cbiAgaWYoZmVhdHVyZS50eXBlID09PSAnRmVhdHVyZUNvbGxlY3Rpb24nKXtcbiAgICB2YXIgbXVsdGkgPSBjb21iaW5lKGZlYXR1cmUpO1xuICAgIG11bHRpLnByb3BlcnRpZXMgPSB7fTtcbiAgICBidWZmZXJlZCA9IGJ1ZmZlck9wKG11bHRpLCByYWRpdXMpO1xuICAgIHJldHVybiBidWZmZXJlZDtcbiAgfVxuICBlbHNle1xuICAgIGJ1ZmZlcmVkID0gYnVmZmVyT3AoZmVhdHVyZSwgcmFkaXVzKTtcbiAgICByZXR1cm4gYnVmZmVyZWQ7XG4gIH1cbn1cblxudmFyIGJ1ZmZlck9wID0gZnVuY3Rpb24oZmVhdHVyZSwgcmFkaXVzKXtcbiAgdmFyIHJlYWRlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05SZWFkZXIoKTtcbiAgdmFyIGdlb20gPSByZWFkZXIucmVhZChKU09OLnN0cmluZ2lmeShmZWF0dXJlLmdlb21ldHJ5KSk7XG4gIHZhciBidWZmZXJlZCA9IGdlb20uYnVmZmVyKHJhZGl1cyk7XG4gIHZhciBwYXJzZXIgPSBuZXcganN0cy5pby5HZW9KU09OUGFyc2VyKCk7XG4gIGJ1ZmZlcmVkID0gcGFyc2VyLndyaXRlKGJ1ZmZlcmVkKTtcblxuICBpZihidWZmZXJlZC50eXBlID09PSAnTXVsdGlQb2x5Z29uJyl7XG4gICAgYnVmZmVyZWQgPSB7XG4gICAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgICBnZW9tZXRyeTogYnVmZmVyZWQsXG4gICAgICBwcm9wZXJ0aWVzOiB7fVxuICAgIH07XG4gICAgYnVmZmVyZWQgPSBmZWF0dXJlY29sbGVjdGlvbihbYnVmZmVyZWRdKTtcbiAgfVxuICBlbHNle1xuICAgIGJ1ZmZlcmVkID0gZmVhdHVyZWNvbGxlY3Rpb24oW3BvbHlnb24oYnVmZmVyZWQuY29vcmRpbmF0ZXMpXSk7XG4gIH1cblxuICByZXR1cm4gYnVmZmVyZWQ7XG59XG4iLCJyZXF1aXJlKCdqYXZhc2NyaXB0LnV0aWwnKTtcbnZhciBqc3RzID0gcmVxdWlyZSgnLi9saWIvanN0cycpO1xubW9kdWxlLmV4cG9ydHMgPSBqc3RzXG4iLCIvKiBUaGUgSlNUUyBUb3BvbG9neSBTdWl0ZSBpcyBhIGNvbGxlY3Rpb24gb2YgSmF2YVNjcmlwdCBjbGFzc2VzIHRoYXRcbmltcGxlbWVudCB0aGUgZnVuZGFtZW50YWwgb3BlcmF0aW9ucyByZXF1aXJlZCB0byB2YWxpZGF0ZSBhIGdpdmVuXG5nZW8tc3BhdGlhbCBkYXRhIHNldCB0byBhIGtub3duIHRvcG9sb2dpY2FsIHNwZWNpZmljYXRpb24uXG5cbkNvcHlyaWdodCAoQykgMjAxMSBUaGUgQXV0aG9yc1xuXG5UaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG5tb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG5MaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbnZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuXG5UaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbmJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG5NRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVVxuTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cblxuWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZVxuRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlLCBTdWl0ZSAzMzAsIEJvc3RvbiwgTUEgIDAyMTExLTEzMDcgIFVTQSAqL1xuanN0cz17dmVyc2lvbjonMC4xNS4wJyxhbGdvcml0aG06e2Rpc3RhbmNlOnt9LGxvY2F0ZTp7fX0sZXJyb3I6e30sZ2VvbTp7dXRpbDp7fX0sZ2VvbWdyYXBoOntpbmRleDp7fX0saW5kZXg6e2JpbnRyZWU6e30sY2hhaW46e30sa2R0cmVlOnt9LHF1YWR0cmVlOnt9LHN0cnRyZWU6e319LGlvOnt9LG5vZGluZzp7c25hcHJvdW5kOnt9fSxvcGVyYXRpb246e2J1ZmZlcjp7fSxkaXN0YW5jZTp7fSxvdmVybGF5OntzbmFwOnt9fSxwb2x5Z29uaXplOnt9LHByZWRpY2F0ZTp7fSxyZWxhdGU6e30sdW5pb246e30sdmFsaWQ6e319LHBsYW5hcmdyYXBoOnt9LHNpbXBsaWZ5Ont9LHRyaWFuZ3VsYXRlOntxdWFkZWRnZTp7fX0sdXRpbDp7fX07aWYodHlwZW9mIFN0cmluZy5wcm90b3R5cGUudHJpbSE9PSdmdW5jdGlvbicpe1N0cmluZy5wcm90b3R5cGUudHJpbT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlcGxhY2UoL15cXHMrfFxccyskL2csJycpO307fVxuanN0cy5hYnN0cmFjdEZ1bmM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5lcnJvcj17fTtqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubmFtZT0nSWxsZWdhbEFyZ3VtZW50RXJyb3InO3RoaXMubWVzc2FnZT1tZXNzYWdlO307anN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7anN0cy5lcnJvci5Ub3BvbG9neUVycm9yPWZ1bmN0aW9uKG1lc3NhZ2UscHQpe3RoaXMubmFtZT0nVG9wb2xvZ3lFcnJvcic7dGhpcy5tZXNzYWdlPXB0P21lc3NhZ2UrJyBbICcrcHQrJyBdJzptZXNzYWdlO307anN0cy5lcnJvci5Ub3BvbG9neUVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yPWZ1bmN0aW9uKCl7dGhpcy5uYW1lPSdBYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcic7dGhpcy5tZXNzYWdlPSdBYnN0cmFjdCBtZXRob2QgY2FsbGVkLCBzaG91bGQgYmUgaW1wbGVtZW50ZWQgaW4gc3ViY2xhc3MuJzt9O2pzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuTm90SW1wbGVtZW50ZWRFcnJvcj1mdW5jdGlvbigpe3RoaXMubmFtZT0nTm90SW1wbGVtZW50ZWRFcnJvcic7dGhpcy5tZXNzYWdlPSdUaGlzIG1ldGhvZCBoYXMgbm90IHlldCBiZWVuIGltcGxlbWVudGVkLic7fTtqc3RzLmVycm9yLk5vdEltcGxlbWVudGVkRXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubmFtZT0nTm90UmVwcmVzZW50YWJsZUVycm9yJzt0aGlzLm1lc3NhZ2U9bWVzc2FnZTt9O2pzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtqc3RzLmVycm9yLkxvY2F0ZUZhaWx1cmVFcnJvcj1mdW5jdGlvbihtZXNzYWdlKXt0aGlzLm5hbWU9J0xvY2F0ZUZhaWx1cmVFcnJvcic7dGhpcy5tZXNzYWdlPW1lc3NhZ2U7fTtqc3RzLmVycm9yLkxvY2F0ZUZhaWx1cmVFcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7aWYodHlwZW9mIG1vZHVsZSE9PVwidW5kZWZpbmVkXCIpbW9kdWxlLmV4cG9ydHM9anN0cztqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXI9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyPWZ1bmN0aW9uKGNvbXBzKXt0aGlzLmNvbXBzPWNvbXBzO307anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcigpO2pzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXIucHJvdG90eXBlLmNvbXBzPW51bGw7anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5nZXRQb2x5Z29ucz1mdW5jdGlvbihnZW9tLGxpc3Qpe2lmKGxpc3Q9PT11bmRlZmluZWQpe2xpc3Q9W107fVxuaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXtsaXN0LnB1c2goZ2VvbSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXIobGlzdCkpO31cbnJldHVybiBsaXN0O307anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMuY29tcHMucHVzaChnZW9tKTt9O2pzdHMuaW8uV0tUUGFyc2VyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMucmVnRXhlcz17J3R5cGVTdHInOi9eXFxzKihcXHcrKVxccypcXChcXHMqKC4qKVxccypcXClcXHMqJC8sJ2VtcHR5VHlwZVN0cic6L15cXHMqKFxcdyspXFxzKkVNUFRZXFxzKiQvLCdzcGFjZXMnOi9cXHMrLywncGFyZW5Db21tYSc6L1xcKVxccyosXFxzKlxcKC8sJ2RvdWJsZVBhcmVuQ29tbWEnOi9cXClcXHMqXFwpXFxzKixcXHMqXFwoXFxzKlxcKC8sJ3RyaW1QYXJlbnMnOi9eXFxzKlxcKD8oLio/KVxcKT9cXHMqJC99O307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24od2t0KXt2YXIgZ2VvbWV0cnksdHlwZSxzdHI7d2t0PXdrdC5yZXBsYWNlKC9bXFxuXFxyXS9nLCcgJyk7dmFyIG1hdGNoZXM9dGhpcy5yZWdFeGVzLnR5cGVTdHIuZXhlYyh3a3QpO2lmKHdrdC5zZWFyY2goJ0VNUFRZJykhPT0tMSl7bWF0Y2hlcz10aGlzLnJlZ0V4ZXMuZW1wdHlUeXBlU3RyLmV4ZWMod2t0KTttYXRjaGVzWzJdPXVuZGVmaW5lZDt9XG5pZihtYXRjaGVzKXt0eXBlPW1hdGNoZXNbMV0udG9Mb3dlckNhc2UoKTtzdHI9bWF0Y2hlc1syXTtpZih0aGlzLnBhcnNlW3R5cGVdKXtnZW9tZXRyeT10aGlzLnBhcnNlW3R5cGVdLmFwcGx5KHRoaXMsW3N0cl0pO319XG5pZihnZW9tZXRyeT09PXVuZGVmaW5lZClcbnRocm93IG5ldyBFcnJvcignQ291bGQgbm90IHBhcnNlIFdLVCAnK3drdCk7cmV0dXJuIGdlb21ldHJ5O307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXtyZXR1cm4gdGhpcy5leHRyYWN0R2VvbWV0cnkoZ2VvbWV0cnkpO307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLmV4dHJhY3RHZW9tZXRyeT1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIHR5cGU9Z2VvbWV0cnkuQ0xBU1NfTkFNRS5zcGxpdCgnLicpWzJdLnRvTG93ZXJDYXNlKCk7aWYoIXRoaXMuZXh0cmFjdFt0eXBlXSl7cmV0dXJuIG51bGw7fVxudmFyIHdrdFR5cGU9dHlwZS50b1VwcGVyQ2FzZSgpO3ZhciBkYXRhO2lmKGdlb21ldHJ5LmlzRW1wdHkoKSl7ZGF0YT13a3RUeXBlKycgRU1QVFknO31lbHNle2RhdGE9d2t0VHlwZSsnKCcrdGhpcy5leHRyYWN0W3R5cGVdLmFwcGx5KHRoaXMsW2dlb21ldHJ5XSkrJyknO31cbnJldHVybiBkYXRhO307anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLmV4dHJhY3Q9eydjb29yZGluYXRlJzpmdW5jdGlvbihjb29yZGluYXRlKXtyZXR1cm4gY29vcmRpbmF0ZS54KycgJytjb29yZGluYXRlLnk7fSwncG9pbnQnOmZ1bmN0aW9uKHBvaW50KXtyZXR1cm4gcG9pbnQuY29vcmRpbmF0ZS54KycgJytwb2ludC5jb29yZGluYXRlLnk7fSwnbXVsdGlwb2ludCc6ZnVuY3Rpb24obXVsdGlwb2ludCl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wLGxlbj1tdWx0aXBvaW50Lmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrXG50aGlzLmV4dHJhY3QucG9pbnQuYXBwbHkodGhpcyxbbXVsdGlwb2ludC5nZW9tZXRyaWVzW2ldXSkrJyknKTt9XG5yZXR1cm4gYXJyYXkuam9pbignLCcpO30sJ2xpbmVzdHJpbmcnOmZ1bmN0aW9uKGxpbmVzdHJpbmcpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49bGluZXN0cmluZy5wb2ludHMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCh0aGlzLmV4dHJhY3QuY29vcmRpbmF0ZS5hcHBseSh0aGlzLFtsaW5lc3RyaW5nLnBvaW50c1tpXV0pKTt9XG5yZXR1cm4gYXJyYXkuam9pbignLCcpO30sJ211bHRpbGluZXN0cmluZyc6ZnVuY3Rpb24obXVsdGlsaW5lc3RyaW5nKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTAsbGVuPW11bHRpbGluZXN0cmluZy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjsrK2kpe2FycmF5LnB1c2goJygnK1xudGhpcy5leHRyYWN0LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbbXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwncG9seWdvbic6ZnVuY3Rpb24ocG9seWdvbil7dmFyIGFycmF5PVtdO2FycmF5LnB1c2goJygnK3RoaXMuZXh0cmFjdC5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW3BvbHlnb24uc2hlbGxdKSsnKScpO2Zvcih2YXIgaT0wLGxlbj1wb2x5Z29uLmhvbGVzLmxlbmd0aDtpPGxlbjsrK2kpe2FycmF5LnB1c2goJygnK3RoaXMuZXh0cmFjdC5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW3BvbHlnb24uaG9sZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnbXVsdGlwb2x5Z29uJzpmdW5jdGlvbihtdWx0aXBvbHlnb24pe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49bXVsdGlwb2x5Z29uLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrdGhpcy5leHRyYWN0LnBvbHlnb24uYXBwbHkodGhpcyxbbXVsdGlwb2x5Z29uLmdlb21ldHJpZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnZ2VvbWV0cnljb2xsZWN0aW9uJzpmdW5jdGlvbihjb2xsZWN0aW9uKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTAsbGVuPWNvbGxlY3Rpb24uZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKHRoaXMuZXh0cmFjdEdlb21ldHJ5LmFwcGx5KHRoaXMsW2NvbGxlY3Rpb24uZ2VvbWV0cmllc1tpXV0pKTt9XG5yZXR1cm4gYXJyYXkuam9pbignLCcpO319O2pzdHMuaW8uV0tUUGFyc2VyLnByb3RvdHlwZS5wYXJzZT17J3BvaW50JzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvaW50KG51bGwpO31cbnZhciBjb29yZHM9c3RyLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BhY2VzKTtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3Jkc1swXSxjb29yZHNbMV0pKTt9LCdtdWx0aXBvaW50JzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9pbnQobnVsbCk7fVxudmFyIHBvaW50O3ZhciBwb2ludHM9c3RyLnRyaW0oKS5zcGxpdCgnLCcpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj1wb2ludHMubGVuZ3RoO2k8bGVuOysraSl7cG9pbnQ9cG9pbnRzW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7Y29tcG9uZW50cy5wdXNoKHRoaXMucGFyc2UucG9pbnQuYXBwbHkodGhpcyxbcG9pbnRdKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9pbnQoY29tcG9uZW50cyk7fSwnbGluZXN0cmluZyc6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKG51bGwpO31cbnZhciBwb2ludHM9c3RyLnRyaW0oKS5zcGxpdCgnLCcpO3ZhciBjb21wb25lbnRzPVtdO3ZhciBjb29yZHM7Zm9yKHZhciBpPTAsbGVuPXBvaW50cy5sZW5ndGg7aTxsZW47KytpKXtjb29yZHM9cG9pbnRzW2ldLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMuc3BhY2VzKTtjb21wb25lbnRzLnB1c2gobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3Jkc1swXSxjb29yZHNbMV0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhjb21wb25lbnRzKTt9LCdsaW5lYXJyaW5nJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcobnVsbCk7fVxudmFyIHBvaW50cz1zdHIudHJpbSgpLnNwbGl0KCcsJyk7dmFyIGNvbXBvbmVudHM9W107dmFyIGNvb3Jkcztmb3IodmFyIGk9MCxsZW49cG9pbnRzLmxlbmd0aDtpPGxlbjsrK2kpe2Nvb3Jkcz1wb2ludHNbaV0udHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5zcGFjZXMpO2NvbXBvbmVudHMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmRzWzBdLGNvb3Jkc1sxXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvbXBvbmVudHMpO30sJ211bHRpbGluZXN0cmluZyc6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobnVsbCk7fVxudmFyIGxpbmU7dmFyIGxpbmVzPXN0ci50cmltKCkuc3BsaXQodGhpcy5yZWdFeGVzLnBhcmVuQ29tbWEpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj1saW5lcy5sZW5ndGg7aTxsZW47KytpKXtsaW5lPWxpbmVzW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7Y29tcG9uZW50cy5wdXNoKHRoaXMucGFyc2UubGluZXN0cmluZy5hcHBseSh0aGlzLFtsaW5lXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcoY29tcG9uZW50cyk7fSwncG9seWdvbic6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2x5Z29uKG51bGwpO31cbnZhciByaW5nLGxpbmVzdHJpbmcsbGluZWFycmluZzt2YXIgcmluZ3M9c3RyLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMucGFyZW5Db21tYSk7dmFyIHNoZWxsO3ZhciBob2xlcz1bXTtmb3IodmFyIGk9MCxsZW49cmluZ3MubGVuZ3RoO2k8bGVuOysraSl7cmluZz1yaW5nc1tpXS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltUGFyZW5zLCckMScpO2xpbmVzdHJpbmc9dGhpcy5wYXJzZS5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW3JpbmddKTtsaW5lYXJyaW5nPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcobGluZXN0cmluZy5wb2ludHMpO2lmKGk9PT0wKXtzaGVsbD1saW5lYXJyaW5nO31lbHNle2hvbGVzLnB1c2gobGluZWFycmluZyk7fX1cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2x5Z29uKHNoZWxsLGhvbGVzKTt9LCdtdWx0aXBvbHlnb24nOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2x5Z29uKG51bGwpO31cbnZhciBwb2x5Z29uO3ZhciBwb2x5Z29ucz1zdHIudHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5kb3VibGVQYXJlbkNvbW1hKTt2YXIgY29tcG9uZW50cz1bXTtmb3IodmFyIGk9MCxsZW49cG9seWdvbnMubGVuZ3RoO2k8bGVuOysraSl7cG9seWdvbj1wb2x5Z29uc1tpXS5yZXBsYWNlKHRoaXMucmVnRXhlcy50cmltUGFyZW5zLCckMScpO2NvbXBvbmVudHMucHVzaCh0aGlzLnBhcnNlLnBvbHlnb24uYXBwbHkodGhpcyxbcG9seWdvbl0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2x5Z29uKGNvbXBvbmVudHMpO30sJ2dlb21ldHJ5Y29sbGVjdGlvbic6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuc3RyPXN0ci5yZXBsYWNlKC8sXFxzKihbQS1aYS16XSkvZywnfCQxJyk7dmFyIHdrdEFycmF5PXN0ci50cmltKCkuc3BsaXQoJ3wnKTt2YXIgY29tcG9uZW50cz1bXTtmb3IodmFyIGk9MCxsZW49d2t0QXJyYXkubGVuZ3RoO2k8bGVuOysraSl7Y29tcG9uZW50cy5wdXNoKGpzdHMuaW8uV0tUUGFyc2VyLnByb3RvdHlwZS5yZWFkLmFwcGx5KHRoaXMsW3drdEFycmF5W2ldXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oY29tcG9uZW50cyk7fX07anN0cy5pbmRleC5JdGVtVmlzaXRvcj1mdW5jdGlvbigpe307anN0cy5pbmRleC5JdGVtVmlzaXRvci5wcm90b3R5cGUudmlzaXRJdGVtPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcz1mdW5jdGlvbigpe307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRT0tMTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuUklHSFQ9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRT0xO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5MRUZUPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT0xMSU5FQVI9MDtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuU1RSQUlHSFQ9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUjtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleD1mdW5jdGlvbihwMSxwMixxKXt2YXIgZHgxLGR5MSxkeDIsZHkyO2R4MT1wMi54LXAxLng7ZHkxPXAyLnktcDEueTtkeDI9cS54LXAyLng7ZHkyPXEueS1wMi55O3JldHVybiBqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoZHgxLGR5MSxkeDIsZHkyKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5sb2NhdGVQb2ludEluUmluZyhwLHJpbmcpIT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxvY2F0ZVBvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5sb2NhdGVQb2ludEluUmluZyhwLHJpbmcpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzT25MaW5lPWZ1bmN0aW9uKHAscHQpe3ZhciBsaW5lSW50ZXJzZWN0b3IsaSxpbCxwMCxwMTtsaW5lSW50ZXJzZWN0b3I9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO2ZvcihpPTEsaWw9cHQubGVuZ3RoO2k8aWw7aSsrKXtwMD1wdFtpLTFdO3AxPXB0W2ldO2xpbmVJbnRlcnNlY3Rvci5jb21wdXRlSW50ZXJzZWN0aW9uKHAscDAscDEpO2lmKGxpbmVJbnRlcnNlY3Rvci5oYXNJbnRlcnNlY3Rpb24oKSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVz1mdW5jdGlvbihyaW5nKXt2YXIgblB0cyxoaVB0LGhpSW5kZXgscCxpUHJldixpTmV4dCxwcmV2LG5leHQsaSxkaXNjLGlzQ0NXO25QdHM9cmluZy5sZW5ndGgtMTtpZihuUHRzPDMpe3Rocm93IG5ldyBqc3RzLklsbGVnYWxBcmd1bWVudEVycm9yKCdSaW5nIGhhcyBmZXdlciB0aGFuIDMgcG9pbnRzLCBzbyBvcmllbnRhdGlvbiBjYW5ub3QgYmUgZGV0ZXJtaW5lZCcpO31cbmhpUHQ9cmluZ1swXTtoaUluZGV4PTA7aT0xO2ZvcihpO2k8PW5QdHM7aSsrKXtwPXJpbmdbaV07aWYocC55PmhpUHQueSl7aGlQdD1wO2hpSW5kZXg9aTt9fVxuaVByZXY9aGlJbmRleDtkb3tpUHJldj1pUHJldi0xO2lmKGlQcmV2PDApe2lQcmV2PW5QdHM7fX13aGlsZShyaW5nW2lQcmV2XS5lcXVhbHMyRChoaVB0KSYmaVByZXYhPT1oaUluZGV4KTtpTmV4dD1oaUluZGV4O2Rve2lOZXh0PShpTmV4dCsxKSVuUHRzO313aGlsZShyaW5nW2lOZXh0XS5lcXVhbHMyRChoaVB0KSYmaU5leHQhPT1oaUluZGV4KTtwcmV2PXJpbmdbaVByZXZdO25leHQ9cmluZ1tpTmV4dF07aWYocHJldi5lcXVhbHMyRChoaVB0KXx8bmV4dC5lcXVhbHMyRChoaVB0KXx8cHJldi5lcXVhbHMyRChuZXh0KSl7cmV0dXJuIGZhbHNlO31cbmRpc2M9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwcmV2LGhpUHQsbmV4dCk7aXNDQ1c9ZmFsc2U7aWYoZGlzYz09PTApe2lzQ0NXPShwcmV2Lng+bmV4dC54KTt9ZWxzZXtpc0NDVz0oZGlzYz4wKTt9XG5yZXR1cm4gaXNDQ1c7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uPWZ1bmN0aW9uKHAxLHAyLHEpe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChwMSxwMixxKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZT1mdW5jdGlvbihwLEEsQil7aWYoIShBIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpKXtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZihBLng9PT1CLngmJkEueT09PUIueSl7cmV0dXJuIHAuZGlzdGFuY2UoQSk7fVxudmFyIHIscztyPSgocC54LUEueCkqKEIueC1BLngpKyhwLnktQS55KSooQi55LUEueSkpLygoQi54LUEueCkqKEIueC1BLngpKyhCLnktQS55KSooQi55LUEueSkpO2lmKHI8PTAuMCl7cmV0dXJuIHAuZGlzdGFuY2UoQSk7fVxuaWYocj49MS4wKXtyZXR1cm4gcC5kaXN0YW5jZShCKTt9XG5zPSgoQS55LXAueSkqKEIueC1BLngpLShBLngtcC54KSooQi55LUEueSkpLygoQi54LUEueCkqKEIueC1BLngpKyhCLnktQS55KSooQi55LUEueSkpO3JldHVybiBNYXRoLmFicyhzKSpNYXRoLnNxcnQoKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSkpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lUGVycGVuZGljdWxhcj1mdW5jdGlvbihwLEEsQil7dmFyIHM9KChBLnktcC55KSooQi54LUEueCktKEEueC1wLngpKihCLnktQS55KSkvKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSk7cmV0dXJuIE1hdGguYWJzKHMpKk1hdGguc3FydCgoKEIueC1BLngpKihCLngtQS54KSsoQi55LUEueSkqKEIueS1BLnkpKSk7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUyPWZ1bmN0aW9uKHAsbGluZSl7dmFyIG1pbkRpc3RhbmNlLGksaWwsZGlzdDtpZihsaW5lLmxlbmd0aD09PTApe3Rocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdMaW5lIGFycmF5IG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgdmVydGV4Jyk7fVxubWluRGlzdGFuY2U9cC5kaXN0YW5jZShsaW5lWzBdKTtmb3IoaT0wLGlsPWxpbmUubGVuZ3RoLTE7aTxpbDtpKyspe2Rpc3Q9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKHAsbGluZVtpXSxsaW5lW2krMV0pO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7fX1cbnJldHVybiBtaW5EaXN0YW5jZTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZUxpbmVMaW5lPWZ1bmN0aW9uKEEsQixDLEQpe2lmKEEuZXF1YWxzKEIpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEEsQyxEKTt9XG5pZihDLmVxdWFscyhEKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShELEEsQik7fVxudmFyIHJfdG9wLHJfYm90LHNfdG9wLHNfYm90LHMscjtyX3RvcD0oQS55LUMueSkqKEQueC1DLngpLShBLngtQy54KSooRC55LUMueSk7cl9ib3Q9KEIueC1BLngpKihELnktQy55KS0oQi55LUEueSkqKEQueC1DLngpO3NfdG9wPShBLnktQy55KSooQi54LUEueCktKEEueC1DLngpKihCLnktQS55KTtzX2JvdD0oQi54LUEueCkqKEQueS1DLnkpLShCLnktQS55KSooRC54LUMueCk7aWYoKHJfYm90PT09MCl8fChzX2JvdD09PTApKXtyZXR1cm4gTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEEsQyxEKSxNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQixDLEQpLE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShDLEEsQiksanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEQsQSxCKSkpKTt9XG5zPXNfdG9wL3NfYm90O3I9cl90b3Avcl9ib3Q7aWYoKHI8MCl8fChyPjEpfHwoczwwKXx8KHM+MSkpe3JldHVybiBNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQSxDLEQpLE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShCLEMsRCksTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEMsQSxCKSxqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoRCxBLEIpKSkpO31cbnJldHVybiAwLjA7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuc2lnbmVkQXJlYT1mdW5jdGlvbihyaW5nKXtpZihyaW5nLmxlbmd0aDwzKXtyZXR1cm4gMC4wO31cbnZhciBzdW0saSxpbCxieCxieSxjeCxjeTtzdW09MC4wO2ZvcihpPTAsaWw9cmluZy5sZW5ndGgtMTtpPGlsO2krKyl7Yng9cmluZ1tpXS54O2J5PXJpbmdbaV0ueTtjeD1yaW5nW2krMV0ueDtjeT1yaW5nW2krMV0ueTtzdW0rPShieCtjeCkqKGN5LWJ5KTt9XG5yZXR1cm4tc3VtLzIuMDt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5zaWduZWRBcmVhPWZ1bmN0aW9uKHJpbmcpe3ZhciBuLHN1bSxwLGJ4LGJ5LGksY3gsY3k7bj1yaW5nLmxlbmd0aDtpZihuPDMpe3JldHVybiAwLjA7fVxuc3VtPTAuMDtwPXJpbmdbMF07Yng9cC54O2J5PXAueTtmb3IoaT0xO2k8bjtpKyspe3A9cmluZ1tpXTtjeD1wLng7Y3k9cC55O3N1bSs9KGJ4K2N4KSooY3ktYnkpO2J4PWN4O2J5PWN5O31cbnJldHVybi1zdW0vMi4wO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVMZW5ndGg9ZnVuY3Rpb24ocHRzKXt2YXIgbj1wdHMubGVuZ3RoLGxlbix4MCx5MCx4MSx5MSxkeCxkeSxwLGksaWw7aWYobjw9MSl7cmV0dXJuIDAuMDt9XG5sZW49MC4wO3A9cHRzWzBdO3gwPXAueDt5MD1wLnk7aT0xLGlsPW47Zm9yKGk7aTxuO2krKyl7cD1wdHNbaV07eDE9cC54O3kxPXAueTtkeD14MS14MDtkeT15MS15MDtsZW4rPU1hdGguc3FydChkeCpkeCtkeSpkeSk7eDA9eDE7eTA9eTE7fVxucmV0dXJuIGxlbjt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5sZW5ndGg9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yPTIuMCpNYXRoLlBJO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX09WRVJfMj1NYXRoLlBJLzIuMDtqc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9PVkVSXzQ9TWF0aC5QSS80LjA7anN0cy5hbGdvcml0aG0uQW5nbGUuQ09VTlRFUkNMT0NLV0lTRT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRTtqc3RzLmFsZ29yaXRobS5BbmdsZS5DTE9DS1dJU0U9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRTtqc3RzLmFsZ29yaXRobS5BbmdsZS5OT05FPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT0xMSU5FQVI7anN0cy5hbGdvcml0aG0uQW5nbGUudG9EZWdyZWVzPWZ1bmN0aW9uKHJhZGlhbnMpe3JldHVybihyYWRpYW5zKjE4MCkvTWF0aC5QSTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLnRvUmFkaWFucz1mdW5jdGlvbihhbmdsZURlZ3JlZXMpe3JldHVybihhbmdsZURlZ3JlZXMqTWF0aC5QSSkvMTgwLjA7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVGcm9tT3JpZ28oYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuQ29vcmRzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2VlbkNvb3Jkcz1mdW5jdGlvbihwMCxwMSl7dmFyIGR4LGR5O2R4PXAxLngtcDAueDtkeT1wMS55LXAwLnk7cmV0dXJuIE1hdGguYXRhbjIoZHksZHgpO307anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVGcm9tT3JpZ289ZnVuY3Rpb24ocCl7cmV0dXJuIE1hdGguYXRhbjIocC55LHAueCk7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlPWZ1bmN0aW9uKHAwLHAxLHAyKXt2YXIgZHgwLGR5MCxkeDEsZHkxLGRvdHByb2Q7ZHgwPXAwLngtcDEueDtkeTA9cDAueS1wMS55O2R4MT1wMi54LXAxLng7ZHkxPXAyLnktcDEueTtkb3Rwcm9kPWR4MCpkeDErZHkwKmR5MTtyZXR1cm4gZG90cHJvZD4wO307anN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2U9ZnVuY3Rpb24ocDAscDEscDIpe3ZhciBkeDAsZHkwLGR4MSxkeTEsZG90cHJvZDtkeDA9cDAueC1wMS54O2R5MD1wMC55LXAxLnk7ZHgxPXAyLngtcDEueDtkeTE9cDIueS1wMS55O2RvdHByb2Q9ZHgwKmR4MStkeTAqZHkxO3JldHVybiBkb3Rwcm9kPDA7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW49ZnVuY3Rpb24odGlwMSx0YWlsLHRpcDIpe3ZhciBhMSxhMjthMT1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZSh0YWlsLHRpcDEpO2EyPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHRhaWwsdGlwMik7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkFuZ2xlLmRpZmYoYTEsYTIpO307anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuT3JpZW50ZWQ9ZnVuY3Rpb24odGlwMSx0YWlsLHRpcDIpe3ZhciBhMSxhMixhbmdEZWw7YTE9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUodGFpbCx0aXAxKTthMj1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZSh0YWlsLHRpcDIpO2FuZ0RlbD1hMi1hMTtpZihhbmdEZWw8PS1NYXRoLlBJKXtyZXR1cm4gYW5nRGVsK2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxuaWYoYW5nRGVsPk1hdGguUEkpe3JldHVybiBhbmdEZWwtanN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5yZXR1cm4gYW5nRGVsO307anN0cy5hbGdvcml0aG0uQW5nbGUuaW50ZXJpb3JBbmdsZT1mdW5jdGlvbihwMCxwMSxwMil7dmFyIGFuZ2xlUHJldixhbmdsZU5leHQ7YW5nbGVQcmV2PWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHAxLHAwKTthbmdsZU5leHQ9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUocDEscDIpO3JldHVybiBNYXRoLmFicyhhbmdsZU5leHQtYW5nbGVQcmV2KTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmdldFR1cm49ZnVuY3Rpb24oYW5nMSxhbmcyKXt2YXIgY3Jvc3Nwcm9kdWN0PU1hdGguc2luKGFuZzItYW5nMSk7aWYoY3Jvc3Nwcm9kdWN0PjApe3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5DT1VOVEVSQ0xPQ0tXSVNFO31cbmlmKGNyb3NzcHJvZHVjdDwwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuQ0xPQ0tXSVNFO31cbnJldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5OT05FO307anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplPWZ1bmN0aW9uKGFuZ2xlKXt3aGlsZShhbmdsZT5NYXRoLlBJKXthbmdsZS09anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG53aGlsZShhbmdsZTw9LU1hdGguUEkpe2FuZ2xlKz1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yO31cbnJldHVybiBhbmdsZTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLm5vcm1hbGl6ZVBvc2l0aXZlPWZ1bmN0aW9uKGFuZ2xlKXtpZihhbmdsZTwwLjApe3doaWxlKGFuZ2xlPDAuMCl7YW5nbGUrPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxuaWYoYW5nbGU+PWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzIpe2FuZ2xlPTAuMDt9fVxuZWxzZXt3aGlsZShhbmdsZT49anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMil7YW5nbGUtPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxuaWYoYW5nbGU8MC4wKXthbmdsZT0wLjA7fX1cbnJldHVybiBhbmdsZTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmRpZmY9ZnVuY3Rpb24oYW5nMSxhbmcyKXt2YXIgZGVsQW5nbGU7aWYoYW5nMTxhbmcyKXtkZWxBbmdsZT1hbmcyLWFuZzE7fWVsc2V7ZGVsQW5nbGU9YW5nMS1hbmcyO31cbmlmKGRlbEFuZ2xlPk1hdGguUEkpe2RlbEFuZ2xlPSgyKk1hdGguUEkpLWRlbEFuZ2xlO31cbnJldHVybiBkZWxBbmdsZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbXBvbmVudEZpbHRlcj1mdW5jdGlvbigpe307anN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlcj1mdW5jdGlvbihsaW5lcyxpc0ZvcmNlZFRvTGluZVN0cmluZyl7dGhpcy5saW5lcz1saW5lczt0aGlzLmlzRm9yY2VkVG9MaW5lU3RyaW5nPWlzRm9yY2VkVG9MaW5lU3RyaW5nO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKCk7anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZS5saW5lcz1udWxsO2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5wcm90b3R5cGUuaXNGb3JjZWRUb0xpbmVTdHJpbmc9ZmFsc2U7anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzPWZ1bmN0aW9uKGdlb21zLGxpbmVzKXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT0yJiZ0eXBlb2YgbGluZXM9PT0nYm9vbGVhbicpe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM2LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PTImJmdlb21zIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT0zJiZnZW9tcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeSl7cmV0dXJuIGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczQuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09Myl7cmV0dXJuIGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmZvcih2YXIgaT0wO2k8Z2VvbXMubGVuZ3RoO2krKyl7dmFyIGc9Z2VvbXNbaV07anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMyhnLGxpbmVzKTt9XG5yZXR1cm4gbGluZXM7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMyPWZ1bmN0aW9uKGdlb21zLGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKXtmb3IodmFyIGk9MDtpPGdlb21zLmxlbmd0aDtpKyspe3ZhciBnPWdlb21zW2ldO2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczQoZyxsaW5lcyxmb3JjZVRvTGluZVN0cmluZyk7fVxucmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMz1mdW5jdGlvbihnZW9tLGxpbmVzKXtpZihnZW9tIGluc3RhbmNlb2YgTGluZVN0cmluZyl7bGluZXMuYWRkKGdlb20pO31lbHNle2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3RlcihsaW5lcykpO31cbnJldHVybiBsaW5lczt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczQ9ZnVuY3Rpb24oZ2VvbSxsaW5lcyxmb3JjZVRvTGluZVN0cmluZyl7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyKGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKSk7cmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNT1mdW5jdGlvbihnZW9tKXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNihnZW9tLGZhbHNlKTt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczY9ZnVuY3Rpb24oZ2VvbSxmb3JjZVRvTGluZVN0cmluZyl7dmFyIGxpbmVzPVtdO2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3RlcihsaW5lcyxmb3JjZVRvTGluZVN0cmluZykpO3JldHVybiBsaW5lczt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5wcm90b3R5cGUuc2V0Rm9yY2VUb0xpbmVTdHJpbmc9ZnVuY3Rpb24oaXNGb3JjZWRUb0xpbmVTdHJpbmcpe3RoaXMuaXNGb3JjZWRUb0xpbmVTdHJpbmc9aXNGb3JjZWRUb0xpbmVTdHJpbmc7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXtpZih0aGlzLmlzRm9yY2VkVG9MaW5lU3RyaW5nJiZnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpe3ZhciBsaW5lPWdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVTdHJpbmcoZ2VvbS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSk7dGhpcy5saW5lcy5wdXNoKGxpbmUpO3JldHVybjt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZylcbnRoaXMubGluZXMucHVzaChnZW9tKTt9O2pzdHMuZ2VvbS5Mb2NhdGlvbj1mdW5jdGlvbigpe307anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SPTA7anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZPTE7anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SPTI7anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU9LTE7anN0cy5nZW9tLkxvY2F0aW9uLnRvTG9jYXRpb25TeW1ib2w9ZnVuY3Rpb24obG9jYXRpb25WYWx1ZSl7c3dpdGNoKGxvY2F0aW9uVmFsdWUpe2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SOnJldHVybidlJztjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTpyZXR1cm4nYic7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I6cmV0dXJuJ2knO2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLk5PTkU6cmV0dXJuJy0nO31cbnRocm93IG5ldyBqc3RzLklsbGVnYWxBcmd1bWVudEVycm9yKCdVbmtub3duIGxvY2F0aW9uIHZhbHVlOiAnK1xubG9jYXRpb25WYWx1ZSk7fTsoZnVuY3Rpb24oKXtqc3RzLmlvLkdlb0pTT05SZWFkZXI9ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnl8fG5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5wcmVjaXNpb25Nb2RlbD10aGlzLmdlb21ldHJ5RmFjdG9yeS5nZXRQcmVjaXNpb25Nb2RlbCgpO3RoaXMucGFyc2VyPW5ldyBqc3RzLmlvLkdlb0pTT05QYXJzZXIodGhpcy5nZW9tZXRyeUZhY3RvcnkpO307anN0cy5pby5HZW9KU09OUmVhZGVyLnByb3RvdHlwZS5yZWFkPWZ1bmN0aW9uKGdlb0pzb24pe3ZhciBnZW9tZXRyeT10aGlzLnBhcnNlci5yZWFkKGdlb0pzb24pO2lmKHRoaXMucHJlY2lzaW9uTW9kZWwuZ2V0VHlwZSgpPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeSk7fVxucmV0dXJuIGdlb21ldHJ5O307anN0cy5pby5HZW9KU09OUmVhZGVyLnByb3RvdHlwZS5yZWR1Y2VQcmVjaXNpb249ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBpLGxlbjtpZihnZW9tZXRyeS5jb29yZGluYXRlKXt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGdlb21ldHJ5LmNvb3JkaW5hdGUpO31lbHNlIGlmKGdlb21ldHJ5LnBvaW50cyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkucG9pbnRzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkucG9pbnRzW2ldKTt9fWVsc2UgaWYoZ2VvbWV0cnkuZ2VvbWV0cmllcyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeS5nZW9tZXRyaWVzW2ldKTt9fX07fSkoKTtqc3RzLmdlb20uR2VvbWV0cnk9ZnVuY3Rpb24oZmFjdG9yeSl7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVudmVsb3BlPW51bGw7anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5mYWN0b3J5PW51bGw7anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRHZW9tZXRyeVR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4nR2VvbWV0cnknO307anN0cy5nZW9tLkdlb21ldHJ5Lmhhc05vbkVtcHR5RWxlbWVudHM9ZnVuY3Rpb24oZ2VvbWV0cmllcyl7dmFyIGk7Zm9yKGk9MDtpPGdlb21ldHJpZXMubGVuZ3RoO2krKyl7aWYoIWdlb21ldHJpZXNbaV0uaXNFbXB0eSgpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5Lmhhc051bGxFbGVtZW50cz1mdW5jdGlvbihhcnJheSl7dmFyIGk7Zm9yKGk9MDtpPGFycmF5Lmxlbmd0aDtpKyspe2lmKGFycmF5W2ldPT09bnVsbCl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0RmFjdG9yeT1mdW5jdGlvbigpe2lmKHRoaXMuZmFjdG9yeT09PW51bGx8fHRoaXMuZmFjdG9yeT09PXVuZGVmaW5lZCl7dGhpcy5mYWN0b3J5PW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7fVxucmV0dXJuIHRoaXMuZmFjdG9yeTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0TnVtR2VvbWV0cmllcz1mdW5jdGlvbigpe3JldHVybiAxO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRHZW9tZXRyeU49ZnVuY3Rpb24obil7cmV0dXJuIHRoaXM7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldFByZWNpc2lvbk1vZGVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmdldFByZWNpc2lvbk1vZGVsKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzU2ltcGxlPWZ1bmN0aW9uKCl7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt2YXIgb3A9bmV3IGpzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AodGhpcyk7cmV0dXJuIG9wLmlzU2ltcGxlKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt2YXIgaXNWYWxpZE9wPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AodGhpcyk7cmV0dXJuIGlzVmFsaWRPcC5pc1ZhbGlkKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihnKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5kaXN0YW5jZSh0aGlzLGcpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc1dpdGhpbkRpc3RhbmNlPWZ1bmN0aW9uKGdlb20sZGlzdGFuY2Upe3ZhciBlbnZEaXN0PXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmRpc3RhbmNlKGdlb20uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTtpZihlbnZEaXN0PmRpc3RhbmNlKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIERpc3RhbmNlT3AuaXNXaXRoaW5EaXN0YW5jZSh0aGlzLGdlb20sZGlzdGFuY2UpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc1JlY3RhbmdsZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0QXJlYT1mdW5jdGlvbigpe3JldHVybiAwLjA7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3JldHVybiAwLjA7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnZhciBjZW50O3ZhciBjZW50UHQ9bnVsbDt2YXIgZGltPXRoaXMuZ2V0RGltZW5zaW9uKCk7aWYoZGltPT09MCl7Y2VudD1uZXcganN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludCgpO2NlbnQuYWRkKHRoaXMpO2NlbnRQdD1jZW50LmdldENlbnRyb2lkKCk7fWVsc2UgaWYoZGltPT09MSl7Y2VudD1uZXcganN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lKCk7Y2VudC5hZGQodGhpcyk7Y2VudFB0PWNlbnQuZ2V0Q2VudHJvaWQoKTt9ZWxzZXtjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEoKTtjZW50LmFkZCh0aGlzKTtjZW50UHQ9Y2VudC5nZXRDZW50cm9pZCgpO31cbnJldHVybiB0aGlzLmNyZWF0ZVBvaW50RnJvbUludGVybmFsQ29vcmQoY2VudFB0LHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRJbnRlcmlvclBvaW50PWZ1bmN0aW9uKCl7dmFyIGludFB0O3ZhciBpbnRlcmlvclB0PW51bGw7dmFyIGRpbT10aGlzLmdldERpbWVuc2lvbigpO2lmKGRpbT09PTApe2ludFB0PW5ldyBqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQodGhpcyk7aW50ZXJpb3JQdD1pbnRQdC5nZXRJbnRlcmlvclBvaW50KCk7fWVsc2UgaWYoZGltPT09MSl7aW50UHQ9bmV3IGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRMaW5lKHRoaXMpO2ludGVyaW9yUHQ9aW50UHQuZ2V0SW50ZXJpb3JQb2ludCgpO31lbHNle2ludFB0PW5ldyBqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYSh0aGlzKTtpbnRlcmlvclB0PWludFB0LmdldEludGVyaW9yUG9pbnQoKTt9XG5yZXR1cm4gdGhpcy5jcmVhdGVQb2ludEZyb21JbnRlcm5hbENvb3JkKGludGVyaW9yUHQsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Qm91bmRhcnlEaW1lbnNpb249ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRFbnZlbG9wZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS50b0dlb21ldHJ5KHRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0RW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe2lmKHRoaXMuZW52ZWxvcGU9PT1udWxsKXt0aGlzLmVudmVsb3BlPXRoaXMuY29tcHV0ZUVudmVsb3BlSW50ZXJuYWwoKTt9XG5yZXR1cm4gdGhpcy5lbnZlbG9wZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZGlzam9pbnQ9ZnVuY3Rpb24oZyl7cmV0dXJuIXRoaXMuaW50ZXJzZWN0cyhnKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUudG91Y2hlcz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNUb3VjaGVzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5pc1JlY3RhbmdsZSgpKXtyZXR1cm4ganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMuaW50ZXJzZWN0cyh0aGlzLGcpO31cbmlmKGcuaXNSZWN0YW5nbGUoKSl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLmludGVyc2VjdHMoZyx0aGlzKTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNJbnRlcnNlY3RzKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNyb3NzZXM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMucmVsYXRlKGcpLmlzQ3Jvc3Nlcyh0aGlzLmdldERpbWVuc2lvbigpLGcuZ2V0RGltZW5zaW9uKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS53aXRoaW49ZnVuY3Rpb24oZyl7cmV0dXJuIGcuY29udGFpbnModGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5jb250YWlucyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzUmVjdGFuZ2xlKCkpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMuY29udGFpbnModGhpcyxnKTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNDb250YWlucygpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5vdmVybGFwcz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNPdmVybGFwcyh0aGlzLmdldERpbWVuc2lvbigpLGcuZ2V0RGltZW5zaW9uKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb3ZlcnM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmNvdmVycyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzUmVjdGFuZ2xlKCkpe3JldHVybiB0cnVlO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc0NvdmVycygpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb3ZlcmVkQnk9ZnVuY3Rpb24oZyl7cmV0dXJuIGcuY292ZXJzKHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5yZWxhdGU9ZnVuY3Rpb24oZyxpbnRlcnNlY3Rpb25QYXR0ZXJuKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMucmVsYXRlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxucmV0dXJuIHRoaXMucmVsYXRlMihnKS5tYXRjaGVzKGludGVyc2VjdGlvblBhdHRlcm4pO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5yZWxhdGUyPWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihnKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnJlbGF0ZSh0aGlzLGcpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5lcXVhbHNUb3BvPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5lcXVhbHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMucmVsYXRlKGcpLmlzRXF1YWxzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvKXtpZihvIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5fHxvIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmd8fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb258fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXtyZXR1cm4gdGhpcy5lcXVhbHNFeGFjdChvKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmJ1ZmZlcj1mdW5jdGlvbihkaXN0YW5jZSxxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlKXt2YXIgcGFyYW1zPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycyhxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlKVxucmV0dXJuIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDIodGhpcyxkaXN0YW5jZSxwYXJhbXMpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb252ZXhIdWxsPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsKHRoaXMpLmdldENvbnZleEh1bGwoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYodGhpcy5pc0dlb21ldHJ5Q29sbGVjdGlvbih0aGlzKSl7dmFyIGcyPW90aGVyO31cbnRoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihvdGhlcik7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMsb3RoZXIsanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUudW5pb249ZnVuY3Rpb24ob3RoZXIpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0wKXtyZXR1cm4ganN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnVuaW9uKHRoaXMpO31cbmlmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gb3RoZXIuY2xvbmUoKTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmNsb25lKCk7fVxudGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKG90aGVyKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AodGhpcyxvdGhlcixqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5VTklPTik7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmRpZmZlcmVuY2U9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuY2xvbmUoKTt9XG50aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpO3RoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24ob3RoZXIpO3JldHVybiBqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcElmTmVlZGVkT3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLG90aGVyLGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLkRJRkZFUkVOQ0UpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5zeW1EaWZmZXJlbmNlPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG90aGVyLmNsb25lKCk7fVxuaWYob3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5jbG9uZSgpO31cbnRoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihvdGhlcik7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMsb3RoZXIsanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuU1lNRElGRkVSRU5DRSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWxzTm9ybT1mdW5jdGlvbihnKXtpZihnPT09bnVsbHx8Zz09PXVuZGVmaW5lZClcbnJldHVybiBmYWxzZTtyZXR1cm4gdGhpcy5ub3JtKCkuZXF1YWxzRXhhY3QoZy5ub3JtKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUubm9ybT1mdW5jdGlvbigpe3ZhciBjb3B5PXRoaXMuY2xvbmUoKTtjb3B5Lm5vcm1hbGl6ZSgpO3JldHVybiBjb3B5O307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24obyl7dmFyIG90aGVyPW87aWYodGhpcy5nZXRDbGFzc1NvcnRJbmRleCgpIT09b3RoZXIuZ2V0Q2xhc3NTb3J0SW5kZXgoKSl7cmV0dXJuIHRoaXMuZ2V0Q2xhc3NTb3J0SW5kZXgoKS1vdGhlci5nZXRDbGFzc1NvcnRJbmRleCgpO31cbmlmKHRoaXMuaXNFbXB0eSgpJiZvdGhlci5pc0VtcHR5KCkpe3JldHVybiAwO31cbmlmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4tMTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiAxO31cbnJldHVybiB0aGlzLmNvbXBhcmVUb1NhbWVDbGFzcyhvKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNFcXVpdmFsZW50Q2xhc3M9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQmJm90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24mJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKSl7cmV0dXJuIHRydWU7fWVsc2UgaWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50JiYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludCkpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nJiYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKSl7cmV0dXJuIHRydWU7fWVsc2UgaWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24mJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbiYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbikpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZyl7aWYoZy5pc0dlb21ldHJ5Q29sbGVjdGlvbkJhc2UoKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1RoaXMgbWV0aG9kIGRvZXMgbm90IHN1cHBvcnQgR2VvbWV0cnlDb2xsZWN0aW9uJyk7fX07anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc0dlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbigpe3JldHVybih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbik7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzR2VvbWV0cnlDb2xsZWN0aW9uQmFzZT1mdW5jdGlvbigpe3JldHVybih0aGlzLkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbicpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXBhcmVUb1NhbWVDbGFzcz1mdW5jdGlvbihvKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jb21wYXJlPWZ1bmN0aW9uKGEsYil7dmFyIGk9YS5pdGVyYXRvcigpO3ZhciBqPWIuaXRlcmF0b3IoKTt3aGlsZShpLmhhc05leHQoKSYmai5oYXNOZXh0KCkpe3ZhciBhRWxlbWVudD1pLm5leHQoKTt2YXIgYkVsZW1lbnQ9ai5uZXh0KCk7dmFyIGNvbXBhcmlzb249YUVsZW1lbnQuY29tcGFyZVRvKGJFbGVtZW50KTtpZihjb21wYXJpc29uIT09MCl7cmV0dXJuIGNvbXBhcmlzb247fX1cbmlmKGkuaGFzTmV4dCgpKXtyZXR1cm4gMTt9XG5pZihqLmhhc05leHQoKSl7cmV0dXJuLTE7fVxucmV0dXJuIDA7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsPWZ1bmN0aW9uKGEsYix0b2xlcmFuY2Upe2lmKHRvbGVyYW5jZT09PXVuZGVmaW5lZHx8dG9sZXJhbmNlPT09bnVsbHx8dG9sZXJhbmNlPT09MCl7cmV0dXJuIGEuZXF1YWxzKGIpO31cbnJldHVybiBhLmRpc3RhbmNlKGIpPD10b2xlcmFuY2U7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENsYXNzU29ydEluZGV4PWZ1bmN0aW9uKCl7dmFyIHNvcnRlZENsYXNzZXM9W2pzdHMuZ2VvbS5Qb2ludCxqc3RzLmdlb20uTXVsdGlQb2ludCxqc3RzLmdlb20uTGluZVN0cmluZyxqc3RzLmdlb20uTGluZWFyUmluZyxqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLGpzdHMuZ2VvbS5Qb2x5Z29uLGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24sanN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbl07Zm9yKHZhciBpPTA7aTxzb3J0ZWRDbGFzc2VzLmxlbmd0aDtpKyspe2lmKHRoaXMgaW5zdGFuY2VvZiBzb3J0ZWRDbGFzc2VzW2ldKVxucmV0dXJuIGk7fVxuanN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgnQ2xhc3Mgbm90IHN1cHBvcnRlZDogJyt0aGlzKTtyZXR1cm4tMTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuaW8uV0tUV3JpdGVyKCkud3JpdGUodGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNyZWF0ZVBvaW50RnJvbUludGVybmFsQ29vcmQ9ZnVuY3Rpb24oY29vcmQsZXhlbXBsYXIpe2V4ZW1wbGFyLmdldFByZWNpc2lvbk1vZGVsKCkubWFrZVByZWNpc2UoY29vcmQpO3JldHVybiBleGVtcGxhci5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQoY29vcmQpO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLkNvb3JkaW5hdGU9ZnVuY3Rpb24oeCx5KXtpZih0eXBlb2YgeD09PSdudW1iZXInKXt0aGlzLng9eDt0aGlzLnk9eTt9ZWxzZSBpZih4IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMueD1wYXJzZUZsb2F0KHgueCk7dGhpcy55PXBhcnNlRmxvYXQoeC55KTt9ZWxzZSBpZih4PT09dW5kZWZpbmVkfHx4PT09bnVsbCl7dGhpcy54PTA7dGhpcy55PTA7fWVsc2UgaWYodHlwZW9mIHg9PT0nc3RyaW5nJyl7dGhpcy54PXBhcnNlRmxvYXQoeCk7dGhpcy55PXBhcnNlRmxvYXQoeSk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLnNldENvb3JkaW5hdGU9ZnVuY3Rpb24ob3RoZXIpe3RoaXMueD1vdGhlci54O3RoaXMueT1vdGhlci55O307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLngsdGhpcy55KTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihwKXt2YXIgZHg9dGhpcy54LXAueDt2YXIgZHk9dGhpcy55LXAueTtyZXR1cm4gTWF0aC5zcXJ0KGR4KmR4K2R5KmR5KTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5lcXVhbHMyRD1mdW5jdGlvbihvdGhlcil7aWYodGhpcy54IT09b3RoZXIueCl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMueSE9PW90aGVyLnkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24ob3RoZXIpe2lmKCFvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlfHxvdGhlcj09PXVuZGVmaW5lZCl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLmVxdWFsczJEKG90aGVyKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMueDxvdGhlci54KXtyZXR1cm4tMTt9XG5pZih0aGlzLng+b3RoZXIueCl7cmV0dXJuIDE7fVxuaWYodGhpcy55PG90aGVyLnkpe3JldHVybi0xO31cbmlmKHRoaXMueT5vdGhlci55KXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybicoJyt0aGlzLngrJywgJyt0aGlzLnkrJyknO307fSkoKTtqc3RzLmdlb20uRW52ZWxvcGU9ZnVuY3Rpb24oKXtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5taW54PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5tYXh4PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5taW55PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5tYXh5PW51bGw7anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKCl7aWYodHlwZW9mIGFyZ3VtZW50c1swXT09PSdudW1iZXInJiZhcmd1bWVudHMubGVuZ3RoPT09NCl7dGhpcy5pbml0RnJvbVZhbHVlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSxhcmd1bWVudHNbM10pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUmJmFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUmJmFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmluaXRGcm9tQ29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUmJmFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZXt0aGlzLnNldFRvTnVsbCgpO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21WYWx1ZXM9ZnVuY3Rpb24oeDEseDIseTEseTIpe2lmKHgxPHgyKXt0aGlzLm1pbng9eDE7dGhpcy5tYXh4PXgyO31lbHNle3RoaXMubWlueD14Mjt0aGlzLm1heHg9eDE7fVxuaWYoeTE8eTIpe3RoaXMubWlueT15MTt0aGlzLm1heHk9eTI7fWVsc2V7dGhpcy5taW55PXkyO3RoaXMubWF4eT15MTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXRGcm9tQ29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIpe3RoaXMuaW5pdEZyb21WYWx1ZXMocDEueCxwMi54LHAxLnkscDIueSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXRGcm9tQ29vcmRpbmF0ZT1mdW5jdGlvbihwKXt0aGlzLmluaXRGcm9tVmFsdWVzKHAueCxwLngscC55LHAueSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXRGcm9tRW52ZWxvcGU9ZnVuY3Rpb24oZW52KXt0aGlzLm1pbng9ZW52Lm1pbng7dGhpcy5tYXh4PWVudi5tYXh4O3RoaXMubWlueT1lbnYubWlueTt0aGlzLm1heHk9ZW52Lm1heHk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLnNldFRvTnVsbD1mdW5jdGlvbigpe3RoaXMubWlueD0wO3RoaXMubWF4eD0tMTt0aGlzLm1pbnk9MDt0aGlzLm1heHk9LTE7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmlzTnVsbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heHg8dGhpcy5taW54O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRIZWlnaHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gMDt9XG5yZXR1cm4gdGhpcy5tYXh5LXRoaXMubWlueTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0V2lkdGg9ZnVuY3Rpb24oKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gMDt9XG5yZXR1cm4gdGhpcy5tYXh4LXRoaXMubWlueDt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0TWluWD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1pbng7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldE1heFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXh4O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRNaW5ZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWlueTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0TWF4WT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heHk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldEFyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRXaWR0aCgpKnRoaXMuZ2V0SGVpZ2h0KCk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMuZXhwYW5kVG9JbmNsdWRlQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkVudmVsb3BlKXt0aGlzLmV4cGFuZFRvSW5jbHVkZUVudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5leHBhbmRUb0luY2x1ZGVWYWx1ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGVDb29yZGluYXRlPWZ1bmN0aW9uKHApe3RoaXMuZXhwYW5kVG9JbmNsdWRlVmFsdWVzKHAueCxwLnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGVWYWx1ZXM9ZnVuY3Rpb24oeCx5KXtpZih0aGlzLmlzTnVsbCgpKXt0aGlzLm1pbng9eDt0aGlzLm1heHg9eDt0aGlzLm1pbnk9eTt0aGlzLm1heHk9eTt9ZWxzZXtpZih4PHRoaXMubWlueCl7dGhpcy5taW54PXg7fVxuaWYoeD50aGlzLm1heHgpe3RoaXMubWF4eD14O31cbmlmKHk8dGhpcy5taW55KXt0aGlzLm1pbnk9eTt9XG5pZih5PnRoaXMubWF4eSl7dGhpcy5tYXh5PXk7fX19O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlRW52ZWxvcGU9ZnVuY3Rpb24ob3RoZXIpe2lmKG90aGVyLmlzTnVsbCgpKXtyZXR1cm47fVxuaWYodGhpcy5pc051bGwoKSl7dGhpcy5taW54PW90aGVyLmdldE1pblgoKTt0aGlzLm1heHg9b3RoZXIuZ2V0TWF4WCgpO3RoaXMubWlueT1vdGhlci5nZXRNaW5ZKCk7dGhpcy5tYXh5PW90aGVyLmdldE1heFkoKTt9ZWxzZXtpZihvdGhlci5taW54PHRoaXMubWlueCl7dGhpcy5taW54PW90aGVyLm1pbng7fVxuaWYob3RoZXIubWF4eD50aGlzLm1heHgpe3RoaXMubWF4eD1vdGhlci5tYXh4O31cbmlmKG90aGVyLm1pbnk8dGhpcy5taW55KXt0aGlzLm1pbnk9b3RoZXIubWlueTt9XG5pZihvdGhlci5tYXh5PnRoaXMubWF4eSl7dGhpcy5tYXh5PW90aGVyLm1heHk7fX19O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kQnk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5leHBhbmRCeURpc3RhbmNlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5leHBhbmRCeURpc3RhbmNlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZEJ5RGlzdGFuY2U9ZnVuY3Rpb24oZGlzdGFuY2Upe3RoaXMuZXhwYW5kQnlEaXN0YW5jZXMoZGlzdGFuY2UsZGlzdGFuY2UpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRCeURpc3RhbmNlcz1mdW5jdGlvbihkZWx0YVgsZGVsdGFZKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm47fVxudGhpcy5taW54LT1kZWx0YVg7dGhpcy5tYXh4Kz1kZWx0YVg7dGhpcy5taW55LT1kZWx0YVk7dGhpcy5tYXh5Kz1kZWx0YVk7aWYodGhpcy5taW54PnRoaXMubWF4eHx8dGhpcy5taW55PnRoaXMubWF4eSl7dGhpcy5zZXRUb051bGwoKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLnRyYW5zbGF0ZT1mdW5jdGlvbih0cmFuc1gsdHJhbnNZKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm47fVxudGhpcy5pbml0KHRoaXMubWlueCt0cmFuc1gsdGhpcy5tYXh4K3RyYW5zWCx0aGlzLm1pbnkrdHJhbnNZLHRoaXMubWF4eSt0cmFuc1kpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jZW50cmU9ZnVuY3Rpb24oKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCh0aGlzLm1pbngrdGhpcy5tYXh4KS8yLjAsKHRoaXMubWlueSt0aGlzLm1heHkpLzIuMCk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmludGVyc2VjdGlvbj1mdW5jdGlvbihlbnYpe2lmKHRoaXMuaXNOdWxsKCl8fGVudi5pc051bGwoKXx8IXRoaXMuaW50ZXJzZWN0cyhlbnYpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO31cbnZhciBpbnRNaW5YPXRoaXMubWlueD5lbnYubWlueD90aGlzLm1pbng6ZW52Lm1pbng7dmFyIGludE1pblk9dGhpcy5taW55PmVudi5taW55P3RoaXMubWlueTplbnYubWlueTt2YXIgaW50TWF4WD10aGlzLm1heHg8ZW52Lm1heHg/dGhpcy5tYXh4OmVudi5tYXh4O3ZhciBpbnRNYXhZPXRoaXMubWF4eTxlbnYubWF4eT90aGlzLm1heHk6ZW52Lm1heHk7cmV0dXJuIG5ldyBqc3RzLmdlb20uRW52ZWxvcGUoaW50TWluWCxpbnRNYXhYLGludE1pblksaW50TWF4WSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c0VudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c0Nvb3JkaW5hdGUoYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0c0VudmVsb3BlPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzTnVsbCgpfHxvdGhlci5pc051bGwoKSl7cmV0dXJuIGZhbHNlO31cbnZhciByZXN1bHQ9IShvdGhlci5taW54PnRoaXMubWF4eHx8b3RoZXIubWF4eDx0aGlzLm1pbnh8fG90aGVyLm1pbnk+dGhpcy5tYXh5fHxvdGhlci5tYXh5PHRoaXMubWlueSk7cmV0dXJuIHJlc3VsdDt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0c0Nvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c1ZhbHVlcyhwLngscC55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0c1ZhbHVlcz1mdW5jdGlvbih4LHkpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4hKHg+dGhpcy5tYXh4fHx4PHRoaXMubWlueHx8eT50aGlzLm1heHl8fHk8dGhpcy5taW55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7cmV0dXJuIHRoaXMuY29udGFpbnNFbnZlbG9wZShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLmNvbnRhaW5zQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmNvbnRhaW5zVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY29udGFpbnNFbnZlbG9wZT1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMuY292ZXJzRW52ZWxvcGUob3RoZXIpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWluc0Nvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuY292ZXJzQ29vcmRpbmF0ZShwKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY29udGFpbnNWYWx1ZXM9ZnVuY3Rpb24oeCx5KXtyZXR1cm4gdGhpcy5jb3ZlcnNWYWx1ZXMoeCx5KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY292ZXJzPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUpe3JldHVybiB0aGlzLmNvdmVyc0VudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuY292ZXJzQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmNvdmVyc1ZhbHVlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNvdmVyc1ZhbHVlcz1mdW5jdGlvbih4LHkpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4geD49dGhpcy5taW54JiZ4PD10aGlzLm1heHgmJnk+PXRoaXMubWlueSYmeTw9dGhpcy5tYXh5O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb3ZlcnNDb29yZGluYXRlPWZ1bmN0aW9uKHApe3JldHVybiB0aGlzLmNvdmVyc1ZhbHVlcyhwLngscC55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY292ZXJzRW52ZWxvcGU9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNOdWxsKCl8fG90aGVyLmlzTnVsbCgpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIG90aGVyLm1pbng+PXRoaXMubWlueCYmb3RoZXIubWF4eDw9dGhpcy5tYXh4JiZvdGhlci5taW55Pj10aGlzLm1pbnkmJm90aGVyLm1heHk8PXRoaXMubWF4eTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZGlzdGFuY2U9ZnVuY3Rpb24oZW52KXtpZih0aGlzLmludGVyc2VjdHMoZW52KSl7cmV0dXJuIDA7fVxudmFyIGR4PTAuMDtpZih0aGlzLm1heHg8ZW52Lm1pbngpe2R4PWVudi5taW54LXRoaXMubWF4eDt9XG5pZih0aGlzLm1pbng+ZW52Lm1heHgpe2R4PXRoaXMubWlueC1lbnYubWF4eDt9XG52YXIgZHk9MC4wO2lmKHRoaXMubWF4eTxlbnYubWlueSl7ZHk9ZW52Lm1pbnktdGhpcy5tYXh5O31cbmlmKHRoaXMubWlueT5lbnYubWF4eSl7ZHk9dGhpcy5taW55LWVudi5tYXh5O31cbmlmKGR4PT09MC4wKXtyZXR1cm4gZHk7fVxuaWYoZHk9PT0wLjApe3JldHVybiBkeDt9XG5yZXR1cm4gTWF0aC5zcXJ0KGR4KmR4K2R5KmR5KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLmlzTnVsbCgpKXtyZXR1cm4gb3RoZXIuaXNOdWxsKCk7fVxucmV0dXJuIHRoaXMubWF4eD09PW90aGVyLm1heHgmJnRoaXMubWF4eT09PW90aGVyLm1heHkmJnRoaXMubWlueD09PW90aGVyLm1pbngmJnRoaXMubWlueT09PW90aGVyLm1pbnk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJ0VudlsnK3RoaXMubWlueCsnIDogJyt0aGlzLm1heHgrJywgJyt0aGlzLm1pbnkrJyA6ICcrXG50aGlzLm1heHkrJ10nO307anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHM9ZnVuY3Rpb24ocDEscDIscSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe3JldHVybiBqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0c0VudmVsb3BlKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fVxudmFyIHhjMT1wMS54PHAyLng/cDEueDpwMi54O3ZhciB4YzI9cDEueD5wMi54P3AxLng6cDIueDt2YXIgeWMxPXAxLnk8cDIueT9wMS55OnAyLnk7dmFyIHljMj1wMS55PnAyLnk/cDEueTpwMi55O2lmKCgocS54Pj14YzEpJiYocS54PD14YzIpKSYmKChxLnk+PXljMSkmJihxLnk8PXljMikpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0c0VudmVsb3BlPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgbWlucT1NYXRoLm1pbihxMS54LHEyLngpO3ZhciBtYXhxPU1hdGgubWF4KHExLngscTIueCk7dmFyIG1pbnA9TWF0aC5taW4ocDEueCxwMi54KTt2YXIgbWF4cD1NYXRoLm1heChwMS54LHAyLngpO2lmKG1pbnA+bWF4cSl7cmV0dXJuIGZhbHNlO31cbmlmKG1heHA8bWlucSl7cmV0dXJuIGZhbHNlO31cbm1pbnE9TWF0aC5taW4ocTEueSxxMi55KTttYXhxPU1hdGgubWF4KHExLnkscTIueSk7bWlucD1NYXRoLm1pbihwMS55LHAyLnkpO21heHA9TWF0aC5tYXgocDEueSxwMi55KTtpZihtaW5wPm1heHEpe3JldHVybiBmYWxzZTt9XG5pZihtYXhwPG1pbnEpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLm1pbngsdGhpcy5tYXh4LHRoaXMubWlueSx0aGlzLm1heHkpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lcj1mdW5jdGlvbihnZW9tcyl7dGhpcy5nZW9tRmFjdG9yeT1qc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmV4dHJhY3RGYWN0b3J5KGdlb21zKTt0aGlzLmlucHV0R2VvbXM9Z2VvbXM7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmU9ZnVuY3Rpb24oZ2VvbXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSlyZXR1cm4gdGhpcy5jb21iaW5lMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGNvbWJpbmVyPW5ldyBqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyKGdlb21zKTtyZXR1cm4gY29tYmluZXIuY29tYmluZSgpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lMj1mdW5jdGlvbigpe3ZhciBhcnJheUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLmZvckVhY2goZnVuY3Rpb24oYSl7YXJyYXlMaXN0LmFkZChhKTt9KTt2YXIgY29tYmluZXI9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIoYXJyYXlMaXN0KTtyZXR1cm4gY29tYmluZXIuY29tYmluZSgpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLnByb3RvdHlwZS5za2lwRW1wdHk9ZmFsc2U7anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuaW5wdXRHZW9tcztqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmV4dHJhY3RGYWN0b3J5PWZ1bmN0aW9uKGdlb21zKXtpZihnZW9tcy5pc0VtcHR5KCkpcmV0dXJuIG51bGw7cmV0dXJuIGdlb21zLml0ZXJhdG9yKCkubmV4dCgpLmdldEZhY3RvcnkoKTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIucHJvdG90eXBlLmNvbWJpbmU9ZnVuY3Rpb24oKXt2YXIgZWxlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKSxpO2ZvcihpPXRoaXMuaW5wdXRHZW9tcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGc9aS5uZXh0KCk7dGhpcy5leHRyYWN0RWxlbWVudHMoZyxlbGVtcyk7fVxuaWYoZWxlbXMuc2l6ZSgpPT09MCl7aWYodGhpcy5nZW9tRmFjdG9yeSE9PW51bGwpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5yZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5idWlsZEdlb21ldHJ5KGVsZW1zKTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIucHJvdG90eXBlLmV4dHJhY3RFbGVtZW50cz1mdW5jdGlvbihnZW9tLGVsZW1zKXtpZihnZW9tPT09bnVsbCl7cmV0dXJuO31cbmZvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZWxlbUdlb209Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYodGhpcy5za2lwRW1wdHkmJmVsZW1HZW9tLmlzRW1wdHkoKSl7Y29udGludWU7fVxuZWxlbXMuYWRkKGVsZW1HZW9tKTt9fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24obW9kZWxUeXBlKXtpZih0eXBlb2YgbW9kZWxUeXBlPT09J251bWJlcicpe3RoaXMubW9kZWxUeXBlPWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRDt0aGlzLnNjYWxlPW1vZGVsVHlwZTtyZXR1cm47fVxudGhpcy5tb2RlbFR5cGU9bW9kZWxUeXBlfHxqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRkxPQVRJTkc7aWYodGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRklYRUQpe3RoaXMuc2NhbGU9MS4wO319O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElORz0nRkxPQVRJTkcnO2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRD0nRklYRUQnO2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElOR19TSU5HTEU9J0ZMT0FUSU5HX1NJTkdMRSc7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5zY2FsZT1udWxsO2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUubW9kZWxUeXBlPW51bGw7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5pc0Zsb2F0aW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HfHx0aGlzLm1vZGVsVHlwZT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElOR19TSU5MR0U7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmdldFNjYWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2NhbGU7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbFR5cGU7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRydWU7aWYoIShvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbCkpe3JldHVybiBmYWxzZTt9XG52YXIgb3RoZXJQcmVjaXNpb25Nb2RlbD1vdGhlcjtyZXR1cm4gdGhpcy5tb2RlbFR5cGU9PT1vdGhlclByZWNpc2lvbk1vZGVsLm1vZGVsVHlwZSYmdGhpcy5zY2FsZT09PW90aGVyUHJlY2lzaW9uTW9kZWwuc2NhbGU7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLm1ha2VQcmVjaXNlPWZ1bmN0aW9uKHZhbCl7aWYodmFsIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMubWFrZVByZWNpc2UyKHZhbCk7cmV0dXJuO31cbmlmKGlzTmFOKHZhbCkpXG5yZXR1cm4gdmFsO2lmKHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXtyZXR1cm4gTWF0aC5yb3VuZCh2YWwqdGhpcy5zY2FsZSkvdGhpcy5zY2FsZTt9XG5yZXR1cm4gdmFsO307anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5tYWtlUHJlY2lzZTI9ZnVuY3Rpb24oY29vcmQpe2lmKHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HKVxucmV0dXJuO2Nvb3JkLng9dGhpcy5tYWtlUHJlY2lzZShjb29yZC54KTtjb29yZC55PXRoaXMubWFrZVByZWNpc2UoY29vcmQueSk7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvKXt2YXIgb3RoZXI9bztyZXR1cm4gMDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGNvb3JkKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyPWZ1bmN0aW9uKHB0cyl7dGhpcy5wdHM9cHRzO3RoaXMuc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUucHRzPW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS51c2VQdD1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZGlzdGFuY2VUb2xlcmFuY2U9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIuc2ltcGxpZnk9ZnVuY3Rpb24ocHRzLGRpc3RhbmNlVG9sZXJhbmNlKXt2YXIgc2ltcD1uZXcganN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyKHB0cyk7c2ltcC5zZXREaXN0YW5jZVRvbGVyYW5jZShkaXN0YW5jZVRvbGVyYW5jZSk7cmV0dXJuIHNpbXAuc2ltcGxpZnkoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2V0RGlzdGFuY2VUb2xlcmFuY2U9ZnVuY3Rpb24oZGlzdGFuY2VUb2xlcmFuY2Upe3RoaXMuZGlzdGFuY2VUb2xlcmFuY2U9ZGlzdGFuY2VUb2xlcmFuY2U7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7dGhpcy51c2VQdD1bXTtmb3IodmFyIGk9MDtpPHRoaXMucHRzLmxlbmd0aDtpKyspe3RoaXMudXNlUHRbaV09dHJ1ZTt9XG50aGlzLnNpbXBsaWZ5U2VjdGlvbigwLHRoaXMucHRzLmxlbmd0aC0xKTt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoKTtmb3IodmFyIGo9MDtqPHRoaXMucHRzLmxlbmd0aDtqKyspe2lmKHRoaXMudXNlUHRbal0pe2Nvb3JkTGlzdC5hZGQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMucHRzW2pdKSk7fX1cbnJldHVybiBjb29yZExpc3QudG9Db29yZGluYXRlQXJyYXkoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2VnPW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5zaW1wbGlmeVNlY3Rpb249ZnVuY3Rpb24oaSxqKXtpZihpKzE9PWope3JldHVybjt9XG50aGlzLnNlZy5wMD10aGlzLnB0c1tpXTt0aGlzLnNlZy5wMT10aGlzLnB0c1tqXTt2YXIgbWF4RGlzdGFuY2U9LTEuMDt2YXIgbWF4SW5kZXg9aTtmb3IodmFyIGs9aSsxO2s8ajtrKyspe3ZhciBkaXN0YW5jZT10aGlzLnNlZy5kaXN0YW5jZSh0aGlzLnB0c1trXSk7aWYoZGlzdGFuY2U+bWF4RGlzdGFuY2Upe21heERpc3RhbmNlPWRpc3RhbmNlO21heEluZGV4PWs7fX1cbmlmKG1heERpc3RhbmNlPD10aGlzLmRpc3RhbmNlVG9sZXJhbmNlKXtmb3IodmFyIGw9aSsxO2w8ajtsKyspe3RoaXMudXNlUHRbbF09ZmFsc2U7fX1lbHNle3RoaXMuc2ltcGxpZnlTZWN0aW9uKGksbWF4SW5kZXgpO3RoaXMuc2ltcGxpZnlTZWN0aW9uKG1heEluZGV4LGopO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb249ZnVuY3Rpb24oY29vcmQsc2VnbWVudEluZGV4LGRpc3Qpe3RoaXMuY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3JkKTt0aGlzLnNlZ21lbnRJbmRleD1zZWdtZW50SW5kZXg7dGhpcy5kaXN0PWRpc3Q7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5jb29yZD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLnNlZ21lbnRJbmRleD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmRpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5nZXRTZWdtZW50SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWdtZW50SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5nZXREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3Q7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLmNvbXBhcmUob3RoZXIuc2VnbWVudEluZGV4LG90aGVyLmRpc3QpO307anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbihzZWdtZW50SW5kZXgsZGlzdCl7aWYodGhpcy5zZWdtZW50SW5kZXg8c2VnbWVudEluZGV4KVxucmV0dXJuLTE7aWYodGhpcy5zZWdtZW50SW5kZXg+c2VnbWVudEluZGV4KVxucmV0dXJuIDE7aWYodGhpcy5kaXN0PGRpc3QpXG5yZXR1cm4tMTtpZih0aGlzLmRpc3Q+ZGlzdClcbnJldHVybiAxO3JldHVybiAwO307anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuaXNFbmRQb2ludD1mdW5jdGlvbihtYXhTZWdtZW50SW5kZXgpe2lmKHRoaXMuc2VnbWVudEluZGV4PT09MCYmdGhpcy5kaXN0PT09MC4wKVxucmV0dXJuIHRydWU7aWYodGhpcy5zZWdtZW50SW5kZXg9PT1tYXhTZWdtZW50SW5kZXgpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybicnK3RoaXMuc2VnbWVudEluZGV4K3RoaXMuZGlzdDt9OyhmdW5jdGlvbigpe3ZhciBFZGdlSW50ZXJzZWN0aW9uPWpzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb247dmFyIFRyZWVNYXA9amF2YXNjcmlwdC51dGlsLlRyZWVNYXA7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3Q9ZnVuY3Rpb24oZWRnZSl7dGhpcy5ub2RlTWFwPW5ldyBUcmVlTWFwKCk7dGhpcy5lZGdlPWVkZ2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUubm9kZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5lZGdlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmlzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHB0KXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZWk9aXQubmV4dCgpO2lmKGVpLmNvb3JkLmVxdWFscyhwdCkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGludFB0LHNlZ21lbnRJbmRleCxkaXN0KXt2YXIgZWlOZXc9bmV3IEVkZ2VJbnRlcnNlY3Rpb24oaW50UHQsc2VnbWVudEluZGV4LGRpc3QpO3ZhciBlaT10aGlzLm5vZGVNYXAuZ2V0KGVpTmV3KTtpZihlaSE9PW51bGwpe3JldHVybiBlaTt9XG50aGlzLm5vZGVNYXAucHV0KGVpTmV3LGVpTmV3KTtyZXR1cm4gZWlOZXc7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuYWRkRW5kcG9pbnRzPWZ1bmN0aW9uKCl7dmFyIG1heFNlZ0luZGV4PXRoaXMuZWRnZS5wdHMubGVuZ3RoLTE7dGhpcy5hZGQodGhpcy5lZGdlLnB0c1swXSwwLDAuMCk7dGhpcy5hZGQodGhpcy5lZGdlLnB0c1ttYXhTZWdJbmRleF0sbWF4U2VnSW5kZXgsMC4wKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5hZGRTcGxpdEVkZ2VzPWZ1bmN0aW9uKGVkZ2VMaXN0KVxue3RoaXMuYWRkRW5kcG9pbnRzKCk7dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTt2YXIgZWlQcmV2PWl0Lm5leHQoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBlaT1pdC5uZXh0KCk7dmFyIG5ld0VkZ2U9dGhpcy5jcmVhdGVTcGxpdEVkZ2UoZWlQcmV2LGVpKTtlZGdlTGlzdC5hZGQobmV3RWRnZSk7ZWlQcmV2PWVpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5jcmVhdGVTcGxpdEVkZ2U9ZnVuY3Rpb24oZWkwLGVpMSl7dmFyIG5wdHM9ZWkxLnNlZ21lbnRJbmRleC1laTAuc2VnbWVudEluZGV4KzI7dmFyIGxhc3RTZWdTdGFydFB0PXRoaXMuZWRnZS5wdHNbZWkxLnNlZ21lbnRJbmRleF07dmFyIHVzZUludFB0MT1laTEuZGlzdD4wLjB8fCFlaTEuY29vcmQuZXF1YWxzMkQobGFzdFNlZ1N0YXJ0UHQpO2lmKCF1c2VJbnRQdDEpe25wdHMtLTt9XG52YXIgcHRzPVtdO3ZhciBpcHQ9MDtwdHNbaXB0KytdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlaTAuY29vcmQpO2Zvcih2YXIgaT1laTAuc2VnbWVudEluZGV4KzE7aTw9ZWkxLnNlZ21lbnRJbmRleDtpKyspe3B0c1tpcHQrK109dGhpcy5lZGdlLnB0c1tpXTt9XG5pZih1c2VJbnRQdDEpcHRzW2lwdF09ZWkxLmNvb3JkO3JldHVybiBuZXcganN0cy5nZW9tZ3JhcGguRWRnZShwdHMsbmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKHRoaXMuZWRnZS5sYWJlbCkpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubWVzc2FnZT1tZXNzYWdlO307QXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24ucHJvdG90eXBlLm5hbWU9J0Fzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbic7anN0cy51dGlsLkFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbj1Bc3NlcnRpb25GYWlsZWRFeGNlcHRpb247fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uPWpzdHMudXRpbC5Bc3NlcnRpb25GYWlsZWRFeGNlcHRpb247anN0cy51dGlsLkFzc2VydD1mdW5jdGlvbigpe307anN0cy51dGlsLkFzc2VydC5pc1RydWU9ZnVuY3Rpb24oYXNzZXJ0aW9uLG1lc3NhZ2Upe2lmKCFhc3NlcnRpb24pe2lmKG1lc3NhZ2U9PT1udWxsKXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKCk7fWVsc2V7dGhyb3cgbmV3IEFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbihtZXNzYWdlKTt9fX07anN0cy51dGlsLkFzc2VydC5lcXVhbHM9ZnVuY3Rpb24oZXhwZWN0ZWRWYWx1ZSxhY3R1YWxWYWx1ZSxtZXNzYWdlKXtpZighYWN0dWFsVmFsdWUuZXF1YWxzKGV4cGVjdGVkVmFsdWUpKXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKCdFeHBlY3RlZCAnK2V4cGVjdGVkVmFsdWUrJyBidXQgZW5jb3VudGVyZWQgJythY3R1YWxWYWx1ZStcbihtZXNzYWdlIT1udWxsPyc6ICcrbWVzc2FnZTonJykpO319O2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmU9ZnVuY3Rpb24obWVzc2FnZSl7dGhyb3cgbmV3IEFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbignU2hvdWxkIG5ldmVyIHJlYWNoIGhlcmUnK1xuKG1lc3NhZ2UhPW51bGw/JzogJyttZXNzYWdlOicnKSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXI9ZnVuY3Rpb24oYXJnKXt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLnB0TG9jYXRvcj1uZXcganN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yKCk7dGhpcy5ub2Rlcz1uZXcganN0cy5nZW9tZ3JhcGguTm9kZU1hcChuZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVGYWN0b3J5KCkpO3RoaXMuaXNvbGF0ZWRFZGdlcz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5hcmc9YXJnO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUucHRMb2NhdG9yPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5hcmc9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLm5vZGVzPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5pbT1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuaXNvbGF0ZWRFZGdlcz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuaW52YWxpZFBvaW50PW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oKXt2YXIgaW09bmV3IGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgoKTtpbS5zZXQoTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uRVhURVJJT1IsMik7aWYoIXRoaXMuYXJnWzBdLmdldEdlb21ldHJ5KCkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHModGhpcy5hcmdbMV0uZ2V0R2VvbWV0cnkoKS5nZXRFbnZlbG9wZUludGVybmFsKCkpKXt0aGlzLmNvbXB1dGVEaXNqb2ludElNKGltKTtyZXR1cm4gaW07fVxudGhpcy5hcmdbMF0uY29tcHV0ZVNlbGZOb2Rlcyh0aGlzLmxpLGZhbHNlKTt0aGlzLmFyZ1sxXS5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksZmFsc2UpO3ZhciBpbnRlcnNlY3Rvcj10aGlzLmFyZ1swXS5jb21wdXRlRWRnZUludGVyc2VjdGlvbnModGhpcy5hcmdbMV0sdGhpcy5saSxmYWxzZSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXMoMCk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXMoMSk7dGhpcy5jb3B5Tm9kZXNBbmRMYWJlbHMoMCk7dGhpcy5jb3B5Tm9kZXNBbmRMYWJlbHMoMSk7dGhpcy5sYWJlbElzb2xhdGVkTm9kZXMoKTt0aGlzLmNvbXB1dGVQcm9wZXJJbnRlcnNlY3Rpb25JTShpbnRlcnNlY3RvcixpbSk7dmFyIGVlQnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyKCk7dmFyIGVlMD1lZUJ1aWxkZXIuY29tcHV0ZUVkZ2VFbmRzKHRoaXMuYXJnWzBdLmdldEVkZ2VJdGVyYXRvcigpKTt0aGlzLmluc2VydEVkZ2VFbmRzKGVlMCk7dmFyIGVlMT1lZUJ1aWxkZXIuY29tcHV0ZUVkZ2VFbmRzKHRoaXMuYXJnWzFdLmdldEVkZ2VJdGVyYXRvcigpKTt0aGlzLmluc2VydEVkZ2VFbmRzKGVlMSk7dGhpcy5sYWJlbE5vZGVFZGdlcygpO3RoaXMubGFiZWxJc29sYXRlZEVkZ2VzKDAsMSk7dGhpcy5sYWJlbElzb2xhdGVkRWRnZXMoMSwwKTt0aGlzLnVwZGF0ZUlNKGltKTtyZXR1cm4gaW07fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmluc2VydEVkZ2VFbmRzPWZ1bmN0aW9uKGVlKXtmb3IodmFyIGk9ZWUuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3RoaXMubm9kZXMuYWRkKGUpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuY29tcHV0ZVByb3BlckludGVyc2VjdGlvbklNPWZ1bmN0aW9uKGludGVyc2VjdG9yLGltKXt2YXIgZGltQT10aGlzLmFyZ1swXS5nZXRHZW9tZXRyeSgpLmdldERpbWVuc2lvbigpO3ZhciBkaW1CPXRoaXMuYXJnWzFdLmdldEdlb21ldHJ5KCkuZ2V0RGltZW5zaW9uKCk7dmFyIGhhc1Byb3Blcj1pbnRlcnNlY3Rvci5oYXNQcm9wZXJJbnRlcnNlY3Rpb24oKTt2YXIgaGFzUHJvcGVySW50ZXJpb3I9aW50ZXJzZWN0b3IuaGFzUHJvcGVySW50ZXJpb3JJbnRlcnNlY3Rpb24oKTtpZihkaW1BPT09MiYmZGltQj09PTIpe2lmKGhhc1Byb3BlcilcbmltLnNldEF0TGVhc3QoJzIxMjEwMTIxMicpO31cbmVsc2UgaWYoZGltQT09PTImJmRpbUI9PT0xKXtpZihoYXNQcm9wZXIpXG5pbS5zZXRBdExlYXN0KCdGRkYwRkZGRjInKTtpZihoYXNQcm9wZXJJbnRlcmlvcilcbmltLnNldEF0TGVhc3QoJzFGRkZGRjFGRicpO31lbHNlIGlmKGRpbUE9PT0xJiZkaW1CPT09Mil7aWYoaGFzUHJvcGVyKVxuaW0uc2V0QXRMZWFzdCgnRjBGRkZGRkYyJyk7aWYoaGFzUHJvcGVySW50ZXJpb3IpXG5pbS5zZXRBdExlYXN0KCcxRjFGRkZGRkYnKTt9XG5lbHNlIGlmKGRpbUE9PT0xJiZkaW1CPT09MSl7aWYoaGFzUHJvcGVySW50ZXJpb3IpXG5pbS5zZXRBdExlYXN0KCcwRkZGRkZGRkYnKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvcHlOb2Rlc0FuZExhYmVscz1mdW5jdGlvbihhcmdJbmRleCl7Zm9yKHZhciBpPXRoaXMuYXJnW2FyZ0luZGV4XS5nZXROb2RlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBncmFwaE5vZGU9aS5uZXh0KCk7dmFyIG5ld05vZGU9dGhpcy5ub2Rlcy5hZGROb2RlKGdyYXBoTm9kZS5nZXRDb29yZGluYXRlKCkpO25ld05vZGUuc2V0TGFiZWwoYXJnSW5kZXgsZ3JhcGhOb2RlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihhcmdJbmRleCl7Zm9yKHZhciBpPXRoaXMuYXJnW2FyZ0luZGV4XS5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3ZhciBlTG9jPWUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCk7Zm9yKHZhciBlaUl0PWUuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKS5pdGVyYXRvcigpO2VpSXQuaGFzTmV4dCgpOyl7dmFyIGVpPWVpSXQubmV4dCgpO3ZhciBuPXRoaXMubm9kZXMuYWRkTm9kZShlaS5jb29yZCk7aWYoZUxvYz09PUxvY2F0aW9uLkJPVU5EQVJZKVxubi5zZXRMYWJlbEJvdW5kYXJ5KGFyZ0luZGV4KTtlbHNle2lmKG4uZ2V0TGFiZWwoKS5pc051bGwoYXJnSW5kZXgpKVxubi5zZXRMYWJlbChhcmdJbmRleCxMb2NhdGlvbi5JTlRFUklPUik7fX19fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oYXJnSW5kZXgpe2Zvcih2YXIgaT10aGlzLmFyZ1thcmdJbmRleF0uZ2V0RWRnZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgZUxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO2Zvcih2YXIgZWlJdD1lLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCkuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTt2YXIgbj10aGlzLm5vZGVzLmZpbmQoZWkuY29vcmQpO2lmKG4uZ2V0TGFiZWwoKS5pc051bGwoYXJnSW5kZXgpKXtpZihlTG9jPT09TG9jYXRpb24uQk9VTkRBUlkpXG5uLnNldExhYmVsQm91bmRhcnkoYXJnSW5kZXgpO2Vsc2Vcbm4uc2V0TGFiZWwoYXJnSW5kZXgsTG9jYXRpb24uSU5URVJJT1IpO319fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5jb21wdXRlRGlzam9pbnRJTT1mdW5jdGlvbihpbSl7dmFyIGdhPXRoaXMuYXJnWzBdLmdldEdlb21ldHJ5KCk7aWYoIWdhLmlzRW1wdHkoKSl7aW0uc2V0KExvY2F0aW9uLklOVEVSSU9SLExvY2F0aW9uLkVYVEVSSU9SLGdhLmdldERpbWVuc2lvbigpKTtpbS5zZXQoTG9jYXRpb24uQk9VTkRBUlksTG9jYXRpb24uRVhURVJJT1IsZ2EuZ2V0Qm91bmRhcnlEaW1lbnNpb24oKSk7fVxudmFyIGdiPXRoaXMuYXJnWzFdLmdldEdlb21ldHJ5KCk7aWYoIWdiLmlzRW1wdHkoKSl7aW0uc2V0KExvY2F0aW9uLkVYVEVSSU9SLExvY2F0aW9uLklOVEVSSU9SLGdiLmdldERpbWVuc2lvbigpKTtpbS5zZXQoTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uQk9VTkRBUlksZ2IuZ2V0Qm91bmRhcnlEaW1lbnNpb24oKSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbE5vZGVFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgbmk9dGhpcy5ub2Rlcy5pdGVyYXRvcigpO25pLmhhc05leHQoKTspe3ZhciBub2RlPW5pLm5leHQoKTtub2RlLmdldEVkZ2VzKCkuY29tcHV0ZUxhYmVsbGluZyh0aGlzLmFyZyk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7Zm9yKHZhciBlaT10aGlzLmlzb2xhdGVkRWRnZXMuaXRlcmF0b3IoKTtlaS5oYXNOZXh0KCk7KXt2YXIgZT1laS5uZXh0KCk7ZS51cGRhdGVJTShpbSk7fVxuZm9yKHZhciBuaT10aGlzLm5vZGVzLml0ZXJhdG9yKCk7bmkuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bmkubmV4dCgpO25vZGUudXBkYXRlSU0oaW0pO25vZGUudXBkYXRlSU1Gcm9tRWRnZXMoaW0pO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZEVkZ2VzPWZ1bmN0aW9uKHRoaXNJbmRleCx0YXJnZXRJbmRleCl7Zm9yKHZhciBlaT10aGlzLmFyZ1t0aGlzSW5kZXhdLmdldEVkZ2VJdGVyYXRvcigpO2VpLmhhc05leHQoKTspe3ZhciBlPWVpLm5leHQoKTtpZihlLmlzSXNvbGF0ZWQoKSl7dGhpcy5sYWJlbElzb2xhdGVkRWRnZShlLHRhcmdldEluZGV4LHRoaXMuYXJnW3RhcmdldEluZGV4XS5nZXRHZW9tZXRyeSgpKTt0aGlzLmlzb2xhdGVkRWRnZXMuYWRkKGUpO319fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWRFZGdlPWZ1bmN0aW9uKGUsdGFyZ2V0SW5kZXgsdGFyZ2V0KXtpZih0YXJnZXQuZ2V0RGltZW5zaW9uKCk+MCl7dmFyIGxvYz10aGlzLnB0TG9jYXRvci5sb2NhdGUoZS5nZXRDb29yZGluYXRlKCksdGFyZ2V0KTtlLmdldExhYmVsKCkuc2V0QWxsTG9jYXRpb25zKHRhcmdldEluZGV4LGxvYyk7fWVsc2V7ZS5nZXRMYWJlbCgpLnNldEFsbExvY2F0aW9ucyh0YXJnZXRJbmRleCxMb2NhdGlvbi5FWFRFUklPUik7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkTm9kZXM9ZnVuY3Rpb24oKXtmb3IodmFyIG5pPXRoaXMubm9kZXMuaXRlcmF0b3IoKTtuaS5oYXNOZXh0KCk7KXt2YXIgbj1uaS5uZXh0KCk7dmFyIGxhYmVsPW4uZ2V0TGFiZWwoKTtBc3NlcnQuaXNUcnVlKGxhYmVsLmdldEdlb21ldHJ5Q291bnQoKT4wLCdub2RlIHdpdGggZW1wdHkgbGFiZWwgZm91bmQnKTtpZihuLmlzSXNvbGF0ZWQoKSl7aWYobGFiZWwuaXNOdWxsKDApKVxudGhpcy5sYWJlbElzb2xhdGVkTm9kZShuLDApO2Vsc2VcbnRoaXMubGFiZWxJc29sYXRlZE5vZGUobiwxKTt9fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkTm9kZT1mdW5jdGlvbihuLHRhcmdldEluZGV4KXt2YXIgbG9jPXRoaXMucHRMb2NhdG9yLmxvY2F0ZShuLmdldENvb3JkaW5hdGUoKSx0aGlzLmFyZ1t0YXJnZXRJbmRleF0uZ2V0R2VvbWV0cnkoKSk7bi5nZXRMYWJlbCgpLnNldEFsbExvY2F0aW9ucyh0YXJnZXRJbmRleCxsb2MpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQ9ZnVuY3Rpb24obGFiZWwpe3RoaXMubGFiZWw9bGFiZWw7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUubGFiZWw9bnVsbDtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzSW5SZXN1bHQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc0NvdmVyZWQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc0NvdmVyZWRTZXQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc1Zpc2l0ZWQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmdldExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0TGFiZWw9ZnVuY3Rpb24obGFiZWwpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnNldExhYmVsMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMubGFiZWw9bGFiZWw7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0SW5SZXN1bHQ9ZnVuY3Rpb24oaXNJblJlc3VsdCl7dGhpcy5faXNJblJlc3VsdD1pc0luUmVzdWx0O307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzSW5SZXN1bHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJblJlc3VsdDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRDb3ZlcmVkPWZ1bmN0aW9uKGlzQ292ZXJlZCl7dGhpcy5faXNDb3ZlcmVkPWlzQ292ZXJlZDt0aGlzLl9pc0NvdmVyZWRTZXQ9dHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc0NvdmVyZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNDb3ZlcmVkO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzQ292ZXJlZFNldD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0NvdmVyZWRTZXQ7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNWaXNpdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRWaXNpdGVkPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5faXNWaXNpdGVkPWlzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oaW0pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNJc29sYXRlZD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUudXBkYXRlSU09ZnVuY3Rpb24oaW0pe0Fzc2VydC5pc1RydWUodGhpcy5sYWJlbC5nZXRHZW9tZXRyeUNvdW50KCk+PTIsJ2ZvdW5kIHBhcnRpYWwgbGFiZWwnKTt0aGlzLmNvbXB1dGVJTShpbSk7fTt9KSgpO2pzdHMuZ2VvbWdyYXBoLk5vZGU9ZnVuY3Rpb24oY29vcmQsZWRnZXMpe3RoaXMuY29vcmQ9Y29vcmQ7dGhpcy5lZGdlcz1lZGdlczt0aGlzLmxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbCgwLGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudCgpO2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmNvb3JkPW51bGw7anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5pc0lzb2xhdGVkPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubGFiZWwuZ2V0R2VvbWV0cnlDb3VudCgpPT0xKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLnNldExhYmVsMj1mdW5jdGlvbihhcmdJbmRleCxvbkxvY2F0aW9uKXtpZih0aGlzLmxhYmVsPT09bnVsbCl7dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoYXJnSW5kZXgsb25Mb2NhdGlvbik7fWVsc2VcbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oYXJnSW5kZXgsb25Mb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5zZXRMYWJlbEJvdW5kYXJ5PWZ1bmN0aW9uKGFyZ0luZGV4KXt2YXIgbG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO2lmKHRoaXMubGFiZWwhPT1udWxsKVxubG9jPXRoaXMubGFiZWwuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO3ZhciBuZXdMb2M7c3dpdGNoKGxvYyl7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk6bmV3TG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjticmVhaztjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjpuZXdMb2M9anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2JyZWFrO2RlZmF1bHQ6bmV3TG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTticmVhazt9XG50aGlzLmxhYmVsLnNldExvY2F0aW9uKGFyZ0luZGV4LG5ld0xvYyk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSl7dGhpcy5lZGdlcy5pbnNlcnQoZSk7ZS5zZXROb2RlKHRoaXMpO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvb3JkO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmlzSW5jaWRlbnRFZGdlSW5SZXN1bHQ9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZ2V0RWRnZXMoKS5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtpZihkZS5nZXRFZGdlKCkuaXNJblJlc3VsdCgpKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLlBvaW50PWZ1bmN0aW9uKGNvb3JkaW5hdGUsZmFjdG9yeSl7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7aWYoY29vcmRpbmF0ZT09PXVuZGVmaW5lZClcbnJldHVybjt0aGlzLmNvb3JkaW5hdGU9Y29vcmRpbmF0ZTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeSgpO2pzdHMuZ2VvbS5Qb2ludC5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uUG9pbnQ7anN0cy5nZW9tLlBvaW50LkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5Qb2ludCc7anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jb29yZGluYXRlPW51bGw7anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRYPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZS54O307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZS55O307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VtcHR5KCk/W106W3RoaXMuY29vcmRpbmF0ZV07fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldENvb3JkaW5hdGVTZXF1ZW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW1wdHkoKT9bXTpbdGhpcy5jb29yZGluYXRlXTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvb3JkaW5hdGU9PT1udWxsO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNFbXB0eSgpJiZvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0cnVlO31cbnJldHVybiB0aGlzLmVxdWFsKG90aGVyLmdldENvb3JkaW5hdGUoKSx0aGlzLmdldENvb3JkaW5hdGUoKSx0b2xlcmFuY2UpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VtcHR5KCk/MDoxO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5pc1NpbXBsZT1mdW5jdGlvbigpe3JldHVybiB0cnVlO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuY29tcHV0ZUVudmVsb3BlSW50ZXJuYWw9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmNvb3JkaW5hdGUpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcnx8ZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO31lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuO31cbmZpbHRlci5maWx0ZXIodGhpcy5nZXRDb29yZGluYXRlKCkpO319O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Qb2ludCh0aGlzLmNvb3JkaW5hdGUuY2xvbmUoKSx0aGlzLmZhY3RvcnkpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4gMDt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0Qm91bmRhcnlEaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUucmV2ZXJzZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNsb25lKCk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXtpZighanN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmlzVmFsaWQodGhpcy5nZXRDb29yZGluYXRlKCkpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jb21wYXJlVG9TYW1lQ2xhc3M9ZnVuY3Rpb24ob3RoZXIpe3ZhciBwb2ludD1vdGhlcjtyZXR1cm4gdGhpcy5nZXRDb29yZGluYXRlKCkuY29tcGFyZVRvKHBvaW50LmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidQb2ludCc7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmhhc2hDb2RlPWZ1bmN0aW9uKCl7cmV0dXJuJ1BvaW50XycrdGhpcy5jb29yZGluYXRlLmhhc2hDb2RlKCk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5Qb2ludCc7anN0cy5nZW9tLkRpbWVuc2lvbj1mdW5jdGlvbigpe307anN0cy5nZW9tLkRpbWVuc2lvbi5QPTA7anN0cy5nZW9tLkRpbWVuc2lvbi5MPTE7anN0cy5nZW9tLkRpbWVuc2lvbi5BPTI7anN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRT0tMTtqc3RzLmdlb20uRGltZW5zaW9uLlRSVUU9LTI7anN0cy5nZW9tLkRpbWVuc2lvbi5ET05UQ0FSRT0tMztqc3RzLmdlb20uRGltZW5zaW9uLnRvRGltZW5zaW9uU3ltYm9sPWZ1bmN0aW9uKGRpbWVuc2lvblZhbHVlKXtzd2l0Y2goZGltZW5zaW9uVmFsdWUpe2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTpyZXR1cm4nRic7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLlRSVUU6cmV0dXJuJ1QnO2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5ET05UQ0FSRTpyZXR1cm4nKic7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLlA6cmV0dXJuJzAnO2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5MOnJldHVybicxJztjYXNlIGpzdHMuZ2VvbS5EaW1lbnNpb24uQTpyZXR1cm4nMic7fVxudGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1Vua25vd24gZGltZW5zaW9uIHZhbHVlOiAnK1xuZGltZW5zaW9uVmFsdWUpO307anN0cy5nZW9tLkRpbWVuc2lvbi50b0RpbWVuc2lvblZhbHVlPWZ1bmN0aW9uKGRpbWVuc2lvblN5bWJvbCl7c3dpdGNoKGRpbWVuc2lvblN5bWJvbC50b1VwcGVyQ2FzZSgpKXtjYXNlJ0YnOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFO2Nhc2UnVCc6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uVFJVRTtjYXNlJyonOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkRPTlRDQVJFO2Nhc2UnMCc6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uUDtjYXNlJzEnOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkw7Y2FzZScyJzpyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5BO31cbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdVbmtub3duIGRpbWVuc2lvbiBzeW1ib2w6ICcrXG5kaW1lbnNpb25TeW1ib2wpO307KGZ1bmN0aW9uKCl7dmFyIERpbWVuc2lvbj1qc3RzLmdlb20uRGltZW5zaW9uO2pzdHMuZ2VvbS5MaW5lU3RyaW5nPWZ1bmN0aW9uKHBvaW50cyxmYWN0b3J5KXt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt0aGlzLnBvaW50cz1wb2ludHN8fFtdO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnkoKTtqc3RzLmdlb20uTGluZVN0cmluZy5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTGluZVN0cmluZztqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUucG9pbnRzPW51bGw7anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVTZXF1ZW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBvaW50czt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlTj1mdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5wb2ludHNbbl07fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy5nZXRDb29yZGluYXRlTigwKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4gMTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe2lmKHRoaXMuaXNDbG9zZWQoKSl7cmV0dXJuIERpbWVuc2lvbi5GQUxTRTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzLmxlbmd0aD09PTA7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzLmxlbmd0aDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRQb2ludE49ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvaW50KHRoaXMucG9pbnRzW25dKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRTdGFydFBvaW50PWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdldFBvaW50TigwKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRFbmRQb2ludD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy5nZXRQb2ludE4odGhpcy5nZXROdW1Qb2ludHMoKS0xKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMuZ2V0Q29vcmRpbmF0ZU4oMCkuZXF1YWxzMkQodGhpcy5nZXRDb29yZGluYXRlTih0aGlzLnBvaW50cy5sZW5ndGgtMSkpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzQ2xvc2VkKCkmJnRoaXMuaXNTaW1wbGUoKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRHZW9tZXRyeVR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4nTGluZVN0cmluZyc7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlTGVuZ3RoKHRoaXMucG9pbnRzKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe3JldHVybihuZXcganN0cy5vcGVyYXRpb24uQm91bmRhcnlPcCh0aGlzKSkuZ2V0Qm91bmRhcnkoKTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO31cbnZhciBlbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO3RoaXMucG9pbnRzLmZvckVhY2goZnVuY3Rpb24oY29tcG9uZW50KXtlbnYuZXhwYW5kVG9JbmNsdWRlKGNvbXBvbmVudCk7fSk7cmV0dXJuIGVudjt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMucG9pbnRzLmxlbmd0aCE9PW90aGVyLnBvaW50cy5sZW5ndGgpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzRW1wdHkoKSYmb3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gdGhpcy5wb2ludHMucmVkdWNlKGZ1bmN0aW9uKGVxdWFsLHBvaW50LGkpe3JldHVybiBlcXVhbCYmanN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5lcXVhbChwb2ludCxvdGhlci5wb2ludHNbaV0sdG9sZXJhbmNlKTt9KTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5pc0VxdWl2YWxlbnRDbGFzcz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmc7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3ZhciBsaW5lPW87dmFyIGk9MCxpbD10aGlzLnBvaW50cy5sZW5ndGg7dmFyIGo9MCxqbD1saW5lLnBvaW50cy5sZW5ndGg7d2hpbGUoaTxpbCYmajxqbCl7dmFyIGNvbXBhcmlzb249dGhpcy5wb2ludHNbaV0uY29tcGFyZVRvKGxpbmUucG9pbnRzW2pdKTtpZihjb21wYXJpc29uIT09MCl7cmV0dXJuIGNvbXBhcmlzb247fVxuaSsrO2orKzt9XG5pZihpPGlsKXtyZXR1cm4gMTt9XG5pZihqPGpsKXtyZXR1cm4tMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcnx8ZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO31lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyKXtmb3IodmFyIGk9MCxsZW49dGhpcy5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7ZmlsdGVyLmZpbHRlcih0aGlzLnBvaW50c1tpXSk7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIpe3RoaXMuYXBwbHkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuYXBwbHkyPWZ1bmN0aW9uKGZpbHRlcil7aWYodGhpcy5wb2ludHMubGVuZ3RoPT09MClcbnJldHVybjtmb3IodmFyIGk9MDtpPHRoaXMucG9pbnRzLmxlbmd0aDtpKyspe2ZpbHRlci5maWx0ZXIodGhpcy5wb2ludHMsaSk7aWYoZmlsdGVyLmlzRG9uZSgpKVxuYnJlYWs7fVxuaWYoZmlsdGVyLmlzR2VvbWV0cnlDaGFuZ2VkKCkpe319O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBwb2ludHM9W107Zm9yKHZhciBpPTAsbGVuPXRoaXMucG9pbnRzLmxlbmd0aDtpPGxlbjtpKyspe3BvaW50cy5wdXNoKHRoaXMucG9pbnRzW2ldLmNsb25lKCkpO31cbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhwb2ludHMpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3ZhciBpLGlsLGosY2ksY2osbGVuO2xlbj10aGlzLnBvaW50cy5sZW5ndGg7aWw9cGFyc2VJbnQobGVuLzIpO2ZvcihpPTA7aTxpbDtpKyspe2o9bGVuLTEtaTtjaT10aGlzLnBvaW50c1tpXTtjaj10aGlzLnBvaW50c1tqXTtpZighY2kuZXF1YWxzKGNqKSl7aWYoY2kuY29tcGFyZVRvKGNqKT4wKXt0aGlzLnBvaW50cy5yZXZlcnNlKCk7fVxucmV0dXJuO319fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLkxpbmVTdHJpbmcnO30pKCk7KGZ1bmN0aW9uKCl7anN0cy5nZW9tLlBvbHlnb249ZnVuY3Rpb24oc2hlbGwsaG9sZXMsZmFjdG9yeSl7dGhpcy5zaGVsbD1zaGVsbHx8ZmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKG51bGwpO3RoaXMuaG9sZXM9aG9sZXN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnkoKTtqc3RzLmdlb20uUG9seWdvbi5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uUG9seWdvbjtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsLmdldENvb3JkaW5hdGUoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm5bXTt9XG52YXIgY29vcmRpbmF0ZXM9W107dmFyIGs9LTE7dmFyIHNoZWxsQ29vcmRpbmF0ZXM9dGhpcy5zaGVsbC5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgeD0wO3g8c2hlbGxDb29yZGluYXRlcy5sZW5ndGg7eCsrKXtrKys7Y29vcmRpbmF0ZXNba109c2hlbGxDb29yZGluYXRlc1t4XTt9XG5mb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQ29vcmRpbmF0ZXM9dGhpcy5ob2xlc1tpXS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaj0wO2o8Y2hpbGRDb29yZGluYXRlcy5sZW5ndGg7aisrKXtrKys7Y29vcmRpbmF0ZXNba109Y2hpbGRDb29yZGluYXRlc1tqXTt9fVxucmV0dXJuIGNvb3JkaW5hdGVzO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbigpe3ZhciBudW1Qb2ludHM9dGhpcy5zaGVsbC5nZXROdW1Qb2ludHMoKTtmb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7bnVtUG9pbnRzKz10aGlzLmhvbGVzW2ldLmdldE51bVBvaW50cygpO31cbnJldHVybiBudW1Qb2ludHM7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsLmlzRW1wdHkoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5pc1JlY3RhbmdsZT1mdW5jdGlvbigpe2lmKHRoaXMuZ2V0TnVtSW50ZXJpb3JSaW5nKCkhPTApcmV0dXJuIGZhbHNlO2lmKHRoaXMuc2hlbGw9PW51bGwpcmV0dXJuIGZhbHNlO2lmKHRoaXMuc2hlbGwuZ2V0TnVtUG9pbnRzKCkhPTUpcmV0dXJuIGZhbHNlO3ZhciBzZXE9dGhpcy5zaGVsbC5nZXRDb29yZGluYXRlU2VxdWVuY2UoKTt2YXIgZW52PXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2Zvcih2YXIgaT0wO2k8NTtpKyspe3ZhciB4PXNlcVtpXS54O2lmKCEoeD09ZW52LmdldE1pblgoKXx8eD09ZW52LmdldE1heFgoKSkpcmV0dXJuIGZhbHNlO3ZhciB5PXNlcVtpXS55O2lmKCEoeT09ZW52LmdldE1pblkoKXx8eT09ZW52LmdldE1heFkoKSkpcmV0dXJuIGZhbHNlO31cbnZhciBwcmV2WD1zZXFbMF0ueDt2YXIgcHJldlk9c2VxWzBdLnk7Zm9yKHZhciBpPTE7aTw9NDtpKyspe3ZhciB4PXNlcVtpXS54O3ZhciB5PXNlcVtpXS55O3ZhciB4Q2hhbmdlZD14IT1wcmV2WDt2YXIgeUNoYW5nZWQ9eSE9cHJldlk7aWYoeENoYW5nZWQ9PXlDaGFuZ2VkKVxucmV0dXJuIGZhbHNlO3ByZXZYPXg7cHJldlk9eTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRFeHRlcmlvclJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaGVsbDt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRJbnRlcmlvclJpbmdOPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmhvbGVzW25dO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldE51bUludGVyaW9yUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhvbGVzLmxlbmd0aDt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRBcmVhPWZ1bmN0aW9uKCl7dmFyIGFyZWE9MC4wO2FyZWErPU1hdGguYWJzKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5zaWduZWRBcmVhKHRoaXMuc2hlbGwuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCkpKTtmb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7YXJlYS09TWF0aC5hYnMoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLnNpZ25lZEFyZWEodGhpcy5ob2xlc1tpXS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSkpO31cbnJldHVybiBhcmVhO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3ZhciBsZW49MC4wO2xlbis9dGhpcy5zaGVsbC5nZXRMZW5ndGgoKTtmb3IodmFyIGk9MDtpPHRoaXMuaG9sZXMubGVuZ3RoO2krKyl7bGVuKz10aGlzLmhvbGVzW2ldLmdldExlbmd0aCgpO31cbnJldHVybiBsZW47fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZU11bHRpTGluZVN0cmluZyhudWxsKTt9XG52YXIgcmluZ3M9W107cmluZ3NbMF09dGhpcy5zaGVsbC5jbG9uZSgpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmhvbGVzLmxlbmd0aDtpPGxlbjtpKyspe3JpbmdzW2krMV09dGhpcy5ob2xlc1tpXS5jbG9uZSgpO31cbmlmKHJpbmdzLmxlbmd0aDw9MSlcbnJldHVybiByaW5nc1swXTtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKHJpbmdzKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsLmdldEVudmVsb3BlSW50ZXJuYWwoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4gMjt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAxO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5pc0VtcHR5KCkmJm90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRydWU7fVxuaWYodGhpcy5pc0VtcHR5KCkhPT1vdGhlci5pc0VtcHR5KCkpe3JldHVybiBmYWxzZTt9XG5pZighdGhpcy5zaGVsbC5lcXVhbHNFeGFjdChvdGhlci5zaGVsbCx0b2xlcmFuY2UpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5ob2xlcy5sZW5ndGghPT1vdGhlci5ob2xlcy5sZW5ndGgpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmhvbGVzLmxlbmd0aCE9PW90aGVyLmhvbGVzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmZvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtpZighKHRoaXMuaG9sZXNbaV0pLmVxdWFsc0V4YWN0KG90aGVyLmhvbGVzW2ldLHRvbGVyYW5jZSkpe3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3JldHVybiB0aGlzLnNoZWxsLmNvbXBhcmVUb1NhbWVDbGFzcyhvLnNoZWxsKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbXBvbmVudEZpbHRlcil7ZmlsdGVyLmZpbHRlcih0aGlzKTt0aGlzLnNoZWxsLmFwcGx5KGZpbHRlcik7Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5ob2xlc1tpXS5hcHBseShmaWx0ZXIpO319ZWxzZSBpZihmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXIpe2ZpbHRlci5maWx0ZXIodGhpcyk7fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe3RoaXMuc2hlbGwuYXBwbHkoZmlsdGVyKTtmb3IodmFyIGk9MCxsZW49dGhpcy5ob2xlcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmhvbGVzW2ldLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIpe3RoaXMuYXBwbHkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuYXBwbHkyPWZ1bmN0aW9uKGZpbHRlcil7dGhpcy5zaGVsbC5hcHBseShmaWx0ZXIpO2lmKCFmaWx0ZXIuaXNEb25lKCkpe2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXt0aGlzLmhvbGVzW2ldLmFwcGx5KGZpbHRlcik7aWYoZmlsdGVyLmlzRG9uZSgpKVxuYnJlYWs7fX1cbmlmKGZpbHRlci5pc0dlb21ldHJ5Q2hhbmdlZCgpKXt9fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt2YXIgaG9sZXM9W107Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7aG9sZXMucHVzaCh0aGlzLmhvbGVzW2ldLmNsb25lKCkpO31cbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlUG9seWdvbih0aGlzLnNoZWxsLmNsb25lKCksaG9sZXMpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe3RoaXMubm9ybWFsaXplMih0aGlzLnNoZWxsLHRydWUpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmhvbGVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMubm9ybWFsaXplMih0aGlzLmhvbGVzW2ldLGZhbHNlKTt9XG50aGlzLmhvbGVzLnNvcnQoKTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5ub3JtYWxpemUyPWZ1bmN0aW9uKHJpbmcsY2xvY2t3aXNlKXtpZihyaW5nLmlzRW1wdHkoKSl7cmV0dXJuO31cbnZhciB1bmlxdWVDb29yZGluYXRlcz1yaW5nLnBvaW50cy5zbGljZSgwLHJpbmcucG9pbnRzLmxlbmd0aC0xKTt2YXIgbWluQ29vcmRpbmF0ZT1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5taW5Db29yZGluYXRlKHJpbmcucG9pbnRzKTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5zY3JvbGwodW5pcXVlQ29vcmRpbmF0ZXMsbWluQ29vcmRpbmF0ZSk7cmluZy5wb2ludHM9dW5pcXVlQ29vcmRpbmF0ZXMuY29uY2F0KCk7cmluZy5wb2ludHNbdW5pcXVlQ29vcmRpbmF0ZXMubGVuZ3RoXT11bmlxdWVDb29yZGluYXRlc1swXTtpZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocmluZy5wb2ludHMpPT09Y2xvY2t3aXNlKXtyaW5nLnBvaW50cy5yZXZlcnNlKCk7fX07anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidQb2x5Z29uJzt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uUG9seWdvbic7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR2VvbWV0cnk9anN0cy5nZW9tLkdlb21ldHJ5O3ZhciBUcmVlU2V0PWphdmFzY3JpcHQudXRpbC5UcmVlU2V0O3ZhciBBcnJheXM9amF2YXNjcmlwdC51dGlsLkFycmF5cztqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKGdlb21ldHJpZXMsZmFjdG9yeSl7dGhpcy5nZW9tZXRyaWVzPWdlb21ldHJpZXN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGU9bmV3IEdlb21ldHJ5KCk7anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uO2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtpZighZ2VvbWV0cnkuaXNFbXB0eSgpKXtyZXR1cm4gZmFsc2U7fX1cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0QXJlYT1mdW5jdGlvbigpe3ZhciBhcmVhPTAuMDtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe2FyZWErPXRoaXMuZ2V0R2VvbWV0cnlOKGkpLmdldEFyZWEoKTt9XG5yZXR1cm4gYXJlYTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3ZhciBsZW5ndGg9MC4wO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7bGVuZ3RoKz10aGlzLmdldEdlb21ldHJ5TihpKS5nZXRMZW5ndGgoKTt9XG5yZXR1cm4gbGVuZ3RoO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKVxucmV0dXJuIG51bGw7cmV0dXJuIHRoaXMuZ2V0R2VvbWV0cnlOKDApLmdldENvb3JkaW5hdGUoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7dmFyIGNvb3JkaW5hdGVzPVtdO3ZhciBrPS0xO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO3ZhciBjaGlsZENvb3JkaW5hdGVzPWdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBqPTA7ajxjaGlsZENvb3JkaW5hdGVzLmxlbmd0aDtqKyspe2srKztjb29yZGluYXRlc1trXT1jaGlsZENvb3JkaW5hdGVzW2pdO319XG5yZXR1cm4gY29vcmRpbmF0ZXM7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXROdW1HZW9tZXRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRHZW9tZXRyeU49ZnVuY3Rpb24obil7dmFyIGdlb21ldHJ5PXRoaXMuZ2VvbWV0cmllc1tuXTtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtnZW9tZXRyeT1uZXcganN0cy5nZW9tLlBvaW50KGdlb21ldHJ5KTt9XG5yZXR1cm4gZ2VvbWV0cnk7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24obil7dmFyIG51bVBvaW50cz0wO2Zvcih2YXIgaT0wO2k8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe251bVBvaW50cys9dGhpcy5nZW9tZXRyaWVzW2ldLmdldE51bVBvaW50cygpO31cbnJldHVybiBudW1Qb2ludHM7fVxuanN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmdlb21ldHJpZXMubGVuZ3RoIT09b3RoZXIuZ2VvbWV0cmllcy5sZW5ndGgpe3JldHVybiBmYWxzZTt9XG5mb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtpZighZ2VvbWV0cnkuZXF1YWxzRXhhY3Qob3RoZXIuZ2V0R2VvbWV0cnlOKGkpLHRvbGVyYW5jZSkpe3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBnZW9tZXRyaWVzPVtdO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7Z2VvbWV0cmllcy5wdXNoKHRoaXMuZ2VvbWV0cmllc1tpXS5jbG9uZSgpKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5nZXRHZW9tZXRyeU4oaSkubm9ybWFsaXplKCk7fVxudGhpcy5nZW9tZXRyaWVzLnNvcnQoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmNvbXBhcmVUb1NhbWVDbGFzcz1mdW5jdGlvbihvKXt2YXIgdGhlc2VFbGVtZW50cz1uZXcgVHJlZVNldChBcnJheXMuYXNMaXN0KHRoaXMuZ2VvbWV0cmllcykpO3ZhciBvdGhlckVsZW1lbnRzPW5ldyBUcmVlU2V0KEFycmF5cy5hc0xpc3Qoby5nZW9tZXRyaWVzKSk7cmV0dXJuIHRoaXMuY29tcGFyZSh0aGVzZUVsZW1lbnRzLG90aGVyRWxlbWVudHMpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuYXBwbHk9ZnVuY3Rpb24oZmlsdGVyKXtpZihmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXJ8fGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbXBvbmVudEZpbHRlcil7ZmlsdGVyLmZpbHRlcih0aGlzKTtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZ2V0R2VvbWV0cnlOKGkpLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyKXtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZ2V0R2VvbWV0cnlOKGkpLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIpe3RoaXMuYXBwbHkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5hcHBseTI9ZnVuY3Rpb24oZmlsdGVyKXtpZih0aGlzLmdlb21ldHJpZXMubGVuZ3RoPT0wKVxucmV0dXJuO2Zvcih2YXIgaT0wO2k8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3RoaXMuZ2VvbWV0cmllc1tpXS5hcHBseShmaWx0ZXIpO2lmKGZpbHRlci5pc0RvbmUoKSl7YnJlYWs7fX1cbmlmKGZpbHRlci5pc0dlb21ldHJ5Q2hhbmdlZCgpKXt9fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXREaW1lbnNpb249ZnVuY3Rpb24oKXt2YXIgZGltZW5zaW9uPWpzdHMuZ2VvbS5EaW1lbnNpb24uRkFMU0U7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt2YXIgZ2VvbWV0cnk9dGhpcy5nZXRHZW9tZXRyeU4oaSk7ZGltZW5zaW9uPU1hdGgubWF4KGRpbWVuc2lvbixnZW9tZXRyeS5nZXREaW1lbnNpb24oKSk7fVxucmV0dXJuIGRpbWVuc2lvbjt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7dmFyIGVudmVsb3BlPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtlbnZlbG9wZS5leHBhbmRUb0luY2x1ZGUoZ2VvbWV0cnkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9XG5yZXR1cm4gZW52ZWxvcGU7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJzt9KSgpO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkPWZ1bmN0aW9uKGdlb21ldHJ5KXt0aGlzLmFyZWFCYXNlUHQ9bnVsbDt0aGlzLnRyaWFuZ2xlQ2VudDM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5hcmVhc3VtMj0wO3RoaXMuY2czPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMubGluZUNlbnRTdW09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy50b3RhbExlbmd0aD0wO3RoaXMucHRDb3VudD0wO3RoaXMucHRDZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMuYWRkKGdlb21ldHJ5KTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmdldENlbnRyb2lkPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgY2VudD1uZXcganN0cy5hbGdvcml0aG0uQ2VudHJvaWQoZ2VvbWV0cnkpO3JldHVybiBjZW50LmdldENlbnRyb2lkKCk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5jZW50cm9pZDM9ZnVuY3Rpb24ocDEscDIscDMsYyl7Yy54PXAxLngrcDIueCtwMy54O2MueT1wMS55K3AyLnkrcDMueTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmFyZWEyPWZ1bmN0aW9uKHAxLHAyLHAzKXtyZXR1cm4ocDIueC1wMS54KSoocDMueS1wMS55KS0ocDMueC1wMS54KSoocDIueS1wMS55KTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbS5pc0VtcHR5KCkpe3JldHVybjt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmFkZFBvaW50KGdlb20uZ2V0Q29vcmRpbmF0ZSgpKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3RoaXMuYWRkTGluZVNlZ21lbnRzKGdlb20uZ2V0Q29vcmRpbmF0ZXMoKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXt0aGlzLmFkZFBvbHlnb24oZ2VvbSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZChnZW9tLmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5nZXRDZW50cm9pZD1mdW5jdGlvbigpe3ZhciBjZW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2lmKE1hdGguYWJzKHRoaXMuYXJlYXN1bTIpPjApe2NlbnQueD10aGlzLmNnMy54LzMvdGhpcy5hcmVhc3VtMjtjZW50Lnk9dGhpcy5jZzMueS8zL3RoaXMuYXJlYXN1bTI7fWVsc2UgaWYodGhpcy50b3RhbExlbmd0aD4wKXtjZW50Lng9dGhpcy5saW5lQ2VudFN1bS54L3RoaXMudG90YWxMZW5ndGg7Y2VudC55PXRoaXMubGluZUNlbnRTdW0ueS90aGlzLnRvdGFsTGVuZ3RoO31lbHNlIGlmKHRoaXMucHRDb3VudD4wKXtjZW50Lng9dGhpcy5wdENlbnRTdW0ueC90aGlzLnB0Q291bnQ7Y2VudC55PXRoaXMucHRDZW50U3VtLnkvdGhpcy5wdENvdW50O31lbHNle3JldHVybiBudWxsO31cbnJldHVybiBjZW50O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLnNldEJhc2VQb2ludD1mdW5jdGlvbihiYXNlUHQpe2lmKHRoaXMuYXJlYUJhc2VQdD09PW51bGwpe3RoaXMuYXJlYUJhc2VQdD1iYXNlUHQ7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFBvbHlnb249ZnVuY3Rpb24ocG9seSl7dGhpcy5hZGRTaGVsbChwb2x5LmdldEV4dGVyaW9yUmluZygpLmdldENvb3JkaW5hdGVzKCkpO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuYWRkSG9sZShwb2x5LmdldEludGVyaW9yUmluZ04oaSkuZ2V0Q29vcmRpbmF0ZXMoKSk7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFNoZWxsPWZ1bmN0aW9uKHB0cyl7aWYocHRzLmxlbmd0aD4wKXt0aGlzLnNldEJhc2VQb2ludChwdHNbMF0pO31cbnZhciBpc1Bvc2l0aXZlQXJlYT0hanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHB0cyk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt0aGlzLmFkZFRyaWFuZ2xlKHRoaXMuYXJlYUJhc2VQdCxwdHNbaV0scHRzW2krMV0saXNQb3NpdGl2ZUFyZWEpO31cbnRoaXMuYWRkTGluZVNlZ21lbnRzKHB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkSG9sZT1mdW5jdGlvbihwdHMpe3ZhciBpc1Bvc2l0aXZlQXJlYT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5hcmVhQmFzZVB0LHB0c1tpXSxwdHNbaSsxXSxpc1Bvc2l0aXZlQXJlYSk7fVxudGhpcy5hZGRMaW5lU2VnbWVudHMocHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGRUcmlhbmdsZT1mdW5jdGlvbihwMCxwMSxwMixpc1Bvc2l0aXZlQXJlYSl7dmFyIHNpZ249KGlzUG9zaXRpdmVBcmVhKT8xOi0xO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmNlbnRyb2lkMyhwMCxwMSxwMix0aGlzLnRyaWFuZ2xlQ2VudDMpO3ZhciBhcmVhMj1qc3RzLmFsZ29yaXRobS5DZW50cm9pZC5hcmVhMihwMCxwMSxwMik7dGhpcy5jZzMueCs9c2lnbiphcmVhMip0aGlzLnRyaWFuZ2xlQ2VudDMueDt0aGlzLmNnMy55Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My55O3RoaXMuYXJlYXN1bTIrPXNpZ24qYXJlYTI7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkTGluZVNlZ21lbnRzPWZ1bmN0aW9uKHB0cyl7dmFyIGxpbmVMZW49MDtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3ZhciBzZWdtZW50TGVuPXB0c1tpXS5kaXN0YW5jZShwdHNbaSsxXSk7aWYoc2VnbWVudExlbj09PTApe2NvbnRpbnVlO31cbmxpbmVMZW4rPXNlZ21lbnRMZW47dmFyIG1pZHg9KHB0c1tpXS54K3B0c1tpKzFdLngpLzI7dGhpcy5saW5lQ2VudFN1bS54Kz1zZWdtZW50TGVuKm1pZHg7dmFyIG1pZHk9KHB0c1tpXS55K3B0c1tpKzFdLnkpLzI7dGhpcy5saW5lQ2VudFN1bS55Kz1zZWdtZW50TGVuKm1pZHk7fVxudGhpcy50b3RhbExlbmd0aCs9bGluZUxlbjtpZihsaW5lTGVuPT09MCYmcHRzLmxlbmd0aD4wKXt0aGlzLmFkZFBvaW50KHB0c1swXSk7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFBvaW50PWZ1bmN0aW9uKHB0KXt0aGlzLnB0Q291bnQrPTE7dGhpcy5wdENlbnRTdW0ueCs9cHQueDt0aGlzLnB0Q2VudFN1bS55Kz1wdC55O307KGZ1bmN0aW9uKCl7dmFyIEVkZ2VSaW5nPWZ1bmN0aW9uKGZhY3Rvcnkpe3RoaXMuZGVMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtFZGdlUmluZy5maW5kRWRnZVJpbmdDb250YWluaW5nPWZ1bmN0aW9uKHRlc3RFcixzaGVsbExpc3Qpe3ZhciB0ZXN0UmluZz10ZXN0RXIuZ2V0UmluZygpO3ZhciB0ZXN0RW52PXRlc3RSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgdGVzdFB0PXRlc3RSaW5nLmdldENvb3JkaW5hdGVOKDApO3ZhciBtaW5TaGVsbD1udWxsO3ZhciBtaW5FbnY9bnVsbDtmb3IodmFyIGl0PXNoZWxsTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciB0cnlTaGVsbD1pdC5uZXh0KCk7dmFyIHRyeVJpbmc9dHJ5U2hlbGwuZ2V0UmluZygpO3ZhciB0cnlFbnY9dHJ5UmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYobWluU2hlbGwhPW51bGwpXG5taW5FbnY9bWluU2hlbGwuZ2V0UmluZygpLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgaXNDb250YWluZWQ9ZmFsc2U7aWYodHJ5RW52LmVxdWFscyh0ZXN0RW52KSlcbmNvbnRpbnVlO3Rlc3RQdD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5wdE5vdEluTGlzdCh0ZXN0UmluZy5nZXRDb29yZGluYXRlcygpLHRyeVJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodHJ5RW52LmNvbnRhaW5zKHRlc3RFbnYpJiZqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyh0ZXN0UHQsdHJ5UmluZy5nZXRDb29yZGluYXRlcygpKSlcbmlzQ29udGFpbmVkPXRydWU7aWYoaXNDb250YWluZWQpe2lmKG1pblNoZWxsPT1udWxsfHxtaW5FbnYuY29udGFpbnModHJ5RW52KSl7bWluU2hlbGw9dHJ5U2hlbGw7fX19XG5yZXR1cm4gbWluU2hlbGw7fTtFZGdlUmluZy5wdE5vdEluTGlzdD1mdW5jdGlvbih0ZXN0UHRzLHB0cyl7Zm9yKHZhciBpPTA7aTx0ZXN0UHRzLmxlbmd0aDtpKyspe3ZhciB0ZXN0UHQ9dGVzdFB0c1tpXTtpZighaXNJbkxpc3QodGVzdFB0LHB0cykpXG5yZXR1cm4gdGVzdFB0O31cbnJldHVybiBudWxsO307RWRnZVJpbmcuaXNJbkxpc3Q9ZnVuY3Rpb24ocHQscHRzKXtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtpZihwdC5lcXVhbHMocHRzW2ldKSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9XG5FZGdlUmluZy5wcm90b3R5cGUuZmFjdG9yeT1udWxsO0VkZ2VSaW5nLnByb3RvdHlwZS5kZUxpc3Q9bnVsbDtFZGdlUmluZy5wcm90b3R5cGUucmluZz1udWxsO0VkZ2VSaW5nLnByb3RvdHlwZS5yaW5nUHRzPW51bGw7RWRnZVJpbmcucHJvdG90eXBlLmhvbGVzPW51bGw7RWRnZVJpbmcucHJvdG90eXBlLmFkZD1mdW5jdGlvbihkZSl7dGhpcy5kZUxpc3QuYWRkKGRlKTt9O0VkZ2VSaW5nLnByb3RvdHlwZS5pc0hvbGU9ZnVuY3Rpb24oKXt2YXIgcmluZz10aGlzLmdldFJpbmcoKTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtFZGdlUmluZy5wcm90b3R5cGUuYWRkSG9sZT1mdW5jdGlvbihob2xlKXtpZih0aGlzLmhvbGVzPT1udWxsKVxudGhpcy5ob2xlcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuaG9sZXMuYWRkKGhvbGUpO307RWRnZVJpbmcucHJvdG90eXBlLmdldFBvbHlnb249ZnVuY3Rpb24oKXt2YXIgaG9sZUxSPW51bGw7aWYodGhpcy5ob2xlcyE9bnVsbCl7aG9sZUxSPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5zaXplKCk7aSsrKXtob2xlTFJbaV09dGhpcy5ob2xlcy5nZXQoaSk7fX1cbnZhciBwb2x5PXRoaXMuZmFjdG9yeS5jcmVhdGVQb2x5Z29uKHRoaXMucmluZyxob2xlTFIpO3JldHVybiBwb2x5O307RWRnZVJpbmcucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmdldENvb3JkaW5hdGVzKCk7aWYodGhpcy5yaW5nUHRzLmxlbmd0aDw9MylcbnJldHVybiBmYWxzZTt0aGlzLmdldFJpbmcoKTtyZXR1cm4gdGhpcy5yaW5nLmlzVmFsaWQoKTt9O0VkZ2VSaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe2lmKHRoaXMucmluZ1B0cz09bnVsbCl7dmFyIGNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KCk7Zm9yKHZhciBpPXRoaXMuZGVMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7dmFyIGVkZ2U9ZGUuZ2V0RWRnZSgpO0VkZ2VSaW5nLmFkZEVkZ2UoZWRnZS5nZXRMaW5lKCkuZ2V0Q29vcmRpbmF0ZXMoKSxkZS5nZXRFZGdlRGlyZWN0aW9uKCksY29vcmRMaXN0KTt9XG50aGlzLnJpbmdQdHM9Y29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fVxucmV0dXJuIHRoaXMucmluZ1B0czt9O0VkZ2VSaW5nLnByb3RvdHlwZS5nZXRMaW5lU3RyaW5nPWZ1bmN0aW9uKCl7dGhpcy5nZXRDb29yZGluYXRlcygpO3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyh0aGlzLnJpbmdQdHMpO307RWRnZVJpbmcucHJvdG90eXBlLmdldFJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLnJpbmchPW51bGwpXG5yZXR1cm4gdGhpcy5yaW5nO3RoaXMuZ2V0Q29vcmRpbmF0ZXMoKTtpZih0aGlzLnJpbmdQdHMubGVuZ3RoPDMpXG5jb25zb2xlLmxvZyh0aGlzLnJpbmdQdHMpO3RyeXt0aGlzLnJpbmc9dGhpcy5mYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcodGhpcy5yaW5nUHRzKTt9Y2F0Y2goZXgpe2NvbnNvbGUubG9nKHRoaXMucmluZ1B0cyk7fVxucmV0dXJuIHRoaXMucmluZzt9O0VkZ2VSaW5nLmFkZEVkZ2U9ZnVuY3Rpb24oY29vcmRzLGlzRm9yd2FyZCxjb29yZExpc3Qpe2lmKGlzRm9yd2FyZCl7Zm9yKHZhciBpPTA7aTxjb29yZHMubGVuZ3RoO2krKyl7Y29vcmRMaXN0LmFkZChjb29yZHNbaV0sZmFsc2UpO319ZWxzZXtmb3IodmFyIGk9Y29vcmRzLmxlbmd0aC0xO2k+PTA7aS0tKXtjb29yZExpc3QuYWRkKGNvb3Jkc1tpXSxmYWxzZSk7fX19O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuRWRnZVJpbmc9RWRnZVJpbmc7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR3JhcGhDb21wb25lbnQ9ZnVuY3Rpb24oKXt9O0dyYXBoQ29tcG9uZW50LnNldFZpc2l0ZWQ9ZnVuY3Rpb24oaSx2aXNpdGVkKXt3aGlsZShpLmhhc05leHQoKSl7dmFyIGNvbXA9aS5uZXh0KCk7Y29tcC5zZXRWaXNpdGVkKHZpc2l0ZWQpO319O0dyYXBoQ29tcG9uZW50LnNldE1hcmtlZD1mdW5jdGlvbihpLG1hcmtlZCl7d2hpbGUoaS5oYXNOZXh0KCkpe3ZhciBjb21wPWkubmV4dCgpO2NvbXAuc2V0TWFya2VkKG1hcmtlZCk7fX07R3JhcGhDb21wb25lbnQuZ2V0Q29tcG9uZW50V2l0aFZpc2l0ZWRTdGF0ZT1mdW5jdGlvbihpLHZpc2l0ZWRTdGF0ZSl7d2hpbGUoaS5oYXNOZXh0KCkpe3ZhciBjb21wPWkubmV4dCgpO2lmKGNvbXAuaXNWaXNpdGVkKCk9PXZpc2l0ZWRTdGF0ZSlcbnJldHVybiBjb21wO31cbnJldHVybiBudWxsO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLl9pc01hcmtlZD1mYWxzZTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzVmlzaXRlZD1mYWxzZTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZGF0YTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNWaXNpdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmlzaXRlZDt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRWaXNpdGVkPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5faXNWaXNpdGVkPWlzVmlzaXRlZDt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc01hcmtlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc01hcmtlZDt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRNYXJrZWQ9ZnVuY3Rpb24oaXNNYXJrZWQpe3RoaXMuX2lzTWFya2VkPWlzTWFya2VkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldENvbnRleHQ9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZ2V0Q29udGV4dD1mdW5jdGlvbigpe3JldHVybiBkYXRhO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZ2V0RGF0YT1mdW5jdGlvbigpe3JldHVybiBkYXRhO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzUmVtb3ZlZD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLnBsYW5hcmdyYXBoLkdyYXBoQ29tcG9uZW50PUdyYXBoQ29tcG9uZW50O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEdyYXBoQ29tcG9uZW50PWpzdHMucGxhbmFyZ3JhcGguR3JhcGhDb21wb25lbnQ7dmFyIEVkZ2U9ZnVuY3Rpb24oZGUwLGRlMSl7aWYoZGUwPT09dW5kZWZpbmVkKXtyZXR1cm47fVxudGhpcy5zZXREaXJlY3RlZEVkZ2VzKGRlMCxkZTEpO307RWRnZS5wcm90b3R5cGU9bmV3IEdyYXBoQ29tcG9uZW50KCk7RWRnZS5wcm90b3R5cGUuZGlyRWRnZT1udWxsO0VkZ2UucHJvdG90eXBlLnNldERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oZGUwLGRlMSl7dGhpcy5kaXJFZGdlPVtkZTAsZGUxXTtkZTAuc2V0RWRnZSh0aGlzKTtkZTEuc2V0RWRnZSh0aGlzKTtkZTAuc2V0U3ltKGRlMSk7ZGUxLnNldFN5bShkZTApO2RlMC5nZXRGcm9tTm9kZSgpLmFkZE91dEVkZ2UoZGUwKTtkZTEuZ2V0RnJvbU5vZGUoKS5hZGRPdXRFZGdlKGRlMSk7fTtFZGdlLnByb3RvdHlwZS5nZXREaXJFZGdlPWZ1bmN0aW9uKGkpe2lmKGkgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLk5vZGUpe3RoaXMuZ2V0RGlyRWRnZTIoaSk7fVxucmV0dXJuIHRoaXMuZGlyRWRnZVtpXTt9O0VkZ2UucHJvdG90eXBlLmdldERpckVkZ2UyPWZ1bmN0aW9uKGZyb21Ob2RlKXtpZih0aGlzLmRpckVkZ2VbMF0uZ2V0RnJvbU5vZGUoKT09ZnJvbU5vZGUpXG5yZXR1cm4gdGhpcy5kaXJFZGdlWzBdO2lmKHRoaXMuZGlyRWRnZVsxXS5nZXRGcm9tTm9kZSgpPT1mcm9tTm9kZSlcbnJldHVybiB0aGlzLmRpckVkZ2VbMV07cmV0dXJuIG51bGw7fTtFZGdlLnByb3RvdHlwZS5nZXRPcHBvc2l0ZU5vZGU9ZnVuY3Rpb24obm9kZSl7aWYodGhpcy5kaXJFZGdlWzBdLmdldEZyb21Ob2RlKCk9PW5vZGUpXG5yZXR1cm4gdGhpcy5kaXJFZGdlWzBdLmdldFRvTm9kZSgpO2lmKHRoaXMuZGlyRWRnZVsxXS5nZXRGcm9tTm9kZSgpPT1ub2RlKVxucmV0dXJuIHRoaXMuZGlyRWRnZVsxXS5nZXRUb05vZGUoKTtyZXR1cm4gbnVsbDt9O0VkZ2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3RoaXMuZGlyRWRnZT1udWxsO307RWRnZS5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIGRpckVkZ2U9PW51bGw7fTtqc3RzLnBsYW5hcmdyYXBoLkVkZ2U9RWRnZTt9KSgpO2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUVkZ2U9ZnVuY3Rpb24obGluZSl7dGhpcy5saW5lPWxpbmU7fTtqc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVFZGdlLnByb3RvdHlwZT1uZXcganN0cy5wbGFuYXJncmFwaC5FZGdlKCk7anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZS5wcm90b3R5cGUubGluZT1udWxsO2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUVkZ2UucHJvdG90eXBlLmdldExpbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saW5lO307KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBHcmFwaENvbXBvbmVudD1qc3RzLnBsYW5hcmdyYXBoLkdyYXBoQ29tcG9uZW50O3ZhciBEaXJlY3RlZEVkZ2U9ZnVuY3Rpb24oZnJvbSx0byxkaXJlY3Rpb25QdCxlZGdlRGlyZWN0aW9uKXtpZihmcm9tPT09dW5kZWZpbmVkKXtyZXR1cm47fVxudGhpcy5mcm9tPWZyb207dGhpcy50bz10bzt0aGlzLmVkZ2VEaXJlY3Rpb249ZWRnZURpcmVjdGlvbjt0aGlzLnAwPWZyb20uZ2V0Q29vcmRpbmF0ZSgpO3RoaXMucDE9ZGlyZWN0aW9uUHQ7dmFyIGR4PXRoaXMucDEueC10aGlzLnAwLng7dmFyIGR5PXRoaXMucDEueS10aGlzLnAwLnk7dGhpcy5xdWFkcmFudD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChkeCxkeSk7dGhpcy5hbmdsZT1NYXRoLmF0YW4yKGR5LGR4KTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGU9bmV3IEdyYXBoQ29tcG9uZW50KCk7RGlyZWN0ZWRFZGdlLnRvRWRnZXM9ZnVuY3Rpb24oZGlyRWRnZXMpe3ZhciBlZGdlcz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPWRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXtlZGdlcy5hZGQoKGkubmV4dCgpKS5wYXJlbnRFZGdlKTt9XG5yZXR1cm4gZWRnZXM7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnBhcmVudEVkZ2U9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmZyb209bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnRvPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5wMD1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucDE9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnN5bT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZWRnZURpcmVjdGlvbj1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucXVhZHJhbnQ9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmFuZ2xlPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRFZGdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGFyZW50RWRnZTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RWRnZT1mdW5jdGlvbihwYXJlbnRFZGdlKXt0aGlzLnBhcmVudEVkZ2U9cGFyZW50RWRnZTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0UXVhZHJhbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5xdWFkcmFudDt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RGlyZWN0aW9uUHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RWRnZURpcmVjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VEaXJlY3Rpb247fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEZyb21Ob2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZnJvbTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0VG9Ob2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG87fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mcm9tLmdldENvb3JkaW5hdGUoKTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0QW5nbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hbmdsZTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0U3ltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3ltO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRTeW09ZnVuY3Rpb24oc3ltKXt0aGlzLnN5bT1zeW07fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3RoaXMuc3ltPW51bGw7dGhpcy5wYXJlbnRFZGdlPW51bGw7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzUmVtb3ZlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudEVkZ2U9PW51bGw7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvYmope3ZhciBkZT1vYmo7cmV0dXJuIHRoaXMuY29tcGFyZURpcmVjdGlvbihkZSk7fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmNvbXBhcmVEaXJlY3Rpb249ZnVuY3Rpb24oZSl7aWYodGhpcy5xdWFkcmFudD5lLnF1YWRyYW50KVxucmV0dXJuIDE7aWYodGhpcy5xdWFkcmFudDxlLnF1YWRyYW50KVxucmV0dXJuLTE7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24oZS5wMCxlLnAxLHRoaXMucDEpO307anN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2U9RGlyZWN0ZWRFZGdlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIERpcmVjdGVkRWRnZT1qc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZTt2YXIgUG9seWdvbml6ZURpcmVjdGVkRWRnZT1mdW5jdGlvbihmcm9tLHRvLGRpcmVjdGlvblB0LGVkZ2VEaXJlY3Rpb24pe0RpcmVjdGVkRWRnZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZT1uZXcgRGlyZWN0ZWRFZGdlKCk7UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuZWRnZVJpbmc9bnVsbDtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5uZXh0PW51bGw7UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUubGFiZWw9LTE7UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldExhYmVsPWZ1bmN0aW9uKGxhYmVsKXt0aGlzLmxhYmVsPWxhYmVsO307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5leHQ7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXROZXh0PWZ1bmN0aW9uKG5leHQpe3RoaXMubmV4dD1uZXh0O307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNJblJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlUmluZyE9bnVsbDt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFJpbmc9ZnVuY3Rpb24oZWRnZVJpbmcpe3RoaXMuZWRnZVJpbmc9ZWRnZVJpbmc7fTtqc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVEaXJlY3RlZEVkZ2U9UG9seWdvbml6ZURpcmVjdGVkRWRnZTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgRGlyZWN0ZWRFZGdlU3Rhcj1mdW5jdGlvbigpe3RoaXMub3V0RWRnZXM9bmV3IEFycmF5TGlzdCgpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUub3V0RWRnZXM9bnVsbDtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5zb3J0ZWQ9ZmFsc2U7RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGRlKXt0aGlzLm91dEVkZ2VzLmFkZChkZSk7dGhpcy5zb3J0ZWQ9ZmFsc2U7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZGUpe3RoaXMub3V0RWRnZXMucmVtb3ZlKGRlKTt9O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLml0ZXJhdG9yPWZ1bmN0aW9uKCl7dGhpcy5zb3J0RWRnZXMoKTtyZXR1cm4gdGhpcy5vdXRFZGdlcy5pdGVyYXRvcigpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0RGVncmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3V0RWRnZXMuc2l6ZSgpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3ZhciBpdD1pdGVyYXRvcigpO2lmKCFpdC5oYXNOZXh0KCkpXG5yZXR1cm4gbnVsbDt2YXIgZT1pdC5uZXh0KCk7cmV0dXJuIGUuZ2V0Q29vcmRpbmF0ZSgpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXt0aGlzLnNvcnRFZGdlcygpO3JldHVybiB0aGlzLm91dEVkZ2VzO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuc29ydEVkZ2VzPWZ1bmN0aW9uKCl7aWYoIXRoaXMuc29ydGVkKXt2YXIgYXJyYXk9dGhpcy5vdXRFZGdlcy50b0FycmF5KCk7YXJyYXkuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTt0aGlzLm91dEVkZ2VzPWphdmFzY3JpcHQudXRpbC5BcnJheXMuYXNMaXN0KGFycmF5KTt0aGlzLnNvcnRlZD10cnVlO319O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldEluZGV4PWZ1bmN0aW9uKGVkZ2Upe2lmKGVkZ2UgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMuZ2V0SW5kZXgyKGVkZ2UpO31lbHNlIGlmKHR5cGVvZihlZGdlKT09PSdudW1iZXInKXtyZXR1cm4gdGhpcy5nZXRJbmRleDMoZWRnZSk7fVxudGhpcy5zb3J0RWRnZXMoKTtmb3IodmFyIGk9MDtpPHRoaXMub3V0RWRnZXMuc2l6ZSgpO2krKyl7dmFyIGRlPXRoaXMub3V0RWRnZXMuZ2V0KGkpO2lmKGRlLmdldEVkZ2UoKT09ZWRnZSlcbnJldHVybiBpO31cbnJldHVybi0xO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0SW5kZXgyPWZ1bmN0aW9uKGRpckVkZ2Upe3RoaXMuc29ydEVkZ2VzKCk7Zm9yKHZhciBpPTA7aTx0aGlzLm91dEVkZ2VzLnNpemUoKTtpKyspe3ZhciBkZT10aGlzLm91dEVkZ2VzLmdldChpKTtpZihkZT09ZGlyRWRnZSlcbnJldHVybiBpO31cbnJldHVybi0xO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0SW5kZXgzPWZ1bmN0aW9uKGkpe3ZhciBtb2RpPXRvSW50KGkldGhpcy5vdXRFZGdlcy5zaXplKCkpO2lmKG1vZGk8MClcbm1vZGkrPXRoaXMub3V0RWRnZXMuc2l6ZSgpO3JldHVybiBtb2RpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0TmV4dEVkZ2U9ZnVuY3Rpb24oZGlyRWRnZSl7dmFyIGk9dGhpcy5nZXRJbmRleChkaXJFZGdlKTtyZXR1cm4gdGhpcy5vdXRFZGdlcy5nZXQoZ2V0SW5kZXgoaSsxKSk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXROZXh0Q1dFZGdlPWZ1bmN0aW9uKGRpckVkZ2Upe3ZhciBpPXRoaXMuZ2V0SW5kZXgoZGlyRWRnZSk7cmV0dXJuIHRoaXMub3V0RWRnZXMuZ2V0KGdldEluZGV4KGktMSkpO307anN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2VTdGFyPURpcmVjdGVkRWRnZVN0YXI7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR3JhcGhDb21wb25lbnQ9anN0cy5wbGFuYXJncmFwaC5HcmFwaENvbXBvbmVudDt2YXIgRGlyZWN0ZWRFZGdlU3Rhcj1qc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZVN0YXI7dmFyIE5vZGU9ZnVuY3Rpb24ocHQsZGVTdGFyKXt0aGlzLnB0PXB0O3RoaXMuZGVTdGFyPWRlU3Rhcnx8bmV3IERpcmVjdGVkRWRnZVN0YXIoKTt9O05vZGUucHJvdG90eXBlPW5ldyBHcmFwaENvbXBvbmVudCgpO05vZGUuZ2V0RWRnZXNCZXR3ZWVuPWZ1bmN0aW9uKG5vZGUwLG5vZGUxKXt2YXIgZWRnZXMwPURpcmVjdGVkRWRnZS50b0VkZ2VzKG5vZGUwLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKSk7dmFyIGNvbW1vbkVkZ2VzPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaFNldChlZGdlczApO3ZhciBlZGdlczE9RGlyZWN0ZWRFZGdlLnRvRWRnZXMobm9kZTEuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpKTtjb21tb25FZGdlcy5yZXRhaW5BbGwoZWRnZXMxKTtyZXR1cm4gY29tbW9uRWRnZXM7fTtOb2RlLnByb3RvdHlwZS5wdD1udWxsO05vZGUucHJvdG90eXBlLmRlU3Rhcj1udWxsO05vZGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O05vZGUucHJvdG90eXBlLmFkZE91dEVkZ2U9ZnVuY3Rpb24oZGUpe3RoaXMuZGVTdGFyLmFkZChkZSk7fTtOb2RlLnByb3RvdHlwZS5nZXRPdXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlU3Rhcjt9O05vZGUucHJvdG90eXBlLmdldERlZ3JlZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlU3Rhci5nZXREZWdyZWUoKTt9O05vZGUucHJvdG90eXBlLmdldEluZGV4PWZ1bmN0aW9uKGVkZ2Upe3JldHVybiB0aGlzLmRlU3Rhci5nZXRJbmRleChlZGdlKTt9O05vZGUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihkZSl7aWYoZGU9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLnJlbW92ZTIoKTt9XG50aGlzLmRlU3Rhci5yZW1vdmUoZGUpO307Tm9kZS5wcm90b3R5cGUucmVtb3ZlMj1mdW5jdGlvbigpe3RoaXMucHQ9bnVsbDt9O05vZGUucHJvdG90eXBlLmlzUmVtb3ZlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0PT1udWxsO307anN0cy5wbGFuYXJncmFwaC5Ob2RlPU5vZGU7fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZU1hcD1mdW5jdGlvbigpe3RoaXMubm9kZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTt9O05vZGVNYXAucHJvdG90eXBlLm5vZGVNYXA9bnVsbDtOb2RlTWFwLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24obil7dGhpcy5ub2RlTWFwLnB1dChuLmdldENvb3JkaW5hdGUoKSxuKTtyZXR1cm4gbjt9O05vZGVNYXAucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihwdCl7cmV0dXJuIHRoaXMubm9kZU1hcC5yZW1vdmUocHQpO307Tm9kZU1hcC5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihjb29yZCl7cmV0dXJuIHRoaXMubm9kZU1hcC5nZXQoY29vcmQpO307Tm9kZU1hcC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpLml0ZXJhdG9yKCk7fTtOb2RlTWFwLnByb3RvdHlwZS52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpO307anN0cy5wbGFuYXJncmFwaC5Ob2RlTWFwPU5vZGVNYXA7fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIFBsYW5hckdyYXBoPWZ1bmN0aW9uKCl7dGhpcy5lZGdlcz1uZXcgamF2YXNjcmlwdC51dGlsLkhhc2hTZXQoKTt0aGlzLmRpckVkZ2VzPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaFNldCgpO3RoaXMubm9kZU1hcD1uZXcganN0cy5wbGFuYXJncmFwaC5Ob2RlTWFwKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZWRnZXM9bnVsbDtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZGlyRWRnZXM9bnVsbDtQbGFuYXJHcmFwaC5wcm90b3R5cGUubm9kZU1hcD1udWxsO1BsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kTm9kZT1mdW5jdGlvbihwdCl7cmV0dXJuIHRoaXMubm9kZU1hcC5maW5kKHB0KTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24obm9kZSl7aWYobm9kZSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguRWRnZSl7cmV0dXJuIHRoaXMuYWRkMihub2RlKTt9ZWxzZSBpZihub2RlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2Upe3JldHVybiB0aGlzLmFkZDMobm9kZSk7fVxudGhpcy5ub2RlTWFwLmFkZChub2RlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKGVkZ2Upe3RoaXMuZWRnZXMuYWRkKGVkZ2UpO3RoaXMuYWRkKGVkZ2UuZ2V0RGlyRWRnZSgwKSk7dGhpcy5hZGQoZWRnZS5nZXREaXJFZGdlKDEpKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5hZGQzPWZ1bmN0aW9uKGRpckVkZ2Upe3RoaXMuZGlyRWRnZXMuYWRkKGRpckVkZ2UpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLm5vZGVJdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAuaXRlcmF0b3IoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5EaXJlY3RlZEVkZ2Upe3JldHVybiB0aGlzLmNvbnRhaW5zMihlKTt9XG5yZXR1cm4gdGhpcy5lZGdlcy5jb250YWlucyhlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5jb250YWluczI9ZnVuY3Rpb24oZGUpe3JldHVybiB0aGlzLmRpckVkZ2VzLmNvbnRhaW5zKGRlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5nZXROb2Rlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZGlyRWRnZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlyRWRnZXMuaXRlcmF0b3IoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlcy5pdGVyYXRvcigpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXM7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGVkZ2Upe2lmKGVkZ2UgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMucmVtb3ZlMihlZGdlKTt9XG50aGlzLnJlbW92ZShlZGdlLmdldERpckVkZ2UoMCkpO3RoaXMucmVtb3ZlKGVkZ2UuZ2V0RGlyRWRnZSgxKSk7dGhpcy5lZGdlcy5yZW1vdmUoZWRnZSk7dGhpcy5lZGdlLnJlbW92ZSgpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLnJlbW92ZTI9ZnVuY3Rpb24oZGUpe2lmKGRlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5Ob2RlKXtyZXR1cm4gdGhpcy5yZW1vdmUzKGRlKTt9XG52YXIgc3ltPWRlLmdldFN5bSgpO2lmKHN5bSE9bnVsbClcbnN5bS5zZXRTeW0obnVsbCk7ZGUuZ2V0RnJvbU5vZGUoKS5yZW1vdmUoZGUpO2RlLnJlbW92ZSgpO3RoaXMuZGlyRWRnZXMucmVtb3ZlKGRlKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5yZW1vdmUzPWZ1bmN0aW9uKG5vZGUpe3ZhciBvdXRFZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTtmb3IodmFyIGk9b3V0RWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTt2YXIgc3ltPWRlLmdldFN5bSgpO2lmKHN5bSE9bnVsbClcbnRoaXMucmVtb3ZlKHN5bSk7dGhpcy5kaXJFZGdlcy5yZW1vdmUoZGUpO3ZhciBlZGdlPWRlLmdldEVkZ2UoKTtpZihlZGdlIT1udWxsKXt0aGlzLmVkZ2VzLnJlbW92ZShlZGdlKTt9fVxudGhpcy5ub2RlTWFwLnJlbW92ZShub2RlLmdldENvb3JkaW5hdGUoKSk7bm9kZS5yZW1vdmUoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kTm9kZXNPZkRlZ3JlZT1mdW5jdGlvbihkZWdyZWUpe3ZhciBub2Rlc0ZvdW5kPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5ub2RlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBub2RlPWkubmV4dCgpO2lmKG5vZGUuZ2V0RGVncmVlKCk9PWRlZ3JlZSlcbm5vZGVzRm91bmQuYWRkKG5vZGUpO31cbnJldHVybiBub2Rlc0ZvdW5kO307anN0cy5wbGFuYXJncmFwaC5QbGFuYXJHcmFwaD1QbGFuYXJHcmFwaDt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgU3RhY2s9amF2YXNjcmlwdC51dGlsLlN0YWNrO3ZhciBIYXNoU2V0PWphdmFzY3JpcHQudXRpbC5IYXNoU2V0O3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDt2YXIgRWRnZVJpbmc9anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5FZGdlUmluZzt2YXIgUG9seWdvbml6ZUVkZ2U9anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZTt2YXIgUG9seWdvbml6ZURpcmVjdGVkRWRnZT1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVEaXJlY3RlZEVkZ2U7dmFyIFBsYW5hckdyYXBoPWpzdHMucGxhbmFyZ3JhcGguUGxhbmFyR3JhcGg7dmFyIE5vZGU9anN0cy5wbGFuYXJncmFwaC5Ob2RlO3ZhciBQb2x5Z29uaXplR3JhcGg9ZnVuY3Rpb24oZmFjdG9yeSl7UGxhbmFyR3JhcGguYXBwbHkodGhpcyk7dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlPW5ldyBQbGFuYXJHcmFwaCgpO1BvbHlnb25pemVHcmFwaC5nZXREZWdyZWVOb25EZWxldGVkPWZ1bmN0aW9uKG5vZGUpe3ZhciBlZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTt2YXIgZGVncmVlPTA7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoIWRlLmlzTWFya2VkKCkpXG5kZWdyZWUrKzt9XG5yZXR1cm4gZGVncmVlO307UG9seWdvbml6ZUdyYXBoLmdldERlZ3JlZT1mdW5jdGlvbihub2RlLGxhYmVsKXt2YXIgZWRnZXM9bm9kZS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCk7dmFyIGRlZ3JlZT0wO2Zvcih2YXIgaT1lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmdldExhYmVsKCk9PWxhYmVsKVxuZGVncmVlKys7fVxucmV0dXJuIGRlZ3JlZTt9O1BvbHlnb25pemVHcmFwaC5kZWxldGVBbGxFZGdlcz1mdW5jdGlvbihub2RlKXt2YXIgZWRnZXM9bm9kZS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCk7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7ZGUuc2V0TWFya2VkKHRydWUpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltIT1udWxsKVxuc3ltLnNldE1hcmtlZCh0cnVlKTt9fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmZhY3Rvcnk9bnVsbDtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmFkZEVkZ2U9ZnVuY3Rpb24obGluZSl7aWYobGluZS5pc0VtcHR5KCkpe3JldHVybjt9XG52YXIgbGluZVB0cz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhsaW5lLmdldENvb3JkaW5hdGVzKCkpO2lmKGxpbmVQdHMubGVuZ3RoPDIpe3JldHVybjt9XG52YXIgc3RhcnRQdD1saW5lUHRzWzBdO3ZhciBlbmRQdD1saW5lUHRzW2xpbmVQdHMubGVuZ3RoLTFdO3ZhciBuU3RhcnQ9dGhpcy5nZXROb2RlKHN0YXJ0UHQpO3ZhciBuRW5kPXRoaXMuZ2V0Tm9kZShlbmRQdCk7dmFyIGRlMD1uZXcgUG9seWdvbml6ZURpcmVjdGVkRWRnZShuU3RhcnQsbkVuZCxsaW5lUHRzWzFdLHRydWUpO3ZhciBkZTE9bmV3IFBvbHlnb25pemVEaXJlY3RlZEVkZ2UobkVuZCxuU3RhcnQsbGluZVB0c1tsaW5lUHRzLmxlbmd0aC0yXSxmYWxzZSk7dmFyIGVkZ2U9bmV3IFBvbHlnb25pemVFZGdlKGxpbmUpO2VkZ2Uuc2V0RGlyZWN0ZWRFZGdlcyhkZTAsZGUxKTt0aGlzLmFkZChlZGdlKTt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZ2V0Tm9kZT1mdW5jdGlvbihwdCl7dmFyIG5vZGU9dGhpcy5maW5kTm9kZShwdCk7aWYobm9kZT09bnVsbCl7bm9kZT1uZXcgTm9kZShwdCk7dGhpcy5hZGQobm9kZSk7fVxucmV0dXJuIG5vZGU7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmNvbXB1dGVOZXh0Q1dFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgaU5vZGU9dGhpcy5ub2RlSXRlcmF0b3IoKTtpTm9kZS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pTm9kZS5uZXh0KCk7UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q1dFZGdlcyhub2RlKTt9fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmNvbnZlcnRNYXhpbWFsVG9NaW5pbWFsRWRnZVJpbmdzPWZ1bmN0aW9uKHJpbmdFZGdlcyl7Zm9yKHZhciBpPXJpbmdFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO3ZhciBpbnROb2Rlcz1Qb2x5Z29uaXplR3JhcGguZmluZEludGVyc2VjdGlvbk5vZGVzKGRlLGxhYmVsKTtpZihpbnROb2Rlcz09bnVsbClcbmNvbnRpbnVlO2Zvcih2YXIgaU5vZGU9aW50Tm9kZXMuaXRlcmF0b3IoKTtpTm9kZS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pTm9kZS5uZXh0KCk7UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q0NXRWRnZXMobm9kZSxsYWJlbCk7fX19O1BvbHlnb25pemVHcmFwaC5maW5kSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oc3RhcnRERSxsYWJlbCl7dmFyIGRlPXN0YXJ0REU7dmFyIGludE5vZGVzPW51bGw7ZG97dmFyIG5vZGU9ZGUuZ2V0RnJvbU5vZGUoKTtpZihQb2x5Z29uaXplR3JhcGguZ2V0RGVncmVlKG5vZGUsbGFiZWwpPjEpe2lmKGludE5vZGVzPT1udWxsKVxuaW50Tm9kZXM9bmV3IEFycmF5TGlzdCgpO2ludE5vZGVzLmFkZChub2RlKTt9XG5kZT1kZS5nZXROZXh0KCk7QXNzZXJ0LmlzVHJ1ZShkZSE9bnVsbCwnZm91bmQgbnVsbCBERSBpbiByaW5nJyk7QXNzZXJ0LmlzVHJ1ZShkZT09c3RhcnRERXx8IWRlLmlzSW5SaW5nKCksJ2ZvdW5kIERFIGFscmVhZHkgaW4gcmluZycpO313aGlsZShkZSE9c3RhcnRERSk7cmV0dXJuIGludE5vZGVzO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5nZXRFZGdlUmluZ3M9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVOZXh0Q1dFZGdlcygpO1BvbHlnb25pemVHcmFwaC5sYWJlbCh0aGlzLmRpckVkZ2VzLC0xKTt2YXIgbWF4aW1hbFJpbmdzPVBvbHlnb25pemVHcmFwaC5maW5kTGFiZWxlZEVkZ2VSaW5ncyh0aGlzLmRpckVkZ2VzKTt0aGlzLmNvbnZlcnRNYXhpbWFsVG9NaW5pbWFsRWRnZVJpbmdzKG1heGltYWxSaW5ncyk7dmFyIGVkZ2VSaW5nTGlzdD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPXRoaXMuZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZihkZS5pc01hcmtlZCgpKVxuY29udGludWU7aWYoZGUuaXNJblJpbmcoKSlcbmNvbnRpbnVlO3ZhciBlcj10aGlzLmZpbmRFZGdlUmluZyhkZSk7ZWRnZVJpbmdMaXN0LmFkZChlcik7fVxucmV0dXJuIGVkZ2VSaW5nTGlzdDt9O1BvbHlnb25pemVHcmFwaC5maW5kTGFiZWxlZEVkZ2VSaW5ncz1mdW5jdGlvbihkaXJFZGdlcyl7dmFyIGVkZ2VSaW5nU3RhcnRzPW5ldyBBcnJheUxpc3QoKTt2YXIgY3VyckxhYmVsPTE7Zm9yKHZhciBpPWRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuaXNNYXJrZWQoKSlcbmNvbnRpbnVlO2lmKGRlLmdldExhYmVsKCk+PTApXG5jb250aW51ZTtlZGdlUmluZ1N0YXJ0cy5hZGQoZGUpO3ZhciBlZGdlcz1Qb2x5Z29uaXplR3JhcGguZmluZERpckVkZ2VzSW5SaW5nKGRlKTtQb2x5Z29uaXplR3JhcGgubGFiZWwoZWRnZXMsY3VyckxhYmVsKTtjdXJyTGFiZWwrKzt9XG5yZXR1cm4gZWRnZVJpbmdTdGFydHM7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmRlbGV0ZUN1dEVkZ2VzPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTmV4dENXRWRnZXMoKTtQb2x5Z29uaXplR3JhcGguZmluZExhYmVsZWRFZGdlUmluZ3ModGhpcy5kaXJFZGdlcyk7dmFyIGN1dExpbmVzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5kaXJFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmlzTWFya2VkKCkpXG5jb250aW51ZTt2YXIgc3ltPWRlLmdldFN5bSgpO2lmKGRlLmdldExhYmVsKCk9PXN5bS5nZXRMYWJlbCgpKXtkZS5zZXRNYXJrZWQodHJ1ZSk7c3ltLnNldE1hcmtlZCh0cnVlKTt2YXIgZT1kZS5nZXRFZGdlKCk7Y3V0TGluZXMuYWRkKGUuZ2V0TGluZSgpKTt9fVxucmV0dXJuIGN1dExpbmVzO307UG9seWdvbml6ZUdyYXBoLmxhYmVsPWZ1bmN0aW9uKGRpckVkZ2VzLGxhYmVsKXtmb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtkZS5zZXRMYWJlbChsYWJlbCk7fX07UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q1dFZGdlcz1mdW5jdGlvbihub2RlKXt2YXIgZGVTdGFyPW5vZGUuZ2V0T3V0RWRnZXMoKTt2YXIgc3RhcnRERT1udWxsO3ZhciBwcmV2REU9bnVsbDtmb3IodmFyIGk9ZGVTdGFyLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBvdXRERT1pLm5leHQoKTtpZihvdXRERS5pc01hcmtlZCgpKVxuY29udGludWU7aWYoc3RhcnRERT09bnVsbClcbnN0YXJ0REU9b3V0REU7aWYocHJldkRFIT1udWxsKXt2YXIgc3ltPXByZXZERS5nZXRTeW0oKTtzeW0uc2V0TmV4dChvdXRERSk7fVxucHJldkRFPW91dERFO31cbmlmKHByZXZERSE9bnVsbCl7dmFyIHN5bT1wcmV2REUuZ2V0U3ltKCk7c3ltLnNldE5leHQoc3RhcnRERSk7fX07UG9seWdvbml6ZUdyYXBoLmNvbXB1dGVOZXh0Q0NXRWRnZXM9ZnVuY3Rpb24obm9kZSxsYWJlbCl7dmFyIGRlU3Rhcj1ub2RlLmdldE91dEVkZ2VzKCk7dmFyIGZpcnN0T3V0REU9bnVsbDt2YXIgcHJldkluREU9bnVsbDt2YXIgZWRnZXM9ZGVTdGFyLmdldEVkZ2VzKCk7Zm9yKHZhciBpPWVkZ2VzLnNpemUoKS0xO2k+PTA7aS0tKXt2YXIgZGU9ZWRnZXMuZ2V0KGkpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7dmFyIG91dERFPW51bGw7aWYoZGUuZ2V0TGFiZWwoKT09bGFiZWwpXG5vdXRERT1kZTt2YXIgaW5ERT1udWxsO2lmKHN5bS5nZXRMYWJlbCgpPT1sYWJlbClcbmluREU9c3ltO2lmKG91dERFPT1udWxsJiZpbkRFPT1udWxsKVxuY29udGludWU7aWYoaW5ERSE9bnVsbCl7cHJldkluREU9aW5ERTt9XG5pZihvdXRERSE9bnVsbCl7aWYocHJldkluREUhPW51bGwpe3ByZXZJbkRFLnNldE5leHQob3V0REUpO3ByZXZJbkRFPW51bGw7fVxuaWYoZmlyc3RPdXRERT09bnVsbClcbmZpcnN0T3V0REU9b3V0REU7fX1cbmlmKHByZXZJbkRFIT1udWxsKXtBc3NlcnQuaXNUcnVlKGZpcnN0T3V0REUhPW51bGwpO3ByZXZJbkRFLnNldE5leHQoZmlyc3RPdXRERSk7fX07UG9seWdvbml6ZUdyYXBoLmZpbmREaXJFZGdlc0luUmluZz1mdW5jdGlvbihzdGFydERFKXt2YXIgZGU9c3RhcnRERTt2YXIgZWRnZXM9bmV3IEFycmF5TGlzdCgpO2Rve2VkZ2VzLmFkZChkZSk7ZGU9ZGUuZ2V0TmV4dCgpO0Fzc2VydC5pc1RydWUoZGUhPW51bGwsJ2ZvdW5kIG51bGwgREUgaW4gcmluZycpO0Fzc2VydC5pc1RydWUoZGU9PXN0YXJ0REV8fCFkZS5pc0luUmluZygpLCdmb3VuZCBERSBhbHJlYWR5IGluIHJpbmcnKTt9d2hpbGUoZGUhPXN0YXJ0REUpO3JldHVybiBlZGdlczt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZmluZEVkZ2VSaW5nPWZ1bmN0aW9uKHN0YXJ0REUpe3ZhciBkZT1zdGFydERFO3ZhciBlcj1uZXcgRWRnZVJpbmcodGhpcy5mYWN0b3J5KTtkb3tlci5hZGQoZGUpO2RlLnNldFJpbmcoZXIpO2RlPWRlLmdldE5leHQoKTtBc3NlcnQuaXNUcnVlKGRlIT1udWxsLCdmb3VuZCBudWxsIERFIGluIHJpbmcnKTtBc3NlcnQuaXNUcnVlKGRlPT1zdGFydERFfHwhZGUuaXNJblJpbmcoKSwnZm91bmQgREUgYWxyZWFkeSBpbiByaW5nJyk7fXdoaWxlKGRlIT1zdGFydERFKTtyZXR1cm4gZXI7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmRlbGV0ZURhbmdsZXM9ZnVuY3Rpb24oKXt2YXIgbm9kZXNUb1JlbW92ZT10aGlzLmZpbmROb2Rlc09mRGVncmVlKDEpO3ZhciBkYW5nbGVMaW5lcz1uZXcgSGFzaFNldCgpO3ZhciBub2RlU3RhY2s9bmV3IFN0YWNrKCk7Zm9yKHZhciBpPW5vZGVzVG9SZW1vdmUuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe25vZGVTdGFjay5wdXNoKGkubmV4dCgpKTt9XG53aGlsZSghbm9kZVN0YWNrLmlzRW1wdHkoKSl7dmFyIG5vZGU9bm9kZVN0YWNrLnBvcCgpO1BvbHlnb25pemVHcmFwaC5kZWxldGVBbGxFZGdlcyhub2RlKTt2YXIgbm9kZU91dEVkZ2VzPW5vZGUuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpO2Zvcih2YXIgaT1ub2RlT3V0RWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtkZS5zZXRNYXJrZWQodHJ1ZSk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihzeW0hPW51bGwpXG5zeW0uc2V0TWFya2VkKHRydWUpO3ZhciBlPWRlLmdldEVkZ2UoKTtkYW5nbGVMaW5lcy5hZGQoZS5nZXRMaW5lKCkpO3ZhciB0b05vZGU9ZGUuZ2V0VG9Ob2RlKCk7aWYoUG9seWdvbml6ZUdyYXBoLmdldERlZ3JlZU5vbkRlbGV0ZWQodG9Ob2RlKT09MSlcbm5vZGVTdGFjay5wdXNoKHRvTm9kZSk7fX1cbnJldHVybiBkYW5nbGVMaW5lczt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29tcHV0ZURlcHRoUGFyaXR5PWZ1bmN0aW9uKCl7d2hpbGUodHJ1ZSl7dmFyIGRlPW51bGw7aWYoZGU9PW51bGwpXG5yZXR1cm47dGhpcy5jb21wdXRlRGVwdGhQYXJpdHkoZGUpO319O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29tcHV0ZURlcHRoUGFyaXR5PWZ1bmN0aW9uKGRlKXt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUdyYXBoPVBvbHlnb25pemVHcmFwaDt9KSgpO2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbD1mdW5jdGlvbigpe3ZhciBvdGhlcjtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7b3RoZXI9YXJndW1lbnRzWzBdO3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwob3RoZXIubWluLG90aGVyLm1heCk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMubWluPD10aGlzLm1heCk7dGhpcy5taW49YXJndW1lbnRzWzBdO3RoaXMubWF4PWFyZ3VtZW50c1sxXTt9fTtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLm1pbj1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUubWF4PW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5nZXRDZW50cmU9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5taW4rdGhpcy5tYXgpLzI7fTtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZT1mdW5jdGlvbihvdGhlcil7dGhpcy5tYXg9TWF0aC5tYXgodGhpcy5tYXgsb3RoZXIubWF4KTt0aGlzLm1pbj1NYXRoLm1pbih0aGlzLm1pbixvdGhlci5taW4pO3JldHVybiB0aGlzO307anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4hKG90aGVyLm1pbj50aGlzLm1heHx8b3RoZXIubWF4PHRoaXMubWluKTt9O2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG8pe2lmKCEobyBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbCkpe3JldHVybiBmYWxzZTt9XG5vdGhlcj1vO3JldHVybiB0aGlzLm1pbj09PW90aGVyLm1pbiYmdGhpcy5tYXg9PT1vdGhlci5tYXg7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5PWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsKXt0aGlzLnByZWNpc2lvbk1vZGVsPXByZWNpc2lvbk1vZGVsfHxuZXcganN0cy5nZW9tLlByZWNpc2lvbk1vZGVsKCk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5wcmVjaXNpb25Nb2RlbD1udWxsO2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmdldFByZWNpc2lvbk1vZGVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJlY2lzaW9uTW9kZWw7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVQb2ludD1mdW5jdGlvbihjb29yZGluYXRlKXt2YXIgcG9pbnQ9bmV3IGpzdHMuZ2VvbS5Qb2ludChjb29yZGluYXRlLHRoaXMpO3JldHVybiBwb2ludDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZUxpbmVTdHJpbmc9ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe3ZhciBsaW5lU3RyaW5nPW5ldyBqc3RzLmdlb20uTGluZVN0cmluZyhjb29yZGluYXRlcyx0aGlzKTtyZXR1cm4gbGluZVN0cmluZzt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZUxpbmVhclJpbmc9ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe3ZhciBsaW5lYXJSaW5nPW5ldyBqc3RzLmdlb20uTGluZWFyUmluZyhjb29yZGluYXRlcyx0aGlzKTtyZXR1cm4gbGluZWFyUmluZzt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZVBvbHlnb249ZnVuY3Rpb24oc2hlbGwsaG9sZXMpe3ZhciBwb2x5Z29uPW5ldyBqc3RzLmdlb20uUG9seWdvbihzaGVsbCxob2xlcyx0aGlzKTtyZXR1cm4gcG9seWdvbjt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU11bHRpUG9pbnQ9ZnVuY3Rpb24ocG9pbnRzKXtpZihwb2ludHMmJnBvaW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3ZhciBjb252ZXJ0ZWQ9W107dmFyIGk7Zm9yKGk9MDtpPHBvaW50cy5sZW5ndGg7aSsrKXtjb252ZXJ0ZWQucHVzaCh0aGlzLmNyZWF0ZVBvaW50KHBvaW50c1tpXSkpO31cbnBvaW50cz1jb252ZXJ0ZWQ7fVxucmV0dXJuIG5ldyBqc3RzLmdlb20uTXVsdGlQb2ludChwb2ludHMsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVNdWx0aUxpbmVTdHJpbmc9ZnVuY3Rpb24obGluZVN0cmluZ3Mpe3JldHVybiBuZXcganN0cy5nZW9tLk11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyx0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU11bHRpUG9seWdvbj1mdW5jdGlvbihwb2x5Z29ucyl7cmV0dXJuIG5ldyBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKHBvbHlnb25zLHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuYnVpbGRHZW9tZXRyeT1mdW5jdGlvbihnZW9tTGlzdCl7dmFyIGdlb21DbGFzcz1udWxsO3ZhciBpc0hldGVyb2dlbmVvdXM9ZmFsc2U7dmFyIGhhc0dlb21ldHJ5Q29sbGVjdGlvbj1mYWxzZTtmb3IodmFyIGk9Z2VvbUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBnZW9tPWkubmV4dCgpO3ZhciBwYXJ0Q2xhc3M9Z2VvbS5DTEFTU19OQU1FO2lmKGdlb21DbGFzcz09PW51bGwpe2dlb21DbGFzcz1wYXJ0Q2xhc3M7fVxuaWYoIShwYXJ0Q2xhc3M9PT1nZW9tQ2xhc3MpKXtpc0hldGVyb2dlbmVvdXM9dHJ1ZTt9XG5pZihnZW9tLmlzR2VvbWV0cnlDb2xsZWN0aW9uQmFzZSgpKVxuaGFzR2VvbWV0cnlDb2xsZWN0aW9uPXRydWU7fVxuaWYoZ2VvbUNsYXNzPT09bnVsbCl7cmV0dXJuIHRoaXMuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbmlmKGlzSGV0ZXJvZ2VuZW91c3x8aGFzR2VvbWV0cnlDb2xsZWN0aW9uKXtyZXR1cm4gdGhpcy5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oZ2VvbUxpc3QudG9BcnJheSgpKTt9XG52YXIgZ2VvbTA9Z2VvbUxpc3QuZ2V0KDApO3ZhciBpc0NvbGxlY3Rpb249Z2VvbUxpc3Quc2l6ZSgpPjE7aWYoaXNDb2xsZWN0aW9uKXtpZihnZW9tMCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXtyZXR1cm4gdGhpcy5jcmVhdGVNdWx0aVBvbHlnb24oZ2VvbUxpc3QudG9BcnJheSgpKTt9ZWxzZSBpZihnZW9tMCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXtyZXR1cm4gdGhpcy5jcmVhdGVNdWx0aUxpbmVTdHJpbmcoZ2VvbUxpc3QudG9BcnJheSgpKTt9ZWxzZSBpZihnZW9tMCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7cmV0dXJuIHRoaXMuY3JlYXRlTXVsdGlQb2ludChnZW9tTGlzdC50b0FycmF5KCkpO31cbmpzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoJ1VuaGFuZGxlZCBjbGFzczogJytnZW9tMCk7fVxucmV0dXJuIGdlb20wO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKGdlb21ldHJpZXMpe3JldHVybiBuZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzLHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUudG9HZW9tZXRyeT1mdW5jdGlvbihlbnZlbG9wZSl7aWYoZW52ZWxvcGUuaXNOdWxsKCkpe3JldHVybiB0aGlzLmNyZWF0ZVBvaW50KG51bGwpO31cbmlmKGVudmVsb3BlLmdldE1pblgoKT09PWVudmVsb3BlLmdldE1heFgoKSYmZW52ZWxvcGUuZ2V0TWluWSgpPT09ZW52ZWxvcGUuZ2V0TWF4WSgpKXtyZXR1cm4gdGhpcy5jcmVhdGVQb2ludChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1pblkoKSkpO31cbmlmKGVudmVsb3BlLmdldE1pblgoKT09PWVudmVsb3BlLmdldE1heFgoKXx8ZW52ZWxvcGUuZ2V0TWluWSgpPT09ZW52ZWxvcGUuZ2V0TWF4WSgpKXtyZXR1cm4gdGhpcy5jcmVhdGVMaW5lU3RyaW5nKFtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1pblkoKSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1heFgoKSxlbnZlbG9wZS5nZXRNYXhZKCkpXSk7fVxucmV0dXJuIHRoaXMuY3JlYXRlUG9seWdvbih0aGlzLmNyZWF0ZUxpbmVhclJpbmcoW25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1heFkoKSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1heFgoKSxlbnZlbG9wZS5nZXRNYXhZKCkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNYXhYKCksZW52ZWxvcGUuZ2V0TWluWSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGVudmVsb3BlLmdldE1pblkoKSldKSxudWxsKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVGYWN0b3J5PWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5Ob2RlRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihjb29yZCl7cmV0dXJuIG5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlKGNvb3JkLG51bGwpO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tZ3JhcGguUG9zaXRpb249ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OPTA7anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVD0xO2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUPTI7anN0cy5nZW9tZ3JhcGguUG9zaXRpb24ub3Bwb3NpdGU9ZnVuY3Rpb24ocG9zaXRpb24pe2lmKHBvc2l0aW9uPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCl7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUO31cbmlmKHBvc2l0aW9uPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpe3JldHVybiBqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUO31cbnJldHVybiBwb3NpdGlvbjt9O30pKCk7anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbj1mdW5jdGlvbigpe3RoaXMubG9jYXRpb249W107aWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3ZhciBvbj1hcmd1bWVudHNbMF07dmFyIGxlZnQ9YXJndW1lbnRzWzFdO3ZhciByaWdodD1hcmd1bWVudHNbMl07dGhpcy5pbml0KDMpO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dPW9uO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVF09bGVmdDt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUXT1yaWdodDt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24pe3ZhciBnbD1hcmd1bWVudHNbMF07dGhpcy5pbml0KGdsLmxvY2F0aW9uLmxlbmd0aCk7aWYoZ2whPW51bGwpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXt0aGlzLmxvY2F0aW9uW2ldPWdsLmxvY2F0aW9uW2ldO319fWVsc2UgaWYodHlwZW9mIGFyZ3VtZW50c1swXT09PSdudW1iZXInKXt2YXIgb249YXJndW1lbnRzWzBdO3RoaXMuaW5pdCgxKTt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXT1vbjt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIEFycmF5KXt2YXIgbG9jYXRpb249YXJndW1lbnRzWzBdO3RoaXMuaW5pdChsb2NhdGlvbi5sZW5ndGgpO319O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmxvY2F0aW9uPW51bGw7anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbihzaXplKXt0aGlzLmxvY2F0aW9uW3NpemUtMV09bnVsbDt0aGlzLnNldEFsbExvY2F0aW9ucyhqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24ocG9zSW5kZXgpe2lmKHBvc0luZGV4PHRoaXMubG9jYXRpb24ubGVuZ3RoKVxucmV0dXJuIHRoaXMubG9jYXRpb25bcG9zSW5kZXhdO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uTk9ORTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzTnVsbD1mdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldIT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pc0FueU51bGw9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaXNFcXVhbE9uU2lkZT1mdW5jdGlvbihsZSxsb2NJbmRleCl7cmV0dXJuIHRoaXMubG9jYXRpb25bbG9jSW5kZXhdPT1sZS5sb2NhdGlvbltsb2NJbmRleF07fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pc0FyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2NhdGlvbi5sZW5ndGg+MTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzTGluZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2F0aW9uLmxlbmd0aD09PTE7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5mbGlwPWZ1bmN0aW9uKCl7aWYodGhpcy5sb2NhdGlvbi5sZW5ndGg8PTEpXG5yZXR1cm47dmFyIHRlbXA9dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXTt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlRdPXRoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPXRlbXA7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5zZXRBbGxMb2NhdGlvbnM9ZnVuY3Rpb24obG9jVmFsdWUpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXt0aGlzLmxvY2F0aW9uW2ldPWxvY1ZhbHVlO319O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLnNldEFsbExvY2F0aW9uc0lmTnVsbD1mdW5jdGlvbihsb2NWYWx1ZSl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe2lmKHRoaXMubG9jYXRpb25baV09PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnRoaXMubG9jYXRpb25baV09bG9jVmFsdWU7fX07anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuc2V0TG9jYXRpb249ZnVuY3Rpb24obG9jSW5kZXgsbG9jVmFsdWUpe2lmKGxvY1ZhbHVlIT09dW5kZWZpbmVkKXt0aGlzLmxvY2F0aW9uW2xvY0luZGV4XT1sb2NWYWx1ZTt9ZWxzZXt0aGlzLnNldExvY2F0aW9uKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OLGxvY0luZGV4KTt9fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5nZXRMb2NhdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gbG9jYXRpb247fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5zZXRMb2NhdGlvbnM9ZnVuY3Rpb24ob24sbGVmdCxyaWdodCl7dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTl09b247dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXT1sZWZ0O3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPXJpZ2h0O307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuYWxsUG9zaXRpb25zRXF1YWw9ZnVuY3Rpb24obG9jKXtmb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXSE9PWxvYylcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLm1lcmdlPWZ1bmN0aW9uKGdsKXtpZihnbC5sb2NhdGlvbi5sZW5ndGg+dGhpcy5sb2NhdGlvbi5sZW5ndGgpe3ZhciBuZXdMb2M9W107bmV3TG9jW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXT10aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXTtuZXdMb2NbanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVF09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7bmV3TG9jW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUXT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTt0aGlzLmxvY2F0aW9uPW5ld0xvYzt9XG5mb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FJiZpPGdsLmxvY2F0aW9uLmxlbmd0aClcbnRoaXMubG9jYXRpb25baV09Z2wubG9jYXRpb25baV07fX07anN0cy5nZW9tZ3JhcGguTGFiZWw9ZnVuY3Rpb24oKXt0aGlzLmVsdD1bXTt2YXIgZ2VvbUluZGV4LG9uTG9jLGxlZnRMb2MsbGJsLHJpZ2h0TG9jO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT00KXtnZW9tSW5kZXg9YXJndW1lbnRzWzBdO29uTG9jPWFyZ3VtZW50c1sxXTtsZWZ0TG9jPWFyZ3VtZW50c1syXTtyaWdodExvYz1hcmd1bWVudHNbM107dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FLGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FLGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt0aGlzLmVsdFtnZW9tSW5kZXhdLnNldExvY2F0aW9ucyhvbkxvYyxsZWZ0TG9jLHJpZ2h0TG9jKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7b25Mb2M9YXJndW1lbnRzWzBdO2xlZnRMb2M9YXJndW1lbnRzWzFdO3JpZ2h0TG9jPWFyZ3VtZW50c1syXTt0aGlzLmVsdFswXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihvbkxvYyxsZWZ0TG9jLHJpZ2h0TG9jKTt0aGlzLmVsdFsxXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihvbkxvYyxsZWZ0TG9jLHJpZ2h0TG9jKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7Z2VvbUluZGV4PWFyZ3VtZW50c1swXTtvbkxvYz1hcmd1bWVudHNbMV07dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt0aGlzLmVsdFtnZW9tSW5kZXhdLnNldExvY2F0aW9uKG9uTG9jKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLkxhYmVsKXtsYmw9YXJndW1lbnRzWzBdO3RoaXMuZWx0WzBdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGxibC5lbHRbMF0pO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGxibC5lbHRbMV0pO31lbHNlIGlmKHR5cGVvZiBhcmd1bWVudHNbMF09PT0nbnVtYmVyJyl7b25Mb2M9YXJndW1lbnRzWzBdO3RoaXMuZWx0WzBdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jKTt0aGlzLmVsdFsxXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihvbkxvYyk7fX07anN0cy5nZW9tZ3JhcGguTGFiZWwudG9MaW5lTGFiZWw9ZnVuY3Rpb24obGFiZWwpe3ZhciBpLGxpbmVMYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO2ZvcihpPTA7aTwyO2krKyl7bGluZUxhYmVsLnNldExvY2F0aW9uKGksbGFiZWwuZ2V0TG9jYXRpb24oaSkpO31cbnJldHVybiBsaW5lTGFiZWw7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZWx0PW51bGw7anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24oKXt0aGlzLmVsdFswXS5mbGlwKCk7dGhpcy5lbHRbMV0uZmxpcCgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmdldExvY2F0aW9uPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7cmV0dXJuIHRoaXMuZ2V0TG9jYXRpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5yZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5nZXQocG9zSW5kZXgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmdldExvY2F0aW9uMj1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmdldChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0TG9jYXRpb249ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4LGxvY2F0aW9uKXtpZihhcmd1bWVudHMubGVuZ3RoPT0yKXt0aGlzLnNldExvY2F0aW9uMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb24ocG9zSW5kZXgsbG9jYXRpb24pO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnNldExvY2F0aW9uMj1mdW5jdGlvbihnZW9tSW5kZXgsbG9jYXRpb24pe3RoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb24oanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04sbG9jYXRpb24pO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnNldEFsbExvY2F0aW9ucz1mdW5jdGlvbihnZW9tSW5kZXgsbG9jYXRpb24pe3RoaXMuZWx0W2dlb21JbmRleF0uc2V0QWxsTG9jYXRpb25zKGxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5zZXRBbGxMb2NhdGlvbnNJZk51bGw9ZnVuY3Rpb24oZ2VvbUluZGV4LGxvY2F0aW9uKXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXt0aGlzLnNldEFsbExvY2F0aW9uc0lmTnVsbDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG50aGlzLmVsdFtnZW9tSW5kZXhdLnNldEFsbExvY2F0aW9uc0lmTnVsbChsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0QWxsTG9jYXRpb25zSWZOdWxsMj1mdW5jdGlvbihsb2NhdGlvbil7dGhpcy5zZXRBbGxMb2NhdGlvbnNJZk51bGwoMCxsb2NhdGlvbik7dGhpcy5zZXRBbGxMb2NhdGlvbnNJZk51bGwoMSxsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUubWVyZ2U9ZnVuY3Rpb24obGJsKXt2YXIgaTtmb3IoaT0wO2k8MjtpKyspe2lmKHRoaXMuZWx0W2ldPT09bnVsbCYmbGJsLmVsdFtpXSE9PW51bGwpe3RoaXMuZWx0W2ldPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKGxibC5lbHRbaV0pO31lbHNle3RoaXMuZWx0W2ldLm1lcmdlKGxibC5lbHRbaV0pO319fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZ2V0R2VvbWV0cnlDb3VudD1mdW5jdGlvbigpe3ZhciBjb3VudD0wO2lmKCF0aGlzLmVsdFswXS5pc051bGwoKSl7Y291bnQrKzt9XG5pZighdGhpcy5lbHRbMV0uaXNOdWxsKCkpe2NvdW50Kys7fVxucmV0dXJuIGNvdW50O307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzTnVsbD1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzTnVsbCgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzQW55TnVsbD1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzQW55TnVsbCgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzQXJlYT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe3JldHVybiB0aGlzLmlzQXJlYTIoYXJndW1lbnRzWzBdKTt9XG5yZXR1cm4gdGhpcy5lbHRbMF0uaXNBcmVhKCl8fHRoaXMuZWx0WzFdLmlzQXJlYSgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzQXJlYTI9ZnVuY3Rpb24oZ2VvbUluZGV4KXtyZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5pc0FyZWEoKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5pc0xpbmU9ZnVuY3Rpb24oZ2VvbUluZGV4KXtyZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5pc0xpbmUoKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5pc0VxdWFsT25TaWRlPWZ1bmN0aW9uKGxibCxzaWRlKXtyZXR1cm4gdGhpcy5lbHRbMF0uaXNFcXVhbE9uU2lkZShsYmwuZWx0WzBdLHNpZGUpJiZ0aGlzLmVsdFsxXS5pc0VxdWFsT25TaWRlKGxibC5lbHRbMV0sc2lkZSk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuYWxsUG9zaXRpb25zRXF1YWw9ZnVuY3Rpb24oZ2VvbUluZGV4LGxvYyl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uYWxsUG9zaXRpb25zRXF1YWwobG9jKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS50b0xpbmU9ZnVuY3Rpb24oZ2VvbUluZGV4KXtpZih0aGlzLmVsdFtnZW9tSW5kZXhdLmlzQXJlYSgpKXt0aGlzLmVsdFtnZW9tSW5kZXhdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKHRoaXMuZWx0W2dlb21JbmRleF0ubG9jYXRpb25bMF0pO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nPWZ1bmN0aW9uKHN0YXJ0LGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5lZGdlcz1bXTt0aGlzLnB0cz1bXTt0aGlzLmhvbGVzPVtdO3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnk7aWYoc3RhcnQpe3RoaXMuY29tcHV0ZVBvaW50cyhzdGFydCk7dGhpcy5jb21wdXRlUmluZygpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zdGFydERlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLm1heE5vZGVEZWdyZWU9LTE7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmVkZ2VzPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5sYWJlbD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5yaW5nPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLl9pc0hvbGU9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuc2hlbGw9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuaG9sZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2VvbWV0cnlGYWN0b3J5PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmlzSXNvbGF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5sYWJlbC5nZXRHZW9tZXRyeUNvdW50KCk9PTEpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmlzSG9sZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0hvbGU7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TGluZWFyUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJpbmc7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5pc1NoZWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGw9PT1udWxsO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmdldFNoZWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGw7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuc2V0U2hlbGw9ZnVuY3Rpb24oc2hlbGwpe3RoaXMuc2hlbGw9c2hlbGw7aWYoc2hlbGwhPT1udWxsKVxuc2hlbGwuYWRkSG9sZSh0aGlzKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5hZGRIb2xlPWZ1bmN0aW9uKHJpbmcpe3RoaXMuaG9sZXMucHVzaChyaW5nKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS50b1BvbHlnb249ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt2YXIgaG9sZUxSPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtob2xlTFJbaV09dGhpcy5ob2xlc1tpXS5nZXRMaW5lYXJSaW5nKCk7fVxudmFyIHBvbHk9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9seWdvbih0aGlzLmdldExpbmVhclJpbmcoKSxob2xlTFIpO3JldHVybiBwb2x5O307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmNvbXB1dGVSaW5nPWZ1bmN0aW9uKCl7aWYodGhpcy5yaW5nIT09bnVsbClcbnJldHVybjt2YXIgY29vcmQ9W107Zm9yKHZhciBpPTA7aTx0aGlzLnB0cy5sZW5ndGg7aSsrKXtjb29yZFtpXT10aGlzLnB0c1tpXTt9XG50aGlzLnJpbmc9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhjb29yZCk7dGhpcy5faXNIb2xlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyh0aGlzLnJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbihkZSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zZXRFZGdlUmluZz1mdW5jdGlvbihkZSxlcil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmNvbXB1dGVQb2ludHM9ZnVuY3Rpb24oc3RhcnQpe3RoaXMuc3RhcnREZT1zdGFydDt2YXIgZGU9c3RhcnQ7dmFyIGlzRmlyc3RFZGdlPXRydWU7ZG97aWYoZGU9PT1udWxsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignRm91bmQgbnVsbCBEaXJlY3RlZEVkZ2UnKTtpZihkZS5nZXRFZGdlUmluZygpPT09dGhpcylcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ0RpcmVjdGVkIEVkZ2UgdmlzaXRlZCB0d2ljZSBkdXJpbmcgcmluZy1idWlsZGluZyBhdCAnK1xuZGUuZ2V0Q29vcmRpbmF0ZSgpKTt0aGlzLmVkZ2VzLnB1c2goZGUpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKGxhYmVsLmlzQXJlYSgpKTt0aGlzLm1lcmdlTGFiZWwobGFiZWwpO3RoaXMuYWRkUG9pbnRzKGRlLmdldEVkZ2UoKSxkZS5pc0ZvcndhcmQoKSxpc0ZpcnN0RWRnZSk7aXNGaXJzdEVkZ2U9ZmFsc2U7dGhpcy5zZXRFZGdlUmluZyhkZSx0aGlzKTtkZT10aGlzLmdldE5leHQoZGUpO313aGlsZShkZSE9PXRoaXMuc3RhcnREZSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0TWF4Tm9kZURlZ3JlZT1mdW5jdGlvbigpe2lmKHRoaXMubWF4Tm9kZURlZ3JlZTwwKVxudGhpcy5jb21wdXRlTWF4Tm9kZURlZ3JlZSgpO3JldHVybiB0aGlzLm1heE5vZGVEZWdyZWU7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuY29tcHV0ZU1heE5vZGVEZWdyZWU9ZnVuY3Rpb24oKXt0aGlzLm1heE5vZGVEZWdyZWU9MDt2YXIgZGU9dGhpcy5zdGFydERlO2Rve3ZhciBub2RlPWRlLmdldE5vZGUoKTt2YXIgZGVncmVlPW5vZGUuZ2V0RWRnZXMoKS5nZXRPdXRnb2luZ0RlZ3JlZSh0aGlzKTtpZihkZWdyZWU+dGhpcy5tYXhOb2RlRGVncmVlKVxudGhpcy5tYXhOb2RlRGVncmVlPWRlZ3JlZTtkZT10aGlzLmdldE5leHQoZGUpO313aGlsZShkZSE9PXRoaXMuc3RhcnREZSk7dGhpcy5tYXhOb2RlRGVncmVlKj0yO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnNldEluUmVzdWx0PWZ1bmN0aW9uKCl7dmFyIGRlPXRoaXMuc3RhcnREZTtkb3tkZS5nZXRFZGdlKCkuc2V0SW5SZXN1bHQodHJ1ZSk7ZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9dGhpcy5zdGFydERlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5tZXJnZUxhYmVsPWZ1bmN0aW9uKGRlTGFiZWwpe3RoaXMubWVyZ2VMYWJlbDIoZGVMYWJlbCwwKTt0aGlzLm1lcmdlTGFiZWwyKGRlTGFiZWwsMSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUubWVyZ2VMYWJlbDI9ZnVuY3Rpb24oZGVMYWJlbCxnZW9tSW5kZXgpe3ZhciBsb2M9ZGVMYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKGxvYz09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5yZXR1cm47aWYodGhpcy5sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgpPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpe3RoaXMubGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LGxvYyk7cmV0dXJuO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5hZGRQb2ludHM9ZnVuY3Rpb24oZWRnZSxpc0ZvcndhcmQsaXNGaXJzdEVkZ2Upe3ZhciBlZGdlUHRzPWVkZ2UuZ2V0Q29vcmRpbmF0ZXMoKTtpZihpc0ZvcndhcmQpe3ZhciBzdGFydEluZGV4PTE7aWYoaXNGaXJzdEVkZ2UpXG5zdGFydEluZGV4PTA7Zm9yKHZhciBpPXN0YXJ0SW5kZXg7aTxlZGdlUHRzLmxlbmd0aDtpKyspe3RoaXMucHRzLnB1c2goZWRnZVB0c1tpXSk7fX1lbHNle3ZhciBzdGFydEluZGV4PWVkZ2VQdHMubGVuZ3RoLTI7aWYoaXNGaXJzdEVkZ2UpXG5zdGFydEluZGV4PWVkZ2VQdHMubGVuZ3RoLTE7Zm9yKHZhciBpPXN0YXJ0SW5kZXg7aT49MDtpLS0pe3RoaXMucHRzLnB1c2goZWRnZVB0c1tpXSk7fX19O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5jb250YWluc1BvaW50PWZ1bmN0aW9uKHApe3ZhciBzaGVsbD10aGlzLmdldExpbmVhclJpbmcoKTt2YXIgZW52PXNoZWxsLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighZW52LmNvbnRhaW5zKHApKVxucmV0dXJuIGZhbHNlO2lmKCFqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyhwLHNoZWxsLmdldENvb3JkaW5hdGVzKCkpKVxucmV0dXJuIGZhbHNlO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXt2YXIgaG9sZT10aGlzLmhvbGVzW2ldO2lmKGhvbGUuY29udGFpbnNQb2ludChwKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS5MaW5lYXJSaW5nPWZ1bmN0aW9uKHBvaW50cyxmYWN0b3J5KXtqc3RzLmdlb20uTGluZVN0cmluZy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5MaW5lU3RyaW5nKCk7anN0cy5nZW9tLkxpbmVhclJpbmcuY29uc3RydWN0b3I9anN0cy5nZW9tLkxpbmVhclJpbmc7anN0cy5nZW9tLkxpbmVhclJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGUuaXNTaW1wbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZS5nZXRHZW9tZXRyeVR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4nTGluZWFyUmluZyc7fTtqc3RzLmdlb20uTGluZWFyUmluZy5NSU5JTVVNX1ZBTElEX1NJWkU9NDtqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLkxpbmVhclJpbmcnO30pKCk7anN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZT1mdW5jdGlvbigpe307anN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZS5wcm90b3R5cGUuZ2V0Qm91bmRzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGU9ZnVuY3Rpb24obGV2ZWwpe3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5jaGlsZEJvdW5kYWJsZXM9W107fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZSgpO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUuY29uc3RydWN0b3I9anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5jaGlsZEJvdW5kYWJsZXM9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5ib3VuZHM9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5sZXZlbD1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmdldENoaWxkQm91bmRhYmxlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNoaWxkQm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmNvbXB1dGVCb3VuZHM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuZ2V0Qm91bmRzPWZ1bmN0aW9uKCl7aWYodGhpcy5ib3VuZHM9PT1udWxsKXt0aGlzLmJvdW5kcz10aGlzLmNvbXB1dGVCb3VuZHMoKTt9XG5yZXR1cm4gdGhpcy5ib3VuZHM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxldmVsO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuYWRkQ2hpbGRCb3VuZGFibGU9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGUpe3RoaXMuY2hpbGRCb3VuZGFibGVzLnB1c2goY2hpbGRCb3VuZGFibGUpO307KGZ1bmN0aW9uKCl7anN0cy5ub2RpbmcuTm9kZXI9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLk5vZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZXM9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuTm9kZXIucHJvdG90eXBlLmdldE5vZGVkU3Vic3RyaW5ncz1qc3RzLmFic3RyYWN0RnVuYzt9KSgpOyhmdW5jdGlvbigpe3ZhciBOb2Rlcj1qc3RzLm5vZGluZy5Ob2Rlcjtqc3RzLm5vZGluZy5TaW5nbGVQYXNzTm9kZXI9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlci5wcm90b3R5cGU9bmV3IE5vZGVyKCk7anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlcjtqc3RzLm5vZGluZy5TaW5nbGVQYXNzTm9kZXIucHJvdG90eXBlLnNlZ0ludD1udWxsO2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlci5wcm90b3R5cGUuc2V0U2VnbWVudEludGVyc2VjdG9yPWZ1bmN0aW9uKHNlZ0ludCl7dGhpcy5zZWdJbnQ9c2VnSW50O307fSkoKTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleD1mdW5jdGlvbigpe307anN0cy5pbmRleC5TcGF0aWFsSW5kZXgucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleC5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oc2VhcmNoRW52LHZpc2l0b3Ipe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWU9ZnVuY3Rpb24obm9kZUNhcGFjaXR5KXtpZihub2RlQ2FwYWNpdHk9PT11bmRlZmluZWQpXG5yZXR1cm47dGhpcy5pdGVtQm91bmRhYmxlcz1bXTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShub2RlQ2FwYWNpdHk+MSwnTm9kZSBjYXBhY2l0eSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAxJyk7dGhpcy5ub2RlQ2FwYWNpdHk9bm9kZUNhcGFjaXR5O307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5JbnRlcnNlY3RzT3A9ZnVuY3Rpb24oKXt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUuSW50ZXJzZWN0c09wLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKGFCb3VuZHMsYkJvdW5kcyl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJvb3Q9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5idWlsdD1mYWxzZTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pdGVtQm91bmRhYmxlcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLm5vZGVDYXBhY2l0eT1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmJ1aWxkPWZ1bmN0aW9uKCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIXRoaXMuYnVpbHQpO3RoaXMucm9vdD10aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTA/dGhpcy5jcmVhdGVOb2RlKDApOnRoaXMuY3JlYXRlSGlnaGVyTGV2ZWxzKHRoaXMuaXRlbUJvdW5kYWJsZXMsLTEpO3RoaXMuYnVpbHQ9dHJ1ZTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24obGV2ZWwpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzPWZ1bmN0aW9uKGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIShjaGlsZEJvdW5kYWJsZXMubGVuZ3RoPT09MCkpO3ZhciBwYXJlbnRCb3VuZGFibGVzPVtdO3BhcmVudEJvdW5kYWJsZXMucHVzaCh0aGlzLmNyZWF0ZU5vZGUobmV3TGV2ZWwpKTt2YXIgc29ydGVkQ2hpbGRCb3VuZGFibGVzPVtdO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3NvcnRlZENoaWxkQm91bmRhYmxlcy5wdXNoKGNoaWxkQm91bmRhYmxlc1tpXSk7fVxuc29ydGVkQ2hpbGRCb3VuZGFibGVzLnNvcnQodGhpcy5nZXRDb21wYXJhdG9yKCkpO2Zvcih2YXIgaT0wO2k8c29ydGVkQ2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1zb3J0ZWRDaGlsZEJvdW5kYWJsZXNbaV07aWYodGhpcy5sYXN0Tm9kZShwYXJlbnRCb3VuZGFibGVzKS5nZXRDaGlsZEJvdW5kYWJsZXMoKS5sZW5ndGg9PT10aGlzLmdldE5vZGVDYXBhY2l0eSgpKXtwYXJlbnRCb3VuZGFibGVzLnB1c2godGhpcy5jcmVhdGVOb2RlKG5ld0xldmVsKSk7fVxudGhpcy5sYXN0Tm9kZShwYXJlbnRCb3VuZGFibGVzKS5hZGRDaGlsZEJvdW5kYWJsZShjaGlsZEJvdW5kYWJsZSk7fVxucmV0dXJuIHBhcmVudEJvdW5kYWJsZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5sYXN0Tm9kZT1mdW5jdGlvbihub2Rlcyl7cmV0dXJuIG5vZGVzW25vZGVzLmxlbmd0aC0xXTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNvbXBhcmVEb3VibGVzPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE+Yj8xOmE8Yj8tMTowO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlSGlnaGVyTGV2ZWxzPWZ1bmN0aW9uKGJvdW5kYWJsZXNPZkFMZXZlbCxsZXZlbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIShib3VuZGFibGVzT2ZBTGV2ZWwubGVuZ3RoPT09MCkpO3ZhciBwYXJlbnRCb3VuZGFibGVzPXRoaXMuY3JlYXRlUGFyZW50Qm91bmRhYmxlcyhib3VuZGFibGVzT2ZBTGV2ZWwsbGV2ZWwrMSk7aWYocGFyZW50Qm91bmRhYmxlcy5sZW5ndGg9PT0xKXtyZXR1cm4gcGFyZW50Qm91bmRhYmxlc1swXTt9XG5yZXR1cm4gdGhpcy5jcmVhdGVIaWdoZXJMZXZlbHMocGFyZW50Qm91bmRhYmxlcyxsZXZlbCsxKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmdldFJvb3Q9ZnVuY3Rpb24oKXtpZighdGhpcy5idWlsdClcbnRoaXMuYnVpbGQoKTtyZXR1cm4gdGhpcy5yb290O307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZ2V0Tm9kZUNhcGFjaXR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZUNhcGFjaXR5O307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5zaXplMihhcmd1bWVudHNbMF0pO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxuaWYodGhpcy5pdGVtQm91bmRhYmxlcy5sZW5ndGg9PT0wKXtyZXR1cm4gMDt9XG5yZXR1cm4gdGhpcy5zaXplMihyb290KTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnNpemUyPWZ1bmN0aW9uKG5vZGUpe3ZhciBzaXplPTA7dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXtzaXplKz10aGlzLnNpemUoY2hpbGRCb3VuZGFibGUpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe3NpemUrPTE7fX1cbnJldHVybiBzaXplO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuZGVwdGgyKGFyZ3VtZW50c1swXSk7fVxuaWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG5pZih0aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTApe3JldHVybiAwO31cbnJldHVybiB0aGlzLmRlcHRoMihyb290KTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmRlcHRoMj1mdW5jdGlvbigpe3ZhciBtYXhDaGlsZERlcHRoPTA7dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt2YXIgY2hpbGREZXB0aD10aGlzLmRlcHRoKGNoaWxkQm91bmRhYmxlKTtpZihjaGlsZERlcHRoPm1heENoaWxkRGVwdGgpXG5tYXhDaGlsZERlcHRoPWNoaWxkRGVwdGg7fX1cbnJldHVybiBtYXhDaGlsZERlcHRoKzE7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oYm91bmRzLGl0ZW0pe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKCF0aGlzLmJ1aWx0LCdDYW5ub3QgaW5zZXJ0IGl0ZW1zIGludG8gYW4gU1RSIHBhY2tlZCBSLXRyZWUgYWZ0ZXIgaXQgaGFzIGJlZW4gYnVpbHQuJyk7dGhpcy5pdGVtQm91bmRhYmxlcy5wdXNoKG5ldyBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZShib3VuZHMsaXRlbSkpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oc2VhcmNoQm91bmRzKXtpZihhcmd1bWVudHMubGVuZ3RoPjEpe3RoaXMucXVlcnkyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbnZhciBtYXRjaGVzPVtdO2lmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5yb290LmdldEJvdW5kcygpPT09bnVsbCk7cmV0dXJuIG1hdGNoZXM7fVxuaWYodGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKHRoaXMucm9vdC5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXt0aGlzLnF1ZXJ5MyhzZWFyY2hCb3VuZHMsdGhpcy5yb290LG1hdGNoZXMpO31cbnJldHVybiBtYXRjaGVzO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnkyPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyx2aXNpdG9yKXtpZihhcmd1bWVudHMubGVuZ3RoPjIpe3RoaXMucXVlcnkzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbmlmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5yb290LmdldEJvdW5kcygpPT09bnVsbCk7fVxuaWYodGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKHRoaXMucm9vdC5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXt0aGlzLnF1ZXJ5NChzZWFyY2hCb3VuZHMsdGhpcy5yb290LHZpc2l0b3IpO319O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5Mz1mdW5jdGlvbihzZWFyY2hCb3VuZHMsbm9kZSxtYXRjaGVzKXtpZighKGFyZ3VtZW50c1syXWluc3RhbmNlb2YgQXJyYXkpKXt0aGlzLnF1ZXJ5NC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoIXRoaXMuZ2V0SW50ZXJzZWN0c09wKCkuaW50ZXJzZWN0cyhjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXtjb250aW51ZTt9XG5pZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe3RoaXMucXVlcnkzKHNlYXJjaEJvdW5kcyxjaGlsZEJvdW5kYWJsZSxtYXRjaGVzKTt9ZWxzZSBpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKXttYXRjaGVzLnB1c2goY2hpbGRCb3VuZGFibGUuZ2V0SXRlbSgpKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCk7fX19O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5ND1mdW5jdGlvbihzZWFyY2hCb3VuZHMsbm9kZSx2aXNpdG9yKXt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZighdGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe2NvbnRpbnVlO31cbmlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dGhpcy5xdWVyeTQoc2VhcmNoQm91bmRzLGNoaWxkQm91bmRhYmxlLHZpc2l0b3IpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe3Zpc2l0b3IudmlzaXRJdGVtKGNoaWxkQm91bmRhYmxlLmdldEl0ZW0oKSk7fWVsc2V7anN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgpO319fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5nZXRJbnRlcnNlY3RzT3A9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuaXRlbXNUcmVlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLml0ZW1zVHJlZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxudmFyIHZhbHVlc1RyZWU9dGhpcy5pdGVtc1RyZWUyKHRoaXMucm9vdCk7aWYodmFsdWVzVHJlZT09PW51bGwpXG5yZXR1cm5bXTtyZXR1cm4gdmFsdWVzVHJlZTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLml0ZW1zVHJlZTI9ZnVuY3Rpb24obm9kZSl7dmFyIHZhbHVlc1RyZWVGb3JOb2RlPVtdO3ZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dmFyIHZhbHVlc1RyZWVGb3JDaGlsZD10aGlzLml0ZW1zVHJlZShjaGlsZEJvdW5kYWJsZSk7aWYodmFsdWVzVHJlZUZvckNoaWxkIT1udWxsKVxudmFsdWVzVHJlZUZvck5vZGUucHVzaCh2YWx1ZXNUcmVlRm9yQ2hpbGQpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe3ZhbHVlc1RyZWVGb3JOb2RlLnB1c2goY2hpbGRCb3VuZGFibGUuZ2V0SXRlbSgpKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCk7fX1cbmlmKHZhbHVlc1RyZWVGb3JOb2RlLmxlbmd0aDw9MClcbnJldHVybiBudWxsO3JldHVybiB2YWx1ZXNUcmVlRm9yTm9kZTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihzZWFyY2hCb3VuZHMsaXRlbSl7aWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG5pZih0aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTApe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMucm9vdC5nZXRCb3VuZHMoKT09bnVsbCk7fVxuaWYodGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKHRoaXMucm9vdC5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXtyZXR1cm4gdGhpcy5yZW1vdmUyKHNlYXJjaEJvdW5kcyx0aGlzLnJvb3QsaXRlbSk7fVxucmV0dXJuIGZhbHNlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlMj1mdW5jdGlvbihzZWFyY2hCb3VuZHMsbm9kZSxpdGVtKXt2YXIgZm91bmQ9dGhpcy5yZW1vdmVJdGVtKG5vZGUsaXRlbSk7aWYoZm91bmQpXG5yZXR1cm4gdHJ1ZTt2YXIgY2hpbGRUb1BydW5lPW51bGw7dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoIXRoaXMuZ2V0SW50ZXJzZWN0c09wKCkuaW50ZXJzZWN0cyhjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSxzZWFyY2hCb3VuZHMpKXtjb250aW51ZTt9XG5pZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe2ZvdW5kPXRoaXMucmVtb3ZlKHNlYXJjaEJvdW5kcyxjaGlsZEJvdW5kYWJsZSxpdGVtKTtpZihmb3VuZCl7Y2hpbGRUb1BydW5lPWNoaWxkQm91bmRhYmxlO2JyZWFrO319fVxuaWYoY2hpbGRUb1BydW5lIT1udWxsKXtpZihjaGlsZFRvUHJ1bmUuZ2V0Q2hpbGRCb3VuZGFibGVzKCkubGVuZ3RoPT09MCl7Y2hpbGRCb3VuZGFibGVzLnNwbGljZShjaGlsZEJvdW5kYWJsZXMuaW5kZXhPZihjaGlsZFRvUHJ1bmUpLDEpO319XG5yZXR1cm4gZm91bmQ7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5yZW1vdmVJdGVtPWZ1bmN0aW9uKG5vZGUsaXRlbSl7dmFyIGNoaWxkVG9SZW1vdmU9bnVsbDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKXtpZihjaGlsZEJvdW5kYWJsZS5nZXRJdGVtKCk9PT1pdGVtKVxuY2hpbGRUb1JlbW92ZT1jaGlsZEJvdW5kYWJsZTt9fVxuaWYoY2hpbGRUb1JlbW92ZSE9PW51bGwpe2NoaWxkQm91bmRhYmxlcy5zcGxpY2UoY2hpbGRCb3VuZGFibGVzLmluZGV4T2YoY2hpbGRUb1JlbW92ZSksMSk7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuYm91bmRhYmxlc0F0TGV2ZWw9ZnVuY3Rpb24obGV2ZWwpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7dGhpcy5ib3VuZGFibGVzQXRMZXZlbDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgYm91bmRhYmxlcz1bXTt0aGlzLmJvdW5kYWJsZXNBdExldmVsMihsZXZlbCx0aGlzLnJvb3QsYm91bmRhYmxlcyk7cmV0dXJuIGJvdW5kYWJsZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5ib3VuZGFibGVzQXRMZXZlbDI9ZnVuY3Rpb24obGV2ZWwsdG9wLGJvdW5kYWJsZXMpe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKGxldmVsPi0yKTtpZih0b3AuZ2V0TGV2ZWwoKT09PWxldmVsKXtib3VuZGFibGVzLmFkZCh0b3ApO3JldHVybjt9XG52YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoYm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dGhpcy5ib3VuZGFibGVzQXRMZXZlbChsZXZlbCxib3VuZGFibGUsYm91bmRhYmxlcyk7fWVsc2V7anN0cy51dGlsLkFzc2VydC5pc1RydWUoYm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpO2lmKGxldmVsPT09LTEpe2JvdW5kYWJsZXMuYWRkKGJvdW5kYWJsZSk7fX19XG5yZXR1cm47fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5nZXRDb21wYXJhdG9yPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlPWZ1bmN0aW9uKG5vZGVDYXBhY2l0eSl7bm9kZUNhcGFjaXR5PW5vZGVDYXBhY2l0eXx8anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUuREVGQVVMVF9OT0RFX0NBUEFDSVRZO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUuY2FsbCh0aGlzLG5vZGVDYXBhY2l0eSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUoKTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUueENvbXBhcmF0b3I9ZnVuY3Rpb24obzEsbzIpe3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5jb21wYXJlRG91Ymxlcyhqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWChvMS5nZXRCb3VuZHMoKSksanN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVgobzIuZ2V0Qm91bmRzKCkpKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS55Q29tcGFyYXRvcj1mdW5jdGlvbihvMSxvMil7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNvbXBhcmVEb3VibGVzKGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jZW50cmVZKG8xLmdldEJvdW5kcygpKSxqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWShvMi5nZXRCb3VuZHMoKSkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVg9ZnVuY3Rpb24oZSl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5hdmcoZS5nZXRNaW5YKCksZS5nZXRNYXhYKCkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVk9ZnVuY3Rpb24oZSl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5hdmcoZS5nZXRNaW5ZKCksZS5nZXRNYXhZKCkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmF2Zz1mdW5jdGlvbihhLGIpe3JldHVybihhK2IpLzIuMDt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5pbnRlcnNlY3RzT3A9e2ludGVyc2VjdHM6ZnVuY3Rpb24oYUJvdW5kcyxiQm91bmRzKXtyZXR1cm4gYUJvdW5kcy5pbnRlcnNlY3RzKGJCb3VuZHMpO319O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzPWZ1bmN0aW9uKGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIShjaGlsZEJvdW5kYWJsZXMubGVuZ3RoPT09MCkpO3ZhciBtaW5MZWFmQ291bnQ9TWF0aC5jZWlsKGNoaWxkQm91bmRhYmxlcy5sZW5ndGgvdGhpcy5nZXROb2RlQ2FwYWNpdHkoKSk7dmFyIHNvcnRlZENoaWxkQm91bmRhYmxlcz1bXTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXtzb3J0ZWRDaGlsZEJvdW5kYWJsZXMucHVzaChjaGlsZEJvdW5kYWJsZXNbaV0pO31cbnNvcnRlZENoaWxkQm91bmRhYmxlcy5zb3J0KHRoaXMueENvbXBhcmF0b3IpO3ZhciB2ZXJ0aWNhbFNsaWNlcz10aGlzLnZlcnRpY2FsU2xpY2VzKHNvcnRlZENoaWxkQm91bmRhYmxlcyxNYXRoLmNlaWwoTWF0aC5zcXJ0KG1pbkxlYWZDb3VudCkpKTtyZXR1cm4gdGhpcy5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2VzKHZlcnRpY2FsU2xpY2VzLG5ld0xldmVsKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2VzPWZ1bmN0aW9uKHZlcnRpY2FsU2xpY2VzLG5ld0xldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSh2ZXJ0aWNhbFNsaWNlcy5sZW5ndGg+MCk7dmFyIHBhcmVudEJvdW5kYWJsZXM9W107Zm9yKHZhciBpPTA7aTx2ZXJ0aWNhbFNsaWNlcy5sZW5ndGg7aSsrKXtwYXJlbnRCb3VuZGFibGVzPXBhcmVudEJvdW5kYWJsZXMuY29uY2F0KHRoaXMuY3JlYXRlUGFyZW50Qm91bmRhYmxlc0Zyb21WZXJ0aWNhbFNsaWNlKHZlcnRpY2FsU2xpY2VzW2ldLG5ld0xldmVsKSk7fVxucmV0dXJuIHBhcmVudEJvdW5kYWJsZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlUGFyZW50Qm91bmRhYmxlc0Zyb21WZXJ0aWNhbFNsaWNlPWZ1bmN0aW9uKGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXMuY2FsbCh0aGlzLGNoaWxkQm91bmRhYmxlcyxuZXdMZXZlbCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUudmVydGljYWxTbGljZXM9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLHNsaWNlQ291bnQpe3ZhciBzbGljZUNhcGFjaXR5PU1hdGguY2VpbChjaGlsZEJvdW5kYWJsZXMubGVuZ3RoL3NsaWNlQ291bnQpO3ZhciBzbGljZXM9W107dmFyIGk9MCxib3VuZGFibGVzQWRkZWRUb1NsaWNlLGNoaWxkQm91bmRhYmxlO2Zvcih2YXIgaj0wO2o8c2xpY2VDb3VudDtqKyspe3NsaWNlc1tqXT1bXTtib3VuZGFibGVzQWRkZWRUb1NsaWNlPTA7d2hpbGUoaTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoJiZib3VuZGFibGVzQWRkZWRUb1NsaWNlPHNsaWNlQ2FwYWNpdHkpe2NoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpKytdO3NsaWNlc1tqXS5wdXNoKGNoaWxkQm91bmRhYmxlKTtib3VuZGFibGVzQWRkZWRUb1NsaWNlKys7fX1cbnJldHVybiBzbGljZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5ERUZBVUxUX05PREVfQ0FQQUNJVFk9MTA7anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24obGV2ZWwpe3ZhciBhYnN0cmFjdE5vZGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUobGV2ZWwpO2Fic3RyYWN0Tm9kZS5jb21wdXRlQm91bmRzPWZ1bmN0aW9uKCl7dmFyIGJvdW5kcz1udWxsO3ZhciBjaGlsZEJvdW5kYWJsZXM9dGhpcy5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKGJvdW5kcz09PW51bGwpe2JvdW5kcz1uZXcganN0cy5nZW9tLkVudmVsb3BlKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpKTt9ZWxzZXtib3VuZHMuZXhwYW5kVG9JbmNsdWRlKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpKTt9fVxucmV0dXJuIGJvdW5kczt9O3JldHVybiBhYnN0cmFjdE5vZGU7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0c09wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c09wO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe2lmKGl0ZW1FbnYuaXNOdWxsKCkpe3JldHVybjt9XG5qc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pbnNlcnQuY2FsbCh0aGlzLGl0ZW1FbnYsaXRlbSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oc2VhcmNoRW52LHZpc2l0b3Ipe3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5xdWVyeS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJlbW92ZS5jYWxsKHRoaXMsaXRlbUVudixpdGVtKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnNpemUuY2FsbCh0aGlzKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5kZXB0aD1mdW5jdGlvbigpe3JldHVybiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5kZXB0aC5jYWxsKHRoaXMpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmdldENvbXBhcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55Q29tcGFyYXRvcjt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyPWZ1bmN0aW9uKGl0ZW1EaXN0KXt2YXIgYnA9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5Cb3VuZGFibGVQYWlyKHRoaXMuZ2V0Um9vdCgpLHRoaXMuZ2V0Um9vdCgpLGl0ZW1EaXN0KTtyZXR1cm4gdGhpcy5uZWFyZXN0TmVpZ2hib3VyNChicCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUubmVhcmVzdE5laWdoYm91cjI9ZnVuY3Rpb24oZW52LGl0ZW0saXRlbURpc3Qpe3ZhciBibmQ9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKGVudixpdGVtKTt2YXIgYnA9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5Cb3VuZGFibGVQYWlyKHRoaXMuZ2V0Um9vdCgpLGJuZCxpdGVtRGlzdCk7cmV0dXJuIHRoaXMubmVhcmVzdE5laWdoYm91cjQoYnApWzBdO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXIzPWZ1bmN0aW9uKHRyZWUsaXRlbURpc3Qpe3ZhciBicD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZVBhaXIodGhpcy5nZXRSb290KCksdHJlZS5nZXRSb290KCksaXRlbURpc3QpO3JldHVybiB0aGlzLm5lYXJlc3ROZWlnaGJvdXI0KGJwKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyND1mdW5jdGlvbihpbml0Qm5kUGFpcil7cmV0dXJuIHRoaXMubmVhcmVzdE5laWdoYm91cjUoaW5pdEJuZFBhaXIsRG91YmxlLlBPU0lUSVZFX0lORklOSVRZKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyNT1mdW5jdGlvbihpbml0Qm5kUGFpcixtYXhEaXN0YW5jZSl7dmFyIGRpc3RhbmNlTG93ZXJCb3VuZD1tYXhEaXN0YW5jZTt2YXIgbWluUGFpcj1udWxsO3ZhciBwcmlRPVtdO3ByaVEucHVzaChpbml0Qm5kUGFpcik7d2hpbGUoIXByaVEuaXNFbXB0eSgpJiZkaXN0YW5jZUxvd2VyQm91bmQ+MC4wKXt2YXIgYm5kUGFpcj1wcmlRLnBvcCgpO3ZhciBjdXJyZW50RGlzdGFuY2U9Ym5kUGFpci5nZXREaXN0YW5jZSgpO2lmKGN1cnJlbnREaXN0YW5jZT49ZGlzdGFuY2VMb3dlckJvdW5kKVxuYnJlYWs7aWYoYm5kUGFpci5pc0xlYXZlcygpKXtkaXN0YW5jZUxvd2VyQm91bmQ9Y3VycmVudERpc3RhbmNlO21pblBhaXI9Ym5kUGFpcjt9ZWxzZXtibmRQYWlyLmV4cGFuZFRvUXVldWUocHJpUSxkaXN0YW5jZUxvd2VyQm91bmQpO319XG5yZXR1cm5bbWluUGFpci5nZXRCb3VuZGFibGUoMCkuZ2V0SXRlbSgpLG1pblBhaXIuZ2V0Qm91bmRhYmxlKDEpLmdldEl0ZW0oKV07fTtqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXREYXRhPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNldERhdGE9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2l6ZT1qc3RzLmFic3RyYWN0RnVuYztqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5Ob2RhYmxlU2VnbWVudFN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcoKTtqc3RzLm5vZGluZy5Ob2RhYmxlU2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9uPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZz1mdW5jdGlvbihwdHMsZGF0YSl7dGhpcy5ub2RlTGlzdD1uZXcganN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0KHRoaXMpO3RoaXMucHRzPXB0czt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nKCk7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZztqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKHNlZ1N0cmluZ3Mpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcuZ2V0Tm9kZWRTdWJzdHJpbmdzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciByZXN1bHRFZGdlbGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3MyKHNlZ1N0cmluZ3MscmVzdWx0RWRnZWxpc3QpO3JldHVybiByZXN1bHRFZGdlbGlzdDt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3MyPWZ1bmN0aW9uKHNlZ1N0cmluZ3MscmVzdWx0RWRnZWxpc3Qpe2Zvcih2YXIgaT1zZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgc3M9aS5uZXh0KCk7c3MuZ2V0Tm9kZUxpc3QoKS5hZGRTcGxpdEVkZ2VzKHJlc3VsdEVkZ2VsaXN0KTt9fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLm5vZGVMaXN0PW51bGw7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmRhdGE9bnVsbDtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXREYXRhPWZ1bmN0aW9uKGRhdGEpe3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXROb2RlTGlzdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVMaXN0O307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzLmxlbmd0aDt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0c1swXS5lcXVhbHModGhpcy5wdHNbdGhpcy5wdHMubGVuZ3RoLTFdKTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0U2VnbWVudE9jdGFudD1mdW5jdGlvbihpbmRleCl7aWYoaW5kZXg9PT10aGlzLnB0cy5sZW5ndGgtMSlcbnJldHVybi0xO3JldHVybiB0aGlzLnNhZmVPY3RhbnQodGhpcy5nZXRDb29yZGluYXRlKGluZGV4KSx0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgrMSkpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zYWZlT2N0YW50PWZ1bmN0aW9uKHAwLHAxKXtpZihwMC5lcXVhbHMyRChwMSkpXG5yZXR1cm4gMDtyZXR1cm4ganN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudChwMCxwMSk7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbnM9ZnVuY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCl7Zm9yKHZhciBpPTA7aTxsaS5nZXRJbnRlcnNlY3Rpb25OdW0oKTtpKyspe3RoaXMuYWRkSW50ZXJzZWN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgsaSk7fX07anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb249ZnVuY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCxpbnRJbmRleCl7aWYobGkgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5hZGRJbnRlcnNlY3Rpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGludFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShsaS5nZXRJbnRlcnNlY3Rpb24oaW50SW5kZXgpKTt0aGlzLmFkZEludGVyc2VjdGlvbjIoaW50UHQsc2VnbWVudEluZGV4KTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9uMj1mdW5jdGlvbihpbnRQdCxzZWdtZW50SW5kZXgpe3RoaXMuYWRkSW50ZXJzZWN0aW9uTm9kZShpbnRQdCxzZWdtZW50SW5kZXgpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb25Ob2RlPWZ1bmN0aW9uKGludFB0LHNlZ21lbnRJbmRleCl7dmFyIG5vcm1hbGl6ZWRTZWdtZW50SW5kZXg9c2VnbWVudEluZGV4O3ZhciBuZXh0U2VnSW5kZXg9bm9ybWFsaXplZFNlZ21lbnRJbmRleCsxO2lmKG5leHRTZWdJbmRleDx0aGlzLnB0cy5sZW5ndGgpe3ZhciBuZXh0UHQ9dGhpcy5wdHNbbmV4dFNlZ0luZGV4XTtpZihpbnRQdC5lcXVhbHMyRChuZXh0UHQpKXtub3JtYWxpemVkU2VnbWVudEluZGV4PW5leHRTZWdJbmRleDt9fVxudmFyIGVpPXRoaXMubm9kZUxpc3QuYWRkKGludFB0LG5vcm1hbGl6ZWRTZWdtZW50SW5kZXgpO3JldHVybiBlaTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgZ2VvbWV0cnlGYWN0b3J5PW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7cmV0dXJuIG5ldyBqc3RzLmlvLldLVFdyaXRlcigpLndyaXRlKGdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMucHRzKSk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLnRvSW50QXJyYXk9ZnVuY3Rpb24obGlzdCl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bGlzdC5sZW5ndGg7aSsrKXthcnJheVtpXT1saXN0W2ldO31cbnJldHVybiBhcnJheTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zPWZ1bmN0aW9uKHB0cyl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3JldHVybiBqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnJldHVybiBqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluczIocHRzLG51bGwpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpbnMyPWZ1bmN0aW9uKHB0cyxjb250ZXh0KXt2YXIgbWNMaXN0PVtdO3ZhciBzdGFydEluZGV4PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5TdGFydEluZGljZXMocHRzKTtmb3IodmFyIGk9MDtpPHN0YXJ0SW5kZXgubGVuZ3RoLTE7aSsrKXt2YXIgbWM9bmV3IGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbihwdHMsc3RhcnRJbmRleFtpXSxzdGFydEluZGV4W2krMV0sY29udGV4dCk7bWNMaXN0LnB1c2gobWMpO31cbnJldHVybiBtY0xpc3Q7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluU3RhcnRJbmRpY2VzPWZ1bmN0aW9uKHB0cyl7dmFyIHN0YXJ0PTA7dmFyIHN0YXJ0SW5kZXhMaXN0PVtdO3N0YXJ0SW5kZXhMaXN0LnB1c2goc3RhcnQpO2Rve3ZhciBsYXN0PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZmluZENoYWluRW5kKHB0cyxzdGFydCk7c3RhcnRJbmRleExpc3QucHVzaChsYXN0KTtzdGFydD1sYXN0O313aGlsZShzdGFydDxwdHMubGVuZ3RoLTEpO3ZhciBzdGFydEluZGV4PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIudG9JbnRBcnJheShzdGFydEluZGV4TGlzdCk7cmV0dXJuIHN0YXJ0SW5kZXg7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmZpbmRDaGFpbkVuZD1mdW5jdGlvbihwdHMsc3RhcnQpe3ZhciBzYWZlU3RhcnQ9c3RhcnQ7d2hpbGUoc2FmZVN0YXJ0PHB0cy5sZW5ndGgtMSYmcHRzW3NhZmVTdGFydF0uZXF1YWxzMkQocHRzW3NhZmVTdGFydCsxXSkpe3NhZmVTdGFydCsrO31cbmlmKHNhZmVTdGFydD49cHRzLmxlbmd0aC0xKXtyZXR1cm4gcHRzLmxlbmd0aC0xO31cbnZhciBjaGFpblF1YWQ9anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQocHRzW3NhZmVTdGFydF0scHRzW3NhZmVTdGFydCsxXSk7dmFyIGxhc3Q9c3RhcnQrMTt3aGlsZShsYXN0PHB0cy5sZW5ndGgpe2lmKCFwdHNbbGFzdC0xXS5lcXVhbHMyRChwdHNbbGFzdF0pKXt2YXIgcXVhZD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwdHNbbGFzdC0xXSxwdHNbbGFzdF0pO2lmKHF1YWQhPT1jaGFpblF1YWQpXG5icmVhazt9XG5sYXN0Kys7fVxucmV0dXJuIGxhc3QtMTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe3RoaXMuaW5wdXRMaW5lcz1bW10sW11dO3RoaXMuaW50UHQ9W251bGwsbnVsbF07dGhpcy5wYT10aGlzLmludFB0WzBdO3RoaXMucGI9dGhpcy5pbnRQdFsxXTt0aGlzLnJlc3VsdD1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTj0wO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT049MTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTj0yO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuc2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEVuZHBvaW50PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxwdEluZGV4KXtyZXR1cm4gdGhpcy5pbnB1dExpbmVzW3NlZ21lbnRJbmRleF1bcHRJbmRleF07fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuY29tcHV0ZUVkZ2VEaXN0YW5jZT1mdW5jdGlvbihwLHAwLHAxKXt2YXIgZHg9TWF0aC5hYnMocDEueC1wMC54KTt2YXIgZHk9TWF0aC5hYnMocDEueS1wMC55KTt2YXIgZGlzdD0tMS4wO2lmKHAuZXF1YWxzKHAwKSl7ZGlzdD0wLjA7fWVsc2UgaWYocC5lcXVhbHMocDEpKXtpZihkeD5keSl7ZGlzdD1keDt9ZWxzZXtkaXN0PWR5O319ZWxzZXt2YXIgcGR4PU1hdGguYWJzKHAueC1wMC54KTt2YXIgcGR5PU1hdGguYWJzKHAueS1wMC55KTtpZihkeD5keSl7ZGlzdD1wZHg7fWVsc2V7ZGlzdD1wZHk7fVxuaWYoZGlzdD09PTAuMCYmIXAuZXF1YWxzKHAwKSl7ZGlzdD1NYXRoLm1heChwZHgscGR5KTt9fVxuaWYoZGlzdD09PTAuMCYmIXAuZXF1YWxzKHAwKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0JhZCBkaXN0YW5jZSBjYWxjdWxhdGlvbicpO31cbnJldHVybiBkaXN0O307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLm5vblJvYnVzdENvbXB1dGVFZGdlRGlzdGFuY2U9ZnVuY3Rpb24ocCxwMSxwMil7dmFyIGR4PXAueC1wMS54O3ZhciBkeT1wLnktcDEueTt2YXIgZGlzdD1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO2lmKCEoZGlzdD09PTAuMCYmIXAuZXF1YWxzKHAxKSkpe3Rocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdJbnZhbGlkIGRpc3RhbmNlIGNhbGN1bGF0aW9uJyk7fVxucmV0dXJuIGRpc3Q7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnJlc3VsdD1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW5wdXRMaW5lcz1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50UHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmludExpbmVJbmRleD1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuX2lzUHJvcGVyPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wYT1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucGI9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAscDEscDIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzQ29sbGluZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0PT09anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscDMscDQpe3RoaXMuaW5wdXRMaW5lc1swXVswXT1wMTt0aGlzLmlucHV0TGluZXNbMF1bMV09cDI7dGhpcy5pbnB1dExpbmVzWzFdWzBdPXAzO3RoaXMuaW5wdXRMaW5lc1sxXVsxXT1wNDt0aGlzLnJlc3VsdD10aGlzLmNvbXB1dGVJbnRlcnNlY3QocDEscDIscDMscDQpO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0PWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0VuZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzSW50ZXJzZWN0aW9uKCkmJiF0aGlzLl9pc1Byb3Blcjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0IT09anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9uTnVtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVzdWx0O307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb249ZnVuY3Rpb24oaW50SW5kZXgpe3JldHVybiB0aGlzLmludFB0W2ludEluZGV4XTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludExpbmVJbmRleD1mdW5jdGlvbigpe2lmKHRoaXMuaW50TGluZUluZGV4PT09bnVsbCl7dGhpcy5pbnRMaW5lSW5kZXg9W1tdLFtdXTt0aGlzLmNvbXB1dGVJbnRMaW5lSW5kZXgoMCk7dGhpcy5jb21wdXRlSW50TGluZUluZGV4KDEpO319O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocHQpe3ZhciBpO2ZvcihpPTA7aTx0aGlzLnJlc3VsdDtpKyspe2lmKHRoaXMuaW50UHRbaV0uZXF1YWxzMkQocHQpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZih0aGlzLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24oMCkpe3JldHVybiB0cnVlO31cbmlmKHRoaXMuaXNJbnRlcmlvckludGVyc2VjdGlvbigxKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uMj1mdW5jdGlvbihpbnB1dExpbmVJbmRleCl7dmFyIGk7Zm9yKGk9MDtpPHRoaXMucmVzdWx0O2krKyl7aWYoISh0aGlzLmludFB0W2ldLmVxdWFsczJEKHRoaXMuaW5wdXRMaW5lc1tpbnB1dExpbmVJbmRleF1bMF0pfHx0aGlzLmludFB0W2ldLmVxdWFsczJEKHRoaXMuaW5wdXRMaW5lc1tpbnB1dExpbmVJbmRleF1bMV0pKSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNQcm9wZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb24oKSYmdGhpcy5faXNQcm9wZXI7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEludGVyc2VjdGlvbkFsb25nU2VnbWVudD1mdW5jdGlvbihzZWdtZW50SW5kZXgsaW50SW5kZXgpe3RoaXMuY29tcHV0ZUludExpbmVJbmRleCgpO3JldHVybiB0aGlzLmludFB0W2ludExpbmVJbmRleFtzZWdtZW50SW5kZXhdW2ludEluZGV4XV07fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEluZGV4QWxvbmdTZWdtZW50PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxpbnRJbmRleCl7dGhpcy5jb21wdXRlSW50TGluZUluZGV4KCk7cmV0dXJuIHRoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1baW50SW5kZXhdO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50TGluZUluZGV4PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCl7dmFyIGRpc3QwPXRoaXMuZ2V0RWRnZURpc3RhbmNlKHNlZ21lbnRJbmRleCwwKTt2YXIgZGlzdDE9dGhpcy5nZXRFZGdlRGlzdGFuY2Uoc2VnbWVudEluZGV4LDEpO2lmKGRpc3QwPmRpc3QxKXt0aGlzLmludExpbmVJbmRleFtzZWdtZW50SW5kZXhdWzBdPTA7dGhpcy5pbnRMaW5lSW5kZXhbc2VnbWVudEluZGV4XVsxXT0xO31lbHNle3RoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1bMF09MTt0aGlzLmludExpbmVJbmRleFtzZWdtZW50SW5kZXhdWzFdPTA7fX07anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRFZGdlRGlzdGFuY2U9ZnVuY3Rpb24oc2VnbWVudEluZGV4LGludEluZGV4KXt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuY29tcHV0ZUVkZ2VEaXN0YW5jZSh0aGlzLmludFB0W2ludEluZGV4XSx0aGlzLmlucHV0TGluZXNbc2VnbWVudEluZGV4XVswXSx0aGlzLmlucHV0TGluZXNbc2VnbWVudEluZGV4XVsxXSk7cmV0dXJuIGRpc3Q7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbnN0cnVjdG9yLmNhbGwodGhpcyk7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IoKTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocCxwMSxwMil7aWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuX2lzUHJvcGVyPWZhbHNlO2lmKGpzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzKHAxLHAyLHApKXtpZigoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDEscDIscCk9PT0wKSYmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAyLHAxLHApPT09MCkpe3RoaXMuX2lzUHJvcGVyPXRydWU7aWYocC5lcXVhbHMocDEpfHxwLmVxdWFscyhwMikpe3RoaXMuX2lzUHJvcGVyPWZhbHNlO31cbnRoaXMucmVzdWx0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT047cmV0dXJuO319XG50aGlzLnJlc3VsdD1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0PWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt0aGlzLl9pc1Byb3Blcj1mYWxzZTtpZighanN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscTEscTIpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9XG52YXIgUHExPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAxLHAyLHExKTt2YXIgUHEyPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAxLHAyLHEyKTtpZigoUHExPjAmJlBxMj4wKXx8KFBxMTwwJiZQcTI8MCkpe3JldHVybiBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO31cbnZhciBRcDE9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocTEscTIscDEpO3ZhciBRcDI9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocTEscTIscDIpO2lmKChRcDE+MCYmUXAyPjApfHwoUXAxPDAmJlFwMjwwKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fVxudmFyIGNvbGxpbmVhcj1QcTE9PT0wJiZQcTI9PT0wJiZRcDE9PT0wJiZRcDI9PT0wO2lmKGNvbGxpbmVhcil7cmV0dXJuIHRoaXMuY29tcHV0ZUNvbGxpbmVhckludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fVxuaWYoUHExPT09MHx8UHEyPT09MHx8UXAxPT09MHx8UXAyPT09MCl7dGhpcy5faXNQcm9wZXI9ZmFsc2U7aWYocDEuZXF1YWxzMkQocTEpfHxwMS5lcXVhbHMyRChxMikpe3RoaXMuaW50UHRbMF09cDE7fWVsc2UgaWYocDIuZXF1YWxzMkQocTEpfHxwMi5lcXVhbHMyRChxMikpe3RoaXMuaW50UHRbMF09cDI7fVxuZWxzZSBpZihQcTE9PT0wKXt0aGlzLmludFB0WzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShxMSk7fWVsc2UgaWYoUHEyPT09MCl7dGhpcy5pbnRQdFswXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocTIpO31lbHNlIGlmKFFwMT09PTApe3RoaXMuaW50UHRbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAxKTt9ZWxzZSBpZihRcDI9PT0wKXt0aGlzLmludFB0WzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwMik7fX1lbHNle3RoaXMuX2lzUHJvcGVyPXRydWU7dGhpcy5pbnRQdFswXT10aGlzLmludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fVxucmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVDb2xsaW5lYXJJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBwMXExcDI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscTEpO3ZhciBwMXEycDI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscTIpO3ZhciBxMXAxcTI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocTEscTIscDEpO3ZhciBxMXAycTI9anN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocTEscTIscDIpO2lmKHAxcTFwMiYmcDFxMnAyKXt0aGlzLmludFB0WzBdPXExO3RoaXMuaW50UHRbMV09cTI7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHExcDFxMiYmcTFwMnEyKXt0aGlzLmludFB0WzBdPXAxO3RoaXMuaW50UHRbMV09cDI7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHAxcTFwMiYmcTFwMXEyKXt0aGlzLmludFB0WzBdPXExO3RoaXMuaW50UHRbMV09cDE7cmV0dXJuIHExLmVxdWFscyhwMSkmJiFwMXEycDImJiFxMXAycTI/anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjpqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9XG5pZihwMXExcDImJnExcDJxMil7dGhpcy5pbnRQdFswXT1xMTt0aGlzLmludFB0WzFdPXAyO3JldHVybiBxMS5lcXVhbHMocDIpJiYhcDFxMnAyJiYhcTFwMXEyP2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT046anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocDFxMnAyJiZxMXAxcTIpe3RoaXMuaW50UHRbMF09cTI7dGhpcy5pbnRQdFsxXT1wMTtyZXR1cm4gcTIuZXF1YWxzKHAxKSYmIXAxcTFwMiYmIXExcDJxMj9qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuUE9JTlRfSU5URVJTRUNUSU9OOmpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHAxcTJwMiYmcTFwMnEyKXt0aGlzLmludFB0WzBdPXEyO3RoaXMuaW50UHRbMV09cDI7cmV0dXJuIHEyLmVxdWFscyhwMikmJiFwMXExcDImJiFxMXAxcTI/anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjpqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9XG5yZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgaW50UHQ9dGhpcy5pbnRlcnNlY3Rpb25XaXRoTm9ybWFsaXphdGlvbihwMSxwMixxMSxxMik7aWYoIXRoaXMuaXNJblNlZ21lbnRFbnZlbG9wZXMoaW50UHQpKXtpbnRQdD1qc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5nZXRJbnRlcnNlY3Rpb24ocDEscDIscTEscTIpO31cbmlmKHRoaXMucHJlY2lzaW9uTW9kZWwhPT1udWxsKXt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGludFB0KTt9XG5yZXR1cm4gaW50UHQ7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmludGVyc2VjdGlvbldpdGhOb3JtYWxpemF0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgbjE9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAxKTt2YXIgbjI9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAyKTt2YXIgbjM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHExKTt2YXIgbjQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHEyKTt2YXIgbm9ybVB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMubm9ybWFsaXplVG9FbnZDZW50cmUobjEsbjIsbjMsbjQsbm9ybVB0KTt2YXIgaW50UHQ9dGhpcy5zYWZlSENvb3JkaW5hdGVJbnRlcnNlY3Rpb24objEsbjIsbjMsbjQpO2ludFB0LngrPW5vcm1QdC54O2ludFB0LnkrPW5vcm1QdC55O3JldHVybiBpbnRQdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuc2FmZUhDb29yZGluYXRlSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgaW50UHQ9bnVsbDt0cnl7aW50UHQ9anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUuaW50ZXJzZWN0aW9uKHAxLHAyLHExLHEyKTt9Y2F0Y2goZSl7aWYoZSBpbnN0YW5jZW9mIGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKXtpbnRQdD1qc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5nZXRJbnRlcnNlY3Rpb24ocDEscDIscTEscTIpO31lbHNle3Rocm93IGU7fX1cbnJldHVybiBpbnRQdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubm9ybWFsaXplVG9NaW5pbXVtPWZ1bmN0aW9uKG4xLG4yLG4zLG40LG5vcm1QdCl7bm9ybVB0Lng9dGhpcy5zbWFsbGVzdEluQWJzVmFsdWUobjEueCxuMi54LG4zLngsbjQueCk7bm9ybVB0Lnk9dGhpcy5zbWFsbGVzdEluQWJzVmFsdWUobjEueSxuMi55LG4zLnksbjQueSk7bjEueC09bm9ybVB0Lng7bjEueS09bm9ybVB0Lnk7bjIueC09bm9ybVB0Lng7bjIueS09bm9ybVB0Lnk7bjMueC09bm9ybVB0Lng7bjMueS09bm9ybVB0Lnk7bjQueC09bm9ybVB0Lng7bjQueS09bm9ybVB0Lnk7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLm5vcm1hbGl6ZVRvRW52Q2VudHJlPWZ1bmN0aW9uKG4wMCxuMDEsbjEwLG4xMSxub3JtUHQpe3ZhciBtaW5YMD1uMDAueDxuMDEueD9uMDAueDpuMDEueDt2YXIgbWluWTA9bjAwLnk8bjAxLnk/bjAwLnk6bjAxLnk7dmFyIG1heFgwPW4wMC54Pm4wMS54P24wMC54Om4wMS54O3ZhciBtYXhZMD1uMDAueT5uMDEueT9uMDAueTpuMDEueTt2YXIgbWluWDE9bjEwLng8bjExLng/bjEwLng6bjExLng7dmFyIG1pblkxPW4xMC55PG4xMS55P24xMC55Om4xMS55O3ZhciBtYXhYMT1uMTAueD5uMTEueD9uMTAueDpuMTEueDt2YXIgbWF4WTE9bjEwLnk+bjExLnk/bjEwLnk6bjExLnk7dmFyIGludE1pblg9bWluWDA+bWluWDE/bWluWDA6bWluWDE7dmFyIGludE1heFg9bWF4WDA8bWF4WDE/bWF4WDA6bWF4WDE7dmFyIGludE1pblk9bWluWTA+bWluWTE/bWluWTA6bWluWTE7dmFyIGludE1heFk9bWF4WTA8bWF4WTE/bWF4WTA6bWF4WTE7dmFyIGludE1pZFg9KGludE1pblgraW50TWF4WCkvMi4wO3ZhciBpbnRNaWRZPShpbnRNaW5ZK2ludE1heFkpLzIuMDtub3JtUHQueD1pbnRNaWRYO25vcm1QdC55PWludE1pZFk7bjAwLngtPW5vcm1QdC54O24wMC55LT1ub3JtUHQueTtuMDEueC09bm9ybVB0Lng7bjAxLnktPW5vcm1QdC55O24xMC54LT1ub3JtUHQueDtuMTAueS09bm9ybVB0Lnk7bjExLngtPW5vcm1QdC54O24xMS55LT1ub3JtUHQueTt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuc21hbGxlc3RJbkFic1ZhbHVlPWZ1bmN0aW9uKHgxLHgyLHgzLHg0KXt2YXIgeD14MTt2YXIgeGFicz1NYXRoLmFicyh4KTtpZihNYXRoLmFicyh4Mik8eGFicyl7eD14Mjt4YWJzPU1hdGguYWJzKHgyKTt9XG5pZihNYXRoLmFicyh4Myk8eGFicyl7eD14Mzt4YWJzPU1hdGguYWJzKHgzKTt9XG5pZihNYXRoLmFicyh4NCk8eGFicyl7eD14NDt9XG5yZXR1cm4geDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNJblNlZ21lbnRFbnZlbG9wZXM9ZnVuY3Rpb24oaW50UHQpe3ZhciBlbnYwPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUodGhpcy5pbnB1dExpbmVzWzBdWzBdLHRoaXMuaW5wdXRMaW5lc1swXVsxXSk7dmFyIGVudjE9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmlucHV0TGluZXNbMV1bMF0sdGhpcy5pbnB1dExpbmVzWzFdWzFdKTtyZXR1cm4gZW52MC5jb250YWlucyhpbnRQdCkmJmVudjEuY29udGFpbnMoaW50UHQpO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aGlzLng9MC4wO3RoaXMueT0wLjA7dGhpcy53PTEuMDtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5pbml0RnJvbTFDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTImJmFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMuaW5pdEZyb20yQ29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTImJmFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUpe3RoaXMuaW5pdEZyb20ySENvb3JkaW5hdGVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmluaXRGcm9tWFkoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuaW5pdEZyb21YWVcoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT00KXt0aGlzLmluaXRGcm9tWFlXKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fX07anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAxLHAyLHExLHEyKXt2YXIgcHgscHkscHcscXgscXkscXcseCx5LHcseEludCx5SW50O3B4PXAxLnktcDIueTtweT1wMi54LXAxLng7cHc9cDEueCpwMi55LXAyLngqcDEueTtxeD1xMS55LXEyLnk7cXk9cTIueC1xMS54O3F3PXExLngqcTIueS1xMi54KnExLnk7eD1weSpxdy1xeSpwdzt5PXF4KnB3LXB4KnF3O3c9cHgqcXktcXgqcHk7eEludD14L3c7eUludD15L3c7aWYoIWlzRmluaXRlKHhJbnQpfHwhaXNGaW5pdGUoeUludCkpe3Rocm93IG5ldyBqc3RzLmVycm9yLk5vdFJlcHJlc2VudGFibGVFcnJvcigpO31cbnJldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeEludCx5SW50KTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbTFDb29yZGluYXRlPWZ1bmN0aW9uKHApe3RoaXMueD1wLng7dGhpcy55PXAueTt0aGlzLnc9MS4wO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmluaXRGcm9tMkNvb3JkaW5hdGVzPWZ1bmN0aW9uKHAxLHAyKXt0aGlzLng9cDEueS1wMi55O3RoaXMueT1wMi54LXAxLng7dGhpcy53PXAxLngqcDIueS1wMi54KnAxLnk7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb20ySENvb3JkaW5hdGVzPWZ1bmN0aW9uKHAxLHAyKXt0aGlzLng9cDEueSpwMi53LXAyLnkqcDEudzt0aGlzLnk9cDIueCpwMS53LXAxLngqcDIudzt0aGlzLnc9cDEueCpwMi55LXAyLngqcDEueTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbVhZVz1mdW5jdGlvbih4LHksdyl7dGhpcy54PXg7dGhpcy55PXk7dGhpcy53PXc7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb21YWT1mdW5jdGlvbih4LHkpe3RoaXMueD14O3RoaXMueT15O3RoaXMudz0xLjA7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb200Q29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBweCxweSxwdyxxeCxxeSxxdztweD1wMS55LXAyLnk7cHk9cDIueC1wMS54O3B3PXAxLngqcDIueS1wMi54KnAxLnk7cXg9cTEueS1xMi55O3F5PXEyLngtcTEueDtxdz1xMS54KnEyLnktcTIueCpxMS55O3RoaXMueD1weSpxdy1xeSpwdzt0aGlzLnk9cXgqcHctcHgqcXc7dGhpcy53PXB4KnF5LXF4KnB5O307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLngvdGhpcy53O2lmKCFpc0Zpbml0ZShhKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKCk7fVxucmV0dXJuIGE7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuZ2V0WT1mdW5jdGlvbigpe3ZhciBhPXRoaXMueS90aGlzLnc7aWYoIWlzRmluaXRlKGEpKXt0aHJvdyBuZXcganN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3IoKTt9XG5yZXR1cm4gYTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dmFyIHA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7cC54PXRoaXMuZ2V0WCgpO3AueT10aGlzLmdldFkoKTtyZXR1cm4gcDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0wKXt0aGlzLnAwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMucDE9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMucDA9YXJndW1lbnRzWzBdLnAwO3RoaXMucDE9YXJndW1lbnRzWzBdLnAxO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnAwPWFyZ3VtZW50c1swXTt0aGlzLnAxPWFyZ3VtZW50c1sxXTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09NCl7dGhpcy5wMD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7dGhpcy5wMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fX07anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wMD1udWxsO2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucDE9bnVsbDtqc3RzLmdlb20uTGluZVNlZ21lbnQubWlkUG9pbnQ9ZnVuY3Rpb24ocDAscDEpe3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHAwLngrcDEueCkvMiwocDAueStwMS55KS8yKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtpZihpPT09MClyZXR1cm4gdGhpcy5wMDtyZXR1cm4gdGhpcy5wMTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDAuZGlzdGFuY2UodGhpcy5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmlzSG9yaXpvbnRhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAwLnk9PT10aGlzLnAxLnk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmlzVmVydGljYWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMC54PT09dGhpcy5wMS54O307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5vcmllbnRhdGlvbkluZGV4PWZ1bmN0aW9uKGFyZyl7aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KXtyZXR1cm4gdGhpcy5vcmllbnRhdGlvbkluZGV4MShhcmcpO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5vcmllbnRhdGlvbkluZGV4MihhcmcpO319O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUub3JpZW50YXRpb25JbmRleDE9ZnVuY3Rpb24oc2VnKXt2YXIgb3JpZW50MD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleCh0aGlzLnAwLHRoaXMucDEsc2VnLnAwKTt2YXIgb3JpZW50MT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleCh0aGlzLnAwLHRoaXMucDEsc2VnLnAxKTtpZihvcmllbnQwPj0wJiZvcmllbnQxPj0wKXtyZXR1cm4gTWF0aC5tYXgob3JpZW50MCxvcmllbnQxKTt9XG5pZihvcmllbnQwPD0wJiZvcmllbnQxPD0wKXtyZXR1cm4gTWF0aC5tYXgob3JpZW50MCxvcmllbnQxKTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUub3JpZW50YXRpb25JbmRleDI9ZnVuY3Rpb24ocCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHRoaXMucDAsdGhpcy5wMSxwKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucmV2ZXJzZT1mdW5jdGlvbigpe3ZhciB0ZW1wPXRoaXMucDA7dGhpcy5wMD10aGlzLnAxO3RoaXMucDE9dGVtcDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7aWYodGhpcy5wMS5jb21wYXJlVG8odGhpcy5wMCk8MCl0aGlzLnJldmVyc2UoKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuYW5nbGU9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5hdGFuMih0aGlzLnAxLnktdGhpcy5wMC55LHRoaXMucDEueC10aGlzLnAwLngpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5taWRQb2ludD1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uTGluZVNlZ21lbnQubWlkUG9pbnQodGhpcy5wMCx0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2U9ZnVuY3Rpb24oYXJnKXtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpe3JldHVybiB0aGlzLmRpc3RhbmNlMShhcmcpO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5kaXN0YW5jZTIoYXJnKTt9fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmRpc3RhbmNlMT1mdW5jdGlvbihscyl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZUxpbmVMaW5lKHRoaXMucDAsdGhpcy5wMSxscy5wMCxscy5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmRpc3RhbmNlMj1mdW5jdGlvbihwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKHAsdGhpcy5wMCx0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucG9pbnRBbG9uZz1mdW5jdGlvbihzZWdtZW50TGVuZ3RoRnJhY3Rpb24pe3ZhciBjb29yZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtjb29yZC54PXRoaXMucDAueCtzZWdtZW50TGVuZ3RoRnJhY3Rpb24qKHRoaXMucDEueC10aGlzLnAwLngpO2Nvb3JkLnk9dGhpcy5wMC55K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS55LXRoaXMucDAueSk7cmV0dXJuIGNvb3JkO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wb2ludEFsb25nT2Zmc2V0PWZ1bmN0aW9uKHNlZ21lbnRMZW5ndGhGcmFjdGlvbixvZmZzZXREaXN0YW5jZSl7dmFyIHNlZ3g9dGhpcy5wMC54K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS54LXRoaXMucDAueCk7dmFyIHNlZ3k9dGhpcy5wMC55K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS55LXRoaXMucDAueSk7dmFyIGR4PXRoaXMucDEueC10aGlzLnAwLng7dmFyIGR5PXRoaXMucDEueS10aGlzLnAwLnk7dmFyIGxlbj1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO3ZhciB1eD0wO3ZhciB1eT0wO2lmKG9mZnNldERpc3RhbmNlIT09MCl7aWYobGVuPD0wKXt0aHJvd1wiQ2Fubm90IGNvbXB1dGUgb2Zmc2V0IGZyb20gemVyby1sZW5ndGggbGluZSBzZWdtZW50XCI7fVxudXg9b2Zmc2V0RGlzdGFuY2UqZHgvbGVuO3V5PW9mZnNldERpc3RhbmNlKmR5L2xlbjt9XG52YXIgb2Zmc2V0eD1zZWd4LXV5O3ZhciBvZmZzZXR5PXNlZ3krdXg7dmFyIGNvb3JkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShvZmZzZXR4LG9mZnNldHkpO3JldHVybiBjb29yZDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdGlvbkZhY3Rvcj1mdW5jdGlvbihwKXtpZihwLmVxdWFscyh0aGlzLnAwKSlcbnJldHVybiAwLjA7aWYocC5lcXVhbHModGhpcy5wMSkpXG5yZXR1cm4gMS4wO3ZhciBkeD10aGlzLnAxLngtdGhpcy5wMC54O3ZhciBkeT10aGlzLnAxLnktdGhpcy5wMC55O3ZhciBsZW4yPWR4KmR4K2R5KmR5O3ZhciByPSgocC54LXRoaXMucDAueCkqZHgrKHAueS10aGlzLnAwLnkpKmR5KS9sZW4yO3JldHVybiByO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5zZWdtZW50RnJhY3Rpb249ZnVuY3Rpb24oaW5wdXRQdCl7dmFyIHNlZ0ZyYWM9dGhpcy5wcm9qZWN0aW9uRmFjdG9yKGlucHV0UHQpO2lmKHNlZ0ZyYWM8MCl7c2VnRnJhYz0wO31lbHNlIGlmKHNlZ0ZyYWM+MXx8aXNOYU4oc2VnRnJhYykpe3NlZ0ZyYWM9MTt9XG5yZXR1cm4gc2VnRnJhYzt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdD1mdW5jdGlvbihhcmcpe2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5wcm9qZWN0MShhcmcpO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU2VnbWVudCl7cmV0dXJuIHRoaXMucHJvamVjdDIoYXJnKTt9fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnByb2plY3QxPWZ1bmN0aW9uKHApe2lmKHAuZXF1YWxzKHRoaXMucDApfHxwLmVxdWFscyh0aGlzLnAxKSl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwKTt9XG52YXIgcj10aGlzLnByb2plY3Rpb25GYWN0b3IocCk7dmFyIGNvb3JkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2Nvb3JkLng9dGhpcy5wMC54K3IqKHRoaXMucDEueC10aGlzLnAwLngpO2Nvb3JkLnk9dGhpcy5wMC55K3IqKHRoaXMucDEueS10aGlzLnAwLnkpO3JldHVybiBjb29yZDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdDI9ZnVuY3Rpb24oc2VnKXt2YXIgcGYwPXRoaXMucHJvamVjdGlvbkZhY3RvcihzZWcucDApO3ZhciBwZjE9dGhpcy5wcm9qZWN0aW9uRmFjdG9yKHNlZy5wMSk7aWYocGYwPj0xJiZwZjE+PTEpcmV0dXJuIG51bGw7aWYocGYwPD0wJiZwZjE8PTApcmV0dXJuIG51bGw7dmFyIG5ld3AwPXRoaXMucHJvamVjdChzZWcucDApO2lmKHBmMDwwKW5ld3AwPXAwO2lmKHBmMD4xKW5ld3AwPXAxO3ZhciBuZXdwMT10aGlzLnByb2plY3Qoc2VnLnAxKTtpZihwZjE8MC4wKW5ld3AxPXAwO2lmKHBmMT4xLjApbmV3cDE9cDE7cmV0dXJuIG5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQobmV3cDAsbmV3cDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5jbG9zZXN0UG9pbnQ9ZnVuY3Rpb24ocCl7dmFyIGZhY3Rvcj10aGlzLnByb2plY3Rpb25GYWN0b3IocCk7aWYoZmFjdG9yPjAmJmZhY3RvcjwxKXtyZXR1cm4gdGhpcy5wcm9qZWN0KHApO31cbnZhciBkaXN0MD10aGlzLnAwLmRpc3RhbmNlKHApO3ZhciBkaXN0MT10aGlzLnAxLmRpc3RhbmNlKHApO2lmKGRpc3QwPGRpc3QxKVxucmV0dXJuIHRoaXMucDA7cmV0dXJuIHRoaXMucDE7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmNsb3Nlc3RQb2ludHM9ZnVuY3Rpb24obGluZSl7dmFyIGludFB0PXRoaXMuaW50ZXJzZWN0aW9uKGxpbmUpO2lmKGludFB0IT09bnVsbCl7cmV0dXJuW2ludFB0LGludFB0XTt9XG52YXIgY2xvc2VzdFB0PVtdO3ZhciBtaW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBkaXN0O3ZhciBjbG9zZTAwPXRoaXMuY2xvc2VzdFBvaW50KGxpbmUucDApO21pbkRpc3RhbmNlPWNsb3NlMDAuZGlzdGFuY2UobGluZS5wMCk7Y2xvc2VzdFB0WzBdPWNsb3NlMDA7Y2xvc2VzdFB0WzFdPWxpbmUucDA7dmFyIGNsb3NlMDE9dGhpcy5jbG9zZXN0UG9pbnQobGluZS5wMSk7ZGlzdD1jbG9zZTAxLmRpc3RhbmNlKGxpbmUucDEpO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7Y2xvc2VzdFB0WzBdPWNsb3NlMDE7Y2xvc2VzdFB0WzFdPWxpbmUucDE7fVxudmFyIGNsb3NlMTA9bGluZS5jbG9zZXN0UG9pbnQodGhpcy5wMCk7ZGlzdD1jbG9zZTEwLmRpc3RhbmNlKHRoaXMucDApO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7Y2xvc2VzdFB0WzBdPXRoaXMucDA7Y2xvc2VzdFB0WzFdPWNsb3NlMTA7fVxudmFyIGNsb3NlMTE9bGluZS5jbG9zZXN0UG9pbnQodGhpcy5wMSk7ZGlzdD1jbG9zZTExLmRpc3RhbmNlKHRoaXMucDEpO2lmKGRpc3Q8bWluRGlzdGFuY2Upe21pbkRpc3RhbmNlPWRpc3Q7Y2xvc2VzdFB0WzBdPXRoaXMucDE7Y2xvc2VzdFB0WzFdPWNsb3NlMTE7fVxucmV0dXJuIGNsb3Nlc3RQdDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGxpbmUpe3ZhciBsaT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7bGkuY29tcHV0ZUludGVyc2VjdGlvbih0aGlzLnAwLHRoaXMucDEsbGluZS5wMCxsaW5lLnAxKTtpZihsaS5oYXNJbnRlcnNlY3Rpb24oKSlcbnJldHVybiBsaS5nZXRJbnRlcnNlY3Rpb24oMCk7cmV0dXJuIG51bGw7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnNldENvb3JkaW5hdGVzPWZ1bmN0aW9uKGxzKXtpZihscyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXt0aGlzLnNldENvb3JkaW5hdGVzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuc2V0Q29vcmRpbmF0ZXMyKGxzLnAwLGxzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuc2V0Q29vcmRpbmF0ZXMyPWZ1bmN0aW9uKHAwLHAxKXt0aGlzLnAwLng9cDAueDt0aGlzLnAwLnk9cDAueTt0aGlzLnAxLng9cDEueDt0aGlzLnAxLnk9cDEueTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2VQZXJwZW5kaWN1bGFyPWZ1bmN0aW9uKHApe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmVQZXJwZW5kaWN1bGFyKHAsdGhpcy5wMCx0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUubGluZUludGVyc2VjdGlvbj1mdW5jdGlvbihsaW5lKXt0cnl7dmFyIGludFB0PWpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLmludGVyc2VjdGlvbih0aGlzLnAwLHRoaXMucDEsbGluZS5wMCxsaW5lLnAxKTtyZXR1cm4gaW50UHQ7fWNhdGNoKGV4KXt9XG5yZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUudG9HZW9tZXRyeT1mdW5jdGlvbihnZW9tRmFjdG9yeSl7cmV0dXJuIGdlb21GYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoW3RoaXMucDAsdGhpcy5wMV0pO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24obyl7aWYoIShvIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLnAwLmVxdWFscyhvLnAwKSYmdGhpcy5wMS5lcXVhbHMoby5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvKXt2YXIgY29tcDA9dGhpcy5wMC5jb21wYXJlVG8oby5wMCk7aWYoY29tcDAhPT0wKXJldHVybiBjb21wMDtyZXR1cm4gdGhpcy5wMS5jb21wYXJlVG8oby5wMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmVxdWFsc1RvcG89ZnVuY3Rpb24ob3RoZXIpe3JldHVybiB0aGlzLnAwLmVxdWFscyhvdGhlci5wMCkmJnRoaXMucDEuZXF1YWxzKG90aGVyLnAxKXx8dGhpcy5wMC5lcXVhbHMob3RoZXIucDEpJiZ0aGlzLnAxLmVxdWFscyhvdGhlci5wMCk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJMSU5FU1RSSU5HKFwiK1xudGhpcy5wMC54K1wiIFwiK3RoaXMucDAueVxuK1wiLCBcIitcbnRoaXMucDEueCtcIiBcIit0aGlzLnAxLnkrXCIpXCI7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uPWZ1bmN0aW9uKCl7dGhpcy50ZW1wRW52MT1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy50ZW1wRW52Mj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy5vdmVybGFwU2VnMT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5vdmVybGFwU2VnMj1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uLnByb3RvdHlwZS50ZW1wRW52MT1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLnRlbXBFbnYyPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcFNlZzE9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uLnByb3RvdHlwZS5vdmVybGFwU2VnMj1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXA9ZnVuY3Rpb24obWMxLHN0YXJ0MSxtYzIsc3RhcnQyKXt0aGlzLm1jMS5nZXRMaW5lU2VnbWVudChzdGFydDEsdGhpcy5vdmVybGFwU2VnMSk7dGhpcy5tYzIuZ2V0TGluZVNlZ21lbnQoc3RhcnQyLHRoaXMub3ZlcmxhcFNlZzIpO3RoaXMub3ZlcmxhcDIodGhpcy5vdmVybGFwU2VnMSx0aGlzLm92ZXJsYXBTZWcyKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXAyPWZ1bmN0aW9uKHNlZzEsc2VnMil7fTsoZnVuY3Rpb24oKXt2YXIgTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb249anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbjt2YXIgU2luZ2xlUGFzc05vZGVyPWpzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlcjt2YXIgU1RSdHJlZT1qc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZTt2YXIgTm9kZWRTZWdtZW50U3RyaW5nPWpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZzt2YXIgTW9ub3RvbmVDaGFpbkJ1aWxkZXI9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlcjt2YXIgU2VnbWVudE92ZXJsYXBBY3Rpb249ZnVuY3Rpb24oc2kpe3RoaXMuc2k9c2k7fTtTZWdtZW50T3ZlcmxhcEFjdGlvbi5wcm90b3R5cGU9bmV3IE1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uKCk7U2VnbWVudE92ZXJsYXBBY3Rpb24uY29uc3RydWN0b3I9U2VnbWVudE92ZXJsYXBBY3Rpb247U2VnbWVudE92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLnNpPW51bGw7U2VnbWVudE92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXA9ZnVuY3Rpb24obWMxLHN0YXJ0MSxtYzIsc3RhcnQyKXt2YXIgc3MxPW1jMS5nZXRDb250ZXh0KCk7dmFyIHNzMj1tYzIuZ2V0Q29udGV4dCgpO3RoaXMuc2kucHJvY2Vzc0ludGVyc2VjdGlvbnMoc3MxLHN0YXJ0MSxzczIsc3RhcnQyKTt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlcj1mdW5jdGlvbigpe3RoaXMubW9ub0NoYWlucz1bXTt0aGlzLmluZGV4PW5ldyBTVFJ0cmVlKCk7fTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlPW5ldyBTaW5nbGVQYXNzTm9kZXIoKTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUubW9ub0NoYWlucz1udWxsO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuaW5kZXg9bnVsbDtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmlkQ291bnRlcj0wO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUubm9kZWRTZWdTdHJpbmdzPW51bGw7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5uT3ZlcmxhcHM9MDtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmdldE1vbm90b25lQ2hhaW5zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9ub0NoYWluczt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuZ2V0SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbmRleDt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKCl7cmV0dXJuIE5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3ModGhpcy5ub2RlZFNlZ1N0cmluZ3MpO307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZXM9ZnVuY3Rpb24oaW5wdXRTZWdTdHJpbmdzKXt0aGlzLm5vZGVkU2VnU3RyaW5ncz1pbnB1dFNlZ1N0cmluZ3M7Zm9yKHZhciBpPWlucHV0U2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dGhpcy5hZGQoaS5uZXh0KCkpO31cbnRoaXMuaW50ZXJzZWN0Q2hhaW5zKCk7fTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmludGVyc2VjdENoYWlucz1mdW5jdGlvbigpe3ZhciBvdmVybGFwQWN0aW9uPW5ldyBTZWdtZW50T3ZlcmxhcEFjdGlvbih0aGlzLnNlZ0ludCk7Zm9yKHZhciBpPTA7aTx0aGlzLm1vbm9DaGFpbnMubGVuZ3RoO2krKyl7dmFyIHF1ZXJ5Q2hhaW49dGhpcy5tb25vQ2hhaW5zW2ldO3ZhciBvdmVybGFwQ2hhaW5zPXRoaXMuaW5kZXgucXVlcnkocXVlcnlDaGFpbi5nZXRFbnZlbG9wZSgpKTtmb3IodmFyIGo9MDtqPG92ZXJsYXBDaGFpbnMubGVuZ3RoO2orKyl7dmFyIHRlc3RDaGFpbj1vdmVybGFwQ2hhaW5zW2pdO2lmKHRlc3RDaGFpbi5nZXRJZCgpPnF1ZXJ5Q2hhaW4uZ2V0SWQoKSl7cXVlcnlDaGFpbi5jb21wdXRlT3ZlcmxhcHModGVzdENoYWluLG92ZXJsYXBBY3Rpb24pO3RoaXMubk92ZXJsYXBzKys7fVxuaWYodGhpcy5zZWdJbnQuaXNEb25lKCkpXG5yZXR1cm47fX19O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHNlZ1N0cil7dmFyIHNlZ0NoYWlucz1Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpbnMoc2VnU3RyLmdldENvb3JkaW5hdGVzKCksc2VnU3RyKTtmb3IodmFyIGk9MDtpPHNlZ0NoYWlucy5sZW5ndGg7aSsrKXt2YXIgbWM9c2VnQ2hhaW5zW2ldO21jLnNldElkKHRoaXMuaWRDb3VudGVyKyspO3RoaXMuaW5kZXguaW5zZXJ0KG1jLmdldEVudmVsb3BlKCksbWMpO3RoaXMubW9ub0NoYWlucy5wdXNoKG1jKTt9fTt9KSgpO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3RoaXMuaW5kZXg9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUoKTt9O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUuaW5kZXg9bnVsbDtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihsaW5lKXtpZihsaW5lIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KXt0aGlzLmFkZDIobGluZSk7cmV0dXJuO31cbnZhciBzZWdzPWxpbmUuZ2V0U2VnbWVudHMoKTtmb3IodmFyIGk9MDtpPHNlZ3MubGVuZ3RoO2krKyl7dmFyIHNlZz1zZWdzW2ldO3RoaXMuYWRkMihzZWcpO319O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihzZWcpe3RoaXMuaW5kZXguaW5zZXJ0KG5ldyBqc3RzLmdlb20uRW52ZWxvcGUoc2VnLnAwLHNlZy5wMSksc2VnKTt9O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHNlZyl7dGhpcy5pbmRleC5yZW1vdmUobmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShzZWcucDAsc2VnLnAxKSxzZWcpO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihxdWVyeVNlZyl7dmFyIGVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHF1ZXJ5U2VnLnAwLHF1ZXJ5U2VnLnAxKTt2YXIgdmlzaXRvcj1uZXcganN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvcihxdWVyeVNlZyk7dGhpcy5pbmRleC5xdWVyeShlbnYsdmlzaXRvcik7dmFyIGl0ZW1zRm91bmQ9dmlzaXRvci5nZXRJdGVtcygpO3JldHVybiBpdGVtc0ZvdW5kO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvcj1mdW5jdGlvbihxdWVyeVNlZyl7dGhpcy5pdGVtcz1bXTt0aGlzLnF1ZXJ5U2VnPXF1ZXJ5U2VnO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvci5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguSXRlbVZpc2l0b3IoKTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5xdWVyeVNlZz1udWxsO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5MaW5lU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLml0ZW1zPW51bGw7anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvci5wcm90b3R5cGUudmlzaXRJdGVtPWZ1bmN0aW9uKGl0ZW0pe3ZhciBzZWc9aXRlbTtpZihqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhzZWcucDAsc2VnLnAxLHRoaXMucXVlcnlTZWcucDAsdGhpcy5xdWVyeVNlZy5wMSkpXG50aGlzLml0ZW1zLnB1c2goaXRlbSk7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXI9ZnVuY3Rpb24oKXt0aGlzLmVkZ2VNYXA9bmV3IGphdmFzY3JpcHQudXRpbC5UcmVlTWFwKCk7dGhpcy5lZGdlTGlzdD1udWxsO3RoaXMucHRJbkFyZWFMb2NhdGlvbj1banN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkVdO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmVkZ2VNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZWRnZUxpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUucHRJbkFyZWFMb2NhdGlvbj1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5pbnNlcnRFZGdlRW5kPWZ1bmN0aW9uKGUsb2JqKXt0aGlzLmVkZ2VNYXAucHV0KGUsb2JqKTt0aGlzLmVkZ2VMaXN0PW51bGw7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3ZhciBpdD10aGlzLml0ZXJhdG9yKCk7aWYoIWl0Lmhhc05leHQoKSlcbnJldHVybiBudWxsO3ZhciBlPWl0Lm5leHQoKTtyZXR1cm4gZS5nZXRDb29yZGluYXRlKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0RGVncmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZU1hcC5zaXplKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRFZGdlcygpLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtpZih0aGlzLmVkZ2VMaXN0PT09bnVsbCl7dGhpcy5lZGdlTGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCh0aGlzLmVkZ2VNYXAudmFsdWVzKCkpO31cbnJldHVybiB0aGlzLmVkZ2VMaXN0O307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmdldE5leHRDVz1mdW5jdGlvbihlZSl7dGhpcy5nZXRFZGdlcygpO3ZhciBpPXRoaXMuZWRnZUxpc3QuaW5kZXhPZihlZSk7dmFyIGlOZXh0Q1c9aS0xO2lmKGk9PT0wKVxuaU5leHRDVz10aGlzLmVkZ2VMaXN0Lmxlbmd0aC0xO3JldHVybiB0aGlzLmVkZ2VMaXN0W2lOZXh0Q1ddO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmNvbXB1dGVMYWJlbGxpbmc9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmNvbXB1dGVFZGdlRW5kTGFiZWxzKGdlb21HcmFwaFswXS5nZXRCb3VuZGFyeU5vZGVSdWxlKCkpO3RoaXMucHJvcGFnYXRlU2lkZUxhYmVscygwKTt0aGlzLnByb3BhZ2F0ZVNpZGVMYWJlbHMoMSk7dmFyIGhhc0RpbWVuc2lvbmFsQ29sbGFwc2VFZGdlPVtmYWxzZSxmYWxzZV07Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO3ZhciBsYWJlbD1lLmdldExhYmVsKCk7Zm9yKHZhciBnZW9taT0wO2dlb21pPDI7Z2VvbWkrKyl7aWYobGFiZWwuaXNMaW5lKGdlb21pKSYmbGFiZWwuZ2V0TG9jYXRpb24oZ2VvbWkpPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxuaGFzRGltZW5zaW9uYWxDb2xsYXBzZUVkZ2VbZ2VvbWldPXRydWU7fX1cbmZvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2Zvcih2YXIgZ2VvbWk9MDtnZW9taTwyO2dlb21pKyspe2lmKGxhYmVsLmlzQW55TnVsbChnZW9taSkpe3ZhciBsb2M9anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7aWYoaGFzRGltZW5zaW9uYWxDb2xsYXBzZUVkZ2VbZ2VvbWldKXtsb2M9anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO31lbHNle3ZhciBwPWUuZ2V0Q29vcmRpbmF0ZSgpO2xvYz10aGlzLmdldExvY2F0aW9uKGdlb21pLHAsZ2VvbUdyYXBoKTt9XG5sYWJlbC5zZXRBbGxMb2NhdGlvbnNJZk51bGwoZ2VvbWksbG9jKTt9fX19O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5jb21wdXRlRWRnZUVuZExhYmVscz1mdW5jdGlvbihib3VuZGFyeU5vZGVSdWxlKXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZWU9aXQubmV4dCgpO2VlLmNvbXB1dGVMYWJlbChib3VuZGFyeU5vZGVSdWxlKTt9fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0TG9jYXRpb249ZnVuY3Rpb24oZ2VvbUluZGV4LHAsZ2VvbSl7aWYodGhpcy5wdEluQXJlYUxvY2F0aW9uW2dlb21JbmRleF09PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSl7dGhpcy5wdEluQXJlYUxvY2F0aW9uW2dlb21JbmRleF09anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5sb2NhdGUocCxnZW9tW2dlb21JbmRleF0uZ2V0R2VvbWV0cnkoKSk7fVxucmV0dXJuIHRoaXMucHRJbkFyZWFMb2NhdGlvbltnZW9tSW5kZXhdO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmlzQXJlYUxhYmVsc0NvbnNpc3RlbnQ9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmNvbXB1dGVFZGdlRW5kTGFiZWxzKGdlb21HcmFwaC5nZXRCb3VuZGFyeU5vZGVSdWxlKCkpO3JldHVybiB0aGlzLmNoZWNrQXJlYUxhYmVsc0NvbnNpc3RlbnQoMCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuY2hlY2tBcmVhTGFiZWxzQ29uc2lzdGVudD1mdW5jdGlvbihnZW9tSW5kZXgpe3ZhciBlZGdlcz10aGlzLmdldEVkZ2VzKCk7aWYoZWRnZXMuc2l6ZSgpPD0wKVxucmV0dXJuIHRydWU7dmFyIGxhc3RFZGdlSW5kZXg9ZWRnZXMuc2l6ZSgpLTE7dmFyIHN0YXJ0TGFiZWw9ZWRnZXMuZ2V0KGxhc3RFZGdlSW5kZXgpLmdldExhYmVsKCk7dmFyIHN0YXJ0TG9jPXN0YXJ0TGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHN0YXJ0TG9jIT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSwnRm91bmQgdW5sYWJlbGxlZCBhcmVhIGVkZ2UnKTt2YXIgY3VyckxvYz1zdGFydExvYztmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShsYWJlbC5pc0FyZWEoZ2VvbUluZGV4KSwnRm91bmQgbm9uLWFyZWEgZWRnZScpO3ZhciBsZWZ0TG9jPWxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt2YXIgcmlnaHRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTtpZihsZWZ0TG9jPT09cmlnaHRMb2Mpe3JldHVybiBmYWxzZTt9XG5pZihyaWdodExvYyE9PWN1cnJMb2Mpe3JldHVybiBmYWxzZTt9XG5jdXJyTG9jPWxlZnRMb2M7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUucHJvcGFnYXRlU2lkZUxhYmVscz1mdW5jdGlvbihnZW9tSW5kZXgpe3ZhciBzdGFydExvYz1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtpZihsYWJlbC5pc0FyZWEoZ2VvbUluZGV4KSYmbGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpIT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5zdGFydExvYz1sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7fVxuaWYoc3RhcnRMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnJldHVybjt2YXIgY3VyckxvYz1zdGFydExvYztmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtpZihsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04pPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04sY3VyckxvYyk7aWYobGFiZWwuaXNBcmVhKGdlb21JbmRleCkpe3ZhciBsZWZ0TG9jPWxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt2YXIgcmlnaHRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTtpZihyaWdodExvYyE9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKXtpZihyaWdodExvYyE9PWN1cnJMb2MpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCdzaWRlIGxvY2F0aW9uIGNvbmZsaWN0JyxlLmdldENvb3JkaW5hdGUoKSk7aWYobGVmdExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCdmb3VuZCBzaW5nbGUgbnVsbCBzaWRlIChhdCAnK1xuZS5nZXRDb29yZGluYXRlKCkrJyknKTt9XG5jdXJyTG9jPWxlZnRMb2M7fWVsc2V7anN0cy51dGlsLkFzc2VydC5pc1RydWUobGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsJ2ZvdW5kIHNpbmdsZSBudWxsIHNpZGUnKTtsYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQsY3VyckxvYyk7bGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQsY3VyckxvYyk7fX19fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZmluZEluZGV4PWZ1bmN0aW9uKGVTZWFyY2gpe3RoaXMuaXRlcmF0b3IoKTtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUxpc3Quc2l6ZSgpO2krKyl7dmFyIGU9dGhpcy5lZGdlTGlzdC5nZXQoaSk7aWYoZT09PWVTZWFyY2gpXG5yZXR1cm4gaTt9XG5yZXR1cm4tMTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3Rhcj1mdW5jdGlvbigpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3Rhci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyKCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oZSl7dmFyIGViPXRoaXMuZWRnZU1hcC5nZXQoZSk7aWYoZWI9PT1udWxsKXtlYj1uZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUoZSk7dGhpcy5pbnNlcnRFZGdlRW5kKGUsZWIpO31cbmVsc2V7ZWIuaW5zZXJ0KGUpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3Rhci5wcm90b3R5cGUudXBkYXRlSU09ZnVuY3Rpb24oaW0pe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlc2I9aXQubmV4dCgpO2VzYi51cGRhdGVJTShpbSk7fX07anN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yPWZ1bmN0aW9uKCl7dGhpcy5pdGVtcz1bXTt9O2pzdHMuaW5kZXguQXJyYXlMaXN0VmlzaXRvci5wcm90b3R5cGUudmlzaXRJdGVtPWZ1bmN0aW9uKGl0ZW0pe3RoaXMuaXRlbXMucHVzaChpdGVtKTt9O2pzdHMuaW5kZXguQXJyYXlMaXN0VmlzaXRvci5wcm90b3R5cGUuZ2V0SXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtczt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludD1mdW5jdGlvbigpe307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZT1mdW5jdGlvbihnZW9tLHB0LHB0RGlzdCl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlMihnZW9tLHB0LHB0RGlzdCk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlNChnZW9tLHB0LHB0RGlzdCk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGc9Z2MuZ2V0R2VvbWV0cnlOKGkpO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UoZyxwdCxwdERpc3QpO319ZWxzZXtwdERpc3Quc2V0TWluaW11bShnZW9tLmdldENvb3JkaW5hdGUoKSxwdCk7fX07anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTI9ZnVuY3Rpb24obGluZSxwdCxwdERpc3Qpe3ZhciB0ZW1wU2VnbWVudD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dmFyIGNvb3Jkcz1saW5lLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxjb29yZHMubGVuZ3RoLTE7aSsrKXt0ZW1wU2VnbWVudC5zZXRDb29yZGluYXRlcyhjb29yZHNbaV0sY29vcmRzW2krMV0pO3ZhciBjbG9zZXN0UHQ9dGVtcFNlZ21lbnQuY2xvc2VzdFBvaW50KHB0KTtwdERpc3Quc2V0TWluaW11bShjbG9zZXN0UHQscHQpO319O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UzPWZ1bmN0aW9uKHNlZ21lbnQscHQscHREaXN0KXt2YXIgY2xvc2VzdFB0PXNlZ21lbnQuY2xvc2VzdFBvaW50KHB0KTtwdERpc3Quc2V0TWluaW11bShjbG9zZXN0UHQscHQpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTQ9ZnVuY3Rpb24ocG9seSxwdCxwdERpc3Qpe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UyKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkscHQscHREaXN0KTtmb3IodmFyIGk9MDtpPHBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlMihwb2x5LmdldEludGVyaW9yUmluZ04oaSkscHQscHREaXN0KTt9fTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZT1mdW5jdGlvbihib3VuZHMsaXRlbSl7dGhpcy5ib3VuZHM9Ym91bmRzO3RoaXMuaXRlbT1pdGVtO307anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlKCk7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUuY29uc3RydWN0b3I9anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGU7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLmJvdW5kcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlLnByb3RvdHlwZS5pdGVtPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLmdldEJvdW5kcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJvdW5kczt9O2pzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlLnByb3RvdHlwZS5nZXRJdGVtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlbTt9OyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgVHJlZU1hcD1qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcDtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdD1mdW5jdGlvbigpe3RoaXMuZWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMub2NhTWFwPW5ldyBUcmVlTWFwKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUub2NhTWFwPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt0aGlzLmVkZ2VzLmFkZChlKTt2YXIgb2NhPW5ldyBqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheShlLmdldENvb3JkaW5hdGVzKCkpO3RoaXMub2NhTWFwLnB1dChvY2EsZSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuYWRkQWxsPWZ1bmN0aW9uKGVkZ2VDb2xsKXtmb3IodmFyIGk9ZWRnZUNvbGwuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3RoaXMuYWRkKGkubmV4dCgpKTt9fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5maW5kRXF1YWxFZGdlPWZ1bmN0aW9uKGUpe3ZhciBvY2E9bmV3IGpzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5KGUuZ2V0Q29vcmRpbmF0ZXMoKSk7dmFyIG1hdGNoRWRnZT10aGlzLm9jYU1hcC5nZXQob2NhKTtyZXR1cm4gbWF0Y2hFZGdlO307anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXM7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlcy5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmdldD1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5lZGdlcy5nZXQoaSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZmluZEVkZ2VJbmRleD1mdW5jdGlvbihlKXtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZXMuc2l6ZSgpO2krKyl7aWYodGhpcy5lZGdlcy5nZXQoaSkuZXF1YWxzKGUpKVxucmV0dXJuIGk7fVxucmV0dXJuLTE7fTt9KSgpO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3A9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5nZW9tPWdlb207fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5nZW9tPW51bGw7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuaXNDbG9zZWRFbmRwb2ludHNJbkludGVyaW9yPXRydWU7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUubm9uU2ltcGxlTG9jYXRpb249bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5Jc1NpbXBsZU9wPWZ1bmN0aW9uKGdlb20pe3RoaXMuZ2VvbT1nZW9tO307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuaXNTaW1wbGU9ZnVuY3Rpb24oKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPW51bGw7aWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmlzU2ltcGxlTGluZWFyR2VvbWV0cnkodGhpcy5nZW9tKTt9XG5pZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKXtyZXR1cm4gdGhpcy5pc1NpbXBsZUxpbmVhckdlb21ldHJ5KHRoaXMuZ2VvbSk7fVxuaWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpe3JldHVybiB0aGlzLmlzU2ltcGxlTXVsdGlQb2ludCh0aGlzLmdlb20pO31cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuaXNTaW1wbGVNdWx0aVBvaW50PWZ1bmN0aW9uKG1wKXtpZihtcC5pc0VtcHR5KCkpXG5yZXR1cm4gdHJ1ZTt2YXIgcG9pbnRzPVtdO2Zvcih2YXIgaT0wO2k8bXAuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHB0PW1wLmdldEdlb21ldHJ5TihpKTt2YXIgcD1wdC5nZXRDb29yZGluYXRlKCk7Zm9yKHZhciBqPTA7ajxwb2ludHMubGVuZ3RoO2orKyl7dmFyIHBvaW50PXBvaW50c1tqXTtpZihwLmVxdWFsczJEKHBvaW50KSl7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1wO3JldHVybiBmYWxzZTt9fVxucG9pbnRzLnB1c2gocCk7fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc1NpbXBsZUxpbmVhckdlb21ldHJ5PWZ1bmN0aW9uKGdlb20pe2lmKGdlb20uaXNFbXB0eSgpKVxucmV0dXJuIHRydWU7dmFyIGdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZ2VvbSk7dmFyIGxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt2YXIgc2k9Z3JhcGguY29tcHV0ZVNlbGZOb2RlcyhsaSx0cnVlKTtpZighc2kuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTtpZihzaS5oYXNQcm9wZXJJbnRlcnNlY3Rpb24oKSl7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1zaS5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludCgpO3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmhhc05vbkVuZHBvaW50SW50ZXJzZWN0aW9uKGdyYXBoKSlcbnJldHVybiBmYWxzZTtpZih0aGlzLmlzQ2xvc2VkRW5kcG9pbnRzSW5JbnRlcmlvcil7aWYodGhpcy5oYXNDbG9zZWRFbmRwb2ludEludGVyc2VjdGlvbihncmFwaCkpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5oYXNOb25FbmRwb2ludEludGVyc2VjdGlvbj1mdW5jdGlvbihncmFwaCl7Zm9yKHZhciBpPWdyYXBoLmdldEVkZ2VJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dmFyIG1heFNlZ21lbnRJbmRleD1lLmdldE1heGltdW1TZWdtZW50SW5kZXgoKTtmb3IodmFyIGVpSXQ9ZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpLml0ZXJhdG9yKCk7ZWlJdC5oYXNOZXh0KCk7KXt2YXIgZWk9ZWlJdC5uZXh0KCk7aWYoIWVpLmlzRW5kUG9pbnQobWF4U2VnbWVudEluZGV4KSl7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1laS5nZXRDb29yZGluYXRlKCk7cmV0dXJuIHRydWU7fX19XG5yZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5oYXNDbG9zZWRFbmRwb2ludEludGVyc2VjdGlvbj1mdW5jdGlvbihncmFwaCl7dmFyIGVuZFBvaW50cz1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTtmb3IodmFyIGk9Z3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgbWF4U2VnbWVudEluZGV4PWUuZ2V0TWF4aW11bVNlZ21lbnRJbmRleCgpO3ZhciBpc0Nsb3NlZD1lLmlzQ2xvc2VkKCk7dmFyIHAwPWUuZ2V0Q29vcmRpbmF0ZSgwKTt0aGlzLmFkZEVuZHBvaW50KGVuZFBvaW50cyxwMCxpc0Nsb3NlZCk7dmFyIHAxPWUuZ2V0Q29vcmRpbmF0ZShlLmdldE51bVBvaW50cygpLTEpO3RoaXMuYWRkRW5kcG9pbnQoZW5kUG9pbnRzLHAxLGlzQ2xvc2VkKTt9XG5mb3IodmFyIGk9ZW5kUG9pbnRzLnZhbHVlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWlJbmZvPWkubmV4dCgpO2lmKGVpSW5mby5pc0Nsb3NlZCYmZWlJbmZvLmRlZ3JlZSE9Mil7dGhpcy5ub25TaW1wbGVMb2NhdGlvbj1laUluZm8uZ2V0Q29vcmRpbmF0ZSgpO3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mbz1mdW5jdGlvbihwdCl7dGhpcy5wdD1wdDt0aGlzLmlzQ2xvc2VkPWZhbHNlO3RoaXMuZGVncmVlPTA7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUuaXNDbG9zZWQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUuZGVncmVlPW51bGw7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5FbmRwb2ludEluZm8ucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5hZGRFbmRwb2ludD1mdW5jdGlvbihpc0Nsb3NlZCl7dGhpcy5kZWdyZWUrKzt0aGlzLmlzQ2xvc2VkPXRoaXMuaXNDbG9zZWR8fGlzQ2xvc2VkO307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5wcm90b3R5cGUuYWRkRW5kcG9pbnQ9ZnVuY3Rpb24oZW5kUG9pbnRzLHAsaXNDbG9zZWQpe3ZhciBlaUluZm89ZW5kUG9pbnRzLmdldChwKTtpZihlaUluZm89PT1udWxsKXtlaUluZm89bmV3IGpzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvKHApO2VuZFBvaW50cy5wdXQocCxlaUluZm8pO31cbmVpSW5mby5hZGRFbmRwb2ludChpc0Nsb3NlZCk7fTsoZnVuY3Rpb24oKXt2YXIgTGluZVN0cmluZ1NuYXBwZXI9ZnVuY3Rpb24oKXt0aGlzLnNuYXBUb2xlcmFuY2U9MC4wO3RoaXMuc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLmFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzPWZhbHNlO3RoaXMuaXNDbG9zZWQ9ZmFsc2U7dGhpcy5zcmNQdHM9W107aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5pbml0RnJvbUxpbmUuYXBwbHkodGhpcyxhcmd1bWVudHMpO31lbHNle3RoaXMuaW5pdEZyb21Qb2ludHMuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5pbml0RnJvbUxpbmU9ZnVuY3Rpb24oc3JjTGluZSxzbmFwVG9sZXJhbmNlKXt0aGlzLmluaXRGcm9tUG9pbnRzKHNyY0xpbmUuZ2V0Q29vcmRpbmF0ZXMoKSxzbmFwVG9sZXJhbmNlKTt9O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5pbml0RnJvbVBvaW50cz1mdW5jdGlvbihzcmNQdHMsc25hcFRvbGVyYW5jZSl7dGhpcy5zcmNQdHM9c3JjUHRzO3RoaXMuaXNDbG9zZWQ9dGhpcy5jYWxjSXNDbG9zZWQoc3JjUHRzKTt0aGlzLnNuYXBUb2xlcmFuY2U9c25hcFRvbGVyYW5jZTt9O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5zZXRBbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcz1mdW5jdGlvbihhbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcyl7dGhpcy5hbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcz1hbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlczt9O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5jYWxjSXNDbG9zZWQ9ZnVuY3Rpb24ocHRzKXtpZihwdHMubGVuZ3RoPD0xKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHB0c1swXS5lcXVhbHMocHRzW3B0cy5sZW5ndGgtMV0pO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNuYXBUbz1mdW5jdGlvbihzbmFwUHRzKXt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QodGhpcy5zcmNQdHMpO3RoaXMuc25hcFZlcnRpY2VzKGNvb3JkTGlzdCxzbmFwUHRzKTt0aGlzLnNuYXBTZWdtZW50cyhjb29yZExpc3Qsc25hcFB0cyk7cmV0dXJuIGNvb3JkTGlzdC50b0Nvb3JkaW5hdGVBcnJheSgpO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNuYXBWZXJ0aWNlcz1mdW5jdGlvbihzcmNDb29yZHMsc25hcFB0cyl7dmFyIGVuZD10aGlzLmlzQ2xvc2VkP3NyY0Nvb3Jkcy5zaXplKCktMTpzcmNDb29yZHMuc2l6ZSgpLGk9MCxzcmNQdCxzbmFwVmVydDtmb3IoaTtpPGVuZDtpKyspe3NyY1B0PXNyY0Nvb3Jkcy5nZXQoaSk7c25hcFZlcnQ9dGhpcy5maW5kU25hcEZvclZlcnRleChzcmNQdCxzbmFwUHRzKTtpZihzbmFwVmVydCE9PW51bGwpe3NyY0Nvb3Jkcy5zZXQoaSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc25hcFZlcnQpKTtpZihpPT09MCYmdGhpcy5pc0Nsb3NlZClcbnNyY0Nvb3Jkcy5zZXQoc3JjQ29vcmRzLnNpemUoKS0xLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzbmFwVmVydCkpO319fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuZmluZFNuYXBGb3JWZXJ0ZXg9ZnVuY3Rpb24ocHQsc25hcFB0cyl7dmFyIGk9MCxpbD1zbmFwUHRzLmxlbmd0aDtmb3IoaT0wO2k8aWw7aSsrKXtpZihwdC5lcXVhbHMoc25hcFB0c1tpXSkpe3JldHVybiBudWxsO31cbmlmKHB0LmRpc3RhbmNlKHNuYXBQdHNbaV0pPHRoaXMuc25hcFRvbGVyYW5jZSl7cmV0dXJuIHNuYXBQdHNbaV07fX1cbnJldHVybiBudWxsO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNuYXBTZWdtZW50cz1mdW5jdGlvbihzcmNDb29yZHMsc25hcFB0cyl7aWYoc25hcFB0cy5sZW5ndGg9PT0wKXtyZXR1cm47fVxudmFyIGRpc3RpbmN0UHRDb3VudD1zbmFwUHRzLmxlbmd0aCxpLHNuYXBQdCxpbmRleDtpZihzbmFwUHRzLmxlbmd0aD4xJiZzbmFwUHRzWzBdLmVxdWFsczJEKHNuYXBQdHNbc25hcFB0cy5sZW5ndGgtMV0pKXtkaXN0aW5jdFB0Q291bnQ9c25hcFB0cy5sZW5ndGgtMTt9XG5pPTA7Zm9yKGk7aTxkaXN0aW5jdFB0Q291bnQ7aSsrKXtzbmFwUHQ9c25hcFB0c1tpXTtpbmRleD10aGlzLmZpbmRTZWdtZW50SW5kZXhUb1NuYXAoc25hcFB0LHNyY0Nvb3Jkcyk7aWYoaW5kZXg+PTApe3NyY0Nvb3Jkcy5hZGQoaW5kZXgrMSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc25hcFB0KSxmYWxzZSk7fX19O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5maW5kU2VnbWVudEluZGV4VG9TbmFwPWZ1bmN0aW9uKHNuYXBQdCxzcmNDb29yZHMpe3ZhciBtaW5EaXN0PU51bWJlci5NQVhfVkFMVUUsc25hcEluZGV4PS0xLGk9MCxkaXN0O2ZvcihpO2k8c3JjQ29vcmRzLnNpemUoKS0xO2krKyl7dGhpcy5zZWcucDA9c3JjQ29vcmRzLmdldChpKTt0aGlzLnNlZy5wMT1zcmNDb29yZHMuZ2V0KGkrMSk7aWYodGhpcy5zZWcucDAuZXF1YWxzKHNuYXBQdCl8fHRoaXMuc2VnLnAxLmVxdWFscyhzbmFwUHQpKXtpZih0aGlzLmFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzKXtjb250aW51ZTt9ZWxzZXtyZXR1cm4tMTt9fVxuZGlzdD10aGlzLnNlZy5kaXN0YW5jZShzbmFwUHQpO2lmKGRpc3Q8dGhpcy5zbmFwVG9sZXJhbmNlJiZkaXN0PG1pbkRpc3Qpe21pbkRpc3Q9ZGlzdDtzbmFwSW5kZXg9aTt9fVxucmV0dXJuIHNuYXBJbmRleDt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5MaW5lU3RyaW5nU25hcHBlcj1MaW5lU3RyaW5nU25hcHBlcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgR2VvbWV0cnlDb21wb25lbnRGaWx0ZXI9anN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyO3ZhciBMaW5lU3RyaW5nPWpzdHMuZ2VvbS5MaW5lU3RyaW5nO3ZhciBFZGdlUmluZz1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLkVkZ2VSaW5nO3ZhciBQb2x5Z29uaXplR3JhcGg9anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplR3JhcGg7dmFyIFBvbHlnb25pemVyPWZ1bmN0aW9uKCl7dmFyIHRoYXQ9dGhpczt2YXIgTGluZVN0cmluZ0FkZGVyPWZ1bmN0aW9uKCl7fTtMaW5lU3RyaW5nQWRkZXIucHJvdG90eXBlPW5ldyBHZW9tZXRyeUNvbXBvbmVudEZpbHRlcigpO0xpbmVTdHJpbmdBZGRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGcpe2lmKGcgaW5zdGFuY2VvZiBMaW5lU3RyaW5nKVxudGhhdC5hZGQoZyk7fTt0aGlzLmxpbmVTdHJpbmdBZGRlcj1uZXcgTGluZVN0cmluZ0FkZGVyKCk7dGhpcy5kYW5nbGVzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmN1dEVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmludmFsaWRSaW5nTGluZXM9bmV3IEFycmF5TGlzdCgpO307UG9seWdvbml6ZXIucHJvdG90eXBlLmxpbmVTdHJpbmdBZGRlcj1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5ncmFwaD1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5kYW5nbGVzPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmN1dEVkZ2VzPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmludmFsaWRSaW5nTGluZXM9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuaG9sZUxpc3Q9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuc2hlbGxMaXN0PW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLnBvbHlMaXN0PW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tTGlzdCl7aWYoZ2VvbUxpc3QgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7cmV0dXJuIHRoaXMuYWRkMyhnZW9tTGlzdCk7fWVsc2UgaWYoZ2VvbUxpc3QgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnkpe3JldHVybiB0aGlzLmFkZDIoZ2VvbUxpc3QpO31cbmZvcih2YXIgaT1nZW9tTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdlb21ldHJ5PWkubmV4dCgpO3RoaXMuYWRkMihnZW9tZXRyeSk7fX07UG9seWdvbml6ZXIucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24oZyl7Zy5hcHBseSh0aGlzLmxpbmVTdHJpbmdBZGRlcik7fTtQb2x5Z29uaXplci5wcm90b3R5cGUuYWRkMz1mdW5jdGlvbihsaW5lKXtpZih0aGlzLmdyYXBoPT1udWxsKVxudGhpcy5ncmFwaD1uZXcgUG9seWdvbml6ZUdyYXBoKGxpbmUuZ2V0RmFjdG9yeSgpKTt0aGlzLmdyYXBoLmFkZEVkZ2UobGluZSk7fTtQb2x5Z29uaXplci5wcm90b3R5cGUuZ2V0UG9seWdvbnM9ZnVuY3Rpb24oKXt0aGlzLnBvbHlnb25pemUoKTtyZXR1cm4gdGhpcy5wb2x5TGlzdDt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5nZXREYW5nbGVzPWZ1bmN0aW9uKCl7dGhpcy5wb2x5Z29uaXplKCk7cmV0dXJuIHRoaXMuZGFuZ2xlczt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5nZXRDdXRFZGdlcz1mdW5jdGlvbigpe3RoaXMucG9seWdvbml6ZSgpO3JldHVybiB0aGlzLmN1dEVkZ2VzO307UG9seWdvbml6ZXIucHJvdG90eXBlLmdldEludmFsaWRSaW5nTGluZXM9ZnVuY3Rpb24oKXt0aGlzLnBvbHlnb25pemUoKTtyZXR1cm4gdGhpcy5pbnZhbGlkUmluZ0xpbmVzO307UG9seWdvbml6ZXIucHJvdG90eXBlLnBvbHlnb25pemU9ZnVuY3Rpb24oKXtpZih0aGlzLnBvbHlMaXN0IT1udWxsKVxucmV0dXJuO3RoaXMucG9seUxpc3Q9bmV3IEFycmF5TGlzdCgpO2lmKHRoaXMuZ3JhcGg9PW51bGwpXG5yZXR1cm47dGhpcy5kYW5nbGVzPXRoaXMuZ3JhcGguZGVsZXRlRGFuZ2xlcygpO3RoaXMuY3V0RWRnZXM9dGhpcy5ncmFwaC5kZWxldGVDdXRFZGdlcygpO3ZhciBlZGdlUmluZ0xpc3Q9dGhpcy5ncmFwaC5nZXRFZGdlUmluZ3MoKTt2YXIgdmFsaWRFZGdlUmluZ0xpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMuaW52YWxpZFJpbmdMaW5lcz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5maW5kVmFsaWRSaW5ncyhlZGdlUmluZ0xpc3QsdmFsaWRFZGdlUmluZ0xpc3QsdGhpcy5pbnZhbGlkUmluZ0xpbmVzKTt0aGlzLmZpbmRTaGVsbHNBbmRIb2xlcyh2YWxpZEVkZ2VSaW5nTGlzdCk7UG9seWdvbml6ZXIuYXNzaWduSG9sZXNUb1NoZWxscyh0aGlzLmhvbGVMaXN0LHRoaXMuc2hlbGxMaXN0KTt0aGlzLnBvbHlMaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5zaGVsbExpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlcj1pLm5leHQoKTt0aGlzLnBvbHlMaXN0LmFkZChlci5nZXRQb2x5Z29uKCkpO319O1BvbHlnb25pemVyLnByb3RvdHlwZS5maW5kVmFsaWRSaW5ncz1mdW5jdGlvbihlZGdlUmluZ0xpc3QsdmFsaWRFZGdlUmluZ0xpc3QsaW52YWxpZFJpbmdMaXN0KXtmb3IodmFyIGk9ZWRnZVJpbmdMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZXI9aS5uZXh0KCk7aWYoZXIuaXNWYWxpZCgpKVxudmFsaWRFZGdlUmluZ0xpc3QuYWRkKGVyKTtlbHNlXG5pbnZhbGlkUmluZ0xpc3QuYWRkKGVyLmdldExpbmVTdHJpbmcoKSk7fX07UG9seWdvbml6ZXIucHJvdG90eXBlLmZpbmRTaGVsbHNBbmRIb2xlcz1mdW5jdGlvbihlZGdlUmluZ0xpc3Qpe3RoaXMuaG9sZUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMuc2hlbGxMaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZWRnZVJpbmdMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZXI9aS5uZXh0KCk7aWYoZXIuaXNIb2xlKCkpXG50aGlzLmhvbGVMaXN0LmFkZChlcik7ZWxzZVxudGhpcy5zaGVsbExpc3QuYWRkKGVyKTt9fTtQb2x5Z29uaXplci5hc3NpZ25Ib2xlc1RvU2hlbGxzPWZ1bmN0aW9uKGhvbGVMaXN0LHNoZWxsTGlzdCl7Zm9yKHZhciBpPWhvbGVMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgaG9sZUVSPWkubmV4dCgpO1BvbHlnb25pemVyLmFzc2lnbkhvbGVUb1NoZWxsKGhvbGVFUixzaGVsbExpc3QpO319O1BvbHlnb25pemVyLmFzc2lnbkhvbGVUb1NoZWxsPWZ1bmN0aW9uKGhvbGVFUixzaGVsbExpc3Qpe3ZhciBzaGVsbD1FZGdlUmluZy5maW5kRWRnZVJpbmdDb250YWluaW5nKGhvbGVFUixzaGVsbExpc3QpO2lmKHNoZWxsIT1udWxsKVxuc2hlbGwuYWRkSG9sZShob2xlRVIuZ2V0UmluZygpKTt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZXI9UG9seWdvbml6ZXI7fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIEdlb21ldHJ5VHJhbnNmb3JtZXI9ZnVuY3Rpb24oKXt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmlucHV0R2VvbT1udWxsO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmZhY3Rvcnk9bnVsbDtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5wcnVuZUVtcHR5R2VvbWV0cnk9dHJ1ZTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5wcmVzZXJ2ZUdlb21ldHJ5Q29sbGVjdGlvblR5cGU9dHJ1ZTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5wcmVzZXJ2ZUNvbGxlY3Rpb25zPWZhbHNlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnJlc2VydmVUeXBlPWZhbHNlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmdldElucHV0R2VvbWV0cnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnB1dEdlb207fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm09ZnVuY3Rpb24oaW5wdXRHZW9tKXt0aGlzLmlucHV0R2VvbT1pbnB1dEdlb207dGhpcy5mYWN0b3J5PWlucHV0R2VvbS5nZXRGYWN0b3J5KCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KVxucmV0dXJuIHRoaXMudHJhbnNmb3JtUG9pbnQoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KVxucmV0dXJuIHRoaXMudHJhbnNmb3JtTXVsdGlQb2ludChpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1MaW5lYXJSaW5nKGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylcbnJldHVybiB0aGlzLnRyYW5zZm9ybUxpbmVTdHJpbmcoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1NdWx0aUxpbmVTdHJpbmcoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtUG9seWdvbihpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbilcbnJldHVybiB0aGlzLnRyYW5zZm9ybU11bHRpUG9seWdvbihpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbilcbnJldHVybiB0aGlzLnRyYW5zZm9ybUdlb21ldHJ5Q29sbGVjdGlvbihpbnB1dEdlb20sbnVsbCk7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCdVbmtub3duIEdlb21ldHJ5IHN1YnR5cGU6ICcrXG5pbnB1dEdlb20uZ2V0Q2xhc3MoKS5nZXROYW1lKCkpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuY3JlYXRlQ29vcmRpbmF0ZVNlcXVlbmNlPWZ1bmN0aW9uKGNvb3Jkcyl7cmV0dXJuIHRoaXMuZmFjdG9yeS5nZXRDb29yZGluYXRlU2VxdWVuY2VGYWN0b3J5KCkuY3JlYXRlKGNvb3Jkcyk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHNlcSl7cmV0dXJuIHNlcS5jbG9uZSgpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmRzLHBhcmVudCl7cmV0dXJuIHRoaXMuY29weShjb29yZHMpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnQ9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlUG9pbnQodGhpcy50cmFuc2Zvcm1Db29yZGluYXRlcyhnZW9tLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpLGdlb20pKTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybU11bHRpUG9pbnQ9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm1Qb2ludChnZW9tLmdldEdlb21ldHJ5TihpKSxnZW9tKTtpZih0cmFuc2Zvcm1HZW9tPT1udWxsKVxuY29udGludWU7aWYodHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkodHJhbnNHZW9tTGlzdCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1MaW5lYXJSaW5nPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgc2VxPXRoaXMudHJhbnNmb3JtQ29vcmRpbmF0ZXMoZ2VvbS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSxnZW9tKTt2YXIgc2VxU2l6ZT1zZXEubGVuZ3RoO2lmKHNlcVNpemU+MCYmc2VxU2l6ZTw0JiYhdGhpcy5wcmVzZXJ2ZVR5cGUpXG5yZXR1cm4gdGhpcy5mYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoc2VxKTtyZXR1cm4gdGhpcy5mYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoc2VxKTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUxpbmVTdHJpbmc9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyh0aGlzLnRyYW5zZm9ybUNvb3JkaW5hdGVzKGdlb20uZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCksZ2VvbSkpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgdHJhbnNHZW9tTGlzdD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciB0cmFuc2Zvcm1HZW9tPXRoaXMudHJhbnNmb3JtTGluZVN0cmluZyhnZW9tLmdldEdlb21ldHJ5TihpKSxnZW9tKTtpZih0cmFuc2Zvcm1HZW9tPT1udWxsKVxuY29udGludWU7aWYodHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkodHJhbnNHZW9tTGlzdCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgaXNBbGxWYWxpZExpbmVhclJpbmdzPXRydWU7dmFyIHNoZWxsPXRoaXMudHJhbnNmb3JtTGluZWFyUmluZyhnZW9tLmdldEV4dGVyaW9yUmluZygpLGdlb20pO2lmKHNoZWxsPT1udWxsfHwhKHNoZWxsIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpfHxzaGVsbC5pc0VtcHR5KCkpXG5pc0FsbFZhbGlkTGluZWFyUmluZ3M9ZmFsc2U7dmFyIGhvbGVzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT10aGlzLnRyYW5zZm9ybUxpbmVhclJpbmcoZ2VvbS5nZXRJbnRlcmlvclJpbmdOKGkpLGdlb20pO2lmKGhvbGU9PW51bGx8fGhvbGUuaXNFbXB0eSgpKXtjb250aW51ZTt9XG5pZighKGhvbGUgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZykpXG5pc0FsbFZhbGlkTGluZWFyUmluZ3M9ZmFsc2U7aG9sZXMuYWRkKGhvbGUpO31cbmlmKGlzQWxsVmFsaWRMaW5lYXJSaW5ncylcbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlUG9seWdvbihzaGVsbCxob2xlcy50b0FycmF5KCkpO2Vsc2V7dmFyIGNvbXBvbmVudHM9bmV3IEFycmF5TGlzdCgpO2lmKHNoZWxsIT1udWxsKVxuY29tcG9uZW50cy5hZGQoc2hlbGwpO2NvbXBvbmVudHMuYWRkQWxsKGhvbGVzKTtyZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkoY29tcG9uZW50cyk7fX07R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgdHJhbnNHZW9tTGlzdD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciB0cmFuc2Zvcm1HZW9tPXRoaXMudHJhbnNmb3JtUG9seWdvbihnZW9tLmdldEdlb21ldHJ5TihpKSxnZW9tKTtpZih0cmFuc2Zvcm1HZW9tPT1udWxsKVxuY29udGludWU7aWYodHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5LmJ1aWxkR2VvbWV0cnkodHJhbnNHZW9tTGlzdCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1HZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm0oZ2VvbS5nZXRHZW9tZXRyeU4oaSkpO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0aGlzLnBydW5lRW1wdHlHZW9tZXRyeSYmdHJhbnNmb3JtR2VvbS5pc0VtcHR5KCkpXG5jb250aW51ZTt0cmFuc0dlb21MaXN0LmFkZCh0cmFuc2Zvcm1HZW9tKTt9XG5pZih0aGlzLnByZXNlcnZlR2VvbWV0cnlDb2xsZWN0aW9uVHlwZSlcbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKEdlb21ldHJ5RmFjdG9yeS50b0dlb21ldHJ5QXJyYXkodHJhbnNHZW9tTGlzdCkpO3JldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXI9R2VvbWV0cnlUcmFuc2Zvcm1lcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBMaW5lU3RyaW5nU25hcHBlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuTGluZVN0cmluZ1NuYXBwZXI7dmFyIFByZWNpc2lvbk1vZGVsPWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbDt2YXIgVHJlZVNldD1qYXZhc2NyaXB0LnV0aWwuVHJlZVNldDt2YXIgU25hcFRyYW5zZm9ybWVyPWZ1bmN0aW9uKHNuYXBUb2xlcmFuY2Usc25hcFB0cyxpc1NlbGZTbmFwKXt0aGlzLnNuYXBUb2xlcmFuY2U9c25hcFRvbGVyYW5jZTt0aGlzLnNuYXBQdHM9c25hcFB0czt0aGlzLmlzU2VsZlNuYXA9aXNTZWxmU25hcHx8ZmFsc2U7fTtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20udXRpbC5HZW9tZXRyeVRyYW5zZm9ybWVyKCk7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS5zbmFwVG9sZXJhbmNlPW51bGw7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS5zbmFwUHRzPW51bGw7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS5pc1NlbGZTbmFwPWZhbHNlO1NuYXBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmRzLHBhcmVudCl7dmFyIHNyY1B0cz1jb29yZHM7dmFyIG5ld1B0cz10aGlzLnNuYXBMaW5lKHNyY1B0cyx0aGlzLnNuYXBQdHMpO3JldHVybiBuZXdQdHM7fTtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLnNuYXBMaW5lPWZ1bmN0aW9uKHNyY1B0cyxzbmFwUHRzKXt2YXIgc25hcHBlcj1uZXcgTGluZVN0cmluZ1NuYXBwZXIoc3JjUHRzLHRoaXMuc25hcFRvbGVyYW5jZSk7c25hcHBlci5zZXRBbGxvd1NuYXBwaW5nVG9Tb3VyY2VWZXJ0aWNlcyh0aGlzLmlzU2VsZlNuYXApO3JldHVybiBzbmFwcGVyLnNuYXBUbyhzbmFwUHRzKTt9O3ZhciBHZW9tZXRyeVNuYXBwZXI9ZnVuY3Rpb24oc3JjR2VvbSl7dGhpcy5zcmNHZW9tPXNyY0dlb207fTtHZW9tZXRyeVNuYXBwZXIuU05BUF9QUkVDSVNJT05fRkFDVE9SPTFlLTk7R2VvbWV0cnlTbmFwcGVyLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZT1mdW5jdGlvbihnKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7cmV0dXJuIEdlb21ldHJ5U25hcHBlci5jb21wdXRlT3ZlcmxheVNuYXBUb2xlcmFuY2UyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgc25hcFRvbGVyYW5jZT10aGlzLmNvbXB1dGVTaXplQmFzZWRTbmFwVG9sZXJhbmNlKGcpO3ZhciBwbT1nLmdldFByZWNpc2lvbk1vZGVsKCk7aWYocG0uZ2V0VHlwZSgpPT1QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dmFyIGZpeGVkU25hcFRvbD0oMS9wbS5nZXRTY2FsZSgpKSoyLzEuNDE1O2lmKGZpeGVkU25hcFRvbD5zbmFwVG9sZXJhbmNlKVxuc25hcFRvbGVyYW5jZT1maXhlZFNuYXBUb2w7fVxucmV0dXJuIHNuYXBUb2xlcmFuY2U7fTtHZW9tZXRyeVNuYXBwZXIuY29tcHV0ZVNpemVCYXNlZFNuYXBUb2xlcmFuY2U9ZnVuY3Rpb24oZyl7dmFyIGVudj1nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgbWluRGltZW5zaW9uPU1hdGgubWluKGVudi5nZXRIZWlnaHQoKSxlbnYuZ2V0V2lkdGgoKSk7dmFyIHNuYXBUb2w9bWluRGltZW5zaW9uKkdlb21ldHJ5U25hcHBlci5TTkFQX1BSRUNJU0lPTl9GQUNUT1I7cmV0dXJuIHNuYXBUb2w7fTtHZW9tZXRyeVNuYXBwZXIuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlMj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIE1hdGgubWluKHRoaXMuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlKGcwKSx0aGlzLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZShnMSkpO307R2VvbWV0cnlTbmFwcGVyLnNuYXA9ZnVuY3Rpb24oZzAsZzEsc25hcFRvbGVyYW5jZSl7dmFyIHNuYXBHZW9tPVtdO3ZhciBzbmFwcGVyMD1uZXcgR2VvbWV0cnlTbmFwcGVyKGcwKTtzbmFwR2VvbVswXT1zbmFwcGVyMC5zbmFwVG8oZzEsc25hcFRvbGVyYW5jZSk7dmFyIHNuYXBwZXIxPW5ldyBHZW9tZXRyeVNuYXBwZXIoZzEpO3NuYXBHZW9tWzFdPXNuYXBwZXIxLnNuYXBUbyhzbmFwR2VvbVswXSxzbmFwVG9sZXJhbmNlKTtyZXR1cm4gc25hcEdlb207fTtHZW9tZXRyeVNuYXBwZXIuc25hcFRvU2VsZj1mdW5jdGlvbihnMCxzbmFwVG9sZXJhbmNlLGNsZWFuUmVzdWx0KXt2YXIgc25hcHBlcjA9bmV3IEdlb21ldHJ5U25hcHBlcihnMCk7cmV0dXJuIHNuYXBwZXIwLnNuYXBUb1NlbGYoc25hcFRvbGVyYW5jZSxjbGVhblJlc3VsdCk7fTtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLnNyY0dlb209bnVsbDtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLnNuYXBUbz1mdW5jdGlvbihzbmFwR2VvbSxzbmFwVG9sZXJhbmNlKXt2YXIgc25hcFB0cz10aGlzLmV4dHJhY3RUYXJnZXRDb29yZGluYXRlcyhzbmFwR2VvbSk7dmFyIHNuYXBUcmFucz1uZXcgU25hcFRyYW5zZm9ybWVyKHNuYXBUb2xlcmFuY2Usc25hcFB0cyk7cmV0dXJuIHNuYXBUcmFucy50cmFuc2Zvcm0odGhpcy5zcmNHZW9tKTt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuc25hcFRvU2VsZj1mdW5jdGlvbihzbmFwVG9sZXJhbmNlLGNsZWFuUmVzdWx0KXt2YXIgc25hcFB0cz10aGlzLmV4dHJhY3RUYXJnZXRDb29yZGluYXRlcyhzcmNHZW9tKTt2YXIgc25hcFRyYW5zPW5ldyBTbmFwVHJhbnNmb3JtZXIoc25hcFRvbGVyYW5jZSxzbmFwUHRzLHRydWUpO3ZhciBzbmFwcGVkR2VvbT1zbmFwVHJhbnMudHJhbnNmb3JtKHNyY0dlb20pO3ZhciByZXN1bHQ9c25hcHBlZEdlb207aWYoY2xlYW5SZXN1bHQmJnJlc3VsdCBpbnN0YW5jZW9mIFBvbHlnb25hbCl7cmVzdWx0PXNuYXBwZWRHZW9tLmJ1ZmZlcigwKTt9XG5yZXR1cm4gcmVzdWx0O307R2VvbWV0cnlTbmFwcGVyLnByb3RvdHlwZS5leHRyYWN0VGFyZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oZyl7dmFyIHB0U2V0PW5ldyBUcmVlU2V0KCk7dmFyIHB0cz1nLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7cHRTZXQuYWRkKHB0c1tpXSk7fVxucmV0dXJuIHB0U2V0LnRvQXJyYXkoKTt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuY29tcHV0ZVNuYXBUb2xlcmFuY2U9ZnVuY3Rpb24ocmluZ1B0cyl7dmFyIG1pblNlZ0xlbj10aGlzLmNvbXB1dGVNaW5pbXVtU2VnbWVudExlbmd0aChyaW5nUHRzKTt2YXIgc25hcFRvbD1taW5TZWdMZW4vMTA7cmV0dXJuIHNuYXBUb2w7fTtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLmNvbXB1dGVNaW5pbXVtU2VnbWVudExlbmd0aD1mdW5jdGlvbihwdHMpe3ZhciBtaW5TZWdMZW49TnVtYmVyLk1BWF9WQUxVRTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3ZhciBzZWdMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTtpZihzZWdMZW48bWluU2VnTGVuKVxubWluU2VnTGVuPXNlZ0xlbjt9XG5yZXR1cm4gbWluU2VnTGVuO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLkdlb21ldHJ5U25hcHBlcj1HZW9tZXRyeVNuYXBwZXI7fSkoKTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3I9ZnVuY3Rpb24oYm91bmRhcnlSdWxlKXt0aGlzLmJvdW5kYXJ5UnVsZT1ib3VuZGFyeVJ1bGU/Ym91bmRhcnlSdWxlOmpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUuT0dDX1NGU19CT1VOREFSWV9SVUxFO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5ib3VuZGFyeVJ1bGU9bnVsbDtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmlzSW49bnVsbDtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLm51bUJvdW5kYXJpZXM9bnVsbDtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24ocCxnZW9tKXtyZXR1cm4gdGhpcy5sb2NhdGUocCxnZW9tKSE9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubG9jYXRlPWZ1bmN0aW9uKHAsZ2VvbSl7aWYoZ2VvbS5pc0VtcHR5KCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3JldHVybiB0aGlzLmxvY2F0ZTIocCxnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmxvY2F0ZTMocCxnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3JldHVybiB0aGlzLmxvY2F0ZTQocCxnZW9tKTt9XG50aGlzLmlzSW49ZmFsc2U7dGhpcy5udW1Cb3VuZGFyaWVzPTA7dGhpcy5jb21wdXRlTG9jYXRpb24ocCxnZW9tKTtpZih0aGlzLmJvdW5kYXJ5UnVsZS5pc0luQm91bmRhcnkodGhpcy5udW1Cb3VuZGFyaWVzKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7aWYodGhpcy5udW1Cb3VuZGFyaWVzPjB8fHRoaXMuaXNJbilcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUuY29tcHV0ZUxvY2F0aW9uPWZ1bmN0aW9uKHAsZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMudXBkYXRlTG9jYXRpb25JbmZvKHRoaXMubG9jYXRlKHAsZ2VvbSkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKXt2YXIgbWw9Z2VvbTtmb3IodmFyIGk9MDtpPG1sLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBsPW1sLmdldEdlb21ldHJ5TihpKTt0aGlzLnVwZGF0ZUxvY2F0aW9uSW5mbyh0aGlzLmxvY2F0ZShwLGwpKTt9fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBtcG9seT1nZW9tO2Zvcih2YXIgaT0wO2k8bXBvbHkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHBvbHk9bXBvbHkuZ2V0R2VvbWV0cnlOKGkpO3RoaXMudXBkYXRlTG9jYXRpb25JbmZvKHRoaXMubG9jYXRlKHAscG9seSkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHBhcnQ9Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYocGFydCE9PWdlb20pe3RoaXMuY29tcHV0ZUxvY2F0aW9uKHAscGFydCk7fX19fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLnVwZGF0ZUxvY2F0aW9uSW5mbz1mdW5jdGlvbihsb2Mpe2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUilcbnRoaXMuaXNJbj10cnVlO2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbnRoaXMubnVtQm91bmRhcmllcysrO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGUyPWZ1bmN0aW9uKHAscHQpe3ZhciBwdENvb3JkPXB0LmdldENvb3JkaW5hdGUoKTtpZihwdENvb3JkLmVxdWFsczJEKHApKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGUzPWZ1bmN0aW9uKHAsbCl7aWYoIWwuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMocCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO3ZhciBwdD1sLmdldENvb3JkaW5hdGVzKCk7aWYoIWwuaXNDbG9zZWQoKSl7aWYocC5lcXVhbHMocHRbMF0pfHxwLmVxdWFscyhwdFtwdC5sZW5ndGgtMV0pKXtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO319XG5pZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNPbkxpbmUocCxwdCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZUluUG9seWdvblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtpZighcmluZy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhwKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5sb2NhdGVQb2ludEluUmluZyhwLHJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZTQ9ZnVuY3Rpb24ocCxwb2x5KXtpZihwb2x5LmlzRW1wdHkoKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7dmFyIHNoZWxsPXBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCk7dmFyIHNoZWxsTG9jPXRoaXMubG9jYXRlSW5Qb2x5Z29uUmluZyhwLHNoZWxsKTtpZihzaGVsbExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7aWYoc2hlbGxMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKTt2YXIgaG9sZUxvYz10aGlzLmxvY2F0ZUluUG9seWdvblJpbmcocCxob2xlKTtpZihob2xlTG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtpZihob2xlTG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTt9XG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO307KGZ1bmN0aW9uKCl7dmFyIExvY2F0aW9uPWpzdHMuZ2VvbS5Mb2NhdGlvbjt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIFRyZWVNYXA9amF2YXNjcmlwdC51dGlsLlRyZWVNYXA7anN0cy5nZW9tZ3JhcGguTm9kZU1hcD1mdW5jdGlvbihub2RlRmFjdG9yeSl7dGhpcy5ub2RlTWFwPW5ldyBUcmVlTWFwKCk7dGhpcy5ub2RlRmFjdD1ub2RlRmFjdG9yeTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLm5vZGVNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS5ub2RlRmFjdD1udWxsO2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLmFkZE5vZGU9ZnVuY3Rpb24oYXJnKXt2YXIgbm9kZSxjb29yZDtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7Y29vcmQ9YXJnO25vZGU9dGhpcy5ub2RlTWFwLmdldChjb29yZCk7aWYobm9kZT09PW51bGwpe25vZGU9dGhpcy5ub2RlRmFjdC5jcmVhdGVOb2RlKGNvb3JkKTt0aGlzLm5vZGVNYXAucHV0KGNvb3JkLG5vZGUpO31cbnJldHVybiBub2RlO31lbHNlIGlmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLk5vZGUpe3ZhciBuPWFyZztjb29yZD1uLmdldENvb3JkaW5hdGUoKTtub2RlPXRoaXMubm9kZU1hcC5nZXQoY29vcmQpO2lmKG5vZGU9PT1udWxsKXt0aGlzLm5vZGVNYXAucHV0KGNvb3JkLG4pO3JldHVybiBuO31cbm5vZGUubWVyZ2VMYWJlbChuKTtyZXR1cm4gbm9kZTt9fTtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZSl7dmFyIHA9ZS5nZXRDb29yZGluYXRlKCk7dmFyIG49dGhpcy5hZGROb2RlKHApO24uYWRkKGUpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihjb29yZCl7cmV0dXJuIHRoaXMubm9kZU1hcC5nZXQoY29vcmQpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZU1hcC52YWx1ZXMoKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLml0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWVzKCkuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLmdldEJvdW5kYXJ5Tm9kZXM9ZnVuY3Rpb24oZ2VvbUluZGV4KXt2YXIgYmR5Tm9kZXM9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pLm5leHQoKTtpZihub2RlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oZ2VvbUluZGV4KT09PUxvY2F0aW9uLkJPVU5EQVJZKXtiZHlOb2Rlcy5hZGQobm9kZSk7fX1cbnJldHVybiBiZHlOb2Rlczt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoPWZ1bmN0aW9uKG5vZGVGYWN0b3J5KXt0aGlzLmVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmVkZ2VFbmRMaXN0PW5ldyBBcnJheUxpc3QoKTt0aGlzLm5vZGVzPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlTWFwKG5vZGVGYWN0b3J5fHxuZXcganN0cy5nZW9tZ3JhcGguTm9kZUZhY3RvcnkoKSk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUubm9kZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZWRnZUVuZExpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbihub2Rlcyl7Zm9yKHZhciBub2RlaXQ9bm9kZXMuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTtub2RlLmdldEVkZ2VzKCkubGlua1Jlc3VsdERpcmVjdGVkRWRnZXMoKTt9fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZ2V0RWRnZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXMuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5nZXRFZGdlRW5kcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VFbmRMaXN0O307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmlzQm91bmRhcnlOb2RlPWZ1bmN0aW9uKGdlb21JbmRleCxjb29yZCl7dmFyIG5vZGU9dGhpcy5ub2Rlcy5maW5kKGNvb3JkKTtpZihub2RlPT09bnVsbClcbnJldHVybiBmYWxzZTt2YXIgbGFiZWw9bm9kZS5nZXRMYWJlbCgpO2lmKGxhYmVsIT09bnVsbCYmbGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4KT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5pbnNlcnRFZGdlPWZ1bmN0aW9uKGUpe3RoaXMuZWRnZXMuYWRkKGUpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt0aGlzLm5vZGVzLmFkZChlKTt0aGlzLmVkZ2VFbmRMaXN0LmFkZChlKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5nZXROb2RlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlcy5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmdldE5vZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXMudmFsdWVzKCk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuYWRkTm9kZT1mdW5jdGlvbihub2RlKXtyZXR1cm4gdGhpcy5ub2Rlcy5hZGROb2RlKG5vZGUpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZEVkZ2VzPWZ1bmN0aW9uKGVkZ2VzVG9BZGQpe2Zvcih2YXIgaXQ9ZWRnZXNUb0FkZC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt0aGlzLmVkZ2VzLmFkZChlKTt2YXIgZGUxPW5ldyBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UoZSx0cnVlKTt2YXIgZGUyPW5ldyBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UoZSxmYWxzZSk7ZGUxLnNldFN5bShkZTIpO2RlMi5zZXRTeW0oZGUxKTt0aGlzLmFkZChkZTEpO3RoaXMuYWRkKGRlMik7fX07anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmxpbmtSZXN1bHREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ub2Rlcy5pdGVyYXRvcigpO25vZGVpdC5oYXNOZXh0KCk7KXt2YXIgbm9kZT1ub2RlaXQubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcygpO319O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kRWRnZUluU2FtZURpcmVjdGlvbj1mdW5jdGlvbihwMCxwMSl7dmFyIGk9MCxpbD10aGlzLmVkZ2VzLnNpemUoKSxlLGVDb29yZDtmb3IoaTtpPGlsO2krKyl7ZT10aGlzLmVkZ2VzLmdldChpKTtlQ29vcmQ9ZS5nZXRDb29yZGluYXRlcygpO2lmKHRoaXMubWF0Y2hJblNhbWVEaXJlY3Rpb24ocDAscDEsZUNvb3JkWzBdLGVDb29yZFsxXSkpe3JldHVybiBlO31cbmlmKHRoaXMubWF0Y2hJblNhbWVEaXJlY3Rpb24ocDAscDEsZUNvb3JkW2VDb29yZC5sZW5ndGgtMV0sZUNvb3JkW2VDb29yZC5sZW5ndGgtMl0pKXtyZXR1cm4gZTt9fVxucmV0dXJuIG51bGw7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUubWF0Y2hJblNhbWVEaXJlY3Rpb249ZnVuY3Rpb24ocDAscDEsZXAwLGVwMSl7aWYoIXAwLmVxdWFscyhlcDApKXtyZXR1cm4gZmFsc2U7fVxuaWYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwMCxwMSxlcDEpPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUiYmanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQocDAscDEpPT09anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQoZXAwLGVwMSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5maW5kRWRnZUVuZD1mdW5jdGlvbihlKXtmb3IodmFyIGk9dGhpcy5nZXRFZGdlRW5kcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWU9aS5uZXh0KCk7aWYoZWUuZ2V0RWRnZSgpPT09ZSl7cmV0dXJuIGVlO319XG5yZXR1cm4gbnVsbDt9O30pKCk7anN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNEb25lPWpzdHMuYWJzdHJhY3RGdW5jOyhmdW5jdGlvbigpe3ZhciBTZWdtZW50SW50ZXJzZWN0b3I9anN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcj1mdW5jdGlvbihsaSl7dGhpcy5saT1saTt0aGlzLmludGVyc2VjdGlvbnM9bmV3IEFycmF5TGlzdCgpO3RoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb249bnVsbDt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZT1uZXcgU2VnbWVudEludGVyc2VjdG9yKCk7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXI7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmZpbmRBbGxJbnRlcnNlY3Rpb25zPWZhbHNlO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pc0NoZWNrRW5kU2VnbWVudHNPbmx5PWZhbHNlO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pbnRlcmlvckludGVyc2VjdGlvbj1udWxsO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pbnRTZWdtZW50cz1udWxsO2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pbnRlcnNlY3Rpb25zPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLnNldEZpbmRBbGxJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGZpbmRBbGxJbnRlcnNlY3Rpb25zKXt0aGlzLmZpbmRBbGxJbnRlcnNlY3Rpb25zPWZpbmRBbGxJbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmdldEludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gaW50ZXJzZWN0aW9uczt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5zZXRDaGVja0VuZFNlZ21lbnRzT25seT1mdW5jdGlvbihpc0NoZWNrRW5kU2VnbWVudHNPbmx5KXt0aGlzLmlzQ2hlY2tFbmRTZWdtZW50c09ubHk9aXNDaGVja0VuZFNlZ21lbnRzT25seTt9XG5qc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb24hPW51bGw7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbjt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb25TZWdtZW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludFNlZ21lbnRzO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKHRoaXMuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm47aWYoZTA9PWUxJiZzZWdJbmRleDA9PXNlZ0luZGV4MSlcbnJldHVybjtpZih0aGlzLmlzQ2hlY2tFbmRTZWdtZW50c09ubHkpe3ZhciBpc0VuZFNlZ1ByZXNlbnQ9dGhpcy5pc0VuZFNlZ21lbnQoZTAsc2VnSW5kZXgwKXx8aXNFbmRTZWdtZW50KGUxLHNlZ0luZGV4MSk7aWYoIWlzRW5kU2VnUHJlc2VudClcbnJldHVybjt9XG52YXIgcDAwPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwXTt2YXIgcDAxPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwKzFdO3ZhciBwMTA9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDFdO3ZhciBwMTE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDErMV07dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwMCxwMDEscDEwLHAxMSk7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSl7aWYodGhpcy5saS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKCkpe3RoaXMuaW50U2VnbWVudHM9W107dGhpcy5pbnRTZWdtZW50c1swXT1wMDA7dGhpcy5pbnRTZWdtZW50c1sxXT1wMDE7dGhpcy5pbnRTZWdtZW50c1syXT1wMTA7dGhpcy5pbnRTZWdtZW50c1szXT1wMTE7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbj10aGlzLmxpLmdldEludGVyc2VjdGlvbigwKTt0aGlzLmludGVyc2VjdGlvbnMuYWRkKHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb24pO319fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuaXNFbmRTZWdtZW50PWZ1bmN0aW9uKHNlZ1N0cixpbmRleCl7aWYoaW5kZXg9PTApXG5yZXR1cm4gdHJ1ZTtpZihpbmRleD49c2VnU3RyLnNpemUoKS0yKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe2lmKHRoaXMuZmluZEFsbEludGVyc2VjdGlvbnMpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb24hPW51bGw7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBSb2J1c3RMaW5lSW50ZXJzZWN0b3I9anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yO3ZhciBJbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcj1qc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcjt2YXIgTUNJbmRleE5vZGVyPWpzdHMubm9kaW5nLk1DSW5kZXhOb2Rlcjtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yPWZ1bmN0aW9uKHNlZ1N0cmluZ3Mpe3RoaXMubGk9bmV3IFJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMuc2VnU3RyaW5ncz1zZWdTdHJpbmdzO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5zZWdTdHJpbmdzPW51bGw7anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuZmluZEFsbEludGVyc2VjdGlvbnM9ZmFsc2U7anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuc2VnSW50PW51bGw7anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuX2lzVmFsaWQ9dHJ1ZTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5zZXRGaW5kQWxsSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihmaW5kQWxsSW50ZXJzZWN0aW9ucyl7dGhpcy5maW5kQWxsSW50ZXJzZWN0aW9ucz1maW5kQWxsSW50ZXJzZWN0aW9uczt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmdldEludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gc2VnSW50LmdldEludGVyc2VjdGlvbnMoKTt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmV4ZWN1dGUoKTtyZXR1cm4gdGhpcy5faXNWYWxpZDt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmdldEVycm9yTWVzc2FnZT1mdW5jdGlvbigpe2lmKHRoaXMuX2lzVmFsaWQpXG5yZXR1cm4nbm8gaW50ZXJzZWN0aW9ucyBmb3VuZCc7dmFyIGludFNlZ3M9dGhpcy5zZWdJbnQuZ2V0SW50ZXJzZWN0aW9uU2VnbWVudHMoKTtyZXR1cm4nZm91bmQgbm9uLW5vZGVkIGludGVyc2VjdGlvbiBiZXR3ZWVuICcrXG5qc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmcoaW50U2Vnc1swXSxpbnRTZWdzWzFdKSsnIGFuZCAnK1xuanN0cy5pby5XS1RXcml0ZXIudG9MaW5lU3RyaW5nKGludFNlZ3NbMl0saW50U2Vnc1szXSk7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5jaGVja1ZhbGlkPWZ1bmN0aW9uKCl7dGhpcy5leGVjdXRlKCk7aWYoIXRoaXMuX2lzVmFsaWQpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKHRoaXMuZ2V0RXJyb3JNZXNzYWdlKCksdGhpcy5zZWdJbnQuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb24oKSk7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5leGVjdXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5zZWdJbnQhPW51bGwpXG5yZXR1cm47dGhpcy5jaGVja0ludGVyaW9ySW50ZXJzZWN0aW9ucygpO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuY2hlY2tJbnRlcmlvckludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXt0aGlzLl9pc1ZhbGlkPXRydWU7dGhpcy5zZWdJbnQ9bmV3IEludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyKHRoaXMubGkpO3RoaXMuc2VnSW50LnNldEZpbmRBbGxJbnRlcnNlY3Rpb25zKHRoaXMuZmluZEFsbEludGVyc2VjdGlvbnMpO3ZhciBub2Rlcj1uZXcgTUNJbmRleE5vZGVyKCk7bm9kZXIuc2V0U2VnbWVudEludGVyc2VjdG9yKHRoaXMuc2VnSW50KTtub2Rlci5jb21wdXRlTm9kZXModGhpcy5zZWdTdHJpbmdzKTtpZih0aGlzLnNlZ0ludC5oYXNJbnRlcnNlY3Rpb24oKSl7dGhpcy5faXNWYWxpZD1mYWxzZTtyZXR1cm47fX07fSkoKTsoZnVuY3Rpb24oKXtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmc9ZnVuY3Rpb24ocHRzLGRhdGEpe3RoaXMucHRzPXB0czt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcoKTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLnB0cz1udWxsO2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZGF0YT1udWxsO2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0RGF0YT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRhdGE7fVxuanN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXREYXRhPWZ1bmN0aW9uKGRhdGEpe3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzLmxlbmd0aDt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0c1swXS5lcXVhbHModGhpcy5wdHNbdGhpcy5wdHMubGVuZ3RoLTFdKTt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0U2VnbWVudE9jdGFudD1mdW5jdGlvbihpbmRleCl7aWYoaW5kZXg9PXRoaXMucHRzLmxlbmd0aC0xKVxucmV0dXJuLTE7cmV0dXJuIGpzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQodGhpcy5nZXRDb29yZGluYXRlKGluZGV4KSx0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgrMSkpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgRmFzdE5vZGluZ1ZhbGlkYXRvcj1qc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yO3ZhciBCYXNpY1NlZ21lbnRTdHJpbmc9anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yPWZ1bmN0aW9uKGVkZ2VzKXt0aGlzLm52PW5ldyBGYXN0Tm9kaW5nVmFsaWRhdG9yKGpzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IudG9TZWdtZW50U3RyaW5ncyhlZGdlcykpO307anN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci5jaGVja1ZhbGlkPWZ1bmN0aW9uKGVkZ2VzKXt2YXIgdmFsaWRhdG9yPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yKGVkZ2VzKTt2YWxpZGF0b3IuY2hlY2tWYWxpZCgpO307anN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci50b1NlZ21lbnRTdHJpbmdzPWZ1bmN0aW9uKGVkZ2VzKXt2YXIgc2VnU3RyaW5ncz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTtzZWdTdHJpbmdzLmFkZChuZXcgQmFzaWNTZWdtZW50U3RyaW5nKGUuZ2V0Q29vcmRpbmF0ZXMoKSxlKSk7fVxucmV0dXJuIHNlZ1N0cmluZ3M7fTtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5udj1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmNoZWNrVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLm52LmNoZWNrVmFsaWQoKTt9O30pKCk7anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbj1mdW5jdGlvbihnMCxnMSxib3VuZGFyeU5vZGVSdWxlKXt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLmFyZz1bXTtpZihnMD09PXVuZGVmaW5lZCl7cmV0dXJuO31cbmlmKGcxPT09dW5kZWZpbmVkKXt0aGlzLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uKGcwLmdldFByZWNpc2lvbk1vZGVsKCkpO3RoaXMuYXJnWzBdPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZzApO3JldHVybjt9XG5ib3VuZGFyeU5vZGVSdWxlPWJvdW5kYXJ5Tm9kZVJ1bGV8fGpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUuT0dDX1NGU19CT1VOREFSWV9SVUxFO2lmKGcwLmdldFByZWNpc2lvbk1vZGVsKCkuY29tcGFyZVRvKGcxLmdldFByZWNpc2lvbk1vZGVsKCkpPj0wKVxudGhpcy5zZXRDb21wdXRhdGlvblByZWNpc2lvbihnMC5nZXRQcmVjaXNpb25Nb2RlbCgpKTtlbHNlXG50aGlzLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uKGcxLmdldFByZWNpc2lvbk1vZGVsKCkpO3RoaXMuYXJnWzBdPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZzAsYm91bmRhcnlOb2RlUnVsZSk7dGhpcy5hcmdbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMSxnMSxib3VuZGFyeU5vZGVSdWxlKTt9O2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLmxpPW51bGw7anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbi5wcm90b3R5cGUucmVzdWx0UHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5hcmc9bnVsbDtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5nZXRBcmdHZW9tZXRyeT1mdW5jdGlvbihpKXtyZXR1cm4gYXJnW2ldLmdldEdlb21ldHJ5KCk7fTtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5zZXRDb21wdXRhdGlvblByZWNpc2lvbj1mdW5jdGlvbihwbSl7dGhpcy5yZXN1bHRQcmVjaXNpb25Nb2RlbD1wbTt0aGlzLmxpLnNldFByZWNpc2lvbk1vZGVsKHRoaXMucmVzdWx0UHJlY2lzaW9uTW9kZWwpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5Tm9kZUZhY3Rvcnk9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5LnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguTm9kZUZhY3RvcnkoKTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeS5jb25zdHJ1Y3Rvcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihjb29yZCl7cmV0dXJuIG5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlKGNvb3JkLG5ldyBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyKCkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuc2hlbGxMaXN0PVtdO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmdlb21ldHJ5RmFjdG9yeT1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLnNoZWxsTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihncmFwaCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuYWRkMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuYWRkMihncmFwaC5nZXRFZGdlRW5kcygpLGdyYXBoLmdldE5vZGVzKCkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihkaXJFZGdlcyxub2Rlcyl7anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgubGlua1Jlc3VsdERpcmVjdGVkRWRnZXMobm9kZXMpO3ZhciBtYXhFZGdlUmluZ3M9dGhpcy5idWlsZE1heGltYWxFZGdlUmluZ3MoZGlyRWRnZXMpO3ZhciBmcmVlSG9sZUxpc3Q9W107dmFyIGVkZ2VSaW5ncz10aGlzLmJ1aWxkTWluaW1hbEVkZ2VSaW5ncyhtYXhFZGdlUmluZ3MsdGhpcy5zaGVsbExpc3QsZnJlZUhvbGVMaXN0KTt0aGlzLnNvcnRTaGVsbHNBbmRIb2xlcyhlZGdlUmluZ3MsdGhpcy5zaGVsbExpc3QsZnJlZUhvbGVMaXN0KTt0aGlzLnBsYWNlRnJlZUhvbGVzKHRoaXMuc2hlbGxMaXN0LGZyZWVIb2xlTGlzdCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5nZXRQb2x5Z29ucz1mdW5jdGlvbigpe3ZhciByZXN1bHRQb2x5TGlzdD10aGlzLmNvbXB1dGVQb2x5Z29ucyh0aGlzLnNoZWxsTGlzdCk7cmV0dXJuIHJlc3VsdFBvbHlMaXN0O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYnVpbGRNYXhpbWFsRWRnZVJpbmdzPWZ1bmN0aW9uKGRpckVkZ2VzKXt2YXIgbWF4RWRnZVJpbmdzPVtdO2Zvcih2YXIgaXQ9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKSYmZGUuZ2V0TGFiZWwoKS5pc0FyZWEoKSl7aWYoZGUuZ2V0RWRnZVJpbmcoKT09bnVsbCl7dmFyIGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZyhkZSx0aGlzLmdlb21ldHJ5RmFjdG9yeSk7bWF4RWRnZVJpbmdzLnB1c2goZXIpO2VyLnNldEluUmVzdWx0KCk7fX19XG5yZXR1cm4gbWF4RWRnZVJpbmdzO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYnVpbGRNaW5pbWFsRWRnZVJpbmdzPWZ1bmN0aW9uKG1heEVkZ2VSaW5ncyxzaGVsbExpc3QsZnJlZUhvbGVMaXN0KXt2YXIgZWRnZVJpbmdzPVtdO2Zvcih2YXIgaT0wO2k8bWF4RWRnZVJpbmdzLmxlbmd0aDtpKyspe3ZhciBlcj1tYXhFZGdlUmluZ3NbaV07aWYoZXIuZ2V0TWF4Tm9kZURlZ3JlZSgpPjIpe2VyLmxpbmtEaXJlY3RlZEVkZ2VzRm9yTWluaW1hbEVkZ2VSaW5ncygpO3ZhciBtaW5FZGdlUmluZ3M9ZXIuYnVpbGRNaW5pbWFsUmluZ3MoKTt2YXIgc2hlbGw9dGhpcy5maW5kU2hlbGwobWluRWRnZVJpbmdzKTtpZihzaGVsbCE9PW51bGwpe3RoaXMucGxhY2VQb2x5Z29uSG9sZXMoc2hlbGwsbWluRWRnZVJpbmdzKTtzaGVsbExpc3QucHVzaChzaGVsbCk7fWVsc2V7ZnJlZUhvbGVMaXN0PWZyZWVIb2xlTGlzdC5jb25jYXQobWluRWRnZVJpbmdzKTt9fWVsc2V7ZWRnZVJpbmdzLnB1c2goZXIpO319XG5yZXR1cm4gZWRnZVJpbmdzO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuZmluZFNoZWxsPWZ1bmN0aW9uKG1pbkVkZ2VSaW5ncyl7dmFyIHNoZWxsQ291bnQ9MDt2YXIgc2hlbGw9bnVsbDtmb3IodmFyIGk9MDtpPG1pbkVkZ2VSaW5ncy5sZW5ndGg7aSsrKXt2YXIgZXI9bWluRWRnZVJpbmdzW2ldO2lmKCFlci5pc0hvbGUoKSl7c2hlbGw9ZXI7c2hlbGxDb3VudCsrO319XG5qc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShzaGVsbENvdW50PD0xLCdmb3VuZCB0d28gc2hlbGxzIGluIE1pbmltYWxFZGdlUmluZyBsaXN0Jyk7cmV0dXJuIHNoZWxsO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUucGxhY2VQb2x5Z29uSG9sZXM9ZnVuY3Rpb24oc2hlbGwsbWluRWRnZVJpbmdzKXtmb3IodmFyIGk9MDtpPG1pbkVkZ2VSaW5ncy5sZW5ndGg7aSsrKXt2YXIgZXI9bWluRWRnZVJpbmdzW2ldO2lmKGVyLmlzSG9sZSgpKXtlci5zZXRTaGVsbChzaGVsbCk7fX19O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLnNvcnRTaGVsbHNBbmRIb2xlcz1mdW5jdGlvbihlZGdlUmluZ3Msc2hlbGxMaXN0LGZyZWVIb2xlTGlzdCl7Zm9yKHZhciBpPTA7aTxlZGdlUmluZ3MubGVuZ3RoO2krKyl7dmFyIGVyPWVkZ2VSaW5nc1tpXTtpZihlci5pc0hvbGUoKSl7ZnJlZUhvbGVMaXN0LnB1c2goZXIpO31lbHNle3NoZWxsTGlzdC5wdXNoKGVyKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUucGxhY2VGcmVlSG9sZXM9ZnVuY3Rpb24oc2hlbGxMaXN0LGZyZWVIb2xlTGlzdCl7Zm9yKHZhciBpPTA7aTxmcmVlSG9sZUxpc3QubGVuZ3RoO2krKyl7dmFyIGhvbGU9ZnJlZUhvbGVMaXN0W2ldO2lmKGhvbGUuZ2V0U2hlbGwoKT09bnVsbCl7dmFyIHNoZWxsPXRoaXMuZmluZEVkZ2VSaW5nQ29udGFpbmluZyhob2xlLHNoZWxsTGlzdCk7aWYoc2hlbGw9PT1udWxsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcigndW5hYmxlIHRvIGFzc2lnbiBob2xlIHRvIGEgc2hlbGwnLGhvbGUuZ2V0Q29vcmRpbmF0ZSgwKSk7aG9sZS5zZXRTaGVsbChzaGVsbCk7fX19O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmZpbmRFZGdlUmluZ0NvbnRhaW5pbmc9ZnVuY3Rpb24odGVzdEVyLHNoZWxsTGlzdCl7dmFyIHRlc3RSaW5nPXRlc3RFci5nZXRMaW5lYXJSaW5nKCk7dmFyIHRlc3RFbnY9dGVzdFJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciB0ZXN0UHQ9dGVzdFJpbmcuZ2V0Q29vcmRpbmF0ZU4oMCk7dmFyIG1pblNoZWxsPW51bGw7dmFyIG1pbkVudj1udWxsO2Zvcih2YXIgaT0wO2k8c2hlbGxMaXN0Lmxlbmd0aDtpKyspe3ZhciB0cnlTaGVsbD1zaGVsbExpc3RbaV07dmFyIHRyeVJpbmc9dHJ5U2hlbGwuZ2V0TGluZWFyUmluZygpO3ZhciB0cnlFbnY9dHJ5UmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYobWluU2hlbGwhPT1udWxsKVxubWluRW52PW1pblNoZWxsLmdldExpbmVhclJpbmcoKS5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIGlzQ29udGFpbmVkPWZhbHNlO2lmKHRyeUVudi5jb250YWlucyh0ZXN0RW52KSYmanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcodGVzdFB0LHRyeVJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSkpXG5pc0NvbnRhaW5lZD10cnVlO2lmKGlzQ29udGFpbmVkKXtpZihtaW5TaGVsbD09bnVsbHx8bWluRW52LmNvbnRhaW5zKHRyeUVudikpe21pblNoZWxsPXRyeVNoZWxsO319fVxucmV0dXJuIG1pblNoZWxsO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVBvbHlnb25zPWZ1bmN0aW9uKHNoZWxsTGlzdCl7dmFyIHJlc3VsdFBvbHlMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxzaGVsbExpc3QubGVuZ3RoO2krKyl7dmFyIGVyPXNoZWxsTGlzdFtpXTt2YXIgcG9seT1lci50b1BvbHlnb24odGhpcy5nZW9tZXRyeUZhY3RvcnkpO3Jlc3VsdFBvbHlMaXN0LmFkZChwb2x5KTt9XG5yZXR1cm4gcmVzdWx0UG9seUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5jb250YWluc1BvaW50PWZ1bmN0aW9uKHApe2Zvcih2YXIgaT0wO2k8dGhpcy5zaGVsbExpc3QubGVuZ3RoO2krKyl7dmFyIGVyPXRoaXMuc2hlbGxMaXN0W2ldO2lmKGVyLmNvbnRhaW5zUG9pbnQocCkpXG5yZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBMaW5lQnVpbGRlcj1mdW5jdGlvbihvcCxnZW9tZXRyeUZhY3RvcnkscHRMb2NhdG9yKXt0aGlzLmxpbmVFZGdlc0xpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMucmVzdWx0TGluZUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMub3A9b3A7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5O3RoaXMucHRMb2NhdG9yPXB0TG9jYXRvcjt9O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5vcD1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5nZW9tZXRyeUZhY3Rvcnk9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUucHRMb2NhdG9yPW51bGw7TGluZUJ1aWxkZXIucHJvdG90eXBlLmxpbmVFZGdlc0xpc3Q9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUucmVzdWx0TGluZUxpc3Q9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUuYnVpbGQ9ZnVuY3Rpb24ob3BDb2RlKXt0aGlzLmZpbmRDb3ZlcmVkTGluZUVkZ2VzKCk7dGhpcy5jb2xsZWN0TGluZXMob3BDb2RlKTt0aGlzLmJ1aWxkTGluZXMob3BDb2RlKTtyZXR1cm4gdGhpcy5yZXN1bHRMaW5lTGlzdDt9O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5maW5kQ292ZXJlZExpbmVFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgbm9kZWl0PXRoaXMub3AuZ2V0R3JhcGgoKS5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLmZpbmRDb3ZlcmVkTGluZUVkZ2VzKCk7fVxuZm9yKHZhciBpdD10aGlzLm9wLmdldEdyYXBoKCkuZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIGU9ZGUuZ2V0RWRnZSgpO2lmKGRlLmlzTGluZUVkZ2UoKSYmIWUuaXNDb3ZlcmVkU2V0KCkpe3ZhciBpc0NvdmVyZWQ9dGhpcy5vcC5pc0NvdmVyZWRCeUEoZGUuZ2V0Q29vcmRpbmF0ZSgpKTtlLnNldENvdmVyZWQoaXNDb3ZlcmVkKTt9fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmNvbGxlY3RMaW5lcz1mdW5jdGlvbihvcENvZGUpe2Zvcih2YXIgaXQ9dGhpcy5vcC5nZXRHcmFwaCgpLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3RoaXMuY29sbGVjdExpbmVFZGdlKGRlLG9wQ29kZSx0aGlzLmxpbmVFZGdlc0xpc3QpO3RoaXMuY29sbGVjdEJvdW5kYXJ5VG91Y2hFZGdlKGRlLG9wQ29kZSx0aGlzLmxpbmVFZGdlc0xpc3QpO319O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5jb2xsZWN0TGluZUVkZ2U9ZnVuY3Rpb24oZGUsb3BDb2RlLGVkZ2VzKXt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTt2YXIgZT1kZS5nZXRFZGdlKCk7aWYoZGUuaXNMaW5lRWRnZSgpKXtpZighZGUuaXNWaXNpdGVkKCkmJmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbCxvcENvZGUpJiYhZS5pc0NvdmVyZWQoKSl7ZWRnZXMuYWRkKGUpO2RlLnNldFZpc2l0ZWRFZGdlKHRydWUpO319fTtMaW5lQnVpbGRlci5wcm90b3R5cGUuY29sbGVjdEJvdW5kYXJ5VG91Y2hFZGdlPWZ1bmN0aW9uKGRlLG9wQ29kZSxlZGdlcyl7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7aWYoZGUuaXNMaW5lRWRnZSgpKVxucmV0dXJuO2lmKGRlLmlzVmlzaXRlZCgpKVxucmV0dXJuO2lmKGRlLmlzSW50ZXJpb3JBcmVhRWRnZSgpKVxucmV0dXJuO2lmKGRlLmdldEVkZ2UoKS5pc0luUmVzdWx0KCkpXG5yZXR1cm47QXNzZXJ0LmlzVHJ1ZSghKGRlLmlzSW5SZXN1bHQoKXx8ZGUuZ2V0U3ltKCkuaXNJblJlc3VsdCgpKXx8IWRlLmdldEVkZ2UoKS5pc0luUmVzdWx0KCkpO2lmKGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbCxvcENvZGUpJiZvcENvZGU9PT1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT04pe2VkZ2VzLmFkZChkZS5nZXRFZGdlKCkpO2RlLnNldFZpc2l0ZWRFZGdlKHRydWUpO319O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5idWlsZExpbmVzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBpdD10aGlzLmxpbmVFZGdlc0xpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTt2YXIgbGluZT10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKGUuZ2V0Q29vcmRpbmF0ZXMoKSk7dGhpcy5yZXN1bHRMaW5lTGlzdC5hZGQobGluZSk7ZS5zZXRJblJlc3VsdCh0cnVlKTt9fTtMaW5lQnVpbGRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZExpbmVzPWZ1bmN0aW9uKGVkZ2VzTGlzdCl7Zm9yKHZhciBpdD1lZGdlc0xpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtpZihlLmlzSXNvbGF0ZWQoKSl7aWYobGFiZWwuaXNOdWxsKDApKVxudGhpcy5sYWJlbElzb2xhdGVkTGluZShlLDApO2Vsc2VcbnRoaXMubGFiZWxJc29sYXRlZExpbmUoZSwxKTt9fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWRMaW5lPWZ1bmN0aW9uKGUsdGFyZ2V0SW5kZXgpe3ZhciBsb2M9cHRMb2NhdG9yLmxvY2F0ZShlLmdldENvb3JkaW5hdGUoKSxvcC5nZXRBcmdHZW9tZXRyeSh0YXJnZXRJbmRleCkpO2UuZ2V0TGFiZWwoKS5zZXRMb2NhdGlvbih0YXJnZXRJbmRleCxsb2MpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5MaW5lQnVpbGRlcj1MaW5lQnVpbGRlcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgUG9pbnRCdWlsZGVyPWZ1bmN0aW9uKG9wLGdlb21ldHJ5RmFjdG9yeSxwdExvY2F0b3Ipe3RoaXMucmVzdWx0UG9pbnRMaXN0PW5ldyBBcnJheUxpc3QoKTt0aGlzLm9wPW9wO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeTt9O1BvaW50QnVpbGRlci5wcm90b3R5cGUub3A9bnVsbDtQb2ludEJ1aWxkZXIucHJvdG90eXBlLmdlb21ldHJ5RmFjdG9yeT1udWxsO1BvaW50QnVpbGRlci5wcm90b3R5cGUucmVzdWx0UG9pbnRMaXN0PW51bGw7UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5idWlsZD1mdW5jdGlvbihvcENvZGUpe3RoaXMuZXh0cmFjdE5vbkNvdmVyZWRSZXN1bHROb2RlcyhvcENvZGUpO3JldHVybiB0aGlzLnJlc3VsdFBvaW50TGlzdDt9O1BvaW50QnVpbGRlci5wcm90b3R5cGUuZXh0cmFjdE5vbkNvdmVyZWRSZXN1bHROb2Rlcz1mdW5jdGlvbihvcENvZGUpe2Zvcih2YXIgbm9kZWl0PXRoaXMub3AuZ2V0R3JhcGgoKS5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBuPW5vZGVpdC5uZXh0KCk7aWYobi5pc0luUmVzdWx0KCkpXG5jb250aW51ZTtpZihuLmlzSW5jaWRlbnRFZGdlSW5SZXN1bHQoKSlcbmNvbnRpbnVlO2lmKG4uZ2V0RWRnZXMoKS5nZXREZWdyZWUoKT09PTB8fG9wQ29kZT09PWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTil7dmFyIGxhYmVsPW4uZ2V0TGFiZWwoKTtpZihqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5pc1Jlc3VsdE9mT3AobGFiZWwsb3BDb2RlKSl7dGhpcy5maWx0ZXJDb3ZlcmVkTm9kZVRvUG9pbnQobik7fX19fTtQb2ludEJ1aWxkZXIucHJvdG90eXBlLmZpbHRlckNvdmVyZWROb2RlVG9Qb2ludD1mdW5jdGlvbihuKXt2YXIgY29vcmQ9bi5nZXRDb29yZGluYXRlKCk7aWYoIXRoaXMub3AuaXNDb3ZlcmVkQnlMQShjb29yZCkpe3ZhciBwdD10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChjb29yZCk7dGhpcy5yZXN1bHRQb2ludExpc3QuYWRkKHB0KTt9fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvaW50QnVpbGRlcj1Qb2ludEJ1aWxkZXI7fSkoKTsoZnVuY3Rpb24oKXt2YXIgUG9pbnRMb2NhdG9yPWpzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcjt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBFZGdlTGlzdD1qc3RzLmdlb21ncmFwaC5FZGdlTGlzdDt2YXIgTGFiZWw9anN0cy5nZW9tZ3JhcGguTGFiZWw7dmFyIFBsYW5hckdyYXBoPWpzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgRWRnZU5vZGluZ1ZhbGlkYXRvcj1qc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yO3ZhciBHZW9tZXRyeUdyYXBoT3BlcmF0aW9uPWpzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb247dmFyIE92ZXJsYXlOb2RlRmFjdG9yeT1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeTt2YXIgUG9seWdvbkJ1aWxkZXI9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlcjt2YXIgTGluZUJ1aWxkZXI9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5MaW5lQnVpbGRlcjt2YXIgUG9pbnRCdWlsZGVyPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9pbnRCdWlsZGVyO3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A9ZnVuY3Rpb24oZzAsZzEpe3RoaXMucHRMb2NhdG9yPW5ldyBQb2ludExvY2F0b3IoKTt0aGlzLmVkZ2VMaXN0PW5ldyBFZGdlTGlzdCgpO3RoaXMucmVzdWx0UG9seUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMucmVzdWx0TGluZUxpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMucmVzdWx0UG9pbnRMaXN0PW5ldyBBcnJheUxpc3QoKTtHZW9tZXRyeUdyYXBoT3BlcmF0aW9uLmNhbGwodGhpcyxnMCxnMSk7dGhpcy5ncmFwaD1uZXcgUGxhbmFyR3JhcGgobmV3IE92ZXJsYXlOb2RlRmFjdG9yeSgpKTt0aGlzLmdlb21GYWN0PWcwLmdldEZhY3RvcnkoKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZT1uZXcgR2VvbWV0cnlHcmFwaE9wZXJhdGlvbigpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTj0xO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OPTI7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRT0zO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0U9NDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5vdmVybGF5T3A9ZnVuY3Rpb24oZ2VvbTAsZ2VvbTEsb3BDb2RlKXt2YXIgZ292PW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcChnZW9tMCxnZW9tMSk7dmFyIGdlb21Pdj1nb3YuZ2V0UmVzdWx0R2VvbWV0cnkob3BDb2RlKTtyZXR1cm4gZ2VvbU92O31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcD1mdW5jdGlvbihsYWJlbCxvcENvZGUpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0zKXtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGxvYzA9bGFiZWwuZ2V0TG9jYXRpb24oMCk7dmFyIGxvYzE9bGFiZWwuZ2V0TG9jYXRpb24oMSk7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcDIobG9jMCxsb2MxLG9wQ29kZSk7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wMj1mdW5jdGlvbihsb2MwLGxvYzEsb3BDb2RlKXtpZihsb2MwPT1Mb2NhdGlvbi5CT1VOREFSWSlcbmxvYzA9TG9jYXRpb24uSU5URVJJT1I7aWYobG9jMT09TG9jYXRpb24uQk9VTkRBUlkpXG5sb2MxPUxvY2F0aW9uLklOVEVSSU9SO3N3aXRjaChvcENvZGUpe2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OOnJldHVybiBsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUiYmbG9jMT09TG9jYXRpb24uSU5URVJJT1I7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5VTklPTjpyZXR1cm4gbG9jMD09TG9jYXRpb24uSU5URVJJT1J8fGxvYzE9PUxvY2F0aW9uLklOVEVSSU9SO2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRTpyZXR1cm4gbG9jMD09TG9jYXRpb24uSU5URVJJT1ImJmxvYzEhPUxvY2F0aW9uLklOVEVSSU9SO2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuU1lNRElGRkVSRU5DRTpyZXR1cm4obG9jMD09TG9jYXRpb24uSU5URVJJT1ImJmxvYzEhPUxvY2F0aW9uLklOVEVSSU9SKXx8KGxvYzAhPUxvY2F0aW9uLklOVEVSSU9SJiZsb2MxPT1Mb2NhdGlvbi5JTlRFUklPUik7fVxucmV0dXJuIGZhbHNlO31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuZ2VvbUZhY3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUucmVzdWx0R2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5ncmFwaD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5lZGdlTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRQb2x5TGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRMaW5lTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRQb2ludExpc3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24oZnVuY0NvZGUpe3RoaXMuY29tcHV0ZU92ZXJsYXkoZnVuY0NvZGUpO3JldHVybiB0aGlzLnJlc3VsdEdlb207fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmdldEdyYXBoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ3JhcGg7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNvbXB1dGVPdmVybGF5PWZ1bmN0aW9uKG9wQ29kZSl7dGhpcy5jb3B5UG9pbnRzKDApO3RoaXMuY29weVBvaW50cygxKTt0aGlzLmFyZ1swXS5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksZmFsc2UpO3RoaXMuYXJnWzFdLmNvbXB1dGVTZWxmTm9kZXModGhpcy5saSxmYWxzZSk7dGhpcy5hcmdbMF0uY29tcHV0ZUVkZ2VJbnRlcnNlY3Rpb25zKHRoaXMuYXJnWzFdLHRoaXMubGksdHJ1ZSk7dmFyIGJhc2VTcGxpdEVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmFyZ1swXS5jb21wdXRlU3BsaXRFZGdlcyhiYXNlU3BsaXRFZGdlcyk7dGhpcy5hcmdbMV0uY29tcHV0ZVNwbGl0RWRnZXMoYmFzZVNwbGl0RWRnZXMpO3ZhciBzcGxpdEVkZ2VzPWJhc2VTcGxpdEVkZ2VzO3RoaXMuaW5zZXJ0VW5pcXVlRWRnZXMoYmFzZVNwbGl0RWRnZXMpO3RoaXMuY29tcHV0ZUxhYmVsc0Zyb21EZXB0aHMoKTt0aGlzLnJlcGxhY2VDb2xsYXBzZWRFZGdlcygpO0VkZ2VOb2RpbmdWYWxpZGF0b3IuY2hlY2tWYWxpZCh0aGlzLmVkZ2VMaXN0LmdldEVkZ2VzKCkpO3RoaXMuZ3JhcGguYWRkRWRnZXModGhpcy5lZGdlTGlzdC5nZXRFZGdlcygpKTt0aGlzLmNvbXB1dGVMYWJlbGxpbmcoKTt0aGlzLmxhYmVsSW5jb21wbGV0ZU5vZGVzKCk7dGhpcy5maW5kUmVzdWx0QXJlYUVkZ2VzKG9wQ29kZSk7dGhpcy5jYW5jZWxEdXBsaWNhdGVSZXN1bHRFZGdlcygpO3ZhciBwb2x5QnVpbGRlcj1uZXcgUG9seWdvbkJ1aWxkZXIodGhpcy5nZW9tRmFjdCk7cG9seUJ1aWxkZXIuYWRkKHRoaXMuZ3JhcGgpO3RoaXMucmVzdWx0UG9seUxpc3Q9cG9seUJ1aWxkZXIuZ2V0UG9seWdvbnMoKTt2YXIgbGluZUJ1aWxkZXI9bmV3IExpbmVCdWlsZGVyKHRoaXMsdGhpcy5nZW9tRmFjdCx0aGlzLnB0TG9jYXRvcik7dGhpcy5yZXN1bHRMaW5lTGlzdD1saW5lQnVpbGRlci5idWlsZChvcENvZGUpO3ZhciBwb2ludEJ1aWxkZXI9bmV3IFBvaW50QnVpbGRlcih0aGlzLHRoaXMuZ2VvbUZhY3QsdGhpcy5wdExvY2F0b3IpO3RoaXMucmVzdWx0UG9pbnRMaXN0PXBvaW50QnVpbGRlci5idWlsZChvcENvZGUpO3RoaXMucmVzdWx0R2VvbT10aGlzLmNvbXB1dGVHZW9tZXRyeSh0aGlzLnJlc3VsdFBvaW50TGlzdCx0aGlzLnJlc3VsdExpbmVMaXN0LHRoaXMucmVzdWx0UG9seUxpc3Qsb3BDb2RlKTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaW5zZXJ0VW5pcXVlRWRnZXM9ZnVuY3Rpb24oZWRnZXMpe2Zvcih2YXIgaT1lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5pbnNlcnRVbmlxdWVFZGdlKGUpO319XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaW5zZXJ0VW5pcXVlRWRnZT1mdW5jdGlvbihlKXt2YXIgZXhpc3RpbmdFZGdlPXRoaXMuZWRnZUxpc3QuZmluZEVxdWFsRWRnZShlKTtpZihleGlzdGluZ0VkZ2UhPT1udWxsKXt2YXIgZXhpc3RpbmdMYWJlbD1leGlzdGluZ0VkZ2UuZ2V0TGFiZWwoKTt2YXIgbGFiZWxUb01lcmdlPWUuZ2V0TGFiZWwoKTtpZighZXhpc3RpbmdFZGdlLmlzUG9pbnR3aXNlRXF1YWwoZSkpe2xhYmVsVG9NZXJnZT1uZXcgTGFiZWwoZS5nZXRMYWJlbCgpKTtsYWJlbFRvTWVyZ2UuZmxpcCgpO31cbnZhciBkZXB0aD1leGlzdGluZ0VkZ2UuZ2V0RGVwdGgoKTtpZihkZXB0aC5pc051bGwoKSl7ZGVwdGguYWRkKGV4aXN0aW5nTGFiZWwpO31cbmRlcHRoLmFkZChsYWJlbFRvTWVyZ2UpO2V4aXN0aW5nTGFiZWwubWVyZ2UobGFiZWxUb01lcmdlKTt9ZWxzZXt0aGlzLmVkZ2VMaXN0LmFkZChlKTt9fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZUxhYmVsc0Zyb21EZXB0aHM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZWRnZUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxibD1lLmdldExhYmVsKCk7dmFyIGRlcHRoPWUuZ2V0RGVwdGgoKTtpZighZGVwdGguaXNOdWxsKCkpe2RlcHRoLm5vcm1hbGl6ZSgpO2Zvcih2YXIgaT0wO2k8MjtpKyspe2lmKCFsYmwuaXNOdWxsKGkpJiZsYmwuaXNBcmVhKCkmJiFkZXB0aC5pc051bGwoaSkpe2lmKGRlcHRoLmdldERlbHRhKGkpPT0wKXtsYmwudG9MaW5lKGkpO31lbHNle0Fzc2VydC5pc1RydWUoIWRlcHRoLmlzTnVsbChpLFBvc2l0aW9uLkxFRlQpLCdkZXB0aCBvZiBMRUZUIHNpZGUgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkJyk7bGJsLnNldExvY2F0aW9uKGksUG9zaXRpb24uTEVGVCxkZXB0aC5nZXRMb2NhdGlvbihpLFBvc2l0aW9uLkxFRlQpKTtBc3NlcnQuaXNUcnVlKCFkZXB0aC5pc051bGwoaSxQb3NpdGlvbi5SSUdIVCksJ2RlcHRoIG9mIFJJR0hUIHNpZGUgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkJyk7bGJsLnNldExvY2F0aW9uKGksUG9zaXRpb24uUklHSFQsZGVwdGguZ2V0TG9jYXRpb24oaSxQb3NpdGlvbi5SSUdIVCkpO319fX19fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlcGxhY2VDb2xsYXBzZWRFZGdlcz1mdW5jdGlvbigpe3ZhciBuZXdFZGdlcz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpdD10aGlzLmVkZ2VMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO2lmKGUuaXNDb2xsYXBzZWQoKSl7aXQucmVtb3ZlKCk7bmV3RWRnZXMuYWRkKGUuZ2V0Q29sbGFwc2VkRWRnZSgpKTt9fVxudGhpcy5lZGdlTGlzdC5hZGRBbGwobmV3RWRnZXMpO31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb3B5UG9pbnRzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5hcmdbYXJnSW5kZXhdLmdldE5vZGVJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdyYXBoTm9kZT1pLm5leHQoKTt2YXIgbmV3Tm9kZT10aGlzLmdyYXBoLmFkZE5vZGUoZ3JhcGhOb2RlLmdldENvb3JkaW5hdGUoKSk7bmV3Tm9kZS5zZXRMYWJlbChhcmdJbmRleCxncmFwaE5vZGUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCkpO319XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZz1mdW5jdGlvbigpe2Zvcih2YXIgbm9kZWl0PXRoaXMuZ3JhcGguZ2V0Tm9kZXMoKS5pdGVyYXRvcigpO25vZGVpdC5oYXNOZXh0KCk7KXt2YXIgbm9kZT1ub2RlaXQubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5jb21wdXRlTGFiZWxsaW5nKHRoaXMuYXJnKTt9XG50aGlzLm1lcmdlU3ltTGFiZWxzKCk7dGhpcy51cGRhdGVOb2RlTGFiZWxsaW5nKCk7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLm1lcmdlU3ltTGFiZWxzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLm1lcmdlU3ltTGFiZWxzKCk7fX1cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS51cGRhdGVOb2RlTGFiZWxsaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7dmFyIGxibD1ub2RlLmdldEVkZ2VzKCkuZ2V0TGFiZWwoKTtub2RlLmdldExhYmVsKCkubWVyZ2UobGJsKTt9fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmxhYmVsSW5jb21wbGV0ZU5vZGVzPWZ1bmN0aW9uKCl7dmFyIG5vZGVDb3VudD0wO2Zvcih2YXIgbmk9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bmkuaGFzTmV4dCgpOyl7dmFyIG49bmkubmV4dCgpO3ZhciBsYWJlbD1uLmdldExhYmVsKCk7aWYobi5pc0lzb2xhdGVkKCkpe25vZGVDb3VudCsrO2lmKGxhYmVsLmlzTnVsbCgwKSlcbnRoaXMubGFiZWxJbmNvbXBsZXRlTm9kZShuLDApO2Vsc2VcbnRoaXMubGFiZWxJbmNvbXBsZXRlTm9kZShuLDEpO31cbm4uZ2V0RWRnZXMoKS51cGRhdGVMYWJlbGxpbmcobGFiZWwpO319O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5sYWJlbEluY29tcGxldGVOb2RlPWZ1bmN0aW9uKG4sdGFyZ2V0SW5kZXgpe3ZhciBsb2M9dGhpcy5wdExvY2F0b3IubG9jYXRlKG4uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuYXJnW3RhcmdldEluZGV4XS5nZXRHZW9tZXRyeSgpKTtuLmdldExhYmVsKCkuc2V0TG9jYXRpb24odGFyZ2V0SW5kZXgsbG9jKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5maW5kUmVzdWx0QXJlYUVkZ2VzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBpdD10aGlzLmdyYXBoLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2lmKGxhYmVsLmlzQXJlYSgpJiYhZGUuaXNJbnRlcmlvckFyZWFFZGdlKCkmJmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbC5nZXRMb2NhdGlvbigwLFBvc2l0aW9uLlJJR0hUKSxsYWJlbC5nZXRMb2NhdGlvbigxLFBvc2l0aW9uLlJJR0hUKSxvcENvZGUpKXtkZS5zZXRJblJlc3VsdCh0cnVlKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNhbmNlbER1cGxpY2F0ZVJlc3VsdEVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpdD10aGlzLmdyYXBoLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoZGUuaXNJblJlc3VsdCgpJiZzeW0uaXNJblJlc3VsdCgpKXtkZS5zZXRJblJlc3VsdChmYWxzZSk7c3ltLnNldEluUmVzdWx0KGZhbHNlKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmlzQ292ZXJlZEJ5TEE9ZnVuY3Rpb24oY29vcmQpe2lmKHRoaXMuaXNDb3ZlcmVkKGNvb3JkLHRoaXMucmVzdWx0TGluZUxpc3QpKVxucmV0dXJuIHRydWU7aWYodGhpcy5pc0NvdmVyZWQoY29vcmQsdGhpcy5yZXN1bHRQb2x5TGlzdCkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaXNDb3ZlcmVkQnlBPWZ1bmN0aW9uKGNvb3JkKXtpZih0aGlzLmlzQ292ZXJlZChjb29yZCx0aGlzLnJlc3VsdFBvbHlMaXN0KSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pc0NvdmVyZWQ9ZnVuY3Rpb24oY29vcmQsZ2VvbUxpc3Qpe2Zvcih2YXIgaXQ9Z2VvbUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZ2VvbT1pdC5uZXh0KCk7dmFyIGxvYz10aGlzLnB0TG9jYXRvci5sb2NhdGUoY29vcmQsZ2VvbSk7aWYobG9jIT1Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlR2VvbWV0cnk9ZnVuY3Rpb24ocmVzdWx0UG9pbnRMaXN0LHJlc3VsdExpbmVMaXN0LHJlc3VsdFBvbHlMaXN0LG9wY29kZSl7dmFyIGdlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtnZW9tTGlzdC5hZGRBbGwocmVzdWx0UG9pbnRMaXN0KTtnZW9tTGlzdC5hZGRBbGwocmVzdWx0TGluZUxpc3QpO2dlb21MaXN0LmFkZEFsbChyZXN1bHRQb2x5TGlzdCk7cmV0dXJuIHRoaXMuZ2VvbUZhY3QuYnVpbGRHZW9tZXRyeShnZW9tTGlzdCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY3JlYXRlRW1wdHlSZXN1bHQ9ZnVuY3Rpb24ob3BDb2RlKXt2YXIgcmVzdWx0PW51bGw7c3dpdGNoKHJlc3VsdERpbWVuc2lvbihvcENvZGUsdGhpcy5hcmdbMF0uZ2V0R2VvbWV0cnkoKSx0aGlzLmFyZ1sxXS5nZXRHZW9tZXRyeSgpKSl7Y2FzZS0xOnJlc3VsdD1nZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oKTticmVhaztjYXNlIDA6cmVzdWx0PWdlb21GYWN0LmNyZWF0ZVBvaW50KG51bGwpO2JyZWFrO2Nhc2UgMTpyZXN1bHQ9Z2VvbUZhY3QuY3JlYXRlTGluZVN0cmluZyhudWxsKTticmVhaztjYXNlIDI6cmVzdWx0PWdlb21GYWN0LmNyZWF0ZVBvbHlnb24obnVsbCxudWxsKTticmVhazt9XG5yZXR1cm4gcmVzdWx0O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdERpbWVuc2lvbj1mdW5jdGlvbihvcENvZGUsZzAsZzEpe3ZhciBkaW0wPWcwLmdldERpbWVuc2lvbigpO3ZhciBkaW0xPWcxLmdldERpbWVuc2lvbigpO3ZhciByZXN1bHREaW1lbnNpb249LTE7c3dpdGNoKG9wQ29kZSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT046cmVzdWx0RGltZW5zaW9uPU1hdGgubWluKGRpbTAsZGltMSk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5VTklPTjpyZXN1bHREaW1lbnNpb249TWF0aC5tYXgoZGltMCxkaW0xKTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLkRJRkZFUkVOQ0U6cmVzdWx0RGltZW5zaW9uPWRpbTA7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFOnJlc3VsdERpbWVuc2lvbj1NYXRoLm1heChkaW0wLGRpbTEpO2JyZWFrO31cbnJldHVybiByZXN1bHREaW1lbnNpb247fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7dmFyIEdlb21ldHJ5U25hcHBlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuR2VvbWV0cnlTbmFwcGVyO3ZhciBTbmFwT3ZlcmxheU9wPWZ1bmN0aW9uKGcxLGcyKXt0aGlzLmdlb209W107dGhpcy5nZW9tWzBdPWcxO3RoaXMuZ2VvbVsxXT1nMjt0aGlzLmNvbXB1dGVTbmFwVG9sZXJhbmNlKCk7fTtTbmFwT3ZlcmxheU9wLm92ZXJsYXlPcD1mdW5jdGlvbihnMCxnMSxvcENvZGUpe3ZhciBvcD1uZXcgU25hcE92ZXJsYXlPcChnMCxnMSk7cmV0dXJuIG9wLmdldFJlc3VsdEdlb21ldHJ5KG9wQ29kZSk7fTtTbmFwT3ZlcmxheU9wLmludGVyc2VjdGlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIHRoaXMub3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5JTlRFUlNFQ1RJT04pO307U25hcE92ZXJsYXlPcC51bmlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIHRoaXMub3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5VTklPTik7fTtTbmFwT3ZlcmxheU9wLmRpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLkRJRkZFUkVOQ0UpO307U25hcE92ZXJsYXlPcC5zeW1EaWZmZXJlbmNlPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gb3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFKTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLmdlb209bnVsbDtTbmFwT3ZlcmxheU9wLnByb3RvdHlwZS5zbmFwVG9sZXJhbmNlPW51bGw7U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZVNuYXBUb2xlcmFuY2U9ZnVuY3Rpb24oKXt0aGlzLnNuYXBUb2xlcmFuY2U9R2VvbWV0cnlTbmFwcGVyLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZSh0aGlzLmdlb21bMF0sdGhpcy5nZW9tWzFdKTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLmdldFJlc3VsdEdlb21ldHJ5PWZ1bmN0aW9uKG9wQ29kZSl7dmFyIHByZXBHZW9tPXRoaXMuc25hcCh0aGlzLmdlb20pO3ZhciByZXN1bHQ9T3ZlcmxheU9wLm92ZXJsYXlPcChwcmVwR2VvbVswXSxwcmVwR2VvbVsxXSxvcENvZGUpO3JldHVybiB0aGlzLnByZXBhcmVSZXN1bHQocmVzdWx0KTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnNlbGZTbmFwPWZ1bmN0aW9uKGdlb20pe3ZhciBzbmFwcGVyMD1uZXcgR2VvbWV0cnlTbmFwcGVyKGdlb20pO3ZhciBzbmFwR2VvbT1zbmFwcGVyMC5zbmFwVG8oZ2VvbSx0aGlzLnNuYXBUb2xlcmFuY2UpO3JldHVybiBzbmFwR2VvbTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnNuYXA9ZnVuY3Rpb24oZ2VvbSl7dmFyIHJlbUdlb209Z2VvbTt2YXIgc25hcEdlb209R2VvbWV0cnlTbmFwcGVyLnNuYXAocmVtR2VvbVswXSxyZW1HZW9tWzFdLHRoaXMuc25hcFRvbGVyYW5jZSk7cmV0dXJuIHNuYXBHZW9tO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUucHJlcGFyZVJlc3VsdD1mdW5jdGlvbihnZW9tKXtyZXR1cm4gZ2VvbTt9O1NuYXBPdmVybGF5T3AucHJvdG90eXBlLmNicj1udWxsO1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnJlbW92ZUNvbW1vbkJpdHM9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5jYnI9bmV3IGpzdHMucHJlY2lzaW9uLkNvbW1vbkJpdHNSZW1vdmVyKCk7dGhpcy5jYnIuYWRkKHRoaXMuZ2VvbVswXSk7dGhpcy5jYnIuYWRkKHRoaXMuZ2VvbVsxXSk7dmFyIHJlbUdlb209W107cmVtR2VvbVswXT1jYnIucmVtb3ZlQ29tbW9uQml0cyh0aGlzLmdlb21bMF0uY2xvbmUoKSk7cmVtR2VvbVsxXT1jYnIucmVtb3ZlQ29tbW9uQml0cyh0aGlzLmdlb21bMV0uY2xvbmUoKSk7cmV0dXJuIHJlbUdlb207fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcE92ZXJsYXlPcD1TbmFwT3ZlcmxheU9wO30pKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGVkZ2VzLHNpLHRlc3RBbGxTZWdtZW50cyl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LkVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMyPWZ1bmN0aW9uKGVkZ2VzMCxlZGdlczEsc2kpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yPWZ1bmN0aW9uKCl7dGhpcy5ldmVudHM9W107fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZXZlbnRzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubk92ZXJsYXBzPTA7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXtpZihzaSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbmlmKHRlc3RBbGxTZWdtZW50cyl7dGhpcy5hZGRMaXN0MihlZGdlcyxudWxsKTt9ZWxzZXt0aGlzLmFkZExpc3QoZWRnZXMpO31cbnRoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMzKHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMj1mdW5jdGlvbihlZGdlczAsZWRnZXMxLHNpKXt0aGlzLmFkZExpc3QyKGVkZ2VzMCxlZGdlczApO3RoaXMuYWRkTGlzdDIoZWRnZXMxLGVkZ2VzMSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczMoc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGVkZ2UsZWRnZVNldCl7aWYoZWRnZSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmFkZExpc3QuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgbWNlPWVkZ2UuZ2V0TW9ub3RvbmVDaGFpbkVkZ2UoKTt2YXIgc3RhcnRJbmRleD1tY2UuZ2V0U3RhcnRJbmRleGVzKCk7Zm9yKHZhciBpPTA7aTxzdGFydEluZGV4Lmxlbmd0aC0xO2krKyl7dmFyIG1jPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluKG1jZSxpKTt2YXIgaW5zZXJ0RXZlbnQ9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KG1jZS5nZXRNaW5YKGkpLG1jLGVkZ2VTZXQpO3RoaXMuZXZlbnRzLnB1c2goaW5zZXJ0RXZlbnQpO3RoaXMuZXZlbnRzLnB1c2gobmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KG1jZS5nZXRNYXhYKGkpLGluc2VydEV2ZW50KSk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkTGlzdD1mdW5jdGlvbihlZGdlcyl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWRnZT1pLm5leHQoKTt0aGlzLmFkZChlZGdlLGVkZ2UpO319O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmFkZExpc3QyPWZ1bmN0aW9uKGVkZ2VzLGVkZ2VTZXQpe2Zvcih2YXIgaT1lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVkZ2U9aS5uZXh0KCk7dGhpcy5hZGQoZWRnZSxlZGdlU2V0KTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wcmVwYXJlRXZlbnRzPWZ1bmN0aW9uKCl7dGhpcy5ldmVudHMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0RlbGV0ZSgpKXtldi5nZXRJbnNlcnRFdmVudCgpLnNldERlbGV0ZUV2ZW50SW5kZXgoaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMz1mdW5jdGlvbihzaSl7dGhpcy5uT3ZlcmxhcHM9MDt0aGlzLnByZXBhcmVFdmVudHMoKTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0luc2VydCgpKXt0aGlzLnByb2Nlc3NPdmVybGFwcyhpLGV2LmdldERlbGV0ZUV2ZW50SW5kZXgoKSxldixzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByb2Nlc3NPdmVybGFwcz1mdW5jdGlvbihzdGFydCxlbmQsZXYwLHNpKXt2YXIgbWMwPWV2MC5nZXRPYmplY3QoKTtmb3IodmFyIGk9c3RhcnQ7aTxlbmQ7aSsrKXt2YXIgZXYxPXRoaXMuZXZlbnRzW2ldO2lmKGV2MS5pc0luc2VydCgpKXt2YXIgbWMxPWV2MS5nZXRPYmplY3QoKTtpZighZXYwLmlzU2FtZUxhYmVsKGV2MSkpe21jMC5jb21wdXRlSW50ZXJzZWN0aW9ucyhtYzEsc2kpO3RoaXMubk92ZXJsYXBzKys7fX19fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yPWZ1bmN0aW9uKGdlb20pe3RoaXMuZ2VvbT1nZW9tO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5sb2NhdGU9ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tLmlzRW1wdHkoKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7aWYoanN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50KHAsZ2VvbSkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3JldHVybiBqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnRJblBvbHlnb24ocCxnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3ZhciBnMj1nZW9tLmdlb21ldHJpZXNbaV07aWYoZzIhPT1nZW9tKVxuaWYoanN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50KHAsZzIpKVxucmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuY29udGFpbnNQb2ludEluUG9seWdvbj1mdW5jdGlvbihwLHBvbHkpe2lmKHBvbHkuaXNFbXB0eSgpKVxucmV0dXJuIGZhbHNlO3ZhciBzaGVsbD1wb2x5LmdldEV4dGVyaW9yUmluZygpO2lmKCFqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmlzUG9pbnRJblJpbmcocCxzaGVsbCkpXG5yZXR1cm4gZmFsc2U7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cG9seS5nZXRJbnRlcmlvclJpbmdOKGkpO2lmKGpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuaXNQb2ludEluUmluZyhwLGhvbGUpKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5pc1BvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7aWYoIXJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMocCkpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHAscmluZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IucHJvdG90eXBlLmdlb209bnVsbDtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IubG9jYXRlKHAsZ2VvbSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgRWRnZUVuZFN0YXI9anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXI7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXI9ZnVuY3Rpb24oKXtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5jYWxsKHRoaXMpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGU9bmV3IEVkZ2VFbmRTdGFyKCk7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnJlc3VsdEFyZWFFZGdlTGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGVlKXt2YXIgZGU9ZWU7dGhpcy5pbnNlcnRFZGdlRW5kKGRlLGRlKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRPdXRnb2luZ0RlZ3JlZT1mdW5jdGlvbigpe3ZhciBkZWdyZWU9MDtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKSlcbmRlZ3JlZSsrO31cbnJldHVybiBkZWdyZWU7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRPdXRnb2luZ0RlZ3JlZT1mdW5jdGlvbihlcil7dmFyIGRlZ3JlZT0wO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuZ2V0RWRnZVJpbmcoKT09PWVyKVxuZGVncmVlKys7fVxucmV0dXJuIGRlZ3JlZTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldFJpZ2h0bW9zdEVkZ2U9ZnVuY3Rpb24oKXt2YXIgZWRnZXM9dGhpcy5nZXRFZGdlcygpO3ZhciBzaXplPWVkZ2VzLnNpemUoKTtpZihzaXplPDEpXG5yZXR1cm4gbnVsbDt2YXIgZGUwPWVkZ2VzLmdldCgwKTtpZihzaXplPT0xKVxucmV0dXJuIGRlMDt2YXIgZGVMYXN0PWVkZ2VzLmdldChzaXplLTEpO3ZhciBxdWFkMD1kZTAuZ2V0UXVhZHJhbnQoKTt2YXIgcXVhZDE9ZGVMYXN0LmdldFF1YWRyYW50KCk7aWYoanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNOb3J0aGVybihxdWFkMCkmJmpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm4ocXVhZDEpKVxucmV0dXJuIGRlMDtlbHNlIGlmKCFqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc05vcnRoZXJuKHF1YWQwKSYmIWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm4ocXVhZDEpKVxucmV0dXJuIGRlTGFzdDtlbHNle3ZhciBub25Ib3Jpem9udGFsRWRnZT1udWxsO2lmKGRlMC5nZXREeSgpIT0wKVxucmV0dXJuIGRlMDtlbHNlIGlmKGRlTGFzdC5nZXREeSgpIT0wKVxucmV0dXJuIGRlTGFzdDt9XG5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoJ2ZvdW5kIHR3byBob3Jpem9udGFsIGVkZ2VzIGluY2lkZW50IG9uIG5vZGUnKTtyZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmNvbXB1dGVMYWJlbGxpbmc9ZnVuY3Rpb24oZ2VvbSl7RWRnZUVuZFN0YXIucHJvdG90eXBlLmNvbXB1dGVMYWJlbGxpbmcuY2FsbCh0aGlzLGdlb20pO3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKExvY2F0aW9uLk5PTkUpO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlZT1pdC5uZXh0KCk7dmFyIGU9ZWUuZ2V0RWRnZSgpO3ZhciBlTGFiZWw9ZS5nZXRMYWJlbCgpO2Zvcih2YXIgaT0wO2k8MjtpKyspe3ZhciBlTG9jPWVMYWJlbC5nZXRMb2NhdGlvbihpKTtpZihlTG9jPT09TG9jYXRpb24uSU5URVJJT1J8fGVMb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oaSxMb2NhdGlvbi5JTlRFUklPUik7fX19O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLm1lcmdlU3ltTGFiZWxzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTtsYWJlbC5tZXJnZShkZS5nZXRTeW0oKS5nZXRMYWJlbCgpKTt9fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS51cGRhdGVMYWJlbGxpbmc9ZnVuY3Rpb24obm9kZUxhYmVsKXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2xhYmVsLnNldEFsbExvY2F0aW9uc0lmTnVsbCgwLG5vZGVMYWJlbC5nZXRMb2NhdGlvbigwKSk7bGFiZWwuc2V0QWxsTG9jYXRpb25zSWZOdWxsKDEsbm9kZUxhYmVsLmdldExvY2F0aW9uKDEpKTt9fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRSZXN1bHRBcmVhRWRnZXM9ZnVuY3Rpb24oKXtpZih0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdCE9PW51bGwpXG5yZXR1cm4gdGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Q7dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKXx8ZGUuZ2V0U3ltKCkuaXNJblJlc3VsdCgpKVxudGhpcy5yZXN1bHRBcmVhRWRnZUxpc3QuYWRkKGRlKTt9XG5yZXR1cm4gdGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Q7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5TQ0FOTklOR19GT1JfSU5DT01JTkc9MTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5MSU5LSU5HX1RPX09VVEdPSU5HPTI7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGlua1Jlc3VsdERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oKXt0aGlzLmdldFJlc3VsdEFyZWFFZGdlcygpO3ZhciBmaXJzdE91dD1udWxsO3ZhciBpbmNvbWluZz1udWxsO3ZhciBzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORztmb3IodmFyIGk9MDtpPHRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LnNpemUoKTtpKyspe3ZhciBuZXh0T3V0PXRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LmdldChpKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoIW5leHRPdXQuZ2V0TGFiZWwoKS5pc0FyZWEoKSlcbmNvbnRpbnVlO2lmKGZpcnN0T3V0PT09bnVsbCYmbmV4dE91dC5pc0luUmVzdWx0KCkpXG5maXJzdE91dD1uZXh0T3V0O3N3aXRjaChzdGF0ZSl7Y2FzZSB0aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzppZighbmV4dEluLmlzSW5SZXN1bHQoKSlcbmNvbnRpbnVlO2luY29taW5nPW5leHRJbjtzdGF0ZT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkc7YnJlYWs7Y2FzZSB0aGlzLkxJTktJTkdfVE9fT1VUR09JTkc6aWYoIW5leHRPdXQuaXNJblJlc3VsdCgpKVxuY29udGludWU7aW5jb21pbmcuc2V0TmV4dChuZXh0T3V0KTtzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzticmVhazt9fVxuaWYoc3RhdGU9PT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkcpe2lmKGZpcnN0T3V0PT09bnVsbClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ25vIG91dGdvaW5nIGRpckVkZ2UgZm91bmQnLHRoaXMuZ2V0Q29vcmRpbmF0ZSgpKTtBc3NlcnQuaXNUcnVlKGZpcnN0T3V0LmlzSW5SZXN1bHQoKSwndW5hYmxlIHRvIGxpbmsgbGFzdCBpbmNvbWluZyBkaXJFZGdlJyk7aW5jb21pbmcuc2V0TmV4dChmaXJzdE91dCk7fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGlua01pbmltYWxEaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKGVyKXt2YXIgZmlyc3RPdXQ9bnVsbDt2YXIgaW5jb21pbmc9bnVsbDt2YXIgc3RhdGU9dGhpcy5TQ0FOTklOR19GT1JfSU5DT01JTkc7Zm9yKHZhciBpPXRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LnNpemUoKS0xO2k+PTA7aS0tKXt2YXIgbmV4dE91dD10aGlzLnJlc3VsdEFyZWFFZGdlTGlzdC5nZXQoaSk7dmFyIG5leHRJbj1uZXh0T3V0LmdldFN5bSgpO2lmKGZpcnN0T3V0PT09bnVsbCYmbmV4dE91dC5nZXRFZGdlUmluZygpPT09ZXIpXG5maXJzdE91dD1uZXh0T3V0O3N3aXRjaChzdGF0ZSl7Y2FzZSB0aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzppZihuZXh0SW4uZ2V0RWRnZVJpbmcoKSE9ZXIpXG5jb250aW51ZTtpbmNvbWluZz1uZXh0SW47c3RhdGU9dGhpcy5MSU5LSU5HX1RPX09VVEdPSU5HO2JyZWFrO2Nhc2UgdGhpcy5MSU5LSU5HX1RPX09VVEdPSU5HOmlmKG5leHRPdXQuZ2V0RWRnZVJpbmcoKSE9PWVyKVxuY29udGludWU7aW5jb21pbmcuc2V0TmV4dE1pbihuZXh0T3V0KTtzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORzticmVhazt9fVxuaWYoc3RhdGU9PT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkcpe0Fzc2VydC5pc1RydWUoZmlyc3RPdXQhPT1udWxsLCdmb3VuZCBudWxsIGZvciBmaXJzdCBvdXRnb2luZyBkaXJFZGdlJyk7QXNzZXJ0LmlzVHJ1ZShmaXJzdE91dC5nZXRFZGdlUmluZygpPT09ZXIsJ3VuYWJsZSB0byBsaW5rIGxhc3QgaW5jb21pbmcgZGlyRWRnZScpO2luY29taW5nLnNldE5leHRNaW4oZmlyc3RPdXQpO319O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmxpbmtBbGxEaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKCl7dGhpcy5nZXRFZGdlcygpO3ZhciBwcmV2T3V0PW51bGw7dmFyIGZpcnN0SW49bnVsbDtmb3IodmFyIGk9dGhpcy5lZGdlTGlzdC5zaXplKCktMTtpPj0wO2ktLSl7dmFyIG5leHRPdXQ9dGhpcy5lZGdlTGlzdC5nZXQoaSk7dmFyIG5leHRJbj1uZXh0T3V0LmdldFN5bSgpO2lmKGZpcnN0SW49PT1udWxsKVxuZmlyc3RJbj1uZXh0SW47aWYocHJldk91dCE9PW51bGwpXG5uZXh0SW4uc2V0TmV4dChwcmV2T3V0KTtwcmV2T3V0PW5leHRPdXQ7fVxuZmlyc3RJbi5zZXROZXh0KHByZXZPdXQpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZmluZENvdmVyZWRMaW5lRWRnZXM9ZnVuY3Rpb24oKXt2YXIgc3RhcnRMb2M9TG9jYXRpb24uTk9ORTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgbmV4dE91dD1pdC5uZXh0KCk7dmFyIG5leHRJbj1uZXh0T3V0LmdldFN5bSgpO2lmKCFuZXh0T3V0LmlzTGluZUVkZ2UoKSl7aWYobmV4dE91dC5pc0luUmVzdWx0KCkpe3N0YXJ0TG9jPUxvY2F0aW9uLklOVEVSSU9SO2JyZWFrO31cbmlmKG5leHRJbi5pc0luUmVzdWx0KCkpe3N0YXJ0TG9jPUxvY2F0aW9uLkVYVEVSSU9SO2JyZWFrO319fVxuaWYoc3RhcnRMb2M9PT1Mb2NhdGlvbi5OT05FKVxucmV0dXJuO3ZhciBjdXJyTG9jPXN0YXJ0TG9jO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBuZXh0T3V0PWl0Lm5leHQoKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYobmV4dE91dC5pc0xpbmVFZGdlKCkpe25leHRPdXQuZ2V0RWRnZSgpLnNldENvdmVyZWQoY3VyckxvYz09PUxvY2F0aW9uLklOVEVSSU9SKTt9ZWxzZXtpZihuZXh0T3V0LmlzSW5SZXN1bHQoKSlcbmN1cnJMb2M9TG9jYXRpb24uRVhURVJJT1I7aWYobmV4dEluLmlzSW5SZXN1bHQoKSlcbmN1cnJMb2M9TG9jYXRpb24uSU5URVJJT1I7fX19O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmNvbXB1dGVEZXB0aHM9ZnVuY3Rpb24oZGUpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmNvbXB1dGVEZXB0aHMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGVkZ2VJbmRleD10aGlzLmZpbmRJbmRleChkZSk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7dmFyIHN0YXJ0RGVwdGg9ZGUuZ2V0RGVwdGgoUG9zaXRpb24uTEVGVCk7dmFyIHRhcmdldExhc3REZXB0aD1kZS5nZXREZXB0aChQb3NpdGlvbi5SSUdIVCk7dmFyIG5leHREZXB0aD10aGlzLmNvbXB1dGVEZXB0aHMyKGVkZ2VJbmRleCsxLHRoaXMuZWRnZUxpc3Quc2l6ZSgpLHN0YXJ0RGVwdGgpO3ZhciBsYXN0RGVwdGg9dGhpcy5jb21wdXRlRGVwdGhzMigwLGVkZ2VJbmRleCxuZXh0RGVwdGgpO2lmKGxhc3REZXB0aCE9dGFyZ2V0TGFzdERlcHRoKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignZGVwdGggbWlzbWF0Y2ggYXQgJytcbmRlLmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5jb21wdXRlRGVwdGhzMj1mdW5jdGlvbihzdGFydEluZGV4LGVuZEluZGV4LHN0YXJ0RGVwdGgpe3ZhciBjdXJyRGVwdGg9c3RhcnREZXB0aDtmb3IodmFyIGk9c3RhcnRJbmRleDtpPGVuZEluZGV4O2krKyl7dmFyIG5leHREZT10aGlzLmVkZ2VMaXN0LmdldChpKTt2YXIgbGFiZWw9bmV4dERlLmdldExhYmVsKCk7bmV4dERlLnNldEVkZ2VEZXB0aHMoUG9zaXRpb24uUklHSFQsY3VyckRlcHRoKTtjdXJyRGVwdGg9bmV4dERlLmdldERlcHRoKFBvc2l0aW9uLkxFRlQpO31cbnJldHVybiBjdXJyRGVwdGg7fTt9KSgpO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZT1mdW5jdGlvbigpe3RoaXMuY2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuY2VudFN1bT1udWxsO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUudG90YWxMZW5ndGg9MC4wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBBcnJheSl7dGhpcy5hZGQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxuaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmFkZChnZW9tLmdldENvb3JkaW5hdGVzKCkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dmFyIHBvbHk9Z2VvbTt0aGlzLmFkZChwb2x5LmdldEV4dGVyaW9yUmluZygpLmdldENvb3JkaW5hdGVzKCkpO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuYWRkKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKS5nZXRDb29yZGluYXRlcygpKTt9fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb258fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt2YXIgZ2M9Z2VvbTtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdjLmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXt2YXIgY2VudD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtjZW50Lng9dGhpcy5jZW50U3VtLngvdGhpcy50b3RhbExlbmd0aDtjZW50Lnk9dGhpcy5jZW50U3VtLnkvdGhpcy50b3RhbExlbmd0aDtyZXR1cm4gY2VudDt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkTGluZS5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ21lbnRMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTt0aGlzLnRvdGFsTGVuZ3RoKz1zZWdtZW50TGVuO3ZhciBtaWR4PShwdHNbaV0ueCtwdHNbaSsxXS54KS8yO3RoaXMuY2VudFN1bS54Kz1zZWdtZW50TGVuKm1pZHg7dmFyIG1pZHk9KHB0c1tpXS55K3B0c1tpKzFdLnkpLzI7dGhpcy5jZW50U3VtLnkrPXNlZ21lbnRMZW4qbWlkeTt9fTtqc3RzLmluZGV4LkludGVydmFsU2l6ZT1mdW5jdGlvbigpe307anN0cy5pbmRleC5JbnRlcnZhbFNpemUuTUlOX0JJTkFSWV9FWFBPTkVOVD0tNTA7anN0cy5pbmRleC5JbnRlcnZhbFNpemUuaXNaZXJvV2lkdGg9ZnVuY3Rpb24obWluLG1heCl7dmFyIHdpZHRoPW1heC1taW47aWYod2lkdGg9PT0wLjApe3JldHVybiB0cnVlO31cbnZhciBtYXhBYnMsc2NhbGVkSW50ZXJ2YWwsbGV2ZWw7bWF4QWJzPU1hdGgubWF4KE1hdGguYWJzKG1pbiksTWF0aC5hYnMobWF4KSk7c2NhbGVkSW50ZXJ2YWw9d2lkdGgvbWF4QWJzO2xldmVsPWpzdHMuaW5kZXguRG91YmxlQml0cy5leHBvbmVudChzY2FsZWRJbnRlcnZhbCk7cmV0dXJuIGxldmVsPD1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5NSU5fQklOQVJZX0VYUE9ORU5UO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlRWRnZVNldEludGVyc2VjdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLm5PdmVybGFwcz0wO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXtpZihzaSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMubk92ZXJsYXBzPTA7Zm9yKHZhciBpMD1lZGdlcy5pdGVyYXRvcigpO2kwLmhhc05leHQoKTspe3ZhciBlZGdlMD1pMC5uZXh0KCk7Zm9yKHZhciBpMT1lZGdlcy5pdGVyYXRvcigpO2kxLmhhc05leHQoKTspe3ZhciBlZGdlMT1pMS5uZXh0KCk7aWYodGVzdEFsbFNlZ21lbnRzfHxlZGdlMCE9ZWRnZTEpXG50aGlzLmNvbXB1dGVJbnRlcnNlY3RzKGVkZ2UwLGVkZ2UxLHNpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlRWRnZVNldEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczI9ZnVuY3Rpb24oZWRnZXMwLGVkZ2VzMSxzaSl7dGhpcy5uT3ZlcmxhcHM9MDtmb3IodmFyIGkwPWVkZ2VzMC5pdGVyYXRvcigpO2kwLmhhc05leHQoKTspe3ZhciBlZGdlMD1pMC5uZXh0KCk7Zm9yKHZhciBpMT1lZGdlczEuaXRlcmF0b3IoKTtpMS5oYXNOZXh0KCk7KXt2YXIgZWRnZTE9aTEubmV4dCgpO3RoaXMuY29tcHV0ZUludGVyc2VjdHMoZWRnZTAsZWRnZTEsc2kpO319fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3RzPWZ1bmN0aW9uKGUwLGUxLHNpKXt2YXIgcHRzMD1lMC5nZXRDb29yZGluYXRlcygpO3ZhciBwdHMxPWUxLmdldENvb3JkaW5hdGVzKCk7dmFyIGkwLGkxO2ZvcihpMD0wO2kwPHB0czAubGVuZ3RoLTE7aTArKyl7Zm9yKGkxPTA7aTE8cHRzMS5sZW5ndGgtMTtpMSsrKXtzaS5hZGRJbnRlcnNlY3Rpb25zKGUwLGkwLGUxLGkxKTt9fX07anN0cy5nZW9tZ3JhcGguRWRnZT1mdW5jdGlvbihwdHMsbGFiZWwpe3RoaXMucHRzPXB0czt0aGlzLmxhYmVsPWxhYmVsO3RoaXMuZWlMaXN0PW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdCh0aGlzKTt0aGlzLmRlcHRoPW5ldyBqc3RzLmdlb21ncmFwaC5EZXB0aCgpO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50KCk7anN0cy5nZW9tZ3JhcGguRWRnZS5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5FZGdlO2pzdHMuZ2VvbWdyYXBoLkVkZ2UudXBkYXRlSU09ZnVuY3Rpb24obGFiZWwsaW0pe2ltLnNldEF0TGVhc3RJZlZhbGlkKGxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04pLGxhYmVsLmdldExvY2F0aW9uKDEsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04pLDEpO2lmKGxhYmVsLmlzQXJlYSgpKXtpbS5zZXRBdExlYXN0SWZWYWxpZChsYWJlbC5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpLGxhYmVsLmdldExvY2F0aW9uKDEsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCksMik7aW0uc2V0QXRMZWFzdElmVmFsaWQobGFiZWwuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCksbGFiZWwuZ2V0TG9jYXRpb24oMSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCksMik7fX07anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUucHRzPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZW52PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUubmFtZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLm1jZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLl9pc0lzb2xhdGVkPXRydWU7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZGVwdGg9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5kZXB0aERlbHRhPTA7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZWlMaXN0PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzLmxlbmd0aDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7aWYodGhpcy5lbnY9PT1udWxsKXt0aGlzLmVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7Zm9yKHZhciBpPTA7aTx0aGlzLnB0cy5sZW5ndGg7aSsrKXt0aGlzLmVudi5leHBhbmRUb0luY2x1ZGUocHRzW2ldKTt9fVxucmV0dXJuIGVudjt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldERlcHRoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVwdGg7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXREZXB0aERlbHRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVwdGhEZWx0YTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLnNldERlcHRoRGVsdGE9ZnVuY3Rpb24oZGVwdGhEZWx0YSl7dGhpcy5kZXB0aERlbHRhPWRlcHRoRGVsdGE7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0czt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oaSl7aWYoaT09PXVuZGVmaW5lZCl7aWYodGhpcy5wdHMubGVuZ3RoPjApe3JldHVybiB0aGlzLnB0c1swXTt9ZWxzZXtyZXR1cm4gbnVsbDt9fVxucmV0dXJuIHRoaXMucHRzW2ldO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuaXNDbG9zZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHNbMF0uZXF1YWxzKHRoaXMucHRzW3RoaXMucHRzLmxlbmd0aC0xXSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5zZXRJc29sYXRlZD1mdW5jdGlvbihpc0lzb2xhdGVkKXt0aGlzLl9pc0lzb2xhdGVkPWlzSXNvbGF0ZWQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0lzb2xhdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSXNvbGF0ZWQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgpe2Zvcih2YXIgaT0wO2k8bGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk7aSsrKXt0aGlzLmFkZEludGVyc2VjdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4LGkpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbj1mdW5jdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4LGludEluZGV4KXt2YXIgaW50UHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGxpLmdldEludGVyc2VjdGlvbihpbnRJbmRleCkpO3ZhciBub3JtYWxpemVkU2VnbWVudEluZGV4PXNlZ21lbnRJbmRleDt2YXIgZGlzdD1saS5nZXRFZGdlRGlzdGFuY2UoZ2VvbUluZGV4LGludEluZGV4KTt2YXIgbmV4dFNlZ0luZGV4PW5vcm1hbGl6ZWRTZWdtZW50SW5kZXgrMTtpZihuZXh0U2VnSW5kZXg8dGhpcy5wdHMubGVuZ3RoKXt2YXIgbmV4dFB0PXRoaXMucHRzW25leHRTZWdJbmRleF07aWYoaW50UHQuZXF1YWxzMkQobmV4dFB0KSl7bm9ybWFsaXplZFNlZ21lbnRJbmRleD1uZXh0U2VnSW5kZXg7ZGlzdD0wLjA7fX1cbnZhciBlaT10aGlzLmVpTGlzdC5hZGQoaW50UHQsbm9ybWFsaXplZFNlZ21lbnRJbmRleCxkaXN0KTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldE1heGltdW1TZWdtZW50SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoLTE7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVpTGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldE1vbm90b25lQ2hhaW5FZGdlPWZ1bmN0aW9uKCl7aWYodGhpcy5tY2U9PW51bGwpe3RoaXMubWNlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZSh0aGlzKTt9XG5yZXR1cm4gdGhpcy5tY2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpXG57cmV0dXJuIHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1t0aGlzLnB0cy5sZW5ndGgtMV0pO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuaXNDb2xsYXBzZWQ9ZnVuY3Rpb24oKVxue2lmKCF0aGlzLmxhYmVsLmlzQXJlYSgpKXJldHVybiBmYWxzZTtpZih0aGlzLnB0cy5sZW5ndGghPTMpcmV0dXJuIGZhbHNlO2lmKHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1syXSkpcmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0Q29sbGFwc2VkRWRnZT1mdW5jdGlvbigpXG57dmFyIG5ld1B0cz1bXTtuZXdQdHNbMF09dGhpcy5wdHNbMF07bmV3UHRzWzFdPXRoaXMucHRzWzFdO3ZhciBuZXdlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKG5ld1B0cyxqc3RzLmdlb21ncmFwaC5MYWJlbC50b0xpbmVMYWJlbCh0aGlzLmxhYmVsKSk7cmV0dXJuIG5ld2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oaW0pe2pzdHMuZ2VvbWdyYXBoLkVkZ2UudXBkYXRlSU0odGhpcy5sYWJlbCxpbSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc1BvaW50d2lzZUVxdWFsPWZ1bmN0aW9uKGUpXG57aWYodGhpcy5wdHMubGVuZ3RoIT1lLnB0cy5sZW5ndGgpcmV0dXJuIGZhbHNlO2Zvcih2YXIgaT0wO2k8dGhpcy5wdHMubGVuZ3RoO2krKyl7aWYoIXRoaXMucHRzW2ldLmVxdWFsczJEKGUucHRzW2ldKSl7cmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMubm9kaW5nLk9jdGFudD1mdW5jdGlvbigpe3Rocm93IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQ9ZnVuY3Rpb24oZHgsZHkpe2lmKGR4IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiBqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50Mi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuaWYoZHg9PT0wLjAmJmR5PT09MC4wKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBvY3RhbnQgZm9yIHBvaW50ICggJytkeCsnLCAnK2R5KycgKScpO3ZhciBhZHg9TWF0aC5hYnMoZHgpO3ZhciBhZHk9TWF0aC5hYnMoZHkpO2lmKGR4Pj0wKXtpZihkeT49MCl7aWYoYWR4Pj1hZHkpXG5yZXR1cm4gMDtlbHNlXG5yZXR1cm4gMTt9XG5lbHNle2lmKGFkeD49YWR5KVxucmV0dXJuIDc7ZWxzZVxucmV0dXJuIDY7fX1cbmVsc2V7aWYoZHk+PTApe2lmKGFkeD49YWR5KVxucmV0dXJuIDM7ZWxzZVxucmV0dXJuIDI7fVxuZWxzZXtpZihhZHg+PWFkeSlcbnJldHVybiA0O2Vsc2VcbnJldHVybiA1O319fTtqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50Mj1mdW5jdGlvbihwMCxwMSl7dmFyIGR4PXAxLngtcDAueDt2YXIgZHk9cDEueS1wMC55O2lmKGR4PT09MC4wJiZkeT09PTAuMClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdDYW5ub3QgY29tcHV0ZSB0aGUgb2N0YW50IGZvciB0d28gaWRlbnRpY2FsIHBvaW50cyAnK3AwKTtyZXR1cm4ganN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudChkeCxkeSk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nPWZ1bmN0aW9uKGcwLGcxKXt0aGlzLmcwPWcwO3RoaXMuZzE9ZzE7dGhpcy5nZW9tRmFjdG9yeT1nMC5nZXRGYWN0b3J5KCk7dGhpcy5pbnRlcmFjdHMwPVtdO3RoaXMuaW50ZXJhY3RzMT1bXTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcudW5pb249ZnVuY3Rpb24oZzAsZzEpe3ZhciB1dWU9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcoZzAsZzEpO3JldHVybiB1dWUudW5pb24oKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmdlb21GYWN0b3J5PW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuZzA9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5nMT1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmludGVyYWN0czA9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5pbnRlcmFjdHMxPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUudW5pb249ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVJbnRlcmFjdGluZygpO3ZhciBpbnQwPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzAsdGhpcy5pbnRlcmFjdHMwLHRydWUpO3ZhciBpbnQxPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzEsdGhpcy5pbnRlcmFjdHMxLHRydWUpO2lmKGludDAuaXNFbXB0eSgpfHxpbnQxLmlzRW1wdHkoKSl7fVxudmFyIHVuaW9uPWluMC51bmlvbihpbnQxKTt2YXIgZGlzam9pbnQwPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzAsdGhpcy5pbnRlcmFjdHMwLGZhbHNlKTt2YXIgZGlzam9pbnQxPXRoaXMuZXh0cmFjdEVsZW1lbnRzKHRoaXMuZzEsdGhpcy5pbnRlcmFjdHMxLGZhbHNlKTt2YXIgb3ZlcmFsbFVuaW9uPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZSh1bmlvbixkaXNqb2ludDAsZGlzam9pbnQxKTtyZXR1cm4gb3ZlcmFsbFVuaW9uO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuYnVmZmVyVW5pb249ZnVuY3Rpb24oZzAsZzEpe3ZhciBmYWN0b3J5PWcwLmdldEZhY3RvcnkoKTt2YXIgZ0NvbGw9ZmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oW2cwLGcxXSk7dmFyIHVuaW9uQWxsPWdDb2xsLmJ1ZmZlcigwLjApO3JldHVybiB1bmlvbkFsbDt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmNvbXB1dGVJbnRlcmFjdGluZz1mdW5jdGlvbihlbGVtMCl7aWYoIWVsZW0wKXtmb3IodmFyIGk9MCxsPXRoaXMuZzAuZ2V0TnVtR2VvbWV0cmllcygpO2k8bDtpKyspe3ZhciBlbGVtPXRoaXMuZzAuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuaW50ZXJhY3RzMFtpXT10aGlzLmNvbXB1dGVJbnRlcmFjdGluZyhlbGVtKTt9fVxuZWxzZXt2YXIgaW50ZXJhY3RzV2l0aEFueT1mYWxzZTtmb3IodmFyIGk9MCxsPWcxLmdldE51bUdlb21ldHJpZXMoKTtpPGw7aSsrKXt2YXIgZWxlbTE9dGhpcy5nMS5nZXRHZW9tZXRyeU4oaSk7dmFyIGludGVyYWN0cz1lbGVtMS5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhlbGVtMC5nZXRFbnZlbG9wZUludGVybmFsKCkpO2lmKGludGVyYWN0cyl7dGhpcy5pbnRlcmFjdHMxW2ldPXRydWU7aW50ZXJhY3RzV2l0aEFueT10cnVlO319XG5yZXR1cm4gaW50ZXJhY3RzV2l0aEFueTt9fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5leHRyYWN0RWxlbWVudHM9ZnVuY3Rpb24oZ2VvbSxpbnRlcmFjdHMsaXNJbnRlcmFjdGluZyl7dmFyIGV4dHJhY3RlZEdlb21zPVtdO2Zvcih2YXIgaT0wLGw9Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aTxsO2krKyl7dmFyIGVsZW09Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYoaW50ZXJhY3RzW2ldPT09aXNJbnRlcmFjdGluZyl7ZXh0cmFjdGVkR2VvbXMucHVzaChlbGVtKTt9fVxucmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuYnVpbGRHZW9tZXRyeShleHRyYWN0ZWRHZW9tcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlPWZ1bmN0aW9uKCl7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVOb25Sb2J1c3Q9ZnVuY3Rpb24oYSxiLGMscCl7dmFyIGlzSW5DaXJjbGU9KGEueCphLngrYS55KmEueSkqanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhKGIsYyxwKS1cbihiLngqYi54K2IueSpiLnkpKmpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYShhLGMscCkrXG4oYy54KmMueCtjLnkqYy55KSpqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWEoYSxiLHApLVxuKHAueCpwLngrcC55KnAueSkqanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhKGEsYixjKT4wO3JldHVybiBpc0luQ2lyY2xlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlTm9ybWFsaXplZD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgYWR4LGFkeSxiZHgsYmR5LGNkeCxjZHksYWJkZXQsYmNkZXQsY2FkZXQsYWxpZnQsYmxpZnQsY2xpZnQsZGlzYzthZHg9YS54LXAueDthZHk9YS55LXAueTtiZHg9Yi54LXAueDtiZHk9Yi55LXAueTtjZHg9Yy54LXAueDtjZHk9Yy55LXAueTthYmRldD1hZHgqYmR5LWJkeCphZHk7YmNkZXQ9YmR4KmNkeS1jZHgqYmR5O2NhZGV0PWNkeCphZHktYWR4KmNkeTthbGlmdD1hZHgqYWR4K2FkeSphZHk7YmxpZnQ9YmR4KmJkeCtiZHkqYmR5O2NsaWZ0PWNkeCpjZHgrY2R5KmNkeTtkaXNjPWFsaWZ0KmJjZGV0K2JsaWZ0KmNhZGV0K2NsaWZ0KmFiZGV0O3JldHVybiBkaXNjPjA7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybihiLngtYS54KSooYy55LWEueSktKGIueS1hLnkpKihjLngtYS54KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZVJvYnVzdD1mdW5jdGlvbihhLGIsYyxwKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlTm9ybWFsaXplZChhLGIsYyxwKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZUREU2xvdz1mdW5jdGlvbihhLGIsYyxwKXt2YXIgcHgscHksYXgsYXksYngsYnksY3gsY3ksYVRlcm0sYlRlcm0sY1Rlcm0scFRlcm0sc3VtLGlzSW5DaXJjbGU7cHg9anN0cy5tYXRoLkRELnZhbHVlT2YocC54KTtweT1qc3RzLm1hdGguREQudmFsdWVPZihwLnkpO2F4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGEueCk7YXk9anN0cy5tYXRoLkRELnZhbHVlT2YoYS55KTtieD1qc3RzLm1hdGguREQudmFsdWVPZihiLngpO2J5PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueSk7Y3g9anN0cy5tYXRoLkRELnZhbHVlT2YoYy54KTtjeT1qc3RzLm1hdGguREQudmFsdWVPZihjLnkpO2FUZXJtPShheC5tdWx0aXBseShheCkuYWRkKGF5Lm11bHRpcGx5KGF5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhieCxieSxjeCxjeSxweCxweSkpO2JUZXJtPShieC5tdWx0aXBseShieCkuYWRkKGJ5Lm11bHRpcGx5KGJ5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhheCxheSxjeCxjeSxweCxweSkpO2NUZXJtPShjeC5tdWx0aXBseShjeCkuYWRkKGN5Lm11bHRpcGx5KGN5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhheCxheSxieCxieSxweCxweSkpO3BUZXJtPShweC5tdWx0aXBseShweCkuYWRkKHB5Lm11bHRpcGx5KHB5KSkpLm11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYUREU2xvdyhheCxheSxieCxieSxjeCxjeSkpO3N1bT1hVGVybS5zdWJ0cmFjdChiVGVybSkuYWRkKGNUZXJtKS5zdWJ0cmFjdChwVGVybSk7aXNJbkNpcmNsZT1zdW0uZG91YmxlVmFsdWUoKT4wO3JldHVybiBpc0luQ2lyY2xlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93PWZ1bmN0aW9uKGF4LGF5LGJ4LGJ5LGN4LGN5KXtyZXR1cm4oYnguc3VidHJhY3QoYXgpLm11bHRpcGx5KGN5LnN1YnRyYWN0KGF5KSkuc3VidHJhY3QoYnkuc3VidHJhY3QoYXkpLm11bHRpcGx5KGN4LnN1YnRyYWN0KGF4KSkpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZURERmFzdD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgYVRlcm0sYlRlcm0sY1Rlcm0scFRlcm0sc3VtLGlzSW5DaXJjbGU7YVRlcm09KGpzdHMubWF0aC5ERC5zcXIoYS54KS5zZWxmQWRkKGpzdHMubWF0aC5ERC5zcXIoYS55KSkpLnNlbGZNdWx0aXBseShqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFEREZhc3QoYixjLHApKTtiVGVybT0oanN0cy5tYXRoLkRELnNxcihiLngpLnNlbGZBZGQoanN0cy5tYXRoLkRELnNxcihiLnkpKSkuc2VsZk11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdChhLGMscCkpO2NUZXJtPShqc3RzLm1hdGguREQuc3FyKGMueCkuc2VsZkFkZChqc3RzLm1hdGguREQuc3FyKGMueSkpKS5zZWxmTXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERGYXN0KGEsYixwKSk7cFRlcm09KGpzdHMubWF0aC5ERC5zcXIocC54KS5zZWxmQWRkKGpzdHMubWF0aC5ERC5zcXIocC55KSkpLnNlbGZNdWx0aXBseShqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFEREZhc3QoYSxiLGMpKTtzdW09YVRlcm0uc2VsZlN1YnRyYWN0KGJUZXJtKS5zZWxmQWRkKGNUZXJtKS5zZWxmU3VidHJhY3QocFRlcm0pO2lzSW5DaXJjbGU9c3VtLmRvdWJsZVZhbHVlKCk+MDtyZXR1cm4gaXNJbkNpcmNsZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdD1mdW5jdGlvbihhLGIsYyl7dmFyIHQxLHQyO3QxPWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueCkuc2VsZlN1YnRyYWN0KGEueCkuc2VsZk11bHRpcGx5KGpzdHMubWF0aC5ERC52YWx1ZU9mKGMueSkuc2VsZlN1YnRyYWN0KGEueSkpO3QyPWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueSkuc2VsU3VidHJhY3QoYS55KS5zZWxmTXVsdGlwbHkoanN0cy5tYXRoLkRELnZhbHVlT2YoYy54KS5zZWxmU3VidHJhY3QoYS54KSk7cmV0dXJuIHQxLnNlbGZTdWJ0cmFjdCh0Mik7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVERE5vcm1hbGl6ZWQ9ZnVuY3Rpb24oYSxiLGMscCl7dmFyIGFkeCxhZHksYmR4LGJkeSxjZHgsY2R5LGFiZGV0LGJjZGV0LGNhZGV0LGFsaWZ0LGJsaWZ0LGNsaWZ0LHN1bSxpc0luQ2lyY2xlO2FkeD1qc3RzLm1hdGguREQudmFsdWVPZihhLngpLnNlbGZTdWJ0cmFjdChwLngpO2FkeT1qc3RzLm1hdGguREQudmFsdWVPZihhLnkpLnNlbGZTdWJ0cmFjdChwLnkpO2JkeD1qc3RzLm1hdGguREQudmFsdWVPZihiLngpLnNlbGZTdWJ0cmFjdChwLngpO2JkeD1qc3RzLm1hdGguREQudmFsdWVPZihiLnkpLnNlbGZTdWJ0cmFjdChwLnkpO2NkeD1qc3RzLm1hdGguREQudmFsdWVPZihjLngpLnNlbGZTdWJ0cmFjdChwLngpO2NkeD1qc3RzLm1hdGguREQudmFsdWVPZihjLnkpLnNlbGZTdWJ0cmFjdChwLnkpO2FiZGV0PWFkeC5tdWx0aXBseShiZHkpLnNlbGZTdWJ0cmFjdChiZHgubXVsdGlwbHkoYWR5KSk7YmNkZXQ9YmR4Lm11bHRpcGx5KGNkeSkuc2VsZlN1YnRyYWN0KGNkeC5tdWx0aXBseShiZHkpKTtjYWRldD1jZHgubXVsdGlwbHkoYWR5KS5zZWxmU3VidHJhY3QoYWR4Lm11bHRpcGx5KGNkeSkpO2FsaWZ0PWFkeC5tdWx0aXBseShhZHgpLnNlbGZBZGQoYWR5Lm11bHRpcGx5KGFkeSkpO2JsaWZ0PWJkeC5tdWx0aXBseShiZHgpLnNlbGZBZGQoYmR5Lm11bHRpcGx5KGJkeSkpO2NsaWZ0PWNkeC5tdWx0aXBseShjZHgpLnNlbGZBZGQoY2R5Lm11bHRpcGx5KGNkeSkpO3N1bT1hbGlmdC5zZWxmTXVsdGlwbHkoYmNkZXQpLnNlbGZBZGQoYmxpZnQuc2VsZk11bHRpcGx5KGNhZGV0KSkuc2VsZkFkZChjbGlmdC5zZWxmTXVsdGlwbHkoYWJkZXQpKTtpc0luQ2lyY2xlPXN1bS5kb3VibGVWYWx1ZSgpPjA7cmV0dXJuIGlzSW5DaXJjbGU7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVDQz1mdW5jdGlvbihhLGIsYyxwKXt2YXIgY2MsY2NSYWRpdXMscFJhZGl1c0RpZmY7Y2M9anN0cy5nZW9tLlRyaWFuZ2xlLmNpcmN1bWNlbnRyZShhLGIsYyk7Y2NSYWRpdXM9YS5kaXN0YW5jZShjYyk7cFJhZGl1c0RpZmY9cC5kaXN0YW5jZShjYyktY2NSYWRpdXM7cmV0dXJuIHBSYWRpdXNEaWZmPD0wO307anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uPWZ1bmN0aW9uKHBvaW50R2VvbSxvdGhlckdlb20pe3RoaXMucG9pbnRHZW9tPXBvaW50R2VvbTt0aGlzLm90aGVyR2VvbT1vdGhlckdlb207dGhpcy5nZW9tRmFjdD1vdGhlckdlb20uZ2V0RmFjdG9yeSgpO307anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnVuaW9uPWZ1bmN0aW9uKHBvaW50R2VvbSxvdGhlckdlb20pe3ZhciB1bmlvbmVyPW5ldyBqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ocG9pbnRHZW9tLG90aGVyR2VvbSk7cmV0dXJuIHVuaW9uZXIudW5pb24oKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbi5wcm90b3R5cGUucG9pbnRHZW9tPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnByb3RvdHlwZS5vdGhlckdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ucHJvdG90eXBlLmdlb21GYWN0PW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbigpe3ZhciBsb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt2YXIgZXh0ZXJpb3JDb29yZHM9W107Zm9yKHZhciBpPTAsbD10aGlzLnBvaW50R2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aTxsO2krKyl7dmFyIHBvaW50PXRoaXMucG9pbnRHZW9tLmdldEdlb21ldHJ5TihpKTt2YXIgY29vcmQ9cG9pbnQuZ2V0Q29vcmRpbmF0ZSgpO3ZhciBsb2M9bG9jYXRvci5sb2NhdGUoY29vcmQsdGhpcy5vdGhlckdlb20pO2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUil7dmFyIGluY2x1ZGU9dHJ1ZTtmb3IodmFyIGo9ZXh0ZXJpb3JDb29yZHMubGVuZ3RoO2ktLTspe2lmKGV4dGVyaW9yQ29vcmRzW2pdLmVxdWFscyhjb29yZCkpe2luY2x1ZGU9ZmFsc2U7YnJlYWs7fX1cbmlmKGluY2x1ZGUpe2V4dGVyaW9yQ29vcmRzLnB1c2goY29vcmQpO319fVxuZXh0ZXJpb3JDb29yZHMuc29ydChmdW5jdGlvbih4LHkpe3JldHVybiB4LmNvbXBhcmVUbyh5KTt9KTtpZihleHRlcmlvckNvb3Jkcy5sZW5ndGg9PT0wKXtyZXR1cm4gdGhpcy5vdGhlckdlb207fVxudmFyIHB0Q29tcD1udWxsO3ZhciBjb29yZHM9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMudG9Db29yZGluYXRlQXJyYXkoZXh0ZXJpb3JDb29yZHMpO2lmKGNvb3Jkcy5sZW5ndGg9PT0xKXtwdENvbXA9dGhpcy5nZW9tRmFjdC5jcmVhdGVQb2ludChjb29yZHNbMF0pO31cbmVsc2V7cHRDb21wPXRoaXMuZ2VvbUZhY3QuY3JlYXRlTXVsdGlQb2ludChjb29yZHMpO31cbnJldHVybiBqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmUocHRDb21wLHRoaXMub3RoZXJHZW9tKTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyPWZ1bmN0aW9uKGxpKXt0aGlzLmxpPWxpO3RoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb25zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3RvcigpO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZS5pbnRlcmlvckludGVyc2VjdGlvbnM9bnVsbDtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGUuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEmJnNlZ0luZGV4MD09PXNlZ0luZGV4MSlcbnJldHVybjt2YXIgcDAwPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwXTt2YXIgcDAxPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwKzFdO3ZhciBwMTA9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDFdO3ZhciBwMTE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDErMV07dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwMCxwMDEscDEwLHAxMSk7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSl7aWYodGhpcy5saS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKCkpe2Zvcih2YXIgaW50SW5kZXg9MDtpbnRJbmRleDx0aGlzLmxpLmdldEludGVyc2VjdGlvbk51bSgpO2ludEluZGV4Kyspe3RoaXMuaW50ZXJpb3JJbnRlcnNlY3Rpb25zLmFkZCh0aGlzLmxpLmdldEludGVyc2VjdGlvbihpbnRJbmRleCkpO31cbmUwLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDAsMCk7ZTEuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MSwxKTt9fX07anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXI9ZnVuY3Rpb24ocG0pe3RoaXMucG09cG07dGhpcy5saT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7dGhpcy5saS5zZXRQcmVjaXNpb25Nb2RlbChwbSk7dGhpcy5zY2FsZUZhY3Rvcj1wbS5nZXRTY2FsZSgpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLk5vZGVyKCk7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyO2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLnBtPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5zY2FsZUZhY3Rvcj1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLm5vZGVyPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUucG9pbnRTbmFwcGVyPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUubm9kZWRTZWdTdHJpbmdzPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3ModGhpcy5ub2RlZFNlZ1N0cmluZ3MpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuY29tcHV0ZU5vZGVzPWZ1bmN0aW9uKGlucHV0U2VnbWVudFN0cmluZ3Mpe3RoaXMubm9kZWRTZWdTdHJpbmdzPWlucHV0U2VnbWVudFN0cmluZ3M7dGhpcy5ub2Rlcj1uZXcganN0cy5ub2RpbmcuTUNJbmRleE5vZGVyKCk7dGhpcy5wb2ludFNuYXBwZXI9bmV3IGpzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4UG9pbnRTbmFwcGVyKHRoaXMubm9kZXIuZ2V0SW5kZXgoKSk7dGhpcy5zbmFwUm91bmQoaW5wdXRTZWdtZW50U3RyaW5ncyx0aGlzLmxpKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLnNuYXBSb3VuZD1mdW5jdGlvbihzZWdTdHJpbmdzLGxpKXt2YXIgaW50ZXJzZWN0aW9ucz10aGlzLmZpbmRJbnRlcmlvckludGVyc2VjdGlvbnMoc2VnU3RyaW5ncyxsaSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uU25hcHMoaW50ZXJzZWN0aW9ucyk7dGhpcy5jb21wdXRlVmVydGV4U25hcHMoc2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5maW5kSW50ZXJpb3JJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKHNlZ1N0cmluZ3MsbGkpe3ZhciBpbnRGaW5kZXJBZGRlcj1uZXcganN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIobGkpO3RoaXMubm9kZXIuc2V0U2VnbWVudEludGVyc2VjdG9yKGludEZpbmRlckFkZGVyKTt0aGlzLm5vZGVyLmNvbXB1dGVOb2RlcyhzZWdTdHJpbmdzKTtyZXR1cm4gaW50RmluZGVyQWRkZXIuZ2V0SW50ZXJpb3JJbnRlcnNlY3Rpb25zKCk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uU25hcHM9ZnVuY3Rpb24oc25hcFB0cyl7Zm9yKHZhciBpdD1zbmFwUHRzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIHNuYXBQdD1pdC5uZXh0KCk7dmFyIGhvdFBpeGVsPW5ldyBqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwoc25hcFB0LHRoaXMuc2NhbGVGYWN0b3IsdGhpcy5saSk7dGhpcy5wb2ludFNuYXBwZXIuc25hcChob3RQaXhlbCk7fX07anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuY29tcHV0ZVZlcnRleFNuYXBzPWZ1bmN0aW9uKGVkZ2VzKXtpZihlZGdlcyBpbnN0YW5jZW9mIGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyl7dGhpcy5jb21wdXRlVmVydGV4U25hcHMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxuZm9yKHZhciBpMD1lZGdlcy5pdGVyYXRvcigpO2kwLmhhc05leHQoKTspe3ZhciBlZGdlMD1pMC5uZXh0KCk7dGhpcy5jb21wdXRlVmVydGV4U25hcHMoZWRnZTApO319O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLmNvbXB1dGVWZXJ0ZXhTbmFwczI9ZnVuY3Rpb24oZSl7dmFyIHB0czA9ZS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8cHRzMC5sZW5ndGgtMTtpKyspe3ZhciBob3RQaXhlbD1uZXcganN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsKHB0czBbaV0sdGhpcy5zY2FsZUZhY3Rvcix0aGlzLmxpKTt2YXIgaXNOb2RlQWRkZWQ9dGhpcy5wb2ludFNuYXBwZXIuc25hcChob3RQaXhlbCxlLGkpO2lmKGlzTm9kZUFkZGVkKXtlLmFkZEludGVyc2VjdGlvbihwdHMwW2ldLGkpO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlcj1mdW5jdGlvbihnZW9tR3JhcGgpe3RoaXMuZ2VvbUdyYXBoPWdlb21HcmFwaDt0aGlzLmdlb21ldHJ5RmFjdG9yeT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMuZGlzY29ubmVjdGVkUmluZ2Nvb3JkPW51bGw7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5maW5kRGlmZmVyZW50UG9pbnQ9ZnVuY3Rpb24oY29vcmQscHQpe3ZhciBpPTAsaWw9Y29vcmQubGVuZ3RoO2ZvcihpO2k8aWw7aSsrKXtpZighY29vcmRbaV0uZXF1YWxzKHB0KSlcbnJldHVybiBjb29yZFtpXTt9XG5yZXR1cm4gbnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzY29ubmVjdGVkUmluZ2Nvb3JkO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLmlzSW50ZXJpb3JzQ29ubmVjdGVkPWZ1bmN0aW9uKCl7dmFyIHNwbGl0RWRnZXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLmdlb21HcmFwaC5jb21wdXRlU3BsaXRFZGdlcyhzcGxpdEVkZ2VzKTt2YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoKG5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeSgpKTtncmFwaC5hZGRFZGdlcyhzcGxpdEVkZ2VzKTt0aGlzLnNldEludGVyaW9yRWRnZXNJblJlc3VsdChncmFwaCk7Z3JhcGgubGlua1Jlc3VsdERpcmVjdGVkRWRnZXMoKTt2YXIgZWRnZVJpbmdzPXRoaXMuYnVpbGRFZGdlUmluZ3MoZ3JhcGguZ2V0RWRnZUVuZHMoKSk7dGhpcy52aXNpdFNoZWxsSW50ZXJpb3JzKHRoaXMuZ2VvbUdyYXBoLmdldEdlb21ldHJ5KCksZ3JhcGgpO3JldHVybiF0aGlzLmhhc1VudmlzaXRlZFNoZWxsRWRnZShlZGdlUmluZ3MpO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLnNldEludGVyaW9yRWRnZXNJblJlc3VsdD1mdW5jdGlvbihncmFwaCl7dmFyIGl0PWdyYXBoLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKSxkZTt3aGlsZShpdC5oYXNOZXh0KCkpe2RlPWl0Lm5leHQoKTtpZihkZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpPT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe2RlLnNldEluUmVzdWx0KHRydWUpO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuYnVpbGRFZGdlUmluZ3M9ZnVuY3Rpb24oZGlyRWRnZXMpe3ZhciBlZGdlUmluZ3M9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGl0PWRpckVkZ2VzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtpZihkZS5pc0luUmVzdWx0KCkmJmRlLmdldEVkZ2VSaW5nKCk9PW51bGwpe3ZhciBlcj1uZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcoZGUsdGhpcy5nZW9tZXRyeUZhY3RvcnkpO2VyLmxpbmtEaXJlY3RlZEVkZ2VzRm9yTWluaW1hbEVkZ2VSaW5ncygpO3ZhciBtaW5FZGdlUmluZ3M9ZXIuYnVpbGRNaW5pbWFsUmluZ3MoKTt2YXIgaT0wLGlsPW1pbkVkZ2VSaW5ncy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe2VkZ2VSaW5ncy5hZGQobWluRWRnZVJpbmdzW2ldKTt9fX1cbnJldHVybiBlZGdlUmluZ3M7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUudmlzaXRTaGVsbEludGVyaW9ycz1mdW5jdGlvbihnLGdyYXBoKXtpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3ZhciBwPWc7dGhpcy52aXNpdEludGVyaW9yUmluZyhwLmdldEV4dGVyaW9yUmluZygpLGdyYXBoKTt9XG5pZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dmFyIG1wPWc7Zm9yKHZhciBpPTA7aTxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcD1tcC5nZXRHZW9tZXRyeU4oaSk7dGhpcy52aXNpdEludGVyaW9yUmluZyhwLmdldEV4dGVyaW9yUmluZygpLGdyYXBoKTt9fX07anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLnZpc2l0SW50ZXJpb3JSaW5nPWZ1bmN0aW9uKHJpbmcsZ3JhcGgpe3ZhciBwdHM9cmluZy5nZXRDb29yZGluYXRlcygpO3ZhciBwdDA9cHRzWzBdO3ZhciBwdDE9anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIuZmluZERpZmZlcmVudFBvaW50KHB0cyxwdDApO3ZhciBlPWdyYXBoLmZpbmRFZGdlSW5TYW1lRGlyZWN0aW9uKHB0MCxwdDEpO3ZhciBkZT1ncmFwaC5maW5kRWRnZUVuZChlKTt2YXIgaW50RGU9bnVsbDtpZihkZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpPT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe2ludERlPWRlO31lbHNlIGlmKGRlLmdldFN5bSgpLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7aW50RGU9ZGUuZ2V0U3ltKCk7fVxudGhpcy52aXNpdExpbmtlZERpcmVjdGVkRWRnZXMoaW50RGUpO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLnZpc2l0TGlua2VkRGlyZWN0ZWRFZGdlcz1mdW5jdGlvbihzdGFydCl7dmFyIHN0YXJ0RGU9c3RhcnQ7dmFyIGRlPXN0YXJ0O2Rve2RlLnNldFZpc2l0ZWQodHJ1ZSk7ZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9c3RhcnREZSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuaGFzVW52aXNpdGVkU2hlbGxFZGdlPWZ1bmN0aW9uKGVkZ2VSaW5ncyl7Zm9yKHZhciBpPTA7aTxlZGdlUmluZ3Muc2l6ZSgpO2krKyl7dmFyIGVyPWVkZ2VSaW5ncy5nZXQoaSk7aWYoZXIuaXNIb2xlKCkpe2NvbnRpbnVlO31cbnZhciBlZGdlcz1lci5nZXRFZGdlcygpO3ZhciBkZT1lZGdlc1swXTtpZihkZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpIT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe2NvbnRpbnVlO31cbmZvcih2YXIgaj0wO2o8ZWRnZXMubGVuZ3RoO2orKyl7ZGU9ZWRnZXNbal07aWYoIWRlLmlzVmlzaXRlZCgpKXtkaXNjb25uZWN0ZWRSaW5nY29vcmQ9ZGUuZ2V0Q29vcmRpbmF0ZSgpO3JldHVybiB0cnVlO319fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMuY2VudHJvaWQ7dGhpcy5taW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMuaW50ZXJpb3JQb2ludD1udWxsO3RoaXMuY2VudHJvaWQ9Z2VvbWV0cnkuZ2V0Q2VudHJvaWQoKS5nZXRDb29yZGluYXRlKCk7dGhpcy5hZGRJbnRlcmlvcihnZW9tZXRyeSk7aWYodGhpcy5pbnRlcmlvclBvaW50PT1udWxsKXt0aGlzLmFkZEVuZHBvaW50cyhnZW9tZXRyeSk7fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvclBvaW50O307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEludGVyaW9yPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmFkZEludGVyaW9yQ29vcmQoZ2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZXMoKSk7fWVsc2UgaWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb21ldHJ5LmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkSW50ZXJpb3IoZ2VvbWV0cnkuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEludGVyaW9yQ29vcmQ9ZnVuY3Rpb24ocHRzKXtmb3IodmFyIGk9MTtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkKHB0c1tpXSk7fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEVuZHBvaW50cz1mdW5jdGlvbihnZW9tZXRyeSl7aWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5hZGRFbmRwb2ludHNDb29yZChnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpKTt9ZWxzZSBpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbWV0cnkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGRFbmRwb2ludHMoZ2VvbWV0cnkuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUucHJvdG90eXBlLmFkZEVuZHBvaW50c0Nvb3JkPWZ1bmN0aW9uKHB0cyl7dGhpcy5hZGQocHRzWzBdKTt0aGlzLmFkZChwdHNbcHRzLmxlbmd0aC0xXSk7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHBvaW50KXt2YXIgZGlzdD1wb2ludC5kaXN0YW5jZSh0aGlzLmNlbnRyb2lkKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMuaW50ZXJpb3JQb2ludD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocG9pbnQpO3RoaXMubWluRGlzdGFuY2U9ZGlzdDt9fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb249ZnVuY3Rpb24oKXt0aGlzLnRlbXBFbnYxPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLnNlbGVjdGVkU2VnbWVudD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnRlbXBFbnYxPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluU2VsZWN0QWN0aW9uLnByb3RvdHlwZS5zZWxlY3RlZFNlZ21lbnQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnNlbGVjdD1mdW5jdGlvbihtYyxzdGFydCl7bWMuZ2V0TGluZVNlZ21lbnQoc3RhcnQsdGhpcy5zZWxlY3RlZFNlZ21lbnQpO3RoaXMuc2VsZWN0Mih0aGlzLnNlbGVjdGVkU2VnbWVudCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnNlbGVjdDI9ZnVuY3Rpb24oc2VnKXt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmc9ZnVuY3Rpb24ocmluZyl7dGhpcy5yaW5nPXJpbmc7dGhpcy50cmVlPW51bGw7dGhpcy5jcm9zc2luZ3M9MDt0aGlzLmludGVydmFsPW5ldyBqc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWwoKTt0aGlzLmJ1aWxkSW5kZXgoKTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcuTUNTZWxlY3Rlcj1mdW5jdGlvbihwLHBhcmVudCl7dGhpcy5wYXJlbnQ9cGFyZW50O3RoaXMucD1wO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluU2VsZWN0QWN0aW9uO2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcuTUNTZWxlY3Rlci5wcm90b3R5cGUuY29uc3RydWN0b3I9anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyO2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcuTUNTZWxlY3Rlci5wcm90b3R5cGUuc2VsZWN0Mj1mdW5jdGlvbihscyl7dGhpcy5wYXJlbnQudGVzdExpbmVTZWdtZW50LmFwcGx5KHRoaXMucGFyZW50LFt0aGlzLnAsbHNdKTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLmJ1aWxkSW5kZXg9ZnVuY3Rpb24oKXt0aGlzLnRyZWU9bmV3IGpzdHMuaW5kZXguYmludHJlZS5CaW50cmVlKCk7dmFyIHB0cz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyh0aGlzLnJpbmcuZ2V0Q29vcmRpbmF0ZXMoKSk7dmFyIG1jTGlzdD1qc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWlucyhwdHMpO2Zvcih2YXIgaT0wO2k8bWNMaXN0Lmxlbmd0aDtpKyspe3ZhciBtYz1tY0xpc3RbaV07dmFyIG1jRW52PW1jLmdldEVudmVsb3BlKCk7dGhpcy5pbnRlcnZhbC5taW49bWNFbnYuZ2V0TWluWSgpO3RoaXMuaW50ZXJ2YWwubWF4PW1jRW52LmdldE1heFkoKTt0aGlzLnRyZWUuaW5zZXJ0KHRoaXMuaW50ZXJ2YWwsbWMpO319O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLmlzSW5zaWRlPWZ1bmN0aW9uKHB0KXt0aGlzLmNyb3NzaW5ncz0wO3ZhciByYXlFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgtTnVtYmVyLk1BWF9WQUxVRSxOdW1iZXIuTUFYX1ZBTFVFLHB0LnkscHQueSk7dGhpcy5pbnRlcnZhbC5taW49cHQueTt0aGlzLmludGVydmFsLm1heD1wdC55O3ZhciBzZWdzPXRoaXMudHJlZS5xdWVyeSh0aGlzLmludGVydmFsKTt2YXIgbWNTZWxlY3Rlcj1uZXcganN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyKHB0LHRoaXMpO2Zvcih2YXIgaT1zZWdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbWM9aS5uZXh0KCk7dGhpcy50ZXN0TW9ub3RvbmVDaGFpbihyYXlFbnYsbWNTZWxlY3RlcixtYyk7fVxuaWYoKHRoaXMuY3Jvc3NpbmdzJTIpPT0xKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLnByb3RvdHlwZS50ZXN0TW9ub3RvbmVDaGFpbj1mdW5jdGlvbihyYXlFbnYsbWNTZWxlY3RlcixtYyl7bWMuc2VsZWN0KHJheUVudixtY1NlbGVjdGVyKTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLnRlc3RMaW5lU2VnbWVudD1mdW5jdGlvbihwLHNlZyl7dmFyIHhJbnQseDEseTEseDIseTIscDEscDI7cDE9c2VnLnAwO3AyPXNlZy5wMTt4MT1wMS54LXAueDt5MT1wMS55LXAueTt4Mj1wMi54LXAueDt5Mj1wMi55LXAueTtpZigoKHkxPjApJiYoeTI8PTApKXx8KCh5Mj4wKSYmKHkxPD0wKSkpe3hJbnQ9anN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQuc2lnbk9mRGV0MngyKHgxLHkxLHgyLHkyKS8oeTIteTEpO2lmKDAuMDx4SW50KXt0aGlzLmNyb3NzaW5ncysrO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcj1mdW5jdGlvbihlcnJvclR5cGUscHQpe3RoaXMuZXJyb3JUeXBlPWVycm9yVHlwZTt0aGlzLnB0PW51bGw7aWYocHQhPW51bGwpe3RoaXMucHQ9cHQuY2xvbmUoKTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5IT0xFX09VVFNJREVfU0hFTEw9Mjtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfSE9MRVM9Mztqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ESVNDT05ORUNURURfSU5URVJJT1I9NDtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5TRUxGX0lOVEVSU0VDVElPTj01O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlJJTkdfU0VMRl9JTlRFUlNFQ1RJT049Njtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfU0hFTExTPTc7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuRFVQTElDQVRFX1JJTkdTPTg7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuVE9PX0ZFV19QT0lOVFM9OTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5JTlZBTElEX0NPT1JESU5BVEU9MTA7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19OT1RfQ0xPU0VEPTExO2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5lcnJNc2c9WydUb3BvbG9neSBWYWxpZGF0aW9uIEVycm9yJywnUmVwZWF0ZWQgUG9pbnQnLCdIb2xlIGxpZXMgb3V0c2lkZSBzaGVsbCcsJ0hvbGVzIGFyZSBuZXN0ZWQnLCdJbnRlcmlvciBpcyBkaXNjb25uZWN0ZWQnLCdTZWxmLWludGVyc2VjdGlvbicsJ1JpbmcgU2VsZi1pbnRlcnNlY3Rpb24nLCdOZXN0ZWQgc2hlbGxzJywnRHVwbGljYXRlIFJpbmdzJywnVG9vIGZldyBkaXN0aW5jdCBwb2ludHMgaW4gZ2VvbWV0cnkgY29tcG9uZW50JywnSW52YWxpZCBDb29yZGluYXRlJywnUmluZyBpcyBub3QgY2xvc2VkJ107anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5nZXRFcnJvclR5cGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcnJvclR5cGU7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5wcm90b3R5cGUuZ2V0TWVzc2FnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVyck1zZ1t0aGlzLmVycm9yVHlwZV07fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgbG9jU3RyPScnO2lmKHRoaXMucHQhPW51bGwpe2xvY1N0cj0nIGF0IG9yIG5lYXIgcG9pbnQgJyt0aGlzLnB0O3JldHVybiB0aGlzLmdldE1lc3NhZ2UoKStsb2NTdHI7fVxucmV0dXJuIGxvY1N0cjt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS5NdWx0aVBvbHlnb249ZnVuY3Rpb24oZ2VvbWV0cmllcyxmYWN0b3J5KXt0aGlzLmdlb21ldHJpZXM9Z2VvbWV0cmllc3x8W107dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uTXVsdGlQb2x5Z29uLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbigpO2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24uY29uc3RydWN0b3I9anN0cy5nZW9tLk11bHRpUG9seWdvbjtqc3RzLmdlb20uTXVsdGlQb2x5Z29uLnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKG51bGwpO31cbnZhciBhbGxSaW5ncz1bXTtmb3IodmFyIGk9MDtpPHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXt2YXIgcG9seWdvbj10aGlzLmdlb21ldHJpZXNbaV07dmFyIHJpbmdzPXBvbHlnb24uZ2V0Qm91bmRhcnkoKTtmb3IodmFyIGo9MDtqPHJpbmdzLmdldE51bUdlb21ldHJpZXMoKTtqKyspe2FsbFJpbmdzLnB1c2gocmluZ3MuZ2V0R2VvbWV0cnlOKGopKTt9fVxucmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZU11bHRpTGluZVN0cmluZyhhbGxSaW5ncyk7fTtqc3RzLmdlb20uTXVsdGlQb2x5Z29uLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdC5jYWxsKHRoaXMsb3RoZXIsdG9sZXJhbmNlKTt9O2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24nO30pKCk7anN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcj1mdW5jdGlvbigpe307anN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIucHJvdG90eXBlLmlzRG9uZT1qc3RzLmFic3RyYWN0RnVuYztqc3RzLmdlb20uQ29vcmRpbmF0ZVNlcXVlbmNlRmlsdGVyLnByb3RvdHlwZS5pc0dlb21ldHJ5Q2hhbmdlZD1qc3RzLmFic3RyYWN0RnVuYzsoZnVuY3Rpb24oKXt2YXIgSW50ZXJ2YWw9ZnVuY3Rpb24oKXt0aGlzLm1pbj0wLjA7dGhpcy5tYXg9MC4wO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt2YXIgaW50ZXJ2YWw9YXJndW1lbnRzWzBdO3RoaXMuaW5pdChpbnRlcnZhbC5taW4saW50ZXJ2YWwubWF4KTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5pbml0KGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O0ludGVydmFsLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKG1pbixtYXgpe3RoaXMubWluPW1pbjt0aGlzLm1heD1tYXg7aWYobWluPm1heCl7dGhpcy5taW49bWF4O3RoaXMubWF4PW1pbjt9fTtJbnRlcnZhbC5wcm90b3R5cGUuZ2V0TWluPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWluO307SW50ZXJ2YWwucHJvdG90eXBlLmdldE1heD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heDt9O0ludGVydmFsLnByb3RvdHlwZS5nZXRXaWR0aD1mdW5jdGlvbigpe3JldHVybih0aGlzLm1heC10aGlzLm1pbik7fTtJbnRlcnZhbC5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlPWZ1bmN0aW9uKGludGVydmFsKXtpZihpbnRlcnZhbC5tYXg+dGhpcy5tYXgpe3RoaXMubWF4PWludGVydmFsLm1heDt9XG5pZihpbnRlcnZhbC5taW48dGhpcy5taW4pe3RoaXMubWluPWludGVydmFsLm1pbjt9fTtJbnRlcnZhbC5wcm90b3R5cGUub3ZlcmxhcHM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMub3ZlcmxhcHNJbnRlcnZhbC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7cmV0dXJuIHRoaXMub3ZlcmxhcHNNaW5NYXguYXBwbHkodGhpcyxhcmd1bWVudHMpO319O0ludGVydmFsLnByb3RvdHlwZS5vdmVybGFwc0ludGVydmFsPWZ1bmN0aW9uKGludGVydmFsKXtyZXR1cm4gdGhpcy5vdmVybGFwcyhpbnRlcnZhbC5taW4saW50ZXJ2YWwubWF4KTt9O0ludGVydmFsLnByb3RvdHlwZS5vdmVybGFwc01pbk1heD1mdW5jdGlvbihtaW4sbWF4KXtpZih0aGlzLm1pbj5tYXh8fHRoaXMubWF4PG1pbil7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307SW50ZXJ2YWwucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKCl7dmFyIGludGVydmFsO2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5pbmRleC5iaW50cmVlLkludGVydmFsKXtpbnRlcnZhbD1hcmd1bWVudHNbMF07cmV0dXJuIHRoaXMuY29udGFpbnNNaW5NYXgoaW50ZXJ2YWwubWluLGludGVydmFsLm1heCk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLmNvbnRhaW5zUG9pbnQoYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5jb250YWluc01pbk1heChhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtJbnRlcnZhbC5wcm90b3R5cGUuY29udGFpbnNNaW5NYXg9ZnVuY3Rpb24obWluLG1heCl7cmV0dXJuKG1pbj49dGhpcy5taW4mJm1heDw9dGhpcy5tYXgpO307SW50ZXJ2YWwucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCl7cmV0dXJuKHA+PXRoaXMubWluJiZwPD10aGlzLm1heCk7fTtqc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWw9SW50ZXJ2YWw7fSkoKTtqc3RzLmluZGV4LkRvdWJsZUJpdHM9ZnVuY3Rpb24oKXt9O2pzdHMuaW5kZXguRG91YmxlQml0cy5wb3dlck9mMj1mdW5jdGlvbihleHApe3JldHVybiBNYXRoLnBvdygyLGV4cCk7fTtqc3RzLmluZGV4LkRvdWJsZUJpdHMuZXhwb25lbnQ9ZnVuY3Rpb24oZCl7cmV0dXJuIGpzdHMuaW5kZXguRG91YmxlQml0cy5DVlRGV0QoNjQsZCktMTAyMzt9O2pzdHMuaW5kZXguRG91YmxlQml0cy5DVlRGV0Q9ZnVuY3Rpb24oTnVtVyxRdHkpe3ZhciBTaWduLEV4cG8sTWFudCxCaW4sbmIwMT0nJzt2YXIgSW5mPXszMjp7ZDoweDdGLGM6MHg4MCxiOjAsYTowfSw2NDp7ZDoweDdGRjAsYzowLGI6MCxhOjB9fTt2YXIgRXhXPXszMjo4LDY0OjExfVtOdW1XXSxNdFc9TnVtVy1FeFctMTtpZighQmluKXtTaWduPVF0eTwwfHwxL1F0eTwwO2lmKCFpc0Zpbml0ZShRdHkpKXtCaW49SW5mW051bVddO2lmKFNpZ24pe0Jpbi5kKz0xPDwoTnVtVy80LTEpO31cbkV4cG89TWF0aC5wb3coMixFeFcpLTE7TWFudD0wO319XG5pZighQmluKXtFeHBvPXszMjoxMjcsNjQ6MTAyM31bTnVtV107TWFudD1NYXRoLmFicyhRdHkpO3doaWxlKE1hbnQ+PTIpe0V4cG8rKztNYW50Lz0yO31cbndoaWxlKE1hbnQ8MSYmRXhwbz4wKXtFeHBvLS07TWFudCo9Mjt9XG5pZihFeHBvPD0wKXtNYW50Lz0yO25iMDE9J1plcm8gb3IgRGVub3JtYWwnO31cbmlmKE51bVc9PT0zMiYmRXhwbz4yNTQpe25iMDE9J1RvbyBiaWcgZm9yIFNpbmdsZSc7QmluPXtkOlNpZ24/MHhGRjoweDdGLGM6MHg4MCxiOjAsYTowfTtFeHBvPU1hdGgucG93KDIsRXhXKS0xO01hbnQ9MDt9fVxucmV0dXJuIEV4cG87fTsoZnVuY3Rpb24oKXt2YXIgRG91YmxlQml0cz1qc3RzLmluZGV4LkRvdWJsZUJpdHM7dmFyIEludGVydmFsPWpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbDt2YXIgS2V5PWZ1bmN0aW9uKGludGVydmFsKXt0aGlzLnB0PTAuMDt0aGlzLmxldmVsPTA7dGhpcy5jb21wdXRlS2V5KGludGVydmFsKTt9O0tleS5jb21wdXRlTGV2ZWw9ZnVuY3Rpb24oaW50ZXJ2YWwpe3ZhciBkeD1pbnRlcnZhbC5nZXRXaWR0aCgpLGxldmVsO2xldmVsPURvdWJsZUJpdHMuZXhwb25lbnQoZHgpKzE7cmV0dXJuIGxldmVsO307S2V5LnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307S2V5LnByb3RvdHlwZS5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxldmVsO307S2V5LnByb3RvdHlwZS5nZXRJbnRlcnZhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVydmFsO307S2V5LnByb3RvdHlwZS5jb21wdXRlS2V5PWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCl7dGhpcy5sZXZlbD1LZXkuY29tcHV0ZUxldmVsKGl0ZW1JbnRlcnZhbCk7dGhpcy5pbnRlcnZhbD1uZXcgSW50ZXJ2YWwoKTt0aGlzLmNvbXB1dGVJbnRlcnZhbCh0aGlzLmxldmVsLGl0ZW1JbnRlcnZhbCk7d2hpbGUoIXRoaXMuaW50ZXJ2YWwuY29udGFpbnMoaXRlbUludGVydmFsKSl7dGhpcy5sZXZlbCs9MTt0aGlzLmNvbXB1dGVJbnRlcnZhbCh0aGlzLmxldmVsLGl0ZW1JbnRlcnZhbCk7fX07S2V5LnByb3RvdHlwZS5jb21wdXRlSW50ZXJ2YWw9ZnVuY3Rpb24obGV2ZWwsaXRlbUludGVydmFsKXt2YXIgc2l6ZT1Eb3VibGVCaXRzLnBvd2VyT2YyKGxldmVsKTt0aGlzLnB0PU1hdGguZmxvb3IoaXRlbUludGVydmFsLmdldE1pbigpL3NpemUpKnNpemU7dGhpcy5pbnRlcnZhbC5pbml0KHRoaXMucHQsdGhpcy5wdCtzaXplKTt9O2pzdHMuaW5kZXguYmludHJlZS5LZXk9S2V5O30pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyPWZ1bmN0aW9uKHN1YmdyYXBocyl7dGhpcy5zdWJncmFwaHM9W107dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuc3ViZ3JhcGhzPXN1YmdyYXBoczt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuc3ViZ3JhcGhzPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLnByb3RvdHlwZS5zZWc9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLmdldERlcHRoPWZ1bmN0aW9uKHApe3ZhciBzdGFiYmVkU2VnbWVudHM9dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzKHApO2lmKHN0YWJiZWRTZWdtZW50cy5sZW5ndGg9PT0wKVxucmV0dXJuIDA7c3RhYmJlZFNlZ21lbnRzLnNvcnQoKTt2YXIgZHM9c3RhYmJlZFNlZ21lbnRzWzBdO3JldHVybiBkcy5sZWZ0RGVwdGg7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLmZpbmRTdGFiYmVkU2VnbWVudHM9ZnVuY3Rpb24oc3RhYmJpbmdSYXlMZWZ0UHQpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0zKXt0aGlzLmZpbmRTdGFiYmVkU2VnbWVudHMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIHN0YWJiZWRTZWdtZW50cz1bXTtmb3IodmFyIGk9MDtpPHRoaXMuc3ViZ3JhcGhzLmxlbmd0aDtpKyspe3ZhciBic2c9dGhpcy5zdWJncmFwaHNbaV07dmFyIGVudj1ic2cuZ2V0RW52ZWxvcGUoKTtpZihzdGFiYmluZ1JheUxlZnRQdC55PGVudi5nZXRNaW5ZKCl8fHN0YWJiaW5nUmF5TGVmdFB0Lnk+ZW52LmdldE1heFkoKSlcbmNvbnRpbnVlO3RoaXMuZmluZFN0YWJiZWRTZWdtZW50czIoc3RhYmJpbmdSYXlMZWZ0UHQsYnNnLmdldERpcmVjdGVkRWRnZXMoKSxzdGFiYmVkU2VnbWVudHMpO31cbnJldHVybiBzdGFiYmVkU2VnbWVudHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLmZpbmRTdGFiYmVkU2VnbWVudHMyPWZ1bmN0aW9uKHN0YWJiaW5nUmF5TGVmdFB0LGRpckVkZ2VzLHN0YWJiZWRTZWdtZW50cyl7aWYoYXJndW1lbnRzWzFdaW5zdGFuY2VvZiBqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2Upe3RoaXMuZmluZFN0YWJiZWRTZWdtZW50czMoc3RhYmJpbmdSYXlMZWZ0UHQsZGlyRWRnZXMsc3RhYmJlZFNlZ21lbnRzKTtyZXR1cm47fVxuZm9yKHZhciBpPWRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoIWRlLmlzRm9yd2FyZCgpKVxuY29udGludWU7dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzMyhzdGFiYmluZ1JheUxlZnRQdCxkZSxzdGFiYmVkU2VnbWVudHMpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZmluZFN0YWJiZWRTZWdtZW50czM9ZnVuY3Rpb24oc3RhYmJpbmdSYXlMZWZ0UHQsZGlyRWRnZSxzdGFiYmVkU2VnbWVudHMpe3ZhciBwdHM9ZGlyRWRnZS5nZXRFZGdlKCkuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuc2VnLnAwPXB0c1tpXTt0aGlzLnNlZy5wMT1wdHNbaSsxXTtpZih0aGlzLnNlZy5wMC55PnRoaXMuc2VnLnAxLnkpXG50aGlzLnNlZy5yZXZlcnNlKCk7dmFyIG1heHg9TWF0aC5tYXgodGhpcy5zZWcucDAueCx0aGlzLnNlZy5wMS54KTtpZihtYXh4PHN0YWJiaW5nUmF5TGVmdFB0LngpXG5jb250aW51ZTtpZih0aGlzLnNlZy5pc0hvcml6b250YWwoKSlcbmNvbnRpbnVlO2lmKHN0YWJiaW5nUmF5TGVmdFB0Lnk8dGhpcy5zZWcucDAueXx8c3RhYmJpbmdSYXlMZWZ0UHQueT50aGlzLnNlZy5wMS55KVxuY29udGludWU7aWYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbih0aGlzLnNlZy5wMCx0aGlzLnNlZy5wMSxzdGFiYmluZ1JheUxlZnRQdCk9PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuUklHSFQpXG5jb250aW51ZTt2YXIgZGVwdGg9ZGlyRWRnZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtpZighdGhpcy5zZWcucDAuZXF1YWxzKHB0c1tpXSkpXG5kZXB0aD1kaXJFZGdlLmdldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTt2YXIgZHM9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5EZXB0aFNlZ21lbnQodGhpcy5zZWcsZGVwdGgpO3N0YWJiZWRTZWdtZW50cy5wdXNoKGRzKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50PWZ1bmN0aW9uKHNlZyxkZXB0aCl7dGhpcy51cHdhcmRTZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChzZWcpO3RoaXMubGVmdERlcHRoPWRlcHRoO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudC5wcm90b3R5cGUudXB3YXJkU2VnPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudC5wcm90b3R5cGUubGVmdERlcHRoPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG9iail7dmFyIG90aGVyPW9iajt2YXIgb3JpZW50SW5kZXg9dGhpcy51cHdhcmRTZWcub3JpZW50YXRpb25JbmRleChvdGhlci51cHdhcmRTZWcpO2lmKG9yaWVudEluZGV4PT09MClcbm9yaWVudEluZGV4PS0xKm90aGVyLnVwd2FyZFNlZy5vcmllbnRhdGlvbkluZGV4KHVwd2FyZFNlZyk7aWYob3JpZW50SW5kZXghPT0wKVxucmV0dXJuIG9yaWVudEluZGV4O3JldHVybiB0aGlzLmNvbXBhcmVYKHRoaXMudXB3YXJkU2VnLG90aGVyLnVwd2FyZFNlZyk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS5jb21wYXJlWD1mdW5jdGlvbihzZWcwLHNlZzEpe3ZhciBjb21wYXJlMD1zZWcwLnAwLmNvbXBhcmVUbyhzZWcxLnAwKTtpZihjb21wYXJlMCE9PTApXG5yZXR1cm4gY29tcGFyZTA7cmV0dXJuIHNlZzAucDEuY29tcGFyZVRvKHNlZzEucDEpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsPWZ1bmN0aW9uKHB0LHNjYWxlRmFjdG9yLGxpKXt0aGlzLmNvcm5lcj1bXTt0aGlzLm9yaWdpbmFsUHQ9cHQ7dGhpcy5wdD1wdDt0aGlzLnNjYWxlRmFjdG9yPXNjYWxlRmFjdG9yO3RoaXMubGk9bGk7aWYodGhpcy5zY2FsZUZhY3RvciE9PTEuMCl7dGhpcy5wdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5zY2FsZShwdC54KSx0aGlzLnNjYWxlKHB0LnkpKTt0aGlzLnAwU2NhbGVkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMucDFTY2FsZWQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7fVxudGhpcy5pbml0Q29ybmVycyh0aGlzLnB0KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnB0PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5vcmlnaW5hbFB0PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5wdFNjYWxlZD1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUucDBTY2FsZWQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnAxU2NhbGVkPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5zY2FsZUZhY3Rvcj11bmRlZmluZWQ7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5taW54PXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm1heHg9dW5kZWZpbmVkO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUubWlueT11bmRlZmluZWQ7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5tYXh5PXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmNvcm5lcj1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuc2FmZUVudj1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9yaWdpbmFsUHQ7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwuU0FGRV9FTlZfRVhQQU5TSU9OX0ZBQ1RPUj0wLjc1O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuZ2V0U2FmZUVudmVsb3BlPWZ1bmN0aW9uKCl7aWYodGhpcy5zYWZlRW52PT09bnVsbCl7dmFyIHNhZmVUb2xlcmFuY2U9anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLlNBRkVfRU5WX0VYUEFOU0lPTl9GQUNUT1IvdGhpcy5zY2FsZUZhY3Rvcjt0aGlzLnNhZmVFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLm9yaWdpbmFsUHQueC1zYWZlVG9sZXJhbmNlLHRoaXMub3JpZ2luYWxQdC54K3NhZmVUb2xlcmFuY2UsdGhpcy5vcmlnaW5hbFB0Lnktc2FmZVRvbGVyYW5jZSx0aGlzLm9yaWdpbmFsUHQueStzYWZlVG9sZXJhbmNlKTt9XG5yZXR1cm4gdGhpcy5zYWZlRW52O307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbml0Q29ybmVycz1mdW5jdGlvbihwdCl7dmFyIHRvbGVyYW5jZT0wLjU7dGhpcy5taW54PXB0LngtdG9sZXJhbmNlO3RoaXMubWF4eD1wdC54K3RvbGVyYW5jZTt0aGlzLm1pbnk9cHQueS10b2xlcmFuY2U7dGhpcy5tYXh5PXB0LnkrdG9sZXJhbmNlO3RoaXMuY29ybmVyWzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLm1heHgsdGhpcy5tYXh5KTt0aGlzLmNvcm5lclsxXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5taW54LHRoaXMubWF4eSk7dGhpcy5jb3JuZXJbMl09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMubWlueCx0aGlzLm1pbnkpO3RoaXMuY29ybmVyWzNdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLm1heHgsdGhpcy5taW55KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24odmFsKXtyZXR1cm4gTWF0aC5yb3VuZCh2YWwqdGhpcy5zY2FsZUZhY3Rvcik7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24ocDAscDEpe2lmKHRoaXMuc2NhbGVGYWN0b3I9PT0xLjApXG5yZXR1cm4gdGhpcy5pbnRlcnNlY3RzU2NhbGVkKHAwLHAxKTt0aGlzLmNvcHlTY2FsZWQocDAsdGhpcy5wMFNjYWxlZCk7dGhpcy5jb3B5U2NhbGVkKHAxLHRoaXMucDFTY2FsZWQpO3JldHVybiB0aGlzLmludGVyc2VjdHNTY2FsZWQodGhpcy5wMFNjYWxlZCx0aGlzLnAxU2NhbGVkKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuY29weVNjYWxlZD1mdW5jdGlvbihwLHBTY2FsZWQpe3BTY2FsZWQueD10aGlzLnNjYWxlKHAueCk7cFNjYWxlZC55PXRoaXMuc2NhbGUocC55KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0c1NjYWxlZD1mdW5jdGlvbihwMCxwMSl7dmFyIHNlZ01pbng9TWF0aC5taW4ocDAueCxwMS54KTt2YXIgc2VnTWF4eD1NYXRoLm1heChwMC54LHAxLngpO3ZhciBzZWdNaW55PU1hdGgubWluKHAwLnkscDEueSk7dmFyIHNlZ01heHk9TWF0aC5tYXgocDAueSxwMS55KTt2YXIgaXNPdXRzaWRlUGl4ZWxFbnY9dGhpcy5tYXh4PHNlZ01pbnh8fHRoaXMubWlueD5zZWdNYXh4fHx0aGlzLm1heHk8c2VnTWlueXx8dGhpcy5taW55PnNlZ01heHk7aWYoaXNPdXRzaWRlUGl4ZWxFbnYpXG5yZXR1cm4gZmFsc2U7dmFyIGludGVyc2VjdHM9dGhpcy5pbnRlcnNlY3RzVG9sZXJhbmNlU3F1YXJlKHAwLHAxKTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGlzT3V0c2lkZVBpeGVsRW52JiZpbnRlcnNlY3RzKSwnRm91bmQgYmFkIGVudmVsb3BlIHRlc3QnKTtyZXR1cm4gaW50ZXJzZWN0czt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0c1RvbGVyYW5jZVNxdWFyZT1mdW5jdGlvbihwMCxwMSl7dmFyIGludGVyc2VjdHNMZWZ0PWZhbHNlO3ZhciBpbnRlcnNlY3RzQm90dG9tPWZhbHNlO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMCxwMSx0aGlzLmNvcm5lclswXSx0aGlzLmNvcm5lclsxXSk7aWYodGhpcy5saS5pc1Byb3BlcigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzFdLHRoaXMuY29ybmVyWzJdKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxuaW50ZXJzZWN0c0xlZnQ9dHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMl0sdGhpcy5jb3JuZXJbM10pO2lmKHRoaXMubGkuaXNQcm9wZXIoKSlcbnJldHVybiB0cnVlO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5pbnRlcnNlY3RzQm90dG9tPXRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzNdLHRoaXMuY29ybmVyWzBdKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpXG5yZXR1cm4gdHJ1ZTtpZihpbnRlcnNlY3RzTGVmdCYmaW50ZXJzZWN0c0JvdHRvbSlcbnJldHVybiB0cnVlO2lmKHAwLmVxdWFscyh0aGlzLnB0KSlcbnJldHVybiB0cnVlO2lmKHAxLmVxdWFscyh0aGlzLnB0KSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0c1BpeGVsQ2xvc3VyZT1mdW5jdGlvbihwMCxwMSl7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzBdLHRoaXMuY29ybmVyWzFdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzFdLHRoaXMuY29ybmVyWzJdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzJdLHRoaXMuY29ybmVyWzNdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzNdLHRoaXMuY29ybmVyWzBdKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5hZGRTbmFwcGVkTm9kZT1mdW5jdGlvbihzZWdTdHIsc2VnSW5kZXgpe3ZhciBwMD1zZWdTdHIuZ2V0Q29vcmRpbmF0ZShzZWdJbmRleCk7dmFyIHAxPXNlZ1N0ci5nZXRDb29yZGluYXRlKHNlZ0luZGV4KzEpO2lmKHRoaXMuaW50ZXJzZWN0cyhwMCxwMSkpe3NlZ1N0ci5hZGRJbnRlcnNlY3Rpb24odGhpcy5nZXRDb29yZGluYXRlKCksc2VnSW5kZXgpO3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyPWZ1bmN0aW9uKGlucHV0TGluZSl7dGhpcy5pbnB1dExpbmU9aW5wdXRMaW5lO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnk9ZnVuY3Rpb24oaW5wdXRMaW5lLGRpc3RhbmNlVG9sKXt2YXIgc2ltcD1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIoaW5wdXRMaW5lKTtyZXR1cm4gc2ltcC5zaW1wbGlmeShkaXN0YW5jZVRvbCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5JTklUPTA7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuREVMRVRFPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuS0VFUD0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pbnB1dExpbmU9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZGlzdGFuY2VUb2w9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNEZWxldGVkPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmFuZ2xlT3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0U7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKGRpc3RhbmNlVG9sKXt0aGlzLmRpc3RhbmNlVG9sPU1hdGguYWJzKGRpc3RhbmNlVG9sKTtpZihkaXN0YW5jZVRvbDwwKVxudGhpcy5hbmdsZU9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0U7dGhpcy5pc0RlbGV0ZWQ9W107dGhpcy5pc0RlbGV0ZWQubGVuZ3RoPXRoaXMuaW5wdXRMaW5lLmxlbmd0aDt2YXIgaXNDaGFuZ2VkPWZhbHNlO2Rve2lzQ2hhbmdlZD10aGlzLmRlbGV0ZVNoYWxsb3dDb25jYXZpdGllcygpO313aGlsZShpc0NoYW5nZWQpO3JldHVybiB0aGlzLmNvbGxhcHNlTGluZSgpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmRlbGV0ZVNoYWxsb3dDb25jYXZpdGllcz1mdW5jdGlvbigpe3ZhciBpbmRleD0xO3ZhciBtYXhJbmRleD10aGlzLmlucHV0TGluZS5sZW5ndGgtMTt2YXIgbWlkSW5kZXg9dGhpcy5maW5kTmV4dE5vbkRlbGV0ZWRJbmRleChpbmRleCk7dmFyIGxhc3RJbmRleD10aGlzLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4KG1pZEluZGV4KTt2YXIgaXNDaGFuZ2VkPWZhbHNlO3doaWxlKGxhc3RJbmRleDx0aGlzLmlucHV0TGluZS5sZW5ndGgpe3ZhciBpc01pZGRsZVZlcnRleERlbGV0ZWQ9ZmFsc2U7aWYodGhpcy5pc0RlbGV0YWJsZShpbmRleCxtaWRJbmRleCxsYXN0SW5kZXgsdGhpcy5kaXN0YW5jZVRvbCkpe3RoaXMuaXNEZWxldGVkW21pZEluZGV4XT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5ERUxFVEU7aXNNaWRkbGVWZXJ0ZXhEZWxldGVkPXRydWU7aXNDaGFuZ2VkPXRydWU7fVxuaWYoaXNNaWRkbGVWZXJ0ZXhEZWxldGVkKVxuaW5kZXg9bGFzdEluZGV4O2Vsc2VcbmluZGV4PW1pZEluZGV4O21pZEluZGV4PXRoaXMuZmluZE5leHROb25EZWxldGVkSW5kZXgoaW5kZXgpO2xhc3RJbmRleD10aGlzLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4KG1pZEluZGV4KTt9XG5yZXR1cm4gaXNDaGFuZ2VkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4PWZ1bmN0aW9uKGluZGV4KXt2YXIgbmV4dD1pbmRleCsxO3doaWxlKG5leHQ8dGhpcy5pbnB1dExpbmUubGVuZ3RoJiZ0aGlzLmlzRGVsZXRlZFtuZXh0XT09PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLkRFTEVURSlcbm5leHQrKztyZXR1cm4gbmV4dDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5jb2xsYXBzZUxpbmU9ZnVuY3Rpb24oKXt2YXIgY29vcmRMaXN0PVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5pbnB1dExpbmUubGVuZ3RoO2krKyl7aWYodGhpcy5pc0RlbGV0ZWRbaV0hPT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5ERUxFVEUpXG5jb29yZExpc3QucHVzaCh0aGlzLmlucHV0TGluZVtpXSk7fVxucmV0dXJuIGNvb3JkTGlzdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0RlbGV0YWJsZT1mdW5jdGlvbihpMCxpMSxpMixkaXN0YW5jZVRvbCl7dmFyIHAwPXRoaXMuaW5wdXRMaW5lW2kwXTt2YXIgcDE9dGhpcy5pbnB1dExpbmVbaTFdO3ZhciBwMj10aGlzLmlucHV0TGluZVtpMl07aWYoIXRoaXMuaXNDb25jYXZlKHAwLHAxLHAyKSlcbnJldHVybiBmYWxzZTtpZighdGhpcy5pc1NoYWxsb3cocDAscDEscDIsZGlzdGFuY2VUb2wpKVxucmV0dXJuIGZhbHNlO3JldHVybiB0aGlzLmlzU2hhbGxvd1NhbXBsZWQocDAscDEsaTAsaTIsZGlzdGFuY2VUb2wpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlzU2hhbGxvd0NvbmNhdml0eT1mdW5jdGlvbihwMCxwMSxwMixkaXN0YW5jZVRvbCl7dmFyIG9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24ocDAscDEscDIpO3ZhciBpc0FuZ2xlVG9TaW1wbGlmeT0ob3JpZW50YXRpb249PT10aGlzLmFuZ2xlT3JpZW50YXRpb24pO2lmKCFpc0FuZ2xlVG9TaW1wbGlmeSlcbnJldHVybiBmYWxzZTt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUocDEscDAscDIpO3JldHVybiBkaXN0PGRpc3RhbmNlVG9sO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuTlVNX1BUU19UT19DSEVDSz0xMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNTaGFsbG93U2FtcGxlZD1mdW5jdGlvbihwMCxwMixpMCxpMixkaXN0YW5jZVRvbCl7dmFyIGluYz1wYXJzZUludCgoaTItaTApL2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLk5VTV9QVFNfVE9fQ0hFQ0spO2lmKGluYzw9MClcbmluYz0xO2Zvcih2YXIgaT1pMDtpPGkyO2krPWluYyl7aWYoIXRoaXMuaXNTaGFsbG93KHAwLHAyLHRoaXMuaW5wdXRMaW5lW2ldLGRpc3RhbmNlVG9sKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc1NoYWxsb3c9ZnVuY3Rpb24ocDAscDEscDIsZGlzdGFuY2VUb2wpe3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShwMSxwMCxwMik7cmV0dXJuIGRpc3Q8ZGlzdGFuY2VUb2w7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNDb25jYXZlPWZ1bmN0aW9uKHAwLHAxLHAyKXt2YXIgb3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwMCxwMSxwMik7dmFyIGlzQ29uY2F2ZT0ob3JpZW50YXRpb249PT10aGlzLmFuZ2xlT3JpZW50YXRpb24pO3JldHVybiBpc0NvbmNhdmU7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudD1mdW5jdGlvbih4LG9iaixsYWJlbCl7aWYoIShvYmogaW5zdGFuY2VvZiBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudCkpe3RoaXMuZXZlbnRUeXBlPWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LklOU0VSVDt0aGlzLmxhYmVsPWxhYmVsO3RoaXMueFZhbHVlPXg7dGhpcy5vYmo9b2JqO3JldHVybjt9XG50aGlzLmV2ZW50VHlwZT1qc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5ERUxFVEU7dGhpcy54VmFsdWU9eDt0aGlzLmluc2VydEV2ZW50PW9iajt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LklOU0VSVD0xO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LkRFTEVURT0yO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5sYWJlbD1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS54VmFsdWU9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZXZlbnRUeXBlPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmluc2VydEV2ZW50PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmRlbGV0ZUV2ZW50SW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUub2JqPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmlzSW5zZXJ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXZlbnRUeXBlPT1qc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5JTlNFUlQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaXNEZWxldGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ldmVudFR5cGU9PWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LkRFTEVURTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5nZXRJbnNlcnRFdmVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmluc2VydEV2ZW50O307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmdldERlbGV0ZUV2ZW50SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZWxldGVFdmVudEluZGV4O307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLnNldERlbGV0ZUV2ZW50SW5kZXg9ZnVuY3Rpb24oZGVsZXRlRXZlbnRJbmRleCl7dGhpcy5kZWxldGVFdmVudEluZGV4PWRlbGV0ZUV2ZW50SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZ2V0T2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub2JqO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmlzU2FtZUxhYmVsPWZ1bmN0aW9uKGV2KXtpZih0aGlzLmxhYmVsPT1udWxsKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMubGFiZWw9PWV2LmxhYmVsO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihwZSl7aWYodGhpcy54VmFsdWU8cGUueFZhbHVlKXtyZXR1cm4tMTt9XG5pZih0aGlzLnhWYWx1ZT5wZS54VmFsdWUpe3JldHVybiAxO31cbmlmKHRoaXMuZXZlbnRUeXBlPHBlLmV2ZW50VHlwZSl7cmV0dXJuLTE7fVxuaWYodGhpcy5ldmVudFR5cGU+cGUuZXZlbnRUeXBlKXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdD1mdW5jdGlvbihjb29yZCxhbGxvd1JlcGVhdGVkKXt0aGlzLmFycmF5PVtdO2FsbG93UmVwZWF0ZWQ9KGFsbG93UmVwZWF0ZWQ9PT11bmRlZmluZWQpP3RydWU6YWxsb3dSZXBlYXRlZDtpZihjb29yZCE9PXVuZGVmaW5lZCl7dGhpcy5hZGQoY29vcmQsYWxsb3dSZXBlYXRlZCk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZT1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9bnVsbDtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLnJlbW92ZT1udWxsO2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLmFycmF5W2ldO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oaSxlKXt2YXIgbz10aGlzLmFycmF5W2ldO3RoaXMuYXJyYXlbaV09ZTtyZXR1cm4gbzt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFycmF5Lmxlbmd0aDt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtyZXR1cm4gdGhpcy5hZGRDb29yZGluYXRlcy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7cmV0dXJuIHRoaXMuYXJyYXkucHVzaChhcmd1bWVudHNbMF0pO319O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuYWRkQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmQsYWxsb3dSZXBlYXRlZCxkaXJlY3Rpb24pe2lmKGNvb3JkIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLmFkZENvb3JkaW5hdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO31lbHNlIGlmKHR5cGVvZiBjb29yZD09PSdudW1iZXInKXtyZXR1cm4gdGhpcy5pbnNlcnRDb29yZGluYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5kaXJlY3Rpb249ZGlyZWN0aW9ufHx0cnVlO2lmKGRpcmVjdGlvbil7Zm9yKHZhciBpPTA7aTxjb29yZC5sZW5ndGg7aSsrKXt0aGlzLmFkZENvb3JkaW5hdGUoY29vcmRbaV0sYWxsb3dSZXBlYXRlZCk7fX1lbHNle2Zvcih2YXIgaT1jb29yZC5sZW5ndGgtMTtpPj0wO2ktLSl7dGhpcy5hZGRDb29yZGluYXRlKGNvb3JkW2ldLGFsbG93UmVwZWF0ZWQpO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuYWRkQ29vcmRpbmF0ZT1mdW5jdGlvbihjb29yZCxhbGxvd1JlcGVhdGVkKXtpZighYWxsb3dSZXBlYXRlZCl7aWYodGhpcy5zaXplKCk+PTEpe3ZhciBsYXN0PXRoaXMuZ2V0KHRoaXMuc2l6ZSgpLTEpO2lmKGxhc3QuZXF1YWxzMkQoY29vcmQpKXJldHVybjt9fVxudGhpcy5hZGQoY29vcmQpO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5pbnNlcnRDb29yZGluYXRlPWZ1bmN0aW9uKGluZGV4LGNvb3JkLGFsbG93UmVwZWF0ZWQpe2lmKCFhbGxvd1JlcGVhdGVkKXt2YXIgYmVmb3JlPWluZGV4PjA/aW5kZXgtMTotMTtpZihiZWZvcmUhPT0tMSYmdGhpcy5nZXQoYmVmb3JlKS5lcXVhbHMyRChjb29yZCkpe3JldHVybjt9XG52YXIgYWZ0ZXI9aW5kZXg8dGhpcy5zaXplKCktMT9pbmRleCsxOi0xO2lmKGFmdGVyIT09LTEmJnRoaXMuZ2V0KGFmdGVyKS5lcXVhbHMyRChjb29yZCkpe3JldHVybjt9fVxudGhpcy5hcnJheS5zcGxpY2UoaW5kZXgsMCxjb29yZCk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLmNsb3NlUmluZz1mdW5jdGlvbigpe2lmKHRoaXMuc2l6ZSgpPjApe3RoaXMuYWRkQ29vcmRpbmF0ZShuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5nZXQoMCkpLGZhbHNlKTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcnJheTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUudG9Db29yZGluYXRlQXJyYXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcnJheTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yPWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsLGJ1ZlBhcmFtcyxkaXN0YW5jZSl7dGhpcy5zZWcwPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLnNlZzE9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMub2Zmc2V0MD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5vZmZzZXQxPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLnByZWNpc2lvbk1vZGVsPXByZWNpc2lvbk1vZGVsO3RoaXMuYnVmUGFyYW1zPWJ1ZlBhcmFtczt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLmZpbGxldEFuZ2xlUXVhbnR1bT1NYXRoLlBJLzIuMC9idWZQYXJhbXMuZ2V0UXVhZHJhbnRTZWdtZW50cygpO2lmKHRoaXMuYnVmUGFyYW1zLmdldFF1YWRyYW50U2VnbWVudHMoKT49OCYmdGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX1JPVU5EKXt0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3I9anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuTUFYX0NMT1NJTkdfU0VHX0xFTl9GQUNUT1I7fVxudGhpcy5pbml0KGRpc3RhbmNlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLk9GRlNFVF9TRUdNRU5UX1NFUEFSQVRJT05fRkFDVE9SPTEuMEUtMztqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5JTlNJREVfVFVSTl9WRVJURVhfU05BUF9ESVNUQU5DRV9GQUNUT1I9MS4wRS0zO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLkNVUlZFX1ZFUlRFWF9TTkFQX0RJU1RBTkNFX0ZBQ1RPUj0xLjBFLTY7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuTUFYX0NMT1NJTkdfU0VHX0xFTl9GQUNUT1I9ODA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLm1heEN1cnZlU2VnbWVudEVycm9yPTAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuZmlsbGV0QW5nbGVRdWFudHVtPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3I9MTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuc2VnTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5kaXN0YW5jZT0wLjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmJ1ZlBhcmFtcz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5saT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zMD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zMT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zMj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zZWcwPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnNlZzE9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUub2Zmc2V0MD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5vZmZzZXQxPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnNpZGU9MDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuaGFzTmFycm93Q29uY2F2ZUFuZ2xlPWZhbHNlO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5oYXNOYXJyb3dDb25jYXZlQW5nbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNOYXJyb3dDb25jYXZlQW5nbGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbihkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTt0aGlzLm1heEN1cnZlU2VnbWVudEVycm9yPXRoaXMuZGlzdGFuY2UqKDEtTWF0aC5jb3ModGhpcy5maWxsZXRBbmdsZVF1YW50dW0vMi4wKSk7dGhpcy5zZWdMaXN0PW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZygpO3RoaXMuc2VnTGlzdC5zZXRQcmVjaXNpb25Nb2RlbCh0aGlzLnByZWNpc2lvbk1vZGVsKTt0aGlzLnNlZ0xpc3Quc2V0TWluaW11bVZlcnRleERpc3RhbmNlKHRoaXMuZGlzdGFuY2UqanN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuQ1VSVkVfVkVSVEVYX1NOQVBfRElTVEFOQ0VfRkFDVE9SKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5pbml0U2lkZVNlZ21lbnRzPWZ1bmN0aW9uKHMxLHMyLHNpZGUpe3RoaXMuczE9czE7dGhpcy5zMj1zMjt0aGlzLnNpZGU9c2lkZTt0aGlzLnNlZzEuc2V0Q29vcmRpbmF0ZXModGhpcy5zMSx0aGlzLnMyKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHRoaXMuc2VnMSx0aGlzLnNpZGUsdGhpcy5kaXN0YW5jZSx0aGlzLm9mZnNldDEpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VnTGlzdC5nZXRDb29yZGluYXRlcygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNsb3NlUmluZz1mdW5jdGlvbigpe3RoaXMuc2VnTGlzdC5jbG9zZVJpbmcoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRTZWdtZW50cz1mdW5jdGlvbihwdCxpc0ZvcndhcmQpe3RoaXMuc2VnTGlzdC5hZGRQdHMocHQsaXNGb3J3YXJkKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRGaXJzdFNlZ21lbnQ9ZnVuY3Rpb24oKXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQxLnAwKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRMYXN0U2VnbWVudD1mdW5jdGlvbigpe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDEpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZE5leHRTZWdtZW50PWZ1bmN0aW9uKHAsYWRkU3RhcnRQb2ludCl7dGhpcy5zMD10aGlzLnMxO3RoaXMuczE9dGhpcy5zMjt0aGlzLnMyPXA7dGhpcy5zZWcwLnNldENvb3JkaW5hdGVzKHRoaXMuczAsdGhpcy5zMSk7dGhpcy5jb21wdXRlT2Zmc2V0U2VnbWVudCh0aGlzLnNlZzAsdGhpcy5zaWRlLHRoaXMuZGlzdGFuY2UsdGhpcy5vZmZzZXQwKTt0aGlzLnNlZzEuc2V0Q29vcmRpbmF0ZXModGhpcy5zMSx0aGlzLnMyKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHRoaXMuc2VnMSx0aGlzLnNpZGUsdGhpcy5kaXN0YW5jZSx0aGlzLm9mZnNldDEpO2lmKHRoaXMuczEuZXF1YWxzKHRoaXMuczIpKVxucmV0dXJuO3ZhciBvcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHRoaXMuczAsdGhpcy5zMSx0aGlzLnMyKTt2YXIgb3V0c2lkZVR1cm49KG9yaWVudGF0aW9uPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRSYmdGhpcy5zaWRlPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCl8fChvcmllbnRhdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFJiZ0aGlzLnNpZGU9PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk7aWYob3JpZW50YXRpb249PTApe3RoaXMuYWRkQ29sbGluZWFyKGFkZFN0YXJ0UG9pbnQpO31lbHNlIGlmKG91dHNpZGVUdXJuKXt0aGlzLmFkZE91dHNpZGVUdXJuKG9yaWVudGF0aW9uLGFkZFN0YXJ0UG9pbnQpO31lbHNle3RoaXMuYWRkSW5zaWRlVHVybihvcmllbnRhdGlvbixhZGRTdGFydFBvaW50KTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkQ29sbGluZWFyPWZ1bmN0aW9uKGFkZFN0YXJ0UG9pbnQpe3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbih0aGlzLnMwLHRoaXMuczEsdGhpcy5zMSx0aGlzLnMyKTt2YXIgbnVtSW50PXRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk7aWYobnVtSW50Pj0yKXtpZih0aGlzLmJ1ZlBhcmFtcy5nZXRKb2luU3R5bGUoKT09PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fQkVWRUx8fHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9NSVRSRSl7aWYoYWRkU3RhcnRQb2ludClcbnRoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDApO31lbHNle3RoaXMuYWRkRmlsbGV0KHRoaXMuczEsdGhpcy5vZmZzZXQwLnAxLHRoaXMub2Zmc2V0MS5wMCxqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFLHRoaXMuZGlzdGFuY2UpO319fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkT3V0c2lkZVR1cm49ZnVuY3Rpb24ob3JpZW50YXRpb24sYWRkU3RhcnRQb2ludCl7aWYodGhpcy5vZmZzZXQwLnAxLmRpc3RhbmNlKHRoaXMub2Zmc2V0MS5wMCk8dGhpcy5kaXN0YW5jZSpqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5PRkZTRVRfU0VHTUVOVF9TRVBBUkFUSU9OX0ZBQ1RPUil7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7cmV0dXJuO31cbmlmKHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9NSVRSRSl7dGhpcy5hZGRNaXRyZUpvaW4odGhpcy5zMSx0aGlzLm9mZnNldDAsdGhpcy5vZmZzZXQxLHRoaXMuZGlzdGFuY2UpO31lbHNlIGlmKHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9CRVZFTCl7dGhpcy5hZGRCZXZlbEpvaW4odGhpcy5vZmZzZXQwLHRoaXMub2Zmc2V0MSk7fWVsc2V7aWYoYWRkU3RhcnRQb2ludClcbnRoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO3RoaXMuYWRkRmlsbGV0KHRoaXMuczEsdGhpcy5vZmZzZXQwLnAxLHRoaXMub2Zmc2V0MS5wMCxvcmllbnRhdGlvbix0aGlzLmRpc3RhbmNlKTt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQxLnAwKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkSW5zaWRlVHVybj1mdW5jdGlvbihvcmllbnRhdGlvbixhZGRTdGFydFBvaW50KXt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24odGhpcy5vZmZzZXQwLnAwLHRoaXMub2Zmc2V0MC5wMSx0aGlzLm9mZnNldDEucDAsdGhpcy5vZmZzZXQxLnAxKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5saS5nZXRJbnRlcnNlY3Rpb24oMCkpO31lbHNle3RoaXMuaGFzTmFycm93Q29uY2F2ZUFuZ2xlPXRydWU7aWYodGhpcy5vZmZzZXQwLnAxLmRpc3RhbmNlKHRoaXMub2Zmc2V0MS5wMCk8dGhpcy5kaXN0YW5jZSpqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5JTlNJREVfVFVSTl9WRVJURVhfU05BUF9ESVNUQU5DRV9GQUNUT1Ipe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO31lbHNle3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDAucDEpO2lmKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcj4wKXt2YXIgbWlkMD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDAucDEueCt0aGlzLnMxLngpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSksKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDAucDEueSt0aGlzLnMxLnkpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSkpO3RoaXMuc2VnTGlzdC5hZGRQdChtaWQwKTt2YXIgbWlkMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDEucDAueCt0aGlzLnMxLngpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSksKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcip0aGlzLm9mZnNldDEucDAueSt0aGlzLnMxLnkpLyh0aGlzLmNsb3NpbmdTZWdMZW5ndGhGYWN0b3IrMSkpO3RoaXMuc2VnTGlzdC5hZGRQdChtaWQxKTt9ZWxzZXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5zMSk7fVxudGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MS5wMCk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5jb21wdXRlT2Zmc2V0U2VnbWVudD1mdW5jdGlvbihzZWcsc2lkZSxkaXN0YW5jZSxvZmZzZXQpe3ZhciBzaWRlU2lnbj1zaWRlPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVD8xOi0xO3ZhciBkeD1zZWcucDEueC1zZWcucDAueDt2YXIgZHk9c2VnLnAxLnktc2VnLnAwLnk7dmFyIGxlbj1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO3ZhciB1eD1zaWRlU2lnbipkaXN0YW5jZSpkeC9sZW47dmFyIHV5PXNpZGVTaWduKmRpc3RhbmNlKmR5L2xlbjtvZmZzZXQucDAueD1zZWcucDAueC11eTtvZmZzZXQucDAueT1zZWcucDAueSt1eDtvZmZzZXQucDEueD1zZWcucDEueC11eTtvZmZzZXQucDEueT1zZWcucDEueSt1eDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRMaW5lRW5kQ2FwPWZ1bmN0aW9uKHAwLHAxKXt2YXIgc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQocDAscDEpO3ZhciBvZmZzZXRMPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHNlZyxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZULHRoaXMuZGlzdGFuY2Usb2Zmc2V0TCk7dmFyIG9mZnNldFI9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQoc2VnLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hULHRoaXMuZGlzdGFuY2Usb2Zmc2V0Uik7dmFyIGR4PXAxLngtcDAueDt2YXIgZHk9cDEueS1wMC55O3ZhciBhbmdsZT1NYXRoLmF0YW4yKGR5LGR4KTtzd2l0Y2godGhpcy5idWZQYXJhbXMuZ2V0RW5kQ2FwU3R5bGUoKSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfUk9VTkQ6dGhpcy5zZWdMaXN0LmFkZFB0KG9mZnNldEwucDEpO3RoaXMuYWRkRmlsbGV0KHAxLGFuZ2xlK01hdGguUEkvMixhbmdsZS1NYXRoLlBJLzIsanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRSx0aGlzLmRpc3RhbmNlKTt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0Ui5wMSk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfRkxBVDp0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0TC5wMSk7dGhpcy5zZWdMaXN0LmFkZFB0KG9mZnNldFIucDEpO2JyZWFrO2Nhc2UganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX1NRVUFSRTp2YXIgc3F1YXJlQ2FwU2lkZU9mZnNldD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtzcXVhcmVDYXBTaWRlT2Zmc2V0Lng9TWF0aC5hYnModGhpcy5kaXN0YW5jZSkqTWF0aC5jb3MoYW5nbGUpO3NxdWFyZUNhcFNpZGVPZmZzZXQueT1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKSpNYXRoLnNpbihhbmdsZSk7dmFyIHNxdWFyZUNhcExPZmZzZXQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKG9mZnNldEwucDEueCtcbnNxdWFyZUNhcFNpZGVPZmZzZXQueCxvZmZzZXRMLnAxLnkrc3F1YXJlQ2FwU2lkZU9mZnNldC55KTt2YXIgc3F1YXJlQ2FwUk9mZnNldD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUob2Zmc2V0Ui5wMS54K1xuc3F1YXJlQ2FwU2lkZU9mZnNldC54LG9mZnNldFIucDEueStzcXVhcmVDYXBTaWRlT2Zmc2V0LnkpO3RoaXMuc2VnTGlzdC5hZGRQdChzcXVhcmVDYXBMT2Zmc2V0KTt0aGlzLnNlZ0xpc3QuYWRkUHQoc3F1YXJlQ2FwUk9mZnNldCk7YnJlYWs7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZE1pdHJlSm9pbj1mdW5jdGlvbihwLG9mZnNldDAsb2Zmc2V0MSxkaXN0YW5jZSl7dmFyIGlzTWl0cmVXaXRoaW5MaW1pdD10cnVlO3ZhciBpbnRQdD1udWxsO3RyeXtpbnRQdD1qc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5pbnRlcnNlY3Rpb24ob2Zmc2V0MC5wMCxvZmZzZXQwLnAxLG9mZnNldDEucDAsb2Zmc2V0MS5wMSk7dmFyIG1pdHJlUmF0aW89ZGlzdGFuY2U8PTAuMD8xLjA6aW50UHQuZGlzdGFuY2UocCkvTWF0aC5hYnMoZGlzdGFuY2UpO2lmKG1pdHJlUmF0aW8+dGhpcy5idWZQYXJhbXMuZ2V0TWl0cmVMaW1pdCgpKVxudGhpcy5pc01pdHJlV2l0aGluTGltaXQ9ZmFsc2U7fWNhdGNoKGUpe2lmKGUgaW5zdGFuY2VvZiBqc3RzLmVycm9yLk5vdFJlcHJlc2VudGFibGVFcnJvcil7aW50UHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKDAsMCk7dGhpcy5pc01pdHJlV2l0aGluTGltaXQ9ZmFsc2U7fX1cbmlmKGlzTWl0cmVXaXRoaW5MaW1pdCl7dGhpcy5zZWdMaXN0LmFkZFB0KGludFB0KTt9ZWxzZXt0aGlzLmFkZExpbWl0ZWRNaXRyZUpvaW4ob2Zmc2V0MCxvZmZzZXQxLGRpc3RhbmNlLGJ1ZlBhcmFtcy5nZXRNaXRyZUxpbWl0KCkpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRMaW1pdGVkTWl0cmVKb2luPWZ1bmN0aW9uKG9mZnNldDAsb2Zmc2V0MSxkaXN0YW5jZSxtaXRyZUxpbWl0KXt2YXIgYmFzZVB0PXRoaXMuc2VnMC5wMTt2YXIgYW5nMD1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZShiYXNlUHQsdGhpcy5zZWcwLnAwKTt2YXIgYW5nMT1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZShiYXNlUHQsdGhpcy5zZWcxLnAxKTt2YXIgYW5nRGlmZj1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW5PcmllbnRlZCh0aGlzLnNlZzAucDAsYmFzZVB0LHRoaXMuc2VnMS5wMSk7dmFyIGFuZ0RpZmZIYWxmPWFuZ0RpZmYvMjt2YXIgbWlkQW5nPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLm5vcm1hbGl6ZShhbmcwK2FuZ0RpZmZIYWxmKTt2YXIgbWl0cmVNaWRBbmc9anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplKG1pZEFuZytNYXRoLlBJKTt2YXIgbWl0cmVEaXN0PW1pdHJlTGltaXQqZGlzdGFuY2U7dmFyIGJldmVsRGVsdGE9bWl0cmVEaXN0Kk1hdGguYWJzKE1hdGguc2luKGFuZ0RpZmZIYWxmKSk7dmFyIGJldmVsSGFsZkxlbj1kaXN0YW5jZS1iZXZlbERlbHRhO3ZhciBiZXZlbE1pZFg9YmFzZVB0LngrbWl0cmVEaXN0Kk1hdGguY29zKG1pdHJlTWlkQW5nKTt2YXIgYmV2ZWxNaWRZPWJhc2VQdC55K21pdHJlRGlzdCpNYXRoLnNpbihtaXRyZU1pZEFuZyk7dmFyIGJldmVsTWlkUHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGJldmVsTWlkWCxiZXZlbE1pZFkpO3ZhciBtaXRyZU1pZExpbmU9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChiYXNlUHQsYmV2ZWxNaWRQdCk7dmFyIGJldmVsRW5kTGVmdD1taXRyZU1pZExpbmUucG9pbnRBbG9uZ09mZnNldCgxLjAsYmV2ZWxIYWxmTGVuKTt2YXIgYmV2ZWxFbmRSaWdodD1taXRyZU1pZExpbmUucG9pbnRBbG9uZ09mZnNldCgxLjAsLWJldmVsSGFsZkxlbik7aWYodGhpcy5zaWRlPT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKXt0aGlzLnNlZ0xpc3QuYWRkUHQoYmV2ZWxFbmRMZWZ0KTt0aGlzLnNlZ0xpc3QuYWRkUHQoYmV2ZWxFbmRSaWdodCk7fWVsc2V7dGhpcy5zZWdMaXN0LmFkZFB0KGJldmVsRW5kUmlnaHQpO3RoaXMuc2VnTGlzdC5hZGRQdChiZXZlbEVuZExlZnQpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRCZXZlbEpvaW49ZnVuY3Rpb24ob2Zmc2V0MCxvZmZzZXQxKXt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0MC5wMSk7dGhpcy5zZWdMaXN0LmFkZFB0KG9mZnNldDEucDApO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEZpbGxldD1mdW5jdGlvbihwLHAwLHAxLGRpcmVjdGlvbixyYWRpdXMpe2lmKCEocDEgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSkpe3RoaXMuYWRkRmlsbGV0Mi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBkeDA9cDAueC1wLng7dmFyIGR5MD1wMC55LXAueTt2YXIgc3RhcnRBbmdsZT1NYXRoLmF0YW4yKGR5MCxkeDApO3ZhciBkeDE9cDEueC1wLng7dmFyIGR5MT1wMS55LXAueTt2YXIgZW5kQW5nbGU9TWF0aC5hdGFuMihkeTEsZHgxKTtpZihkaXJlY3Rpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFKXtpZihzdGFydEFuZ2xlPD1lbmRBbmdsZSlcbnN0YXJ0QW5nbGUrPTIuMCpNYXRoLlBJO31lbHNle2lmKHN0YXJ0QW5nbGU+PWVuZEFuZ2xlKVxuc3RhcnRBbmdsZS09Mi4wKk1hdGguUEk7fVxudGhpcy5zZWdMaXN0LmFkZFB0KHAwKTt0aGlzLmFkZEZpbGxldChwLHN0YXJ0QW5nbGUsZW5kQW5nbGUsZGlyZWN0aW9uLHJhZGl1cyk7dGhpcy5zZWdMaXN0LmFkZFB0KHAxKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRGaWxsZXQyPWZ1bmN0aW9uKHAsc3RhcnRBbmdsZSxlbmRBbmdsZSxkaXJlY3Rpb24scmFkaXVzKXt2YXIgZGlyZWN0aW9uRmFjdG9yPWRpcmVjdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0U/LTE6MTt2YXIgdG90YWxBbmdsZT1NYXRoLmFicyhzdGFydEFuZ2xlLWVuZEFuZ2xlKTt2YXIgblNlZ3M9cGFyc2VJbnQoKHRvdGFsQW5nbGUvdGhpcy5maWxsZXRBbmdsZVF1YW50dW0rMC41KSk7aWYoblNlZ3M8MSlcbnJldHVybjt2YXIgaW5pdEFuZ2xlLGN1cnJBbmdsZUluYztpbml0QW5nbGU9MC4wO2N1cnJBbmdsZUluYz10b3RhbEFuZ2xlL25TZWdzO3ZhciBjdXJyQW5nbGU9aW5pdEFuZ2xlO3ZhciBwdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt3aGlsZShjdXJyQW5nbGU8dG90YWxBbmdsZSl7dmFyIGFuZ2xlPXN0YXJ0QW5nbGUrZGlyZWN0aW9uRmFjdG9yKmN1cnJBbmdsZTtwdC54PXAueCtyYWRpdXMqTWF0aC5jb3MoYW5nbGUpO3B0Lnk9cC55K3JhZGl1cypNYXRoLnNpbihhbmdsZSk7dGhpcy5zZWdMaXN0LmFkZFB0KHB0KTtjdXJyQW5nbGUrPWN1cnJBbmdsZUluYzt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuY3JlYXRlQ2lyY2xlPWZ1bmN0aW9uKHApe3ZhciBwdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocC54K3RoaXMuZGlzdGFuY2UscC55KTt0aGlzLnNlZ0xpc3QuYWRkUHQocHQpO3RoaXMuYWRkRmlsbGV0KHAsMC4wLDIuMCpNYXRoLlBJLC0xLHRoaXMuZGlzdGFuY2UpO3RoaXMuc2VnTGlzdC5jbG9zZVJpbmcoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5jcmVhdGVTcXVhcmU9ZnVuY3Rpb24ocCl7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngrZGlzdGFuY2UscC55K2Rpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngrZGlzdGFuY2UscC55LWRpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngtZGlzdGFuY2UscC55LWRpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngtZGlzdGFuY2UscC55K2Rpc3RhbmNlKSk7dGhpcy5zZWdMaXN0LmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmc9ZnVuY3Rpb24oc3RhcnQsZ2VvbWV0cnlGYWN0b3J5KXtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5jYWxsKHRoaXMsc3RhcnQsZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZVJpbmcoKTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZy5jb25zdHJ1Y3Rvcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZztqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZy5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbihkZSlcbntyZXR1cm4gZGUuZ2V0TmV4dCgpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGRlLGVyKVxue2RlLnNldEVkZ2VSaW5nKGVyKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5saW5rRGlyZWN0ZWRFZGdlc0Zvck1pbmltYWxFZGdlUmluZ3M9ZnVuY3Rpb24oKVxue3ZhciBkZT10aGlzLnN0YXJ0RGU7ZG97dmFyIG5vZGU9ZGUuZ2V0Tm9kZSgpO25vZGUuZ2V0RWRnZXMoKS5saW5rTWluaW1hbERpcmVjdGVkRWRnZXModGhpcyk7ZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9dGhpcy5zdGFydERlKTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5idWlsZE1pbmltYWxSaW5ncz1mdW5jdGlvbigpXG57dmFyIG1pbkVkZ2VSaW5ncz1bXTt2YXIgZGU9dGhpcy5zdGFydERlO2Rve2lmKGRlLmdldE1pbkVkZ2VSaW5nKCk9PT1udWxsKXt2YXIgbWluRXI9bmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nKGRlLHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTttaW5FZGdlUmluZ3MucHVzaChtaW5Fcik7fVxuZGU9ZGUuZ2V0TmV4dCgpO313aGlsZShkZSE9dGhpcy5zdGFydERlKTtyZXR1cm4gbWluRWRnZVJpbmdzO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludD1mdW5jdGlvbigpe3RoaXMuY2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLnB0Q291bnQ9MDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50LnByb3RvdHlwZS5jZW50U3VtPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuYWRkMihnZW9tLmdldENvb3JkaW5hdGUoKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb258fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt2YXIgZ2M9Z2VvbTtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdjLmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24ocHQpe3RoaXMucHRDb3VudCs9MTt0aGlzLmNlbnRTdW0ueCs9cHQueDt0aGlzLmNlbnRTdW0ueSs9cHQueTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7dmFyIGNlbnQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7Y2VudC54PXRoaXMuY2VudFN1bS54L3RoaXMucHRDb3VudDtjZW50Lnk9dGhpcy5jZW50U3VtLnkvdGhpcy5wdENvdW50O3JldHVybiBjZW50O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyPWZ1bmN0aW9uKGxvY2F0aW9ucyl7dGhpcy5sb2NhdGlvbnM9bG9jYXRpb25zO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyKCk7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyLnByb3RvdHlwZS5sb2NhdGlvbnM9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIuZ2V0TG9jYXRpb25zPWZ1bmN0aW9uKGdlb20pe3ZhciBsb2NhdGlvbnM9W107Z2VvbS5hcHBseShuZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyKGxvY2F0aW9ucykpO3JldHVybiBsb2NhdGlvbnM7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMubG9jYXRpb25zLnB1c2gobmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24oZ2VvbSwwLGdlb20uZ2V0Q29vcmRpbmF0ZSgpKSk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZT1mdW5jdGlvbihlKXt0aGlzLmU9ZTt0aGlzLnB0cz1lLmdldENvb3JkaW5hdGVzKCk7dmFyIG1jYj1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkluZGV4ZXIoKTt0aGlzLnN0YXJ0SW5kZXg9bWNiLmdldENoYWluU3RhcnRJbmRpY2VzKHRoaXMucHRzKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5lPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5zdGFydEluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmVudjE9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5lbnYyPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHM7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZ2V0U3RhcnRJbmRleGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5nZXRNaW5YPWZ1bmN0aW9uKGNoYWluSW5kZXgpe3ZhciB4MT10aGlzLnB0c1t0aGlzLnN0YXJ0SW5kZXhbY2hhaW5JbmRleF1dLng7dmFyIHgyPXRoaXMucHRzW3RoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4KzFdXS54O2lmKHgxPHgyKXtyZXR1cm4geDE7fVxucmV0dXJuIHgyO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmdldE1heFg9ZnVuY3Rpb24oY2hhaW5JbmRleCl7dmFyIHgxPXRoaXMucHRzW3RoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4XV0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXgrMV1dLng7aWYoeDE+eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdHM9ZnVuY3Rpb24obWNlLHNpKXtmb3IodmFyIGk9MDtpPHRoaXMuc3RhcnRJbmRleC5sZW5ndGgtMTtpKyspe2Zvcih2YXIgaj0wO2o8bWNlLnN0YXJ0SW5kZXgubGVuZ3RoLTE7aisrKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4oaSxtY2UsaixzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluPWZ1bmN0aW9uKGNoYWluSW5kZXgwLG1jZSxjaGFpbkluZGV4MSxzaSl7dGhpcy5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluMih0aGlzLnN0YXJ0SW5kZXhbY2hhaW5JbmRleDBdLHRoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4MCsxXSxtY2UsbWNlLnN0YXJ0SW5kZXhbY2hhaW5JbmRleDFdLG1jZS5zdGFydEluZGV4W2NoYWluSW5kZXgxKzFdLHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluMj1mdW5jdGlvbihzdGFydDAsZW5kMCxtY2Usc3RhcnQxLGVuZDEsZWkpe3ZhciBwMDA9dGhpcy5wdHNbc3RhcnQwXTt2YXIgcDAxPXRoaXMucHRzW2VuZDBdO3ZhciBwMTA9bWNlLnB0c1tzdGFydDFdO3ZhciBwMTE9bWNlLnB0c1tlbmQxXTtpZihlbmQwLXN0YXJ0MD09MSYmZW5kMS1zdGFydDE9PTEpe2VpLmFkZEludGVyc2VjdGlvbnModGhpcy5lLHN0YXJ0MCxtY2UuZSxzdGFydDEpO3JldHVybjt9XG50aGlzLmVudjEuaW5pdChwMDAscDAxKTt0aGlzLmVudjIuaW5pdChwMTAscDExKTtpZighdGhpcy5lbnYxLmludGVyc2VjdHModGhpcy5lbnYyKSl7cmV0dXJuO31cbnZhciBtaWQwPU1hdGguZmxvb3IoKHN0YXJ0MCtlbmQwKS8yKTt2YXIgbWlkMT1NYXRoLmZsb29yKChzdGFydDErZW5kMSkvMik7aWYoc3RhcnQwPG1pZDApe2lmKHN0YXJ0MTxtaWQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKHN0YXJ0MCxtaWQwLG1jZSxzdGFydDEsbWlkMSxlaSk7fVxuaWYobWlkMTxlbmQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKHN0YXJ0MCxtaWQwLG1jZSxtaWQxLGVuZDEsZWkpO319XG5pZihtaWQwPGVuZDApe2lmKHN0YXJ0MTxtaWQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKG1pZDAsZW5kMCxtY2Usc3RhcnQxLG1pZDEsZWkpO31cbmlmKG1pZDE8ZW5kMSl7dGhpcy5jb21wdXRlSW50ZXJzZWN0c0ZvckNoYWluMihtaWQwLGVuZDAsbWNlLG1pZDEsZW5kMSxlaSk7fX19OyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXI9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZUVkZ2VFbmRzPWZ1bmN0aW9uKGVkZ2VzKXtpZihhcmd1bWVudHMubGVuZ3RoPT0yKXt0aGlzLmNvbXB1dGVFZGdlRW5kczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgbD1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPWVkZ2VzO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5jb21wdXRlRWRnZUVuZHMyKGUsbCk7fVxucmV0dXJuIGw7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVFZGdlRW5kczI9ZnVuY3Rpb24oZWRnZSxsKXt2YXIgZWlMaXN0PWVkZ2UuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKTtlaUxpc3QuYWRkRW5kcG9pbnRzKCk7dmFyIGl0PWVpTGlzdC5pdGVyYXRvcigpO3ZhciBlaVByZXY9bnVsbDt2YXIgZWlDdXJyPW51bGw7aWYoIWl0Lmhhc05leHQoKSlcbnJldHVybjt2YXIgZWlOZXh0PWl0Lm5leHQoKTtkb3tlaVByZXY9ZWlDdXJyO2VpQ3Vycj1laU5leHQ7ZWlOZXh0PW51bGw7aWYoaXQuaGFzTmV4dCgpKVxuZWlOZXh0PWl0Lm5leHQoKTtpZihlaUN1cnIhPT1udWxsKXt0aGlzLmNyZWF0ZUVkZ2VFbmRGb3JQcmV2KGVkZ2UsbCxlaUN1cnIsZWlQcmV2KTt0aGlzLmNyZWF0ZUVkZ2VFbmRGb3JOZXh0KGVkZ2UsbCxlaUN1cnIsZWlOZXh0KTt9fXdoaWxlKGVpQ3VyciE9PW51bGwpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVFZGdlRW5kRm9yUHJldj1mdW5jdGlvbihlZGdlLGwsZWlDdXJyLGVpUHJldil7dmFyIGlQcmV2PWVpQ3Vyci5zZWdtZW50SW5kZXg7aWYoZWlDdXJyLmRpc3Q9PT0wLjApe2lmKGlQcmV2PT09MClcbnJldHVybjtpUHJldi0tO31cbnZhciBwUHJldj1lZGdlLmdldENvb3JkaW5hdGUoaVByZXYpO2lmKGVpUHJldiE9PW51bGwmJmVpUHJldi5zZWdtZW50SW5kZXg+PWlQcmV2KVxucFByZXY9ZWlQcmV2LmNvb3JkO3ZhciBsYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZWRnZS5nZXRMYWJlbCgpKTtsYWJlbC5mbGlwKCk7dmFyIGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQoZWRnZSxlaUN1cnIuY29vcmQscFByZXYsbGFiZWwpO2wuYWRkKGUpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVFZGdlRW5kRm9yTmV4dD1mdW5jdGlvbihlZGdlLGwsZWlDdXJyLGVpTmV4dCl7dmFyIGlOZXh0PWVpQ3Vyci5zZWdtZW50SW5kZXgrMTtpZihpTmV4dD49ZWRnZS5nZXROdW1Qb2ludHMoKSYmZWlOZXh0PT09bnVsbClcbnJldHVybjt2YXIgcE5leHQ9ZWRnZS5nZXRDb29yZGluYXRlKGlOZXh0KTtpZihlaU5leHQhPT1udWxsJiZlaU5leHQuc2VnbWVudEluZGV4PT09ZWlDdXJyLnNlZ21lbnRJbmRleClcbnBOZXh0PWVpTmV4dC5jb29yZDt2YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZChlZGdlLGVpQ3Vyci5jb29yZCxwTmV4dCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZWRnZS5nZXRMYWJlbCgpKSk7bC5hZGQoZSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgVHJlZVNldD1qYXZhc2NyaXB0LnV0aWwuVHJlZVNldDt2YXIgQ29vcmRpbmF0ZUZpbHRlcj1qc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlcjtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyPWZ1bmN0aW9uKCl7dGhpcy50cmVlU2V0PW5ldyBUcmVlU2V0KCk7dGhpcy5saXN0PW5ldyBBcnJheUxpc3QoKTt9O2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIucHJvdG90eXBlPW5ldyBDb29yZGluYXRlRmlsdGVyKCk7anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGUudHJlZVNldD1udWxsO2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIucHJvdG90eXBlLmxpc3Q9bnVsbDtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxpc3QudG9BcnJheSgpO307anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGNvb3JkKXtpZighdGhpcy50cmVlU2V0LmNvbnRhaW5zKGNvb3JkKSl7dGhpcy5saXN0LmFkZChjb29yZCk7dGhpcy50cmVlU2V0LmFkZChjb29yZCk7fX07fSkoKTsoZnVuY3Rpb24oKXt2YXIgQ0dBbGdvcml0aG1zPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtczt2YXIgVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyPWpzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXI7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBTdGFjaz1qYXZhc2NyaXB0LnV0aWwuU3RhY2s7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBBcnJheXM9amF2YXNjcmlwdC51dGlsLkFycmF5czt2YXIgUmFkaWFsQ29tcGFyYXRvcj1mdW5jdGlvbihvcmlnaW4pe3RoaXMub3JpZ2luPW9yaWdpbjt9O1JhZGlhbENvbXBhcmF0b3IucHJvdG90eXBlLm9yaWdpbj1udWxsO1JhZGlhbENvbXBhcmF0b3IucHJvdG90eXBlLmNvbXBhcmU9ZnVuY3Rpb24obzEsbzIpe3ZhciBwMT1vMTt2YXIgcDI9bzI7cmV0dXJuIFJhZGlhbENvbXBhcmF0b3IucG9sYXJDb21wYXJlKHRoaXMub3JpZ2luLHAxLHAyKTt9O1JhZGlhbENvbXBhcmF0b3IucG9sYXJDb21wYXJlPWZ1bmN0aW9uKG8scCxxKXt2YXIgZHhwPXAueC1vLng7dmFyIGR5cD1wLnktby55O3ZhciBkeHE9cS54LW8ueDt2YXIgZHlxPXEueS1vLnk7dmFyIG9yaWVudD1DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKG8scCxxKTtpZihvcmllbnQ9PUNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFKVxucmV0dXJuIDE7aWYob3JpZW50PT1DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFKVxucmV0dXJuLTE7dmFyIG9wPWR4cCpkeHArZHlwKmR5cDt2YXIgb3E9ZHhxKmR4cStkeXEqZHlxO2lmKG9wPG9xKXtyZXR1cm4tMTt9XG5pZihvcD5vcSl7cmV0dXJuIDE7fVxucmV0dXJuIDA7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3ZhciBnZW9tZXRyeT1hcmd1bWVudHNbMF07dGhpcy5pbnB1dFB0cz1qc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLmV4dHJhY3RDb29yZGluYXRlcyhnZW9tZXRyeSk7dGhpcy5nZW9tRmFjdG9yeT1nZW9tZXRyeS5nZXRGYWN0b3J5KCk7fWVsc2V7dGhpcy5wdHM9YXJndW1lbnRzWzBdO3RoaXMuZ2VvbUZhY3Rvcnk9YXJndW1lbnRzWzFdO319O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmdlb21GYWN0b3J5PW51bGw7anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuaW5wdXRQdHM9bnVsbDtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLmV4dHJhY3RDb29yZGluYXRlcz1mdW5jdGlvbihnZW9tKXt2YXIgZmlsdGVyPW5ldyBVbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIoKTtnZW9tLmFwcGx5KGZpbHRlcik7cmV0dXJuIGZpbHRlci5nZXRDb29yZGluYXRlcygpO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuZ2V0Q29udmV4SHVsbD1mdW5jdGlvbigpe2lmKHRoaXMuaW5wdXRQdHMubGVuZ3RoPT0wKXtyZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYodGhpcy5pbnB1dFB0cy5sZW5ndGg9PTEpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZVBvaW50KHRoaXMuaW5wdXRQdHNbMF0pO31cbmlmKHRoaXMuaW5wdXRQdHMubGVuZ3RoPT0yKXtyZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMuaW5wdXRQdHMpO31cbnZhciByZWR1Y2VkUHRzPXRoaXMuaW5wdXRQdHM7aWYodGhpcy5pbnB1dFB0cy5sZW5ndGg+NTApe3JlZHVjZWRQdHM9dGhpcy5yZWR1Y2UodGhpcy5pbnB1dFB0cyk7fVxudmFyIHNvcnRlZFB0cz10aGlzLnByZVNvcnQocmVkdWNlZFB0cyk7dmFyIGNIUz10aGlzLmdyYWhhbVNjYW4oc29ydGVkUHRzKTt2YXIgY0g9Y0hTLnRvQXJyYXkoKTtyZXR1cm4gdGhpcy5saW5lT3JQb2x5Z29uKGNIKTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLnJlZHVjZT1mdW5jdGlvbihpbnB1dFB0cyl7dmFyIHBvbHlQdHM9dGhpcy5jb21wdXRlT2N0UmluZyhpbnB1dFB0cyk7aWYocG9seVB0cz09bnVsbClcbnJldHVybiB0aGlzLmlucHV0UHRzO3ZhciByZWR1Y2VkU2V0PW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZVNldCgpO2Zvcih2YXIgaT0wO2k8cG9seVB0cy5sZW5ndGg7aSsrKXtyZWR1Y2VkU2V0LmFkZChwb2x5UHRzW2ldKTt9XG5mb3IodmFyIGk9MDtpPGlucHV0UHRzLmxlbmd0aDtpKyspe2lmKCFDR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyhpbnB1dFB0c1tpXSxwb2x5UHRzKSl7cmVkdWNlZFNldC5hZGQoaW5wdXRQdHNbaV0pO319XG52YXIgcmVkdWNlZFB0cz1yZWR1Y2VkU2V0LnRvQXJyYXkoKTtpZihyZWR1Y2VkUHRzLmxlbmd0aDwzKVxucmV0dXJuIHRoaXMucGFkQXJyYXkzKHJlZHVjZWRQdHMpO3JldHVybiByZWR1Y2VkUHRzO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUucGFkQXJyYXkzPWZ1bmN0aW9uKHB0cyl7dmFyIHBhZD1bXTtmb3IodmFyIGk9MDtpPHBhZC5sZW5ndGg7aSsrKXtpZihpPHB0cy5sZW5ndGgpe3BhZFtpXT1wdHNbaV07fWVsc2VcbnBhZFtpXT1wdHNbMF07fVxucmV0dXJuIHBhZDt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLnByZVNvcnQ9ZnVuY3Rpb24ocHRzKXt2YXIgdDtmb3IodmFyIGk9MTtpPHB0cy5sZW5ndGg7aSsrKXtpZigocHRzW2ldLnk8cHRzWzBdLnkpfHwoKHB0c1tpXS55PT1wdHNbMF0ueSkmJihwdHNbaV0ueDxwdHNbMF0ueCkpKXt0PXB0c1swXTtwdHNbMF09cHRzW2ldO3B0c1tpXT10O319XG5BcnJheXMuc29ydChwdHMsMSxwdHMubGVuZ3RoLG5ldyBSYWRpYWxDb21wYXJhdG9yKHB0c1swXSkpO3JldHVybiBwdHM7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5ncmFoYW1TY2FuPWZ1bmN0aW9uKGMpe3ZhciBwO3ZhciBwcz1uZXcgU3RhY2soKTtwPXBzLnB1c2goY1swXSk7cD1wcy5wdXNoKGNbMV0pO3A9cHMucHVzaChjWzJdKTtmb3IodmFyIGk9MztpPGMubGVuZ3RoO2krKyl7cD1wcy5wb3AoKTt3aGlsZSghcHMuZW1wdHkoKSYmQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwcy5wZWVrKCkscCxjW2ldKT4wKXtwPXBzLnBvcCgpO31cbnA9cHMucHVzaChwKTtwPXBzLnB1c2goY1tpXSk7fVxucD1wcy5wdXNoKGNbMF0pO3JldHVybiBwczt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmlzQmV0d2Vlbj1mdW5jdGlvbihjMSxjMixjMyl7aWYoQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihjMSxjMixjMykhPT0wKXtyZXR1cm4gZmFsc2U7fVxuaWYoYzEueCE9YzMueCl7aWYoYzEueDw9YzIueCYmYzIueDw9YzMueCl7cmV0dXJuIHRydWU7fVxuaWYoYzMueDw9YzIueCYmYzIueDw9YzEueCl7cmV0dXJuIHRydWU7fX1cbmlmKGMxLnkhPWMzLnkpe2lmKGMxLnk8PWMyLnkmJmMyLnk8PWMzLnkpe3JldHVybiB0cnVlO31cbmlmKGMzLnk8PWMyLnkmJmMyLnk8PWMxLnkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5jb21wdXRlT2N0UmluZz1mdW5jdGlvbihpbnB1dFB0cyl7dmFyIG9jdFB0cz10aGlzLmNvbXB1dGVPY3RQdHMoaW5wdXRQdHMpO3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdCgpO2Nvb3JkTGlzdC5hZGQob2N0UHRzLGZhbHNlKTtpZihjb29yZExpc3Quc2l6ZSgpPDMpe3JldHVybiBudWxsO31cbmNvb3JkTGlzdC5jbG9zZVJpbmcoKTtyZXR1cm4gY29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5jb21wdXRlT2N0UHRzPWZ1bmN0aW9uKGlucHV0UHRzKXt2YXIgcHRzPVtdO2Zvcih2YXIgaj0wO2o8ODtqKyspe3B0c1tqXT1pbnB1dFB0c1swXTt9XG5mb3IodmFyIGk9MTtpPGlucHV0UHRzLmxlbmd0aDtpKyspe2lmKGlucHV0UHRzW2ldLng8cHRzWzBdLngpe3B0c1swXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54LWlucHV0UHRzW2ldLnk8cHRzWzFdLngtcHRzWzFdLnkpe3B0c1sxXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS55PnB0c1syXS55KXtwdHNbMl09aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueCtpbnB1dFB0c1tpXS55PnB0c1szXS54K3B0c1szXS55KXtwdHNbM109aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueD5wdHNbNF0ueCl7cHRzWzRdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLngtaW5wdXRQdHNbaV0ueT5wdHNbNV0ueC1wdHNbNV0ueSl7cHRzWzVdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLnk8cHRzWzZdLnkpe3B0c1s2XT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54K2lucHV0UHRzW2ldLnk8cHRzWzddLngrcHRzWzddLnkpe3B0c1s3XT1pbnB1dFB0c1tpXTt9fVxucmV0dXJuIHB0czt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmxpbmVPclBvbHlnb249ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe2Nvb3JkaW5hdGVzPXRoaXMuY2xlYW5SaW5nKGNvb3JkaW5hdGVzKTtpZihjb29yZGluYXRlcy5sZW5ndGg9PTMpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoW2Nvb3JkaW5hdGVzWzBdLGNvb3JkaW5hdGVzWzFdXSk7fVxudmFyIGxpbmVhclJpbmc9dGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvb3JkaW5hdGVzKTtyZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5jcmVhdGVQb2x5Z29uKGxpbmVhclJpbmcsbnVsbCk7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5jbGVhblJpbmc9ZnVuY3Rpb24ob3JpZ2luYWwpe0Fzc2VydC5lcXVhbHMob3JpZ2luYWxbMF0sb3JpZ2luYWxbb3JpZ2luYWwubGVuZ3RoLTFdKTt2YXIgY2xlYW5lZFJpbmc9bmV3IEFycmF5TGlzdCgpO3ZhciBwcmV2aW91c0Rpc3RpbmN0Q29vcmRpbmF0ZT1udWxsO2Zvcih2YXIgaT0wO2k8PW9yaWdpbmFsLmxlbmd0aC0yO2krKyl7dmFyIGN1cnJlbnRDb29yZGluYXRlPW9yaWdpbmFsW2ldO3ZhciBuZXh0Q29vcmRpbmF0ZT1vcmlnaW5hbFtpKzFdO2lmKGN1cnJlbnRDb29yZGluYXRlLmVxdWFscyhuZXh0Q29vcmRpbmF0ZSkpe2NvbnRpbnVlO31cbmlmKHByZXZpb3VzRGlzdGluY3RDb29yZGluYXRlIT1udWxsJiZ0aGlzLmlzQmV0d2VlbihwcmV2aW91c0Rpc3RpbmN0Q29vcmRpbmF0ZSxjdXJyZW50Q29vcmRpbmF0ZSxuZXh0Q29vcmRpbmF0ZSkpe2NvbnRpbnVlO31cbmNsZWFuZWRSaW5nLmFkZChjdXJyZW50Q29vcmRpbmF0ZSk7cHJldmlvdXNEaXN0aW5jdENvb3JkaW5hdGU9Y3VycmVudENvb3JkaW5hdGU7fVxuY2xlYW5lZFJpbmcuYWRkKG9yaWdpbmFsW29yaWdpbmFsLmxlbmd0aC0xXSk7dmFyIGNsZWFuZWRSaW5nQ29vcmRpbmF0ZXM9W107cmV0dXJuIGNsZWFuZWRSaW5nLnRvQXJyYXkoY2xlYW5lZFJpbmdDb29yZGluYXRlcyk7fTt9KSgpO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlcj1mdW5jdGlvbihpbnB1dEdlb20saXNDb252ZXgpe3RoaXMuY29udmV4SHVsbFB0cz1udWxsO3RoaXMubWluQmFzZVNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5taW5XaWR0aFB0PW51bGw7dGhpcy5taW5QdEluZGV4PTA7dGhpcy5taW5XaWR0aD0wO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb209aW5wdXRHZW9tO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pc0NvbnZleD1pc0NvbnZleHx8ZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tPW51bGw7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlzQ29udmV4PWZhbHNlO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5uZXh0SW5kZXg9ZnVuY3Rpb24ocHRzLGluZGV4KXtpbmRleCsrO2lmKGluZGV4Pj1wdHMubGVuZ3RoKXtpbmRleD0wO31cbnJldHVybiBpbmRleDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5jb21wdXRlQz1mdW5jdGlvbihhLGIscCl7cmV0dXJuIGEqcC55LWIqcC54O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZT1mdW5jdGlvbihhLGIsYyl7dmFyIHAwO3ZhciBwMTtpZihNYXRoLmFicyhiKT5NYXRoLmFicyhhKSl7cDA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKDAsYy9iKTtwMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoMSxjL2ItYS9iKTt9XG5lbHNle3AwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShjL2EsMCk7cDE9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGMvYS1iL2EsMSk7fVxucmV0dXJuIG5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQocDAscDEpO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTtyZXR1cm4gdGhpcy5taW5XaWR0aDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0V2lkdGhDb29yZGluYXRlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTWluaW11bURpYW1ldGVyKCk7cmV0dXJuIHRoaXMubWluV2lkdGhQdDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0U3VwcG9ydGluZ1NlZ21lbnQ9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTt2YXIgY29vcmQ9W3RoaXMubWluQmFzZVNlZy5wMCx0aGlzLm1pbkJhc2VTZWcucDFdO3JldHVybiBqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVMaW5lU3RyaW5nKGNvb3JkKTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0RGlhbWV0ZXI9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTtpZih0aGlzLm1pbldpZHRoUHQ9PT1udWxsKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlTGluZVN0cmluZyhudWxsKTt9XG52YXIgYmFzZVB0PXRoaXMubWluQmFzZVNlZy5wcm9qZWN0KHRoaXMubWluV2lkdGhQdCk7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVTdHJpbmcoW2Jhc2VQdCx0aGlzLm1pbldpZHRoUHRdKTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuY29tcHV0ZU1pbmltdW1EaWFtZXRlcj1mdW5jdGlvbigpe2lmKHRoaXMubWluV2lkdGhQdCE9PW51bGwpe3JldHVybjt9XG5pZihqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaXNDb252ZXgpXG50aGlzLmNvbXB1dGVXaWR0aENvbnZleChqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tKTtlbHNle3ZhciBjb252ZXhHZW9tPW5ldyBqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsKGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20pLmdldENvbnZleEh1bGwoKTt0aGlzLmNvbXB1dGVXaWR0aENvbnZleChjb252ZXhHZW9tKTt9fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIucHJvdG90eXBlLmNvbXB1dGVXaWR0aENvbnZleD1mdW5jdGlvbihjb252ZXhHZW9tKXtpZihjb252ZXhHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuY29udmV4SHVsbFB0cz1jb252ZXhHZW9tLmdldEV4dGVyaW9yUmluZygpLmdldENvb3JkaW5hdGVzKCk7fWVsc2V7dGhpcy5jb252ZXhIdWxsUHRzPWNvbnZleEdlb20uZ2V0Q29vcmRpbmF0ZXMoKTt9XG5pZih0aGlzLmNvbnZleEh1bGxQdHMubGVuZ3RoPT09MCl7dGhpcy5taW5XaWR0aD0wO3RoaXMubWluV2lkdGhQdD1udWxsO3RoaXMubWluQmFzZVNlZz1udWxsO31lbHNlIGlmKHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg9PT0xKXt0aGlzLm1pbldpZHRoPTA7dGhpcy5taW5XaWR0aFB0PXRoaXMuY29udmV4SHVsbFB0c1swXTt0aGlzLm1pbkJhc2VTZWcucDA9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMT10aGlzLmNvbnZleEh1bGxQdHNbMF07fWVsc2UgaWYodGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aD09PTJ8fHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg9PT0zKXt0aGlzLm1pbldpZHRoPTA7dGhpcy5taW5XaWR0aFB0PXRoaXMuY29udmV4SHVsbFB0c1swXTt0aGlzLm1pbkJhc2VTZWcucDA9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMT10aGlzLmNvbnZleEh1bGxQdHNbMV07fWVsc2V7dGhpcy5jb21wdXRlQ29udmV4UmluZ01pbkRpYW1ldGVyKHRoaXMuY29udmV4SHVsbFB0cyk7fX07anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5jb21wdXRlQ29udmV4UmluZ01pbkRpYW1ldGVyPWZ1bmN0aW9uKHB0cyl7dGhpcy5taW5XaWR0aD1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBjdXJyTWF4SW5kZXg9MTt2YXIgc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3NlZy5wMD1wdHNbaV07c2VnLnAxPXB0c1tpKzFdO2N1cnJNYXhJbmRleD10aGlzLmZpbmRNYXhQZXJwRGlzdGFuY2UocHRzLHNlZyxjdXJyTWF4SW5kZXgpO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZmluZE1heFBlcnBEaXN0YW5jZT1mdW5jdGlvbihwdHMsc2VnLHN0YXJ0SW5kZXgpe3ZhciBtYXhQZXJwRGlzdGFuY2U9c2VnLmRpc3RhbmNlUGVycGVuZGljdWxhcihwdHNbc3RhcnRJbmRleF0pO3ZhciBuZXh0UGVycERpc3RhbmNlPW1heFBlcnBEaXN0YW5jZTt2YXIgbWF4SW5kZXg9c3RhcnRJbmRleDt2YXIgbmV4dEluZGV4PW1heEluZGV4O3doaWxlKG5leHRQZXJwRGlzdGFuY2U+PW1heFBlcnBEaXN0YW5jZSl7bWF4UGVycERpc3RhbmNlPW5leHRQZXJwRGlzdGFuY2U7bWF4SW5kZXg9bmV4dEluZGV4O25leHRJbmRleD1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIubmV4dEluZGV4KHB0cyxtYXhJbmRleCk7bmV4dFBlcnBEaXN0YW5jZT1zZWcuZGlzdGFuY2VQZXJwZW5kaWN1bGFyKHB0c1tuZXh0SW5kZXhdKTt9XG5pZihtYXhQZXJwRGlzdGFuY2U8dGhpcy5taW5XaWR0aCl7dGhpcy5taW5QdEluZGV4PW1heEluZGV4O3RoaXMubWluV2lkdGg9bWF4UGVycERpc3RhbmNlO3RoaXMubWluV2lkdGhQdD1wdHNbdGhpcy5taW5QdEluZGV4XTt0aGlzLm1pbkJhc2VTZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChzZWcpO31cbnJldHVybiBtYXhJbmRleDt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuZ2V0TWluaW11bVJlY3RhbmdsZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO2lmKHRoaXMubWluV2lkdGg9PT0wKXtpZih0aGlzLm1pbkJhc2VTZWcucDAuZXF1YWxzMkQodGhpcy5taW5CYXNlU2VnLnAxKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvaW50KHRoaXMubWluQmFzZVNlZy5wMCk7fVxucmV0dXJuIHRoaXMubWluQmFzZVNlZy50b0dlb21ldHJ5KGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpKTt9XG52YXIgZHg9dGhpcy5taW5CYXNlU2VnLnAxLngtdGhpcy5taW5CYXNlU2VnLnAwLng7dmFyIGR5PXRoaXMubWluQmFzZVNlZy5wMS55LXRoaXMubWluQmFzZVNlZy5wMC55O3ZhciBtaW5QYXJhPU51bWJlci5NQVhfVkFMVUU7dmFyIG1heFBhcmE9LU51bWJlci5NQVhfVkFMVUU7dmFyIG1pblBlcnA9TnVtYmVyLk1BWF9WQUxVRTt2YXIgbWF4UGVycD0tTnVtYmVyLk1BWF9WQUxVRTtmb3IodmFyIGk9MDtpPHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg7aSsrKXt2YXIgcGFyYUM9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVDKGR4LGR5LHRoaXMuY29udmV4SHVsbFB0c1tpXSk7aWYocGFyYUM+bWF4UGFyYSltYXhQYXJhPXBhcmFDO2lmKHBhcmFDPG1pblBhcmEpbWluUGFyYT1wYXJhQzt2YXIgcGVycEM9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVDKC1keSxkeCx0aGlzLmNvbnZleEh1bGxQdHNbaV0pO2lmKHBlcnBDPm1heFBlcnApbWF4UGVycD1wZXJwQztpZihwZXJwQzxtaW5QZXJwKW1pblBlcnA9cGVycEM7fVxudmFyIG1heFBlcnBMaW5lPWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5jb21wdXRlU2VnbWVudEZvckxpbmUoLWR4LC1keSxtYXhQZXJwKTt2YXIgbWluUGVycExpbmU9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZSgtZHgsLWR5LG1pblBlcnApO3ZhciBtYXhQYXJhTGluZT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lKC1keSxkeCxtYXhQYXJhKTt2YXIgbWluUGFyYUxpbmU9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZSgtZHksZHgsbWluUGFyYSk7dmFyIHAwPW1heFBhcmFMaW5lLmxpbmVJbnRlcnNlY3Rpb24obWF4UGVycExpbmUpO3ZhciBwMT1taW5QYXJhTGluZS5saW5lSW50ZXJzZWN0aW9uKG1heFBlcnBMaW5lKTt2YXIgcDI9bWluUGFyYUxpbmUubGluZUludGVyc2VjdGlvbihtaW5QZXJwTGluZSk7dmFyIHAzPW1heFBhcmFMaW5lLmxpbmVJbnRlcnNlY3Rpb24obWluUGVycExpbmUpO3ZhciBzaGVsbD1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVMaW5lYXJSaW5nKFtwMCxwMSxwMixwMyxwMF0pO3JldHVybiBqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVQb2x5Z29uKHNoZWxsLG51bGwpO307KGZ1bmN0aW9uKCl7anN0cy5pby5HZW9KU09OUGFyc2VyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMuZ2VvbWV0cnlUeXBlcz1bJ1BvaW50JywnTXVsdGlQb2ludCcsJ0xpbmVTdHJpbmcnLCdNdWx0aUxpbmVTdHJpbmcnLCdQb2x5Z29uJywnTXVsdGlQb2x5Z29uJ107fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24oanNvbil7dmFyIG9iajtpZih0eXBlb2YganNvbj09PSdzdHJpbmcnKXtvYmo9SlNPTi5wYXJzZShqc29uKTt9ZWxzZXtvYmo9anNvbjt9XG52YXIgdHlwZT1vYmoudHlwZTtpZighdGhpcy5wYXJzZVt0eXBlXSl7dGhyb3cgbmV3IEVycm9yKCdVbmtub3duIEdlb0pTT04gdHlwZTogJytvYmoudHlwZSk7fVxuaWYodGhpcy5nZW9tZXRyeVR5cGVzLmluZGV4T2YodHlwZSkhPS0xKXtyZXR1cm4gdGhpcy5wYXJzZVt0eXBlXS5hcHBseSh0aGlzLFtvYmouY29vcmRpbmF0ZXNdKTt9ZWxzZSBpZih0eXBlPT09J0dlb21ldHJ5Q29sbGVjdGlvbicpe3JldHVybiB0aGlzLnBhcnNlW3R5cGVdLmFwcGx5KHRoaXMsW29iai5nZW9tZXRyaWVzXSk7fVxucmV0dXJuIHRoaXMucGFyc2VbdHlwZV0uYXBwbHkodGhpcyxbb2JqXSk7fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLnBhcnNlPXsnRmVhdHVyZSc6ZnVuY3Rpb24ob2JqKXt2YXIgZmVhdHVyZT17fTtmb3IodmFyIGtleSBpbiBvYmope2ZlYXR1cmVba2V5XT1vYmpba2V5XTt9XG5pZihvYmouZ2VvbWV0cnkpe3ZhciB0eXBlPW9iai5nZW9tZXRyeS50eXBlO2lmKCF0aGlzLnBhcnNlW3R5cGVdKXt0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gR2VvSlNPTiB0eXBlOiAnK29iai50eXBlKTt9XG5mZWF0dXJlLmdlb21ldHJ5PXRoaXMucmVhZChvYmouZ2VvbWV0cnkpO31cbmlmKG9iai5iYm94KXtmZWF0dXJlLmJib3g9dGhpcy5wYXJzZS5iYm94LmFwcGx5KHRoaXMsW29iai5iYm94XSk7fVxucmV0dXJuIGZlYXR1cmU7fSwnRmVhdHVyZUNvbGxlY3Rpb24nOmZ1bmN0aW9uKG9iail7dmFyIGZlYXR1cmVDb2xsZWN0aW9uPXt9O2lmKG9iai5mZWF0dXJlcyl7ZmVhdHVyZUNvbGxlY3Rpb24uZmVhdHVyZXM9W107Zm9yKHZhciBpPTA7aTxvYmouZmVhdHVyZXMubGVuZ3RoOysraSl7ZmVhdHVyZUNvbGxlY3Rpb24uZmVhdHVyZXMucHVzaCh0aGlzLnJlYWQob2JqLmZlYXR1cmVzW2ldKSk7fX1cbmlmKG9iai5iYm94KXtmZWF0dXJlQ29sbGVjdGlvbi5iYm94PXRoaXMucGFyc2UuYmJveC5hcHBseSh0aGlzLFtvYmouYmJveF0pO31cbnJldHVybiBmZWF0dXJlQ29sbGVjdGlvbjt9LCdjb29yZGluYXRlcyc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBjb29yZGluYXRlcz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3ZhciBzdWI9YXJyYXlbaV07Y29vcmRpbmF0ZXMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc3ViWzBdLHN1YlsxXSkpO31cbnJldHVybiBjb29yZGluYXRlczt9LCdiYm94JzpmdW5jdGlvbihhcnJheSl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoW25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcnJheVswXSxhcnJheVsxXSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzJdLGFycmF5WzFdKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMl0sYXJyYXlbM10pLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcnJheVswXSxhcnJheVszXSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzFdKV0pO30sJ1BvaW50JzpmdW5jdGlvbihhcnJheSl7dmFyIGNvb3JkaW5hdGU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzFdKTtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQoY29vcmRpbmF0ZSk7fSwnTXVsdGlQb2ludCc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBwb2ludHM9W107Zm9yKHZhciBpPTA7aTxhcnJheS5sZW5ndGg7KytpKXtwb2ludHMucHVzaCh0aGlzLnBhcnNlLlBvaW50LmFwcGx5KHRoaXMsW2FycmF5W2ldXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvaW50KHBvaW50cyk7fSwnTGluZVN0cmluZyc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBjb29yZGluYXRlcz10aGlzLnBhcnNlLmNvb3JkaW5hdGVzLmFwcGx5KHRoaXMsW2FycmF5XSk7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoY29vcmRpbmF0ZXMpO30sJ011bHRpTGluZVN0cmluZyc6ZnVuY3Rpb24oYXJyYXkpe3ZhciBsaW5lU3RyaW5ncz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe2xpbmVTdHJpbmdzLnB1c2godGhpcy5wYXJzZS5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW2FycmF5W2ldXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobGluZVN0cmluZ3MpO30sJ1BvbHlnb24nOmZ1bmN0aW9uKGFycmF5KXt2YXIgc2hlbGxDb29yZGluYXRlcz10aGlzLnBhcnNlLmNvb3JkaW5hdGVzLmFwcGx5KHRoaXMsW2FycmF5WzBdXSk7dmFyIHNoZWxsPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoc2hlbGxDb29yZGluYXRlcyk7dmFyIGhvbGVzPVtdO2Zvcih2YXIgaT0xO2k8YXJyYXkubGVuZ3RoOysraSl7dmFyIGhvbGU9YXJyYXlbaV07dmFyIGNvb3JkaW5hdGVzPXRoaXMucGFyc2UuY29vcmRpbmF0ZXMuYXBwbHkodGhpcyxbaG9sZV0pO3ZhciBsaW5lYXJSaW5nPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRpbmF0ZXMpO2hvbGVzLnB1c2gobGluZWFyUmluZyk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24oc2hlbGwsaG9sZXMpO30sJ011bHRpUG9seWdvbic6ZnVuY3Rpb24oYXJyYXkpe3ZhciBwb2x5Z29ucz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3ZhciBwb2x5Z29uPWFycmF5W2ldO3BvbHlnb25zLnB1c2godGhpcy5wYXJzZS5Qb2x5Z29uLmFwcGx5KHRoaXMsW3BvbHlnb25dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9seWdvbihwb2x5Z29ucyk7fSwnR2VvbWV0cnlDb2xsZWN0aW9uJzpmdW5jdGlvbihhcnJheSl7dmFyIGdlb21ldHJpZXM9W107Zm9yKHZhciBpPTA7aTxhcnJheS5sZW5ndGg7KytpKXt2YXIgZ2VvbWV0cnk9YXJyYXlbaV07Z2VvbWV0cmllcy5wdXNoKHRoaXMucmVhZChnZW9tZXRyeSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oZ2VvbWV0cmllcyk7fX07anN0cy5pby5HZW9KU09OUGFyc2VyLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIHR5cGU9Z2VvbWV0cnkuQ0xBU1NfTkFNRS5zbGljZSgxMCk7aWYoIXRoaXMuZXh0cmFjdFt0eXBlXSl7dGhyb3cgbmV3IEVycm9yKCdHZW9tZXRyeSBpcyBub3Qgc3VwcG9ydGVkJyk7fVxucmV0dXJuIHRoaXMuZXh0cmFjdFt0eXBlXS5hcHBseSh0aGlzLFtnZW9tZXRyeV0pO307anN0cy5pby5HZW9KU09OUGFyc2VyLnByb3RvdHlwZS5leHRyYWN0PXsnY29vcmRpbmF0ZSc6ZnVuY3Rpb24oY29vcmRpbmF0ZSl7cmV0dXJuW2Nvb3JkaW5hdGUueCxjb29yZGluYXRlLnldO30sJ1BvaW50JzpmdW5jdGlvbihwb2ludCl7dmFyIGFycmF5PXRoaXMuZXh0cmFjdC5jb29yZGluYXRlLmFwcGx5KHRoaXMsW3BvaW50LmNvb3JkaW5hdGVdKTtyZXR1cm57dHlwZTonUG9pbnQnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdNdWx0aVBvaW50JzpmdW5jdGlvbihtdWx0aXBvaW50KXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxtdWx0aXBvaW50Lmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIHBvaW50PW11bHRpcG9pbnQuZ2VvbWV0cmllc1tpXTt2YXIgZ2VvSnNvbj10aGlzLmV4dHJhY3QuUG9pbnQuYXBwbHkodGhpcyxbcG9pbnRdKTthcnJheS5wdXNoKGdlb0pzb24uY29vcmRpbmF0ZXMpO31cbnJldHVybnt0eXBlOidNdWx0aVBvaW50Jyxjb29yZGluYXRlczphcnJheX07fSwnTGluZVN0cmluZyc6ZnVuY3Rpb24obGluZXN0cmluZyl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bGluZXN0cmluZy5wb2ludHMubGVuZ3RoOysraSl7dmFyIGNvb3JkaW5hdGU9bGluZXN0cmluZy5wb2ludHNbaV07YXJyYXkucHVzaCh0aGlzLmV4dHJhY3QuY29vcmRpbmF0ZS5hcHBseSh0aGlzLFtjb29yZGluYXRlXSkpO31cbnJldHVybnt0eXBlOidMaW5lU3RyaW5nJyxjb29yZGluYXRlczphcnJheX07fSwnTXVsdGlMaW5lU3RyaW5nJzpmdW5jdGlvbihtdWx0aWxpbmVzdHJpbmcpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MDtpPG11bHRpbGluZXN0cmluZy5nZW9tZXRyaWVzLmxlbmd0aDsrK2kpe3ZhciBsaW5lc3RyaW5nPW11bHRpbGluZXN0cmluZy5nZW9tZXRyaWVzW2ldO3ZhciBnZW9Kc29uPXRoaXMuZXh0cmFjdC5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW2xpbmVzdHJpbmddKTthcnJheS5wdXNoKGdlb0pzb24uY29vcmRpbmF0ZXMpO31cbnJldHVybnt0eXBlOidNdWx0aUxpbmVTdHJpbmcnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdQb2x5Z29uJzpmdW5jdGlvbihwb2x5Z29uKXt2YXIgYXJyYXk9W107dmFyIHNoZWxsR2VvSnNvbj10aGlzLmV4dHJhY3QuTGluZVN0cmluZy5hcHBseSh0aGlzLFtwb2x5Z29uLnNoZWxsXSk7YXJyYXkucHVzaChzaGVsbEdlb0pzb24uY29vcmRpbmF0ZXMpO2Zvcih2YXIgaT0wO2k8cG9seWdvbi5ob2xlcy5sZW5ndGg7KytpKXt2YXIgaG9sZT1wb2x5Z29uLmhvbGVzW2ldO3ZhciBob2xlR2VvSnNvbj10aGlzLmV4dHJhY3QuTGluZVN0cmluZy5hcHBseSh0aGlzLFtob2xlXSk7YXJyYXkucHVzaChob2xlR2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J1BvbHlnb24nLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdNdWx0aVBvbHlnb24nOmZ1bmN0aW9uKG11bHRpcG9seWdvbil7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bXVsdGlwb2x5Z29uLmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIHBvbHlnb249bXVsdGlwb2x5Z29uLmdlb21ldHJpZXNbaV07dmFyIGdlb0pzb249dGhpcy5leHRyYWN0LlBvbHlnb24uYXBwbHkodGhpcyxbcG9seWdvbl0pO2FycmF5LnB1c2goZ2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J011bHRpUG9seWdvbicsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ0dlb21ldHJ5Q29sbGVjdGlvbic6ZnVuY3Rpb24oY29sbGVjdGlvbil7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8Y29sbGVjdGlvbi5nZW9tZXRyaWVzLmxlbmd0aDsrK2kpe3ZhciBnZW9tZXRyeT1jb2xsZWN0aW9uLmdlb21ldHJpZXNbaV07dmFyIHR5cGU9Z2VvbWV0cnkuQ0xBU1NfTkFNRS5zbGljZSgxMCk7YXJyYXkucHVzaCh0aGlzLmV4dHJhY3RbdHlwZV0uYXBwbHkodGhpcyxbZ2VvbWV0cnldKSk7fVxucmV0dXJue3R5cGU6J0dlb21ldHJ5Q29sbGVjdGlvbicsZ2VvbWV0cmllczphcnJheX07fX07fSkoKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3RoaXMuaW5pdEZyb21YWShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5MRUZUPTA7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguUklHSFQ9MTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVlPTkQ9Mjtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRUhJTkQ9Mztqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVRXRUVOPTQ7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguT1JJR0lOPTU7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguREVTVElOQVRJT049Njtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuaW5pdEZyb21YWT1mdW5jdGlvbih4LHkpe3RoaXMucD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pbml0RnJvbUNvb3JkaW5hdGU9ZnVuY3Rpb24oX3Ape3RoaXMucD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoX3ApO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLng7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZ2V0WT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5nZXRaPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucC56O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnNldFo9ZnVuY3Rpb24oeil7dGhpcy5wLno9ejt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybidQT0lOVCAoJyt0aGlzLnAueCsnICcrdGhpcy5wLnkrJyknO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5lcXVhbHNFeGFjdChhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmVxdWFsc1dpdGhUb2xlcmFuY2UoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4odGhpcy5wLng9PT1vdGhlci5nZXRYKCkmJnRoaXMucC55PT09b3RoZXIuZ2V0WSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5lcXVhbHNXaXRoVG9sZXJhbmNlPWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7cmV0dXJuKHRoaXMucC5kaXN0YW5jZShvdGhlci5nZXRDb29yZGluYXRlKCkpPHRvbGVyYW5jZSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY2xhc3NpZnk9ZnVuY3Rpb24ocDAscDEpe3ZhciBwMixhLGIsc2E7cDI9dGhpczthPXAxLnN1YihwMCk7Yj1wMi5zdWIocDApO3NhPWEuY3Jvc3NQcm9kdWN0KGIpO2lmKHNhPjAuMCl7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkxFRlQ7fVxuaWYoc2E8MC4wKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguUklHSFQ7fVxuaWYoKGEuZ2V0WCgpKmIuZ2V0WCgpPDAuMCl8fChhLmdldFkoKSpiLmdldFkoKTwwLjApKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguQkVISU5EO31cbmlmKGEubWFnbigpPGIubWFnbigpKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguQkVZT05EO31cbmlmKHAwLmVxdWFscyhwMikpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5PUklHSU47fVxuaWYocDEuZXF1YWxzKHAyKSl7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkRFU1RJTkFUSU9OO31cbnJldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVRXRUVOO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmNyb3NzUHJvZHVjdD1mdW5jdGlvbih2KXtyZXR1cm4oKHRoaXMucC54KnYuZ2V0WSgpKS0odGhpcy5wLnkqdi5nZXRYKCkpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5kb3Q9ZnVuY3Rpb24odil7cmV0dXJuKCh0aGlzLnAueCp2LmdldFgoKSkrKHRoaXMucC55KnYuZ2V0WSgpKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUudGltZXM9ZnVuY3Rpb24oYyl7cmV0dXJuIG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChjKnRoaXMucC54LGMqdGhpcy5wLnkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnN1bT1mdW5jdGlvbih2KXtyZXR1cm4gbmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHRoaXMucC54K3YuZ2V0WCgpLHRoaXMucC55K1xudi5nZXRZKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnN1Yj1mdW5jdGlvbih2KXtyZXR1cm4gbmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHRoaXMucC54LXYuZ2V0WCgpLHRoaXMucC55LVxudi5nZXRZKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLm1hZ249ZnVuY3Rpb24oKXtyZXR1cm4oTWF0aC5zcXJ0KCh0aGlzLnAueCp0aGlzLnAueCkrKHRoaXMucC55KnRoaXMucC55KSkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmNyb3NzPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBWZXJ0ZXgodGhpcy5wLnksLXRoaXMucC54KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pc0luQ2lyY2xlPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlUm9idXN0KGEucCxiLnAsYy5wLHRoaXMucCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuaXNDQ1c9ZnVuY3Rpb24oYixjKXtyZXR1cm4oKGIucC54LXRoaXMucC54KSooYy5wLnktdGhpcy5wLnkpLShiLnAueS10aGlzLnAueSkqKGMucC54LXRoaXMucC54KT4wKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5yaWdodE9mPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmlzQ0NXKGUuZGVzdCgpLGUub3JpZygpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5sZWZ0T2Y9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuaXNDQ1coZS5vcmlnKCksZS5kZXN0KCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmJpc2VjdG9yPWZ1bmN0aW9uKGEsYil7dmFyIGR4LGR5LGwxLGwyO2R4PWIuZ2V0WCgpLWEuZ2V0WCgpO2R5PWIuZ2V0WSgpLWEuZ2V0WSgpO2wxPW5ldyBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZShhLmdldFgoKSsoZHgvMi4wKSxhLmdldFkoKStcbihkeS8yLjApLDEuMCk7bDI9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEuZ2V0WCgpLWR5KyhkeC8yLjApLGEuZ2V0WSgpK1xuZHgrKGR5LzIuMCksMS4wKTtyZXR1cm4gbmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGwxLGwyKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbih2MSx2Mil7cmV0dXJuIHYxLnAuZGlzdGFuY2UodjIucCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY2lyY3VtUmFkaXVzUmF0aW89ZnVuY3Rpb24oYixjKXt2YXIgeCxyYWRpdXMsZWRnZUxlbmd0aCxlbDt4PXRoaXMuY2lyY2xlQ2VudGVyKGIsYyk7cmFkaXVzPXRoaXMuZGlzdGFuY2UoeCxiKTtlZGdlTGVuZ3RoPXRoaXMuZGlzdGFuY2UodGhpcyxiKTtlbD10aGlzLmRpc3RhbmNlKGIsYyk7aWYoZWw8ZWRnZUxlbmd0aCl7ZWRnZUxlbmd0aD1lbDt9XG5lbD10aGlzLmRpc3RhbmNlKGMsdGhpcyk7aWYoZWw8ZWRnZUxlbmd0aCl7ZWRnZUxlbmd0aD1lbDt9XG5yZXR1cm4gcmFkaXVzL2VkZ2VMZW5ndGg7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUubWlkUG9pbnQ9ZnVuY3Rpb24oYSl7dmFyIHhtLHltO3htPSh0aGlzLnAueCthLmdldFgoKSkvMi4wO3ltPSh0aGlzLnAueSthLmdldFkoKSkvMi4wO3JldHVybiBuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoeG0seW0pO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmNpcmNsZUNlbnRlcj1mdW5jdGlvbihiLGMpe3ZhciBhLGNhYixjYmMsaGNjLGNjO2E9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHRoaXMuZ2V0WCgpLHRoaXMuZ2V0WSgpKTtjYWI9dGhpcy5iaXNlY3RvcihhLGIpO2NiYz10aGlzLmJpc2VjdG9yKGIsYyk7aGNjPW5ldyBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZShjYWIsY2JjKTtjYz1udWxsO3RyeXtjYz1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoaGNjLmdldFgoKSxoY2MuZ2V0WSgpKTt9Y2F0Y2goZXJyKXt9XG5yZXR1cm4gY2M7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3A9ZnVuY3Rpb24ocGFyZW50R2VvbWV0cnkpe3RoaXMucGFyZW50R2VvbWV0cnk9cGFyZW50R2VvbWV0cnk7dGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkPWZhbHNlO3RoaXMudmFsaWRFcnI9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5pc1ZhbGlkPWZ1bmN0aW9uKGFyZyl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7aWYoaXNOYU4oYXJnLngpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWlzRmluaXRlKGFyZy54KSYmIWlzTmFOKGFyZy54KSl7cmV0dXJuIGZhbHNlO31cbmlmKGlzTmFOKGFyZy55KSl7cmV0dXJuIGZhbHNlO31cbmlmKCFpc0Zpbml0ZShhcmcueSkmJiFpc05hTihhcmcueSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9ZWxzZXt2YXIgaXNWYWxpZE9wPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AoYXJnKTtyZXR1cm4gaXNWYWxpZE9wLmlzVmFsaWQoKTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZT1mdW5jdGlvbih0ZXN0Q29vcmRzLHNlYXJjaFJpbmcsZ3JhcGgpe3ZhciBzZWFyY2hFZGdlPWdyYXBoLmZpbmRFZGdlKHNlYXJjaFJpbmcpO3ZhciBlaUxpc3Q9c2VhcmNoRWRnZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpO2Zvcih2YXIgaT0wO2k8dGVzdENvb3Jkcy5sZW5ndGg7aSsrKXt2YXIgcHQ9dGVzdENvb3Jkc1tpXTtpZighZWlMaXN0LmlzSW50ZXJzZWN0aW9uKHB0KSl7cmV0dXJuIHB0O319XG5yZXR1cm4gbnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuc2V0U2VsZlRvdWNoaW5nUmluZ0Zvcm1pbmdIb2xlVmFsaWQ9ZnVuY3Rpb24oaXNWYWxpZCl7dGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkPWlzVmFsaWQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmlzVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmNoZWNrVmFsaWQodGhpcy5wYXJlbnRHZW9tZXRyeSk7cmV0dXJuIHRoaXMudmFsaWRFcnI9PW51bGw7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmdldFZhbGlkYXRpb25FcnJvcj1mdW5jdGlvbigpe3RoaXMuY2hlY2tWYWxpZCh0aGlzLnBhcmVudEdlb21ldHJ5KTtyZXR1cm4gdGhpcy52YWxpZEVycjt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZD1mdW5jdGlvbihnKXt0aGlzLnZhbGlkRXJyPW51bGw7aWYoZy5pc0VtcHR5KCkpe3JldHVybjt9XG5pZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmNoZWNrVmFsaWRQb2ludChnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpe3RoaXMuY2hlY2tWYWxpZE11bHRpUG9pbnQoZyk7fWVsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKXt0aGlzLmNoZWNrVmFsaWRMaW5lYXJSaW5nKGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5jaGVja1ZhbGlkTGluZVN0cmluZyhnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuY2hlY2tWYWxpZFBvbHlnb24oZyk7fWVsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3RoaXMuY2hlY2tWYWxpZE11bHRpUG9seWdvbihnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7dGhpcy5jaGVja1ZhbGlkR2VvbWV0cnlDb2xsZWN0aW9uKGcpO31lbHNle3Rocm93IGcuY29uc3RydWN0b3I7fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkUG9pbnQ9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnLmdldENvb3JkaW5hdGVzKCkpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkTXVsdGlQb2ludD1mdW5jdGlvbihnKXt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKGcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRMaW5lU3RyaW5nPWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMoZy5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudmFyIGdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZyk7dGhpcy5jaGVja1Rvb0Zld1BvaW50cyhncmFwaCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRMaW5lYXJSaW5nPWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMoZy5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nsb3NlZFJpbmcoZyk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgwLGcpO3RoaXMuY2hlY2tUb29GZXdQb2ludHMoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG52YXIgbGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO2dyYXBoLmNvbXB1dGVTZWxmTm9kZXMobGksdHJ1ZSk7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmdzKGdyYXBoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZFBvbHlnb249ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nsb3NlZFJpbmdzKGcpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG52YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnKTt0aGlzLmNoZWNrVG9vRmV3UG9pbnRzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0NvbnNpc3RlbnRBcmVhKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuaWYoIXRoaXMuaXNTZWxmVG91Y2hpbmdSaW5nRm9ybWluZ0hvbGVWYWxpZCl7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmdzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbnRoaXMuY2hlY2tIb2xlc0luU2hlbGwoZyxncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnRoaXMuY2hlY2tIb2xlc05vdE5lc3RlZChnLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nvbm5lY3RlZEludGVyaW9ycyhncmFwaCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRNdWx0aVBvbHlnb249ZnVuY3Rpb24oZyl7dmFyIGlsPWcuZ2V0TnVtR2VvbWV0cmllcygpO2Zvcih2YXIgaT0wO2k8aWw7aSsrKXt2YXIgcD1nLmdldEdlb21ldHJ5TihpKTt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKHApO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ2xvc2VkUmluZ3MocCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319XG52YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnKTt0aGlzLmNoZWNrVG9vRmV3UG9pbnRzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0NvbnNpc3RlbnRBcmVhKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuaWYoIXRoaXMuaXNTZWxmVG91Y2hpbmdSaW5nRm9ybWluZ0hvbGVWYWxpZCl7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmdzKGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbmZvcih2YXIgaT0wO2k8Zy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcD1nLmdldEdlb21ldHJ5TihpKTt0aGlzLmNoZWNrSG9sZXNJblNoZWxsKHAsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxuZm9yKHZhciBpPTA7aTxnLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBwPWcuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tIb2xlc05vdE5lc3RlZChwLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbnRoaXMuY2hlY2tTaGVsbHNOb3ROZXN0ZWQoZyxncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnRoaXMuY2hlY2tDb25uZWN0ZWRJbnRlcmlvcnMoZ3JhcGgpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKGdjKXtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBnPWdjLmdldEdlb21ldHJ5TihpKTt0aGlzLmNoZWNrVmFsaWQoZyk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzPWZ1bmN0aW9uKGFyZyl7aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3ZhciBwb2x5PWFyZzt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbmZvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fX1lbHNle3ZhciBjb29yZHM9YXJnO2Zvcih2YXIgaT0wO2k8Y29vcmRzLmxlbmd0aDtpKyspe2lmKCFqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuaXNWYWxpZChjb29yZHNbaV0pKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5JTlZBTElEX0NPT1JESU5BVEUsY29vcmRzW2ldKTtyZXR1cm47fX19fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrQ2xvc2VkUmluZ3M9ZnVuY3Rpb24ocG9seSl7dGhpcy5jaGVja0Nsb3NlZFJpbmcocG9seS5nZXRFeHRlcmlvclJpbmcoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbmZvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMuY2hlY2tDbG9zZWRSaW5nKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrQ2xvc2VkUmluZz1mdW5jdGlvbihyaW5nKXtpZighcmluZy5pc0Nsb3NlZCgpKXt2YXIgcHQ9bnVsbDtpZihyaW5nLmdldE51bVBvaW50cygpPj0xKXtwdD1yaW5nLmdldENvb3JkaW5hdGVOKDApO31cbnRoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlJJTkdfTk9UX0NMT1NFRCxwdCk7fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1Rvb0Zld1BvaW50cz1mdW5jdGlvbihncmFwaCl7aWYoZ3JhcGguaGFzVG9vRmV3UG9pbnRzKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5UT09fRkVXX1BPSU5UUyxncmFwaC5nZXRJbnZhbGlkUG9pbnQoKSk7cmV0dXJuO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tDb25zaXN0ZW50QXJlYT1mdW5jdGlvbihncmFwaCl7dmFyIGNhdD1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXIoZ3JhcGgpO3ZhciBpc1ZhbGlkQXJlYT1jYXQuaXNOb2RlQ29uc2lzdGVudEFyZWEoKTtpZighaXNWYWxpZEFyZWEpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlNFTEZfSU5URVJTRUNUSU9OLGNhdC5nZXRJbnZhbGlkUG9pbnQoKSk7cmV0dXJuO31cbmlmKGNhdC5oYXNEdXBsaWNhdGVSaW5ncygpKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5EVVBMSUNBVEVfUklOR1MsY2F0LmdldEludmFsaWRQb2ludCgpKTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3M9ZnVuY3Rpb24oZ3JhcGgpe2Zvcih2YXIgaT1ncmFwaC5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3RoaXMuY2hlY2tOb1NlbGZJbnRlcnNlY3RpbmdSaW5nKGUuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZz1mdW5jdGlvbihlaUxpc3Qpe3ZhciBub2RlU2V0PVtdO3ZhciBpc0ZpcnN0PXRydWU7Zm9yKHZhciBpPWVpTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVpPWkubmV4dCgpO2lmKGlzRmlyc3Qpe2lzRmlyc3Q9ZmFsc2U7Y29udGludWU7fVxuaWYobm9kZVNldC5pbmRleE9mKGVpLmNvb3JkKT49MCl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19TRUxGX0lOVEVSU0VDVElPTixlaS5jb29yZCk7cmV0dXJuO31lbHNle25vZGVTZXQucHVzaChlaS5jb29yZCk7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tIb2xlc0luU2hlbGw9ZnVuY3Rpb24ocCxncmFwaCl7dmFyIHNoZWxsPXAuZ2V0RXh0ZXJpb3JSaW5nKCk7dmFyIHBpcj1uZXcganN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZyhzaGVsbCk7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO3ZhciBob2xlUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoaG9sZS5nZXRDb29yZGluYXRlcygpLHNoZWxsLGdyYXBoKTtpZihob2xlUHQ9PW51bGwpe3JldHVybjt9XG52YXIgb3V0c2lkZT0hcGlyLmlzSW5zaWRlKGhvbGVQdCk7aWYob3V0c2lkZSl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuSE9MRV9PVVRTSURFX1NIRUxMLGhvbGVQdCk7cmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrSG9sZXNOb3ROZXN0ZWQ9ZnVuY3Rpb24ocCxncmFwaCl7dmFyIG5lc3RlZFRlc3Rlcj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIoZ3JhcGgpO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBpbm5lckhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO25lc3RlZFRlc3Rlci5hZGQoaW5uZXJIb2xlKTt9XG52YXIgaXNOb25OZXN0ZWQ9bmVzdGVkVGVzdGVyLmlzTm9uTmVzdGVkKCk7aWYoIWlzTm9uTmVzdGVkKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfSE9MRVMsbmVzdGVkVGVzdGVyLmdldE5lc3RlZFBvaW50KCkpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tTaGVsbHNOb3ROZXN0ZWQ9ZnVuY3Rpb24obXAsZ3JhcGgpe2Zvcih2YXIgaT0wO2k8bXAuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHA9bXAuZ2V0R2VvbWV0cnlOKGkpO3ZhciBzaGVsbD1wLmdldEV4dGVyaW9yUmluZygpO2Zvcih2YXIgaj0wO2o8bXAuZ2V0TnVtR2VvbWV0cmllcygpO2orKyl7aWYoaT09ail7Y29udGludWU7fVxudmFyIHAyPW1wLmdldEdlb21ldHJ5TihqKTt0aGlzLmNoZWNrU2hlbGxOb3ROZXN0ZWQoc2hlbGwscDIsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tTaGVsbE5vdE5lc3RlZD1mdW5jdGlvbihzaGVsbCxwLGdyYXBoKXt2YXIgc2hlbGxQdHM9c2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgcG9seVNoZWxsPXAuZ2V0RXh0ZXJpb3JSaW5nKCk7dmFyIHBvbHlQdHM9cG9seVNoZWxsLmdldENvb3JkaW5hdGVzKCk7dmFyIHNoZWxsUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoc2hlbGxQdHMscG9seVNoZWxsLGdyYXBoKTtpZihzaGVsbFB0PT1udWxsKXtyZXR1cm47fVxudmFyIGluc2lkZVBvbHlTaGVsbD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyhzaGVsbFB0LHBvbHlQdHMpO2lmKCFpbnNpZGVQb2x5U2hlbGwpe3JldHVybjt9XG5pZihwLmdldE51bUludGVyaW9yUmluZygpPD0wKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfU0hFTExTLHNoZWxsUHQpO3JldHVybjt9XG52YXIgYmFkTmVzdGVkUHQ9bnVsbDtmb3IodmFyIGk9MDtpPHAuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT1wLmdldEludGVyaW9yUmluZ04oaSk7YmFkTmVzdGVkUHQ9dGhpcy5jaGVja1NoZWxsSW5zaWRlSG9sZShzaGVsbCxob2xlLGdyYXBoKTtpZihiYWROZXN0ZWRQdD09bnVsbCl7cmV0dXJuO319XG50aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ORVNURURfU0hFTExTLGJhZE5lc3RlZFB0KTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tTaGVsbEluc2lkZUhvbGU9ZnVuY3Rpb24oc2hlbGwsaG9sZSxncmFwaCl7dmFyIHNoZWxsUHRzPXNoZWxsLmdldENvb3JkaW5hdGVzKCk7dmFyIGhvbGVQdHM9aG9sZS5nZXRDb29yZGluYXRlcygpO3ZhciBzaGVsbFB0PWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlKHNoZWxsUHRzLGhvbGUsZ3JhcGgpO2lmKHNoZWxsUHQhPW51bGwpe3ZhciBpbnNpZGVIb2xlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHNoZWxsUHQsaG9sZVB0cyk7aWYoIWluc2lkZUhvbGUpe3JldHVybiBzaGVsbFB0O319XG52YXIgaG9sZVB0PWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlKGhvbGVQdHMsc2hlbGwsZ3JhcGgpO2lmKGhvbGVQdCE9bnVsbCl7dmFyIGluc2lkZVNoZWxsPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKGhvbGVQdCxzaGVsbFB0cyk7aWYoaW5zaWRlU2hlbGwpe3JldHVybiBob2xlUHQ7fVxucmV0dXJuIG51bGw7fVxuanN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgncG9pbnRzIGluIHNoZWxsIGFuZCBob2xlIGFwcGVhciB0byBiZSBlcXVhbCcpO3JldHVybiBudWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja0Nvbm5lY3RlZEludGVyaW9ycz1mdW5jdGlvbihncmFwaCl7dmFyIGNpdD1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIoZ3JhcGgpO2lmKCFjaXQuaXNJbnRlcmlvcnNDb25uZWN0ZWQoKSl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuRElTQ09OTkVDVEVEX0lOVEVSSU9SLGNpdC5nZXRDb29yZGluYXRlKCkpO319O2pzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50PWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDI9ZnVuY3Rpb24oeDEseTEseDIseTIpe3ZhciBzaWduLHN3YXAsayxjb3VudDtjb3VudD0wO3NpZ249MTtpZigoeDE9PT0wLjApfHwoeTI9PT0wLjApKXtpZigoeTE9PT0wLjApfHwoeDI9PT0wLjApKXtyZXR1cm4gMDt9XG5lbHNlIGlmKHkxPjApe2lmKHgyPjApe3JldHVybi1zaWduO31cbmVsc2V7cmV0dXJuIHNpZ247fX1cbmVsc2V7aWYoeDI+MCl7cmV0dXJuIHNpZ247fVxuZWxzZXtyZXR1cm4tc2lnbjt9fX1cbmlmKCh5MT09PTAuMCl8fCh4Mj09PTAuMCkpe2lmKHkyPjApe2lmKHgxPjApe3JldHVybiBzaWduO31cbmVsc2V7cmV0dXJuLXNpZ247fX1cbmVsc2V7aWYoeDE+MCl7cmV0dXJuLXNpZ247fVxuZWxzZXtyZXR1cm4gc2lnbjt9fX1cbmlmKDAuMDx5MSl7aWYoMC4wPHkyKXtpZih5MT55Mil7c2lnbj0tc2lnbjtzd2FwPXgxO3gxPXgyO3gyPXN3YXA7c3dhcD15MTt5MT15Mjt5Mj1zd2FwO319XG5lbHNle2lmKHkxPD0teTIpe3NpZ249LXNpZ247eDI9LXgyO3kyPS15Mjt9XG5lbHNle3N3YXA9eDE7eDE9LXgyO3gyPXN3YXA7c3dhcD15MTt5MT0teTI7eTI9c3dhcDt9fX1cbmVsc2V7aWYoMC4wPHkyKXtpZigteTE8PXkyKXtzaWduPS1zaWduO3gxPS14MTt5MT0teTE7fVxuZWxzZXtzd2FwPS14MTt4MT14Mjt4Mj1zd2FwO3N3YXA9LXkxO3kxPXkyO3kyPXN3YXA7fX1cbmVsc2V7aWYoeTE+PXkyKXt4MT0teDE7eTE9LXkxO3gyPS14Mjt5Mj0teTI7fVxuZWxzZXtzaWduPS1zaWduO3N3YXA9LXgxO3gxPS14Mjt4Mj1zd2FwO3N3YXA9LXkxO3kxPS15Mjt5Mj1zd2FwO319fVxuaWYoMC4wPHgxKXtpZigwLjA8eDIpe2lmKHgxPngyKXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtpZigwLjA8eDIpe3JldHVybi1zaWduO31cbmVsc2V7aWYoeDE+PXgyKXtzaWduPS1zaWduO3gxPS14MTt4Mj0teDI7fVxuZWxzZXtyZXR1cm4tc2lnbjt9fX1cbndoaWxlKHRydWUpe2NvdW50PWNvdW50KzE7az1NYXRoLmZsb29yKHgyL3gxKTt4Mj14Mi1rKngxO3kyPXkyLWsqeTE7aWYoeTI8MC4wKXtyZXR1cm4tc2lnbjt9XG5pZih5Mj55MSl7cmV0dXJuIHNpZ247fVxuaWYoeDE+eDIreDIpe2lmKHkxPHkyK3kyKXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtpZih5MT55Mit5Mil7cmV0dXJuLXNpZ247fVxuZWxzZXt4Mj14MS14Mjt5Mj15MS15MjtzaWduPS1zaWduO319XG5pZih5Mj09PTAuMCl7aWYoeDI9PT0wLjApe3JldHVybiAwO31cbmVsc2V7cmV0dXJuLXNpZ247fX1cbmlmKHgyPT09MC4wKXtyZXR1cm4gc2lnbjt9XG5rPU1hdGguZmxvb3IoeDEveDIpO3gxPXgxLWsqeDI7eTE9eTEtayp5MjtpZih5MTwwLjApe3JldHVybiBzaWduO31cbmlmKHkxPnkyKXtyZXR1cm4tc2lnbjt9XG5pZih4Mj54MSt4MSl7aWYoeTI8eTEreTEpe3JldHVybi1zaWduO319XG5lbHNle2lmKHkyPnkxK3kxKXtyZXR1cm4gc2lnbjt9XG5lbHNle3gxPXgyLXgxO3kxPXkyLXkxO3NpZ249LXNpZ247fX1cbmlmKHkxPT09MC4wKXtpZih4MT09PTAuMCl7cmV0dXJuIDA7fVxuZWxzZXtyZXR1cm4gc2lnbjt9fVxuaWYoeDE9PT0wLjApe3JldHVybi1zaWduO319fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5vcmllbnRhdGlvbkluZGV4PWZ1bmN0aW9uKHAxLHAyLHEpe3ZhciBkeDE9cDIueC1wMS54O3ZhciBkeTE9cDIueS1wMS55O3ZhciBkeDI9cS54LXAyLng7dmFyIGR5Mj1xLnktcDIueTtyZXR1cm4ganN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQuc2lnbk9mRGV0MngyKGR4MSxkeTEsZHgyLGR5Mik7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlPWZ1bmN0aW9uKCl7dGhpcy5zdWJub2RlPW5ldyBBcnJheSg0KTt0aGlzLnN1Ym5vZGVbMF09bnVsbDt0aGlzLnN1Ym5vZGVbMV09bnVsbDt0aGlzLnN1Ym5vZGVbMl09bnVsbDt0aGlzLnN1Ym5vZGVbM109bnVsbDt0aGlzLml0ZW1zPVtdO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZ2V0U3Vibm9kZUluZGV4PWZ1bmN0aW9uKGVudixjZW50cmUpe3ZhciBzdWJub2RlSW5kZXg9LTE7aWYoZW52LmdldE1pblgoKT49Y2VudHJlLngpe2lmKGVudi5nZXRNaW5ZKCk+PWNlbnRyZS55KXtzdWJub2RlSW5kZXg9Mzt9XG5pZihlbnYuZ2V0TWF4WSgpPD1jZW50cmUueSl7c3Vibm9kZUluZGV4PTE7fX1cbmlmKGVudi5nZXRNYXhYKCk8PWNlbnRyZS54KXtpZihlbnYuZ2V0TWluWSgpPj1jZW50cmUueSl7c3Vibm9kZUluZGV4PTI7fVxuaWYoZW52LmdldE1heFkoKTw9Y2VudHJlLnkpe3N1Ym5vZGVJbmRleD0wO319XG5yZXR1cm4gc3Vibm9kZUluZGV4O307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZ2V0SXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmhhc0l0ZW1zPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuaXRlbXMubGVuZ3RoPjApO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGl0ZW0pe3RoaXMuaXRlbXMucHVzaChpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe2lmKCF0aGlzLmlzU2VhcmNoTWF0Y2goaXRlbUVudikpe3JldHVybiBmYWxzZTt9XG52YXIgZm91bmQ9ZmFsc2UsaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe2ZvdW5kPXRoaXMuc3Vibm9kZVtpXS5yZW1vdmUoaXRlbUVudixpdGVtKTtpZihmb3VuZCl7aWYodGhpcy5zdWJub2RlW2ldLmlzUHJ1bmFibGUoKSl7dGhpcy5zdWJub2RlW2ldPW51bGw7fVxuYnJlYWs7fX19XG5pZihmb3VuZCl7cmV0dXJuIGZvdW5kO31cbmlmKHRoaXMuaXRlbXMuaW5kZXhPZihpdGVtKSE9PS0xKXtmb3IodmFyIGk9dGhpcy5pdGVtcy5sZW5ndGgtMTtpPj0wO2ktLSl7aWYodGhpcy5pdGVtc1tpXT09PWl0ZW0pe3RoaXMuaXRlbXMuc3BsaWNlKGksMSk7fX1cbmZvdW5kPXRydWU7fVxucmV0dXJuIGZvdW5kO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuaXNQcnVuYWJsZT1mdW5jdGlvbigpe3JldHVybiEodGhpcy5oYXNDaGlsZHJlbigpfHx0aGlzLmhhc0l0ZW1zKCkpO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuaGFzQ2hpbGRyZW49ZnVuY3Rpb24oKXt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7dmFyIGlzRW1wdHk9dHJ1ZTtpZih0aGlzLml0ZW1zLmxlbmd0aD4wKXtpc0VtcHR5PWZhbHNlO31cbnZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7aWYoIXRoaXMuc3Vibm9kZVtpXS5pc0VtcHR5KCkpe2lzRW1wdHk9ZmFsc2U7fX19XG5yZXR1cm4gaXNFbXB0eTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmFkZEFsbEl0ZW1zPWZ1bmN0aW9uKHJlc3VsdEl0ZW1zKXtyZXN1bHRJdGVtcz1yZXN1bHRJdGVtcy5jb25jYXQodGhpcy5pdGVtcyk7dmFyIGk9MDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtyZXN1bHRJdGVtcz10aGlzLnN1Ym5vZGVbaV0uYWRkQWxsSXRlbXMocmVzdWx0SXRlbXMpO319XG5yZXR1cm4gcmVzdWx0SXRlbXM7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZz1mdW5jdGlvbihzZWFyY2hFbnYscmVzdWx0SXRlbXMpe2lmKCF0aGlzLmlzU2VhcmNoTWF0Y2goc2VhcmNoRW52KSl7cmV0dXJuO31cbnJlc3VsdEl0ZW1zPXJlc3VsdEl0ZW1zLmNvbmNhdCh0aGlzLml0ZW1zKTt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3Jlc3VsdEl0ZW1zPXRoaXMuc3Vibm9kZVtpXS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZyhzZWFyY2hFbnYscmVzdWx0SXRlbXMpO319fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbihzZWFyY2hFbnYsdmlzaXRvcil7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChzZWFyY2hFbnYpKXtyZXR1cm47fVxudGhpcy52aXNpdEl0ZW1zKHNlYXJjaEVudix2aXNpdG9yKTt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3RoaXMuc3Vibm9kZVtpXS52aXNpdChzZWFyY2hFbnYsdmlzaXRvcik7fX19O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnZpc2l0SXRlbXM9ZnVuY3Rpb24oZW52LHZpc2l0b3Ipe3ZhciBpPTAsaWw9dGhpcy5pdGVtcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3Zpc2l0b3IudmlzaXRJdGVtKHRoaXMuaXRlbXNbaV0pO319O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7dmFyIG1heFN1YkRlcHRoPTAsaT0wLHNxZDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtzcWQ9dGhpcy5zdWJub2RlW2ldLmRlcHRoKCk7aWYoc3FkPm1heFN1YkRlcHRoKXttYXhTdWJEZXB0aD1zcWQ7fX19XG5yZXR1cm4gbWF4U3ViRGVwdGgrMTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXt2YXIgc3ViU2l6ZT0wLGk9MDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtzdWJTaXplKz10aGlzLnN1Ym5vZGVbaV0uc2l6ZSgpO319XG5yZXR1cm4gc3ViU2l6ZSt0aGlzLml0ZW1zLmxlbmd0aDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmdldE5vZGVDb3VudD1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5zaXplKCk7fX1cbnJldHVybiBzdWJTaXplKzE7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGU9ZnVuY3Rpb24oZW52LGxldmVsKXtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5lbnY9ZW52O3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5jZW50cmU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5jZW50cmUueD0oZW52LmdldE1pblgoKStlbnYuZ2V0TWF4WCgpKS8yO3RoaXMuY2VudHJlLnk9KGVudi5nZXRNaW5ZKCkrZW52LmdldE1heFkoKSkvMjt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UoKTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUuY3JlYXRlTm9kZT1mdW5jdGlvbihlbnYpe3ZhciBrZXksbm9kZTtrZXk9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuS2V5KGVudik7bm9kZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlKGtleS5nZXRFbnZlbG9wZSgpLGtleS5nZXRMZXZlbCgpKTtyZXR1cm4gbm9kZTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5jcmVhdGVFeHBhbmRlZD1mdW5jdGlvbihub2RlLGFkZEVudil7dmFyIGV4cGFuZEVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKGFkZEVudiksbGFyZ2VyTm9kZTtpZihub2RlIT09bnVsbCl7ZXhwYW5kRW52LmV4cGFuZFRvSW5jbHVkZShub2RlLmVudik7fVxubGFyZ2VyTm9kZT1qc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUuY3JlYXRlTm9kZShleHBhbmRFbnYpO2lmKG5vZGUhPT1udWxsKXtsYXJnZXJOb2RlLmluc2VydE5vZGUobm9kZSk7fVxucmV0dXJuIGxhcmdlck5vZGU7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW52O307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5pc1NlYXJjaE1hdGNoPWZ1bmN0aW9uKHNlYXJjaEVudil7cmV0dXJuIHRoaXMuZW52LmludGVyc2VjdHMoc2VhcmNoRW52KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuZ2V0Tm9kZT1mdW5jdGlvbihzZWFyY2hFbnYpe3ZhciBzdWJub2RlSW5kZXg9dGhpcy5nZXRTdWJub2RlSW5kZXgoc2VhcmNoRW52LHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleCE9PS0xKXtub2RlPXRoaXMuZ2V0U3Vibm9kZShzdWJub2RlSW5kZXgpO3JldHVybiBub2RlLmdldE5vZGUoc2VhcmNoRW52KTt9ZWxzZXtyZXR1cm4gdGhpczt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmZpbmQ9ZnVuY3Rpb24oc2VhcmNoRW52KXt2YXIgc3Vibm9kZUluZGV4PXRoaXMuZ2V0U3Vibm9kZUluZGV4KHNlYXJjaEVudix0aGlzLmNlbnRyZSksbm9kZTtpZihzdWJub2RlSW5kZXg9PT0tMSl7cmV0dXJuIHRoaXM7fVxuaWYodGhpcy5zdWJub2RlW3N1Ym5vZGVJbmRleF0hPT1udWxsKXtub2RlPXRoaXMuc3Vibm9kZVtzdWJub2RlSW5kZXhdO3JldHVybiBub2RlLmZpbmQoc2VhcmNoRW52KTt9XG5yZXR1cm4gdGhpczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuaW5zZXJ0Tm9kZT1mdW5jdGlvbihub2RlKXt2YXIgaW5kZXg9dGhpcy5nZXRTdWJub2RlSW5kZXgobm9kZS5lbnYsdGhpcy5jZW50cmUpLGNoaWxkTm9kZTtpZihub2RlLmxldmVsPT09dGhpcy5sZXZlbC0xKXt0aGlzLnN1Ym5vZGVbaW5kZXhdPW5vZGU7fWVsc2V7Y2hpbGROb2RlPXRoaXMuY3JlYXRlU3Vibm9kZShpbmRleCk7Y2hpbGROb2RlLmluc2VydE5vZGUobm9kZSk7dGhpcy5zdWJub2RlW2luZGV4XT1jaGlsZE5vZGU7fX07anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5nZXRTdWJub2RlPWZ1bmN0aW9uKGluZGV4KXtpZih0aGlzLnN1Ym5vZGVbaW5kZXhdPT09bnVsbCl7dGhpcy5zdWJub2RlW2luZGV4XT10aGlzLmNyZWF0ZVN1Ym5vZGUoaW5kZXgpO31cbnJldHVybiB0aGlzLnN1Ym5vZGVbaW5kZXhdO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5jcmVhdGVTdWJub2RlPWZ1bmN0aW9uKGluZGV4KXt2YXIgbWlueD0wLjAsbWF4eD0wLjAsbWlueT0wLjAsbWF4eT0wLjAsc3FFbnYsbm9kZTtzd2l0Y2goaW5kZXgpe2Nhc2UgMDptaW54PXRoaXMuZW52LmdldE1pblgoKTttYXh4PXRoaXMuY2VudHJlLng7bWlueT10aGlzLmVudi5nZXRNaW5ZKCk7bWF4eT10aGlzLmNlbnRyZS55O2JyZWFrO2Nhc2UgMTptaW54PXRoaXMuY2VudHJlLng7bWF4eD10aGlzLmVudi5nZXRNYXhYKCk7bWlueT10aGlzLmVudi5nZXRNaW5ZKCk7bWF4eT10aGlzLmNlbnRyZS55O2JyZWFrO2Nhc2UgMjptaW54PXRoaXMuZW52LmdldE1pblgoKTttYXh4PXRoaXMuY2VudHJlLng7bWlueT10aGlzLmNlbnRyZS55O21heHk9dGhpcy5lbnYuZ2V0TWF4WSgpO2JyZWFrO2Nhc2UgMzptaW54PXRoaXMuY2VudHJlLng7bWF4eD10aGlzLmVudi5nZXRNYXhYKCk7bWlueT10aGlzLmNlbnRyZS55O21heHk9dGhpcy5lbnYuZ2V0TWF4WSgpO2JyZWFrO31cbnNxRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUobWlueCxtYXh4LG1pbnksbWF4eSk7bm9kZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlKHNxRW52LHRoaXMubGV2ZWwtMSk7cmV0dXJuIG5vZGU7fTsoZnVuY3Rpb24oKXtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlPWZ1bmN0aW9uKCl7dGhpcy5yb3Q9bnVsbDt0aGlzLnZlcnRleD1udWxsO3RoaXMubmV4dD1udWxsO3RoaXMuZGF0YT1udWxsO307dmFyIFF1YWRFZGdlPWpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2U7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5tYWtlRWRnZT1mdW5jdGlvbihvLGQpe3ZhciBxMCxxMSxxMixxMyxiYXNlO3EwPW5ldyBRdWFkRWRnZSgpO3ExPW5ldyBRdWFkRWRnZSgpO3EyPW5ldyBRdWFkRWRnZSgpO3EzPW5ldyBRdWFkRWRnZSgpO3EwLnJvdD1xMTtxMS5yb3Q9cTI7cTIucm90PXEzO3EzLnJvdD1xMDtxMC5zZXROZXh0KHEwKTtxMS5zZXROZXh0KHEzKTtxMi5zZXROZXh0KHEyKTtxMy5zZXROZXh0KHExKTtiYXNlPXEwO2Jhc2Uuc2V0T3JpZyhvKTtiYXNlLnNldERlc3QoZCk7cmV0dXJuIGJhc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLmNvbm5lY3Q9ZnVuY3Rpb24oYSxiKXt2YXIgZT1RdWFkRWRnZS5tYWtlRWRnZShhLmRlc3QoKSxiLm9yaWcoKSk7UXVhZEVkZ2Uuc3BsaWNlKGUsYS5sTmV4dCgpKTtRdWFkRWRnZS5zcGxpY2UoZS5zeW0oKSxiKTtyZXR1cm4gZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlPWZ1bmN0aW9uKGEsYil7dmFyIGFscGhhLGJldGEsdDEsdDIsdDMsdDQ7YWxwaGE9YS5vTmV4dCgpLnJvdDtiZXRhPWIub05leHQoKS5yb3Q7dDE9Yi5vTmV4dCgpO3QyPWEub05leHQoKTt0Mz1iZXRhLm9OZXh0KCk7dDQ9YWxwaGEub05leHQoKTthLnNldE5leHQodDEpO2Iuc2V0TmV4dCh0Mik7YWxwaGEuc2V0TmV4dCh0Myk7YmV0YS5zZXROZXh0KHQ0KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3dhcD1mdW5jdGlvbihlKXt2YXIgYSxiO2E9ZS5vUHJldigpO2I9ZS5zeW0oKS5vUHJldigpO1F1YWRFZGdlLnNwbGljZShlLGEpO1F1YWRFZGdlLnNwbGljZShlLnN5bSgpLGIpO1F1YWRFZGdlLnNwbGljZShlLGEubE5leHQoKSk7UXVhZEVkZ2Uuc3BsaWNlKGUuc3ltKCksYi5sTmV4dCgpKTtlLnNldE9yaWcoYS5kZXN0KCkpO2Uuc2V0RGVzdChiLmRlc3QoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5nZXRQcmltYXJ5PWZ1bmN0aW9uKCl7aWYodGhpcy5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpLmNvbXBhcmVUbyh0aGlzLmRlc3QoKS5nZXRDb29yZGluYXRlKCkpPD0wKXtyZXR1cm4gdGhpczt9XG5lbHNle3JldHVybiB0aGlzLnN5bSgpO319O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF0YTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmRlbGV0ZV9qc3RzPWZ1bmN0aW9uKCl7dGhpcy5yb3Q9bnVsbDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmlzTGl2ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJvdCE9PW51bGw7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zZXROZXh0PWZ1bmN0aW9uKG5leHQpe3RoaXMubmV4dD1uZXh0O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuaW52Um90PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90LnN5bSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuc3ltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90LnJvdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLm9OZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLm9QcmV2PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90Lm5leHQucm90O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZE5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW0oKS5vTmV4dCgpLnN5bSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZFByZXY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZSb3QoKS5vTmV4dCgpLmludlJvdCgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUubE5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZSb3QoKS5vTmV4dCgpLnJvdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmxQcmV2PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dC5zeW0oKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnJOZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90Lm5leHQuaW52Um90KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5yUHJldj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN5bSgpLm9OZXh0KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zZXRPcmlnPWZ1bmN0aW9uKG8pe3RoaXMudmVydGV4PW87fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zZXREZXN0PWZ1bmN0aW9uKGQpe3RoaXMuc3ltKCkuc2V0T3JpZyhkKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLm9yaWc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52ZXJ0ZXg7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5kZXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3ltKCkub3JpZygpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3JpZygpLmdldENvb3JkaW5hdGUoKS5kaXN0YW5jZShkZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmVxdWFsc05vbk9yaWVudGVkPWZ1bmN0aW9uKHFlKXtpZih0aGlzLmVxdWFsc09yaWVudGVkKHFlKSl7cmV0dXJuIHRydWU7fVxuaWYodGhpcy5lcXVhbHNPcmllbnRlZChxZS5zeW0oKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmVxdWFsc09yaWVudGVkPWZ1bmN0aW9uKHFlKXtpZih0aGlzLm9yaWcoKS5nZXRDb29yZGluYXRlKCkuZXF1YWxzMkQocWUub3JpZygpLmdldENvb3JkaW5hdGUoKSkmJnRoaXMuZGVzdCgpLmdldENvb3JkaW5hdGUoKS5lcXVhbHMyRChxZS5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUudG9MaW5lU2VnbWVudD1mdW5jdGlvbigpXG57cmV0dXJuIG5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQodGhpcy52ZXJ0ZXguZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBwMCxwMTtwMD10aGlzLnZlcnRleC5nZXRDb29yZGluYXRlKCk7cDE9dGhpcy5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpO3JldHVybiBqc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmcocDAscDEpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguRWRnZUVuZD1mdW5jdGlvbihlZGdlLHAwLHAxLGxhYmVsKXt0aGlzLmVkZ2U9ZWRnZTtpZihwMCYmcDEpe3RoaXMuaW5pdChwMCxwMSk7fVxuaWYobGFiZWwpe3RoaXMubGFiZWw9bGFiZWx8fG51bGw7fX07anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZWRnZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUubm9kZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLnAwPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUucDE9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5keD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmR5PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUucXVhZHJhbnQ9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKHAwLHAxKXt0aGlzLnAwPXAwO3RoaXMucDE9cDE7dGhpcy5keD1wMS54LXAwLng7dGhpcy5keT1wMS55LXAwLnk7dGhpcy5xdWFkcmFudD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudCh0aGlzLmR4LHRoaXMuZHkpO0Fzc2VydC5pc1RydWUoISh0aGlzLmR4PT09MCYmdGhpcy5keT09PTApLCdFZGdlRW5kIHdpdGggaWRlbnRpY2FsIGVuZHBvaW50cyBmb3VuZCcpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAwO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RGlyZWN0ZWRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDE7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRRdWFkcmFudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnF1YWRyYW50O307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RHg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5keDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmdldER5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZHk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5zZXROb2RlPWZ1bmN0aW9uKG5vZGUpe3RoaXMubm9kZT1ub2RlO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0Tm9kZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGU7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY29tcGFyZURpcmVjdGlvbihlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmNvbXBhcmVEaXJlY3Rpb249ZnVuY3Rpb24oZSl7aWYodGhpcy5keD09PWUuZHgmJnRoaXMuZHk9PT1lLmR5KVxucmV0dXJuIDA7aWYodGhpcy5xdWFkcmFudD5lLnF1YWRyYW50KVxucmV0dXJuIDE7aWYodGhpcy5xdWFkcmFudDxlLnF1YWRyYW50KVxucmV0dXJuLTE7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24oZS5wMCxlLnAxLHRoaXMucDEpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuY29tcHV0ZUxhYmVsPWZ1bmN0aW9uKGJvdW5kYXJ5Tm9kZVJ1bGUpe307fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlcj1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm1pbkluZGV4PS0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5taW5Db29yZD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5taW5EZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5vcmllbnRlZERlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcmllbnRlZERlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW5Db29yZDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5maW5kRWRnZT1mdW5jdGlvbihkaXJFZGdlTGlzdCl7Zm9yKHZhciBpPWRpckVkZ2VMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoIWRlLmlzRm9yd2FyZCgpKVxuY29udGludWU7dGhpcy5jaGVja0ZvclJpZ2h0bW9zdENvb3JkaW5hdGUoZGUpO31cbmpzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMubWluSW5kZXghPT0wfHx0aGlzLm1pbkNvb3JkLmVxdWFscyh0aGlzLm1pbkRlLmdldENvb3JkaW5hdGUoKSksJ2luY29uc2lzdGVuY3kgaW4gcmlnaHRtb3N0IHByb2Nlc3NpbmcnKTtpZih0aGlzLm1pbkluZGV4PT09MCl7dGhpcy5maW5kUmlnaHRtb3N0RWRnZUF0Tm9kZSgpO31lbHNle3RoaXMuZmluZFJpZ2h0bW9zdEVkZ2VBdFZlcnRleCgpO31cbnRoaXMub3JpZW50ZWREZT10aGlzLm1pbkRlO3ZhciByaWdodG1vc3RTaWRlPXRoaXMuZ2V0UmlnaHRtb3N0U2lkZSh0aGlzLm1pbkRlLHRoaXMubWluSW5kZXgpO2lmKHJpZ2h0bW9zdFNpZGU9PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpe3RoaXMub3JpZW50ZWREZT10aGlzLm1pbkRlLmdldFN5bSgpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5maW5kUmlnaHRtb3N0RWRnZUF0Tm9kZT1mdW5jdGlvbigpe3ZhciBub2RlPXRoaXMubWluRGUuZ2V0Tm9kZSgpO3ZhciBzdGFyPW5vZGUuZ2V0RWRnZXMoKTt0aGlzLm1pbkRlPXN0YXIuZ2V0UmlnaHRtb3N0RWRnZSgpO2lmKCF0aGlzLm1pbkRlLmlzRm9yd2FyZCgpKXt0aGlzLm1pbkRlPXRoaXMubWluRGUuZ2V0U3ltKCk7dGhpcy5taW5JbmRleD10aGlzLm1pbkRlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpLmxlbmd0aC0xO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5maW5kUmlnaHRtb3N0RWRnZUF0VmVydGV4PWZ1bmN0aW9uKCl7dmFyIHB0cz10aGlzLm1pbkRlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHRoaXMubWluSW5kZXg+MCYmdGhpcy5taW5JbmRleDxwdHMubGVuZ3RoLCdyaWdodG1vc3QgcG9pbnQgZXhwZWN0ZWQgdG8gYmUgaW50ZXJpb3IgdmVydGV4IG9mIGVkZ2UnKTt2YXIgcFByZXY9cHRzW3RoaXMubWluSW5kZXgtMV07dmFyIHBOZXh0PXB0c1t0aGlzLm1pbkluZGV4KzFdO3ZhciBvcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHRoaXMubWluQ29vcmQscE5leHQscFByZXYpO3ZhciB1c2VQcmV2PWZhbHNlO2lmKHBQcmV2Lnk8dGhpcy5taW5Db29yZC55JiZwTmV4dC55PHRoaXMubWluQ29vcmQueSYmb3JpZW50YXRpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRSl7dXNlUHJldj10cnVlO31lbHNlIGlmKHBQcmV2Lnk+dGhpcy5taW5Db29yZC55JiZwTmV4dC55PnRoaXMubWluQ29vcmQueSYmb3JpZW50YXRpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFKXt1c2VQcmV2PXRydWU7fVxuaWYodXNlUHJldil7dGhpcy5taW5JbmRleD10aGlzLm1pbkluZGV4LTE7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmNoZWNrRm9yUmlnaHRtb3N0Q29vcmRpbmF0ZT1mdW5jdGlvbihkZSl7dmFyIGNvb3JkPWRlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8Y29vcmQubGVuZ3RoLTE7aSsrKXtpZih0aGlzLm1pbkNvb3JkPT09bnVsbHx8Y29vcmRbaV0ueD50aGlzLm1pbkNvb3JkLngpe3RoaXMubWluRGU9ZGU7dGhpcy5taW5JbmRleD1pO3RoaXMubWluQ29vcmQ9Y29vcmRbaV07fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5nZXRSaWdodG1vc3RTaWRlPWZ1bmN0aW9uKGRlLGluZGV4KXt2YXIgc2lkZT10aGlzLmdldFJpZ2h0bW9zdFNpZGVPZlNlZ21lbnQoZGUsaW5kZXgpO2lmKHNpZGU8MClcbnNpZGU9dGhpcy5nZXRSaWdodG1vc3RTaWRlT2ZTZWdtZW50KGRlLGluZGV4LTEpO2lmKHNpZGU8MCl7dGhpcy5taW5Db29yZD1udWxsO3RoaXMuY2hlY2tGb3JSaWdodG1vc3RDb29yZGluYXRlKGRlKTt9XG5yZXR1cm4gc2lkZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyLnByb3RvdHlwZS5nZXRSaWdodG1vc3RTaWRlT2ZTZWdtZW50PWZ1bmN0aW9uKGRlLGkpe3ZhciBlPWRlLmdldEVkZ2UoKTt2YXIgY29vcmQ9ZS5nZXRDb29yZGluYXRlcygpO2lmKGk8MHx8aSsxPj1jb29yZC5sZW5ndGgpXG5yZXR1cm4tMTtpZihjb29yZFtpXS55PT1jb29yZFtpKzFdLnkpXG5yZXR1cm4tMTt2YXIgcG9zPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQ7aWYoY29vcmRbaV0ueTxjb29yZFtpKzFdLnkpXG5wb3M9anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQ7cmV0dXJuIHBvczt9OyhmdW5jdGlvbigpe2pzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvcj1mdW5jdGlvbihzdWJkaXYpe3RoaXMuc3ViZGl2PXN1YmRpdjt0aGlzLmlzVXNpbmdUb2xlcmFuY2U9c3ViZGl2LmdldFRvbGVyYW5jZSgpPjAuMDt9O2pzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvci5wcm90b3R5cGUuaW5zZXJ0U2l0ZXM9ZnVuY3Rpb24odmVydGljZXMpe3ZhciBpPTAsaWw9dmVydGljZXMubGVuZ3RoLHY7Zm9yKGk7aTxpbDtpKyspe3Y9dmVydGljZXNbaV07dGhpcy5pbnNlcnRTaXRlKHYpO319O2pzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvci5wcm90b3R5cGUuaW5zZXJ0U2l0ZT1mdW5jdGlvbih2KXt2YXIgZSxiYXNlLHN0YXJ0RWRnZSx0O2U9dGhpcy5zdWJkaXYubG9jYXRlKHYpO2lmKHRoaXMuc3ViZGl2LmlzVmVydGV4T2ZFZGdlKGUsdikpe3JldHVybiBlO31cbmVsc2UgaWYodGhpcy5zdWJkaXYuaXNPbkVkZ2UoZSx2LmdldENvb3JkaW5hdGUoKSkpe2U9ZS5vUHJldigpO3RoaXMuc3ViZGl2LmRlbGV0ZV9qc3RzKGUub05leHQoKSk7fVxuYmFzZT10aGlzLnN1YmRpdi5tYWtlRWRnZShlLm9yaWcoKSx2KTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShiYXNlLGUpO3N0YXJ0RWRnZT1iYXNlO2Rve2Jhc2U9dGhpcy5zdWJkaXYuY29ubmVjdChlLGJhc2Uuc3ltKCkpO2U9YmFzZS5vUHJldigpO313aGlsZShlLmxOZXh0KCkhPXN0YXJ0RWRnZSk7ZG97dD1lLm9QcmV2KCk7aWYodC5kZXN0KCkucmlnaHRPZihlKSYmdi5pc0luQ2lyY2xlKGUub3JpZygpLHQuZGVzdCgpLGUuZGVzdCgpKSl7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zd2FwKGUpO2U9ZS5vUHJldigpO31lbHNlIGlmKGUub05leHQoKT09c3RhcnRFZGdlKXtyZXR1cm4gYmFzZTt9ZWxzZXtlPWUub05leHQoKS5sUHJldigpO319d2hpbGUodHJ1ZSk7fTt9KCkpO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYT1mdW5jdGlvbigpe3RoaXMuYmFzZVB0PW51bGw7dGhpcy50cmlhbmdsZUNlbnQzPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMuY2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLmNnMz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYmFzZVB0PW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS50cmlhbmdsZUNlbnQzPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hcmVhc3VtMj0wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuY2czPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5jZW50U3VtPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS50b3RhbExlbmd0aD0wLjA7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXt2YXIgcG9seT1nZW9tO3RoaXMuc2V0QmFzZVBvaW50KHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZU4oMCkpO3RoaXMuYWRkMyhwb2x5KTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2MuZ2V0R2VvbWV0cnlOKGkpKTt9fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIEFycmF5KXt0aGlzLmFkZDIoZ2VvbSk7fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKHJpbmcpe3RoaXMuc2V0QmFzZVBvaW50KHJpbmdbMF0pO3RoaXMuYWRkU2hlbGwocmluZyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7dmFyIGNlbnQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7aWYoTWF0aC5hYnModGhpcy5hcmVhc3VtMik+MC4wKXtjZW50Lng9dGhpcy5jZzMueC8zL3RoaXMuYXJlYXN1bTI7Y2VudC55PXRoaXMuY2czLnkvMy90aGlzLmFyZWFzdW0yO31lbHNle2NlbnQueD10aGlzLmNlbnRTdW0ueC90aGlzLnRvdGFsTGVuZ3RoO2NlbnQueT10aGlzLmNlbnRTdW0ueS90aGlzLnRvdGFsTGVuZ3RoO31cbnJldHVybiBjZW50O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5zZXRCYXNlUG9pbnQ9ZnVuY3Rpb24oYmFzZVB0KXtpZih0aGlzLmJhc2VQdD09bnVsbClcbnRoaXMuYmFzZVB0PWJhc2VQdDt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkMz1mdW5jdGlvbihwb2x5KXt0aGlzLmFkZFNoZWxsKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5hZGRIb2xlKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKS5nZXRDb29yZGluYXRlcygpKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZFNoZWxsPWZ1bmN0aW9uKHB0cyl7dmFyIGlzUG9zaXRpdmVBcmVhPSFqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5iYXNlUHQscHRzW2ldLHB0c1tpKzFdLGlzUG9zaXRpdmVBcmVhKTt9XG50aGlzLmFkZExpbmVhclNlZ21lbnRzKHB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZEhvbGU9ZnVuY3Rpb24ocHRzKXt2YXIgaXNQb3NpdGl2ZUFyZWE9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHB0cyk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt0aGlzLmFkZFRyaWFuZ2xlKHRoaXMuYmFzZVB0LHB0c1tpXSxwdHNbaSsxXSxpc1Bvc2l0aXZlQXJlYSk7fVxudGhpcy5hZGRMaW5lYXJTZWdtZW50cyhwdHMpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGRUcmlhbmdsZT1mdW5jdGlvbihwMCxwMSxwMixpc1Bvc2l0aXZlQXJlYSl7dmFyIHNpZ249KGlzUG9zaXRpdmVBcmVhKT8xLjA6LTEuMDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEuY2VudHJvaWQzKHAwLHAxLHAyLHRoaXMudHJpYW5nbGVDZW50Myk7dmFyIGFyZWEyPWpzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5hcmVhMihwMCxwMSxwMik7dGhpcy5jZzMueCs9c2lnbiphcmVhMip0aGlzLnRyaWFuZ2xlQ2VudDMueDt0aGlzLmNnMy55Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My55O3RoaXMuYXJlYXN1bTIrPXNpZ24qYXJlYTI7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEuY2VudHJvaWQzPWZ1bmN0aW9uKHAxLHAyLHAzLGMpe2MueD1wMS54K3AyLngrcDMueDtjLnk9cDEueStwMi55K3AzLnk7cmV0dXJuO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLmFyZWEyPWZ1bmN0aW9uKHAxLHAyLHAzKXtyZXR1cm4ocDIueC1wMS54KSoocDMueS1wMS55KS0ocDMueC1wMS54KSoocDIueS1wMS55KTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkTGluZWFyU2VnbWVudHM9ZnVuY3Rpb24ocHRzKXtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3ZhciBzZWdtZW50TGVuPXB0c1tpXS5kaXN0YW5jZShwdHNbaSsxXSk7dGhpcy50b3RhbExlbmd0aCs9c2VnbWVudExlbjt2YXIgbWlkeD0ocHRzW2ldLngrcHRzW2krMV0ueCkvMjt0aGlzLmNlbnRTdW0ueCs9c2VnbWVudExlbiptaWR4O3ZhciBtaWR5PShwdHNbaV0ueStwdHNbaSsxXS55KS8yO3RoaXMuY2VudFN1bS55Kz1zZWdtZW50TGVuKm1pZHk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudD1mdW5jdGlvbihlZGdlLHB0SW5kZXgpe3RoaXMuZWRnZT1lZGdlO3RoaXMucHRJbmRleD1wdEluZGV4O3RoaXMucHRzPWVkZ2UuZ2V0Q29vcmRpbmF0ZXMoKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQucHJvdG90eXBlLmVkZ2U9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5wdEluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0TWluWD1mdW5jdGlvbigpe3ZhciB4MT10aGlzLnB0c1t0aGlzLnB0SW5kZXhdLng7dmFyIHgyPXRoaXMucHRzW3RoaXMucHRJbmRleCsxXS54O2lmKHgxPHgyKXtyZXR1cm4geDE7fVxucmV0dXJuIHgyO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuZ2V0TWF4WD1mdW5jdGlvbigpe3ZhciB4MT10aGlzLnB0c1t0aGlzLnB0SW5kZXhdLng7dmFyIHgyPXRoaXMucHRzW3RoaXMucHRJbmRleCsxXS54O2lmKHgxPngyKXtyZXR1cm4geDE7fVxucmV0dXJuIHgyO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oc3Msc2kpe3NpLmFkZEludGVyc2VjdGlvbnModGhpcy5lZGdlLHRoaXMucHRJbmRleCxzcy5lZGdlLHNzLnB0SW5kZXgpO307anN0cy5pbmRleC5xdWFkdHJlZS5Sb290PWZ1bmN0aW9uKCl7anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuY29uc3RydWN0b3IuYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMub3JpZ2luPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgwLjAsMC4wKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UoKTtqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3QucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe3ZhciBpbmRleD10aGlzLmdldFN1Ym5vZGVJbmRleChpdGVtRW52LHRoaXMub3JpZ2luKTtpZihpbmRleD09PS0xKXt0aGlzLmFkZChpdGVtKTtyZXR1cm47fVxudmFyIG5vZGU9dGhpcy5zdWJub2RlW2luZGV4XTtpZihub2RlPT09bnVsbHx8IW5vZGUuZ2V0RW52ZWxvcGUoKS5jb250YWlucyhpdGVtRW52KSl7dmFyIGxhcmdlck5vZGU9anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLmNyZWF0ZUV4cGFuZGVkKG5vZGUsaXRlbUVudik7dGhpcy5zdWJub2RlW2luZGV4XT1sYXJnZXJOb2RlO31cbnRoaXMuaW5zZXJ0Q29udGFpbmVkKHRoaXMuc3Vibm9kZVtpbmRleF0saXRlbUVudixpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGUuaW5zZXJ0Q29udGFpbmVkPWZ1bmN0aW9uKHRyZWUsaXRlbUVudixpdGVtKXt2YXIgaXNaZXJvWCxpc1plcm9ZLG5vZGU7aXNaZXJvWD1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aChpdGVtRW52LmdldE1pblgoKSxpdGVtRW52LmdldE1heFgoKSk7aXNaZXJvWT1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aChpdGVtRW52LmdldE1pblkoKSxpdGVtRW52LmdldE1heFkoKSk7aWYoaXNaZXJvWHx8aXNaZXJvWSl7bm9kZT10cmVlLmZpbmQoaXRlbUVudik7fWVsc2V7bm9kZT10cmVlLmdldE5vZGUoaXRlbUVudik7fVxubm9kZS5hZGQoaXRlbSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3QucHJvdG90eXBlLmlzU2VhcmNoTWF0Y2g9ZnVuY3Rpb24oc2VhcmNoRW52KXtyZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci50b0ludEFycmF5PWZ1bmN0aW9uKGxpc3Qpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9bGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVsZW1lbnQ9aS5uZXh0KCk7YXJyYXkucHVzaChlbGVtZW50KTt9XG5yZXR1cm4gYXJyYXk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci5wcm90b3R5cGUuZ2V0Q2hhaW5TdGFydEluZGljZXM9ZnVuY3Rpb24ocHRzKXt2YXIgc3RhcnQ9MDt2YXIgc3RhcnRJbmRleExpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtzdGFydEluZGV4TGlzdC5hZGQoc3RhcnQpO2Rve3ZhciBsYXN0PXRoaXMuZmluZENoYWluRW5kKHB0cyxzdGFydCk7c3RhcnRJbmRleExpc3QuYWRkKGxhc3QpO3N0YXJ0PWxhc3Q7fXdoaWxlKHN0YXJ0PHB0cy5sZW5ndGgtMSk7dmFyIHN0YXJ0SW5kZXg9anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkluZGV4ZXIudG9JbnRBcnJheShzdGFydEluZGV4TGlzdCk7cmV0dXJuIHN0YXJ0SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci5wcm90b3R5cGUuZmluZENoYWluRW5kPWZ1bmN0aW9uKHB0cyxzdGFydCl7dmFyIGNoYWluUXVhZD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwdHNbc3RhcnRdLHB0c1tzdGFydCsxXSk7dmFyIGxhc3Q9c3RhcnQrMTt3aGlsZShsYXN0PHB0cy5sZW5ndGgpe3ZhciBxdWFkPWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHB0c1tsYXN0LTFdLHB0c1tsYXN0XSk7aWYocXVhZCE9Y2hhaW5RdWFkKXticmVhazt9XG5sYXN0Kys7fVxucmV0dXJuIGxhc3QtMTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyPWZ1bmN0aW9uKGxpKXt0aGlzLmxpPWxpO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlPW5ldyBqc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3IoKTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlcjtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5pc0FkamFjZW50U2VnbWVudHM9ZnVuY3Rpb24oaTEsaTIpe3JldHVybiBNYXRoLmFicyhpMS1pMik9PT0xO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLl9oYXNJbnRlcnNlY3Rpb249ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc1Byb3Blcj1mYWxzZTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3I9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc0ludGVyaW9yPWZhbHNlO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5wcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5pc1NlbGZJbnRlcnNlY3Rpb249bnVsbDtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUubnVtSW50ZXJzZWN0aW9ucz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1JbnRlcmlvckludGVyc2VjdGlvbnM9MDtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUubnVtUHJvcGVySW50ZXJzZWN0aW9ucz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1UZXN0cz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5nZXRMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5saTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BlckludGVyc2VjdGlvblBvaW50O307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc0ludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNJbnRlcnNlY3Rpb247fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzUHJvcGVyO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmhhc1Byb3BlckludGVyaW9ySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzUHJvcGVySW50ZXJpb3I7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzSW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcmlvcjt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5pc1RyaXZpYWxJbnRlcnNlY3Rpb249ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYoZTA9PWUxKXtpZih0aGlzLmxpLmdldEludGVyc2VjdGlvbk51bSgpPT0xKXtpZihqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5pc0FkamFjZW50U2VnbWVudHMoc2VnSW5kZXgwLHNlZ0luZGV4MSkpXG5yZXR1cm4gdHJ1ZTtpZihlMC5pc0Nsb3NlZCgpKXt2YXIgbWF4U2VnSW5kZXg9ZTAuc2l6ZSgpLTE7aWYoKHNlZ0luZGV4MD09PTAmJnNlZ0luZGV4MT09PW1heFNlZ0luZGV4KXx8KHNlZ0luZGV4MT09PTAmJnNlZ0luZGV4MD09PW1heFNlZ0luZGV4KSl7cmV0dXJuIHRydWU7fX19fVxucmV0dXJuIGZhbHNlO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLnByb2Nlc3NJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEmJnNlZ0luZGV4MD09PXNlZ0luZGV4MSlcbnJldHVybjt0aGlzLm51bVRlc3RzKys7dmFyIHAwMD1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MF07dmFyIHAwMT1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MCsxXTt2YXIgcDEwPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxXTt2YXIgcDExPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxKzFdO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMDAscDAxLHAxMCxwMTEpO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpe3RoaXMubnVtSW50ZXJzZWN0aW9ucysrO2lmKHRoaXMubGkuaXNJbnRlcmlvckludGVyc2VjdGlvbigpKXt0aGlzLm51bUludGVyaW9ySW50ZXJzZWN0aW9ucysrO3RoaXMuaGFzSW50ZXJpb3I9dHJ1ZTt9XG5pZighdGhpcy5pc1RyaXZpYWxJbnRlcnNlY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSkpe3RoaXMuX2hhc0ludGVyc2VjdGlvbj10cnVlO2UwLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDAsMCk7ZTEuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MSwxKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpe3RoaXMubnVtUHJvcGVySW50ZXJzZWN0aW9ucysrO3RoaXMuaGFzUHJvcGVyPXRydWU7dGhpcy5oYXNQcm9wZXJJbnRlcmlvcj10cnVlO319fX07anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uPWZ1bmN0aW9uKHBvbHlzKXt0aGlzLmlucHV0UG9seXM9cG9seXM7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi51bmlvbj1mdW5jdGlvbihwb2x5cyl7dmFyIG9wPW5ldyBqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbihwb2x5cyk7cmV0dXJuIG9wLnVuaW9uKCk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuaW5wdXRQb2x5cztqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuU1RSVFJFRV9OT0RFX0NBUEFDSVRZPTQ7anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5pbnB1dFBvbHlzLmxlbmd0aD09PTApe3JldHVybiBudWxsO31cbnRoaXMuZ2VvbUZhY3Rvcnk9dGhpcy5pbnB1dFBvbHlzWzBdLmdldEZhY3RvcnkoKTt2YXIgaW5kZXg9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlKHRoaXMuU1RSVFJFRV9OT0RFX0NBUEFDSVRZKTtmb3IodmFyIGk9MCxsPXRoaXMuaW5wdXRQb2x5cy5sZW5ndGg7aTxsO2krKyl7dmFyIGl0ZW09dGhpcy5pbnB1dFBvbHlzW2ldO2luZGV4Lmluc2VydChpdGVtLmdldEVudmVsb3BlSW50ZXJuYWwoKSxpdGVtKTt9XG52YXIgaXRlbVRyZWU9aW5kZXguaXRlbXNUcmVlKCk7dmFyIHVuaW9uQWxsPXRoaXMudW5pb25UcmVlKGl0ZW1UcmVlKTtyZXR1cm4gdW5pb25BbGw7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUudW5pb25UcmVlPWZ1bmN0aW9uKGdlb21UcmVlKXt2YXIgZ2VvbXM9dGhpcy5yZWR1Y2VUb0dlb21ldHJpZXMoZ2VvbVRyZWUpO3ZhciB1bmlvbj10aGlzLmJpbmFyeVVuaW9uKGdlb21zKTtyZXR1cm4gdW5pb247fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuYmluYXJ5VW5pb249ZnVuY3Rpb24oZ2VvbXMsc3RhcnQsZW5kKXtzdGFydD1zdGFydHx8MDtlbmQ9ZW5kfHxnZW9tcy5sZW5ndGg7aWYoZW5kLXN0YXJ0PD0xKXt2YXIgZzA9dGhpcy5nZXRHZW9tZXRyeShnZW9tcyxzdGFydCk7cmV0dXJuIHRoaXMudW5pb25TYWZlKGcwLG51bGwpO31cbmVsc2UgaWYoZW5kLXN0YXJ0PT09Mil7cmV0dXJuIHRoaXMudW5pb25TYWZlKHRoaXMuZ2V0R2VvbWV0cnkoZ2VvbXMsc3RhcnQpLHRoaXMuZ2V0R2VvbWV0cnkoZ2VvbXMsc3RhcnQrMSkpO31cbmVsc2V7dmFyIG1pZD1wYXJzZUludCgoZW5kK3N0YXJ0KS8yKTt2YXIgZzA9dGhpcy5iaW5hcnlVbmlvbihnZW9tcyxzdGFydCxtaWQpO3ZhciBnMT10aGlzLmJpbmFyeVVuaW9uKGdlb21zLG1pZCxlbmQpO3JldHVybiB0aGlzLnVuaW9uU2FmZShnMCxnMSk7fX07anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLmdldEdlb21ldHJ5PWZ1bmN0aW9uKGxpc3QsaW5kZXgpe2lmKGluZGV4Pj1saXN0Lmxlbmd0aCl7cmV0dXJuIG51bGw7fVxucmV0dXJuIGxpc3RbaW5kZXhdO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnJlZHVjZVRvR2VvbWV0cmllcz1mdW5jdGlvbihnZW9tVHJlZSl7dmFyIGdlb21zPVtdO2Zvcih2YXIgaT0wLGw9Z2VvbVRyZWUubGVuZ3RoO2k8bDtpKyspe3ZhciBvPWdlb21UcmVlW2ldLGdlb209bnVsbDtpZihvIGluc3RhbmNlb2YgQXJyYXkpe2dlb209dGhpcy51bmlvblRyZWUobyk7fVxuZWxzZSBpZihvIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtnZW9tPW87fVxuZ2VvbXMucHVzaChnZW9tKTt9XG5yZXR1cm4gZ2VvbXM7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUudW5pb25TYWZlPWZ1bmN0aW9uKGcwLGcxKXtpZihnMD09PW51bGwmJmcxPT09bnVsbCl7cmV0dXJuIG51bGw7fVxuaWYoZzA9PT1udWxsKXtyZXR1cm4gZzEuY2xvbmUoKTt9XG5pZihnMT09PW51bGwpe3JldHVybiBnMC5jbG9uZSgpO31cbnJldHVybiB0aGlzLnVuaW9uT3B0aW1pemVkKGcwLGcxKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvbk9wdGltaXplZD1mdW5jdGlvbihnMCxnMSl7dmFyIGcwRW52PWcwLmdldEVudmVsb3BlSW50ZXJuYWwoKSxnMUVudj1nMS5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYoIWcwRW52LmludGVyc2VjdHMoZzFFbnYpKXt2YXIgY29tYm89anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lKGcwLGcxKTtyZXR1cm4gY29tYm87fVxuaWYoZzAuZ2V0TnVtR2VvbWV0cmllczw9MSYmZzEuZ2V0TnVtR2VvbWV0cmllczw9MSl7cmV0dXJuIHRoaXMudW5pb25BY3R1YWwoZzAsZzEpO31cbnZhciBjb21tb25FbnY9ZzBFbnYuaW50ZXJzZWN0aW9uKGcxRW52KTtyZXR1cm4gdGhpcy51bmlvblVzaW5nRW52ZWxvcGVJbnRlcnNlY3Rpb24oZzAsZzEsY29tbW9uRW52KTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvblVzaW5nRW52ZWxvcGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24oZzAsZzEsY29tbW9uKXt2YXIgZGlzam9pbnRQb2x5cz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3ZhciBnMEludD10aGlzLmV4dHJhY3RCeUVudmVsb3BlKGNvbW1vbixnMCxkaXNqb2ludFBvbHlzKTt2YXIgZzFJbnQ9dGhpcy5leHRyYWN0QnlFbnZlbG9wZShjb21tb24sZzEsZGlzam9pbnRQb2x5cyk7dmFyIHVuaW9uPXRoaXMudW5pb25BY3R1YWwoZzBJbnQsZzFJbnQpO2Rpc2pvaW50UG9seXMuYWRkKHVuaW9uKTt2YXIgb3ZlcmFsbFVuaW9uPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZShkaXNqb2ludFBvbHlzKTtyZXR1cm4gb3ZlcmFsbFVuaW9uO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLmV4dHJhY3RCeUVudmVsb3BlPWZ1bmN0aW9uKGVudixnZW9tLGRpc2pvaW50R2VvbXMpe3ZhciBpbnRlcnNlY3RpbmdHZW9tcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZWxlbT1nZW9tLmdldEdlb21ldHJ5TihpKTtpZihlbGVtLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGVudikpe2ludGVyc2VjdGluZ0dlb21zLmFkZChlbGVtKTt9XG5lbHNle2Rpc2pvaW50R2VvbXMuYWRkKGVsZW0pO319XG5yZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5idWlsZEdlb21ldHJ5KGludGVyc2VjdGluZ0dlb21zKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvbkFjdHVhbD1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIGcwLnVuaW9uKGcxKTt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS5NdWx0aVBvaW50PWZ1bmN0aW9uKHBvaW50cyxmYWN0b3J5KXt0aGlzLmdlb21ldHJpZXM9cG9pbnRzfHxbXTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbigpO2pzdHMuZ2VvbS5NdWx0aVBvaW50LmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5NdWx0aVBvaW50O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fTtqc3RzLmdlb20uTXVsdGlQb2ludC5wcm90b3R5cGUuZ2V0R2VvbWV0cnlOPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmdlb21ldHJpZXNbbl07fTtqc3RzLmdlb20uTXVsdGlQb2ludC5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4ganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3QuY2FsbCh0aGlzLG90aGVyLHRvbGVyYW5jZSk7fTtqc3RzLmdlb20uTXVsdGlQb2ludC5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLk11bHRpUG9pbnQnO30pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlcj1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCxidWZQYXJhbXMpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7dGhpcy5idWZQYXJhbXM9YnVmUGFyYW1zO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZGlzdGFuY2U9MC4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuYnVmUGFyYW1zPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0QnVmZmVyUGFyYW1ldGVycz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJ1ZlBhcmFtczt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmdldExpbmVDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTtpZih0aGlzLmRpc3RhbmNlPDAuMCYmIXRoaXMuYnVmUGFyYW1zLmlzU2luZ2xlU2lkZWQoKSlcbnJldHVybiBudWxsO2lmKHRoaXMuZGlzdGFuY2U9PTAuMClcbnJldHVybiBudWxsO3ZhciBwb3NEaXN0YW5jZT1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKTt2YXIgc2VnR2VuPXRoaXMuZ2V0U2VnR2VuKHBvc0Rpc3RhbmNlKTtpZihpbnB1dFB0cy5sZW5ndGg8PTEpe3RoaXMuY29tcHV0ZVBvaW50Q3VydmUoaW5wdXRQdHNbMF0sc2VnR2VuKTt9ZWxzZXtpZih0aGlzLmJ1ZlBhcmFtcy5pc1NpbmdsZVNpZGVkKCkpe3ZhciBpc1JpZ2h0U2lkZT1kaXN0YW5jZTwwLjA7dGhpcy5jb21wdXRlU2luZ2xlU2lkZWRCdWZmZXJDdXJ2ZShpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pO31lbHNlXG50aGlzLmNvbXB1dGVMaW5lQnVmZmVyQ3VydmUoaW5wdXRQdHMsc2VnR2VuKTt9XG52YXIgbGluZUNvb3JkPXNlZ0dlbi5nZXRDb29yZGluYXRlcygpO3JldHVybiBsaW5lQ29vcmQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRSaW5nQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsc2lkZSxkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTtpZihpbnB1dFB0cy5sZW5ndGg8PTIpXG5yZXR1cm4gdGhpcy5nZXRMaW5lQ3VydmUoaW5wdXRQdHMsZGlzdGFuY2UpO2lmKHRoaXMuZGlzdGFuY2U9PTAuMCl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuY29weUNvb3JkaW5hdGVzKGlucHV0UHRzKTt9XG52YXIgc2VnR2VuPXRoaXMuZ2V0U2VnR2VuKHRoaXMuZGlzdGFuY2UpO3RoaXMuY29tcHV0ZVJpbmdCdWZmZXJDdXJ2ZShpbnB1dFB0cyxzaWRlLHNlZ0dlbik7cmV0dXJuIHNlZ0dlbi5nZXRDb29yZGluYXRlcygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0T2Zmc2V0Q3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsZGlzdGFuY2Upe3RoaXMuZGlzdGFuY2U9ZGlzdGFuY2U7aWYodGhpcy5kaXN0YW5jZT09PTAuMClcbnJldHVybiBudWxsO3ZhciBpc1JpZ2h0U2lkZT10aGlzLmRpc3RhbmNlPDAuMDt2YXIgcG9zRGlzdGFuY2U9TWF0aC5hYnModGhpcy5kaXN0YW5jZSk7dmFyIHNlZ0dlbj10aGlzLmdldFNlZ0dlbihwb3NEaXN0YW5jZSk7aWYoaW5wdXRQdHMubGVuZ3RoPD0xKXt0aGlzLmNvbXB1dGVQb2ludEN1cnZlKGlucHV0UHRzWzBdLHNlZ0dlbik7fWVsc2V7dGhpcy5jb21wdXRlT2Zmc2V0Q3VydmUoaW5wdXRQdHMsaXNSaWdodFNpZGUsc2VnR2VuKTt9XG52YXIgY3VydmVQdHM9c2VnR2VuLmdldENvb3JkaW5hdGVzKCk7aWYoaXNSaWdodFNpZGUpXG5jdXJ2ZVB0cy5yZXZlcnNlKCk7cmV0dXJuIGN1cnZlUHRzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5jb3B5Q29vcmRpbmF0ZXM9ZnVuY3Rpb24ocHRzKXt2YXIgY29weT1bXTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtjb3B5LnB1c2gocHRzW2ldLmNsb25lKCkpO31cbnJldHVybiBjb3B5O307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0U2VnR2VuPWZ1bmN0aW9uKGRpc3RhbmNlKXtyZXR1cm4gbmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yKHRoaXMucHJlY2lzaW9uTW9kZWwsdGhpcy5idWZQYXJhbXMsZGlzdGFuY2UpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5TSU1QTElGWV9GQUNUT1I9MTAwLjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5zaW1wbGlmeVRvbGVyYW5jZT1mdW5jdGlvbihidWZEaXN0YW5jZSl7cmV0dXJuIGJ1ZkRpc3RhbmNlL2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuU0lNUExJRllfRkFDVE9SO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVBvaW50Q3VydmU9ZnVuY3Rpb24ocHQsc2VnR2VuKXtzd2l0Y2godGhpcy5idWZQYXJhbXMuZ2V0RW5kQ2FwU3R5bGUoKSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfUk9VTkQ6c2VnR2VuLmNyZWF0ZUNpcmNsZShwdCk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfU1FVQVJFOnNlZ0dlbi5jcmVhdGVTcXVhcmUocHQpO2JyZWFrO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVMaW5lQnVmZmVyQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsc2VnR2VuKXt2YXIgZGlzdFRvbD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlKHRoaXMuZGlzdGFuY2UpO3ZhciBzaW1wMT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbjE9c2ltcDEubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDFbMF0sc2ltcDFbMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7Zm9yKHZhciBpPTI7aTw9bjE7aSsrKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDFbaV0sdHJ1ZSk7fVxuc2VnR2VuLmFkZExhc3RTZWdtZW50KCk7c2VnR2VuLmFkZExpbmVFbmRDYXAoc2ltcDFbbjEtMV0sc2ltcDFbbjFdKTt2YXIgc2ltcDI9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsLWRpc3RUb2wpO3ZhciBuMj1zaW1wMi5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMltuMl0sc2ltcDJbbjItMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7Zm9yKHZhciBpPW4yLTI7aT49MDtpLS0pe3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wMltpXSx0cnVlKTt9XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTtzZWdHZW4uYWRkTGluZUVuZENhcChzaW1wMlsxXSxzaW1wMlswXSk7c2VnR2VuLmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVNpbmdsZVNpZGVkQnVmZmVyQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsaXNSaWdodFNpZGUsc2VnR2VuKXt2YXIgZGlzdFRvbD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlKHRoaXMuZGlzdGFuY2UpO2lmKGlzUmlnaHRTaWRlKXtzZWdHZW4uYWRkU2VnbWVudHMoaW5wdXRQdHMsdHJ1ZSk7dmFyIHNpbXAyPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLC1kaXN0VG9sKTt2YXIgbjI9c2ltcDIubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDJbbjJdLHNpbXAyW24yLTFdLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3NlZ0dlbi5hZGRGaXJzdFNlZ21lbnQoKTtmb3IodmFyIGk9bjItMjtpPj0wO2ktLSl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAyW2ldLHRydWUpO319ZWxzZXtzZWdHZW4uYWRkU2VnbWVudHMoaW5wdXRQdHMsZmFsc2UpO3ZhciBzaW1wMT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbjE9c2ltcDEubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDFbMF0sc2ltcDFbMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT0yO2k8PW4xO2krKyl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAxW2ldLHRydWUpO319XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTtzZWdHZW4uY2xvc2VSaW5nKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlT2Zmc2V0Q3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsaXNSaWdodFNpZGUsc2VnR2VuKXt2YXIgZGlzdFRvbD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlKHRoaXMuZGlzdGFuY2UpO2lmKGlzUmlnaHRTaWRlKXt2YXIgc2ltcDI9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsLWRpc3RUb2wpO3ZhciBuMj1zaW1wMi5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMltuMl0sc2ltcDJbbjItMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT1uMi0yO2k+PTA7aS0tKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDJbaV0sdHJ1ZSk7fX1lbHNle3ZhciBzaW1wMT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbjE9c2ltcDEubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcDFbMF0sc2ltcDFbMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT0yO2k8PW4xO2krKyl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAxW2ldLHRydWUpO319XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVSaW5nQnVmZmVyQ3VydmU9ZnVuY3Rpb24oaW5wdXRQdHMsc2lkZSxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7aWYoc2lkZT09PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKVxuZGlzdFRvbD0tZGlzdFRvbDt2YXIgc2ltcD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyxkaXN0VG9sKTt2YXIgbj1zaW1wLmxlbmd0aC0xO3NlZ0dlbi5pbml0U2lkZVNlZ21lbnRzKHNpbXBbbi0xXSxzaW1wWzBdLHNpZGUpO2Zvcih2YXIgaT0xO2k8PW47aSsrKXt2YXIgYWRkU3RhcnRQb2ludD1pIT09MTtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcFtpXSxhZGRTdGFydFBvaW50KTt9XG5zZWdHZW4uY2xvc2VSaW5nKCk7fTsoZnVuY3Rpb24oKXt2YXIgSG90UGl4ZWxTbmFwQWN0aW9uPWZ1bmN0aW9uKGhvdFBpeGVsLHBhcmVudEVkZ2UsdmVydGV4SW5kZXgpe3RoaXMuaG90UGl4ZWw9aG90UGl4ZWw7dGhpcy5wYXJlbnRFZGdlPXBhcmVudEVkZ2U7dGhpcy52ZXJ0ZXhJbmRleD12ZXJ0ZXhJbmRleDt9O0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbigpO0hvdFBpeGVsU25hcEFjdGlvbi5jb25zdHJ1Y3Rvcj1Ib3RQaXhlbFNuYXBBY3Rpb247SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS5ob3RQaXhlbD1udWxsO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUucGFyZW50RWRnZT1udWxsO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUudmVydGV4SW5kZXg9bnVsbDtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLl9pc05vZGVBZGRlZD1mYWxzZTtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLmlzTm9kZUFkZGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzTm9kZUFkZGVkO307SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS5zZWxlY3Q9ZnVuY3Rpb24obWMsc3RhcnRJbmRleCl7dmFyIHNzPW1jLmdldENvbnRleHQoKTtpZih0aGlzLnBhcmVudEVkZ2UhPT1udWxsKXtpZihzcz09PXRoaXMucGFyZW50RWRnZSYmc3RhcnRJbmRleD09PXRoaXMudmVydGV4SW5kZXgpXG5yZXR1cm47fVxudGhpcy5faXNOb2RlQWRkZWQ9dGhpcy5ob3RQaXhlbC5hZGRTbmFwcGVkTm9kZShzcyxzdGFydEluZGV4KTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4UG9pbnRTbmFwcGVyPWZ1bmN0aW9uKGluZGV4KXt0aGlzLmluZGV4PWluZGV4O307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIucHJvdG90eXBlLmluZGV4PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIucHJvdG90eXBlLnNuYXA9ZnVuY3Rpb24oaG90UGl4ZWwscGFyZW50RWRnZSx2ZXJ0ZXhJbmRleCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuc25hcDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgcGl4ZWxFbnY9aG90UGl4ZWwuZ2V0U2FmZUVudmVsb3BlKCk7dmFyIGhvdFBpeGVsU25hcEFjdGlvbj1uZXcgSG90UGl4ZWxTbmFwQWN0aW9uKGhvdFBpeGVsLHBhcmVudEVkZ2UsdmVydGV4SW5kZXgpO3RoaXMuaW5kZXgucXVlcnkocGl4ZWxFbnYse3Zpc2l0SXRlbTpmdW5jdGlvbih0ZXN0Q2hhaW4pe3Rlc3RDaGFpbi5zZWxlY3QocGl4ZWxFbnYsaG90UGl4ZWxTbmFwQWN0aW9uKTt9fSk7cmV0dXJuIGhvdFBpeGVsU25hcEFjdGlvbi5pc05vZGVBZGRlZCgpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIucHJvdG90eXBlLnNuYXAyPWZ1bmN0aW9uKGhvdFBpeGVsKXtyZXR1cm4gdGhpcy5zbmFwKGhvdFBpeGVsLG51bGwsLTEpO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZUJhc2U9ZnVuY3Rpb24oKXt0aGlzLml0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5zdWJub2RlPVtudWxsLG51bGxdO307Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4PWZ1bmN0aW9uKGludGVydmFsLGNlbnRyZSl7dmFyIHN1Ym5vZGVJbmRleD0tMTtpZihpbnRlcnZhbC5taW4+PWNlbnRyZSl7c3Vibm9kZUluZGV4PTE7fVxuaWYoaW50ZXJ2YWwubWF4PD1jZW50cmUpe3N1Ym5vZGVJbmRleD0wO31cbnJldHVybiBzdWJub2RlSW5kZXg7fTtOb2RlQmFzZS5wcm90b3R5cGUuZ2V0SXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtczt9O05vZGVCYXNlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaXRlbSl7dGhpcy5pdGVtcy5hZGQoaXRlbSk7fTtOb2RlQmFzZS5wcm90b3R5cGUuYWRkQWxsSXRlbXM9ZnVuY3Rpb24oaXRlbXMpe2l0ZW1zLmFkZEFsbCh0aGlzLml0ZW1zKTt2YXIgaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3RoaXMuc3Vibm9kZVtpXS5hZGRBbGxJdGVtcyhpdGVtcyk7fX1cbnJldHVybiBpdGVtczt9O05vZGVCYXNlLnByb3RvdHlwZS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZz1mdW5jdGlvbihpbnRlcnZhbCxyZXN1bHRJdGVtcyl7aWYoaW50ZXJ2YWwhPT1udWxsJiYhdGhpcy5pc1NlYXJjaE1hdGNoKGludGVydmFsKSl7cmV0dXJuO31cbnJlc3VsdEl0ZW1zLmFkZEFsbCh0aGlzLml0ZW1zKTtpZih0aGlzLnN1Ym5vZGVbMF0hPT1udWxsKXt0aGlzLnN1Ym5vZGVbMF0uYWRkQWxsSXRlbXNGcm9tT3ZlcmxhcHBpbmcoaW50ZXJ2YWwscmVzdWx0SXRlbXMpO31cbmlmKHRoaXMuc3Vibm9kZVsxXSE9PW51bGwpe3RoaXMuc3Vibm9kZVsxXS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZyhpbnRlcnZhbCxyZXN1bHRJdGVtcyk7fX07Tm9kZUJhc2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChpdGVtSW50ZXJ2YWwpKXtyZXR1cm4gZmFsc2U7fVxudmFyIGZvdW5kPWZhbHNlLGk9MCxpbD0yO2ZvcihpO2k8aWw7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtmb3VuZD10aGlzLnN1Ym5vZGVbaV0ucmVtb3ZlKGl0ZW1JbnRlcnZhbCxpdGVtKTtpZihmb3VuZCl7aWYodGhpcy5zdWJub2RlW2ldLmlzUHJ1bmFibGUoKSl7dGhpcy5zdWJub2RlW2ldPW51bGw7fVxuYnJlYWs7fX19XG5pZihmb3VuZCl7cmV0dXJuIGZvdW5kO31cbmZvdW5kPXRoaXMuaXRlbXMucmVtb3ZlKGl0ZW0pO3JldHVybiBmb3VuZDt9O05vZGVCYXNlLnByb3RvdHlwZS5pc1BydW5hYmxlPWZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLmhhc0NoaWxkcmVuKCl8fHRoaXMuaGFzSXRlbXMoKSk7fTtOb2RlQmFzZS5wcm90b3R5cGUuaGFzQ2hpbGRyZW49ZnVuY3Rpb24oKXt2YXIgaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtOb2RlQmFzZS5wcm90b3R5cGUuaGFzSXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pdGVtcy5pc0VtcHR5KCk7fTtOb2RlQmFzZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXt2YXIgbWF4U3ViRGVwdGg9MCxpPTAsaWw9MixzcWQ7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3NxZD10aGlzLnN1Ym5vZGVbaV0uZGVwdGgoKTtpZihzcWQ+bWF4U3ViRGVwdGgpe21heFN1YkRlcHRoPXNxZDt9fX1cbnJldHVybiBtYXhTdWJEZXB0aCsxO307Tm9kZUJhc2UucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXt2YXIgc3ViU2l6ZT0wLGk9MCxpbD0yO2ZvcihpO2k8aWw7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtzdWJTaXplKz10aGlzLnN1Ym5vZGVbaV0uc2l6ZSgpO319XG5yZXR1cm4gc3ViU2l6ZSt0aGlzLml0ZW1zLnNpemUoKTt9O05vZGVCYXNlLnByb3RvdHlwZS5ub2RlU2l6ZT1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5ub2RlU2l6ZSgpO319XG5yZXR1cm4gc3ViU2l6ZSsxO307anN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlPU5vZGVCYXNlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIE5vZGVCYXNlPWpzdHMuaW5kZXguYmludHJlZS5Ob2RlQmFzZTt2YXIgS2V5PWpzdHMuaW5kZXguYmludHJlZS5LZXk7dmFyIEludGVydmFsPWpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbDt2YXIgTm9kZT1mdW5jdGlvbihpbnRlcnZhbCxsZXZlbCl7dGhpcy5pdGVtcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuc3Vibm9kZT1bbnVsbCxudWxsXTt0aGlzLmludGVydmFsPWludGVydmFsO3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5jZW50cmU9KGludGVydmFsLmdldE1pbigpK2ludGVydmFsLmdldE1heCgpKS8yO307Tm9kZS5wcm90b3R5cGU9bmV3IE5vZGVCYXNlKCk7Tm9kZS5jb25zdHJ1Y3Rvcj1Ob2RlO05vZGUuY3JlYXRlTm9kZT1mdW5jdGlvbihpdGVtSW50ZXJ2YWwpe3ZhciBrZXksbm9kZTtrZXk9bmV3IEtleShpdGVtSW50ZXJ2YWwpO25vZGU9bmV3IE5vZGUoa2V5LmdldEludGVydmFsKCksa2V5LmdldExldmVsKCkpO3JldHVybiBub2RlO307Tm9kZS5jcmVhdGVFeHBhbmRlZD1mdW5jdGlvbihub2RlLGFkZEludGVydmFsKXt2YXIgZXhwYW5kSW50LGxhcmdlck5vZGU7ZXhwYW5kSW50PW5ldyBJbnRlcnZhbChhZGRJbnRlcnZhbCk7aWYobm9kZSE9PW51bGwpe2V4cGFuZEludC5leHBhbmRUb0luY2x1ZGUobm9kZS5pbnRlcnZhbCk7fVxubGFyZ2VyTm9kZT1Ob2RlLmNyZWF0ZU5vZGUoZXhwYW5kSW50KTtpZihub2RlIT09bnVsbCl7bGFyZ2VyTm9kZS5pbnNlcnQobm9kZSk7fVxucmV0dXJuIGxhcmdlck5vZGU7fTtOb2RlLnByb3RvdHlwZS5nZXRJbnRlcnZhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVydmFsO307Tm9kZS5wcm90b3R5cGUuaXNTZWFyY2hNYXRjaD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwpe3JldHVybiBpdGVtSW50ZXJ2YWwub3ZlcmxhcHModGhpcy5pbnRlcnZhbCk7fTtOb2RlLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKHNlYXJjaEludGVydmFsKXt2YXIgc3Vibm9kZUluZGV4PU5vZGVCYXNlLmdldFN1Ym5vZGVJbmRleChzZWFyY2hJbnRlcnZhbCx0aGlzLmNlbnRyZSksbm9kZTtpZihzdWJub2RlSW5kZXghPS0xKXtub2RlPXRoaXMuZ2V0U3Vibm9kZShzdWJub2RlSW5kZXgpO3JldHVybiBub2RlLmdldE5vZGUoc2VhcmNoSW50ZXJ2YWwpO31lbHNle3JldHVybiB0aGlzO319O05vZGUucHJvdG90eXBlLmZpbmQ9ZnVuY3Rpb24oc2VhcmNoSW50ZXJ2YWwpe3ZhciBzdWJub2RlSW5kZXg9Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4KHNlYXJjaEludGVydmFsLHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleD09PS0xKXtyZXR1cm4gdGhpczt9XG5pZih0aGlzLnN1Ym5vZGVbc3Vibm9kZUluZGV4XSE9PW51bGwpe25vZGU9dGhpcy5zdWJub2RlW3N1Ym5vZGVJbmRleF07cmV0dXJuIG5vZGUuZmluZChzZWFyY2hJbnRlcnZhbCk7fVxucmV0dXJuIHRoaXM7fTtOb2RlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24obm9kZSl7dmFyIGluZGV4PU5vZGVCYXNlLmdldFN1Ym5vZGVJbmRleChub2RlLmludGVydmFsLHRoaXMuY2VudHJlKSxjaGlsZE5vZGU7aWYobm9kZS5sZXZlbD09PXRoaXMubGV2ZWwtMSl7dGhpcy5zdWJub2RlW2luZGV4XT1ub2RlO31lbHNle2NoaWxkTm9kZT10aGlzLmNyZWF0ZVN1Ym5vZGUoaW5kZXgpO2NoaWxkTm9kZS5pbnNlcnQobm9kZSk7dGhpcy5zdWJub2RlW2luZGV4XT1jaGlsZE5vZGU7fX07Tm9kZS5wcm90b3R5cGUuZ2V0U3Vibm9kZT1mdW5jdGlvbihpbmRleCl7aWYodGhpcy5zdWJub2RlW2luZGV4XT09PW51bGwpe3RoaXMuc3Vibm9kZVtpbmRleF09dGhpcy5jcmVhdGVTdWJub2RlKGluZGV4KTt9XG5yZXR1cm4gdGhpcy5zdWJub2RlW2luZGV4XTt9O05vZGUucHJvdG90eXBlLmNyZWF0ZVN1Ym5vZGU9ZnVuY3Rpb24oaW5kZXgpe3ZhciBtaW4sbWF4LHN1YkludCxub2RlO21pbj0wLjA7bWF4PTAuMDtzd2l0Y2goaW5kZXgpe2Nhc2UgMDptaW49dGhpcy5pbnRlcnZhbC5nZXRNaW4oKTttYXg9dGhpcy5jZW50cmU7YnJlYWs7Y2FzZSAxOm1pbj10aGlzLmNlbnRyZTttYXg9dGhpcy5pbnRlcnZhbC5nZXRNYXgoKTticmVhazt9XG5zdWJJbnQ9bmV3IEludGVydmFsKG1pbixtYXgpO25vZGU9bmV3IE5vZGUoc3ViSW50LHRoaXMubGV2ZWwtMSk7cmV0dXJuIG5vZGU7fTtqc3RzLmluZGV4LmJpbnRyZWUuTm9kZT1Ob2RlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIE5vZGU9anN0cy5pbmRleC5iaW50cmVlLk5vZGU7dmFyIE5vZGVCYXNlPWpzdHMuaW5kZXguYmludHJlZS5Ob2RlQmFzZTt2YXIgUm9vdD1mdW5jdGlvbigpe3RoaXMuc3Vibm9kZT1bbnVsbCxudWxsXTt0aGlzLml0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7fTtSb290LnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlKCk7Um9vdC5jb25zdHJ1Y3Rvcj1Sb290O1Jvb3Qub3JpZ2luPTAuMDtSb290LnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oaXRlbUludGVydmFsLGl0ZW0pe3ZhciBpbmRleD1Ob2RlQmFzZS5nZXRTdWJub2RlSW5kZXgoaXRlbUludGVydmFsLFJvb3Qub3JpZ2luKSxub2RlLGxhcmdlck5vZGU7aWYoaW5kZXg9PT0tMSl7dGhpcy5hZGQoaXRlbSk7cmV0dXJuO31cbm5vZGU9dGhpcy5zdWJub2RlW2luZGV4XTtpZihub2RlPT09bnVsbHx8IW5vZGUuZ2V0SW50ZXJ2YWwoKS5jb250YWlucyhpdGVtSW50ZXJ2YWwpKXtsYXJnZXJOb2RlPU5vZGUuY3JlYXRlRXhwYW5kZWQobm9kZSxpdGVtSW50ZXJ2YWwpO3RoaXMuc3Vibm9kZVtpbmRleF09bGFyZ2VyTm9kZTt9XG50aGlzLmluc2VydENvbnRhaW5lZCh0aGlzLnN1Ym5vZGVbaW5kZXhdLGl0ZW1JbnRlcnZhbCxpdGVtKTt9O1Jvb3QucHJvdG90eXBlLmluc2VydENvbnRhaW5lZD1mdW5jdGlvbih0cmVlLGl0ZW1JbnRlcnZhbCxpdGVtKXt2YXIgaXNaZXJvQXJlYSxub2RlO2lzWmVyb0FyZWE9anN0cy5pbmRleC5JbnRlcnZhbFNpemUuaXNaZXJvV2lkdGgoaXRlbUludGVydmFsLmdldE1pbigpLGl0ZW1JbnRlcnZhbC5nZXRNYXgoKSk7bm9kZT1pc1plcm9BcmVhP3RyZWUuZmluZChpdGVtSW50ZXJ2YWwpOnRyZWUuZ2V0Tm9kZShpdGVtSW50ZXJ2YWwpO25vZGUuYWRkKGl0ZW0pO307Um9vdC5wcm90b3R5cGUuaXNTZWFyY2hNYXRjaD1mdW5jdGlvbihpbnRlcnZhbCl7cmV0dXJuIHRydWU7fTtqc3RzLmluZGV4LmJpbnRyZWUuUm9vdD1Sb290O30pKCk7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQ9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5FPTA7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTlc9MTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TVz0yO2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFPTM7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQ9ZnVuY3Rpb24oZHgsZHkpe2lmKGR4IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKGR4PT09MC4wJiZkeT09PTAuMClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdDYW5ub3QgY29tcHV0ZSB0aGUgcXVhZHJhbnQgZm9yIHBvaW50ICggJytkeCsnLCAnK2R5KycgKScpO2lmKGR4Pj0wLjApe2lmKGR5Pj0wLjApXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTkU7ZWxzZVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFO31lbHNle2lmKGR5Pj0wLjApXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTlc7ZWxzZVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNXO319O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50Mj1mdW5jdGlvbihwMCxwMSl7aWYocDEueD09PXAwLngmJnAxLnk9PT1wMC55KVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBxdWFkcmFudCBmb3IgdHdvIGlkZW50aWNhbCBwb2ludHMgJytwMCk7aWYocDEueD49cDAueCl7aWYocDEueT49cDAueSlcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5ORTtlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU0U7fWVsc2V7aWYocDEueT49cDAueSlcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVztlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU1c7fX07anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNPcHBvc2l0ZT1mdW5jdGlvbihxdWFkMSxxdWFkMil7aWYocXVhZDE9PT1xdWFkMilcbnJldHVybiBmYWxzZTt2YXIgZGlmZj0ocXVhZDEtcXVhZDIrNCklNDtpZihkaWZmPT09MilcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmNvbW1vbkhhbGZQbGFuZT1mdW5jdGlvbihxdWFkMSxxdWFkMil7aWYocXVhZDE9PT1xdWFkMilcbnJldHVybiBxdWFkMTt2YXIgZGlmZj0ocXVhZDEtcXVhZDIrNCklNDtpZihkaWZmPT09MilcbnJldHVybi0xO3ZhciBtaW49KHF1YWQxPHF1YWQyKT9xdWFkMTpxdWFkMjt2YXIgbWF4PShxdWFkMT5xdWFkMik/cXVhZDE6cXVhZDI7aWYobWluPT09MCYmbWF4PT09MylcbnJldHVybiAzO3JldHVybiBtaW47fTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc0luSGFsZlBsYW5lPWZ1bmN0aW9uKHF1YWQsaGFsZlBsYW5lKXtpZihoYWxmUGxhbmU9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TRSl7cmV0dXJuIHF1YWQ9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TRXx8cXVhZD09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNXO31cbnJldHVybiBxdWFkPT09aGFsZlBsYW5lfHxxdWFkPT09aGFsZlBsYW5lKzE7fTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc05vcnRoZXJuPWZ1bmN0aW9uKHF1YWQpe3JldHVybiBxdWFkPT09anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTkV8fHF1YWQ9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVzt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyPWZ1bmN0aW9uKGdlb21HcmFwaCl7dGhpcy5nZW9tR3JhcGg9Z2VvbUdyYXBoO3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMubm9kZUdyYXBoPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoKCk7dGhpcy5pbnZhbGlkUG9pbnQ9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyLnByb3RvdHlwZS5nZXRJbnZhbGlkUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnZhbGlkUG9pbnQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3Rlci5wcm90b3R5cGUuaXNOb2RlQ29uc2lzdGVudEFyZWE9ZnVuY3Rpb24oKXt2YXIgaW50ZXJzZWN0b3I9dGhpcy5nZW9tR3JhcGguY29tcHV0ZVNlbGZOb2Rlcyh0aGlzLmxpLHRydWUpO2lmKGludGVyc2VjdG9yLmhhc1Byb3BlckludGVyc2VjdGlvbigpKXt0aGlzLmludmFsaWRQb2ludD1pbnRlcnNlY3Rvci5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludCgpO3JldHVybiBmYWxzZTt9XG50aGlzLm5vZGVHcmFwaC5idWlsZCh0aGlzLmdlb21HcmFwaCk7cmV0dXJuIHRoaXMuaXNOb2RlRWRnZUFyZWFMYWJlbHNDb25zaXN0ZW50KCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3Rlci5wcm90b3R5cGUuaXNOb2RlRWRnZUFyZWFMYWJlbHNDb25zaXN0ZW50PWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlSXQ9dGhpcy5ub2RlR3JhcGguZ2V0Tm9kZUl0ZXJhdG9yKCk7bm9kZUl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVJdC5uZXh0KCk7aWYoIW5vZGUuZ2V0RWRnZXMoKS5pc0FyZWFMYWJlbHNDb25zaXN0ZW50KHRoaXMuZ2VvbUdyYXBoKSl7dGhpcy5pbnZhbGlkUG9pbnQ9bm9kZS5nZXRDb29yZGluYXRlKCkuY2xvbmUoKTtyZXR1cm4gZmFsc2U7fX1cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXIucHJvdG90eXBlLmhhc0R1cGxpY2F0ZVJpbmdzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlSXQ9dGhpcy5ub2RlR3JhcGguZ2V0Tm9kZUl0ZXJhdG9yKCk7bm9kZUl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVJdC5uZXh0KCk7Zm9yKHZhciBpPW5vZGUuZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVlYj1pLm5leHQoKTtpZihlZWIuZ2V0RWRnZUVuZHMoKS5sZW5ndGg+MSl7aW52YWxpZFBvaW50PWVlYi5nZXRFZGdlKCkuZ2V0Q29vcmRpbmF0ZSgwKTtyZXR1cm4gdHJ1ZTt9fX1cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkLGVkZ2VzKXtqc3RzLmdlb21ncmFwaC5Ob2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguTm9kZSgpO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlLnByb3RvdHlwZS5jb21wdXRlSU09ZnVuY3Rpb24oaW0pe2ltLnNldEF0TGVhc3RJZlZhbGlkKHRoaXMubGFiZWwuZ2V0TG9jYXRpb24oMCksdGhpcy5sYWJlbC5nZXRMb2NhdGlvbigxKSwwKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlLnByb3RvdHlwZS51cGRhdGVJTUZyb21FZGdlcz1mdW5jdGlvbihpbSl7dGhpcy5lZGdlcy51cGRhdGVJTShpbSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgRWRnZUVuZD1qc3RzLmdlb21ncmFwaC5FZGdlRW5kO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZT1mdW5jdGlvbihlZGdlLGlzRm9yd2FyZCl7RWRnZUVuZC5jYWxsKHRoaXMsZWRnZSk7dGhpcy5kZXB0aD1bMCwtOTk5LC05OTldO3RoaXMuX2lzRm9yd2FyZD1pc0ZvcndhcmQ7aWYoaXNGb3J3YXJkKXt0aGlzLmluaXQoZWRnZS5nZXRDb29yZGluYXRlKDApLGVkZ2UuZ2V0Q29vcmRpbmF0ZSgxKSk7fWVsc2V7dmFyIG49ZWRnZS5nZXROdW1Qb2ludHMoKS0xO3RoaXMuaW5pdChlZGdlLmdldENvb3JkaW5hdGUobiksZWRnZS5nZXRDb29yZGluYXRlKG4tMSkpO31cbnRoaXMuY29tcHV0ZURpcmVjdGVkTGFiZWwoKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGU9bmV3IEVkZ2VFbmQoKTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UuY29uc3RydWN0b3I9anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5kZXB0aEZhY3Rvcj1mdW5jdGlvbihjdXJyTG9jYXRpb24sbmV4dExvY2F0aW9uKXtpZihjdXJyTG9jYXRpb249PT1Mb2NhdGlvbi5FWFRFUklPUiYmbmV4dExvY2F0aW9uPT09TG9jYXRpb24uSU5URVJJT1IpXG5yZXR1cm4gMTtlbHNlIGlmKGN1cnJMb2NhdGlvbj09PUxvY2F0aW9uLklOVEVSSU9SJiZuZXh0TG9jYXRpb249PT1Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybi0xO3JldHVybiAwO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5faXNGb3J3YXJkPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5faXNJblJlc3VsdD1mYWxzZTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLl9pc1Zpc2l0ZWQ9ZmFsc2U7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zeW09bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLm5leHQ9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLm5leHRNaW49bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmVkZ2VSaW5nPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5taW5FZGdlUmluZz1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZGVwdGg9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRJblJlc3VsdD1mdW5jdGlvbihpc0luUmVzdWx0KXt0aGlzLl9pc0luUmVzdWx0PWlzSW5SZXN1bHQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzSW5SZXN1bHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJblJlc3VsdDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNWaXNpdGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0VmlzaXRlZD1mdW5jdGlvbihpc1Zpc2l0ZWQpe3RoaXMuX2lzVmlzaXRlZD1pc1Zpc2l0ZWQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGVkZ2VSaW5nKXt0aGlzLmVkZ2VSaW5nPWVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRFZGdlUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRNaW5FZGdlUmluZz1mdW5jdGlvbihtaW5FZGdlUmluZyl7dGhpcy5taW5FZGdlUmluZz1taW5FZGdlUmluZzt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TWluRWRnZVJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW5FZGdlUmluZzt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24ocG9zaXRpb24pe3JldHVybiB0aGlzLmRlcHRoW3Bvc2l0aW9uXTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RGVwdGg9ZnVuY3Rpb24ocG9zaXRpb24sZGVwdGhWYWwpe2lmKHRoaXMuZGVwdGhbcG9zaXRpb25dIT09LTk5OSl7aWYodGhpcy5kZXB0aFtwb3NpdGlvbl0hPT1kZXB0aFZhbClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ2Fzc2lnbmVkIGRlcHRocyBkbyBub3QgbWF0Y2gnLHRoaXMuZ2V0Q29vcmRpbmF0ZSgpKTt9XG50aGlzLmRlcHRoW3Bvc2l0aW9uXT1kZXB0aFZhbDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RGVwdGhEZWx0YT1mdW5jdGlvbigpe3ZhciBkZXB0aERlbHRhPXRoaXMuZWRnZS5nZXREZXB0aERlbHRhKCk7aWYoIXRoaXMuX2lzRm9yd2FyZClcbmRlcHRoRGVsdGE9LWRlcHRoRGVsdGE7cmV0dXJuIGRlcHRoRGVsdGE7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFZpc2l0ZWRFZGdlPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5zZXRWaXNpdGVkKGlzVmlzaXRlZCk7dGhpcy5zeW0uc2V0VmlzaXRlZChpc1Zpc2l0ZWQpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRTeW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW07fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzRm9yd2FyZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0ZvcndhcmQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFN5bT1mdW5jdGlvbihkZSl7dGhpcy5zeW09ZGU7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldE5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0O307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXROZXh0PWZ1bmN0aW9uKG5leHQpe3RoaXMubmV4dD1uZXh0O307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXROZXh0TWluPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dE1pbjt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0TmV4dE1pbj1mdW5jdGlvbihuZXh0TWluKXt0aGlzLm5leHRNaW49bmV4dE1pbjt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNMaW5lRWRnZT1mdW5jdGlvbigpe3ZhciBpc0xpbmU9dGhpcy5sYWJlbC5pc0xpbmUoMCl8fHRoaXMubGFiZWwuaXNMaW5lKDEpO3ZhciBpc0V4dGVyaW9ySWZBcmVhMD0hdGhpcy5sYWJlbC5pc0FyZWEoMCl8fHRoaXMubGFiZWwuYWxsUG9zaXRpb25zRXF1YWwoMCxMb2NhdGlvbi5FWFRFUklPUik7dmFyIGlzRXh0ZXJpb3JJZkFyZWExPSF0aGlzLmxhYmVsLmlzQXJlYSgxKXx8dGhpcy5sYWJlbC5hbGxQb3NpdGlvbnNFcXVhbCgxLExvY2F0aW9uLkVYVEVSSU9SKTtyZXR1cm4gaXNMaW5lJiZpc0V4dGVyaW9ySWZBcmVhMCYmaXNFeHRlcmlvcklmQXJlYTE7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmlzSW50ZXJpb3JBcmVhRWRnZT1mdW5jdGlvbigpe3ZhciBpc0ludGVyaW9yQXJlYUVkZ2U9dHJ1ZTtmb3IodmFyIGk9MDtpPDI7aSsrKXtpZighKHRoaXMubGFiZWwuaXNBcmVhKGkpJiZ0aGlzLmxhYmVsLmdldExvY2F0aW9uKGksUG9zaXRpb24uTEVGVCk9PT1Mb2NhdGlvbi5JTlRFUklPUiYmdGhpcy5sYWJlbC5nZXRMb2NhdGlvbihpLFBvc2l0aW9uLlJJR0hUKT09PUxvY2F0aW9uLklOVEVSSU9SKSl7aXNJbnRlcmlvckFyZWFFZGdlPWZhbHNlO319XG5yZXR1cm4gaXNJbnRlcmlvckFyZWFFZGdlO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5jb21wdXRlRGlyZWN0ZWRMYWJlbD1mdW5jdGlvbigpe3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKHRoaXMuZWRnZS5nZXRMYWJlbCgpKTtpZighdGhpcy5faXNGb3J3YXJkKVxudGhpcy5sYWJlbC5mbGlwKCk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldEVkZ2VEZXB0aHM9ZnVuY3Rpb24ocG9zaXRpb24sZGVwdGgpe3ZhciBkZXB0aERlbHRhPXRoaXMuZ2V0RWRnZSgpLmdldERlcHRoRGVsdGEoKTtpZighdGhpcy5faXNGb3J3YXJkKVxuZGVwdGhEZWx0YT0tZGVwdGhEZWx0YTt2YXIgZGlyZWN0aW9uRmFjdG9yPTE7aWYocG9zaXRpb249PT1Qb3NpdGlvbi5MRUZUKVxuZGlyZWN0aW9uRmFjdG9yPS0xO3ZhciBvcHBvc2l0ZVBvcz1Qb3NpdGlvbi5vcHBvc2l0ZShwb3NpdGlvbik7dmFyIGRlbHRhPWRlcHRoRGVsdGEqZGlyZWN0aW9uRmFjdG9yO3ZhciBvcHBvc2l0ZURlcHRoPWRlcHRoK2RlbHRhO3RoaXMuc2V0RGVwdGgocG9zaXRpb24sZGVwdGgpO3RoaXMuc2V0RGVwdGgob3Bwb3NpdGVQb3Msb3Bwb3NpdGVEZXB0aCk7fTt9KSgpO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3A9ZnVuY3Rpb24oZzAsZzEsdGVybWluYXRlRGlzdGFuY2Upe3RoaXMucHRMb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt0aGlzLmdlb209W107dGhpcy5nZW9tWzBdPWcwO3RoaXMuZ2VvbVsxXT1nMTt0aGlzLnRlcm1pbmF0ZURpc3RhbmNlPXRlcm1pbmF0ZURpc3RhbmNlO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuZ2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLnRlcm1pbmF0ZURpc3RhbmNlPTAuMDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5taW5EaXN0YW5jZUxvY2F0aW9uPW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUubWluRGlzdGFuY2U9TnVtYmVyLk1BWF9WQUxVRTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLmRpc3RhbmNlPWZ1bmN0aW9uKGcwLGcxKXt2YXIgZGlzdE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wKGcwLGcxLDAuMCk7cmV0dXJuIGRpc3RPcC5kaXN0YW5jZSgpO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5pc1dpdGhpbkRpc3RhbmNlPWZ1bmN0aW9uKGcwLGcxLGRpc3RhbmNlKXt2YXIgZGlzdE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wKGcwLGcxLGRpc3RhbmNlKTtyZXR1cm4gZGlzdE9wLmRpc3RhbmNlKCk8PWRpc3RhbmNlO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5uZWFyZXN0UG9pbnRzPWZ1bmN0aW9uKGcwLGcxKXt2YXIgZGlzdE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wKGcwLGcxLDAuMCk7cmV0dXJuIGRpc3RPcC5uZWFyZXN0UG9pbnRzKCk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbigpe2lmKHRoaXMuZ2VvbVswXT09PW51bGx8fHRoaXMuZ2VvbVsxXT09PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignbnVsbCBnZW9tZXRyaWVzIGFyZSBub3Qgc3VwcG9ydGVkJyk7aWYodGhpcy5nZW9tWzBdLmlzRW1wdHkoKXx8dGhpcy5nZW9tWzFdLmlzRW1wdHkoKSlcbnJldHVybiAwLjA7dGhpcy5jb21wdXRlTWluRGlzdGFuY2UoKTtyZXR1cm4gdGhpcy5taW5EaXN0YW5jZTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLm5lYXJlc3RQb2ludHM9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZSgpO3ZhciBuZWFyZXN0UHRzPVt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMF0uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMubWluRGlzdGFuY2VMb2NhdGlvblsxXS5nZXRDb29yZGluYXRlKCldO3JldHVybiBuZWFyZXN0UHRzO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUubmVhcmVzdExvY2F0aW9ucz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlKCk7cmV0dXJuIHRoaXMubWluRGlzdGFuY2VMb2NhdGlvbjt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLnVwZGF0ZU1pbkRpc3RhbmNlPWZ1bmN0aW9uKGxvY0dlb20sZmxpcCl7aWYobG9jR2VvbVswXT09PW51bGwpXG5yZXR1cm47aWYoZmxpcCl7dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzBdPWxvY0dlb21bMV07dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzFdPWxvY0dlb21bMF07fWVsc2V7dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzBdPWxvY0dlb21bMF07dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzFdPWxvY0dlb21bMV07fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4wKXt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5pZih0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb24hPT1udWxsKVxucmV0dXJuO3RoaXMubWluRGlzdGFuY2VMb2NhdGlvbj1bXTt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlKCk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt0aGlzLmNvbXB1dGVGYWNldERpc3RhbmNlKCk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0zJiYoIWFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbikpe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2U0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGxvY1B0UG9seT1bXTt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMigwLGxvY1B0UG9seSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMigxLGxvY1B0UG9seSk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTI9ZnVuY3Rpb24ocG9seUdlb21JbmRleCxsb2NQdFBvbHkpe3ZhciBsb2NhdGlvbnNJbmRleD0xLXBvbHlHZW9tSW5kZXg7dmFyIHBvbHlzPWpzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXIuZ2V0UG9seWdvbnModGhpcy5nZW9tW3BvbHlHZW9tSW5kZXhdKTtpZihwb2x5cy5sZW5ndGg+MCl7dmFyIGluc2lkZUxvY3M9anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuQ29ubmVjdGVkRWxlbWVudExvY2F0aW9uRmlsdGVyLmdldExvY2F0aW9ucyh0aGlzLmdlb21bbG9jYXRpb25zSW5kZXhdKTt0aGlzLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMyhpbnNpZGVMb2NzLHBvbHlzLGxvY1B0UG9seSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSl7dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uW2xvY2F0aW9uc0luZGV4XT1sb2NQdFBvbHlbMF07dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uW3BvbHlHZW9tSW5kZXhdPWxvY1B0UG9seVsxXTtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMz1mdW5jdGlvbihsb2NzLHBvbHlzLGxvY1B0UG9seSl7Zm9yKHZhciBpPTA7aTxsb2NzLmxlbmd0aDtpKyspe3ZhciBsb2M9bG9jc1tpXTtmb3IodmFyIGo9MDtqPHBvbHlzLmxlbmd0aDtqKyspe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2U0KGxvYyxwb2x5c1tqXSxsb2NQdFBvbHkpO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlND1mdW5jdGlvbihwdExvYyxwb2x5LGxvY1B0UG9seSl7dmFyIHB0PXB0TG9jLmdldENvb3JkaW5hdGUoKTtpZihqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IhPT10aGlzLnB0TG9jYXRvci5sb2NhdGUocHQscG9seSkpe3RoaXMubWluRGlzdGFuY2U9MC4wO2xvY1B0UG9seVswXT1wdExvYztsb2NQdFBvbHlbMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ocG9seSxwdCk7cmV0dXJuO319O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVGYWNldERpc3RhbmNlPWZ1bmN0aW9uKCl7dmFyIGxvY0dlb209W107dmFyIGxpbmVzMD1qc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXModGhpcy5nZW9tWzBdKTt2YXIgbGluZXMxPWpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lcyh0aGlzLmdlb21bMV0pO3ZhciBwdHMwPWpzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLmdldFBvaW50cyh0aGlzLmdlb21bMF0pO3ZhciBwdHMxPWpzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLmdldFBvaW50cyh0aGlzLmdlb21bMV0pO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXMobGluZXMwLGxpbmVzMSxsb2NHZW9tKTt0aGlzLnVwZGF0ZU1pbkRpc3RhbmNlKGxvY0dlb20sZmFsc2UpO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47bG9jR2VvbVswXT1udWxsO2xvY0dlb21bMV09bnVsbDt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZUxpbmVzUG9pbnRzKGxpbmVzMCxwdHMxLGxvY0dlb20pO3RoaXMudXBkYXRlTWluRGlzdGFuY2UobG9jR2VvbSxmYWxzZSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjtsb2NHZW9tWzBdPW51bGw7bG9jR2VvbVsxXT1udWxsO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXNQb2ludHMobGluZXMxLHB0czAsbG9jR2VvbSk7dGhpcy51cGRhdGVNaW5EaXN0YW5jZShsb2NHZW9tLHRydWUpO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47bG9jR2VvbVswXT1udWxsO2xvY0dlb21bMV09bnVsbDt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZVBvaW50cyhwdHMwLHB0czEsbG9jR2VvbSk7dGhpcy51cGRhdGVNaW5EaXN0YW5jZShsb2NHZW9tLGZhbHNlKTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZUxpbmVzPWZ1bmN0aW9uKGxpbmVzMCxsaW5lczEsbG9jR2VvbSl7Zm9yKHZhciBpPTA7aTxsaW5lczAubGVuZ3RoO2krKyl7dmFyIGxpbmUwPWxpbmVzMFtpXTtmb3IodmFyIGo9MDtqPGxpbmVzMS5sZW5ndGg7aisrKXt2YXIgbGluZTE9bGluZXMxW2pdO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlKGxpbmUwLGxpbmUxLGxvY0dlb20pO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZVBvaW50cz1mdW5jdGlvbihwb2ludHMwLHBvaW50czEsbG9jR2VvbSl7Zm9yKHZhciBpPTA7aTxwb2ludHMwLmxlbmd0aDtpKyspe3ZhciBwdDA9cG9pbnRzMFtpXTtmb3IodmFyIGo9MDtqPHBvaW50czEubGVuZ3RoO2orKyl7dmFyIHB0MT1wb2ludHMxW2pdO3ZhciBkaXN0PXB0MC5nZXRDb29yZGluYXRlKCkuZGlzdGFuY2UocHQxLmdldENvb3JkaW5hdGUoKSk7aWYoZGlzdDx0aGlzLm1pbkRpc3RhbmNlKXt0aGlzLm1pbkRpc3RhbmNlPWRpc3Q7bG9jR2VvbVswXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihwdDAsMCxwdDAuZ2V0Q29vcmRpbmF0ZSgpKTtsb2NHZW9tWzFdPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKHB0MSwwLHB0MS5nZXRDb29yZGluYXRlKCkpO31cbmlmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZUxpbmVzUG9pbnRzPWZ1bmN0aW9uKGxpbmVzLHBvaW50cyxsb2NHZW9tKXtmb3IodmFyIGk9MDtpPGxpbmVzLmxlbmd0aDtpKyspe3ZhciBsaW5lPWxpbmVzW2ldO2Zvcih2YXIgaj0wO2o8cG9pbnRzLmxlbmd0aDtqKyspe3ZhciBwdD1wb2ludHNbal07dGhpcy5jb21wdXRlTWluRGlzdGFuY2UobGluZSxwdCxsb2NHZW9tKTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO319fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlTWluRGlzdGFuY2UyPWZ1bmN0aW9uKGxpbmUwLGxpbmUxLGxvY0dlb20pe2lmKGxpbmUxIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZTMobGluZTAsbGluZTEsbG9jR2VvbSk7cmV0dXJuO31cbmlmKGxpbmUwLmdldEVudmVsb3BlSW50ZXJuYWwoKS5kaXN0YW5jZShsaW5lMS5nZXRFbnZlbG9wZUludGVybmFsKCkpPnRoaXMubWluRGlzdGFuY2Upe3JldHVybjt9XG52YXIgY29vcmQwPWxpbmUwLmdldENvb3JkaW5hdGVzKCk7dmFyIGNvb3JkMT1saW5lMS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8Y29vcmQwLmxlbmd0aC0xO2krKyl7Zm9yKHZhciBqPTA7ajxjb29yZDEubGVuZ3RoLTE7aisrKXt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VMaW5lTGluZShjb29yZDBbaV0sY29vcmQwW2krMV0sY29vcmQxW2pdLGNvb3JkMVtqKzFdKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMubWluRGlzdGFuY2U9ZGlzdDt2YXIgc2VnMD1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGNvb3JkMFtpXSxjb29yZDBbaSsxXSk7dmFyIHNlZzE9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChjb29yZDFbal0sY29vcmQxW2orMV0pO3ZhciBjbG9zZXN0UHQ9c2VnMC5jbG9zZXN0UG9pbnRzKHNlZzEpO2xvY0dlb21bMF09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24obGluZTAsaSxjbG9zZXN0UHRbMF0pO2xvY0dlb21bMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24obGluZTEsaixjbG9zZXN0UHRbMV0pO31cbmlmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2Upe3JldHVybjt9fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZTM9ZnVuY3Rpb24obGluZSxwdCxsb2NHZW9tKXtpZihsaW5lLmdldEVudmVsb3BlSW50ZXJuYWwoKS5kaXN0YW5jZShwdC5nZXRFbnZlbG9wZUludGVybmFsKCkpPnRoaXMubWluRGlzdGFuY2Upe3JldHVybjt9XG52YXIgY29vcmQwPWxpbmUuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgY29vcmQ9cHQuZ2V0Q29vcmRpbmF0ZSgpO2Zvcih2YXIgaT0wO2k8Y29vcmQwLmxlbmd0aC0xO2krKyl7dmFyIGRpc3Q9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKGNvb3JkLGNvb3JkMFtpXSxjb29yZDBbaSsxXSk7aWYoZGlzdDx0aGlzLm1pbkRpc3RhbmNlKXt0aGlzLm1pbkRpc3RhbmNlPWRpc3Q7dmFyIHNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGNvb3JkMFtpXSxjb29yZDBbaSsxXSk7dmFyIHNlZ0Nsb3Nlc3RQb2ludD1zZWcuY2xvc2VzdFBvaW50KGNvb3JkKTtsb2NHZW9tWzBdPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKGxpbmUsaSxzZWdDbG9zZXN0UG9pbnQpO2xvY0dlb21bMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ocHQsMCxjb29yZCk7fVxuaWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSl7cmV0dXJuO319fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZT1mdW5jdGlvbihub2RlQ2FwYWNpdHkpe25vZGVDYXBhY2l0eT1ub2RlQ2FwYWNpdHl8fDEwO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUuY2FsbCh0aGlzLG5vZGVDYXBhY2l0eSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUoKTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuY29tcGVyYXRvcj17Y29tcGFyZTpmdW5jdGlvbihvMSxvMil7cmV0dXJuIG8xLmdldEJvdW5kcygpLmdldENlbnRyZSgpLW8yLmdldEJvdW5kcygpLmdldENlbnRyZSgpO319O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZS5pbnRlcnNlY3Rpb25PcD17aW50ZXJzZWN0czpmdW5jdGlvbihhQm91bmRzLGJCb3VuZHMpe3JldHVybiBhQm91bmRzLmludGVyc2VjdHMoYkJvdW5kcyk7fX07anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24obGV2ZWwpe3ZhciBBYnN0cmFjdE5vZGU9ZnVuY3Rpb24obGV2ZWwpe2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307QWJzdHJhY3ROb2RlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSgpO0Fic3RyYWN0Tm9kZS5jb25zdHJ1Y3Rvcj1BYnN0cmFjdE5vZGU7QWJzdHJhY3ROb2RlLnByb3RvdHlwZS5jb21wdXRlQm91bmRzPWZ1bmN0aW9uKCl7dmFyIGJvdW5kcz1udWxsLGNoaWxkQm91bmRhYmxlcz10aGlzLmdldENoaWxkQm91bmRhYmxlcygpLGNoaWxkQm91bmRhYmxlO2Zvcih2YXIgaT0wLGw9Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpPGw7aSsrKXtjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoYm91bmRzPT09bnVsbCl7Ym91bmRzPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCkpO31cbmVsc2V7Ym91bmRzLmV4cGFuZFRvSW5jbHVkZShjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSk7fX1cbnJldHVybiBib3VuZHM7fTtyZXR1cm4gQWJzdHJhY3ROb2RlO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbih4MSx4MixpdGVtKXtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pbnNlcnQobmV3IGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChNYXRoLm1pbih4MSx4MiksTWF0aC5tYXgoeDEseDIpKSxpdGVtKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbih4MSx4Mil7eDI9eDJ8fHgxO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5KG5ldyBqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwoTWF0aC5taW4oeDEseDIpLE1hdGgubWF4KHgxLHgyKSkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmdldEludGVyc2VjdHNPcD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyc2VjdGlvbk9wO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmdldENvbXBhcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wZXJhdG9yO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXI9ZnVuY3Rpb24oaW5wdXRHZW9tKXt0aGlzLmlucHV0R2VvbT1pbnB1dEdlb207dGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9dHJ1ZTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5pbnB1dEdlb209bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuZGlzdGFuY2VUb2xlcmFuY2U9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuaXNFbnN1cmVWYWxpZFRvcG9sb2d5PW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXIuc2ltcGxpZnk9ZnVuY3Rpb24oZ2VvbSxkaXN0YW5jZVRvbGVyYW5jZSl7dmFyIHRzcz1uZXcganN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXIoZ2VvbSk7dHNzLnNldERpc3RhbmNlVG9sZXJhbmNlKGRpc3RhbmNlVG9sZXJhbmNlKTtyZXR1cm4gdHNzLmdldFJlc3VsdEdlb21ldHJ5KCk7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuc2V0RGlzdGFuY2VUb2xlcmFuY2U9ZnVuY3Rpb24oZGlzdGFuY2VUb2xlcmFuY2Upe2lmKGRpc3RhbmNlVG9sZXJhbmNlPDAuMCl7dGhyb3dcIlRvbGVyYW5jZSBtdXN0IGJlIG5vbi1uZWdhdGl2ZVwiO31cbnRoaXMuZGlzdGFuY2VUb2xlcmFuY2U9ZGlzdGFuY2VUb2xlcmFuY2U7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuc2V0RW5zdXJlVmFsaWQ9ZnVuY3Rpb24oaXNFbnN1cmVWYWxpZFRvcG9sb2d5KXt0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neT1pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24oKXtpZih0aGlzLmlucHV0R2VvbS5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmlucHV0R2VvbS5jbG9uZSgpO31cbnJldHVybihuZXcganN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyKHRoaXMuZGlzdGFuY2VUb2xlcmFuY2UsdGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpKS50cmFuc2Zvcm0odGhpcy5pbnB1dEdlb20pO307KGZ1bmN0aW9uKCl7anN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zLmNvbnRhaW5zPWZ1bmN0aW9uKHJlY3RhbmdsZSxiKXt2YXIgcmM9bmV3IGpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucyhyZWN0YW5nbGUpO3JldHVybiByYy5jb250YWlucyhiKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGdlb20pe2lmKCF0aGlzLnJlY3RFbnYuY29udGFpbnMoZ2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCkpKVxucmV0dXJuIGZhbHNlO2lmKHRoaXMuaXNDb250YWluZWRJbkJvdW5kYXJ5KGdlb20pKVxucmV0dXJuIGZhbHNlO3JldHVybiB0cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNDb250YWluZWRJbkJvdW5kYXJ5PWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilyZXR1cm4gZmFsc2U7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludClyZXR1cm4gdGhpcy5pc1BvaW50Q29udGFpbmVkSW5Cb3VuZGFyeShnZW9tLmdldENvb3JkaW5hdGUoKSk7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXJldHVybiB0aGlzLmlzTGluZVN0cmluZ0NvbnRhaW5lZEluQm91bmRhcnkoZ2VvbSk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBjb21wPWdlb20uZ2V0R2VvbWV0cnlOKGkpO2lmKCF0aGlzLmlzQ29udGFpbmVkSW5Cb3VuZGFyeShjb21wKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLmlzUG9pbnRDb250YWluZWRJbkJvdW5kYXJ5PWZ1bmN0aW9uKHB0KXtyZXR1cm4gcHQueD09dGhpcy5yZWN0RW52LmdldE1pblgoKXx8cHQueD09dGhpcy5yZWN0RW52LmdldE1heFgoKXx8cHQueT09dGhpcy5yZWN0RW52LmdldE1pblkoKXx8cHQueT09dGhpcy5yZWN0RW52LmdldE1heFkoKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMucHJvdG90eXBlLmlzTGluZVN0cmluZ0NvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24obGluZSl7dmFyIHNlcT1saW5lLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO2Zvcih2YXIgaT0wO2k8c2VxLmxlbmd0aC0xO2krKyl7dmFyIHAwPXNlcVtpXTt2YXIgcDE9c2VxW2krMV07aWYoIXRoaXMuaXNMaW5lU2VnbWVudENvbnRhaW5lZEluQm91bmRhcnkocDAscDEpKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNMaW5lU2VnbWVudENvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24ocDAscDEpe2lmKHAwLmVxdWFscyhwMSkpXG5yZXR1cm4gdGhpcy5pc1BvaW50Q29udGFpbmVkSW5Cb3VuZGFyeShwMCk7aWYocDAueD09cDEueCl7aWYocDAueD09dGhpcy5yZWN0RW52LmdldE1pblgoKXx8cDAueD09dGhpcy5yZWN0RW52LmdldE1heFgoKSlcbnJldHVybiB0cnVlO31cbmVsc2UgaWYocDAueT09cDEueSl7aWYocDAueT09dGhpcy5yZWN0RW52LmdldE1pblkoKXx8cDAueT09dGhpcy5yZWN0RW52LmdldE1heFkoKSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9fSkoKTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjtqc3RzLmdlb21ncmFwaC5EZXB0aD1mdW5jdGlvbigpe3RoaXMuZGVwdGg9W1tdLFtdXTtmb3IodmFyIGk9MDtpPDI7aSsrKXtmb3IodmFyIGo9MDtqPDM7aisrKXt0aGlzLmRlcHRoW2ldW2pdPWpzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU7fX19O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU9LTE7anN0cy5nZW9tZ3JhcGguRGVwdGguZGVwdGhBdExvY2F0aW9uPWZ1bmN0aW9uKGxvY2F0aW9uKXtpZihsb2NhdGlvbj09PUxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuIDA7aWYobG9jYXRpb249PT1Mb2NhdGlvbi5JTlRFUklPUilcbnJldHVybiAxO3JldHVybiBqc3RzLmdlb21ncmFwaC5EZXB0aC5OVUxMX1ZBTFVFO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmRlcHRoPW51bGw7anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmdldERlcHRoPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7cmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF07fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuc2V0RGVwdGg9ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4LGRlcHRoVmFsdWUpe3RoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF09ZGVwdGhWYWx1ZTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5nZXRMb2NhdGlvbj1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgpe2lmKHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF08PTApXG5yZXR1cm4gTG9jYXRpb24uRVhURVJJT1I7cmV0dXJuIExvY2F0aW9uLklOVEVSSU9SO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgsbG9jYXRpb24pe2lmKGxvY2F0aW9uPT09TG9jYXRpb24uSU5URVJJT1IpXG50aGlzLmRlcHRoW2dlb21JbmRleF1bcG9zSW5kZXhdKys7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4wKXtyZXR1cm4gdGhpcy5pc051bGwyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5mb3IodmFyIGk9MDtpPDI7aSsrKXtmb3IodmFyIGo9MDtqPDM7aisrKXtpZih0aGlzLmRlcHRoW2ldW2pdIT09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRSlcbnJldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuaXNOdWxsMj1mdW5jdGlvbihnZW9tSW5kZXgpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7cmV0dXJuIHRoaXMuaXNOdWxsMy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxucmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVsxXT09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5pc051bGwzPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7cmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF09PWpzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGxibCl7Zm9yKHZhciBpPTA7aTwyO2krKyl7Zm9yKHZhciBqPTE7ajwzO2orKyl7dmFyIGxvYz1sYmwuZ2V0TG9jYXRpb24oaSxqKTtpZihsb2M9PT1Mb2NhdGlvbi5FWFRFUklPUnx8bG9jPT09TG9jYXRpb24uSU5URVJJT1Ipe2lmKHRoaXMuaXNOdWxsKGksaikpe3RoaXMuZGVwdGhbaV1bal09anN0cy5nZW9tZ3JhcGguRGVwdGguZGVwdGhBdExvY2F0aW9uKGxvYyk7fWVsc2VcbnRoaXMuZGVwdGhbaV1bal0rPWpzdHMuZ2VvbWdyYXBoLkRlcHRoLmRlcHRoQXRMb2NhdGlvbihsb2MpO319fX07anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmdldERlbHRhPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZGVwdGhbZ2VvbUluZGV4XVtQb3NpdGlvbi5SSUdIVF0tXG50aGlzLmRlcHRoW2dlb21JbmRleF1bUG9zaXRpb24uTEVGVF07fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTwyO2krKyl7aWYoIXRoaXMuaXNOdWxsKGkpKXt2YXIgbWluRGVwdGg9dGhpcy5kZXB0aFtpXVsxXTtpZih0aGlzLmRlcHRoW2ldWzJdPG1pbkRlcHRoKVxubWluRGVwdGg9dGhpcy5kZXB0aFtpXVsyXTtpZihtaW5EZXB0aDwwKVxubWluRGVwdGg9MDtmb3IodmFyIGo9MTtqPDM7aisrKXt2YXIgbmV3VmFsdWU9MDtpZih0aGlzLmRlcHRoW2ldW2pdPm1pbkRlcHRoKVxubmV3VmFsdWU9MTt0aGlzLmRlcHRoW2ldW2pdPW5ld1ZhbHVlO319fX07anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJ0E6ICcrdGhpcy5kZXB0aFswXVsxXSsnLCcrdGhpcy5kZXB0aFswXVsyXSsnIEI6ICcrXG50aGlzLmRlcHRoWzFdWzFdKycsJyt0aGlzLmRlcHRoWzFdWzJdO307fSkoKTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLnByb3RvdHlwZS5pc0luQm91bmRhcnk9ZnVuY3Rpb24oYm91bmRhcnlDb3VudCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5Nb2QyQm91bmRhcnlOb2RlUnVsZS5wcm90b3R5cGU9bmV3IGpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUoKTtqc3RzLmFsZ29yaXRobS5Nb2QyQm91bmRhcnlOb2RlUnVsZS5wcm90b3R5cGUuaXNJbkJvdW5kYXJ5PWZ1bmN0aW9uKGJvdW5kYXJ5Q291bnQpe3JldHVybiBib3VuZGFyeUNvdW50JTI9PT0xO307anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5NT0QyX0JPVU5EQVJZX1JVTEU9bmV3IGpzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlKCk7anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU9anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5NT0QyX0JPVU5EQVJZX1JVTEU7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbj1mdW5jdGlvbihjb21wb25lbnQsc2VnSW5kZXgscHQpe3RoaXMuY29tcG9uZW50PWNvbXBvbmVudDt0aGlzLnNlZ0luZGV4PXNlZ0luZGV4O3RoaXMucHQ9cHQ7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLklOU0lERV9BUkVBPS0xO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLmNvbXBvbmVudD1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLnNlZ0luZGV4PW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5nZXRHZW9tZXRyeUNvbXBvbmVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBvbmVudDt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLmdldFNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNlZ0luZGV4O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuaXNJbnNpZGVBcmVhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VnSW5kZXg9PT1qc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLklOU0lERV9BUkVBO307anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXI9ZnVuY3Rpb24ocHRzKXt0aGlzLnB0cz1wdHM7fTtqc3RzLmdlb20udXRpbC5Qb2ludEV4dHJhY3Rlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcigpO2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmdlb20udXRpbC5Qb2ludEV4dHJhY3Rlci5nZXRQb2ludHM9ZnVuY3Rpb24oZ2VvbSxsaXN0KXtpZihsaXN0PT09dW5kZWZpbmVkKXtsaXN0PVtdO31cbmlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe2xpc3QucHVzaChnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyKGxpc3QpKTt9XG5yZXR1cm4gbGlzdDt9O2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludClcbnRoaXMucHRzLnB1c2goZ2VvbSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGg9ZnVuY3Rpb24oKXt0aGlzLm5vZGVzPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlTWFwKG5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3RvcnkoKSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5ub2Rlcz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLmJ1aWxkPWZ1bmN0aW9uKGdlb21HcmFwaCl7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXMoZ2VvbUdyYXBoLDApO3RoaXMuY29weU5vZGVzQW5kTGFiZWxzKGdlb21HcmFwaCwwKTt2YXIgZWVCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIoKTt2YXIgZWVMaXN0PWVlQnVpbGRlci5jb21wdXRlRWRnZUVuZHMoZ2VvbUdyYXBoLmdldEVkZ2VJdGVyYXRvcigpKTt0aGlzLmluc2VydEVkZ2VFbmRzKGVlTGlzdCk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oZ2VvbUdyYXBoLGFyZ0luZGV4KXtmb3IodmFyIGVkZ2VJdD1nZW9tR3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCk7ZWRnZUl0Lmhhc05leHQoKTspe3ZhciBlPWVkZ2VJdC5uZXh0KCk7dmFyIGVMb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KTtmb3IodmFyIGVpSXQ9ZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpLml0ZXJhdG9yKCk7ZWlJdC5oYXNOZXh0KCk7KXt2YXIgZWk9ZWlJdC5uZXh0KCk7dmFyIG49dGhpcy5ub2Rlcy5hZGROb2RlKGVpLmNvb3JkKTtpZihlTG9jPT09TG9jYXRpb24uQk9VTkRBUlkpXG5uLnNldExhYmVsQm91bmRhcnkoYXJnSW5kZXgpO2Vsc2V7aWYobi5nZXRMYWJlbCgpLmlzTnVsbChhcmdJbmRleCkpXG5uLnNldExhYmVsKGFyZ0luZGV4LExvY2F0aW9uLklOVEVSSU9SKTt9fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLmNvcHlOb2Rlc0FuZExhYmVscz1mdW5jdGlvbihnZW9tR3JhcGgsYXJnSW5kZXgpe2Zvcih2YXIgbm9kZUl0PWdlb21HcmFwaC5nZXROb2RlSXRlcmF0b3IoKTtub2RlSXQuaGFzTmV4dCgpOyl7dmFyIGdyYXBoTm9kZT1ub2RlSXQubmV4dCgpO3ZhciBuZXdOb2RlPXRoaXMubm9kZXMuYWRkTm9kZShncmFwaE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTtuZXdOb2RlLnNldExhYmVsKGFyZ0luZGV4LGdyYXBoTm9kZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuaW5zZXJ0RWRnZUVuZHM9ZnVuY3Rpb24oZWUpe2Zvcih2YXIgaT1lZS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5ub2Rlcy5hZGQoZSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuZ2V0Tm9kZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXMuaXRlcmF0b3IoKTt9O30pKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmV2ZW50cz1bXTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubk92ZXJsYXBzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGVkZ2VzLHNpLHRlc3RBbGxTZWdtZW50cyl7aWYoc2kgaW5zdGFuY2VvZiBqYXZhc2NyaXB0LnV0aWwuTGlzdCl7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5pZih0ZXN0QWxsU2VnbWVudHMpe3RoaXMuYWRkKGVkZ2VzLG51bGwpO31lbHNle3RoaXMuYWRkKGVkZ2VzKTt9XG50aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMyhzaSk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMyPWZ1bmN0aW9uKGVkZ2VzMCxlZGdlczEsc2kpe3RoaXMuYWRkKGVkZ2VzMCxlZGdlczApO3RoaXMuYWRkKGVkZ2VzMSxlZGdlczEpO3RoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMzKHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZWRnZSxlZGdlU2V0KXtpZihlZGdlIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuYWRkMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBwdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNzPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50KGVkZ2UsaSk7dmFyIGluc2VydEV2ZW50PW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudChzcy5nZXRNaW5YKCksc3MsZWRnZVNldCk7dGhpcy5ldmVudHMucHVzaChpbnNlcnRFdmVudCk7dGhpcy5ldmVudHMucHVzaChuZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQoc3MuZ2V0TWF4WCgpLGluc2VydEV2ZW50KSk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24oZWRnZXMsZWRnZVNldCl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWRnZT1pLm5leHQoKTtpZihlZGdlU2V0KXt0aGlzLmFkZChlZGdlLGVkZ2VTZXQpO31lbHNle3RoaXMuYWRkKGVkZ2UsZWRnZSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wcmVwYXJlRXZlbnRzPWZ1bmN0aW9uKCl7dGhpcy5ldmVudHMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0RlbGV0ZSgpKXtldi5nZXRJbnNlcnRFdmVudCgpLnNldERlbGV0ZUV2ZW50SW5kZXgoaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczM9ZnVuY3Rpb24oc2kpe3RoaXMubk92ZXJsYXBzPTA7dGhpcy5wcmVwYXJlRXZlbnRzKCk7Zm9yKHZhciBpPTA7aTx0aGlzLmV2ZW50cy5sZW5ndGg7aSsrKXt2YXIgZXY9dGhpcy5ldmVudHNbaV07aWYoZXYuaXNJbnNlcnQoKSl7dGhpcy5wcm9jZXNzT3ZlcmxhcHMoaSxldi5nZXREZWxldGVFdmVudEluZGV4KCksZXYsc2kpO319fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJvY2Vzc092ZXJsYXBzPWZ1bmN0aW9uKHN0YXJ0LGVuZCxldjAsc2kpe3ZhciBzczA9ZXYwLmdldE9iamVjdCgpO2Zvcih2YXIgaT1zdGFydDtpPGVuZDtpKyspe3ZhciBldjE9dGhpcy5ldmVudHNbaV07aWYoZXYxLmlzSW5zZXJ0KCkpe3ZhciBzczE9ZXYxLmdldE9iamVjdCgpO2lmKCFldjAuaXNTYW1lTGFiZWwoZXYxKSl7c3MwLmNvbXB1dGVJbnRlcnNlY3Rpb25zKHNzMSxzaSk7dGhpcy5uT3ZlcmxhcHMrKzt9fX19XG5qc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlcj1mdW5jdGlvbigpe3RoaXMuc2l0ZUNvb3Jkcz1udWxsO3RoaXMudG9sZXJhbmNlPTAuMDt0aGlzLnN1YmRpdj1udWxsO3RoaXMuY2xpcEVudj1udWxsO3RoaXMuZGlhZ3JhbUVudj1udWxsO307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzPWZ1bmN0aW9uKCl7dmFyIGFyZz1hcmd1bWVudHNbMF07aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZXx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dGhpcy5zZXRTaXRlc0J5R2VvbWV0cnkoYXJnKTt9ZWxzZXt0aGlzLnNldFNpdGVzQnlBcnJheShhcmcpO319O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlc0J5R2VvbWV0cnk9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5leHRyYWN0VW5pcXVlQ29vcmRpbmF0ZXMoZ2VvbSk7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuc2V0U2l0ZXNCeUFycmF5PWZ1bmN0aW9uKGNvb3Jkcyl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWUoY29vcmRzKTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRDbGlwRW52ZWxvcGU9ZnVuY3Rpb24oY2xpcEVudil7dGhpcy5jbGlwRW52PWNsaXBFbnY7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuc2V0VG9sZXJhbmNlPWZ1bmN0aW9uKHRvbGVyYW5jZSlcbnt0aGlzLnRvbGVyYW5jZT10b2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuY3JlYXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5zdWJkaXYhPT1udWxsKXtyZXR1cm47fVxudmFyIHNpdGVFbnYsZXhwYW5kQnksdmVydGljZXMsdHJpYW5ndWxhdG9yO3NpdGVFbnY9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmVudmVsb3BlKHRoaXMuc2l0ZUNvb3Jkcyk7dGhpcy5kaWFncmFtRW52PXNpdGVFbnY7ZXhwYW5kQnk9TWF0aC5tYXgodGhpcy5kaWFncmFtRW52LmdldFdpZHRoKCksdGhpcy5kaWFncmFtRW52LmdldEhlaWdodCgpKTt0aGlzLmRpYWdyYW1FbnYuZXhwYW5kQnkoZXhwYW5kQnkpO2lmKHRoaXMuY2xpcEVudiE9PW51bGwpe3RoaXMuZGlhZ3JhbUVudi5leHBhbmRUb0luY2x1ZGUodGhpcy5jbGlwRW52KTt9XG52ZXJ0aWNlcz1qc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIudG9WZXJ0aWNlcyh0aGlzLnNpdGVDb29yZHMpO3RoaXMuc3ViZGl2PW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24oc2l0ZUVudix0aGlzLnRvbGVyYW5jZSk7dHJpYW5ndWxhdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLkluY3JlbWVudGFsRGVsYXVuYXlUcmlhbmd1bGF0b3IodGhpcy5zdWJkaXYpO3RyaWFuZ3VsYXRvci5pbnNlcnRTaXRlcyh2ZXJ0aWNlcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuZ2V0U3ViZGl2aXNpb249ZnVuY3Rpb24oKXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdjt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5nZXREaWFncmFtPWZ1bmN0aW9uKGdlb21GYWN0KXt0aGlzLmNyZWF0ZSgpO3ZhciBwb2x5cz10aGlzLnN1YmRpdi5nZXRWb3Jvbm9pRGlhZ3JhbShnZW9tRmFjdCk7cmV0dXJuIHRoaXMuY2xpcEdlb21ldHJ5Q29sbGVjdGlvbihwb2x5cyx0aGlzLmRpYWdyYW1FbnYpO307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLmNsaXBHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbSxjbGlwRW52KXt2YXIgY2xpcFBvbHksY2xpcHBlZCxpLGlsLGcscmVzdWx0O2NsaXBQb2x5PWdlb20uZ2V0RmFjdG9yeSgpLnRvR2VvbWV0cnkoY2xpcEVudik7Y2xpcHBlZD1bXTtpPTAsaWw9Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7Zm9yKGk7aTxpbDtpKyspe2c9Z2VvbS5nZXRHZW9tZXRyeU4oaSk7cmVzdWx0PW51bGw7aWYoY2xpcEVudi5jb250YWlucyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3Jlc3VsdD1nO31cbmVsc2UgaWYoY2xpcEVudi5pbnRlcnNlY3RzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmVzdWx0PWNsaXBQb2x5LmludGVyc2VjdGlvbihnKTt9XG5pZihyZXN1bHQhPT1udWxsJiYhcmVzdWx0LmlzRW1wdHkoKSl7Y2xpcHBlZC5wdXNoKHJlc3VsdCk7fX1cbnJldHVybiBnZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oY2xpcHBlZCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlcj1mdW5jdGlvbihncmFwaCl7dGhpcy5ncmFwaD1ncmFwaDt0aGlzLnJpbmdzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy50b3RhbEVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy5pbmRleD1udWxsO3RoaXMubmVzdGVkUHQ9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkluZGV4ZWROZXN0ZWRSaW5nVGVzdGVyLnByb3RvdHlwZS5nZXROZXN0ZWRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5lc3RlZFB0O307anN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihyaW5nKXt0aGlzLnJpbmdzLmFkZChyaW5nKTt0aGlzLnRvdGFsRW52LmV4cGFuZFRvSW5jbHVkZShyaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlci5wcm90b3R5cGUuaXNOb25OZXN0ZWQ9ZnVuY3Rpb24oKXt0aGlzLmJ1aWxkSW5kZXgoKTtmb3IodmFyIGk9MDtpPHRoaXMucmluZ3Muc2l6ZSgpO2krKyl7dmFyIGlubmVyUmluZz10aGlzLnJpbmdzLmdldChpKTt2YXIgaW5uZXJSaW5nUHRzPWlubmVyUmluZy5nZXRDb29yZGluYXRlcygpO3ZhciByZXN1bHRzPXRoaXMuaW5kZXgucXVlcnkoaW5uZXJSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7Zm9yKHZhciBqPTA7ajxyZXN1bHRzLmxlbmd0aDtqKyspe3ZhciBzZWFyY2hSaW5nPXJlc3VsdHNbal07dmFyIHNlYXJjaFJpbmdQdHM9c2VhcmNoUmluZy5nZXRDb29yZGluYXRlcygpO2lmKGlubmVyUmluZz09c2VhcmNoUmluZyl7Y29udGludWU7fVxuaWYoIWlubmVyUmluZy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhzZWFyY2hSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe2NvbnRpbnVlO31cbnZhciBpbm5lclJpbmdQdD1qc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZShpbm5lclJpbmdQdHMsc2VhcmNoUmluZyx0aGlzLmdyYXBoKTtpZihpbm5lclJpbmdQdD09bnVsbCl7Y29udGludWU7fVxudmFyIGlzSW5zaWRlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKGlubmVyUmluZ1B0LHNlYXJjaFJpbmdQdHMpO2lmKGlzSW5zaWRlKXt0aGlzLm5lc3RlZFB0PWlubmVyUmluZ1B0O3JldHVybiBmYWxzZTt9fX1cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIucHJvdG90eXBlLmJ1aWxkSW5kZXg9ZnVuY3Rpb24oKXt0aGlzLmluZGV4PW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZSgpO2Zvcih2YXIgaT0wO2k8dGhpcy5yaW5ncy5zaXplKCk7aSsrKXt2YXIgcmluZz10aGlzLnJpbmdzLmdldChpKTt2YXIgZW52PXJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3RoaXMuaW5kZXguaW5zZXJ0KGVudixyaW5nKTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluPWZ1bmN0aW9uKG1jZSxjaGFpbkluZGV4KXt0aGlzLm1jZT1tY2U7dGhpcy5jaGFpbkluZGV4PWNoYWluSW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5tY2U9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jaGFpbkluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24obWMsc2kpe3RoaXMubWNlLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4odGhpcy5jaGFpbkluZGV4LG1jLm1jZSxtYy5jaGFpbkluZGV4LHNpKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlPWZ1bmN0aW9uKHNlZ1N0cmluZyxjb29yZCxzZWdtZW50SW5kZXgsc2VnbWVudE9jdGFudCl7dGhpcy5zZWdTdHJpbmc9c2VnU3RyaW5nO3RoaXMuY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3JkKTt0aGlzLnNlZ21lbnRJbmRleD1zZWdtZW50SW5kZXg7dGhpcy5zZWdtZW50T2N0YW50PXNlZ21lbnRPY3RhbnQ7dGhpcy5faXNJbnRlcmlvcj0hY29vcmQuZXF1YWxzMkQoc2VnU3RyaW5nLmdldENvb3JkaW5hdGUoc2VnbWVudEluZGV4KSk7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuc2VnU3RyaW5nPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLmNvb3JkPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLnNlZ21lbnRJbmRleD1udWxsO2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5zZWdtZW50T2N0YW50PW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLl9pc0ludGVyaW9yPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZDt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5pc0ludGVyaW9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSW50ZXJpb3I7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuaXNFbmRQb2ludD1mdW5jdGlvbihtYXhTZWdtZW50SW5kZXgpe2lmKHRoaXMuc2VnbWVudEluZGV4PT09MCYmIXRoaXMuX2lzSW50ZXJpb3IpcmV0dXJuIHRydWU7aWYodGhpcy5zZWdtZW50SW5kZXg9PT10aGlzLm1heFNlZ21lbnRJbmRleClyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG9iail7dmFyIG90aGVyPW9iajtpZih0aGlzLnNlZ21lbnRJbmRleDxvdGhlci5zZWdtZW50SW5kZXgpcmV0dXJuLTE7aWYodGhpcy5zZWdtZW50SW5kZXg+b3RoZXIuc2VnbWVudEluZGV4KXJldHVybiAxO2lmKHRoaXMuY29vcmQuZXF1YWxzMkQob3RoZXIuY29vcmQpKXJldHVybiAwO3JldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmUodGhpcy5zZWdtZW50T2N0YW50LHRoaXMuY29vcmQsb3RoZXIuY29vcmQpO307KGZ1bmN0aW9uKCl7anN0cy5pby5HZW9KU09OV3JpdGVyPWZ1bmN0aW9uKCl7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uR2VvSlNPTlBhcnNlcih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLmlvLkdlb0pTT05Xcml0ZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgZ2VvSnNvbj10aGlzLnBhcnNlci53cml0ZShnZW9tZXRyeSk7cmV0dXJuIGdlb0pzb247fTt9KSgpO2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeXx8bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUucmVhZD1mdW5jdGlvbihnZW9tZXRyeSl7aWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50Jyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21Qb2ludChnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbUxpbmVTdHJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21MaW5lYXJSaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnQnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbU11bHRpUG9pbnQoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbU11bHRpTGluZVN0cmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTXVsdGlQb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbicpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tQ29sbGVjdGlvbihnZW9tZXRyeSk7fX07anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbVBvaW50PWZ1bmN0aW9uKHBvaW50KXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHBvaW50LngscG9pbnQueSkpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbUxpbmVTdHJpbmc9ZnVuY3Rpb24obGluZVN0cmluZyl7dmFyIGk7dmFyIGNvb3JkaW5hdGVzPVtdO2ZvcihpPTA7aTxsaW5lU3RyaW5nLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7Y29vcmRpbmF0ZXMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUobGluZVN0cmluZy5jb21wb25lbnRzW2ldLngsbGluZVN0cmluZy5jb21wb25lbnRzW2ldLnkpKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhjb29yZGluYXRlcyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTGluZWFyUmluZz1mdW5jdGlvbihsaW5lYXJSaW5nKXt2YXIgaTt2YXIgY29vcmRpbmF0ZXM9W107Zm9yKGk9MDtpPGxpbmVhclJpbmcuY29tcG9uZW50cy5sZW5ndGg7aSsrKXtjb29yZGluYXRlcy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShsaW5lYXJSaW5nLmNvbXBvbmVudHNbaV0ueCxsaW5lYXJSaW5nLmNvbXBvbmVudHNbaV0ueSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvb3JkaW5hdGVzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydEZyb21Qb2x5Z29uPWZ1bmN0aW9uKHBvbHlnb24pe3ZhciBpO3ZhciBzaGVsbD1udWxsO3ZhciBob2xlcz1bXTtmb3IoaT0wO2k8cG9seWdvbi5jb21wb25lbnRzLmxlbmd0aDtpKyspe3ZhciBsaW5lYXJSaW5nPXRoaXMuY29udmVydEZyb21MaW5lYXJSaW5nKHBvbHlnb24uY29tcG9uZW50c1tpXSk7aWYoaT09PTApe3NoZWxsPWxpbmVhclJpbmc7fWVsc2V7aG9sZXMucHVzaChsaW5lYXJSaW5nKTt9fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24oc2hlbGwsaG9sZXMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbU11bHRpUG9pbnQ9ZnVuY3Rpb24obXVsdGlQb2ludCl7dmFyIGk7dmFyIHBvaW50cz1bXTtmb3IoaT0wO2k8bXVsdGlQb2ludC5jb21wb25lbnRzLmxlbmd0aDtpKyspe3BvaW50cy5wdXNoKHRoaXMuY29udmVydEZyb21Qb2ludChtdWx0aVBvaW50LmNvbXBvbmVudHNbaV0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2ludChwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbU11bHRpTGluZVN0cmluZz1mdW5jdGlvbihtdWx0aUxpbmVTdHJpbmcpe3ZhciBpO3ZhciBsaW5lU3RyaW5ncz1bXTtmb3IoaT0wO2k8bXVsdGlMaW5lU3RyaW5nLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7bGluZVN0cmluZ3MucHVzaCh0aGlzLmNvbnZlcnRGcm9tTGluZVN0cmluZyhtdWx0aUxpbmVTdHJpbmcuY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobGluZVN0cmluZ3MpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbU11bHRpUG9seWdvbj1mdW5jdGlvbihtdWx0aVBvbHlnb24pe3ZhciBpO3ZhciBwb2x5Z29ucz1bXTtmb3IoaT0wO2k8bXVsdGlQb2x5Z29uLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7cG9seWdvbnMucHVzaCh0aGlzLmNvbnZlcnRGcm9tUG9seWdvbihtdWx0aVBvbHlnb24uY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvbHlnb24ocG9seWdvbnMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbUNvbGxlY3Rpb249ZnVuY3Rpb24oY29sbGVjdGlvbil7dmFyIGk7dmFyIGdlb21ldHJpZXM9W107Zm9yKGk9MDtpPGNvbGxlY3Rpb24uY29tcG9uZW50cy5sZW5ndGg7aSsrKXtnZW9tZXRyaWVzLnB1c2godGhpcy5yZWFkKGNvbGxlY3Rpb24uY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oZ2VvbWV0cmllcyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5Qb2ludCcpe3JldHVybiB0aGlzLmNvbnZlcnRUb1BvaW50KGdlb21ldHJ5LmNvb3JkaW5hdGUpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLkxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9MaW5lU3RyaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5MaW5lYXJSaW5nJyl7cmV0dXJuIHRoaXMuY29udmVydFRvTGluZWFyUmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRUb1BvbHlnb24oZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLk11bHRpUG9pbnQnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9NdWx0aVBvaW50KGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9NdWx0aUxpbmVTdHJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLk11bHRpUG9seWdvbicpe3JldHVybiB0aGlzLmNvbnZlcnRUb011bHRpUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJyl7cmV0dXJuIHRoaXMuY29udmVydFRvQ29sbGVjdGlvbihnZW9tZXRyeSk7fX07anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9Qb2ludD1mdW5jdGlvbihjb29yZGluYXRlKXtyZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQoY29vcmRpbmF0ZS54LGNvb3JkaW5hdGUueSk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb0xpbmVTdHJpbmc9ZnVuY3Rpb24obGluZVN0cmluZyl7dmFyIGk7dmFyIHBvaW50cz1bXTtmb3IoaT0wO2k8bGluZVN0cmluZy5wb2ludHMubGVuZ3RoO2krKyl7dmFyIGNvb3JkaW5hdGU9bGluZVN0cmluZy5wb2ludHNbaV07cG9pbnRzLnB1c2godGhpcy5jb252ZXJ0VG9Qb2ludChjb29yZGluYXRlKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVTdHJpbmcocG9pbnRzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvTGluZWFyUmluZz1mdW5jdGlvbihsaW5lYXJSaW5nKXt2YXIgaTt2YXIgcG9pbnRzPVtdO2ZvcihpPTA7aTxsaW5lYXJSaW5nLnBvaW50cy5sZW5ndGg7aSsrKXt2YXIgY29vcmRpbmF0ZT1saW5lYXJSaW5nLnBvaW50c1tpXTtwb2ludHMucHVzaCh0aGlzLmNvbnZlcnRUb1BvaW50KGNvb3JkaW5hdGUpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZWFyUmluZyhwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9Qb2x5Z29uPWZ1bmN0aW9uKHBvbHlnb24pe3ZhciBpO3ZhciByaW5ncz1bXTtyaW5ncy5wdXNoKHRoaXMuY29udmVydFRvTGluZWFyUmluZyhwb2x5Z29uLnNoZWxsKSk7Zm9yKGk9MDtpPHBvbHlnb24uaG9sZXMubGVuZ3RoO2krKyl7dmFyIHJpbmc9cG9seWdvbi5ob2xlc1tpXTtyaW5ncy5wdXNoKHRoaXMuY29udmVydFRvTGluZWFyUmluZyhyaW5nKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvbHlnb24ocmluZ3MpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9NdWx0aVBvaW50PWZ1bmN0aW9uKG11bHRpUG9pbnQpe3ZhciBpO3ZhciBwb2ludHM9W107Zm9yKGk9MDtpPG11bHRpUG9pbnQuZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXt2YXIgY29vcmRpbmF0ZT1tdWx0aVBvaW50Lmdlb21ldHJpZXNbaV0uY29vcmRpbmF0ZTtwb2ludHMucHVzaChuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjb29yZGluYXRlLngsY29vcmRpbmF0ZS55KSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9pbnQocG9pbnRzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKG11bHRpTGluZVN0cmluZyl7dmFyIGk7dmFyIGxpbmVTdHJpbmdzPVtdO2ZvcihpPTA7aTxtdWx0aUxpbmVTdHJpbmcuZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXtsaW5lU3RyaW5ncy5wdXNoKHRoaXMuY29udmVydFRvTGluZVN0cmluZyhtdWx0aUxpbmVTdHJpbmcuZ2VvbWV0cmllc1tpXSkpO31cbnJldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5NdWx0aUxpbmVTdHJpbmcobGluZVN0cmluZ3MpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9NdWx0aVBvbHlnb249ZnVuY3Rpb24obXVsdGlQb2x5Z29uKXt2YXIgaTt2YXIgcG9seWdvbnM9W107Zm9yKGk9MDtpPG11bHRpUG9seWdvbi5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3BvbHlnb25zLnB1c2godGhpcy5jb252ZXJ0VG9Qb2x5Z29uKG11bHRpUG9seWdvbi5nZW9tZXRyaWVzW2ldKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpUG9seWdvbihwb2x5Z29ucyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb0NvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbWV0cnlDb2xsZWN0aW9uKXt2YXIgaTt2YXIgZ2VvbWV0cmllcz1bXTtmb3IoaT0wO2k8Z2VvbWV0cnlDb2xsZWN0aW9uLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7dmFyIGdlb21ldHJ5PWdlb21ldHJ5Q29sbGVjdGlvbi5nZW9tZXRyaWVzW2ldO3ZhciBnZW9tZXRyeU9wZW5MYXllcnM9dGhpcy53cml0ZShnZW9tZXRyeSk7Z2VvbWV0cmllcy5wdXNoKGdlb21ldHJ5T3BlbkxheWVycyk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LkNvbGxlY3Rpb24oZ2VvbWV0cmllcyk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlPWZ1bmN0aW9uKCl7dGhpcy5yb290PW5ldyBqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3QoKTt0aGlzLm1pbkV4dGVudD0xLjA7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLmVuc3VyZUV4dGVudD1mdW5jdGlvbihpdGVtRW52LG1pbkV4dGVudCl7dmFyIG1pbngsbWF4eCxtaW55LG1heHk7bWlueD1pdGVtRW52LmdldE1pblgoKTttYXh4PWl0ZW1FbnYuZ2V0TWF4WCgpO21pbnk9aXRlbUVudi5nZXRNaW5ZKCk7bWF4eT1pdGVtRW52LmdldE1heFkoKTtpZihtaW54IT09bWF4eCYmbWlueSE9PW1heHkpe3JldHVybiBpdGVtRW52O31cbmlmKG1pbng9PT1tYXh4KXttaW54PW1pbngtKG1pbkV4dGVudC8yLjApO21heHg9bWlueCsobWluRXh0ZW50LzIuMCk7fVxuaWYobWlueT09PW1heHkpe21pbnk9bWlueS0obWluRXh0ZW50LzIuMCk7bWF4eT1taW55KyhtaW5FeHRlbnQvMi4wKTt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShtaW54LG1heHgsbWlueSxtYXh5KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm9vdC5kZXB0aCgpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJvb3Quc2l6ZSgpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dGhpcy5jb2xsZWN0U3RhdHMoaXRlbUVudik7dmFyIGluc2VydEVudj1qc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLmVuc3VyZUV4dGVudChpdGVtRW52LHRoaXMubWluRXh0ZW50KTt0aGlzLnJvb3QuaW5zZXJ0KGluc2VydEVudixpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtRW52LGl0ZW0pe3ZhciBwb3NFbnY9anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5lbnN1cmVFeHRlbnQoaXRlbUVudix0aGlzLm1pbkV4dGVudCk7cmV0dXJuIHRoaXMucm9vdC5yZW1vdmUocG9zRW52LGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIGpzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLnF1ZXJ5QnlFbnZlbG9wZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlXaXRoVmlzaXRvci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX07anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlCeUVudmVsb3BlPWZ1bmN0aW9uKHNlYXJjaEVudil7dmFyIHZpc2l0b3I9bmV3IGpzdHMuaW5kZXguQXJyYXlMaXN0VmlzaXRvcigpO3RoaXMucXVlcnkoc2VhcmNoRW52LHZpc2l0b3IpO3JldHVybiB2aXNpdG9yLmdldEl0ZW1zKCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeVdpdGhWaXNpdG9yPWZ1bmN0aW9uKHNlYXJjaEVudix2aXNpdG9yKXt0aGlzLnJvb3QudmlzaXQoc2VhcmNoRW52LHZpc2l0b3IpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlBbGw9ZnVuY3Rpb24oKXt2YXIgZm91bmRJdGVtcz1bXTtmb3VuZEl0ZW1zPXRoaXMucm9vdC5hZGRBbGxJdGVtcyhmb3VuZEl0ZW1zKTtyZXR1cm4gZm91bmRJdGVtczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLmNvbGxlY3RTdGF0cz1mdW5jdGlvbihpdGVtRW52KXt2YXIgZGVsWD1pdGVtRW52LmdldFdpZHRoKCk7aWYoZGVsWDx0aGlzLm1pbkV4dGVudCYmZGVsWD4wLjApe3RoaXMubWluRXh0ZW50PWRlbFg7fVxudmFyIGRlbFk9aXRlbUVudi5nZXRIZWlnaHQoKTtpZihkZWxZPHRoaXMubWluRXh0ZW50JiZkZWxZPjAuMCl7dGhpcy5taW5FeHRlbnQ9ZGVsWTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3Rvcnk9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlRmFjdG9yeS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGVGYWN0b3J5KCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gbmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlKGNvb3JkLG5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZVN0YXIoKSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleT1mdW5jdGlvbihpdGVtRW52KXt0aGlzLnB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMubGV2ZWw9MDt0aGlzLmVudj1udWxsO3RoaXMuY29tcHV0ZUtleShpdGVtRW52KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LmNvbXB1dGVRdWFkTGV2ZWw9ZnVuY3Rpb24oZW52KXt2YXIgZHgsZHksZE1heCxsZXZlbDtkeD1lbnYuZ2V0V2lkdGgoKTtkeT1lbnYuZ2V0SGVpZ2h0KCk7ZE1heD1keD5keT9keDpkeTtsZXZlbD1qc3RzLmluZGV4LkRvdWJsZUJpdHMuZXhwb25lbnQoZE1heCkrMTtyZXR1cm4gbGV2ZWw7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuZ2V0UG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxldmVsO307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW52O307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmdldENlbnRyZT1mdW5jdGlvbigpe3ZhciB4LHk7eD0odGhpcy5lbnYuZ2V0TWluWCgpK3RoaXMuZW52LmdldE1heFgoKSkvMjt5PSh0aGlzLmVudi5nZXRNaW5ZKCkrdGhpcy5lbnYuZ2V0TWF4WSgpKS8yO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5jb21wdXRlS2V5PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUpe3RoaXMuY29tcHV0ZUtleUZyb21FbnZlbG9wZShhcmd1bWVudHNbMF0pO31lbHNle3RoaXMuY29tcHV0ZUtleUZyb21MZXZlbChhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuY29tcHV0ZUtleUZyb21FbnZlbG9wZT1mdW5jdGlvbihlbnYpe3RoaXMubGV2ZWw9anN0cy5pbmRleC5xdWFkdHJlZS5LZXkuY29tcHV0ZVF1YWRMZXZlbChlbnYpO3RoaXMuZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLmNvbXB1dGVLZXkodGhpcy5sZXZlbCxlbnYpO3doaWxlKCF0aGlzLmVudi5jb250YWlucyhlbnYpKXt0aGlzLmxldmVsKz0xO3RoaXMuY29tcHV0ZUtleSh0aGlzLmxldmVsLGVudik7fX07anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmNvbXB1dGVLZXlGcm9tTGV2ZWw9ZnVuY3Rpb24obGV2ZWwsZW52KXt2YXIgcXVhZFNpemU9anN0cy5pbmRleC5Eb3VibGVCaXRzLnBvd2VyT2YyKGxldmVsKTt0aGlzLnB0Lng9TWF0aC5mbG9vcihlbnYuZ2V0TWluWCgpL3F1YWRTaXplKSpxdWFkU2l6ZTt0aGlzLnB0Lnk9TWF0aC5mbG9vcihlbnYuZ2V0TWluWSgpL3F1YWRTaXplKSpxdWFkU2l6ZTt0aGlzLmVudi5pbml0KHRoaXMucHQueCx0aGlzLnB0LngrcXVhZFNpemUsdGhpcy5wdC55LHRoaXMucHQueStcbnF1YWRTaXplKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiBqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcDEoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09NSl7anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAyKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSxhcmd1bWVudHNbNF0pO319O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwMT1mdW5jdGlvbihjb29yZGluYXRlcyl7dmFyIGNvcHk9W107Zm9yKHZhciBpPTA7aTxjb29yZGluYXRlcy5sZW5ndGg7aSsrKXtjb3B5W2ldPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShjb29yZGluYXRlc1tpXSk7fVxucmV0dXJuIGNvcHk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcDI9ZnVuY3Rpb24oc3JjLHNyY1N0YXJ0LGRlc3QsZGVzdFN0YXJ0LGxlbmd0aCl7Zm9yKHZhciBpPTA7aTxsZW5ndGg7aSsrKXtkZXN0W2Rlc3RTdGFydCtpXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoc3JjW3NyY1N0YXJ0K2ldKTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cz1mdW5jdGlvbihjb29yZCl7dmFyIGNvb3JkTGlzdDtpZighdGhpcy5oYXNSZXBlYXRlZFBvaW50cyhjb29yZCkpe3JldHVybiBjb29yZDt9XG5jb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdChjb29yZCxmYWxzZSk7cmV0dXJuIGNvb3JkTGlzdC50b0Nvb3JkaW5hdGVBcnJheSgpO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaGFzUmVwZWF0ZWRQb2ludHM9ZnVuY3Rpb24oY29vcmQpe3ZhciBpO2ZvcihpPTE7aTxjb29yZC5sZW5ndGg7aSsrKXtpZihjb29yZFtpLTFdLmVxdWFscyhjb29yZFtpXSkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5wdE5vdEluTGlzdD1mdW5jdGlvbih0ZXN0UHRzLHB0cyl7Zm9yKHZhciBpPTA7aTx0ZXN0UHRzLmxlbmd0aDtpKyspe3ZhciB0ZXN0UHQ9dGVzdFB0c1tpXTtpZihqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmRleE9mKHRlc3RQdCxwdHMpPDApXG5yZXR1cm4gdGVzdFB0O31cbnJldHVybiBudWxsO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaW5jcmVhc2luZ0RpcmVjdGlvbj1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cGFyc2VJbnQocHRzLmxlbmd0aC8yKTtpKyspe3ZhciBqPXB0cy5sZW5ndGgtMS1pO3ZhciBjb21wPXB0c1tpXS5jb21wYXJlVG8ocHRzW2pdKTtpZihjb21wIT0wKVxucmV0dXJuIGNvbXA7fVxucmV0dXJuIDE7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5taW5Db29yZGluYXRlPWZ1bmN0aW9uKGNvb3JkaW5hdGVzKXt2YXIgbWluQ29vcmQ9bnVsbDtmb3IodmFyIGk9MDtpPGNvb3JkaW5hdGVzLmxlbmd0aDtpKyspe2lmKG1pbkNvb3JkPT09bnVsbHx8bWluQ29vcmQuY29tcGFyZVRvKGNvb3JkaW5hdGVzW2ldKT4wKXttaW5Db29yZD1jb29yZGluYXRlc1tpXTt9fVxucmV0dXJuIG1pbkNvb3JkO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuc2Nyb2xsPWZ1bmN0aW9uKGNvb3JkaW5hdGVzLGZpcnN0Q29vcmRpbmF0ZSl7dmFyIGk9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaW5kZXhPZihmaXJzdENvb3JkaW5hdGUsY29vcmRpbmF0ZXMpO2lmKGk8MClcbnJldHVybjt2YXIgbmV3Q29vcmRpbmF0ZXM9Y29vcmRpbmF0ZXMuc2xpY2UoaSkuY29uY2F0KGNvb3JkaW5hdGVzLnNsaWNlKDAsaSkpO2ZvcihpPTA7aTxuZXdDb29yZGluYXRlcy5sZW5ndGg7aSsrKXtjb29yZGluYXRlc1tpXT1uZXdDb29yZGluYXRlc1tpXTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmRleE9mPWZ1bmN0aW9uKGNvb3JkaW5hdGUsY29vcmRpbmF0ZXMpe2Zvcih2YXIgaT0wO2k8Y29vcmRpbmF0ZXMubGVuZ3RoO2krKyl7aWYoY29vcmRpbmF0ZS5lcXVhbHMoY29vcmRpbmF0ZXNbaV0pKXtyZXR1cm4gaTt9fVxucmV0dXJuLTE7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1pbmltYWxFZGdlUmluZz1mdW5jdGlvbihzdGFydCxnZW9tZXRyeUZhY3Rvcnkpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLmNhbGwodGhpcyxzdGFydCxnZW9tZXRyeUZhY3RvcnkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlUmluZygpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nLmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKGRlKXtyZXR1cm4gZGUuZ2V0TmV4dE1pbigpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGRlLGVyKXtkZS5zZXRNaW5FZGdlUmluZyhlcik7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXI9ZnVuY3Rpb24oKXt0aGlzLnNpdGVDb29yZHM9bnVsbDt0aGlzLnRvbGVyYW5jZT0wLjA7dGhpcy5zdWJkaXY9bnVsbDt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5leHRyYWN0VW5pcXVlQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbT09PXVuZGVmaW5lZHx8Z2VvbT09PW51bGwpe3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKS50b0FycmF5KCk7fVxudmFyIGNvb3Jkcz1nZW9tLmdldENvb3JkaW5hdGVzKCk7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWUoY29vcmRzKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWU9ZnVuY3Rpb24oY29vcmRzKXtjb29yZHMuc29ydChmdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9KTt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoY29vcmRzLGZhbHNlKTtyZXR1cm4gY29vcmRMaXN0LnRvQXJyYXkoKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci50b1ZlcnRpY2VzPWZ1bmN0aW9uKGNvb3Jkcyl7dmFyIHZlcnRzPW5ldyBBcnJheShjb29yZHMubGVuZ3RoKSxpPTAsaWw9Y29vcmRzLmxlbmd0aCxjb29yZDtmb3IoaTtpPGlsO2krKyl7Y29vcmQ9Y29vcmRzW2ldO3ZlcnRzW2ldPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChjb29yZCk7fVxucmV0dXJuIHZlcnRzO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmVudmVsb3BlPWZ1bmN0aW9uKGNvb3Jkcyl7dmFyIGVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCksaT0wLGlsPWNvb3Jkcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe2Vudi5leHBhbmRUb0luY2x1ZGUoY29vcmRzW2ldKTt9XG5yZXR1cm4gZW52O307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlcz1mdW5jdGlvbigpe3ZhciBhcmc9YXJndW1lbnRzWzBdO2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeXx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGV8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludHx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZ3x8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb258fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3RoaXMuc2V0U2l0ZXNGcm9tR2VvbWV0cnkoYXJnKTt9ZWxzZXt0aGlzLnNldFNpdGVzRnJvbUNvbGxlY3Rpb24oYXJnKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzRnJvbUdlb21ldHJ5PWZ1bmN0aW9uKGdlb20pe3RoaXMuc2l0ZUNvb3Jkcz1qc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIuZXh0cmFjdFVuaXF1ZUNvb3JkaW5hdGVzKGdlb20pO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlc0Zyb21Db2xsZWN0aW9uPWZ1bmN0aW9uKGNvb3Jkcyl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci51bmlxdWUoY29vcmRzKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuc2V0VG9sZXJhbmNlPWZ1bmN0aW9uKHRvbGVyYW5jZSl7dGhpcy50b2xlcmFuY2U9dG9sZXJhbmNlO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24oKXtpZih0aGlzLnN1YmRpdj09PW51bGwpe3ZhciBzaXRlRW52LHZlcnRpY2VzLHRyaWFuZ3VsYXRvcjtzaXRlRW52PWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5lbnZlbG9wZSh0aGlzLnNpdGVDb29yZHMpO3ZlcnRpY2VzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci50b1ZlcnRpY2VzKHRoaXMuc2l0ZUNvb3Jkcyk7dGhpcy5zdWJkaXY9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbihzaXRlRW52LHRoaXMudG9sZXJhbmNlKTt0cmlhbmd1bGF0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvcih0aGlzLnN1YmRpdik7dHJpYW5ndWxhdG9yLmluc2VydFNpdGVzKHZlcnRpY2VzKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmdldFN1YmRpdmlzaW9uPWZ1bmN0aW9uKCl7dGhpcy5jcmVhdGUoKTtyZXR1cm4gdGhpcy5zdWJkaXY7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKGdlb21GYWN0KXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdi5nZXRFZGdlcyhnZW9tRmFjdCk7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmdldFRyaWFuZ2xlcz1mdW5jdGlvbihnZW9tRmFjdCl7dGhpcy5jcmVhdGUoKTtyZXR1cm4gdGhpcy5zdWJkaXYuZ2V0VHJpYW5nbGVzKGdlb21GYWN0KTt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlcj1mdW5jdGlvbihwKXt0aGlzLnA9cDt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5sb2NhdGVQb2ludEluUmluZz1mdW5jdGlvbihwLHJpbmcpe3ZhciBjb3VudGVyPW5ldyBqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIocCk7Zm9yKHZhciBpPTE7aTxyaW5nLmxlbmd0aDtpKyspe3ZhciBwMT1yaW5nW2ldO3ZhciBwMj1yaW5nW2ktMV07Y291bnRlci5jb3VudFNlZ21lbnQocDEscDIpO2lmKGNvdW50ZXIuaXNPblNlZ21lbnQoKSlcbnJldHVybiBjb3VudGVyLmdldExvY2F0aW9uKCk7fVxucmV0dXJuIGNvdW50ZXIuZ2V0TG9jYXRpb24oKTt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUucD1udWxsO2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuY3Jvc3NpbmdDb3VudD0wO2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuaXNQb2ludE9uU2VnbWVudD1mYWxzZTtqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIucHJvdG90eXBlLmNvdW50U2VnbWVudD1mdW5jdGlvbihwMSxwMil7aWYocDEueDx0aGlzLnAueCYmcDIueDx0aGlzLnAueClcbnJldHVybjtpZih0aGlzLnAueD09cDIueCYmdGhpcy5wLnk9PT1wMi55KXt0aGlzLmlzUG9pbnRPblNlZ21lbnQ9dHJ1ZTtyZXR1cm47fVxuaWYocDEueT09PXRoaXMucC55JiZwMi55PT09dGhpcy5wLnkpe3ZhciBtaW54PXAxLng7dmFyIG1heHg9cDIueDtpZihtaW54Pm1heHgpe21pbng9cDIueDttYXh4PXAxLng7fVxuaWYodGhpcy5wLng+PW1pbngmJnRoaXMucC54PD1tYXh4KXt0aGlzLmlzUG9pbnRPblNlZ21lbnQ9dHJ1ZTt9XG5yZXR1cm47fVxuaWYoKChwMS55PnRoaXMucC55KSYmKHAyLnk8PXRoaXMucC55KSl8fCgocDIueT50aGlzLnAueSkmJihwMS55PD10aGlzLnAueSkpKXt2YXIgeDE9cDEueC10aGlzLnAueDt2YXIgeTE9cDEueS10aGlzLnAueTt2YXIgeDI9cDIueC10aGlzLnAueDt2YXIgeTI9cDIueS10aGlzLnAueTt2YXIgeEludFNpZ249anN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQuc2lnbk9mRGV0MngyKHgxLHkxLHgyLHkyKTtpZih4SW50U2lnbj09PTAuMCl7dGhpcy5pc1BvaW50T25TZWdtZW50PXRydWU7cmV0dXJuO31cbmlmKHkyPHkxKVxueEludFNpZ249LXhJbnRTaWduO2lmKHhJbnRTaWduPjAuMCl7dGhpcy5jcm9zc2luZ0NvdW50Kys7fX19O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuaXNPblNlZ21lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLmlzUG9pbnRPblNlZ21lbnQ7fTtqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIucHJvdG90eXBlLmdldExvY2F0aW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5pc1BvaW50T25TZWdtZW50KVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTtpZigodGhpcy5jcm9zc2luZ0NvdW50JTIpPT09MSl7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjt9XG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5pc1BvaW50SW5Qb2x5Z29uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TG9jYXRpb24oKSE9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3A9ZnVuY3Rpb24oZ2VvbSxiblJ1bGUpe3RoaXMuZ2VvbT1nZW9tO3RoaXMuZ2VvbUZhY3Q9Z2VvbS5nZXRGYWN0b3J5KCk7dGhpcy5iblJ1bGU9Ym5SdWxlfHxqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk1PRDJfQk9VTkRBUllfUlVMRTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmJuUnVsZT1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7aWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpcmV0dXJuIHRoaXMuYm91bmRhcnlMaW5lU3RyaW5nKHRoaXMuZ2VvbSk7aWYodGhpcy5nZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZylyZXR1cm4gdGhpcy5ib3VuZGFyeU11bHRpTGluZVN0cmluZyh0aGlzLmdlb20pO3JldHVybiB0aGlzLmdlb20uZ2V0Qm91bmRhcnkoKTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdldEVtcHR5TXVsdGlQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQobnVsbCk7fTtqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wLnByb3RvdHlwZS5ib3VuZGFyeU11bHRpTGluZVN0cmluZz1mdW5jdGlvbihtTGluZSl7aWYodGhpcy5nZW9tLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RW1wdHlNdWx0aVBvaW50KCk7fVxudmFyIGJkeVB0cz10aGlzLmNvbXB1dGVCb3VuZGFyeUNvb3JkaW5hdGVzKG1MaW5lKTtpZihiZHlQdHMubGVuZ3RoPT0xKXtyZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVQb2ludChiZHlQdHNbMF0pO31cbnJldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQoYmR5UHRzKTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmVuZHBvaW50cz1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmNvbXB1dGVCb3VuZGFyeUNvb3JkaW5hdGVzPWZ1bmN0aW9uKG1MaW5lKXt2YXIgaSxsaW5lLGVuZHBvaW50LGJkeVB0cz1bXTt0aGlzLmVuZHBvaW50cz1bXTtmb3IoaT0wO2k8bUxpbmUuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7bGluZT1tTGluZS5nZXRHZW9tZXRyeU4oaSk7aWYobGluZS5nZXROdW1Qb2ludHMoKT09MClcbmNvbnRpbnVlO3RoaXMuYWRkRW5kcG9pbnQobGluZS5nZXRDb29yZGluYXRlTigwKSk7dGhpcy5hZGRFbmRwb2ludChsaW5lLmdldENvb3JkaW5hdGVOKGxpbmUuZ2V0TnVtUG9pbnRzKCktMSkpO31cbmZvcihpPTA7aTx0aGlzLmVuZHBvaW50cy5sZW5ndGg7aSsrKXtlbmRwb2ludD10aGlzLmVuZHBvaW50c1tpXTtpZih0aGlzLmJuUnVsZS5pc0luQm91bmRhcnkoZW5kcG9pbnQuY291bnQpKXtiZHlQdHMucHVzaChlbmRwb2ludC5jb29yZGluYXRlKTt9fVxucmV0dXJuIGJkeVB0czt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmFkZEVuZHBvaW50PWZ1bmN0aW9uKHB0KXt2YXIgaSxlbmRwb2ludCxmb3VuZD1mYWxzZTtmb3IoaT0wO2k8dGhpcy5lbmRwb2ludHMubGVuZ3RoO2krKyl7ZW5kcG9pbnQ9dGhpcy5lbmRwb2ludHNbaV07aWYoZW5kcG9pbnQuY29vcmRpbmF0ZS5lcXVhbHMocHQpKXtmb3VuZD10cnVlO2JyZWFrO319XG5pZighZm91bmQpe2VuZHBvaW50PXt9O2VuZHBvaW50LmNvb3JkaW5hdGU9cHQ7ZW5kcG9pbnQuY291bnQ9MDt0aGlzLmVuZHBvaW50cy5wdXNoKGVuZHBvaW50KTt9XG5lbmRwb2ludC5jb3VudCsrO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuYm91bmRhcnlMaW5lU3RyaW5nPWZ1bmN0aW9uKGxpbmUpe2lmKHRoaXMuZ2VvbS5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEVtcHR5TXVsdGlQb2ludCgpO31cbmlmKGxpbmUuaXNDbG9zZWQoKSl7dmFyIGNsb3NlZEVuZHBvaW50T25Cb3VuZGFyeT10aGlzLmJuUnVsZS5pc0luQm91bmRhcnkoMik7aWYoY2xvc2VkRW5kcG9pbnRPbkJvdW5kYXJ5KXtyZXR1cm4gbGluZS5nZXRTdGFydFBvaW50KCk7fVxuZWxzZXtyZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVNdWx0aVBvaW50KG51bGwpO319XG5yZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVNdWx0aVBvaW50KFtsaW5lLmdldFN0YXJ0UG9pbnQoKSxsaW5lLmdldEVuZFBvaW50KCldKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXI9ZnVuY3Rpb24oaW5wdXRHZW9tLGRpc3RhbmNlLGN1cnZlQnVpbGRlcil7dGhpcy5pbnB1dEdlb209aW5wdXRHZW9tO3RoaXMuZGlzdGFuY2U9ZGlzdGFuY2U7dGhpcy5jdXJ2ZUJ1aWxkZXI9Y3VydmVCdWlsZGVyO3RoaXMuY3VydmVMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5pbnB1dEdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5kaXN0YW5jZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmN1cnZlQnVpbGRlcj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmN1cnZlTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmdldEN1cnZlcz1mdW5jdGlvbigpe3RoaXMuYWRkKHRoaXMuaW5wdXRHZW9tKTtyZXR1cm4gdGhpcy5jdXJ2ZUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRDdXJ2ZT1mdW5jdGlvbihjb29yZCxsZWZ0TG9jLHJpZ2h0TG9jKXtpZihjb29yZD09bnVsbHx8Y29vcmQubGVuZ3RoPDIpXG5yZXR1cm47dmFyIGU9bmV3IGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyhjb29yZCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoMCxqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlksbGVmdExvYyxyaWdodExvYykpO3RoaXMuY3VydmVMaXN0LmFkZChlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnKXtpZihnLmlzRW1wdHkoKSlcbnJldHVybjtpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pXG50aGlzLmFkZFBvbHlnb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpXG50aGlzLmFkZExpbmVTdHJpbmcoZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KVxudGhpcy5hZGRQb2ludChnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludClcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbilcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcigpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkQ29sbGVjdGlvbj1mdW5jdGlvbihnYyl7Zm9yKHZhciBpPTA7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZz1nYy5nZXRHZW9tZXRyeU4oaSk7dGhpcy5hZGQoZyk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24ocCl7aWYodGhpcy5kaXN0YW5jZTw9MC4wKVxucmV0dXJuO3ZhciBjb29yZD1wLmdldENvb3JkaW5hdGVzKCk7dmFyIGN1cnZlPXRoaXMuY3VydmVCdWlsZGVyLmdldExpbmVDdXJ2ZShjb29yZCx0aGlzLmRpc3RhbmNlKTt0aGlzLmFkZEN1cnZlKGN1cnZlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUixqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkTGluZVN0cmluZz1mdW5jdGlvbihsaW5lKXtpZih0aGlzLmRpc3RhbmNlPD0wLjAmJiF0aGlzLmN1cnZlQnVpbGRlci5nZXRCdWZmZXJQYXJhbWV0ZXJzKCkuaXNTaW5nbGVTaWRlZCgpKVxucmV0dXJuO3ZhciBjb29yZD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhsaW5lLmdldENvb3JkaW5hdGVzKCkpO3ZhciBjdXJ2ZT10aGlzLmN1cnZlQnVpbGRlci5nZXRMaW5lQ3VydmUoY29vcmQsdGhpcy5kaXN0YW5jZSk7dGhpcy5hZGRDdXJ2ZShjdXJ2ZSxqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IsanN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmFkZFBvbHlnb249ZnVuY3Rpb24ocCl7dmFyIG9mZnNldERpc3RhbmNlPXRoaXMuZGlzdGFuY2U7dmFyIG9mZnNldFNpZGU9anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVDtpZih0aGlzLmRpc3RhbmNlPDAuMCl7b2Zmc2V0RGlzdGFuY2U9LXRoaXMuZGlzdGFuY2U7b2Zmc2V0U2lkZT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVDt9XG52YXIgc2hlbGw9cC5nZXRFeHRlcmlvclJpbmcoKTt2YXIgc2hlbGxDb29yZD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhzaGVsbC5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLmRpc3RhbmNlPDAuMCYmdGhpcy5pc0Vyb2RlZENvbXBsZXRlbHkoc2hlbGwsdGhpcy5kaXN0YW5jZSkpXG5yZXR1cm47aWYodGhpcy5kaXN0YW5jZTw9MC4wJiZzaGVsbENvb3JkLmxlbmd0aDwzKVxucmV0dXJuO3RoaXMuYWRkUG9seWdvblJpbmcoc2hlbGxDb29yZCxvZmZzZXREaXN0YW5jZSxvZmZzZXRTaWRlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUixqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXAuZ2V0SW50ZXJpb3JSaW5nTihpKTt2YXIgaG9sZUNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGhvbGUuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodGhpcy5kaXN0YW5jZT4wLjAmJnRoaXMuaXNFcm9kZWRDb21wbGV0ZWx5KGhvbGUsLXRoaXMuZGlzdGFuY2UpKVxuY29udGludWU7dGhpcy5hZGRQb2x5Z29uUmluZyhob2xlQ29vcmQsb2Zmc2V0RGlzdGFuY2UsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24ub3Bwb3NpdGUob2Zmc2V0U2lkZSksanN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUik7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkUG9seWdvblJpbmc9ZnVuY3Rpb24oY29vcmQsb2Zmc2V0RGlzdGFuY2Usc2lkZSxjd0xlZnRMb2MsY3dSaWdodExvYyl7aWYob2Zmc2V0RGlzdGFuY2U9PTAuMCYmY29vcmQubGVuZ3RoPGpzdHMuZ2VvbS5MaW5lYXJSaW5nLk1JTklNVU1fVkFMSURfU0laRSlcbnJldHVybjt2YXIgbGVmdExvYz1jd0xlZnRMb2M7dmFyIHJpZ2h0TG9jPWN3UmlnaHRMb2M7aWYoY29vcmQubGVuZ3RoPj1qc3RzLmdlb20uTGluZWFyUmluZy5NSU5JTVVNX1ZBTElEX1NJWkUmJmpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhjb29yZCkpe2xlZnRMb2M9Y3dSaWdodExvYztyaWdodExvYz1jd0xlZnRMb2M7c2lkZT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5vcHBvc2l0ZShzaWRlKTt9XG52YXIgY3VydmU9dGhpcy5jdXJ2ZUJ1aWxkZXIuZ2V0UmluZ0N1cnZlKGNvb3JkLHNpZGUsb2Zmc2V0RGlzdGFuY2UpO3RoaXMuYWRkQ3VydmUoY3VydmUsbGVmdExvYyxyaWdodExvYyk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5pc0Vyb2RlZENvbXBsZXRlbHk9ZnVuY3Rpb24ocmluZyxidWZmZXJEaXN0YW5jZSl7dmFyIHJpbmdDb29yZD1yaW5nLmdldENvb3JkaW5hdGVzKCk7dmFyIG1pbkRpYW09MC4wO2lmKHJpbmdDb29yZC5sZW5ndGg8NClcbnJldHVybiBidWZmZXJEaXN0YW5jZTwwO2lmKHJpbmdDb29yZC5sZW5ndGg9PTQpXG5yZXR1cm4gdGhpcy5pc1RyaWFuZ2xlRXJvZGVkQ29tcGxldGVseShyaW5nQ29vcmQsYnVmZmVyRGlzdGFuY2UpO3ZhciBlbnY9cmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIGVudk1pbkRpbWVuc2lvbj1NYXRoLm1pbihlbnYuZ2V0SGVpZ2h0KCksZW52LmdldFdpZHRoKCkpO2lmKGJ1ZmZlckRpc3RhbmNlPDAuMCYmMipNYXRoLmFicyhidWZmZXJEaXN0YW5jZSk+ZW52TWluRGltZW5zaW9uKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuaXNUcmlhbmdsZUVyb2RlZENvbXBsZXRlbHk9ZnVuY3Rpb24odHJpYW5nbGVDb29yZCxidWZmZXJEaXN0YW5jZSl7dmFyIHRyaT1uZXcganN0cy5nZW9tLlRyaWFuZ2xlKHRyaWFuZ2xlQ29vcmRbMF0sdHJpYW5nbGVDb29yZFsxXSx0cmlhbmdsZUNvb3JkWzJdKTt2YXIgaW5DZW50cmU9dHJpLmluQ2VudHJlKCk7dmFyIGRpc3RUb0NlbnRyZT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoaW5DZW50cmUsdHJpLnAwLHRyaS5wMSk7cmV0dXJuIGRpc3RUb0NlbnRyZTxNYXRoLmFicyhidWZmZXJEaXN0YW5jZSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGg9ZnVuY3Rpb24oKXt0aGlzLmRpckVkZ2VMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5ub2Rlcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuZmluZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlcigpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5maW5kZXI9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmRpckVkZ2VMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5ub2Rlcz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUucmlnaHRNb3N0Q29vcmQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmVudj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZ2V0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpckVkZ2VMaXN0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXROb2Rlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXRFbnZlbG9wZT1mdW5jdGlvbigpe2lmKHRoaXMuZW52PT09bnVsbCl7dmFyIGVkZ2VFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2Zvcih2YXIgaXQ9dGhpcy5kaXJFZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkaXJFZGdlPWl0Lm5leHQoKTt2YXIgcHRzPWRpckVkZ2UuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBqPTA7ajxwdHMubGVuZ3RoLTE7aisrKXtlZGdlRW52LmV4cGFuZFRvSW5jbHVkZShwdHNbal0pO319XG50aGlzLmVudj1lZGdlRW52O31cbnJldHVybiB0aGlzLmVudjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZ2V0UmlnaHRtb3N0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJpZ2h0TW9zdENvb3JkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24obm9kZSl7dGhpcy5hZGRSZWFjaGFibGUobm9kZSk7dGhpcy5maW5kZXIuZmluZEVkZ2UodGhpcy5kaXJFZGdlTGlzdCk7dGhpcy5yaWdodE1vc3RDb29yZD10aGlzLmZpbmRlci5nZXRDb29yZGluYXRlKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmFkZFJlYWNoYWJsZT1mdW5jdGlvbihzdGFydE5vZGUpe3ZhciBub2RlU3RhY2s9W107bm9kZVN0YWNrLnB1c2goc3RhcnROb2RlKTt3aGlsZShub2RlU3RhY2subGVuZ3RoIT09MCl7dmFyIG5vZGU9bm9kZVN0YWNrLnBvcCgpO3RoaXMuYWRkKG5vZGUsbm9kZVN0YWNrKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihub2RlLG5vZGVTdGFjayl7bm9kZS5zZXRWaXNpdGVkKHRydWUpO3RoaXMubm9kZXMuYWRkKG5vZGUpO2Zvcih2YXIgaT1ub2RlLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTt0aGlzLmRpckVkZ2VMaXN0LmFkZChkZSk7dmFyIHN5bT1kZS5nZXRTeW0oKTt2YXIgc3ltTm9kZT1zeW0uZ2V0Tm9kZSgpO2lmKCFzeW1Ob2RlLmlzVmlzaXRlZCgpKVxubm9kZVN0YWNrLnB1c2goc3ltTm9kZSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jbGVhclZpc2l0ZWRFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5kaXJFZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7ZGUuc2V0VmlzaXRlZChmYWxzZSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGg9ZnVuY3Rpb24ob3V0c2lkZURlcHRoKXt0aGlzLmNsZWFyVmlzaXRlZEVkZ2VzKCk7dmFyIGRlPXRoaXMuZmluZGVyLmdldEVkZ2UoKTt2YXIgbj1kZS5nZXROb2RlKCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7ZGUuc2V0RWRnZURlcHRocyhqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCxvdXRzaWRlRGVwdGgpO3RoaXMuY29weVN5bURlcHRocyhkZSk7dGhpcy5jb21wdXRlRGVwdGhzKGRlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29tcHV0ZURlcHRocz1mdW5jdGlvbihzdGFydEVkZ2Upe3ZhciBub2Rlc1Zpc2l0ZWQ9W107dmFyIG5vZGVRdWV1ZT1bXTt2YXIgc3RhcnROb2RlPXN0YXJ0RWRnZS5nZXROb2RlKCk7bm9kZVF1ZXVlLnB1c2goc3RhcnROb2RlKTtub2Rlc1Zpc2l0ZWQucHVzaChzdGFydE5vZGUpO3N0YXJ0RWRnZS5zZXRWaXNpdGVkKHRydWUpO3doaWxlKG5vZGVRdWV1ZS5sZW5ndGghPT0wKXt2YXIgbj1ub2RlUXVldWUuc2hpZnQoKTtub2Rlc1Zpc2l0ZWQucHVzaChuKTt0aGlzLmNvbXB1dGVOb2RlRGVwdGgobik7Zm9yKHZhciBpPW4uZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltLmlzVmlzaXRlZCgpKVxuY29udGludWU7dmFyIGFkak5vZGU9c3ltLmdldE5vZGUoKTtpZihub2Rlc1Zpc2l0ZWQuaW5kZXhPZihhZGpOb2RlKT09PS0xKXtub2RlUXVldWUucHVzaChhZGpOb2RlKTtub2Rlc1Zpc2l0ZWQucHVzaChhZGpOb2RlKTt9fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29tcHV0ZU5vZGVEZXB0aD1mdW5jdGlvbihuKXt2YXIgc3RhcnRFZGdlPW51bGw7Zm9yKHZhciBpPW4uZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmlzVmlzaXRlZCgpfHxkZS5nZXRTeW0oKS5pc1Zpc2l0ZWQoKSl7c3RhcnRFZGdlPWRlO2JyZWFrO319XG5pZihzdGFydEVkZ2U9PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCd1bmFibGUgdG8gZmluZCBlZGdlIHRvIGNvbXB1dGUgZGVwdGhzIGF0ICcrbi5nZXRDb29yZGluYXRlKCkpO24uZ2V0RWRnZXMoKS5jb21wdXRlRGVwdGhzKHN0YXJ0RWRnZSk7Zm9yKHZhciBpPW4uZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2RlLnNldFZpc2l0ZWQodHJ1ZSk7dGhpcy5jb3B5U3ltRGVwdGhzKGRlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNvcHlTeW1EZXB0aHM9ZnVuY3Rpb24oZGUpe3ZhciBzeW09ZGUuZ2V0U3ltKCk7c3ltLnNldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQsZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpKTtzeW0uc2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQsZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCkpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5maW5kUmVzdWx0RWRnZXM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZGlyRWRnZUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmdldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKT49MSYmZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk8PTAmJiFkZS5pc0ludGVyaW9yQXJlYUVkZ2UoKSl7ZGUuc2V0SW5SZXN1bHQodHJ1ZSk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG8pe3ZhciBncmFwaD1vO2lmKHRoaXMucmlnaHRNb3N0Q29vcmQueDxncmFwaC5yaWdodE1vc3RDb29yZC54KXtyZXR1cm4tMTt9XG5pZih0aGlzLnJpZ2h0TW9zdENvb3JkLng+Z3JhcGgucmlnaHRNb3N0Q29vcmQueCl7cmV0dXJuIDE7fVxucmV0dXJuIDA7fTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXI9ZnVuY3Rpb24oZGlzdGFuY2VUb2xlcmFuY2UsaXNFbnN1cmVWYWxpZFRvcG9sb2d5KXt0aGlzLmRpc3RhbmNlVG9sZXJhbmNlPWRpc3RhbmNlVG9sZXJhbmNlO3RoaXMuaXNFbnN1cmVWYWxpZFRvcG9sb2d5PWlzRW5zdXJlVmFsaWRUb3BvbG9neTt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIoKTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLmRpc3RhbmNlVG9sZXJhbmNlPW51bGw7anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZS5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9bnVsbDtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUNvb3JkaW5hdGVzPWZ1bmN0aW9uKGNvb3JkcyxwYXJlbnQpe3ZhciBpbnB1dFB0cz1jb29yZHM7dmFyIG5ld1B0cz1udWxsO2lmKGlucHV0UHRzLmxlbmd0aD09MCl7bmV3UHRzPVtdO31lbHNle25ld1B0cz1qc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsdGhpcy5kaXN0YW5jZVRvbGVyYW5jZSk7fVxucmV0dXJuIG5ld1B0czt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtUG9seWdvbj1mdW5jdGlvbihnZW9tLHBhcmVudCl7aWYoZ2VvbS5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnZhciByYXdHZW9tPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybVBvbHlnb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHBhcmVudCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3JldHVybiByYXdHZW9tO31cbnJldHVybiB0aGlzLmNyZWF0ZVZhbGlkQXJlYShyYXdHZW9tKTt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTGluZWFyUmluZz1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHJlbW92ZURlZ2VuZXJhdGVSaW5ncz1wYXJlbnQgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbjt2YXIgc2ltcFJlc3VsdD1qc3RzLmdlb20udXRpbC5HZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1MaW5lYXJSaW5nLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtpZihyZW1vdmVEZWdlbmVyYXRlUmluZ3MmJiEoc2ltcFJlc3VsdCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKSl7cmV0dXJuIG51bGw7fVxucmV0dXJuIHNpbXBSZXN1bHQ7fTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybU11bHRpUG9seWdvbj1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHJhd0dlb209anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2x5Z29uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5jcmVhdGVWYWxpZEFyZWEocmF3R2VvbSk7fTtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLmNyZWF0ZVZhbGlkQXJlYT1mdW5jdGlvbihyYXdBcmVhR2VvbSl7aWYodGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpe3JldHVybiByYXdBcmVhR2VvbS5idWZmZXIoMC4wKTt9XG5yZXR1cm4gcmF3QXJlYUdlb207fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlcj1mdW5jdGlvbihjbHosY29tcHMpe3RoaXMuY2x6PWNsejt0aGlzLmNvbXBzPWNvbXBzO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXIoKTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGUuY2x6PW51bGw7anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIucHJvdG90eXBlLmNvbXBzPW51bGw7anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIuZXh0cmFjdD1mdW5jdGlvbihnZW9tLGNseixsaXN0KXtsaXN0PWxpc3R8fG5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7aWYoZ2VvbSBpbnN0YW5jZW9mIGNseil7bGlzdC5hZGQoZ2VvbSk7fVxuZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe2dlb20uYXBwbHkobmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyKGNseixsaXN0KSk7fVxucmV0dXJuIGxpc3Q7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKHRoaXMuY2x6PT09bnVsbHx8Z2VvbSBpbnN0YW5jZW9mIHRoaXMuY2x6KXt0aGlzLmNvbXBzLmFkZChnZW9tKTt9fTsoZnVuY3Rpb24oKXt2YXIgT3ZlcmxheU9wPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wO3ZhciBTbmFwT3ZlcmxheU9wPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwT3ZlcmxheU9wO3ZhciBTbmFwSWZOZWVkZWRPdmVybGF5T3A9ZnVuY3Rpb24oZzEsZzIpe3RoaXMuZ2VvbT1bXTt0aGlzLmdlb21bMF09ZzE7dGhpcy5nZW9tWzFdPWcyO307U25hcElmTmVlZGVkT3ZlcmxheU9wLm92ZXJsYXlPcD1mdW5jdGlvbihnMCxnMSxvcENvZGUpe3ZhciBvcD1uZXcgU25hcElmTmVlZGVkT3ZlcmxheU9wKGcwLGcxKTtyZXR1cm4gb3AuZ2V0UmVzdWx0R2VvbWV0cnkob3BDb2RlKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5pbnRlcnNlY3Rpb249ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLklOVEVSU0VDVElPTik7fTtTbmFwSWZOZWVkZWRPdmVybGF5T3AudW5pb249ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlVOSU9OKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5kaWZmZXJlbmNlPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gb3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5ESUZGRVJFTkNFKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5zeW1EaWZmZXJlbmNlPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gb3ZlcmxheU9wKGcwLGcxLE92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5wcm90b3R5cGUuZ2VvbT1udWxsO1NuYXBJZk5lZWRlZE92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24ob3BDb2RlKXt2YXIgcmVzdWx0PW51bGw7dmFyIGlzU3VjY2Vzcz1mYWxzZTt2YXIgc2F2ZWRFeGNlcHRpb249bnVsbDt0cnl7cmVzdWx0PU92ZXJsYXlPcC5vdmVybGF5T3AodGhpcy5nZW9tWzBdLHRoaXMuZ2VvbVsxXSxvcENvZGUpO3ZhciBpc1ZhbGlkPXRydWU7aWYoaXNWYWxpZClcbmlzU3VjY2Vzcz10cnVlO31jYXRjaChleCl7c2F2ZWRFeGNlcHRpb249ZXg7fVxuaWYoIWlzU3VjY2Vzcyl7dHJ5e3Jlc3VsdD1TbmFwT3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLmdlb21bMF0sdGhpcy5nZW9tWzFdLG9wQ29kZSk7fWNhdGNoKGV4KXt0aHJvdyBzYXZlZEV4Y2VwdGlvbjt9fVxucmV0dXJuIHJlc3VsdDt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3A9U25hcElmTmVlZGVkT3ZlcmxheU9wO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEdlb21ldHJ5RXh0cmFjdGVyPWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyO3ZhciBDYXNjYWRlZFBvbHlnb25Vbmlvbj1qc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbjt2YXIgUG9pbnRHZW9tZXRyeVVuaW9uPWpzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbjt2YXIgT3ZlcmxheU9wPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wO3ZhciBTbmFwSWZOZWVkZWRPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcDt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wPWZ1bmN0aW9uKGdlb21zLGdlb21GYWN0KXt0aGlzLnBvbHlnb25zPW5ldyBBcnJheUxpc3QoKTt0aGlzLmxpbmVzPW5ldyBBcnJheUxpc3QoKTt0aGlzLnBvaW50cz1uZXcgQXJyYXlMaXN0KCk7aWYoZ2VvbUZhY3Qpe3RoaXMuZ2VvbUZhY3Q9Z2VvbUZhY3Q7fVxudGhpcy5leHRyYWN0KGdlb21zKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC51bmlvbj1mdW5jdGlvbihnZW9tcyxnZW9tRmFjdCl7dmFyIG9wPW5ldyBqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AoZ2VvbXMsZ2VvbUZhY3QpO3JldHVybiBvcC51bmlvbigpO307anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS5wb2x5Z29ucz1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUubGluZXM9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnBvaW50cz1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUuZ2VvbUZhY3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLmV4dHJhY3Q9ZnVuY3Rpb24oZ2VvbXMpe2lmKGdlb21zIGluc3RhbmNlb2YgQXJyYXlMaXN0KXtmb3IodmFyIGk9Z2VvbXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBnZW9tPWkubmV4dCgpO3RoaXMuZXh0cmFjdChnZW9tKTt9fWVsc2V7aWYodGhpcy5nZW9tRmFjdD09PW51bGwpe3RoaXMuZ2VvbUZhY3Q9Z2VvbXMuZ2V0RmFjdG9yeSgpO31cbkdlb21ldHJ5RXh0cmFjdGVyLmV4dHJhY3QoZ2VvbXMsanN0cy5nZW9tLlBvbHlnb24sdGhpcy5wb2x5Z29ucyk7R2VvbWV0cnlFeHRyYWN0ZXIuZXh0cmFjdChnZW9tcyxqc3RzLmdlb20uTGluZVN0cmluZyx0aGlzLmxpbmVzKTtHZW9tZXRyeUV4dHJhY3Rlci5leHRyYWN0KGdlb21zLGpzdHMuZ2VvbS5Qb2ludCx0aGlzLnBvaW50cyk7fX07anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbigpe2lmKHRoaXMuZ2VvbUZhY3Q9PT1udWxsKXtyZXR1cm4gbnVsbDt9XG52YXIgdW5pb25Qb2ludHM9bnVsbDtpZih0aGlzLnBvaW50cy5zaXplKCk+MCl7dmFyIHB0R2VvbT10aGlzLmdlb21GYWN0LmJ1aWxkR2VvbWV0cnkodGhpcy5wb2ludHMpO3VuaW9uUG9pbnRzPXRoaXMudW5pb25Ob09wdChwdEdlb20pO31cbnZhciB1bmlvbkxpbmVzPW51bGw7aWYodGhpcy5saW5lcy5zaXplKCk+MCl7dmFyIGxpbmVHZW9tPXRoaXMuZ2VvbUZhY3QuYnVpbGRHZW9tZXRyeSh0aGlzLmxpbmVzKTt1bmlvbkxpbmVzPXRoaXMudW5pb25Ob09wdChsaW5lR2VvbSk7fVxudmFyIHVuaW9uUG9seWdvbnM9bnVsbDtpZih0aGlzLnBvbHlnb25zLnNpemUoKT4wKXt1bmlvblBvbHlnb25zPUNhc2NhZGVkUG9seWdvblVuaW9uLnVuaW9uKHRoaXMucG9seWdvbnMpO31cbnZhciB1bmlvbkxBPXRoaXMudW5pb25XaXRoTnVsbCh1bmlvbkxpbmVzLHVuaW9uUG9seWdvbnMpO3ZhciB1bmlvbj1udWxsO2lmKHVuaW9uUG9pbnRzPT09bnVsbCl7dW5pb249dW5pb25MQTt9ZWxzZSBpZih1bmlvbkxBPT09bnVsbCl7dW5pb249dW5pb25Qb2ludHM7fWVsc2V7dW5pb249UG9pbnRHZW9tZXRyeVVuaW9uKHVuaW9uUG9pbnRzLHVuaW9uTEEpO31cbmlmKHVuaW9uPT09bnVsbCl7cmV0dXJuIHRoaXMuZ2VvbUZhY3QuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbnJldHVybiB1bmlvbjt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUudW5pb25XaXRoTnVsbD1mdW5jdGlvbihnMCxnMSl7aWYoZzA9PT1udWxsJiZnMT09PW51bGwpe3JldHVybiBudWxsO31cbmlmKGcxPT09bnVsbCl7cmV0dXJuIGcwO31cbmlmKGcwPT09bnVsbCl7cmV0dXJuIGcxO31cbnJldHVybiBnMC51bmlvbihnMSk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnVuaW9uTm9PcHQ9ZnVuY3Rpb24oZzApe3ZhciBlbXB0eT10aGlzLmdlb21GYWN0LmNyZWF0ZVBvaW50KG51bGwpO3JldHVybiBTbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKGcwLGVtcHR5LE92ZXJsYXlPcC5VTklPTik7fTt9KCkpO2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZT1mdW5jdGlvbigpe3RoaXMubGVmdD1udWxsO3RoaXMucmlnaHQ9bnVsbDt0aGlzLmNvdW50PTE7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuaW5pdGlhbGl6ZUZyb21Db29yZGluYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuaW5pdGlhbGl6ZUZyb21YWS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKTt9fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmluaXRpYWxpemVGcm9tWFk9ZnVuY3Rpb24oeCx5LGRhdGEpe3RoaXMucD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUZyb21Db29yZGluYXRlPWZ1bmN0aW9uKHAsZGF0YSl7dGhpcy5wPXA7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLng7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldFk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLnk7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF0YTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0TGVmdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxlZnQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldFJpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmlnaHQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmluY3JlbWVudD1mdW5jdGlvbigpe3RoaXMuY291bnQrPTE7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldENvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY291bnQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmlzUmVwZWF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gY291bnQ+MTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuc2V0TGVmdD1mdW5jdGlvbihsZWZ0KXt0aGlzLmxlZnQ9bGVmdDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuc2V0UmlnaHQ9ZnVuY3Rpb24ocmlnaHQpe3RoaXMucmlnaHQ9cmlnaHQ7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMubWluRGlzdGFuY2U9TnVtYmVyLk1BWF9WQUxVRTt0aGlzLmludGVyaW9yUG9pbnQ9bnVsbDt0aGlzLmNlbnRyb2lkPWdlb21ldHJ5LmdldENlbnRyb2lkKCkuZ2V0Q29vcmRpbmF0ZSgpO3RoaXMuYWRkKGdlb21ldHJ5KTt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7dGhpcy5hZGRQb2ludChnZW9tZXRyeS5nZXRDb29yZGluYXRlKCkpO31lbHNlIGlmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Zm9yKHZhciBpPTA7aTxnZW9tZXRyeS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZChnZW9tZXRyeS5nZXRHZW9tZXRyeU4oaSkpO319fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQucHJvdG90eXBlLmFkZFBvaW50PWZ1bmN0aW9uKHBvaW50KXt2YXIgZGlzdD1wb2ludC5kaXN0YW5jZSh0aGlzLmNlbnRyb2lkKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMuaW50ZXJpb3JQb2ludD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocG9pbnQpO3RoaXMubWluRGlzdGFuY2U9ZGlzdDt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50UG9pbnQucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvclBvaW50O307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLk11bHRpTGluZVN0cmluZz1mdW5jdGlvbihnZW9tZXRyaWVzLGZhY3Rvcnkpe3RoaXMuZ2VvbWV0cmllcz1nZW9tZXRyaWVzfHxbXTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKCk7anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nO2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuKG5ldyBqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wKHRoaXMpKS5nZXRCb3VuZGFyeSgpO307anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4ganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3QuY2FsbCh0aGlzLG90aGVyLHRvbGVyYW5jZSk7fTtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nJzt9KSgpOyhmdW5jdGlvbigpe3ZhciBJbnRlcnZhbD1qc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWw7dmFyIFJvb3Q9anN0cy5pbmRleC5iaW50cmVlLlJvb3Q7dmFyIEJpbnRyZWU9ZnVuY3Rpb24oKXt0aGlzLnJvb3Q9bmV3IFJvb3QoKTt0aGlzLm1pbkV4dGVudD0xLjA7fTtCaW50cmVlLmVuc3VyZUV4dGVudD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsbWluRXh0ZW50KXt2YXIgbWluLG1heDttaW49aXRlbUludGVydmFsLmdldE1pbigpO21heD1pdGVtSW50ZXJ2YWwuZ2V0TWF4KCk7aWYobWluIT09bWF4KXtyZXR1cm4gaXRlbUludGVydmFsO31cbmlmKG1pbj09PW1heCl7bWluPW1pbi0obWluRXh0ZW50LzIuMCk7bWF4PW1pbisobWluRXh0ZW50LzIuMCk7fVxucmV0dXJuIG5ldyBJbnRlcnZhbChtaW4sbWF4KTt9O0JpbnRyZWUucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290IT09bnVsbCl7cmV0dXJuIHRoaXMucm9vdC5kZXB0aCgpO31cbnJldHVybiAwO307QmludHJlZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe2lmKHRoaXMucm9vdCE9PW51bGwpe3JldHVybiB0aGlzLnJvb3Quc2l6ZSgpO31cbnJldHVybiAwO307QmludHJlZS5wcm90b3R5cGUubm9kZVNpemU9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QhPT1udWxsKXtyZXR1cm4gdGhpcy5yb290Lm5vZGVTaXplKCk7fVxucmV0dXJuIDA7fTtCaW50cmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oaXRlbUludGVydmFsLGl0ZW0pe3RoaXMuY29sbGVjdFN0YXRzKGl0ZW1JbnRlcnZhbCk7dmFyIGluc2VydEludGVydmFsPUJpbnRyZWUuZW5zdXJlRXh0ZW50KGl0ZW1JbnRlcnZhbCx0aGlzLm1pbkV4dGVudCk7dGhpcy5yb290Lmluc2VydChpbnNlcnRJbnRlcnZhbCxpdGVtKTt9O0JpbnRyZWUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7dmFyIGluc2VydEludGVydmFsPUJpbnRyZWUuZW5zdXJlRXh0ZW50KGl0ZW1JbnRlcnZhbCx0aGlzLm1pbkV4dGVudCk7cmV0dXJuIHRoaXMucm9vdC5yZW1vdmUoaW5zZXJ0SW50ZXJ2YWwsaXRlbSk7fTtCaW50cmVlLnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3ZhciBmb3VuZEl0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5yb290LmFkZEFsbEl0ZW1zKGZvdW5kSXRlbXMpO3JldHVybiBmb3VuZEl0ZW1zLml0ZXJhdG9yKCk7fTtCaW50cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnF1ZXJ5QW5kQWRkKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO31lbHNle3ZhciB4PWFyZ3VtZW50c1swXTtpZigheCBpbnN0YW5jZW9mIEludGVydmFsKXt4PW5ldyBJbnRlcnZhbCh4LHgpO31cbnJldHVybiB0aGlzLnF1ZXJ5SW50ZXJ2YWwoeCk7fX07QmludHJlZS5wcm90b3R5cGUucXVlcnlJbnRlcnZhbD1mdW5jdGlvbihpbnRlcnZhbCl7dmFyIGZvdW5kSXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnF1ZXJ5KGludGVydmFsLGZvdW5kSXRlbXMpO3JldHVybiBmb3VuZEl0ZW1zO307QmludHJlZS5wcm90b3R5cGUucXVlcnlBbmRBZGQ9ZnVuY3Rpb24oaW50ZXJ2YWwsZm91bmRJdGVtcyl7dGhpcy5yb290LmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nKGludGVydmFsLGZvdW5kSXRlbXMpO307QmludHJlZS5wcm90b3R5cGUuY29sbGVjdFN0YXRzPWZ1bmN0aW9uKGludGVydmFsKXt2YXIgZGVsPWludGVydmFsLmdldFdpZHRoKCk7aWYoZGVsPHRoaXMubWluRXh0ZW50JiZkZWw+MC4wKXt0aGlzLm1pbkV4dGVudD1kZWw7fX07anN0cy5pbmRleC5iaW50cmVlLkJpbnRyZWU9QmludHJlZTt9KSgpO2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhPWZ1bmN0aW9uKGdlb21ldHJ5KXt0aGlzLmZhY3Rvcnk7dGhpcy5pbnRlcmlvclBvaW50PW51bGw7dGhpcy5tYXhXaWR0aD0wO3RoaXMuZmFjdG9yeT1nZW9tZXRyeS5nZXRGYWN0b3J5KCk7dGhpcy5hZGQoZ2VvbWV0cnkpO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEuYXZnPWZ1bmN0aW9uKGEsYil7cmV0dXJuKGErYikvMjt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5nZXRJbnRlcmlvclBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJpb3JQb2ludDt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuYWRkUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb21ldHJ5LmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdlb21ldHJ5LmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5hZGRQb2x5Z29uPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeS5pc0VtcHR5KCkpe3JldHVybjt9XG52YXIgaW50UHQ7dmFyIHdpZHRoPTA7dmFyIGJpc2VjdG9yPXRoaXMuaG9yaXpvbnRhbEJpc2VjdG9yKGdlb21ldHJ5KTtpZihiaXNlY3Rvci5nZXRMZW5ndGgoKT09MC4wKXt3aWR0aD0wO2ludFB0PWJpc2VjdG9yLmdldENvb3JkaW5hdGUoKTt9ZWxzZXt2YXIgaW50ZXJzZWN0aW9ucz1iaXNlY3Rvci5pbnRlcnNlY3Rpb24oZ2VvbWV0cnkpO3ZhciB3aWRlc3RJbnRlcnNlY3Rpb249dGhpcy53aWRlc3RHZW9tZXRyeShpbnRlcnNlY3Rpb25zKTt3aWR0aD13aWRlc3RJbnRlcnNlY3Rpb24uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldFdpZHRoKCk7aW50UHQ9dGhpcy5jZW50cmUod2lkZXN0SW50ZXJzZWN0aW9uLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7fVxuaWYodGhpcy5pbnRlcmlvclBvaW50PT1udWxsfHx3aWR0aD50aGlzLm1heFdpZHRoKXt0aGlzLmludGVyaW9yUG9pbnQ9aW50UHQ7dGhpcy5tYXhXaWR0aD13aWR0aDt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5wcm90b3R5cGUud2lkZXN0R2VvbWV0cnk9ZnVuY3Rpb24ob2JqKXtpZihvYmogaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXt2YXIgZ2M9b2JqO2lmKGdjLmlzRW1wdHkoKSl7cmV0dXJuIGdjO31cbnZhciB3aWRlc3RHZW9tZXRyeT1nYy5nZXRHZW9tZXRyeU4oMCk7Zm9yKHZhciBpPTE7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXtpZihnYy5nZXRHZW9tZXRyeU4oaSkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldFdpZHRoKCk+d2lkZXN0R2VvbWV0cnkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldFdpZHRoKCkpe3dpZGVzdEdlb21ldHJ5PWdjLmdldEdlb21ldHJ5TihpKTt9fVxucmV0dXJuIHdpZGVzdEdlb21ldHJ5O31lbHNlIGlmKG9iaiBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeSl7cmV0dXJuIG9iajt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5wcm90b3R5cGUuaG9yaXpvbnRhbEJpc2VjdG9yPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgZW52ZWxvcGU9Z2VvbWV0cnkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBiaXNlY3RZPWpzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlci5nZXRCaXNlY3RvclkoZ2VvbWV0cnkpO3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhbbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1pblgoKSxiaXNlY3RZKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWF4WCgpLGJpc2VjdFkpXSk7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5wcm90b3R5cGUuY2VudHJlPWZ1bmN0aW9uKGVudmVsb3BlKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2ZyhlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWF4WCgpKSxqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5hdmcoZW52ZWxvcGUuZ2V0TWluWSgpLGVudmVsb3BlLmdldE1heFkoKSkpO307anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyPWZ1bmN0aW9uKHBvbHkpe3RoaXMucG9seTt0aGlzLmNlbnRyZVk7dGhpcy5oaVk9TnVtYmVyLk1BWF9WQUxVRTt0aGlzLmxvWT0tTnVtYmVyLk1BWF9WQUxVRTt0aGlzLnBvbHk9cG9seTt0aGlzLmhpWT1wb2x5LmdldEVudmVsb3BlSW50ZXJuYWwoKS5nZXRNYXhZKCk7dGhpcy5sb1k9cG9seS5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0TWluWSgpO3RoaXMuY2VudHJlWT1qc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5hdmcodGhpcy5sb1ksdGhpcy5oaVkpO307anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLmdldEJpc2VjdG9yWT1mdW5jdGlvbihwb2x5KXt2YXIgZmluZGVyPW5ldyBqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIocG9seSk7cmV0dXJuIGZpbmRlci5nZXRCaXNlY3RvclkoKTt9O2pzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlci5wcm90b3R5cGUuZ2V0QmlzZWN0b3JZPWZ1bmN0aW9uKCl7dGhpcy5wcm9jZXNzKHRoaXMucG9seS5nZXRFeHRlcmlvclJpbmcoKSk7Zm9yKHZhciBpPTA7aTx0aGlzLnBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt0aGlzLnByb2Nlc3ModGhpcy5wb2x5LmdldEludGVyaW9yUmluZ04oaSkpO31cbnZhciBiaXNlY3RZPWpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2Zyh0aGlzLmhpWSx0aGlzLmxvWSk7cmV0dXJuIGJpc2VjdFk7fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIucHJvdG90eXBlLnByb2Nlc3M9ZnVuY3Rpb24obGluZSl7dmFyIHNlcT1saW5lLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO2Zvcih2YXIgaT0wO2k8c2VxLmxlbmd0aDtpKyspe3ZhciB5PXNlcVtpXS55O3RoaXMudXBkYXRlSW50ZXJ2YWwoeSk7fX07anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLnByb3RvdHlwZS51cGRhdGVJbnRlcnZhbD1mdW5jdGlvbih5KXtpZih5PD10aGlzLmNlbnRyZVkpe2lmKHk+dGhpcy5sb1kpe3RoaXMubG9ZPXk7fX1lbHNlIGlmKHk+dGhpcy5jZW50cmVZKXtpZih5PHRoaXMuaGlZKXt0aGlzLmhpWT15O319fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycz1mdW5jdGlvbihxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlLGpvaW5TdHlsZSxtaXRyZUxpbWl0KXtpZihxdWFkcmFudFNlZ21lbnRzKVxudGhpcy5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO2lmKGVuZENhcFN0eWxlKVxudGhpcy5zZXRFbmRDYXBTdHlsZShlbmRDYXBTdHlsZSk7aWYoam9pblN0eWxlKVxudGhpcy5zZXRKb2luU3R5bGUoam9pblN0eWxlKTtpZihtaXRyZUxpbWl0KVxudGhpcy5zZXRNaXRyZUxpbWl0KG1pdHJlTGltaXQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX1JPVU5EPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX0ZMQVQ9Mjtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfU1FVQVJFPTM7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9ST1VORD0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fTUlUUkU9Mjtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX0JFVkVMPTM7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9RVUFEUkFOVF9TRUdNRU5UUz04O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkRFRkFVTFRfTUlUUkVfTElNSVQ9NS4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5xdWFkcmFudFNlZ21lbnRzPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkRFRkFVTFRfUVVBRFJBTlRfU0VHTUVOVFM7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmVuZENhcFN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9ST1VORDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuam9pblN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fUk9VTkQ7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLm1pdHJlTGltaXQ9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9NSVRSRV9MSU1JVDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuX2lzU2luZ2xlU2lkZWQ9ZmFsc2U7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmdldFF1YWRyYW50U2VnbWVudHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5xdWFkcmFudFNlZ21lbnRzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldFF1YWRyYW50U2VnbWVudHM9ZnVuY3Rpb24ocXVhZHJhbnRTZWdtZW50cyl7dGhpcy5xdWFkcmFudFNlZ21lbnRzPXF1YWRyYW50U2VnbWVudHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbihxdWFkU2Vncyl7dGhpcy5xdWFkcmFudFNlZ21lbnRzPXF1YWRTZWdzO2lmKHRoaXMucXVhZHJhbnRTZWdtZW50cz09PTApXG50aGlzLmpvaW5TdHlsZT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX0JFVkVMO2lmKHRoaXMucXVhZHJhbnRTZWdtZW50czwwKXt0aGlzLmpvaW5TdHlsZT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX01JVFJFO3RoaXMubWl0cmVMaW1pdD1NYXRoLmFicyh0aGlzLnF1YWRyYW50U2VnbWVudHMpO31cbmlmKHF1YWRTZWdzPD0wKXt0aGlzLnF1YWRyYW50U2VnbWVudHM9MTt9XG5pZih0aGlzLmpvaW5TdHlsZSE9PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fUk9VTkQpe3RoaXMucXVhZHJhbnRTZWdtZW50cz1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5ERUZBVUxUX1FVQURSQU5UX1NFR01FTlRTO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLmJ1ZmZlckRpc3RhbmNlRXJyb3I9ZnVuY3Rpb24ocXVhZFNlZ3Mpe3ZhciBhbHBoYT1NYXRoLlBJLzIuMC9xdWFkU2VncztyZXR1cm4gMS1NYXRoLmNvcyhhbHBoYS8yLjApO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmdldEVuZENhcFN0eWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kQ2FwU3R5bGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0RW5kQ2FwU3R5bGU9ZnVuY3Rpb24oZW5kQ2FwU3R5bGUpe3RoaXMuZW5kQ2FwU3R5bGU9ZW5kQ2FwU3R5bGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZ2V0Sm9pblN0eWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuam9pblN0eWxlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldEpvaW5TdHlsZT1mdW5jdGlvbihqb2luU3R5bGUpe3RoaXMuam9pblN0eWxlPWpvaW5TdHlsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5nZXRNaXRyZUxpbWl0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWl0cmVMaW1pdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5zZXRNaXRyZUxpbWl0PWZ1bmN0aW9uKG1pdHJlTGltaXQpe3RoaXMubWl0cmVMaW1pdD1taXRyZUxpbWl0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldFNpbmdsZVNpZGVkPWZ1bmN0aW9uKGlzU2luZ2xlU2lkZWQpe3RoaXMuX2lzU2luZ2xlU2lkZWQ9aXNTaW5nbGVTaWRlZDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5pc1NpbmdsZVNpZGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzU2luZ2xlU2lkZWQ7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvcj1mdW5jdGlvbigpe307anN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IucHJvdG90eXBlLmlzRG9uZT1mYWxzZTtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUuYXBwbHlUbz1mdW5jdGlvbihnZW9tKXtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpJiYhdGhpcy5pc0RvbmU7aSsrKXt2YXIgZWxlbWVudD1nZW9tLmdldEdlb21ldHJ5TihpKTtpZighKGVsZW1lbnQgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKSl7dGhpcy52aXNpdChlbGVtZW50KTtpZih0aGlzLmlzRG9uZSgpKXt0aGlzLmlzRG9uZT10cnVlO3JldHVybjt9fVxuZWxzZVxudGhpcy5hcHBseVRvKGVsZW1lbnQpO319XG5qc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZWxlbWVudCl7fTtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yPWZ1bmN0aW9uKHJlY3RFbnYpe3RoaXMucmVjdEVudj1yZWN0RW52O307RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yKCk7RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5jb25zdHJ1Y3Rvcj1FbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yO0VudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZhbHNlO0VudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzO31cbkVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKGVsZW1lbnQpe3ZhciBlbGVtZW50RW52PWVsZW1lbnQuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2lmKCF0aGlzLnJlY3RFbnYuaW50ZXJzZWN0cyhlbGVtZW50RW52KSl7cmV0dXJuO31cbmlmKHRoaXMucmVjdEVudi5jb250YWlucyhlbGVtZW50RW52KSl7dGhpcy5pbnRlcnNlY3RzPXRydWU7cmV0dXJuO31cbmlmKGVsZW1lbnRFbnYuZ2V0TWluWCgpPj1yZWN0RW52LmdldE1pblgoKSYmZWxlbWVudEVudi5nZXRNYXhYKCk8PXJlY3RFbnYuZ2V0TWF4WCgpKXt0aGlzLmludGVyc2VjdHM9dHJ1ZTtyZXR1cm47fVxuaWYoZWxlbWVudEVudi5nZXRNaW5ZKCk+PXJlY3RFbnYuZ2V0TWluWSgpJiZlbGVtZW50RW52LmdldE1heFkoKTw9cmVjdEVudi5nZXRNYXhZKCkpe3RoaXMuaW50ZXJzZWN0cz10cnVlO3JldHVybjt9fVxuRW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0cz09dHJ1ZTt9XG52YXIgR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvcj1mdW5jdGlvbihyZWN0YW5nbGUpe3RoaXMucmVjdFNlcT1yZWN0YW5nbGUuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7fTtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IoKTtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLmNvbnN0cnVjdG9yPUdlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3I7R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUucmVjdFNlcT1udWxsO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZS5jb250YWluc1BvaW50PWZhbHNlO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250YWluc1BvaW50O31cbkdlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKGdlb20pe2lmKCEoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKSlcbnJldHVybjt2YXIgZWxlbWVudEVudj1nZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighdGhpcy5yZWN0RW52LmludGVyc2VjdHMoZWxlbWVudEVudikpXG5yZXR1cm47dmFyIHJlY3RQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtmb3IodmFyIGk9MDtpPDQ7aSsrKXt0aGlzLnJlY3RTZXEuZ2V0Q29vcmRpbmF0ZShpLHJlY3RQdCk7aWYoIWVsZW1lbnRFbnYuY29udGFpbnMocmVjdFB0KSlcbmNvbnRpbnVlO2lmKFNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50SW5Qb2x5Z29uKHJlY3RQdCxnZW9tKSl7dGhpcy5jb250YWluc1BvaW50PXRydWU7cmV0dXJuO319fVxuR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGFpbnNQb2ludD09dHJ1ZTt9XG52YXIgUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7dGhpcy5yZWN0SW50ZXJzZWN0b3I9bmV3IFJlY3RhbmdsZUxpbmVJbnRlcnNlY3RvcihyZWN0RW52KTt9O1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yKCk7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLmNvbnN0cnVjdG9yPVJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvcjtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnJlY3RJbnRlcnNlY3Rvcj1udWxsO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZhbHNlO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucDA9bnVsbDtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnAxPW51bGw7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzSW50ZXJzZWN0aW9uO31cblJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZ2VvbSl7dmFyIGVsZW1lbnRFbnY9Z2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYoIXRoaXMucmVjdEVudi5pbnRlcnNlY3RzKGVsZW1lbnRFbnYpKVxucmV0dXJuO3ZhciBsaW5lcz1MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMoZ2VvbSk7dGhpcy5jaGVja0ludGVyc2VjdGlvbldpdGhMaW5lU3RyaW5ncyhsaW5lcyk7fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5jaGVja0ludGVyc2VjdGlvbldpdGhMaW5lU3RyaW5ncz1mdW5jdGlvbihsaW5lcyl7Zm9yKHZhciBpPWxpbmVzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgdGVzdExpbmU9aS5uZXh0KCk7dGhpcy5jaGVja0ludGVyc2VjdGlvbldpdGhTZWdtZW50cyh0ZXN0TGluZSk7aWYodGhpcy5oYXNJbnRlcnNlY3Rpb24pXG5yZXR1cm47fX1cblJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuY2hlY2tJbnRlcnNlY3Rpb25XaXRoU2VnbWVudHM9ZnVuY3Rpb24odGVzdExpbmUpe3ZhciBzZXExPXRlc3RMaW5lLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO2Zvcih2YXIgaj0xO2o8c2VxMS5sZW5ndGg7aisrKXt0aGlzLnAwPXNlcTFbai0xXTt0aGlzLnAxPXNlcTFbal07aWYocmVjdEludGVyc2VjdG9yLmludGVyc2VjdHMocDAscDEpKXt0aGlzLmhhc0ludGVyc2VjdGlvbj10cnVlO3JldHVybjt9fX1cblJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzSW50ZXJzZWN0aW9uPT10cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0YW5nbGU9cmVjdGFuZ2xlO3RoaXMucmVjdEVudj1yZWN0YW5nbGUuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLmludGVyc2VjdHM9ZnVuY3Rpb24ocmVjdGFuZ2xlLGIpe3ZhciBycD1uZXcganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMocmVjdGFuZ2xlKTtyZXR1cm4gcnAuaW50ZXJzZWN0cyhiKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5wcm90b3R5cGUucmVjdGFuZ2xlPW51bGw7anN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMucHJvdG90eXBlLnJlY3RFbnY9bnVsbDtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihnZW9tKXtpZighdGhpcy5yZWN0RW52LmludGVyc2VjdHMoZ2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCkpKVxucmV0dXJuIGZhbHNlO3ZhciB2aXNpdG9yPW5ldyBFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yKHRoaXMucmVjdEVudik7dmlzaXRvci5hcHBseVRvKGdlb20pO2lmKHZpc2l0b3IuaW50ZXJzZWN0cygpKVxucmV0dXJuIHRydWU7dmFyIGVjcFZpc2l0b3I9bmV3IEdlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IocmVjdGFuZ2xlKTtlY3BWaXNpdG9yLmFwcGx5VG8oZ2VvbSk7aWYoZWNwVmlzaXRvci5jb250YWluc1BvaW50KCkpXG5yZXR1cm4gdHJ1ZTt2YXIgcmlWaXNpdG9yPW5ldyBSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IocmVjdGFuZ2xlKTtyaVZpc2l0b3IuYXBwbHlUbyhnZW9tKTtpZihyaVZpc2l0b3IuaW50ZXJzZWN0cygpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO319KSgpO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyPWZ1bmN0aW9uKGJ1ZlBhcmFtcyl7dGhpcy5idWZQYXJhbXM9YnVmUGFyYW1zO3RoaXMuZWRnZUxpc3Q9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0KCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5kZXB0aERlbHRhPWZ1bmN0aW9uKGxhYmVsKXt2YXIgbExvYz1sYWJlbC5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3ZhciByTG9jPWxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKGxMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1ImJnJMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IpXG5yZXR1cm4gMTtlbHNlIGlmKGxMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1ImJnJMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpXG5yZXR1cm4tMTtyZXR1cm4gMDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5idWZQYXJhbXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUud29ya2luZ1ByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLndvcmtpbmdOb2Rlcj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5ncmFwaD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5lZGdlTGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5zZXRXb3JraW5nUHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24ocG0pe3RoaXMud29ya2luZ1ByZWNpc2lvbk1vZGVsPXBtO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLnNldE5vZGVyPWZ1bmN0aW9uKG5vZGVyKXt0aGlzLndvcmtpbmdOb2Rlcj1ub2Rlcjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5idWZmZXI9ZnVuY3Rpb24oZyxkaXN0YW5jZSl7dmFyIHByZWNpc2lvbk1vZGVsPXRoaXMud29ya2luZ1ByZWNpc2lvbk1vZGVsO2lmKHByZWNpc2lvbk1vZGVsPT09bnVsbClcbnByZWNpc2lvbk1vZGVsPWcuZ2V0UHJlY2lzaW9uTW9kZWwoKTt0aGlzLmdlb21GYWN0PWcuZ2V0RmFjdG9yeSgpO3ZhciBjdXJ2ZUJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIocHJlY2lzaW9uTW9kZWwsdGhpcy5idWZQYXJhbXMpO3ZhciBjdXJ2ZVNldEJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIoZyxkaXN0YW5jZSxjdXJ2ZUJ1aWxkZXIpO3ZhciBidWZmZXJTZWdTdHJMaXN0PWN1cnZlU2V0QnVpbGRlci5nZXRDdXJ2ZXMoKTtpZihidWZmZXJTZWdTdHJMaXN0LnNpemUoKTw9MCl7cmV0dXJuIHRoaXMuY3JlYXRlRW1wdHlSZXN1bHRHZW9tZXRyeSgpO31cbnRoaXMuY29tcHV0ZU5vZGVkRWRnZXMoYnVmZmVyU2VnU3RyTGlzdCxwcmVjaXNpb25Nb2RlbCk7dGhpcy5ncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgobmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5KCkpO3RoaXMuZ3JhcGguYWRkRWRnZXModGhpcy5lZGdlTGlzdC5nZXRFZGdlcygpKTt2YXIgc3ViZ3JhcGhMaXN0PXRoaXMuY3JlYXRlU3ViZ3JhcGhzKHRoaXMuZ3JhcGgpO3ZhciBwb2x5QnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlcih0aGlzLmdlb21GYWN0KTt0aGlzLmJ1aWxkU3ViZ3JhcGhzKHN1YmdyYXBoTGlzdCxwb2x5QnVpbGRlcik7dmFyIHJlc3VsdFBvbHlMaXN0PXBvbHlCdWlsZGVyLmdldFBvbHlnb25zKCk7aWYocmVzdWx0UG9seUxpc3Quc2l6ZSgpPD0wKXtyZXR1cm4gdGhpcy5jcmVhdGVFbXB0eVJlc3VsdEdlb21ldHJ5KCk7fVxudmFyIHJlc3VsdEdlb209dGhpcy5nZW9tRmFjdC5idWlsZEdlb21ldHJ5KHJlc3VsdFBvbHlMaXN0KTtyZXR1cm4gcmVzdWx0R2VvbTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5nZXROb2Rlcj1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCl7aWYodGhpcy53b3JraW5nTm9kZXIhPT1udWxsKVxucmV0dXJuIHRoaXMud29ya2luZ05vZGVyO3ZhciBub2Rlcj1uZXcganN0cy5ub2RpbmcuTUNJbmRleE5vZGVyKCk7dmFyIGxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTtsaS5zZXRQcmVjaXNpb25Nb2RlbChwcmVjaXNpb25Nb2RlbCk7bm9kZXIuc2V0U2VnbWVudEludGVyc2VjdG9yKG5ldyBqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlcihsaSkpO3JldHVybiBub2Rlcjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZWRFZGdlcz1mdW5jdGlvbihidWZmZXJTZWdTdHJMaXN0LHByZWNpc2lvbk1vZGVsKXt2YXIgbm9kZXI9dGhpcy5nZXROb2RlcihwcmVjaXNpb25Nb2RlbCk7bm9kZXIuY29tcHV0ZU5vZGVzKGJ1ZmZlclNlZ1N0ckxpc3QpO3ZhciBub2RlZFNlZ1N0cmluZ3M9bm9kZXIuZ2V0Tm9kZWRTdWJzdHJpbmdzKCk7Zm9yKHZhciBpPW5vZGVkU2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIHNlZ1N0cj1pLm5leHQoKTt2YXIgb2xkTGFiZWw9c2VnU3RyLmdldERhdGEoKTt2YXIgZWRnZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZShzZWdTdHIuZ2V0Q29vcmRpbmF0ZXMoKSxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwob2xkTGFiZWwpKTt0aGlzLmluc2VydFVuaXF1ZUVkZ2UoZWRnZSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmluc2VydFVuaXF1ZUVkZ2U9ZnVuY3Rpb24oZSl7dmFyIGV4aXN0aW5nRWRnZT10aGlzLmVkZ2VMaXN0LmZpbmRFcXVhbEVkZ2UoZSk7aWYoZXhpc3RpbmdFZGdlIT1udWxsKXt2YXIgZXhpc3RpbmdMYWJlbD1leGlzdGluZ0VkZ2UuZ2V0TGFiZWwoKTt2YXIgbGFiZWxUb01lcmdlPWUuZ2V0TGFiZWwoKTtpZighZXhpc3RpbmdFZGdlLmlzUG9pbnR3aXNlRXF1YWwoZSkpe2xhYmVsVG9NZXJnZT1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZS5nZXRMYWJlbCgpKTtsYWJlbFRvTWVyZ2UuZmxpcCgpO31cbmV4aXN0aW5nTGFiZWwubWVyZ2UobGFiZWxUb01lcmdlKTt2YXIgbWVyZ2VEZWx0YT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5kZXB0aERlbHRhKGxhYmVsVG9NZXJnZSk7dmFyIGV4aXN0aW5nRGVsdGE9ZXhpc3RpbmdFZGdlLmdldERlcHRoRGVsdGEoKTt2YXIgbmV3RGVsdGE9ZXhpc3RpbmdEZWx0YSttZXJnZURlbHRhO2V4aXN0aW5nRWRnZS5zZXREZXB0aERlbHRhKG5ld0RlbHRhKTt9ZWxzZXt0aGlzLmVkZ2VMaXN0LmFkZChlKTtlLnNldERlcHRoRGVsdGEoanN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIuZGVwdGhEZWx0YShlLmdldExhYmVsKCkpKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUuY3JlYXRlU3ViZ3JhcGhzPWZ1bmN0aW9uKGdyYXBoKXt2YXIgc3ViZ3JhcGhMaXN0PVtdO2Zvcih2YXIgaT1ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pLm5leHQoKTtpZighbm9kZS5pc1Zpc2l0ZWQoKSl7dmFyIHN1YmdyYXBoPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgoKTtzdWJncmFwaC5jcmVhdGUobm9kZSk7c3ViZ3JhcGhMaXN0LnB1c2goc3ViZ3JhcGgpO319XG52YXIgY29tcGFyZT1mdW5jdGlvbihhLGIpe3JldHVybiBhLmNvbXBhcmVUbyhiKTt9O3N1YmdyYXBoTGlzdC5zb3J0KGNvbXBhcmUpO3N1YmdyYXBoTGlzdC5yZXZlcnNlKCk7cmV0dXJuIHN1YmdyYXBoTGlzdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5idWlsZFN1YmdyYXBocz1mdW5jdGlvbihzdWJncmFwaExpc3QscG9seUJ1aWxkZXIpe3ZhciBwcm9jZXNzZWRHcmFwaHM9W107Zm9yKHZhciBpPTA7aTxzdWJncmFwaExpc3QubGVuZ3RoO2krKyl7dmFyIHN1YmdyYXBoPXN1YmdyYXBoTGlzdFtpXTt2YXIgcD1zdWJncmFwaC5nZXRSaWdodG1vc3RDb29yZGluYXRlKCk7dmFyIGxvY2F0ZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlcihwcm9jZXNzZWRHcmFwaHMpO3ZhciBvdXRzaWRlRGVwdGg9bG9jYXRlci5nZXREZXB0aChwKTtzdWJncmFwaC5jb21wdXRlRGVwdGgob3V0c2lkZURlcHRoKTtzdWJncmFwaC5maW5kUmVzdWx0RWRnZXMoKTtwcm9jZXNzZWRHcmFwaHMucHVzaChzdWJncmFwaCk7cG9seUJ1aWxkZXIuYWRkKHN1YmdyYXBoLmdldERpcmVjdGVkRWRnZXMoKSxzdWJncmFwaC5nZXROb2RlcygpKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5jb252ZXJ0U2VnU3RyaW5ncz1mdW5jdGlvbihpdCl7dmFyIGZhY3Q9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt2YXIgbGluZXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBzcz1pdC5uZXh0KCk7dmFyIGxpbmU9ZmFjdC5jcmVhdGVMaW5lU3RyaW5nKHNzLmdldENvb3JkaW5hdGVzKCkpO2xpbmVzLmFkZChsaW5lKTt9XG5yZXR1cm4gZmFjdC5idWlsZEdlb21ldHJ5KGxpbmVzKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVFbXB0eVJlc3VsdEdlb21ldHJ5PWZ1bmN0aW9uKCl7dmFyIGVtcHR5R2VvbT10aGlzLmdlb21GYWN0LmNyZWF0ZVBvbHlnb24obnVsbCxudWxsKTtyZXR1cm4gZW1wdHlHZW9tO307anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvcj1mdW5jdGlvbigpe307anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlPWZ1bmN0aW9uKG9jdGFudCxwMCxwMSl7aWYocDAuZXF1YWxzMkQocDEpKVxucmV0dXJuIDA7dmFyIHhTaWduPWpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IucmVsYXRpdmVTaWduKHAwLngscDEueCk7dmFyIHlTaWduPWpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IucmVsYXRpdmVTaWduKHAwLnkscDEueSk7c3dpdGNoKG9jdGFudCl7Y2FzZSAwOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh4U2lnbix5U2lnbik7Y2FzZSAxOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh5U2lnbix4U2lnbik7Y2FzZSAyOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh5U2lnbiwteFNpZ24pO2Nhc2UgMzpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoLXhTaWduLHlTaWduKTtjYXNlIDQ6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKC14U2lnbiwteVNpZ24pO2Nhc2UgNTpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoLXlTaWduLC14U2lnbik7Y2FzZSA2OnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSgteVNpZ24seFNpZ24pO2Nhc2UgNzpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoeFNpZ24sLXlTaWduKTt9XG5yZXR1cm4gMDt9O2pzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IucmVsYXRpdmVTaWduPWZ1bmN0aW9uKHgwLHgxKXtpZih4MDx4MSlcbnJldHVybi0xO2lmKHgwPngxKVxucmV0dXJuIDE7cmV0dXJuIDA7fTtqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZT1mdW5jdGlvbihjb21wYXJlU2lnbjAsY29tcGFyZVNpZ24xKXtpZihjb21wYXJlU2lnbjA8MClcbnJldHVybi0xO2lmKGNvbXBhcmVTaWduMD4wKVxucmV0dXJuIDE7aWYoY29tcGFyZVNpZ24xPDApXG5yZXR1cm4tMTtpZihjb21wYXJlU2lnbjE+MClcbnJldHVybiAxO3JldHVybiAwO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wPWZ1bmN0aW9uKCl7anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5fcmVsYXRlPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIodGhpcy5hcmcpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnByb3RvdHlwZT1uZXcganN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbigpO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVPcC5yZWxhdGU9ZnVuY3Rpb24oYSxiLGJvdW5kYXJ5Tm9kZVJ1bGUpe3ZhciByZWxPcD1uZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wKGEsYixib3VuZGFyeU5vZGVSdWxlKTt2YXIgaW09cmVsT3AuZ2V0SW50ZXJzZWN0aW9uTWF0cml4KCk7cmV0dXJuIGltO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnByb3RvdHlwZS5fcmVsYXRlPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb25NYXRyaXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcmVsYXRlLmNvbXB1dGVJTSgpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluPWZ1bmN0aW9uKHB0cyxzdGFydCxlbmQsY29udGV4dCl7dGhpcy5wdHM9cHRzO3RoaXMuc3RhcnQ9c3RhcnQ7dGhpcy5lbmQ9ZW5kO3RoaXMuY29udGV4dD1jb250ZXh0O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLnN0YXJ0PW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5lbmQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmVudj1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29udGV4dD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuaWQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLnNldElkPWZ1bmN0aW9uKGlkKXt0aGlzLmlkPWlkO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRJZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlkO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRDb250ZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGV4dDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtpZih0aGlzLmVudj09bnVsbCl7dmFyIHAwPXRoaXMucHRzW3RoaXMuc3RhcnRdO3ZhciBwMT10aGlzLnB0c1t0aGlzLmVuZF07dGhpcy5lbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShwMCxwMSk7fVxucmV0dXJuIHRoaXMuZW52O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRTdGFydEluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldEVuZEluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRMaW5lU2VnbWVudD1mdW5jdGlvbihpbmRleCxscyl7bHMucDA9dGhpcy5wdHNbaW5kZXhdO2xzLnAxPXRoaXMucHRzW2luZGV4KzFdO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3ZhciBjb29yZD1bXTt2YXIgaW5kZXg9MDtmb3IodmFyIGk9dGhpcy5zdGFydDtpPD10aGlzLmVuZDtpKyspe2Nvb3JkW2luZGV4KytdPXRoaXMucHRzW2ldO31cbnJldHVybiBjb29yZDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuc2VsZWN0PWZ1bmN0aW9uKHNlYXJjaEVudixtY3Mpe3RoaXMuY29tcHV0ZVNlbGVjdDIoc2VhcmNoRW52LHRoaXMuc3RhcnQsdGhpcy5lbmQsbWNzKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29tcHV0ZVNlbGVjdDI9ZnVuY3Rpb24oc2VhcmNoRW52LHN0YXJ0MCxlbmQwLG1jcyl7dmFyIHAwPXRoaXMucHRzW3N0YXJ0MF07dmFyIHAxPXRoaXMucHRzW2VuZDBdO21jcy50ZW1wRW52MS5pbml0KHAwLHAxKTtpZihlbmQwLXN0YXJ0MD09PTEpe21jcy5zZWxlY3QodGhpcyxzdGFydDApO3JldHVybjt9XG5pZighc2VhcmNoRW52LmludGVyc2VjdHMobWNzLnRlbXBFbnYxKSlcbnJldHVybjt2YXIgbWlkPXBhcnNlSW50KChzdGFydDArZW5kMCkvMik7aWYoc3RhcnQwPG1pZCl7dGhpcy5jb21wdXRlU2VsZWN0MihzZWFyY2hFbnYsc3RhcnQwLG1pZCxtY3MpO31cbmlmKG1pZDxlbmQwKXt0aGlzLmNvbXB1dGVTZWxlY3QyKHNlYXJjaEVudixtaWQsZW5kMCxtY3MpO319O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuY29tcHV0ZU92ZXJsYXBzPWZ1bmN0aW9uKG1jLG1jbyl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTYpe3JldHVybiB0aGlzLmNvbXB1dGVPdmVybGFwczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnRoaXMuY29tcHV0ZU92ZXJsYXBzMih0aGlzLnN0YXJ0LHRoaXMuZW5kLG1jLG1jLnN0YXJ0LG1jLmVuZCxtY28pO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlT3ZlcmxhcHMyPWZ1bmN0aW9uKHN0YXJ0MCxlbmQwLG1jLHN0YXJ0MSxlbmQxLG1jbyl7dmFyIHAwMD10aGlzLnB0c1tzdGFydDBdO3ZhciBwMDE9dGhpcy5wdHNbZW5kMF07dmFyIHAxMD1tYy5wdHNbc3RhcnQxXTt2YXIgcDExPW1jLnB0c1tlbmQxXTtpZihlbmQwLXN0YXJ0MD09PTEmJmVuZDEtc3RhcnQxPT09MSl7bWNvLm92ZXJsYXAodGhpcyxzdGFydDAsbWMsc3RhcnQxKTtyZXR1cm47fVxubWNvLnRlbXBFbnYxLmluaXQocDAwLHAwMSk7bWNvLnRlbXBFbnYyLmluaXQocDEwLHAxMSk7aWYoIW1jby50ZW1wRW52MS5pbnRlcnNlY3RzKG1jby50ZW1wRW52MikpXG5yZXR1cm47dmFyIG1pZDA9cGFyc2VJbnQoKHN0YXJ0MCtlbmQwKS8yKTt2YXIgbWlkMT1wYXJzZUludCgoc3RhcnQxK2VuZDEpLzIpO2lmKHN0YXJ0MDxtaWQwKXtpZihzdGFydDE8bWlkMSlcbnRoaXMuY29tcHV0ZU92ZXJsYXBzMihzdGFydDAsbWlkMCxtYyxzdGFydDEsbWlkMSxtY28pO2lmKG1pZDE8ZW5kMSlcbnRoaXMuY29tcHV0ZU92ZXJsYXBzMihzdGFydDAsbWlkMCxtYyxtaWQxLGVuZDEsbWNvKTt9XG5pZihtaWQwPGVuZDApe2lmKHN0YXJ0MTxtaWQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKG1pZDAsZW5kMCxtYyxzdGFydDEsbWlkMSxtY28pO2lmKG1pZDE8ZW5kMSlcbnRoaXMuY29tcHV0ZU92ZXJsYXBzMihtaWQwLGVuZDAsbWMsbWlkMSxlbmQxLG1jbyk7fX07KGZ1bmN0aW9uKCl7dmFyIExvY2F0aW9uPWpzdHMuZ2VvbS5Mb2NhdGlvbjt2YXIgRGltZW5zaW9uPWpzdHMuZ2VvbS5EaW1lbnNpb247anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeD1mdW5jdGlvbihlbGVtZW50cyl7dmFyIG90aGVyPWVsZW1lbnRzO2lmKGVsZW1lbnRzPT09dW5kZWZpbmVkfHxlbGVtZW50cz09PW51bGwpe3RoaXMubWF0cml4PVtbXSxbXSxbXV07dGhpcy5zZXRBbGwoRGltZW5zaW9uLkZBTFNFKTt9ZWxzZSBpZih0eXBlb2YgZWxlbWVudHM9PT0nc3RyaW5nJyl7dGhpcy5zZXQoZWxlbWVudHMpO31lbHNlIGlmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeCl7dGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldO3RoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09b3RoZXIubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl07dGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uQk9VTkRBUlldPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uQk9VTkRBUlldO3RoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl09b3RoZXIubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl07dGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldO3RoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09b3RoZXIubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl07fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUubWF0cml4PW51bGw7anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGltKXt2YXIgaSxqO2ZvcihpPTA7aTwzO2krKyl7Zm9yKGo9MDtqPDM7aisrKXt0aGlzLnNldEF0TGVhc3QoaSxqLGltLmdldChpLGopKTt9fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzPWZ1bmN0aW9uKGFjdHVhbERpbWVuc2lvblZhbHVlLHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sKXtpZih0eXBlb2YgYWN0dWFsRGltZW5zaW9uVmFsdWU9PT0nc3RyaW5nJyl7cmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlczIuY2FsbCh0aGlzLGFyZ3VtZW50cyk7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nKicpe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09J1QnJiYoYWN0dWFsRGltZW5zaW9uVmFsdWU+PTB8fGFjdHVhbERpbWVuc2lvblZhbHVlPT09RGltZW5zaW9uLlRSVUUpKXtyZXR1cm4gdHJ1ZTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PSdGJyYmYWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uRkFMU0Upe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09JzAnJiZhY3R1YWxEaW1lbnNpb25WYWx1ZT09PURpbWVuc2lvbi5QKXtyZXR1cm4gdHJ1ZTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PScxJyYmYWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uTCl7cmV0dXJuIHRydWU7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nMicmJmFjdHVhbERpbWVuc2lvblZhbHVlPT09RGltZW5zaW9uLkEpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlczI9ZnVuY3Rpb24oYWN0dWFsRGltZW5zaW9uU3ltYm9scyxyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMpe3ZhciBtPW5ldyBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4KGFjdHVhbERpbWVuc2lvblN5bWJvbHMpO3JldHVybiBtLm1hdGNoZXMocmVxdWlyZWREaW1lbnNpb25TeW1ib2xzKTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldD1mdW5jdGlvbihyb3csY29sdW1uLGRpbWVuc2lvblZhbHVlKXtpZih0eXBlb2Ygcm93PT09J3N0cmluZycpe3RoaXMuc2V0Mihyb3cpO3JldHVybjt9XG50aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl09ZGltZW5zaW9uVmFsdWU7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXQyPWZ1bmN0aW9uKGRpbWVuc2lvblN5bWJvbHMpe2Zvcih2YXIgaT0wO2k8ZGltZW5zaW9uU3ltYm9scy5sZW5ndGgoKTtpKyspe3ZhciByb3c9aS8zO3ZhciBjb2w9aSUzO3RoaXMubWF0cml4W3Jvd11bY29sXT1EaW1lbnNpb24udG9EaW1lbnNpb25WYWx1ZShkaW1lbnNpb25TeW1ib2xzLmNoYXJBdChpKSk7fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuc2V0QXRMZWFzdD1mdW5jdGlvbihyb3csY29sdW1uLG1pbmltdW1EaW1lbnNpb25WYWx1ZSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuc2V0QXRMZWFzdDIoYXJndW1lbnRzWzBdKTtyZXR1cm47fVxuaWYodGhpcy5tYXRyaXhbcm93XVtjb2x1bW5dPG1pbmltdW1EaW1lbnNpb25WYWx1ZSl7dGhpcy5tYXRyaXhbcm93XVtjb2x1bW5dPW1pbmltdW1EaW1lbnNpb25WYWx1ZTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBdExlYXN0SWZWYWxpZD1mdW5jdGlvbihyb3csY29sdW1uLG1pbmltdW1EaW1lbnNpb25WYWx1ZSl7aWYocm93Pj0wJiZjb2x1bW4+PTApe3RoaXMuc2V0QXRMZWFzdChyb3csY29sdW1uLG1pbmltdW1EaW1lbnNpb25WYWx1ZSk7fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuc2V0QXRMZWFzdDI9ZnVuY3Rpb24obWluaW11bURpbWVuc2lvblN5bWJvbHMpe3ZhciBpO2ZvcihpPTA7aTxtaW5pbXVtRGltZW5zaW9uU3ltYm9scy5sZW5ndGg7aSsrKXt2YXIgcm93PXBhcnNlSW50KGkvMyk7dmFyIGNvbD1wYXJzZUludChpJTMpO3RoaXMuc2V0QXRMZWFzdChyb3csY29sLGpzdHMuZ2VvbS5EaW1lbnNpb24udG9EaW1lbnNpb25WYWx1ZShtaW5pbXVtRGltZW5zaW9uU3ltYm9scy5jaGFyQXQoaSkpKTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBbGw9ZnVuY3Rpb24oZGltZW5zaW9uVmFsdWUpe3ZhciBhaSxiaTtmb3IoYWk9MDthaTwzO2FpKyspe2ZvcihiaT0wO2JpPDM7YmkrKyl7dGhpcy5tYXRyaXhbYWldW2JpXT1kaW1lbnNpb25WYWx1ZTt9fX07anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHJvdyxjb2x1bW4pe3JldHVybiB0aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl07fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0Rpc2pvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV09PT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0ludGVyc2VjdHM9ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5pc0Rpc2pvaW50KCk7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc1RvdWNoZXM9ZnVuY3Rpb24oZGltZW5zaW9uT2ZHZW9tZXRyeUEsZGltZW5zaW9uT2ZHZW9tZXRyeUIpe2lmKGRpbWVuc2lvbk9mR2VvbWV0cnlBPmRpbWVuc2lvbk9mR2VvbWV0cnlCKXtyZXR1cm4gdGhpcy5pc1RvdWNoZXMoZGltZW5zaW9uT2ZHZW9tZXRyeUIsZGltZW5zaW9uT2ZHZW9tZXRyeUEpO31cbmlmKChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCkpe3JldHVybiB0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT09RGltZW5zaW9uLkZBTFNFJiYoanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKSk7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNDcm9zc2VzPWZ1bmN0aW9uKGRpbWVuc2lvbk9mR2VvbWV0cnlBLGRpbWVuc2lvbk9mR2VvbWV0cnlCKXtpZigoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5QJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkwpfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5QJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkEpfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkEpKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl0sJ1QnKTt9XG5pZigoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLlApfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5BJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLlApfHwoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5BJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09RGltZW5zaW9uLkwpKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKG1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJmpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJyk7fVxuaWYoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PT1EaW1lbnNpb24uTCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PT1EaW1lbnNpb24uTCl7cmV0dXJuIHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT0wO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzV2l0aGluPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXT09RGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNDb250YWlucz1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzQ292ZXJzPWZ1bmN0aW9uKCl7dmFyIGhhc1BvaW50SW5Db21tb249anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKTtyZXR1cm4gaGFzUG9pbnRJbkNvbW1vbiYmdGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0NvdmVyZWRCeT1mdW5jdGlvbigpe3ZhciBoYXNQb2ludEluQ29tbW9uPWpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJyl8fGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldLCdUJyl8fGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uSU5URVJJT1JdLCdUJyl8fGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uQk9VTkRBUlldLCdUJyk7cmV0dXJuIGhhc1BvaW50SW5Db21tb24mJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0VxdWFscz1mdW5jdGlvbihkaW1lbnNpb25PZkdlb21ldHJ5QSxkaW1lbnNpb25PZkdlb21ldHJ5Qil7aWYoZGltZW5zaW9uT2ZHZW9tZXRyeUEhPT1kaW1lbnNpb25PZkdlb21ldHJ5Qil7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uRVhURVJJT1JdPT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uQk9VTkRBUlldPT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uRVhURVJJT1JdPT09RGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNPdmVybGFwcz1mdW5jdGlvbihkaW1lbnNpb25PZkdlb21ldHJ5QSxkaW1lbnNpb25PZkdlb21ldHJ5Qil7aWYoKGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uUCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PT1EaW1lbnNpb24uUCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT09RGltZW5zaW9uLkEpKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKTt9XG5pZihkaW1lbnNpb25PZkdlb21ldHJ5QT09PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09PURpbWVuc2lvbi5MKXtyZXR1cm4gdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09MSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9scyl7aWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2xzLmxlbmd0aCE9OSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCdTaG91bGQgYmUgbGVuZ3RoIDk6ICcrXG5yZXF1aXJlZERpbWVuc2lvblN5bWJvbHMpO31cbmZvcih2YXIgYWk9MDthaTwzO2FpKyspe2Zvcih2YXIgYmk9MDtiaTwzO2JpKyspe2lmKCFqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbYWldW2JpXSxyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMuY2hhckF0KDMqYWkrYmkpKSl7cmV0dXJuIGZhbHNlO319fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS50cmFuc3Bvc2U9ZnVuY3Rpb24oKXt2YXIgdGVtcD1tYXRyaXhbMV1bMF07dGhpcy5tYXRyaXhbMV1bMF09dGhpcy5tYXRyaXhbMF1bMV07dGhpcy5tYXRyaXhbMF1bMV09dGVtcDt0ZW1wPXRoaXMubWF0cml4WzJdWzBdO3RoaXMubWF0cml4WzJdWzBdPXRoaXMubWF0cml4WzBdWzJdO3RoaXMubWF0cml4WzBdWzJdPXRlbXA7dGVtcD10aGlzLm1hdHJpeFsyXVsxXTt0aGlzLm1hdHJpeFsyXVsxXT10aGlzLm1hdHJpeFsxXVsyXTt0aGlzLm1hdHJpeFsxXVsyXT10ZW1wO3JldHVybiB0aGlzO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgYWksYmksYnVmPScnO2ZvcihhaT0wO2FpPDM7YWkrKyl7Zm9yKGJpPTA7Ymk8MztiaSsrKXtidWYrPURpbWVuc2lvbi50b0RpbWVuc2lvblN5bWJvbCh0aGlzLm1hdHJpeFthaV1bYmldKTt9fVxucmV0dXJuIGJ1Zjt9O30pKCk7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3I9ZnVuY3Rpb24oc3ViZGl2KXt0aGlzLnN1YmRpdj1zdWJkaXY7dGhpcy5sYXN0RWRnZT1udWxsO3RoaXMuaW5pdCgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3IucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24oKXt0aGlzLmxhc3RFZGdlPXRoaXMuZmluZEVkZ2UoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuTGFzdEZvdW5kUXVhZEVkZ2VMb2NhdG9yLnByb3RvdHlwZS5maW5kRWRnZT1mdW5jdGlvbigpe3ZhciBlZGdlcz10aGlzLnN1YmRpdi5nZXRFZGdlcygpO3JldHVybiBlZGdlc1swXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuTGFzdEZvdW5kUXVhZEVkZ2VMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24odil7aWYoIXRoaXMubGFzdEVkZ2UuaXNMaXZlKCkpe3RoaXMuaW5pdCgpO31cbnZhciBlPXRoaXMuc3ViZGl2LmxvY2F0ZUZyb21FZGdlKHYsdGhpcy5sYXN0RWRnZSk7dGhpcy5sYXN0RWRnZT1lO3JldHVybiBlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0PWZ1bmN0aW9uKGVkZ2Upe3RoaXMubm9kZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTt0aGlzLmVkZ2U9ZWRnZTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUubm9kZU1hcD1udWxsO2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpLml0ZXJhdG9yKCk7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmVkZ2U9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaW50UHQsc2VnbWVudEluZGV4KXt2YXIgZWlOZXc9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnROb2RlKHRoaXMuZWRnZSxpbnRQdCxzZWdtZW50SW5kZXgsdGhpcy5lZGdlLmdldFNlZ21lbnRPY3RhbnQoc2VnbWVudEluZGV4KSk7dmFyIGVpPXRoaXMubm9kZU1hcC5nZXQoZWlOZXcpO2lmKGVpIT09bnVsbCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoZWkuY29vcmQuZXF1YWxzMkQoaW50UHQpLCdGb3VuZCBlcXVhbCBub2RlcyB3aXRoIGRpZmZlcmVudCBjb29yZGluYXRlcycpO3JldHVybiBlaTt9XG50aGlzLm5vZGVNYXAucHV0KGVpTmV3LGVpTmV3KTtyZXR1cm4gZWlOZXc7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmFkZEVuZHBvaW50cz1mdW5jdGlvbigpe3ZhciBtYXhTZWdJbmRleD10aGlzLmVkZ2Uuc2l6ZSgpLTE7dGhpcy5hZGQodGhpcy5lZGdlLmdldENvb3JkaW5hdGUoMCksMCk7dGhpcy5hZGQodGhpcy5lZGdlLmdldENvb3JkaW5hdGUobWF4U2VnSW5kZXgpLG1heFNlZ0luZGV4KTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuYWRkQ29sbGFwc2VkTm9kZXM9ZnVuY3Rpb24oKXt2YXIgY29sbGFwc2VkVmVydGV4SW5kZXhlcz1bXTt0aGlzLmZpbmRDb2xsYXBzZXNGcm9tSW5zZXJ0ZWROb2Rlcyhjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKTt0aGlzLmZpbmRDb2xsYXBzZXNGcm9tRXhpc3RpbmdWZXJ0aWNlcyhjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKTtmb3IodmFyIGk9MDtpPGNvbGxhcHNlZFZlcnRleEluZGV4ZXMubGVuZ3RoO2krKyl7dmFyIHZlcnRleEluZGV4PWNvbGxhcHNlZFZlcnRleEluZGV4ZXNbaV07dGhpcy5hZGQodGhpcy5lZGdlLmdldENvb3JkaW5hdGUodmVydGV4SW5kZXgpLHZlcnRleEluZGV4KTt9fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmZpbmRDb2xsYXBzZXNGcm9tRXhpc3RpbmdWZXJ0aWNlcz1mdW5jdGlvbihjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKXtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZS5zaXplKCktMjtpKyspe3ZhciBwMD10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShpKTt2YXIgcDE9dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoaSsxKTt2YXIgcDI9dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoaSsyKTtpZihwMC5lcXVhbHMyRChwMikpe2NvbGxhcHNlZFZlcnRleEluZGV4ZXMucHVzaChpKzEpO319fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmZpbmRDb2xsYXBzZXNGcm9tSW5zZXJ0ZWROb2Rlcz1mdW5jdGlvbihjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzKXt2YXIgY29sbGFwc2VkVmVydGV4SW5kZXg9W251bGxdO3ZhciBpdD10aGlzLml0ZXJhdG9yKCk7dmFyIGVpUHJldj1pdC5uZXh0KCk7d2hpbGUoaXQuaGFzTmV4dCgpKXt2YXIgZWk9aXQubmV4dCgpO3ZhciBpc0NvbGxhcHNlZD10aGlzLmZpbmRDb2xsYXBzZUluZGV4KGVpUHJldixlaSxjb2xsYXBzZWRWZXJ0ZXhJbmRleCk7aWYoaXNDb2xsYXBzZWQpXG5jb2xsYXBzZWRWZXJ0ZXhJbmRleGVzLnB1c2goY29sbGFwc2VkVmVydGV4SW5kZXhbMF0pO2VpUHJldj1laTt9fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmZpbmRDb2xsYXBzZUluZGV4PWZ1bmN0aW9uKGVpMCxlaTEsY29sbGFwc2VkVmVydGV4SW5kZXgpe2lmKCFlaTAuY29vcmQuZXF1YWxzMkQoZWkxLmNvb3JkKSlcbnJldHVybiBmYWxzZTt2YXIgbnVtVmVydGljZXNCZXR3ZWVuPWVpMS5zZWdtZW50SW5kZXgtZWkwLnNlZ21lbnRJbmRleDtpZighZWkxLmlzSW50ZXJpb3IoKSl7bnVtVmVydGljZXNCZXR3ZWVuLS07fVxuaWYobnVtVmVydGljZXNCZXR3ZWVuPT09MSl7Y29sbGFwc2VkVmVydGV4SW5kZXhbMF09ZWkwLnNlZ21lbnRJbmRleCsxO3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuYWRkU3BsaXRFZGdlcz1mdW5jdGlvbihlZGdlTGlzdCl7dGhpcy5hZGRFbmRwb2ludHMoKTt0aGlzLmFkZENvbGxhcHNlZE5vZGVzKCk7dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTt2YXIgZWlQcmV2PWl0Lm5leHQoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBlaT1pdC5uZXh0KCk7dmFyIG5ld0VkZ2U9dGhpcy5jcmVhdGVTcGxpdEVkZ2UoZWlQcmV2LGVpKTtlZGdlTGlzdC5hZGQobmV3RWRnZSk7ZWlQcmV2PWVpO319O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuY2hlY2tTcGxpdEVkZ2VzQ29ycmVjdG5lc3M9ZnVuY3Rpb24oc3BsaXRFZGdlcyl7dmFyIGVkZ2VQdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO3ZhciBzcGxpdDA9c3BsaXRFZGdlc1swXTt2YXIgcHQwPXNwbGl0MC5nZXRDb29yZGluYXRlKDApO2lmKCFwdDAuZXF1YWxzMkQoZWRnZVB0c1swXSkpXG50aHJvdyBuZXcgRXJyb3IoJ2JhZCBzcGxpdCBlZGdlIHN0YXJ0IHBvaW50IGF0ICcrcHQwKTt2YXIgc3BsaXRuPXNwbGl0RWRnZXNbc3BsaXRFZGdlcy5sZW5ndGgtMV07dmFyIHNwbGl0blB0cz1zcGxpdG4uZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgcHRuPXNwbGl0blB0c1tzcGxpdG5QdHMubGVuZ3RoLTFdO2lmKCFwdG4uZXF1YWxzMkQoZWRnZVB0c1tlZGdlUHRzLmxlbmd0aC0xXSkpXG50aHJvdyBuZXcgRXJyb3IoJ2JhZCBzcGxpdCBlZGdlIGVuZCBwb2ludCBhdCAnK3B0bik7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmNyZWF0ZVNwbGl0RWRnZT1mdW5jdGlvbihlaTAsZWkxKXt2YXIgbnB0cz1laTEuc2VnbWVudEluZGV4LWVpMC5zZWdtZW50SW5kZXgrMjt2YXIgbGFzdFNlZ1N0YXJ0UHQ9dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoZWkxLnNlZ21lbnRJbmRleCk7dmFyIHVzZUludFB0MT1laTEuaXNJbnRlcmlvcigpfHwhZWkxLmNvb3JkLmVxdWFsczJEKGxhc3RTZWdTdGFydFB0KTtpZighdXNlSW50UHQxKXtucHRzLS07fVxudmFyIHB0cz1bXTt2YXIgaXB0PTA7cHRzW2lwdCsrXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZWkwLmNvb3JkKTtmb3IodmFyIGk9ZWkwLnNlZ21lbnRJbmRleCsxO2k8PWVpMS5zZWdtZW50SW5kZXg7aSsrKXtwdHNbaXB0KytdPXRoaXMuZWRnZS5nZXRDb29yZGluYXRlKGkpO31cbmlmKHVzZUludFB0MSlcbnB0c1tpcHRdPWVpMS5jb29yZDtyZXR1cm4gbmV3IGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyhwdHMsdGhpcy5lZGdlLmdldERhdGEoKSk7fTtqc3RzLmlvLldLVFdyaXRlcj1mdW5jdGlvbigpe3RoaXMucGFyc2VyPW5ldyBqc3RzLmlvLldLVFBhcnNlcih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLmlvLldLVFdyaXRlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciB3a3Q9dGhpcy5wYXJzZXIud3JpdGUoZ2VvbWV0cnkpO3JldHVybiB3a3Q7fTtqc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmc9ZnVuY3Rpb24ocDAscDEpe2lmKGFyZ3VtZW50cy5sZW5ndGghPT0yKXt0aHJvdyBuZXcganN0cy5lcnJvci5Ob3RJbXBsZW1lbnRlZEVycm9yKCk7fVxucmV0dXJuJ0xJTkVTVFJJTkcgKCAnK3AwLngrJyAnK3AwLnkrJywgJytwMS54KycgJytwMS55KycgKSc7fTtqc3RzLmlvLldLVFJlYWRlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeXx8bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt0aGlzLnByZWNpc2lvbk1vZGVsPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmdldFByZWNpc2lvbk1vZGVsKCk7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uV0tUUGFyc2VyKHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMuaW8uV0tUUmVhZGVyLnByb3RvdHlwZS5yZWFkPWZ1bmN0aW9uKHdrdCl7dmFyIGdlb21ldHJ5PXRoaXMucGFyc2VyLnJlYWQod2t0KTtpZih0aGlzLnByZWNpc2lvbk1vZGVsLmdldFR5cGUoKT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dGhpcy5yZWR1Y2VQcmVjaXNpb24oZ2VvbWV0cnkpO31cbnJldHVybiBnZW9tZXRyeTt9O2pzdHMuaW8uV0tUUmVhZGVyLnByb3RvdHlwZS5yZWR1Y2VQcmVjaXNpb249ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBpLGxlbjtpZihnZW9tZXRyeS5jb29yZGluYXRlKXt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGdlb21ldHJ5LmNvb3JkaW5hdGUpO31lbHNlIGlmKGdlb21ldHJ5LnBvaW50cyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkucG9pbnRzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkucG9pbnRzW2ldKTt9fWVsc2UgaWYoZ2VvbWV0cnkuZ2VvbWV0cmllcyl7Zm9yKGk9MCxsZW49Z2VvbWV0cnkuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeS5nZW9tZXRyaWVzW2ldKTt9fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uPWZ1bmN0aW9uKGVudix0b2xlcmFuY2Upe3RoaXMudG9sZXJhbmNlPXRvbGVyYW5jZTt0aGlzLmVkZ2VDb2luY2lkZW5jZVRvbGVyYW5jZT10b2xlcmFuY2UvanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLkVER0VfQ09JTkNJREVOQ0VfVE9MX0ZBQ1RPUjt0aGlzLnZpc2l0ZWRLZXk9MDt0aGlzLnF1YWRFZGdlcz1bXTt0aGlzLnN0YXJ0aW5nRWRnZTt0aGlzLnRvbGVyYW5jZTt0aGlzLmVkZ2VDb2luY2lkZW5jZVRvbGVyYW5jZTt0aGlzLmZyYW1lRW52O3RoaXMubG9jYXRvcj1udWxsO3RoaXMuc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLnRyaUVkZ2VzPW5ldyBBcnJheSgzKTt0aGlzLmZyYW1lVmVydGV4PW5ldyBBcnJheSgzKTt0aGlzLmNyZWF0ZUZyYW1lKGVudik7dGhpcy5zdGFydGluZ0VkZ2U9dGhpcy5pbml0U3ViZGl2KCk7dGhpcy5sb2NhdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLkxhc3RGb3VuZFF1YWRFZGdlTG9jYXRvcih0aGlzKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5FREdFX0NPSU5DSURFTkNFX1RPTF9GQUNUT1I9MTAwMDtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24uZ2V0VHJpYW5nbGVFZGdlcz1mdW5jdGlvbihzdGFydFFFLHRyaUVkZ2Upe3RyaUVkZ2VbMF09c3RhcnRRRTt0cmlFZGdlWzFdPXRyaUVkZ2VbMF0ubE5leHQoKTt0cmlFZGdlWzJdPXRyaUVkZ2VbMV0ubE5leHQoKTtpZih0cmlFZGdlWzJdLmxOZXh0KCkhPXRyaUVkZ2VbMF0pe3Rocm93IG5ldyBqc3RzLklsbGVnYWxBcmd1bWVudEVycm9yKCdFZGdlcyBkbyBub3QgZm9ybSBhIHRyaWFuZ2xlJyk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5jcmVhdGVGcmFtZT1mdW5jdGlvbihlbnYpe3ZhciBkZWx0YVgsZGVsdGFZLG9mZnNldDtkZWx0YVg9ZW52LmdldFdpZHRoKCk7ZGVsdGFZPWVudi5nZXRIZWlnaHQoKTtvZmZzZXQ9MC4wO2lmKGRlbHRhWD5kZWx0YVkpe29mZnNldD1kZWx0YVgqMTAuMDt9ZWxzZXtvZmZzZXQ9ZGVsdGFZKjEwLjA7fVxudGhpcy5mcmFtZVZlcnRleFswXT1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoKGVudi5nZXRNYXhYKCkrZW52LmdldE1pblgoKSkvMi4wLGVudi5nZXRNYXhZKClcbitvZmZzZXQpO3RoaXMuZnJhbWVWZXJ0ZXhbMV09bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGVudi5nZXRNaW5YKCktb2Zmc2V0LGVudi5nZXRNaW5ZKCktb2Zmc2V0KTt0aGlzLmZyYW1lVmVydGV4WzJdPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChlbnYuZ2V0TWF4WCgpK29mZnNldCxlbnYuZ2V0TWluWSgpLW9mZnNldCk7dGhpcy5mcmFtZUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMuZnJhbWVWZXJ0ZXhbMF0uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuZnJhbWVWZXJ0ZXhbMV0uZ2V0Q29vcmRpbmF0ZSgpKTt0aGlzLmZyYW1lRW52LmV4cGFuZFRvSW5jbHVkZSh0aGlzLmZyYW1lVmVydGV4WzJdLmdldENvb3JkaW5hdGUoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmluaXRTdWJkaXY9ZnVuY3Rpb24oKXt2YXIgZWEsZWIsZWM7ZWE9dGhpcy5tYWtlRWRnZSh0aGlzLmZyYW1lVmVydGV4WzBdLHRoaXMuZnJhbWVWZXJ0ZXhbMV0pO2ViPXRoaXMubWFrZUVkZ2UodGhpcy5mcmFtZVZlcnRleFsxXSx0aGlzLmZyYW1lVmVydGV4WzJdKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlYS5zeW0oKSxlYik7ZWM9dGhpcy5tYWtlRWRnZSh0aGlzLmZyYW1lVmVydGV4WzJdLHRoaXMuZnJhbWVWZXJ0ZXhbMF0pO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGViLnN5bSgpLGVjKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlYy5zeW0oKSxlYSk7cmV0dXJuIGVhO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRUb2xlcmFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uRW52ZWxvcGUodGhpcy5mcmFtZUVudik7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD4wKXtyZXR1cm4gdGhpcy5nZXRFZGdlc0J5RmFjdG9yeShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLnF1YWRFZGdlczt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLnNldExvY2F0b3I9ZnVuY3Rpb24obG9jYXRvcil7dGhpcy5sb2NhdG9yPWxvY2F0b3I7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLm1ha2VFZGdlPWZ1bmN0aW9uKG8sZCl7dmFyIHE9anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5tYWtlRWRnZShvLGQpO3RoaXMucXVhZEVkZ2VzLnB1c2gocSk7cmV0dXJuIHE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24oYSxiKXt2YXIgcT1qc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLmNvbm5lY3QoYSxiKTt0aGlzLnF1YWRFZGdlcy5wdXNoKHEpO3JldHVybiBxO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5kZWxldGVfanN0cz1mdW5jdGlvbihlKXtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlLGUub1ByZXYoKSk7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zcGxpY2UoZS5zeW0oKSxlLnN5bSgpLm9QcmV2KCkpO3ZhciBlU3ltLGVSb3QsZVJvdFN5bTtlLmVTeW09ZS5zeW0oKTtlUm90PWUucm90O2VSb3RTeW09ZS5yb3Quc3ltKCk7dmFyIGlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGUpO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGVTeW0pO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGVSb3QpO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmlkeD10aGlzLnF1YWRFZGdlcy5pbmRleE9mKGVSb3RTeW0pO2lmKGlkeCE9PS0xKXt0aGlzLnF1YWRFZGdlcy5zcGxpY2UoaWR4LDEpO31cbmUuZGVsZXRlX2pzdHMoKTtlU3ltLmRlbGV0ZV9qc3RzKCk7ZVJvdC5kZWxldGVfanN0cygpO2VSb3RTeW0uZGVsZXRlX2pzdHMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlRnJvbUVkZ2U9ZnVuY3Rpb24odixzdGFydEVkZ2Upe3ZhciBpdGVyPTAsbWF4SXRlcj10aGlzLnF1YWRFZGdlcy5sZW5ndGgsZTtlPXN0YXJ0RWRnZTt3aGlsZSh0cnVlKXtpdGVyKys7aWYoaXRlcj5tYXhJdGVyKXt0aHJvdyBuZXcganN0cy5lcnJvci5Mb2NhdGVGYWlsdXJlRXJyb3IoZS50b0xpbmVTZWdtZW50KCkpO31cbmlmKCh2LmVxdWFscyhlLm9yaWcoKSkpfHwodi5lcXVhbHMoZS5kZXN0KCkpKSl7YnJlYWs7fWVsc2UgaWYodi5yaWdodE9mKGUpKXtlPWUuc3ltKCk7fWVsc2UgaWYoIXYucmlnaHRPZihlLm9OZXh0KCkpKXtlPWUub05leHQoKTt9ZWxzZSBpZighdi5yaWdodE9mKGUuZFByZXYoKSkpe2U9ZS5kUHJldigpO31lbHNle2JyZWFrO319XG5yZXR1cm4gZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgpe3JldHVybiB0aGlzLmxvY2F0ZUJ5VmVydGV4KGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMubG9jYXRlQnlDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fX1lbHNle3JldHVybiB0aGlzLmxvY2F0ZUJ5Q29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGVCeVZlcnRleD1mdW5jdGlvbih2KXtyZXR1cm4gdGhpcy5sb2NhdG9yLmxvY2F0ZSh2KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlQnlDb29yZGluYXRlPWZ1bmN0aW9uKHApe3JldHVybiB0aGlzLmxvY2F0b3IubG9jYXRlKG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChwKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmxvY2F0ZUJ5Q29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDAscDEpe3ZhciBlLGJhc2UsbG9jRWRnZTt2YXIgZT10aGlzLmxvY2F0b3IubG9jYXRlKG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChwMCkpO2lmKGU9PT1udWxsKXtyZXR1cm4gbnVsbDt9XG5iYXNlPWU7aWYoZS5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpLmVxdWFsczJEKHAwKSl7YmFzZT1lLnN5bSgpO31cbmxvY0VkZ2U9YmFzZTtkb3tpZihsb2NFZGdlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkuZXF1YWxzMkQocDEpKXtyZXR1cm4gbG9jRWRnZTt9XG5sb2NFZGdlPWxvY0VkZ2Uub05leHQoKTt9d2hpbGUobG9jRWRnZSE9YmFzZSk7cmV0dXJuIG51bGw7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmluc2VydFNpdGU9ZnVuY3Rpb24odil7dmFyIGUsYmFzZSxzdGFydEVkZ2U7ZT10aGlzLmxvY2F0ZSh2KTtpZigodi5lcXVhbHMoZS5vcmlnKCksdGhpcy50b2xlcmFuY2UpKXx8KHYuZXF1YWxzKGUuZGVzdCgpLHRoaXMudG9sZXJhbmNlKSkpe3JldHVybiBlO31cbmJhc2U9dGhpcy5tYWtlRWRnZShlLm9yaWcoKSx2KTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShiYXNlLGUpO3N0YXJ0RWRnZT1iYXNlO2Rve2Jhc2U9dGhpcy5jb25uZWN0KGUsYmFzZS5zeW0oKSk7ZT1iYXNlLm9QcmV2KCk7fXdoaWxlKGUubE5leHQoKSE9c3RhcnRFZGdlKTtyZXR1cm4gc3RhcnRFZGdlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5pc0ZyYW1lRWRnZT1mdW5jdGlvbihlKXtpZih0aGlzLmlzRnJhbWVWZXJ0ZXgoZS5vcmlnKCkpfHx0aGlzLmlzRnJhbWVWZXJ0ZXgoZS5kZXN0KCkpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzRnJhbWVCb3JkZXJFZGdlPWZ1bmN0aW9uKGUpe3ZhciBsZWZ0VHJpLHJpZ2h0VHJpLHZMZWZ0VHJpT3RoZXIsdlJpZ2h0VHJpT3RoZXI7bGVmdFRyaT1uZXcgQXJyYXkoMyk7dGhpcy5nZXRUcmlhbmdsZUVkZ2VzKGUsbGVmdFRyaSk7cmlnaHRUcmk9bmV3IEFycmF5KDMpO3RoaXMuZ2V0VHJpYW5nbGVFZGdlcyhlLnN5bSgpLHJpZ2h0VHJpKTt2TGVmdFRyaU90aGVyPWUubE5leHQoKS5kZXN0KCk7aWYodGhpcy5pc0ZyYW1lVmVydGV4KHZMZWZ0VHJpT3RoZXIpKXtyZXR1cm4gdHJ1ZTt9XG52UmlnaHRUcmlPdGhlcj1lLnN5bSgpLmxOZXh0KCkuZGVzdCgpO2lmKHRoaXMuaXNGcmFtZVZlcnRleCh2UmlnaHRUcmlPdGhlcikpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNGcmFtZVZlcnRleD1mdW5jdGlvbih2KXtpZih2LmVxdWFscyh0aGlzLmZyYW1lVmVydGV4WzBdKSl7cmV0dXJuIHRydWU7fVxuaWYodi5lcXVhbHModGhpcy5mcmFtZVZlcnRleFsxXSkpe3JldHVybiB0cnVlO31cbmlmKHYuZXF1YWxzKHRoaXMuZnJhbWVWZXJ0ZXhbMl0pKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzT25FZGdlPWZ1bmN0aW9uKGUscCl7dGhpcy5zZWcuc2V0Q29vcmRpbmF0ZXMoZS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpLGUuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk7dmFyIGRpc3Q9dGhpcy5zZWcuZGlzdGFuY2UocCk7cmV0dXJuIGRpc3Q8dGhpcy5lZGdlQ29pbmNpZGVuY2VUb2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzVmVydGV4T2ZFZGdlPWZ1bmN0aW9uKGUsdil7aWYoKHYuZXF1YWxzKGUub3JpZygpLHRoaXMudG9sZXJhbmNlKSl8fCh2LmVxdWFscyhlLmRlc3QoKSx0aGlzLnRvbGVyYW5jZSkpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFZlcnRpY2VzPWZ1bmN0aW9uKGluY2x1ZGVGcmFtZSlcbnt2YXIgdmVydGljZXM9W10saSxpbCxxZSx2LHZkO2k9MCxpbD10aGlzLnF1YWRFZGdlcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3FlPXRoaXMucXVhZEVkZ2VzW2ldO3Y9cWUub3JpZygpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZVZlcnRleCh2KSl7dmVydGljZXMucHVzaCh2KTt9XG52ZD1xZS5kZXN0KCk7aWYoaW5jbHVkZUZyYW1lfHwhdGhpcy5pc0ZyYW1lVmVydGV4KHZkKSl7dmVydGljZXMucHVzaCh2ZCk7fX1cbnJldHVybiB2ZXJ0aWNlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VmVydGV4VW5pcXVlRWRnZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKVxue3ZhciBlZGdlcyx2aXNpdGVkVmVydGljZXMsaSxpbCxxZSx2LHFkLHZkO2VkZ2VzPVtdO3Zpc2l0ZWRWZXJ0aWNlcz1bXTtpPTAsaWw9dGhpcy5xdWFkRWRnZXMubGVuZ3RoO2ZvcihpO2k8aWw7aSsrKXtxZT10aGlzLnF1YWRFZGdlc1tpXTt2PXFlLm9yaWcoKTtpZih2aXNpdGVkVmVydGljZXMuaW5kZXhPZih2KT09PS0xKXt2aXNpdGVkVmVydGljZXMucHVzaCh2KTtpZihpbmNsdWRlRnJhbWV8fCF0aGlzLmlzRnJhbWVWZXJ0ZXgodikpe2VkZ2VzLnB1c2gocWUpO319XG5xZD1xZS5zeW0oKTt2ZD1xZC5vcmlnKCk7aWYodmlzaXRlZFZlcnRpY2VzLmluZGV4T2YodmQpPT09LTEpe3Zpc2l0ZWRWZXJ0aWNlcy5wdXNoKHZkKTtpZihpbmNsdWRlRnJhbWV8fCF0aGlzLmlzRnJhbWVWZXJ0ZXgodmQpKXtlZGdlcy5wdXNoKHFkKTt9fX1cbnJldHVybiBlZGdlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0UHJpbWFyeUVkZ2VzPWZ1bmN0aW9uKGluY2x1ZGVGcmFtZSl7dGhpcy52aXNpdGVkS2V5Kys7dmFyIGVkZ2VzLGVkZ2VTdGFjayx2aXNpdGVkRWRnZXMsZWRnZSxwcmlRRTtlZGdlcz1bXTtlZGdlU3RhY2s9W107ZWRnZVN0YWNrLnB1c2godGhpcy5zdGFydGluZ0VkZ2UpO3Zpc2l0ZWRFZGdlcz1bXTt3aGlsZShlZGdlU3RhY2subGVuZ3RoPjApe2VkZ2U9ZWRnZVN0YWNrLnBvcCgpO2lmKHZpc2l0ZWRFZGdlcy5pbmRleE9mKGVkZ2UpPT09LTEpe3ByaVFFPWVkZ2UuZ2V0UHJpbWFyeSgpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZUVkZ2UocHJpUUUpKXtlZGdlcy5wdXNoKHByaVFFKTt9XG5lZGdlU3RhY2sucHVzaChlZGdlLm9OZXh0KCkpO2VkZ2VTdGFjay5wdXNoKGVkZ2Uuc3ltKCkub05leHQoKSk7dmlzaXRlZEVkZ2VzLnB1c2goZWRnZSk7dmlzaXRlZEVkZ2VzLnB1c2goZWRnZS5zeW0oKSk7fX1cbnJldHVybiBlZGdlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUudmlzaXRUcmlhbmdsZXM9ZnVuY3Rpb24odHJpVmlzaXRvcixpbmNsdWRlRnJhbWUpe3RoaXMudmlzaXRlZEtleSsrO3ZhciBlZGdlU3RhY2ssdmlzaXRlZEVkZ2VzLGVkZ2UsdHJpRWRnZXM7ZWRnZVN0YWNrPVtdO2VkZ2VTdGFjay5wdXNoKHRoaXMuc3RhcnRpbmdFZGdlKTt2aXNpdGVkRWRnZXM9W107d2hpbGUoZWRnZVN0YWNrLmxlbmd0aD4wKXtlZGdlPWVkZ2VTdGFjay5wb3AoKTtpZih2aXNpdGVkRWRnZXMuaW5kZXhPZihlZGdlKT09PS0xKXt0cmlFZGdlcz10aGlzLmZldGNoVHJpYW5nbGVUb1Zpc2l0KGVkZ2UsZWRnZVN0YWNrLGluY2x1ZGVGcmFtZSx2aXNpdGVkRWRnZXMpO2lmKHRyaUVkZ2VzIT09bnVsbClcbnRyaVZpc2l0b3IudmlzaXQodHJpRWRnZXMpO319fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmZldGNoVHJpYW5nbGVUb1Zpc2l0PWZ1bmN0aW9uKGVkZ2UsZWRnZVN0YWNrLGluY2x1ZGVGcmFtZSx2aXNpdGVkRWRnZXMpe3ZhciBjdXJyLGVkZ2VDb3VudCxpc0ZyYW1lLHN5bTtjdXJyPWVkZ2U7ZWRnZUNvdW50PTA7aXNGcmFtZT1mYWxzZTtkb3t0aGlzLnRyaUVkZ2VzW2VkZ2VDb3VudF09Y3VycjtpZih0aGlzLmlzRnJhbWVFZGdlKGN1cnIpKXtpc0ZyYW1lPXRydWU7fVxuc3ltPWN1cnIuc3ltKCk7aWYodmlzaXRlZEVkZ2VzLmluZGV4T2Yoc3ltKT09PS0xKXtlZGdlU3RhY2sucHVzaChzeW0pO31cbnZpc2l0ZWRFZGdlcy5wdXNoKGN1cnIpO2VkZ2VDb3VudCsrO2N1cnI9Y3Vyci5sTmV4dCgpO313aGlsZShjdXJyIT09ZWRnZSk7aWYoaXNGcmFtZSYmIWluY2x1ZGVGcmFtZSl7cmV0dXJuIG51bGw7fVxucmV0dXJuIHRoaXMudHJpRWRnZXM7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFRyaWFuZ2xlRWRnZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKXt2YXIgdmlzaXRvcj1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUVkZ2VzTGlzdFZpc2l0b3IoKTt0aGlzLnZpc2l0VHJpYW5nbGVzKHZpc2l0b3IsaW5jbHVkZUZyYW1lKTtyZXR1cm4gdmlzaXRvci5nZXRUcmlhbmdsZUVkZ2VzKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFRyaWFuZ2xlVmVydGljZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKXt2YXIgdmlzaXRvcj1uZXcgVHJpYW5nbGVWZXJ0ZXhMaXN0VmlzaXRvcigpO3RoaXMudmlzaXRUcmlhbmdsZXModmlzaXRvcixpbmNsdWRlRnJhbWUpO3JldHVybiB2aXNpdG9yLmdldFRyaWFuZ2xlVmVydGljZXMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVDb29yZGluYXRlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpe3ZhciB2aXNpdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ29vcmRpbmF0ZXNWaXNpdG9yKCk7dGhpcy52aXNpdFRyaWFuZ2xlcyh2aXNpdG9yLGluY2x1ZGVGcmFtZSk7cmV0dXJuIHZpc2l0b3IuZ2V0VHJpYW5nbGVzKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldEVkZ2VzQnlGYWN0b3J5PWZ1bmN0aW9uKGdlb21GYWN0KXt2YXIgcXVhZEVkZ2VzLGVkZ2VzLGksaWwscWUsY29vcmRzO3F1YWRFZGdlcz10aGlzLmdldFByaW1hcnlFZGdlcyhmYWxzZSk7ZWRnZXM9W107aT0wO2lsPXF1YWRFZGdlcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3FlPXF1YWRFZGdlc1tpXTtjb29yZHM9W107Y29vcmRzWzBdPShxZS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpKTtjb29yZHNbMV09KHFlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkpO2VkZ2VzW2ldPWdlb21GYWN0LmNyZWF0ZUxpbmVTdHJpbmcoY29vcmRzKTt9XG5yZXR1cm4gZ2VvbUZhY3QuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKGVkZ2VzKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVzPWZ1bmN0aW9uKGdlb21GYWN0KXt2YXIgdHJpUHRzTGlzdCx0cmlzLHRyaVB0LGksaWw7dHJpUHRzTGlzdD10aGlzLmdldFRyaWFuZ2xlQ29vcmRpbmF0ZXMoZmFsc2UpO3RyaXM9bmV3IEFycmF5KHRyaVB0c0xpc3QubGVuZ3RoKTtpPTAsaWw9dHJpUHRzTGlzdC5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3RyaVB0PXRyaVB0c0xpc3RbaV07dHJpc1tpXT1nZW9tRmFjdC5jcmVhdGVQb2x5Z29uKGdlb21GYWN0LmNyZWF0ZUxpbmVhclJpbmcodHJpUHQsbnVsbCkpO31cbnJldHVybiBnZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24odHJpcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFZvcm9ub2lEaWFncmFtPWZ1bmN0aW9uKGdlb21GYWN0KVxue3ZhciB2b3JDZWxscz10aGlzLmdldFZvcm9ub2lDZWxsUG9seWdvbnMoZ2VvbUZhY3QpO3JldHVybiBnZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24odm9yQ2VsbHMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRWb3Jvbm9pQ2VsbFBvbHlnb25zPWZ1bmN0aW9uKGdlb21GYWN0KVxue3RoaXMudmlzaXRUcmlhbmdsZXMobmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDaXJjdW1jZW50cmVWaXNpdG9yKCksdHJ1ZSk7dmFyIGNlbGxzLGVkZ2VzLGksaWwscWU7Y2VsbHM9W107ZWRnZXM9dGhpcy5nZXRWZXJ0ZXhVbmlxdWVFZGdlcyhmYWxzZSk7aT0wLGlsPWVkZ2VzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7cWU9ZWRnZXNbaV07Y2VsbHMucHVzaCh0aGlzLmdldFZvcm9ub2lDZWxsUG9seWdvbihxZSxnZW9tRmFjdCkpO31cbnJldHVybiBjZWxsczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0Vm9yb25vaUNlbGxQb2x5Z29uPWZ1bmN0aW9uKHFlLGdlb21GYWN0KVxue3ZhciBjZWxsUHRzLHN0YXJ0UWUsY2MsY29vcmRMaXN0LGNlbGxQb2x5LHY7Y2VsbFB0cz1bXTtzdGFydFFFPXFlO2Rve2NjPXFlLnJvdC5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpO2NlbGxQdHMucHVzaChjYyk7cWU9cWUub1ByZXYoKTt9d2hpbGUocWUhPT1zdGFydFFFKTtjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdChbXSxmYWxzZSk7Y29vcmRMaXN0LmFkZChjZWxsUHRzLGZhbHNlKTtjb29yZExpc3QuY2xvc2VSaW5nKCk7aWYoY29vcmRMaXN0LnNpemUoKTw0KXtjb29yZExpc3QuYWRkKGNvb3JkTGlzdC5nZXQoY29vcmRMaXN0LnNpemUoKS0xKSx0cnVlKTt9XG5jZWxsUG9seT1nZW9tRmFjdC5jcmVhdGVQb2x5Z29uKGdlb21GYWN0LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRMaXN0LnRvQXJyYXkoKSksbnVsbCk7dj1zdGFydFFFLm9yaWcoKTtyZXR1cm4gY2VsbFBvbHk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ2lyY3VtY2VudHJlVmlzaXRvcj1mdW5jdGlvbigpe307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNpcmN1bWNlbnRyZVZpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHRyaUVkZ2VzKXt2YXIgYSxiLGMsY2MsY2NWZXJ0ZXgsaTthPXRyaUVkZ2VzWzBdLm9yaWcoKS5nZXRDb29yZGluYXRlKCk7Yj10cmlFZGdlc1sxXS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpO2M9dHJpRWRnZXNbMl0ub3JpZygpLmdldENvb3JkaW5hdGUoKTtjYz1qc3RzLmdlb20uVHJpYW5nbGUuY2lyY3VtY2VudHJlKGEsYixjKTtjY1ZlcnRleD1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoY2MpO2k9MDtmb3IoaTtpPDM7aSsrKXt0cmlFZGdlc1tpXS5yb3Quc2V0T3JpZyhjY1ZlcnRleCk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUVkZ2VzTGlzdFZpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLnRyaUxpc3Q9W107fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3ZhciBjbG9uZT10cmlFZGdlcy5jb25jYXQoKTt0aGlzLnRyaUxpc3QucHVzaChjbG9uZSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvci5wcm90b3R5cGUuZ2V0VHJpYW5nbGVFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRyaUxpc3Q7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlVmVydGV4TGlzdFZpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLnRyaUxpc3Q9W107fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlVmVydGV4TGlzdFZpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHRyaUVkZ2VzKXt2YXIgdmVydGljZXM9W107dmVydGljZXMucHVzaCh0cmllRWRnZXNbMF0ub3JpZygpKTt2ZXJ0aWNlcy5wdXNoKHRyaWVFZGdlc1sxXS5vcmlnKCkpO3ZlcnRpY2VzLnB1c2godHJpZUVkZ2VzWzJdLm9yaWcoKSk7dGhpcy50cmlMaXN0LnB1c2godmVydGljZXMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVZlcnRleExpc3RWaXNpdG9yLnByb3RvdHlwZS5nZXRUcmlhbmdsZVZlcnRpY2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJpTGlzdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDb29yZGluYXRlc1Zpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLmNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKTt0aGlzLnRyaUNvb3Jkcz1bXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDb29yZGluYXRlc1Zpc2l0b3IucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHRyaUVkZ2VzKXt0aGlzLmNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKTt2YXIgaT0wLHYscHRzO2ZvcihpO2k8MztpKyspe3Y9dHJpRWRnZXNbaV0ub3JpZygpO3RoaXMuY29vcmRMaXN0LmFkZCh2LmdldENvb3JkaW5hdGUoKSk7fVxuaWYodGhpcy5jb29yZExpc3Quc2l6ZSgpPjApe3RoaXMuY29vcmRMaXN0LmNsb3NlUmluZygpO3B0cz10aGlzLmNvb3JkTGlzdC50b0FycmF5KCk7aWYocHRzLmxlbmd0aCE9PTQpe3JldHVybjt9XG50aGlzLnRyaUNvb3Jkcy5wdXNoKHB0cyk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNvb3JkaW5hdGVzVmlzaXRvci5wcm90b3R5cGUuZ2V0VHJpYW5nbGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJpQ29vcmRzO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGU9ZnVuY3Rpb24oKXt0aGlzLmVkZ2VFbmRzPVtdO3ZhciBlPWFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguRWRnZUVuZD9hcmd1bWVudHNbMF06YXJndW1lbnRzWzFdO3ZhciBlZGdlPWUuZ2V0RWRnZSgpO3ZhciBjb29yZD1lLmdldENvb3JkaW5hdGUoKTt2YXIgZGlyQ29vcmQ9ZS5nZXREaXJlY3RlZENvb3JkaW5hdGUoKTt2YXIgbGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGUuZ2V0TGFiZWwoKSk7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5jYWxsKHRoaXMsZWRnZSxjb29yZCxkaXJDb29yZCxsYWJlbCk7dGhpcy5pbnNlcnQoZSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQoKTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuZWRnZUVuZHM9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5nZXRFZGdlRW5kcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VFbmRzO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihlKXt0aGlzLmVkZ2VFbmRzLnB1c2goZSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuY29tcHV0ZUxhYmVsPWZ1bmN0aW9uKGJvdW5kYXJ5Tm9kZVJ1bGUpe3ZhciBpc0FyZWE9ZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLmVkZ2VFbmRzLmxlbmd0aDtpKyspe3ZhciBlPXRoaXMuZWRnZUVuZHNbaV07aWYoZS5nZXRMYWJlbCgpLmlzQXJlYSgpKVxuaXNBcmVhPXRydWU7fVxuaWYoaXNBcmVhKVxudGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO2Vsc2VcbnRoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTtmb3IodmFyIGk9MDtpPDI7aSsrKXt0aGlzLmNvbXB1dGVMYWJlbE9uKGksYm91bmRhcnlOb2RlUnVsZSk7aWYoaXNBcmVhKVxudGhpcy5jb21wdXRlTGFiZWxTaWRlcyhpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuY29tcHV0ZUxhYmVsT249ZnVuY3Rpb24oZ2VvbUluZGV4LGJvdW5kYXJ5Tm9kZVJ1bGUpe3ZhciBib3VuZGFyeUNvdW50PTA7dmFyIGZvdW5kSW50ZXJpb3I9ZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLmVkZ2VFbmRzLmxlbmd0aDtpKyspe3ZhciBlPXRoaXMuZWRnZUVuZHNbaV07dmFyIGxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oZ2VvbUluZGV4KTtpZihsb2M9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbmJvdW5kYXJ5Q291bnQrKztpZihsb2M9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUilcbmZvdW5kSW50ZXJpb3I9dHJ1ZTt9XG52YXIgbG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO2lmKGZvdW5kSW50ZXJpb3IpXG5sb2M9anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO2lmKGJvdW5kYXJ5Q291bnQ+MCl7bG9jPWpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguZGV0ZXJtaW5lQm91bmRhcnkoYm91bmRhcnlOb2RlUnVsZSxib3VuZGFyeUNvdW50KTt9XG50aGlzLmxhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxsb2MpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmNvbXB1dGVMYWJlbFNpZGVzPWZ1bmN0aW9uKGdlb21JbmRleCl7dGhpcy5jb21wdXRlTGFiZWxTaWRlKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt0aGlzLmNvbXB1dGVMYWJlbFNpZGUoZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5jb21wdXRlTGFiZWxTaWRlPWZ1bmN0aW9uKGdlb21JbmRleCxzaWRlKXtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUVuZHMubGVuZ3RoO2krKyl7dmFyIGU9dGhpcy5lZGdlRW5kc1tpXTtpZihlLmdldExhYmVsKCkuaXNBcmVhKCkpe3ZhciBsb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGdlb21JbmRleCxzaWRlKTtpZihsb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1Ipe3RoaXMubGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LHNpZGUsanN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKTtyZXR1cm47fWVsc2UgaWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKVxudGhpcy5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsc2lkZSxqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IpO319fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUudXBkYXRlSU09ZnVuY3Rpb24oaW0pe2pzdHMuZ2VvbWdyYXBoLkVkZ2UudXBkYXRlSU0odGhpcy5sYWJlbCxpbSk7fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWU9ZnVuY3Rpb24odG9sZXJhbmNlKXt2YXIgdG9sPTAuMDtpZih0b2xlcmFuY2UhPT11bmRlZmluZWQpe3RvbD10b2xlcmFuY2U7fVxudGhpcy5yb290PW51bGw7dGhpcy5sYXN0PW51bGw7dGhpcy5udW1iZXJPZk5vZGVzPTA7dGhpcy50b2xlcmFuY2U9dG9sO307anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuaW5zZXJ0Q29vcmRpbmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuaW5zZXJ0V2l0aERhdGEuYXBwbHkodGhpcyxhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWUucHJvdG90eXBlLmluc2VydENvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuaW5zZXJ0V2l0aERhdGEocCxudWxsKTt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUuaW5zZXJ0V2l0aERhdGE9ZnVuY3Rpb24ocCxkYXRhKXtpZih0aGlzLnJvb3Q9PT1udWxsKXt0aGlzLnJvb3Q9bmV3IGpzdHMuaW5kZXgua2R0cmVlLktkTm9kZShwLGRhdGEpO3JldHVybiB0aGlzLnJvb3Q7fVxudmFyIGN1cnJlbnROb2RlPXRoaXMucm9vdCxsZWFmTm9kZT10aGlzLnJvb3QsaXNPZGRMZXZlbD10cnVlLGlzTGVzc1RoYW49dHJ1ZTt3aGlsZShjdXJyZW50Tm9kZSE9PWxhc3Qpe2lmKGlzT2RkTGV2ZWwpe2lzTGVzc1RoYW49cC54PGN1cnJlbnROb2RlLmdldFgoKTt9ZWxzZXtpc0xlc3NUaGFuPXAueTxjdXJyZW50Tm9kZS5nZXRZKCk7fVxubGVhZk5vZGU9Y3VycmVudE5vZGU7aWYoaXNMZXNzVGhhbil7Y3VycmVudE5vZGU9Y3VycmVudE5vZGUuZ2V0TGVmdCgpO31lbHNle2N1cnJlbnROb2RlPWN1cnJlbnROb2RlLmdldFJpZ2h0KCk7fVxuaWYoY3VycmVudE5vZGUhPT1udWxsKXt2YXIgaXNJblRvbGVyYW5jZT1wLmRpc3RhbmNlKGN1cnJlbnROb2RlLmdldENvb3JkaW5hdGUoKSk8PXRoaXMudG9sZXJhbmNlO2lmKGlzSW5Ub2xlcmFuY2Upe2N1cnJlbnROb2RlLmluY3JlbWVudCgpO3JldHVybiBjdXJyZW50Tm9kZTt9fVxuaXNPZGRMZXZlbD0haXNPZGRMZXZlbDt9XG50aGlzLm51bWJlck9mTm9kZXM9bnVtYmVyT2ZOb2RlcysxO3ZhciBub2RlPW5ldyBqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUocCxkYXRhKTtub2RlLnNldExlZnQodGhpcy5sYXN0KTtub2RlLnNldFJpZ2h0KHRoaXMubGFzdCk7aWYoaXNMZXNzVGhhbil7bGVhZk5vZGUuc2V0TGVmdChub2RlKTt9ZWxzZXtsZWFmTm9kZS5zZXRSaWdodChub2RlKTt9XG5yZXR1cm4gbm9kZTt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnlOb2RlPWZ1bmN0aW9uKGN1cnJlbnROb2RlLGJvdHRvbU5vZGUscXVlcnlFbnYsb2RkLHJlc3VsdCl7aWYoY3VycmVudE5vZGU9PT1ib3R0b21Ob2RlKXtyZXR1cm47fVxudmFyIG1pbixtYXgsZGlzY3JpbWluYW50O2lmKG9kZCl7bWluPXF1ZXJ5RW52LmdldE1pblgoKTttYXg9cXVlcnlFbnYuZ2V0TWF4WCgpO2Rpc2NyaW1pbmFudD1jdXJyZW50Tm9kZS5nZXRYKCk7fWVsc2V7bWluPXF1ZXJ5RW52LmdldE1pblkoKTttYXg9cXVlcnlFbnYuZ2V0TWF4WSgpO2Rpc2NyaW1pbmFudD1jdXJyZW50Tm9kZS5nZXRZKCk7fVxudmFyIHNlYXJjaExlZnQ9bWluPGRpc2NyaW1pbmFudDt2YXIgc2VhcmNoUmlnaHQ9ZGlzY3JpbWluYW50PD1tYXg7aWYoc2VhcmNoTGVmdCl7dGhpcy5xdWVyeU5vZGUoY3VycmVudE5vZGUuZ2V0TGVmdCgpLGJvdHRvbU5vZGUscXVlcnlFbnYsIW9kZCxyZXN1bHQpO31cbmlmKHF1ZXJ5RW52LmNvbnRhaW5zKGN1cnJlbnROb2RlLmdldENvb3JkaW5hdGUoKSkpe3Jlc3VsdC5hZGQoY3VycmVudE5vZGUpO31cbmlmKHNlYXJjaFJpZ2h0KXt0aGlzLnF1ZXJ5Tm9kZShjdXJyZW50Tm9kZS5nZXRSaWdodCgpLGJvdHRvbU5vZGUscXVlcnlFbnYsIW9kZCxyZXN1bHQpO319O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMucXVlcnlCeUVudmVsb3BlLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5xdWVyeVdpdGhBcnJheS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnlCeUVudmVsb3BlPWZ1bmN0aW9uKHF1ZXJ5RW52KXt2YXIgcmVzdWx0PVtdO3RoaXMucXVlcnlOb2RlKHRoaXMucm9vdCx0aGlzLmxhc3QscXVlcnlFbnYsdHJ1ZSxyZXN1bHQpO3JldHVybiByZXN1bHQ7fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWUucHJvdG90eXBlLnF1ZXJ5V2l0aEFycmF5PWZ1bmN0aW9uKHF1ZXJ5RW52LHJlc3VsdCl7dGhpcy5xdWVyeU5vZGUodGhpcy5yb290LHRoaXMubGFzdCxxdWVyeUVudix0cnVlLHJlc3VsdCk7fTtqc3RzLmdlb20uVHJpYW5nbGU9ZnVuY3Rpb24ocDAscDEscDIpe3RoaXMucDA9cDA7dGhpcy5wMT1wMTt0aGlzLnAyPXAyO307anN0cy5nZW9tLlRyaWFuZ2xlLmlzQWN1dGU9ZnVuY3Rpb24oYSxiLGMpe2lmKCFqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlKGEsYixjKSl7cmV0dXJuIGZhbHNlO31cbmlmKCFqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlKGIsYyxhKSl7cmV0dXJuIGZhbHNlO31cbmlmKCFqc3RzLmFsZ29yaXRobS5BbmdsZS5pc0FjdXRlKGMsYSxiKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLlRyaWFuZ2xlLnBlcnBlbmRpY3VsYXJCaXNlY3Rvcj1mdW5jdGlvbihhLGIpe3ZhciBkeCxkeSxsMSxsMjtkeD1iLngtYS54O2R5PWIueS1hLnk7bDE9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEueCtkeC8yLjAsYS55K2R5LzIuMCwxLjApO2wyPW5ldyBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZShhLngtZHkrZHgvMi4wLGEueStkeCtkeS8yLjAsMS4wKTtyZXR1cm4gbmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGwxLGwyKTt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5jaXJjdW1jZW50cmU9ZnVuY3Rpb24oYSxiLGMpe3ZhciBjeCxjeSxheCxheSxieCxieSxkZW5vbSxudW14LG51bXksY2N4LGNjeTtjeD1jLng7Y3k9Yy55O2F4PWEueC1jeDtheT1hLnktY3k7Yng9Yi54LWN4O2J5PWIueS1jeTtkZW5vbT0yKmpzdHMuZ2VvbS5UcmlhbmdsZS5kZXQoYXgsYXksYngsYnkpO251bXg9anN0cy5nZW9tLlRyaWFuZ2xlLmRldChheSxheCpheCtheSpheSxieSxieCpieCtieSpieSk7bnVteT1qc3RzLmdlb20uVHJpYW5nbGUuZGV0KGF4LGF4KmF4K2F5KmF5LGJ4LGJ4KmJ4K2J5KmJ5KTtjY3g9Y3gtbnVteC9kZW5vbTtjY3k9Y3krbnVteS9kZW5vbTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNjeCxjY3kpO307anN0cy5nZW9tLlRyaWFuZ2xlLmRldD1mdW5jdGlvbihtMDAsbTAxLG0xMCxtMTEpe3JldHVybiBtMDAqbTExLW0wMSptMTA7fTtqc3RzLmdlb20uVHJpYW5nbGUuaW5DZW50cmU9ZnVuY3Rpb24oYSxiLGMpe3ZhciBsZW4wLGxlbjEsbGVuMixjaXJjdW0saW5DZW50cmVYLGluQ2VudHJlWTtsZW4wPWIuZGlzdGFuY2UoYyk7bGVuMT1hLmRpc3RhbmNlKGMpO2xlbjI9YS5kaXN0YW5jZShiKTtjaXJjdW09bGVuMCtsZW4xK2xlbjI7aW5DZW50cmVYPShsZW4wKmEueCtsZW4xKmIueCtsZW4yKmMueCkvY2lyY3VtO2luQ2VudHJlWT0obGVuMCphLnkrbGVuMSpiLnkrbGVuMipjLnkpL2NpcmN1bTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGluQ2VudHJlWCxpbkNlbnRyZVkpO307anN0cy5nZW9tLlRyaWFuZ2xlLmNlbnRyb2lkPWZ1bmN0aW9uKGEsYixjKXt2YXIgeCx5O3g9KGEueCtiLngrYy54KS8zO3k9KGEueStiLnkrYy55KS8zO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5sb25nZXN0U2lkZUxlbmd0aD1mdW5jdGlvbihhLGIsYyl7dmFyIGxlbkFCLGxlbkJDLGxlbkNBLG1heExlbjtsZW5BQj1hLmRpc3RhbmNlKGIpO2xlbkJDPWIuZGlzdGFuY2UoYyk7bGVuQ0E9Yy5kaXN0YW5jZShhKTttYXhMZW49bGVuQUI7aWYobGVuQkM+bWF4TGVuKXttYXhMZW49bGVuQkM7fVxuaWYobGVuQ0E+bWF4TGVuKXttYXhMZW49bGVuQ0E7fVxucmV0dXJuIG1heExlbjt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5hbmdsZUJpc2VjdG9yPWZ1bmN0aW9uKGEsYixjKXt2YXIgbGVuMCxsZW4yLGZyYWMsZHgsZHksc3BsaXRQdDtsZW4wPWIuZGlzdGFuY2UoYSk7bGVuMj1iLmRpc3RhbmNlKGMpO2ZyYWM9bGVuMC8obGVuMCtsZW4yKTtkeD1jLngtYS54O2R5PWMueS1hLnk7c3BsaXRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYS54K2ZyYWMqZHgsYS55K2ZyYWMqZHkpO3JldHVybiBzcGxpdFB0O307anN0cy5nZW9tLlRyaWFuZ2xlLmFyZWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBNYXRoLmFicygoKGMueC1hLngpKihiLnktYS55KS0oYi54LWEueCkqKGMueS1hLnkpKS8yLjApO307anN0cy5nZW9tLlRyaWFuZ2xlLnNpZ25lZEFyZWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybigoYy54LWEueCkqKGIueS1hLnkpLShiLngtYS54KSooYy55LWEueSkpLzIuMDt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5wcm90b3R5cGUuaW5DZW50cmU9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLlRyaWFuZ2xlLmluQ2VudHJlKHRoaXMucDAsdGhpcy5wMSx0aGlzLnAyKTt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5PWZ1bmN0aW9uKHB0cyl7dGhpcy5wdHM9cHRzO3RoaXMuX29yaWVudGF0aW9uPWpzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5Lm9yaWVudGF0aW9uKHB0cyk7fTtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5wcm90b3R5cGUucHRzPW51bGw7anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkucHJvdG90eXBlLl9vcmllbnRhdGlvbj11bmRlZmluZWQ7anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkub3JpZW50YXRpb249ZnVuY3Rpb24ocHRzKXtyZXR1cm4ganN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuaW5jcmVhc2luZ0RpcmVjdGlvbihwdHMpPT09MTt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5LnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24obzEpe3ZhciBvY2E9bzE7dmFyIGNvbXA9anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkuY29tcGFyZU9yaWVudGVkKHRoaXMucHRzLHRoaXMuX29yaWVudGF0aW9uLG9jYS5wdHMsb2NhLl9vcmllbnRhdGlvbik7cmV0dXJuIGNvbXA7fTtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5jb21wYXJlT3JpZW50ZWQ9ZnVuY3Rpb24ocHRzMSxvcmllbnRhdGlvbjEscHRzMixvcmllbnRhdGlvbjIpe3ZhciBkaXIxPW9yaWVudGF0aW9uMT8xOi0xO3ZhciBkaXIyPW9yaWVudGF0aW9uMj8xOi0xO3ZhciBsaW1pdDE9b3JpZW50YXRpb24xP3B0czEubGVuZ3RoOi0xO3ZhciBsaW1pdDI9b3JpZW50YXRpb24yP3B0czIubGVuZ3RoOi0xO3ZhciBpMT1vcmllbnRhdGlvbjE/MDpwdHMxLmxlbmd0aC0xO3ZhciBpMj1vcmllbnRhdGlvbjI/MDpwdHMyLmxlbmd0aC0xO3ZhciBjb21wPTA7d2hpbGUodHJ1ZSl7dmFyIGNvbXBQdD1wdHMxW2kxXS5jb21wYXJlVG8ocHRzMltpMl0pO2lmKGNvbXBQdCE9PTApXG5yZXR1cm4gY29tcFB0O2kxKz1kaXIxO2kyKz1kaXIyO3ZhciBkb25lMT1pMT09PWxpbWl0MTt2YXIgZG9uZTI9aTI9PT1saW1pdDI7aWYoZG9uZTEmJiFkb25lMilcbnJldHVybi0xO2lmKCFkb25lMSYmZG9uZTIpXG5yZXR1cm4gMTtpZihkb25lMSYmZG9uZTIpXG5yZXR1cm4gMDt9fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvcj1mdW5jdGlvbihwMDAscDAxLHAxMCxwMTEpe3RoaXMucHRzPVtwMDAscDAxLHAxMCxwMTFdO3RoaXMuY29tcHV0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJhbEVuZHBvaW50SW50ZXJzZWN0b3IuZ2V0SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKHAwMCxwMDEscDEwLHAxMSl7dmFyIGludG9yPW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3RvcihwMDAscDAxLHAxMCxwMTEpO3JldHVybiBpbnRvci5nZXRJbnRlcnNlY3Rpb24oKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50UHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbigpe3ZhciBjZW50cm9pZD1qc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5hdmVyYWdlKHRoaXMucHRzKTt0aGlzLmludFB0PXRoaXMuZmluZE5lYXJlc3RQb2ludChjZW50cm9pZCx0aGlzLnB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50UHQ7fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5hdmVyYWdlPWZ1bmN0aW9uKHB0cyl7dmFyIGF2Zz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt2YXIgaSxuPXB0cy5sZW5ndGg7Zm9yKGk9MDtpPG47aSsrKXthdmcueCs9cHRzW2ldLng7YXZnLnkrPXB0c1tpXS55O31cbmlmKG4+MCl7YXZnLngvPW47YXZnLnkvPW47fVxucmV0dXJuIGF2Zzt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5maW5kTmVhcmVzdFBvaW50PWZ1bmN0aW9uKHAscHRzKXt2YXIgbWluRGlzdD1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBpLHJlc3VsdD1udWxsLGRpc3Q7Zm9yKGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtkaXN0PXAuZGlzdGFuY2UocHRzW2ldKTtpZihkaXN0PG1pbkRpc3Qpe21pbkRpc3Q9ZGlzdDtyZXN1bHQ9cHRzW2ldO319XG5yZXR1cm4gcmVzdWx0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wPWZ1bmN0aW9uKGcsYnVmUGFyYW1zKXt0aGlzLmFyZ0dlb209Zzt0aGlzLmJ1ZlBhcmFtcz1idWZQYXJhbXM/YnVmUGFyYW1zOm5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLk1BWF9QUkVDSVNJT05fRElHSVRTPTEyO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcmVjaXNpb25TY2FsZUZhY3Rvcj1mdW5jdGlvbihnLGRpc3RhbmNlLG1heFByZWNpc2lvbkRpZ2l0cyl7dmFyIGVudj1nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgZW52U2l6ZT1NYXRoLm1heChlbnYuZ2V0SGVpZ2h0KCksZW52LmdldFdpZHRoKCkpO3ZhciBleHBhbmRCeURpc3RhbmNlPWRpc3RhbmNlPjAuMD9kaXN0YW5jZTowLjA7dmFyIGJ1ZkVudlNpemU9ZW52U2l6ZSsyKmV4cGFuZEJ5RGlzdGFuY2U7dmFyIGJ1ZkVudkxvZzEwPShNYXRoLmxvZyhidWZFbnZTaXplKS9NYXRoLmxvZygxMCkrMS4wKTt2YXIgbWluVW5pdExvZzEwPWJ1ZkVudkxvZzEwLW1heFByZWNpc2lvbkRpZ2l0czt2YXIgc2NhbGVGYWN0b3I9TWF0aC5wb3coMTAuMCwtbWluVW5pdExvZzEwKTtyZXR1cm4gc2NhbGVGYWN0b3I7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3A9ZnVuY3Rpb24oZyxkaXN0YW5jZSl7aWYoYXJndW1lbnRzLmxlbmd0aD4yKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGdCdWY9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcChnKTt2YXIgZ2VvbUJ1Zj1nQnVmLmdldFJlc3VsdEdlb21ldHJ5KGRpc3RhbmNlKTtyZXR1cm4gZ2VvbUJ1Zjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDI9ZnVuY3Rpb24oZyxkaXN0YW5jZSxwYXJhbXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg+Myl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDMuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnZhciBidWZPcD1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wKGcscGFyYW1zKTt2YXIgZ2VvbUJ1Zj1idWZPcC5nZXRSZXN1bHRHZW9tZXRyeShkaXN0YW5jZSk7cmV0dXJuIGdlb21CdWY7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3AzPWZ1bmN0aW9uKGcsZGlzdGFuY2UscXVhZHJhbnRTZWdtZW50cyl7aWYoYXJndW1lbnRzLmxlbmd0aD40KXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wNC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGJ1Zk9wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AoZyk7YnVmT3Auc2V0UXVhZHJhbnRTZWdtZW50cyhxdWFkcmFudFNlZ21lbnRzKTt2YXIgZ2VvbUJ1Zj1idWZPcC5nZXRSZXN1bHRHZW9tZXRyeShkaXN0YW5jZSk7cmV0dXJuIGdlb21CdWY7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3A0PWZ1bmN0aW9uKGcsZGlzdGFuY2UscXVhZHJhbnRTZWdtZW50cyxlbmRDYXBTdHlsZSl7dmFyIGJ1Zk9wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AoZyk7YnVmT3Auc2V0UXVhZHJhbnRTZWdtZW50cyhxdWFkcmFudFNlZ21lbnRzKTtidWZPcC5zZXRFbmRDYXBTdHlsZShlbmRDYXBTdHlsZSk7dmFyIGdlb21CdWY9YnVmT3AuZ2V0UmVzdWx0R2VvbWV0cnkoZGlzdGFuY2UpO3JldHVybiBnZW9tQnVmO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5hcmdHZW9tPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5kaXN0YW5jZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuYnVmUGFyYW1zPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5yZXN1bHRHZW9tZXRyeT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuc2V0RW5kQ2FwU3R5bGU9ZnVuY3Rpb24oZW5kQ2FwU3R5bGUpe3RoaXMuYnVmUGFyYW1zLnNldEVuZENhcFN0eWxlKGVuZENhcFN0eWxlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuc2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbihxdWFkcmFudFNlZ21lbnRzKXt0aGlzLmJ1ZlBhcmFtcy5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbihkaXN0KXt0aGlzLmRpc3RhbmNlPWRpc3Q7dGhpcy5jb21wdXRlR2VvbWV0cnkoKTtyZXR1cm4gdGhpcy5yZXN1bHRHZW9tZXRyeTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuY29tcHV0ZUdlb21ldHJ5PWZ1bmN0aW9uKCl7dGhpcy5idWZmZXJPcmlnaW5hbFByZWNpc2lvbigpO2lmKHRoaXMucmVzdWx0R2VvbWV0cnkhPT1udWxsKXtyZXR1cm47fVxudmFyIGFyZ1BNPXRoaXMuYXJnR2VvbS5nZXRQcmVjaXNpb25Nb2RlbCgpO2lmKGFyZ1BNLmdldFR5cGUoKT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dGhpcy5idWZmZXJGaXhlZFByZWNpc2lvbihhcmdQTSk7fWVsc2V7dGhpcy5idWZmZXJSZWR1Y2VkUHJlY2lzaW9uKCk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5idWZmZXJSZWR1Y2VkUHJlY2lzaW9uPWZ1bmN0aW9uKCl7dmFyIHByZWNEaWdpdHM7dmFyIHNhdmVFeGNlcHRpb249bnVsbDtmb3IocHJlY0RpZ2l0cz1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuTUFYX1BSRUNJU0lPTl9ESUdJVFM7cHJlY0RpZ2l0cz49MDtwcmVjRGlnaXRzLS0pe3RyeXt0aGlzLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb24yKHByZWNEaWdpdHMpO31jYXRjaChleCl7c2F2ZUV4Y2VwdGlvbj1leDt9XG5pZih0aGlzLnJlc3VsdEdlb21ldHJ5IT09bnVsbCl7cmV0dXJuO319XG50aHJvdyBzYXZlRXhjZXB0aW9uO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5idWZmZXJPcmlnaW5hbFByZWNpc2lvbj1mdW5jdGlvbigpe3RyeXt2YXIgYnVmQnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIodGhpcy5idWZQYXJhbXMpO3RoaXMucmVzdWx0R2VvbWV0cnk9YnVmQnVpbGRlci5idWZmZXIodGhpcy5hcmdHZW9tLHRoaXMuZGlzdGFuY2UpO31jYXRjaChlKXt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb24yPWZ1bmN0aW9uKHByZWNpc2lvbkRpZ2l0cyl7dmFyIHNpemVCYXNlZFNjYWxlRmFjdG9yPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcmVjaXNpb25TY2FsZUZhY3Rvcih0aGlzLmFyZ0dlb20sdGhpcy5kaXN0YW5jZSxwcmVjaXNpb25EaWdpdHMpO3ZhciBmaXhlZFBNPW5ldyBqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwoc2l6ZUJhc2VkU2NhbGVGYWN0b3IpO3RoaXMuYnVmZmVyRml4ZWRQcmVjaXNpb24oZml4ZWRQTSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlckZpeGVkUHJlY2lzaW9uPWZ1bmN0aW9uKGZpeGVkUE0pe3ZhciBub2Rlcj1uZXcganN0cy5ub2RpbmcuU2NhbGVkTm9kZXIobmV3IGpzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIobmV3IGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbCgxLjApKSxmaXhlZFBNLmdldFNjYWxlKCkpO3ZhciBidWZCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlcih0aGlzLmJ1ZlBhcmFtcyk7YnVmQnVpbGRlci5zZXRXb3JraW5nUHJlY2lzaW9uTW9kZWwoZml4ZWRQTSk7YnVmQnVpbGRlci5zZXROb2Rlcihub2Rlcik7dGhpcy5yZXN1bHRHZW9tZXRyeT1idWZCdWlsZGVyLmJ1ZmZlcih0aGlzLmFyZ0dlb20sdGhpcy5kaXN0YW5jZSk7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBQb3NpdGlvbj1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaD1mdW5jdGlvbihhcmdJbmRleCxwYXJlbnRHZW9tLGJvdW5kYXJ5Tm9kZVJ1bGUpe2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLmNhbGwodGhpcyk7dGhpcy5saW5lRWRnZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLkhhc2hNYXAoKTt0aGlzLnB0TG9jYXRvcj1uZXcganN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yKCk7dGhpcy5hcmdJbmRleD1hcmdJbmRleDt0aGlzLnBhcmVudEdlb209cGFyZW50R2VvbTt0aGlzLmJvdW5kYXJ5Tm9kZVJ1bGU9Ym91bmRhcnlOb2RlUnVsZXx8anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU7aWYocGFyZW50R2VvbSE9PW51bGwpe3RoaXMuYWRkKHBhcmVudEdlb20pO319O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaCgpO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguY29uc3RydWN0b3I9anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5jcmVhdGVFZGdlU2V0SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguZGV0ZXJtaW5lQm91bmRhcnk9ZnVuY3Rpb24oYm91bmRhcnlOb2RlUnVsZSxib3VuZGFyeUNvdW50KXtyZXR1cm4gYm91bmRhcnlOb2RlUnVsZS5pc0luQm91bmRhcnkoYm91bmRhcnlDb3VudCk/TG9jYXRpb24uQk9VTkRBUlk6TG9jYXRpb24uSU5URVJJT1I7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5wYXJlbnRHZW9tPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUubGluZUVkZ2VNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5ib3VuZGFyeU5vZGVSdWxlPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUudXNlQm91bmRhcnlEZXRlcm1pbmF0aW9uUnVsZT10cnVlO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFyZ0luZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYm91bmRhcnlOb2Rlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmhhc1Rvb0Zld1BvaW50cz1mYWxzZTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5pbnZhbGlkUG9pbnQ9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hcmVhUHRMb2NhdG9yPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUucHRMb2NhdG9yPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZ2V0R2VvbWV0cnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnRHZW9tO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZ2V0Qm91bmRhcnlOb2Rlcz1mdW5jdGlvbigpe2lmKHRoaXMuYm91bmRhcnlOb2Rlcz09PW51bGwpXG50aGlzLmJvdW5kYXJ5Tm9kZXM9dGhpcy5ub2Rlcy5nZXRCb3VuZGFyeU5vZGVzKHRoaXMuYXJnSW5kZXgpO3JldHVybiB0aGlzLmJvdW5kYXJ5Tm9kZXM7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5nZXRCb3VuZGFyeU5vZGVSdWxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYm91bmRhcnlOb2RlUnVsZTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmZpbmRFZGdlPWZ1bmN0aW9uKGxpbmUpe3JldHVybiB0aGlzLmxpbmVFZGdlTWFwLmdldChsaW5lKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNvbXB1dGVTcGxpdEVkZ2VzPWZ1bmN0aW9uKGVkZ2VsaXN0KXtmb3IodmFyIGk9dGhpcy5lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7ZS5laUxpc3QuYWRkU3BsaXRFZGdlcyhlZGdlbGlzdCk7fX1cbmpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnKXtpZihnLmlzRW1wdHkoKSl7cmV0dXJuO31cbmlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKVxudGhpcy51c2VCb3VuZGFyeURldGVybWluYXRpb25SdWxlPWZhbHNlO2lmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMuYWRkUG9seWdvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylcbnRoaXMuYWRkTGluZVN0cmluZyhnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpXG50aGlzLmFkZFBvaW50KGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbilcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2VcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdHZW9tZXRyeSB0eXBlIG5vdCBzdXBwb3J0ZWQuJyk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRDb2xsZWN0aW9uPWZ1bmN0aW9uKGdjKXtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBnPWdjLmdldEdlb21ldHJ5TihpKTt0aGlzLmFkZChnKTt9fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRFZGdlPWZ1bmN0aW9uKGUpe3RoaXMuaW5zZXJ0RWRnZShlKTt2YXIgY29vcmQ9ZS5nZXRDb29yZGluYXRlcygpO3RoaXMuaW5zZXJ0UG9pbnQodGhpcy5hcmdJbmRleCxjb29yZFswXSxMb2NhdGlvbi5CT1VOREFSWSk7dGhpcy5pbnNlcnRQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkW2Nvb3JkLmxlbmd0aC0xXSxMb2NhdGlvbi5CT1VOREFSWSk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRQb2ludD1mdW5jdGlvbihwKXt2YXIgY29vcmQ9cC5nZXRDb29yZGluYXRlKCk7dGhpcy5pbnNlcnRQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkLExvY2F0aW9uLklOVEVSSU9SKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZExpbmVTdHJpbmc9ZnVuY3Rpb24obGluZSl7dmFyIGNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxpbmUuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYoY29vcmQubGVuZ3RoPDIpe3RoaXMuaGFzVG9vRmV3UG9pbnRzPXRydWU7dGhpcy5pbnZhbGlkUG9pbnQ9Y29vcmRzWzBdO3JldHVybjt9XG52YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZShjb29yZCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5hcmdJbmRleCxMb2NhdGlvbi5JTlRFUklPUikpO3RoaXMubGluZUVkZ2VNYXAucHV0KGxpbmUsZSk7dGhpcy5pbnNlcnRFZGdlKGUpO0Fzc2VydC5pc1RydWUoY29vcmQubGVuZ3RoPj0yLCdmb3VuZCBMaW5lU3RyaW5nIHdpdGggc2luZ2xlIHBvaW50Jyk7dGhpcy5pbnNlcnRCb3VuZGFyeVBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbMF0pO3RoaXMuaW5zZXJ0Qm91bmRhcnlQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkW2Nvb3JkLmxlbmd0aC0xXSk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRQb2x5Z29uUmluZz1mdW5jdGlvbihscixjd0xlZnQsY3dSaWdodCl7aWYobHIuaXNFbXB0eSgpKVxucmV0dXJuO3ZhciBjb29yZD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhsci5nZXRDb29yZGluYXRlcygpKTtpZihjb29yZC5sZW5ndGg8NCl7dGhpcy5oYXNUb29GZXdQb2ludHM9dHJ1ZTt0aGlzLmludmFsaWRQb2ludD1jb29yZFswXTtyZXR1cm47fVxudmFyIGxlZnQ9Y3dMZWZ0O3ZhciByaWdodD1jd1JpZ2h0O2lmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhjb29yZCkpe2xlZnQ9Y3dSaWdodDtyaWdodD1jd0xlZnQ7fVxudmFyIGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2UoY29vcmQsbmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKHRoaXMuYXJnSW5kZXgsTG9jYXRpb24uQk9VTkRBUlksbGVmdCxyaWdodCkpO3RoaXMubGluZUVkZ2VNYXAucHV0KGxyLGUpO3RoaXMuaW5zZXJ0RWRnZShlKTt0aGlzLmluc2VydFBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbMF0sTG9jYXRpb24uQk9VTkRBUlkpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkUG9seWdvbj1mdW5jdGlvbihwKXt0aGlzLmFkZFBvbHlnb25SaW5nKHAuZ2V0RXh0ZXJpb3JSaW5nKCksTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uSU5URVJJT1IpO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXAuZ2V0SW50ZXJpb3JSaW5nTihpKTt0aGlzLmFkZFBvbHlnb25SaW5nKGhvbGUsTG9jYXRpb24uSU5URVJJT1IsTG9jYXRpb24uRVhURVJJT1IpO319O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNvbXB1dGVFZGdlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihnLGxpLGluY2x1ZGVQcm9wZXIpe3ZhciBzaT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yKGxpLGluY2x1ZGVQcm9wZXIsdHJ1ZSk7c2kuc2V0Qm91bmRhcnlOb2Rlcyh0aGlzLmdldEJvdW5kYXJ5Tm9kZXMoKSxnLmdldEJvdW5kYXJ5Tm9kZXMoKSk7dmFyIGVzaT10aGlzLmNyZWF0ZUVkZ2VTZXRJbnRlcnNlY3RvcigpO2VzaS5jb21wdXRlSW50ZXJzZWN0aW9ucyh0aGlzLmVkZ2VzLGcuZWRnZXMsc2kpO3JldHVybiBzaTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNvbXB1dGVTZWxmTm9kZXM9ZnVuY3Rpb24obGksY29tcHV0ZVJpbmdTZWxmTm9kZXMpe3ZhciBzaT1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yKGxpLHRydWUsZmFsc2UpO3ZhciBlc2k9dGhpcy5jcmVhdGVFZGdlU2V0SW50ZXJzZWN0b3IoKTtpZighY29tcHV0ZVJpbmdTZWxmTm9kZXMmJih0aGlzLnBhcmVudEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZ3x8dGhpcy5wYXJlbnRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb258fHRoaXMucGFyZW50R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pKXtlc2kuY29tcHV0ZUludGVyc2VjdGlvbnModGhpcy5lZGdlcyxzaSxmYWxzZSk7fWVsc2V7ZXNpLmNvbXB1dGVJbnRlcnNlY3Rpb25zKHRoaXMuZWRnZXMsc2ksdHJ1ZSk7fVxudGhpcy5hZGRTZWxmSW50ZXJzZWN0aW9uTm9kZXModGhpcy5hcmdJbmRleCk7cmV0dXJuIHNpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuaW5zZXJ0UG9pbnQ9ZnVuY3Rpb24oYXJnSW5kZXgsY29vcmQsb25Mb2NhdGlvbil7dmFyIG49dGhpcy5ub2Rlcy5hZGROb2RlKGNvb3JkKTt2YXIgbGJsPW4uZ2V0TGFiZWwoKTtpZihsYmw9PW51bGwpe24ubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKGFyZ0luZGV4LG9uTG9jYXRpb24pO31lbHNlXG5sYmwuc2V0TG9jYXRpb24oYXJnSW5kZXgsb25Mb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5pbnNlcnRCb3VuZGFyeVBvaW50PWZ1bmN0aW9uKGFyZ0luZGV4LGNvb3JkKXt2YXIgbj10aGlzLm5vZGVzLmFkZE5vZGUoY29vcmQpO3ZhciBsYmw9bi5nZXRMYWJlbCgpO3ZhciBib3VuZGFyeUNvdW50PTE7dmFyIGxvYz1Mb2NhdGlvbi5OT05FO2lmKGxibCE9PW51bGwpXG5sb2M9bGJsLmdldExvY2F0aW9uKGFyZ0luZGV4LFBvc2l0aW9uLk9OKTtpZihsb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbmJvdW5kYXJ5Q291bnQrKzt2YXIgbmV3TG9jPWpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGguZGV0ZXJtaW5lQm91bmRhcnkodGhpcy5ib3VuZGFyeU5vZGVSdWxlLGJvdW5kYXJ5Q291bnQpO2xibC5zZXRMb2NhdGlvbihhcmdJbmRleCxuZXdMb2MpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkU2VsZkludGVyc2VjdGlvbk5vZGVzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5lZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dmFyIGVMb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KTtmb3IodmFyIGVpSXQ9ZS5laUxpc3QuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTt0aGlzLmFkZFNlbGZJbnRlcnNlY3Rpb25Ob2RlKGFyZ0luZGV4LGVpLmNvb3JkLGVMb2MpO319fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRTZWxmSW50ZXJzZWN0aW9uTm9kZT1mdW5jdGlvbihhcmdJbmRleCxjb29yZCxsb2Mpe2lmKHRoaXMuaXNCb3VuZGFyeU5vZGUoYXJnSW5kZXgsY29vcmQpKVxucmV0dXJuO2lmKGxvYz09PUxvY2F0aW9uLkJPVU5EQVJZJiZ0aGlzLnVzZUJvdW5kYXJ5RGV0ZXJtaW5hdGlvblJ1bGUpXG50aGlzLmluc2VydEJvdW5kYXJ5UG9pbnQoYXJnSW5kZXgsY29vcmQpO2Vsc2VcbnRoaXMuaW5zZXJ0UG9pbnQoYXJnSW5kZXgsY29vcmQsbG9jKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmdldEludmFsaWRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludmFsaWRQb2ludDt9O30pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmc9ZnVuY3Rpb24oKXt0aGlzLnB0TGlzdD1bXTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5wdExpc3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUubWluaW1pbVZlcnRleERpc3RhbmNlPTAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2V0TWluaW11bVZlcnRleERpc3RhbmNlPWZ1bmN0aW9uKG1pbmltaW1WZXJ0ZXhEaXN0YW5jZSl7dGhpcy5taW5pbWltVmVydGV4RGlzdGFuY2U9bWluaW1pbVZlcnRleERpc3RhbmNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZFB0PWZ1bmN0aW9uKHB0KXt2YXIgYnVmUHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHB0KTt0aGlzLnByZWNpc2lvbk1vZGVsLm1ha2VQcmVjaXNlKGJ1ZlB0KTtpZih0aGlzLmlzUmVkdW5kYW50KGJ1ZlB0KSlcbnJldHVybjt0aGlzLnB0TGlzdC5wdXNoKGJ1ZlB0KTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRQdHM9ZnVuY3Rpb24ocHQsaXNGb3J3YXJkKXtpZihpc0ZvcndhcmQpe2Zvcih2YXIgaT0wO2k8cHQubGVuZ3RoO2krKyl7dGhpcy5hZGRQdChwdFtpXSk7fX1lbHNle2Zvcih2YXIgaT1wdC5sZW5ndGgtMTtpPj0wO2ktLSl7dGhpcy5hZGRQdChwdFtpXSk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5pc1JlZHVuZGFudD1mdW5jdGlvbihwdCl7aWYodGhpcy5wdExpc3QubGVuZ3RoPDEpXG5yZXR1cm4gZmFsc2U7dmFyIGxhc3RQdD10aGlzLnB0TGlzdFt0aGlzLnB0TGlzdC5sZW5ndGgtMV07dmFyIHB0RGlzdD1wdC5kaXN0YW5jZShsYXN0UHQpO2lmKHB0RGlzdDx0aGlzLm1pbmltaW1WZXJ0ZXhEaXN0YW5jZSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5jbG9zZVJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLnB0TGlzdC5sZW5ndGg8MSlcbnJldHVybjt2YXIgc3RhcnRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5wdExpc3RbMF0pO3ZhciBsYXN0UHQ9dGhpcy5wdExpc3RbdGhpcy5wdExpc3QubGVuZ3RoLTFdO3ZhciBsYXN0MlB0PW51bGw7aWYodGhpcy5wdExpc3QubGVuZ3RoPj0yKVxubGFzdDJQdD10aGlzLnB0TGlzdFt0aGlzLnB0TGlzdC5sZW5ndGgtMl07aWYoc3RhcnRQdC5lcXVhbHMobGFzdFB0KSlcbnJldHVybjt0aGlzLnB0TGlzdC5wdXNoKHN0YXJ0UHQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnJldmVyc2U9ZnVuY3Rpb24oKXt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0TGlzdDt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlPWZ1bmN0aW9uKCl7dGhpcy5wdD1bbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCldO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLnB0PW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmRpc3RhbmNlPU5hTjtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuaXNOdWxsPXRydWU7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmluaXRpYWxpemU9ZnVuY3Rpb24ocDAscDEsZGlzdGFuY2Upe2lmKHAwPT09dW5kZWZpbmVkKXt0aGlzLmlzTnVsbD10cnVlO3JldHVybjt9XG50aGlzLnB0WzBdLnNldENvb3JkaW5hdGUocDApO3RoaXMucHRbMV0uc2V0Q29vcmRpbmF0ZShwMSk7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZSE9PXVuZGVmaW5lZD9kaXN0YW5jZTpwMC5kaXN0YW5jZShwMSk7dGhpcy5pc051bGw9ZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuZ2V0RGlzdGFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXN0YW5jZTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oaSl7cmV0dXJuIHRoaXMucHRbaV07fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuc2V0TWF4aW11bT1mdW5jdGlvbihwdERpc3Qpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLnNldE1heGltdW0yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5zZXRNYXhpbXVtKHB0RGlzdC5wdFswXSxwdERpc3QucHRbMV0pO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLnNldE1heGltdW0yPWZ1bmN0aW9uKHAwLHAxKXtpZih0aGlzLmlzTnVsbCl7dGhpcy5pbml0aWFsaXplKHAwLHAxKTtyZXR1cm47fVxudmFyIGRpc3Q9cDAuZGlzdGFuY2UocDEpO2lmKGRpc3Q+dGhpcy5kaXN0YW5jZSlcbnRoaXMuaW5pdGlhbGl6ZShwMCxwMSxkaXN0KTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5zZXRNaW5pbXVtPWZ1bmN0aW9uKHB0RGlzdCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuc2V0TWluaW11bTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG50aGlzLnNldE1pbmltdW0ocHREaXN0LnB0WzBdLHB0RGlzdC5wdFsxXSk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuc2V0TWluaW11bTI9ZnVuY3Rpb24ocDAscDEpe2lmKHRoaXMuaXNOdWxsKXt0aGlzLmluaXRpYWxpemUocDAscDEpO3JldHVybjt9XG52YXIgZGlzdD1wMC5kaXN0YW5jZShwMSk7aWYoZGlzdDx0aGlzLmRpc3RhbmNlKVxudGhpcy5pbml0aWFsaXplKHAwLHAxLGRpc3QpO307KGZ1bmN0aW9uKCl7dmFyIFBvaW50UGFpckRpc3RhbmNlPWpzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlO3ZhciBEaXN0YW5jZVRvUG9pbnQ9anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50O3ZhciBNYXhQb2ludERpc3RhbmNlRmlsdGVyPWZ1bmN0aW9uKGdlb20pe3RoaXMubWF4UHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO3RoaXMubWluUHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO3RoaXMuZXVjbGlkZWFuRGlzdD1uZXcgRGlzdGFuY2VUb1BvaW50KCk7dGhpcy5nZW9tPWdlb207fTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIoKTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5tYXhQdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUubWluUHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmV1Y2xpZGVhbkRpc3Q9bmV3IERpc3RhbmNlVG9Qb2ludCgpO01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmdlb207TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKHB0KXt0aGlzLm1pblB0RGlzdC5pbml0aWFsaXplKCk7RGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZSh0aGlzLmdlb20scHQsdGhpcy5taW5QdERpc3QpO3RoaXMubWF4UHREaXN0LnNldE1heGltdW0odGhpcy5taW5QdERpc3QpO307TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2V0TWF4UG9pbnREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heFB0RGlzdDt9O3ZhciBNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXI9ZnVuY3Rpb24oZ2VvbSxmcmFjdGlvbil7dGhpcy5tYXhQdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5taW5QdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5nZW9tPWdlb207dGhpcy5udW1TdWJTZWdzPU1hdGgucm91bmQoMS4wL2ZyYWN0aW9uKTt9O01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIoKTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm1heFB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm1pblB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmdlb207TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5udW1TdWJTZWdzPTA7TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oc2VxLGluZGV4KXtpZihpbmRleD09MClcbnJldHVybjt2YXIgcDA9c2VxW2luZGV4LTFdO3ZhciBwMT1zZXFbaW5kZXhdO3ZhciBkZWx4PShwMS54LXAwLngpL3RoaXMubnVtU3ViU2Vnczt2YXIgZGVseT0ocDEueS1wMC55KS90aGlzLm51bVN1YlNlZ3M7Zm9yKHZhciBpPTA7aTx0aGlzLm51bVN1YlNlZ3M7aSsrKXt2YXIgeD1wMC54K2kqZGVseDt2YXIgeT1wMC55K2kqZGVseTt2YXIgcHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHgseSk7dGhpcy5taW5QdERpc3QuaW5pdGlhbGl6ZSgpO0Rpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UodGhpcy5nZW9tLHB0LHRoaXMubWluUHREaXN0KTt0aGlzLm1heFB0RGlzdC5zZXRNYXhpbXVtKHRoaXMubWluUHREaXN0KTt9fTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmlzR2VvbWV0cnlDaGFuZ2VkPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmdldE1heFBvaW50RGlzdGFuY2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXhQdERpc3Q7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlPWZ1bmN0aW9uKGcwLGcxKXt0aGlzLmcwPWcwO3RoaXMuZzE9ZzE7dGhpcy5wdERpc3Q9bmV3IGpzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5nMD1udWxsO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmcxPW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUucHREaXN0PW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZGVuc2lmeUZyYWM9MC4wO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UuZGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEsZGVuc2lmeUZyYWMpe3ZhciBkaXN0PW5ldyBqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlKGcwLGcxKTtpZihkZW5zaWZ5RnJhYyE9PXVuZGVmaW5lZClcbmRpc3Quc2V0RGVuc2lmeUZyYWN0aW9uKGRlbnNpZnlGcmFjKTtyZXR1cm4gZGlzdC5kaXN0YW5jZSgpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuc2V0RGVuc2lmeUZyYWN0aW9uPWZ1bmN0aW9uKGRlbnNpZnlGcmFjKXtpZihkZW5zaWZ5RnJhYz4xLjB8fGRlbnNpZnlGcmFjPD0wLjApXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignRnJhY3Rpb24gaXMgbm90IGluIHJhbmdlICgwLjAgLSAxLjBdJyk7dGhpcy5kZW5zaWZ5RnJhYz1kZW5zaWZ5RnJhYzt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKHRoaXMuZzAsdGhpcy5nMSk7cmV0dXJuIHB0RGlzdC5nZXREaXN0YW5jZSgpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUub3JpZW50ZWREaXN0YW5jZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU9yaWVudGVkRGlzdGFuY2UodGhpcy5nMCx0aGlzLmcxLHRoaXMucHREaXN0KTtyZXR1cm4gdGhpcy5wdERpc3QuZ2V0RGlzdGFuY2UoKTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHB0RGlzdC5nZXRDb29yZGluYXRlcygpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbihnMCxnMSl7dGhpcy5jb21wdXRlT3JpZW50ZWREaXN0YW5jZShnMCxnMSx0aGlzLnB0RGlzdCk7dGhpcy5jb21wdXRlT3JpZW50ZWREaXN0YW5jZShnMSxnMCx0aGlzLnB0RGlzdCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5jb21wdXRlT3JpZW50ZWREaXN0YW5jZT1mdW5jdGlvbihkaXNjcmV0ZUdlb20sZ2VvbSxwdERpc3Qpe3ZhciBkaXN0RmlsdGVyPW5ldyBNYXhQb2ludERpc3RhbmNlRmlsdGVyKGdlb20pO2Rpc2NyZXRlR2VvbS5hcHBseShkaXN0RmlsdGVyKTtwdERpc3Quc2V0TWF4aW11bShkaXN0RmlsdGVyLmdldE1heFBvaW50RGlzdGFuY2UoKSk7aWYodGhpcy5kZW5zaWZ5RnJhYz4wKXt2YXIgZnJhY0ZpbHRlcj1uZXcgTWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyKGdlb20sdGhpcy5kZW5zaWZ5RnJhYyk7ZGlzY3JldGVHZW9tLmFwcGx5KGZyYWNGaWx0ZXIpO3B0RGlzdC5zZXRNYXhpbXVtKGZyYWNGaWx0ZXIuZ2V0TWF4UG9pbnREaXN0YW5jZSgpKTt9fTt9KSgpO2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZT1mdW5jdGlvbihnZW9tKXt0aGlzLmlucHV0PW51bGw7dGhpcy5leHRyZW1hbFB0cz1udWxsO3RoaXMuY2VudHJlPW51bGw7dGhpcy5yYWRpdXM9MDt0aGlzLmlucHV0PWdlb207fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldENpcmNsZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO2lmKHRoaXMuY2VudHJlPT09bnVsbCl7cmV0dXJuIHRoaXMuaW5wdXQuZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvbHlnb24obnVsbCxudWxsKTt9XG52YXIgY2VudHJlUG9pbnQ9dGhpcy5pbnB1dC5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQodGhpcy5jZW50cmUpO2lmKHRoaXMucmFkaXVzPT09MCl7cmV0dXJuIGNlbnRyZVBvaW50O31cbnJldHVybiBjZW50cmVQb2ludC5idWZmZXIodGhpcy5yYWRpdXMpO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5nZXRFeHRyZW1hbFBvaW50cz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO3JldHVybiB0aGlzLmV4dHJlbWFsUHRzO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5nZXRDZW50cmU9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGUoKTtyZXR1cm4gdGhpcy5jZW50cmU7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldFJhZGl1cz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO3JldHVybiB0aGlzLnJhZGl1czt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuY29tcHV0ZUNlbnRyZT1mdW5jdGlvbigpe3N3aXRjaCh0aGlzLmV4dHJlbWFsUHRzLmxlbmd0aCl7Y2FzZSAwOnRoaXMuY2VudHJlPW51bGw7YnJlYWs7Y2FzZSAxOnRoaXMuY2VudHJlPXRoaXMuZXh0cmVtYWxQdHNbMF07YnJlYWs7Y2FzZSAyOnRoaXMuY2VudHJlPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgodGhpcy5leHRyZW1hbFB0c1swXS54K3RoaXMuZXh0cmVtYWxQdHNbMV0ueCkvMiwodGhpcy5leHRyZW1hbFB0c1swXS55K3RoaXMuZXh0cmVtYWxQdHNbMV0ueSkvMik7YnJlYWs7Y2FzZSAzOnRoaXMuY2VudHJlPWpzdHMuZ2VvbS5UcmlhbmdsZS5jaXJjdW1jZW50cmUodGhpcy5leHRyZW1hbFB0c1swXSx0aGlzLmV4dHJlbWFsUHRzWzFdLHRoaXMuZXh0cmVtYWxQdHNbMl0pO2JyZWFrO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbigpe2lmKHRoaXMuZXh0cmVtYWxQdHMhPT1udWxsKXtyZXR1cm47fVxudGhpcy5jb21wdXRlQ2lyY2xlUG9pbnRzKCk7dGhpcy5jb21wdXRlQ2VudHJlKCk7aWYodGhpcy5jZW50cmUhPT1udWxsKXt0aGlzLnJhZGl1cz10aGlzLmNlbnRyZS5kaXN0YW5jZSh0aGlzLmV4dHJlbWFsUHRzWzBdKTt9fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmNvbXB1dGVDaXJjbGVQb2ludHM9ZnVuY3Rpb24oKXtpZih0aGlzLmlucHV0LmlzRW1wdHkoKSl7dGhpcy5leHRyZW1hbFB0cz1bXTtyZXR1cm47fVxudmFyIHB0cztpZih0aGlzLmlucHV0LmdldE51bVBvaW50cygpPT09MSl7cHRzPXRoaXMuaW5wdXQuZ2V0Q29vcmRpbmF0ZXMoKTt0aGlzLmV4dHJlbWFsUHRzPVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocHRzWzBdKV07cmV0dXJuO31cbnZhciBjb252ZXhIdWxsPXRoaXMuaW5wdXQuY29udmV4SHVsbCgpO3ZhciBodWxsUHRzPWNvbnZleEh1bGwuZ2V0Q29vcmRpbmF0ZXMoKTtwdHM9aHVsbFB0cztpZihodWxsUHRzWzBdLmVxdWFsczJEKGh1bGxQdHNbaHVsbFB0cy5sZW5ndGgtMV0pKXtwdHM9W107anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAoaHVsbFB0cywwLHB0cywwLGh1bGxQdHMubGVuZ3RoLTEpO31cbmlmKHB0cy5sZW5ndGg8PTIpe3RoaXMuZXh0cmVtYWxQdHM9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAocHRzKTtyZXR1cm47fVxudmFyIFA9anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLmxvd2VzdFBvaW50KHB0cyk7dmFyIFE9anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0TWluQW5nbGVXaXRoWChwdHMsUCk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7dmFyIFI9anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0aE1pbkFuZ2xlV2l0aFNlZ21lbnQocHRzLFAsUSk7aWYoanN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2UoUCxSLFEpKXt0aGlzLmV4dHJlbWFsUHRzPVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUCksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKFEpXTtyZXR1cm47fVxuaWYoanN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2UoUixQLFEpKXtQPVI7Y29udGludWU7fVxuaWYoanN0cy5hbGdvcml0aG0uQW5nbGUuaXNPYnR1c2UoUixRLFApKXtRPVI7Y29udGludWU7fVxudGhpcy5leHRyZW1hbFB0cz1bbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKFApLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShRKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUildO3JldHVybjt9XG50aHJvdyBuZXcgRXJyb3IoXCJMb2dpYyBmYWlsdXJlIGluIE1pbmltdW0gQm91bmRpbmcgQ2lyY2xlIGFsZ29yaXRobSFcIik7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUubG93ZXN0UG9pbnQ9ZnVuY3Rpb24ocHRzKXt2YXIgbWluPXB0c1swXTtmb3IodmFyIGk9MTtpPHB0cy5sZW5ndGg7aSsrKXtpZihwdHNbaV0ueTxtaW4ueSl7bWluPXB0c1tpXTt9fVxucmV0dXJuIG1pbjt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wb2ludFdpdE1pbkFuZ2xlV2l0aFg9ZnVuY3Rpb24ocHRzLFApe3ZhciBtaW5TaW49TnVtYmVyLk1BWF9WQUxVRTt2YXIgbWluQW5nUHQ9bnVsbDtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXt2YXIgcD1wdHNbaV07aWYocD09PVApY29udGludWU7dmFyIGR4PXAueC1QLng7dmFyIGR5PXAueS1QLnk7aWYoZHk8MClkeT0tZHk7dmFyIGxlbj1NYXRoLnNxcnQoZHgqZHgrZHkqZHkpO3ZhciBzaW49ZHkvbGVuO2lmKHNpbjxtaW5TaW4pe21pblNpbj1zaW47bWluQW5nUHQ9cDt9fVxucmV0dXJuIG1pbkFuZ1B0O307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0aE1pbkFuZ2xlV2l0aFNlZ21lbnQ9ZnVuY3Rpb24ocHRzLFAsUSl7dmFyIG1pbkFuZz1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBtaW5BbmdQdD1udWxsO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe3ZhciBwPXB0c1tpXTtpZihwPT09UCljb250aW51ZTtpZihwPT09USljb250aW51ZTt2YXIgYW5nPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2VlbihQLHAsUSk7aWYoYW5nPG1pbkFuZyl7bWluQW5nPWFuZzttaW5BbmdQdD1wO319XG5yZXR1cm4gbWluQW5nUHQ7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlcj1mdW5jdGlvbihub2RlcixzY2FsZUZhY3RvcixvZmZzZXRYLG9mZnNldFkpe3RoaXMub2Zmc2V0WD1vZmZzZXRYP29mZnNldFg6MDt0aGlzLm9mZnNldFk9b2Zmc2V0WT9vZmZzZXRZOjA7dGhpcy5ub2Rlcj1ub2Rlcjt0aGlzLnNjYWxlRmFjdG9yPXNjYWxlRmFjdG9yO3RoaXMuaXNTY2FsZWQ9IXRoaXMuaXNJbnRlZ2VyUHJlY2lzaW9uKCk7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLk5vZGVyKCk7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuU2NhbGVkTm9kZXI7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLm5vZGVyPW51bGw7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLnNjYWxlRmFjdG9yPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUub2Zmc2V0WD11bmRlZmluZWQ7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLm9mZnNldFk9dW5kZWZpbmVkO2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5pc1NjYWxlZD1mYWxzZTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuaXNJbnRlZ2VyUHJlY2lzaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2NhbGVGYWN0b3I9PT0xLjA7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWZ1bmN0aW9uKCl7dmFyIHNwbGl0U1M9dGhpcy5ub2Rlci5nZXROb2RlZFN1YnN0cmluZ3MoKTtpZih0aGlzLmlzU2NhbGVkKVxudGhpcy5yZXNjYWxlKHNwbGl0U1MpO3JldHVybiBzcGxpdFNTO307anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLmNvbXB1dGVOb2Rlcz1mdW5jdGlvbihpbnB1dFNlZ1N0cmluZ3Mpe3ZhciBpbnRTZWdTdHJpbmdzPWlucHV0U2VnU3RyaW5ncztpZih0aGlzLmlzU2NhbGVkKVxuaW50U2VnU3RyaW5ncz10aGlzLnNjYWxlKGlucHV0U2VnU3RyaW5ncyk7dGhpcy5ub2Rlci5jb21wdXRlTm9kZXMoaW50U2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuc2NhbGU9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7aWYoc2VnU3RyaW5ncyBpbnN0YW5jZW9mIEFycmF5KXtyZXR1cm4gdGhpcy5zY2FsZTIoc2VnU3RyaW5ncyk7fVxudmFyIHRyYW5zZm9ybWVkPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7Zm9yKHZhciBpPXNlZ1N0cmluZ3MuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBzcz1pLm5leHQoKTt0cmFuc2Zvcm1lZC5hZGQobmV3IGpzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZyh0aGlzLnNjYWxlKHNzLmdldENvb3JkaW5hdGVzKCkpLHNzLmdldERhdGEoKSkpO31cbnJldHVybiB0cmFuc2Zvcm1lZDt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5zY2FsZTI9ZnVuY3Rpb24ocHRzKXt2YXIgcm91bmRQdHM9W107Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7cm91bmRQdHNbaV09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKE1hdGgucm91bmQoKHB0c1tpXS54LXRoaXMub2Zmc2V0WCkqdGhpcy5zY2FsZUZhY3RvciksTWF0aC5yb3VuZCgocHRzW2ldLnktdGhpcy5vZmZzZXRZKSp0aGlzLnNjYWxlRmFjdG9yKSk7fVxudmFyIHJvdW5kUHRzTm9EdXA9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMucmVtb3ZlUmVwZWF0ZWRQb2ludHMocm91bmRQdHMpO3JldHVybiByb3VuZFB0c05vRHVwO307anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLnJlc2NhbGU9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7aWYoc2VnU3RyaW5ncyBpbnN0YW5jZW9mIEFycmF5KXt0aGlzLnJlc2NhbGUyKHNlZ1N0cmluZ3MpO3JldHVybjt9XG5mb3IodmFyIGk9c2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIHNzPWkubmV4dCgpO3RoaXMucmVzY2FsZShzcy5nZXRDb29yZGluYXRlcygpKTt9fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUucmVzY2FsZTI9ZnVuY3Rpb24ocHRzKXtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtwdHNbaV0ueD1wdHNbaV0ueC90aGlzLnNjYWxlRmFjdG9yK3RoaXMub2Zmc2V0WDtwdHNbaV0ueT1wdHNbaV0ueS90aGlzLnNjYWxlRmFjdG9yK3RoaXMub2Zmc2V0WTt9fTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yPWZ1bmN0aW9uKGxpLGluY2x1ZGVQcm9wZXIscmVjb3JkSXNvbGF0ZWQpe3RoaXMubGk9bGk7dGhpcy5pbmNsdWRlUHJvcGVyPWluY2x1ZGVQcm9wZXI7dGhpcy5yZWNvcmRJc29sYXRlZD1yZWNvcmRJc29sYXRlZDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5pc0FkamFjZW50U2VnbWVudHM9ZnVuY3Rpb24oaTEsaTIpe3JldHVybiBNYXRoLmFicyhpMS1pMik9PT0xO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5faGFzSW50ZXJzZWN0aW9uPWZhbHNlO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzUHJvcGVyPWZhbHNlO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3I9ZmFsc2U7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5wcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUubGk9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmluY2x1ZGVQcm9wZXI9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnJlY29yZElzb2xhdGVkPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5pc1NlbGZJbnRlcnNlY3Rpb249bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLm51bUludGVyc2VjdGlvbnM9MDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLm51bVRlc3RzPTA7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5iZHlOb2Rlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuc2V0Qm91bmRhcnlOb2Rlcz1mdW5jdGlvbihiZHlOb2RlczAsYmR5Tm9kZXMxKXt0aGlzLmJkeU5vZGVzPVtdO3RoaXMuYmR5Tm9kZXNbMF09YmR5Tm9kZXMwO3RoaXMuYmR5Tm9kZXNbMV09YmR5Tm9kZXMxO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRQcm9wZXJJbnRlcnNlY3Rpb25Qb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BlckludGVyc2VjdGlvblBvaW50O307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faGFzSW50ZXJzZWN0aW9uO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmhhc1Byb3BlckludGVyaW9ySW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGFzUHJvcGVySW50ZXJpb3I7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmlzVHJpdmlhbEludGVyc2VjdGlvbj1mdW5jdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKXtpZihlMD09PWUxKXtpZih0aGlzLmxpLmdldEludGVyc2VjdGlvbk51bSgpPT09MSl7aWYoanN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLmlzQWRqYWNlbnRTZWdtZW50cyhzZWdJbmRleDAsc2VnSW5kZXgxKSlcbnJldHVybiB0cnVlO2lmKGUwLmlzQ2xvc2VkKCkpe3ZhciBtYXhTZWdJbmRleD1lMC5nZXROdW1Qb2ludHMoKS0xO2lmKChzZWdJbmRleDA9PT0wJiZzZWdJbmRleDE9PT1tYXhTZWdJbmRleCl8fChzZWdJbmRleDE9PT0wJiZzZWdJbmRleDA9PT1tYXhTZWdJbmRleCkpe3JldHVybiB0cnVlO319fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKXtpZihlMD09PWUxJiZzZWdJbmRleDA9PT1zZWdJbmRleDEpXG5yZXR1cm47dGhpcy5udW1UZXN0cysrO3ZhciBwMDA9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDBdO3ZhciBwMDE9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDArMV07dmFyIHAxMD1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MV07dmFyIHAxMT1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MSsxXTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAwLHAwMSxwMTAscDExKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXtpZih0aGlzLnJlY29yZElzb2xhdGVkKXtlMC5zZXRJc29sYXRlZChmYWxzZSk7ZTEuc2V0SXNvbGF0ZWQoZmFsc2UpO31cbnRoaXMubnVtSW50ZXJzZWN0aW9ucysrO2lmKCF0aGlzLmlzVHJpdmlhbEludGVyc2VjdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKSl7dGhpcy5faGFzSW50ZXJzZWN0aW9uPXRydWU7aWYodGhpcy5pbmNsdWRlUHJvcGVyfHwhdGhpcy5saS5pc1Byb3BlcigpKXtlMC5hZGRJbnRlcnNlY3Rpb25zKHRoaXMubGksc2VnSW5kZXgwLDApO2UxLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDEsMSk7fVxuaWYodGhpcy5saS5pc1Byb3BlcigpKXt0aGlzLnByb3BlckludGVyc2VjdGlvblBvaW50PXRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uKDApLmNsb25lKCk7dGhpcy5oYXNQcm9wZXI9dHJ1ZTtpZighdGhpcy5pc0JvdW5kYXJ5UG9pbnQodGhpcy5saSx0aGlzLmJkeU5vZGVzKSlcbnRoaXMuaGFzUHJvcGVySW50ZXJpb3I9dHJ1ZTt9fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNCb3VuZGFyeVBvaW50PWZ1bmN0aW9uKGxpLGJkeU5vZGVzKXtpZihiZHlOb2Rlcz09PW51bGwpXG5yZXR1cm4gZmFsc2U7aWYoYmR5Tm9kZXMgaW5zdGFuY2VvZiBBcnJheSl7aWYodGhpcy5pc0JvdW5kYXJ5UG9pbnQobGksYmR5Tm9kZXNbMF0pKVxucmV0dXJuIHRydWU7aWYodGhpcy5pc0JvdW5kYXJ5UG9pbnQobGksYmR5Tm9kZXNbMV0pKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO31lbHNle2Zvcih2YXIgaT1iZHlOb2Rlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIG5vZGU9aS5uZXh0KCk7dmFyIHB0PW5vZGUuZ2V0Q29vcmRpbmF0ZSgpO2lmKGxpLmlzSW50ZXJzZWN0aW9uKHB0KSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9fTt9KSgpOyIsIi8qXG4gIGphdmFzY3JpcHQudXRpbCBpcyBhIHBvcnQgb2Ygc2VsZWN0ZWQgcGFydHMgb2YgamF2YS51dGlsIHRvIEphdmFTY3JpcHQgd2hpY2hcbiAgbWFpbiBwdXJwb3NlIGlzIHRvIGVhc2UgcG9ydGluZyBKYXZhIGNvZGUgdG8gSmF2YVNjcmlwdC5cbiAgXG4gIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG4gIENvcHlyaWdodCAoQykgMjAxMS0yMDE0IGJ5IFRoZSBBdXRob3JzXG5cbiAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIFRIRSBTT0ZUV0FSRS5cbiovXG47KGZ1bmN0aW9uKCl7dmFyIGU9dGhpcztmdW5jdGlvbiBmKGEsYil7dmFyIGM9YS5zcGxpdChcIi5cIiksZD1lO2NbMF1pbiBkfHwhZC5leGVjU2NyaXB0fHxkLmV4ZWNTY3JpcHQoXCJ2YXIgXCIrY1swXSk7Zm9yKHZhciB0O2MubGVuZ3RoJiYodD1jLnNoaWZ0KCkpOyljLmxlbmd0aHx8dm9pZCAwPT09Yj9kPWRbdF0/ZFt0XTpkW3RdPXt9OmRbdF09Yn1mdW5jdGlvbiBnKGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLnE9Yi5wcm90b3R5cGU7YS5wcm90b3R5cGU9bmV3IGM7YS5wcm90b3R5cGUuY29uc3RydWN0b3I9YTthLnA9ZnVuY3Rpb24oYSxjLE8pe3ZhciBNPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gYi5wcm90b3R5cGVbY10uYXBwbHkoYSxNKX19O2Z1bmN0aW9uIGgoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhoLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb25cIixoKTtoLnByb3RvdHlwZS5uYW1lPVwiRW1wdHlTdGFja0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGsoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhrLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25cIixrKTtrLnByb3RvdHlwZS5uYW1lPVwiSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGwoKXt9ZihcImphdmFzY3JpcHQudXRpbC5JdGVyYXRvclwiLGwpO2wucHJvdG90eXBlLmhhc05leHQ9bC5wcm90b3R5cGUuYztsLnByb3RvdHlwZS5uZXh0PWwucHJvdG90eXBlLm5leHQ7bC5wcm90b3R5cGUucmVtb3ZlPWwucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBtKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQ29sbGVjdGlvblwiLG0pO2Z1bmN0aW9uIG4oKXt9ZyhuLG0pO2YoXCJqYXZhc2NyaXB0LnV0aWwuTGlzdFwiLG4pO2Z1bmN0aW9uIHAoKXt9ZihcImphdmFzY3JpcHQudXRpbC5NYXBcIixwKTtmdW5jdGlvbiBxKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocSxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uXCIscSk7cS5wcm90b3R5cGUubmFtZT1cIk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIjtmdW5jdGlvbiByKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocixFcnJvcik7ci5wcm90b3R5cGUubmFtZT1cIk9wZXJhdGlvbk5vdFN1cHBvcnRlZFwiO2Z1bmN0aW9uIHMoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhzLG4pO2YoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0XCIscyk7cy5wcm90b3R5cGUuYT1udWxsO3MucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkPXMucHJvdG90eXBlLmFkZDtzLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3MucHJvdG90eXBlLmFkZEFsbD1zLnByb3RvdHlwZS5lO3MucHJvdG90eXBlLnNldD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYVthXTt0aGlzLmFbYV09YjtyZXR1cm4gY307cy5wcm90b3R5cGUuc2V0PXMucHJvdG90eXBlLnNldDtzLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB1KHRoaXMpfTtzLnByb3RvdHlwZS5pdGVyYXRvcj1zLnByb3RvdHlwZS5mO1xucy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2lmKDA+YXx8YT49dGhpcy5zaXplKCkpdGhyb3cgbmV3IGs7cmV0dXJuIHRoaXMuYVthXX07cy5wcm90b3R5cGUuZ2V0PXMucHJvdG90eXBlLmdldDtzLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5pc0VtcHR5PXMucHJvdG90eXBlLmc7cy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5zaXplPXMucHJvdG90eXBlLnNpemU7cy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O3MucHJvdG90eXBlLnRvQXJyYXk9cy5wcm90b3R5cGUuaDtcbnMucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihhKXtmb3IodmFyIGI9ITEsYz0wLGQ9dGhpcy5hLmxlbmd0aDtjPGQ7YysrKWlmKHRoaXMuYVtjXT09PWEpe3RoaXMuYS5zcGxpY2UoYywxKTtiPSEwO2JyZWFrfXJldHVybiBifTtzLnByb3RvdHlwZS5yZW1vdmU9cy5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIHUoYSl7dGhpcy5qPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfXCIsdSk7dS5wcm90b3R5cGUuaj1udWxsO3UucHJvdG90eXBlLmI9MDt1LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5qLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5qLmdldCh0aGlzLmIrKyl9O3UucHJvdG90eXBlLm5leHQ9dS5wcm90b3R5cGUubmV4dDt1LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmouc2l6ZSgpPyEwOiExfTt1LnByb3RvdHlwZS5oYXNOZXh0PXUucHJvdG90eXBlLmM7XG51LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3UucHJvdG90eXBlLnJlbW92ZT11LnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdigpe31mKFwiamF2YXNjcmlwdC51dGlsLkFycmF5c1wiLHYpO1xudi5zb3J0PWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdLGIsYyxkO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWEuc29ydCgpO2Vsc2UgaWYoMj09PWFyZ3VtZW50cy5sZW5ndGgpYz1hcmd1bWVudHNbMV0sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYS5zb3J0KGQpO2Vsc2UgaWYoMz09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxiLnNvcnQoKSxkPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKTtlbHNlIGlmKDQ9PT1hcmd1bWVudHMubGVuZ3RoKWZvcihiPWEuc2xpY2UoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSksYz1hcmd1bWVudHNbM10sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYi5zb3J0KGQpLFxuZD1hLnNsaWNlKDAsYXJndW1lbnRzWzFdKS5jb25jYXQoYixhLnNsaWNlKGFyZ3VtZW50c1syXSxhLmxlbmd0aCkpLGEuc3BsaWNlKDAsYS5sZW5ndGgpLGI9MDtiPGQubGVuZ3RoO2IrKylhLnB1c2goZFtiXSl9O3YuYXNMaXN0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1uZXcgcyxjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKWIuYWRkKGFbY10pO3JldHVybiBifTtmdW5jdGlvbiB3KCl7dGhpcy5pPXt9fWcodyxwKTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hNYXBcIix3KTt3LnByb3RvdHlwZS5pPW51bGw7dy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmlbYV18fG51bGx9O3cucHJvdG90eXBlLmdldD13LnByb3RvdHlwZS5nZXQ7dy5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaVthXT1ifTt3LnByb3RvdHlwZS5wdXQ9dy5wcm90b3R5cGUucHV0O3cucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2ZvcihiIGluIHRoaXMuaSl0aGlzLmkuaGFzT3duUHJvcGVydHkoYikmJmEuYWRkKHRoaXMuaVtiXSk7cmV0dXJuIGF9O3cucHJvdG90eXBlLnZhbHVlcz13LnByb3RvdHlwZS5tO3cucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tKCkuc2l6ZSgpfTt3LnByb3RvdHlwZS5zaXplPXcucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24geCgpe31nKHgsbSk7ZihcImphdmFzY3JpcHQudXRpbC5TZXRcIix4KTtmdW5jdGlvbiB5KGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcoeSx4KTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hTZXRcIix5KTt5LnByb3RvdHlwZS5hPW51bGw7eS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYodGhpcy5hW2JdPT09YSlyZXR1cm4hMDtyZXR1cm4hMX07eS5wcm90b3R5cGUuY29udGFpbnM9eS5wcm90b3R5cGUuY29udGFpbnM7eS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZD15LnByb3RvdHlwZS5hZGQ7eS5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTt5LnByb3RvdHlwZS5hZGRBbGw9eS5wcm90b3R5cGUuZTtcbnkucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307eS5wcm90b3R5cGUucmVtb3ZlPXkucHJvdG90eXBlLnJlbW92ZTt5LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmlzRW1wdHk9eS5wcm90b3R5cGUuZzt5LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07eS5wcm90b3R5cGUudG9BcnJheT15LnByb3RvdHlwZS5oO3kucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHoodGhpcyl9O3kucHJvdG90eXBlLml0ZXJhdG9yPXkucHJvdG90eXBlLmY7ZnVuY3Rpb24geihhKXt0aGlzLms9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMVwiLHopO3oucHJvdG90eXBlLms9bnVsbDtcbnoucHJvdG90eXBlLmI9MDt6LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5rLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5rLmFbdGhpcy5iKytdfTt6LnByb3RvdHlwZS5uZXh0PXoucHJvdG90eXBlLm5leHQ7ei5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5rLnNpemUoKT8hMDohMX07ei5wcm90b3R5cGUuaGFzTmV4dD16LnByb3RvdHlwZS5jO3oucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307ei5wcm90b3R5cGUucmVtb3ZlPXoucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBBKCl7fWcoQSxwKTtmKFwiamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcFwiLEEpO2Z1bmN0aW9uIEIoKXt9ZyhCLHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0XCIsQik7ZnVuY3Rpb24gQygpe3RoaXMuYT1bXX1nKEMsbik7ZihcImphdmFzY3JpcHQudXRpbC5TdGFja1wiLEMpO0MucHJvdG90eXBlLmE9bnVsbDtDLnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiBhfTtDLnByb3RvdHlwZS5wdXNoPUMucHJvdG90eXBlLnB1c2g7Qy5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYS5wb3AoKX07Qy5wcm90b3R5cGUucG9wPUMucHJvdG90eXBlLnBvcDtDLnByb3RvdHlwZS5vPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYVt0aGlzLmEubGVuZ3RoLTFdfTtDLnByb3RvdHlwZS5wZWVrPUMucHJvdG90eXBlLm87Qy5wcm90b3R5cGUuZW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGg/ITA6ITF9O0MucHJvdG90eXBlLmVtcHR5PUMucHJvdG90eXBlLmVtcHR5O1xuQy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVtcHR5KCl9O0MucHJvdG90eXBlLmlzRW1wdHk9Qy5wcm90b3R5cGUuZztDLnByb3RvdHlwZS5zZWFyY2g9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYS5pbmRleE9mKGEpfTtDLnByb3RvdHlwZS5zZWFyY2g9Qy5wcm90b3R5cGUuc2VhcmNoO0MucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07Qy5wcm90b3R5cGUuc2l6ZT1DLnByb3RvdHlwZS5zaXplO0MucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtDLnByb3RvdHlwZS50b0FycmF5PUMucHJvdG90eXBlLmg7ZnVuY3Rpb24gRChhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEucGFyZW50fWZ1bmN0aW9uIEUoYSxiKXtudWxsIT09YSYmKGEuY29sb3I9Yil9ZnVuY3Rpb24gRihhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEubGVmdH1mdW5jdGlvbiBHKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5yaWdodH1mdW5jdGlvbiBIKCl7dGhpcy5kPW51bGw7dGhpcy5uPTB9ZyhILEEpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcFwiLEgpO0gucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5kO251bGwhPT1iOyl7dmFyIGM9YS5jb21wYXJlVG8oYi5rZXkpO2lmKDA+YyliPWIubGVmdDtlbHNlIGlmKDA8YyliPWIucmlnaHQ7ZWxzZSByZXR1cm4gYi52YWx1ZX1yZXR1cm4gbnVsbH07SC5wcm90b3R5cGUuZ2V0PUgucHJvdG90eXBlLmdldDtcbkgucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhLGIpe2lmKG51bGw9PT10aGlzLmQpcmV0dXJuIHRoaXMuZD17a2V5OmEsdmFsdWU6YixsZWZ0Om51bGwscmlnaHQ6bnVsbCxwYXJlbnQ6bnVsbCxjb2xvcjowfSx0aGlzLm49MSxudWxsO3ZhciBjPXRoaXMuZCxkLHQ7ZG8gaWYoZD1jLHQ9YS5jb21wYXJlVG8oYy5rZXkpLDA+dCljPWMubGVmdDtlbHNlIGlmKDA8dCljPWMucmlnaHQ7ZWxzZSByZXR1cm4gZD1jLnZhbHVlLGMudmFsdWU9YixkO3doaWxlKG51bGwhPT1jKTtjPXtrZXk6YSxsZWZ0Om51bGwscmlnaHQ6bnVsbCx2YWx1ZTpiLHBhcmVudDpkLGNvbG9yOjB9OzA+dD9kLmxlZnQ9YzpkLnJpZ2h0PWM7Zm9yKGMuY29sb3I9MTtudWxsIT1jJiZjIT10aGlzLmQmJjE9PWMucGFyZW50LmNvbG9yOylEKGMpPT1GKEQoRChjKSkpPyhkPUcoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RyhEKGMpKSYmXG4oYz1EKGMpLEkodGhpcyxjKSksRShEKGMpLDApLEUoRChEKGMpKSwxKSxKKHRoaXMsRChEKGMpKSkpKTooZD1GKEQoRChjKSkpLDE9PShudWxsPT1kPzA6ZC5jb2xvcik/KEUoRChjKSwwKSxFKGQsMCksRShEKEQoYykpLDEpLGM9RChEKGMpKSk6KGM9PUYoRChjKSkmJihjPUQoYyksSih0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEkodGhpcyxEKEQoYykpKSkpO3RoaXMuZC5jb2xvcj0wO3RoaXMubisrO3JldHVybiBudWxsfTtILnByb3RvdHlwZS5wdXQ9SC5wcm90b3R5cGUucHV0O0gucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2I9dGhpcy5kO2lmKG51bGwhPWIpZm9yKDtudWxsIT1iLmxlZnQ7KWI9Yi5sZWZ0O2lmKG51bGwhPT1iKWZvcihhLmFkZChiLnZhbHVlKTtudWxsIT09KGI9SyhiKSk7KWEuYWRkKGIudmFsdWUpO3JldHVybiBhfTtILnByb3RvdHlwZS52YWx1ZXM9SC5wcm90b3R5cGUubTtcbmZ1bmN0aW9uIEkoYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLnJpZ2h0O2IucmlnaHQ9Yy5sZWZ0O251bGwhPWMubGVmdCYmKGMubGVmdC5wYXJlbnQ9Yik7Yy5wYXJlbnQ9Yi5wYXJlbnQ7bnVsbD09Yi5wYXJlbnQ/YS5kPWM6Yi5wYXJlbnQubGVmdD09Yj9iLnBhcmVudC5sZWZ0PWM6Yi5wYXJlbnQucmlnaHQ9YztjLmxlZnQ9YjtiLnBhcmVudD1jfX1mdW5jdGlvbiBKKGEsYil7aWYobnVsbCE9Yil7dmFyIGM9Yi5sZWZ0O2IubGVmdD1jLnJpZ2h0O251bGwhPWMucmlnaHQmJihjLnJpZ2h0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5yaWdodD09Yj9iLnBhcmVudC5yaWdodD1jOmIucGFyZW50LmxlZnQ9YztjLnJpZ2h0PWI7Yi5wYXJlbnQ9Y319XG5mdW5jdGlvbiBLKGEpe2lmKG51bGw9PT1hKXJldHVybiBudWxsO2lmKG51bGwhPT1hLnJpZ2h0KWZvcih2YXIgYj1hLnJpZ2h0O251bGwhPT1iLmxlZnQ7KWI9Yi5sZWZ0O2Vsc2UgZm9yKGI9YS5wYXJlbnQ7bnVsbCE9PWImJmE9PT1iLnJpZ2h0OylhPWIsYj1iLnBhcmVudDtyZXR1cm4gYn1ILnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubn07SC5wcm90b3R5cGUuc2l6ZT1ILnByb3RvdHlwZS5zaXplO2Z1bmN0aW9uIEwoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhMLEIpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZVNldFwiLEwpO0wucHJvdG90eXBlLmE9bnVsbDtMLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigwPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4hMDtyZXR1cm4hMX07TC5wcm90b3R5cGUuY29udGFpbnM9TC5wcm90b3R5cGUuY29udGFpbnM7TC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYoMT09PXRoaXMuYVtiXS5jb21wYXJlVG8oYSkpcmV0dXJuIHRoaXMuYS5zcGxpY2UoYiwwLGEpLCEwO3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGQ9TC5wcm90b3R5cGUuYWRkO1xuTC5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGRBbGw9TC5wcm90b3R5cGUuZTtMLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O0wucHJvdG90eXBlLnJlbW92ZT1MLnByb3RvdHlwZS5yZW1vdmU7TC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5zaXplPUwucHJvdG90eXBlLnNpemU7TC5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07TC5wcm90b3R5cGUuaXNFbXB0eT1MLnByb3RvdHlwZS5nO0wucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtMLnByb3RvdHlwZS50b0FycmF5PUwucHJvdG90eXBlLmg7TC5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgTih0aGlzKX07XG5MLnByb3RvdHlwZS5pdGVyYXRvcj1MLnByb3RvdHlwZS5mO2Z1bmN0aW9uIE4oYSl7dGhpcy5sPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfJDJcIixOKTtOLnByb3RvdHlwZS5sPW51bGw7Ti5wcm90b3R5cGUuYj0wO04ucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmwuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmwuYVt0aGlzLmIrK119O04ucHJvdG90eXBlLm5leHQ9Ti5wcm90b3R5cGUubmV4dDtOLnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmwuc2l6ZSgpPyEwOiExfTtOLnByb3RvdHlwZS5oYXNOZXh0PU4ucHJvdG90eXBlLmM7Ti5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTtOLnByb3RvdHlwZS5yZW1vdmU9Ti5wcm90b3R5cGUucmVtb3ZlO1widW5kZWZpbmVkXCIhPT10eXBlb2YgZ2xvYmFsJiYoZ2xvYmFsLmphdmFzY3JpcHQ9e30sZ2xvYmFsLmphdmFzY3JpcHQudXRpbD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdD1zLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlzPXYsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uPW0sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5FbXB0eVN0YWNrRXhjZXB0aW9uPWgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoTWFwPXcsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoU2V0PXksZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JbmRleE91dE9mQm91bmRzRXhjZXB0aW9uPWssZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JdGVyYXRvcj1sLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTGlzdD1uLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTWFwPXAsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uPXEsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5PcGVyYXRpb25Ob3RTdXBwb3J0ZWQ9XG5yLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU2V0PXgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Tb3J0ZWRNYXA9QSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZFNldD1CLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU3RhY2s9QyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVNYXA9SCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVTZXQ9TCk7fSkuY2FsbCh0aGlzKTtcbiIsInJlcXVpcmUoJy4vZGlzdC9qYXZhc2NyaXB0LnV0aWwtbm9kZS5taW4uanMnKTtcbiIsInZhciBleHRlbnQgPSByZXF1aXJlKCd0dXJmLWV4dGVudCcpLFxuICAgIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiBhbnkgdHlwZSBhbmQgcmV0dXJucyB0aGUgYWJzb2x1dGUgY2VudGVyIHBvaW50IG9mIGFsbCBmZWF0dXJlcy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvY2VudGVyXG4gKiBAY2F0ZWdvcnkgbWVhc3VyZW1lbnRcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IGZlYXR1cmVzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgYW55IHR5cGVcbiAqIEByZXR1cm4ge1BvaW50fSBhIFBvaW50IGZlYXR1cmUgYXQgdGhlXG4gKiBhYnNvbHV0ZSBjZW50ZXIgcG9pbnQgb2YgYWxsIGlucHV0IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGZlYXR1cmVzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUyMjI1OSwgMzUuNDY5MV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUwMjc1NCwgMzUuNDYzNDU1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTA4MjY5LCAzNS40NjMyNDVdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny41MTY4MDksIDM1LjQ2NTc3OV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUxNTM3MiwgMzUuNDY3MDcyXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTA5MzYzLCAzNS40NjMwNTNdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny41MTExMjMsIDM1LjQ2NjYwMV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUxODU0NywgMzUuNDY5MzI3XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTE5NzA2LCAzNS40Njk2NTldXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny41MTc4MzksIDM1LjQ2Njk5OF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUwODY3OCwgMzUuNDY0OTQyXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTE0OTE0LCAzNS40NjM0NTNdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBjZW50ZXJQdCA9IHR1cmYuY2VudGVyKGZlYXR1cmVzKTtcbiAqIGNlbnRlclB0LnByb3BlcnRpZXNbJ21hcmtlci1zaXplJ10gPSAnbGFyZ2UnO1xuICogY2VudGVyUHQucHJvcGVydGllc1snbWFya2VyLWNvbG9yJ10gPSAnIzAwMCc7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gZmVhdHVyZXMuZmVhdHVyZXMuY29uY2F0KGNlbnRlclB0KTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihsYXllciwgZG9uZSl7XG4gIHZhciBleHQgPSBleHRlbnQobGF5ZXIpO1xuICB2YXIgeCA9IChleHRbMF0gKyBleHRbMl0pLzI7XG4gIHZhciB5ID0gKGV4dFsxXSArIGV4dFszXSkvMjtcbiAgcmV0dXJuIHBvaW50KFt4LCB5XSk7XG59O1xuIiwidmFyIGVhY2ggPSByZXF1aXJlKCd0dXJmLW1ldGEnKS5jb29yZEVhY2g7XG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZX0gb3Ige0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiBhbnkgdHlwZSBhbmQgY2FsY3VsYXRlcyB0aGUgY2VudHJvaWQgdXNpbmcgdGhlIGFyaXRobWV0aWMgbWVhbiBvZiBhbGwgdmVydGljZXMuXG4gKiBUaGlzIGxlc3NlbnMgdGhlIGVmZmVjdCBvZiBzbWFsbCBpc2xhbmRzIGFuZCBhcnRpZmFjdHMgd2hlbiBjYWxjdWxhdGluZ1xuICogdGhlIGNlbnRyb2lkIG9mIGEgc2V0IG9mIHBvbHlnb25zLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9jZW50cm9pZFxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0dlb0pTT059IGZlYXR1cmVzIGEge0BsaW5rIEZlYXR1cmV9IG9yIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4gKiBAcmV0dXJuIHtQb2ludH0gYSBQb2ludCBmZWF0dXJlIGF0IHRoZSBjZW50cm9pZCBvZiB0aGUgaW5wdXQgZmVhdHVyZShzKVxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFsxMDUuODE4OTM5LDIxLjAwNDcxNF0sXG4gKiAgICAgICBbMTA1LjgxODkzOSwyMS4wNjE3NTRdLFxuICogICAgICAgWzEwNS44OTAwMDcsMjEuMDYxNzU0XSxcbiAqICAgICAgIFsxMDUuODkwMDA3LDIxLjAwNDcxNF0sXG4gKiAgICAgICBbMTA1LjgxODkzOSwyMS4wMDQ3MTRdXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgY2VudHJvaWRQdCA9IHR1cmYuY2VudHJvaWQocG9seSk7XG4gKlxuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbcG9seSwgY2VudHJvaWRQdF1cbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmVhdHVyZXMpe1xuICB2YXIgeFN1bSA9IDAsIHlTdW0gPSAwLCBsZW4gPSAwO1xuICBlYWNoKGZlYXR1cmVzLCBmdW5jdGlvbihjb29yZCkge1xuICAgIHhTdW0gKz0gY29vcmRbMF07XG4gICAgeVN1bSArPSBjb29yZFsxXTtcbiAgICBsZW4rKztcbiAgfSwgdHJ1ZSk7XG4gIHJldHVybiBwb2ludChbeFN1bSAvIGxlbiwgeVN1bSAvIGxlbl0pO1xufTtcbiIsIi8qKlxuICogTGF6aWx5IGl0ZXJhdGUgb3ZlciBjb29yZGluYXRlcyBpbiBhbnkgR2VvSlNPTiBvYmplY3QsIHNpbWlsYXIgdG9cbiAqIEFycmF5LmZvckVhY2guXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGxheWVyIGFueSBHZW9KU09OIG9iamVjdFxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgYSBtZXRob2QgdGhhdCB0YWtlcyAodmFsdWUpXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBleGNsdWRlV3JhcENvb3JkIHdoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGVcbiAqIHRoZSBmaW5hbCBjb29yZGluYXRlIG9mIExpbmVhclJpbmdzIHRoYXQgd3JhcHMgdGhlIHJpbmcgaW4gaXRzIGl0ZXJhdGlvbi5cbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnQgPSB7IHR5cGU6ICdQb2ludCcsIGNvb3JkaW5hdGVzOiBbMCwgMF0gfTtcbiAqIGNvb3JkRWFjaChwb2ludCwgZnVuY3Rpb24oY29vcmRzKSB7XG4gKiAgIC8vIGNvb3JkcyBpcyBlcXVhbCB0byBbMCwgMF1cbiAqIH0pO1xuICovXG5mdW5jdGlvbiBjb29yZEVhY2gobGF5ZXIsIGNhbGxiYWNrLCBleGNsdWRlV3JhcENvb3JkKSB7XG4gIHZhciBpLCBqLCBrLCBnLCBnZW9tZXRyeSwgc3RvcEcsIGNvb3JkcyxcbiAgICBnZW9tZXRyeU1heWJlQ29sbGVjdGlvbixcbiAgICB3cmFwU2hyaW5rID0gMCxcbiAgICBpc0dlb21ldHJ5Q29sbGVjdGlvbixcbiAgICBpc0ZlYXR1cmVDb2xsZWN0aW9uID0gbGF5ZXIudHlwZSA9PT0gJ0ZlYXR1cmVDb2xsZWN0aW9uJyxcbiAgICBpc0ZlYXR1cmUgPSBsYXllci50eXBlID09PSAnRmVhdHVyZScsXG4gICAgc3RvcCA9IGlzRmVhdHVyZUNvbGxlY3Rpb24gPyBsYXllci5mZWF0dXJlcy5sZW5ndGggOiAxO1xuXG4gIC8vIFRoaXMgbG9naWMgbWF5IGxvb2sgYSBsaXR0bGUgd2VpcmQuIFRoZSByZWFzb24gd2h5IGl0IGlzIHRoYXQgd2F5XG4gIC8vIGlzIGJlY2F1c2UgaXQncyB0cnlpbmcgdG8gYmUgZmFzdC4gR2VvSlNPTiBzdXBwb3J0cyBtdWx0aXBsZSBraW5kc1xuICAvLyBvZiBvYmplY3RzIGF0IGl0cyByb290OiBGZWF0dXJlQ29sbGVjdGlvbiwgRmVhdHVyZXMsIEdlb21ldHJpZXMuXG4gIC8vIFRoaXMgZnVuY3Rpb24gaGFzIHRoZSByZXNwb25zaWJpbGl0eSBvZiBoYW5kbGluZyBhbGwgb2YgdGhlbSwgYW5kIHRoYXRcbiAgLy8gbWVhbnMgdGhhdCBzb21lIG9mIHRoZSBgZm9yYCBsb29wcyB5b3Ugc2VlIGJlbG93IGFjdHVhbGx5IGp1c3QgZG9uJ3QgYXBwbHlcbiAgLy8gdG8gY2VydGFpbiBpbnB1dHMuIEZvciBpbnN0YW5jZSwgaWYgeW91IGdpdmUgdGhpcyBqdXN0IGFcbiAgLy8gUG9pbnQgZ2VvbWV0cnksIHRoZW4gYm90aCBsb29wcyBhcmUgc2hvcnQtY2lyY3VpdGVkIGFuZCBhbGwgd2UgZG9cbiAgLy8gaXMgZ3JhZHVhbGx5IHJlbmFtZSB0aGUgaW5wdXQgdW50aWwgaXQncyBjYWxsZWQgJ2dlb21ldHJ5Jy5cbiAgLy9cbiAgLy8gVGhpcyBhbHNvIGFpbXMgdG8gYWxsb2NhdGUgYXMgZmV3IHJlc291cmNlcyBhcyBwb3NzaWJsZToganVzdCBhXG4gIC8vIGZldyBudW1iZXJzIGFuZCBib29sZWFucywgcmF0aGVyIHRoYW4gYW55IHRlbXBvcmFyeSBhcnJheXMgYXMgd291bGRcbiAgLy8gYmUgcmVxdWlyZWQgd2l0aCB0aGUgbm9ybWFsaXphdGlvbiBhcHByb2FjaC5cbiAgZm9yIChpID0gMDsgaSA8IHN0b3A7IGkrKykge1xuXG4gICAgZ2VvbWV0cnlNYXliZUNvbGxlY3Rpb24gPSAoaXNGZWF0dXJlQ29sbGVjdGlvbiA/IGxheWVyLmZlYXR1cmVzW2ldLmdlb21ldHJ5IDpcbiAgICAgICAgKGlzRmVhdHVyZSA/IGxheWVyLmdlb21ldHJ5IDogbGF5ZXIpKTtcbiAgICBpc0dlb21ldHJ5Q29sbGVjdGlvbiA9IGdlb21ldHJ5TWF5YmVDb2xsZWN0aW9uLnR5cGUgPT09ICdHZW9tZXRyeUNvbGxlY3Rpb24nO1xuICAgIHN0b3BHID0gaXNHZW9tZXRyeUNvbGxlY3Rpb24gPyBnZW9tZXRyeU1heWJlQ29sbGVjdGlvbi5nZW9tZXRyaWVzLmxlbmd0aCA6IDE7XG5cbiAgICBmb3IgKGcgPSAwOyBnIDwgc3RvcEc7IGcrKykge1xuXG4gICAgICBnZW9tZXRyeSA9IGlzR2VvbWV0cnlDb2xsZWN0aW9uID9cbiAgICAgICAgICBnZW9tZXRyeU1heWJlQ29sbGVjdGlvbi5nZW9tZXRyaWVzW2ddIDogZ2VvbWV0cnlNYXliZUNvbGxlY3Rpb247XG4gICAgICBjb29yZHMgPSBnZW9tZXRyeS5jb29yZGluYXRlcztcblxuICAgICAgd3JhcFNocmluayA9IChleGNsdWRlV3JhcENvb3JkICYmXG4gICAgICAgIChnZW9tZXRyeS50eXBlID09PSAnUG9seWdvbicgfHwgZ2VvbWV0cnkudHlwZSA9PT0gJ011bHRpUG9seWdvbicpKSA/XG4gICAgICAgIDEgOiAwO1xuXG4gICAgICBpZiAoZ2VvbWV0cnkudHlwZSA9PT0gJ1BvaW50Jykge1xuICAgICAgICBjYWxsYmFjayhjb29yZHMpO1xuICAgICAgfSBlbHNlIGlmIChnZW9tZXRyeS50eXBlID09PSAnTGluZVN0cmluZycgfHwgZ2VvbWV0cnkudHlwZSA9PT0gJ011bHRpUG9pbnQnKSB7XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBjb29yZHMubGVuZ3RoOyBqKyspIGNhbGxiYWNrKGNvb3Jkc1tqXSk7XG4gICAgICB9IGVsc2UgaWYgKGdlb21ldHJ5LnR5cGUgPT09ICdQb2x5Z29uJyB8fCBnZW9tZXRyeS50eXBlID09PSAnTXVsdGlMaW5lU3RyaW5nJykge1xuICAgICAgICBmb3IgKGogPSAwOyBqIDwgY29vcmRzLmxlbmd0aDsgaisrKVxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBjb29yZHNbal0ubGVuZ3RoIC0gd3JhcFNocmluazsgaysrKVxuICAgICAgICAgICAgY2FsbGJhY2soY29vcmRzW2pdW2tdKTtcbiAgICAgIH0gZWxzZSBpZiAoZ2VvbWV0cnkudHlwZSA9PT0gJ011bHRpUG9seWdvbicpIHtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGNvb3Jkcy5sZW5ndGg7IGorKylcbiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgY29vcmRzW2pdLmxlbmd0aDsgaysrKVxuICAgICAgICAgICAgZm9yIChsID0gMDsgbCA8IGNvb3Jkc1tqXVtrXS5sZW5ndGggLSB3cmFwU2hyaW5rOyBsKyspXG4gICAgICAgICAgICAgIGNhbGxiYWNrKGNvb3Jkc1tqXVtrXVtsXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gR2VvbWV0cnkgVHlwZScpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxubW9kdWxlLmV4cG9ydHMuY29vcmRFYWNoID0gY29vcmRFYWNoO1xuXG4vKipcbiAqIExhemlseSByZWR1Y2UgY29vcmRpbmF0ZXMgaW4gYW55IEdlb0pTT04gb2JqZWN0IGludG8gYSBzaW5nbGUgdmFsdWUsXG4gKiBzaW1pbGFyIHRvIGhvdyBBcnJheS5yZWR1Y2Ugd29ya3MuIEhvd2V2ZXIsIGluIHRoaXMgY2FzZSB3ZSBsYXppbHkgcnVuXG4gKiB0aGUgcmVkdWN0aW9uLCBzbyBhbiBhcnJheSBvZiBhbGwgY29vcmRpbmF0ZXMgaXMgdW5uZWNlc3NhcnkuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGxheWVyIGFueSBHZW9KU09OIG9iamVjdFxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgYSBtZXRob2QgdGhhdCB0YWtlcyAobWVtbywgdmFsdWUpIGFuZCByZXR1cm5zXG4gKiBhIG5ldyBtZW1vXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBleGNsdWRlV3JhcENvb3JkIHdoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGVcbiAqIHRoZSBmaW5hbCBjb29yZGluYXRlIG9mIExpbmVhclJpbmdzIHRoYXQgd3JhcHMgdGhlIHJpbmcgaW4gaXRzIGl0ZXJhdGlvbi5cbiAqIEBwYXJhbSB7Kn0gbWVtbyB0aGUgc3RhcnRpbmcgdmFsdWUgb2YgbWVtbzogY2FuIGJlIGFueSB0eXBlLlxuICovXG5mdW5jdGlvbiBjb29yZFJlZHVjZShsYXllciwgY2FsbGJhY2ssIG1lbW8sIGV4Y2x1ZGVXcmFwQ29vcmQpIHtcbiAgY29vcmRFYWNoKGxheWVyLCBmdW5jdGlvbihjb29yZCkge1xuICAgIG1lbW8gPSBjYWxsYmFjayhtZW1vLCBjb29yZCk7XG4gIH0sIGV4Y2x1ZGVXcmFwQ29vcmQpO1xuICByZXR1cm4gbWVtbztcbn1cbm1vZHVsZS5leHBvcnRzLmNvb3JkUmVkdWNlID0gY29vcmRSZWR1Y2U7XG5cbi8qKlxuICogTGF6aWx5IGl0ZXJhdGUgb3ZlciBwcm9wZXJ0eSBvYmplY3RzIGluIGFueSBHZW9KU09OIG9iamVjdCwgc2ltaWxhciB0b1xuICogQXJyYXkuZm9yRWFjaC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gbGF5ZXIgYW55IEdlb0pTT04gb2JqZWN0XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBhIG1ldGhvZCB0aGF0IHRha2VzICh2YWx1ZSlcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnQgPSB7IHR5cGU6ICdGZWF0dXJlJywgZ2VvbWV0cnk6IG51bGwsIHByb3BlcnRpZXM6IHsgZm9vOiAxIH0gfTtcbiAqIHByb3BFYWNoKHBvaW50LCBmdW5jdGlvbihwcm9wcykge1xuICogICAvLyBwcm9wcyBpcyBlcXVhbCB0byB7IGZvbzogMX1cbiAqIH0pO1xuICovXG5mdW5jdGlvbiBwcm9wRWFjaChsYXllciwgY2FsbGJhY2spIHtcbiAgdmFyIGk7XG4gIHN3aXRjaCAobGF5ZXIudHlwZSkge1xuICAgICAgY2FzZSAnRmVhdHVyZUNvbGxlY3Rpb24nOlxuICAgICAgICBmZWF0dXJlcyA9IGxheWVyLmZlYXR1cmVzO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGF5ZXIuZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGxheWVyLmZlYXR1cmVzW2ldLnByb3BlcnRpZXMpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnRmVhdHVyZSc6XG4gICAgICAgIGNhbGxiYWNrKGxheWVyLnByb3BlcnRpZXMpO1xuICAgICAgICBicmVhaztcbiAgfVxufVxubW9kdWxlLmV4cG9ydHMucHJvcEVhY2ggPSBwcm9wRWFjaDtcblxuLyoqXG4gKiBMYXppbHkgcmVkdWNlIHByb3BlcnRpZXMgaW4gYW55IEdlb0pTT04gb2JqZWN0IGludG8gYSBzaW5nbGUgdmFsdWUsXG4gKiBzaW1pbGFyIHRvIGhvdyBBcnJheS5yZWR1Y2Ugd29ya3MuIEhvd2V2ZXIsIGluIHRoaXMgY2FzZSB3ZSBsYXppbHkgcnVuXG4gKiB0aGUgcmVkdWN0aW9uLCBzbyBhbiBhcnJheSBvZiBhbGwgcHJvcGVydGllcyBpcyB1bm5lY2Vzc2FyeS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gbGF5ZXIgYW55IEdlb0pTT04gb2JqZWN0XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBhIG1ldGhvZCB0aGF0IHRha2VzIChtZW1vLCBjb29yZCkgYW5kIHJldHVybnNcbiAqIGEgbmV3IG1lbW9cbiAqIEBwYXJhbSB7Kn0gbWVtbyB0aGUgc3RhcnRpbmcgdmFsdWUgb2YgbWVtbzogY2FuIGJlIGFueSB0eXBlLlxuICovXG5mdW5jdGlvbiBwcm9wUmVkdWNlKGxheWVyLCBjYWxsYmFjaywgbWVtbykge1xuICBwcm9wRWFjaChsYXllciwgZnVuY3Rpb24ocHJvcCkge1xuICAgIG1lbW8gPSBjYWxsYmFjayhtZW1vLCBwcm9wKTtcbiAgfSk7XG4gIHJldHVybiBtZW1vO1xufVxubW9kdWxlLmV4cG9ydHMucHJvcFJlZHVjZSA9IHByb3BSZWR1Y2U7XG4iLCIvKipcbiAqIENvbWJpbmVzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9pbnR9LCB7QGxpbmsgTGluZVN0cmluZ30sIG9yIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcyBpbnRvIHtAbGluayBNdWx0aVBvaW50fSwge0BsaW5rIE11bHRpTGluZVN0cmluZ30sIG9yIHtAbGluayBNdWx0aVBvbHlnb259IGZlYXR1cmVzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9jb21iaW5lXG4gKiBAY2F0ZWdvcnkgbWlzY1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gZmMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBhbnkgdHlwZVxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgY29ycmVzcG9uZGluZyB0eXBlIHRvIGlucHV0XG4gKiBAZXhhbXBsZVxuICogdmFyIGZjID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTkuMDI2NDMyLCA0Ny40OTEzNF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTkuMDc0NDk3LCA0Ny41MDk1NDhdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBjb21iaW5lZCA9IHR1cmYuY29tYmluZShmYyk7XG4gKlxuICogLy89Y29tYmluZWRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZjKSB7XG4gIHZhciB0eXBlID0gZmMuZmVhdHVyZXNbMF0uZ2VvbWV0cnkudHlwZTtcbiAgdmFyIGdlb21ldHJpZXMgPSBmYy5mZWF0dXJlcy5tYXAoZnVuY3Rpb24oZikge1xuICAgIHJldHVybiBmLmdlb21ldHJ5O1xuICB9KTtcblxuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlICdQb2ludCc6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICBnZW9tZXRyeToge1xuICAgICAgICAgIHR5cGU6ICdNdWx0aVBvaW50JyxcbiAgICAgICAgICBjb29yZGluYXRlczogcGx1Y2tDb29kcyhnZW9tZXRyaWVzKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIGNhc2UgJ0xpbmVTdHJpbmcnOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7fSxcbiAgICAgICAgZ2VvbWV0cnk6IHtcbiAgICAgICAgICB0eXBlOiAnTXVsdGlMaW5lU3RyaW5nJyxcbiAgICAgICAgICBjb29yZGluYXRlczogcGx1Y2tDb29kcyhnZW9tZXRyaWVzKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIGNhc2UgJ1BvbHlnb24nOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7fSxcbiAgICAgICAgZ2VvbWV0cnk6IHtcbiAgICAgICAgICB0eXBlOiAnTXVsdGlQb2x5Z29uJyxcbiAgICAgICAgICBjb29yZGluYXRlczogcGx1Y2tDb29kcyhnZW9tZXRyaWVzKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmM7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIHBsdWNrQ29vZHMobXVsdGkpe1xuICByZXR1cm4gbXVsdGkubWFwKGZ1bmN0aW9uKGdlb20pe1xuICAgIHJldHVybiBnZW9tLmNvb3JkaW5hdGVzO1xuICB9KTtcbn1cbiIsIi8vIDEuIHJ1biB0aW4gb24gcG9pbnRzXG4vLyAyLiBjYWxjdWxhdGUgbGVudGggb2YgYWxsIGVkZ2VzIGFuZCBhcmVhIG9mIGFsbCB0cmlhbmdsZXNcbi8vIDMuIHJlbW92ZSB0cmlhbmdsZXMgdGhhdCBmYWlsIHRoZSBtYXggbGVuZ3RoIHRlc3Rcbi8vIDQuIGJ1ZmZlciB0aGUgcmVzdWx0cyBzbGlnaHRseVxuLy8gNS4gbWVyZ2UgdGhlIHJlc3VsdHNcbnZhciB0ID0ge307XG50LnRpbiA9IHJlcXVpcmUoJ3R1cmYtdGluJyk7XG50Lm1lcmdlID0gcmVxdWlyZSgndHVyZi1tZXJnZScpO1xudC5kaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcbnQucG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYW5kXG4gKiByZXR1cm5zIGEgY29uY2F2ZSBodWxsLlxuICpcbiAqIEludGVybmFsbHksIHRoaXMgaW1wbGVtZW50c1xuICogYSBbTW9ub3RvbmUgY2hhaW4gYWxnb3JpdGhtXShodHRwOi8vZW4ud2lraWJvb2tzLm9yZy93aWtpL0FsZ29yaXRobV9JbXBsZW1lbnRhdGlvbi9HZW9tZXRyeS9Db252ZXhfaHVsbC9Nb25vdG9uZV9jaGFpbiNKYXZhU2NyaXB0KS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvY29uY2F2ZVxuICogQGNhdGVnb3J5IHRyYW5zZm9ybWF0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAcGFyYW0ge251bWJlcn0gbWF4RWRnZSB0aGUgc2l6ZSBvZiBhbiBlZGdlIG5lY2Vzc2FyeSBmb3IgcGFydCBvZiB0aGVcbiAqIGh1bGwgdG8gYmVjb21lIGNvbmNhdmUgKGluIG1pbGVzKVxuICogQHBhcmFtIHtTdHJpbmd9IHVuaXRzIHVzZWQgZm9yIG1heEVkZ2UgZGlzdGFuY2UgKG1pbGVzIG9yIGtpbG9tZXRlcnMpXG4gKiBAcmV0dXJucyB7RmVhdHVyZX0gYSB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZVxuICogQHRocm93cyB7RXJyb3J9IGlmIG1heEVkZ2UgcGFyYW1ldGVyIGlzIG1pc3NpbmdcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTYzLjYwMTIyNiwgNDQuNjQyNjQzXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNjMuNTkxNDQyLCA0NC42NTE0MzZdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy02My41ODA3OTksIDQ0LjY0ODc0OV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTYzLjU3MzU4OSwgNDQuNjQxNzg4XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNjMuNTg3NjY1LCA0NC42NDUzM11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTYzLjU5NTIxOCwgNDQuNjQ3NjVdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBodWxsID0gdHVyZi5jb25jYXZlKHBvaW50cywgMSwgJ21pbGVzJyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChodWxsKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvaW50cywgbWF4RWRnZSwgdW5pdHMpIHtcbiAgaWYgKHR5cGVvZiBtYXhFZGdlICE9PSAnbnVtYmVyJykgdGhyb3cgbmV3IEVycm9yKCdtYXhFZGdlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpO1xuICBpZiAodHlwZW9mIHVuaXRzICE9PSAnc3RyaW5nJykgdGhyb3cgbmV3IEVycm9yKCd1bml0cyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnKTtcblxuICB2YXIgdGluUG9seXMgPSB0LnRpbihwb2ludHMpO1xuICB2YXIgZmlsdGVyZWRQb2x5cyA9IHRpblBvbHlzLmZlYXR1cmVzLmZpbHRlcihmaWx0ZXJUcmlhbmdsZXMpO1xuICB0aW5Qb2x5cy5mZWF0dXJlcyA9IGZpbHRlcmVkUG9seXM7XG5cbiAgZnVuY3Rpb24gZmlsdGVyVHJpYW5nbGVzKHRyaWFuZ2xlKSB7XG4gICAgdmFyIHB0MSA9IHQucG9pbnQodHJpYW5nbGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF1bMF0pO1xuICAgIHZhciBwdDIgPSB0LnBvaW50KHRyaWFuZ2xlLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdWzFdKTtcbiAgICB2YXIgcHQzID0gdC5wb2ludCh0cmlhbmdsZS5nZW9tZXRyeS5jb29yZGluYXRlc1swXVsyXSk7XG4gICAgdmFyIGRpc3QxID0gdC5kaXN0YW5jZShwdDEsIHB0MiwgdW5pdHMpO1xuICAgIHZhciBkaXN0MiA9IHQuZGlzdGFuY2UocHQyLCBwdDMsIHVuaXRzKTtcbiAgICB2YXIgZGlzdDMgPSB0LmRpc3RhbmNlKHB0MSwgcHQzLCB1bml0cyk7XG4gICAgcmV0dXJuIChkaXN0MSA8PSBtYXhFZGdlICYmIGRpc3QyIDw9IG1heEVkZ2UgJiYgZGlzdDMgPD0gbWF4RWRnZSk7XG4gIH1cblxuICByZXR1cm4gdC5tZXJnZSh0aW5Qb2x5cyk7XG59O1xuIiwidmFyIGVhY2ggPSByZXF1aXJlKCd0dXJmLW1ldGEnKS5jb29yZEVhY2gsXG4gICAgY29udmV4SHVsbCA9IHJlcXVpcmUoJ2NvbnZleC1odWxsJyksXG4gICAgcG9seWdvbiA9IHJlcXVpcmUoJ3R1cmYtcG9seWdvbicpO1xuXG4vKipcbiAqIFRha2VzIGFueSB7QGxpbmsgR2VvSlNPTn0gb2JqZWN0IGFuZCByZXR1cm5zIGFcbiAqIFtjb252ZXggaHVsbF0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db252ZXhfaHVsbCkgcG9seWdvbi5cbiAqXG4gKiBJbnRlcm5hbGx5IHRoaXMgdXNlc1xuICogdGhlIFtjb252ZXgtaHVsbF0oaHR0cHM6Ly9naXRodWIuY29tL21pa29sYWx5c2Vua28vY29udmV4LWh1bGwpIG1vZHVsZSB0aGF0XG4gKiBpbXBsZW1lbnRzIGEgW21vbm90b25lIGNoYWluIGh1bGxdKGh0dHA6Ly9lbi53aWtpYm9va3Mub3JnL3dpa2kvQWxnb3JpdGhtX0ltcGxlbWVudGF0aW9uL0dlb21ldHJ5L0NvbnZleF9odWxsL01vbm90b25lX2NoYWluKS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvY29udmV4XG4gKiBAY2F0ZWdvcnkgdHJhbnNmb3JtYXRpb25cbiAqIEBwYXJhbSB7R2VvSlNPTn0gaW5wdXQgYW55IEdlb0pTT04gb2JqZWN0XG4gKiBAcmV0dXJucyB7RmVhdHVyZX0gYSB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZVxuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMC4xOTUzMTIsIDQzLjc1NTIyNV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAuNDA0MDUyLCA0My44NDI0NTExXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMC41Nzk4MzMsIDQzLjY1OTkyNF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAuMzYwMTA3LCA0My41MTY2ODhdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjE0MDM4LCA0My41ODgzNDhdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjE5NTMxMiwgNDMuNzU1MjI1XVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgaHVsbCA9IHR1cmYuY29udmV4KHBvaW50cyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChodWxsKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmMpIHtcbiAgdmFyIHBvaW50cyA9IFtdO1xuICBlYWNoKGZjLCBmdW5jdGlvbihjb29yZCkgeyBwb2ludHMucHVzaChjb29yZCk7IH0pO1xuICB2YXIgaHVsbCA9IGNvbnZleEh1bGwocG9pbnRzKTtcbiAgdmFyIHJpbmcgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBodWxsLmxlbmd0aDsgaSsrKSB7XG4gICAgICByaW5nLnB1c2gocG9pbnRzW2h1bGxbaV1bMF1dKTtcbiAgfVxuICByaW5nLnB1c2gocG9pbnRzW2h1bGxbaHVsbC5sZW5ndGggLSAxXVsxXV0pO1xuICByZXR1cm4gcG9seWdvbihbcmluZ10pO1xufTtcbiIsIlwidXNlIHN0cmljdFwiXG5cbnZhciBjb252ZXhIdWxsMWQgPSByZXF1aXJlKCcuL2xpYi9jaDFkJylcbnZhciBjb252ZXhIdWxsMmQgPSByZXF1aXJlKCcuL2xpYi9jaDJkJylcbnZhciBjb252ZXhIdWxsbmQgPSByZXF1aXJlKCcuL2xpYi9jaG5kJylcblxubW9kdWxlLmV4cG9ydHMgPSBjb252ZXhIdWxsXG5cbmZ1bmN0aW9uIGNvbnZleEh1bGwocG9pbnRzKSB7XG4gIHZhciBuID0gcG9pbnRzLmxlbmd0aFxuICBpZihuID09PSAwKSB7XG4gICAgcmV0dXJuIFtdXG4gIH0gZWxzZSBpZihuID09PSAxKSB7XG4gICAgcmV0dXJuIFtbMF1dXG4gIH1cbiAgdmFyIGQgPSBwb2ludHNbMF0ubGVuZ3RoXG4gIGlmKGQgPT09IDApIHtcbiAgICByZXR1cm4gW11cbiAgfSBlbHNlIGlmKGQgPT09IDEpIHtcbiAgICByZXR1cm4gY29udmV4SHVsbDFkKHBvaW50cylcbiAgfSBlbHNlIGlmKGQgPT09IDIpIHtcbiAgICByZXR1cm4gY29udmV4SHVsbDJkKHBvaW50cylcbiAgfVxuICByZXR1cm4gY29udmV4SHVsbG5kKHBvaW50cywgZClcbn0iLCJcInVzZSBzdHJpY3RcIlxuXG5tb2R1bGUuZXhwb3J0cyA9IGNvbnZleEh1bGwxZFxuXG5mdW5jdGlvbiBjb252ZXhIdWxsMWQocG9pbnRzKSB7XG4gIHZhciBsbyA9IDBcbiAgdmFyIGhpID0gMFxuICBmb3IodmFyIGk9MTsgaTxwb2ludHMubGVuZ3RoOyArK2kpIHtcbiAgICBpZihwb2ludHNbaV1bMF0gPCBwb2ludHNbbG9dWzBdKSB7XG4gICAgICBsbyA9IGlcbiAgICB9XG4gICAgaWYocG9pbnRzW2ldWzBdID4gcG9pbnRzW2hpXVswXSkge1xuICAgICAgaGkgPSBpXG4gICAgfVxuICB9XG4gIGlmKGxvIDwgaGkpIHtcbiAgICByZXR1cm4gW1tsb10sIFtoaV1dXG4gIH0gZWxzZSBpZihsbyA+IGhpKSB7XG4gICAgcmV0dXJuIFtbaGldLCBbbG9dXVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBbW2xvXV1cbiAgfVxufSIsIid1c2Ugc3RyaWN0J1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNvbnZleEh1bGwyRFxuXG52YXIgbW9ub3RvbmVIdWxsID0gcmVxdWlyZSgnbW9ub3RvbmUtY29udmV4LWh1bGwtMmQnKVxuXG5mdW5jdGlvbiBjb252ZXhIdWxsMkQocG9pbnRzKSB7XG4gIHZhciBodWxsID0gbW9ub3RvbmVIdWxsKHBvaW50cylcbiAgdmFyIGggPSBodWxsLmxlbmd0aFxuICBpZihoIDw9IDIpIHtcbiAgICByZXR1cm4gW11cbiAgfVxuICB2YXIgZWRnZXMgPSBuZXcgQXJyYXkoaClcbiAgdmFyIGEgPSBodWxsW2gtMV1cbiAgZm9yKHZhciBpPTA7IGk8aDsgKytpKSB7XG4gICAgdmFyIGIgPSBodWxsW2ldXG4gICAgZWRnZXNbaV0gPSBbYSxiXVxuICAgIGEgPSBiXG4gIH1cbiAgcmV0dXJuIGVkZ2VzXG59XG4iLCIndXNlIHN0cmljdCdcblxubW9kdWxlLmV4cG9ydHMgPSBjb252ZXhIdWxsbkRcblxudmFyIGljaCA9IHJlcXVpcmUoJ2luY3JlbWVudGFsLWNvbnZleC1odWxsJylcbnZhciBhZmYgPSByZXF1aXJlKCdhZmZpbmUtaHVsbCcpXG5cbmZ1bmN0aW9uIHBlcm11dGUocG9pbnRzLCBmcm9udCkge1xuICB2YXIgbiA9IHBvaW50cy5sZW5ndGhcbiAgdmFyIG5wb2ludHMgPSBuZXcgQXJyYXkobilcbiAgZm9yKHZhciBpPTA7IGk8ZnJvbnQubGVuZ3RoOyArK2kpIHtcbiAgICBucG9pbnRzW2ldID0gcG9pbnRzW2Zyb250W2ldXVxuICB9XG4gIHZhciBwdHIgPSBmcm9udC5sZW5ndGhcbiAgZm9yKHZhciBpPTA7IGk8bjsgKytpKSB7XG4gICAgaWYoZnJvbnQuaW5kZXhPZihpKSA8IDApIHtcbiAgICAgIG5wb2ludHNbcHRyKytdID0gcG9pbnRzW2ldXG4gICAgfVxuICB9XG4gIHJldHVybiBucG9pbnRzXG59XG5cbmZ1bmN0aW9uIGludlBlcm11dGUoY2VsbHMsIGZyb250KSB7XG4gIHZhciBuYyA9IGNlbGxzLmxlbmd0aFxuICB2YXIgbmYgPSBmcm9udC5sZW5ndGhcbiAgZm9yKHZhciBpPTA7IGk8bmM7ICsraSkge1xuICAgIHZhciBjID0gY2VsbHNbaV1cbiAgICBmb3IodmFyIGo9MDsgajxjLmxlbmd0aDsgKytqKSB7XG4gICAgICB2YXIgeCA9IGNbal1cbiAgICAgIGlmKHggPCBuZikge1xuICAgICAgICBjW2pdID0gZnJvbnRbeF1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHggPSB4IC0gbmZcbiAgICAgICAgZm9yKHZhciBrPTA7IGs8bmY7ICsraykge1xuICAgICAgICAgIGlmKHggPj0gZnJvbnRba10pIHtcbiAgICAgICAgICAgIHggKz0gMVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjW2pdID0geFxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gY2VsbHNcbn1cblxuZnVuY3Rpb24gY29udmV4SHVsbG5EKHBvaW50cywgZCkge1xuICB0cnkge1xuICAgIHJldHVybiBpY2gocG9pbnRzLCB0cnVlKVxuICB9IGNhdGNoKGUpIHtcbiAgICAvL0lmIHBvaW50IHNldCBpcyBkZWdlbmVyYXRlLCB0cnkgdG8gZmluZCBhIGJhc2lzIGFuZCByZXJ1biBpdFxuICAgIHZhciBhaCA9IGFmZihwb2ludHMpXG4gICAgaWYoYWgubGVuZ3RoIDw9IGQpIHtcbiAgICAgIC8vTm8gYmFzaXMsIG5vIHRyeVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICAgIHZhciBucG9pbnRzID0gcGVybXV0ZShwb2ludHMsIGFoKVxuICAgIHZhciBuaHVsbCAgID0gaWNoKG5wb2ludHMsIHRydWUpXG4gICAgcmV0dXJuIGludlBlcm11dGUobmh1bGwsIGFoKVxuICB9XG59IiwiJ3VzZSBzdHJpY3QnXG5cbm1vZHVsZS5leHBvcnRzID0gYWZmaW5lSHVsbFxuXG52YXIgb3JpZW50ID0gcmVxdWlyZSgncm9idXN0LW9yaWVudGF0aW9uJylcblxuZnVuY3Rpb24gbGluZWFybHlJbmRlcGVuZGVudChwb2ludHMsIGQpIHtcbiAgdmFyIG5odWxsID0gbmV3IEFycmF5KGQrMSlcbiAgZm9yKHZhciBpPTA7IGk8cG9pbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgbmh1bGxbaV0gPSBwb2ludHNbaV1cbiAgfVxuICBmb3IodmFyIGk9MDsgaTw9cG9pbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgZm9yKHZhciBqPXBvaW50cy5sZW5ndGg7IGo8PWQ7ICsraikge1xuICAgICAgdmFyIHggPSBuZXcgQXJyYXkoZClcbiAgICAgIGZvcih2YXIgaz0wOyBrPGQ7ICsraykge1xuICAgICAgICB4W2tdID0gTWF0aC5wb3coaisxLWksIGspXG4gICAgICB9XG4gICAgICBuaHVsbFtqXSA9IHhcbiAgICB9XG4gICAgdmFyIG8gPSBvcmllbnQuYXBwbHkodm9pZCAwLCBuaHVsbClcbiAgICBpZihvKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2Vcbn1cblxuZnVuY3Rpb24gYWZmaW5lSHVsbChwb2ludHMpIHtcbiAgdmFyIG4gPSBwb2ludHMubGVuZ3RoXG4gIGlmKG4gPT09IDApIHtcbiAgICByZXR1cm4gW11cbiAgfVxuICBpZihuID09PSAxKSB7XG4gICAgcmV0dXJuIFswXVxuICB9XG4gIHZhciBkID0gcG9pbnRzWzBdLmxlbmd0aFxuICB2YXIgZnJhbWUgPSBbIHBvaW50c1swXSBdXG4gIHZhciBpbmRleCA9IFsgMCBdXG4gIGZvcih2YXIgaT0xOyBpPG47ICsraSkge1xuICAgIGZyYW1lLnB1c2gocG9pbnRzW2ldKVxuICAgIGlmKCFsaW5lYXJseUluZGVwZW5kZW50KGZyYW1lLCBkKSkge1xuICAgICAgZnJhbWUucG9wKClcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuICAgIGluZGV4LnB1c2goaSlcbiAgICBpZihpbmRleC5sZW5ndGggPT09IGQrMSkge1xuICAgICAgcmV0dXJuIGluZGV4XG4gICAgfVxuICB9XG4gIHJldHVybiBpbmRleFxufSIsIlwidXNlIHN0cmljdFwiXG5cbm1vZHVsZS5leHBvcnRzID0gZmFzdFR3b1N1bVxuXG5mdW5jdGlvbiBmYXN0VHdvU3VtKGEsIGIsIHJlc3VsdCkge1xuXHR2YXIgeCA9IGEgKyBiXG5cdHZhciBidiA9IHggLSBhXG5cdHZhciBhdiA9IHggLSBidlxuXHR2YXIgYnIgPSBiIC0gYnZcblx0dmFyIGFyID0gYSAtIGF2XG5cdGlmKHJlc3VsdCkge1xuXHRcdHJlc3VsdFswXSA9IGFyICsgYnJcblx0XHRyZXN1bHRbMV0gPSB4XG5cdFx0cmV0dXJuIHJlc3VsdFxuXHR9XG5cdHJldHVybiBbYXIrYnIsIHhdXG59IiwiXCJ1c2Ugc3RyaWN0XCJcblxudmFyIHR3b1Byb2R1Y3QgPSByZXF1aXJlKFwidHdvLXByb2R1Y3RcIilcbnZhciB0d29TdW0gPSByZXF1aXJlKFwidHdvLXN1bVwiKVxuXG5tb2R1bGUuZXhwb3J0cyA9IHNjYWxlTGluZWFyRXhwYW5zaW9uXG5cbmZ1bmN0aW9uIHNjYWxlTGluZWFyRXhwYW5zaW9uKGUsIHNjYWxlKSB7XG4gIHZhciBuID0gZS5sZW5ndGhcbiAgaWYobiA9PT0gMSkge1xuICAgIHZhciB0cyA9IHR3b1Byb2R1Y3QoZVswXSwgc2NhbGUpXG4gICAgaWYodHNbMF0pIHtcbiAgICAgIHJldHVybiB0c1xuICAgIH1cbiAgICByZXR1cm4gWyB0c1sxXSBdXG4gIH1cbiAgdmFyIGcgPSBuZXcgQXJyYXkoMiAqIG4pXG4gIHZhciBxID0gWzAuMSwgMC4xXVxuICB2YXIgdCA9IFswLjEsIDAuMV1cbiAgdmFyIGNvdW50ID0gMFxuICB0d29Qcm9kdWN0KGVbMF0sIHNjYWxlLCBxKVxuICBpZihxWzBdKSB7XG4gICAgZ1tjb3VudCsrXSA9IHFbMF1cbiAgfVxuICBmb3IodmFyIGk9MTsgaTxuOyArK2kpIHtcbiAgICB0d29Qcm9kdWN0KGVbaV0sIHNjYWxlLCB0KVxuICAgIHZhciBwcSA9IHFbMV1cbiAgICB0d29TdW0ocHEsIHRbMF0sIHEpXG4gICAgaWYocVswXSkge1xuICAgICAgZ1tjb3VudCsrXSA9IHFbMF1cbiAgICB9XG4gICAgdmFyIGEgPSB0WzFdXG4gICAgdmFyIGIgPSBxWzFdXG4gICAgdmFyIHggPSBhICsgYlxuICAgIHZhciBidiA9IHggLSBhXG4gICAgdmFyIHkgPSBiIC0gYnZcbiAgICBxWzFdID0geFxuICAgIGlmKHkpIHtcbiAgICAgIGdbY291bnQrK10gPSB5XG4gICAgfVxuICB9XG4gIGlmKHFbMV0pIHtcbiAgICBnW2NvdW50KytdID0gcVsxXVxuICB9XG4gIGlmKGNvdW50ID09PSAwKSB7XG4gICAgZ1tjb3VudCsrXSA9IDAuMFxuICB9XG4gIGcubGVuZ3RoID0gY291bnRcbiAgcmV0dXJuIGdcbn0iLCJcInVzZSBzdHJpY3RcIlxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvYnVzdFN1YnRyYWN0XG5cbi8vRWFzeSBjYXNlOiBBZGQgdHdvIHNjYWxhcnNcbmZ1bmN0aW9uIHNjYWxhclNjYWxhcihhLCBiKSB7XG4gIHZhciB4ID0gYSArIGJcbiAgdmFyIGJ2ID0geCAtIGFcbiAgdmFyIGF2ID0geCAtIGJ2XG4gIHZhciBiciA9IGIgLSBidlxuICB2YXIgYXIgPSBhIC0gYXZcbiAgdmFyIHkgPSBhciArIGJyXG4gIGlmKHkpIHtcbiAgICByZXR1cm4gW3ksIHhdXG4gIH1cbiAgcmV0dXJuIFt4XVxufVxuXG5mdW5jdGlvbiByb2J1c3RTdWJ0cmFjdChlLCBmKSB7XG4gIHZhciBuZSA9IGUubGVuZ3RofDBcbiAgdmFyIG5mID0gZi5sZW5ndGh8MFxuICBpZihuZSA9PT0gMSAmJiBuZiA9PT0gMSkge1xuICAgIHJldHVybiBzY2FsYXJTY2FsYXIoZVswXSwgLWZbMF0pXG4gIH1cbiAgdmFyIG4gPSBuZSArIG5mXG4gIHZhciBnID0gbmV3IEFycmF5KG4pXG4gIHZhciBjb3VudCA9IDBcbiAgdmFyIGVwdHIgPSAwXG4gIHZhciBmcHRyID0gMFxuICB2YXIgYWJzID0gTWF0aC5hYnNcbiAgdmFyIGVpID0gZVtlcHRyXVxuICB2YXIgZWEgPSBhYnMoZWkpXG4gIHZhciBmaSA9IC1mW2ZwdHJdXG4gIHZhciBmYSA9IGFicyhmaSlcbiAgdmFyIGEsIGJcbiAgaWYoZWEgPCBmYSkge1xuICAgIGIgPSBlaVxuICAgIGVwdHIgKz0gMVxuICAgIGlmKGVwdHIgPCBuZSkge1xuICAgICAgZWkgPSBlW2VwdHJdXG4gICAgICBlYSA9IGFicyhlaSlcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgYiA9IGZpXG4gICAgZnB0ciArPSAxXG4gICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICBmaSA9IC1mW2ZwdHJdXG4gICAgICBmYSA9IGFicyhmaSlcbiAgICB9XG4gIH1cbiAgaWYoKGVwdHIgPCBuZSAmJiBlYSA8IGZhKSB8fCAoZnB0ciA+PSBuZikpIHtcbiAgICBhID0gZWlcbiAgICBlcHRyICs9IDFcbiAgICBpZihlcHRyIDwgbmUpIHtcbiAgICAgIGVpID0gZVtlcHRyXVxuICAgICAgZWEgPSBhYnMoZWkpXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGEgPSBmaVxuICAgIGZwdHIgKz0gMVxuICAgIGlmKGZwdHIgPCBuZikge1xuICAgICAgZmkgPSAtZltmcHRyXVxuICAgICAgZmEgPSBhYnMoZmkpXG4gICAgfVxuICB9XG4gIHZhciB4ID0gYSArIGJcbiAgdmFyIGJ2ID0geCAtIGFcbiAgdmFyIHkgPSBiIC0gYnZcbiAgdmFyIHEwID0geVxuICB2YXIgcTEgPSB4XG4gIHZhciBfeCwgX2J2LCBfYXYsIF9iciwgX2FyXG4gIHdoaWxlKGVwdHIgPCBuZSAmJiBmcHRyIDwgbmYpIHtcbiAgICBpZihlYSA8IGZhKSB7XG4gICAgICBhID0gZWlcbiAgICAgIGVwdHIgKz0gMVxuICAgICAgaWYoZXB0ciA8IG5lKSB7XG4gICAgICAgIGVpID0gZVtlcHRyXVxuICAgICAgICBlYSA9IGFicyhlaSlcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYSA9IGZpXG4gICAgICBmcHRyICs9IDFcbiAgICAgIGlmKGZwdHIgPCBuZikge1xuICAgICAgICBmaSA9IC1mW2ZwdHJdXG4gICAgICAgIGZhID0gYWJzKGZpKVxuICAgICAgfVxuICAgIH1cbiAgICBiID0gcTBcbiAgICB4ID0gYSArIGJcbiAgICBidiA9IHggLSBhXG4gICAgeSA9IGIgLSBidlxuICAgIGlmKHkpIHtcbiAgICAgIGdbY291bnQrK10gPSB5XG4gICAgfVxuICAgIF94ID0gcTEgKyB4XG4gICAgX2J2ID0gX3ggLSBxMVxuICAgIF9hdiA9IF94IC0gX2J2XG4gICAgX2JyID0geCAtIF9idlxuICAgIF9hciA9IHExIC0gX2F2XG4gICAgcTAgPSBfYXIgKyBfYnJcbiAgICBxMSA9IF94XG4gIH1cbiAgd2hpbGUoZXB0ciA8IG5lKSB7XG4gICAgYSA9IGVpXG4gICAgYiA9IHEwXG4gICAgeCA9IGEgKyBiXG4gICAgYnYgPSB4IC0gYVxuICAgIHkgPSBiIC0gYnZcbiAgICBpZih5KSB7XG4gICAgICBnW2NvdW50KytdID0geVxuICAgIH1cbiAgICBfeCA9IHExICsgeFxuICAgIF9idiA9IF94IC0gcTFcbiAgICBfYXYgPSBfeCAtIF9idlxuICAgIF9iciA9IHggLSBfYnZcbiAgICBfYXIgPSBxMSAtIF9hdlxuICAgIHEwID0gX2FyICsgX2JyXG4gICAgcTEgPSBfeFxuICAgIGVwdHIgKz0gMVxuICAgIGlmKGVwdHIgPCBuZSkge1xuICAgICAgZWkgPSBlW2VwdHJdXG4gICAgfVxuICB9XG4gIHdoaWxlKGZwdHIgPCBuZikge1xuICAgIGEgPSBmaVxuICAgIGIgPSBxMFxuICAgIHggPSBhICsgYlxuICAgIGJ2ID0geCAtIGFcbiAgICB5ID0gYiAtIGJ2XG4gICAgaWYoeSkge1xuICAgICAgZ1tjb3VudCsrXSA9IHlcbiAgICB9IFxuICAgIF94ID0gcTEgKyB4XG4gICAgX2J2ID0gX3ggLSBxMVxuICAgIF9hdiA9IF94IC0gX2J2XG4gICAgX2JyID0geCAtIF9idlxuICAgIF9hciA9IHExIC0gX2F2XG4gICAgcTAgPSBfYXIgKyBfYnJcbiAgICBxMSA9IF94XG4gICAgZnB0ciArPSAxXG4gICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICBmaSA9IC1mW2ZwdHJdXG4gICAgfVxuICB9XG4gIGlmKHEwKSB7XG4gICAgZ1tjb3VudCsrXSA9IHEwXG4gIH1cbiAgaWYocTEpIHtcbiAgICBnW2NvdW50KytdID0gcTFcbiAgfVxuICBpZighY291bnQpIHtcbiAgICBnW2NvdW50KytdID0gMC4wICBcbiAgfVxuICBnLmxlbmd0aCA9IGNvdW50XG4gIHJldHVybiBnXG59IiwiXCJ1c2Ugc3RyaWN0XCJcblxubW9kdWxlLmV4cG9ydHMgPSBsaW5lYXJFeHBhbnNpb25TdW1cblxuLy9FYXN5IGNhc2U6IEFkZCB0d28gc2NhbGFyc1xuZnVuY3Rpb24gc2NhbGFyU2NhbGFyKGEsIGIpIHtcbiAgdmFyIHggPSBhICsgYlxuICB2YXIgYnYgPSB4IC0gYVxuICB2YXIgYXYgPSB4IC0gYnZcbiAgdmFyIGJyID0gYiAtIGJ2XG4gIHZhciBhciA9IGEgLSBhdlxuICB2YXIgeSA9IGFyICsgYnJcbiAgaWYoeSkge1xuICAgIHJldHVybiBbeSwgeF1cbiAgfVxuICByZXR1cm4gW3hdXG59XG5cbmZ1bmN0aW9uIGxpbmVhckV4cGFuc2lvblN1bShlLCBmKSB7XG4gIHZhciBuZSA9IGUubGVuZ3RofDBcbiAgdmFyIG5mID0gZi5sZW5ndGh8MFxuICBpZihuZSA9PT0gMSAmJiBuZiA9PT0gMSkge1xuICAgIHJldHVybiBzY2FsYXJTY2FsYXIoZVswXSwgZlswXSlcbiAgfVxuICB2YXIgbiA9IG5lICsgbmZcbiAgdmFyIGcgPSBuZXcgQXJyYXkobilcbiAgdmFyIGNvdW50ID0gMFxuICB2YXIgZXB0ciA9IDBcbiAgdmFyIGZwdHIgPSAwXG4gIHZhciBhYnMgPSBNYXRoLmFic1xuICB2YXIgZWkgPSBlW2VwdHJdXG4gIHZhciBlYSA9IGFicyhlaSlcbiAgdmFyIGZpID0gZltmcHRyXVxuICB2YXIgZmEgPSBhYnMoZmkpXG4gIHZhciBhLCBiXG4gIGlmKGVhIDwgZmEpIHtcbiAgICBiID0gZWlcbiAgICBlcHRyICs9IDFcbiAgICBpZihlcHRyIDwgbmUpIHtcbiAgICAgIGVpID0gZVtlcHRyXVxuICAgICAgZWEgPSBhYnMoZWkpXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGIgPSBmaVxuICAgIGZwdHIgKz0gMVxuICAgIGlmKGZwdHIgPCBuZikge1xuICAgICAgZmkgPSBmW2ZwdHJdXG4gICAgICBmYSA9IGFicyhmaSlcbiAgICB9XG4gIH1cbiAgaWYoKGVwdHIgPCBuZSAmJiBlYSA8IGZhKSB8fCAoZnB0ciA+PSBuZikpIHtcbiAgICBhID0gZWlcbiAgICBlcHRyICs9IDFcbiAgICBpZihlcHRyIDwgbmUpIHtcbiAgICAgIGVpID0gZVtlcHRyXVxuICAgICAgZWEgPSBhYnMoZWkpXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGEgPSBmaVxuICAgIGZwdHIgKz0gMVxuICAgIGlmKGZwdHIgPCBuZikge1xuICAgICAgZmkgPSBmW2ZwdHJdXG4gICAgICBmYSA9IGFicyhmaSlcbiAgICB9XG4gIH1cbiAgdmFyIHggPSBhICsgYlxuICB2YXIgYnYgPSB4IC0gYVxuICB2YXIgeSA9IGIgLSBidlxuICB2YXIgcTAgPSB5XG4gIHZhciBxMSA9IHhcbiAgdmFyIF94LCBfYnYsIF9hdiwgX2JyLCBfYXJcbiAgd2hpbGUoZXB0ciA8IG5lICYmIGZwdHIgPCBuZikge1xuICAgIGlmKGVhIDwgZmEpIHtcbiAgICAgIGEgPSBlaVxuICAgICAgZXB0ciArPSAxXG4gICAgICBpZihlcHRyIDwgbmUpIHtcbiAgICAgICAgZWkgPSBlW2VwdHJdXG4gICAgICAgIGVhID0gYWJzKGVpKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhID0gZmlcbiAgICAgIGZwdHIgKz0gMVxuICAgICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICAgIGZpID0gZltmcHRyXVxuICAgICAgICBmYSA9IGFicyhmaSlcbiAgICAgIH1cbiAgICB9XG4gICAgYiA9IHEwXG4gICAgeCA9IGEgKyBiXG4gICAgYnYgPSB4IC0gYVxuICAgIHkgPSBiIC0gYnZcbiAgICBpZih5KSB7XG4gICAgICBnW2NvdW50KytdID0geVxuICAgIH1cbiAgICBfeCA9IHExICsgeFxuICAgIF9idiA9IF94IC0gcTFcbiAgICBfYXYgPSBfeCAtIF9idlxuICAgIF9iciA9IHggLSBfYnZcbiAgICBfYXIgPSBxMSAtIF9hdlxuICAgIHEwID0gX2FyICsgX2JyXG4gICAgcTEgPSBfeFxuICB9XG4gIHdoaWxlKGVwdHIgPCBuZSkge1xuICAgIGEgPSBlaVxuICAgIGIgPSBxMFxuICAgIHggPSBhICsgYlxuICAgIGJ2ID0geCAtIGFcbiAgICB5ID0gYiAtIGJ2XG4gICAgaWYoeSkge1xuICAgICAgZ1tjb3VudCsrXSA9IHlcbiAgICB9XG4gICAgX3ggPSBxMSArIHhcbiAgICBfYnYgPSBfeCAtIHExXG4gICAgX2F2ID0gX3ggLSBfYnZcbiAgICBfYnIgPSB4IC0gX2J2XG4gICAgX2FyID0gcTEgLSBfYXZcbiAgICBxMCA9IF9hciArIF9iclxuICAgIHExID0gX3hcbiAgICBlcHRyICs9IDFcbiAgICBpZihlcHRyIDwgbmUpIHtcbiAgICAgIGVpID0gZVtlcHRyXVxuICAgIH1cbiAgfVxuICB3aGlsZShmcHRyIDwgbmYpIHtcbiAgICBhID0gZmlcbiAgICBiID0gcTBcbiAgICB4ID0gYSArIGJcbiAgICBidiA9IHggLSBhXG4gICAgeSA9IGIgLSBidlxuICAgIGlmKHkpIHtcbiAgICAgIGdbY291bnQrK10gPSB5XG4gICAgfSBcbiAgICBfeCA9IHExICsgeFxuICAgIF9idiA9IF94IC0gcTFcbiAgICBfYXYgPSBfeCAtIF9idlxuICAgIF9iciA9IHggLSBfYnZcbiAgICBfYXIgPSBxMSAtIF9hdlxuICAgIHEwID0gX2FyICsgX2JyXG4gICAgcTEgPSBfeFxuICAgIGZwdHIgKz0gMVxuICAgIGlmKGZwdHIgPCBuZikge1xuICAgICAgZmkgPSBmW2ZwdHJdXG4gICAgfVxuICB9XG4gIGlmKHEwKSB7XG4gICAgZ1tjb3VudCsrXSA9IHEwXG4gIH1cbiAgaWYocTEpIHtcbiAgICBnW2NvdW50KytdID0gcTFcbiAgfVxuICBpZighY291bnQpIHtcbiAgICBnW2NvdW50KytdID0gMC4wICBcbiAgfVxuICBnLmxlbmd0aCA9IGNvdW50XG4gIHJldHVybiBnXG59IiwiXCJ1c2Ugc3RyaWN0XCJcblxubW9kdWxlLmV4cG9ydHMgPSB0d29Qcm9kdWN0XG5cbnZhciBTUExJVFRFUiA9ICsoTWF0aC5wb3coMiwgMjcpICsgMS4wKVxuXG5mdW5jdGlvbiB0d29Qcm9kdWN0KGEsIGIsIHJlc3VsdCkge1xuICB2YXIgeCA9IGEgKiBiXG5cbiAgdmFyIGMgPSBTUExJVFRFUiAqIGFcbiAgdmFyIGFiaWcgPSBjIC0gYVxuICB2YXIgYWhpID0gYyAtIGFiaWdcbiAgdmFyIGFsbyA9IGEgLSBhaGlcblxuICB2YXIgZCA9IFNQTElUVEVSICogYlxuICB2YXIgYmJpZyA9IGQgLSBiXG4gIHZhciBiaGkgPSBkIC0gYmJpZ1xuICB2YXIgYmxvID0gYiAtIGJoaVxuXG4gIHZhciBlcnIxID0geCAtIChhaGkgKiBiaGkpXG4gIHZhciBlcnIyID0gZXJyMSAtIChhbG8gKiBiaGkpXG4gIHZhciBlcnIzID0gZXJyMiAtIChhaGkgKiBibG8pXG5cbiAgdmFyIHkgPSBhbG8gKiBibG8gLSBlcnIzXG5cbiAgaWYocmVzdWx0KSB7XG4gICAgcmVzdWx0WzBdID0geVxuICAgIHJlc3VsdFsxXSA9IHhcbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cblxuICByZXR1cm4gWyB5LCB4IF1cbn0iLCJcInVzZSBzdHJpY3RcIlxuXG52YXIgdHdvUHJvZHVjdCA9IHJlcXVpcmUoXCJ0d28tcHJvZHVjdFwiKVxudmFyIHJvYnVzdFN1bSA9IHJlcXVpcmUoXCJyb2J1c3Qtc3VtXCIpXG52YXIgcm9idXN0U2NhbGUgPSByZXF1aXJlKFwicm9idXN0LXNjYWxlXCIpXG52YXIgcm9idXN0U3VidHJhY3QgPSByZXF1aXJlKFwicm9idXN0LXN1YnRyYWN0XCIpXG5cbnZhciBOVU1fRVhQQU5EID0gNVxuXG52YXIgRVBTSUxPTiAgICAgPSAxLjExMDIyMzAyNDYyNTE1NjVlLTE2XG52YXIgRVJSQk9VTkQzICAgPSAoMy4wICsgMTYuMCAqIEVQU0lMT04pICogRVBTSUxPTlxudmFyIEVSUkJPVU5ENCAgID0gKDcuMCArIDU2LjAgKiBFUFNJTE9OKSAqIEVQU0lMT05cblxuZnVuY3Rpb24gY29mYWN0b3IobSwgYykge1xuICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KG0ubGVuZ3RoLTEpXG4gIGZvcih2YXIgaT0xOyBpPG0ubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgciA9IHJlc3VsdFtpLTFdID0gbmV3IEFycmF5KG0ubGVuZ3RoLTEpXG4gICAgZm9yKHZhciBqPTAsaz0wOyBqPG0ubGVuZ3RoOyArK2opIHtcbiAgICAgIGlmKGogPT09IGMpIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIHJbaysrXSA9IG1baV1bal1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5mdW5jdGlvbiBtYXRyaXgobikge1xuICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KG4pXG4gIGZvcih2YXIgaT0wOyBpPG47ICsraSkge1xuICAgIHJlc3VsdFtpXSA9IG5ldyBBcnJheShuKVxuICAgIGZvcih2YXIgaj0wOyBqPG47ICsraikge1xuICAgICAgcmVzdWx0W2ldW2pdID0gW1wibVwiLCBqLCBcIltcIiwgKG4taS0xKSwgXCJdXCJdLmpvaW4oXCJcIilcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5mdW5jdGlvbiBzaWduKG4pIHtcbiAgaWYobiAmIDEpIHtcbiAgICByZXR1cm4gXCItXCJcbiAgfVxuICByZXR1cm4gXCJcIlxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVN1bShleHByKSB7XG4gIGlmKGV4cHIubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIGV4cHJbMF1cbiAgfSBlbHNlIGlmKGV4cHIubGVuZ3RoID09PSAyKSB7XG4gICAgcmV0dXJuIFtcInN1bShcIiwgZXhwclswXSwgXCIsXCIsIGV4cHJbMV0sIFwiKVwiXS5qb2luKFwiXCIpXG4gIH0gZWxzZSB7XG4gICAgdmFyIG0gPSBleHByLmxlbmd0aD4+MVxuICAgIHJldHVybiBbXCJzdW0oXCIsIGdlbmVyYXRlU3VtKGV4cHIuc2xpY2UoMCwgbSkpLCBcIixcIiwgZ2VuZXJhdGVTdW0oZXhwci5zbGljZShtKSksIFwiKVwiXS5qb2luKFwiXCIpXG4gIH1cbn1cblxuZnVuY3Rpb24gZGV0ZXJtaW5hbnQobSkge1xuICBpZihtLmxlbmd0aCA9PT0gMikge1xuICAgIHJldHVybiBbW1wic3VtKHByb2QoXCIsIG1bMF1bMF0sIFwiLFwiLCBtWzFdWzFdLCBcIikscHJvZCgtXCIsIG1bMF1bMV0sIFwiLFwiLCBtWzFdWzBdLCBcIikpXCJdLmpvaW4oXCJcIildXG4gIH0gZWxzZSB7XG4gICAgdmFyIGV4cHIgPSBbXVxuICAgIGZvcih2YXIgaT0wOyBpPG0ubGVuZ3RoOyArK2kpIHtcbiAgICAgIGV4cHIucHVzaChbXCJzY2FsZShcIiwgZ2VuZXJhdGVTdW0oZGV0ZXJtaW5hbnQoY29mYWN0b3IobSwgaSkpKSwgXCIsXCIsIHNpZ24oaSksIG1bMF1baV0sIFwiKVwiXS5qb2luKFwiXCIpKVxuICAgIH1cbiAgICByZXR1cm4gZXhwclxuICB9XG59XG5cbmZ1bmN0aW9uIG9yaWVudGF0aW9uKG4pIHtcbiAgdmFyIHBvcyA9IFtdXG4gIHZhciBuZWcgPSBbXVxuICB2YXIgbSA9IG1hdHJpeChuKVxuICB2YXIgYXJncyA9IFtdXG4gIGZvcih2YXIgaT0wOyBpPG47ICsraSkge1xuICAgIGlmKChpJjEpPT09MCkge1xuICAgICAgcG9zLnB1c2guYXBwbHkocG9zLCBkZXRlcm1pbmFudChjb2ZhY3RvcihtLCBpKSkpXG4gICAgfSBlbHNlIHtcbiAgICAgIG5lZy5wdXNoLmFwcGx5KG5lZywgZGV0ZXJtaW5hbnQoY29mYWN0b3IobSwgaSkpKVxuICAgIH1cbiAgICBhcmdzLnB1c2goXCJtXCIgKyBpKVxuICB9XG4gIHZhciBwb3NFeHByID0gZ2VuZXJhdGVTdW0ocG9zKVxuICB2YXIgbmVnRXhwciA9IGdlbmVyYXRlU3VtKG5lZylcbiAgdmFyIGZ1bmNOYW1lID0gXCJvcmllbnRhdGlvblwiICsgbiArIFwiRXhhY3RcIlxuICB2YXIgY29kZSA9IFtcImZ1bmN0aW9uIFwiLCBmdW5jTmFtZSwgXCIoXCIsIGFyZ3Muam9pbigpLCBcIil7dmFyIHA9XCIsIHBvc0V4cHIsIFwiLG49XCIsIG5lZ0V4cHIsIFwiLGQ9c3ViKHAsbik7XFxcbnJldHVybiBkW2QubGVuZ3RoLTFdO307cmV0dXJuIFwiLCBmdW5jTmFtZV0uam9pbihcIlwiKVxuICB2YXIgcHJvYyA9IG5ldyBGdW5jdGlvbihcInN1bVwiLCBcInByb2RcIiwgXCJzY2FsZVwiLCBcInN1YlwiLCBjb2RlKVxuICByZXR1cm4gcHJvYyhyb2J1c3RTdW0sIHR3b1Byb2R1Y3QsIHJvYnVzdFNjYWxlLCByb2J1c3RTdWJ0cmFjdClcbn1cblxudmFyIG9yaWVudGF0aW9uM0V4YWN0ID0gb3JpZW50YXRpb24oMylcbnZhciBvcmllbnRhdGlvbjRFeGFjdCA9IG9yaWVudGF0aW9uKDQpXG5cbnZhciBDQUNIRUQgPSBbXG4gIGZ1bmN0aW9uIG9yaWVudGF0aW9uMCgpIHsgcmV0dXJuIDAgfSxcbiAgZnVuY3Rpb24gb3JpZW50YXRpb24xKCkgeyByZXR1cm4gMCB9LFxuICBmdW5jdGlvbiBvcmllbnRhdGlvbjIoYSwgYikgeyBcbiAgICByZXR1cm4gYlswXSAtIGFbMF1cbiAgfSxcbiAgZnVuY3Rpb24gb3JpZW50YXRpb24zKGEsIGIsIGMpIHtcbiAgICB2YXIgbCA9IChhWzFdIC0gY1sxXSkgKiAoYlswXSAtIGNbMF0pXG4gICAgdmFyIHIgPSAoYVswXSAtIGNbMF0pICogKGJbMV0gLSBjWzFdKVxuICAgIHZhciBkZXQgPSBsIC0gclxuICAgIHZhciBzXG4gICAgaWYobCA+IDApIHtcbiAgICAgIGlmKHIgPD0gMCkge1xuICAgICAgICByZXR1cm4gZGV0XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzID0gbCArIHJcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYobCA8IDApIHtcbiAgICAgIGlmKHIgPj0gMCkge1xuICAgICAgICByZXR1cm4gZGV0XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzID0gLShsICsgcilcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGRldFxuICAgIH1cbiAgICB2YXIgdG9sID0gRVJSQk9VTkQzICogc1xuICAgIGlmKGRldCA+PSB0b2wgfHwgZGV0IDw9IC10b2wpIHtcbiAgICAgIHJldHVybiBkZXRcbiAgICB9XG4gICAgcmV0dXJuIG9yaWVudGF0aW9uM0V4YWN0KGEsIGIsIGMpXG4gIH0sXG4gIGZ1bmN0aW9uIG9yaWVudGF0aW9uNChhLGIsYyxkKSB7XG4gICAgdmFyIGFkeCA9IGFbMF0gLSBkWzBdXG4gICAgdmFyIGJkeCA9IGJbMF0gLSBkWzBdXG4gICAgdmFyIGNkeCA9IGNbMF0gLSBkWzBdXG4gICAgdmFyIGFkeSA9IGFbMV0gLSBkWzFdXG4gICAgdmFyIGJkeSA9IGJbMV0gLSBkWzFdXG4gICAgdmFyIGNkeSA9IGNbMV0gLSBkWzFdXG4gICAgdmFyIGFkeiA9IGFbMl0gLSBkWzJdXG4gICAgdmFyIGJkeiA9IGJbMl0gLSBkWzJdXG4gICAgdmFyIGNkeiA9IGNbMl0gLSBkWzJdXG4gICAgdmFyIGJkeGNkeSA9IGJkeCAqIGNkeVxuICAgIHZhciBjZHhiZHkgPSBjZHggKiBiZHlcbiAgICB2YXIgY2R4YWR5ID0gY2R4ICogYWR5XG4gICAgdmFyIGFkeGNkeSA9IGFkeCAqIGNkeVxuICAgIHZhciBhZHhiZHkgPSBhZHggKiBiZHlcbiAgICB2YXIgYmR4YWR5ID0gYmR4ICogYWR5XG4gICAgdmFyIGRldCA9IGFkeiAqIChiZHhjZHkgLSBjZHhiZHkpIFxuICAgICAgICAgICAgKyBiZHogKiAoY2R4YWR5IC0gYWR4Y2R5KVxuICAgICAgICAgICAgKyBjZHogKiAoYWR4YmR5IC0gYmR4YWR5KVxuICAgIHZhciBwZXJtYW5lbnQgPSAoTWF0aC5hYnMoYmR4Y2R5KSArIE1hdGguYWJzKGNkeGJkeSkpICogTWF0aC5hYnMoYWR6KVxuICAgICAgICAgICAgICAgICAgKyAoTWF0aC5hYnMoY2R4YWR5KSArIE1hdGguYWJzKGFkeGNkeSkpICogTWF0aC5hYnMoYmR6KVxuICAgICAgICAgICAgICAgICAgKyAoTWF0aC5hYnMoYWR4YmR5KSArIE1hdGguYWJzKGJkeGFkeSkpICogTWF0aC5hYnMoY2R6KVxuICAgIHZhciB0b2wgPSBFUlJCT1VORDQgKiBwZXJtYW5lbnRcbiAgICBpZiAoKGRldCA+IHRvbCkgfHwgKC1kZXQgPiB0b2wpKSB7XG4gICAgICByZXR1cm4gZGV0XG4gICAgfVxuICAgIHJldHVybiBvcmllbnRhdGlvbjRFeGFjdChhLGIsYyxkKVxuICB9XG5dXG5cbmZ1bmN0aW9uIHNsb3dPcmllbnQoYXJncykge1xuICB2YXIgcHJvYyA9IENBQ0hFRFthcmdzLmxlbmd0aF1cbiAgaWYoIXByb2MpIHtcbiAgICBwcm9jID0gQ0FDSEVEW2FyZ3MubGVuZ3RoXSA9IG9yaWVudGF0aW9uKGFyZ3MubGVuZ3RoKVxuICB9XG4gIHJldHVybiBwcm9jLmFwcGx5KHVuZGVmaW5lZCwgYXJncylcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVPcmllbnRhdGlvblByb2MoKSB7XG4gIHdoaWxlKENBQ0hFRC5sZW5ndGggPD0gTlVNX0VYUEFORCkge1xuICAgIENBQ0hFRC5wdXNoKG9yaWVudGF0aW9uKENBQ0hFRC5sZW5ndGgpKVxuICB9XG4gIHZhciBhcmdzID0gW11cbiAgdmFyIHByb2NBcmdzID0gW1wic2xvd1wiXVxuICBmb3IodmFyIGk9MDsgaTw9TlVNX0VYUEFORDsgKytpKSB7XG4gICAgYXJncy5wdXNoKFwiYVwiICsgaSlcbiAgICBwcm9jQXJncy5wdXNoKFwib1wiICsgaSlcbiAgfVxuICB2YXIgY29kZSA9IFtcbiAgICBcImZ1bmN0aW9uIGdldE9yaWVudGF0aW9uKFwiLCBhcmdzLmpvaW4oKSwgXCIpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6Y2FzZSAxOnJldHVybiAwO1wiXG4gIF1cbiAgZm9yKHZhciBpPTI7IGk8PU5VTV9FWFBBTkQ7ICsraSkge1xuICAgIGNvZGUucHVzaChcImNhc2UgXCIsIGksIFwiOnJldHVybiBvXCIsIGksIFwiKFwiLCBhcmdzLnNsaWNlKDAsIGkpLmpvaW4oKSwgXCIpO1wiKVxuICB9XG4gIGNvZGUucHVzaChcIn12YXIgcz1uZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCk7Zm9yKHZhciBpPTA7aTxhcmd1bWVudHMubGVuZ3RoOysraSl7c1tpXT1hcmd1bWVudHNbaV19O3JldHVybiBzbG93KHMpO31yZXR1cm4gZ2V0T3JpZW50YXRpb25cIilcbiAgcHJvY0FyZ3MucHVzaChjb2RlLmpvaW4oXCJcIikpXG5cbiAgdmFyIHByb2MgPSBGdW5jdGlvbi5hcHBseSh1bmRlZmluZWQsIHByb2NBcmdzKVxuICBtb2R1bGUuZXhwb3J0cyA9IHByb2MuYXBwbHkodW5kZWZpbmVkLCBbc2xvd09yaWVudF0uY29uY2F0KENBQ0hFRCkpXG4gIGZvcih2YXIgaT0wOyBpPD1OVU1fRVhQQU5EOyArK2kpIHtcbiAgICBtb2R1bGUuZXhwb3J0c1tpXSA9IENBQ0hFRFtpXVxuICB9XG59XG5cbmdlbmVyYXRlT3JpZW50YXRpb25Qcm9jKCkiLCJcInVzZSBzdHJpY3RcIlxuXG4vL0hpZ2ggbGV2ZWwgaWRlYTpcbi8vIDEuIFVzZSBDbGFya3NvbidzIGluY3JlbWVudGFsIGNvbnN0cnVjdGlvbiB0byBmaW5kIGNvbnZleCBodWxsXG4vLyAyLiBQb2ludCBsb2NhdGlvbiBpbiB0cmlhbmd1bGF0aW9uIGJ5IGp1bXAgYW5kIHdhbGtcblxubW9kdWxlLmV4cG9ydHMgPSBpbmNyZW1lbnRhbENvbnZleEh1bGxcblxudmFyIG9yaWVudCA9IHJlcXVpcmUoXCJyb2J1c3Qtb3JpZW50YXRpb25cIilcbnZhciBjb21wYXJlQ2VsbCA9IHJlcXVpcmUoXCJzaW1wbGljaWFsLWNvbXBsZXhcIikuY29tcGFyZUNlbGxzXG5cbmZ1bmN0aW9uIGNvbXBhcmVJbnQoYSwgYikge1xuICByZXR1cm4gYSAtIGJcbn1cblxuZnVuY3Rpb24gU2ltcGxleCh2ZXJ0aWNlcywgYWRqYWNlbnQsIGJvdW5kYXJ5KSB7XG4gIHRoaXMudmVydGljZXMgPSB2ZXJ0aWNlc1xuICB0aGlzLmFkamFjZW50ID0gYWRqYWNlbnRcbiAgdGhpcy5ib3VuZGFyeSA9IGJvdW5kYXJ5XG4gIHRoaXMubGFzdFZpc2l0ZWQgPSAtMVxufVxuXG5TaW1wbGV4LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24oKSB7XG4gIHZhciB0ID0gdGhpcy52ZXJ0aWNlc1swXVxuICB0aGlzLnZlcnRpY2VzWzBdID0gdGhpcy52ZXJ0aWNlc1sxXVxuICB0aGlzLnZlcnRpY2VzWzFdID0gdFxuICB2YXIgdSA9IHRoaXMuYWRqYWNlbnRbMF1cbiAgdGhpcy5hZGphY2VudFswXSA9IHRoaXMuYWRqYWNlbnRbMV1cbiAgdGhpcy5hZGphY2VudFsxXSA9IHVcbn1cblxuZnVuY3Rpb24gR2x1ZUZhY2V0KHZlcnRpY2VzLCBjZWxsLCBpbmRleCkge1xuICB0aGlzLnZlcnRpY2VzID0gdmVydGljZXNcbiAgdGhpcy5jZWxsID0gY2VsbFxuICB0aGlzLmluZGV4ID0gaW5kZXhcbn1cblxuZnVuY3Rpb24gY29tcGFyZUdsdWUoYSwgYikge1xuICByZXR1cm4gY29tcGFyZUNlbGwoYS52ZXJ0aWNlcywgYi52ZXJ0aWNlcylcbn1cblxuZnVuY3Rpb24gYmFrZU9yaWVudChkKSB7XG4gIHZhciBjb2RlID0gW1wiZnVuY3Rpb24gb3JpZW50KCl7dmFyIHR1cGxlPXRoaXMudHVwbGU7cmV0dXJuIHRlc3QoXCJdXG4gIGZvcih2YXIgaT0wOyBpPD1kOyArK2kpIHtcbiAgICBpZihpID4gMCkge1xuICAgICAgY29kZS5wdXNoKFwiLFwiKVxuICAgIH1cbiAgICBjb2RlLnB1c2goXCJ0dXBsZVtcIiwgaSwgXCJdXCIpXG4gIH1cbiAgY29kZS5wdXNoKFwiKX1yZXR1cm4gb3JpZW50XCIpXG4gIHZhciBwcm9jID0gbmV3IEZ1bmN0aW9uKFwidGVzdFwiLCBjb2RlLmpvaW4oXCJcIikpXG4gIHZhciB0ZXN0ID0gb3JpZW50W2QrMV1cbiAgaWYoIXRlc3QpIHtcbiAgICB0ZXN0ID0gb3JpZW50XG4gIH1cbiAgcmV0dXJuIHByb2ModGVzdClcbn1cblxudmFyIEJBS0VEID0gW11cblxuZnVuY3Rpb24gVHJpYW5ndWxhdGlvbihkaW1lbnNpb24sIHZlcnRpY2VzLCBzaW1wbGljZXMpIHtcbiAgdGhpcy5kaW1lbnNpb24gPSBkaW1lbnNpb25cbiAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzXG4gIHRoaXMuc2ltcGxpY2VzID0gc2ltcGxpY2VzXG4gIHRoaXMuaW50ZXJpb3IgPSBzaW1wbGljZXMuZmlsdGVyKGZ1bmN0aW9uKGMpIHtcbiAgICByZXR1cm4gIWMuYm91bmRhcnlcbiAgfSlcblxuICB0aGlzLnR1cGxlID0gbmV3IEFycmF5KGRpbWVuc2lvbisxKVxuICBmb3IodmFyIGk9MDsgaTw9ZGltZW5zaW9uOyArK2kpIHtcbiAgICB0aGlzLnR1cGxlW2ldID0gdGhpcy52ZXJ0aWNlc1tpXVxuICB9XG5cbiAgdmFyIG8gPSBCQUtFRFtkaW1lbnNpb25dXG4gIGlmKCFvKSB7XG4gICAgbyA9IEJBS0VEW2RpbWVuc2lvbl0gPSBiYWtlT3JpZW50KGRpbWVuc2lvbilcbiAgfVxuICB0aGlzLm9yaWVudCA9IG9cbn1cblxudmFyIHByb3RvID0gVHJpYW5ndWxhdGlvbi5wcm90b3R5cGVcblxuLy9EZWdlbmVyYXRlIHNpdHVhdGlvbiB3aGVyZSB3ZSBhcmUgb24gYm91bmRhcnksIGJ1dCBjb3BsYW5hciB0byBmYWNlXG5wcm90by5oYW5kbGVCb3VuZGFyeURlZ2VuZXJhY3kgPSBmdW5jdGlvbihjZWxsLCBwb2ludCkge1xuICB2YXIgZCA9IHRoaXMuZGltZW5zaW9uXG4gIHZhciBuID0gdGhpcy52ZXJ0aWNlcy5sZW5ndGggLSAxXG4gIHZhciB0dXBsZSA9IHRoaXMudHVwbGVcbiAgdmFyIHZlcnRzID0gdGhpcy52ZXJ0aWNlc1xuXG4gIC8vRHVtYiBzb2x1dGlvbjogSnVzdCBkbyBkZnMgZnJvbSBib3VuZGFyeSBjZWxsIHVudGlsIHdlIGZpbmQgYW55IHBlYWssIG9yIHRlcm1pbmF0ZVxuICB2YXIgdG9WaXNpdCA9IFsgY2VsbCBdXG4gIGNlbGwubGFzdFZpc2l0ZWQgPSAtblxuICB3aGlsZSh0b1Zpc2l0Lmxlbmd0aCA+IDApIHtcbiAgICBjZWxsID0gdG9WaXNpdC5wb3AoKVxuICAgIHZhciBjZWxsVmVydHMgPSBjZWxsLnZlcnRpY2VzXG4gICAgdmFyIGNlbGxBZGogPSBjZWxsLmFkamFjZW50XG4gICAgZm9yKHZhciBpPTA7IGk8PWQ7ICsraSkge1xuICAgICAgdmFyIG5laWdoYm9yID0gY2VsbEFkaltpXVxuICAgICAgaWYoIW5laWdoYm9yLmJvdW5kYXJ5IHx8IG5laWdoYm9yLmxhc3RWaXNpdGVkIDw9IC1uKSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICB2YXIgbnYgPSBuZWlnaGJvci52ZXJ0aWNlc1xuICAgICAgZm9yKHZhciBqPTA7IGo8PWQ7ICsraikge1xuICAgICAgICB2YXIgdnYgPSBudltqXVxuICAgICAgICBpZih2diA8IDApIHtcbiAgICAgICAgICB0dXBsZVtqXSA9IHBvaW50XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdHVwbGVbal0gPSB2ZXJ0c1t2dl1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIG8gPSB0aGlzLm9yaWVudCgpXG4gICAgICBpZihvID4gMCkge1xuICAgICAgICByZXR1cm4gbmVpZ2hib3JcbiAgICAgIH1cbiAgICAgIG5laWdoYm9yLmxhc3RWaXNpdGVkID0gLW5cbiAgICAgIGlmKG8gPT09IDApIHtcbiAgICAgICAgdG9WaXNpdC5wdXNoKG5laWdoYm9yKVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbFxufVxuXG5wcm90by53YWxrID0gZnVuY3Rpb24ocG9pbnQsIHJhbmRvbSkge1xuICAvL0FsaWFzIGxvY2FsIHByb3BlcnRpZXNcbiAgdmFyIG4gPSB0aGlzLnZlcnRpY2VzLmxlbmd0aCAtIDFcbiAgdmFyIGQgPSB0aGlzLmRpbWVuc2lvblxuICB2YXIgdmVydHMgPSB0aGlzLnZlcnRpY2VzXG4gIHZhciB0dXBsZSA9IHRoaXMudHVwbGVcblxuICAvL0NvbXB1dGUgaW5pdGlhbCBqdW1wIGNlbGxcbiAgdmFyIGluaXRJbmRleCA9IHJhbmRvbSA/ICh0aGlzLmludGVyaW9yLmxlbmd0aCAqIE1hdGgucmFuZG9tKCkpfDAgOiAodGhpcy5pbnRlcmlvci5sZW5ndGgtMSlcbiAgdmFyIGNlbGwgPSB0aGlzLmludGVyaW9yWyBpbml0SW5kZXggXVxuXG4gIC8vU3RhcnQgd2Fsa2luZ1xub3V0ZXJMb29wOlxuICB3aGlsZSghY2VsbC5ib3VuZGFyeSkge1xuICAgIHZhciBjZWxsVmVydHMgPSBjZWxsLnZlcnRpY2VzXG4gICAgdmFyIGNlbGxBZGogPSBjZWxsLmFkamFjZW50XG5cbiAgICBmb3IodmFyIGk9MDsgaTw9ZDsgKytpKSB7XG4gICAgICB0dXBsZVtpXSA9IHZlcnRzW2NlbGxWZXJ0c1tpXV1cbiAgICB9XG4gICAgY2VsbC5sYXN0VmlzaXRlZCA9IG5cblxuICAgIC8vRmluZCBmYXJ0aGVzdCBhZGphY2VudCBjZWxsXG4gICAgZm9yKHZhciBpPTA7IGk8PWQ7ICsraSkge1xuICAgICAgdmFyIG5laWdoYm9yID0gY2VsbEFkaltpXVxuICAgICAgaWYobmVpZ2hib3IubGFzdFZpc2l0ZWQgPj0gbikge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgdmFyIHByZXYgPSB0dXBsZVtpXVxuICAgICAgdHVwbGVbaV0gPSBwb2ludFxuICAgICAgdmFyIG8gPSB0aGlzLm9yaWVudCgpXG4gICAgICB0dXBsZVtpXSA9IHByZXZcbiAgICAgIGlmKG8gPCAwKSB7XG4gICAgICAgIGNlbGwgPSBuZWlnaGJvclxuICAgICAgICBjb250aW51ZSBvdXRlckxvb3BcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmKCFuZWlnaGJvci5ib3VuZGFyeSkge1xuICAgICAgICAgIG5laWdoYm9yLmxhc3RWaXNpdGVkID0gblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5laWdoYm9yLmxhc3RWaXNpdGVkID0gLW5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm5cbiAgfVxuXG4gIHJldHVybiBjZWxsXG59XG5cbnByb3RvLmFkZFBlYWtzID0gZnVuY3Rpb24ocG9pbnQsIGNlbGwpIHtcbiAgdmFyIG4gPSB0aGlzLnZlcnRpY2VzLmxlbmd0aCAtIDFcbiAgdmFyIGQgPSB0aGlzLmRpbWVuc2lvblxuICB2YXIgdmVydHMgPSB0aGlzLnZlcnRpY2VzXG4gIHZhciB0dXBsZSA9IHRoaXMudHVwbGVcbiAgdmFyIGludGVyaW9yID0gdGhpcy5pbnRlcmlvclxuICB2YXIgc2ltcGxpY2VzID0gdGhpcy5zaW1wbGljZXNcblxuICAvL1dhbGtpbmcgZmluaXNoZWQgYXQgYm91bmRhcnksIHRpbWUgdG8gYWRkIHBlYWtzXG4gIHZhciB0b3Zpc2l0ID0gWyBjZWxsIF1cblxuICAvL1N0cmV0Y2ggaW5pdGlhbCBib3VuZGFyeSBjZWxsIGludG8gYSBwZWFrXG4gIGNlbGwubGFzdFZpc2l0ZWQgPSBuXG4gIGNlbGwudmVydGljZXNbY2VsbC52ZXJ0aWNlcy5pbmRleE9mKC0xKV0gPSBuXG4gIGNlbGwuYm91bmRhcnkgPSBmYWxzZVxuICBpbnRlcmlvci5wdXNoKGNlbGwpXG5cbiAgLy9SZWNvcmQgYSBsaXN0IG9mIGFsbCBuZXcgYm91bmRhcmllcyBjcmVhdGVkIGJ5IGFkZGVkIHBlYWtzIHNvIHdlIGNhbiBnbHVlIHRoZW0gdG9nZXRoZXIgd2hlbiB3ZSBhcmUgYWxsIGRvbmVcbiAgdmFyIGdsdWVGYWNldHMgPSBbXVxuXG4gIC8vRG8gYSB0cmF2ZXJzYWwgb2YgdGhlIGJvdW5kYXJ5IHdhbGtpbmcgb3V0d2FyZCBmcm9tIHN0YXJ0aW5nIHBlYWtcbiAgd2hpbGUodG92aXNpdC5sZW5ndGggPiAwKSB7XG4gICAgLy9Qb3Agb2ZmIHBlYWsgYW5kIHdhbGsgb3ZlciBhZGphY2VudCBjZWxsc1xuICAgIHZhciBjZWxsID0gdG92aXNpdC5wb3AoKVxuICAgIHZhciBjZWxsVmVydHMgPSBjZWxsLnZlcnRpY2VzXG4gICAgdmFyIGNlbGxBZGogPSBjZWxsLmFkamFjZW50XG4gICAgdmFyIGluZGV4T2ZOID0gY2VsbFZlcnRzLmluZGV4T2YobilcbiAgICBpZihpbmRleE9mTiA8IDApIHtcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuXG4gICAgZm9yKHZhciBpPTA7IGk8PWQ7ICsraSkge1xuICAgICAgaWYoaSA9PT0gaW5kZXhPZk4pIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy9Gb3IgZWFjaCBib3VuZGFyeSBuZWlnaGJvciBvZiB0aGUgY2VsbFxuICAgICAgdmFyIG5laWdoYm9yID0gY2VsbEFkaltpXVxuICAgICAgaWYoIW5laWdoYm9yLmJvdW5kYXJ5IHx8IG5laWdoYm9yLmxhc3RWaXNpdGVkID49IG4pIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgdmFyIG52ID0gbmVpZ2hib3IudmVydGljZXNcblxuICAgICAgLy9UZXN0IGlmIG5laWdoYm9yIGlzIGEgcGVha1xuICAgICAgaWYobmVpZ2hib3IubGFzdFZpc2l0ZWQgIT09IC1uKSB7ICAgICAgXG4gICAgICAgIC8vQ29tcHV0ZSBvcmllbnRhdGlvbiBvZiBwIHJlbGF0aXZlIHRvIGVhY2ggYm91bmRhcnkgcGVha1xuICAgICAgICB2YXIgaW5kZXhPZk5lZzEgPSAwXG4gICAgICAgIGZvcih2YXIgaj0wOyBqPD1kOyArK2opIHtcbiAgICAgICAgICBpZihudltqXSA8IDApIHtcbiAgICAgICAgICAgIGluZGV4T2ZOZWcxID0galxuICAgICAgICAgICAgdHVwbGVbal0gPSBwb2ludFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0dXBsZVtqXSA9IHZlcnRzW252W2pdXVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgbyA9IHRoaXMub3JpZW50KClcblxuICAgICAgICAvL1Rlc3QgaWYgbmVpZ2hib3IgY2VsbCBpcyBhbHNvIGEgcGVha1xuICAgICAgICBpZihvID4gMCkge1xuICAgICAgICAgIG52W2luZGV4T2ZOZWcxXSA9IG5cbiAgICAgICAgICBuZWlnaGJvci5ib3VuZGFyeSA9IGZhbHNlXG4gICAgICAgICAgaW50ZXJpb3IucHVzaChuZWlnaGJvcilcbiAgICAgICAgICB0b3Zpc2l0LnB1c2gobmVpZ2hib3IpXG4gICAgICAgICAgbmVpZ2hib3IubGFzdFZpc2l0ZWQgPSBuXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZWlnaGJvci5sYXN0VmlzaXRlZCA9IC1uXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIG5hID0gbmVpZ2hib3IuYWRqYWNlbnRcblxuICAgICAgLy9PdGhlcndpc2UsIHJlcGxhY2UgbmVpZ2hib3Igd2l0aCBuZXcgZmFjZVxuICAgICAgdmFyIHZ2ZXJ0cyA9IGNlbGxWZXJ0cy5zbGljZSgpXG4gICAgICB2YXIgdmFkaiA9IGNlbGxBZGouc2xpY2UoKVxuICAgICAgdmFyIG5jZWxsID0gbmV3IFNpbXBsZXgodnZlcnRzLCB2YWRqLCB0cnVlKVxuICAgICAgc2ltcGxpY2VzLnB1c2gobmNlbGwpXG5cbiAgICAgIC8vQ29ubmVjdCB0byBuZWlnaGJvclxuICAgICAgdmFyIG9wcG9zaXRlID0gbmEuaW5kZXhPZihjZWxsKVxuICAgICAgaWYob3Bwb3NpdGUgPCAwKSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICBuYVtvcHBvc2l0ZV0gPSBuY2VsbFxuICAgICAgdmFkaltpbmRleE9mTl0gPSBuZWlnaGJvclxuXG4gICAgICAvL0Nvbm5lY3QgdG8gY2VsbFxuICAgICAgdnZlcnRzW2ldID0gLTFcbiAgICAgIHZhZGpbaV0gPSBjZWxsXG4gICAgICBjZWxsQWRqW2ldID0gbmNlbGxcblxuICAgICAgLy9GbGlwIGZhY2V0XG4gICAgICBuY2VsbC5mbGlwKClcblxuICAgICAgLy9BZGQgdG8gZ2x1ZSBsaXN0XG4gICAgICBmb3IodmFyIGo9MDsgajw9ZDsgKytqKSB7XG4gICAgICAgIHZhciB1dSA9IHZ2ZXJ0c1tqXVxuICAgICAgICBpZih1dSA8IDAgfHwgdXUgPT09IG4pIHtcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICAgIHZhciBuZmFjZSA9IG5ldyBBcnJheShkLTEpXG4gICAgICAgIHZhciBucHRyID0gMFxuICAgICAgICBmb3IodmFyIGs9MDsgazw9ZDsgKytrKSB7XG4gICAgICAgICAgdmFyIHZ2ID0gdnZlcnRzW2tdXG4gICAgICAgICAgaWYodnYgPCAwIHx8IGsgPT09IGopIHtcbiAgICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgICAgfVxuICAgICAgICAgIG5mYWNlW25wdHIrK10gPSB2dlxuICAgICAgICB9XG4gICAgICAgIGdsdWVGYWNldHMucHVzaChuZXcgR2x1ZUZhY2V0KG5mYWNlLCBuY2VsbCwgaikpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy9HbHVlIGJvdW5kYXJ5IGZhY2V0cyB0b2dldGhlclxuICBnbHVlRmFjZXRzLnNvcnQoY29tcGFyZUdsdWUpXG5cbiAgZm9yKHZhciBpPTA7IGkrMTxnbHVlRmFjZXRzLmxlbmd0aDsgaSs9Mikge1xuICAgIHZhciBhID0gZ2x1ZUZhY2V0c1tpXVxuICAgIHZhciBiID0gZ2x1ZUZhY2V0c1tpKzFdXG4gICAgdmFyIGFpID0gYS5pbmRleFxuICAgIHZhciBiaSA9IGIuaW5kZXhcbiAgICBpZihhaSA8IDAgfHwgYmkgPCAwKSB7XG4gICAgICBjb250aW51ZVxuICAgIH1cbiAgICBhLmNlbGwuYWRqYWNlbnRbYS5pbmRleF0gPSBiLmNlbGxcbiAgICBiLmNlbGwuYWRqYWNlbnRbYi5pbmRleF0gPSBhLmNlbGxcbiAgfVxufVxuXG5wcm90by5pbnNlcnQgPSBmdW5jdGlvbihwb2ludCwgcmFuZG9tKSB7XG4gIC8vQWRkIHBvaW50XG4gIHZhciB2ZXJ0cyA9IHRoaXMudmVydGljZXNcbiAgdmVydHMucHVzaChwb2ludClcblxuICB2YXIgY2VsbCA9IHRoaXMud2Fsayhwb2ludCwgcmFuZG9tKVxuICBpZighY2VsbCkge1xuICAgIHJldHVyblxuICB9XG5cbiAgLy9BbGlhcyBsb2NhbCBwcm9wZXJ0aWVzXG4gIHZhciBkID0gdGhpcy5kaW1lbnNpb25cbiAgdmFyIHR1cGxlID0gdGhpcy50dXBsZVxuXG4gIC8vRGVnZW5lcmF0ZSBjYXNlOiBJZiBwb2ludCBpcyBjb3BsYW5hciB0byBjZWxsLCB0aGVuIHdhbGsgdW50aWwgd2UgZmluZCBhIG5vbi1kZWdlbmVyYXRlIGJvdW5kYXJ5XG4gIGZvcih2YXIgaT0wOyBpPD1kOyArK2kpIHtcbiAgICB2YXIgdnYgPSBjZWxsLnZlcnRpY2VzW2ldXG4gICAgaWYodnYgPCAwKSB7XG4gICAgICB0dXBsZVtpXSA9IHBvaW50XG4gICAgfSBlbHNlIHtcbiAgICAgIHR1cGxlW2ldID0gdmVydHNbdnZdXG4gICAgfVxuICB9XG4gIHZhciBvID0gdGhpcy5vcmllbnQodHVwbGUpXG4gIGlmKG8gPCAwKSB7XG4gICAgcmV0dXJuXG4gIH0gZWxzZSBpZihvID09PSAwKSB7XG4gICAgY2VsbCA9IHRoaXMuaGFuZGxlQm91bmRhcnlEZWdlbmVyYWN5KGNlbGwsIHBvaW50KVxuICAgIGlmKCFjZWxsKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG4gIH1cblxuICAvL0FkZCBwZWFrc1xuICB0aGlzLmFkZFBlYWtzKHBvaW50LCBjZWxsKVxufVxuXG4vL0V4dHJhY3QgYWxsIGJvdW5kYXJ5IGNlbGxzXG5wcm90by5ib3VuZGFyeSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZCA9IHRoaXMuZGltZW5zaW9uXG4gIHZhciBib3VuZGFyeSA9IFtdXG4gIHZhciBjZWxscyA9IHRoaXMuc2ltcGxpY2VzXG4gIHZhciBuYyA9IGNlbGxzLmxlbmd0aFxuICBmb3IodmFyIGk9MDsgaTxuYzsgKytpKSB7XG4gICAgdmFyIGMgPSBjZWxsc1tpXVxuICAgIGlmKGMuYm91bmRhcnkpIHtcbiAgICAgIHZhciBiY2VsbCA9IG5ldyBBcnJheShkKVxuICAgICAgdmFyIGN2ID0gYy52ZXJ0aWNlc1xuICAgICAgdmFyIHB0ciA9IDBcbiAgICAgIHZhciBwYXJpdHkgPSAwXG4gICAgICBmb3IodmFyIGo9MDsgajw9ZDsgKytqKSB7XG4gICAgICAgIGlmKGN2W2pdID49IDApIHtcbiAgICAgICAgICBiY2VsbFtwdHIrK10gPSBjdltqXVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBhcml0eSA9IGomMVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZihwYXJpdHkgPT09IChkJjEpKSB7XG4gICAgICAgIHZhciB0ID0gYmNlbGxbMF1cbiAgICAgICAgYmNlbGxbMF0gPSBiY2VsbFsxXVxuICAgICAgICBiY2VsbFsxXSA9IHRcbiAgICAgIH1cbiAgICAgIGJvdW5kYXJ5LnB1c2goYmNlbGwpXG4gICAgfVxuICB9XG4gIHJldHVybiBib3VuZGFyeVxufVxuXG5mdW5jdGlvbiBpbmNyZW1lbnRhbENvbnZleEh1bGwocG9pbnRzLCByYW5kb21TZWFyY2gpIHtcbiAgdmFyIG4gPSBwb2ludHMubGVuZ3RoXG4gIGlmKG4gPT09IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNdXN0IGhhdmUgYXQgbGVhc3QgZCsxIHBvaW50c1wiKVxuICB9XG4gIHZhciBkID0gcG9pbnRzWzBdLmxlbmd0aFxuICBpZihuIDw9IGQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJNdXN0IGlucHV0IGF0IGxlYXN0IGQrMSBwb2ludHNcIilcbiAgfVxuXG4gIC8vRklYTUU6IFRoaXMgY291bGQgYmUgZGVnZW5lcmF0ZSwgYnV0IG5lZWQgdG8gc2VsZWN0IGQrMSBub24tY29wbGFuYXIgcG9pbnRzIHRvIGJvb3RzdHJhcCBwcm9jZXNzXG4gIHZhciBpbml0aWFsU2ltcGxleCA9IHBvaW50cy5zbGljZSgwLCBkKzEpXG5cbiAgLy9NYWtlIHN1cmUgaW5pdGlhbCBzaW1wbGV4IGlzIHBvc2l0aXZlbHkgb3JpZW50ZWRcbiAgdmFyIG8gPSBvcmllbnQuYXBwbHkodm9pZCAwLCBpbml0aWFsU2ltcGxleClcbiAgaWYobyA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIklucHV0IG5vdCBpbiBnZW5lcmFsIHBvc2l0aW9uXCIpXG4gIH1cbiAgdmFyIGluaXRpYWxDb29yZHMgPSBuZXcgQXJyYXkoZCsxKVxuICBmb3IodmFyIGk9MDsgaTw9ZDsgKytpKSB7XG4gICAgaW5pdGlhbENvb3Jkc1tpXSA9IGlcbiAgfVxuICBpZihvIDwgMCkge1xuICAgIGluaXRpYWxDb29yZHNbMF0gPSAxXG4gICAgaW5pdGlhbENvb3Jkc1sxXSA9IDBcbiAgfVxuXG4gIC8vQ3JlYXRlIGluaXRpYWwgdG9wb2xvZ2ljYWwgaW5kZXgsIGdsdWUgcG9pbnRlcnMgdG9nZXRoZXIgKGtpbmQgb2YgbWVzc3kpXG4gIHZhciBpbml0aWFsQ2VsbCA9IG5ldyBTaW1wbGV4KGluaXRpYWxDb29yZHMsIG5ldyBBcnJheShkKzEpLCBmYWxzZSlcbiAgdmFyIGJvdW5kYXJ5ID0gaW5pdGlhbENlbGwuYWRqYWNlbnRcbiAgdmFyIGxpc3QgPSBuZXcgQXJyYXkoZCsyKVxuICBmb3IodmFyIGk9MDsgaTw9ZDsgKytpKSB7XG4gICAgdmFyIHZlcnRzID0gaW5pdGlhbENvb3Jkcy5zbGljZSgpXG4gICAgZm9yKHZhciBqPTA7IGo8PWQ7ICsraikge1xuICAgICAgaWYoaiA9PT0gaSkge1xuICAgICAgICB2ZXJ0c1tqXSA9IC0xXG4gICAgICB9XG4gICAgfVxuICAgIHZhciB0ID0gdmVydHNbMF1cbiAgICB2ZXJ0c1swXSA9IHZlcnRzWzFdXG4gICAgdmVydHNbMV0gPSB0XG4gICAgdmFyIGNlbGwgPSBuZXcgU2ltcGxleCh2ZXJ0cywgbmV3IEFycmF5KGQrMSksIHRydWUpXG4gICAgYm91bmRhcnlbaV0gPSBjZWxsXG4gICAgbGlzdFtpXSA9IGNlbGxcbiAgfVxuICBsaXN0W2QrMV0gPSBpbml0aWFsQ2VsbFxuICBmb3IodmFyIGk9MDsgaTw9ZDsgKytpKSB7XG4gICAgdmFyIHZlcnRzID0gYm91bmRhcnlbaV0udmVydGljZXNcbiAgICB2YXIgYWRqID0gYm91bmRhcnlbaV0uYWRqYWNlbnRcbiAgICBmb3IodmFyIGo9MDsgajw9ZDsgKytqKSB7XG4gICAgICB2YXIgdiA9IHZlcnRzW2pdXG4gICAgICBpZih2IDwgMCkge1xuICAgICAgICBhZGpbal0gPSBpbml0aWFsQ2VsbFxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgZm9yKHZhciBrPTA7IGs8PWQ7ICsraykge1xuICAgICAgICBpZihib3VuZGFyeVtrXS52ZXJ0aWNlcy5pbmRleE9mKHYpIDwgMCkge1xuICAgICAgICAgIGFkaltqXSA9IGJvdW5kYXJ5W2tdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvL0luaXRpYWxpemUgdHJpYW5nbGVzXG4gIHZhciB0cmlhbmdsZXMgPSBuZXcgVHJpYW5ndWxhdGlvbihkLCBpbml0aWFsU2ltcGxleCwgbGlzdClcblxuICAvL0luc2VydCByZW1haW5pbmcgcG9pbnRzXG4gIHZhciB1c2VSYW5kb20gPSAhIXJhbmRvbVNlYXJjaFxuICBmb3IodmFyIGk9ZCsxOyBpPG47ICsraSkge1xuICAgIHRyaWFuZ2xlcy5pbnNlcnQocG9pbnRzW2ldLCB1c2VSYW5kb20pXG4gIH1cbiAgXG4gIC8vRXh0cmFjdCBib3VuZGFyeSBjZWxsc1xuICByZXR1cm4gdHJpYW5nbGVzLmJvdW5kYXJ5KClcbn0iLCIvKipcbiAqIEJpdCB0d2lkZGxpbmcgaGFja3MgZm9yIEphdmFTY3JpcHQuXG4gKlxuICogQXV0aG9yOiBNaWtvbGEgTHlzZW5rb1xuICpcbiAqIFBvcnRlZCBmcm9tIFN0YW5mb3JkIGJpdCB0d2lkZGxpbmcgaGFjayBsaWJyYXJ5OlxuICogICAgaHR0cDovL2dyYXBoaWNzLnN0YW5mb3JkLmVkdS9+c2VhbmRlci9iaXRoYWNrcy5odG1sXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7IFwidXNlIHJlc3RyaWN0XCI7XG5cbi8vTnVtYmVyIG9mIGJpdHMgaW4gYW4gaW50ZWdlclxudmFyIElOVF9CSVRTID0gMzI7XG5cbi8vQ29uc3RhbnRzXG5leHBvcnRzLklOVF9CSVRTICA9IElOVF9CSVRTO1xuZXhwb3J0cy5JTlRfTUFYICAgPSAgMHg3ZmZmZmZmZjtcbmV4cG9ydHMuSU5UX01JTiAgID0gLTE8PChJTlRfQklUUy0xKTtcblxuLy9SZXR1cm5zIC0xLCAwLCArMSBkZXBlbmRpbmcgb24gc2lnbiBvZiB4XG5leHBvcnRzLnNpZ24gPSBmdW5jdGlvbih2KSB7XG4gIHJldHVybiAodiA+IDApIC0gKHYgPCAwKTtcbn1cblxuLy9Db21wdXRlcyBhYnNvbHV0ZSB2YWx1ZSBvZiBpbnRlZ2VyXG5leHBvcnRzLmFicyA9IGZ1bmN0aW9uKHYpIHtcbiAgdmFyIG1hc2sgPSB2ID4+IChJTlRfQklUUy0xKTtcbiAgcmV0dXJuICh2IF4gbWFzaykgLSBtYXNrO1xufVxuXG4vL0NvbXB1dGVzIG1pbmltdW0gb2YgaW50ZWdlcnMgeCBhbmQgeVxuZXhwb3J0cy5taW4gPSBmdW5jdGlvbih4LCB5KSB7XG4gIHJldHVybiB5IF4gKCh4IF4geSkgJiAtKHggPCB5KSk7XG59XG5cbi8vQ29tcHV0ZXMgbWF4aW11bSBvZiBpbnRlZ2VycyB4IGFuZCB5XG5leHBvcnRzLm1heCA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgcmV0dXJuIHggXiAoKHggXiB5KSAmIC0oeCA8IHkpKTtcbn1cblxuLy9DaGVja3MgaWYgYSBudW1iZXIgaXMgYSBwb3dlciBvZiB0d29cbmV4cG9ydHMuaXNQb3cyID0gZnVuY3Rpb24odikge1xuICByZXR1cm4gISh2ICYgKHYtMSkpICYmICghIXYpO1xufVxuXG4vL0NvbXB1dGVzIGxvZyBiYXNlIDIgb2YgdlxuZXhwb3J0cy5sb2cyID0gZnVuY3Rpb24odikge1xuICB2YXIgciwgc2hpZnQ7XG4gIHIgPSAgICAgKHYgPiAweEZGRkYpIDw8IDQ7IHYgPj4+PSByO1xuICBzaGlmdCA9ICh2ID4gMHhGRiAgKSA8PCAzOyB2ID4+Pj0gc2hpZnQ7IHIgfD0gc2hpZnQ7XG4gIHNoaWZ0ID0gKHYgPiAweEYgICApIDw8IDI7IHYgPj4+PSBzaGlmdDsgciB8PSBzaGlmdDtcbiAgc2hpZnQgPSAodiA+IDB4MyAgICkgPDwgMTsgdiA+Pj49IHNoaWZ0OyByIHw9IHNoaWZ0O1xuICByZXR1cm4gciB8ICh2ID4+IDEpO1xufVxuXG4vL0NvbXB1dGVzIGxvZyBiYXNlIDEwIG9mIHZcbmV4cG9ydHMubG9nMTAgPSBmdW5jdGlvbih2KSB7XG4gIHJldHVybiAgKHYgPj0gMTAwMDAwMDAwMCkgPyA5IDogKHYgPj0gMTAwMDAwMDAwKSA/IDggOiAodiA+PSAxMDAwMDAwMCkgPyA3IDpcbiAgICAgICAgICAodiA+PSAxMDAwMDAwKSA/IDYgOiAodiA+PSAxMDAwMDApID8gNSA6ICh2ID49IDEwMDAwKSA/IDQgOlxuICAgICAgICAgICh2ID49IDEwMDApID8gMyA6ICh2ID49IDEwMCkgPyAyIDogKHYgPj0gMTApID8gMSA6IDA7XG59XG5cbi8vQ291bnRzIG51bWJlciBvZiBiaXRzXG5leHBvcnRzLnBvcENvdW50ID0gZnVuY3Rpb24odikge1xuICB2ID0gdiAtICgodiA+Pj4gMSkgJiAweDU1NTU1NTU1KTtcbiAgdiA9ICh2ICYgMHgzMzMzMzMzMykgKyAoKHYgPj4+IDIpICYgMHgzMzMzMzMzMyk7XG4gIHJldHVybiAoKHYgKyAodiA+Pj4gNCkgJiAweEYwRjBGMEYpICogMHgxMDEwMTAxKSA+Pj4gMjQ7XG59XG5cbi8vQ291bnRzIG51bWJlciBvZiB0cmFpbGluZyB6ZXJvc1xuZnVuY3Rpb24gY291bnRUcmFpbGluZ1plcm9zKHYpIHtcbiAgdmFyIGMgPSAzMjtcbiAgdiAmPSAtdjtcbiAgaWYgKHYpIGMtLTtcbiAgaWYgKHYgJiAweDAwMDBGRkZGKSBjIC09IDE2O1xuICBpZiAodiAmIDB4MDBGRjAwRkYpIGMgLT0gODtcbiAgaWYgKHYgJiAweDBGMEYwRjBGKSBjIC09IDQ7XG4gIGlmICh2ICYgMHgzMzMzMzMzMykgYyAtPSAyO1xuICBpZiAodiAmIDB4NTU1NTU1NTUpIGMgLT0gMTtcbiAgcmV0dXJuIGM7XG59XG5leHBvcnRzLmNvdW50VHJhaWxpbmdaZXJvcyA9IGNvdW50VHJhaWxpbmdaZXJvcztcblxuLy9Sb3VuZHMgdG8gbmV4dCBwb3dlciBvZiAyXG5leHBvcnRzLm5leHRQb3cyID0gZnVuY3Rpb24odikge1xuICB2ICs9IHYgPT09IDA7XG4gIC0tdjtcbiAgdiB8PSB2ID4+PiAxO1xuICB2IHw9IHYgPj4+IDI7XG4gIHYgfD0gdiA+Pj4gNDtcbiAgdiB8PSB2ID4+PiA4O1xuICB2IHw9IHYgPj4+IDE2O1xuICByZXR1cm4gdiArIDE7XG59XG5cbi8vUm91bmRzIGRvd24gdG8gcHJldmlvdXMgcG93ZXIgb2YgMlxuZXhwb3J0cy5wcmV2UG93MiA9IGZ1bmN0aW9uKHYpIHtcbiAgdiB8PSB2ID4+PiAxO1xuICB2IHw9IHYgPj4+IDI7XG4gIHYgfD0gdiA+Pj4gNDtcbiAgdiB8PSB2ID4+PiA4O1xuICB2IHw9IHYgPj4+IDE2O1xuICByZXR1cm4gdiAtICh2Pj4+MSk7XG59XG5cbi8vQ29tcHV0ZXMgcGFyaXR5IG9mIHdvcmRcbmV4cG9ydHMucGFyaXR5ID0gZnVuY3Rpb24odikge1xuICB2IF49IHYgPj4+IDE2O1xuICB2IF49IHYgPj4+IDg7XG4gIHYgXj0gdiA+Pj4gNDtcbiAgdiAmPSAweGY7XG4gIHJldHVybiAoMHg2OTk2ID4+PiB2KSAmIDE7XG59XG5cbnZhciBSRVZFUlNFX1RBQkxFID0gbmV3IEFycmF5KDI1Nik7XG5cbihmdW5jdGlvbih0YWIpIHtcbiAgZm9yKHZhciBpPTA7IGk8MjU2OyArK2kpIHtcbiAgICB2YXIgdiA9IGksIHIgPSBpLCBzID0gNztcbiAgICBmb3IgKHYgPj4+PSAxOyB2OyB2ID4+Pj0gMSkge1xuICAgICAgciA8PD0gMTtcbiAgICAgIHIgfD0gdiAmIDE7XG4gICAgICAtLXM7XG4gICAgfVxuICAgIHRhYltpXSA9IChyIDw8IHMpICYgMHhmZjtcbiAgfVxufSkoUkVWRVJTRV9UQUJMRSk7XG5cbi8vUmV2ZXJzZSBiaXRzIGluIGEgMzIgYml0IHdvcmRcbmV4cG9ydHMucmV2ZXJzZSA9IGZ1bmN0aW9uKHYpIHtcbiAgcmV0dXJuICAoUkVWRVJTRV9UQUJMRVsgdiAgICAgICAgICYgMHhmZl0gPDwgMjQpIHxcbiAgICAgICAgICAoUkVWRVJTRV9UQUJMRVsodiA+Pj4gOCkgICYgMHhmZl0gPDwgMTYpIHxcbiAgICAgICAgICAoUkVWRVJTRV9UQUJMRVsodiA+Pj4gMTYpICYgMHhmZl0gPDwgOCkgIHxcbiAgICAgICAgICAgUkVWRVJTRV9UQUJMRVsodiA+Pj4gMjQpICYgMHhmZl07XG59XG5cbi8vSW50ZXJsZWF2ZSBiaXRzIG9mIDIgY29vcmRpbmF0ZXMgd2l0aCAxNiBiaXRzLiAgVXNlZnVsIGZvciBmYXN0IHF1YWR0cmVlIGNvZGVzXG5leHBvcnRzLmludGVybGVhdmUyID0gZnVuY3Rpb24oeCwgeSkge1xuICB4ICY9IDB4RkZGRjtcbiAgeCA9ICh4IHwgKHggPDwgOCkpICYgMHgwMEZGMDBGRjtcbiAgeCA9ICh4IHwgKHggPDwgNCkpICYgMHgwRjBGMEYwRjtcbiAgeCA9ICh4IHwgKHggPDwgMikpICYgMHgzMzMzMzMzMztcbiAgeCA9ICh4IHwgKHggPDwgMSkpICYgMHg1NTU1NTU1NTtcblxuICB5ICY9IDB4RkZGRjtcbiAgeSA9ICh5IHwgKHkgPDwgOCkpICYgMHgwMEZGMDBGRjtcbiAgeSA9ICh5IHwgKHkgPDwgNCkpICYgMHgwRjBGMEYwRjtcbiAgeSA9ICh5IHwgKHkgPDwgMikpICYgMHgzMzMzMzMzMztcbiAgeSA9ICh5IHwgKHkgPDwgMSkpICYgMHg1NTU1NTU1NTtcblxuICByZXR1cm4geCB8ICh5IDw8IDEpO1xufVxuXG4vL0V4dHJhY3RzIHRoZSBudGggaW50ZXJsZWF2ZWQgY29tcG9uZW50XG5leHBvcnRzLmRlaW50ZXJsZWF2ZTIgPSBmdW5jdGlvbih2LCBuKSB7XG4gIHYgPSAodiA+Pj4gbikgJiAweDU1NTU1NTU1O1xuICB2ID0gKHYgfCAodiA+Pj4gMSkpICAmIDB4MzMzMzMzMzM7XG4gIHYgPSAodiB8ICh2ID4+PiAyKSkgICYgMHgwRjBGMEYwRjtcbiAgdiA9ICh2IHwgKHYgPj4+IDQpKSAgJiAweDAwRkYwMEZGO1xuICB2ID0gKHYgfCAodiA+Pj4gMTYpKSAmIDB4MDAwRkZGRjtcbiAgcmV0dXJuICh2IDw8IDE2KSA+PiAxNjtcbn1cblxuXG4vL0ludGVybGVhdmUgYml0cyBvZiAzIGNvb3JkaW5hdGVzLCBlYWNoIHdpdGggMTAgYml0cy4gIFVzZWZ1bCBmb3IgZmFzdCBvY3RyZWUgY29kZXNcbmV4cG9ydHMuaW50ZXJsZWF2ZTMgPSBmdW5jdGlvbih4LCB5LCB6KSB7XG4gIHggJj0gMHgzRkY7XG4gIHggID0gKHggfCAoeDw8MTYpKSAmIDQyNzgxOTAzMzU7XG4gIHggID0gKHggfCAoeDw8OCkpICAmIDI1MTcxOTY5NTtcbiAgeCAgPSAoeCB8ICh4PDw0KSkgICYgMzI3MjM1NjAzNTtcbiAgeCAgPSAoeCB8ICh4PDwyKSkgICYgMTIyNzEzMzUxMztcblxuICB5ICY9IDB4M0ZGO1xuICB5ICA9ICh5IHwgKHk8PDE2KSkgJiA0Mjc4MTkwMzM1O1xuICB5ICA9ICh5IHwgKHk8PDgpKSAgJiAyNTE3MTk2OTU7XG4gIHkgID0gKHkgfCAoeTw8NCkpICAmIDMyNzIzNTYwMzU7XG4gIHkgID0gKHkgfCAoeTw8MikpICAmIDEyMjcxMzM1MTM7XG4gIHggfD0gKHkgPDwgMSk7XG4gIFxuICB6ICY9IDB4M0ZGO1xuICB6ICA9ICh6IHwgKHo8PDE2KSkgJiA0Mjc4MTkwMzM1O1xuICB6ICA9ICh6IHwgKHo8PDgpKSAgJiAyNTE3MTk2OTU7XG4gIHogID0gKHogfCAoejw8NCkpICAmIDMyNzIzNTYwMzU7XG4gIHogID0gKHogfCAoejw8MikpICAmIDEyMjcxMzM1MTM7XG4gIFxuICByZXR1cm4geCB8ICh6IDw8IDIpO1xufVxuXG4vL0V4dHJhY3RzIG50aCBpbnRlcmxlYXZlZCBjb21wb25lbnQgb2YgYSAzLXR1cGxlXG5leHBvcnRzLmRlaW50ZXJsZWF2ZTMgPSBmdW5jdGlvbih2LCBuKSB7XG4gIHYgPSAodiA+Pj4gbikgICAgICAgJiAxMjI3MTMzNTEzO1xuICB2ID0gKHYgfCAodj4+PjIpKSAgICYgMzI3MjM1NjAzNTtcbiAgdiA9ICh2IHwgKHY+Pj40KSkgICAmIDI1MTcxOTY5NTtcbiAgdiA9ICh2IHwgKHY+Pj44KSkgICAmIDQyNzgxOTAzMzU7XG4gIHYgPSAodiB8ICh2Pj4+MTYpKSAgJiAweDNGRjtcbiAgcmV0dXJuICh2PDwyMik+PjIyO1xufVxuXG4vL0NvbXB1dGVzIG5leHQgY29tYmluYXRpb24gaW4gY29sZXhpY29ncmFwaGljIG9yZGVyICh0aGlzIGlzIG1pc3Rha2VubHkgY2FsbGVkIG5leHRQZXJtdXRhdGlvbiBvbiB0aGUgYml0IHR3aWRkbGluZyBoYWNrcyBwYWdlKVxuZXhwb3J0cy5uZXh0Q29tYmluYXRpb24gPSBmdW5jdGlvbih2KSB7XG4gIHZhciB0ID0gdiB8ICh2IC0gMSk7XG4gIHJldHVybiAodCArIDEpIHwgKCgofnQgJiAtfnQpIC0gMSkgPj4+IChjb3VudFRyYWlsaW5nWmVyb3ModikgKyAxKSk7XG59XG5cbiIsIlwidXNlIHN0cmljdFwiOyBcInVzZSByZXN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFVuaW9uRmluZDtcblxuZnVuY3Rpb24gVW5pb25GaW5kKGNvdW50KSB7XG4gIHRoaXMucm9vdHMgPSBuZXcgQXJyYXkoY291bnQpO1xuICB0aGlzLnJhbmtzID0gbmV3IEFycmF5KGNvdW50KTtcbiAgXG4gIGZvcih2YXIgaT0wOyBpPGNvdW50OyArK2kpIHtcbiAgICB0aGlzLnJvb3RzW2ldID0gaTtcbiAgICB0aGlzLnJhbmtzW2ldID0gMDtcbiAgfVxufVxuXG52YXIgcHJvdG8gPSBVbmlvbkZpbmQucHJvdG90eXBlXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90bywgXCJsZW5ndGhcIiwge1xuICBcImdldFwiOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5yb290cy5sZW5ndGhcbiAgfVxufSlcblxucHJvdG8ubWFrZVNldCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgbiA9IHRoaXMucm9vdHMubGVuZ3RoO1xuICB0aGlzLnJvb3RzLnB1c2gobik7XG4gIHRoaXMucmFua3MucHVzaCgwKTtcbiAgcmV0dXJuIG47XG59XG5cbnByb3RvLmZpbmQgPSBmdW5jdGlvbih4KSB7XG4gIHZhciB4MCA9IHhcbiAgdmFyIHJvb3RzID0gdGhpcy5yb290cztcbiAgd2hpbGUocm9vdHNbeF0gIT09IHgpIHtcbiAgICB4ID0gcm9vdHNbeF1cbiAgfVxuICB3aGlsZShyb290c1t4MF0gIT09IHgpIHtcbiAgICB2YXIgeSA9IHJvb3RzW3gwXVxuICAgIHJvb3RzW3gwXSA9IHhcbiAgICB4MCA9IHlcbiAgfVxuICByZXR1cm4geDtcbn1cblxucHJvdG8ubGluayA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgdmFyIHhyID0gdGhpcy5maW5kKHgpXG4gICAgLCB5ciA9IHRoaXMuZmluZCh5KTtcbiAgaWYoeHIgPT09IHlyKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciByYW5rcyA9IHRoaXMucmFua3NcbiAgICAsIHJvb3RzID0gdGhpcy5yb290c1xuICAgICwgeGQgICAgPSByYW5rc1t4cl1cbiAgICAsIHlkICAgID0gcmFua3NbeXJdO1xuICBpZih4ZCA8IHlkKSB7XG4gICAgcm9vdHNbeHJdID0geXI7XG4gIH0gZWxzZSBpZih5ZCA8IHhkKSB7XG4gICAgcm9vdHNbeXJdID0geHI7XG4gIH0gZWxzZSB7XG4gICAgcm9vdHNbeXJdID0geHI7XG4gICAgKytyYW5rc1t4cl07XG4gIH1cbn0iLCJcInVzZSBzdHJpY3RcIjsgXCJ1c2UgcmVzdHJpY3RcIjtcblxudmFyIGJpdHMgICAgICA9IHJlcXVpcmUoXCJiaXQtdHdpZGRsZVwiKVxuICAsIFVuaW9uRmluZCA9IHJlcXVpcmUoXCJ1bmlvbi1maW5kXCIpXG5cbi8vUmV0dXJucyB0aGUgZGltZW5zaW9uIG9mIGEgY2VsbCBjb21wbGV4XG5mdW5jdGlvbiBkaW1lbnNpb24oY2VsbHMpIHtcbiAgdmFyIGQgPSAwXG4gICAgLCBtYXggPSBNYXRoLm1heFxuICBmb3IodmFyIGk9MCwgaWw9Y2VsbHMubGVuZ3RoOyBpPGlsOyArK2kpIHtcbiAgICBkID0gbWF4KGQsIGNlbGxzW2ldLmxlbmd0aClcbiAgfVxuICByZXR1cm4gZC0xXG59XG5leHBvcnRzLmRpbWVuc2lvbiA9IGRpbWVuc2lvblxuXG4vL0NvdW50cyB0aGUgbnVtYmVyIG9mIHZlcnRpY2VzIGluIGZhY2VzXG5mdW5jdGlvbiBjb3VudFZlcnRpY2VzKGNlbGxzKSB7XG4gIHZhciB2YyA9IC0xXG4gICAgLCBtYXggPSBNYXRoLm1heFxuICBmb3IodmFyIGk9MCwgaWw9Y2VsbHMubGVuZ3RoOyBpPGlsOyArK2kpIHtcbiAgICB2YXIgYyA9IGNlbGxzW2ldXG4gICAgZm9yKHZhciBqPTAsIGpsPWMubGVuZ3RoOyBqPGpsOyArK2opIHtcbiAgICAgIHZjID0gbWF4KHZjLCBjW2pdKVxuICAgIH1cbiAgfVxuICByZXR1cm4gdmMrMVxufVxuZXhwb3J0cy5jb3VudFZlcnRpY2VzID0gY291bnRWZXJ0aWNlc1xuXG4vL1JldHVybnMgYSBkZWVwIGNvcHkgb2YgY2VsbHNcbmZ1bmN0aW9uIGNsb25lQ2VsbHMoY2VsbHMpIHtcbiAgdmFyIG5jZWxscyA9IG5ldyBBcnJheShjZWxscy5sZW5ndGgpXG4gIGZvcih2YXIgaT0wLCBpbD1jZWxscy5sZW5ndGg7IGk8aWw7ICsraSkge1xuICAgIG5jZWxsc1tpXSA9IGNlbGxzW2ldLnNsaWNlKDApXG4gIH1cbiAgcmV0dXJuIG5jZWxsc1xufVxuZXhwb3J0cy5jbG9uZUNlbGxzID0gY2xvbmVDZWxsc1xuXG4vL1JhbmtzIGEgcGFpciBvZiBjZWxscyB1cCB0byBwZXJtdXRhdGlvblxuZnVuY3Rpb24gY29tcGFyZUNlbGxzKGEsIGIpIHtcbiAgdmFyIG4gPSBhLmxlbmd0aFxuICAgICwgdCA9IGEubGVuZ3RoIC0gYi5sZW5ndGhcbiAgICAsIG1pbiA9IE1hdGgubWluXG4gIGlmKHQpIHtcbiAgICByZXR1cm4gdFxuICB9XG4gIHN3aXRjaChuKSB7XG4gICAgY2FzZSAwOlxuICAgICAgcmV0dXJuIDA7XG4gICAgY2FzZSAxOlxuICAgICAgcmV0dXJuIGFbMF0gLSBiWzBdO1xuICAgIGNhc2UgMjpcbiAgICAgIHZhciBkID0gYVswXSthWzFdLWJbMF0tYlsxXVxuICAgICAgaWYoZCkge1xuICAgICAgICByZXR1cm4gZFxuICAgICAgfVxuICAgICAgcmV0dXJuIG1pbihhWzBdLGFbMV0pIC0gbWluKGJbMF0sYlsxXSlcbiAgICBjYXNlIDM6XG4gICAgICB2YXIgbDEgPSBhWzBdK2FbMV1cbiAgICAgICAgLCBtMSA9IGJbMF0rYlsxXVxuICAgICAgZCA9IGwxK2FbMl0gLSAobTErYlsyXSlcbiAgICAgIGlmKGQpIHtcbiAgICAgICAgcmV0dXJuIGRcbiAgICAgIH1cbiAgICAgIHZhciBsMCA9IG1pbihhWzBdLCBhWzFdKVxuICAgICAgICAsIG0wID0gbWluKGJbMF0sIGJbMV0pXG4gICAgICAgICwgZCAgPSBtaW4obDAsIGFbMl0pIC0gbWluKG0wLCBiWzJdKVxuICAgICAgaWYoZCkge1xuICAgICAgICByZXR1cm4gZFxuICAgICAgfVxuICAgICAgcmV0dXJuIG1pbihsMCthWzJdLCBsMSkgLSBtaW4obTArYlsyXSwgbTEpXG4gICAgXG4gICAgLy9UT0RPOiBNYXliZSBvcHRpbWl6ZSBuPTQgYXMgd2VsbD9cbiAgICBcbiAgICBkZWZhdWx0OlxuICAgICAgdmFyIGFzID0gYS5zbGljZSgwKVxuICAgICAgYXMuc29ydCgpXG4gICAgICB2YXIgYnMgPSBiLnNsaWNlKDApXG4gICAgICBicy5zb3J0KClcbiAgICAgIGZvcih2YXIgaT0wOyBpPG47ICsraSkge1xuICAgICAgICB0ID0gYXNbaV0gLSBic1tpXVxuICAgICAgICBpZih0KSB7XG4gICAgICAgICAgcmV0dXJuIHRcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIDBcbiAgfVxufVxuZXhwb3J0cy5jb21wYXJlQ2VsbHMgPSBjb21wYXJlQ2VsbHNcblxuZnVuY3Rpb24gY29tcGFyZVppcHBlZChhLCBiKSB7XG4gIHJldHVybiBjb21wYXJlQ2VsbHMoYVswXSwgYlswXSlcbn1cblxuLy9QdXRzIGEgY2VsbCBjb21wbGV4IGludG8gbm9ybWFsIG9yZGVyIGZvciB0aGUgcHVycG9zZXMgb2YgZmluZENlbGwgcXVlcmllc1xuZnVuY3Rpb24gbm9ybWFsaXplKGNlbGxzLCBhdHRyKSB7XG4gIGlmKGF0dHIpIHtcbiAgICB2YXIgbGVuID0gY2VsbHMubGVuZ3RoXG4gICAgdmFyIHppcHBlZCA9IG5ldyBBcnJheShsZW4pXG4gICAgZm9yKHZhciBpPTA7IGk8bGVuOyArK2kpIHtcbiAgICAgIHppcHBlZFtpXSA9IFtjZWxsc1tpXSwgYXR0cltpXV1cbiAgICB9XG4gICAgemlwcGVkLnNvcnQoY29tcGFyZVppcHBlZClcbiAgICBmb3IodmFyIGk9MDsgaTxsZW47ICsraSkge1xuICAgICAgY2VsbHNbaV0gPSB6aXBwZWRbaV1bMF1cbiAgICAgIGF0dHJbaV0gPSB6aXBwZWRbaV1bMV1cbiAgICB9XG4gICAgcmV0dXJuIGNlbGxzXG4gIH0gZWxzZSB7XG4gICAgY2VsbHMuc29ydChjb21wYXJlQ2VsbHMpXG4gICAgcmV0dXJuIGNlbGxzXG4gIH1cbn1cbmV4cG9ydHMubm9ybWFsaXplID0gbm9ybWFsaXplXG5cbi8vUmVtb3ZlcyBhbGwgZHVwbGljYXRlIGNlbGxzIGluIHRoZSBjb21wbGV4XG5mdW5jdGlvbiB1bmlxdWUoY2VsbHMpIHtcbiAgaWYoY2VsbHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIFtdXG4gIH1cbiAgdmFyIHB0ciA9IDFcbiAgICAsIGxlbiA9IGNlbGxzLmxlbmd0aFxuICBmb3IodmFyIGk9MTsgaTxsZW47ICsraSkge1xuICAgIHZhciBhID0gY2VsbHNbaV1cbiAgICBpZihjb21wYXJlQ2VsbHMoYSwgY2VsbHNbaS0xXSkpIHtcbiAgICAgIGlmKGkgPT09IHB0cikge1xuICAgICAgICBwdHIrK1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgY2VsbHNbcHRyKytdID0gYVxuICAgIH1cbiAgfVxuICBjZWxscy5sZW5ndGggPSBwdHJcbiAgcmV0dXJuIGNlbGxzXG59XG5leHBvcnRzLnVuaXF1ZSA9IHVuaXF1ZTtcblxuLy9GaW5kcyBhIGNlbGwgaW4gYSBub3JtYWxpemVkIGNlbGwgY29tcGxleFxuZnVuY3Rpb24gZmluZENlbGwoY2VsbHMsIGMpIHtcbiAgdmFyIGxvID0gMFxuICAgICwgaGkgPSBjZWxscy5sZW5ndGgtMVxuICAgICwgciAgPSAtMVxuICB3aGlsZSAobG8gPD0gaGkpIHtcbiAgICB2YXIgbWlkID0gKGxvICsgaGkpID4+IDFcbiAgICAgICwgcyAgID0gY29tcGFyZUNlbGxzKGNlbGxzW21pZF0sIGMpXG4gICAgaWYocyA8PSAwKSB7XG4gICAgICBpZihzID09PSAwKSB7XG4gICAgICAgIHIgPSBtaWRcbiAgICAgIH1cbiAgICAgIGxvID0gbWlkICsgMVxuICAgIH0gZWxzZSBpZihzID4gMCkge1xuICAgICAgaGkgPSBtaWQgLSAxXG4gICAgfVxuICB9XG4gIHJldHVybiByXG59XG5leHBvcnRzLmZpbmRDZWxsID0gZmluZENlbGw7XG5cbi8vQnVpbGRzIGFuIGluZGV4IGZvciBhbiBuLWNlbGwuICBUaGlzIGlzIG1vcmUgZ2VuZXJhbCB0aGFuIGR1YWwsIGJ1dCBsZXNzIGVmZmljaWVudFxuZnVuY3Rpb24gaW5jaWRlbmNlKGZyb21fY2VsbHMsIHRvX2NlbGxzKSB7XG4gIHZhciBpbmRleCA9IG5ldyBBcnJheShmcm9tX2NlbGxzLmxlbmd0aClcbiAgZm9yKHZhciBpPTAsIGlsPWluZGV4Lmxlbmd0aDsgaTxpbDsgKytpKSB7XG4gICAgaW5kZXhbaV0gPSBbXVxuICB9XG4gIHZhciBiID0gW11cbiAgZm9yKHZhciBpPTAsIG49dG9fY2VsbHMubGVuZ3RoOyBpPG47ICsraSkge1xuICAgIHZhciBjID0gdG9fY2VsbHNbaV1cbiAgICB2YXIgY2wgPSBjLmxlbmd0aFxuICAgIGZvcih2YXIgaz0xLCBrbj0oMTw8Y2wpOyBrPGtuOyArK2spIHtcbiAgICAgIGIubGVuZ3RoID0gYml0cy5wb3BDb3VudChrKVxuICAgICAgdmFyIGwgPSAwXG4gICAgICBmb3IodmFyIGo9MDsgajxjbDsgKytqKSB7XG4gICAgICAgIGlmKGsgJiAoMTw8aikpIHtcbiAgICAgICAgICBiW2wrK10gPSBjW2pdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBpZHg9ZmluZENlbGwoZnJvbV9jZWxscywgYilcbiAgICAgIGlmKGlkeCA8IDApIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIHdoaWxlKHRydWUpIHtcbiAgICAgICAgaW5kZXhbaWR4KytdLnB1c2goaSlcbiAgICAgICAgaWYoaWR4ID49IGZyb21fY2VsbHMubGVuZ3RoIHx8IGNvbXBhcmVDZWxscyhmcm9tX2NlbGxzW2lkeF0sIGIpICE9PSAwKSB7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gaW5kZXhcbn1cbmV4cG9ydHMuaW5jaWRlbmNlID0gaW5jaWRlbmNlXG5cbi8vQ29tcHV0ZXMgdGhlIGR1YWwgb2YgdGhlIG1lc2guICBUaGlzIGlzIGJhc2ljYWxseSBhbiBvcHRpbWl6ZWQgdmVyc2lvbiBvZiBidWlsZEluZGV4IGZvciB0aGUgc2l0dWF0aW9uIHdoZXJlIGZyb21fY2VsbHMgaXMganVzdCB0aGUgbGlzdCBvZiB2ZXJ0aWNlc1xuZnVuY3Rpb24gZHVhbChjZWxscywgdmVydGV4X2NvdW50KSB7XG4gIGlmKCF2ZXJ0ZXhfY291bnQpIHtcbiAgICByZXR1cm4gaW5jaWRlbmNlKHVuaXF1ZShza2VsZXRvbihjZWxscywgMCkpLCBjZWxscywgMClcbiAgfVxuICB2YXIgcmVzID0gbmV3IEFycmF5KHZlcnRleF9jb3VudClcbiAgZm9yKHZhciBpPTA7IGk8dmVydGV4X2NvdW50OyArK2kpIHtcbiAgICByZXNbaV0gPSBbXVxuICB9XG4gIGZvcih2YXIgaT0wLCBsZW49Y2VsbHMubGVuZ3RoOyBpPGxlbjsgKytpKSB7XG4gICAgdmFyIGMgPSBjZWxsc1tpXVxuICAgIGZvcih2YXIgaj0wLCBjbD1jLmxlbmd0aDsgajxjbDsgKytqKSB7XG4gICAgICByZXNbY1tqXV0ucHVzaChpKVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzXG59XG5leHBvcnRzLmR1YWwgPSBkdWFsXG5cbi8vRW51bWVyYXRlcyBhbGwgY2VsbHMgaW4gdGhlIGNvbXBsZXhcbmZ1bmN0aW9uIGV4cGxvZGUoY2VsbHMpIHtcbiAgdmFyIHJlc3VsdCA9IFtdXG4gIGZvcih2YXIgaT0wLCBpbD1jZWxscy5sZW5ndGg7IGk8aWw7ICsraSkge1xuICAgIHZhciBjID0gY2VsbHNbaV1cbiAgICAgICwgY2wgPSBjLmxlbmd0aHwwXG4gICAgZm9yKHZhciBqPTEsIGpsPSgxPDxjbCk7IGo8amw7ICsraikge1xuICAgICAgdmFyIGIgPSBbXVxuICAgICAgZm9yKHZhciBrPTA7IGs8Y2w7ICsraykge1xuICAgICAgICBpZigoaiA+Pj4gaykgJiAxKSB7XG4gICAgICAgICAgYi5wdXNoKGNba10pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJlc3VsdC5wdXNoKGIpXG4gICAgfVxuICB9XG4gIHJldHVybiBub3JtYWxpemUocmVzdWx0KVxufVxuZXhwb3J0cy5leHBsb2RlID0gZXhwbG9kZVxuXG4vL0VudW1lcmF0ZXMgYWxsIG9mIHRoZSBuLWNlbGxzIG9mIGEgY2VsbCBjb21wbGV4XG5mdW5jdGlvbiBza2VsZXRvbihjZWxscywgbikge1xuICBpZihuIDwgMCkge1xuICAgIHJldHVybiBbXVxuICB9XG4gIHZhciByZXN1bHQgPSBbXVxuICAgICwgazAgICAgID0gKDE8PChuKzEpKS0xXG4gIGZvcih2YXIgaT0wOyBpPGNlbGxzLmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGMgPSBjZWxsc1tpXVxuICAgIGZvcih2YXIgaz1rMDsgazwoMTw8Yy5sZW5ndGgpOyBrPWJpdHMubmV4dENvbWJpbmF0aW9uKGspKSB7XG4gICAgICB2YXIgYiA9IG5ldyBBcnJheShuKzEpXG4gICAgICAgICwgbCA9IDBcbiAgICAgIGZvcih2YXIgaj0wOyBqPGMubGVuZ3RoOyArK2opIHtcbiAgICAgICAgaWYoayAmICgxPDxqKSkge1xuICAgICAgICAgIGJbbCsrXSA9IGNbal1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzdWx0LnB1c2goYilcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5vcm1hbGl6ZShyZXN1bHQpXG59XG5leHBvcnRzLnNrZWxldG9uID0gc2tlbGV0b247XG5cbi8vQ29tcHV0ZXMgdGhlIGJvdW5kYXJ5IG9mIGFsbCBjZWxscywgZG9lcyBub3QgcmVtb3ZlIGR1cGxpY2F0ZXNcbmZ1bmN0aW9uIGJvdW5kYXJ5KGNlbGxzKSB7XG4gIHZhciByZXMgPSBbXVxuICBmb3IodmFyIGk9MCxpbD1jZWxscy5sZW5ndGg7IGk8aWw7ICsraSkge1xuICAgIHZhciBjID0gY2VsbHNbaV1cbiAgICBmb3IodmFyIGo9MCxjbD1jLmxlbmd0aDsgajxjbDsgKytqKSB7XG4gICAgICB2YXIgYiA9IG5ldyBBcnJheShjLmxlbmd0aC0xKVxuICAgICAgZm9yKHZhciBrPTAsIGw9MDsgazxjbDsgKytrKSB7XG4gICAgICAgIGlmKGsgIT09IGopIHtcbiAgICAgICAgICBiW2wrK10gPSBjW2tdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJlcy5wdXNoKGIpXG4gICAgfVxuICB9XG4gIHJldHVybiBub3JtYWxpemUocmVzKVxufVxuZXhwb3J0cy5ib3VuZGFyeSA9IGJvdW5kYXJ5O1xuXG4vL0NvbXB1dGVzIGNvbm5lY3RlZCBjb21wb25lbnRzIGZvciBhIGRlbnNlIGNlbGwgY29tcGxleFxuZnVuY3Rpb24gY29ubmVjdGVkQ29tcG9uZW50c19kZW5zZShjZWxscywgdmVydGV4X2NvdW50KSB7XG4gIHZhciBsYWJlbHMgPSBuZXcgVW5pb25GaW5kKHZlcnRleF9jb3VudClcbiAgZm9yKHZhciBpPTA7IGk8Y2VsbHMubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYyA9IGNlbGxzW2ldXG4gICAgZm9yKHZhciBqPTA7IGo8Yy5sZW5ndGg7ICsraikge1xuICAgICAgZm9yKHZhciBrPWorMTsgazxjLmxlbmd0aDsgKytrKSB7XG4gICAgICAgIGxhYmVscy5saW5rKGNbal0sIGNba10pXG4gICAgICB9XG4gICAgfVxuICB9XG4gIHZhciBjb21wb25lbnRzID0gW11cbiAgICAsIGNvbXBvbmVudF9sYWJlbHMgPSBsYWJlbHMucmFua3NcbiAgZm9yKHZhciBpPTA7IGk8Y29tcG9uZW50X2xhYmVscy5sZW5ndGg7ICsraSkge1xuICAgIGNvbXBvbmVudF9sYWJlbHNbaV0gPSAtMVxuICB9XG4gIGZvcih2YXIgaT0wOyBpPGNlbGxzLmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGwgPSBsYWJlbHMuZmluZChjZWxsc1tpXVswXSlcbiAgICBpZihjb21wb25lbnRfbGFiZWxzW2xdIDwgMCkge1xuICAgICAgY29tcG9uZW50X2xhYmVsc1tsXSA9IGNvbXBvbmVudHMubGVuZ3RoXG4gICAgICBjb21wb25lbnRzLnB1c2goW2NlbGxzW2ldLnNsaWNlKDApXSlcbiAgICB9IGVsc2Uge1xuICAgICAgY29tcG9uZW50c1tjb21wb25lbnRfbGFiZWxzW2xdXS5wdXNoKGNlbGxzW2ldLnNsaWNlKDApKVxuICAgIH1cbiAgfVxuICByZXR1cm4gY29tcG9uZW50c1xufVxuXG4vL0NvbXB1dGVzIGNvbm5lY3RlZCBjb21wb25lbnRzIGZvciBhIHNwYXJzZSBncmFwaFxuZnVuY3Rpb24gY29ubmVjdGVkQ29tcG9uZW50c19zcGFyc2UoY2VsbHMpIHtcbiAgdmFyIHZlcnRpY2VzICA9IHVuaXF1ZShub3JtYWxpemUoc2tlbGV0b24oY2VsbHMsIDApKSlcbiAgICAsIGxhYmVscyAgICA9IG5ldyBVbmlvbkZpbmQodmVydGljZXMubGVuZ3RoKVxuICBmb3IodmFyIGk9MDsgaTxjZWxscy5sZW5ndGg7ICsraSkge1xuICAgIHZhciBjID0gY2VsbHNbaV1cbiAgICBmb3IodmFyIGo9MDsgajxjLmxlbmd0aDsgKytqKSB7XG4gICAgICB2YXIgdmogPSBmaW5kQ2VsbCh2ZXJ0aWNlcywgW2Nbal1dKVxuICAgICAgZm9yKHZhciBrPWorMTsgazxjLmxlbmd0aDsgKytrKSB7XG4gICAgICAgIGxhYmVscy5saW5rKHZqLCBmaW5kQ2VsbCh2ZXJ0aWNlcywgW2Nba11dKSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgdmFyIGNvbXBvbmVudHMgICAgICAgID0gW11cbiAgICAsIGNvbXBvbmVudF9sYWJlbHMgID0gbGFiZWxzLnJhbmtzXG4gIGZvcih2YXIgaT0wOyBpPGNvbXBvbmVudF9sYWJlbHMubGVuZ3RoOyArK2kpIHtcbiAgICBjb21wb25lbnRfbGFiZWxzW2ldID0gLTFcbiAgfVxuICBmb3IodmFyIGk9MDsgaTxjZWxscy5sZW5ndGg7ICsraSkge1xuICAgIHZhciBsID0gbGFiZWxzLmZpbmQoZmluZENlbGwodmVydGljZXMsIFtjZWxsc1tpXVswXV0pKTtcbiAgICBpZihjb21wb25lbnRfbGFiZWxzW2xdIDwgMCkge1xuICAgICAgY29tcG9uZW50X2xhYmVsc1tsXSA9IGNvbXBvbmVudHMubGVuZ3RoXG4gICAgICBjb21wb25lbnRzLnB1c2goW2NlbGxzW2ldLnNsaWNlKDApXSlcbiAgICB9IGVsc2Uge1xuICAgICAgY29tcG9uZW50c1tjb21wb25lbnRfbGFiZWxzW2xdXS5wdXNoKGNlbGxzW2ldLnNsaWNlKDApKVxuICAgIH1cbiAgfVxuICByZXR1cm4gY29tcG9uZW50c1xufVxuXG4vL0NvbXB1dGVzIGNvbm5lY3RlZCBjb21wb25lbnRzIGZvciBhIGNlbGwgY29tcGxleFxuZnVuY3Rpb24gY29ubmVjdGVkQ29tcG9uZW50cyhjZWxscywgdmVydGV4X2NvdW50KSB7XG4gIGlmKHZlcnRleF9jb3VudCkge1xuICAgIHJldHVybiBjb25uZWN0ZWRDb21wb25lbnRzX2RlbnNlKGNlbGxzLCB2ZXJ0ZXhfY291bnQpXG4gIH1cbiAgcmV0dXJuIGNvbm5lY3RlZENvbXBvbmVudHNfc3BhcnNlKGNlbGxzKVxufVxuZXhwb3J0cy5jb25uZWN0ZWRDb21wb25lbnRzID0gY29ubmVjdGVkQ29tcG9uZW50c1xuIiwiJ3VzZSBzdHJpY3QnXG5cbm1vZHVsZS5leHBvcnRzID0gbW9ub3RvbmVDb252ZXhIdWxsMkRcblxudmFyIG9yaWVudCA9IHJlcXVpcmUoJ3JvYnVzdC1vcmllbnRhdGlvbicpWzNdXG5cbmZ1bmN0aW9uIG1vbm90b25lQ29udmV4SHVsbDJEKHBvaW50cykge1xuICB2YXIgbiA9IHBvaW50cy5sZW5ndGhcblxuICBpZihuIDwgMykge1xuICAgIHZhciByZXN1bHQgPSBuZXcgQXJyYXkobilcbiAgICBmb3IodmFyIGk9MDsgaTxuOyArK2kpIHtcbiAgICAgIHJlc3VsdFtpXSA9IGlcbiAgICB9XG5cbiAgICBpZihuID09PSAyICYmXG4gICAgICAgcG9pbnRzWzBdWzBdID09PSBwb2ludHNbMV1bMF0gJiZcbiAgICAgICBwb2ludHNbMF1bMV0gPT09IHBvaW50c1sxXVsxXSkge1xuICAgICAgcmV0dXJuIFswXVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIC8vU29ydCBwb2ludCBpbmRpY2VzIGFsb25nIHgtYXhpc1xuICB2YXIgc29ydGVkID0gbmV3IEFycmF5KG4pXG4gIGZvcih2YXIgaT0wOyBpPG47ICsraSkge1xuICAgIHNvcnRlZFtpXSA9IGlcbiAgfVxuICBzb3J0ZWQuc29ydChmdW5jdGlvbihhLGIpIHtcbiAgICB2YXIgZCA9IHBvaW50c1thXVswXS1wb2ludHNbYl1bMF1cbiAgICBpZihkKSB7XG4gICAgICByZXR1cm4gZFxuICAgIH1cbiAgICByZXR1cm4gcG9pbnRzW2FdWzFdIC0gcG9pbnRzW2JdWzFdXG4gIH0pXG5cbiAgLy9Db25zdHJ1Y3QgdXBwZXIgYW5kIGxvd2VyIGh1bGxzXG4gIHZhciBsb3dlciA9IFtzb3J0ZWRbMF0sIHNvcnRlZFsxXV1cbiAgdmFyIHVwcGVyID0gW3NvcnRlZFswXSwgc29ydGVkWzFdXVxuXG4gIGZvcih2YXIgaT0yOyBpPG47ICsraSkge1xuICAgIHZhciBpZHggPSBzb3J0ZWRbaV1cbiAgICB2YXIgcCAgID0gcG9pbnRzW2lkeF1cblxuICAgIC8vSW5zZXJ0IGludG8gbG93ZXIgbGlzdFxuICAgIHZhciBtID0gbG93ZXIubGVuZ3RoXG4gICAgd2hpbGUobSA+IDEgJiYgb3JpZW50KFxuICAgICAgICBwb2ludHNbbG93ZXJbbS0yXV0sIFxuICAgICAgICBwb2ludHNbbG93ZXJbbS0xXV0sIFxuICAgICAgICBwKSA8PSAwKSB7XG4gICAgICBtIC09IDFcbiAgICAgIGxvd2VyLnBvcCgpXG4gICAgfVxuICAgIGxvd2VyLnB1c2goaWR4KVxuXG4gICAgLy9JbnNlcnQgaW50byB1cHBlciBsaXN0XG4gICAgbSA9IHVwcGVyLmxlbmd0aFxuICAgIHdoaWxlKG0gPiAxICYmIG9yaWVudChcbiAgICAgICAgcG9pbnRzW3VwcGVyW20tMl1dLCBcbiAgICAgICAgcG9pbnRzW3VwcGVyW20tMV1dLCBcbiAgICAgICAgcCkgPj0gMCkge1xuICAgICAgbSAtPSAxXG4gICAgICB1cHBlci5wb3AoKVxuICAgIH1cbiAgICB1cHBlci5wdXNoKGlkeClcbiAgfVxuXG4gIC8vTWVyZ2UgbGlzdHMgdG9nZXRoZXJcbiAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh1cHBlci5sZW5ndGggKyBsb3dlci5sZW5ndGggLSAyKVxuICB2YXIgcHRyICAgID0gMFxuICBmb3IodmFyIGk9MCwgbmw9bG93ZXIubGVuZ3RoOyBpPG5sOyArK2kpIHtcbiAgICByZXN1bHRbcHRyKytdID0gbG93ZXJbaV1cbiAgfVxuICBmb3IodmFyIGo9dXBwZXIubGVuZ3RoLTI7IGo+MDsgLS1qKSB7XG4gICAgcmVzdWx0W3B0cisrXSA9IHVwcGVyW2pdXG4gIH1cblxuICAvL1JldHVybiByZXN1bHRcbiAgcmV0dXJuIHJlc3VsdFxufSIsInZhciBpbnNpZGUgPSByZXF1aXJlKCd0dXJmLWluc2lkZScpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIGFuZCBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGFuZCBjYWxjdWxhdGVzIHRoZSBudW1iZXIgb2YgcG9pbnRzIHRoYXQgZmFsbCB3aXRoaW4gdGhlIHNldCBvZiBwb2x5Z29ucy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvY291bnRcbiAqIEBjYXRlZ29yeSBhZ2dyZWdhdGlvblxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBjb3VudEZpZWxkIGEgZmllbGQgdG8gYXBwZW5kIHRvIHRoZSBhdHRyaWJ1dGVzIG9mIHRoZSBQb2x5Z29uIGZlYXR1cmVzIHJlcHJlc2VudGluZyBQb2ludCBjb3VudHNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIFBvbHlnb24gZmVhdHVyZXMgd2l0aCBgY291bnRGaWVsZGAgYXBwZW5kZWRcbiAqIEBleGFtcGxlXG4qIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstMTEyLjA3MjM5MSw0Ni41ODY1OTFdLFxuICogICAgICAgICAgIFstMTEyLjA3MjM5MSw0Ni42MTc2MV0sXG4gKiAgICAgICAgICAgWy0xMTIuMDI4MTAyLDQ2LjYxNzYxXSxcbiAqICAgICAgICAgICBbLTExMi4wMjgxMDIsNDYuNTg2NTkxXSxcbiAqICAgICAgICAgICBbLTExMi4wNzIzOTEsNDYuNTg2NTkxXVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbLTExMi4wMjM5ODMsNDYuNTcwNDI2XSxcbiAqICAgICAgICAgICBbLTExMi4wMjM5ODMsNDYuNjE1MDE2XSxcbiAqICAgICAgICAgICBbLTExMS45NjYxMzMsNDYuNjE1MDE2XSxcbiAqICAgICAgICAgICBbLTExMS45NjYxMzMsNDYuNTcwNDI2XSxcbiAqICAgICAgICAgICBbLTExMi4wMjM5ODMsNDYuNTcwNDI2XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTExMi4wMzcyLCA0Ni42MDgwNThdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDYwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstMTEyLjA0NTk1NSwgNDYuNTk2MjY0XVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgY291bnRlZCA9IHR1cmYuY291bnQocG9seWdvbnMsIHBvaW50cywgJ3B0X2NvdW50Jyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChjb3VudGVkLmZlYXR1cmVzKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5RkMsIHB0RkMsIG91dEZpZWxkLCBkb25lKXtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5RkMuZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcG9seSA9IHBvbHlGQy5mZWF0dXJlc1tpXTtcbiAgICBpZighcG9seS5wcm9wZXJ0aWVzKSBwb2x5LnByb3BlcnRpZXMgPSB7fTtcbiAgICB2YXIgdmFsdWVzID0gMDtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHB0RkMuZmVhdHVyZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIHZhciBwdCA9IHB0RkMuZmVhdHVyZXNbal07XG4gICAgICBpZiAoaW5zaWRlKHB0LCBwb2x5KSkge1xuICAgICAgICB2YWx1ZXMrKztcbiAgICAgIH1cbiAgICB9XG4gICAgcG9seS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IHZhbHVlcztcbiAgfVxuXG4gIHJldHVybiBwb2x5RkM7XG59O1xuIiwiLy9odHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0hhdmVyc2luZV9mb3JtdWxhXG4vL2h0dHA6Ly93d3cubW92YWJsZS10eXBlLmNvLnVrL3NjcmlwdHMvbGF0bG9uZy5odG1sXG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgUG9pbnR9IGZlYXR1cmUgYW5kIGNhbGN1bGF0ZXMgdGhlIGxvY2F0aW9uIG9mIGEgZGVzdGluYXRpb24gcG9pbnQgZ2l2ZW4gYSBkaXN0YW5jZSBpbiBkZWdyZWVzLCByYWRpYW5zLCBtaWxlcywgb3Iga2lsb21ldGVyczsgYW5kIGJlYXJpbmcgaW4gZGVncmVlcy4gVGhpcyB1c2VzIHRoZSBbSGF2ZXJzaW5lIGZvcm11bGFdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSGF2ZXJzaW5lX2Zvcm11bGEpIHRvIGFjY291bnQgZm9yIGdsb2JhbCBjdXJ2YXR1cmUuXG4gKlxuICogQG1vZHVsZSB0dXJmL2Rlc3RpbmF0aW9uXG4gKiBAY2F0ZWdvcnkgbWVhc3VyZW1lbnRcbiAqIEBwYXJhbSB7UG9pbnR9IHN0YXJ0IGEgUG9pbnQgZmVhdHVyZSBhdCB0aGUgc3RhcnRpbmcgcG9pbnRcbiAqIEBwYXJhbSB7TnVtYmVyfSBkaXN0YW5jZSBkaXN0YW5jZSBmcm9tIHRoZSBzdGFydGluZyBwb2ludFxuICogQHBhcmFtIHtOdW1iZXJ9IGJlYXJpbmcgcmFuZ2luZyBmcm9tIC0xODAgdG8gMTgwXG4gKiBAcGFyYW0ge1N0cmluZ30gdW5pdHMgbWlsZXMsIGtpbG9tZXRlcnMsIGRlZ3JlZXMsIG9yIHJhZGlhbnNcbiAqIEByZXR1cm5zIHtQb2ludH0gYSBQb2ludCBmZWF0dXJlIGF0IHRoZSBkZXN0aW5hdGlvblxuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwibWFya2VyLWNvbG9yXCI6IFwiIzBmMFwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjM0MywgMzkuOTg0XVxuICogICB9XG4gKiB9O1xuICogdmFyIGRpc3RhbmNlID0gNTA7XG4gKiB2YXIgYmVhcmluZyA9IDkwO1xuICogdmFyIHVuaXRzID0gJ21pbGVzJztcbiAqXG4gKiB2YXIgZGVzdGluYXRpb24gPSB0dXJmLmRlc3RpbmF0aW9uKHBvaW50LCBkaXN0YW5jZSwgYmVhcmluZywgdW5pdHMpO1xuICogZGVzdGluYXRpb24ucHJvcGVydGllc1snbWFya2VyLWNvbG9yJ10gPSAnI2YwMCc7XG4gKlxuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbcG9pbnQsIGRlc3RpbmF0aW9uXVxuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAocG9pbnQxLCBkaXN0YW5jZSwgYmVhcmluZywgdW5pdHMpIHtcbiAgICB2YXIgY29vcmRpbmF0ZXMxID0gcG9pbnQxLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICAgIHZhciBsb25naXR1ZGUxID0gdG9SYWQoY29vcmRpbmF0ZXMxWzBdKTtcbiAgICB2YXIgbGF0aXR1ZGUxID0gdG9SYWQoY29vcmRpbmF0ZXMxWzFdKTtcbiAgICB2YXIgYmVhcmluZ19yYWQgPSB0b1JhZChiZWFyaW5nKTtcblxuICAgIHZhciBSID0gMDtcbiAgICBzd2l0Y2ggKHVuaXRzKSB7XG4gICAgY2FzZSAnbWlsZXMnOlxuICAgICAgICBSID0gMzk2MDtcbiAgICAgICAgYnJlYWtcbiAgICBjYXNlICdraWxvbWV0ZXJzJzpcbiAgICAgICAgUiA9IDYzNzM7XG4gICAgICAgIGJyZWFrXG4gICAgY2FzZSAnZGVncmVlcyc6XG4gICAgICAgIFIgPSA1Ny4yOTU3Nzk1O1xuICAgICAgICBicmVha1xuICAgIGNhc2UgJ3JhZGlhbnMnOlxuICAgICAgICBSID0gMTtcbiAgICAgICAgYnJlYWtcbiAgICB9XG5cbiAgICB2YXIgbGF0aXR1ZGUyID0gTWF0aC5hc2luKE1hdGguc2luKGxhdGl0dWRlMSkgKiBNYXRoLmNvcyhkaXN0YW5jZSAvIFIpICtcbiAgICAgICAgTWF0aC5jb3MobGF0aXR1ZGUxKSAqIE1hdGguc2luKGRpc3RhbmNlIC8gUikgKiBNYXRoLmNvcyhiZWFyaW5nX3JhZCkpO1xuICAgIHZhciBsb25naXR1ZGUyID0gbG9uZ2l0dWRlMSArIE1hdGguYXRhbjIoTWF0aC5zaW4oYmVhcmluZ19yYWQpICogTWF0aC5zaW4oZGlzdGFuY2UgLyBSKSAqIE1hdGguY29zKGxhdGl0dWRlMSksXG4gICAgICAgIE1hdGguY29zKGRpc3RhbmNlIC8gUikgLSBNYXRoLnNpbihsYXRpdHVkZTEpICogTWF0aC5zaW4obGF0aXR1ZGUyKSk7XG5cbiAgICByZXR1cm4gcG9pbnQoW3RvRGVnKGxvbmdpdHVkZTIpLCB0b0RlZyhsYXRpdHVkZTIpXSk7XG59O1xuXG5mdW5jdGlvbiB0b1JhZChkZWdyZWUpIHtcbiAgICByZXR1cm4gZGVncmVlICogTWF0aC5QSSAvIDE4MDtcbn1cblxuZnVuY3Rpb24gdG9EZWcocmFkKSB7XG4gICAgcmV0dXJuIHJhZCAqIDE4MCAvIE1hdGguUEk7XG59XG4iLCJ2YXIgc3MgPSByZXF1aXJlKCdzaW1wbGUtc3RhdGlzdGljcycpO1xudmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIHZhbHVlIG9mIGEgZmllbGQgZm9yIHBvaW50cyB3aXRoaW4gYSBzZXQgb2YgcG9seWdvbnMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2RldmlhdGlvblxuICogQGNhdGVnb3J5IGFnZ3JlZ2F0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtTdHJpbmd9IGluRmllbGQgdGhlIGZpZWxkIGluIGBwb2ludHNgIGZyb20gd2hpY2ggdG8gYWdncmVnYXRlXG4gKiBAcGFyYW0ge1N0cmluZ30gb3V0RmllbGQgdGhlIGZpZWxkIHRvIGFwcGVuZCB0byBgcG9seWdvbnNgIHJlcHJlc2VudGluZyBkZXZpYXRpb25cbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIFBvbHlnb24gZmVhdHVyZXMgd2l0aCBhcHBlbmRlZCBmaWVsZCByZXByZXNlbnRpbmcgZGV2aWF0aW9uXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHlnb25zID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy05Ny44MDcxNTksIDMwLjI3MDMzNV0sXG4gKiAgICAgICAgICAgWy05Ny44MDcxNTksIDMwLjM2OTkxM10sXG4gKiAgICAgICAgICAgWy05Ny42MTI4MzgsIDMwLjM2OTkxM10sXG4gKiAgICAgICAgICAgWy05Ny42MTI4MzgsIDMwLjI3MDMzNV0sXG4gKiAgICAgICAgICAgWy05Ny44MDcxNTksIDMwLjI3MDMzNV1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy05Ny44MjU2OTgsIDMwLjE3NTQwNV0sXG4gKiAgICAgICAgICAgWy05Ny44MjU2OTgsIDMwLjI2NDQwNF0sXG4gKiAgICAgICAgICAgWy05Ny42MzA2OTEsIDMwLjI2NDQwNF0sXG4gKiAgICAgICAgICAgWy05Ny42MzA2OTEsIDMwLjE3NTQwNV0sXG4gKiAgICAgICAgICAgWy05Ny44MjU2OTgsIDMwLjE3NTQwNV1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNTAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny43MDk2NTUsIDMwLjMxMTI0NV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNDAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny43NjY2NDcsIDMwLjM0NTAyOF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny43NjUyNzQsIDMwLjI5NDY0Nl1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNTAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny43NTM2MDEsIDMwLjIxNjM1NV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny42NjcwODMsIDMwLjIwODA0N11cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGluRmllbGQgPSBcInBvcHVsYXRpb25cIjtcbiAqIHZhciBvdXRGaWVsZCA9IFwicG9wX2RldmlhdGlvblwiO1xuICpcbiAqIHZhciBkZXZpYXRlZCA9IHR1cmYuZGV2aWF0aW9uKFxuICogICBwb2x5Z29ucywgcG9pbnRzLCBpbkZpZWxkLCBvdXRGaWVsZCk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChcbiAqICAgZGV2aWF0ZWQuZmVhdHVyZXMpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlGQywgcHRGQywgaW5GaWVsZCwgb3V0RmllbGQsIGRvbmUpe1xuICBwb2x5RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwb2x5KXtcbiAgICBpZighcG9seS5wcm9wZXJ0aWVzKXtcbiAgICAgIHBvbHkucHJvcGVydGllcyA9IHt9O1xuICAgIH1cbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgcHRGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHB0KXtcbiAgICAgIGlmIChpbnNpZGUocHQsIHBvbHkpKSB7XG4gICAgICAgIHZhbHVlcy5wdXNoKHB0LnByb3BlcnRpZXNbaW5GaWVsZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHBvbHkucHJvcGVydGllc1tvdXRGaWVsZF0gPSBzcy5zdGFuZGFyZF9kZXZpYXRpb24odmFsdWVzKTtcbiAgfSlcblxuICByZXR1cm4gcG9seUZDO1xufVxuIiwiLyogZ2xvYmFsIG1vZHVsZSAqL1xuLy8gIyBzaW1wbGUtc3RhdGlzdGljc1xuLy9cbi8vIEEgc2ltcGxlLCBsaXRlcmF0ZSBzdGF0aXN0aWNzIHN5c3RlbS4gVGhlIGNvZGUgYmVsb3cgdXNlcyB0aGVcbi8vIFtKYXZhc2NyaXB0IG1vZHVsZSBwYXR0ZXJuXShodHRwOi8vd3d3LmFkZXF1YXRlbHlnb29kLmNvbS8yMDEwLzMvSmF2YVNjcmlwdC1Nb2R1bGUtUGF0dGVybi1Jbi1EZXB0aCksXG4vLyBldmVudHVhbGx5IGFzc2lnbmluZyBgc2ltcGxlLXN0YXRpc3RpY3NgIHRvIGBzc2AgaW4gYnJvd3NlcnMgb3IgdGhlXG4vLyBgZXhwb3J0c2Agb2JqZWN0IGZvciBub2RlLmpzXG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNzID0ge307XG5cbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgLy8gQXNzaWduIHRoZSBgc3NgIG9iamVjdCB0byBleHBvcnRzLCBzbyB0aGF0IHlvdSBjYW4gcmVxdWlyZVxuICAgICAgICAvLyBpdCBpbiBbbm9kZS5qc10oaHR0cDovL25vZGVqcy5vcmcvKVxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IHNzO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE90aGVyd2lzZSwgaW4gYSBicm93c2VyLCB3ZSBhc3NpZ24gYHNzYCB0byB0aGUgd2luZG93IG9iamVjdCxcbiAgICAgICAgLy8gc28geW91IGNhbiBzaW1wbHkgcmVmZXIgdG8gaXQgYXMgYHNzYC5cbiAgICAgICAgdGhpcy5zcyA9IHNzO1xuICAgIH1cblxuICAgIC8vICMgW0xpbmVhciBSZWdyZXNzaW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xpbmVhcl9yZWdyZXNzaW9uKVxuICAgIC8vXG4gICAgLy8gW1NpbXBsZSBsaW5lYXIgcmVncmVzc2lvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TaW1wbGVfbGluZWFyX3JlZ3Jlc3Npb24pXG4gICAgLy8gaXMgYSBzaW1wbGUgd2F5IHRvIGZpbmQgYSBmaXR0ZWQgbGluZVxuICAgIC8vIGJldHdlZW4gYSBzZXQgb2YgY29vcmRpbmF0ZXMuXG4gICAgZnVuY3Rpb24gbGluZWFyX3JlZ3Jlc3Npb24oKSB7XG4gICAgICAgIHZhciBsaW5yZWcgPSB7fSxcbiAgICAgICAgICAgIGRhdGEgPSBbXTtcblxuICAgICAgICAvLyBBc3NpZ24gZGF0YSB0byB0aGUgbW9kZWwuIERhdGEgaXMgYXNzdW1lZCB0byBiZSBhbiBhcnJheS5cbiAgICAgICAgbGlucmVnLmRhdGEgPSBmdW5jdGlvbih4KSB7XG4gICAgICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgZGF0YSA9IHguc2xpY2UoKTtcbiAgICAgICAgICAgIHJldHVybiBsaW5yZWc7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBzbG9wZSBhbmQgeS1pbnRlcmNlcHQgb2YgdGhlIHJlZ3Jlc3Npb24gbGluZVxuICAgICAgICAvLyBieSBjYWxjdWxhdGluZyB0aGUgbGVhc3Qgc3VtIG9mIHNxdWFyZXNcbiAgICAgICAgbGlucmVnLm1iID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbSwgYjtcblxuICAgICAgICAgICAgLy8gU3RvcmUgZGF0YSBsZW5ndGggaW4gYSBsb2NhbCB2YXJpYWJsZSB0byByZWR1Y2VcbiAgICAgICAgICAgIC8vIHJlcGVhdGVkIG9iamVjdCBwcm9wZXJ0eSBsb29rdXBzXG4gICAgICAgICAgICB2YXIgZGF0YV9sZW5ndGggPSBkYXRhLmxlbmd0aDtcblxuICAgICAgICAgICAgLy9pZiB0aGVyZSdzIG9ubHkgb25lIHBvaW50LCBhcmJpdHJhcmlseSBjaG9vc2UgYSBzbG9wZSBvZiAwXG4gICAgICAgICAgICAvL2FuZCBhIHktaW50ZXJjZXB0IG9mIHdoYXRldmVyIHRoZSB5IG9mIHRoZSBpbml0aWFsIHBvaW50IGlzXG4gICAgICAgICAgICBpZiAoZGF0YV9sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICBtID0gMDtcbiAgICAgICAgICAgICAgICBiID0gZGF0YVswXVsxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBvdXIgc3VtcyBhbmQgc2NvcGUgdGhlIGBtYCBhbmQgYGJgXG4gICAgICAgICAgICAgICAgLy8gdmFyaWFibGVzIHRoYXQgZGVmaW5lIHRoZSBsaW5lLlxuICAgICAgICAgICAgICAgIHZhciBzdW1feCA9IDAsIHN1bV95ID0gMCxcbiAgICAgICAgICAgICAgICAgICAgc3VtX3h4ID0gMCwgc3VtX3h5ID0gMDtcblxuICAgICAgICAgICAgICAgIC8vIFVzZSBsb2NhbCB2YXJpYWJsZXMgdG8gZ3JhYiBwb2ludCB2YWx1ZXNcbiAgICAgICAgICAgICAgICAvLyB3aXRoIG1pbmltYWwgb2JqZWN0IHByb3BlcnR5IGxvb2t1cHNcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnQsIHgsIHk7XG5cbiAgICAgICAgICAgICAgICAvLyBHYXRoZXIgdGhlIHN1bSBvZiBhbGwgeCB2YWx1ZXMsIHRoZSBzdW0gb2YgYWxsXG4gICAgICAgICAgICAgICAgLy8geSB2YWx1ZXMsIGFuZCB0aGUgc3VtIG9mIHheMiBhbmQgKHgqeSkgZm9yIGVhY2hcbiAgICAgICAgICAgICAgICAvLyB2YWx1ZS5cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIEluIG1hdGggbm90YXRpb24sIHRoZXNlIHdvdWxkIGJlIFNTX3gsIFNTX3ksIFNTX3h4LCBhbmQgU1NfeHlcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFfbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcG9pbnQgPSBkYXRhW2ldO1xuICAgICAgICAgICAgICAgICAgICB4ID0gcG9pbnRbMF07XG4gICAgICAgICAgICAgICAgICAgIHkgPSBwb2ludFsxXTtcblxuICAgICAgICAgICAgICAgICAgICBzdW1feCArPSB4O1xuICAgICAgICAgICAgICAgICAgICBzdW1feSArPSB5O1xuXG4gICAgICAgICAgICAgICAgICAgIHN1bV94eCArPSB4ICogeDtcbiAgICAgICAgICAgICAgICAgICAgc3VtX3h5ICs9IHggKiB5O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGBtYCBpcyB0aGUgc2xvcGUgb2YgdGhlIHJlZ3Jlc3Npb24gbGluZVxuICAgICAgICAgICAgICAgIG0gPSAoKGRhdGFfbGVuZ3RoICogc3VtX3h5KSAtIChzdW1feCAqIHN1bV95KSkgL1xuICAgICAgICAgICAgICAgICAgICAoKGRhdGFfbGVuZ3RoICogc3VtX3h4KSAtIChzdW1feCAqIHN1bV94KSk7XG5cbiAgICAgICAgICAgICAgICAvLyBgYmAgaXMgdGhlIHktaW50ZXJjZXB0IG9mIHRoZSBsaW5lLlxuICAgICAgICAgICAgICAgIGIgPSAoc3VtX3kgLyBkYXRhX2xlbmd0aCkgLSAoKG0gKiBzdW1feCkgLyBkYXRhX2xlbmd0aCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJldHVybiBib3RoIHZhbHVlcyBhcyBhbiBvYmplY3QuXG4gICAgICAgICAgICByZXR1cm4geyBtOiBtLCBiOiBiIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYSBzaG9ydGN1dCBmb3Igc2ltcGx5IGdldHRpbmcgdGhlIHNsb3BlIG9mIHRoZSByZWdyZXNzaW9uIGxpbmVcbiAgICAgICAgbGlucmVnLm0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBsaW5yZWcubWIoKS5tO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGEgc2hvcnRjdXQgZm9yIHNpbXBseSBnZXR0aW5nIHRoZSB5LWludGVyY2VwdCBvZiB0aGUgcmVncmVzc2lvblxuICAgICAgICAvLyBsaW5lLlxuICAgICAgICBsaW5yZWcuYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpbnJlZy5tYigpLmI7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gIyMgRml0dGluZyBUaGUgUmVncmVzc2lvbiBMaW5lXG4gICAgICAgIC8vXG4gICAgICAgIC8vIFRoaXMgaXMgY2FsbGVkIGFmdGVyIGAuZGF0YSgpYCBhbmQgcmV0dXJucyB0aGVcbiAgICAgICAgLy8gZXF1YXRpb24gYHkgPSBmKHgpYCB3aGljaCBnaXZlcyB0aGUgcG9zaXRpb25cbiAgICAgICAgLy8gb2YgdGhlIHJlZ3Jlc3Npb24gbGluZSBhdCBlYWNoIHBvaW50IGluIGB4YC5cbiAgICAgICAgbGlucmVnLmxpbmUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgLy8gR2V0IHRoZSBzbG9wZSwgYG1gLCBhbmQgeS1pbnRlcmNlcHQsIGBiYCwgb2YgdGhlIGxpbmUuXG4gICAgICAgICAgICB2YXIgbWIgPSBsaW5yZWcubWIoKSxcbiAgICAgICAgICAgICAgICBtID0gbWIubSxcbiAgICAgICAgICAgICAgICBiID0gbWIuYjtcblxuICAgICAgICAgICAgLy8gUmV0dXJuIGEgZnVuY3Rpb24gdGhhdCBjb21wdXRlcyBhIGB5YCB2YWx1ZSBmb3IgZWFjaFxuICAgICAgICAgICAgLy8geCB2YWx1ZSBpdCBpcyBnaXZlbiwgYmFzZWQgb24gdGhlIHZhbHVlcyBvZiBgYmAgYW5kIGBhYFxuICAgICAgICAgICAgLy8gdGhhdCB3ZSBqdXN0IGNvbXB1dGVkLlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYiArIChtICogeCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBsaW5yZWc7XG4gICAgfVxuXG4gICAgLy8gIyBbUiBTcXVhcmVkXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvZWZmaWNpZW50X29mX2RldGVybWluYXRpb24pXG4gICAgLy9cbiAgICAvLyBUaGUgci1zcXVhcmVkIHZhbHVlIG9mIGRhdGEgY29tcGFyZWQgd2l0aCBhIGZ1bmN0aW9uIGBmYFxuICAgIC8vIGlzIHRoZSBzdW0gb2YgdGhlIHNxdWFyZWQgZGlmZmVyZW5jZXMgYmV0d2VlbiB0aGUgcHJlZGljdGlvblxuICAgIC8vIGFuZCB0aGUgYWN0dWFsIHZhbHVlLlxuICAgIGZ1bmN0aW9uIHJfc3F1YXJlZChkYXRhLCBmKSB7XG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCA8IDIpIHJldHVybiAxO1xuXG4gICAgICAgIC8vIENvbXB1dGUgdGhlIGF2ZXJhZ2UgeSB2YWx1ZSBmb3IgdGhlIGFjdHVhbFxuICAgICAgICAvLyBkYXRhIHNldCBpbiBvcmRlciB0byBjb21wdXRlIHRoZVxuICAgICAgICAvLyBfdG90YWwgc3VtIG9mIHNxdWFyZXNfXG4gICAgICAgIHZhciBzdW0gPSAwLCBhdmVyYWdlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHN1bSArPSBkYXRhW2ldWzFdO1xuICAgICAgICB9XG4gICAgICAgIGF2ZXJhZ2UgPSBzdW0gLyBkYXRhLmxlbmd0aDtcblxuICAgICAgICAvLyBDb21wdXRlIHRoZSB0b3RhbCBzdW0gb2Ygc3F1YXJlcyAtIHRoZVxuICAgICAgICAvLyBzcXVhcmVkIGRpZmZlcmVuY2UgYmV0d2VlbiBlYWNoIHBvaW50XG4gICAgICAgIC8vIGFuZCB0aGUgYXZlcmFnZSBvZiBhbGwgcG9pbnRzLlxuICAgICAgICB2YXIgc3VtX29mX3NxdWFyZXMgPSAwO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGRhdGEubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHN1bV9vZl9zcXVhcmVzICs9IE1hdGgucG93KGF2ZXJhZ2UgLSBkYXRhW2pdWzFdLCAyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbmFsbHkgZXN0aW1hdGUgdGhlIGVycm9yOiB0aGUgc3F1YXJlZFxuICAgICAgICAvLyBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIGVzdGltYXRlIGFuZCB0aGUgYWN0dWFsIGRhdGFcbiAgICAgICAgLy8gdmFsdWUgYXQgZWFjaCBwb2ludC5cbiAgICAgICAgdmFyIGVyciA9IDA7XG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZGF0YS5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgZXJyICs9IE1hdGgucG93KGRhdGFba11bMV0gLSBmKGRhdGFba11bMF0pLCAyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFzIHRoZSBlcnJvciBncm93cyBsYXJnZXIsIGl0cyByYXRpbyB0byB0aGVcbiAgICAgICAgLy8gc3VtIG9mIHNxdWFyZXMgaW5jcmVhc2VzIGFuZCB0aGUgciBzcXVhcmVkXG4gICAgICAgIC8vIHZhbHVlIGdyb3dzIGxvd2VyLlxuICAgICAgICByZXR1cm4gMSAtIChlcnIgLyBzdW1fb2Zfc3F1YXJlcyk7XG4gICAgfVxuXG5cbiAgICAvLyAjIFtCYXllc2lhbiBDbGFzc2lmaWVyXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL05haXZlX0JheWVzX2NsYXNzaWZpZXIpXG4gICAgLy9cbiAgICAvLyBUaGlzIGlzIGEgbmHDr3ZlIGJheWVzaWFuIGNsYXNzaWZpZXIgdGhhdCB0YWtlc1xuICAgIC8vIHNpbmdseS1uZXN0ZWQgb2JqZWN0cy5cbiAgICBmdW5jdGlvbiBiYXllc2lhbigpIHtcbiAgICAgICAgLy8gVGhlIGBiYXllc19tb2RlbGAgb2JqZWN0IGlzIHdoYXQgd2lsbCBiZSBleHBvc2VkXG4gICAgICAgIC8vIGJ5IHRoaXMgY2xvc3VyZSwgd2l0aCBhbGwgb2YgaXRzIGV4dGVuZGVkIG1ldGhvZHMsIGFuZCB3aWxsXG4gICAgICAgIC8vIGhhdmUgYWNjZXNzIHRvIGFsbCBzY29wZSB2YXJpYWJsZXMsIGxpa2UgYHRvdGFsX2NvdW50YC5cbiAgICAgICAgdmFyIGJheWVzX21vZGVsID0ge30sXG4gICAgICAgICAgICAvLyBUaGUgbnVtYmVyIG9mIGl0ZW1zIHRoYXQgYXJlIGN1cnJlbnRseVxuICAgICAgICAgICAgLy8gY2xhc3NpZmllZCBpbiB0aGUgbW9kZWxcbiAgICAgICAgICAgIHRvdGFsX2NvdW50ID0gMCxcbiAgICAgICAgICAgIC8vIEV2ZXJ5IGl0ZW0gY2xhc3NpZmllZCBpbiB0aGUgbW9kZWxcbiAgICAgICAgICAgIGRhdGEgPSB7fTtcblxuICAgICAgICAvLyAjIyBUcmFpblxuICAgICAgICAvLyBUcmFpbiB0aGUgY2xhc3NpZmllciB3aXRoIGEgbmV3IGl0ZW0sIHdoaWNoIGhhcyBhIHNpbmdsZVxuICAgICAgICAvLyBkaW1lbnNpb24gb2YgSmF2YXNjcmlwdCBsaXRlcmFsIGtleXMgYW5kIHZhbHVlcy5cbiAgICAgICAgYmF5ZXNfbW9kZWwudHJhaW4gPSBmdW5jdGlvbihpdGVtLCBjYXRlZ29yeSkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGRhdGEgb2JqZWN0IGRvZXNuJ3QgaGF2ZSBhbnkgdmFsdWVzXG4gICAgICAgICAgICAvLyBmb3IgdGhpcyBjYXRlZ29yeSwgY3JlYXRlIGEgbmV3IG9iamVjdCBmb3IgaXQuXG4gICAgICAgICAgICBpZiAoIWRhdGFbY2F0ZWdvcnldKSBkYXRhW2NhdGVnb3J5XSA9IHt9O1xuXG4gICAgICAgICAgICAvLyBJdGVyYXRlIHRocm91Z2ggZWFjaCBrZXkgaW4gdGhlIGl0ZW0uXG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdiA9IGl0ZW1ba107XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgbmVzdGVkIG9iamVjdCBgZGF0YVtjYXRlZ29yeV1ba11baXRlbVtrXV1gXG4gICAgICAgICAgICAgICAgLy8gd2l0aCBhbiBvYmplY3Qgb2Yga2V5cyB0aGF0IGVxdWFsIDAuXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFbY2F0ZWdvcnldW2tdID09PSB1bmRlZmluZWQpIGRhdGFbY2F0ZWdvcnldW2tdID0ge307XG4gICAgICAgICAgICAgICAgaWYgKGRhdGFbY2F0ZWdvcnldW2tdW3ZdID09PSB1bmRlZmluZWQpIGRhdGFbY2F0ZWdvcnldW2tdW3ZdID0gMDtcblxuICAgICAgICAgICAgICAgIC8vIEFuZCBpbmNyZW1lbnQgdGhlIGtleSBmb3IgdGhpcyBrZXkvdmFsdWUgY29tYmluYXRpb24uXG4gICAgICAgICAgICAgICAgZGF0YVtjYXRlZ29yeV1ba11baXRlbVtrXV0rKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEluY3JlbWVudCB0aGUgbnVtYmVyIG9mIGl0ZW1zIGNsYXNzaWZpZWRcbiAgICAgICAgICAgIHRvdGFsX2NvdW50Kys7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gIyMgU2NvcmVcbiAgICAgICAgLy8gR2VuZXJhdGUgYSBzY29yZSBvZiBob3cgd2VsbCB0aGlzIGl0ZW0gbWF0Y2hlcyBhbGxcbiAgICAgICAgLy8gcG9zc2libGUgY2F0ZWdvcmllcyBiYXNlZCBvbiBpdHMgYXR0cmlidXRlc1xuICAgICAgICBiYXllc19tb2RlbC5zY29yZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgYW4gZW1wdHkgYXJyYXkgb2Ygb2RkcyBwZXIgY2F0ZWdvcnkuXG4gICAgICAgICAgICB2YXIgb2RkcyA9IHt9LCBjYXRlZ29yeTtcbiAgICAgICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBlYWNoIGtleSBpbiB0aGUgaXRlbSxcbiAgICAgICAgICAgIC8vIHRoZW4gaXRlcmF0ZSB0aHJvdWdoIGVhY2ggY2F0ZWdvcnkgdGhhdCBoYXMgYmVlbiB1c2VkXG4gICAgICAgICAgICAvLyBpbiBwcmV2aW91cyBjYWxscyB0byBgLnRyYWluKClgXG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdiA9IGl0ZW1ba107XG4gICAgICAgICAgICAgICAgZm9yIChjYXRlZ29yeSBpbiBkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhbiBlbXB0eSBvYmplY3QgZm9yIHN0b3Jpbmcga2V5IC0gdmFsdWUgY29tYmluYXRpb25zXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIGNhdGVnb3J5LlxuICAgICAgICAgICAgICAgICAgICBpZiAob2Rkc1tjYXRlZ29yeV0gPT09IHVuZGVmaW5lZCkgb2Rkc1tjYXRlZ29yeV0gPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGl0ZW0gZG9lc24ndCBldmVuIGhhdmUgYSBwcm9wZXJ0eSwgaXQgY291bnRzIGZvciBub3RoaW5nLFxuICAgICAgICAgICAgICAgICAgICAvLyBidXQgaWYgaXQgZG9lcyBoYXZlIHRoZSBwcm9wZXJ0eSB0aGF0IHdlJ3JlIGxvb2tpbmcgZm9yIGZyb21cbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGl0ZW0gdG8gY2F0ZWdvcml6ZSwgaXQgY291bnRzIGJhc2VkIG9uIGhvdyBwb3B1bGFyIGl0IGlzXG4gICAgICAgICAgICAgICAgICAgIC8vIHZlcnN1cyB0aGUgd2hvbGUgcG9wdWxhdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbY2F0ZWdvcnldW2tdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZGRzW2NhdGVnb3J5XVtrICsgJ18nICsgdl0gPSAoZGF0YVtjYXRlZ29yeV1ba11bdl0gfHwgMCkgLyB0b3RhbF9jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9kZHNbY2F0ZWdvcnldW2sgKyAnXycgKyB2XSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCB1cCBhIG5ldyBvYmplY3QgdGhhdCB3aWxsIGNvbnRhaW4gc3VtcyBvZiB0aGVzZSBvZGRzIGJ5IGNhdGVnb3J5XG4gICAgICAgICAgICB2YXIgb2Rkc19zdW1zID0ge307XG5cbiAgICAgICAgICAgIGZvciAoY2F0ZWdvcnkgaW4gb2Rkcykge1xuICAgICAgICAgICAgICAgIC8vIFRhbGx5IGFsbCBvZiB0aGUgb2RkcyBmb3IgZWFjaCBjYXRlZ29yeS1jb21iaW5hdGlvbiBwYWlyIC1cbiAgICAgICAgICAgICAgICAvLyB0aGUgbm9uLWV4aXN0ZW5jZSBvZiBhIGNhdGVnb3J5IGRvZXMgbm90IGFkZCBhbnl0aGluZyB0byB0aGVcbiAgICAgICAgICAgICAgICAvLyBzY29yZS5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjb21iaW5hdGlvbiBpbiBvZGRzW2NhdGVnb3J5XSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2Rkc19zdW1zW2NhdGVnb3J5XSA9PT0gdW5kZWZpbmVkKSBvZGRzX3N1bXNbY2F0ZWdvcnldID0gMDtcbiAgICAgICAgICAgICAgICAgICAgb2Rkc19zdW1zW2NhdGVnb3J5XSArPSBvZGRzW2NhdGVnb3J5XVtjb21iaW5hdGlvbl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb2Rkc19zdW1zO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJldHVybiB0aGUgY29tcGxldGVkIG1vZGVsLlxuICAgICAgICByZXR1cm4gYmF5ZXNfbW9kZWw7XG4gICAgfVxuXG4gICAgLy8gIyBzdW1cbiAgICAvL1xuICAgIC8vIGlzIHNpbXBseSB0aGUgcmVzdWx0IG9mIGFkZGluZyBhbGwgbnVtYmVyc1xuICAgIC8vIHRvZ2V0aGVyLCBzdGFydGluZyBmcm9tIHplcm8uXG4gICAgLy9cbiAgICAvLyBUaGlzIHJ1bnMgb24gYE8obilgLCBsaW5lYXIgdGltZSBpbiByZXNwZWN0IHRvIHRoZSBhcnJheVxuICAgIGZ1bmN0aW9uIHN1bSh4KSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFsdWUgKz0geFtpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gIyBtZWFuXG4gICAgLy9cbiAgICAvLyBpcyB0aGUgc3VtIG92ZXIgdGhlIG51bWJlciBvZiB2YWx1ZXNcbiAgICAvL1xuICAgIC8vIFRoaXMgcnVucyBvbiBgTyhuKWAsIGxpbmVhciB0aW1lIGluIHJlc3BlY3QgdG8gdGhlIGFycmF5XG4gICAgZnVuY3Rpb24gbWVhbih4KSB7XG4gICAgICAgIC8vIFRoZSBtZWFuIG9mIG5vIG51bWJlcnMgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIHJldHVybiBzdW0oeCkgLyB4Lmxlbmd0aDtcbiAgICB9XG5cbiAgICAvLyAjIGdlb21ldHJpYyBtZWFuXG4gICAgLy9cbiAgICAvLyBhIG1lYW4gZnVuY3Rpb24gdGhhdCBpcyBtb3JlIHVzZWZ1bCBmb3IgbnVtYmVycyBpbiBkaWZmZXJlbnRcbiAgICAvLyByYW5nZXMuXG4gICAgLy9cbiAgICAvLyB0aGlzIGlzIHRoZSBudGggcm9vdCBvZiB0aGUgaW5wdXQgbnVtYmVycyBtdWx0aXBsaWVkIGJ5IGVhY2ggb3RoZXJcbiAgICAvL1xuICAgIC8vIFRoaXMgcnVucyBvbiBgTyhuKWAsIGxpbmVhciB0aW1lIGluIHJlc3BlY3QgdG8gdGhlIGFycmF5XG4gICAgZnVuY3Rpb24gZ2VvbWV0cmljX21lYW4oeCkge1xuICAgICAgICAvLyBUaGUgbWVhbiBvZiBubyBudW1iZXJzIGlzIG51bGxcbiAgICAgICAgaWYgKHgubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAvLyB0aGUgc3RhcnRpbmcgdmFsdWUuXG4gICAgICAgIHZhciB2YWx1ZSA9IDE7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyB0aGUgZ2VvbWV0cmljIG1lYW4gaXMgb25seSB2YWxpZCBmb3IgcG9zaXRpdmUgbnVtYmVyc1xuICAgICAgICAgICAgaWYgKHhbaV0gPD0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIC8vIHJlcGVhdGVkbHkgbXVsdGlwbHkgdGhlIHZhbHVlIGJ5IGVhY2ggbnVtYmVyXG4gICAgICAgICAgICB2YWx1ZSAqPSB4W2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIE1hdGgucG93KHZhbHVlLCAxIC8geC5sZW5ndGgpO1xuICAgIH1cblxuXG4gICAgLy8gIyBoYXJtb25pYyBtZWFuXG4gICAgLy9cbiAgICAvLyBhIG1lYW4gZnVuY3Rpb24gdHlwaWNhbGx5IHVzZWQgdG8gZmluZCB0aGUgYXZlcmFnZSBvZiByYXRlc1xuICAgIC8vXG4gICAgLy8gdGhpcyBpcyB0aGUgcmVjaXByb2NhbCBvZiB0aGUgYXJpdGhtZXRpYyBtZWFuIG9mIHRoZSByZWNpcHJvY2Fsc1xuICAgIC8vIG9mIHRoZSBpbnB1dCBudW1iZXJzXG4gICAgLy9cbiAgICAvLyBUaGlzIHJ1bnMgb24gYE8obilgLCBsaW5lYXIgdGltZSBpbiByZXNwZWN0IHRvIHRoZSBhcnJheVxuICAgIGZ1bmN0aW9uIGhhcm1vbmljX21lYW4oeCkge1xuICAgICAgICAvLyBUaGUgbWVhbiBvZiBubyBudW1iZXJzIGlzIG51bGxcbiAgICAgICAgaWYgKHgubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB2YXIgcmVjaXByb2NhbF9zdW0gPSAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gdGhlIGhhcm1vbmljIG1lYW4gaXMgb25seSB2YWxpZCBmb3IgcG9zaXRpdmUgbnVtYmVyc1xuICAgICAgICAgICAgaWYgKHhbaV0gPD0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIHJlY2lwcm9jYWxfc3VtICs9IDEgLyB4W2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZGl2aWRlIG4gYnkgdGhlIHRoZSByZWNpcHJvY2FsIHN1bVxuICAgICAgICByZXR1cm4geC5sZW5ndGggLyByZWNpcHJvY2FsX3N1bTtcbiAgICB9XG5cbiAgICAvLyByb290IG1lYW4gc3F1YXJlIChSTVMpXG4gICAgLy9cbiAgICAvLyBhIG1lYW4gZnVuY3Rpb24gdXNlZCBhcyBhIG1lYXN1cmUgb2YgdGhlIG1hZ25pdHVkZSBvZiBhIHNldFxuICAgIC8vIG9mIG51bWJlcnMsIHJlZ2FyZGxlc3Mgb2YgdGhlaXIgc2lnblxuICAgIC8vXG4gICAgLy8gdGhpcyBpcyB0aGUgc3F1YXJlIHJvb3Qgb2YgdGhlIG1lYW4gb2YgdGhlIHNxdWFyZXMgb2YgdGhlIFxuICAgIC8vIGlucHV0IG51bWJlcnNcbiAgICAvL1xuICAgIC8vIFRoaXMgcnVucyBvbiBgTyhuKWAsIGxpbmVhciB0aW1lIGluIHJlc3BlY3QgdG8gdGhlIGFycmF5XG4gICAgZnVuY3Rpb24gcm9vdF9tZWFuX3NxdWFyZSh4KSB7XG4gICAgICAgIGlmICh4Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdmFyIHN1bV9vZl9zcXVhcmVzID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdW1fb2Zfc3F1YXJlcyArPSBNYXRoLnBvdyh4W2ldLCAyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoc3VtX29mX3NxdWFyZXMgLyB4Lmxlbmd0aCk7XG4gICAgfVxuXG4gICAgLy8gIyBtaW5cbiAgICAvL1xuICAgIC8vIFRoaXMgaXMgc2ltcGx5IHRoZSBtaW5pbXVtIG51bWJlciBpbiB0aGUgc2V0LlxuICAgIC8vXG4gICAgLy8gVGhpcyBydW5zIG9uIGBPKG4pYCwgbGluZWFyIHRpbWUgaW4gcmVzcGVjdCB0byB0aGUgYXJyYXlcbiAgICBmdW5jdGlvbiBtaW4oeCkge1xuICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gT24gdGhlIGZpcnN0IGl0ZXJhdGlvbiBvZiB0aGlzIGxvb3AsIG1pbiBpc1xuICAgICAgICAgICAgLy8gdW5kZWZpbmVkIGFuZCBpcyB0aHVzIG1hZGUgdGhlIG1pbmltdW0gZWxlbWVudCBpbiB0aGUgYXJyYXlcbiAgICAgICAgICAgIGlmICh4W2ldIDwgdmFsdWUgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgdmFsdWUgPSB4W2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICAvLyAjIG1heFxuICAgIC8vXG4gICAgLy8gVGhpcyBpcyBzaW1wbHkgdGhlIG1heGltdW0gbnVtYmVyIGluIHRoZSBzZXQuXG4gICAgLy9cbiAgICAvLyBUaGlzIHJ1bnMgb24gYE8obilgLCBsaW5lYXIgdGltZSBpbiByZXNwZWN0IHRvIHRoZSBhcnJheVxuICAgIGZ1bmN0aW9uIG1heCh4KSB7XG4gICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyBPbiB0aGUgZmlyc3QgaXRlcmF0aW9uIG9mIHRoaXMgbG9vcCwgbWF4IGlzXG4gICAgICAgICAgICAvLyB1bmRlZmluZWQgYW5kIGlzIHRodXMgbWFkZSB0aGUgbWF4aW11bSBlbGVtZW50IGluIHRoZSBhcnJheVxuICAgICAgICAgICAgaWYgKHhbaV0gPiB2YWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IHhbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8vICMgW3ZhcmlhbmNlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1ZhcmlhbmNlKVxuICAgIC8vXG4gICAgLy8gaXMgdGhlIHN1bSBvZiBzcXVhcmVkIGRldmlhdGlvbnMgZnJvbSB0aGUgbWVhblxuICAgIC8vXG4gICAgLy8gZGVwZW5kcyBvbiBgbWVhbigpYFxuICAgIGZ1bmN0aW9uIHZhcmlhbmNlKHgpIHtcbiAgICAgICAgLy8gVGhlIHZhcmlhbmNlIG9mIG5vIG51bWJlcnMgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIHZhciBtZWFuX3ZhbHVlID0gbWVhbih4KSxcbiAgICAgICAgICAgIGRldmlhdGlvbnMgPSBbXTtcblxuICAgICAgICAvLyBNYWtlIGEgbGlzdCBvZiBzcXVhcmVkIGRldmlhdGlvbnMgZnJvbSB0aGUgbWVhbi5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkZXZpYXRpb25zLnB1c2goTWF0aC5wb3coeFtpXSAtIG1lYW5fdmFsdWUsIDIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbmQgdGhlIG1lYW4gdmFsdWUgb2YgdGhhdCBsaXN0XG4gICAgICAgIHJldHVybiBtZWFuKGRldmlhdGlvbnMpO1xuICAgIH1cblxuICAgIC8vICMgW3N0YW5kYXJkIGRldmlhdGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TdGFuZGFyZF9kZXZpYXRpb24pXG4gICAgLy9cbiAgICAvLyBpcyBqdXN0IHRoZSBzcXVhcmUgcm9vdCBvZiB0aGUgdmFyaWFuY2UuXG4gICAgLy9cbiAgICAvLyBkZXBlbmRzIG9uIGB2YXJpYW5jZSgpYFxuICAgIGZ1bmN0aW9uIHN0YW5kYXJkX2RldmlhdGlvbih4KSB7XG4gICAgICAgIC8vIFRoZSBzdGFuZGFyZCBkZXZpYXRpb24gb2Ygbm8gbnVtYmVycyBpcyBudWxsXG4gICAgICAgIGlmICh4Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCh2YXJpYW5jZSh4KSk7XG4gICAgfVxuXG4gICAgLy8gVGhlIHN1bSBvZiBkZXZpYXRpb25zIHRvIHRoZSBOdGggcG93ZXIuXG4gICAgLy8gV2hlbiBuPTIgaXQncyB0aGUgc3VtIG9mIHNxdWFyZWQgZGV2aWF0aW9ucy5cbiAgICAvLyBXaGVuIG49MyBpdCdzIHRoZSBzdW0gb2YgY3ViZWQgZGV2aWF0aW9ucy5cbiAgICAvL1xuICAgIC8vIGRlcGVuZHMgb24gYG1lYW4oKWBcbiAgICBmdW5jdGlvbiBzdW1fbnRoX3Bvd2VyX2RldmlhdGlvbnMoeCwgbikge1xuICAgICAgICB2YXIgbWVhbl92YWx1ZSA9IG1lYW4oeCksXG4gICAgICAgICAgICBzdW0gPSAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc3VtICs9IE1hdGgucG93KHhbaV0gLSBtZWFuX3ZhbHVlLCBuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdW07XG4gICAgfVxuXG4gICAgLy8gIyBbdmFyaWFuY2VdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVmFyaWFuY2UpXG4gICAgLy9cbiAgICAvLyBpcyB0aGUgc3VtIG9mIHNxdWFyZWQgZGV2aWF0aW9ucyBmcm9tIHRoZSBtZWFuXG4gICAgLy9cbiAgICAvLyBkZXBlbmRzIG9uIGBzdW1fbnRoX3Bvd2VyX2RldmlhdGlvbnNgXG4gICAgZnVuY3Rpb24gc2FtcGxlX3ZhcmlhbmNlKHgpIHtcbiAgICAgICAgLy8gVGhlIHZhcmlhbmNlIG9mIG5vIG51bWJlcnMgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPD0gMSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdmFyIHN1bV9zcXVhcmVkX2RldmlhdGlvbnNfdmFsdWUgPSBzdW1fbnRoX3Bvd2VyX2RldmlhdGlvbnMoeCwgMik7XG5cbiAgICAgICAgLy8gRmluZCB0aGUgbWVhbiB2YWx1ZSBvZiB0aGF0IGxpc3RcbiAgICAgICAgcmV0dXJuIHN1bV9zcXVhcmVkX2RldmlhdGlvbnNfdmFsdWUgLyAoeC5sZW5ndGggLSAxKTtcbiAgICB9XG5cbiAgICAvLyAjIFtzdGFuZGFyZCBkZXZpYXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU3RhbmRhcmRfZGV2aWF0aW9uKVxuICAgIC8vXG4gICAgLy8gaXMganVzdCB0aGUgc3F1YXJlIHJvb3Qgb2YgdGhlIHZhcmlhbmNlLlxuICAgIC8vXG4gICAgLy8gZGVwZW5kcyBvbiBgc2FtcGxlX3ZhcmlhbmNlKClgXG4gICAgZnVuY3Rpb24gc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbih4KSB7XG4gICAgICAgIC8vIFRoZSBzdGFuZGFyZCBkZXZpYXRpb24gb2Ygbm8gbnVtYmVycyBpcyBudWxsXG4gICAgICAgIGlmICh4Lmxlbmd0aCA8PSAxKSByZXR1cm4gbnVsbDtcblxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHNhbXBsZV92YXJpYW5jZSh4KSk7XG4gICAgfVxuXG4gICAgLy8gIyBbY292YXJpYW5jZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db3ZhcmlhbmNlKVxuICAgIC8vXG4gICAgLy8gc2FtcGxlIGNvdmFyaWFuY2Ugb2YgdHdvIGRhdGFzZXRzOlxuICAgIC8vIGhvdyBtdWNoIGRvIHRoZSB0d28gZGF0YXNldHMgbW92ZSB0b2dldGhlcj9cbiAgICAvLyB4IGFuZCB5IGFyZSB0d28gZGF0YXNldHMsIHJlcHJlc2VudGVkIGFzIGFycmF5cyBvZiBudW1iZXJzLlxuICAgIC8vXG4gICAgLy8gZGVwZW5kcyBvbiBgbWVhbigpYFxuICAgIGZ1bmN0aW9uIHNhbXBsZV9jb3ZhcmlhbmNlKHgsIHkpIHtcblxuICAgICAgICAvLyBUaGUgdHdvIGRhdGFzZXRzIG11c3QgaGF2ZSB0aGUgc2FtZSBsZW5ndGggd2hpY2ggbXVzdCBiZSBtb3JlIHRoYW4gMVxuICAgICAgICBpZiAoeC5sZW5ndGggPD0gMSB8fCB4Lmxlbmd0aCAhPSB5Lmxlbmd0aCl7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRldGVybWluZSB0aGUgbWVhbiBvZiBlYWNoIGRhdGFzZXQgc28gdGhhdCB3ZSBjYW4ganVkZ2UgZWFjaFxuICAgICAgICAvLyB2YWx1ZSBvZiB0aGUgZGF0YXNldCBmYWlybHkgYXMgdGhlIGRpZmZlcmVuY2UgZnJvbSB0aGUgbWVhbi4gdGhpc1xuICAgICAgICAvLyB3YXksIGlmIG9uZSBkYXRhc2V0IGlzIFsxLCAyLCAzXSBhbmQgWzIsIDMsIDRdLCB0aGVpciBjb3ZhcmlhbmNlXG4gICAgICAgIC8vIGRvZXMgbm90IHN1ZmZlciBiZWNhdXNlIG9mIHRoZSBkaWZmZXJlbmNlIGluIGFic29sdXRlIHZhbHVlc1xuICAgICAgICB2YXIgeG1lYW4gPSBtZWFuKHgpLFxuICAgICAgICAgICAgeW1lYW4gPSBtZWFuKHkpLFxuICAgICAgICAgICAgc3VtID0gMDtcblxuICAgICAgICAvLyBmb3IgZWFjaCBwYWlyIG9mIHZhbHVlcywgdGhlIGNvdmFyaWFuY2UgaW5jcmVhc2VzIHdoZW4gdGhlaXJcbiAgICAgICAgLy8gZGlmZmVyZW5jZSBmcm9tIHRoZSBtZWFuIGlzIGFzc29jaWF0ZWQgLSBpZiBib3RoIGFyZSB3ZWxsIGFib3ZlXG4gICAgICAgIC8vIG9yIGlmIGJvdGggYXJlIHdlbGwgYmVsb3dcbiAgICAgICAgLy8gdGhlIG1lYW4sIHRoZSBjb3ZhcmlhbmNlIGluY3JlYXNlcyBzaWduaWZpY2FudGx5LlxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgc3VtICs9ICh4W2ldIC0geG1lYW4pICogKHlbaV0gLSB5bWVhbik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0aGUgY292YXJpYW5jZSBpcyB3ZWlnaHRlZCBieSB0aGUgbGVuZ3RoIG9mIHRoZSBkYXRhc2V0cy5cbiAgICAgICAgcmV0dXJuIHN1bSAvICh4Lmxlbmd0aCAtIDEpO1xuICAgIH1cblxuICAgIC8vICMgW2NvcnJlbGF0aW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvcnJlbGF0aW9uX2FuZF9kZXBlbmRlbmNlKVxuICAgIC8vXG4gICAgLy8gR2V0cyBhIG1lYXN1cmUgb2YgaG93IGNvcnJlbGF0ZWQgdHdvIGRhdGFzZXRzIGFyZSwgYmV0d2VlbiAtMSBhbmQgMVxuICAgIC8vXG4gICAgLy8gZGVwZW5kcyBvbiBgc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbigpYCBhbmQgYHNhbXBsZV9jb3ZhcmlhbmNlKClgXG4gICAgZnVuY3Rpb24gc2FtcGxlX2NvcnJlbGF0aW9uKHgsIHkpIHtcbiAgICAgICAgdmFyIGNvdiA9IHNhbXBsZV9jb3ZhcmlhbmNlKHgsIHkpLFxuICAgICAgICAgICAgeHN0ZCA9IHNhbXBsZV9zdGFuZGFyZF9kZXZpYXRpb24oeCksXG4gICAgICAgICAgICB5c3RkID0gc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbih5KTtcblxuICAgICAgICBpZiAoY292ID09PSBudWxsIHx8IHhzdGQgPT09IG51bGwgfHwgeXN0ZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY292IC8geHN0ZCAvIHlzdGQ7XG4gICAgfVxuXG4gICAgLy8gIyBbbWVkaWFuXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL01lZGlhbilcbiAgICAvL1xuICAgIC8vIFRoZSBtaWRkbGUgbnVtYmVyIG9mIGEgbGlzdC4gVGhpcyBpcyBvZnRlbiBhIGdvb2QgaW5kaWNhdG9yIG9mICd0aGUgbWlkZGxlJ1xuICAgIC8vIHdoZW4gdGhlcmUgYXJlIG91dGxpZXJzIHRoYXQgc2tldyB0aGUgYG1lYW4oKWAgdmFsdWUuXG4gICAgZnVuY3Rpb24gbWVkaWFuKHgpIHtcbiAgICAgICAgLy8gVGhlIG1lZGlhbiBvZiBhbiBlbXB0eSBsaXN0IGlzIG51bGxcbiAgICAgICAgaWYgKHgubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAvLyBTb3J0aW5nIHRoZSBhcnJheSBtYWtlcyBpdCBlYXN5IHRvIGZpbmQgdGhlIGNlbnRlciwgYnV0XG4gICAgICAgIC8vIHVzZSBgLnNsaWNlKClgIHRvIGVuc3VyZSB0aGUgb3JpZ2luYWwgYXJyYXkgYHhgIGlzIG5vdCBtb2RpZmllZFxuICAgICAgICB2YXIgc29ydGVkID0geC5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9KTtcblxuICAgICAgICAvLyBJZiB0aGUgbGVuZ3RoIG9mIHRoZSBsaXN0IGlzIG9kZCwgaXQncyB0aGUgY2VudHJhbCBudW1iZXJcbiAgICAgICAgaWYgKHNvcnRlZC5sZW5ndGggJSAyID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gc29ydGVkWyhzb3J0ZWQubGVuZ3RoIC0gMSkgLyAyXTtcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCB0aGUgbWVkaWFuIGlzIHRoZSBhdmVyYWdlIG9mIHRoZSB0d28gbnVtYmVyc1xuICAgICAgICAvLyBhdCB0aGUgY2VudGVyIG9mIHRoZSBsaXN0XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgYSA9IHNvcnRlZFsoc29ydGVkLmxlbmd0aCAvIDIpIC0gMV07XG4gICAgICAgICAgICB2YXIgYiA9IHNvcnRlZFsoc29ydGVkLmxlbmd0aCAvIDIpXTtcbiAgICAgICAgICAgIHJldHVybiAoYSArIGIpIC8gMjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vICMgW21vZGVdKGh0dHA6Ly9iaXQubHkvVzVLNFl0KVxuICAgIC8vXG4gICAgLy8gVGhlIG1vZGUgaXMgdGhlIG51bWJlciB0aGF0IGFwcGVhcnMgaW4gYSBsaXN0IHRoZSBoaWdoZXN0IG51bWJlciBvZiB0aW1lcy5cbiAgICAvLyBUaGVyZSBjYW4gYmUgbXVsdGlwbGUgbW9kZXMgaW4gYSBsaXN0OiBpbiB0aGUgZXZlbnQgb2YgYSB0aWUsIHRoaXNcbiAgICAvLyBhbGdvcml0aG0gd2lsbCByZXR1cm4gdGhlIG1vc3QgcmVjZW50bHkgc2VlbiBtb2RlLlxuICAgIC8vXG4gICAgLy8gVGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBpbnNwaXJlZCBieSBbc2NpZW5jZS5qc10oaHR0cHM6Ly9naXRodWIuY29tL2phc29uZGF2aWVzL3NjaWVuY2UuanMvYmxvYi9tYXN0ZXIvc3JjL3N0YXRzL21vZGUuanMpXG4gICAgLy9cbiAgICAvLyBUaGlzIHJ1bnMgb24gYE8obilgLCBsaW5lYXIgdGltZSBpbiByZXNwZWN0IHRvIHRoZSBhcnJheVxuICAgIGZ1bmN0aW9uIG1vZGUoeCkge1xuXG4gICAgICAgIC8vIEhhbmRsZSBlZGdlIGNhc2VzOlxuICAgICAgICAvLyBUaGUgbWVkaWFuIG9mIGFuIGVtcHR5IGxpc3QgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuICAgICAgICBlbHNlIGlmICh4Lmxlbmd0aCA9PT0gMSkgcmV0dXJuIHhbMF07XG5cbiAgICAgICAgLy8gU29ydGluZyB0aGUgYXJyYXkgbGV0cyB1cyBpdGVyYXRlIHRocm91Z2ggaXQgYmVsb3cgYW5kIGJlIHN1cmVcbiAgICAgICAgLy8gdGhhdCBldmVyeSB0aW1lIHdlIHNlZSBhIG5ldyBudW1iZXIgaXQncyBuZXcgYW5kIHdlJ2xsIG5ldmVyXG4gICAgICAgIC8vIHNlZSB0aGUgc2FtZSBudW1iZXIgdHdpY2VcbiAgICAgICAgdmFyIHNvcnRlZCA9IHguc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhIC0gYjsgfSk7XG5cbiAgICAgICAgLy8gVGhpcyBhc3N1bWVzIGl0IGlzIGRlYWxpbmcgd2l0aCBhbiBhcnJheSBvZiBzaXplID4gMSwgc2luY2Ugc2l6ZVxuICAgICAgICAvLyAwIGFuZCAxIGFyZSBoYW5kbGVkIGltbWVkaWF0ZWx5LiBIZW5jZSBpdCBzdGFydHMgYXQgaW5kZXggMSBpbiB0aGVcbiAgICAgICAgLy8gYXJyYXkuXG4gICAgICAgIHZhciBsYXN0ID0gc29ydGVkWzBdLFxuICAgICAgICAgICAgLy8gc3RvcmUgdGhlIG1vZGUgYXMgd2UgZmluZCBuZXcgbW9kZXNcbiAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgLy8gc3RvcmUgaG93IG1hbnkgdGltZXMgd2UndmUgc2VlbiB0aGUgbW9kZVxuICAgICAgICAgICAgbWF4X3NlZW4gPSAwLFxuICAgICAgICAgICAgLy8gaG93IG1hbnkgdGltZXMgdGhlIGN1cnJlbnQgY2FuZGlkYXRlIGZvciB0aGUgbW9kZVxuICAgICAgICAgICAgLy8gaGFzIGJlZW4gc2VlblxuICAgICAgICAgICAgc2Vlbl90aGlzID0gMTtcblxuICAgICAgICAvLyBlbmQgYXQgc29ydGVkLmxlbmd0aCArIDEgdG8gZml4IHRoZSBjYXNlIGluIHdoaWNoIHRoZSBtb2RlIGlzXG4gICAgICAgIC8vIHRoZSBoaWdoZXN0IG51bWJlciB0aGF0IG9jY3VycyBpbiB0aGUgc2VxdWVuY2UuIHRoZSBsYXN0IGl0ZXJhdGlvblxuICAgICAgICAvLyBjb21wYXJlcyBzb3J0ZWRbaV0sIHdoaWNoIGlzIHVuZGVmaW5lZCwgdG8gdGhlIGhpZ2hlc3QgbnVtYmVyXG4gICAgICAgIC8vIGluIHRoZSBzZXJpZXNcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBzb3J0ZWQubGVuZ3RoICsgMTsgaSsrKSB7XG4gICAgICAgICAgICAvLyB3ZSdyZSBzZWVpbmcgYSBuZXcgbnVtYmVyIHBhc3MgYnlcbiAgICAgICAgICAgIGlmIChzb3J0ZWRbaV0gIT09IGxhc3QpIHtcbiAgICAgICAgICAgICAgICAvLyB0aGUgbGFzdCBudW1iZXIgaXMgdGhlIG5ldyBtb2RlIHNpbmNlIHdlIHNhdyBpdCBtb3JlXG4gICAgICAgICAgICAgICAgLy8gb2Z0ZW4gdGhhbiB0aGUgb2xkIG9uZVxuICAgICAgICAgICAgICAgIGlmIChzZWVuX3RoaXMgPiBtYXhfc2Vlbikge1xuICAgICAgICAgICAgICAgICAgICBtYXhfc2VlbiA9IHNlZW5fdGhpcztcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBsYXN0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWVuX3RoaXMgPSAxO1xuICAgICAgICAgICAgICAgIGxhc3QgPSBzb3J0ZWRbaV07XG4gICAgICAgICAgICAvLyBpZiB0aGlzIGlzbid0IGEgbmV3IG51bWJlciwgaXQncyBvbmUgbW9yZSBvY2N1cnJlbmNlIG9mXG4gICAgICAgICAgICAvLyB0aGUgcG90ZW50aWFsIG1vZGVcbiAgICAgICAgICAgIH0gZWxzZSB7IHNlZW5fdGhpcysrOyB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8vICMgW3QtdGVzdF0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TdHVkZW50J3NfdC10ZXN0KVxuICAgIC8vXG4gICAgLy8gVGhpcyBpcyB0byBjb21wdXRlIGEgb25lLXNhbXBsZSB0LXRlc3QsIGNvbXBhcmluZyB0aGUgbWVhblxuICAgIC8vIG9mIGEgc2FtcGxlIHRvIGEga25vd24gdmFsdWUsIHguXG4gICAgLy9cbiAgICAvLyBpbiB0aGlzIGNhc2UsIHdlJ3JlIHRyeWluZyB0byBkZXRlcm1pbmUgd2hldGhlciB0aGVcbiAgICAvLyBwb3B1bGF0aW9uIG1lYW4gaXMgZXF1YWwgdG8gdGhlIHZhbHVlIHRoYXQgd2Uga25vdywgd2hpY2ggaXMgYHhgXG4gICAgLy8gaGVyZS4gdXN1YWxseSB0aGUgcmVzdWx0cyBoZXJlIGFyZSB1c2VkIHRvIGxvb2sgdXAgYVxuICAgIC8vIFtwLXZhbHVlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1AtdmFsdWUpLCB3aGljaCwgZm9yXG4gICAgLy8gYSBjZXJ0YWluIGxldmVsIG9mIHNpZ25pZmljYW5jZSwgd2lsbCBsZXQgeW91IGRldGVybWluZSB0aGF0IHRoZVxuICAgIC8vIG51bGwgaHlwb3RoZXNpcyBjYW4gb3IgY2Fubm90IGJlIHJlamVjdGVkLlxuICAgIC8vXG4gICAgLy8gRGVwZW5kcyBvbiBgc3RhbmRhcmRfZGV2aWF0aW9uKClgIGFuZCBgbWVhbigpYFxuICAgIGZ1bmN0aW9uIHRfdGVzdChzYW1wbGUsIHgpIHtcbiAgICAgICAgLy8gVGhlIG1lYW4gb2YgdGhlIHNhbXBsZVxuICAgICAgICB2YXIgc2FtcGxlX21lYW4gPSBtZWFuKHNhbXBsZSk7XG5cbiAgICAgICAgLy8gVGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiB0aGUgc2FtcGxlXG4gICAgICAgIHZhciBzZCA9IHN0YW5kYXJkX2RldmlhdGlvbihzYW1wbGUpO1xuXG4gICAgICAgIC8vIFNxdWFyZSByb290IHRoZSBsZW5ndGggb2YgdGhlIHNhbXBsZVxuICAgICAgICB2YXIgcm9vdE4gPSBNYXRoLnNxcnQoc2FtcGxlLmxlbmd0aCk7XG5cbiAgICAgICAgLy8gQ29tcHV0ZSB0aGUga25vd24gdmFsdWUgYWdhaW5zdCB0aGUgc2FtcGxlLFxuICAgICAgICAvLyByZXR1cm5pbmcgdGhlIHQgdmFsdWVcbiAgICAgICAgcmV0dXJuIChzYW1wbGVfbWVhbiAtIHgpIC8gKHNkIC8gcm9vdE4pO1xuICAgIH1cblxuICAgIC8vICMgWzItc2FtcGxlIHQtdGVzdF0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TdHVkZW50J3NfdC10ZXN0KVxuICAgIC8vXG4gICAgLy8gVGhpcyBpcyB0byBjb21wdXRlIHR3byBzYW1wbGUgdC10ZXN0LlxuICAgIC8vIFRlc3RzIHdoZXRoZXIgXCJtZWFuKFgpLW1lYW4oWSkgPSBkaWZmZXJlbmNlXCIsIChcbiAgICAvLyBpbiB0aGUgbW9zdCBjb21tb24gY2FzZSwgd2Ugb2Z0ZW4gaGF2ZSBgZGlmZmVyZW5jZSA9PSAwYCB0byB0ZXN0IGlmIHR3byBzYW1wbGVzXG4gICAgLy8gYXJlIGxpa2VseSB0byBiZSB0YWtlbiBmcm9tIHBvcHVsYXRpb25zIHdpdGggdGhlIHNhbWUgbWVhbiB2YWx1ZSkgd2l0aFxuICAgIC8vIG5vIHByaW9yIGtub3dsZWRnZSBvbiBzdGFuZGFyZCBkZXZpYXRpb25zIG9mIGJvdGggc2FtcGxlc1xuICAgIC8vIG90aGVyIHRoYW4gdGhlIGZhY3QgdGhhdCB0aGV5IGhhdmUgdGhlIHNhbWUgc3RhbmRhcmQgZGV2aWF0aW9uLlxuICAgIC8vXG4gICAgLy8gVXN1YWxseSB0aGUgcmVzdWx0cyBoZXJlIGFyZSB1c2VkIHRvIGxvb2sgdXAgYVxuICAgIC8vIFtwLXZhbHVlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1AtdmFsdWUpLCB3aGljaCwgZm9yXG4gICAgLy8gYSBjZXJ0YWluIGxldmVsIG9mIHNpZ25pZmljYW5jZSwgd2lsbCBsZXQgeW91IGRldGVybWluZSB0aGF0IHRoZVxuICAgIC8vIG51bGwgaHlwb3RoZXNpcyBjYW4gb3IgY2Fubm90IGJlIHJlamVjdGVkLlxuICAgIC8vXG4gICAgLy8gYGRpZmZgIGNhbiBiZSBvbWl0dGVkIGlmIGl0IGVxdWFscyAwLlxuICAgIC8vXG4gICAgLy8gW1RoaXMgaXMgdXNlZCB0byBjb25maXJtIG9yIGRlbnldKGh0dHA6Ly93d3cubW9uYXJjaGxhYi5vcmcvTGFiL1Jlc2VhcmNoL1N0YXRzLzJTYW1wbGVULmFzcHgpXG4gICAgLy8gYSBudWxsIGh5cG90aGVzaXMgdGhhdCB0aGUgdHdvIHBvcHVsYXRpb25zIHRoYXQgaGF2ZSBiZWVuIHNhbXBsZWQgaW50b1xuICAgIC8vIGBzYW1wbGVfeGAgYW5kIGBzYW1wbGVfeWAgYXJlIGVxdWFsIHRvIGVhY2ggb3RoZXIuXG4gICAgLy9cbiAgICAvLyBEZXBlbmRzIG9uIGBzYW1wbGVfdmFyaWFuY2UoKWAgYW5kIGBtZWFuKClgXG4gICAgZnVuY3Rpb24gdF90ZXN0X3R3b19zYW1wbGUoc2FtcGxlX3gsIHNhbXBsZV95LCBkaWZmZXJlbmNlKSB7XG4gICAgICAgIHZhciBuID0gc2FtcGxlX3gubGVuZ3RoLFxuICAgICAgICAgICAgbSA9IHNhbXBsZV95Lmxlbmd0aDtcblxuICAgICAgICAvLyBJZiBlaXRoZXIgc2FtcGxlIGRvZXNuJ3QgYWN0dWFsbHkgaGF2ZSBhbnkgdmFsdWVzLCB3ZSBjYW4ndFxuICAgICAgICAvLyBjb21wdXRlIHRoaXMgYXQgYWxsLCBzbyB3ZSByZXR1cm4gYG51bGxgLlxuICAgICAgICBpZiAoIW4gfHwgIW0pIHJldHVybiBudWxsIDtcblxuICAgICAgICAvLyBkZWZhdWx0IGRpZmZlcmVuY2UgKG11KSBpcyB6ZXJvXG4gICAgICAgIGlmICghZGlmZmVyZW5jZSkgZGlmZmVyZW5jZSA9IDA7XG5cbiAgICAgICAgdmFyIG1lYW5YID0gbWVhbihzYW1wbGVfeCksXG4gICAgICAgICAgICBtZWFuWSA9IG1lYW4oc2FtcGxlX3kpO1xuXG4gICAgICAgIHZhciB3ZWlnaHRlZFZhcmlhbmNlID0gKChuIC0gMSkgKiBzYW1wbGVfdmFyaWFuY2Uoc2FtcGxlX3gpICtcbiAgICAgICAgICAgIChtIC0gMSkgKiBzYW1wbGVfdmFyaWFuY2Uoc2FtcGxlX3kpKSAvIChuICsgbSAtIDIpO1xuXG4gICAgICAgIHJldHVybiAobWVhblggLSBtZWFuWSAtIGRpZmZlcmVuY2UpIC9cbiAgICAgICAgICAgIE1hdGguc3FydCh3ZWlnaHRlZFZhcmlhbmNlICogKDEgLyBuICsgMSAvIG0pKTtcbiAgICB9XG5cbiAgICAvLyAjIGNodW5rXG4gICAgLy9cbiAgICAvLyBTcGxpdCBhbiBhcnJheSBpbnRvIGNodW5rcyBvZiBhIHNwZWNpZmllZCBzaXplLiBUaGlzIGZ1bmN0aW9uXG4gICAgLy8gaGFzIHRoZSBzYW1lIGJlaGF2aW9yIGFzIFtQSFAncyBhcnJheV9jaHVua10oaHR0cDovL3BocC5uZXQvbWFudWFsL2VuL2Z1bmN0aW9uLmFycmF5LWNodW5rLnBocClcbiAgICAvLyBmdW5jdGlvbiwgYW5kIHRodXMgd2lsbCBpbnNlcnQgc21hbGxlci1zaXplZCBjaHVua3MgYXQgdGhlIGVuZCBpZlxuICAgIC8vIHRoZSBpbnB1dCBzaXplIGlzIG5vdCBkaXZpc2libGUgYnkgdGhlIGNodW5rIHNpemUuXG4gICAgLy9cbiAgICAvLyBgc2FtcGxlYCBpcyBleHBlY3RlZCB0byBiZSBhbiBhcnJheSwgYW5kIGBjaHVua1NpemVgIGEgbnVtYmVyLlxuICAgIC8vIFRoZSBgc2FtcGxlYCBhcnJheSBjYW4gY29udGFpbiBhbnkga2luZCBvZiBkYXRhLlxuICAgIGZ1bmN0aW9uIGNodW5rKHNhbXBsZSwgY2h1bmtTaXplKSB7XG5cbiAgICAgICAgLy8gYSBsaXN0IG9mIHJlc3VsdCBjaHVua3MsIGFzIGFycmF5cyBpbiBhbiBhcnJheVxuICAgICAgICB2YXIgb3V0cHV0ID0gW107XG5cbiAgICAgICAgLy8gYGNodW5rU2l6ZWAgbXVzdCBiZSB6ZXJvIG9yIGhpZ2hlciAtIG90aGVyd2lzZSB0aGUgbG9vcCBiZWxvdyxcbiAgICAgICAgLy8gaW4gd2hpY2ggd2UgY2FsbCBgc3RhcnQgKz0gY2h1bmtTaXplYCwgd2lsbCBsb29wIGluZmluaXRlbHkuXG4gICAgICAgIC8vIFNvLCB3ZSdsbCBkZXRlY3QgYW5kIHJldHVybiBudWxsIGluIHRoYXQgY2FzZSB0byBpbmRpY2F0ZVxuICAgICAgICAvLyBpbnZhbGlkIGlucHV0LlxuICAgICAgICBpZiAoY2h1bmtTaXplIDw9IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYHN0YXJ0YCBpcyB0aGUgaW5kZXggYXQgd2hpY2ggYC5zbGljZWAgd2lsbCBzdGFydCBzZWxlY3RpbmdcbiAgICAgICAgLy8gbmV3IGFycmF5IGVsZW1lbnRzXG4gICAgICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgc3RhcnQgPCBzYW1wbGUubGVuZ3RoOyBzdGFydCArPSBjaHVua1NpemUpIHtcblxuICAgICAgICAgICAgLy8gZm9yIGVhY2ggY2h1bmssIHNsaWNlIHRoYXQgcGFydCBvZiB0aGUgYXJyYXkgYW5kIGFkZCBpdFxuICAgICAgICAgICAgLy8gdG8gdGhlIG91dHB1dC4gVGhlIGAuc2xpY2VgIGZ1bmN0aW9uIGRvZXMgbm90IGNoYW5nZVxuICAgICAgICAgICAgLy8gdGhlIG9yaWdpbmFsIGFycmF5LlxuICAgICAgICAgICAgb3V0cHV0LnB1c2goc2FtcGxlLnNsaWNlKHN0YXJ0LCBzdGFydCArIGNodW5rU2l6ZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG4gICAgLy8gIyBzaHVmZmxlX2luX3BsYWNlXG4gICAgLy9cbiAgICAvLyBBIFtGaXNoZXItWWF0ZXMgc2h1ZmZsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXIlRTIlODAlOTNZYXRlc19zaHVmZmxlKVxuICAgIC8vIGluLXBsYWNlIC0gd2hpY2ggbWVhbnMgdGhhdCBpdCB3aWxsIGNoYW5nZSB0aGUgb3JkZXIgb2YgdGhlIG9yaWdpbmFsXG4gICAgLy8gYXJyYXkgYnkgcmVmZXJlbmNlLlxuICAgIGZ1bmN0aW9uIHNodWZmbGVfaW5fcGxhY2Uoc2FtcGxlLCByYW5kb21Tb3VyY2UpIHtcblxuICAgICAgICAvLyBhIGN1c3RvbSByYW5kb20gbnVtYmVyIHNvdXJjZSBjYW4gYmUgcHJvdmlkZWQgaWYgeW91IHdhbnQgdG8gdXNlXG4gICAgICAgIC8vIGEgZml4ZWQgc2VlZCBvciBhbm90aGVyIHJhbmRvbSBudW1iZXIgZ2VuZXJhdG9yLCBsaWtlXG4gICAgICAgIC8vIFtyYW5kb20tanNdKGh0dHBzOi8vd3d3Lm5wbWpzLm9yZy9wYWNrYWdlL3JhbmRvbS1qcylcbiAgICAgICAgcmFuZG9tU291cmNlID0gcmFuZG9tU291cmNlIHx8IE1hdGgucmFuZG9tO1xuXG4gICAgICAgIC8vIHN0b3JlIHRoZSBjdXJyZW50IGxlbmd0aCBvZiB0aGUgc2FtcGxlIHRvIGRldGVybWluZVxuICAgICAgICAvLyB3aGVuIG5vIGVsZW1lbnRzIHJlbWFpbiB0byBzaHVmZmxlLlxuICAgICAgICB2YXIgbGVuZ3RoID0gc2FtcGxlLmxlbmd0aDtcblxuICAgICAgICAvLyB0ZW1wb3JhcnkgaXMgdXNlZCB0byBob2xkIGFuIGl0ZW0gd2hlbiBpdCBpcyBiZWluZ1xuICAgICAgICAvLyBzd2FwcGVkIGJldHdlZW4gaW5kaWNlcy5cbiAgICAgICAgdmFyIHRlbXBvcmFyeTtcblxuICAgICAgICAvLyBUaGUgaW5kZXggdG8gc3dhcCBhdCBlYWNoIHN0YWdlLlxuICAgICAgICB2YXIgaW5kZXg7XG5cbiAgICAgICAgLy8gV2hpbGUgdGhlcmUgYXJlIHN0aWxsIGl0ZW1zIHRvIHNodWZmbGVcbiAgICAgICAgd2hpbGUgKGxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGNob3NlIGEgcmFuZG9tIGluZGV4IHdpdGhpbiB0aGUgc3Vic2V0IG9mIHRoZSBhcnJheVxuICAgICAgICAgICAgLy8gdGhhdCBpcyBub3QgeWV0IHNodWZmbGVkXG4gICAgICAgICAgICBpbmRleCA9IE1hdGguZmxvb3IocmFuZG9tU291cmNlKCkgKiBsZW5ndGgtLSk7XG5cbiAgICAgICAgICAgIC8vIHN0b3JlIHRoZSB2YWx1ZSB0aGF0IHdlJ2xsIG1vdmUgdGVtcG9yYXJpbHlcbiAgICAgICAgICAgIHRlbXBvcmFyeSA9IHNhbXBsZVtsZW5ndGhdO1xuXG4gICAgICAgICAgICAvLyBzd2FwIHRoZSB2YWx1ZSBhdCBgc2FtcGxlW2xlbmd0aF1gIHdpdGggYHNhbXBsZVtpbmRleF1gXG4gICAgICAgICAgICBzYW1wbGVbbGVuZ3RoXSA9IHNhbXBsZVtpbmRleF07XG4gICAgICAgICAgICBzYW1wbGVbaW5kZXhdID0gdGVtcG9yYXJ5O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNhbXBsZTtcbiAgICB9XG5cbiAgICAvLyAjIHNodWZmbGVcbiAgICAvL1xuICAgIC8vIEEgW0Zpc2hlci1ZYXRlcyBzaHVmZmxlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Zpc2hlciVFMiU4MCU5M1lhdGVzX3NodWZmbGUpXG4gICAgLy8gaXMgYSBmYXN0IHdheSB0byBjcmVhdGUgYSByYW5kb20gcGVybXV0YXRpb24gb2YgYSBmaW5pdGUgc2V0LlxuICAgIGZ1bmN0aW9uIHNodWZmbGUoc2FtcGxlLCByYW5kb21Tb3VyY2UpIHtcbiAgICAgICAgLy8gc2xpY2UgdGhlIG9yaWdpbmFsIGFycmF5IHNvIHRoYXQgaXQgaXMgbm90IG1vZGlmaWVkXG4gICAgICAgIHNhbXBsZSA9IHNhbXBsZS5zbGljZSgpO1xuXG4gICAgICAgIC8vIGFuZCB0aGVuIHNodWZmbGUgdGhhdCBzaGFsbG93LWNvcGllZCBhcnJheSwgaW4gcGxhY2VcbiAgICAgICAgcmV0dXJuIHNodWZmbGVfaW5fcGxhY2Uoc2FtcGxlLnNsaWNlKCksIHJhbmRvbVNvdXJjZSk7XG4gICAgfVxuXG4gICAgLy8gIyBzYW1wbGVcbiAgICAvL1xuICAgIC8vIENyZWF0ZSBhIFtzaW1wbGUgcmFuZG9tIHNhbXBsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TaW1wbGVfcmFuZG9tX3NhbXBsZSlcbiAgICAvLyBmcm9tIGEgZ2l2ZW4gYXJyYXkgb2YgYG5gIGVsZW1lbnRzLlxuICAgIGZ1bmN0aW9uIHNhbXBsZShhcnJheSwgbiwgcmFuZG9tU291cmNlKSB7XG4gICAgICAgIC8vIHNodWZmbGUgdGhlIG9yaWdpbmFsIGFycmF5IHVzaW5nIGEgZmlzaGVyLXlhdGVzIHNodWZmbGVcbiAgICAgICAgdmFyIHNodWZmbGVkID0gc2h1ZmZsZShhcnJheSwgcmFuZG9tU291cmNlKTtcblxuICAgICAgICAvLyBhbmQgdGhlbiByZXR1cm4gYSBzdWJzZXQgb2YgaXQgLSB0aGUgZmlyc3QgYG5gIGVsZW1lbnRzLlxuICAgICAgICByZXR1cm4gc2h1ZmZsZWQuc2xpY2UoMCwgbik7XG4gICAgfVxuXG4gICAgLy8gIyBxdWFudGlsZVxuICAgIC8vXG4gICAgLy8gVGhpcyBpcyBhIHBvcHVsYXRpb24gcXVhbnRpbGUsIHNpbmNlIHdlIGFzc3VtZSB0byBrbm93IHRoZSBlbnRpcmVcbiAgICAvLyBkYXRhc2V0IGluIHRoaXMgbGlicmFyeS4gVGh1cyBJJ20gdHJ5aW5nIHRvIGZvbGxvdyB0aGVcbiAgICAvLyBbUXVhbnRpbGVzIG9mIGEgUG9wdWxhdGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWFudGlsZSNRdWFudGlsZXNfb2ZfYV9wb3B1bGF0aW9uKVxuICAgIC8vIGFsZ29yaXRobSBmcm9tIHdpa2lwZWRpYS5cbiAgICAvL1xuICAgIC8vIFNhbXBsZSBpcyBhIG9uZS1kaW1lbnNpb25hbCBhcnJheSBvZiBudW1iZXJzLFxuICAgIC8vIGFuZCBwIGlzIGVpdGhlciBhIGRlY2ltYWwgbnVtYmVyIGZyb20gMCB0byAxIG9yIGFuIGFycmF5IG9mIGRlY2ltYWxcbiAgICAvLyBudW1iZXJzIGZyb20gMCB0byAxLlxuICAgIC8vIEluIHRlcm1zIG9mIGEgay9xIHF1YW50aWxlLCBwID0gay9xIC0gaXQncyBqdXN0IGRlYWxpbmcgd2l0aCBmcmFjdGlvbnMgb3IgZGVhbGluZ1xuICAgIC8vIHdpdGggZGVjaW1hbCB2YWx1ZXMuXG4gICAgLy8gV2hlbiBwIGlzIGFuIGFycmF5LCB0aGUgcmVzdWx0IG9mIHRoZSBmdW5jdGlvbiBpcyBhbHNvIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIGFwcHJvcHJpYXRlXG4gICAgLy8gcXVhbnRpbGVzIGluIGlucHV0IG9yZGVyXG4gICAgZnVuY3Rpb24gcXVhbnRpbGUoc2FtcGxlLCBwKSB7XG5cbiAgICAgICAgLy8gV2UgY2FuJ3QgZGVyaXZlIHF1YW50aWxlcyBmcm9tIGFuIGVtcHR5IGxpc3RcbiAgICAgICAgaWYgKHNhbXBsZS5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIC8vIFNvcnQgYSBjb3B5IG9mIHRoZSBhcnJheS4gV2UnbGwgbmVlZCBhIHNvcnRlZCBhcnJheSB0byBpbmRleFxuICAgICAgICAvLyB0aGUgdmFsdWVzIGluIHNvcnRlZCBvcmRlci5cbiAgICAgICAgdmFyIHNvcnRlZCA9IHNhbXBsZS5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9KTtcblxuICAgICAgICBpZiAocC5sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIHJlc3VsdCBhcnJheVxuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgICAgIC8vIEZvciBlYWNoIHJlcXVlc3RlZCBxdWFudGlsZVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0c1tpXSA9IHF1YW50aWxlX3NvcnRlZChzb3J0ZWQsIHBbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcXVhbnRpbGVfc29ydGVkKHNvcnRlZCwgcCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAjIHF1YW50aWxlXG4gICAgLy9cbiAgICAvLyBUaGlzIGlzIHRoZSBpbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBvZiBxdWFudGlsZXM6IHdoZW4geW91IGtub3dcbiAgICAvLyB0aGF0IHRoZSBvcmRlciBpcyBzb3J0ZWQsIHlvdSBkb24ndCBuZWVkIHRvIHJlLXNvcnQgaXQsIGFuZCB0aGUgY29tcHV0YXRpb25zXG4gICAgLy8gYXJlIG11Y2ggZmFzdGVyLlxuICAgIGZ1bmN0aW9uIHF1YW50aWxlX3NvcnRlZChzYW1wbGUsIHApIHtcbiAgICAgICAgdmFyIGlkeCA9IChzYW1wbGUubGVuZ3RoKSAqIHA7XG4gICAgICAgIGlmIChwIDwgMCB8fCBwID4gMSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0gZWxzZSBpZiAocCA9PT0gMSkge1xuICAgICAgICAgICAgLy8gSWYgcCBpcyAxLCBkaXJlY3RseSByZXR1cm4gdGhlIGxhc3QgZWxlbWVudFxuICAgICAgICAgICAgcmV0dXJuIHNhbXBsZVtzYW1wbGUubGVuZ3RoIC0gMV07XG4gICAgICAgIH0gZWxzZSBpZiAocCA9PT0gMCkge1xuICAgICAgICAgICAgLy8gSWYgcCBpcyAwLCBkaXJlY3RseSByZXR1cm4gdGhlIGZpcnN0IGVsZW1lbnRcbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVbMF07XG4gICAgICAgIH0gZWxzZSBpZiAoaWR4ICUgMSAhPT0gMCkge1xuICAgICAgICAgICAgLy8gSWYgcCBpcyBub3QgaW50ZWdlciwgcmV0dXJuIHRoZSBuZXh0IGVsZW1lbnQgaW4gYXJyYXlcbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVbTWF0aC5jZWlsKGlkeCkgLSAxXTtcbiAgICAgICAgfSBlbHNlIGlmIChzYW1wbGUubGVuZ3RoICUgMiA9PT0gMCkge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGxpc3QgaGFzIGV2ZW4tbGVuZ3RoLCB3ZSdsbCB0YWtlIHRoZSBhdmVyYWdlIG9mIHRoaXMgbnVtYmVyXG4gICAgICAgICAgICAvLyBhbmQgdGhlIG5leHQgdmFsdWUsIGlmIHRoZXJlIGlzIG9uZVxuICAgICAgICAgICAgcmV0dXJuIChzYW1wbGVbaWR4IC0gMV0gKyBzYW1wbGVbaWR4XSkgLyAyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRmluYWxseSwgaW4gdGhlIHNpbXBsZSBjYXNlIG9mIGFuIGludGVnZXIgdmFsdWVcbiAgICAgICAgICAgIC8vIHdpdGggYW4gb2RkLWxlbmd0aCBsaXN0LCByZXR1cm4gdGhlIHNhbXBsZSB2YWx1ZSBhdCB0aGUgaW5kZXguXG4gICAgICAgICAgICByZXR1cm4gc2FtcGxlW2lkeF07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAjIFtJbnRlcnF1YXJ0aWxlIHJhbmdlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0ludGVycXVhcnRpbGVfcmFuZ2UpXG4gICAgLy9cbiAgICAvLyBBIG1lYXN1cmUgb2Ygc3RhdGlzdGljYWwgZGlzcGVyc2lvbiwgb3IgaG93IHNjYXR0ZXJlZCwgc3ByZWFkLCBvclxuICAgIC8vIGNvbmNlbnRyYXRlZCBhIGRpc3RyaWJ1dGlvbiBpcy4gSXQncyBjb21wdXRlZCBhcyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuXG4gICAgLy8gdGhlIHRoaXJkIHF1YXJ0aWxlIGFuZCBmaXJzdCBxdWFydGlsZS5cbiAgICBmdW5jdGlvbiBpcXIoc2FtcGxlKSB7XG4gICAgICAgIC8vIFdlIGNhbid0IGRlcml2ZSBxdWFudGlsZXMgZnJvbSBhbiBlbXB0eSBsaXN0XG4gICAgICAgIGlmIChzYW1wbGUubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAvLyBJbnRlcnF1YXJ0aWxlIHJhbmdlIGlzIHRoZSBzcGFuIGJldHdlZW4gdGhlIHVwcGVyIHF1YXJ0aWxlLFxuICAgICAgICAvLyBhdCBgMC43NWAsIGFuZCBsb3dlciBxdWFydGlsZSwgYDAuMjVgXG4gICAgICAgIHJldHVybiBxdWFudGlsZShzYW1wbGUsIDAuNzUpIC0gcXVhbnRpbGUoc2FtcGxlLCAwLjI1KTtcbiAgICB9XG5cbiAgICAvLyAjIFtNZWRpYW4gQWJzb2x1dGUgRGV2aWF0aW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL01lZGlhbl9hYnNvbHV0ZV9kZXZpYXRpb24pXG4gICAgLy9cbiAgICAvLyBUaGUgTWVkaWFuIEFic29sdXRlIERldmlhdGlvbiAoTUFEKSBpcyBhIHJvYnVzdCBtZWFzdXJlIG9mIHN0YXRpc3RpY2FsXG4gICAgLy8gZGlzcGVyc2lvbi4gSXQgaXMgbW9yZSByZXNpbGllbnQgdG8gb3V0bGllcnMgdGhhbiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uLlxuICAgIGZ1bmN0aW9uIG1hZCh4KSB7XG4gICAgICAgIC8vIFRoZSBtYWQgb2Ygbm90aGluZyBpcyBudWxsXG4gICAgICAgIGlmICgheCB8fCB4Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdmFyIG1lZGlhbl92YWx1ZSA9IG1lZGlhbih4KSxcbiAgICAgICAgICAgIG1lZGlhbl9hYnNvbHV0ZV9kZXZpYXRpb25zID0gW107XG5cbiAgICAgICAgLy8gTWFrZSBhIGxpc3Qgb2YgYWJzb2x1dGUgZGV2aWF0aW9ucyBmcm9tIHRoZSBtZWRpYW5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBtZWRpYW5fYWJzb2x1dGVfZGV2aWF0aW9ucy5wdXNoKE1hdGguYWJzKHhbaV0gLSBtZWRpYW5fdmFsdWUpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbmQgdGhlIG1lZGlhbiB2YWx1ZSBvZiB0aGF0IGxpc3RcbiAgICAgICAgcmV0dXJuIG1lZGlhbihtZWRpYW5fYWJzb2x1dGVfZGV2aWF0aW9ucyk7XG4gICAgfVxuXG4gICAgLy8gIyMgQ29tcHV0ZSBNYXRyaWNlcyBmb3IgSmVua3NcbiAgICAvL1xuICAgIC8vIENvbXB1dGUgdGhlIG1hdHJpY2VzIHJlcXVpcmVkIGZvciBKZW5rcyBicmVha3MuIFRoZXNlIG1hdHJpY2VzXG4gICAgLy8gY2FuIGJlIHVzZWQgZm9yIGFueSBjbGFzc2luZyBvZiBkYXRhIHdpdGggYGNsYXNzZXMgPD0gbl9jbGFzc2VzYFxuICAgIGZ1bmN0aW9uIGplbmtzTWF0cmljZXMoZGF0YSwgbl9jbGFzc2VzKSB7XG5cbiAgICAgICAgLy8gaW4gdGhlIG9yaWdpbmFsIGltcGxlbWVudGF0aW9uLCB0aGVzZSBtYXRyaWNlcyBhcmUgcmVmZXJyZWQgdG9cbiAgICAgICAgLy8gYXMgYExDYCBhbmQgYE9QYFxuICAgICAgICAvL1xuICAgICAgICAvLyAqIGxvd2VyX2NsYXNzX2xpbWl0cyAoTEMpOiBvcHRpbWFsIGxvd2VyIGNsYXNzIGxpbWl0c1xuICAgICAgICAvLyAqIHZhcmlhbmNlX2NvbWJpbmF0aW9ucyAoT1ApOiBvcHRpbWFsIHZhcmlhbmNlIGNvbWJpbmF0aW9ucyBmb3IgYWxsIGNsYXNzZXNcbiAgICAgICAgdmFyIGxvd2VyX2NsYXNzX2xpbWl0cyA9IFtdLFxuICAgICAgICAgICAgdmFyaWFuY2VfY29tYmluYXRpb25zID0gW10sXG4gICAgICAgICAgICAvLyBsb29wIGNvdW50ZXJzXG4gICAgICAgICAgICBpLCBqLFxuICAgICAgICAgICAgLy8gdGhlIHZhcmlhbmNlLCBhcyBjb21wdXRlZCBhdCBlYWNoIHN0ZXAgaW4gdGhlIGNhbGN1bGF0aW9uXG4gICAgICAgICAgICB2YXJpYW5jZSA9IDA7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBhbmQgZmlsbCBlYWNoIG1hdHJpeCB3aXRoIHplcm9lc1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZGF0YS5sZW5ndGggKyAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0bXAxID0gW10sIHRtcDIgPSBbXTtcbiAgICAgICAgICAgIC8vIGRlc3BpdGUgdGhlc2UgYXJyYXlzIGhhdmluZyB0aGUgc2FtZSB2YWx1ZXMsIHdlIG5lZWRcbiAgICAgICAgICAgIC8vIHRvIGtlZXAgdGhlbSBzZXBhcmF0ZSBzbyB0aGF0IGNoYW5naW5nIG9uZSBkb2VzIG5vdCBjaGFuZ2VcbiAgICAgICAgICAgIC8vIHRoZSBvdGhlclxuICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG5fY2xhc3NlcyArIDE7IGorKykge1xuICAgICAgICAgICAgICAgIHRtcDEucHVzaCgwKTtcbiAgICAgICAgICAgICAgICB0bXAyLnB1c2goMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsb3dlcl9jbGFzc19saW1pdHMucHVzaCh0bXAxKTtcbiAgICAgICAgICAgIHZhcmlhbmNlX2NvbWJpbmF0aW9ucy5wdXNoKHRtcDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gMTsgaSA8IG5fY2xhc3NlcyArIDE7IGkrKykge1xuICAgICAgICAgICAgbG93ZXJfY2xhc3NfbGltaXRzWzFdW2ldID0gMTtcbiAgICAgICAgICAgIHZhcmlhbmNlX2NvbWJpbmF0aW9uc1sxXVtpXSA9IDA7XG4gICAgICAgICAgICAvLyBpbiB0aGUgb3JpZ2luYWwgaW1wbGVtZW50YXRpb24sIDk5OTk5OTkgaXMgdXNlZCBidXRcbiAgICAgICAgICAgIC8vIHNpbmNlIEphdmFzY3JpcHQgaGFzIGBJbmZpbml0eWAsIHdlIHVzZSB0aGF0LlxuICAgICAgICAgICAgZm9yIChqID0gMjsgaiA8IGRhdGEubGVuZ3RoICsgMTsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyaWFuY2VfY29tYmluYXRpb25zW2pdW2ldID0gSW5maW5pdHk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBsID0gMjsgbCA8IGRhdGEubGVuZ3RoICsgMTsgbCsrKSB7XG5cbiAgICAgICAgICAgIC8vIGBTWmAgb3JpZ2luYWxseS4gdGhpcyBpcyB0aGUgc3VtIG9mIHRoZSB2YWx1ZXMgc2VlbiB0aHVzXG4gICAgICAgICAgICAvLyBmYXIgd2hlbiBjYWxjdWxhdGluZyB2YXJpYW5jZS5cbiAgICAgICAgICAgIHZhciBzdW0gPSAwLFxuICAgICAgICAgICAgICAgIC8vIGBaU1FgIG9yaWdpbmFsbHkuIHRoZSBzdW0gb2Ygc3F1YXJlcyBvZiB2YWx1ZXMgc2VlblxuICAgICAgICAgICAgICAgIC8vIHRodXMgZmFyXG4gICAgICAgICAgICAgICAgc3VtX3NxdWFyZXMgPSAwLFxuICAgICAgICAgICAgICAgIC8vIGBXVGAgb3JpZ2luYWxseS4gVGhpcyBpcyB0aGUgbnVtYmVyIG9mXG4gICAgICAgICAgICAgICAgdyA9IDAsXG4gICAgICAgICAgICAgICAgLy8gYElWYCBvcmlnaW5hbGx5XG4gICAgICAgICAgICAgICAgaTQgPSAwO1xuXG4gICAgICAgICAgICAvLyBpbiBzZXZlcmFsIGluc3RhbmNlcywgeW91IGNvdWxkIHNheSBgTWF0aC5wb3coeCwgMilgXG4gICAgICAgICAgICAvLyBpbnN0ZWFkIG9mIGB4ICogeGAsIGJ1dCB0aGlzIGlzIHNsb3dlciBpbiBzb21lIGJyb3dzZXJzXG4gICAgICAgICAgICAvLyBpbnRyb2R1Y2VzIGFuIHVubmVjZXNzYXJ5IGNvbmNlcHQuXG4gICAgICAgICAgICBmb3IgKHZhciBtID0gMTsgbSA8IGwgKyAxOyBtKyspIHtcblxuICAgICAgICAgICAgICAgIC8vIGBJSUlgIG9yaWdpbmFsbHlcbiAgICAgICAgICAgICAgICB2YXIgbG93ZXJfY2xhc3NfbGltaXQgPSBsIC0gbSArIDEsXG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IGRhdGFbbG93ZXJfY2xhc3NfbGltaXQgLSAxXTtcblxuICAgICAgICAgICAgICAgIC8vIGhlcmUgd2UncmUgZXN0aW1hdGluZyB2YXJpYW5jZSBmb3IgZWFjaCBwb3RlbnRpYWwgY2xhc3NpbmdcbiAgICAgICAgICAgICAgICAvLyBvZiB0aGUgZGF0YSwgZm9yIGVhY2ggcG90ZW50aWFsIG51bWJlciBvZiBjbGFzc2VzLiBgd2BcbiAgICAgICAgICAgICAgICAvLyBpcyB0aGUgbnVtYmVyIG9mIGRhdGEgcG9pbnRzIGNvbnNpZGVyZWQgc28gZmFyLlxuICAgICAgICAgICAgICAgIHcrKztcblxuICAgICAgICAgICAgICAgIC8vIGluY3JlYXNlIHRoZSBjdXJyZW50IHN1bSBhbmQgc3VtLW9mLXNxdWFyZXNcbiAgICAgICAgICAgICAgICBzdW0gKz0gdmFsO1xuICAgICAgICAgICAgICAgIHN1bV9zcXVhcmVzICs9IHZhbCAqIHZhbDtcblxuICAgICAgICAgICAgICAgIC8vIHRoZSB2YXJpYW5jZSBhdCB0aGlzIHBvaW50IGluIHRoZSBzZXF1ZW5jZSBpcyB0aGUgZGlmZmVyZW5jZVxuICAgICAgICAgICAgICAgIC8vIGJldHdlZW4gdGhlIHN1bSBvZiBzcXVhcmVzIGFuZCB0aGUgdG90YWwgeCAyLCBvdmVyIHRoZSBudW1iZXJcbiAgICAgICAgICAgICAgICAvLyBvZiBzYW1wbGVzLlxuICAgICAgICAgICAgICAgIHZhcmlhbmNlID0gc3VtX3NxdWFyZXMgLSAoc3VtICogc3VtKSAvIHc7XG5cbiAgICAgICAgICAgICAgICBpNCA9IGxvd2VyX2NsYXNzX2xpbWl0IC0gMTtcblxuICAgICAgICAgICAgICAgIGlmIChpNCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSAyOyBqIDwgbl9jbGFzc2VzICsgMTsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBhZGRpbmcgdGhpcyBlbGVtZW50IHRvIGFuIGV4aXN0aW5nIGNsYXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3aWxsIGluY3JlYXNlIGl0cyB2YXJpYW5jZSBiZXlvbmQgdGhlIGxpbWl0LCBicmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNsYXNzIGF0IHRoaXMgcG9pbnQsIHNldHRpbmcgdGhlIGBsb3dlcl9jbGFzc19saW1pdGBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF0IHRoaXMgcG9pbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFuY2VfY29tYmluYXRpb25zW2xdW2pdID49XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhcmlhbmNlICsgdmFyaWFuY2VfY29tYmluYXRpb25zW2k0XVtqIC0gMV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG93ZXJfY2xhc3NfbGltaXRzW2xdW2pdID0gbG93ZXJfY2xhc3NfbGltaXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFuY2VfY29tYmluYXRpb25zW2xdW2pdID0gdmFyaWFuY2UgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW5jZV9jb21iaW5hdGlvbnNbaTRdW2ogLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbG93ZXJfY2xhc3NfbGltaXRzW2xdWzFdID0gMTtcbiAgICAgICAgICAgIHZhcmlhbmNlX2NvbWJpbmF0aW9uc1tsXVsxXSA9IHZhcmlhbmNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmV0dXJuIHRoZSB0d28gbWF0cmljZXMuIGZvciBqdXN0IHByb3ZpZGluZyBicmVha3MsIG9ubHlcbiAgICAgICAgLy8gYGxvd2VyX2NsYXNzX2xpbWl0c2AgaXMgbmVlZGVkLCBidXQgdmFyaWFuY2VzIGNhbiBiZSB1c2VmdWwgdG9cbiAgICAgICAgLy8gZXZhbHVhdGUgZ29vZG5lc3Mgb2YgZml0LlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbG93ZXJfY2xhc3NfbGltaXRzOiBsb3dlcl9jbGFzc19saW1pdHMsXG4gICAgICAgICAgICB2YXJpYW5jZV9jb21iaW5hdGlvbnM6IHZhcmlhbmNlX2NvbWJpbmF0aW9uc1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vICMjIFB1bGwgQnJlYWtzIFZhbHVlcyBmb3IgSmVua3NcbiAgICAvL1xuICAgIC8vIHRoZSBzZWNvbmQgcGFydCBvZiB0aGUgamVua3MgcmVjaXBlOiB0YWtlIHRoZSBjYWxjdWxhdGVkIG1hdHJpY2VzXG4gICAgLy8gYW5kIGRlcml2ZSBhbiBhcnJheSBvZiBuIGJyZWFrcy5cbiAgICBmdW5jdGlvbiBqZW5rc0JyZWFrcyhkYXRhLCBsb3dlcl9jbGFzc19saW1pdHMsIG5fY2xhc3Nlcykge1xuXG4gICAgICAgIHZhciBrID0gZGF0YS5sZW5ndGgsXG4gICAgICAgICAgICBrY2xhc3MgPSBbXSxcbiAgICAgICAgICAgIGNvdW50TnVtID0gbl9jbGFzc2VzO1xuXG4gICAgICAgIC8vIHRoZSBjYWxjdWxhdGlvbiBvZiBjbGFzc2VzIHdpbGwgbmV2ZXIgaW5jbHVkZSB0aGUgdXBwZXJcbiAgICAgICAgLy8gYm91bmQsIHNvIHdlIG5lZWQgdG8gZXhwbGljaXRseSBzZXQgaXRcbiAgICAgICAga2NsYXNzW25fY2xhc3Nlc10gPSBkYXRhW2RhdGEubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgLy8gdGhlIGxvd2VyX2NsYXNzX2xpbWl0cyBtYXRyaXggaXMgdXNlZCBhcyBpbmRpY2VzIGludG8gaXRzZWxmXG4gICAgICAgIC8vIGhlcmU6IHRoZSBga2AgdmFyaWFibGUgaXMgcmV1c2VkIGluIGVhY2ggaXRlcmF0aW9uLlxuICAgICAgICB3aGlsZSAoY291bnROdW0gPiAwKSB7XG4gICAgICAgICAgICBrY2xhc3NbY291bnROdW0gLSAxXSA9IGRhdGFbbG93ZXJfY2xhc3NfbGltaXRzW2tdW2NvdW50TnVtXSAtIDFdO1xuICAgICAgICAgICAgayA9IGxvd2VyX2NsYXNzX2xpbWl0c1trXVtjb3VudE51bV0gLSAxO1xuICAgICAgICAgICAgY291bnROdW0tLTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBrY2xhc3M7XG4gICAgfVxuXG4gICAgLy8gIyBbSmVua3MgbmF0dXJhbCBicmVha3Mgb3B0aW1pemF0aW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0plbmtzX25hdHVyYWxfYnJlYWtzX29wdGltaXphdGlvbilcbiAgICAvL1xuICAgIC8vIEltcGxlbWVudGF0aW9uczogWzFdKGh0dHA6Ly9kYW5pZWxqbGV3aXMub3JnL2ZpbGVzLzIwMTAvMDYvSmVua3MucGRmKSAocHl0aG9uKSxcbiAgICAvLyBbMl0oaHR0cHM6Ly9naXRodWIuY29tL3Z2b292di9kamVvLWplbmtzL2Jsb2IvbWFzdGVyL21haW4uanMpIChidWdneSksXG4gICAgLy8gWzNdKGh0dHBzOi8vZ2l0aHViLmNvbS9zaW1vZ2VvL2dlb3N0YXRzL2Jsb2IvbWFzdGVyL2xpYi9nZW9zdGF0cy5qcyNMNDA3KSAod29ya3MpXG4gICAgLy9cbiAgICAvLyBEZXBlbmRzIG9uIGBqZW5rc0JyZWFrcygpYCBhbmQgYGplbmtzTWF0cmljZXMoKWBcbiAgICBmdW5jdGlvbiBqZW5rcyhkYXRhLCBuX2NsYXNzZXMpIHtcblxuICAgICAgICBpZiAobl9jbGFzc2VzID4gZGF0YS5sZW5ndGgpIHJldHVybiBudWxsO1xuXG4gICAgICAgIC8vIHNvcnQgZGF0YSBpbiBudW1lcmljYWwgb3JkZXIsIHNpbmNlIHRoaXMgaXMgZXhwZWN0ZWRcbiAgICAgICAgLy8gYnkgdGhlIG1hdHJpY2VzIGZ1bmN0aW9uXG4gICAgICAgIGRhdGEgPSBkYXRhLnNsaWNlKCkuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pO1xuXG4gICAgICAgIC8vIGdldCBvdXIgYmFzaWMgbWF0cmljZXNcbiAgICAgICAgdmFyIG1hdHJpY2VzID0gamVua3NNYXRyaWNlcyhkYXRhLCBuX2NsYXNzZXMpLFxuICAgICAgICAgICAgLy8gd2Ugb25seSBuZWVkIGxvd2VyIGNsYXNzIGxpbWl0cyBoZXJlXG4gICAgICAgICAgICBsb3dlcl9jbGFzc19saW1pdHMgPSBtYXRyaWNlcy5sb3dlcl9jbGFzc19saW1pdHM7XG5cbiAgICAgICAgLy8gZXh0cmFjdCBuX2NsYXNzZXMgb3V0IG9mIHRoZSBjb21wdXRlZCBtYXRyaWNlc1xuICAgICAgICByZXR1cm4gamVua3NCcmVha3MoZGF0YSwgbG93ZXJfY2xhc3NfbGltaXRzLCBuX2NsYXNzZXMpO1xuXG4gICAgfVxuXG4gICAgLy8gIyBbU2tld25lc3NdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2tld25lc3MpXG4gICAgLy9cbiAgICAvLyBBIG1lYXN1cmUgb2YgdGhlIGV4dGVudCB0byB3aGljaCBhIHByb2JhYmlsaXR5IGRpc3RyaWJ1dGlvbiBvZiBhXG4gICAgLy8gcmVhbC12YWx1ZWQgcmFuZG9tIHZhcmlhYmxlIFwibGVhbnNcIiB0byBvbmUgc2lkZSBvZiB0aGUgbWVhbi5cbiAgICAvLyBUaGUgc2tld25lc3MgdmFsdWUgY2FuIGJlIHBvc2l0aXZlIG9yIG5lZ2F0aXZlLCBvciBldmVuIHVuZGVmaW5lZC5cbiAgICAvL1xuICAgIC8vIEltcGxlbWVudGF0aW9uIGlzIGJhc2VkIG9uIHRoZSBhZGp1c3RlZCBGaXNoZXItUGVhcnNvbiBzdGFuZGFyZGl6ZWRcbiAgICAvLyBtb21lbnQgY29lZmZpY2llbnQsIHdoaWNoIGlzIHRoZSB2ZXJzaW9uIGZvdW5kIGluIEV4Y2VsIGFuZCBzZXZlcmFsXG4gICAgLy8gc3RhdGlzdGljYWwgcGFja2FnZXMgaW5jbHVkaW5nIE1pbml0YWIsIFNBUyBhbmQgU1BTUy5cbiAgICAvL1xuICAgIC8vIERlcGVuZHMgb24gYHN1bV9udGhfcG93ZXJfZGV2aWF0aW9ucygpYCBhbmQgYHNhbXBsZV9zdGFuZGFyZF9kZXZpYXRpb25gXG4gICAgZnVuY3Rpb24gc2FtcGxlX3NrZXduZXNzKHgpIHtcbiAgICAgICAgLy8gVGhlIHNrZXduZXNzIG9mIGxlc3MgdGhhbiB0aHJlZSBhcmd1bWVudHMgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPCAzKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB2YXIgbiA9IHgubGVuZ3RoLFxuICAgICAgICAgICAgY3ViZWRfcyA9IE1hdGgucG93KHNhbXBsZV9zdGFuZGFyZF9kZXZpYXRpb24oeCksIDMpLFxuICAgICAgICAgICAgc3VtX2N1YmVkX2RldmlhdGlvbnMgPSBzdW1fbnRoX3Bvd2VyX2RldmlhdGlvbnMoeCwgMyk7XG5cbiAgICAgICAgcmV0dXJuIG4gKiBzdW1fY3ViZWRfZGV2aWF0aW9ucyAvICgobiAtIDEpICogKG4gLSAyKSAqIGN1YmVkX3MpO1xuICAgIH1cblxuICAgIC8vICMgU3RhbmRhcmQgTm9ybWFsIFRhYmxlXG4gICAgLy8gQSBzdGFuZGFyZCBub3JtYWwgdGFibGUsIGFsc28gY2FsbGVkIHRoZSB1bml0IG5vcm1hbCB0YWJsZSBvciBaIHRhYmxlLFxuICAgIC8vIGlzIGEgbWF0aGVtYXRpY2FsIHRhYmxlIGZvciB0aGUgdmFsdWVzIG9mIM6mIChwaGkpLCB3aGljaCBhcmUgdGhlIHZhbHVlcyBvZlxuICAgIC8vIHRoZSBjdW11bGF0aXZlIGRpc3RyaWJ1dGlvbiBmdW5jdGlvbiBvZiB0aGUgbm9ybWFsIGRpc3RyaWJ1dGlvbi5cbiAgICAvLyBJdCBpcyB1c2VkIHRvIGZpbmQgdGhlIHByb2JhYmlsaXR5IHRoYXQgYSBzdGF0aXN0aWMgaXMgb2JzZXJ2ZWQgYmVsb3csXG4gICAgLy8gYWJvdmUsIG9yIGJldHdlZW4gdmFsdWVzIG9uIHRoZSBzdGFuZGFyZCBub3JtYWwgZGlzdHJpYnV0aW9uLCBhbmQgYnlcbiAgICAvLyBleHRlbnNpb24sIGFueSBub3JtYWwgZGlzdHJpYnV0aW9uLlxuICAgIC8vXG4gICAgLy8gVGhlIHByb2JhYmlsaXRpZXMgYXJlIHRha2VuIGZyb20gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TdGFuZGFyZF9ub3JtYWxfdGFibGVcbiAgICAvLyBUaGUgdGFibGUgdXNlZCBpcyB0aGUgY3VtdWxhdGl2ZSwgYW5kIG5vdCBjdW11bGF0aXZlIGZyb20gMCB0byBtZWFuXG4gICAgLy8gKGV2ZW4gdGhvdWdoIHRoZSBsYXR0ZXIgaGFzIDUgZGlnaXRzIHByZWNpc2lvbiwgaW5zdGVhZCBvZiA0KS5cbiAgICB2YXIgc3RhbmRhcmRfbm9ybWFsX3RhYmxlID0gW1xuICAgICAgICAvKiAgeiAgICAgIDAuMDAgICAgMC4wMSAgICAwLjAyICAgIDAuMDMgICAgMC4wNCAgICAwLjA1ICAgIDAuMDYgICAgMC4wNyAgICAwLjA4ICAgIDAuMDkgKi9cbiAgICAgICAgLyogMC4wICovXG4gICAgICAgIDAuNTAwMCwgMC41MDQwLCAwLjUwODAsIDAuNTEyMCwgMC41MTYwLCAwLjUxOTksIDAuNTIzOSwgMC41Mjc5LCAwLjUzMTksIDAuNTM1OSxcbiAgICAgICAgLyogMC4xICovXG4gICAgICAgIDAuNTM5OCwgMC41NDM4LCAwLjU0NzgsIDAuNTUxNywgMC41NTU3LCAwLjU1OTYsIDAuNTYzNiwgMC41Njc1LCAwLjU3MTQsIDAuNTc1MyxcbiAgICAgICAgLyogMC4yICovXG4gICAgICAgIDAuNTc5MywgMC41ODMyLCAwLjU4NzEsIDAuNTkxMCwgMC41OTQ4LCAwLjU5ODcsIDAuNjAyNiwgMC42MDY0LCAwLjYxMDMsIDAuNjE0MSxcbiAgICAgICAgLyogMC4zICovXG4gICAgICAgIDAuNjE3OSwgMC42MjE3LCAwLjYyNTUsIDAuNjI5MywgMC42MzMxLCAwLjYzNjgsIDAuNjQwNiwgMC42NDQzLCAwLjY0ODAsIDAuNjUxNyxcbiAgICAgICAgLyogMC40ICovXG4gICAgICAgIDAuNjU1NCwgMC42NTkxLCAwLjY2MjgsIDAuNjY2NCwgMC42NzAwLCAwLjY3MzYsIDAuNjc3MiwgMC42ODA4LCAwLjY4NDQsIDAuNjg3OSxcbiAgICAgICAgLyogMC41ICovXG4gICAgICAgIDAuNjkxNSwgMC42OTUwLCAwLjY5ODUsIDAuNzAxOSwgMC43MDU0LCAwLjcwODgsIDAuNzEyMywgMC43MTU3LCAwLjcxOTAsIDAuNzIyNCxcbiAgICAgICAgLyogMC42ICovXG4gICAgICAgIDAuNzI1NywgMC43MjkxLCAwLjczMjQsIDAuNzM1NywgMC43Mzg5LCAwLjc0MjIsIDAuNzQ1NCwgMC43NDg2LCAwLjc1MTcsIDAuNzU0OSxcbiAgICAgICAgLyogMC43ICovXG4gICAgICAgIDAuNzU4MCwgMC43NjExLCAwLjc2NDIsIDAuNzY3MywgMC43NzA0LCAwLjc3MzQsIDAuNzc2NCwgMC43Nzk0LCAwLjc4MjMsIDAuNzg1MixcbiAgICAgICAgLyogMC44ICovXG4gICAgICAgIDAuNzg4MSwgMC43OTEwLCAwLjc5MzksIDAuNzk2NywgMC43OTk1LCAwLjgwMjMsIDAuODA1MSwgMC44MDc4LCAwLjgxMDYsIDAuODEzMyxcbiAgICAgICAgLyogMC45ICovXG4gICAgICAgIDAuODE1OSwgMC44MTg2LCAwLjgyMTIsIDAuODIzOCwgMC44MjY0LCAwLjgyODksIDAuODMxNSwgMC44MzQwLCAwLjgzNjUsIDAuODM4OSxcbiAgICAgICAgLyogMS4wICovXG4gICAgICAgIDAuODQxMywgMC44NDM4LCAwLjg0NjEsIDAuODQ4NSwgMC44NTA4LCAwLjg1MzEsIDAuODU1NCwgMC44NTc3LCAwLjg1OTksIDAuODYyMSxcbiAgICAgICAgLyogMS4xICovXG4gICAgICAgIDAuODY0MywgMC44NjY1LCAwLjg2ODYsIDAuODcwOCwgMC44NzI5LCAwLjg3NDksIDAuODc3MCwgMC44NzkwLCAwLjg4MTAsIDAuODgzMCxcbiAgICAgICAgLyogMS4yICovXG4gICAgICAgIDAuODg0OSwgMC44ODY5LCAwLjg4ODgsIDAuODkwNywgMC44OTI1LCAwLjg5NDQsIDAuODk2MiwgMC44OTgwLCAwLjg5OTcsIDAuOTAxNSxcbiAgICAgICAgLyogMS4zICovXG4gICAgICAgIDAuOTAzMiwgMC45MDQ5LCAwLjkwNjYsIDAuOTA4MiwgMC45MDk5LCAwLjkxMTUsIDAuOTEzMSwgMC45MTQ3LCAwLjkxNjIsIDAuOTE3NyxcbiAgICAgICAgLyogMS40ICovXG4gICAgICAgIDAuOTE5MiwgMC45MjA3LCAwLjkyMjIsIDAuOTIzNiwgMC45MjUxLCAwLjkyNjUsIDAuOTI3OSwgMC45MjkyLCAwLjkzMDYsIDAuOTMxOSxcbiAgICAgICAgLyogMS41ICovXG4gICAgICAgIDAuOTMzMiwgMC45MzQ1LCAwLjkzNTcsIDAuOTM3MCwgMC45MzgyLCAwLjkzOTQsIDAuOTQwNiwgMC45NDE4LCAwLjk0MjksIDAuOTQ0MSxcbiAgICAgICAgLyogMS42ICovXG4gICAgICAgIDAuOTQ1MiwgMC45NDYzLCAwLjk0NzQsIDAuOTQ4NCwgMC45NDk1LCAwLjk1MDUsIDAuOTUxNSwgMC45NTI1LCAwLjk1MzUsIDAuOTU0NSxcbiAgICAgICAgLyogMS43ICovXG4gICAgICAgIDAuOTU1NCwgMC45NTY0LCAwLjk1NzMsIDAuOTU4MiwgMC45NTkxLCAwLjk1OTksIDAuOTYwOCwgMC45NjE2LCAwLjk2MjUsIDAuOTYzMyxcbiAgICAgICAgLyogMS44ICovXG4gICAgICAgIDAuOTY0MSwgMC45NjQ5LCAwLjk2NTYsIDAuOTY2NCwgMC45NjcxLCAwLjk2NzgsIDAuOTY4NiwgMC45NjkzLCAwLjk2OTksIDAuOTcwNixcbiAgICAgICAgLyogMS45ICovXG4gICAgICAgIDAuOTcxMywgMC45NzE5LCAwLjk3MjYsIDAuOTczMiwgMC45NzM4LCAwLjk3NDQsIDAuOTc1MCwgMC45NzU2LCAwLjk3NjEsIDAuOTc2NyxcbiAgICAgICAgLyogMi4wICovXG4gICAgICAgIDAuOTc3MiwgMC45Nzc4LCAwLjk3ODMsIDAuOTc4OCwgMC45NzkzLCAwLjk3OTgsIDAuOTgwMywgMC45ODA4LCAwLjk4MTIsIDAuOTgxNyxcbiAgICAgICAgLyogMi4xICovXG4gICAgICAgIDAuOTgyMSwgMC45ODI2LCAwLjk4MzAsIDAuOTgzNCwgMC45ODM4LCAwLjk4NDIsIDAuOTg0NiwgMC45ODUwLCAwLjk4NTQsIDAuOTg1NyxcbiAgICAgICAgLyogMi4yICovXG4gICAgICAgIDAuOTg2MSwgMC45ODY0LCAwLjk4NjgsIDAuOTg3MSwgMC45ODc1LCAwLjk4NzgsIDAuOTg4MSwgMC45ODg0LCAwLjk4ODcsIDAuOTg5MCxcbiAgICAgICAgLyogMi4zICovXG4gICAgICAgIDAuOTg5MywgMC45ODk2LCAwLjk4OTgsIDAuOTkwMSwgMC45OTA0LCAwLjk5MDYsIDAuOTkwOSwgMC45OTExLCAwLjk5MTMsIDAuOTkxNixcbiAgICAgICAgLyogMi40ICovXG4gICAgICAgIDAuOTkxOCwgMC45OTIwLCAwLjk5MjIsIDAuOTkyNSwgMC45OTI3LCAwLjk5MjksIDAuOTkzMSwgMC45OTMyLCAwLjk5MzQsIDAuOTkzNixcbiAgICAgICAgLyogMi41ICovXG4gICAgICAgIDAuOTkzOCwgMC45OTQwLCAwLjk5NDEsIDAuOTk0MywgMC45OTQ1LCAwLjk5NDYsIDAuOTk0OCwgMC45OTQ5LCAwLjk5NTEsIDAuOTk1MixcbiAgICAgICAgLyogMi42ICovXG4gICAgICAgIDAuOTk1MywgMC45OTU1LCAwLjk5NTYsIDAuOTk1NywgMC45OTU5LCAwLjk5NjAsIDAuOTk2MSwgMC45OTYyLCAwLjk5NjMsIDAuOTk2NCxcbiAgICAgICAgLyogMi43ICovXG4gICAgICAgIDAuOTk2NSwgMC45OTY2LCAwLjk5NjcsIDAuOTk2OCwgMC45OTY5LCAwLjk5NzAsIDAuOTk3MSwgMC45OTcyLCAwLjk5NzMsIDAuOTk3NCxcbiAgICAgICAgLyogMi44ICovXG4gICAgICAgIDAuOTk3NCwgMC45OTc1LCAwLjk5NzYsIDAuOTk3NywgMC45OTc3LCAwLjk5NzgsIDAuOTk3OSwgMC45OTc5LCAwLjk5ODAsIDAuOTk4MSxcbiAgICAgICAgLyogMi45ICovXG4gICAgICAgIDAuOTk4MSwgMC45OTgyLCAwLjk5ODIsIDAuOTk4MywgMC45OTg0LCAwLjk5ODQsIDAuOTk4NSwgMC45OTg1LCAwLjk5ODYsIDAuOTk4NixcbiAgICAgICAgLyogMy4wICovXG4gICAgICAgIDAuOTk4NywgMC45OTg3LCAwLjk5ODcsIDAuOTk4OCwgMC45OTg4LCAwLjk5ODksIDAuOTk4OSwgMC45OTg5LCAwLjk5OTAsIDAuOTk5MFxuICAgIF07XG5cbiAgICAvLyAjIFtHYXVzc2lhbiBlcnJvciBmdW5jdGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9FcnJvcl9mdW5jdGlvbilcbiAgICAvL1xuICAgIC8vIFRoZSBlcnJvcl9mdW5jdGlvbih4LyhzZCAqIE1hdGguc3FydCgyKSkpIGlzIHRoZSBwcm9iYWJpbGl0eSB0aGF0IGEgdmFsdWUgaW4gYVxuICAgIC8vIG5vcm1hbCBkaXN0cmlidXRpb24gd2l0aCBzdGFuZGFyZCBkZXZpYXRpb24gc2QgaXMgd2l0aGluIHggb2YgdGhlIG1lYW4uXG4gICAgLy9cbiAgICAvLyBUaGlzIGZ1bmN0aW9uIHJldHVybnMgYSBudW1lcmljYWwgYXBwcm94aW1hdGlvbiB0byB0aGUgZXhhY3QgdmFsdWUuXG4gICAgZnVuY3Rpb24gZXJyb3JfZnVuY3Rpb24oeCkge1xuICAgICAgICB2YXIgdCA9IDEgLyAoMSArIDAuNSAqIE1hdGguYWJzKHgpKTtcbiAgICAgICAgdmFyIHRhdSA9IHQgKiBNYXRoLmV4cCgtTWF0aC5wb3coeCwgMikgLVxuICAgICAgICAgICAgMS4yNjU1MTIyMyArXG4gICAgICAgICAgICAxLjAwMDAyMzY4ICogdCArXG4gICAgICAgICAgICAwLjM3NDA5MTk2ICogTWF0aC5wb3codCwgMikgK1xuICAgICAgICAgICAgMC4wOTY3ODQxOCAqIE1hdGgucG93KHQsIDMpIC1cbiAgICAgICAgICAgIDAuMTg2Mjg4MDYgKiBNYXRoLnBvdyh0LCA0KSArXG4gICAgICAgICAgICAwLjI3ODg2ODA3ICogTWF0aC5wb3codCwgNSkgLVxuICAgICAgICAgICAgMS4xMzUyMDM5OCAqIE1hdGgucG93KHQsIDYpICtcbiAgICAgICAgICAgIDEuNDg4NTE1ODcgKiBNYXRoLnBvdyh0LCA3KSAtXG4gICAgICAgICAgICAwLjgyMjE1MjIzICogTWF0aC5wb3codCwgOCkgK1xuICAgICAgICAgICAgMC4xNzA4NzI3NyAqIE1hdGgucG93KHQsIDkpKTtcbiAgICAgICAgaWYgKHggPj0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDEgLSB0YXU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGF1IC0gMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vICMgW0N1bXVsYXRpdmUgU3RhbmRhcmQgTm9ybWFsIFByb2JhYmlsaXR5XShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1N0YW5kYXJkX25vcm1hbF90YWJsZSlcbiAgICAvL1xuICAgIC8vIFNpbmNlIHByb2JhYmlsaXR5IHRhYmxlcyBjYW5ub3QgYmVcbiAgICAvLyBwcmludGVkIGZvciBldmVyeSBub3JtYWwgZGlzdHJpYnV0aW9uLCBhcyB0aGVyZSBhcmUgYW4gaW5maW5pdGUgdmFyaWV0eVxuICAgIC8vIG9mIG5vcm1hbCBkaXN0cmlidXRpb25zLCBpdCBpcyBjb21tb24gcHJhY3RpY2UgdG8gY29udmVydCBhIG5vcm1hbCB0byBhXG4gICAgLy8gc3RhbmRhcmQgbm9ybWFsIGFuZCB0aGVuIHVzZSB0aGUgc3RhbmRhcmQgbm9ybWFsIHRhYmxlIHRvIGZpbmQgcHJvYmFiaWxpdGllcy5cbiAgICAvL1xuICAgIC8vIFlvdSBjYW4gdXNlIC41ICsgLjUgKiBlcnJvcl9mdW5jdGlvbih4IC8gTWF0aC5zcXJ0KDIpKSB0byBjYWxjdWxhdGUgdGhlIHByb2JhYmlsaXR5XG4gICAgLy8gaW5zdGVhZCBvZiBsb29raW5nIGl0IHVwIGluIGEgdGFibGUuXG4gICAgZnVuY3Rpb24gY3VtdWxhdGl2ZV9zdGRfbm9ybWFsX3Byb2JhYmlsaXR5KHopIHtcblxuICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIG9mIHRoaXMgdmFsdWUuXG4gICAgICAgIHZhciBhYnNaID0gTWF0aC5hYnMoeiksXG4gICAgICAgICAgICAvLyBFYWNoIHJvdyBiZWdpbnMgd2l0aCBhIGRpZmZlcmVudFxuICAgICAgICAgICAgLy8gc2lnbmlmaWNhbnQgZGlnaXQ6IDAuNSwgMC42LCAwLjcsIGFuZCBzbyBvbi4gRWFjaCB2YWx1ZSBpbiB0aGUgdGFibGVcbiAgICAgICAgICAgIC8vIGNvcnJlc3BvbmRzIHRvIGEgcmFuZ2Ugb2YgMC4wMSBpbiB0aGUgaW5wdXQgdmFsdWVzLCBzbyB0aGUgdmFsdWUgaXNcbiAgICAgICAgICAgIC8vIG11bHRpcGxpZWQgYnkgMTAwLlxuICAgICAgICAgICAgaW5kZXggPSBNYXRoLm1pbihNYXRoLnJvdW5kKGFic1ogKiAxMDApLCBzdGFuZGFyZF9ub3JtYWxfdGFibGUubGVuZ3RoIC0gMSk7XG5cbiAgICAgICAgLy8gVGhlIGluZGV4IHdlIGNhbGN1bGF0ZSBtdXN0IGJlIGluIHRoZSB0YWJsZSBhcyBhIHBvc2l0aXZlIHZhbHVlLFxuICAgICAgICAvLyBidXQgd2Ugc3RpbGwgcGF5IGF0dGVudGlvbiB0byB3aGV0aGVyIHRoZSBpbnB1dCBpcyBwb3NpdGl2ZVxuICAgICAgICAvLyBvciBuZWdhdGl2ZSwgYW5kIGZsaXAgdGhlIG91dHB1dCB2YWx1ZSBhcyBhIGxhc3Qgc3RlcC5cbiAgICAgICAgaWYgKHogPj0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHN0YW5kYXJkX25vcm1hbF90YWJsZVtpbmRleF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBkdWUgdG8gZmxvYXRpbmctcG9pbnQgYXJpdGhtZXRpYywgdmFsdWVzIGluIHRoZSB0YWJsZSB3aXRoXG4gICAgICAgICAgICAvLyA0IHNpZ25pZmljYW50IGZpZ3VyZXMgY2FuIG5ldmVydGhlbGVzcyBlbmQgdXAgYXMgcmVwZWF0aW5nXG4gICAgICAgICAgICAvLyBmcmFjdGlvbnMgd2hlbiB0aGV5J3JlIGNvbXB1dGVkIGhlcmUuXG4gICAgICAgICAgICByZXR1cm4gKygxIC0gc3RhbmRhcmRfbm9ybWFsX3RhYmxlW2luZGV4XSkudG9GaXhlZCg0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vICMgW1otU2NvcmUsIG9yIFN0YW5kYXJkIFNjb3JlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1N0YW5kYXJkX3Njb3JlKVxuICAgIC8vXG4gICAgLy8gVGhlIHN0YW5kYXJkIHNjb3JlIGlzIHRoZSBudW1iZXIgb2Ygc3RhbmRhcmQgZGV2aWF0aW9ucyBhbiBvYnNlcnZhdGlvblxuICAgIC8vIG9yIGRhdHVtIGlzIGFib3ZlIG9yIGJlbG93IHRoZSBtZWFuLiBUaHVzLCBhIHBvc2l0aXZlIHN0YW5kYXJkIHNjb3JlXG4gICAgLy8gcmVwcmVzZW50cyBhIGRhdHVtIGFib3ZlIHRoZSBtZWFuLCB3aGlsZSBhIG5lZ2F0aXZlIHN0YW5kYXJkIHNjb3JlXG4gICAgLy8gcmVwcmVzZW50cyBhIGRhdHVtIGJlbG93IHRoZSBtZWFuLiBJdCBpcyBhIGRpbWVuc2lvbmxlc3MgcXVhbnRpdHlcbiAgICAvLyBvYnRhaW5lZCBieSBzdWJ0cmFjdGluZyB0aGUgcG9wdWxhdGlvbiBtZWFuIGZyb20gYW4gaW5kaXZpZHVhbCByYXdcbiAgICAvLyBzY29yZSBhbmQgdGhlbiBkaXZpZGluZyB0aGUgZGlmZmVyZW5jZSBieSB0aGUgcG9wdWxhdGlvbiBzdGFuZGFyZFxuICAgIC8vIGRldmlhdGlvbi5cbiAgICAvL1xuICAgIC8vIFRoZSB6LXNjb3JlIGlzIG9ubHkgZGVmaW5lZCBpZiBvbmUga25vd3MgdGhlIHBvcHVsYXRpb24gcGFyYW1ldGVycztcbiAgICAvLyBpZiBvbmUgb25seSBoYXMgYSBzYW1wbGUgc2V0LCB0aGVuIHRoZSBhbmFsb2dvdXMgY29tcHV0YXRpb24gd2l0aFxuICAgIC8vIHNhbXBsZSBtZWFuIGFuZCBzYW1wbGUgc3RhbmRhcmQgZGV2aWF0aW9uIHlpZWxkcyB0aGVcbiAgICAvLyBTdHVkZW50J3MgdC1zdGF0aXN0aWMuXG4gICAgZnVuY3Rpb24gel9zY29yZSh4LCBtZWFuLCBzdGFuZGFyZF9kZXZpYXRpb24pIHtcbiAgICAgICAgcmV0dXJuICh4IC0gbWVhbikgLyBzdGFuZGFyZF9kZXZpYXRpb247XG4gICAgfVxuXG4gICAgLy8gV2UgdXNlIGDOtWAsIGVwc2lsb24sIGFzIGEgc3RvcHBpbmcgY3JpdGVyaW9uIHdoZW4gd2Ugd2FudCB0byBpdGVyYXRlXG4gICAgLy8gdW50aWwgd2UncmUgXCJjbG9zZSBlbm91Z2hcIi5cbiAgICB2YXIgZXBzaWxvbiA9IDAuMDAwMTtcblxuICAgIC8vICMgW0ZhY3RvcmlhbF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRmFjdG9yaWFsKVxuICAgIC8vXG4gICAgLy8gQSBmYWN0b3JpYWwsIHVzdWFsbHkgd3JpdHRlbiBuISwgaXMgdGhlIHByb2R1Y3Qgb2YgYWxsIHBvc2l0aXZlXG4gICAgLy8gaW50ZWdlcnMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIG4uIE9mdGVuIGZhY3RvcmlhbCBpcyBpbXBsZW1lbnRlZFxuICAgIC8vIHJlY3Vyc2l2ZWx5LCBidXQgdGhpcyBpdGVyYXRpdmUgYXBwcm9hY2ggaXMgc2lnbmlmaWNhbnRseSBmYXN0ZXJcbiAgICAvLyBhbmQgc2ltcGxlci5cbiAgICBmdW5jdGlvbiBmYWN0b3JpYWwobikge1xuXG4gICAgICAgIC8vIGZhY3RvcmlhbCBpcyBtYXRoZW1hdGljYWxseSB1bmRlZmluZWQgZm9yIG5lZ2F0aXZlIG51bWJlcnNcbiAgICAgICAgaWYgKG4gPCAwICkgeyByZXR1cm4gbnVsbDsgfVxuXG4gICAgICAgIC8vIHR5cGljYWxseSB5b3UnbGwgZXhwYW5kIHRoZSBmYWN0b3JpYWwgZnVuY3Rpb24gZ29pbmcgZG93biwgbGlrZVxuICAgICAgICAvLyA1ISA9IDUgKiA0ICogMyAqIDIgKiAxLiBUaGlzIGlzIGdvaW5nIGluIHRoZSBvcHBvc2l0ZSBkaXJlY3Rpb24sXG4gICAgICAgIC8vIGNvdW50aW5nIGZyb20gMiB1cCB0byB0aGUgbnVtYmVyIGluIHF1ZXN0aW9uLCBhbmQgc2luY2UgYW55dGhpbmdcbiAgICAgICAgLy8gbXVsdGlwbGllZCBieSAxIGlzIGl0c2VsZiwgdGhlIGxvb3Agb25seSBuZWVkcyB0byBzdGFydCBhdCAyLlxuICAgICAgICB2YXIgYWNjdW11bGF0b3IgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMjsgaSA8PSBuOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGZvciBlYWNoIG51bWJlciB1cCB0byBhbmQgaW5jbHVkaW5nIHRoZSBudW1iZXIgYG5gLCBtdWx0aXBseVxuICAgICAgICAgICAgLy8gdGhlIGFjY3VtdWxhdG9yIG15IHRoYXQgbnVtYmVyLlxuICAgICAgICAgICAgYWNjdW11bGF0b3IgKj0gaTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjdW11bGF0b3I7XG4gICAgfVxuXG4gICAgLy8gIyBCZXJub3VsbGkgRGlzdHJpYnV0aW9uXG4gICAgLy9cbiAgICAvLyBUaGUgW0Jlcm5vdWxsaSBkaXN0cmlidXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmVybm91bGxpX2Rpc3RyaWJ1dGlvbilcbiAgICAvLyBpcyB0aGUgcHJvYmFiaWxpdHkgZGlzY3JldGVcbiAgICAvLyBkaXN0cmlidXRpb24gb2YgYSByYW5kb20gdmFyaWFibGUgd2hpY2ggdGFrZXMgdmFsdWUgMSB3aXRoIHN1Y2Nlc3NcbiAgICAvLyBwcm9iYWJpbGl0eSBgcGAgYW5kIHZhbHVlIDAgd2l0aCBmYWlsdXJlXG4gICAgLy8gcHJvYmFiaWxpdHkgYHFgID0gMSAtIGBwYC4gSXQgY2FuIGJlIHVzZWQsIGZvciBleGFtcGxlLCB0byByZXByZXNlbnQgdGhlXG4gICAgLy8gdG9zcyBvZiBhIGNvaW4sIHdoZXJlIFwiMVwiIGlzIGRlZmluZWQgdG8gbWVhbiBcImhlYWRzXCIgYW5kIFwiMFwiIGlzIGRlZmluZWRcbiAgICAvLyB0byBtZWFuIFwidGFpbHNcIiAob3IgdmljZSB2ZXJzYSkuIEl0IGlzXG4gICAgLy8gYSBzcGVjaWFsIGNhc2Ugb2YgYSBCaW5vbWlhbCBEaXN0cmlidXRpb25cbiAgICAvLyB3aGVyZSBgbmAgPSAxLlxuICAgIGZ1bmN0aW9uIGJlcm5vdWxsaV9kaXN0cmlidXRpb24ocCkge1xuICAgICAgICAvLyBDaGVjayB0aGF0IGBwYCBpcyBhIHZhbGlkIHByb2JhYmlsaXR5ICgwIOKJpCBwIOKJpCAxKVxuICAgICAgICBpZiAocCA8IDAgfHwgcCA+IDEgKSB7IHJldHVybiBudWxsOyB9XG5cbiAgICAgICAgcmV0dXJuIGJpbm9taWFsX2Rpc3RyaWJ1dGlvbigxLCBwKTtcbiAgICB9XG5cbiAgICAvLyAjIEJpbm9taWFsIERpc3RyaWJ1dGlvblxuICAgIC8vXG4gICAgLy8gVGhlIFtCaW5vbWlhbCBEaXN0cmlidXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmlub21pYWxfZGlzdHJpYnV0aW9uKSBpcyB0aGUgZGlzY3JldGUgcHJvYmFiaWxpdHlcbiAgICAvLyBkaXN0cmlidXRpb24gb2YgdGhlIG51bWJlciBvZiBzdWNjZXNzZXMgaW4gYSBzZXF1ZW5jZSBvZiBuIGluZGVwZW5kZW50IHllcy9ubyBleHBlcmltZW50cywgZWFjaCBvZiB3aGljaCB5aWVsZHNcbiAgICAvLyBzdWNjZXNzIHdpdGggcHJvYmFiaWxpdHkgYHByb2JhYmlsaXR5YC4gU3VjaCBhIHN1Y2Nlc3MvZmFpbHVyZSBleHBlcmltZW50IGlzIGFsc28gY2FsbGVkIGEgQmVybm91bGxpIGV4cGVyaW1lbnQgb3JcbiAgICAvLyBCZXJub3VsbGkgdHJpYWw7IHdoZW4gdHJpYWxzID0gMSwgdGhlIEJpbm9taWFsIERpc3RyaWJ1dGlvbiBpcyBhIEJlcm5vdWxsaSBEaXN0cmlidXRpb24uXG4gICAgZnVuY3Rpb24gYmlub21pYWxfZGlzdHJpYnV0aW9uKHRyaWFscywgcHJvYmFiaWxpdHkpIHtcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCBgcGAgaXMgYSB2YWxpZCBwcm9iYWJpbGl0eSAoMCDiiaQgcCDiiaQgMSksXG4gICAgICAgIC8vIHRoYXQgYG5gIGlzIGFuIGludGVnZXIsIHN0cmljdGx5IHBvc2l0aXZlLlxuICAgICAgICBpZiAocHJvYmFiaWxpdHkgPCAwIHx8IHByb2JhYmlsaXR5ID4gMSB8fFxuICAgICAgICAgICAgdHJpYWxzIDw9IDAgfHwgdHJpYWxzICUgMSAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBhIFtwcm9iYWJpbGl0eSBtYXNzIGZ1bmN0aW9uXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Qcm9iYWJpbGl0eV9tYXNzX2Z1bmN0aW9uKVxuICAgICAgICBmdW5jdGlvbiBwcm9iYWJpbGl0eV9tYXNzKHgsIHRyaWFscywgcHJvYmFiaWxpdHkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWN0b3JpYWwodHJpYWxzKSAvXG4gICAgICAgICAgICAgICAgKGZhY3RvcmlhbCh4KSAqIGZhY3RvcmlhbCh0cmlhbHMgLSB4KSkgKlxuICAgICAgICAgICAgICAgIChNYXRoLnBvdyhwcm9iYWJpbGl0eSwgeCkgKiBNYXRoLnBvdygxIC0gcHJvYmFiaWxpdHksIHRyaWFscyAtIHgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdlIGluaXRpYWxpemUgYHhgLCB0aGUgcmFuZG9tIHZhcmlhYmxlLCBhbmQgYGFjY3VtdWxhdG9yYCwgYW4gYWNjdW11bGF0b3JcbiAgICAgICAgLy8gZm9yIHRoZSBjdW11bGF0aXZlIGRpc3RyaWJ1dGlvbiBmdW5jdGlvbiB0byAwLiBgZGlzdHJpYnV0aW9uX2Z1bmN0aW9uc2BcbiAgICAgICAgLy8gaXMgdGhlIG9iamVjdCB3ZSdsbCByZXR1cm4gd2l0aCB0aGUgYHByb2JhYmlsaXR5X29mX3hgIGFuZCB0aGVcbiAgICAgICAgLy8gYGN1bXVsYXRpdmVfcHJvYmFiaWxpdHlfb2ZfeGAsIGFzIHdlbGwgYXMgdGhlIGNhbGN1bGF0ZWQgbWVhbiAmXG4gICAgICAgIC8vIHZhcmlhbmNlLiBXZSBpdGVyYXRlIHVudGlsIHRoZSBgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eV9vZl94YCBpc1xuICAgICAgICAvLyB3aXRoaW4gYGVwc2lsb25gIG9mIDEuMC5cbiAgICAgICAgdmFyIHggPSAwLFxuICAgICAgICAgICAgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eSA9IDAsXG4gICAgICAgICAgICBjZWxscyA9IHt9O1xuXG4gICAgICAgIC8vIFRoaXMgYWxnb3JpdGhtIGl0ZXJhdGVzIHRocm91Z2ggZWFjaCBwb3RlbnRpYWwgb3V0Y29tZSxcbiAgICAgICAgLy8gdW50aWwgdGhlIGBjdW11bGF0aXZlX3Byb2JhYmlsaXR5YCBpcyB2ZXJ5IGNsb3NlIHRvIDEsIGF0XG4gICAgICAgIC8vIHdoaWNoIHBvaW50IHdlJ3ZlIGRlZmluZWQgdGhlIHZhc3QgbWFqb3JpdHkgb2Ygb3V0Y29tZXNcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgY2VsbHNbeF0gPSBwcm9iYWJpbGl0eV9tYXNzKHgsIHRyaWFscywgcHJvYmFiaWxpdHkpO1xuICAgICAgICAgICAgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eSArPSBjZWxsc1t4XTtcbiAgICAgICAgICAgIHgrKztcbiAgICAgICAgLy8gd2hlbiB0aGUgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eSBpcyBuZWFybHkgMSwgd2UndmUgY2FsY3VsYXRlZFxuICAgICAgICAvLyB0aGUgdXNlZnVsIHJhbmdlIG9mIHRoaXMgZGlzdHJpYnV0aW9uXG4gICAgICAgIH0gd2hpbGUgKGN1bXVsYXRpdmVfcHJvYmFiaWxpdHkgPCAxIC0gZXBzaWxvbik7XG5cbiAgICAgICAgcmV0dXJuIGNlbGxzO1xuICAgIH1cblxuICAgIC8vICMgUG9pc3NvbiBEaXN0cmlidXRpb25cbiAgICAvL1xuICAgIC8vIFRoZSBbUG9pc3NvbiBEaXN0cmlidXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUG9pc3Nvbl9kaXN0cmlidXRpb24pXG4gICAgLy8gaXMgYSBkaXNjcmV0ZSBwcm9iYWJpbGl0eSBkaXN0cmlidXRpb24gdGhhdCBleHByZXNzZXMgdGhlIHByb2JhYmlsaXR5XG4gICAgLy8gb2YgYSBnaXZlbiBudW1iZXIgb2YgZXZlbnRzIG9jY3VycmluZyBpbiBhIGZpeGVkIGludGVydmFsIG9mIHRpbWVcbiAgICAvLyBhbmQvb3Igc3BhY2UgaWYgdGhlc2UgZXZlbnRzIG9jY3VyIHdpdGggYSBrbm93biBhdmVyYWdlIHJhdGUgYW5kXG4gICAgLy8gaW5kZXBlbmRlbnRseSBvZiB0aGUgdGltZSBzaW5jZSB0aGUgbGFzdCBldmVudC5cbiAgICAvL1xuICAgIC8vIFRoZSBQb2lzc29uIERpc3RyaWJ1dGlvbiBpcyBjaGFyYWN0ZXJpemVkIGJ5IHRoZSBzdHJpY3RseSBwb3NpdGl2ZVxuICAgIC8vIG1lYW4gYXJyaXZhbCBvciBvY2N1cnJlbmNlIHJhdGUsIGDOu2AuXG4gICAgZnVuY3Rpb24gcG9pc3Nvbl9kaXN0cmlidXRpb24obGFtYmRhKSB7XG4gICAgICAgIC8vIENoZWNrIHRoYXQgbGFtYmRhIGlzIHN0cmljdGx5IHBvc2l0aXZlXG4gICAgICAgIGlmIChsYW1iZGEgPD0gMCkgeyByZXR1cm4gbnVsbDsgfVxuXG4gICAgICAgIC8vIG91ciBjdXJyZW50IHBsYWNlIGluIHRoZSBkaXN0cmlidXRpb25cbiAgICAgICAgdmFyIHggPSAwLFxuICAgICAgICAgICAgLy8gYW5kIHdlIGtlZXAgdHJhY2sgb2YgdGhlIGN1cnJlbnQgY3VtdWxhdGl2ZSBwcm9iYWJpbGl0eSwgaW5cbiAgICAgICAgICAgIC8vIG9yZGVyIHRvIGtub3cgd2hlbiB0byBzdG9wIGNhbGN1bGF0aW5nIGNoYW5jZXMuXG4gICAgICAgICAgICBjdW11bGF0aXZlX3Byb2JhYmlsaXR5ID0gMCxcbiAgICAgICAgICAgIC8vIHRoZSBjYWxjdWxhdGVkIGNlbGxzIHRvIGJlIHJldHVybmVkXG4gICAgICAgICAgICBjZWxscyA9IHt9O1xuXG4gICAgICAgIC8vIGEgW3Byb2JhYmlsaXR5IG1hc3MgZnVuY3Rpb25dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1Byb2JhYmlsaXR5X21hc3NfZnVuY3Rpb24pXG4gICAgICAgIGZ1bmN0aW9uIHByb2JhYmlsaXR5X21hc3MoeCwgbGFtYmRhKSB7XG4gICAgICAgICAgICByZXR1cm4gKE1hdGgucG93KE1hdGguRSwgLWxhbWJkYSkgKiBNYXRoLnBvdyhsYW1iZGEsIHgpKSAvXG4gICAgICAgICAgICAgICAgZmFjdG9yaWFsKHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGhpcyBhbGdvcml0aG0gaXRlcmF0ZXMgdGhyb3VnaCBlYWNoIHBvdGVudGlhbCBvdXRjb21lLFxuICAgICAgICAvLyB1bnRpbCB0aGUgYGN1bXVsYXRpdmVfcHJvYmFiaWxpdHlgIGlzIHZlcnkgY2xvc2UgdG8gMSwgYXRcbiAgICAgICAgLy8gd2hpY2ggcG9pbnQgd2UndmUgZGVmaW5lZCB0aGUgdmFzdCBtYWpvcml0eSBvZiBvdXRjb21lc1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBjZWxsc1t4XSA9IHByb2JhYmlsaXR5X21hc3MoeCwgbGFtYmRhKTtcbiAgICAgICAgICAgIGN1bXVsYXRpdmVfcHJvYmFiaWxpdHkgKz0gY2VsbHNbeF07XG4gICAgICAgICAgICB4Kys7XG4gICAgICAgIC8vIHdoZW4gdGhlIGN1bXVsYXRpdmVfcHJvYmFiaWxpdHkgaXMgbmVhcmx5IDEsIHdlJ3ZlIGNhbGN1bGF0ZWRcbiAgICAgICAgLy8gdGhlIHVzZWZ1bCByYW5nZSBvZiB0aGlzIGRpc3RyaWJ1dGlvblxuICAgICAgICB9IHdoaWxlIChjdW11bGF0aXZlX3Byb2JhYmlsaXR5IDwgMSAtIGVwc2lsb24pO1xuXG4gICAgICAgIHJldHVybiBjZWxscztcbiAgICB9XG5cbiAgICAvLyAjIFBlcmNlbnRhZ2UgUG9pbnRzIG9mIHRoZSDPhzIgKENoaS1TcXVhcmVkKSBEaXN0cmlidXRpb25cbiAgICAvLyBUaGUgW8+HMiAoQ2hpLVNxdWFyZWQpIERpc3RyaWJ1dGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9DaGktc3F1YXJlZF9kaXN0cmlidXRpb24pIGlzIHVzZWQgaW4gdGhlIGNvbW1vblxuICAgIC8vIGNoaS1zcXVhcmVkIHRlc3RzIGZvciBnb29kbmVzcyBvZiBmaXQgb2YgYW4gb2JzZXJ2ZWQgZGlzdHJpYnV0aW9uIHRvIGEgdGhlb3JldGljYWwgb25lLCB0aGUgaW5kZXBlbmRlbmNlIG9mIHR3b1xuICAgIC8vIGNyaXRlcmlhIG9mIGNsYXNzaWZpY2F0aW9uIG9mIHF1YWxpdGF0aXZlIGRhdGEsIGFuZCBpbiBjb25maWRlbmNlIGludGVydmFsIGVzdGltYXRpb24gZm9yIGEgcG9wdWxhdGlvbiBzdGFuZGFyZFxuICAgIC8vIGRldmlhdGlvbiBvZiBhIG5vcm1hbCBkaXN0cmlidXRpb24gZnJvbSBhIHNhbXBsZSBzdGFuZGFyZCBkZXZpYXRpb24uXG4gICAgLy9cbiAgICAvLyBWYWx1ZXMgZnJvbSBBcHBlbmRpeCAxLCBUYWJsZSBJSUkgb2YgV2lsbGlhbSBXLiBIaW5lcyAmIERvdWdsYXMgQy4gTW9udGdvbWVyeSwgXCJQcm9iYWJpbGl0eSBhbmQgU3RhdGlzdGljcyBpblxuICAgIC8vIEVuZ2luZWVyaW5nIGFuZCBNYW5hZ2VtZW50IFNjaWVuY2VcIiwgV2lsZXkgKDE5ODApLlxuICAgIHZhciBjaGlfc3F1YXJlZF9kaXN0cmlidXRpb25fdGFibGUgPSB7XG4gICAgICAgIDE6IHsgMC45OTU6ICAwLjAwLCAwLjk5OiAgMC4wMCwgMC45NzU6ICAwLjAwLCAwLjk1OiAgMC4wMCwgMC45OiAgMC4wMiwgMC41OiAgMC40NSwgMC4xOiAgMi43MSwgMC4wNTogIDMuODQsIDAuMDI1OiAgNS4wMiwgMC4wMTogIDYuNjMsIDAuMDA1OiAgNy44OCB9LFxuICAgICAgICAyOiB7IDAuOTk1OiAgMC4wMSwgMC45OTogIDAuMDIsIDAuOTc1OiAgMC4wNSwgMC45NTogIDAuMTAsIDAuOTogIDAuMjEsIDAuNTogIDEuMzksIDAuMTogIDQuNjEsIDAuMDU6ICA1Ljk5LCAwLjAyNTogIDcuMzgsIDAuMDE6ICA5LjIxLCAwLjAwNTogMTAuNjAgfSxcbiAgICAgICAgMzogeyAwLjk5NTogIDAuMDcsIDAuOTk6ICAwLjExLCAwLjk3NTogIDAuMjIsIDAuOTU6ICAwLjM1LCAwLjk6ICAwLjU4LCAwLjU6ICAyLjM3LCAwLjE6ICA2LjI1LCAwLjA1OiAgNy44MSwgMC4wMjU6ICA5LjM1LCAwLjAxOiAxMS4zNCwgMC4wMDU6IDEyLjg0IH0sXG4gICAgICAgIDQ6IHsgMC45OTU6ICAwLjIxLCAwLjk5OiAgMC4zMCwgMC45NzU6ICAwLjQ4LCAwLjk1OiAgMC43MSwgMC45OiAgMS4wNiwgMC41OiAgMy4zNiwgMC4xOiAgNy43OCwgMC4wNTogIDkuNDksIDAuMDI1OiAxMS4xNCwgMC4wMTogMTMuMjgsIDAuMDA1OiAxNC44NiB9LFxuICAgICAgICA1OiB7IDAuOTk1OiAgMC40MSwgMC45OTogIDAuNTUsIDAuOTc1OiAgMC44MywgMC45NTogIDEuMTUsIDAuOTogIDEuNjEsIDAuNTogIDQuMzUsIDAuMTogIDkuMjQsIDAuMDU6IDExLjA3LCAwLjAyNTogMTIuODMsIDAuMDE6IDE1LjA5LCAwLjAwNTogMTYuNzUgfSxcbiAgICAgICAgNjogeyAwLjk5NTogIDAuNjgsIDAuOTk6ICAwLjg3LCAwLjk3NTogIDEuMjQsIDAuOTU6ICAxLjY0LCAwLjk6ICAyLjIwLCAwLjU6ICA1LjM1LCAwLjE6IDEwLjY1LCAwLjA1OiAxMi41OSwgMC4wMjU6IDE0LjQ1LCAwLjAxOiAxNi44MSwgMC4wMDU6IDE4LjU1IH0sXG4gICAgICAgIDc6IHsgMC45OTU6ICAwLjk5LCAwLjk5OiAgMS4yNSwgMC45NzU6ICAxLjY5LCAwLjk1OiAgMi4xNywgMC45OiAgMi44MywgMC41OiAgNi4zNSwgMC4xOiAxMi4wMiwgMC4wNTogMTQuMDcsIDAuMDI1OiAxNi4wMSwgMC4wMTogMTguNDgsIDAuMDA1OiAyMC4yOCB9LFxuICAgICAgICA4OiB7IDAuOTk1OiAgMS4zNCwgMC45OTogIDEuNjUsIDAuOTc1OiAgMi4xOCwgMC45NTogIDIuNzMsIDAuOTogIDMuNDksIDAuNTogIDcuMzQsIDAuMTogMTMuMzYsIDAuMDU6IDE1LjUxLCAwLjAyNTogMTcuNTMsIDAuMDE6IDIwLjA5LCAwLjAwNTogMjEuOTYgfSxcbiAgICAgICAgOTogeyAwLjk5NTogIDEuNzMsIDAuOTk6ICAyLjA5LCAwLjk3NTogIDIuNzAsIDAuOTU6ICAzLjMzLCAwLjk6ICA0LjE3LCAwLjU6ICA4LjM0LCAwLjE6IDE0LjY4LCAwLjA1OiAxNi45MiwgMC4wMjU6IDE5LjAyLCAwLjAxOiAyMS42NywgMC4wMDU6IDIzLjU5IH0sXG4gICAgICAgIDEwOiB7IDAuOTk1OiAgMi4xNiwgMC45OTogIDIuNTYsIDAuOTc1OiAgMy4yNSwgMC45NTogIDMuOTQsIDAuOTogIDQuODcsIDAuNTogIDkuMzQsIDAuMTogMTUuOTksIDAuMDU6IDE4LjMxLCAwLjAyNTogMjAuNDgsIDAuMDE6IDIzLjIxLCAwLjAwNTogMjUuMTkgfSxcbiAgICAgICAgMTE6IHsgMC45OTU6ICAyLjYwLCAwLjk5OiAgMy4wNSwgMC45NzU6ICAzLjgyLCAwLjk1OiAgNC41NywgMC45OiAgNS41OCwgMC41OiAxMC4zNCwgMC4xOiAxNy4yOCwgMC4wNTogMTkuNjgsIDAuMDI1OiAyMS45MiwgMC4wMTogMjQuNzIsIDAuMDA1OiAyNi43NiB9LFxuICAgICAgICAxMjogeyAwLjk5NTogIDMuMDcsIDAuOTk6ICAzLjU3LCAwLjk3NTogIDQuNDAsIDAuOTU6ICA1LjIzLCAwLjk6ICA2LjMwLCAwLjU6IDExLjM0LCAwLjE6IDE4LjU1LCAwLjA1OiAyMS4wMywgMC4wMjU6IDIzLjM0LCAwLjAxOiAyNi4yMiwgMC4wMDU6IDI4LjMwIH0sXG4gICAgICAgIDEzOiB7IDAuOTk1OiAgMy41NywgMC45OTogIDQuMTEsIDAuOTc1OiAgNS4wMSwgMC45NTogIDUuODksIDAuOTogIDcuMDQsIDAuNTogMTIuMzQsIDAuMTogMTkuODEsIDAuMDU6IDIyLjM2LCAwLjAyNTogMjQuNzQsIDAuMDE6IDI3LjY5LCAwLjAwNTogMjkuODIgfSxcbiAgICAgICAgMTQ6IHsgMC45OTU6ICA0LjA3LCAwLjk5OiAgNC42NiwgMC45NzU6ICA1LjYzLCAwLjk1OiAgNi41NywgMC45OiAgNy43OSwgMC41OiAxMy4zNCwgMC4xOiAyMS4wNiwgMC4wNTogMjMuNjgsIDAuMDI1OiAyNi4xMiwgMC4wMTogMjkuMTQsIDAuMDA1OiAzMS4zMiB9LFxuICAgICAgICAxNTogeyAwLjk5NTogIDQuNjAsIDAuOTk6ICA1LjIzLCAwLjk3NTogIDYuMjcsIDAuOTU6ICA3LjI2LCAwLjk6ICA4LjU1LCAwLjU6IDE0LjM0LCAwLjE6IDIyLjMxLCAwLjA1OiAyNS4wMCwgMC4wMjU6IDI3LjQ5LCAwLjAxOiAzMC41OCwgMC4wMDU6IDMyLjgwIH0sXG4gICAgICAgIDE2OiB7IDAuOTk1OiAgNS4xNCwgMC45OTogIDUuODEsIDAuOTc1OiAgNi45MSwgMC45NTogIDcuOTYsIDAuOTogIDkuMzEsIDAuNTogMTUuMzQsIDAuMTogMjMuNTQsIDAuMDU6IDI2LjMwLCAwLjAyNTogMjguODUsIDAuMDE6IDMyLjAwLCAwLjAwNTogMzQuMjcgfSxcbiAgICAgICAgMTc6IHsgMC45OTU6ICA1LjcwLCAwLjk5OiAgNi40MSwgMC45NzU6ICA3LjU2LCAwLjk1OiAgOC42NywgMC45OiAxMC4wOSwgMC41OiAxNi4zNCwgMC4xOiAyNC43NywgMC4wNTogMjcuNTksIDAuMDI1OiAzMC4xOSwgMC4wMTogMzMuNDEsIDAuMDA1OiAzNS43MiB9LFxuICAgICAgICAxODogeyAwLjk5NTogIDYuMjYsIDAuOTk6ICA3LjAxLCAwLjk3NTogIDguMjMsIDAuOTU6ICA5LjM5LCAwLjk6IDEwLjg3LCAwLjU6IDE3LjM0LCAwLjE6IDI1Ljk5LCAwLjA1OiAyOC44NywgMC4wMjU6IDMxLjUzLCAwLjAxOiAzNC44MSwgMC4wMDU6IDM3LjE2IH0sXG4gICAgICAgIDE5OiB7IDAuOTk1OiAgNi44NCwgMC45OTogIDcuNjMsIDAuOTc1OiAgOC45MSwgMC45NTogMTAuMTIsIDAuOTogMTEuNjUsIDAuNTogMTguMzQsIDAuMTogMjcuMjAsIDAuMDU6IDMwLjE0LCAwLjAyNTogMzIuODUsIDAuMDE6IDM2LjE5LCAwLjAwNTogMzguNTggfSxcbiAgICAgICAgMjA6IHsgMC45OTU6ICA3LjQzLCAwLjk5OiAgOC4yNiwgMC45NzU6ICA5LjU5LCAwLjk1OiAxMC44NSwgMC45OiAxMi40NCwgMC41OiAxOS4zNCwgMC4xOiAyOC40MSwgMC4wNTogMzEuNDEsIDAuMDI1OiAzNC4xNywgMC4wMTogMzcuNTcsIDAuMDA1OiA0MC4wMCB9LFxuICAgICAgICAyMTogeyAwLjk5NTogIDguMDMsIDAuOTk6ICA4LjkwLCAwLjk3NTogMTAuMjgsIDAuOTU6IDExLjU5LCAwLjk6IDEzLjI0LCAwLjU6IDIwLjM0LCAwLjE6IDI5LjYyLCAwLjA1OiAzMi42NywgMC4wMjU6IDM1LjQ4LCAwLjAxOiAzOC45MywgMC4wMDU6IDQxLjQwIH0sXG4gICAgICAgIDIyOiB7IDAuOTk1OiAgOC42NCwgMC45OTogIDkuNTQsIDAuOTc1OiAxMC45OCwgMC45NTogMTIuMzQsIDAuOTogMTQuMDQsIDAuNTogMjEuMzQsIDAuMTogMzAuODEsIDAuMDU6IDMzLjkyLCAwLjAyNTogMzYuNzgsIDAuMDE6IDQwLjI5LCAwLjAwNTogNDIuODAgfSxcbiAgICAgICAgMjM6IHsgMC45OTU6ICA5LjI2LCAwLjk5OiAxMC4yMCwgMC45NzU6IDExLjY5LCAwLjk1OiAxMy4wOSwgMC45OiAxNC44NSwgMC41OiAyMi4zNCwgMC4xOiAzMi4wMSwgMC4wNTogMzUuMTcsIDAuMDI1OiAzOC4wOCwgMC4wMTogNDEuNjQsIDAuMDA1OiA0NC4xOCB9LFxuICAgICAgICAyNDogeyAwLjk5NTogIDkuODksIDAuOTk6IDEwLjg2LCAwLjk3NTogMTIuNDAsIDAuOTU6IDEzLjg1LCAwLjk6IDE1LjY2LCAwLjU6IDIzLjM0LCAwLjE6IDMzLjIwLCAwLjA1OiAzNi40MiwgMC4wMjU6IDM5LjM2LCAwLjAxOiA0Mi45OCwgMC4wMDU6IDQ1LjU2IH0sXG4gICAgICAgIDI1OiB7IDAuOTk1OiAxMC41MiwgMC45OTogMTEuNTIsIDAuOTc1OiAxMy4xMiwgMC45NTogMTQuNjEsIDAuOTogMTYuNDcsIDAuNTogMjQuMzQsIDAuMTogMzQuMjgsIDAuMDU6IDM3LjY1LCAwLjAyNTogNDAuNjUsIDAuMDE6IDQ0LjMxLCAwLjAwNTogNDYuOTMgfSxcbiAgICAgICAgMjY6IHsgMC45OTU6IDExLjE2LCAwLjk5OiAxMi4yMCwgMC45NzU6IDEzLjg0LCAwLjk1OiAxNS4zOCwgMC45OiAxNy4yOSwgMC41OiAyNS4zNCwgMC4xOiAzNS41NiwgMC4wNTogMzguODksIDAuMDI1OiA0MS45MiwgMC4wMTogNDUuNjQsIDAuMDA1OiA0OC4yOSB9LFxuICAgICAgICAyNzogeyAwLjk5NTogMTEuODEsIDAuOTk6IDEyLjg4LCAwLjk3NTogMTQuNTcsIDAuOTU6IDE2LjE1LCAwLjk6IDE4LjExLCAwLjU6IDI2LjM0LCAwLjE6IDM2Ljc0LCAwLjA1OiA0MC4xMSwgMC4wMjU6IDQzLjE5LCAwLjAxOiA0Ni45NiwgMC4wMDU6IDQ5LjY1IH0sXG4gICAgICAgIDI4OiB7IDAuOTk1OiAxMi40NiwgMC45OTogMTMuNTcsIDAuOTc1OiAxNS4zMSwgMC45NTogMTYuOTMsIDAuOTogMTguOTQsIDAuNTogMjcuMzQsIDAuMTogMzcuOTIsIDAuMDU6IDQxLjM0LCAwLjAyNTogNDQuNDYsIDAuMDE6IDQ4LjI4LCAwLjAwNTogNTAuOTkgfSxcbiAgICAgICAgMjk6IHsgMC45OTU6IDEzLjEyLCAwLjk5OiAxNC4yNiwgMC45NzU6IDE2LjA1LCAwLjk1OiAxNy43MSwgMC45OiAxOS43NywgMC41OiAyOC4zNCwgMC4xOiAzOS4wOSwgMC4wNTogNDIuNTYsIDAuMDI1OiA0NS43MiwgMC4wMTogNDkuNTksIDAuMDA1OiA1Mi4zNCB9LFxuICAgICAgICAzMDogeyAwLjk5NTogMTMuNzksIDAuOTk6IDE0Ljk1LCAwLjk3NTogMTYuNzksIDAuOTU6IDE4LjQ5LCAwLjk6IDIwLjYwLCAwLjU6IDI5LjM0LCAwLjE6IDQwLjI2LCAwLjA1OiA0My43NywgMC4wMjU6IDQ2Ljk4LCAwLjAxOiA1MC44OSwgMC4wMDU6IDUzLjY3IH0sXG4gICAgICAgIDQwOiB7IDAuOTk1OiAyMC43MSwgMC45OTogMjIuMTYsIDAuOTc1OiAyNC40MywgMC45NTogMjYuNTEsIDAuOTogMjkuMDUsIDAuNTogMzkuMzQsIDAuMTogNTEuODEsIDAuMDU6IDU1Ljc2LCAwLjAyNTogNTkuMzQsIDAuMDE6IDYzLjY5LCAwLjAwNTogNjYuNzcgfSxcbiAgICAgICAgNTA6IHsgMC45OTU6IDI3Ljk5LCAwLjk5OiAyOS43MSwgMC45NzU6IDMyLjM2LCAwLjk1OiAzNC43NiwgMC45OiAzNy42OSwgMC41OiA0OS4zMywgMC4xOiA2My4xNywgMC4wNTogNjcuNTAsIDAuMDI1OiA3MS40MiwgMC4wMTogNzYuMTUsIDAuMDA1OiA3OS40OSB9LFxuICAgICAgICA2MDogeyAwLjk5NTogMzUuNTMsIDAuOTk6IDM3LjQ4LCAwLjk3NTogNDAuNDgsIDAuOTU6IDQzLjE5LCAwLjk6IDQ2LjQ2LCAwLjU6IDU5LjMzLCAwLjE6IDc0LjQwLCAwLjA1OiA3OS4wOCwgMC4wMjU6IDgzLjMwLCAwLjAxOiA4OC4zOCwgMC4wMDU6IDkxLjk1IH0sXG4gICAgICAgIDcwOiB7IDAuOTk1OiA0My4yOCwgMC45OTogNDUuNDQsIDAuOTc1OiA0OC43NiwgMC45NTogNTEuNzQsIDAuOTogNTUuMzMsIDAuNTogNjkuMzMsIDAuMTogODUuNTMsIDAuMDU6IDkwLjUzLCAwLjAyNTogOTUuMDIsIDAuMDE6IDEwMC40MiwgMC4wMDU6IDEwNC4yMiB9LFxuICAgICAgICA4MDogeyAwLjk5NTogNTEuMTcsIDAuOTk6IDUzLjU0LCAwLjk3NTogNTcuMTUsIDAuOTU6IDYwLjM5LCAwLjk6IDY0LjI4LCAwLjU6IDc5LjMzLCAwLjE6IDk2LjU4LCAwLjA1OiAxMDEuODgsIDAuMDI1OiAxMDYuNjMsIDAuMDE6IDExMi4zMywgMC4wMDU6IDExNi4zMiB9LFxuICAgICAgICA5MDogeyAwLjk5NTogNTkuMjAsIDAuOTk6IDYxLjc1LCAwLjk3NTogNjUuNjUsIDAuOTU6IDY5LjEzLCAwLjk6IDczLjI5LCAwLjU6IDg5LjMzLCAwLjE6IDEwNy41NywgMC4wNTogMTEzLjE0LCAwLjAyNTogMTE4LjE0LCAwLjAxOiAxMjQuMTIsIDAuMDA1OiAxMjguMzAgfSxcbiAgICAgICAgMTAwOiB7IDAuOTk1OiA2Ny4zMywgMC45OTogNzAuMDYsIDAuOTc1OiA3NC4yMiwgMC45NTogNzcuOTMsIDAuOTogODIuMzYsIDAuNTogOTkuMzMsIDAuMTogMTE4LjUwLCAwLjA1OiAxMjQuMzQsIDAuMDI1OiAxMjkuNTYsIDAuMDE6IDEzNS44MSwgMC4wMDU6IDE0MC4xNyB9XG4gICAgfTtcblxuICAgIC8vICMgz4cyIChDaGktU3F1YXJlZCkgR29vZG5lc3Mtb2YtRml0IFRlc3RcbiAgICAvL1xuICAgIC8vIFRoZSBbz4cyIChDaGktU3F1YXJlZCkgR29vZG5lc3Mtb2YtRml0IFRlc3RdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvR29vZG5lc3Nfb2ZfZml0I1BlYXJzb24uMjdzX2NoaS1zcXVhcmVkX3Rlc3QpXG4gICAgLy8gdXNlcyBhIG1lYXN1cmUgb2YgZ29vZG5lc3Mgb2YgZml0IHdoaWNoIGlzIHRoZSBzdW0gb2YgZGlmZmVyZW5jZXMgYmV0d2VlbiBvYnNlcnZlZCBhbmQgZXhwZWN0ZWQgb3V0Y29tZSBmcmVxdWVuY2llc1xuICAgIC8vICh0aGF0IGlzLCBjb3VudHMgb2Ygb2JzZXJ2YXRpb25zKSwgZWFjaCBzcXVhcmVkIGFuZCBkaXZpZGVkIGJ5IHRoZSBudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIGV4cGVjdGVkIGdpdmVuIHRoZVxuICAgIC8vIGh5cG90aGVzaXplZCBkaXN0cmlidXRpb24uIFRoZSByZXN1bHRpbmcgz4cyIHN0YXRpc3RpYywgYGNoaV9zcXVhcmVkYCwgY2FuIGJlIGNvbXBhcmVkIHRvIHRoZSBjaGktc3F1YXJlZCBkaXN0cmlidXRpb25cbiAgICAvLyB0byBkZXRlcm1pbmUgdGhlIGdvb2RuZXNzIG9mIGZpdC4gSW4gb3JkZXIgdG8gZGV0ZXJtaW5lIHRoZSBkZWdyZWVzIG9mIGZyZWVkb20gb2YgdGhlIGNoaS1zcXVhcmVkIGRpc3RyaWJ1dGlvbiwgb25lXG4gICAgLy8gdGFrZXMgdGhlIHRvdGFsIG51bWJlciBvZiBvYnNlcnZlZCBmcmVxdWVuY2llcyBhbmQgc3VidHJhY3RzIHRoZSBudW1iZXIgb2YgZXN0aW1hdGVkIHBhcmFtZXRlcnMuIFRoZSB0ZXN0IHN0YXRpc3RpY1xuICAgIC8vIGZvbGxvd3MsIGFwcHJveGltYXRlbHksIGEgY2hpLXNxdWFyZSBkaXN0cmlidXRpb24gd2l0aCAoayDiiJIgYykgZGVncmVlcyBvZiBmcmVlZG9tIHdoZXJlIGBrYCBpcyB0aGUgbnVtYmVyIG9mIG5vbi1lbXB0eVxuICAgIC8vIGNlbGxzIGFuZCBgY2AgaXMgdGhlIG51bWJlciBvZiBlc3RpbWF0ZWQgcGFyYW1ldGVycyBmb3IgdGhlIGRpc3RyaWJ1dGlvbi5cbiAgICBmdW5jdGlvbiBjaGlfc3F1YXJlZF9nb29kbmVzc19vZl9maXQoZGF0YSwgZGlzdHJpYnV0aW9uX3R5cGUsIHNpZ25pZmljYW5jZSkge1xuICAgICAgICAvLyBFc3RpbWF0ZSBmcm9tIHRoZSBzYW1wbGUgZGF0YSwgYSB3ZWlnaHRlZCBtZWFuLlxuICAgICAgICB2YXIgaW5wdXRfbWVhbiA9IG1lYW4oZGF0YSksXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGVkIHZhbHVlIG9mIHRoZSDPhzIgc3RhdGlzdGljLlxuICAgICAgICAgICAgY2hpX3NxdWFyZWQgPSAwLFxuICAgICAgICAgICAgLy8gRGVncmVlcyBvZiBmcmVlZG9tLCBjYWxjdWxhdGVkIGFzIChudW1iZXIgb2YgY2xhc3MgaW50ZXJ2YWxzIC1cbiAgICAgICAgICAgIC8vIG51bWJlciBvZiBoeXBvdGhlc2l6ZWQgZGlzdHJpYnV0aW9uIHBhcmFtZXRlcnMgZXN0aW1hdGVkIC0gMSlcbiAgICAgICAgICAgIGRlZ3JlZXNfb2ZfZnJlZWRvbSxcbiAgICAgICAgICAgIC8vIE51bWJlciBvZiBoeXBvdGhlc2l6ZWQgZGlzdHJpYnV0aW9uIHBhcmFtZXRlcnMgZXN0aW1hdGVkLCBleHBlY3RlZCB0byBiZSBzdXBwbGllZCBpbiB0aGUgZGlzdHJpYnV0aW9uIHRlc3QuXG4gICAgICAgICAgICAvLyBMb3NlIG9uZSBkZWdyZWUgb2YgZnJlZWRvbSBmb3IgZXN0aW1hdGluZyBgbGFtYmRhYCBmcm9tIHRoZSBzYW1wbGUgZGF0YS5cbiAgICAgICAgICAgIGMgPSAxLFxuICAgICAgICAgICAgLy8gVGhlIGh5cG90aGVzaXplZCBkaXN0cmlidXRpb24uXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSB0aGUgaHlwb3RoZXNpemVkIGRpc3RyaWJ1dGlvbi5cbiAgICAgICAgICAgIGh5cG90aGVzaXplZF9kaXN0cmlidXRpb24gPSBkaXN0cmlidXRpb25fdHlwZShpbnB1dF9tZWFuKSxcbiAgICAgICAgICAgIG9ic2VydmVkX2ZyZXF1ZW5jaWVzID0gW10sXG4gICAgICAgICAgICBleHBlY3RlZF9mcmVxdWVuY2llcyA9IFtdLFxuICAgICAgICAgICAgaztcblxuICAgICAgICAvLyBDcmVhdGUgYW4gYXJyYXkgaG9sZGluZyBhIGhpc3RvZ3JhbSBmcm9tIHRoZSBzYW1wbGUgZGF0YSwgb2ZcbiAgICAgICAgLy8gdGhlIGZvcm0gYHsgdmFsdWU6IG51bWJlck9mT2N1cnJlbmNlcyB9YFxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChvYnNlcnZlZF9mcmVxdWVuY2llc1tkYXRhW2ldXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZWRfZnJlcXVlbmNpZXNbZGF0YVtpXV0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2JzZXJ2ZWRfZnJlcXVlbmNpZXNbZGF0YVtpXV0rKztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRoZSBoaXN0b2dyYW0gd2UgY3JlYXRlZCBtaWdodCBiZSBzcGFyc2UgLSB0aGVyZSBtaWdodCBiZSBnYXBzXG4gICAgICAgIC8vIGJldHdlZW4gdmFsdWVzLiBTbyB3ZSBpdGVyYXRlIHRocm91Z2ggdGhlIGhpc3RvZ3JhbSwgbWFraW5nXG4gICAgICAgIC8vIHN1cmUgdGhhdCBpbnN0ZWFkIG9mIHVuZGVmaW5lZCwgZ2FwcyBoYXZlIDAgdmFsdWVzLlxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgb2JzZXJ2ZWRfZnJlcXVlbmNpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChvYnNlcnZlZF9mcmVxdWVuY2llc1tpXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZWRfZnJlcXVlbmNpZXNbaV0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ3JlYXRlIGFuIGFycmF5IGhvbGRpbmcgYSBoaXN0b2dyYW0gb2YgZXhwZWN0ZWQgZGF0YSBnaXZlbiB0aGVcbiAgICAgICAgLy8gc2FtcGxlIHNpemUgYW5kIGh5cG90aGVzaXplZCBkaXN0cmlidXRpb24uXG4gICAgICAgIGZvciAoayBpbiBoeXBvdGhlc2l6ZWRfZGlzdHJpYnV0aW9uKSB7XG4gICAgICAgICAgICBpZiAoayBpbiBvYnNlcnZlZF9mcmVxdWVuY2llcykge1xuICAgICAgICAgICAgICAgIGV4cGVjdGVkX2ZyZXF1ZW5jaWVzW2tdID0gaHlwb3RoZXNpemVkX2Rpc3RyaWJ1dGlvbltrXSAqIGRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gV29ya2luZyBiYWNrd2FyZCB0aHJvdWdoIHRoZSBleHBlY3RlZCBmcmVxdWVuY2llcywgY29sbGFwc2UgY2xhc3Nlc1xuICAgICAgICAvLyBpZiBsZXNzIHRoYW4gdGhyZWUgb2JzZXJ2YXRpb25zIGFyZSBleHBlY3RlZCBmb3IgYSBjbGFzcy5cbiAgICAgICAgLy8gVGhpcyB0cmFuc2Zvcm1hdGlvbiBpcyBhcHBsaWVkIHRvIHRoZSBvYnNlcnZlZCBmcmVxdWVuY2llcyBhcyB3ZWxsLlxuICAgICAgICBmb3IgKGsgPSBleHBlY3RlZF9mcmVxdWVuY2llcy5sZW5ndGggLSAxOyBrID49IDA7IGstLSkge1xuICAgICAgICAgICAgaWYgKGV4cGVjdGVkX2ZyZXF1ZW5jaWVzW2tdIDwgMykge1xuICAgICAgICAgICAgICAgIGV4cGVjdGVkX2ZyZXF1ZW5jaWVzW2sgLSAxXSArPSBleHBlY3RlZF9mcmVxdWVuY2llc1trXTtcbiAgICAgICAgICAgICAgICBleHBlY3RlZF9mcmVxdWVuY2llcy5wb3AoKTtcblxuICAgICAgICAgICAgICAgIG9ic2VydmVkX2ZyZXF1ZW5jaWVzW2sgLSAxXSArPSBvYnNlcnZlZF9mcmVxdWVuY2llc1trXTtcbiAgICAgICAgICAgICAgICBvYnNlcnZlZF9mcmVxdWVuY2llcy5wb3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgc3F1YXJlZCBkaWZmZXJlbmNlcyBiZXR3ZWVuIG9ic2VydmVkICYgZXhwZWN0ZWRcbiAgICAgICAgLy8gZnJlcXVlbmNpZXMsIGFjY3VtdWxhdGluZyB0aGUgYGNoaV9zcXVhcmVkYCBzdGF0aXN0aWMuXG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBvYnNlcnZlZF9mcmVxdWVuY2llcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgY2hpX3NxdWFyZWQgKz0gTWF0aC5wb3coXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZWRfZnJlcXVlbmNpZXNba10gLSBleHBlY3RlZF9mcmVxdWVuY2llc1trXSwgMikgL1xuICAgICAgICAgICAgICAgIGV4cGVjdGVkX2ZyZXF1ZW5jaWVzW2tdO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2FsY3VsYXRlIGRlZ3JlZXMgb2YgZnJlZWRvbSBmb3IgdGhpcyB0ZXN0IGFuZCBsb29rIGl0IHVwIGluIHRoZVxuICAgICAgICAvLyBgY2hpX3NxdWFyZWRfZGlzdHJpYnV0aW9uX3RhYmxlYCBpbiBvcmRlciB0b1xuICAgICAgICAvLyBhY2NlcHQgb3IgcmVqZWN0IHRoZSBnb29kbmVzcy1vZi1maXQgb2YgdGhlIGh5cG90aGVzaXplZCBkaXN0cmlidXRpb24uXG4gICAgICAgIGRlZ3JlZXNfb2ZfZnJlZWRvbSA9IG9ic2VydmVkX2ZyZXF1ZW5jaWVzLmxlbmd0aCAtIGMgLSAxO1xuICAgICAgICByZXR1cm4gY2hpX3NxdWFyZWRfZGlzdHJpYnV0aW9uX3RhYmxlW2RlZ3JlZXNfb2ZfZnJlZWRvbV1bc2lnbmlmaWNhbmNlXSA8IGNoaV9zcXVhcmVkO1xuICAgIH1cblxuICAgIC8vICMgTWl4aW5cbiAgICAvL1xuICAgIC8vIE1peGluIHNpbXBsZV9zdGF0aXN0aWNzIHRvIGEgc2luZ2xlIEFycmF5IGluc3RhbmNlIGlmIHByb3ZpZGVkXG4gICAgLy8gb3IgdGhlIEFycmF5IG5hdGl2ZSBvYmplY3QgaWYgbm90LiBUaGlzIGlzIGFuIG9wdGlvbmFsXG4gICAgLy8gZmVhdHVyZSB0aGF0IGxldHMgeW91IHRyZWF0IHNpbXBsZV9zdGF0aXN0aWNzIGFzIGEgbmF0aXZlIGZlYXR1cmVcbiAgICAvLyBvZiBKYXZhc2NyaXB0LlxuICAgIGZ1bmN0aW9uIG1peGluKGFycmF5KSB7XG4gICAgICAgIHZhciBzdXBwb3J0ID0gISEoT2JqZWN0LmRlZmluZVByb3BlcnR5ICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKTtcbiAgICAgICAgaWYgKCFzdXBwb3J0KSB0aHJvdyBuZXcgRXJyb3IoJ3dpdGhvdXQgZGVmaW5lUHJvcGVydHksIHNpbXBsZS1zdGF0aXN0aWNzIGNhbm5vdCBiZSBtaXhlZCBpbicpO1xuXG4gICAgICAgIC8vIG9ubHkgbWV0aG9kcyB3aGljaCB3b3JrIG9uIGJhc2ljIGFycmF5cyBpbiBhIHNpbmdsZSBzdGVwXG4gICAgICAgIC8vIGFyZSBzdXBwb3J0ZWRcbiAgICAgICAgdmFyIGFycmF5TWV0aG9kcyA9IFsnbWVkaWFuJywgJ3N0YW5kYXJkX2RldmlhdGlvbicsICdzdW0nLFxuICAgICAgICAgICAgJ3NhbXBsZV9za2V3bmVzcycsXG4gICAgICAgICAgICAnbWVhbicsICdtaW4nLCAnbWF4JywgJ3F1YW50aWxlJywgJ2dlb21ldHJpY19tZWFuJyxcbiAgICAgICAgICAgICdoYXJtb25pY19tZWFuJywgJ3Jvb3RfbWVhbl9zcXVhcmUnXTtcblxuICAgICAgICAvLyBjcmVhdGUgYSBjbG9zdXJlIHdpdGggYSBtZXRob2QgbmFtZSBzbyB0aGF0IGEgcmVmZXJlbmNlXG4gICAgICAgIC8vIGxpa2UgYGFycmF5TWV0aG9kc1tpXWAgZG9lc24ndCBmb2xsb3cgdGhlIGxvb3AgaW5jcmVtZW50XG4gICAgICAgIGZ1bmN0aW9uIHdyYXAobWV0aG9kKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy8gY2FzdCBhbnkgYXJndW1lbnRzIGludG8gYW4gYXJyYXksIHNpbmNlIHRoZXkncmVcbiAgICAgICAgICAgICAgICAvLyBuYXRpdmVseSBvYmplY3RzXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICAvLyBtYWtlIHRoZSBmaXJzdCBhcmd1bWVudCB0aGUgYXJyYXkgaXRzZWxmXG4gICAgICAgICAgICAgICAgYXJncy51bnNoaWZ0KHRoaXMpO1xuICAgICAgICAgICAgICAgIC8vIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZSBzcyBtZXRob2RcbiAgICAgICAgICAgICAgICByZXR1cm4gc3NbbWV0aG9kXS5hcHBseShzcywgYXJncyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2VsZWN0IG9iamVjdCB0byBleHRlbmRcbiAgICAgICAgdmFyIGV4dGVuZGluZztcbiAgICAgICAgaWYgKGFycmF5KSB7XG4gICAgICAgICAgICAvLyBjcmVhdGUgYSBzaGFsbG93IGNvcHkgb2YgdGhlIGFycmF5IHNvIHRoYXQgb3VyIGludGVybmFsXG4gICAgICAgICAgICAvLyBvcGVyYXRpb25zIGRvIG5vdCBjaGFuZ2UgaXQgYnkgcmVmZXJlbmNlXG4gICAgICAgICAgICBleHRlbmRpbmcgPSBhcnJheS5zbGljZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXh0ZW5kaW5nID0gQXJyYXkucHJvdG90eXBlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZm9yIGVhY2ggYXJyYXkgZnVuY3Rpb24sIGRlZmluZSBhIGZ1bmN0aW9uIHRoYXQgZ2V0c1xuICAgICAgICAvLyB0aGUgYXJyYXkgYXMgdGhlIGZpcnN0IGFyZ3VtZW50LlxuICAgICAgICAvLyBXZSB1c2UgW2RlZmluZVByb3BlcnR5XShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9kZWZpbmVQcm9wZXJ0eSlcbiAgICAgICAgLy8gYmVjYXVzZSBpdCBhbGxvd3MgdGhlc2UgcHJvcGVydGllcyB0byBiZSBub24tZW51bWVyYWJsZTpcbiAgICAgICAgLy8gYGZvciAodmFyIGluIHgpYCBsb29wcyB3aWxsIG5vdCBydW4gaW50byBwcm9ibGVtcyB3aXRoIHRoaXNcbiAgICAgICAgLy8gaW1wbGVtZW50YXRpb24uXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXlNZXRob2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXh0ZW5kaW5nLCBhcnJheU1ldGhvZHNbaV0sIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogd3JhcChhcnJheU1ldGhvZHNbaV0pLFxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXh0ZW5kaW5nO1xuICAgIH1cblxuICAgIHNzLmxpbmVhcl9yZWdyZXNzaW9uID0gbGluZWFyX3JlZ3Jlc3Npb247XG4gICAgc3Muc3RhbmRhcmRfZGV2aWF0aW9uID0gc3RhbmRhcmRfZGV2aWF0aW9uO1xuICAgIHNzLnJfc3F1YXJlZCA9IHJfc3F1YXJlZDtcbiAgICBzcy5tZWRpYW4gPSBtZWRpYW47XG4gICAgc3MubWVhbiA9IG1lYW47XG4gICAgc3MubW9kZSA9IG1vZGU7XG4gICAgc3MubWluID0gbWluO1xuICAgIHNzLm1heCA9IG1heDtcbiAgICBzcy5zdW0gPSBzdW07XG4gICAgc3MucXVhbnRpbGUgPSBxdWFudGlsZTtcbiAgICBzcy5xdWFudGlsZV9zb3J0ZWQgPSBxdWFudGlsZV9zb3J0ZWQ7XG4gICAgc3MuaXFyID0gaXFyO1xuICAgIHNzLm1hZCA9IG1hZDtcblxuICAgIHNzLmNodW5rID0gY2h1bms7XG4gICAgc3Muc2h1ZmZsZSA9IHNodWZmbGU7XG4gICAgc3Muc2h1ZmZsZV9pbl9wbGFjZSA9IHNodWZmbGVfaW5fcGxhY2U7XG5cbiAgICBzcy5zYW1wbGUgPSBzYW1wbGU7XG5cbiAgICBzcy5zYW1wbGVfY292YXJpYW5jZSA9IHNhbXBsZV9jb3ZhcmlhbmNlO1xuICAgIHNzLnNhbXBsZV9jb3JyZWxhdGlvbiA9IHNhbXBsZV9jb3JyZWxhdGlvbjtcbiAgICBzcy5zYW1wbGVfdmFyaWFuY2UgPSBzYW1wbGVfdmFyaWFuY2U7XG4gICAgc3Muc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbiA9IHNhbXBsZV9zdGFuZGFyZF9kZXZpYXRpb247XG4gICAgc3Muc2FtcGxlX3NrZXduZXNzID0gc2FtcGxlX3NrZXduZXNzO1xuXG4gICAgc3MuZ2VvbWV0cmljX21lYW4gPSBnZW9tZXRyaWNfbWVhbjtcbiAgICBzcy5oYXJtb25pY19tZWFuID0gaGFybW9uaWNfbWVhbjtcbiAgICBzcy5yb290X21lYW5fc3F1YXJlID0gcm9vdF9tZWFuX3NxdWFyZTtcbiAgICBzcy52YXJpYW5jZSA9IHZhcmlhbmNlO1xuICAgIHNzLnRfdGVzdCA9IHRfdGVzdDtcbiAgICBzcy50X3Rlc3RfdHdvX3NhbXBsZSA9IHRfdGVzdF90d29fc2FtcGxlO1xuXG4gICAgLy8gamVua3NcbiAgICBzcy5qZW5rc01hdHJpY2VzID0gamVua3NNYXRyaWNlcztcbiAgICBzcy5qZW5rc0JyZWFrcyA9IGplbmtzQnJlYWtzO1xuICAgIHNzLmplbmtzID0gamVua3M7XG5cbiAgICBzcy5iYXllc2lhbiA9IGJheWVzaWFuO1xuXG4gICAgLy8gRGlzdHJpYnV0aW9uLXJlbGF0ZWQgbWV0aG9kc1xuICAgIHNzLmVwc2lsb24gPSBlcHNpbG9uOyAvLyBXZSBtYWtlIM61IGF2YWlsYWJsZSB0byB0aGUgdGVzdCBzdWl0ZS5cbiAgICBzcy5mYWN0b3JpYWwgPSBmYWN0b3JpYWw7XG4gICAgc3MuYmVybm91bGxpX2Rpc3RyaWJ1dGlvbiA9IGJlcm5vdWxsaV9kaXN0cmlidXRpb247XG4gICAgc3MuYmlub21pYWxfZGlzdHJpYnV0aW9uID0gYmlub21pYWxfZGlzdHJpYnV0aW9uO1xuICAgIHNzLnBvaXNzb25fZGlzdHJpYnV0aW9uID0gcG9pc3Nvbl9kaXN0cmlidXRpb247XG4gICAgc3MuY2hpX3NxdWFyZWRfZ29vZG5lc3Nfb2ZfZml0ID0gY2hpX3NxdWFyZWRfZ29vZG5lc3Nfb2ZfZml0O1xuXG4gICAgLy8gTm9ybWFsIGRpc3RyaWJ1dGlvblxuICAgIHNzLnpfc2NvcmUgPSB6X3Njb3JlO1xuICAgIHNzLmN1bXVsYXRpdmVfc3RkX25vcm1hbF9wcm9iYWJpbGl0eSA9IGN1bXVsYXRpdmVfc3RkX25vcm1hbF9wcm9iYWJpbGl0eTtcbiAgICBzcy5zdGFuZGFyZF9ub3JtYWxfdGFibGUgPSBzdGFuZGFyZF9ub3JtYWxfdGFibGU7XG4gICAgc3MuZXJyb3JfZnVuY3Rpb24gPSBlcnJvcl9mdW5jdGlvbjtcblxuICAgIC8vIEFsaWFzIHRoaXMgaW50byBpdHMgY29tbW9uIG5hbWVcbiAgICBzcy5hdmVyYWdlID0gbWVhbjtcbiAgICBzcy5pbnRlcnF1YXJ0aWxlX3JhbmdlID0gaXFyO1xuICAgIHNzLm1peGluID0gbWl4aW47XG4gICAgc3MubWVkaWFuX2Fic29sdXRlX2RldmlhdGlvbiA9IG1hZDtcbiAgICBzcy5ybXMgPSByb290X21lYW5fc3F1YXJlO1xuICAgIHNzLmVyZiA9IGVycm9yX2Z1bmN0aW9uO1xuXG59KSh0aGlzKTtcbiIsInZhciBpbnZhcmlhbnQgPSByZXF1aXJlKCd0dXJmLWludmFyaWFudCcpO1xuLy9odHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0hhdmVyc2luZV9mb3JtdWxhXG4vL2h0dHA6Ly93d3cubW92YWJsZS10eXBlLmNvLnVrL3NjcmlwdHMvbGF0bG9uZy5odG1sXG5cbi8qKlxuICogVGFrZXMgdHdvIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYW5kIGNhbGN1bGF0ZXNcbiAqIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHRoZW0gaW4gZGVncmVzcywgcmFkaWFucyxcbiAqIG1pbGVzLCBvciBraWxvbWV0ZXJzLiBUaGlzIHVzZXMgdGhlXG4gKiBbSGF2ZXJzaW5lIGZvcm11bGFdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSGF2ZXJzaW5lX2Zvcm11bGEpXG4gKiB0byBhY2NvdW50IGZvciBnbG9iYWwgY3VydmF0dXJlLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9kaXN0YW5jZVxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0ZlYXR1cmV9IGZyb20gb3JpZ2luIHBvaW50XG4gKiBAcGFyYW0ge0ZlYXR1cmV9IHRvIGRlc3RpbmF0aW9uIHBvaW50XG4gKiBAcGFyYW0ge1N0cmluZ30gW3VuaXRzPWtpbG9tZXRlcnNdIGNhbiBiZSBkZWdyZWVzLCByYWRpYW5zLCBtaWxlcywgb3Iga2lsb21ldGVyc1xuICogQHJldHVybiB7TnVtYmVyfSBkaXN0YW5jZSBiZXR3ZWVuIHRoZSB0d28gcG9pbnRzXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvaW50MSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjM0MywgMzkuOTg0XVxuICogICB9XG4gKiB9O1xuICogdmFyIHBvaW50MiA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjUzNCwgMzkuMTIzXVxuICogICB9XG4gKiB9O1xuICogdmFyIHVuaXRzID0gXCJtaWxlc1wiO1xuICpcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW3BvaW50MSwgcG9pbnQyXVxuICogfTtcbiAqXG4gKiAvLz1wb2ludHNcbiAqXG4gKiB2YXIgZGlzdGFuY2UgPSB0dXJmLmRpc3RhbmNlKHBvaW50MSwgcG9pbnQyLCB1bml0cyk7XG4gKlxuICogLy89ZGlzdGFuY2VcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2ludDEsIHBvaW50MiwgdW5pdHMpe1xuICBpbnZhcmlhbnQuZmVhdHVyZU9mKHBvaW50MSwgJ1BvaW50JywgJ2Rpc3RhbmNlJyk7XG4gIGludmFyaWFudC5mZWF0dXJlT2YocG9pbnQyLCAnUG9pbnQnLCAnZGlzdGFuY2UnKTtcbiAgdmFyIGNvb3JkaW5hdGVzMSA9IHBvaW50MS5nZW9tZXRyeS5jb29yZGluYXRlcztcbiAgdmFyIGNvb3JkaW5hdGVzMiA9IHBvaW50Mi5nZW9tZXRyeS5jb29yZGluYXRlcztcblxuICB2YXIgZExhdCA9IHRvUmFkKGNvb3JkaW5hdGVzMlsxXSAtIGNvb3JkaW5hdGVzMVsxXSk7XG4gIHZhciBkTG9uID0gdG9SYWQoY29vcmRpbmF0ZXMyWzBdIC0gY29vcmRpbmF0ZXMxWzBdKTtcbiAgdmFyIGxhdDEgPSB0b1JhZChjb29yZGluYXRlczFbMV0pO1xuICB2YXIgbGF0MiA9IHRvUmFkKGNvb3JkaW5hdGVzMlsxXSk7XG4gIHZhciBhID0gTWF0aC5zaW4oZExhdC8yKSAqIE1hdGguc2luKGRMYXQvMikgK1xuICAgICAgICAgIE1hdGguc2luKGRMb24vMikgKiBNYXRoLnNpbihkTG9uLzIpICogTWF0aC5jb3MobGF0MSkgKiBNYXRoLmNvcyhsYXQyKTtcbiAgdmFyIGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxLWEpKTtcblxuICB2YXIgUjtcbiAgc3dpdGNoKHVuaXRzKXtcbiAgICBjYXNlICdtaWxlcyc6XG4gICAgICBSID0gMzk2MDtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2tpbG9tZXRlcnMnOlxuICAgICAgUiA9IDYzNzM7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdkZWdyZWVzJzpcbiAgICAgIFIgPSA1Ny4yOTU3Nzk1O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncmFkaWFucyc6XG4gICAgICBSID0gMTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgUiA9IDYzNzM7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bmtub3duIG9wdGlvbiBnaXZlbiB0byBcInVuaXRzXCInKTtcbiAgfVxuXG4gIHZhciBkaXN0YW5jZSA9IFIgKiBjO1xuICByZXR1cm4gZGlzdGFuY2U7XG59O1xuXG5mdW5jdGlvbiB0b1JhZChkZWdyZWUpIHtcbiAgcmV0dXJuIGRlZ3JlZSAqIE1hdGguUEkgLyAxODA7XG59XG4iLCJtb2R1bGUuZXhwb3J0cy5nZW9qc29uVHlwZSA9IGdlb2pzb25UeXBlO1xubW9kdWxlLmV4cG9ydHMuY29sbGVjdGlvbk9mID0gY29sbGVjdGlvbk9mO1xubW9kdWxlLmV4cG9ydHMuZmVhdHVyZU9mID0gZmVhdHVyZU9mO1xuXG4vKipcbiAqIEVuZm9yY2UgZXhwZWN0YXRpb25zIGFib3V0IHR5cGVzIG9mIEdlb0pTT04gb2JqZWN0cyBmb3IgVHVyZi5cbiAqXG4gKiBAYWxpYXMgZ2VvanNvblR5cGVcbiAqIEBwYXJhbSB7R2VvSlNPTn0gdmFsdWUgYW55IEdlb0pTT04gb2JqZWN0XG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBleHBlY3RlZCBHZW9KU09OIHR5cGVcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIG5hbWUgb2YgY2FsbGluZyBmdW5jdGlvblxuICogQHRocm93cyBFcnJvciBpZiB2YWx1ZSBpcyBub3QgdGhlIGV4cGVjdGVkIHR5cGUuXG4gKi9cbmZ1bmN0aW9uIGdlb2pzb25UeXBlKHZhbHVlLCB0eXBlLCBuYW1lKSB7XG4gICAgaWYgKCF0eXBlIHx8ICFuYW1lKSB0aHJvdyBuZXcgRXJyb3IoJ3R5cGUgYW5kIG5hbWUgcmVxdWlyZWQnKTtcblxuICAgIGlmICghdmFsdWUgfHwgdmFsdWUudHlwZSAhPT0gdHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaW5wdXQgdG8gJyArIG5hbWUgKyAnOiBtdXN0IGJlIGEgJyArIHR5cGUgKyAnLCBnaXZlbiAnICsgdmFsdWUudHlwZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEVuZm9yY2UgZXhwZWN0YXRpb25zIGFib3V0IHR5cGVzIG9mIHtAbGluayBGZWF0dXJlfSBpbnB1dHMgZm9yIFR1cmYuXG4gKiBJbnRlcm5hbGx5IHRoaXMgdXNlcyB7QGxpbmsgZ2VvanNvblR5cGV9IHRvIGp1ZGdlIGdlb21ldHJ5IHR5cGVzLlxuICpcbiAqIEBhbGlhcyBmZWF0dXJlT2ZcbiAqIEBwYXJhbSB7RmVhdHVyZX0gZmVhdHVyZSBhIGZlYXR1cmUgd2l0aCBhbiBleHBlY3RlZCBnZW9tZXRyeSB0eXBlXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBleHBlY3RlZCBHZW9KU09OIHR5cGVcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIG5hbWUgb2YgY2FsbGluZyBmdW5jdGlvblxuICogQHRocm93cyBFcnJvciBpZiB2YWx1ZSBpcyBub3QgdGhlIGV4cGVjdGVkIHR5cGUuXG4gKi9cbmZ1bmN0aW9uIGZlYXR1cmVPZih2YWx1ZSwgdHlwZSwgbmFtZSkge1xuICAgIGlmICghbmFtZSkgdGhyb3cgbmV3IEVycm9yKCcuZmVhdHVyZU9mKCkgcmVxdWlyZXMgYSBuYW1lJyk7XG4gICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS50eXBlICE9PSAnRmVhdHVyZScgfHwgIXZhbHVlLmdlb21ldHJ5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpbnB1dCB0byAnICsgbmFtZSArICcsIEZlYXR1cmUgd2l0aCBnZW9tZXRyeSByZXF1aXJlZCcpO1xuICAgIH1cbiAgICBpZiAoIXZhbHVlLmdlb21ldHJ5IHx8IHZhbHVlLmdlb21ldHJ5LnR5cGUgIT09IHR5cGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGlucHV0IHRvICcgKyBuYW1lICsgJzogbXVzdCBiZSBhICcgKyB0eXBlICsgJywgZ2l2ZW4gJyArIHZhbHVlLmdlb21ldHJ5LnR5cGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBFbmZvcmNlIGV4cGVjdGF0aW9ucyBhYm91dCB0eXBlcyBvZiB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IGlucHV0cyBmb3IgVHVyZi5cbiAqIEludGVybmFsbHkgdGhpcyB1c2VzIHtAbGluayBnZW9qc29uVHlwZX0gdG8ganVkZ2UgZ2VvbWV0cnkgdHlwZXMuXG4gKlxuICogQGFsaWFzIGNvbGxlY3Rpb25PZlxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gZmVhdHVyZWNvbGxlY3Rpb24gYSBmZWF0dXJlY29sbGVjdGlvbiBmb3Igd2hpY2ggZmVhdHVyZXMgd2lsbCBiZSBqdWRnZWRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIGV4cGVjdGVkIEdlb0pTT04gdHlwZVxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgbmFtZSBvZiBjYWxsaW5nIGZ1bmN0aW9uXG4gKiBAdGhyb3dzIEVycm9yIGlmIHZhbHVlIGlzIG5vdCB0aGUgZXhwZWN0ZWQgdHlwZS5cbiAqL1xuZnVuY3Rpb24gY29sbGVjdGlvbk9mKHZhbHVlLCB0eXBlLCBuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSB0aHJvdyBuZXcgRXJyb3IoJy5jb2xsZWN0aW9uT2YoKSByZXF1aXJlcyBhIG5hbWUnKTtcbiAgICBpZiAoIXZhbHVlIHx8IHZhbHVlLnR5cGUgIT09ICdGZWF0dXJlQ29sbGVjdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGlucHV0IHRvICcgKyBuYW1lICsgJywgRmVhdHVyZUNvbGxlY3Rpb24gcmVxdWlyZWQnKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZS5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgZmVhdHVyZSA9IHZhbHVlLmZlYXR1cmVzW2ldO1xuICAgICAgICBpZiAoIWZlYXR1cmUgfHwgZmVhdHVyZS50eXBlICE9PSAnRmVhdHVyZScgfHwgIWZlYXR1cmUuZ2VvbWV0cnkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpbnB1dCB0byAnICsgbmFtZSArICcsIEZlYXR1cmUgd2l0aCBnZW9tZXRyeSByZXF1aXJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZmVhdHVyZS5nZW9tZXRyeSB8fCBmZWF0dXJlLmdlb21ldHJ5LnR5cGUgIT09IHR5cGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpbnB1dCB0byAnICsgbmFtZSArICc6IG11c3QgYmUgYSAnICsgdHlwZSArICcsIGdpdmVuICcgKyBmZWF0dXJlLmdlb21ldHJ5LnR5cGUpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwidmFyIGV4dGVudCA9IHJlcXVpcmUoJ3R1cmYtZXh0ZW50Jyk7XG52YXIgYmJveFBvbHlnb24gPSByZXF1aXJlKCd0dXJmLWJib3gtcG9seWdvbicpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIEZlYXR1cmV9IG9yIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gYW5kIHJldHVybnMgYSByZWN0YW5ndWxhciB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZSB0aGF0IGVuY29tcGFzc2VzIGFsbCB2ZXJ0aWNlcy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZW52ZWxvcGVcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gZmMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBhbnkgdHlwZVxuICogQHJldHVybiB7UG9seWdvbn0gYSByZWN0YW5ndWxhciBQb2x5Z29uIGZlYXR1cmUgdGhhdCBlbmNvbXBhc3NlcyBhbGwgdmVydGljZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgZmMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwibmFtZVwiOiBcIkxvY2F0aW9uIEFcIlxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzUuMzQzLCAzOS45ODRdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJuYW1lXCI6IFwiTG9jYXRpb24gQlwiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy03NS44MzMsIDM5LjI4NF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcIm5hbWVcIjogXCJMb2NhdGlvbiBDXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjUzNCwgMzkuMTIzXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgZW52ZWxvcGVkID0gdHVyZi5lbnZlbG9wZShmYyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gZmMuZmVhdHVyZXMuY29uY2F0KGVudmVsb3BlZCk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmVhdHVyZXMsIGRvbmUpe1xuICB2YXIgYmJveCA9IGV4dGVudChmZWF0dXJlcyk7XG4gIHZhciBwb2x5ID0gYmJveFBvbHlnb24oYmJveCk7XG4gIHJldHVybiBwb2x5O1xufVxuIiwiLy8gZGVwZW5kIG9uIGpzdHMgZm9yIG5vdyBodHRwczovL2dpdGh1Yi5jb20vYmpvcm5oYXJydGVsbC9qc3RzL2Jsb2IvbWFzdGVyL2V4YW1wbGVzL292ZXJsYXkuaHRtbFxudmFyIGpzdHMgPSByZXF1aXJlKCdqc3RzJyk7XG5cbi8qKlxuICogRmluZHMgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0d28gcG9seWdvbnMgYnkgY2xpcHBpbmcgdGhlIHNlY29uZFxuICogcG9seWdvbiBmcm9tIHRoZSBmaXJzdC5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZXJhc2VcbiAqIEBjYXRlZ29yeSB0cmFuc2Zvcm1hdGlvblxuICogQHBhcmFtIHtQb2x5Z29ufSBwb2x5MSBpbnB1dCBQb2x5Z29uIGZlYXVyZVxuICogQHBhcmFtIHtQb2x5Z29ufSBwb2x5MiBQb2x5Z29uIGZlYXR1cmUgdG8gZXJhc2UgZnJvbSBgcG9seTFgXG4gKiBAcmV0dXJuIHtQb2x5Z29ufSBhIFBvbHlnb24gZmVhdHVyZSBzaG93aW5nIHRoZSBhcmVhIG9mIGBwb2x5MWAgZXhjbHVkaW5nIHRoZSBhcmVhIG9mIGBwb2x5MmBcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9seTEgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcImZpbGxcIjogXCIjMGYwXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstNDYuNzM4NTg2LCAtMjMuNTk2NzExXSxcbiAqICAgICAgIFstNDYuNzM4NTg2LCAtMjMuNDU4MjA3XSxcbiAqICAgICAgIFstNDYuNTYwMDU4LCAtMjMuNDU4MjA3XSxcbiAqICAgICAgIFstNDYuNTYwMDU4LCAtMjMuNTk2NzExXSxcbiAqICAgICAgIFstNDYuNzM4NTg2LCAtMjMuNTk2NzExXVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcG9seTIgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcImZpbGxcIjogXCIjMDBmXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstNDYuNjUwMDA5LCAtMjMuNjMxMzE0XSxcbiAqICAgICAgIFstNDYuNjUwMDA5LCAtMjMuNTIzN10sXG4gKiAgICAgICBbLTQ2LjUwOTI0NiwgLTIzLjUyMzddLFxuICogICAgICAgWy00Ni41MDkyNDYsIC0yMy42MzEzMTRdLFxuICogICAgICAgWy00Ni42NTAwMDksIC0yMy42MzEzMTRdXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgZXJhc2VkID0gdHVyZi5lcmFzZShwb2x5MSwgcG9seTIpO1xuICogZXJhc2VkLnByb3BlcnRpZXMuZmlsbCA9ICcjZjAwJztcbiAqXG4gKiB2YXIgcG9seWdvbnMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW3BvbHkxLCBwb2x5Ml1cbiAqIH07XG4gKlxuICogLy89cG9seWdvbnNcbiAqXG4gKiAvLz1lcmFzZWRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHAxLCBwMiwgZG9uZSl7XG4gIHZhciBwb2x5MSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocDEpKTtcbiAgdmFyIHBvbHkyID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwMikpO1xuICBpZihwb2x5MS50eXBlICE9PSAnRmVhdHVyZScpIHtcbiAgICBwb2x5MSA9IHtcbiAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgZ2VvbWV0cnk6IHBvbHkxXG4gICAgfTtcbiAgfVxuICBpZihwb2x5Mi50eXBlICE9PSAnRmVhdHVyZScpIHtcbiAgICBwb2x5MiA9IHtcbiAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgZ2VvbWV0cnk6IHBvbHkyXG4gICAgfTtcbiAgfVxuXG4gIHZhciByZWFkZXIgPSBuZXcganN0cy5pby5HZW9KU09OUmVhZGVyKCk7XG4gIHZhciBhID0gcmVhZGVyLnJlYWQoSlNPTi5zdHJpbmdpZnkocG9seTEuZ2VvbWV0cnkpKTtcbiAgdmFyIGIgPSByZWFkZXIucmVhZChKU09OLnN0cmluZ2lmeShwb2x5Mi5nZW9tZXRyeSkpO1xuICB2YXIgZXJhc2VkID0gYS5kaWZmZXJlbmNlKGIpO1xuICB2YXIgcGFyc2VyID0gbmV3IGpzdHMuaW8uR2VvSlNPTlBhcnNlcigpO1xuICBlcmFzZWQgPSBwYXJzZXIud3JpdGUoZXJhc2VkKTtcblxuICBwb2x5MS5nZW9tZXRyeSA9IGVyYXNlZDtcblxuICBpZiAocG9seTEuZ2VvbWV0cnkudHlwZSA9PT0gJ0dlb21ldHJ5Q29sbGVjdGlvbicgJiYgcG9seTEuZ2VvbWV0cnkuZ2VvbWV0cmllcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgIHByb3BlcnRpZXM6IHBvbHkxLnByb3BlcnRpZXMsXG4gICAgICBnZW9tZXRyeTogZXJhc2VkXG4gICAgfTtcbiAgfVxufTtcbiIsIi8qXG4gIGphdmFzY3JpcHQudXRpbCBpcyBhIHBvcnQgb2Ygc2VsZWN0ZWQgcGFydHMgb2YgamF2YS51dGlsIHRvIEphdmFTY3JpcHQgd2hpY2hcbiAgbWFpbiBwdXJwb3NlIGlzIHRvIGVhc2UgcG9ydGluZyBKYXZhIGNvZGUgdG8gSmF2YVNjcmlwdC5cbiAgXG4gIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG4gIENvcHlyaWdodCAoQykgMjAxMS0yMDE0IGJ5IFRoZSBBdXRob3JzXG5cbiAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIFRIRSBTT0ZUV0FSRS5cbiovXG47KGZ1bmN0aW9uKCl7dmFyIGU9dGhpcztmdW5jdGlvbiBmKGEsYil7dmFyIGM9YS5zcGxpdChcIi5cIiksZD1lO2NbMF1pbiBkfHwhZC5leGVjU2NyaXB0fHxkLmV4ZWNTY3JpcHQoXCJ2YXIgXCIrY1swXSk7Zm9yKHZhciB0O2MubGVuZ3RoJiYodD1jLnNoaWZ0KCkpOyljLmxlbmd0aHx8dm9pZCAwPT09Yj9kPWRbdF0/ZFt0XTpkW3RdPXt9OmRbdF09Yn1mdW5jdGlvbiBnKGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLnE9Yi5wcm90b3R5cGU7YS5wcm90b3R5cGU9bmV3IGM7YS5wcm90b3R5cGUuY29uc3RydWN0b3I9YTthLnA9ZnVuY3Rpb24oYSxjLE8pe3ZhciBNPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gYi5wcm90b3R5cGVbY10uYXBwbHkoYSxNKX19O2Z1bmN0aW9uIGgoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhoLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb25cIixoKTtoLnByb3RvdHlwZS5uYW1lPVwiRW1wdHlTdGFja0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGsoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhrLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25cIixrKTtrLnByb3RvdHlwZS5uYW1lPVwiSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGwoKXt9ZihcImphdmFzY3JpcHQudXRpbC5JdGVyYXRvclwiLGwpO2wucHJvdG90eXBlLmhhc05leHQ9bC5wcm90b3R5cGUuYztsLnByb3RvdHlwZS5uZXh0PWwucHJvdG90eXBlLm5leHQ7bC5wcm90b3R5cGUucmVtb3ZlPWwucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBtKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQ29sbGVjdGlvblwiLG0pO2Z1bmN0aW9uIG4oKXt9ZyhuLG0pO2YoXCJqYXZhc2NyaXB0LnV0aWwuTGlzdFwiLG4pO2Z1bmN0aW9uIHAoKXt9ZihcImphdmFzY3JpcHQudXRpbC5NYXBcIixwKTtmdW5jdGlvbiBxKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocSxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uXCIscSk7cS5wcm90b3R5cGUubmFtZT1cIk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIjtmdW5jdGlvbiByKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocixFcnJvcik7ci5wcm90b3R5cGUubmFtZT1cIk9wZXJhdGlvbk5vdFN1cHBvcnRlZFwiO2Z1bmN0aW9uIHMoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhzLG4pO2YoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0XCIscyk7cy5wcm90b3R5cGUuYT1udWxsO3MucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkPXMucHJvdG90eXBlLmFkZDtzLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3MucHJvdG90eXBlLmFkZEFsbD1zLnByb3RvdHlwZS5lO3MucHJvdG90eXBlLnNldD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYVthXTt0aGlzLmFbYV09YjtyZXR1cm4gY307cy5wcm90b3R5cGUuc2V0PXMucHJvdG90eXBlLnNldDtzLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB1KHRoaXMpfTtzLnByb3RvdHlwZS5pdGVyYXRvcj1zLnByb3RvdHlwZS5mO1xucy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2lmKDA+YXx8YT49dGhpcy5zaXplKCkpdGhyb3cgbmV3IGs7cmV0dXJuIHRoaXMuYVthXX07cy5wcm90b3R5cGUuZ2V0PXMucHJvdG90eXBlLmdldDtzLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5pc0VtcHR5PXMucHJvdG90eXBlLmc7cy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5zaXplPXMucHJvdG90eXBlLnNpemU7cy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O3MucHJvdG90eXBlLnRvQXJyYXk9cy5wcm90b3R5cGUuaDtcbnMucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihhKXtmb3IodmFyIGI9ITEsYz0wLGQ9dGhpcy5hLmxlbmd0aDtjPGQ7YysrKWlmKHRoaXMuYVtjXT09PWEpe3RoaXMuYS5zcGxpY2UoYywxKTtiPSEwO2JyZWFrfXJldHVybiBifTtzLnByb3RvdHlwZS5yZW1vdmU9cy5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIHUoYSl7dGhpcy5qPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfXCIsdSk7dS5wcm90b3R5cGUuaj1udWxsO3UucHJvdG90eXBlLmI9MDt1LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5qLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5qLmdldCh0aGlzLmIrKyl9O3UucHJvdG90eXBlLm5leHQ9dS5wcm90b3R5cGUubmV4dDt1LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmouc2l6ZSgpPyEwOiExfTt1LnByb3RvdHlwZS5oYXNOZXh0PXUucHJvdG90eXBlLmM7XG51LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3UucHJvdG90eXBlLnJlbW92ZT11LnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdigpe31mKFwiamF2YXNjcmlwdC51dGlsLkFycmF5c1wiLHYpO1xudi5zb3J0PWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdLGIsYyxkO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWEuc29ydCgpO2Vsc2UgaWYoMj09PWFyZ3VtZW50cy5sZW5ndGgpYz1hcmd1bWVudHNbMV0sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYS5zb3J0KGQpO2Vsc2UgaWYoMz09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxiLnNvcnQoKSxkPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKTtlbHNlIGlmKDQ9PT1hcmd1bWVudHMubGVuZ3RoKWZvcihiPWEuc2xpY2UoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSksYz1hcmd1bWVudHNbM10sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYi5zb3J0KGQpLFxuZD1hLnNsaWNlKDAsYXJndW1lbnRzWzFdKS5jb25jYXQoYixhLnNsaWNlKGFyZ3VtZW50c1syXSxhLmxlbmd0aCkpLGEuc3BsaWNlKDAsYS5sZW5ndGgpLGI9MDtiPGQubGVuZ3RoO2IrKylhLnB1c2goZFtiXSl9O3YuYXNMaXN0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1uZXcgcyxjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKWIuYWRkKGFbY10pO3JldHVybiBifTtmdW5jdGlvbiB3KCl7dGhpcy5pPXt9fWcodyxwKTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hNYXBcIix3KTt3LnByb3RvdHlwZS5pPW51bGw7dy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmlbYV18fG51bGx9O3cucHJvdG90eXBlLmdldD13LnByb3RvdHlwZS5nZXQ7dy5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaVthXT1ifTt3LnByb3RvdHlwZS5wdXQ9dy5wcm90b3R5cGUucHV0O3cucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2ZvcihiIGluIHRoaXMuaSl0aGlzLmkuaGFzT3duUHJvcGVydHkoYikmJmEuYWRkKHRoaXMuaVtiXSk7cmV0dXJuIGF9O3cucHJvdG90eXBlLnZhbHVlcz13LnByb3RvdHlwZS5tO3cucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tKCkuc2l6ZSgpfTt3LnByb3RvdHlwZS5zaXplPXcucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24geCgpe31nKHgsbSk7ZihcImphdmFzY3JpcHQudXRpbC5TZXRcIix4KTtmdW5jdGlvbiB5KGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcoeSx4KTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hTZXRcIix5KTt5LnByb3RvdHlwZS5hPW51bGw7eS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYodGhpcy5hW2JdPT09YSlyZXR1cm4hMDtyZXR1cm4hMX07eS5wcm90b3R5cGUuY29udGFpbnM9eS5wcm90b3R5cGUuY29udGFpbnM7eS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZD15LnByb3RvdHlwZS5hZGQ7eS5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTt5LnByb3RvdHlwZS5hZGRBbGw9eS5wcm90b3R5cGUuZTtcbnkucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307eS5wcm90b3R5cGUucmVtb3ZlPXkucHJvdG90eXBlLnJlbW92ZTt5LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmlzRW1wdHk9eS5wcm90b3R5cGUuZzt5LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07eS5wcm90b3R5cGUudG9BcnJheT15LnByb3RvdHlwZS5oO3kucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHoodGhpcyl9O3kucHJvdG90eXBlLml0ZXJhdG9yPXkucHJvdG90eXBlLmY7ZnVuY3Rpb24geihhKXt0aGlzLms9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMVwiLHopO3oucHJvdG90eXBlLms9bnVsbDtcbnoucHJvdG90eXBlLmI9MDt6LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5rLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5rLmFbdGhpcy5iKytdfTt6LnByb3RvdHlwZS5uZXh0PXoucHJvdG90eXBlLm5leHQ7ei5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5rLnNpemUoKT8hMDohMX07ei5wcm90b3R5cGUuaGFzTmV4dD16LnByb3RvdHlwZS5jO3oucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307ei5wcm90b3R5cGUucmVtb3ZlPXoucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBBKCl7fWcoQSxwKTtmKFwiamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcFwiLEEpO2Z1bmN0aW9uIEIoKXt9ZyhCLHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0XCIsQik7ZnVuY3Rpb24gQygpe3RoaXMuYT1bXX1nKEMsbik7ZihcImphdmFzY3JpcHQudXRpbC5TdGFja1wiLEMpO0MucHJvdG90eXBlLmE9bnVsbDtDLnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiBhfTtDLnByb3RvdHlwZS5wdXNoPUMucHJvdG90eXBlLnB1c2g7Qy5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYS5wb3AoKX07Qy5wcm90b3R5cGUucG9wPUMucHJvdG90eXBlLnBvcDtDLnByb3RvdHlwZS5vPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYVt0aGlzLmEubGVuZ3RoLTFdfTtDLnByb3RvdHlwZS5wZWVrPUMucHJvdG90eXBlLm87Qy5wcm90b3R5cGUuZW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGg/ITA6ITF9O0MucHJvdG90eXBlLmVtcHR5PUMucHJvdG90eXBlLmVtcHR5O1xuQy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVtcHR5KCl9O0MucHJvdG90eXBlLmlzRW1wdHk9Qy5wcm90b3R5cGUuZztDLnByb3RvdHlwZS5zZWFyY2g9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYS5pbmRleE9mKGEpfTtDLnByb3RvdHlwZS5zZWFyY2g9Qy5wcm90b3R5cGUuc2VhcmNoO0MucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07Qy5wcm90b3R5cGUuc2l6ZT1DLnByb3RvdHlwZS5zaXplO0MucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtDLnByb3RvdHlwZS50b0FycmF5PUMucHJvdG90eXBlLmg7ZnVuY3Rpb24gRChhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEucGFyZW50fWZ1bmN0aW9uIEUoYSxiKXtudWxsIT09YSYmKGEuY29sb3I9Yil9ZnVuY3Rpb24gRihhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEubGVmdH1mdW5jdGlvbiBHKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5yaWdodH1mdW5jdGlvbiBIKCl7dGhpcy5kPW51bGw7dGhpcy5uPTB9ZyhILEEpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcFwiLEgpO0gucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5kO251bGwhPT1iOyl7dmFyIGM9YS5jb21wYXJlVG8oYi5rZXkpO2lmKDA+YyliPWIubGVmdDtlbHNlIGlmKDA8YyliPWIucmlnaHQ7ZWxzZSByZXR1cm4gYi52YWx1ZX1yZXR1cm4gbnVsbH07SC5wcm90b3R5cGUuZ2V0PUgucHJvdG90eXBlLmdldDtcbkgucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhLGIpe2lmKG51bGw9PT10aGlzLmQpcmV0dXJuIHRoaXMuZD17a2V5OmEsdmFsdWU6YixsZWZ0Om51bGwscmlnaHQ6bnVsbCxwYXJlbnQ6bnVsbCxjb2xvcjowfSx0aGlzLm49MSxudWxsO3ZhciBjPXRoaXMuZCxkLHQ7ZG8gaWYoZD1jLHQ9YS5jb21wYXJlVG8oYy5rZXkpLDA+dCljPWMubGVmdDtlbHNlIGlmKDA8dCljPWMucmlnaHQ7ZWxzZSByZXR1cm4gZD1jLnZhbHVlLGMudmFsdWU9YixkO3doaWxlKG51bGwhPT1jKTtjPXtrZXk6YSxsZWZ0Om51bGwscmlnaHQ6bnVsbCx2YWx1ZTpiLHBhcmVudDpkLGNvbG9yOjB9OzA+dD9kLmxlZnQ9YzpkLnJpZ2h0PWM7Zm9yKGMuY29sb3I9MTtudWxsIT1jJiZjIT10aGlzLmQmJjE9PWMucGFyZW50LmNvbG9yOylEKGMpPT1GKEQoRChjKSkpPyhkPUcoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RyhEKGMpKSYmXG4oYz1EKGMpLEkodGhpcyxjKSksRShEKGMpLDApLEUoRChEKGMpKSwxKSxKKHRoaXMsRChEKGMpKSkpKTooZD1GKEQoRChjKSkpLDE9PShudWxsPT1kPzA6ZC5jb2xvcik/KEUoRChjKSwwKSxFKGQsMCksRShEKEQoYykpLDEpLGM9RChEKGMpKSk6KGM9PUYoRChjKSkmJihjPUQoYyksSih0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEkodGhpcyxEKEQoYykpKSkpO3RoaXMuZC5jb2xvcj0wO3RoaXMubisrO3JldHVybiBudWxsfTtILnByb3RvdHlwZS5wdXQ9SC5wcm90b3R5cGUucHV0O0gucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2I9dGhpcy5kO2lmKG51bGwhPWIpZm9yKDtudWxsIT1iLmxlZnQ7KWI9Yi5sZWZ0O2lmKG51bGwhPT1iKWZvcihhLmFkZChiLnZhbHVlKTtudWxsIT09KGI9SyhiKSk7KWEuYWRkKGIudmFsdWUpO3JldHVybiBhfTtILnByb3RvdHlwZS52YWx1ZXM9SC5wcm90b3R5cGUubTtcbmZ1bmN0aW9uIEkoYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLnJpZ2h0O2IucmlnaHQ9Yy5sZWZ0O251bGwhPWMubGVmdCYmKGMubGVmdC5wYXJlbnQ9Yik7Yy5wYXJlbnQ9Yi5wYXJlbnQ7bnVsbD09Yi5wYXJlbnQ/YS5kPWM6Yi5wYXJlbnQubGVmdD09Yj9iLnBhcmVudC5sZWZ0PWM6Yi5wYXJlbnQucmlnaHQ9YztjLmxlZnQ9YjtiLnBhcmVudD1jfX1mdW5jdGlvbiBKKGEsYil7aWYobnVsbCE9Yil7dmFyIGM9Yi5sZWZ0O2IubGVmdD1jLnJpZ2h0O251bGwhPWMucmlnaHQmJihjLnJpZ2h0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5yaWdodD09Yj9iLnBhcmVudC5yaWdodD1jOmIucGFyZW50LmxlZnQ9YztjLnJpZ2h0PWI7Yi5wYXJlbnQ9Y319XG5mdW5jdGlvbiBLKGEpe2lmKG51bGw9PT1hKXJldHVybiBudWxsO2lmKG51bGwhPT1hLnJpZ2h0KWZvcih2YXIgYj1hLnJpZ2h0O251bGwhPT1iLmxlZnQ7KWI9Yi5sZWZ0O2Vsc2UgZm9yKGI9YS5wYXJlbnQ7bnVsbCE9PWImJmE9PT1iLnJpZ2h0OylhPWIsYj1iLnBhcmVudDtyZXR1cm4gYn1ILnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubn07SC5wcm90b3R5cGUuc2l6ZT1ILnByb3RvdHlwZS5zaXplO2Z1bmN0aW9uIEwoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhMLEIpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZVNldFwiLEwpO0wucHJvdG90eXBlLmE9bnVsbDtMLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigwPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4hMDtyZXR1cm4hMX07TC5wcm90b3R5cGUuY29udGFpbnM9TC5wcm90b3R5cGUuY29udGFpbnM7TC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYoMT09PXRoaXMuYVtiXS5jb21wYXJlVG8oYSkpcmV0dXJuIHRoaXMuYS5zcGxpY2UoYiwwLGEpLCEwO3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGQ9TC5wcm90b3R5cGUuYWRkO1xuTC5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGRBbGw9TC5wcm90b3R5cGUuZTtMLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O0wucHJvdG90eXBlLnJlbW92ZT1MLnByb3RvdHlwZS5yZW1vdmU7TC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5zaXplPUwucHJvdG90eXBlLnNpemU7TC5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07TC5wcm90b3R5cGUuaXNFbXB0eT1MLnByb3RvdHlwZS5nO0wucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtMLnByb3RvdHlwZS50b0FycmF5PUwucHJvdG90eXBlLmg7TC5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgTih0aGlzKX07XG5MLnByb3RvdHlwZS5pdGVyYXRvcj1MLnByb3RvdHlwZS5mO2Z1bmN0aW9uIE4oYSl7dGhpcy5sPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfJDJcIixOKTtOLnByb3RvdHlwZS5sPW51bGw7Ti5wcm90b3R5cGUuYj0wO04ucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmwuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmwuYVt0aGlzLmIrK119O04ucHJvdG90eXBlLm5leHQ9Ti5wcm90b3R5cGUubmV4dDtOLnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmwuc2l6ZSgpPyEwOiExfTtOLnByb3RvdHlwZS5oYXNOZXh0PU4ucHJvdG90eXBlLmM7Ti5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTtOLnByb3RvdHlwZS5yZW1vdmU9Ti5wcm90b3R5cGUucmVtb3ZlO1widW5kZWZpbmVkXCIhPT10eXBlb2YgZ2xvYmFsJiYoZ2xvYmFsLmphdmFzY3JpcHQ9e30sZ2xvYmFsLmphdmFzY3JpcHQudXRpbD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdD1zLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlzPXYsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uPW0sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5FbXB0eVN0YWNrRXhjZXB0aW9uPWgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoTWFwPXcsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoU2V0PXksZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JbmRleE91dE9mQm91bmRzRXhjZXB0aW9uPWssZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JdGVyYXRvcj1sLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTGlzdD1uLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTWFwPXAsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uPXEsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5PcGVyYXRpb25Ob3RTdXBwb3J0ZWQ9XG5yLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU2V0PXgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Tb3J0ZWRNYXA9QSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZFNldD1CLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU3RhY2s9QyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVNYXA9SCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVTZXQ9TCk7fSkuY2FsbCh0aGlzKTtcbiIsInZhciBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciBlYWNoID0gcmVxdWlyZSgndHVyZi1tZXRhJykuY29vcmRFYWNoO1xudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xuXG4vKipcbiAqIFRha2VzIGFueSB7QGxpbmsgR2VvSlNPTn0gb2JqZWN0IGFuZCByZXR1cm4gYWxsIHBvc2l0aW9ucyBhc1xuICogYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2V4cGxvZGVcbiAqIEBjYXRlZ29yeSBtaXNjXG4gKiBAcGFyYW0ge0dlb0pTT059IGlucHV0IGlucHV0IGZlYXR1cmVzXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIHJlcHJlc2VudGluZyB0aGUgZXhwbG9kZWQgaW5wdXQgZmVhdHVyZXNcbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiBpdCBlbmNvdW50ZXJzIGFuIHVua25vd24gZ2VvbWV0cnkgdHlwZVxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFsxNzcuNDM0NjkyLCAtMTcuNzc1MTddLFxuICogICAgICAgWzE3Ny40MDIwNzYsIC0xNy43NzkwOTNdLFxuICogICAgICAgWzE3Ny4zODA3OSwgLTE3LjgwMzkzN10sXG4gKiAgICAgICBbMTc3LjQwMjQyLCAtMTcuODI2MTY0XSxcbiAqICAgICAgIFsxNzcuNDM4NDY4LCAtMTcuODI0ODU3XSxcbiAqICAgICAgIFsxNzcuNDU0OTQ4LCAtMTcuNzk2NzQ2XSxcbiAqICAgICAgIFsxNzcuNDM0NjkyLCAtMTcuNzc1MTddXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgcG9pbnRzID0gdHVyZi5leHBsb2RlKHBvbHkpO1xuICpcbiAqIC8vPXBvbHlcbiAqXG4gKiAvLz1wb2ludHNcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihsYXllcikge1xuICB2YXIgcG9pbnRzID0gW107XG4gIGVhY2gobGF5ZXIsIGZ1bmN0aW9uKGNvb3JkKSB7XG4gICAgcG9pbnRzLnB1c2gocG9pbnQoY29vcmQpKTtcbiAgfSk7XG4gIHJldHVybiBmZWF0dXJlQ29sbGVjdGlvbihwb2ludHMpO1xufTtcbiIsInZhciBlYWNoID0gcmVxdWlyZSgndHVyZi1tZXRhJykuY29vcmRFYWNoO1xuXG4vKipcbiAqIFRha2VzIGFueSB7QGxpbmsgR2VvSlNPTn0gb2JqZWN0LCBjYWxjdWxhdGVzIHRoZSBleHRlbnQgb2YgYWxsIGlucHV0IGZlYXR1cmVzLCBhbmQgcmV0dXJucyBhIGJvdW5kaW5nIGJveC5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZXh0ZW50XG4gKiBAY2F0ZWdvcnkgbWVhc3VyZW1lbnRcbiAqIEBwYXJhbSB7R2VvSlNPTn0gaW5wdXQgYW55IHZhbGlkIEdlb0pTT04gT2JqZWN0XG4gKiBAcmV0dXJuIHtBcnJheTxudW1iZXI+fSB0aGUgYm91bmRpbmcgYm94IG9mIGBpbnB1dGAgZ2l2ZW5cbiAqIGFzIGFuIGFycmF5IGluIFdTRU4gb3JkZXIgKHdlc3QsIHNvdXRoLCBlYXN0LCBub3J0aClcbiAqIEBleGFtcGxlXG4gKiB2YXIgaW5wdXQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMTQuMTc1MzI5LCAyMi4yNTI0XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMTQuMTcwMDA3LCAyMi4yNjc5NjldXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzExNC4yMDA2NDksIDIyLjI3NDY0MV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTE0LjE4Njc0NCwgMjIuMjY1NzQ1XVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgYmJveCA9IHR1cmYuZXh0ZW50KGlucHV0KTtcbiAqXG4gKiB2YXIgYmJveFBvbHlnb24gPSB0dXJmLmJib3hQb2x5Z29uKGJib3gpO1xuICpcbiAqIHZhciByZXN1bHRGZWF0dXJlcyA9IGlucHV0LmZlYXR1cmVzLmNvbmNhdChiYm94UG9seWdvbik7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxheWVyKSB7XG4gICAgdmFyIGV4dGVudCA9IFtJbmZpbml0eSwgSW5maW5pdHksIC1JbmZpbml0eSwgLUluZmluaXR5XTtcbiAgICBlYWNoKGxheWVyLCBmdW5jdGlvbihjb29yZCkge1xuICAgICAgaWYgKGV4dGVudFswXSA+IGNvb3JkWzBdKSBleHRlbnRbMF0gPSBjb29yZFswXTtcbiAgICAgIGlmIChleHRlbnRbMV0gPiBjb29yZFsxXSkgZXh0ZW50WzFdID0gY29vcmRbMV07XG4gICAgICBpZiAoZXh0ZW50WzJdIDwgY29vcmRbMF0pIGV4dGVudFsyXSA9IGNvb3JkWzBdO1xuICAgICAgaWYgKGV4dGVudFszXSA8IGNvb3JkWzFdKSBleHRlbnRbM10gPSBjb29yZFsxXTtcbiAgICB9KTtcbiAgICByZXR1cm4gZXh0ZW50O1xufTtcbiIsIi8qKlxuICogVGFrZXMgb25lIG9yIG1vcmUge0BsaW5rIEZlYXR1cmV8RmVhdHVyZXN9IGFuZCBjcmVhdGVzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufVxuICpcbiAqIEBtb2R1bGUgdHVyZi9mZWF0dXJlY29sbGVjdGlvblxuICogQGNhdGVnb3J5IGhlbHBlclxuICogQHBhcmFtIHtGZWF0dXJlfSBmZWF0dXJlcyBpbnB1dCBGZWF0dXJlc1xuICogQHJldHVybnMge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGlucHV0IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGZlYXR1cmVzID0gW1xuICogIHR1cmYucG9pbnQoWy03NS4zNDMsIDM5Ljk4NF0sIHtuYW1lOiAnTG9jYXRpb24gQSd9KSxcbiAqICB0dXJmLnBvaW50KFstNzUuODMzLCAzOS4yODRdLCB7bmFtZTogJ0xvY2F0aW9uIEInfSksXG4gKiAgdHVyZi5wb2ludChbLTc1LjUzNCwgMzkuMTIzXSwge25hbWU6ICdMb2NhdGlvbiBDJ30pXG4gKiBdO1xuICpcbiAqIHZhciBmYyA9IHR1cmYuZmVhdHVyZWNvbGxlY3Rpb24oZmVhdHVyZXMpO1xuICpcbiAqIC8vPWZjXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmVhdHVyZXMpe1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAgICBmZWF0dXJlczogZmVhdHVyZXNcbiAgfTtcbn07XG4iLCJ2YXIgZmVhdHVyZUNvbGxlY3Rpb24gPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IGFuZCBmaWx0ZXJzIGl0IGJ5IGEgZ2l2ZW4gcHJvcGVydHkgYW5kIHZhbHVlXG4gKlxuICogQG1vZHVsZSB0dXJmL2ZpbHRlclxuICogQGNhdGVnb3J5IGRhdGFcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IGZlYXR1cmVzIGlucHV0IEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4gKiBAcGFyYW0ge1N0cmluZ30ga2V5IHRoZSBwcm9wZXJ0eSBvbiB3aGljaCB0byBmaWx0ZXJcbiAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSB0aGUgdmFsdWUgb2YgdGhhdCBwcm9wZXJ0eSBvbiB3aGljaCB0byBmaWx0ZXJcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIGZpbHRlcmVkIGNvbGxlY3Rpb24gd2l0aCBvbmx5IGZlYXR1cmVzIHRoYXQgbWF0Y2ggaW5wdXQgYGtleWAgYW5kIGB2YWx1ZWBcbiAqIEBleGFtcGxlXG4gKiB2YXIgZmVhdHVyZXMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwic3BlY2llc1wiOiBcIm9ha1wiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy03Mi41ODE3NzcsIDQ0LjI2MDg3NV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInNwZWNpZXNcIjogXCJiaXJjaFwiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy03Mi41NzAwMTgsIDQ0LjI2MDY5MV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInNwZWNpZXNcIjogXCJvYWtcIlxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzIuNTc2Mjg0LCA0NC4yNTc5MjVdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJzcGVjaWVzXCI6IFwicmVkd29vZFwiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy03Mi41NjkxNiwgNDQuMjU0NjA1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwic3BlY2llc1wiOiBcIm1hcGxlXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTcyLjU4MTY5MSwgNDQuMjQ4NThdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJzcGVjaWVzXCI6IFwib2FrXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTcyLjU4MzgzNywgNDQuMjU1NzczXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIga2V5ID0gXCJzcGVjaWVzXCI7XG4gKiB2YXIgdmFsdWUgPSBcIm9ha1wiO1xuICpcbiAqIHZhciBmaWx0ZXJlZCA9IHR1cmYuZmlsdGVyKGZlYXR1cmVzLCBrZXksIHZhbHVlKTtcbiAqXG4gKiAvLz1mZWF0dXJlc1xuICpcbiAqIC8vPWZpbHRlcmVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oY29sbGVjdGlvbiwga2V5LCB2YWwpIHtcbiAgdmFyIG5ld0ZDID0gZmVhdHVyZUNvbGxlY3Rpb24oW10pO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgY29sbGVjdGlvbi5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgIGlmKGNvbGxlY3Rpb24uZmVhdHVyZXNbaV0ucHJvcGVydGllc1trZXldID09PSB2YWwpIHtcbiAgICAgIG5ld0ZDLmZlYXR1cmVzLnB1c2goY29sbGVjdGlvbi5mZWF0dXJlc1tpXSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBuZXdGQztcbn07XG4iLCIvKipcbiAqIFRha2VzIGEge0BsaW5rIEdlb0pTT059IG9iamVjdCBvZiBhbnkgdHlwZSBhbmQgZmxpcHMgYWxsIG9mIGl0cyBjb29yZGluYXRlc1xuICogZnJvbSBgW3gsIHldYCB0byBgW3ksIHhdYC5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZmxpcFxuICogQGNhdGVnb3J5IG1pc2NcbiAqIEBwYXJhbSB7R2VvSlNPTn0gaW5wdXQgaW5wdXQgR2VvSlNPTiBvYmplY3RcbiAqIEByZXR1cm5zIHtHZW9KU09OfSBhIEdlb0pTT04gb2JqZWN0IG9mIHRoZSBzYW1lIHR5cGUgYXMgYGlucHV0YCB3aXRoIGZsaXBwZWQgY29vcmRpbmF0ZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgc2VyYmlhID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFsyMC41NjY0MDYsIDQzLjQyMTAwOF1cbiAqICAgfVxuICogfTtcbiAqXG4gKiAvLz1zZXJiaWFcbiAqXG4gKiB2YXIgc2F1ZGlBcmFiaWEgPSB0dXJmLmZsaXAoc2VyYmlhKTtcbiAqXG4gKiAvLz1zYXVkaUFyYWJpYVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZsaXBBbnk7XG5cbmZ1bmN0aW9uIGZsaXBBbnkoXykge1xuICAgIC8vIGVuc3VyZSB0aGF0IHdlIGRvbid0IG1vZGlmeSBmZWF0dXJlcyBpbi1wbGFjZSBhbmQgY2hhbmdlcyB0byB0aGVcbiAgICAvLyBvdXRwdXQgZG8gbm90IGNoYW5nZSB0aGUgcHJldmlvdXMgZmVhdHVyZSwgaW5jbHVkaW5nIGNoYW5nZXMgdG8gbmVzdGVkXG4gICAgLy8gcHJvcGVydGllcy5cbiAgICB2YXIgaW5wdXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KF8pKTtcbiAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHtcbiAgICAgICAgY2FzZSAnRmVhdHVyZUNvbGxlY3Rpb24nOlxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dC5mZWF0dXJlcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICBmbGlwR2VvbWV0cnkoaW5wdXQuZmVhdHVyZXNbaV0uZ2VvbWV0cnkpO1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgICAgICBjYXNlICdGZWF0dXJlJzpcbiAgICAgICAgICAgIGZsaXBHZW9tZXRyeShpbnB1dC5nZW9tZXRyeSk7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBmbGlwR2VvbWV0cnkoaW5wdXQpO1xuICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZmxpcEdlb21ldHJ5KGdlb21ldHJ5KSB7XG4gICAgdmFyIGNvb3JkcyA9IGdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICAgIHN3aXRjaChnZW9tZXRyeS50eXBlKSB7XG4gICAgICBjYXNlICdQb2ludCc6XG4gICAgICAgIGZsaXAwKGNvb3Jkcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnTGluZVN0cmluZyc6XG4gICAgICBjYXNlICdNdWx0aVBvaW50JzpcbiAgICAgICAgZmxpcDEoY29vcmRzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdQb2x5Z29uJzpcbiAgICAgIGNhc2UgJ011bHRpTGluZVN0cmluZyc6XG4gICAgICAgIGZsaXAyKGNvb3Jkcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnTXVsdGlQb2x5Z29uJzpcbiAgICAgICAgZmxpcDMoY29vcmRzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdHZW9tZXRyeUNvbGxlY3Rpb24nOlxuICAgICAgICBnZW9tZXRyeS5nZW9tZXRyaWVzLmZvckVhY2goZmxpcEdlb21ldHJ5KTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmbGlwMChjb29yZCkge1xuICAgIGNvb3JkLnJldmVyc2UoKTtcbn1cblxuZnVuY3Rpb24gZmxpcDEoY29vcmRzKSB7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIGNvb3Jkc1tpXS5yZXZlcnNlKCk7XG59XG5cbmZ1bmN0aW9uIGZsaXAyKGNvb3Jkcykge1xuICBmb3IodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKVxuICAgIGZvcih2YXIgaiA9IDA7IGogPCBjb29yZHNbaV0ubGVuZ3RoOyBqKyspIGNvb3Jkc1tpXVtqXS5yZXZlcnNlKCk7XG59XG5cbmZ1bmN0aW9uIGZsaXAzKGNvb3Jkcykge1xuICBmb3IodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKVxuICAgIGZvcih2YXIgaiA9IDA7IGogPCBjb29yZHNbaV0ubGVuZ3RoOyBqKyspXG4gICAgICBmb3IodmFyIGsgPSAwOyBrIDwgY29vcmRzW2ldW2pdLmxlbmd0aDsgaysrKSBjb29yZHNbaV1bal1ba10ucmV2ZXJzZSgpO1xufVxuIiwidmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xudmFyIHBvbHlnb24gPSByZXF1aXJlKCd0dXJmLXBvbHlnb24nKTtcbnZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcbnZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIGJvdW5kaW5nIGJveCBhbmQgYSBjZWxsIHNpemUgaW4gZGVncmVlcyBhbmQgcmV0dXJucyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2YgZmxhdC10b3BwZWRcbiAqIGhleGFnb25zICh7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMpIGFsaWduZWQgaW4gYW4gXCJvZGQtcVwiIHZlcnRpY2FsIGdyaWQgYXNcbiAqIGRlc2NyaWJlZCBpbiBbSGV4YWdvbmFsIEdyaWRzXShodHRwOi8vd3d3LnJlZGJsb2JnYW1lcy5jb20vZ3JpZHMvaGV4YWdvbnMvKVxuICpcbiAqIEBtb2R1bGUgdHVyZi9oZXgtZ3JpZFxuICogQGNhdGVnb3J5IGludGVycG9sYXRpb25cbiAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gYmJveCBib3VuZGluZyBib3ggaW4gW21pblgsIG1pblksIG1heFgsIG1heFldIG9yZGVyXG4gKiBAcGFyYW0ge051bWJlcn0gY2VsbFdpZHRoIHdpZHRoIG9mIGNlbGwgaW4gc3BlY2lmaWVkIHVuaXRzXG4gKiBAcGFyYW0ge1N0cmluZ30gdW5pdHMgdXNlZCBpbiBjYWxjdWxhdGluZyBjZWxsV2lkdGggKCdtaWxlcycgb3IgJ2tpbG9tZXRlcnMnKVxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IHVuaXRzIHVzZWQgaW4gY2FsY3VsYXRpbmcgY2VsbFdpZHRoICgnbWlsZXMnIG9yICdraWxvbWV0ZXJzJylcbiAqIEBleGFtcGxlXG4gKiB2YXIgYmJveCA9IFstOTYsMzEsLTg0LDQwXTtcbiAqIHZhciBjZWxsV2lkdGggPSA1MDtcbiAqIHZhciB1bml0cyA9ICdtaWxlcyc7XG4gKlxuICogdmFyIGhleGdyaWQgPSB0dXJmLmhleEdyaWQoYmJveCwgY2VsbFdpZHRoLCB1bml0cyk7XG4gKlxuICogLy89aGV4Z3JpZFxuICovXG5cbi8vUHJlY29tcHV0ZSBjb3NpbmVzIGFuZCBzaW5lcyBvZiBhbmdsZXMgdXNlZCBpbiBoZXhhZ29uIGNyZWF0aW9uXG4vLyBmb3IgcGVyZm9ybWFuY2UgZ2FpblxudmFyIGNvc2luZXMgPSBbXTtcbnZhciBzaW5lcyA9IFtdO1xuZm9yICh2YXIgaSA9IDA7IGkgPCA2OyBpKyspIHtcbiAgdmFyIGFuZ2xlID0gMiAqIE1hdGguUEkvNiAqIGk7XG4gIGNvc2luZXMucHVzaChNYXRoLmNvcyhhbmdsZSkpO1xuICBzaW5lcy5wdXNoKE1hdGguc2luKGFuZ2xlKSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaGV4Z3JpZChiYm94LCBjZWxsLCB1bml0cykge1xuICB2YXIgeEZyYWN0aW9uID0gY2VsbCAvIChkaXN0YW5jZShwb2ludChbYmJveFswXSwgYmJveFsxXV0pLCBwb2ludChbYmJveFsyXSwgYmJveFsxXV0pLCB1bml0cykpO1xuICB2YXIgY2VsbFdpZHRoID0geEZyYWN0aW9uICogKGJib3hbMl0gLSBiYm94WzBdKTtcbiAgdmFyIHlGcmFjdGlvbiA9IGNlbGwgLyAoZGlzdGFuY2UocG9pbnQoW2Jib3hbMF0sIGJib3hbMV1dKSwgcG9pbnQoW2Jib3hbMF0sIGJib3hbM11dKSwgdW5pdHMpKTtcbiAgdmFyIGNlbGxIZWlnaHQgPSB5RnJhY3Rpb24gKiAoYmJveFszXSAtIGJib3hbMV0pO1xuICB2YXIgcmFkaXVzID0gY2VsbFdpZHRoIC8gMjtcblxuICB2YXIgaGV4X3dpZHRoID0gcmFkaXVzICogMjtcbiAgdmFyIGhleF9oZWlnaHQgPSBNYXRoLnNxcnQoMykvMiAqIGhleF93aWR0aDtcblxuICB2YXIgYm94X3dpZHRoID0gYmJveFsyXSAtIGJib3hbMF07XG4gIHZhciBib3hfaGVpZ2h0ID0gYmJveFszXSAtIGJib3hbMV07XG5cbiAgdmFyIHhfaW50ZXJ2YWwgPSAzLzQgKiBoZXhfd2lkdGg7XG4gIHZhciB5X2ludGVydmFsID0gaGV4X2hlaWdodDtcblxuICB2YXIgeF9zcGFuID0gYm94X3dpZHRoIC8gKGhleF93aWR0aCAtIHJhZGl1cy8yKTtcbiAgdmFyIHhfY291bnQgPSBNYXRoLmNlaWwoeF9zcGFuKTtcbiAgaWYgKE1hdGgucm91bmQoeF9zcGFuKSA9PT0geF9jb3VudCkge1xuICAgIHhfY291bnQrKztcbiAgfVxuXG4gIHZhciB4X2FkanVzdCA9ICgoeF9jb3VudCAqIHhfaW50ZXJ2YWwgLSByYWRpdXMvMikgLSBib3hfd2lkdGgpLzIgLSByYWRpdXMvMjtcblxuICB2YXIgeV9jb3VudCA9IE1hdGguY2VpbChib3hfaGVpZ2h0IC8gaGV4X2hlaWdodCk7XG5cbiAgdmFyIHlfYWRqdXN0ID0gKGJveF9oZWlnaHQgLSB5X2NvdW50ICogaGV4X2hlaWdodCkvMjtcblxuICB2YXIgaGFzT2Zmc2V0WSA9IHlfY291bnQgKiBoZXhfaGVpZ2h0IC0gYm94X2hlaWdodCA+IGhleF9oZWlnaHQvMjtcbiAgaWYgKGhhc09mZnNldFkpIHtcbiAgICB5X2FkanVzdCAtPSBoZXhfaGVpZ2h0LzQ7XG4gIH1cblxuICB2YXIgZmMgPSBmZWF0dXJlY29sbGVjdGlvbihbXSk7XG4gIGZvciAodmFyIHggPSAwOyB4IDwgeF9jb3VudDsgeCsrKSB7XG4gICAgZm9yICh2YXIgeSA9IDA7IHkgPD0geV9jb3VudDsgeSsrKSB7XG5cbiAgICAgIHZhciBpc09kZCA9IHggJSAyID09PSAxO1xuICAgICAgaWYgKHkgPT09IDAgJiYgaXNPZGQpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmICh5ID09PSAwICYmIGhhc09mZnNldFkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBjZW50ZXJfeCA9IHggKiB4X2ludGVydmFsICsgYmJveFswXSAtIHhfYWRqdXN0O1xuICAgICAgdmFyIGNlbnRlcl95ID0geSAqIHlfaW50ZXJ2YWwgKyBiYm94WzFdICsgeV9hZGp1c3Q7XG5cbiAgICAgIGlmIChpc09kZCkge1xuICAgICAgICBjZW50ZXJfeSAtPSBoZXhfaGVpZ2h0LzI7XG4gICAgICB9XG4gICAgICBmYy5mZWF0dXJlcy5wdXNoKGhleGFnb24oW2NlbnRlcl94LCBjZW50ZXJfeV0sIHJhZGl1cykpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmYztcbn07XG5cbi8vQ2VudGVyIHNob3VsZCBiZSBbeCwgeV1cbmZ1bmN0aW9uIGhleGFnb24oY2VudGVyLCByYWRpdXMpIHtcbiAgdmFyIHZlcnRpY2VzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7XG4gICAgdmFyIHggPSBjZW50ZXJbMF0gKyByYWRpdXMgKiBjb3NpbmVzW2ldO1xuICAgIHZhciB5ID0gY2VudGVyWzFdICsgcmFkaXVzICogc2luZXNbaV07XG4gICAgdmVydGljZXMucHVzaChbeCx5XSk7XG4gIH1cbiAgLy9maXJzdCBhbmQgbGFzdCB2ZXJ0ZXggbXVzdCBiZSB0aGUgc2FtZVxuICB2ZXJ0aWNlcy5wdXNoKHZlcnRpY2VzWzBdKTtcbiAgcmV0dXJuIHBvbHlnb24oW3ZlcnRpY2VzXSk7XG59IiwiLy8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9FdmVuJUUyJTgwJTkzb2RkX3J1bGVcbi8vIG1vZGlmaWVkIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9zdWJzdGFjay9wb2ludC1pbi1wb2x5Z29uL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG4vLyB3aGljaCB3YXMgbW9kaWZpZWQgZnJvbSBodHRwOi8vd3d3LmVjc2UucnBpLmVkdS9Ib21lcGFnZXMvd3JmL1Jlc2VhcmNoL1Nob3J0X05vdGVzL3BucG9seS5odG1sXG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgUG9pbnR9IGZlYXR1cmUgYW5kIGEge0BsaW5rIFBvbHlnb259IGZlYXR1cmUgYW5kIGRldGVybWluZXMgaWYgdGhlIFBvaW50IHJlc2lkZXMgaW5zaWRlIHRoZSBQb2x5Z29uLiBUaGUgUG9seWdvbiBjYW5cbiAqIGJlIGNvbnZleCBvciBjb25jYXZlLiBUaGUgZnVuY3Rpb24gYWNjZXB0cyBhbnkgdmFsaWQgUG9seWdvbiBvciB7QGxpbmsgTXVsdGlQb2x5Z29ufVxuICogYW5kIGFjY291bnRzIGZvciBob2xlcy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvaW5zaWRlXG4gKiBAY2F0ZWdvcnkgam9pbnNcbiAqIEBwYXJhbSB7UG9pbnR9IHBvaW50IGEgUG9pbnQgZmVhdHVyZVxuICogQHBhcmFtIHtQb2x5Z29ufSBwb2x5Z29uIGEgUG9seWdvbiBmZWF0dXJlXG4gKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgdGhlIFBvaW50IGlzIGluc2lkZSB0aGUgUG9seWdvbjsgYGZhbHNlYCBpZiB0aGUgUG9pbnQgaXMgbm90IGluc2lkZSB0aGUgUG9seWdvblxuICogQGV4YW1wbGVcbiAqIHZhciBwdDEgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcIm1hcmtlci1jb2xvclwiOiBcIiNmMDBcIlxuICogICB9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogWy0xMTEuNDY3Mjg1LCA0MC43NTc2Nl1cbiAqICAgfVxuICogfTtcbiAqIHZhciBwdDIgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcIm1hcmtlci1jb2xvclwiOiBcIiMwZjBcIlxuICogICB9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogWy0xMTEuODczNzc5LCA0MC42NDczMDNdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcG9seSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICBbLTExMi4wNzQyNzksIDQwLjUyMjE1XSxcbiAqICAgICAgIFstMTEyLjA3NDI3OSwgNDAuODUzMjkzXSxcbiAqICAgICAgIFstMTExLjYxMDEwNywgNDAuODUzMjkzXSxcbiAqICAgICAgIFstMTExLjYxMDEwNywgNDAuNTIyMTVdLFxuICogICAgICAgWy0xMTIuMDc0Mjc5LCA0MC41MjIxNV1cbiAqICAgICBdXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBmZWF0dXJlcyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbcHQxLCBwdDIsIHBvbHldXG4gKiB9O1xuICpcbiAqIC8vPWZlYXR1cmVzXG4gKlxuICogdmFyIGlzSW5zaWRlMSA9IHR1cmYuaW5zaWRlKHB0MSwgcG9seSk7XG4gKiAvLz1pc0luc2lkZTFcbiAqXG4gKiB2YXIgaXNJbnNpZGUyID0gdHVyZi5pbnNpZGUocHQyLCBwb2x5KTtcbiAqIC8vPWlzSW5zaWRlMlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvaW50LCBwb2x5Z29uKSB7XG4gIHZhciBwb2x5cyA9IHBvbHlnb24uZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIHZhciBwdCA9IFtwb2ludC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSwgcG9pbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV1dO1xuICAvLyBub3JtYWxpemUgdG8gbXVsdGlwb2x5Z29uXG4gIGlmKHBvbHlnb24uZ2VvbWV0cnkudHlwZSA9PT0gJ1BvbHlnb24nKSBwb2x5cyA9IFtwb2x5c107XG5cbiAgdmFyIGluc2lkZVBvbHkgPSBmYWxzZTtcbiAgdmFyIGkgPSAwO1xuICB3aGlsZSAoaSA8IHBvbHlzLmxlbmd0aCAmJiAhaW5zaWRlUG9seSkge1xuICAgIC8vIGNoZWNrIGlmIGl0IGlzIGluIHRoZSBvdXRlciByaW5nIGZpcnN0XG4gICAgaWYoaW5SaW5nKHB0LCBwb2x5c1tpXVswXSkpIHtcbiAgICAgIHZhciBpbkhvbGUgPSBmYWxzZTtcbiAgICAgIHZhciBrID0gMTtcbiAgICAgIC8vIGNoZWNrIGZvciB0aGUgcG9pbnQgaW4gYW55IG9mIHRoZSBob2xlc1xuICAgICAgd2hpbGUoayA8IHBvbHlzW2ldLmxlbmd0aCAmJiAhaW5Ib2xlKSB7XG4gICAgICAgIGlmKGluUmluZyhwdCwgcG9seXNbaV1ba10pKSB7XG4gICAgICAgICAgaW5Ib2xlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBrKys7XG4gICAgICB9XG4gICAgICBpZighaW5Ib2xlKSBpbnNpZGVQb2x5ID0gdHJ1ZTtcbiAgICB9XG4gICAgaSsrO1xuICB9XG4gIHJldHVybiBpbnNpZGVQb2x5O1xufVxuXG4vLyBwdCBpcyBbeCx5XSBhbmQgcmluZyBpcyBbW3gseV0sIFt4LHldLC4uXVxuZnVuY3Rpb24gaW5SaW5nIChwdCwgcmluZykge1xuICB2YXIgaXNJbnNpZGUgPSBmYWxzZTtcbiAgZm9yICh2YXIgaSA9IDAsIGogPSByaW5nLmxlbmd0aCAtIDE7IGkgPCByaW5nLmxlbmd0aDsgaiA9IGkrKykge1xuICAgIHZhciB4aSA9IHJpbmdbaV1bMF0sIHlpID0gcmluZ1tpXVsxXTtcbiAgICB2YXIgeGogPSByaW5nW2pdWzBdLCB5aiA9IHJpbmdbal1bMV07XG4gICAgXG4gICAgdmFyIGludGVyc2VjdCA9ICgoeWkgPiBwdFsxXSkgIT0gKHlqID4gcHRbMV0pKVxuICAgICAgICAmJiAocHRbMF0gPCAoeGogLSB4aSkgKiAocHRbMV0gLSB5aSkgLyAoeWogLSB5aSkgKyB4aSk7XG4gICAgaWYgKGludGVyc2VjdCkgaXNJbnNpZGUgPSAhaXNJbnNpZGU7XG4gIH1cbiAgcmV0dXJuIGlzSW5zaWRlO1xufVxuXG4iLCIvLyBkZXBlbmQgb24ganN0cyBmb3Igbm93IGh0dHBzOi8vZ2l0aHViLmNvbS9iam9ybmhhcnJ0ZWxsL2pzdHMvYmxvYi9tYXN0ZXIvZXhhbXBsZXMvb3ZlcmxheS5odG1sXG52YXIganN0cyA9IHJlcXVpcmUoJ2pzdHMnKTtcbnZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyB0d28ge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGFuZCBmaW5kcyB0aGVpciBpbnRlcnNlY3Rpb24uXG4gKlxuICogQG1vZHVsZSB0dXJmL2ludGVyc2VjdFxuICogQGNhdGVnb3J5IHRyYW5zZm9ybWF0aW9uXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHkxIHRoZSBmaXJzdCBQb2x5Z29uXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHkyIHRoZSBzZWNvbmQgUG9seWdvblxuICogQHJldHVybiB7UG9seWdvbn0gYSBQb2x5Z29uIGZlYXR1cmUgcmVwcmVzZW50aW5nIHRoZSBhcmVhIHdoZXJlIGBwb2x5MWAgYW5kIGBwb2x5MmAgb3ZlcmxhcFxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5MSA9IHR1cmYucG9seWdvbihbW1xuICogIFstMTIyLjgwMTc0MiwgNDUuNDg1NjVdLFxuICogIFstMTIyLjgwMTc0MiwgNDUuNjA0OTFdLFxuICogIFstMTIyLjU4NDc2MiwgNDUuNjA0OTFdLFxuICogIFstMTIyLjU4NDc2MiwgNDUuNDg1NjVdLFxuICogIFstMTIyLjgwMTc0MiwgNDUuNDg1NjVdXG4gKiBdXSk7XG4gKiBwb2x5MS5wcm9wZXJ0aWVzLmZpbGwgPSAnIzBmMCc7XG4gKiB2YXIgcG9seTIgPSB0dXJmLnBvbHlnb24oW1tcbiAqICBbLTEyMi41MjAyMTcsIDQ1LjUzNTY5M10sXG4gKiAgWy0xMjIuNjQwMzgsIDQ1LjU1Mzk2N10sXG4gKiAgWy0xMjIuNzIwMDMxLCA0NS41MjY1NTRdLFxuICogIFstMTIyLjY2OTkwNiwgNDUuNTA3MzA5XSxcbiAqICBbLTEyMi43MjM0NjQsIDQ1LjQ0NjY0M10sXG4gKiAgWy0xMjIuNTMyNTc3LCA0NS40MDg1NzRdLFxuICogIFstMTIyLjQ4NzI1OCwgNDUuNDc3NDY2XSxcbiAqICBbLTEyMi41MjAyMTcsIDQ1LjUzNTY5M11cbiAqIF1dKTtcbiAqIHBvbHkyLnByb3BlcnRpZXMuZmlsbCA9ICcjMDBmJztcbiAqIHZhciBwb2x5Z29ucyA9IHR1cmYuZmVhdHVyZWNvbGxlY3Rpb24oW3BvbHkxLCBwb2x5Ml0pO1xuICpcbiAqIHZhciBpbnRlcnNlY3Rpb24gPSB0dXJmLmludGVyc2VjdChwb2x5MSwgcG9seTIpO1xuICpcbiAqIC8vPXBvbHlnb25zXG4gKlxuICogLy89aW50ZXJzZWN0aW9uXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9seTEsIHBvbHkyKXtcbiAgdmFyIGdlb20xO1xuICBpZihwb2x5MS50eXBlID09PSAnRmVhdHVyZScpIGdlb20xID0gcG9seTEuZ2VvbWV0cnk7XG4gIGVsc2UgZ2VvbTEgPSBwb2x5MTtcbiAgaWYocG9seTIudHlwZSA9PT0gJ0ZlYXR1cmUnKSBnZW9tMiA9IHBvbHkyLmdlb21ldHJ5O1xuICBlbHNlIGdlb20yID0gcG9seTI7XG4gIHZhciByZWFkZXIgPSBuZXcganN0cy5pby5HZW9KU09OUmVhZGVyKCk7XG4gIHZhciBhID0gcmVhZGVyLnJlYWQoSlNPTi5zdHJpbmdpZnkoZ2VvbTEpKTtcbiAgdmFyIGIgPSByZWFkZXIucmVhZChKU09OLnN0cmluZ2lmeShnZW9tMikpO1xuICB2YXIgaW50ZXJzZWN0aW9uID0gYS5pbnRlcnNlY3Rpb24oYik7XG4gIHZhciBwYXJzZXIgPSBuZXcganN0cy5pby5HZW9KU09OUGFyc2VyKCk7XG5cbiAgaW50ZXJzZWN0aW9uID0gcGFyc2VyLndyaXRlKGludGVyc2VjdGlvbik7XG4gIGlmKGludGVyc2VjdGlvbi50eXBlID09PSAnR2VvbWV0cnlDb2xsZWN0aW9uJyAmJiBpbnRlcnNlY3Rpb24uZ2VvbWV0cmllcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgZ2VvbWV0cnk6IGludGVyc2VjdGlvblxuICAgIH07XG4gIH1cbn07XG4iLCIvKlxuICBqYXZhc2NyaXB0LnV0aWwgaXMgYSBwb3J0IG9mIHNlbGVjdGVkIHBhcnRzIG9mIGphdmEudXRpbCB0byBKYXZhU2NyaXB0IHdoaWNoXG4gIG1haW4gcHVycG9zZSBpcyB0byBlYXNlIHBvcnRpbmcgSmF2YSBjb2RlIHRvIEphdmFTY3JpcHQuXG4gIFxuICBUaGUgTUlUIExpY2Vuc2UgKE1JVClcblxuICBDb3B5cmlnaHQgKEMpIDIwMTEtMjAxNCBieSBUaGUgQXV0aG9yc1xuXG4gIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cbiAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAgYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG5cbiAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICBUSEUgU09GVFdBUkUuXG4qL1xuOyhmdW5jdGlvbigpe3ZhciBlPXRoaXM7ZnVuY3Rpb24gZihhLGIpe3ZhciBjPWEuc3BsaXQoXCIuXCIpLGQ9ZTtjWzBdaW4gZHx8IWQuZXhlY1NjcmlwdHx8ZC5leGVjU2NyaXB0KFwidmFyIFwiK2NbMF0pO2Zvcih2YXIgdDtjLmxlbmd0aCYmKHQ9Yy5zaGlmdCgpKTspYy5sZW5ndGh8fHZvaWQgMD09PWI/ZD1kW3RdP2RbdF06ZFt0XT17fTpkW3RdPWJ9ZnVuY3Rpb24gZyhhLGIpe2Z1bmN0aW9uIGMoKXt9Yy5wcm90b3R5cGU9Yi5wcm90b3R5cGU7YS5xPWIucHJvdG90eXBlO2EucHJvdG90eXBlPW5ldyBjO2EucHJvdG90eXBlLmNvbnN0cnVjdG9yPWE7YS5wPWZ1bmN0aW9uKGEsYyxPKXt2YXIgTT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGIucHJvdG90eXBlW2NdLmFwcGx5KGEsTSl9fTtmdW5jdGlvbiBoKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcoaCxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5FbXB0eVN0YWNrRXhjZXB0aW9uXCIsaCk7aC5wcm90b3R5cGUubmFtZT1cIkVtcHR5U3RhY2tFeGNlcHRpb25cIjtmdW5jdGlvbiBrKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcoayxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5JbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXCIsayk7ay5wcm90b3R5cGUubmFtZT1cIkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25cIjtmdW5jdGlvbiBsKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuSXRlcmF0b3JcIixsKTtsLnByb3RvdHlwZS5oYXNOZXh0PWwucHJvdG90eXBlLmM7bC5wcm90b3R5cGUubmV4dD1sLnByb3RvdHlwZS5uZXh0O2wucHJvdG90eXBlLnJlbW92ZT1sLnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gbSgpe31mKFwiamF2YXNjcmlwdC51dGlsLkNvbGxlY3Rpb25cIixtKTtmdW5jdGlvbiBuKCl7fWcobixtKTtmKFwiamF2YXNjcmlwdC51dGlsLkxpc3RcIixuKTtmdW5jdGlvbiBwKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuTWFwXCIscCk7ZnVuY3Rpb24gcShhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKHEsRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuTm9TdWNoRWxlbWVudEV4Y2VwdGlvblwiLHEpO3EucHJvdG90eXBlLm5hbWU9XCJOb1N1Y2hFbGVtZW50RXhjZXB0aW9uXCI7ZnVuY3Rpb24gcihhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKHIsRXJyb3IpO3IucHJvdG90eXBlLm5hbWU9XCJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRcIjtmdW5jdGlvbiBzKGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcocyxuKTtmKFwiamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdFwiLHMpO3MucHJvdG90eXBlLmE9bnVsbDtzLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O3MucHJvdG90eXBlLmFkZD1zLnByb3RvdHlwZS5hZGQ7cy5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTtzLnByb3RvdHlwZS5hZGRBbGw9cy5wcm90b3R5cGUuZTtzLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmFbYV07dGhpcy5hW2FdPWI7cmV0dXJuIGN9O3MucHJvdG90eXBlLnNldD1zLnByb3RvdHlwZS5zZXQ7cy5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgdSh0aGlzKX07cy5wcm90b3R5cGUuaXRlcmF0b3I9cy5wcm90b3R5cGUuZjtcbnMucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtpZigwPmF8fGE+PXRoaXMuc2l6ZSgpKXRocm93IG5ldyBrO3JldHVybiB0aGlzLmFbYV19O3MucHJvdG90eXBlLmdldD1zLnByb3RvdHlwZS5nZXQ7cy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07cy5wcm90b3R5cGUuaXNFbXB0eT1zLnByb3RvdHlwZS5nO3MucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07cy5wcm90b3R5cGUuc2l6ZT1zLnByb3RvdHlwZS5zaXplO3MucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtzLnByb3RvdHlwZS50b0FycmF5PXMucHJvdG90eXBlLmg7XG5zLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPSExLGM9MCxkPXRoaXMuYS5sZW5ndGg7YzxkO2MrKylpZih0aGlzLmFbY109PT1hKXt0aGlzLmEuc3BsaWNlKGMsMSk7Yj0hMDticmVha31yZXR1cm4gYn07cy5wcm90b3R5cGUucmVtb3ZlPXMucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiB1KGEpe3RoaXMuaj1hfWYoXCIkanNjb21wLnNjb3BlLkl0ZXJhdG9yX1wiLHUpO3UucHJvdG90eXBlLmo9bnVsbDt1LnByb3RvdHlwZS5iPTA7dS5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKHRoaXMuYj09PXRoaXMuai5zaXplKCkpdGhyb3cgbmV3IHE7cmV0dXJuIHRoaXMuai5nZXQodGhpcy5iKyspfTt1LnByb3RvdHlwZS5uZXh0PXUucHJvdG90eXBlLm5leHQ7dS5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5qLnNpemUoKT8hMDohMX07dS5wcm90b3R5cGUuaGFzTmV4dD11LnByb3RvdHlwZS5jO1xudS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt1LnByb3RvdHlwZS5yZW1vdmU9dS5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIHYoKXt9ZihcImphdmFzY3JpcHQudXRpbC5BcnJheXNcIix2KTtcbnYuc29ydD1mdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50c1swXSxiLGMsZDtpZigxPT09YXJndW1lbnRzLmxlbmd0aClhLnNvcnQoKTtlbHNlIGlmKDI9PT1hcmd1bWVudHMubGVuZ3RoKWM9YXJndW1lbnRzWzFdLGQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYy5jb21wYXJlKGEsYil9LGEuc29ydChkKTtlbHNlIGlmKDM9PT1hcmd1bWVudHMubGVuZ3RoKWZvcihiPWEuc2xpY2UoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSksYi5zb3J0KCksZD1hLnNsaWNlKDAsYXJndW1lbnRzWzFdKS5jb25jYXQoYixhLnNsaWNlKGFyZ3VtZW50c1syXSxhLmxlbmd0aCkpLGEuc3BsaWNlKDAsYS5sZW5ndGgpLGI9MDtiPGQubGVuZ3RoO2IrKylhLnB1c2goZFtiXSk7ZWxzZSBpZig0PT09YXJndW1lbnRzLmxlbmd0aClmb3IoYj1hLnNsaWNlKGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pLGM9YXJndW1lbnRzWzNdLGQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYy5jb21wYXJlKGEsYil9LGIuc29ydChkKSxcbmQ9YS5zbGljZSgwLGFyZ3VtZW50c1sxXSkuY29uY2F0KGIsYS5zbGljZShhcmd1bWVudHNbMl0sYS5sZW5ndGgpKSxhLnNwbGljZSgwLGEubGVuZ3RoKSxiPTA7YjxkLmxlbmd0aDtiKyspYS5wdXNoKGRbYl0pfTt2LmFzTGlzdD1mdW5jdGlvbihhKXtmb3IodmFyIGI9bmV3IHMsYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyliLmFkZChhW2NdKTtyZXR1cm4gYn07ZnVuY3Rpb24gdygpe3RoaXMuaT17fX1nKHcscCk7ZihcImphdmFzY3JpcHQudXRpbC5IYXNoTWFwXCIsdyk7dy5wcm90b3R5cGUuaT1udWxsO3cucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5pW2FdfHxudWxsfTt3LnByb3RvdHlwZS5nZXQ9dy5wcm90b3R5cGUuZ2V0O3cucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmlbYV09Yn07dy5wcm90b3R5cGUucHV0PXcucHJvdG90eXBlLnB1dDt3LnByb3RvdHlwZS5tPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IHMsYjtmb3IoYiBpbiB0aGlzLmkpdGhpcy5pLmhhc093blByb3BlcnR5KGIpJiZhLmFkZCh0aGlzLmlbYl0pO3JldHVybiBhfTt3LnByb3RvdHlwZS52YWx1ZXM9dy5wcm90b3R5cGUubTt3LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubSgpLnNpemUoKX07dy5wcm90b3R5cGUuc2l6ZT13LnByb3RvdHlwZS5zaXplO2Z1bmN0aW9uIHgoKXt9Zyh4LG0pO2YoXCJqYXZhc2NyaXB0LnV0aWwuU2V0XCIseCk7ZnVuY3Rpb24geShhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKHkseCk7ZihcImphdmFzY3JpcHQudXRpbC5IYXNoU2V0XCIseSk7eS5wcm90b3R5cGUuYT1udWxsO3kucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWlmKHRoaXMuYVtiXT09PWEpcmV0dXJuITA7cmV0dXJuITF9O3kucHJvdG90eXBlLmNvbnRhaW5zPXkucHJvdG90eXBlLmNvbnRhaW5zO3kucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXtpZih0aGlzLmNvbnRhaW5zKGEpKXJldHVybiExO3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTt5LnByb3RvdHlwZS5hZGQ9eS5wcm90b3R5cGUuYWRkO3kucHJvdG90eXBlLmU9ZnVuY3Rpb24oYSl7Zm9yKGE9YS5mKCk7YS5jKCk7KXRoaXMuYWRkKGEubmV4dCgpKTtyZXR1cm4hMH07eS5wcm90b3R5cGUuYWRkQWxsPXkucHJvdG90eXBlLmU7XG55LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3kucHJvdG90eXBlLnJlbW92ZT15LnByb3RvdHlwZS5yZW1vdmU7eS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTt5LnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTt5LnByb3RvdHlwZS5pc0VtcHR5PXkucHJvdG90eXBlLmc7eS5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O3kucHJvdG90eXBlLnRvQXJyYXk9eS5wcm90b3R5cGUuaDt5LnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB6KHRoaXMpfTt5LnByb3RvdHlwZS5pdGVyYXRvcj15LnByb3RvdHlwZS5mO2Z1bmN0aW9uIHooYSl7dGhpcy5rPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfJDFcIix6KTt6LnByb3RvdHlwZS5rPW51bGw7XG56LnByb3RvdHlwZS5iPTA7ei5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKHRoaXMuYj09PXRoaXMuay5zaXplKCkpdGhyb3cgbmV3IHE7cmV0dXJuIHRoaXMuay5hW3RoaXMuYisrXX07ei5wcm90b3R5cGUubmV4dD16LnByb3RvdHlwZS5uZXh0O3oucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMuay5zaXplKCk/ITA6ITF9O3oucHJvdG90eXBlLmhhc05leHQ9ei5wcm90b3R5cGUuYzt6LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3oucHJvdG90eXBlLnJlbW92ZT16LnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gQSgpe31nKEEscCk7ZihcImphdmFzY3JpcHQudXRpbC5Tb3J0ZWRNYXBcIixBKTtmdW5jdGlvbiBCKCl7fWcoQix4KTtmKFwiamF2YXNjcmlwdC51dGlsLlNvcnRlZFNldFwiLEIpO2Z1bmN0aW9uIEMoKXt0aGlzLmE9W119ZyhDLG4pO2YoXCJqYXZhc2NyaXB0LnV0aWwuU3RhY2tcIixDKTtDLnByb3RvdHlwZS5hPW51bGw7Qy5wcm90b3R5cGUucHVzaD1mdW5jdGlvbihhKXt0aGlzLmEucHVzaChhKTtyZXR1cm4gYX07Qy5wcm90b3R5cGUucHVzaD1DLnByb3RvdHlwZS5wdXNoO0MucHJvdG90eXBlLnBvcD1mdW5jdGlvbigpe2lmKDA9PT10aGlzLmEubGVuZ3RoKXRocm93IG5ldyBoO3JldHVybiB0aGlzLmEucG9wKCl9O0MucHJvdG90eXBlLnBvcD1DLnByb3RvdHlwZS5wb3A7Qy5wcm90b3R5cGUubz1mdW5jdGlvbigpe2lmKDA9PT10aGlzLmEubGVuZ3RoKXRocm93IG5ldyBoO3JldHVybiB0aGlzLmFbdGhpcy5hLmxlbmd0aC0xXX07Qy5wcm90b3R5cGUucGVlaz1DLnByb3RvdHlwZS5vO0MucHJvdG90eXBlLmVtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RoPyEwOiExfTtDLnByb3RvdHlwZS5lbXB0eT1DLnByb3RvdHlwZS5lbXB0eTtcbkMucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbXB0eSgpfTtDLnByb3RvdHlwZS5pc0VtcHR5PUMucHJvdG90eXBlLmc7Qy5wcm90b3R5cGUuc2VhcmNoPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmEuaW5kZXhPZihhKX07Qy5wcm90b3R5cGUuc2VhcmNoPUMucHJvdG90eXBlLnNlYXJjaDtDLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O0MucHJvdG90eXBlLnNpemU9Qy5wcm90b3R5cGUuc2l6ZTtDLnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07Qy5wcm90b3R5cGUudG9BcnJheT1DLnByb3RvdHlwZS5oO2Z1bmN0aW9uIEQoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLnBhcmVudH1mdW5jdGlvbiBFKGEsYil7bnVsbCE9PWEmJihhLmNvbG9yPWIpfWZ1bmN0aW9uIEYoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLmxlZnR9ZnVuY3Rpb24gRyhhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEucmlnaHR9ZnVuY3Rpb24gSCgpe3RoaXMuZD1udWxsO3RoaXMubj0wfWcoSCxBKTtmKFwiamF2YXNjcmlwdC51dGlsLlRyZWVNYXBcIixIKTtILnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuZDtudWxsIT09Yjspe3ZhciBjPWEuY29tcGFyZVRvKGIua2V5KTtpZigwPmMpYj1iLmxlZnQ7ZWxzZSBpZigwPGMpYj1iLnJpZ2h0O2Vsc2UgcmV0dXJuIGIudmFsdWV9cmV0dXJuIG51bGx9O0gucHJvdG90eXBlLmdldD1ILnByb3RvdHlwZS5nZXQ7XG5ILnByb3RvdHlwZS5wdXQ9ZnVuY3Rpb24oYSxiKXtpZihudWxsPT09dGhpcy5kKXJldHVybiB0aGlzLmQ9e2tleTphLHZhbHVlOmIsbGVmdDpudWxsLHJpZ2h0Om51bGwscGFyZW50Om51bGwsY29sb3I6MH0sdGhpcy5uPTEsbnVsbDt2YXIgYz10aGlzLmQsZCx0O2RvIGlmKGQ9Yyx0PWEuY29tcGFyZVRvKGMua2V5KSwwPnQpYz1jLmxlZnQ7ZWxzZSBpZigwPHQpYz1jLnJpZ2h0O2Vsc2UgcmV0dXJuIGQ9Yy52YWx1ZSxjLnZhbHVlPWIsZDt3aGlsZShudWxsIT09Yyk7Yz17a2V5OmEsbGVmdDpudWxsLHJpZ2h0Om51bGwsdmFsdWU6YixwYXJlbnQ6ZCxjb2xvcjowfTswPnQ/ZC5sZWZ0PWM6ZC5yaWdodD1jO2ZvcihjLmNvbG9yPTE7bnVsbCE9YyYmYyE9dGhpcy5kJiYxPT1jLnBhcmVudC5jb2xvcjspRChjKT09RihEKEQoYykpKT8oZD1HKEQoRChjKSkpLDE9PShudWxsPT1kPzA6ZC5jb2xvcik/KEUoRChjKSwwKSxFKGQsMCksRShEKEQoYykpLDEpLGM9RChEKGMpKSk6KGM9PUcoRChjKSkmJlxuKGM9RChjKSxJKHRoaXMsYykpLEUoRChjKSwwKSxFKEQoRChjKSksMSksSih0aGlzLEQoRChjKSkpKSk6KGQ9RihEKEQoYykpKSwxPT0obnVsbD09ZD8wOmQuY29sb3IpPyhFKEQoYyksMCksRShkLDApLEUoRChEKGMpKSwxKSxjPUQoRChjKSkpOihjPT1GKEQoYykpJiYoYz1EKGMpLEoodGhpcyxjKSksRShEKGMpLDApLEUoRChEKGMpKSwxKSxJKHRoaXMsRChEKGMpKSkpKTt0aGlzLmQuY29sb3I9MDt0aGlzLm4rKztyZXR1cm4gbnVsbH07SC5wcm90b3R5cGUucHV0PUgucHJvdG90eXBlLnB1dDtILnByb3RvdHlwZS5tPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IHMsYjtiPXRoaXMuZDtpZihudWxsIT1iKWZvcig7bnVsbCE9Yi5sZWZ0OyliPWIubGVmdDtpZihudWxsIT09Yilmb3IoYS5hZGQoYi52YWx1ZSk7bnVsbCE9PShiPUsoYikpOylhLmFkZChiLnZhbHVlKTtyZXR1cm4gYX07SC5wcm90b3R5cGUudmFsdWVzPUgucHJvdG90eXBlLm07XG5mdW5jdGlvbiBJKGEsYil7aWYobnVsbCE9Yil7dmFyIGM9Yi5yaWdodDtiLnJpZ2h0PWMubGVmdDtudWxsIT1jLmxlZnQmJihjLmxlZnQucGFyZW50PWIpO2MucGFyZW50PWIucGFyZW50O251bGw9PWIucGFyZW50P2EuZD1jOmIucGFyZW50LmxlZnQ9PWI/Yi5wYXJlbnQubGVmdD1jOmIucGFyZW50LnJpZ2h0PWM7Yy5sZWZ0PWI7Yi5wYXJlbnQ9Y319ZnVuY3Rpb24gSihhLGIpe2lmKG51bGwhPWIpe3ZhciBjPWIubGVmdDtiLmxlZnQ9Yy5yaWdodDtudWxsIT1jLnJpZ2h0JiYoYy5yaWdodC5wYXJlbnQ9Yik7Yy5wYXJlbnQ9Yi5wYXJlbnQ7bnVsbD09Yi5wYXJlbnQ/YS5kPWM6Yi5wYXJlbnQucmlnaHQ9PWI/Yi5wYXJlbnQucmlnaHQ9YzpiLnBhcmVudC5sZWZ0PWM7Yy5yaWdodD1iO2IucGFyZW50PWN9fVxuZnVuY3Rpb24gSyhhKXtpZihudWxsPT09YSlyZXR1cm4gbnVsbDtpZihudWxsIT09YS5yaWdodClmb3IodmFyIGI9YS5yaWdodDtudWxsIT09Yi5sZWZ0OyliPWIubGVmdDtlbHNlIGZvcihiPWEucGFyZW50O251bGwhPT1iJiZhPT09Yi5yaWdodDspYT1iLGI9Yi5wYXJlbnQ7cmV0dXJuIGJ9SC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm59O0gucHJvdG90eXBlLnNpemU9SC5wcm90b3R5cGUuc2l6ZTtmdW5jdGlvbiBMKGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcoTCxCKTtmKFwiamF2YXNjcmlwdC51dGlsLlRyZWVTZXRcIixMKTtMLnByb3RvdHlwZS5hPW51bGw7TC5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYoMD09PXRoaXMuYVtiXS5jb21wYXJlVG8oYSkpcmV0dXJuITA7cmV0dXJuITF9O0wucHJvdG90eXBlLmNvbnRhaW5zPUwucHJvdG90eXBlLmNvbnRhaW5zO0wucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXtpZih0aGlzLmNvbnRhaW5zKGEpKXJldHVybiExO2Zvcih2YXIgYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWlmKDE9PT10aGlzLmFbYl0uY29tcGFyZVRvKGEpKXJldHVybiB0aGlzLmEuc3BsaWNlKGIsMCxhKSwhMDt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07TC5wcm90b3R5cGUuYWRkPUwucHJvdG90eXBlLmFkZDtcbkwucHJvdG90eXBlLmU9ZnVuY3Rpb24oYSl7Zm9yKGE9YS5mKCk7YS5jKCk7KXRoaXMuYWRkKGEubmV4dCgpKTtyZXR1cm4hMH07TC5wcm90b3R5cGUuYWRkQWxsPUwucHJvdG90eXBlLmU7TC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTtMLnByb3RvdHlwZS5yZW1vdmU9TC5wcm90b3R5cGUucmVtb3ZlO0wucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07TC5wcm90b3R5cGUuc2l6ZT1MLnByb3RvdHlwZS5zaXplO0wucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O0wucHJvdG90eXBlLmlzRW1wdHk9TC5wcm90b3R5cGUuZztMLnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07TC5wcm90b3R5cGUudG9BcnJheT1MLnByb3RvdHlwZS5oO0wucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IE4odGhpcyl9O1xuTC5wcm90b3R5cGUuaXRlcmF0b3I9TC5wcm90b3R5cGUuZjtmdW5jdGlvbiBOKGEpe3RoaXMubD1hfWYoXCIkanNjb21wLnNjb3BlLkl0ZXJhdG9yXyQyXCIsTik7Ti5wcm90b3R5cGUubD1udWxsO04ucHJvdG90eXBlLmI9MDtOLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5sLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5sLmFbdGhpcy5iKytdfTtOLnByb3RvdHlwZS5uZXh0PU4ucHJvdG90eXBlLm5leHQ7Ti5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5sLnNpemUoKT8hMDohMX07Ti5wcm90b3R5cGUuaGFzTmV4dD1OLnByb3RvdHlwZS5jO04ucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307Ti5wcm90b3R5cGUucmVtb3ZlPU4ucHJvdG90eXBlLnJlbW92ZTtcInVuZGVmaW5lZFwiIT09dHlwZW9mIGdsb2JhbCYmKGdsb2JhbC5qYXZhc2NyaXB0PXt9LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWw9e30sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q9cyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkFycmF5cz12LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQ29sbGVjdGlvbj1tLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuRW1wdHlTdGFja0V4Y2VwdGlvbj1oLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSGFzaE1hcD13LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSGFzaFNldD15LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbj1rLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSXRlcmF0b3I9bCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkxpc3Q9bixnbG9iYWwuamF2YXNjcmlwdC51dGlsLk1hcD1wLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTm9TdWNoRWxlbWVudEV4Y2VwdGlvbj1xLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuT3BlcmF0aW9uTm90U3VwcG9ydGVkPVxucixnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNldD14LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU29ydGVkTWFwPUEsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Tb3J0ZWRTZXQ9QixnbG9iYWwuamF2YXNjcmlwdC51dGlsLlN0YWNrPUMsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5UcmVlTWFwPUgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5UcmVlU2V0PUwpO30pLmNhbGwodGhpcyk7XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxMCwgSmFzb24gRGF2aWVzLlxuICpcbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuICBUaGlzIGNvZGUgaXMgYmFzZWQgb24gQnJhZGxleSBXaGl0ZSdzIEphdmEgdmVyc2lvbixcbiAqIHdoaWNoIGlzIGluIHR1cm4gYmFzZWQgb24gTmljaG9sYXMgWXVlJ3MgQysrIHZlcnNpb24sIHdoaWNoIGluIHR1cm4gaXMgYmFzZWRcbiAqIG9uIFBhdWwgRC4gQm91cmtlJ3Mgb3JpZ2luYWwgRm9ydHJhbiB2ZXJzaW9uLiAgU2VlIGJlbG93IGZvciB0aGUgcmVzcGVjdGl2ZVxuICogY29weXJpZ2h0IG5vdGljZXMuXG4gKlxuICogU2VlIGh0dHA6Ly9sb2NhbC53YXNwLnV3YS5lZHUuYXUvfnBib3Vya2UvcGFwZXJzL2NvbnJlYy8gZm9yIHRoZSBvcmlnaW5hbFxuICogcGFwZXIgYnkgUGF1bCBELiBCb3Vya2UuXG4gKlxuICogVGhlIHZlY3RvciBjb252ZXJzaW9uIGNvZGUgaXMgYmFzZWQgb24gaHR0cDovL2FwcHRyZWUubmV0L2NvbnJlYy5odG0gYnlcbiAqIEdyYWhhbSBDb3guXG4gKlxuICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0XG4gKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAgICAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodFxuICogICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZVxuICogICAgICAgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqICAgICAqIE5laXRoZXIgdGhlIG5hbWUgb2YgdGhlIDxvcmdhbml6YXRpb24+IG5vciB0aGVcbiAqICAgICAgIG5hbWVzIG9mIGl0cyBjb250cmlidXRvcnMgbWF5IGJlIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzXG4gKiAgICAgICBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0IHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbiAqXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIlxuICogQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuICogSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0VcbiAqIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCA8Q09QWVJJR0hUIEhPTERFUj4gQkUgTElBQkxFIEZPUiBBTllcbiAqIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4gKiAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7XG4gKiBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkRcbiAqIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4gKiAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0ZcbiAqIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMTk5Ni0xOTk3IE5pY2hvbGFzIFl1ZVxuICpcbiAqIFRoaXMgc29mdHdhcmUgaXMgY29weXJpZ2h0ZWQgYnkgTmljaG9sYXMgWXVlLiBUaGlzIGNvZGUgaXMgYmFzZWQgb24gUGF1bCBELlxuICogQm91cmtlJ3MgQ09OUkVDLkYgcm91dGluZS5cbiAqXG4gKiBUaGUgYXV0aG9ycyBoZXJlYnkgZ3JhbnQgcGVybWlzc2lvbiB0byB1c2UsIGNvcHksIGFuZCBkaXN0cmlidXRlIHRoaXNcbiAqIHNvZnR3YXJlIGFuZCBpdHMgZG9jdW1lbnRhdGlvbiBmb3IgYW55IHB1cnBvc2UsIHByb3ZpZGVkIHRoYXQgZXhpc3RpbmdcbiAqIGNvcHlyaWdodCBub3RpY2VzIGFyZSByZXRhaW5lZCBpbiBhbGwgY29waWVzIGFuZCB0aGF0IHRoaXMgbm90aWNlIGlzXG4gKiBpbmNsdWRlZCB2ZXJiYXRpbSBpbiBhbnkgZGlzdHJpYnV0aW9ucy4gQWRkaXRpb25hbGx5LCB0aGUgYXV0aG9ycyBncmFudFxuICogcGVybWlzc2lvbiB0byBtb2RpZnkgdGhpcyBzb2Z0d2FyZSBhbmQgaXRzIGRvY3VtZW50YXRpb24gZm9yIGFueSBwdXJwb3NlLFxuICogcHJvdmlkZWQgdGhhdCBzdWNoIG1vZGlmaWNhdGlvbnMgYXJlIG5vdCBkaXN0cmlidXRlZCB3aXRob3V0IHRoZSBleHBsaWNpdFxuICogY29uc2VudCBvZiB0aGUgYXV0aG9ycyBhbmQgdGhhdCBleGlzdGluZyBjb3B5cmlnaHQgbm90aWNlcyBhcmUgcmV0YWluZWQgaW5cbiAqIGFsbCBjb3BpZXMuIFNvbWUgb2YgdGhlIGFsZ29yaXRobXMgaW1wbGVtZW50ZWQgYnkgdGhpcyBzb2Z0d2FyZSBhcmVcbiAqIHBhdGVudGVkLCBvYnNlcnZlIGFsbCBhcHBsaWNhYmxlIHBhdGVudCBsYXcuXG4gKlxuICogSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgRElTVFJJQlVUT1JTIEJFIExJQUJMRSBUTyBBTlkgUEFSVFkgRk9SXG4gKiBESVJFQ1QsIElORElSRUNULCBTUEVDSUFMLCBJTkNJREVOVEFMLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgQVJJU0lORyBPVVRcbiAqIE9GIFRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgSVRTIERPQ1VNRU5UQVRJT04sIE9SIEFOWSBERVJJVkFUSVZFUyBUSEVSRU9GLFxuICogRVZFTiBJRiBUSEUgQVVUSE9SUyBIQVZFIEJFRU4gQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKlxuICogVEhFIEFVVEhPUlMgQU5EIERJU1RSSUJVVE9SUyBTUEVDSUZJQ0FMTFkgRElTQ0xBSU0gQU5ZIFdBUlJBTlRJRVMsXG4gKiBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSwgQU5EIE5PTi1JTkZSSU5HRU1FTlQuICBUSElTIFNPRlRXQVJFIElTXG4gKiBQUk9WSURFRCBPTiBBTiBcIkFTIElTXCIgQkFTSVMsIEFORCBUSEUgQVVUSE9SUyBBTkQgRElTVFJJQlVUT1JTIEhBVkUgTk9cbiAqIE9CTElHQVRJT04gVE8gUFJPVklERSBNQUlOVEVOQU5DRSwgU1VQUE9SVCwgVVBEQVRFUywgRU5IQU5DRU1FTlRTLCBPUlxuICogTU9ESUZJQ0FUSU9OUy5cbiAqL1xuXG5cbiAgbW9kdWxlLmV4cG9ydHMgPSBDb25yZWM7XG5cbiAgdmFyIEVQU0lMT04gPSAxZS0xMDtcblxuICBmdW5jdGlvbiBwb2ludHNFcXVhbChhLCBiKSB7XG4gICAgdmFyIHggPSBhLnggLSBiLngsIHkgPSBhLnkgLSBiLnk7XG4gICAgcmV0dXJuIHggKiB4ICsgeSAqIHkgPCBFUFNJTE9OO1xuICB9XG5cbiAgZnVuY3Rpb24gcmV2ZXJzZUxpc3QobGlzdCkge1xuICAgIHZhciBwcCA9IGxpc3QuaGVhZDtcblxuICAgIHdoaWxlIChwcCkge1xuICAgICAgLy8gc3dhcCBwcmV2L25leHQgcG9pbnRlcnNcbiAgICAgIHZhciB0ZW1wID0gcHAubmV4dDtcbiAgICAgIHBwLm5leHQgPSBwcC5wcmV2O1xuICAgICAgcHAucHJldiA9IHRlbXA7XG5cbiAgICAgIC8vIGNvbnRpbnVlIHRocm91Z2ggdGhlIGxpc3RcbiAgICAgIHBwID0gdGVtcDtcbiAgICB9XG5cbiAgICAvLyBzd2FwIGhlYWQvdGFpbCBwb2ludGVyc1xuICAgIHZhciB0ZW1wID0gbGlzdC5oZWFkO1xuICAgIGxpc3QuaGVhZCA9IGxpc3QudGFpbDtcbiAgICBsaXN0LnRhaWwgPSB0ZW1wO1xuICB9XG5cbiAgZnVuY3Rpb24gQ29udG91ckJ1aWxkZXIobGV2ZWwpIHtcbiAgICB0aGlzLmxldmVsID0gbGV2ZWw7XG4gICAgdGhpcy5zID0gbnVsbDtcbiAgICB0aGlzLmNvdW50ID0gMDtcbiAgfVxuICBDb250b3VyQnVpbGRlci5wcm90b3R5cGUucmVtb3ZlX3NlcSA9IGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAvLyBpZiBsaXN0IGlzIHRoZSBmaXJzdCBpdGVtLCBzdGF0aWMgcHRyIHMgaXMgdXBkYXRlZFxuICAgIGlmIChsaXN0LnByZXYpIHtcbiAgICAgIGxpc3QucHJldi5uZXh0ID0gbGlzdC5uZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnMgPSBsaXN0Lm5leHQ7XG4gICAgfVxuXG4gICAgaWYgKGxpc3QubmV4dCkge1xuICAgICAgbGlzdC5uZXh0LnByZXYgPSBsaXN0LnByZXY7XG4gICAgfVxuICAgIC0tdGhpcy5jb3VudDtcbiAgfVxuICBDb250b3VyQnVpbGRlci5wcm90b3R5cGUuYWRkU2VnbWVudCA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICB2YXIgc3MgPSB0aGlzLnM7XG4gICAgdmFyIG1hID0gbnVsbDtcbiAgICB2YXIgbWIgPSBudWxsO1xuICAgIHZhciBwcmVwZW5kQSA9IGZhbHNlO1xuICAgIHZhciBwcmVwZW5kQiA9IGZhbHNlO1xuXG4gICAgd2hpbGUgKHNzKSB7XG4gICAgICBpZiAobWEgPT0gbnVsbCkge1xuICAgICAgICAvLyBubyBtYXRjaCBmb3IgYSB5ZXRcbiAgICAgICAgaWYgKHBvaW50c0VxdWFsKGEsIHNzLmhlYWQucCkpIHtcbiAgICAgICAgICBtYSA9IHNzO1xuICAgICAgICAgIHByZXBlbmRBID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChwb2ludHNFcXVhbChhLCBzcy50YWlsLnApKSB7XG4gICAgICAgICAgbWEgPSBzcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG1iID09IG51bGwpIHtcbiAgICAgICAgLy8gbm8gbWF0Y2ggZm9yIGIgeWV0XG4gICAgICAgIGlmIChwb2ludHNFcXVhbChiLCBzcy5oZWFkLnApKSB7XG4gICAgICAgICAgbWIgPSBzcztcbiAgICAgICAgICBwcmVwZW5kQiA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocG9pbnRzRXF1YWwoYiwgc3MudGFpbC5wKSkge1xuICAgICAgICAgIG1iID0gc3M7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIGlmIHdlIG1hdGNoZWQgYm90aCBubyBuZWVkIHRvIGNvbnRpbnVlIHNlYXJjaGluZ1xuICAgICAgaWYgKG1iICE9IG51bGwgJiYgbWEgIT0gbnVsbCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNzID0gc3MubmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjIGlzIHRoZSBjYXNlIHNlbGVjdG9yIGJhc2VkIG9uIHdoaWNoIG9mIG1hIGFuZC9vciBtYiBhcmUgc2V0XG4gICAgdmFyIGMgPSAoKG1hICE9IG51bGwpID8gMSA6IDApIHwgKChtYiAhPSBudWxsKSA/IDIgOiAwKTtcblxuICAgIHN3aXRjaChjKSB7XG4gICAgICBjYXNlIDA6ICAgLy8gYm90aCB1bm1hdGNoZWQsIGFkZCBhcyBuZXcgc2VxdWVuY2VcbiAgICAgICAgdmFyIGFhID0ge3A6IGEsIHByZXY6IG51bGx9O1xuICAgICAgICB2YXIgYmIgPSB7cDogYiwgbmV4dDogbnVsbH07XG4gICAgICAgIGFhLm5leHQgPSBiYjtcbiAgICAgICAgYmIucHJldiA9IGFhO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBzZXF1ZW5jZSBlbGVtZW50IGFuZCBwdXNoIG9udG8gaGVhZCBvZiBtYWluIGxpc3QuIFRoZSBvcmRlclxuICAgICAgICAvLyBvZiBpdGVtcyBpbiB0aGlzIGxpc3QgaXMgdW5pbXBvcnRhbnRcbiAgICAgICAgbWEgPSB7aGVhZDogYWEsIHRhaWw6IGJiLCBuZXh0OiB0aGlzLnMsIHByZXY6IG51bGwsIGNsb3NlZDogZmFsc2V9O1xuICAgICAgICBpZiAodGhpcy5zKSB7XG4gICAgICAgICAgdGhpcy5zLnByZXYgPSBtYTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnMgPSBtYTtcblxuICAgICAgICArK3RoaXMuY291bnQ7ICAgIC8vIG5vdCBlc3NlbnRpYWwgLSB0cmFja3MgbnVtYmVyIG9mIHVubWVyZ2VkIHNlcXVlbmNlc1xuICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgMTogICAvLyBhIG1hdGNoZWQsIGIgZGlkIG5vdCAtIHRodXMgYiBleHRlbmRzIHNlcXVlbmNlIG1hXG4gICAgICAgIHZhciBwcCA9IHtwOiBifTtcblxuICAgICAgICBpZiAocHJlcGVuZEEpIHtcbiAgICAgICAgICBwcC5uZXh0ID0gbWEuaGVhZDtcbiAgICAgICAgICBwcC5wcmV2ID0gbnVsbDtcbiAgICAgICAgICBtYS5oZWFkLnByZXYgPSBwcDtcbiAgICAgICAgICBtYS5oZWFkID0gcHA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHAubmV4dCA9IG51bGw7XG4gICAgICAgICAgcHAucHJldiA9IG1hLnRhaWw7XG4gICAgICAgICAgbWEudGFpbC5uZXh0ID0gcHA7XG4gICAgICAgICAgbWEudGFpbCA9IHBwO1xuICAgICAgICB9XG4gICAgICBicmVhaztcblxuICAgICAgY2FzZSAyOiAgIC8vIGIgbWF0Y2hlZCwgYSBkaWQgbm90IC0gdGh1cyBhIGV4dGVuZHMgc2VxdWVuY2UgbWJcbiAgICAgICAgdmFyIHBwID0ge3A6IGF9O1xuXG4gICAgICAgIGlmIChwcmVwZW5kQikge1xuICAgICAgICAgIHBwLm5leHQgPSBtYi5oZWFkO1xuICAgICAgICAgIHBwLnByZXYgPSBudWxsO1xuICAgICAgICAgIG1iLmhlYWQucHJldiA9IHBwO1xuICAgICAgICAgIG1iLmhlYWQgPSBwcDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwcC5uZXh0ID0gbnVsbDtcbiAgICAgICAgICBwcC5wcmV2ID0gbWIudGFpbDtcbiAgICAgICAgICBtYi50YWlsLm5leHQgPSBwcDtcbiAgICAgICAgICBtYi50YWlsID0gcHA7XG4gICAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIDM6ICAgLy8gYm90aCBtYXRjaGVkLCBjYW4gbWVyZ2Ugc2VxdWVuY2VzXG4gICAgICAgIC8vIGlmIHRoZSBzZXF1ZW5jZXMgYXJlIHRoZSBzYW1lLCBkbyBub3RoaW5nLCBhcyB3ZSBhcmUgc2ltcGx5IGNsb3NpbmcgdGhpcyBwYXRoIChjb3VsZCBzZXQgYSBmbGFnKVxuXG4gICAgICAgIGlmIChtYSA9PT0gbWIpIHtcbiAgICAgICAgICB2YXIgcHAgPSB7cDogbWEudGFpbC5wLCBuZXh0OiBtYS5oZWFkLCBwcmV2OiBudWxsfTtcbiAgICAgICAgICBtYS5oZWFkLnByZXYgPSBwcDtcbiAgICAgICAgICBtYS5oZWFkID0gcHA7XG4gICAgICAgICAgbWEuY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoZXJlIGFyZSA0IHdheXMgdGhlIHNlcXVlbmNlIHBhaXIgY2FuIGJlIGpvaW5lZC4gVGhlIGN1cnJlbnQgc2V0dGluZyBvZiBwcmVwZW5kQSBhbmRcbiAgICAgICAgLy8gcHJlcGVuZEIgd2lsbCB0ZWxsIHVzIHdoaWNoIHR5cGUgb2Ygam9pbiBpcyBuZWVkZWQuIEZvciBoZWFkL2hlYWQgYW5kIHRhaWwvdGFpbCBqb2luc1xuICAgICAgICAvLyBvbmUgc2VxdWVuY2UgbmVlZHMgdG8gYmUgcmV2ZXJzZWRcbiAgICAgICAgc3dpdGNoKChwcmVwZW5kQSA/IDEgOiAwKSB8IChwcmVwZW5kQiA/IDIgOiAwKSkge1xuICAgICAgICAgIGNhc2UgMDogICAvLyB0YWlsLXRhaWxcbiAgICAgICAgICAgIC8vIHJldmVyc2UgbWEgYW5kIGFwcGVuZCB0byBtYlxuICAgICAgICAgICAgcmV2ZXJzZUxpc3QobWEpO1xuICAgICAgICAgICAgLy8gZmFsbCB0aHJvdWdoIHRvIGhlYWQvdGFpbCBjYXNlXG4gICAgICAgICAgY2FzZSAxOiAgIC8vIGhlYWQtdGFpbFxuICAgICAgICAgICAgLy8gbWEgaXMgYXBwZW5kZWQgdG8gbWIgYW5kIG1hIGRpc2NhcmRlZFxuICAgICAgICAgICAgbWIudGFpbC5uZXh0ID0gbWEuaGVhZDtcbiAgICAgICAgICAgIG1hLmhlYWQucHJldiA9IG1iLnRhaWw7XG4gICAgICAgICAgICBtYi50YWlsID0gbWEudGFpbDtcblxuICAgICAgICAgICAgLy9kaXNjYXJkIG1hIHNlcXVlbmNlIHJlY29yZFxuICAgICAgICAgICAgdGhpcy5yZW1vdmVfc2VxKG1hKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgMzogICAvLyBoZWFkLWhlYWRcbiAgICAgICAgICAgIC8vIHJldmVyc2UgbWEgYW5kIGFwcGVuZCBtYiB0byBpdFxuICAgICAgICAgICAgcmV2ZXJzZUxpc3QobWEpO1xuICAgICAgICAgICAgLy8gZmFsbCB0aHJvdWdoIHRvIHRhaWwvaGVhZCBjYXNlXG4gICAgICAgICAgY2FzZSAyOiAgIC8vIHRhaWwtaGVhZFxuICAgICAgICAgICAgLy8gbWIgaXMgYXBwZW5kZWQgdG8gbWEgYW5kIG1iIGlzIGRpc2NhcmRlZFxuICAgICAgICAgICAgbWEudGFpbC5uZXh0ID0gbWIuaGVhZDtcbiAgICAgICAgICAgIG1iLmhlYWQucHJldiA9IG1hLnRhaWw7XG4gICAgICAgICAgICBtYS50YWlsID0gbWIudGFpbDtcblxuICAgICAgICAgICAgLy9kaXNjYXJkIG1iIHNlcXVlbmNlIHJlY29yZFxuICAgICAgICAgICAgdGhpcy5yZW1vdmVfc2VxKG1iKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEltcGxlbWVudHMgQ09OUkVDLlxuICAgKlxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBkcmF3Q29udG91ciBmdW5jdGlvbiBmb3IgZHJhd2luZyBjb250b3VyLiAgRGVmYXVsdHMgdG8gYVxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b20gXCJjb250b3VyIGJ1aWxkZXJcIiwgd2hpY2ggcG9wdWxhdGVzIHRoZVxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250b3VycyBwcm9wZXJ0eS5cbiAgICovXG4gIGZ1bmN0aW9uIENvbnJlYyhkcmF3Q29udG91cikge1xuICAgIGlmICghZHJhd0NvbnRvdXIpIHtcbiAgICAgIHZhciBjID0gdGhpcztcbiAgICAgIGMuY29udG91cnMgPSB7fTtcbiAgICAgIC8qKlxuICAgICAgICogZHJhd0NvbnRvdXIgLSBpbnRlcmZhY2UgZm9yIGltcGxlbWVudGluZyB0aGUgdXNlciBzdXBwbGllZCBtZXRob2QgdG9cbiAgICAgICAqIHJlbmRlciB0aGUgY291bnRvdXJzLlxuICAgICAgICpcbiAgICAgICAqIERyYXdzIGEgbGluZSBiZXR3ZWVuIHRoZSBzdGFydCBhbmQgZW5kIGNvb3JkaW5hdGVzLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSBzdGFydFggICAgLSBzdGFydCBjb29yZGluYXRlIGZvciBYXG4gICAgICAgKiBAcGFyYW0gc3RhcnRZICAgIC0gc3RhcnQgY29vcmRpbmF0ZSBmb3IgWVxuICAgICAgICogQHBhcmFtIGVuZFggICAgICAtIGVuZCBjb29yZGluYXRlIGZvciBYXG4gICAgICAgKiBAcGFyYW0gZW5kWSAgICAgIC0gZW5kIGNvb3JkaW5hdGUgZm9yIFlcbiAgICAgICAqIEBwYXJhbSBjb250b3VyTGV2ZWwgLSBDb250b3VyIGxldmVsIGZvciBsaW5lLlxuICAgICAgICovXG4gICAgICB0aGlzLmRyYXdDb250b3VyID0gZnVuY3Rpb24oc3RhcnRYLCBzdGFydFksIGVuZFgsIGVuZFksIGNvbnRvdXJMZXZlbCwgaykge1xuICAgICAgICB2YXIgY2IgPSBjLmNvbnRvdXJzW2tdO1xuICAgICAgICBpZiAoIWNiKSB7XG4gICAgICAgICAgY2IgPSBjLmNvbnRvdXJzW2tdID0gbmV3IENvbnRvdXJCdWlsZGVyKGNvbnRvdXJMZXZlbCk7XG4gICAgICAgIH1cbiAgICAgICAgY2IuYWRkU2VnbWVudCh7eDogc3RhcnRYLCB5OiBzdGFydFl9LCB7eDogZW5kWCwgeTogZW5kWX0pO1xuICAgICAgfVxuICAgICAgdGhpcy5jb250b3VyTGlzdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbCA9IFtdO1xuICAgICAgICB2YXIgYSA9IGMuY29udG91cnM7XG4gICAgICAgIGZvciAodmFyIGsgaW4gYSkge1xuICAgICAgICAgIHZhciBzID0gYVtrXS5zO1xuICAgICAgICAgIHZhciBsZXZlbCA9IGFba10ubGV2ZWw7XG4gICAgICAgICAgd2hpbGUgKHMpIHtcbiAgICAgICAgICAgIHZhciBoID0gcy5oZWFkO1xuICAgICAgICAgICAgdmFyIGwyID0gW107XG4gICAgICAgICAgICBsMi5sZXZlbCA9IGxldmVsO1xuICAgICAgICAgICAgbDIuayA9IGs7XG4gICAgICAgICAgICB3aGlsZSAoaCAmJiBoLnApIHtcbiAgICAgICAgICAgICAgbDIucHVzaChoLnApO1xuICAgICAgICAgICAgICBoID0gaC5uZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbC5wdXNoKGwyKTtcbiAgICAgICAgICAgIHMgPSBzLm5leHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGwuc29ydChmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhLmsgLSBiLmsgfSk7XG4gICAgICAgIHJldHVybiBsO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRyYXdDb250b3VyID0gZHJhd0NvbnRvdXI7XG4gICAgfVxuICAgIHRoaXMuaCAgPSBuZXcgQXJyYXkoNSk7XG4gICAgdGhpcy5zaCA9IG5ldyBBcnJheSg1KTtcbiAgICB0aGlzLnhoID0gbmV3IEFycmF5KDUpO1xuICAgIHRoaXMueWggPSBuZXcgQXJyYXkoNSk7XG4gIH1cblxuICAvKipcbiAgICogY29udG91ciBpcyBhIGNvbnRvdXJpbmcgc3Vicm91dGluZSBmb3IgcmVjdGFuZ3VsYXJpbHkgc3BhY2VkIGRhdGFcbiAgICpcbiAgICogSXQgZW1pdHMgY2FsbHMgdG8gYSBsaW5lIGRyYXdpbmcgc3Vicm91dGluZSBzdXBwbGllZCBieSB0aGUgdXNlciB3aGljaFxuICAgKiBkcmF3cyBhIGNvbnRvdXIgbWFwIGNvcnJlc3BvbmRpbmcgdG8gcmVhbCo0ZGF0YSBvbiBhIHJhbmRvbWx5IHNwYWNlZFxuICAgKiByZWN0YW5ndWxhciBncmlkLiBUaGUgY29vcmRpbmF0ZXMgZW1pdHRlZCBhcmUgaW4gdGhlIHNhbWUgdW5pdHMgZ2l2ZW4gaW5cbiAgICogdGhlIHgoKSBhbmQgeSgpIGFycmF5cy5cbiAgICpcbiAgICogQW55IG51bWJlciBvZiBjb250b3VyIGxldmVscyBtYXkgYmUgc3BlY2lmaWVkIGJ1dCB0aGV5IG11c3QgYmUgaW4gb3JkZXIgb2ZcbiAgICogaW5jcmVhc2luZyB2YWx1ZS5cbiAgICpcbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJbXVtdfSBkIC0gbWF0cml4IG9mIGRhdGEgdG8gY29udG91clxuICAgKiBAcGFyYW0ge251bWJlcn0gaWxiLGl1YixqbGIsanViIC0gaW5kZXggYm91bmRzIG9mIGRhdGEgbWF0cml4XG4gICAqXG4gICAqICAgICAgICAgICAgIFRoZSBmb2xsb3dpbmcgdHdvLCBvbmUgZGltZW5zaW9uYWwgYXJyYXlzICh4IGFuZCB5KSBjb250YWluXG4gICAqICAgICAgICAgICAgIHRoZSBob3Jpem9udGFsIGFuZCB2ZXJ0aWNhbCBjb29yZGluYXRlcyBvZiBlYWNoIHNhbXBsZSBwb2ludHMuXG4gICAqIEBwYXJhbSB7bnVtYmVyW119IHggIC0gZGF0YSBtYXRyaXggY29sdW1uIGNvb3JkaW5hdGVzXG4gICAqIEBwYXJhbSB7bnVtYmVyW119IHkgIC0gZGF0YSBtYXRyaXggcm93IGNvb3JkaW5hdGVzXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBuYyAgIC0gbnVtYmVyIG9mIGNvbnRvdXIgbGV2ZWxzXG4gICAqIEBwYXJhbSB7bnVtYmVyW119IHogIC0gY29udG91ciBsZXZlbHMgaW4gaW5jcmVhc2luZyBvcmRlci5cbiAgICovXG4gIENvbnJlYy5wcm90b3R5cGUuY29udG91ciA9IGZ1bmN0aW9uKGQsIGlsYiwgaXViLCBqbGIsIGp1YiwgeCwgeSwgbmMsIHopIHtcbiAgICB2YXIgaCA9IHRoaXMuaCwgc2ggPSB0aGlzLnNoLCB4aCA9IHRoaXMueGgsIHloID0gdGhpcy55aDtcbiAgICB2YXIgZHJhd0NvbnRvdXIgPSB0aGlzLmRyYXdDb250b3VyO1xuICAgIHRoaXMuY29udG91cnMgPSB7fTtcblxuICAgIC8qKiBwcml2YXRlICovXG4gICAgdmFyIHhzZWN0ID0gZnVuY3Rpb24ocDEsIHAyKXtcbiAgICAgIHJldHVybiAoaFtwMl0qeGhbcDFdLWhbcDFdKnhoW3AyXSkvKGhbcDJdLWhbcDFdKTtcbiAgICB9XG5cbiAgICB2YXIgeXNlY3QgPSBmdW5jdGlvbihwMSwgcDIpe1xuICAgICAgcmV0dXJuIChoW3AyXSp5aFtwMV0taFtwMV0qeWhbcDJdKS8oaFtwMl0taFtwMV0pO1xuICAgIH1cbiAgICB2YXIgbTE7XG4gICAgdmFyIG0yO1xuICAgIHZhciBtMztcbiAgICB2YXIgY2FzZV92YWx1ZTtcbiAgICB2YXIgZG1pbjtcbiAgICB2YXIgZG1heDtcbiAgICB2YXIgeDEgPSAwLjA7XG4gICAgdmFyIHgyID0gMC4wO1xuICAgIHZhciB5MSA9IDAuMDtcbiAgICB2YXIgeTIgPSAwLjA7XG5cbiAgICAvLyBUaGUgaW5kZXhpbmcgb2YgaW0gYW5kIGptIHNob3VsZCBiZSBub3RlZCBhcyBpdCBoYXMgdG8gc3RhcnQgZnJvbSB6ZXJvXG4gICAgLy8gdW5saWtlIHRoZSBmb3J0cmFuIGNvdW50ZXIgcGFydFxuICAgIHZhciBpbSA9IFswLCAxLCAxLCAwXTtcbiAgICB2YXIgam0gPSBbMCwgMCwgMSwgMV07XG5cbiAgICAvLyBOb3RlIHRoYXQgY2FzdGFiIGlzIGFycmFuZ2VkIGRpZmZlcmVudGx5IGZyb20gdGhlIEZPUlRSQU4gY29kZSBiZWNhdXNlXG4gICAgLy8gRm9ydHJhbiBhbmQgQy9DKysgYXJyYXlzIGFyZSB0cmFuc3Bvc2VkIG9mIGVhY2ggb3RoZXIsIGluIHRoaXMgY2FzZVxuICAgIC8vIGl0IGlzIG1vcmUgdHJpY2t5IGFzIGNhc3RhYiBpcyBpbiAzIGRpbWVuc2lvbnNcbiAgICB2YXIgY2FzdGFiID0gW1xuICAgICAgW1xuICAgICAgICBbMCwgMCwgOF0sIFswLCAyLCA1XSwgWzcsIDYsIDldXG4gICAgICBdLFxuICAgICAgW1xuICAgICAgICBbMCwgMywgNF0sIFsxLCAzLCAxXSwgWzQsIDMsIDBdXG4gICAgICBdLFxuICAgICAgW1xuICAgICAgICBbOSwgNiwgN10sIFs1LCAyLCAwXSwgWzgsIDAsIDBdXG4gICAgICBdXG4gICAgXTtcblxuICAgIGZvciAodmFyIGo9KGp1Yi0xKTtqPj1qbGI7ai0tKSB7XG4gICAgICBmb3IgKHZhciBpPWlsYjtpPD1pdWItMTtpKyspIHtcbiAgICAgICAgdmFyIHRlbXAxLCB0ZW1wMjtcbiAgICAgICAgdGVtcDEgPSBNYXRoLm1pbihkW2ldW2pdLGRbaV1baisxXSk7XG4gICAgICAgIHRlbXAyID0gTWF0aC5taW4oZFtpKzFdW2pdLGRbaSsxXVtqKzFdKTtcbiAgICAgICAgZG1pbiAgPSBNYXRoLm1pbih0ZW1wMSx0ZW1wMik7XG4gICAgICAgIHRlbXAxID0gTWF0aC5tYXgoZFtpXVtqXSxkW2ldW2orMV0pO1xuICAgICAgICB0ZW1wMiA9IE1hdGgubWF4KGRbaSsxXVtqXSxkW2krMV1baisxXSk7XG4gICAgICAgIGRtYXggID0gTWF0aC5tYXgodGVtcDEsdGVtcDIpO1xuXG4gICAgICAgIGlmIChkbWF4Pj16WzBdJiZkbWluPD16W25jLTFdKSB7XG4gICAgICAgICAgZm9yICh2YXIgaz0wO2s8bmM7aysrKSB7XG4gICAgICAgICAgICBpZiAoeltrXT49ZG1pbiYmeltrXTw9ZG1heCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBtPTQ7bT49MDttLS0pIHtcbiAgICAgICAgICAgICAgICBpZiAobT4wKSB7XG4gICAgICAgICAgICAgICAgICAvLyBUaGUgaW5kZXhpbmcgb2YgaW0gYW5kIGptIHNob3VsZCBiZSBub3RlZCBhcyBpdCBoYXMgdG9cbiAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0IGZyb20gemVyb1xuICAgICAgICAgICAgICAgICAgaFttXSA9IGRbaStpbVttLTFdXVtqK2ptW20tMV1dLXpba107XG4gICAgICAgICAgICAgICAgICB4aFttXSA9IHhbaStpbVttLTFdXTtcbiAgICAgICAgICAgICAgICAgIHloW21dID0geVtqK2ptW20tMV1dO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBoWzBdID0gMC4yNSooaFsxXStoWzJdK2hbM10raFs0XSk7XG4gICAgICAgICAgICAgICAgICB4aFswXT0wLjUqKHhbaV0reFtpKzFdKTtcbiAgICAgICAgICAgICAgICAgIHloWzBdPTAuNSooeVtqXSt5W2orMV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaFttXT5FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgICBzaFttXSA9IDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoW21dPC1FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgICBzaFttXSA9IC0xO1xuICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgc2hbbV0gPSAwO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgIC8vIE5vdGU6IGF0IHRoaXMgc3RhZ2UgdGhlIHJlbGF0aXZlIGhlaWdodHMgb2YgdGhlIGNvcm5lcnMgYW5kIHRoZVxuICAgICAgICAgICAgICAvLyBjZW50cmUgYXJlIGluIHRoZSBoIGFycmF5LCBhbmQgdGhlIGNvcnJlc3BvbmRpbmcgY29vcmRpbmF0ZXMgYXJlXG4gICAgICAgICAgICAgIC8vIGluIHRoZSB4aCBhbmQgeWggYXJyYXlzLiBUaGUgY2VudHJlIG9mIHRoZSBib3ggaXMgaW5kZXhlZCBieSAwXG4gICAgICAgICAgICAgIC8vIGFuZCB0aGUgNCBjb3JuZXJzIGJ5IDEgdG8gNCBhcyBzaG93biBiZWxvdy5cbiAgICAgICAgICAgICAgLy8gRWFjaCB0cmlhbmdsZSBpcyB0aGVuIGluZGV4ZWQgYnkgdGhlIHBhcmFtZXRlciBtLCBhbmQgdGhlIDNcbiAgICAgICAgICAgICAgLy8gdmVydGljZXMgb2YgZWFjaCB0cmlhbmdsZSBhcmUgaW5kZXhlZCBieSBwYXJhbWV0ZXJzIG0xLG0yLGFuZFxuICAgICAgICAgICAgICAvLyBtMy5cbiAgICAgICAgICAgICAgLy8gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZSBjZW50cmUgb2YgdGhlIGJveCBpcyBhbHdheXMgdmVydGV4IDJcbiAgICAgICAgICAgICAgLy8gdGhvdWdoIHRoaXMgaXNpbXBvcnRhbnQgb25seSB3aGVuIGFsbCAzIHZlcnRpY2VzIGxpZSBleGFjdGx5IG9uXG4gICAgICAgICAgICAgIC8vIHRoZSBzYW1lIGNvbnRvdXIgbGV2ZWwsIGluIHdoaWNoIGNhc2Ugb25seSB0aGUgc2lkZSBvZiB0aGUgYm94XG4gICAgICAgICAgICAgIC8vIGlzIGRyYXduLlxuICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAvLyAgICAgIHZlcnRleCA0ICstLS0tLS0tLS0tLS0tLS0tLS0tKyB2ZXJ0ZXggM1xuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHwgXFwgICAgICAgICAgICAgICAvIHxcbiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICB8ICAgXFwgICAgbS0zICAgIC8gICB8XG4gICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgfCAgICAgXFwgICAgICAgLyAgICAgfFxuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHwgICAgICAgXFwgICAvICAgICAgIHxcbiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICB8ICBtPTIgICAgWCAgIG09MiAgIHwgICAgICAgdGhlIGNlbnRyZSBpcyB2ZXJ0ZXggMFxuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHwgICAgICAgLyAgIFxcICAgICAgIHxcbiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICB8ICAgICAvICAgICAgIFxcICAgICB8XG4gICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgfCAgIC8gICAgbT0xICAgIFxcICAgfFxuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHwgLyAgICAgICAgICAgICAgIFxcIHxcbiAgICAgICAgICAgICAgLy8gICAgICB2ZXJ0ZXggMSArLS0tLS0tLS0tLS0tLS0tLS0tLSsgdmVydGV4IDJcbiAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICBTY2FuIGVhY2ggdHJpYW5nbGUgaW4gdGhlIGJveFxuICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICBmb3IgKG09MTttPD00O20rKykge1xuICAgICAgICAgICAgICAgIG0xID0gbTtcbiAgICAgICAgICAgICAgICBtMiA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKG0hPTQpIHtcbiAgICAgICAgICAgICAgICAgICAgbTMgPSBtKzE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbTMgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlX3ZhbHVlID0gY2FzdGFiW3NoW20xXSsxXVtzaFttMl0rMV1bc2hbbTNdKzFdO1xuICAgICAgICAgICAgICAgIGlmIChjYXNlX3ZhbHVlIT0wKSB7XG4gICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNhc2VfdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiAvLyBMaW5lIGJldHdlZW4gdmVydGljZXMgMSBhbmQgMlxuICAgICAgICAgICAgICAgICAgICAgIHgxPXhoW20xXTtcbiAgICAgICAgICAgICAgICAgICAgICB5MT15aFttMV07XG4gICAgICAgICAgICAgICAgICAgICAgeDI9eGhbbTJdO1xuICAgICAgICAgICAgICAgICAgICAgIHkyPXloW20yXTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiAvLyBMaW5lIGJldHdlZW4gdmVydGljZXMgMiBhbmQgM1xuICAgICAgICAgICAgICAgICAgICAgIHgxPXhoW20yXTtcbiAgICAgICAgICAgICAgICAgICAgICB5MT15aFttMl07XG4gICAgICAgICAgICAgICAgICAgICAgeDI9eGhbbTNdO1xuICAgICAgICAgICAgICAgICAgICAgIHkyPXloW20zXTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiAvLyBMaW5lIGJldHdlZW4gdmVydGljZXMgMyBhbmQgMVxuICAgICAgICAgICAgICAgICAgICAgIHgxPXhoW20zXTtcbiAgICAgICAgICAgICAgICAgICAgICB5MT15aFttM107XG4gICAgICAgICAgICAgICAgICAgICAgeDI9eGhbbTFdO1xuICAgICAgICAgICAgICAgICAgICAgIHkyPXloW20xXTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiAvLyBMaW5lIGJldHdlZW4gdmVydGV4IDEgYW5kIHNpZGUgMi0zXG4gICAgICAgICAgICAgICAgICAgICAgeDE9eGhbbTFdO1xuICAgICAgICAgICAgICAgICAgICAgIHkxPXloW20xXTtcbiAgICAgICAgICAgICAgICAgICAgICB4Mj14c2VjdChtMixtMyk7XG4gICAgICAgICAgICAgICAgICAgICAgeTI9eXNlY3QobTIsbTMpO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IC8vIExpbmUgYmV0d2VlbiB2ZXJ0ZXggMiBhbmQgc2lkZSAzLTFcbiAgICAgICAgICAgICAgICAgICAgICB4MT14aFttMl07XG4gICAgICAgICAgICAgICAgICAgICAgeTE9eWhbbTJdO1xuICAgICAgICAgICAgICAgICAgICAgIHgyPXhzZWN0KG0zLG0xKTtcbiAgICAgICAgICAgICAgICAgICAgICB5Mj15c2VjdChtMyxtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjogLy8gIExpbmUgYmV0d2VlbiB2ZXJ0ZXggMyBhbmQgc2lkZSAxLTJcbiAgICAgICAgICAgICAgICAgICAgICB4MT14aFttM107XG4gICAgICAgICAgICAgICAgICAgICAgeTE9eWhbbTNdO1xuICAgICAgICAgICAgICAgICAgICAgIHgyPXhzZWN0KG0xLG0yKTtcbiAgICAgICAgICAgICAgICAgICAgICB5Mj15c2VjdChtMSxtMik7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzogLy8gTGluZSBiZXR3ZWVuIHNpZGVzIDEtMiBhbmQgMi0zXG4gICAgICAgICAgICAgICAgICAgICAgeDE9eHNlY3QobTEsbTIpO1xuICAgICAgICAgICAgICAgICAgICAgIHkxPXlzZWN0KG0xLG0yKTtcbiAgICAgICAgICAgICAgICAgICAgICB4Mj14c2VjdChtMixtMyk7XG4gICAgICAgICAgICAgICAgICAgICAgeTI9eXNlY3QobTIsbTMpO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6IC8vIExpbmUgYmV0d2VlbiBzaWRlcyAyLTMgYW5kIDMtMVxuICAgICAgICAgICAgICAgICAgICAgIHgxPXhzZWN0KG0yLG0zKTtcbiAgICAgICAgICAgICAgICAgICAgICB5MT15c2VjdChtMixtMyk7XG4gICAgICAgICAgICAgICAgICAgICAgeDI9eHNlY3QobTMsbTEpO1xuICAgICAgICAgICAgICAgICAgICAgIHkyPXlzZWN0KG0zLG0xKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiAvLyBMaW5lIGJldHdlZW4gc2lkZXMgMy0xIGFuZCAxLTJcbiAgICAgICAgICAgICAgICAgICAgICB4MT14c2VjdChtMyxtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgeTE9eXNlY3QobTMsbTEpO1xuICAgICAgICAgICAgICAgICAgICAgIHgyPXhzZWN0KG0xLG0yKTtcbiAgICAgICAgICAgICAgICAgICAgICB5Mj15c2VjdChtMSxtMik7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAvLyBQdXQgeW91ciBwcm9jZXNzaW5nIGNvZGUgaGVyZSBhbmQgY29tbWVudCBvdXQgdGhlIHByaW50ZlxuICAgICAgICAgICAgICAgICAgLy9wcmludGYoXCIlZiAlZiAlZiAlZiAlZlxcblwiLHgxLHkxLHgyLHkyLHpba10pO1xuICAgICAgICAgICAgICAgICAgZHJhd0NvbnRvdXIoeDEseTEseDIseTIseltrXSxrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiIsIi8vaHR0cHM6Ly9naXRodWIuY29tL2phc29uZGF2aWVzL2NvbnJlYy5qc1xuLy9odHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI2MzMwNS9kcmF3aW5nLWEtdG9wb2dyYXBoaWNhbC1tYXBcbnZhciB0aW4gPSByZXF1aXJlKCd0dXJmLXRpbicpO1xudmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG52YXIgZ3JpZCA9IHJlcXVpcmUoJ3R1cmYtZ3JpZCcpO1xudmFyIGV4dGVudCA9IHJlcXVpcmUoJ3R1cmYtZXh0ZW50Jyk7XG52YXIgcGxhbmVwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcGxhbmVwb2ludCcpO1xudmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xudmFyIGxpbmVzdHJpbmcgPSByZXF1aXJlKCd0dXJmLWxpbmVzdHJpbmcnKTtcbnZhciBzcXVhcmUgPSByZXF1aXJlKCd0dXJmLXNxdWFyZScpO1xudmFyIENvbnJlYyA9IHJlcXVpcmUoJy4vY29ucmVjJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgd2l0aCB6LXZhbHVlcyBhbmQgYW4gYXJyYXkgb2ZcbiAqIHZhbHVlIGJyZWFrcyBhbmQgZ2VuZXJhdGVzIFtpc29saW5lc10oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Jc29saW5lKS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvaXNvbGluZXNcbiAqIEBjYXRlZ29yeSBpbnRlcnBvbGF0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAcGFyYW0ge3N0cmluZ30geiB0aGUgcHJvcGVydHkgbmFtZSBpbiBgcG9pbnRzYCBmcm9tIHdoaWNoIHotdmFsdWVzIHdpbGwgYmUgcHVsbGVkXG4gKiBAcGFyYW0ge251bWJlcn0gcmVzb2x1dGlvbiByZXNvbHV0aW9uIG9mIHRoZSB1bmRlcmx5aW5nIGdyaWRcbiAqIEBwYXJhbSB7bnVtYmVyW119IGJyZWFrcyB3aGVyZSB0byBkcmF3IGNvbnRvdXJzXG4gKiBAcmV0dXJucyB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIExpbmVTdHJpbmd9IGZlYXR1cmVzIHJlcHJlc2VudGluZyBpc29saW5lc1xuICogQGV4YW1wbGVcbiAqIC8vIGNyZWF0ZSByYW5kb20gcG9pbnRzIHdpdGggcmFuZG9tXG4gKiAvLyB6LXZhbHVlcyBpbiB0aGVpciBwcm9wZXJ0aWVzXG4gKiB2YXIgcG9pbnRzID0gdHVyZi5yYW5kb20oJ3BvaW50JywgMTAwLCB7XG4gKiAgIGJib3g6IFswLCAzMCwgMjAsIDUwXVxuICogfSk7XG4gKiBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50cy5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICogICBwb2ludHMuZmVhdHVyZXNbaV0ucHJvcGVydGllcy56ID0gTWF0aC5yYW5kb20oKSAqIDEwO1xuICogfVxuICogdmFyIGJyZWFrcyA9IFswLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF07XG4gKiB2YXIgaXNvbGluZWQgPSB0dXJmLmlzb2xpbmVzKHBvaW50cywgJ3onLCAxNSwgYnJlYWtzKTtcbiAqIC8vPWlzb2xpbmVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnRzLCB6LCByZXNvbHV0aW9uLCBicmVha3MsIGRvbmUpe1xuICB2YXIgdGluUmVzdWx0ID0gdGluKHBvaW50cywgeik7XG4gIHZhciBleHRlbnRCQm94ID0gZXh0ZW50KHBvaW50cyk7XG4gIHZhciBzcXVhcmVCQm94ID0gc3F1YXJlKGV4dGVudEJCb3gpO1xuICB2YXIgZ3JpZFJlc3VsdCA9IGdyaWQoc3F1YXJlQkJveCwgcmVzb2x1dGlvbik7XG4gIHZhciBkYXRhID0gW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBncmlkUmVzdWx0LmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHB0ID0gZ3JpZFJlc3VsdC5mZWF0dXJlc1tpXTtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRpblJlc3VsdC5mZWF0dXJlcy5sZW5ndGg7IGorKykge1xuICAgICAgdmFyIHRyaWFuZ2xlID0gdGluUmVzdWx0LmZlYXR1cmVzW2pdO1xuICAgICAgaWYgKGluc2lkZShwdCwgdHJpYW5nbGUpKSB7XG4gICAgICAgIHB0LnByb3BlcnRpZXMgPSB7fTtcbiAgICAgICAgcHQucHJvcGVydGllc1t6XSA9IHBsYW5lcG9pbnQocHQsIHRyaWFuZ2xlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgZGVwdGggPSBNYXRoLnNxcnQoZ3JpZFJlc3VsdC5mZWF0dXJlcy5sZW5ndGgpO1xuICBmb3IgKHZhciB4PTA7IHg8ZGVwdGg7IHgrKyl7XG4gICAgdmFyIHhHcm91cCA9IGdyaWRSZXN1bHQuZmVhdHVyZXMuc2xpY2UoeCAqIGRlcHRoLCAoeCArIDEpICogZGVwdGgpO1xuICAgIHZhciB4RmxhdCA9IFtdO1xuICAgIHhHcm91cC5mb3JFYWNoKGZ1bmN0aW9uKHZlcnRpY2FsUG9pbnQpe1xuICAgICAgaWYodmVydGljYWxQb2ludC5wcm9wZXJ0aWVzKXtcbiAgICAgICAgeEZsYXQucHVzaCh2ZXJ0aWNhbFBvaW50LnByb3BlcnRpZXNbel0pO1xuICAgICAgfSBlbHNle1xuICAgICAgICB4RmxhdC5wdXNoKDApO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGRhdGEucHVzaCh4RmxhdCk7XG4gIH1cbiAgdmFyIGludGVydmFsID0gKHNxdWFyZUJCb3hbMl0gLSBzcXVhcmVCQm94WzBdKSAvIGRlcHRoO1xuICB2YXIgeENvb3JkaW5hdGVzID0gW107XG4gIHZhciB5Q29vcmRpbmF0ZXMgPSBbXTtcbiAgZm9yICh2YXIgeCA9IDA7IHggPCBkZXB0aDsgeCsrKSB7XG4gICAgeENvb3JkaW5hdGVzLnB1c2goeCAqIGludGVydmFsICsgc3F1YXJlQkJveFswXSk7XG4gICAgeUNvb3JkaW5hdGVzLnB1c2goeCAqIGludGVydmFsICsgc3F1YXJlQkJveFsxXSk7XG4gIH1cblxuICB2YXIgYyA9IG5ldyBDb25yZWMoKTtcbiAgYy5jb250b3VyKGRhdGEsIDAsIHJlc29sdXRpb24sIDAsIHJlc29sdXRpb24sIHhDb29yZGluYXRlcywgeUNvb3JkaW5hdGVzLCBicmVha3MubGVuZ3RoLCBicmVha3MpO1xuICB2YXIgY29udG91ckxpc3QgPSBjLmNvbnRvdXJMaXN0KCk7XG5cbiAgdmFyIGZjID0gZmVhdHVyZWNvbGxlY3Rpb24oW10pO1xuICBjb250b3VyTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGMpe1xuICAgIGlmKGMubGVuZ3RoID4gMil7XG4gICAgICB2YXIgcG9seUNvb3JkaW5hdGVzID0gW107XG4gICAgICBjLmZvckVhY2goZnVuY3Rpb24oY29vcmQpe1xuICAgICAgICBwb2x5Q29vcmRpbmF0ZXMucHVzaChbY29vcmQueCwgY29vcmQueV0pO1xuICAgICAgfSk7XG4gICAgICB2YXIgcG9seSA9IGxpbmVzdHJpbmcocG9seUNvb3JkaW5hdGVzKTtcbiAgICAgIHBvbHkucHJvcGVydGllcyA9IHt9O1xuICAgICAgcG9seS5wcm9wZXJ0aWVzW3pdID0gYy5sZXZlbDtcblxuICAgICAgZmMuZmVhdHVyZXMucHVzaChwb2x5KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBmYztcbn1cblxuXG5cbiIsInZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcblxuLyoqXG4gKiBUYWtlcyBhIGJvdW5kaW5nIGJveCBhbmQgYSBjZWxsIGRlcHRoIGFuZCByZXR1cm5zIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIGluIGEgZ3JpZC5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZ3JpZFxuICogQGNhdGVnb3J5IGludGVycG9sYXRpb25cbiAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gZXh0ZW50IGV4dGVudCBpbiBbbWluWCwgbWluWSwgbWF4WCwgbWF4WV0gb3JkZXJcbiAqIEBwYXJhbSB7TnVtYmVyfSBkZXB0aCBob3cgbWFueSBjZWxscyB0byBvdXRwdXRcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBncmlkIGFzIEZlYXR1cmVDb2xsZWN0aW9uIHdpdGgge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQGV4YW1wbGVcbiAqIHZhciBleHRlbnQgPSBbLTcwLjgyMzM2NCwgLTMzLjU1Mzk4NCwgLTcwLjQ3MzE3NSwgLTMzLjMwMjk4Nl07XG4gKiB2YXIgZGVwdGggPSAxMDtcbiAqXG4gKiB2YXIgZ3JpZCA9IHR1cmYuZ3JpZChleHRlbnQsIGRlcHRoKTtcbiAqXG4gKiAvLz1ncmlkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXh0ZW50cywgZGVwdGgpIHtcbiAgdmFyIHhtaW4gPSBleHRlbnRzWzBdO1xuICB2YXIgeW1pbiA9IGV4dGVudHNbMV07XG4gIHZhciB4bWF4ID0gZXh0ZW50c1syXTtcbiAgdmFyIHltYXggPSBleHRlbnRzWzNdO1xuICB2YXIgaW50ZXJ2YWwgPSAoeG1heCAtIHhtaW4pIC8gZGVwdGg7XG4gIHZhciBjb29yZHMgPSBbXTtcbiAgdmFyIGZjID0ge1xuICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsXG4gICAgZmVhdHVyZXM6IFtdXG4gIH07XG5cbiAgZm9yICh2YXIgeD0wOyB4PD1kZXB0aDsgeCsrKXtcbiAgICBmb3IgKHZhciB5PTA7eTw9ZGVwdGg7IHkrKyl7XG4gICAgICBmYy5mZWF0dXJlcy5wdXNoKHBvaW50KFsoeCAqIGludGVydmFsKSArIHhtaW4sICh5ICogaW50ZXJ2YWwpICsgeW1pbl0pKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZjO1xufVxuIiwidmFyIHNzID0gcmVxdWlyZSgnc2ltcGxlLXN0YXRpc3RpY3MnKTtcblxuLyoqXG4qIFRha2VzIGEge0BGZWF0dXJlQ29sbGVjdGlvbn0gb2YgYW55IHR5cGUgYW5kIHJldHVybnMgYW4gYXJyYXkgb2YgdGhlIFtKZW5rcyBOYXR1cmFsIGJyZWFrc10oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9KZW5rc19uYXR1cmFsX2JyZWFrc19vcHRpbWl6YXRpb24pXG4qIGZvciBhIGdpdmVuIHByb3BlcnR5XG4qIEBtb2R1bGUgdHVyZi9qZW5rc1xuKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBpbnB1dCBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4qIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCB0aGUgcHJvcGVydHkgaW4gYGlucHV0YCBvbiB3aGljaCB0byBjYWxjdWxhdGUgSmVua3MgbmF0dXJhbCBicmVha3NcbiogQHBhcmFtIHtudW1iZXJ9IG51bWJlck9mQnJlYWtzIG51bWJlciBvZiBjbGFzc2VzIGluIHdoaWNoIHRvIGdyb3VwIHRoZSBkYXRhXG4qIEByZXR1cm4ge0FycmF5PG51bWJlcj59IHRoZSBicmVhayBudW1iZXIgZm9yIGVhY2ggY2xhc3MgcGx1cyB0aGUgbWluaW11bSBhbmQgbWF4aW11bSB2YWx1ZXNcbiogQGV4YW1wbGVcbiogdmFyIHBvaW50cyA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuKiAgIFwiZmVhdHVyZXNcIjogW1xuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzQ5Ljg1OTczMywgNDAuNDAwNDI0XVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbNDkuODM4NzksIDQwLjQwMTIwOV1cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDEwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzQ5LjgxNzg0OCwgNDAuMzc2ODg5XVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbNDkuODQwNTA3LCA0MC4zODYwNDNdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAzMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFs0OS44NTQ1ODMsIDQwLjM3NTMyXVxuKiAgICAgICB9XG4qICAgICB9XG4qICAgXVxuKiB9O1xuKlxuKiB2YXIgYnJlYWtzID0gdHVyZi5qZW5rcyhwb2ludHMsICdwb3B1bGF0aW9uJywgMyk7XG4qXG4qIC8vPWJyZWFrc1xuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmMsIGZpZWxkLCBudW0pe1xuICB2YXIgdmFscyA9IFtdO1xuICB2YXIgYnJlYWtzID0gW107XG5cbiAgZmMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihmZWF0dXJlKXtcbiAgICBpZihmZWF0dXJlLnByb3BlcnRpZXNbZmllbGRdIT09dW5kZWZpbmVkKXtcbiAgICAgIHZhbHMucHVzaChmZWF0dXJlLnByb3BlcnRpZXNbZmllbGRdKTtcbiAgICB9XG4gIH0pO1xuICBicmVha3MgPSBzcy5qZW5rcyh2YWxzLCBudW0pO1xuXG4gIHJldHVybiBicmVha3M7XG59O1xuIiwiLyoqXG4gKiBUYWtlcyBhIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlIGFuZCByZXR1cm5zIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIGF0IGFsbCBzZWxmLWludGVyc2VjdGlvbnMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2tpbmtzXG4gKiBAY2F0ZWdvcnkgbWlzY1xuICogQHBhcmFtIHtQb2x5Z29ufSBwb2x5Z29uIGEgUG9seWdvbiBmZWF0dXJlXG4gKiBAcmV0dXJucyB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyByZXByZXNlbnRpbmcgc2VsZi1pbnRlcnNlY3Rpb25zXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHkgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWy0xMi4wMzQ4MzUsIDguOTAxMTgzXSxcbiAqICAgICAgIFstMTIuMDYwNDEzLCA4Ljg5OTgyNl0sXG4gKiAgICAgICBbLTEyLjAzNjM4LCA4Ljg3MzE5OV0sXG4gKiAgICAgICBbLTEyLjA1OTM4MywgOC44NzE0MThdLFxuICogICAgICAgWy0xMi4wMzQ4MzUsIDguOTAxMTgzXVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG4gKiBcbiAqIHZhciBraW5rcyA9IHR1cmYua2lua3MocG9seSk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0ga2lua3MuaW50ZXJzZWN0aW9ucy5mZWF0dXJlcy5jb25jYXQocG9seSk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5cbnZhciBwb2x5Z29uID0gcmVxdWlyZSgndHVyZi1wb2x5Z29uJyk7XG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG52YXIgZmMgPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9seUluKSB7XG4gIHZhciBwb2x5O1xuICB2YXIgcmVzdWx0cyA9IHtpbnRlcnNlY3Rpb25zOiBmYyhbXSksIGZpeGVkOiBudWxsfTtcbiAgaWYgKHBvbHlJbi50eXBlID09PSAnRmVhdHVyZScpIHtcbiAgICBwb2x5ID0gcG9seUluLmdlb21ldHJ5O1xuICB9IGVsc2Uge1xuICAgIHBvbHkgPSBwb2x5SW47XG4gIH1cbiAgdmFyIGludGVyc2VjdGlvbkhhc2ggPSB7fTtcbiAgcG9seS5jb29yZGluYXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHJpbmcxKXtcbiAgICBwb2x5LmNvb3JkaW5hdGVzLmZvckVhY2goZnVuY3Rpb24ocmluZzIpe1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHJpbmcxLmxlbmd0aC0xOyBpKyspIHtcbiAgICAgICAgZm9yKHZhciBrID0gMDsgayA8IHJpbmcyLmxlbmd0aC0xOyBrKyspIHtcbiAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uID0gbGluZUludGVyc2VjdHMocmluZzFbaV1bMF0scmluZzFbaV1bMV0scmluZzFbaSsxXVswXSxyaW5nMVtpKzFdWzFdLFxuICAgICAgICAgICAgcmluZzJba11bMF0scmluZzJba11bMV0scmluZzJbaysxXVswXSxyaW5nMltrKzFdWzFdKTtcbiAgICAgICAgICBpZihpbnRlcnNlY3Rpb24pIHtcbiAgICAgICAgICAgIHJlc3VsdHMuaW50ZXJzZWN0aW9ucy5mZWF0dXJlcy5wdXNoKHBvaW50KFtpbnRlcnNlY3Rpb25bMF0sIGludGVyc2VjdGlvblsxXV0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICB9KVxuICByZXR1cm4gcmVzdWx0cztcbn1cblxuXG4vLyBtb2RpZmllZCBmcm9tIGh0dHA6Ly9qc2ZpZGRsZS5uZXQvanVzdGluX2Nfcm91bmRzL0dkMlMyL2xpZ2h0L1xuZnVuY3Rpb24gbGluZUludGVyc2VjdHMobGluZTFTdGFydFgsIGxpbmUxU3RhcnRZLCBsaW5lMUVuZFgsIGxpbmUxRW5kWSwgbGluZTJTdGFydFgsIGxpbmUyU3RhcnRZLCBsaW5lMkVuZFgsIGxpbmUyRW5kWSkge1xuICAvLyBpZiB0aGUgbGluZXMgaW50ZXJzZWN0LCB0aGUgcmVzdWx0IGNvbnRhaW5zIHRoZSB4IGFuZCB5IG9mIHRoZSBpbnRlcnNlY3Rpb24gKHRyZWF0aW5nIHRoZSBsaW5lcyBhcyBpbmZpbml0ZSkgYW5kIGJvb2xlYW5zIGZvciB3aGV0aGVyIGxpbmUgc2VnbWVudCAxIG9yIGxpbmUgc2VnbWVudCAyIGNvbnRhaW4gdGhlIHBvaW50XG4gIHZhciBkZW5vbWluYXRvciwgYSwgYiwgbnVtZXJhdG9yMSwgbnVtZXJhdG9yMiwgcmVzdWx0ID0ge1xuICAgIHg6IG51bGwsXG4gICAgeTogbnVsbCxcbiAgICBvbkxpbmUxOiBmYWxzZSxcbiAgICBvbkxpbmUyOiBmYWxzZVxuICB9O1xuICBkZW5vbWluYXRvciA9ICgobGluZTJFbmRZIC0gbGluZTJTdGFydFkpICogKGxpbmUxRW5kWCAtIGxpbmUxU3RhcnRYKSkgLSAoKGxpbmUyRW5kWCAtIGxpbmUyU3RhcnRYKSAqIChsaW5lMUVuZFkgLSBsaW5lMVN0YXJ0WSkpO1xuICBpZiAoZGVub21pbmF0b3IgPT0gMCkge1xuICAgIGlmKHJlc3VsdC54ICE9IG51bGwgJiYgcmVzdWx0LnkgIT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBhID0gbGluZTFTdGFydFkgLSBsaW5lMlN0YXJ0WTtcbiAgYiA9IGxpbmUxU3RhcnRYIC0gbGluZTJTdGFydFg7XG4gIG51bWVyYXRvcjEgPSAoKGxpbmUyRW5kWCAtIGxpbmUyU3RhcnRYKSAqIGEpIC0gKChsaW5lMkVuZFkgLSBsaW5lMlN0YXJ0WSkgKiBiKTtcbiAgbnVtZXJhdG9yMiA9ICgobGluZTFFbmRYIC0gbGluZTFTdGFydFgpICogYSkgLSAoKGxpbmUxRW5kWSAtIGxpbmUxU3RhcnRZKSAqIGIpO1xuICBhID0gbnVtZXJhdG9yMSAvIGRlbm9taW5hdG9yO1xuICBiID0gbnVtZXJhdG9yMiAvIGRlbm9taW5hdG9yO1xuXG4gIC8vIGlmIHdlIGNhc3QgdGhlc2UgbGluZXMgaW5maW5pdGVseSBpbiBib3RoIGRpcmVjdGlvbnMsIHRoZXkgaW50ZXJzZWN0IGhlcmU6XG4gIHJlc3VsdC54ID0gbGluZTFTdGFydFggKyAoYSAqIChsaW5lMUVuZFggLSBsaW5lMVN0YXJ0WCkpO1xuICByZXN1bHQueSA9IGxpbmUxU3RhcnRZICsgKGEgKiAobGluZTFFbmRZIC0gbGluZTFTdGFydFkpKTtcblxuICAvLyBpZiBsaW5lMSBpcyBhIHNlZ21lbnQgYW5kIGxpbmUyIGlzIGluZmluaXRlLCB0aGV5IGludGVyc2VjdCBpZjpcbiAgaWYgKGEgPiAwICYmIGEgPCAxKSB7XG4gICAgcmVzdWx0Lm9uTGluZTEgPSB0cnVlO1xuICB9XG4gIC8vIGlmIGxpbmUyIGlzIGEgc2VnbWVudCBhbmQgbGluZTEgaXMgaW5maW5pdGUsIHRoZXkgaW50ZXJzZWN0IGlmOlxuICBpZiAoYiA+IDAgJiYgYiA8IDEpIHtcbiAgICByZXN1bHQub25MaW5lMiA9IHRydWU7XG4gIH1cbiAgLy8gaWYgbGluZTEgYW5kIGxpbmUyIGFyZSBzZWdtZW50cywgdGhleSBpbnRlcnNlY3QgaWYgYm90aCBvZiB0aGUgYWJvdmUgYXJlIHRydWVcbiAgaWYocmVzdWx0Lm9uTGluZTEgJiYgcmVzdWx0Lm9uTGluZTIpe1xuICAgIHJldHVybiBbcmVzdWx0LngsIHJlc3VsdC55XTtcbiAgfVxuICBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsInZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBMaW5lU3RyaW5nfSBmZWF0dXJlIGFuZCBtZWFzdXJlcyBpdHMgbGVuZ3RoIGluIHRoZSBzcGVjaWZpZWQgdW5pdHMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2xpbmUtZGlzdGFuY2VcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtMaW5lU3RyaW5nfSBMaW5lIHRvIG1lYXN1cmVcbiAqIEBwYXJhbSB7U3RyaW5nfSBbdW5pdHM9bWlsZXNdIGNhbiBiZSBkZWdyZWVzLCByYWRpYW5zLCBtaWxlcywgb3Iga2lsb21ldGVyc1xuICogQHJldHVybiB7TnVtYmVyfSBsZW5ndGggb2YgdGhlIExpbmVTdHJpbmdcbiAqIEBleGFtcGxlXG4gKiB2YXIgbGluZSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIkxpbmVTdHJpbmdcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtcbiAqICAgICAgIFstNzcuMDMxNjY5LCAzOC44Nzg2MDVdLFxuICogICAgICAgWy03Ny4wMjk2MDksIDM4Ljg4MTk0Nl0sXG4gKiAgICAgICBbLTc3LjAyMDMzOSwgMzguODg0MDg0XSxcbiAqICAgICAgIFstNzcuMDI1NjYxLCAzOC44ODU4MjFdLFxuICogICAgICAgWy03Ny4wMjE4ODQsIDM4Ljg4OTU2M10sXG4gKiAgICAgICBbLTc3LjAxOTgyNCwgMzguODkyMzY4XVxuICogICAgIF1cbiAqICAgfVxuICogfTtcbiAqXG4gKiB2YXIgbGVuZ3RoID0gdHVyZi5saW5lRGlzdGFuY2UobGluZSwgJ21pbGVzJyk7XG4gKlxuICogLy89bGluZVxuICpcbiAqIC8vPWxlbmd0aFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGxpbmUsIHVuaXRzKSB7XG4gIHZhciBjb29yZHM7XG4gIGlmKGxpbmUudHlwZSA9PT0gJ0ZlYXR1cmUnKSBjb29yZHMgPSBsaW5lLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICBlbHNlIGlmKGxpbmUudHlwZSA9PT0gJ0xpbmVTdHJpbmcnKSBjb29yZHMgPSBsaW5lLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICBlbHNlIHRocm93IG5ldyBFcnJvcignaW5wdXQgbXVzdCBiZSBhIExpbmVTdHJpbmcgRmVhdHVyZSBvciBHZW9tZXRyeScpO1xuXG4gIHZhciB0cmF2ZWxsZWQgPSAwO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgIHRyYXZlbGxlZCArPSBkaXN0YW5jZShwb2ludChjb29yZHNbaV0pLCBwb2ludChjb29yZHNbaSsxXSksIHVuaXRzKTtcbiAgfVxuICByZXR1cm4gdHJhdmVsbGVkO1xufVxuIiwidmFyIGRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xudmFyIGxpbmVzdHJpbmcgPSByZXF1aXJlKCd0dXJmLWxpbmVzdHJpbmcnKTtcbnZhciBiZWFyaW5nID0gcmVxdWlyZSgndHVyZi1iZWFyaW5nJyk7XG52YXIgZGVzdGluYXRpb24gPSByZXF1aXJlKCd0dXJmLWRlc3RpbmF0aW9uJyk7XG5cbi8qKlxuICogU2xpY2VzIGEgTGluZVN0cmluZyBhdCBzdGFydCBhbmQgc3RvcCBQb2ludHNcbiAqXG4gKiBAbW9kdWxlIHR1cmYvbGluZS1zbGljZVxuICpcbiAqIEBwYXJhbSB7UG9pbnR9IFBvaW50IHRvIHN0YXJ0IHRoZSBzbGljZVxuICogQHBhcmFtIHtQb2ludH0gUG9pbnQgdG8gc3RvcCB0aGUgc2xpY2VcbiAqIEBwYXJhbSB7TGluZVN0cmluZ30gTGluZSB0byBzbGljZVxuICogQHJldHVybiB7TGluZVN0cmluZ30gU2xpY2VkIExpbmVTdHJpbmdcbiAqIEBleGFtcGxlXG4gKiB2YXIgbGluZSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIkxpbmVTdHJpbmdcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtcbiAqICAgICAgIFstNzcuMDMxNjY5LCAzOC44Nzg2MDVdLFxuICogICAgICAgWy03Ny4wMjk2MDksIDM4Ljg4MTk0Nl0sXG4gKiAgICAgICBbLTc3LjAyMDMzOSwgMzguODg0MDg0XSxcbiAqICAgICAgIFstNzcuMDI1NjYxLCAzOC44ODU4MjFdLFxuICogICAgICAgWy03Ny4wMjE4ODQsIDM4Ljg4OTU2M10sXG4gKiAgICAgICBbLTc3LjAxOTgyNCwgMzguODkyMzY4XVxuICogICAgIF1cbiAqICAgfVxuICogfTtcbiAqIHZhciBzdGFydCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc3LjAyOTYwOSwgMzguODgxOTQ2XVxuICogICB9XG4gKiB9O1xuICogdmFyIHN0b3AgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogWy03Ny4wMjE4ODQsIDM4Ljg4OTU2M11cbiAqICAgfVxuICogfTtcbiAqIFxuICogdmFyIHNsaWNlZCA9IHR1cmYubGluZVNsaWNlKHN0YXJ0LCBzdG9wLCBsaW5lKTtcbiAqXG4gKiAvLz1saW5lXG4gKlxuICogLy89c2xpY2VkXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoc3RhcnRQdCwgc3RvcFB0LCBsaW5lKSB7ICBcbiAgdmFyIGNvb3JkcztcbiAgaWYobGluZS50eXBlID09PSAnRmVhdHVyZScpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgaWYobGluZS50eXBlID09PSAnTGluZVN0cmluZycpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgdGhyb3cgbmV3IEVycm9yKCdpbnB1dCBtdXN0IGJlIGEgTGluZVN0cmluZyBGZWF0dXJlIG9yIEdlb21ldHJ5Jyk7XG5cbiAgdmFyIHN0YXJ0VmVydGV4ID0gcG9pbnRPbkxpbmUoc3RhcnRQdCwgY29vcmRzKTtcbiAgdmFyIHN0b3BWZXJ0ZXggPSBwb2ludE9uTGluZShzdG9wUHQsIGNvb3Jkcyk7XG4gIHZhciBlbmRzO1xuICBpZihzdGFydFZlcnRleC5wcm9wZXJ0aWVzLmluZGV4IDw9IHN0b3BWZXJ0ZXgucHJvcGVydGllcy5pbmRleCkge1xuICAgIGVuZHMgPSBbc3RhcnRWZXJ0ZXgsIHN0b3BWZXJ0ZXhdO1xuICB9IGVsc2Uge1xuICAgIGVuZHMgPSBbc3RvcFZlcnRleCwgc3RhcnRWZXJ0ZXhdO1xuICB9XG4gIHZhciBjbGlwTGluZSA9IGxpbmVzdHJpbmcoW2VuZHNbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNdLCB7fSk7XG4gIGZvcih2YXIgaSA9IGVuZHNbMF0ucHJvcGVydGllcy5pbmRleCsxOyBpIDwgZW5kc1sxXS5wcm9wZXJ0aWVzLmluZGV4KzE7IGkrKykge1xuICAgIGNsaXBMaW5lLmdlb21ldHJ5LmNvb3JkaW5hdGVzLnB1c2goY29vcmRzW2ldKTtcbiAgfVxuICBjbGlwTGluZS5nZW9tZXRyeS5jb29yZGluYXRlcy5wdXNoKGVuZHNbMV0uZ2VvbWV0cnkuY29vcmRpbmF0ZXMpO1xuICByZXR1cm4gY2xpcExpbmU7XG59XG5cbmZ1bmN0aW9uIHBvaW50T25MaW5lIChwdCwgY29vcmRzKSB7XG4gIHZhciB1bml0cyA9ICdtaWxlcydcbiAgdmFyIGNsb3Nlc3RQdCA9IHBvaW50KFtJbmZpbml0eSwgSW5maW5pdHldLCB7ZGlzdDogSW5maW5pdHl9KTtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICB2YXIgc3RhcnQgPSBwb2ludChjb29yZHNbaV0pXG4gICAgdmFyIHN0b3AgPSBwb2ludChjb29yZHNbaSsxXSlcbiAgICAvL3N0YXJ0XG4gICAgc3RhcnQucHJvcGVydGllcy5kaXN0ID0gZGlzdGFuY2UocHQsIHN0YXJ0LCB1bml0cyk7XG4gICAgLy9zdG9wXG4gICAgc3RvcC5wcm9wZXJ0aWVzLmRpc3QgPSBkaXN0YW5jZShwdCwgc3RvcCwgdW5pdHMpO1xuICAgIC8vcGVycGVuZGljdWxhclxuICAgIHZhciBkaXJlY3Rpb24gPSBiZWFyaW5nKHN0YXJ0LCBzdG9wKVxuICAgIHZhciBwZXJwZW5kaWN1bGFyUHQgPSBkZXN0aW5hdGlvbihwdCwgMTAwMCAsIGRpcmVjdGlvbiArIDkwLCB1bml0cykgLy8gMTAwMCA9IGdyb3NzXG4gICAgdmFyIGludGVyc2VjdCA9IGxpbmVJbnRlcnNlY3RzKFxuICAgICAgcHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICBwdC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSxcbiAgICAgIHBlcnBlbmRpY3VsYXJQdC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgIHBlcnBlbmRpY3VsYXJQdC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSxcbiAgICAgIHN0YXJ0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgc3RhcnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICBzdG9wLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgc3RvcC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXVxuICAgICAgKTtcbiAgICBpZighaW50ZXJzZWN0KSB7XG4gICAgICBwZXJwZW5kaWN1bGFyUHQgPSBkZXN0aW5hdGlvbihwdCwgMTAwMCAsIGRpcmVjdGlvbiAtIDkwLCB1bml0cykgLy8gMTAwMCA9IGdyb3NzXG4gICAgICBpbnRlcnNlY3QgPSBsaW5lSW50ZXJzZWN0cyhcbiAgICAgICAgcHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICAgIHB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgICBwZXJwZW5kaWN1bGFyUHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICAgIHBlcnBlbmRpY3VsYXJQdC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSxcbiAgICAgICAgc3RhcnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICAgIHN0YXJ0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgICBzdG9wLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgICBzdG9wLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdXG4gICAgICAgICk7XG4gICAgfVxuICAgIHBlcnBlbmRpY3VsYXJQdC5wcm9wZXJ0aWVzLmRpc3QgPSBJbmZpbml0eTtcbiAgICB2YXIgaW50ZXJzZWN0UHQ7XG4gICAgaWYoaW50ZXJzZWN0KSB7XG4gICAgICB2YXIgaW50ZXJzZWN0UHQgPSBwb2ludChpbnRlcnNlY3QpO1xuICAgICAgaW50ZXJzZWN0UHQucHJvcGVydGllcy5kaXN0ID0gZGlzdGFuY2UocHQsIGludGVyc2VjdFB0LCB1bml0cyk7XG4gICAgfVxuICAgIFxuICAgIGlmKHN0YXJ0LnByb3BlcnRpZXMuZGlzdCA8IGNsb3Nlc3RQdC5wcm9wZXJ0aWVzLmRpc3QpIHtcbiAgICAgIGNsb3Nlc3RQdCA9IHN0YXJ0O1xuICAgICAgY2xvc2VzdFB0LnByb3BlcnRpZXMuaW5kZXggPSBpO1xuICAgIH1cbiAgICBpZihzdG9wLnByb3BlcnRpZXMuZGlzdCA8IGNsb3Nlc3RQdC5wcm9wZXJ0aWVzLmRpc3QpIHtcbiAgICAgY2xvc2VzdFB0ID0gc3RvcDtcbiAgICAgY2xvc2VzdFB0LnByb3BlcnRpZXMuaW5kZXggPSBpO1xuICAgIH1cbiAgICBpZihpbnRlcnNlY3RQdCAmJiBpbnRlcnNlY3RQdC5wcm9wZXJ0aWVzLmRpc3QgPCBjbG9zZXN0UHQucHJvcGVydGllcy5kaXN0KXsgXG4gICAgICBjbG9zZXN0UHQgPSBpbnRlcnNlY3RQdDtcbiAgICAgIGNsb3Nlc3RQdC5wcm9wZXJ0aWVzLmluZGV4ID0gaTtcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiBjbG9zZXN0UHQ7XG59XG5cbi8vIG1vZGlmaWVkIGZyb20gaHR0cDovL2pzZmlkZGxlLm5ldC9qdXN0aW5fY19yb3VuZHMvR2QyUzIvbGlnaHQvXG5mdW5jdGlvbiBsaW5lSW50ZXJzZWN0cyhsaW5lMVN0YXJ0WCwgbGluZTFTdGFydFksIGxpbmUxRW5kWCwgbGluZTFFbmRZLCBsaW5lMlN0YXJ0WCwgbGluZTJTdGFydFksIGxpbmUyRW5kWCwgbGluZTJFbmRZKSB7XG4gIC8vIGlmIHRoZSBsaW5lcyBpbnRlcnNlY3QsIHRoZSByZXN1bHQgY29udGFpbnMgdGhlIHggYW5kIHkgb2YgdGhlIGludGVyc2VjdGlvbiAodHJlYXRpbmcgdGhlIGxpbmVzIGFzIGluZmluaXRlKSBhbmQgYm9vbGVhbnMgZm9yIHdoZXRoZXIgbGluZSBzZWdtZW50IDEgb3IgbGluZSBzZWdtZW50IDIgY29udGFpbiB0aGUgcG9pbnRcbiAgdmFyIGRlbm9taW5hdG9yLCBhLCBiLCBudW1lcmF0b3IxLCBudW1lcmF0b3IyLCByZXN1bHQgPSB7XG4gICAgeDogbnVsbCxcbiAgICB5OiBudWxsLFxuICAgIG9uTGluZTE6IGZhbHNlLFxuICAgIG9uTGluZTI6IGZhbHNlXG4gIH07XG4gIGRlbm9taW5hdG9yID0gKChsaW5lMkVuZFkgLSBsaW5lMlN0YXJ0WSkgKiAobGluZTFFbmRYIC0gbGluZTFTdGFydFgpKSAtICgobGluZTJFbmRYIC0gbGluZTJTdGFydFgpICogKGxpbmUxRW5kWSAtIGxpbmUxU3RhcnRZKSk7XG4gIGlmIChkZW5vbWluYXRvciA9PSAwKSB7XG4gICAgaWYocmVzdWx0LnggIT0gbnVsbCAmJiByZXN1bHQueSAhPSBudWxsKSB7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGEgPSBsaW5lMVN0YXJ0WSAtIGxpbmUyU3RhcnRZO1xuICBiID0gbGluZTFTdGFydFggLSBsaW5lMlN0YXJ0WDtcbiAgbnVtZXJhdG9yMSA9ICgobGluZTJFbmRYIC0gbGluZTJTdGFydFgpICogYSkgLSAoKGxpbmUyRW5kWSAtIGxpbmUyU3RhcnRZKSAqIGIpO1xuICBudW1lcmF0b3IyID0gKChsaW5lMUVuZFggLSBsaW5lMVN0YXJ0WCkgKiBhKSAtICgobGluZTFFbmRZIC0gbGluZTFTdGFydFkpICogYik7XG4gIGEgPSBudW1lcmF0b3IxIC8gZGVub21pbmF0b3I7XG4gIGIgPSBudW1lcmF0b3IyIC8gZGVub21pbmF0b3I7XG5cbiAgLy8gaWYgd2UgY2FzdCB0aGVzZSBsaW5lcyBpbmZpbml0ZWx5IGluIGJvdGggZGlyZWN0aW9ucywgdGhleSBpbnRlcnNlY3QgaGVyZTpcbiAgcmVzdWx0LnggPSBsaW5lMVN0YXJ0WCArIChhICogKGxpbmUxRW5kWCAtIGxpbmUxU3RhcnRYKSk7XG4gIHJlc3VsdC55ID0gbGluZTFTdGFydFkgKyAoYSAqIChsaW5lMUVuZFkgLSBsaW5lMVN0YXJ0WSkpO1xuXG4gIC8vIGlmIGxpbmUxIGlzIGEgc2VnbWVudCBhbmQgbGluZTIgaXMgaW5maW5pdGUsIHRoZXkgaW50ZXJzZWN0IGlmOlxuICBpZiAoYSA+IDAgJiYgYSA8IDEpIHtcbiAgICByZXN1bHQub25MaW5lMSA9IHRydWU7XG4gIH1cbiAgLy8gaWYgbGluZTIgaXMgYSBzZWdtZW50IGFuZCBsaW5lMSBpcyBpbmZpbml0ZSwgdGhleSBpbnRlcnNlY3QgaWY6XG4gIGlmIChiID4gMCAmJiBiIDwgMSkge1xuICAgIHJlc3VsdC5vbkxpbmUyID0gdHJ1ZTtcbiAgfVxuICAvLyBpZiBsaW5lMSBhbmQgbGluZTIgYXJlIHNlZ21lbnRzLCB0aGV5IGludGVyc2VjdCBpZiBib3RoIG9mIHRoZSBhYm92ZSBhcmUgdHJ1ZVxuICBpZihyZXN1bHQub25MaW5lMSAmJiByZXN1bHQub25MaW5lMil7XG4gICAgcmV0dXJuIFtyZXN1bHQueCwgcmVzdWx0LnldO1xuICB9XG4gIGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIiwiLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIExpbmVTdHJpbmd9IHtAbGluayBGZWF0dXJlfSBiYXNlZCBvbiBhXG4gKiBjb29yZGluYXRlIGFycmF5LiBQcm9wZXJ0aWVzIGNhbiBiZSBhZGRlZCBvcHRpb25hbGx5LlxuICpcbiAqIEBtb2R1bGUgdHVyZi9saW5lc3RyaW5nXG4gKiBAY2F0ZWdvcnkgaGVscGVyXG4gKiBAcGFyYW0ge0FycmF5PEFycmF5PE51bWJlcj4+fSBjb29yZGluYXRlcyBhbiBhcnJheSBvZiBQb3NpdGlvbnNcbiAqIEBwYXJhbSB7T2JqZWN0fSBwcm9wZXJ0aWVzIGFuIE9iamVjdCBvZiBrZXktdmFsdWUgcGFpcnMgdG8gYWRkIGFzIHByb3BlcnRpZXNcbiAqIEByZXR1cm4ge0xpbmVTdHJpbmd9IGEgTGluZVN0cmluZyBmZWF0dXJlXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgbm8gY29vcmRpbmF0ZXMgYXJlIHBhc3NlZFxuICogQGV4YW1wbGVcbiAqIHZhciBsaW5lc3RyaW5nMSA9IHR1cmYubGluZXN0cmluZyhbXG4gKlx0Wy0yMS45NjQ0MTYsIDY0LjE0ODIwM10sXG4gKlx0Wy0yMS45NTYxNzYsIDY0LjE0MTMxNl0sXG4gKlx0Wy0yMS45MzkwMSwgNjQuMTM1OTI0XSxcbiAqXHRbLTIxLjkyNzMzNywgNjQuMTM2NjczXVxuICogXSk7XG4gKiB2YXIgbGluZXN0cmluZzIgPSB0dXJmLmxpbmVzdHJpbmcoW1xuICpcdFstMjEuOTI5MDU0LCA2NC4xMjc5ODVdLFxuICpcdFstMjEuOTEyOTE4LCA2NC4xMzQ3MjZdLFxuICpcdFstMjEuOTE2MDA3LCA2NC4xNDEwMTZdLFxuICogXHRbLTIxLjkzMDA4NCwgNjQuMTQ0NDZdXG4gKiBdLCB7bmFtZTogJ2xpbmUgMScsIGRpc3RhbmNlOiAxNDV9KTtcbiAqXG4gKiAvLz1saW5lc3RyaW5nMVxuICpcbiAqIC8vPWxpbmVzdHJpbmcyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oY29vcmRpbmF0ZXMsIHByb3BlcnRpZXMpe1xuICBpZiAoIWNvb3JkaW5hdGVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGNvb3JkaW5hdGVzIHBhc3NlZCcpO1xuICB9XG4gIHJldHVybiB7XG4gICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICAgIFwiZ2VvbWV0cnlcIjoge1xuICAgICAgXCJ0eXBlXCI6IFwiTGluZVN0cmluZ1wiLFxuICAgICAgXCJjb29yZGluYXRlc1wiOiBjb29yZGluYXRlc1xuICAgIH0sXG4gICAgXCJwcm9wZXJ0aWVzXCI6IHByb3BlcnRpZXMgfHwge31cbiAgfTtcbn07XG4iLCJ2YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcblxuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBtYXhpbXVtIHZhbHVlIG9mIGEgZmllbGQgZm9yIGEgc2V0IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgd2l0aGluIGEgc2V0IG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvbWF4XG4gKiBAY2F0ZWdvcnkgYWdncmVnYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAcGFyYW0ge3N0cmluZ30gaW5GaWVsZCB0aGUgZmllbGQgaW4gaW5wdXQgZGF0YSB0byBhbmFseXplXG4gKiBAcGFyYW0ge3N0cmluZ30gb3V0RmllbGQgdGhlIGZpZWxkIGluIHdoaWNoIHRvIHN0b3JlIHJlc3VsdHNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogd2l0aCBwcm9wZXJ0aWVzIGxpc3RlZCBhcyBgb3V0RmllbGRgIHZhbHVlc1xuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFsxMDEuNTUxNDM3LCAzLjE1MDExNF0sXG4gKiAgICAgICAgICAgWzEwMS41NTE0MzcsIDMuMjUwMjA4XSxcbiAqICAgICAgICAgICBbMTAxLjc0MjMyNCwgMy4yNTAyMDhdLFxuICogICAgICAgICAgIFsxMDEuNzQyMzI0LCAzLjE1MDExNF0sXG4gKiAgICAgICAgICAgWzEwMS41NTE0MzcsIDMuMTUwMTE0XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbMTAxLjY1OTkyNywgMy4wMTE2MTJdLFxuICogICAgICAgICAgIFsxMDEuNjU5OTI3LCAzLjE0Mzk0NF0sXG4gKiAgICAgICAgICAgWzEwMS45MTM5ODYsIDMuMTQzOTQ0XSxcbiAqICAgICAgICAgICBbMTAxLjkxMzk4NiwgMy4wMTE2MTJdLFxuICogICAgICAgICAgIFsxMDEuNjU5OTI3LCAzLjAxMTYxMl1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwMS41NjEwNSwgMy4yMTM4NzRdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDYwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMDEuNzA5MzY1LCAzLjIxMTgxN11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMTAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwMS42NDU1MDcsIDMuMTY5MzExXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAxLjcwODY3OSwgMy4wNzEyNjZdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDMwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMDEuODI2NzgyLCAzLjA4MTU1MV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGFnZ3JlZ2F0ZWQgPSB0dXJmLm1heChcbiAqICAgcG9seWdvbnMsIHBvaW50cywgJ3BvcHVsYXRpb24nLCAnbWF4Jyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChcbiAqICAgYWdncmVnYXRlZC5mZWF0dXJlcyk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlGQywgcHRGQywgaW5GaWVsZCwgb3V0RmllbGQpe1xuICBwb2x5RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwb2x5KXtcbiAgICBpZighcG9seS5wcm9wZXJ0aWVzKXtcbiAgICAgIHBvbHkucHJvcGVydGllcyA9IHt9O1xuICAgIH1cbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgcHRGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHB0KXtcbiAgICAgIGlmIChpbnNpZGUocHQsIHBvbHkpKSB7XG4gICAgICAgIHZhbHVlcy5wdXNoKHB0LnByb3BlcnRpZXNbaW5GaWVsZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHBvbHkucHJvcGVydGllc1tvdXRGaWVsZF0gPSBtYXgodmFsdWVzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHBvbHlGQztcbn1cblxuZnVuY3Rpb24gbWF4KHgpIHtcbiAgICB2YXIgdmFsdWU7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIE9uIHRoZSBmaXJzdCBpdGVyYXRpb24gb2YgdGhpcyBsb29wLCBtYXggaXNcbiAgICAgICAgLy8gdW5kZWZpbmVkIGFuZCBpcyB0aHVzIG1hZGUgdGhlIG1heGltdW0gZWxlbWVudCBpbiB0aGUgYXJyYXlcbiAgICAgICAgaWYgKHhbaV0gPiB2YWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IHhbaV07XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cbiIsInZhciBpbnNpZGUgPSByZXF1aXJlKCd0dXJmLWluc2lkZScpO1xuXG4vKipcbiAqIENhbGN1bGF0ZXMgdGhlIG1lZGlhbiB2YWx1ZSBvZiBhIGZpZWxkIGZvciBhIHNldCBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIHdpdGhpbiBhIHNldCBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMuXG4gKlxuICogQG1vZHVsZSB0dXJmL21lZGlhblxuICogQGNhdGVnb3J5IGFnZ3JlZ2F0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtzdHJpbmd9IGluRmllbGQgdGhlIGZpZWxkIGluIGlucHV0IGRhdGEgdG8gYW5hbHl6ZVxuICogQHBhcmFtIHtzdHJpbmd9IG91dEZpZWxkIHRoZSBmaWVsZCBpbiB3aGljaCB0byBzdG9yZSByZXN1bHRzXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIHdpdGggcHJvcGVydGllcyBsaXN0ZWQgYXMgYG91dEZpZWxkYCB2YWx1ZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9seWdvbnMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbMTguNDAwMDM5LCAtMzMuOTcwNjk3XSxcbiAqICAgICAgICAgICBbMTguNDAwMDM5LCAtMzMuODE4NTE4XSxcbiAqICAgICAgICAgICBbMTguNjY1NzcxLCAtMzMuODE4NTE4XSxcbiAqICAgICAgICAgICBbMTguNjY1NzcxLCAtMzMuOTcwNjk3XSxcbiAqICAgICAgICAgICBbMTguNDAwMDM5LCAtMzMuOTcwNjk3XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbMTguNTM4NzQyLCAtMzQuMDUwMzgzXSxcbiAqICAgICAgICAgICBbMTguNTM4NzQyLCAtMzMuOTg3MjFdLFxuICogICAgICAgICAgIFsxOC43MDM1MzYsIC0zMy45ODcyMV0sXG4gKiAgICAgICAgICAgWzE4LjcwMzUzNiwgLTM0LjA1MDM4M10sXG4gKiAgICAgICAgICAgWzE4LjUzODc0MiwgLTM0LjA1MDM4M11cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzE4LjUxNDAyMiwgLTMzLjg2MDE1Ml1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzE4LjQ4OTk5LCAtMzMuOTI2MjY5XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTguNTgzMzc0LCAtMzMuOTA1NzU1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTguNTkxNjEzLCAtMzQuMDI0Nzc4XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAzMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTguNjUzNDExLCAtMzQuMDE3OTQ5XVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgbWVkaWFucyA9IHR1cmYubWVkaWFuKFxuICogIHBvbHlnb25zLCBwb2ludHMsICdwb3B1bGF0aW9uJywgJ21lZGlhbicpO1xuICpcbiAqIHZhciByZXN1bHRGZWF0dXJlcyA9IHBvaW50cy5mZWF0dXJlcy5jb25jYXQoXG4gKiAgIG1lZGlhbnMuZmVhdHVyZXMpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5RkMsIHB0RkMsIGluRmllbGQsIG91dEZpZWxkKXtcbiAgcG9seUZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocG9seSl7XG4gICAgaWYoIXBvbHkucHJvcGVydGllcyl7XG4gICAgICBwb2x5LnByb3BlcnRpZXMgPSB7fTtcbiAgICB9XG4gICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgIHB0RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwdCl7XG4gICAgICBpZiAoaW5zaWRlKHB0LCBwb2x5KSkge1xuICAgICAgICB2YWx1ZXMucHVzaChwdC5wcm9wZXJ0aWVzW2luRmllbGRdKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBwb2x5LnByb3BlcnRpZXNbb3V0RmllbGRdID0gbWVkaWFuKHZhbHVlcyk7XG4gIH0pO1xuXG4gIHJldHVybiBwb2x5RkM7XG59O1xuXG5mdW5jdGlvbiBtZWRpYW4oeCkge1xuICAgIC8vIFRoZSBtZWRpYW4gb2YgYW4gZW1wdHkgbGlzdCBpcyBudWxsXG4gICAgaWYgKHgubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgIC8vIFNvcnRpbmcgdGhlIGFycmF5IG1ha2VzIGl0IGVhc3kgdG8gZmluZCB0aGUgY2VudGVyLCBidXRcbiAgICAvLyB1c2UgYC5zbGljZSgpYCB0byBlbnN1cmUgdGhlIG9yaWdpbmFsIGFycmF5IGB4YCBpcyBub3QgbW9kaWZpZWRcbiAgICB2YXIgc29ydGVkID0geC5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9KTtcblxuICAgIC8vIElmIHRoZSBsZW5ndGggb2YgdGhlIGxpc3QgaXMgb2RkLCBpdCdzIHRoZSBjZW50cmFsIG51bWJlclxuICAgIGlmIChzb3J0ZWQubGVuZ3RoICUgMiA9PT0gMSkge1xuICAgICAgICByZXR1cm4gc29ydGVkWyhzb3J0ZWQubGVuZ3RoIC0gMSkgLyAyXTtcbiAgICAvLyBPdGhlcndpc2UsIHRoZSBtZWRpYW4gaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHR3byBudW1iZXJzXG4gICAgLy8gYXQgdGhlIGNlbnRlciBvZiB0aGUgbGlzdFxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBhID0gc29ydGVkWyhzb3J0ZWQubGVuZ3RoIC8gMikgLSAxXTtcbiAgICAgICAgdmFyIGIgPSBzb3J0ZWRbKHNvcnRlZC5sZW5ndGggLyAyKV07XG4gICAgICAgIHJldHVybiAoYSArIGIpIC8gMjtcbiAgICB9XG59XG4iLCJ2YXIgY2xvbmUgPSByZXF1aXJlKCdjbG9uZScpO1xudmFyIHVuaW9uID0gcmVxdWlyZSgndHVyZi11bmlvbicpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgYW5kIHJldHVybnMgYSBzaW5nbGUgbWVyZ2VkXG4gKiBwb2x5Z29uIGZlYXR1cmUuIElmIHRoZSBpbnB1dCBQb2x5Z29uIGZlYXR1cmVzIGFyZSBub3QgY29udGlndW91cywgdGhpcyBmdW5jdGlvbiByZXR1cm5zIGEge0BsaW5rIE11bHRpUG9seWdvbn0gZmVhdHVyZS5cbiAqIEBtb2R1bGUgdHVyZi9tZXJnZVxuICogQGNhdGVnb3J5IHRyYW5zZm9ybWF0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBmYyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHJldHVybiB7RmVhdHVyZX0gYSB7QGxpbmsgUG9seWdvbn0gb3Ige0BsaW5rIE11bHRpUG9seWdvbn0gZmVhdHVyZVxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJmaWxsXCI6IFwiIzBmMFwiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFs5Ljk5NDgxMiwgNTMuNTQ5NDg3XSxcbiAqICAgICAgICAgICBbMTAuMDQ2OTk3LCA1My41OTgyMDldLFxuICogICAgICAgICAgIFsxMC4xMTc3MjEsIDUzLjUzMTczN10sXG4gKiAgICAgICAgICAgWzkuOTk0ODEyLCA1My41NDk0ODddXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJmaWxsXCI6IFwiIzAwZlwiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFsxMC4wMDA5OTEsIDUzLjUwNDE4XSxcbiAqICAgICAgICAgICBbMTAuMDM4MDcsIDUzLjU2MjUzOV0sXG4gKiAgICAgICAgICAgWzkuOTI2ODM0LCA1My41NTE3MzFdLFxuICogICAgICAgICAgIFsxMC4wMDA5OTEsIDUzLjUwNDE4XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgbWVyZ2VkID0gdHVyZi5tZXJnZShwb2x5Z29ucyk7XG4gKlxuICogLy89cG9seWdvbnNcbiAqXG4gKiAvLz1tZXJnZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5Z29ucywgZG9uZSl7XG5cbiAgdmFyIG1lcmdlZCA9IGNsb25lKHBvbHlnb25zLmZlYXR1cmVzWzBdKSxcbiAgICBmZWF0dXJlcyA9IHBvbHlnb25zLmZlYXR1cmVzO1xuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBmZWF0dXJlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIHZhciBwb2x5ID0gZmVhdHVyZXNbaV07XG5cbiAgICBpZihwb2x5Lmdlb21ldHJ5KXtcbiAgICAgIG1lcmdlZCA9IHVuaW9uKG1lcmdlZCwgcG9seSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG1lcmdlZDtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIG9iamVjdFRvU3RyaW5nKG8pIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKTtcbn1cblxuLy8gc2hpbSBmb3IgTm9kZSdzICd1dGlsJyBwYWNrYWdlXG4vLyBETyBOT1QgUkVNT1ZFIFRISVMhIEl0IGlzIHJlcXVpcmVkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggRW5kZXJKUyAoaHR0cDovL2VuZGVyanMuY29tLykuXG52YXIgdXRpbCA9IHtcbiAgaXNBcnJheTogZnVuY3Rpb24gKGFyKSB7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXIpIHx8ICh0eXBlb2YgYXIgPT09ICdvYmplY3QnICYmIG9iamVjdFRvU3RyaW5nKGFyKSA9PT0gJ1tvYmplY3QgQXJyYXldJyk7XG4gIH0sXG4gIGlzRGF0ZTogZnVuY3Rpb24gKGQpIHtcbiAgICByZXR1cm4gdHlwZW9mIGQgPT09ICdvYmplY3QnICYmIG9iamVjdFRvU3RyaW5nKGQpID09PSAnW29iamVjdCBEYXRlXSc7XG4gIH0sXG4gIGlzUmVnRXhwOiBmdW5jdGlvbiAocmUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHJlID09PSAnb2JqZWN0JyAmJiBvYmplY3RUb1N0cmluZyhyZSkgPT09ICdbb2JqZWN0IFJlZ0V4cF0nO1xuICB9LFxuICBnZXRSZWdFeHBGbGFnczogZnVuY3Rpb24gKHJlKSB7XG4gICAgdmFyIGZsYWdzID0gJyc7XG4gICAgcmUuZ2xvYmFsICYmIChmbGFncyArPSAnZycpO1xuICAgIHJlLmlnbm9yZUNhc2UgJiYgKGZsYWdzICs9ICdpJyk7XG4gICAgcmUubXVsdGlsaW5lICYmIChmbGFncyArPSAnbScpO1xuICAgIHJldHVybiBmbGFncztcbiAgfVxufTtcblxuXG5pZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG4gIG1vZHVsZS5leHBvcnRzID0gY2xvbmU7XG5cbi8qKlxuICogQ2xvbmVzIChjb3BpZXMpIGFuIE9iamVjdCB1c2luZyBkZWVwIGNvcHlpbmcuXG4gKlxuICogVGhpcyBmdW5jdGlvbiBzdXBwb3J0cyBjaXJjdWxhciByZWZlcmVuY2VzIGJ5IGRlZmF1bHQsIGJ1dCBpZiB5b3UgYXJlIGNlcnRhaW5cbiAqIHRoZXJlIGFyZSBubyBjaXJjdWxhciByZWZlcmVuY2VzIGluIHlvdXIgb2JqZWN0LCB5b3UgY2FuIHNhdmUgc29tZSBDUFUgdGltZVxuICogYnkgY2FsbGluZyBjbG9uZShvYmosIGZhbHNlKS5cbiAqXG4gKiBDYXV0aW9uOiBpZiBgY2lyY3VsYXJgIGlzIGZhbHNlIGFuZCBgcGFyZW50YCBjb250YWlucyBjaXJjdWxhciByZWZlcmVuY2VzLFxuICogeW91ciBwcm9ncmFtIG1heSBlbnRlciBhbiBpbmZpbml0ZSBsb29wIGFuZCBjcmFzaC5cbiAqXG4gKiBAcGFyYW0gYHBhcmVudGAgLSB0aGUgb2JqZWN0IHRvIGJlIGNsb25lZFxuICogQHBhcmFtIGBjaXJjdWxhcmAgLSBzZXQgdG8gdHJ1ZSBpZiB0aGUgb2JqZWN0IHRvIGJlIGNsb25lZCBtYXkgY29udGFpblxuICogICAgY2lyY3VsYXIgcmVmZXJlbmNlcy4gKG9wdGlvbmFsIC0gdHJ1ZSBieSBkZWZhdWx0KVxuICogQHBhcmFtIGBkZXB0aGAgLSBzZXQgdG8gYSBudW1iZXIgaWYgdGhlIG9iamVjdCBpcyBvbmx5IHRvIGJlIGNsb25lZCB0b1xuICogICAgYSBwYXJ0aWN1bGFyIGRlcHRoLiAob3B0aW9uYWwgLSBkZWZhdWx0cyB0byBJbmZpbml0eSlcbiAqIEBwYXJhbSBgcHJvdG90eXBlYCAtIHNldHMgdGhlIHByb3RvdHlwZSB0byBiZSB1c2VkIHdoZW4gY2xvbmluZyBhbiBvYmplY3QuXG4gKiAgICAob3B0aW9uYWwgLSBkZWZhdWx0cyB0byBwYXJlbnQgcHJvdG90eXBlKS5cbiovXG5cbmZ1bmN0aW9uIGNsb25lKHBhcmVudCwgY2lyY3VsYXIsIGRlcHRoLCBwcm90b3R5cGUpIHtcbiAgLy8gbWFpbnRhaW4gdHdvIGFycmF5cyBmb3IgY2lyY3VsYXIgcmVmZXJlbmNlcywgd2hlcmUgY29ycmVzcG9uZGluZyBwYXJlbnRzXG4gIC8vIGFuZCBjaGlsZHJlbiBoYXZlIHRoZSBzYW1lIGluZGV4XG4gIHZhciBhbGxQYXJlbnRzID0gW107XG4gIHZhciBhbGxDaGlsZHJlbiA9IFtdO1xuXG4gIHZhciB1c2VCdWZmZXIgPSB0eXBlb2YgQnVmZmVyICE9ICd1bmRlZmluZWQnO1xuXG4gIGlmICh0eXBlb2YgY2lyY3VsYXIgPT0gJ3VuZGVmaW5lZCcpXG4gICAgY2lyY3VsYXIgPSB0cnVlO1xuXG4gIGlmICh0eXBlb2YgZGVwdGggPT0gJ3VuZGVmaW5lZCcpXG4gICAgZGVwdGggPSBJbmZpbml0eTtcblxuICAvLyByZWN1cnNlIHRoaXMgZnVuY3Rpb24gc28gd2UgZG9uJ3QgcmVzZXQgYWxsUGFyZW50cyBhbmQgYWxsQ2hpbGRyZW5cbiAgZnVuY3Rpb24gX2Nsb25lKHBhcmVudCwgZGVwdGgpIHtcbiAgICAvLyBjbG9uaW5nIG51bGwgYWx3YXlzIHJldHVybnMgbnVsbFxuICAgIGlmIChwYXJlbnQgPT09IG51bGwpXG4gICAgICByZXR1cm4gbnVsbDtcblxuICAgIGlmIChkZXB0aCA9PSAwKVxuICAgICAgcmV0dXJuIHBhcmVudDtcblxuICAgIHZhciBjaGlsZDtcbiAgICB2YXIgcHJvdG87XG4gICAgaWYgKHR5cGVvZiBwYXJlbnQgIT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybiBwYXJlbnQ7XG4gICAgfVxuXG4gICAgaWYgKHV0aWwuaXNBcnJheShwYXJlbnQpKSB7XG4gICAgICBjaGlsZCA9IFtdO1xuICAgIH0gZWxzZSBpZiAodXRpbC5pc1JlZ0V4cChwYXJlbnQpKSB7XG4gICAgICBjaGlsZCA9IG5ldyBSZWdFeHAocGFyZW50LnNvdXJjZSwgdXRpbC5nZXRSZWdFeHBGbGFncyhwYXJlbnQpKTtcbiAgICAgIGlmIChwYXJlbnQubGFzdEluZGV4KSBjaGlsZC5sYXN0SW5kZXggPSBwYXJlbnQubGFzdEluZGV4O1xuICAgIH0gZWxzZSBpZiAodXRpbC5pc0RhdGUocGFyZW50KSkge1xuICAgICAgY2hpbGQgPSBuZXcgRGF0ZShwYXJlbnQuZ2V0VGltZSgpKTtcbiAgICB9IGVsc2UgaWYgKHVzZUJ1ZmZlciAmJiBCdWZmZXIuaXNCdWZmZXIocGFyZW50KSkge1xuICAgICAgY2hpbGQgPSBuZXcgQnVmZmVyKHBhcmVudC5sZW5ndGgpO1xuICAgICAgcGFyZW50LmNvcHkoY2hpbGQpO1xuICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodHlwZW9mIHByb3RvdHlwZSA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihwYXJlbnQpO1xuICAgICAgICBjaGlsZCA9IE9iamVjdC5jcmVhdGUocHJvdG8pO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGNoaWxkID0gT2JqZWN0LmNyZWF0ZShwcm90b3R5cGUpO1xuICAgICAgICBwcm90byA9IHByb3RvdHlwZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2lyY3VsYXIpIHtcbiAgICAgIHZhciBpbmRleCA9IGFsbFBhcmVudHMuaW5kZXhPZihwYXJlbnQpO1xuXG4gICAgICBpZiAoaW5kZXggIT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGFsbENoaWxkcmVuW2luZGV4XTtcbiAgICAgIH1cbiAgICAgIGFsbFBhcmVudHMucHVzaChwYXJlbnQpO1xuICAgICAgYWxsQ2hpbGRyZW4ucHVzaChjaGlsZCk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSBpbiBwYXJlbnQpIHtcbiAgICAgIHZhciBhdHRycztcbiAgICAgIGlmIChwcm90bykge1xuICAgICAgICBhdHRycyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sIGkpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoYXR0cnMgJiYgYXR0cnMuc2V0ID09IG51bGwpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjaGlsZFtpXSA9IF9jbG9uZShwYXJlbnRbaV0sIGRlcHRoIC0gMSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNoaWxkO1xuICB9XG5cbiAgcmV0dXJuIF9jbG9uZShwYXJlbnQsIGRlcHRoKTtcbn1cblxuLyoqXG4gKiBTaW1wbGUgZmxhdCBjbG9uZSB1c2luZyBwcm90b3R5cGUsIGFjY2VwdHMgb25seSBvYmplY3RzLCB1c2VmdWxsIGZvciBwcm9wZXJ0eVxuICogb3ZlcnJpZGUgb24gRkxBVCBjb25maWd1cmF0aW9uIG9iamVjdCAobm8gbmVzdGVkIHByb3BzKS5cbiAqXG4gKiBVU0UgV0lUSCBDQVVUSU9OISBUaGlzIG1heSBub3QgYmVoYXZlIGFzIHlvdSB3aXNoIGlmIHlvdSBkbyBub3Qga25vdyBob3cgdGhpc1xuICogd29ya3MuXG4gKi9cbmNsb25lLmNsb25lUHJvdG90eXBlID0gZnVuY3Rpb24ocGFyZW50KSB7XG4gIGlmIChwYXJlbnQgPT09IG51bGwpXG4gICAgcmV0dXJuIG51bGw7XG5cbiAgdmFyIGMgPSBmdW5jdGlvbiAoKSB7fTtcbiAgYy5wcm90b3R5cGUgPSBwYXJlbnQ7XG4gIHJldHVybiBuZXcgYygpO1xufTtcbiIsIi8vIGh0dHA6Ly9jcy5zZWx1LmVkdS9+cmJ5cmQvbWF0aC9taWRwb2ludC9cbi8vICgoeDEreDIpLzIpLCAoKHkxK3kyKS8yKVxudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xuXG4vKipcbiAqIFRha2VzIHR3byB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIGFuZCByZXR1cm5zIGEgUG9pbnQgbWlkd2F5IGJldHdlZW4gdGhlIHR3by5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvbWlkcG9pbnRcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtQb2ludH0gcHQxIGZpcnN0IHBvaW50XG4gKiBAcGFyYW0ge1BvaW50fSBwdDIgc2Vjb25kIHBvaW50XG4gKiBAcmV0dXJuIHtQb2ludH0gYSBwb2ludCBiZXR3ZWVuIHRoZSB0d29cbiAqIEBleGFtcGxlXG4gKiB2YXIgcHQxID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFsxNDQuODM0ODIzLCAtMzcuNzcxMjU3XVxuICogICB9XG4gKiB9O1xuICogdmFyIHB0MiA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbMTQ1LjE0MjQ0LCAtMzcuODMwOTM3XVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBtaWRwb2ludGVkID0gdHVyZi5taWRwb2ludChwdDEsIHB0Mik7XG4gKiBtaWRwb2ludGVkLnByb3BlcnRpZXNbJ21hcmtlci1jb2xvciddID0gJyNmMDAnO1xuICpcbiAqXG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtwdDEsIHB0MiwgbWlkcG9pbnRlZF1cbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnQxLCBwb2ludDIpIHtcbiAgaWYgKHBvaW50MSA9PT0gbnVsbCB8fCBwb2ludDIgPT09IG51bGwpe1xuICAgIHRocm93IG5ldyBFcnJvcignTGVzcyB0aGFuIHR3byBwb2ludHMgcGFzc2VkLicpO1xuICB9XG5cbiAgdmFyIHgxID0gcG9pbnQxLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdO1xuICB2YXIgeDIgPSBwb2ludDIuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF07XG4gIHZhciB5MSA9IHBvaW50MS5nZW9tZXRyeS5jb29yZGluYXRlc1sxXTtcbiAgdmFyIHkyID0gcG9pbnQyLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdO1xuXG4gIHZhciB4MyA9IHgxICsgeDI7XG4gIHZhciBtaWRYID0geDMvMjtcbiAgdmFyIHkzID0geTEgKyB5MjtcbiAgdmFyIG1pZFkgPSB5My8yO1xuXG4gIHJldHVybiBwb2ludChbbWlkWCwgbWlkWV0pO1xufTtcbiIsInZhciBpbnNpZGUgPSByZXF1aXJlKCd0dXJmLWluc2lkZScpO1xuXG4vKipcbiogQ2FsY3VsYXRlcyB0aGUgbWluaW11bSB2YWx1ZSBvZiBhIGZpZWxkIGZvciB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIHdpdGhpbiBhIHNldCBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMuXG4qXG4qIEBtb2R1bGUgdHVyZi9taW5cbiogQGNhdGVnb3J5IGFnZ3JlZ2F0aW9uXG4qIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4qIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiogQHBhcmFtIHtzdHJpbmd9IGluRmllbGQgdGhlIGZpZWxkIGluIGlucHV0IGRhdGEgdG8gYW5hbHl6ZVxuKiBAcGFyYW0ge3N0cmluZ30gb3V0RmllbGQgdGhlIGZpZWxkIGluIHdoaWNoIHRvIHN0b3JlIHJlc3VsdHNcbiogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4qIHdpdGggcHJvcGVydGllcyBsaXN0ZWQgYXMgYG91dEZpZWxkYCB2YWx1ZXNcbiogQGV4YW1wbGVcbiogdmFyIHBvbHlnb25zID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4qICAgXCJmZWF0dXJlc1wiOiBbXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuKiAgICAgICAgICAgWzcyLjgwOTY1OCwgMTguOTYxODE4XSxcbiogICAgICAgICAgIFs3Mi44MDk2NTgsIDE4Ljk3NDgwNV0sXG4qICAgICAgICAgICBbNzIuODI3MTY3LCAxOC45NzQ4MDVdLFxuKiAgICAgICAgICAgWzcyLjgyNzE2NywgMTguOTYxODE4XSxcbiogICAgICAgICAgIFs3Mi44MDk2NTgsIDE4Ljk2MTgxOF1cbiogICAgICAgICBdXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuKiAgICAgICAgICAgWzcyLjgyMDk4NywgMTguOTQ3MDQzXSxcbiogICAgICAgICAgIFs3Mi44MjA5ODcsIDE4Ljk1OTIyXSxcbiogICAgICAgICAgIFs3Mi44NDEyNDMsIDE4Ljk1OTIyXSxcbiogICAgICAgICAgIFs3Mi44NDEyNDMsIDE4Ljk0NzA0M10sXG4qICAgICAgICAgICBbNzIuODIwOTg3LCAxOC45NDcwNDNdXG4qICAgICAgICAgXV1cbiogICAgICAgfVxuKiAgICAgfVxuKiAgIF1cbiogfTtcbiogdmFyIHBvaW50cyA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuKiAgIFwiZmVhdHVyZXNcIjogW1xuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzcyLjgxNDQ2NCwgMTguOTcxMzk2XVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbNzIuODIwMDQzLCAxOC45Njk3NzJdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFs3Mi44MTcyOTYsIDE4Ljk2NDI1M11cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzcyLjgzNTc1LCAxOC45NTQ4MzddXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAzMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFs3Mi44MjgxOTcsIDE4Ljk1MDk0XVxuKiAgICAgICB9XG4qICAgICB9XG4qICAgXVxuKiB9O1xuKlxuKiB2YXIgbWluaW11bXMgPSB0dXJmLm1pbihcbiogICBwb2x5Z29ucywgcG9pbnRzLCAncG9wdWxhdGlvbicsICdtaW4nKTtcbipcbiogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChcbiogICBtaW5pbXVtcy5mZWF0dXJlcyk7XG4qIHZhciByZXN1bHQgPSB7XG4qICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4qIH07XG4qXG4qIC8vPXJlc3VsdFxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9seUZDLCBwdEZDLCBpbkZpZWxkLCBvdXRGaWVsZCl7XG4gIHBvbHlGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHBvbHkpe1xuICAgIGlmKCFwb2x5LnByb3BlcnRpZXMpe1xuICAgICAgcG9seS5wcm9wZXJ0aWVzID0ge307XG4gICAgfVxuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICBwdEZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocHQpe1xuICAgICAgaWYgKGluc2lkZShwdCwgcG9seSkpIHtcbiAgICAgICAgdmFsdWVzLnB1c2gocHQucHJvcGVydGllc1tpbkZpZWxkXSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcG9seS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IG1pbih2YWx1ZXMpO1xuICB9KTtcblxuICByZXR1cm4gcG9seUZDO1xufTtcblxuZnVuY3Rpb24gbWluKHgpIHtcbiAgICB2YXIgdmFsdWU7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIE9uIHRoZSBmaXJzdCBpdGVyYXRpb24gb2YgdGhpcyBsb29wLCBtaW4gaXNcbiAgICAgICAgLy8gdW5kZWZpbmVkIGFuZCBpcyB0aHVzIG1hZGUgdGhlIG1pbmltdW0gZWxlbWVudCBpbiB0aGUgYXJyYXlcbiAgICAgICAgaWYgKHhbaV0gPCB2YWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IHhbaV07XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cbiIsInZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBQb2ludH0gZmVhdHVyZSBhbmQgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIFBvaW50IGZlYXR1cmVzIGFuZCByZXR1cm5zIHRoZSBQb2ludCBmZWF0dXJlIGZyb20gdGhlIEZlYXR1cmVDb2xsZWN0aW9uIGNsb3Nlc3QgdG8gdGhlIGlucHV0IHBvaW50LlxuICpcbiAqIEBtb2R1bGUgdHVyZi9uZWFyZXN0XG4gKiBAY2F0ZWdvcnkgY2xhc3NpZmljYXRpb25cbiAqIEBwYXJhbSB7UG9pbnR9IHBvaW50IHRoZSByZWZlcmVuY2UgcG9pbnRcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IGFnYWluc3QgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBQb2ludCBmZWF0dXJlc1xuICogQHJldHVybiB7RmVhdHVyZX0gdGhlIGNsb3Nlc3QgUG9pbnQgZmVhdHVyZSBpbiBgYWdhaW5zdGAgdG8gYHBvaW50YFxuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwibWFya2VyLWNvbG9yXCI6IFwiIzBmMFwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbMjguOTY1Nzk3LCA0MS4wMTAwODZdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgYWdhaW5zdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzI4Ljk3Mzg2NSwgNDEuMDExMTIyXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsyOC45NDg0NTksIDQxLjAyNDIwNF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMjguOTM4Njc0LCA0MS4wMTMzMjRdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBuZWFyZXN0ID0gdHVyZi5uZWFyZXN0KHBvaW50LCBhZ2FpbnN0KTtcbiAqIG5lYXJlc3QucHJvcGVydGllc1snbWFya2VyLWNvbG9yJ10gPSAnI2YwMCc7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gYWdhaW5zdC5mZWF0dXJlcy5jb25jYXQocG9pbnQpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih0YXJnZXRQb2ludCwgcG9pbnRzKXtcbiAgdmFyIG5lYXJlc3RQb2ludDtcbiAgdmFyIGNvdW50ID0gMDtcbiAgdmFyIGRpc3QgPSBJbmZpbml0eTtcbiAgcG9pbnRzLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocHQpe1xuICAgIGlmKCFuZWFyZXN0UG9pbnQpe1xuICAgICAgbmVhcmVzdFBvaW50ID0gcHQ7XG4gICAgICB2YXIgZGlzdCA9IGRpc3RhbmNlKHRhcmdldFBvaW50LCBwdCwgJ21pbGVzJyk7XG4gICAgICBuZWFyZXN0UG9pbnQucHJvcGVydGllcy5kaXN0YW5jZSA9IGRpc3Q7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB2YXIgZGlzdCA9IGRpc3RhbmNlKHRhcmdldFBvaW50LCBwdCwgJ21pbGVzJyk7XG4gICAgICBpZihkaXN0IDwgbmVhcmVzdFBvaW50LnByb3BlcnRpZXMuZGlzdGFuY2Upe1xuICAgICAgICBuZWFyZXN0UG9pbnQgPSBwdDtcbiAgICAgICAgbmVhcmVzdFBvaW50LnByb3BlcnRpZXMuZGlzdGFuY2UgPSBkaXN0O1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGRlbGV0ZSBuZWFyZXN0UG9pbnQucHJvcGVydGllcy5kaXN0YW5jZTtcbiAgcmV0dXJuIG5lYXJlc3RQb2ludDtcbn1cbiIsIi8qKlxuICogVGFrZXMgYSB0cmlhbmd1bGFyIHBsYW5lIGFzIGEge0BsaW5rIFBvbHlnb259IGZlYXR1cmVcbiAqIGFuZCBhIHtAbGluayBQb2ludH0gZmVhdHVyZSB3aXRoaW4gdGhhdCB0cmlhbmdsZSBhbmQgcmV0dXJucyB0aGUgei12YWx1ZVxuICogYXQgdGhhdCBwb2ludC4gVGhlIFBvbHlnb24gbmVlZHMgdG8gaGF2ZSBwcm9wZXJ0aWVzIGBhYCwgYGJgLCBhbmQgYGNgXG4gKiB0aGF0IGRlZmluZSB0aGUgdmFsdWVzIGF0IGl0cyB0aHJlZSBjb3JuZXJzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9wbGFuZXBvaW50XG4gKiBAY2F0ZWdvcnkgaW50ZXJwb2xhdGlvblxuICogQHBhcmFtIHtQb2ludH0gaW50ZXJwb2xhdGVkUG9pbnQgdGhlIFBvaW50IGZvciB3aGljaCBhIHotdmFsdWUgd2lsbCBiZSBjYWxjdWxhdGVkXG4gKiBAcGFyYW0ge1BvbHlnb259IHRyaWFuZ2xlIGEgUG9seWdvbiBmZWF0dXJlIHdpdGggdGhyZWUgdmVydGljZXNcbiAqIEByZXR1cm4ge251bWJlcn0gdGhlIHotdmFsdWUgZm9yIGBpbnRlcnBvbGF0ZWRQb2ludGBcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogWy03NS4zMjIxLCAzOS41MjldXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcG9pbnQgPSB0dXJmLnBvaW50KFstNzUuMzIyMSwgMzkuNTI5XSk7XG4gKiAvLyB0cmlhbmdsZSBpcyBhIHBvbHlnb24gd2l0aCBcImFcIiwgXCJiXCIsXG4gKiAvLyBhbmQgXCJjXCIgdmFsdWVzIHJlcHJlc2VudGluZ1xuICogLy8gdGhlIHZhbHVlcyBvZiB0aGUgY29vcmRpbmF0ZXMgaW4gb3JkZXIuXG4gKiB2YXIgdHJpYW5nbGUgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcImFcIjogMTEsXG4gKiAgICAgXCJiXCI6IDEyMixcbiAqICAgICBcImNcIjogNDRcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstNzUuMTIyMSwgMzkuNTddLFxuICogICAgICAgWy03NS41OCwgMzkuMThdLFxuICogICAgICAgWy03NS45NywgMzkuODZdLFxuICogICAgICAgWy03NS4xMjIxLCAzOS41N11cbiAqICAgICBdXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBmZWF0dXJlcyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbdHJpYW5nbGUsIHBvaW50XVxuICogfTtcbiAqXG4gKiB2YXIgelZhbHVlID0gdHVyZi5wbGFuZXBvaW50KHBvaW50LCB0cmlhbmdsZSk7XG4gKlxuICogLy89ZmVhdHVyZXNcbiAqXG4gKiAvLz16VmFsdWVcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2ludCwgdHJpYW5nbGUpe1xuICB2YXIgeCA9IHBvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgeSA9IHBvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgeDEgPSB0cmlhbmdsZS5nZW9tZXRyeS5jb29yZGluYXRlc1swXVswXVswXSxcbiAgICAgIHkxID0gdHJpYW5nbGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF1bMF1bMV0sXG4gICAgICB6MSA9IHRyaWFuZ2xlLnByb3BlcnRpZXMuYSxcbiAgICAgIHgyID0gdHJpYW5nbGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF1bMV1bMF0sXG4gICAgICB5MiA9IHRyaWFuZ2xlLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdWzFdWzFdLFxuICAgICAgejIgPSB0cmlhbmdsZS5wcm9wZXJ0aWVzLmIsXG4gICAgICB4MyA9IHRyaWFuZ2xlLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdWzJdWzBdLFxuICAgICAgeTMgPSB0cmlhbmdsZS5nZW9tZXRyeS5jb29yZGluYXRlc1swXVsyXVsxXSxcbiAgICAgIHozID0gdHJpYW5nbGUucHJvcGVydGllcy5jO1xuXG4gIHZhciB6ID0gKHozICogKHgteDEpICogKHkteTIpICsgejEgKiAoeC14MikgKiAoeS15MykgKyB6MiAqICh4LXgzKSAqICh5LXkxKSAtXG4gICAgICB6MiAqICh4LXgxKSAqICh5LXkzKSAtIHozICogKHgteDIpICogKHkteTEpIC0gejEgKiAoeC14MykgKiAoeS15MikpIC9cbiAgICAgICgoeC14MSkgKiAoeS15MikgKyAoeC14MikgKiAoeS15MykgKyh4LXgzKSAqICh5LXkxKSAtXG4gICAgICAgKHgteDEpICogKHkteTMpIC0gKHgteDIpICogKHkteTEpIC0gKHgteDMpICogKHkteTIpKTtcblxuICByZXR1cm4gejtcbn07XG4iLCJ2YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG52YXIgZmVhdHVyZWNvbGxlY3Rpb24gPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG52YXIgZGlzdGFuY2UgPSByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyk7XG4vKipcbiAqIFRha2VzIGEgYm91bmRpbmcgYm94IGFuZCBhIGNlbGwgZGVwdGggYW5kIHJldHVybnMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgaW4gYSBncmlkLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9wb2ludC1ncmlkXG4gKiBAY2F0ZWdvcnkgaW50ZXJwb2xhdGlvblxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBleHRlbnQgZXh0ZW50IGluIFttaW5YLCBtaW5ZLCBtYXhYLCBtYXhZXSBvcmRlclxuICogQHBhcmFtIHtOdW1iZXJ9IGRlcHRoIGhvdyBtYW55IGNlbGxzIHRvIG91dHB1dFxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGdyaWQgYXMgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aCB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGV4dGVudCA9IFstNzAuODIzMzY0LCAtMzMuNTUzOTg0LCAtNzAuNDczMTc1LCAtMzMuMzAyOTg2XTtcbiAqIHZhciBkZXB0aCA9IDEwO1xuICpcbiAqIHZhciBncmlkID0gdHVyZi5wb2ludEdyaWQoZXh0ZW50LCBkZXB0aCk7XG4gKlxuICogLy89Z3JpZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChiYm94LCBjZWxsLCB1bml0cykge1xuICB2YXIgZmMgPSBmZWF0dXJlY29sbGVjdGlvbihbXSk7XG4gIHZhciB4RnJhY3Rpb24gPSBjZWxsIC8gKGRpc3RhbmNlKHBvaW50KFtiYm94WzBdLCBiYm94WzFdXSksIHBvaW50KFtiYm94WzJdLCBiYm94WzFdXSksIHVuaXRzKSk7XG4gIHZhciBjZWxsV2lkdGggPSB4RnJhY3Rpb24gKiAoYmJveFsyXSAtIGJib3hbMF0pO1xuICB2YXIgeUZyYWN0aW9uID0gY2VsbCAvIChkaXN0YW5jZShwb2ludChbYmJveFswXSwgYmJveFsxXV0pLCBwb2ludChbYmJveFswXSwgYmJveFszXV0pLCB1bml0cykpO1xuICB2YXIgY2VsbEhlaWdodCA9IHlGcmFjdGlvbiAqIChiYm94WzNdIC0gYmJveFsxXSk7XG5cbiAgdmFyIGN1cnJlbnRYID0gYmJveFswXTtcbiAgd2hpbGUgKGN1cnJlbnRYIDw9IGJib3hbMl0pIHtcbiAgICB2YXIgY3VycmVudFkgPSBiYm94WzFdO1xuICAgIHdoaWxlIChjdXJyZW50WSA8PSBiYm94WzNdKSB7XG4gICAgICBmYy5mZWF0dXJlcy5wdXNoKHBvaW50KFtjdXJyZW50WCwgY3VycmVudFldKSk7XG5cbiAgICAgIGN1cnJlbnRZICs9IGNlbGxIZWlnaHQ7XG4gICAgfVxuICAgIGN1cnJlbnRYICs9IGNlbGxXaWR0aDtcbiAgfVxuICBcbiAgcmV0dXJuIGZjO1xufSIsInZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcbnZhciBsaW5lc3RyaW5nID0gcmVxdWlyZSgndHVyZi1saW5lc3RyaW5nJyk7XG52YXIgYmVhcmluZyA9IHJlcXVpcmUoJ3R1cmYtYmVhcmluZycpO1xudmFyIGRlc3RpbmF0aW9uID0gcmVxdWlyZSgndHVyZi1kZXN0aW5hdGlvbicpO1xuXG4vKipcbiAqIFRha2VzIGEgUG9pbnQgYW5kIGEgTGluZVN0cmluZyBhbmQgY2FsY3VsYXRlcyB0aGUgY2xvc2VzdCBQb2ludCBvbiB0aGUgTGluZVN0cmluZ1xuICpcbiAqIEBtb2R1bGUgdHVyZi9wb2ludC1vbi1saW5lXG4gKlxuICogQHBhcmFtIHtMaW5lU3RyaW5nfSBMaW5lIHRvIHNuYXAgdG9cbiAqIEBwYXJhbSB7UG9pbnR9IFBvaW50IHRvIHNuYXAgZnJvbVxuICogQHJldHVybiB7UG9pbnR9IENsb3Nlc3QgUG9pbnQgb24gdGhlIExpbmVcbiAqIEBleGFtcGxlXG4gKiB2YXIgbGluZSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIkxpbmVTdHJpbmdcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtcbiAqICAgICAgIFstNzcuMDMxNjY5LCAzOC44Nzg2MDVdLFxuICogICAgICAgWy03Ny4wMjk2MDksIDM4Ljg4MTk0Nl0sXG4gKiAgICAgICBbLTc3LjAyMDMzOSwgMzguODg0MDg0XSxcbiAqICAgICAgIFstNzcuMDI1NjYxLCAzOC44ODU4MjFdLFxuICogICAgICAgWy03Ny4wMjE4ODQsIDM4Ljg4OTU2M10sXG4gKiAgICAgICBbLTc3LjAxOTgyNCwgMzguODkyMzY4XVxuICogICAgIF1cbiAqICAgfVxuICogfTtcbiAqIHZhciBwdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc3LjAzNzA3NiwgMzguODg0MDE3XVxuICogICB9XG4gKiB9O1xuICogXG4gKiB2YXIgc25hcHBlZCA9IHR1cmYucG9pbnRPbkxpbmUobGluZSwgcHQpO1xuICogc25hcHBlZC5wcm9wZXJ0aWVzWydtYXJrZXItY29sb3InXSA9ICcjMDBmJ1xuICpcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW2xpbmUsIHB0LCBzbmFwcGVkXVxuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChsaW5lLCBwdCkgeyAgXG4gIHZhciBjb29yZHM7XG4gIGlmKGxpbmUudHlwZSA9PT0gJ0ZlYXR1cmUnKSBjb29yZHMgPSBsaW5lLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICBlbHNlIGlmKGxpbmUudHlwZSA9PT0gJ0xpbmVTdHJpbmcnKSBjb29yZHMgPSBsaW5lLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICBlbHNlIHRocm93IG5ldyBFcnJvcignaW5wdXQgbXVzdCBiZSBhIExpbmVTdHJpbmcgRmVhdHVyZSBvciBHZW9tZXRyeScpO1xuXG4gIHJldHVybiBwb2ludE9uTGluZShwdCwgY29vcmRzKTtcbn1cblxuZnVuY3Rpb24gcG9pbnRPbkxpbmUgKHB0LCBjb29yZHMpIHtcbiAgdmFyIHVuaXRzID0gJ21pbGVzJ1xuICB2YXIgY2xvc2VzdFB0ID0gcG9pbnQoW0luZmluaXR5LCBJbmZpbml0eV0sIHtkaXN0OiBJbmZpbml0eX0pO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgIHZhciBzdGFydCA9IHBvaW50KGNvb3Jkc1tpXSlcbiAgICB2YXIgc3RvcCA9IHBvaW50KGNvb3Jkc1tpKzFdKVxuICAgIC8vc3RhcnRcbiAgICBzdGFydC5wcm9wZXJ0aWVzLmRpc3QgPSBkaXN0YW5jZShwdCwgc3RhcnQsIHVuaXRzKTtcbiAgICAvL3N0b3BcbiAgICBzdG9wLnByb3BlcnRpZXMuZGlzdCA9IGRpc3RhbmNlKHB0LCBzdG9wLCB1bml0cyk7XG4gICAgLy9wZXJwZW5kaWN1bGFyXG4gICAgdmFyIGRpcmVjdGlvbiA9IGJlYXJpbmcoc3RhcnQsIHN0b3ApXG4gICAgdmFyIHBlcnBlbmRpY3VsYXJQdCA9IGRlc3RpbmF0aW9uKHB0LCAxMDAwICwgZGlyZWN0aW9uICsgOTAsIHVuaXRzKSAvLyAxMDAwID0gZ3Jvc3NcbiAgICB2YXIgaW50ZXJzZWN0ID0gbGluZUludGVyc2VjdHMoXG4gICAgICBwdC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgIHB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgcGVycGVuZGljdWxhclB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgcGVycGVuZGljdWxhclB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgc3RhcnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICBzdGFydC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSxcbiAgICAgIHN0b3AuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICBzdG9wLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdXG4gICAgICApO1xuICAgIGlmKCFpbnRlcnNlY3QpIHtcbiAgICAgIHBlcnBlbmRpY3VsYXJQdCA9IGRlc3RpbmF0aW9uKHB0LCAxMDAwICwgZGlyZWN0aW9uIC0gOTAsIHVuaXRzKSAvLyAxMDAwID0gZ3Jvc3NcbiAgICAgIGludGVyc2VjdCA9IGxpbmVJbnRlcnNlY3RzKFxuICAgICAgICBwdC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgICAgcHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICAgIHBlcnBlbmRpY3VsYXJQdC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgICAgcGVycGVuZGljdWxhclB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgICBzdGFydC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgICAgc3RhcnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICAgIHN0b3AuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICAgIHN0b3AuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV1cbiAgICAgICAgKTtcbiAgICB9XG4gICAgcGVycGVuZGljdWxhclB0LnByb3BlcnRpZXMuZGlzdCA9IEluZmluaXR5O1xuICAgIHZhciBpbnRlcnNlY3RQdDtcbiAgICBpZihpbnRlcnNlY3QpIHtcbiAgICAgIHZhciBpbnRlcnNlY3RQdCA9IHBvaW50KGludGVyc2VjdCk7XG4gICAgICBpbnRlcnNlY3RQdC5wcm9wZXJ0aWVzLmRpc3QgPSBkaXN0YW5jZShwdCwgaW50ZXJzZWN0UHQsIHVuaXRzKTtcbiAgICB9XG4gICAgXG4gICAgaWYoc3RhcnQucHJvcGVydGllcy5kaXN0IDwgY2xvc2VzdFB0LnByb3BlcnRpZXMuZGlzdCkge1xuICAgICAgY2xvc2VzdFB0ID0gc3RhcnQ7XG4gICAgICBjbG9zZXN0UHQucHJvcGVydGllcy5pbmRleCA9IGk7XG4gICAgfVxuICAgIGlmKHN0b3AucHJvcGVydGllcy5kaXN0IDwgY2xvc2VzdFB0LnByb3BlcnRpZXMuZGlzdCkge1xuICAgICBjbG9zZXN0UHQgPSBzdG9wO1xuICAgICBjbG9zZXN0UHQucHJvcGVydGllcy5pbmRleCA9IGk7XG4gICAgfVxuICAgIGlmKGludGVyc2VjdFB0ICYmIGludGVyc2VjdFB0LnByb3BlcnRpZXMuZGlzdCA8IGNsb3Nlc3RQdC5wcm9wZXJ0aWVzLmRpc3QpeyBcbiAgICAgIGNsb3Nlc3RQdCA9IGludGVyc2VjdFB0O1xuICAgICAgY2xvc2VzdFB0LnByb3BlcnRpZXMuaW5kZXggPSBpO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIGNsb3Nlc3RQdDtcbn1cblxuLy8gbW9kaWZpZWQgZnJvbSBodHRwOi8vanNmaWRkbGUubmV0L2p1c3Rpbl9jX3JvdW5kcy9HZDJTMi9saWdodC9cbmZ1bmN0aW9uIGxpbmVJbnRlcnNlY3RzKGxpbmUxU3RhcnRYLCBsaW5lMVN0YXJ0WSwgbGluZTFFbmRYLCBsaW5lMUVuZFksIGxpbmUyU3RhcnRYLCBsaW5lMlN0YXJ0WSwgbGluZTJFbmRYLCBsaW5lMkVuZFkpIHtcbiAgLy8gaWYgdGhlIGxpbmVzIGludGVyc2VjdCwgdGhlIHJlc3VsdCBjb250YWlucyB0aGUgeCBhbmQgeSBvZiB0aGUgaW50ZXJzZWN0aW9uICh0cmVhdGluZyB0aGUgbGluZXMgYXMgaW5maW5pdGUpIGFuZCBib29sZWFucyBmb3Igd2hldGhlciBsaW5lIHNlZ21lbnQgMSBvciBsaW5lIHNlZ21lbnQgMiBjb250YWluIHRoZSBwb2ludFxuICB2YXIgZGVub21pbmF0b3IsIGEsIGIsIG51bWVyYXRvcjEsIG51bWVyYXRvcjIsIHJlc3VsdCA9IHtcbiAgICB4OiBudWxsLFxuICAgIHk6IG51bGwsXG4gICAgb25MaW5lMTogZmFsc2UsXG4gICAgb25MaW5lMjogZmFsc2VcbiAgfTtcbiAgZGVub21pbmF0b3IgPSAoKGxpbmUyRW5kWSAtIGxpbmUyU3RhcnRZKSAqIChsaW5lMUVuZFggLSBsaW5lMVN0YXJ0WCkpIC0gKChsaW5lMkVuZFggLSBsaW5lMlN0YXJ0WCkgKiAobGluZTFFbmRZIC0gbGluZTFTdGFydFkpKTtcbiAgaWYgKGRlbm9taW5hdG9yID09IDApIHtcbiAgICBpZihyZXN1bHQueCAhPSBudWxsICYmIHJlc3VsdC55ICE9IG51bGwpIHtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgYSA9IGxpbmUxU3RhcnRZIC0gbGluZTJTdGFydFk7XG4gIGIgPSBsaW5lMVN0YXJ0WCAtIGxpbmUyU3RhcnRYO1xuICBudW1lcmF0b3IxID0gKChsaW5lMkVuZFggLSBsaW5lMlN0YXJ0WCkgKiBhKSAtICgobGluZTJFbmRZIC0gbGluZTJTdGFydFkpICogYik7XG4gIG51bWVyYXRvcjIgPSAoKGxpbmUxRW5kWCAtIGxpbmUxU3RhcnRYKSAqIGEpIC0gKChsaW5lMUVuZFkgLSBsaW5lMVN0YXJ0WSkgKiBiKTtcbiAgYSA9IG51bWVyYXRvcjEgLyBkZW5vbWluYXRvcjtcbiAgYiA9IG51bWVyYXRvcjIgLyBkZW5vbWluYXRvcjtcblxuICAvLyBpZiB3ZSBjYXN0IHRoZXNlIGxpbmVzIGluZmluaXRlbHkgaW4gYm90aCBkaXJlY3Rpb25zLCB0aGV5IGludGVyc2VjdCBoZXJlOlxuICByZXN1bHQueCA9IGxpbmUxU3RhcnRYICsgKGEgKiAobGluZTFFbmRYIC0gbGluZTFTdGFydFgpKTtcbiAgcmVzdWx0LnkgPSBsaW5lMVN0YXJ0WSArIChhICogKGxpbmUxRW5kWSAtIGxpbmUxU3RhcnRZKSk7XG5cbiAgLy8gaWYgbGluZTEgaXMgYSBzZWdtZW50IGFuZCBsaW5lMiBpcyBpbmZpbml0ZSwgdGhleSBpbnRlcnNlY3QgaWY6XG4gIGlmIChhID4gMCAmJiBhIDwgMSkge1xuICAgIHJlc3VsdC5vbkxpbmUxID0gdHJ1ZTtcbiAgfVxuICAvLyBpZiBsaW5lMiBpcyBhIHNlZ21lbnQgYW5kIGxpbmUxIGlzIGluZmluaXRlLCB0aGV5IGludGVyc2VjdCBpZjpcbiAgaWYgKGIgPiAwICYmIGIgPCAxKSB7XG4gICAgcmVzdWx0Lm9uTGluZTIgPSB0cnVlO1xuICB9XG4gIC8vIGlmIGxpbmUxIGFuZCBsaW5lMiBhcmUgc2VnbWVudHMsIHRoZXkgaW50ZXJzZWN0IGlmIGJvdGggb2YgdGhlIGFib3ZlIGFyZSB0cnVlXG4gIGlmKHJlc3VsdC5vbkxpbmUxICYmIHJlc3VsdC5vbkxpbmUyKXtcbiAgICByZXR1cm4gW3Jlc3VsdC54LCByZXN1bHQueV07XG4gIH1cbiAgZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCJ2YXIgZmVhdHVyZUNvbGxlY3Rpb24gPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG52YXIgY2VudHJvaWQgPSByZXF1aXJlKCd0dXJmLWNlbnRlcicpO1xudmFyIGRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xudmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG52YXIgZXhwbG9kZSA9IHJlcXVpcmUoJ3R1cmYtZXhwbG9kZScpO1xuXG4vKipcbiAqIEZpbmRzIGEge0BsaW5rIFBvaW50fSBndWFyYW50ZWVkIHRvIGJlIG9uIHRoZSBzdXJmYWNlIG9mXG4gKiB7QGxpbmsgR2VvSlNPTn0gb2JqZWN0LlxuICpcbiAqICogR2l2ZW4gYSB7QGxpbmsgUG9seWdvbn0sIHRoZSBwb2ludCB3aWxsIGJlIGluIHRoZSBhcmVhIG9mIHRoZSBwb2x5Z29uXG4gKiAqIEdpdmVuIGEge0BsaW5rIExpbmVTdHJpbmd9LCB0aGUgcG9pbnQgd2lsbCBiZSBhbG9uZyB0aGUgc3RyaW5nXG4gKiAqIEdpdmVuIGEge0BsaW5rIFBvaW50fSwgdGhlIHBvaW50IHdpbGwgdGhlIHNhbWUgYXMgdGhlIGlucHV0XG4gKlxuICogQG1vZHVsZSB0dXJmL3BvaW50LW9uLXN1cmZhY2VcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtHZW9KU09OfSBpbnB1dCBhbnkgR2VvSlNPTiBvYmplY3RcbiAqIEByZXR1cm5zIHtGZWF0dXJlfSBhIHBvaW50IG9uIHRoZSBzdXJmYWNlIG9mIGBpbnB1dGBcbiAqIEBleGFtcGxlXG4gKiAvLyBjcmVhdGUgYSByYW5kb20gcG9seWdvblxuICogdmFyIHBvbHlnb24gPSB0dXJmLnJhbmRvbSgncG9seWdvbicpO1xuICpcbiAqIC8vPXBvbHlnb25cbiAqXG4gKiB2YXIgcG9pbnRPblBvbHlnb24gPSB0dXJmLnBvaW50T25TdXJmYWNlKHBvbHlnb24pO1xuICpcbiogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9seWdvbi5mZWF0dXJlcy5jb25jYXQocG9pbnRPblBvbHlnb24pO1xuKiB2YXIgcmVzdWx0ID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4qICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZjKSB7XG4gIC8vIG5vcm1hbGl6ZVxuICBpZihmYy50eXBlICE9ICdGZWF0dXJlQ29sbGVjdGlvbicpIHtcbiAgICBpZihmYy50eXBlICE9ICdGZWF0dXJlJykge1xuICAgICAgZmMgPSB7XG4gICAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgICAgZ2VvbWV0cnk6IGZjLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7fVxuICAgICAgfTtcbiAgICB9XG4gICAgZmMgPSBmZWF0dXJlQ29sbGVjdGlvbihbZmNdKTtcbiAgfVxuXG4gIC8vZ2V0IGNlbnRyb2lkXG4gIHZhciBjZW50ID0gY2VudHJvaWQoZmMpO1xuXG4gIC8vIGNoZWNrIHRvIHNlZSBpZiBjZW50cm9pZCBpcyBvbiBzdXJmYWNlXG4gIHZhciBvblN1cmZhY2UgPSBmYWxzZTtcbiAgdmFyIGkgPSAwO1xuICB3aGlsZSghb25TdXJmYWNlICYmIGkgPCBmYy5mZWF0dXJlcy5sZW5ndGgpIHtcbiAgICB2YXIgZ2VvbSA9IGZjLmZlYXR1cmVzW2ldLmdlb21ldHJ5O1xuICAgIGlmIChnZW9tLnR5cGUgPT09ICdQb2ludCcpIHtcbiAgICAgIGlmIChjZW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdID09PSBnZW9tLmNvb3JkaW5hdGVzWzBdICYmXG4gICAgICAgIGNlbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0gPT09IGdlb20uY29vcmRpbmF0ZXNbMV0pIHtcbiAgICAgICAgb25TdXJmYWNlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYoZ2VvbS50eXBlID09PSAnTXVsdGlQb2ludCcpIHtcbiAgICAgIHZhciBvbk11bHRpUG9pbnQgPSBmYWxzZTtcbiAgICAgIHZhciBrID0gMDtcbiAgICAgIHdoaWxlKCFvbk11bHRpUG9pbnQgJiYgayA8IGdlb20uY29vcmRpbmF0ZXMubGVuZ3RoKSB7XG4gICAgICAgIGlmIChjZW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdID09PSBnZW9tLmNvb3JkaW5hdGVzW2tdWzBdICYmXG4gICAgICAgICAgY2VudC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSA9PT0gZ2VvbS5jb29yZGluYXRlc1trXVsxXSkge1xuICAgICAgICAgIG9uU3VyZmFjZSA9IHRydWU7XG4gICAgICAgICAgb25NdWx0aVBvaW50ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBrKys7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmKGdlb20udHlwZSA9PT0gJ0xpbmVTdHJpbmcnKSB7XG4gICAgICB2YXIgb25MaW5lID0gZmFsc2U7XG4gICAgICB2YXIgayA9IDA7XG4gICAgICB3aGlsZSghb25MaW5lICYmIGsgPCBnZW9tLmNvb3JkaW5hdGVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgdmFyIHggPSBjZW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdO1xuICAgICAgICB2YXIgeSA9IGNlbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV07XG4gICAgICAgIHZhciB4MSA9IGdlb20uY29vcmRpbmF0ZXNba11bMF07XG4gICAgICAgIHZhciB5MSA9IGdlb20uY29vcmRpbmF0ZXNba11bMV07XG4gICAgICAgIHZhciB4MiA9IGdlb20uY29vcmRpbmF0ZXNbaysxXVswXTtcbiAgICAgICAgdmFyIHkyID0gZ2VvbS5jb29yZGluYXRlc1trKzFdWzFdO1xuICAgICAgICBpZihwb2ludE9uU2VnbWVudCh4LCB5LCB4MSwgeTEsIHgyLCB5MikpIHtcbiAgICAgICAgICBvbkxpbmUgPSB0cnVlO1xuICAgICAgICAgIG9uU3VyZmFjZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZihnZW9tLnR5cGUgPT09ICdNdWx0aUxpbmVTdHJpbmcnKSB7XG4gICAgICB2YXIgb25NdWx0aUxpbmUgPSBmYWxzZTtcbiAgICAgIHZhciBqID0gMDtcbiAgICAgIHdoaWxlKCFvbk11bHRpTGluZSAmJiBqIDwgZ2VvbS5jb29yZGluYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIG9uTGluZSA9IGZhbHNlO1xuICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgIHZhciBsaW5lID0gZ2VvbS5jb29yZGluYXRlc1tqXTtcbiAgICAgICAgd2hpbGUoIW9uTGluZSAmJiBrIDwgbGluZS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgdmFyIHggPSBjZW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdO1xuICAgICAgICAgIHZhciB5ID0gY2VudC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXTtcbiAgICAgICAgICB2YXIgeDEgPSBsaW5lW2tdWzBdO1xuICAgICAgICAgIHZhciB5MSA9IGxpbmVba11bMV07XG4gICAgICAgICAgdmFyIHgyID0gbGluZVtrKzFdWzBdO1xuICAgICAgICAgIHZhciB5MiA9IGxpbmVbaysxXVsxXTtcbiAgICAgICAgICBpZihwb2ludE9uU2VnbWVudCh4LCB5LCB4MSwgeTEsIHgyLCB5MikpIHtcbiAgICAgICAgICAgIG9uTGluZSA9IHRydWU7XG4gICAgICAgICAgICBvblN1cmZhY2UgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBrKys7XG4gICAgICAgIH1cbiAgICAgICAgaisrO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZihnZW9tLnR5cGUgPT09ICdQb2x5Z29uJyB8fCBnZW9tLnR5cGUgPT09ICdNdWx0aVBvbHlnb24nKSB7XG4gICAgICB2YXIgZiA9IHtcbiAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgICBnZW9tZXRyeTogZ2VvbSxcbiAgICAgICAgcHJvcGVydGllczoge31cbiAgICAgIH07XG4gICAgICBpZihpbnNpZGUoY2VudCwgZikpIHtcbiAgICAgICAgb25TdXJmYWNlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaSsrO1xuICB9XG4gIGlmKG9uU3VyZmFjZSkge1xuICAgIHJldHVybiBjZW50O1xuICB9IGVsc2Uge1xuICAgIHZhciB2ZXJ0aWNlcyA9IGZlYXR1cmVDb2xsZWN0aW9uKFtdKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgZmMuZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZlcnRpY2VzLmZlYXR1cmVzID0gdmVydGljZXMuZmVhdHVyZXMuY29uY2F0KGV4cGxvZGUoZmMuZmVhdHVyZXNbaV0pLmZlYXR1cmVzKTtcbiAgICB9XG4gICAgdmFyIGNsb3Nlc3RWZXJ0ZXg7XG4gICAgdmFyIGNsb3Nlc3REaXN0YW5jZSA9IEluZmluaXR5O1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB2ZXJ0aWNlcy5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGRpc3QgPSBkaXN0YW5jZShjZW50LCB2ZXJ0aWNlcy5mZWF0dXJlc1tpXSwgJ21pbGVzJyk7XG4gICAgICBpZihkaXN0IDwgY2xvc2VzdERpc3RhbmNlKSB7XG4gICAgICAgIGNsb3Nlc3REaXN0YW5jZSA9IGRpc3Q7XG4gICAgICAgIGNsb3Nlc3RWZXJ0ZXggPSB2ZXJ0aWNlcy5mZWF0dXJlc1tpXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNsb3Nlc3RWZXJ0ZXg7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIHBvaW50T25TZWdtZW50ICh4LCB5LCB4MSwgeTEsIHgyLCB5Mikge1xuICB2YXIgYWIgPSBNYXRoLnNxcnQoKHgyLXgxKSooeDIteDEpKyh5Mi15MSkqKHkyLXkxKSk7XG4gIHZhciBhcCA9IE1hdGguc3FydCgoeC14MSkqKHgteDEpKyh5LXkxKSooeS15MSkpO1xuICB2YXIgcGIgPSBNYXRoLnNxcnQoKHgyLXgpKih4Mi14KSsoeTIteSkqKHkyLXkpKTtcbiAgaWYoYWIgPT09IGFwICsgcGIpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuIiwiLyoqXG4gKiBUYWtlcyBjb29yZGluYXRlcyBhbmQgcHJvcGVydGllcyAob3B0aW9uYWwpIGFuZCByZXR1cm5zIGEgbmV3IHtAbGluayBQb2ludH0gZmVhdHVyZS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvcG9pbnRcbiAqIEBjYXRlZ29yeSBoZWxwZXJcbiAqIEBwYXJhbSB7bnVtYmVyfSBsb25naXR1ZGUgcG9zaXRpb24gd2VzdCB0byBlYXN0IGluIGRlY2ltYWwgZGVncmVlc1xuICogQHBhcmFtIHtudW1iZXJ9IGxhdGl0dWRlIHBvc2l0aW9uIHNvdXRoIHRvIG5vcnRoIGluIGRlY2ltYWwgZGVncmVlc1xuICogQHBhcmFtIHtPYmplY3R9IHByb3BlcnRpZXMgYW4gT2JqZWN0IHRoYXQgaXMgdXNlZCBhcyB0aGUge0BsaW5rIEZlYXR1cmV9J3NcbiAqIHByb3BlcnRpZXNcbiAqIEByZXR1cm4ge1BvaW50fSBhIFBvaW50IGZlYXR1cmVcbiAqIEBleGFtcGxlXG4gKiB2YXIgcHQxID0gdHVyZi5wb2ludChbLTc1LjM0MywgMzkuOTg0XSk7XG4gKlxuICogLy89cHQxXG4gKi9cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbihhcmcpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmcpID09PSAnW29iamVjdCBBcnJheV0nO1xufTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oY29vcmRpbmF0ZXMsIHByb3BlcnRpZXMpIHtcbiAgaWYgKCFpc0FycmF5KGNvb3JkaW5hdGVzKSkgdGhyb3cgbmV3IEVycm9yKCdDb29yZGluYXRlcyBtdXN0IGJlIGFuIGFycmF5Jyk7XG4gIGlmIChjb29yZGluYXRlcy5sZW5ndGggPCAyKSB0aHJvdyBuZXcgRXJyb3IoJ0Nvb3JkaW5hdGVzIG11c3QgYmUgYXQgbGVhc3QgMiBudW1iZXJzIGxvbmcnKTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBcIkZlYXR1cmVcIixcbiAgICBnZW9tZXRyeToge1xuICAgICAgdHlwZTogXCJQb2ludFwiLFxuICAgICAgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGVzXG4gICAgfSxcbiAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzIHx8IHt9XG4gIH07XG59O1xuIiwiLyoqXG4gKiBUYWtlcyBhbiBhcnJheSBvZiBMaW5lYXJSaW5ncyBhbmQgb3B0aW9uYWxseSBhbiB7QGxpbmsgT2JqZWN0fSB3aXRoIHByb3BlcnRpZXMgYW5kIHJldHVybnMgYSBHZW9KU09OIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9wb2x5Z29uXG4gKiBAY2F0ZWdvcnkgaGVscGVyXG4gKiBAcGFyYW0ge0FycmF5PEFycmF5PE51bWJlcj4+fSByaW5ncyBhbiBhcnJheSBvZiBMaW5lYXJSaW5nc1xuICogQHBhcmFtIHtPYmplY3R9IHByb3BlcnRpZXMgYW4gb3B0aW9uYWwgcHJvcGVydGllcyBvYmplY3RcbiAqIEByZXR1cm4ge1BvbHlnb259IGEgUG9seWdvbiBmZWF0dXJlXG4gKiBAdGhyb3dzIHtFcnJvcn0gdGhyb3cgYW4gZXJyb3IgaWYgYSBMaW5lYXJSaW5nIG9mIHRoZSBwb2x5Z29uIGhhcyB0b28gZmV3IHBvc2l0aW9uc1xuICogb3IgaWYgYSBMaW5lYXJSaW5nIG9mIHRoZSBQb2x5Z29uIGRvZXMgbm90IGhhdmUgbWF0Y2hpbmcgUG9zaXRpb25zIGF0IHRoZVxuICogYmVnaW5uaW5nICYgZW5kLlxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5Z29uID0gdHVyZi5wb2x5Z29uKFtbXG4gKiAgWy0yLjI3NTU0MywgNTMuNDY0NTQ3XSxcbiAqICBbLTIuMjc1NTQzLCA1My40ODkyNzFdLFxuICogIFstMi4yMTUxMTgsIDUzLjQ4OTI3MV0sXG4gKiAgWy0yLjIxNTExOCwgNTMuNDY0NTQ3XSxcbiAqICBbLTIuMjc1NTQzLCA1My40NjQ1NDddXG4gKiBdXSwgeyBuYW1lOiAncG9seTEnLCBwb3B1bGF0aW9uOiA0MDB9KTtcbiAqXG4gKiAvLz1wb2x5Z29uXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oY29vcmRpbmF0ZXMsIHByb3BlcnRpZXMpe1xuXG4gIGlmIChjb29yZGluYXRlcyA9PT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKCdObyBjb29yZGluYXRlcyBwYXNzZWQnKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHJpbmcgPSBjb29yZGluYXRlc1tpXTtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJpbmdbcmluZy5sZW5ndGggLSAxXS5sZW5ndGg7IGorKykge1xuICAgICAgaWYgKHJpbmcubGVuZ3RoIDwgNCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VhY2ggTGluZWFyUmluZyBvZiBhIFBvbHlnb24gbXVzdCBoYXZlIDQgb3IgbW9yZSBQb3NpdGlvbnMuJyk7XG4gICAgICB9XG4gICAgICBpZiAocmluZ1tyaW5nLmxlbmd0aCAtIDFdW2pdICE9PSByaW5nWzBdW2pdKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmlyc3QgYW5kIGxhc3QgUG9zaXRpb24gYXJlIG5vdCBlcXVpdmFsZW50LicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBwb2x5Z29uID0ge1xuICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAgICBcImdlb21ldHJ5XCI6IHtcbiAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAgICAgIFwiY29vcmRpbmF0ZXNcIjogY29vcmRpbmF0ZXNcbiAgICB9LFxuICAgIFwicHJvcGVydGllc1wiOiBwcm9wZXJ0aWVzXG4gIH07XG5cbiAgaWYgKCFwb2x5Z29uLnByb3BlcnRpZXMpIHtcbiAgICBwb2x5Z29uLnByb3BlcnRpZXMgPSB7fTtcbiAgfVxuXG4gIHJldHVybiBwb2x5Z29uO1xufTtcbiIsInZhciBzcyA9IHJlcXVpcmUoJ3NpbXBsZS1zdGF0aXN0aWNzJyk7XG5cbi8qKlxuKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0sIGEgcHJvcGVydHkgbmFtZSwgYW5kIGEgc2V0IG9mIHBlcmNlbnRpbGVzIGFuZCByZXR1cm5zIGEgcXVhbnRpbGUgYXJyYXkuXG4qIEBtb2R1bGUgdHVyZi9xdWFudGlsZVxuKiBAY2F0ZWdvcnkgY2xhc3NpZmljYXRpb25cbiogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gaW5wdXQgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBhbnkgdHlwZVxuKiBAcGFyYW0ge1N0cmluZ30gZmllbGQgdGhlIHByb3BlcnR5IGluIGBpbnB1dGAgZnJvbSB3aGljaCB0byByZXRyaWV2ZSBxdWFudGlsZSB2YWx1ZXNcbiogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBwZXJjZW50aWxlcyBhbiBBcnJheSBvZiBwZXJjZW50aWxlcyBvbiB3aGljaCB0byBjYWxjdWxhdGUgcXVhbnRpbGUgdmFsdWVzXG4qIEByZXR1cm4ge0FycmF5PG51bWJlcj59IGFuIGFycmF5IG9mIHRoZSBicmVhayB2YWx1ZXNcbiogQGV4YW1wbGVcbiogdmFyIHBvaW50cyA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuKiAgIFwiZmVhdHVyZXNcIjogW1xuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDVcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFs1LCA1XVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogNDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxLCAzXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogODBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxNCwgMl1cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDkwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTMsIDFdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxOSwgN11cbiogICAgICAgfVxuKiAgICAgfVxuKiAgIF1cbiogfTtcbipcbiogdmFyIGJyZWFrcyA9IHR1cmYucXVhbnRpbGUoXG4qICAgcG9pbnRzLCAncG9wdWxhdGlvbicsIFsyNSwgNTAsIDc1LCA5OV0pO1xuKlxuKiAvLz1icmVha3NcbiovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZjLCBmaWVsZCwgcGVyY2VudGlsZXMpe1xuICB2YXIgdmFscyA9IFtdO1xuICB2YXIgcXVhbnRpbGVzID0gW107XG5cbiAgZmMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihmZWF0dXJlKXtcbiAgICB2YWxzLnB1c2goZmVhdHVyZS5wcm9wZXJ0aWVzW2ZpZWxkXSk7XG4gIH0pO1xuICBwZXJjZW50aWxlcy5mb3JFYWNoKGZ1bmN0aW9uKHBlcmNlbnRpbGUpe1xuICAgIHF1YW50aWxlcy5wdXNoKHNzLnF1YW50aWxlKHZhbHMsIHBlcmNlbnRpbGUgKiAwLjAxKSk7XG4gIH0pO1xuICByZXR1cm4gcXVhbnRpbGVzO1xufTtcbiIsInZhciByYW5kb20gPSByZXF1aXJlKCdnZW9qc29uLXJhbmRvbScpO1xuXG4vKipcbiAqIEdlbmVyYXRlcyByYW5kb20ge0BsaW5rIEdlb0pTT059IGRhdGEsIGluY2x1ZGluZyB7QGxpbmsgUG9pbnR8UG9pbnRzfSBhbmQge0BsaW5rIFBvbHlnb258UG9seWdvbnN9LCBmb3IgdGVzdGluZ1xuICogYW5kIGV4cGVyaW1lbnRhdGlvbi5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvcmFuZG9tXG4gKiBAY2F0ZWdvcnkgZGF0YVxuICogQHBhcmFtIHtTdHJpbmd9IFt0eXBlPSdwb2ludCddIHR5cGUgb2YgZmVhdHVyZXMgZGVzaXJlZDogJ3BvaW50cycgb3IgJ3BvbHlnb25zJ1xuICogQHBhcmFtIHtOdW1iZXJ9IFtjb3VudD0xXSBob3cgbWFueSBnZW9tZXRyaWVzIHNob3VsZCBiZSBnZW5lcmF0ZWQuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBvcHRpb25zIHJlbGV2YW50IHRvIHRoZSBmZWF0dXJlIGRlc2lyZWQuIENhbiBpbmNsdWRlOlxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBvcHRpb25zLmJib3ggYSBib3VuZGluZyBib3ggaW5zaWRlIG9mIHdoaWNoIGdlb21ldHJpZXNcbiAqIGFyZSBwbGFjZWQuIEluIHRoZSBjYXNlIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMsIHRoZXkgYXJlIGd1YXJhbnRlZWQgdG8gYmUgd2l0aGluIHRoaXMgYm91bmRzLFxuICogd2hpbGUge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGhhdmUgdGhlaXIgY2VudHJvaWQgd2l0aGluIHRoZSBib3VuZHMuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMubnVtX3ZlcnRpY2VzPTEwXSBvcHRpb25zLnZlcnRpY2VzIHRoZSBudW1iZXIgb2YgdmVydGljZXMgYWRkZWRcbiAqIHRvIHBvbHlnb24gZmVhdHVyZXMuXG4gKiBAcGFyYW0ge051bWJlcn0gW29wdGlvbnMubWF4X3JhZGlhbF9sZW5ndGg9MTBdIHRoZSB0b3RhbCBudW1iZXIgb2YgZGVjaW1hbFxuICogZGVncmVlcyBsb25naXR1ZGUgb3IgbGF0aXR1ZGUgdGhhdCBhIHBvbHlnb24gY2FuIGV4dGVudCBvdXR3YXJkcyB0b1xuICogZnJvbSBpdHMgY2VudGVyLlxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGdlbmVyYXRlZCByYW5kb20gZmVhdHVyZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnRzID0gdHVyZi5yYW5kb20oJ3BvaW50cycsIDEwMCwge1xuICogICBiYm94OiBbLTcwLCA0MCwgLTYwLCA2MF1cbiAqIH0pO1xuICpcbiAqIC8vPXBvaW50c1xuICpcbiAqIHZhciBwb2x5Z29ucyA9IHR1cmYucmFuZG9tKCdwb2x5Z29ucycsIDQsIHtcbiAqICAgYmJveDogWy03MCwgNDAsIC02MCwgNjBdXG4gKiB9KTtcbiAqXG4gKiAvLz1wb2x5Z29uc1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHR5cGUsIGNvdW50LCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgY291bnQgPSBjb3VudCB8fCAxO1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlICdwb2ludCc6XG4gICAgICAgIGNhc2UgJ3BvaW50cyc6XG4gICAgICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgICAgICAgcmV0dXJuIHJhbmRvbS5wb2ludChjb3VudCwgb3B0aW9ucy5iYm94KTtcbiAgICAgICAgY2FzZSAncG9seWdvbic6XG4gICAgICAgIGNhc2UgJ3BvbHlnb25zJzpcbiAgICAgICAgICAgIHJldHVybiByYW5kb20ucG9seWdvbihcbiAgICAgICAgICAgICAgICBjb3VudCxcbiAgICAgICAgICAgICAgICBvcHRpb25zLm51bV92ZXJ0aWNlcyxcbiAgICAgICAgICAgICAgICBvcHRpb25zLm1heF9yYWRpYWxfbGVuZ3RoLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMuYmJveCk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gdHlwZSBnaXZlbjogdmFsaWQgb3B0aW9ucyBhcmUgcG9pbnRzIGFuZCBwb2x5Z29ucycpO1xuICAgIH1cbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2FsbCAucG9pbnQoKSBvciAucG9seWdvbigpIGluc3RlYWQnKTtcbn07XG5cbmZ1bmN0aW9uIHBvc2l0aW9uKGJib3gpIHtcbiAgICBpZiAoYmJveCkgcmV0dXJuIGNvb3JkSW5CQkJPWChiYm94KTtcbiAgICBlbHNlIHJldHVybiBbbG9uKCksIGxhdCgpXTtcbn1cblxubW9kdWxlLmV4cG9ydHMucG9zaXRpb24gPSBwb3NpdGlvbjtcblxubW9kdWxlLmV4cG9ydHMucG9pbnQgPSBmdW5jdGlvbihjb3VudCwgYmJveCkge1xuICAgIHZhciBmZWF0dXJlcyA9IFtdO1xuICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgIGZlYXR1cmVzLnB1c2goZmVhdHVyZShiYm94ID8gcG9pbnQocG9zaXRpb24oYmJveCkpIDogcG9pbnQoKSkpO1xuICAgIH1cbiAgICByZXR1cm4gY29sbGVjdGlvbihmZWF0dXJlcyk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5wb2x5Z29uID0gZnVuY3Rpb24oY291bnQsIG51bV92ZXJ0aWNlcywgbWF4X3JhZGlhbF9sZW5ndGgsIGJib3gpIHtcbiAgICBpZiAodHlwZW9mIG51bV92ZXJ0aWNlcyAhPT0gJ251bWJlcicpIG51bV92ZXJ0aWNlcyA9IDEwO1xuICAgIGlmICh0eXBlb2YgbWF4X3JhZGlhbF9sZW5ndGggIT09ICdudW1iZXInKSBtYXhfcmFkaWFsX2xlbmd0aCA9IDEwO1xuICAgIHZhciBmZWF0dXJlcyA9IFtdO1xuICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgIHZhciB2ZXJ0aWNlcyA9IFtdLFxuICAgICAgICAgICAgY2lyY2xlX29mZnNldHMgPSBBcnJheS5hcHBseShudWxsLFxuICAgICAgICAgICAgICAgIG5ldyBBcnJheShudW1fdmVydGljZXMgKyAxKSkubWFwKE1hdGgucmFuZG9tKTtcblxuICAgICAgICBjaXJjbGVfb2Zmc2V0cy5mb3JFYWNoKHN1bU9mZnNldHMpO1xuICAgICAgICBjaXJjbGVfb2Zmc2V0cy5mb3JFYWNoKHNjYWxlT2Zmc2V0cyk7XG4gICAgICAgIHZlcnRpY2VzW3ZlcnRpY2VzLmxlbmd0aCAtIDFdID0gdmVydGljZXNbMF07IC8vIGNsb3NlIHRoZSByaW5nXG5cbiAgICAgICAgLy8gY2VudGVyIHRoZSBwb2x5Z29uIGFyb3VuZCBzb21ldGhpbmdcbiAgICAgICAgdmVydGljZXMgPSB2ZXJ0aWNlcy5tYXAodmVydGV4VG9Db29yZGluYXRlKHBvc2l0aW9uKGJib3gpKSk7XG4gICAgICAgIGZlYXR1cmVzLnB1c2goZmVhdHVyZShwb2x5Z29uKFt2ZXJ0aWNlc10pKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VtT2Zmc2V0cyhjdXIsIGluZGV4LCBhcnIpIHtcbiAgICAgICAgYXJyW2luZGV4XSA9IChpbmRleCA+IDApID8gY3VyICsgYXJyW2luZGV4IC0gMV0gOiBjdXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NhbGVPZmZzZXRzKGN1ciwgaW5kZXgpIHtcbiAgICAgICAgY3VyID0gY3VyICogMiAqIE1hdGguUEkgLyBjaXJjbGVfb2Zmc2V0c1tjaXJjbGVfb2Zmc2V0cy5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIHJhZGlhbF9zY2FsZXIgPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgICB2ZXJ0aWNlcy5wdXNoKFtcbiAgICAgICAgICAgIHJhZGlhbF9zY2FsZXIgKiBtYXhfcmFkaWFsX2xlbmd0aCAqIE1hdGguc2luKGN1ciksXG4gICAgICAgICAgICByYWRpYWxfc2NhbGVyICogbWF4X3JhZGlhbF9sZW5ndGggKiBNYXRoLmNvcyhjdXIpXG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIHJldHVybiBjb2xsZWN0aW9uKGZlYXR1cmVzKTtcbn07XG5cblxuZnVuY3Rpb24gdmVydGV4VG9Db29yZGluYXRlKGh1Yikge1xuICAgIHJldHVybiBmdW5jdGlvbihjdXIsIGluZGV4KSB7IHJldHVybiBbY3VyWzBdICsgaHViWzBdLCBjdXJbMV0gKyBodWJbMV1dOyB9O1xufVxuXG5mdW5jdGlvbiBybmQoKSB7IHJldHVybiBNYXRoLnJhbmRvbSgpIC0gMC41OyB9XG5mdW5jdGlvbiBsb24oKSB7IHJldHVybiBybmQoKSAqIDM2MDsgfVxuZnVuY3Rpb24gbGF0KCkgeyByZXR1cm4gcm5kKCkgKiAxODA7IH1cblxuZnVuY3Rpb24gcG9pbnQoY29vcmRpbmF0ZXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnUG9pbnQnLFxuICAgICAgICBjb29yZGluYXRlczogY29vcmRpbmF0ZXMgfHwgW2xvbigpLCBsYXQoKV1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBjb29yZEluQkJCT1goYmJveCkge1xuICAgIHJldHVybiBbXG4gICAgICAgIChNYXRoLnJhbmRvbSgpICogKGJib3hbMl0gLSBiYm94WzBdKSkgKyBiYm94WzBdLFxuICAgICAgICAoTWF0aC5yYW5kb20oKSAqIChiYm94WzNdIC0gYmJveFsxXSkpICsgYmJveFsxXV07XG59XG5cbmZ1bmN0aW9uIHBvaW50SW5CQkJPWCgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnUG9pbnQnLFxuICAgICAgICBjb29yZGluYXRlczogW2xvbigpLCBsYXQoKV1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBwb2x5Z29uKGNvb3JkaW5hdGVzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ1BvbHlnb24nLFxuICAgICAgICBjb29yZGluYXRlczogY29vcmRpbmF0ZXNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBmZWF0dXJlKGdlb20pIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgICAgIGdlb21ldHJ5OiBnZW9tLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7fVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGNvbGxlY3Rpb24oZikge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsXG4gICAgICAgIGZlYXR1cmVzOiBmXG4gICAgfTtcbn1cbiIsInZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciByZWNsYXNzID0gcmVxdWlyZSgnLi9pbmRleC5qcycpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSwgYW4gaW5wdXQgZmllbGQsIGFuIG91dHB1dCBmaWVsZCwgYW5kXG4gKiBhbiBhcnJheSBvZiB0cmFuc2xhdGlvbnMgYW5kIG91dHB1dHMgYW4gaWRlbnRpY2FsIEZlYXR1cmVDb2xsZWN0aW9uIHdpdGhcbiAqIHRoZSBvdXRwdXQgZmllbGQgcHJvcGVydHkgcG9wdWxhdGVkLlxuKiBAbW9kdWxlIHR1cmYvcmVjbGFzc1xuKiBAY2F0ZWdvcnkgY2xhc3NpZmljYXRpb25cbiogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gaW5wdXQgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBhbnkgdHlwZVxuKiBAcGFyYW0ge3N0cmluZ30gaW5GaWVsZCB0aGUgZmllbGQgdG8gdHJhbnNsYXRlXG4qIEBwYXJhbSB7c3RyaW5nfSBvdXRGaWVsZCB0aGUgZmllbGQgaW4gd2hpY2ggdG8gc3RvcmUgdHJhbnNsYXRlZCByZXN1bHRzXG4qIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gdHJhbnNsYXRpb25zIGFuIGFycmF5IG9mIHRyYW5zbGF0aW9uc1xuKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiB3aXRoIGlkZW50aWNhbCBnZW9tZXRyaWVzIHRvIGBpbnB1dGAgYnV0IHdpdGggYG91dEZpZWxkYCBwb3B1bGF0ZWQuXG4qIEBleGFtcGxlXG4qIHZhciBwb2ludHMgPSB7XG4qICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiogICBcImZlYXR1cmVzXCI6IFtcbiogICAgIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMy4xNzA1NDcsIDMyLjg4ODY2OV1cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDYwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEzLjE4MjA0OCwgMzIuODg5NTMzXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMTAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTMuMTczOTgsIDMyLjg4MjE4Ml1cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEzLjE3NDMyNCwgMzIuODk1MDExXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMzAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTMuMTg1ODI1LCAzMi44ODQzNDRdXG4qICAgICAgIH1cbiogICAgIH1cbiogICBdXG4qIH07XG4qIC8vIDAgdG8gMjAwIHdpbGwgbWFwIHRvIFwic21hbGxcIiwgMjAwIHRvIDQwMCB3aWxsIG1hcCB0byBcIm1lZGl1bVwiLCA0MDAgdG8gNjAwIHdpbGwgbWFwIHRvIFwibGFyZ2VcIlxuKiB2YXIgdHJhbnNsYXRpb25zID0gW1xuKiAgIFswLCAyMDAsIFwic21hbGxcIl0sXG4qICAgWzIwMCwgNDAwLCBcIm1lZGl1bVwiXSxcbiogICBbNDAwLCA2MDAsIFwibGFyZ2VcIl1cbiogXTtcbipcbiogdmFyIHJlY2xhc3NlZCA9IHR1cmYucmVjbGFzcyhcbiogICBwb2ludHMsICdwb3B1bGF0aW9uJywgJ3NpemUnLCB0cmFuc2xhdGlvbnMpO1xuKlxuKiAvLz1yZWNsYXNzZWRcbipcbiovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZjLCBpbkZpZWxkLCBvdXRGaWVsZCwgdHJhbnNsYXRpb25zLCBkb25lKXtcbiAgdmFyIHJlY2xhc3NlZCA9IGZlYXR1cmVjb2xsZWN0aW9uKFtdKTtcblxuICBmYy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgIHZhciByZWNsYXNzZWRGZWF0dXJlO1xuICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0cmFuc2xhdGlvbnMubGVuZ3RoOyBpKyspe1xuICAgICAgaWYoZmVhdHVyZS5wcm9wZXJ0aWVzW2luRmllbGRdID49IHRyYW5zbGF0aW9uc1tpXVswXSAmJiBmZWF0dXJlLnByb3BlcnRpZXNbaW5GaWVsZF0gPD0gdHJhbnNsYXRpb25zW2ldWzFdKSB7XG4gICAgICAgIGZlYXR1cmUucHJvcGVydGllc1tvdXRGaWVsZF0gPSB0cmFuc2xhdGlvbnNbaV1bMl07XG4gICAgICB9XG4gICAgfVxuICAgIHJlY2xhc3NlZC5mZWF0dXJlcy5wdXNoKGZlYXR1cmUpO1xuICB9KTtcblxuICByZXR1cm4gcmVjbGFzc2VkO1xufTtcbiIsInZhciBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2YgYW55IHR5cGUsIGEgcHJvcGVydHksIGFuZCBhIHZhbHVlIGFuZFxuICogcmV0dXJucyBhIEZlYXR1cmVDb2xsZWN0aW9uIHdpdGggZmVhdHVyZXMgbWF0Y2hpbmcgdGhhdFxuICogcHJvcGVydHktdmFsdWUgcGFpciByZW1vdmVkLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9yZW1vdmVcbiAqIEBjYXRlZ29yeSBkYXRhXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBmZWF0dXJlcyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4gKiBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHkgdGhlIHByb3BlcnR5IHRvIGZpbHRlclxuICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIHRoZSB2YWx1ZSB0byBmaWx0ZXJcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSB0aGUgcmVzdWx0aW5nIEZlYXR1cmVDb2xsZWN0aW9uIHdpdGhvdXQgZmVhdHVyZXMgdGhhdCBtYXRjaCB0aGUgcHJvcGVydHktdmFsdWUgcGFpclxuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgICdtYXJrZXItY29sb3InOiAnIzAwZidcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTAuMjM1MDA0LCA1LjU1MTkxOF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICAnbWFya2VyLWNvbG9yJzogJyNmMDAnXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy0wLjIwOTU5OCwgNS41NjQzOV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICAnbWFya2VyLWNvbG9yJzogJyMwMGYnXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy0wLjE5Nzc1MywgNS41NTYwMThdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgJ21hcmtlci1jb2xvcic6ICcjMDAwJ1xuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstMC4yMTczMjMsIDUuNTQ5NTI2XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgICdtYXJrZXItY29sb3InOiAnIzBmMCdcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTAuMjExMzE1LCA1LjU0Mzg4N11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICAnbWFya2VyLWNvbG9yJzogJyMwMGYnXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy0wLjIwMjIxNywgNS41NDcxMzRdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgJ21hcmtlci1jb2xvcic6ICcjMGYwJ1xuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstMC4yMzEyMjcsIDUuNTY2NDRdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIC8vPXBvaW50c1xuICpcbiAqIHZhciBmaWx0ZXJlZCA9IHR1cmYucmVtb3ZlKHBvaW50cywgJ21hcmtlci1jb2xvcicsICcjMDBmJyk7XG4gKlxuICogLy89ZmlsdGVyZWRcbiovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIGtleSwgdmFsKSB7XG4gIHZhciBuZXdGQyA9IGZlYXR1cmVDb2xsZWN0aW9uKFtdKTtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGNvbGxlY3Rpb24uZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICBpZihjb2xsZWN0aW9uLmZlYXR1cmVzW2ldLnByb3BlcnRpZXNba2V5XSAhPSB2YWwpIHtcbiAgICAgIG5ld0ZDLmZlYXR1cmVzLnB1c2goY29sbGVjdGlvbi5mZWF0dXJlc1tpXSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBuZXdGQztcbn07XG4iLCIvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzExOTM1MTc1L3NhbXBsaW5nLWEtcmFuZG9tLXN1YnNldC1mcm9tLWFuLWFycmF5XG52YXIgZmVhdHVyZUNvbGxlY3Rpb24gPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IGFuZCByZXR1cm5zIGEgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aCBnaXZlbiBudW1iZXIgb2Yge0BsaW5rIEZlYXR1cmV8ZmVhdHVyZXN9IGF0IHJhbmRvbS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvc2FtcGxlXG4gKiBAY2F0ZWdvcnkgZGF0YVxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gZmVhdHVyZXMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBhbnkgdHlwZVxuICogQHBhcmFtIHtudW1iZXJ9IG4gbnVtYmVyIG9mIGZlYXR1cmVzIHRvIHNlbGVjdFxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aCBgbmAgZmVhdHVyZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnRzID0gdHVyZi5yYW5kb20oJ3BvaW50cycsIDEwMDApO1xuICpcbiAqIC8vPXBvaW50c1xuICpcbiAqIHZhciBzYW1wbGUgPSB0dXJmLnNhbXBsZShwb2ludHMsIDEwKTtcbiAqXG4gKiAvLz1zYW1wbGVcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmYywgbnVtKXtcbiAgdmFyIG91dEZDID0gZmVhdHVyZUNvbGxlY3Rpb24oZ2V0UmFuZG9tU3ViYXJyYXkoZmMuZmVhdHVyZXMsIG51bSkpO1xuICByZXR1cm4gb3V0RkM7XG59O1xuXG5mdW5jdGlvbiBnZXRSYW5kb21TdWJhcnJheShhcnIsIHNpemUpIHtcbiAgdmFyIHNodWZmbGVkID0gYXJyLnNsaWNlKDApLCBpID0gYXJyLmxlbmd0aCwgbWluID0gaSAtIHNpemUsIHRlbXAsIGluZGV4O1xuICB3aGlsZSAoaS0tID4gbWluKSB7XG4gICAgICBpbmRleCA9IE1hdGguZmxvb3IoKGkgKyAxKSAqIE1hdGgucmFuZG9tKCkpO1xuICAgICAgdGVtcCA9IHNodWZmbGVkW2luZGV4XTtcbiAgICAgIHNodWZmbGVkW2luZGV4XSA9IHNodWZmbGVkW2ldO1xuICAgICAgc2h1ZmZsZWRbaV0gPSB0ZW1wO1xuICB9XG4gIHJldHVybiBzaHVmZmxlZC5zbGljZShtaW4pO1xufVxuIiwidmFyIHNpbXBsaWZ5ID0gcmVxdWlyZSgnc2ltcGxpZnktanMnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBMaW5lU3RyaW5nfSBvciB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZSBhbmQgcmV0dXJucyBhIHNpbXBsaWZpZWQgdmVyc2lvbi4gSW50ZXJuYWxseSB1c2VzIFtzaW1wbGlmeS1qc10oaHR0cDovL21vdXJuZXIuZ2l0aHViLmlvL3NpbXBsaWZ5LWpzLykgdG8gcGVyZm9ybSBzaW1wbGlmaWNhdGlvbi5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvc2ltcGxpZnlcbiAqIEBjYXRlZ29yeSB0cmFuc2Zvcm1hdGlvblxuICogQHBhcmFtIHtGZWF0dXJlfSBmZWF0dXJlIGEge0BsaW5rIExpbmVTdHJpbmd9IG9yIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlIHRvIGJlIHNpbXBsaWZpZWRcbiAqIEBwYXJhbSB7bnVtYmVyfSB0b2xlcmFuY2Ugc2ltcGxpZmljYXRpb24gdG9sZXJhbmNlXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGhpZ2hRdWFsaXR5IHdoZXRoZXIgb3Igbm90IHRvIHNwZW5kIG1vcmUgdGltZSB0byBjcmVhdGVcbiAqIGEgaGlnaGVyLXF1YWxpdHkgc2ltcGxpZmljYXRpb24gd2l0aCBhIGRpZmZlcmVudCBhbGdvcml0aG1cbiAqIEByZXR1cm4ge0ZlYXR1cmV9IGEgc2ltcGxpZmllZCBmZWF0dXJlXG4gKiBAZXhhbXBsZVxuICAqIHZhciBmZWF0dXJlID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstNzAuNjAzNjM3LCAtMzMuMzk5OTE4XSxcbiAqICAgICAgIFstNzAuNjE0NjI0LCAtMzMuMzk1MzMyXSxcbiAqICAgICAgIFstNzAuNjM5MzQzLCAtMzMuMzkyNDY2XSxcbiAqICAgICAgIFstNzAuNjU5OTQyLCAtMzMuMzk0NzU5XSxcbiAqICAgICAgIFstNzAuNjgzOTc1LCAtMzMuNDA0NTA0XSxcbiAqICAgICAgIFstNzAuNjk3MDIxLCAtMzMuNDE5NDA2XSxcbiAqICAgICAgIFstNzAuNzAxMTQxLCAtMzMuNDM0MzA2XSxcbiAqICAgICAgIFstNzAuNzAwNDU0LCAtMzMuNDQ2MzM5XSxcbiAqICAgICAgIFstNzAuNjk0Mjc0LCAtMzMuNDU4MzY5XSxcbiAqICAgICAgIFstNzAuNjgyNjAxLCAtMzMuNDY1ODE2XSxcbiAqICAgICAgIFstNzAuNjY4ODY5LCAtMzMuNDcyMTE3XSxcbiAqICAgICAgIFstNzAuNjQ2MjA5LCAtMzMuNDczODM1XSxcbiAqICAgICAgIFstNzAuNjI0OTIzLCAtMzMuNDcyMTE3XSxcbiAqICAgICAgIFstNzAuNjA5ODE3LCAtMzMuNDY4MTA3XSxcbiAqICAgICAgIFstNzAuNTk1Mzk3LCAtMzMuNDU4MzY5XSxcbiAqICAgICAgIFstNzAuNTg3MTU4LCAtMzMuNDQyOTAxXSxcbiAqICAgICAgIFstNzAuNTg3MTU4LCAtMzMuNDI2MjgzXSxcbiAqICAgICAgIFstNzAuNTkwNTkxLCAtMzMuNDE0MjQ4XSxcbiAqICAgICAgIFstNzAuNTk0NzExLCAtMzMuNDA2MjI0XSxcbiAqICAgICAgIFstNzAuNjAzNjM3LCAtMzMuMzk5OTE4XVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG5cbiAqIHZhciB0b2xlcmFuY2UgPSAwLjAxO1xuICpcbiAqIHZhciBzaW1wbGlmaWVkID0gdHVyZi5zaW1wbGlmeShcbiAqICBmZWF0dXJlLCB0b2xlcmFuY2UsIGZhbHNlKTtcbiAqXG4gKiAvLz1mZWF0dXJlXG4gKlxuICogLy89c2ltcGxpZmllZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZlYXR1cmUsIHRvbGVyYW5jZSwgaGlnaFF1YWxpdHkpe1xuICBpZihmZWF0dXJlLmdlb21ldHJ5LnR5cGUgPT09ICdMaW5lU3RyaW5nJykge1xuICAgIHZhciBsaW5lID0ge1xuICAgICAgdHlwZTogJ0xpbmVTdHJpbmcnLFxuICAgICAgY29vcmRpbmF0ZXM6IFtdXG4gICAgfTtcbiAgICB2YXIgcHRzID0gZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcy5tYXAoZnVuY3Rpb24oY29vcmQpIHtcbiAgICAgIHJldHVybiB7eDogY29vcmRbMF0sIHk6IGNvb3JkWzFdfTtcbiAgICB9KTtcbiAgICBsaW5lLmNvb3JkaW5hdGVzID0gc2ltcGxpZnkocHRzLCB0b2xlcmFuY2UsIGhpZ2hRdWFsaXR5KS5tYXAoZnVuY3Rpb24oY29vcmRzKXtcbiAgICAgIHJldHVybiBbY29vcmRzLngsIGNvb3Jkcy55XTtcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gc2ltcGxlRmVhdHVyZShsaW5lLCBmZWF0dXJlLnByb3BlcnRpZXMpO1xuICB9IGVsc2UgaWYoZmVhdHVyZS5nZW9tZXRyeS50eXBlID09PSAnUG9seWdvbicpIHtcbiAgICB2YXIgcG9seSA9IHtcbiAgICAgIHR5cGU6ICdQb2x5Z29uJyxcbiAgICAgIGNvb3JkaW5hdGVzOiBbXVxuICAgIH07XG4gICAgZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHJpbmcpe1xuICAgICAgdmFyIHB0cyA9IHJpbmcubWFwKGZ1bmN0aW9uKGNvb3JkKSB7XG4gICAgICAgIHJldHVybiB7eDogY29vcmRbMF0sIHk6IGNvb3JkWzFdfTtcbiAgICAgIH0pO1xuICAgICAgdmFyIHNpbXBsZVJpbmcgPSBzaW1wbGlmeShwdHMsIHRvbGVyYW5jZSwgaGlnaFF1YWxpdHkpLm1hcChmdW5jdGlvbihjb29yZHMpe1xuICAgICAgICByZXR1cm4gW2Nvb3Jkcy54LCBjb29yZHMueV07XG4gICAgICB9KTtcbiAgICAgIHBvbHkuY29vcmRpbmF0ZXMucHVzaChzaW1wbGVSaW5nKTtcbiAgICB9KTtcbiAgICByZXR1cm4gc2ltcGxlRmVhdHVyZShwb2x5LCBmZWF0dXJlLnByb3BlcnRpZXMpXG4gIH1cbn1cblxuZnVuY3Rpb24gc2ltcGxlRmVhdHVyZSAoZ2VvbSwgcHJvcGVydGllcykge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICBnZW9tZXRyeTogZ2VvbSxcbiAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzXG4gIH07XG59XG4iLCIvKlxuIChjKSAyMDEzLCBWbGFkaW1pciBBZ2Fmb25raW5cbiBTaW1wbGlmeS5qcywgYSBoaWdoLXBlcmZvcm1hbmNlIEpTIHBvbHlsaW5lIHNpbXBsaWZpY2F0aW9uIGxpYnJhcnlcbiBtb3VybmVyLmdpdGh1Yi5pby9zaW1wbGlmeS1qc1xuKi9cblxuKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4vLyB0byBzdWl0IHlvdXIgcG9pbnQgZm9ybWF0LCBydW4gc2VhcmNoL3JlcGxhY2UgZm9yICcueCcgYW5kICcueSc7XG4vLyBmb3IgM0QgdmVyc2lvbiwgc2VlIDNkIGJyYW5jaCAoY29uZmlndXJhYmlsaXR5IHdvdWxkIGRyYXcgc2lnbmlmaWNhbnQgcGVyZm9ybWFuY2Ugb3ZlcmhlYWQpXG5cbi8vIHNxdWFyZSBkaXN0YW5jZSBiZXR3ZWVuIDIgcG9pbnRzXG5mdW5jdGlvbiBnZXRTcURpc3QocDEsIHAyKSB7XG5cbiAgICB2YXIgZHggPSBwMS54IC0gcDIueCxcbiAgICAgICAgZHkgPSBwMS55IC0gcDIueTtcblxuICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTtcbn1cblxuLy8gc3F1YXJlIGRpc3RhbmNlIGZyb20gYSBwb2ludCB0byBhIHNlZ21lbnRcbmZ1bmN0aW9uIGdldFNxU2VnRGlzdChwLCBwMSwgcDIpIHtcblxuICAgIHZhciB4ID0gcDEueCxcbiAgICAgICAgeSA9IHAxLnksXG4gICAgICAgIGR4ID0gcDIueCAtIHgsXG4gICAgICAgIGR5ID0gcDIueSAtIHk7XG5cbiAgICBpZiAoZHggIT09IDAgfHwgZHkgIT09IDApIHtcblxuICAgICAgICB2YXIgdCA9ICgocC54IC0geCkgKiBkeCArIChwLnkgLSB5KSAqIGR5KSAvIChkeCAqIGR4ICsgZHkgKiBkeSk7XG5cbiAgICAgICAgaWYgKHQgPiAxKSB7XG4gICAgICAgICAgICB4ID0gcDIueDtcbiAgICAgICAgICAgIHkgPSBwMi55O1xuXG4gICAgICAgIH0gZWxzZSBpZiAodCA+IDApIHtcbiAgICAgICAgICAgIHggKz0gZHggKiB0O1xuICAgICAgICAgICAgeSArPSBkeSAqIHQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkeCA9IHAueCAtIHg7XG4gICAgZHkgPSBwLnkgLSB5O1xuXG4gICAgcmV0dXJuIGR4ICogZHggKyBkeSAqIGR5O1xufVxuLy8gcmVzdCBvZiB0aGUgY29kZSBkb2Vzbid0IGNhcmUgYWJvdXQgcG9pbnQgZm9ybWF0XG5cbi8vIGJhc2ljIGRpc3RhbmNlLWJhc2VkIHNpbXBsaWZpY2F0aW9uXG5mdW5jdGlvbiBzaW1wbGlmeVJhZGlhbERpc3QocG9pbnRzLCBzcVRvbGVyYW5jZSkge1xuXG4gICAgdmFyIHByZXZQb2ludCA9IHBvaW50c1swXSxcbiAgICAgICAgbmV3UG9pbnRzID0gW3ByZXZQb2ludF0sXG4gICAgICAgIHBvaW50O1xuXG4gICAgZm9yICh2YXIgaSA9IDEsIGxlbiA9IHBvaW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBwb2ludCA9IHBvaW50c1tpXTtcblxuICAgICAgICBpZiAoZ2V0U3FEaXN0KHBvaW50LCBwcmV2UG9pbnQpID4gc3FUb2xlcmFuY2UpIHtcbiAgICAgICAgICAgIG5ld1BvaW50cy5wdXNoKHBvaW50KTtcbiAgICAgICAgICAgIHByZXZQb2ludCA9IHBvaW50O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHByZXZQb2ludCAhPT0gcG9pbnQpIG5ld1BvaW50cy5wdXNoKHBvaW50KTtcblxuICAgIHJldHVybiBuZXdQb2ludHM7XG59XG5cbi8vIHNpbXBsaWZpY2F0aW9uIHVzaW5nIG9wdGltaXplZCBEb3VnbGFzLVBldWNrZXIgYWxnb3JpdGhtIHdpdGggcmVjdXJzaW9uIGVsaW1pbmF0aW9uXG5mdW5jdGlvbiBzaW1wbGlmeURvdWdsYXNQZXVja2VyKHBvaW50cywgc3FUb2xlcmFuY2UpIHtcblxuICAgIHZhciBsZW4gPSBwb2ludHMubGVuZ3RoLFxuICAgICAgICBNYXJrZXJBcnJheSA9IHR5cGVvZiBVaW50OEFycmF5ICE9PSAndW5kZWZpbmVkJyA/IFVpbnQ4QXJyYXkgOiBBcnJheSxcbiAgICAgICAgbWFya2VycyA9IG5ldyBNYXJrZXJBcnJheShsZW4pLFxuICAgICAgICBmaXJzdCA9IDAsXG4gICAgICAgIGxhc3QgPSBsZW4gLSAxLFxuICAgICAgICBzdGFjayA9IFtdLFxuICAgICAgICBuZXdQb2ludHMgPSBbXSxcbiAgICAgICAgaSwgbWF4U3FEaXN0LCBzcURpc3QsIGluZGV4O1xuXG4gICAgbWFya2Vyc1tmaXJzdF0gPSBtYXJrZXJzW2xhc3RdID0gMTtcblxuICAgIHdoaWxlIChsYXN0KSB7XG5cbiAgICAgICAgbWF4U3FEaXN0ID0gMDtcblxuICAgICAgICBmb3IgKGkgPSBmaXJzdCArIDE7IGkgPCBsYXN0OyBpKyspIHtcbiAgICAgICAgICAgIHNxRGlzdCA9IGdldFNxU2VnRGlzdChwb2ludHNbaV0sIHBvaW50c1tmaXJzdF0sIHBvaW50c1tsYXN0XSk7XG5cbiAgICAgICAgICAgIGlmIChzcURpc3QgPiBtYXhTcURpc3QpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgbWF4U3FEaXN0ID0gc3FEaXN0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1heFNxRGlzdCA+IHNxVG9sZXJhbmNlKSB7XG4gICAgICAgICAgICBtYXJrZXJzW2luZGV4XSA9IDE7XG4gICAgICAgICAgICBzdGFjay5wdXNoKGZpcnN0LCBpbmRleCwgaW5kZXgsIGxhc3QpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGFzdCA9IHN0YWNrLnBvcCgpO1xuICAgICAgICBmaXJzdCA9IHN0YWNrLnBvcCgpO1xuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAobWFya2Vyc1tpXSkgbmV3UG9pbnRzLnB1c2gocG9pbnRzW2ldKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3UG9pbnRzO1xufVxuXG4vLyBib3RoIGFsZ29yaXRobXMgY29tYmluZWQgZm9yIGF3ZXNvbWUgcGVyZm9ybWFuY2VcbmZ1bmN0aW9uIHNpbXBsaWZ5KHBvaW50cywgdG9sZXJhbmNlLCBoaWdoZXN0UXVhbGl0eSkge1xuXG4gICAgdmFyIHNxVG9sZXJhbmNlID0gdG9sZXJhbmNlICE9PSB1bmRlZmluZWQgPyB0b2xlcmFuY2UgKiB0b2xlcmFuY2UgOiAxO1xuXG4gICAgcG9pbnRzID0gaGlnaGVzdFF1YWxpdHkgPyBwb2ludHMgOiBzaW1wbGlmeVJhZGlhbERpc3QocG9pbnRzLCBzcVRvbGVyYW5jZSk7XG4gICAgcG9pbnRzID0gc2ltcGxpZnlEb3VnbGFzUGV1Y2tlcihwb2ludHMsIHNxVG9sZXJhbmNlKTtcblxuICAgIHJldHVybiBwb2ludHM7XG59XG5cbi8vIGV4cG9ydCBhcyBBTUQgbW9kdWxlIC8gTm9kZSBtb2R1bGUgLyBicm93c2VyIG9yIHdvcmtlciB2YXJpYWJsZVxuaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgZGVmaW5lKGZ1bmN0aW9uKCkgeyByZXR1cm4gc2ltcGxpZnk7IH0pO1xuZWxzZSBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIG1vZHVsZS5leHBvcnRzID0gc2ltcGxpZnk7XG5lbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHNlbGYuc2ltcGxpZnkgPSBzaW1wbGlmeTtcbmVsc2Ugd2luZG93LnNpbXBsaWZ5ID0gc2ltcGxpZnk7XG5cbn0pKCk7XG4iLCIvKipcbiAqIFRha2VzIGEgYm91bmRpbmcgYm94IGFuZCByZXR1cm5zIGEgbmV3IGJvdW5kaW5nIGJveCB3aXRoIGEgc2l6ZSBleHBhbmRlZCBvciBjb250cmFjdGVkXG4gKiBieSBhIGZhY3RvciBvZiBYLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9zaXplXG4gKiBAY2F0ZWdvcnkgbWVhc3VyZW1lbnRcbiAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gYmJveCBhIGJvdW5kaW5nIGJveFxuICogQHBhcmFtIHtudW1iZXJ9IGZhY3RvciB0aGUgcmF0aW8gb2YgdGhlIG5ldyBiYm94IHRvIHRoZSBpbnB1dCBiYm94XG4gKiBAcmV0dXJuIHtBcnJheTxudW1iZXI+fSB0aGUgcmVzaXplZCBiYm94XG4gKiBAZXhhbXBsZVxuICogdmFyIGJib3ggPSBbMCwgMCwgMTAsIDEwXVxuICpcbiAqIHZhciByZXNpemVkID0gdHVyZi5zaXplKGJib3gsIDIpO1xuICpcbiAqIHZhciBmZWF0dXJlcyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAgdHVyZi5iYm94UG9seWdvbihiYm94KSxcbiAqICAgICB0dXJmLmJib3hQb2x5Z29uKHJlc2l6ZWQpXG4gKiAgIF1cbiAqIH07XG4gKlxuICogLy89ZmVhdHVyZXNcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiYm94LCBmYWN0b3Ipe1xuICB2YXIgY3VycmVudFhEaXN0YW5jZSA9IChiYm94WzJdIC0gYmJveFswXSk7XG4gIHZhciBjdXJyZW50WURpc3RhbmNlID0gKGJib3hbM10gLSBiYm94WzFdKTtcbiAgdmFyIG5ld1hEaXN0YW5jZSA9IGN1cnJlbnRYRGlzdGFuY2UgKiBmYWN0b3I7XG4gIHZhciBuZXdZRGlzdGFuY2UgPSBjdXJyZW50WURpc3RhbmNlICogZmFjdG9yO1xuICB2YXIgeENoYW5nZSA9IG5ld1hEaXN0YW5jZSAtIGN1cnJlbnRYRGlzdGFuY2U7XG4gIHZhciB5Q2hhbmdlID0gbmV3WURpc3RhbmNlIC0gY3VycmVudFlEaXN0YW5jZTtcblxuICB2YXIgbG93WCA9IGJib3hbMF0gLSAoeENoYW5nZSAvIDIpO1xuICB2YXIgbG93WSA9IGJib3hbMV0gLSAoeUNoYW5nZSAvIDIpO1xuICB2YXIgaGlnaFggPSAoeENoYW5nZSAvIDIpICsgYmJveFsyXTtcbiAgdmFyIGhpZ2hZID0gKHlDaGFuZ2UgLyAyKSArIGJib3hbM107XG5cbiAgdmFyIHNpemVkID0gW2xvd1gsIGxvd1ksIGhpZ2hYLCBoaWdoWV07XG4gIHJldHVybiBzaXplZDtcbn1cbiIsInZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcbnZhciBwb2x5Z29uID0gcmVxdWlyZSgndHVyZi1wb2x5Z29uJyk7XG52YXIgZGlzdGFuY2UgPSByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyk7XG5cbi8qKlxuICogVGFrZXMgYSBib3VuZGluZyBib3ggYW5kIGEgY2VsbCBkZXB0aCBhbmQgcmV0dXJucyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGluIGEgZ3JpZC5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvc3F1YXJlLWdyaWRcbiAqIEBjYXRlZ29yeSBpbnRlcnBvbGF0aW9uXG4gKiBAcGFyYW0ge0FycmF5PG51bWJlcj59IGV4dGVudCBleHRlbnQgaW4gW21pblgsIG1pblksIG1heFgsIG1heFldIG9yZGVyXG4gKiBAcGFyYW0ge051bWJlcn0gY2VsbFdpZHRoIHdpZHRoIG9mIGVhY2ggY2VsbFxuICogQHBhcmFtIHtTdHJpbmd9IHVuaXRzIHVuaXRzIHRvIHVzZSBmb3IgY2VsbFdpZHRoXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gZ3JpZCBhcyBGZWF0dXJlQ29sbGVjdGlvbiB3aXRoIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQGV4YW1wbGVcbiAqIHZhciBleHRlbnQgPSBbLTc3LjM4NzY5NTMxMjUsMzguNzE5ODA0NzQyNjQyMzksLTc2Ljk0ODI0MjE4NzUsMzkuMDI3NzE4ODQwMjExNjA1XTtcbiAqIHZhciBjZWxsV2lkdGggPSAxMDtcbiAqIHZhciB1bml0cyA9ICdtaWxlcyc7XG4gKlxuICogdmFyIHNxdWFyZUdyaWQgPSB0dXJmLnNxdWFyZUdyaWQoZXh0ZW50LCBjZWxsV2lkdGgsIHVuaXRzKTtcbiAqXG4gKiAvLz1zcXVhcmVHcmlkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGJib3gsIGNlbGwsIHVuaXRzKSB7XG4gIHZhciBmYyA9IGZlYXR1cmVjb2xsZWN0aW9uKFtdKTtcbiAgdmFyIHhGcmFjdGlvbiA9IGNlbGwgLyAoZGlzdGFuY2UocG9pbnQoW2Jib3hbMF0sIGJib3hbMV1dKSwgcG9pbnQoW2Jib3hbMl0sIGJib3hbMV1dKSwgdW5pdHMpKTtcbiAgdmFyIGNlbGxXaWR0aCA9IHhGcmFjdGlvbiAqIChiYm94WzJdIC0gYmJveFswXSk7XG4gIHZhciB5RnJhY3Rpb24gPSBjZWxsIC8gKGRpc3RhbmNlKHBvaW50KFtiYm94WzBdLCBiYm94WzFdXSksIHBvaW50KFtiYm94WzBdLCBiYm94WzNdXSksIHVuaXRzKSk7XG4gIHZhciBjZWxsSGVpZ2h0ID0geUZyYWN0aW9uICogKGJib3hbM10gLSBiYm94WzFdKTtcblxuICB2YXIgY3VycmVudFggPSBiYm94WzBdO1xuICB3aGlsZSAoY3VycmVudFggPD0gYmJveFsyXSkge1xuICAgIHZhciBjdXJyZW50WSA9IGJib3hbMV07XG4gICAgd2hpbGUgKGN1cnJlbnRZIDw9IGJib3hbM10pIHtcbiAgICAgIHZhciBjZWxsUG9seSA9IHBvbHlnb24oW1tcbiAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXSxcbiAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZXSxcbiAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXVxuICAgICAgICBdXSk7XG4gICAgICBmYy5mZWF0dXJlcy5wdXNoKGNlbGxQb2x5KTtcblxuICAgICAgY3VycmVudFkgKz0gY2VsbEhlaWdodDtcbiAgICB9XG4gICAgY3VycmVudFggKz0gY2VsbFdpZHRoO1xuICB9XG4gIFxuICByZXR1cm4gZmM7XG59XG4iLCJ2YXIgbWlkcG9pbnQgPSByZXF1aXJlKCd0dXJmLW1pZHBvaW50Jyk7XG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG52YXIgZGlzdGFuY2UgPSByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyk7XG5cbi8qKlxuICogVGFrZXMgYSBib3VuZGluZyBib3ggYW5kIGNhbGN1bGF0ZXMgdGhlIG1pbmltdW0gc3F1YXJlIGJvdW5kaW5nIGJveCB0aGF0IHdvdWxkIGNvbnRhaW4gdGhlIGlucHV0LlxuICpcbiAqIEBtb2R1bGUgdHVyZi9zcXVhcmVcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBiYm94IGEgYm91bmRpbmcgYm94XG4gKiBAcmV0dXJuIHtBcnJheTxudW1iZXI+fSBhIHNxdWFyZSBzdXJyb3VuZGluZyBgYmJveGBcbiAqIEBleGFtcGxlXG4gKiB2YXIgYmJveCA9IFstMjAsLTIwLC0xNSwwXTtcbiAqXG4gKiB2YXIgc3F1YXJlZCA9IHR1cmYuc3F1YXJlKGJib3gpO1xuICpcbiAqIHZhciBmZWF0dXJlcyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAgdHVyZi5iYm94UG9seWdvbihiYm94KSxcbiAqICAgICB0dXJmLmJib3hQb2x5Z29uKHNxdWFyZWQpXG4gKiAgIF1cbiAqIH07XG4gKlxuICogLy89ZmVhdHVyZXNcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiYm94KXtcbiAgdmFyIHNxdWFyZUJib3ggPSBbMCwwLDAsMF07XG4gIHZhciBsb3dMZWZ0ID0gcG9pbnQoW2Jib3hbMF0sIGJib3hbMV1dKTtcbiAgdmFyIHRvcExlZnQgPSBwb2ludChbYmJveFswXSwgYmJveFszXV0pO1xuICB2YXIgdG9wUmlnaHQgPSBwb2ludChbYmJveFsyXSwgYmJveFszXV0pO1xuICB2YXIgbG93UmlnaHQgPSBwb2ludChbYmJveFsyXSwgYmJveFsxXV0pO1xuXG4gIHZhciBob3Jpem9udGFsRGlzdGFuY2UgPSBkaXN0YW5jZShsb3dMZWZ0LCBsb3dSaWdodCwgJ21pbGVzJyk7XG4gIHZhciB2ZXJ0aWNhbERpc3RhbmNlID0gZGlzdGFuY2UobG93TGVmdCwgdG9wTGVmdCwgJ21pbGVzJyk7XG4gIGlmKGhvcml6b250YWxEaXN0YW5jZSA+PSB2ZXJ0aWNhbERpc3RhbmNlKXtcbiAgICBzcXVhcmVCYm94WzBdID0gYmJveFswXTtcbiAgICBzcXVhcmVCYm94WzJdID0gYmJveFsyXTtcbiAgICB2YXIgdmVydGljYWxNaWRwb2ludCA9IG1pZHBvaW50KGxvd0xlZnQsIHRvcExlZnQpO1xuICAgIHNxdWFyZUJib3hbMV0gPSB2ZXJ0aWNhbE1pZHBvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdIC0gKChiYm94WzJdIC0gYmJveFswXSkgLyAyKTtcbiAgICBzcXVhcmVCYm94WzNdID0gdmVydGljYWxNaWRwb2ludC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSArICgoYmJveFsyXSAtIGJib3hbMF0pIC8gMik7XG4gICAgcmV0dXJuIHNxdWFyZUJib3g7XG4gIH1cbiAgZWxzZSB7XG4gICAgc3F1YXJlQmJveFsxXSA9IGJib3hbMV07XG4gICAgc3F1YXJlQmJveFszXSA9IGJib3hbM107XG4gICAgdmFyIGhvcnpvbnRhbE1pZHBvaW50ID0gbWlkcG9pbnQobG93TGVmdCwgbG93UmlnaHQpO1xuICAgIHNxdWFyZUJib3hbMF0gPSBob3J6b250YWxNaWRwb2ludC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSAtICgoYmJveFszXSAtIGJib3hbMV0pIC8gMik7XG4gICAgc3F1YXJlQmJveFsyXSA9IGhvcnpvbnRhbE1pZHBvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdICsgKChiYm94WzNdIC0gYmJveFsxXSkgLyAyKTtcbiAgICByZXR1cm4gc3F1YXJlQmJveDtcbiAgfVxufVxuXG4iLCJ2YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcblxuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBzdW0gb2YgYSBmaWVsZCBmb3Ige0BsaW5rIFBvaW50fSBmZWF0dXJlcyB3aXRoaW4gYSBzZXQgb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9zdW1cbiAqIEBjYXRlZ29yeSBhZ2dyZWdhdGlvblxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBpbkZpZWxkIHRoZSBmaWVsZCBpbiBpbnB1dCBkYXRhIHRvIGFuYWx5emVcbiAqIEBwYXJhbSB7U3RyaW5nfSBvdXRGaWVsZCB0aGUgZmllbGQgaW4gd2hpY2ggdG8gc3RvcmUgcmVzdWx0c1xuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiB3aXRoIHByb3BlcnRpZXMgbGlzdGVkIGFzIGBvdXRGaWVsZGBcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9seWdvbnMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbLTg3Ljk5MDE4OCwgNDMuMDI2NDg2XSxcbiAqICAgICAgICAgICBbLTg3Ljk5MDE4OCwgNDMuMDYyMTE1XSxcbiAqICAgICAgICAgICBbLTg3LjkxMzI4NCwgNDMuMDYyMTE1XSxcbiAqICAgICAgICAgICBbLTg3LjkxMzI4NCwgNDMuMDI2NDg2XSxcbiAqICAgICAgICAgICBbLTg3Ljk5MDE4OCwgNDMuMDI2NDg2XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbLTg3Ljk3MzcwOSwgNDIuOTYyNDUyXSxcbiAqICAgICAgICAgICBbLTg3Ljk3MzcwOSwgNDMuMDE0Njg5XSxcbiAqICAgICAgICAgICBbLTg3LjkwNDAxNCwgNDMuMDE0Njg5XSxcbiAqICAgICAgICAgICBbLTg3LjkwNDAxNCwgNDIuOTYyNDUyXSxcbiAqICAgICAgICAgICBbLTg3Ljk3MzcwOSwgNDIuOTYyNDUyXVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTg3Ljk3NDA1MiwgNDMuMDQ5MzIxXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA2MDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTg3Ljk1NzIyOSwgNDMuMDM3Mjc3XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTg3LjkzMTEzNywgNDMuMDQ4NTY4XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTg3Ljk2MzQwOSwgNDIuOTk2MTFdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDMwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstODcuOTQxNzgsIDQyLjk3NDc2Ml1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGFnZ3JlZ2F0ZWQgPSB0dXJmLnN1bShcbiAqICAgcG9seWdvbnMsIHBvaW50cywgJ3BvcHVsYXRpb24nLCAnc3VtJyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChcbiAqICAgYWdncmVnYXRlZC5mZWF0dXJlcyk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlGQywgcHRGQywgaW5GaWVsZCwgb3V0RmllbGQpe1xuICBwb2x5RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwb2x5KXtcbiAgICBpZighcG9seS5wcm9wZXJ0aWVzKXtcbiAgICAgIHBvbHkucHJvcGVydGllcyA9IHt9O1xuICAgIH1cbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgcHRGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHB0KXtcbiAgICAgIGlmIChpbnNpZGUocHQsIHBvbHkpKSB7XG4gICAgICAgIHZhbHVlcy5wdXNoKHB0LnByb3BlcnRpZXNbaW5GaWVsZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHBvbHkucHJvcGVydGllc1tvdXRGaWVsZF0gPSBzdW0odmFsdWVzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHBvbHlGQztcbn07XG5cbmZ1bmN0aW9uIHN1bSh4KSB7XG4gICAgdmFyIHZhbHVlID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFsdWUgKz0geFtpXTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuIiwidmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYW5kIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGFuZCBwZXJmb3JtcyBhIHNwYXRpYWwgam9pbi5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvdGFnXG4gKiBAY2F0ZWdvcnkgam9pbnNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcGFyYW0ge1N0cmluZ30gcG9seUlkIHByb3BlcnR5IGluIGBwb2x5Z29uc2AgdG8gYWRkIHRvIGpvaW5lZCBQb2ludCBmZWF0dXJlc1xuICogQHBhcmFtIHtTdHJpbmd9IGNvbnRhaW5pbmdQb2x5SWQgcHJvcGVydHkgaW4gYHBvaW50c2AgaW4gd2hpY2ggdG8gc3RvcmUgam9pbmVkIHByb3BlcnR5IGZyb20gYHBvbHlnb25zXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBwb2ludCBmZWF0dXJlc1xuICogQGV4YW1wbGVcbiAqIHZhciBiYm94ID0gWzAsIDAsIDUwLCA1MF07XG4gKiAvLyBjcmVhdGUgYSB0cmlhbmd1bGFyIGdyaWQgb2YgcG9seWdvbnNcbiAqIHZhciB0cmlhbmdsZUdyaWQgPSB0dXJmLnRpbih0dXJmLmdyaWQoYmJveCwgMTApKTtcbiAqIHRyaWFuZ2xlR3JpZC5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKGYpIHtcbiAqICAgZi5wcm9wZXJ0aWVzLmZpbGwgPSAnIycgK1xuICogICAgICh+fihNYXRoLnJhbmRvbSgpICogMTYpKS50b1N0cmluZygxNikgK1xuICogICAgICh+fihNYXRoLnJhbmRvbSgpICogMTYpKS50b1N0cmluZygxNikgK1xuICogICAgICh+fihNYXRoLnJhbmRvbSgpICogMTYpKS50b1N0cmluZygxNik7XG4gKiAgIGYucHJvcGVydGllcy5zdHJva2UgPSAwO1xuICogICBmLnByb3BlcnRpZXNbJ2ZpbGwtb3BhY2l0eSddID0gMTtcbiAqIH0pO1xuICogdmFyIHJhbmRvbVBvaW50cyA9IHR1cmYucmFuZG9tKCdwb2ludCcsIDMwLCB7XG4gKiAgIGJib3g6IGJib3hcbiAqIH0pO1xuICogdmFyIGJvdGggPSB0dXJmLmZlYXR1cmVjb2xsZWN0aW9uKFxuICogICB0cmlhbmdsZUdyaWQuZmVhdHVyZXMuY29uY2F0KHJhbmRvbVBvaW50cy5mZWF0dXJlcykpO1xuICpcbiAqIC8vPWJvdGhcbiAqXG4gKiB2YXIgdGFnZ2VkID0gdHVyZi50YWcocmFuZG9tUG9pbnRzLCB0cmlhbmdsZUdyaWQsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgJ2ZpbGwnLCAnbWFya2VyLWNvbG9yJyk7XG4gKlxuICogLy89dGFnZ2VkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnRzLCBwb2x5Z29ucywgZmllbGQsIG91dEZpZWxkKXtcbiAgLy8gcHJldmVudCBtdXRhdGlvbnNcbiAgcG9pbnRzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwb2ludHMpKTtcbiAgcG9seWdvbnMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHBvbHlnb25zKSk7XG4gIHBvaW50cy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHB0KSB7XG4gICAgaWYgKCFwdC5wcm9wZXJ0aWVzKSB7XG4gICAgICBwdC5wcm9wZXJ0aWVzID0ge307XG4gICAgfVxuICAgIHBvbHlnb25zLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocG9seSkge1xuICAgICAgaWYgKHB0LnByb3BlcnRpZXNbb3V0RmllbGRdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyIGlzSW5zaWRlID0gaW5zaWRlKHB0LCBwb2x5KTtcbiAgICAgICAgaWYgKGlzSW5zaWRlKSB7XG4gICAgICAgICAgcHQucHJvcGVydGllc1tvdXRGaWVsZF0gPSBwb2x5LnByb3BlcnRpZXNbZmllbGRdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gcG9pbnRzO1xufTtcbiIsIi8vaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9EZWxhdW5heV90cmlhbmd1bGF0aW9uXG4vL2h0dHBzOi8vZ2l0aHViLmNvbS9pcm9ud2FsbGFieS9kZWxhdW5heVxudmFyIHBvbHlnb24gPSByZXF1aXJlKCd0dXJmLXBvbHlnb24nKTtcbnZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIHNldCBvZiBwb2ludHMgYW5kIHRoZSBuYW1lIG9mIGEgei12YWx1ZSBwcm9wZXJ0eSBhbmRcbiAqIGNyZWF0ZXMgYSBbVHJpYW5ndWxhdGVkIElycmVndWxhciBOZXR3b3JrXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1RyaWFuZ3VsYXRlZF9pcnJlZ3VsYXJfbmV0d29yayksXG4gKiBvciBhIFRJTiBmb3Igc2hvcnQsIHJldHVybmVkIGFzIGEgY29sbGVjdGlvbiBvZiBQb2x5Z29ucy4gVGhlc2UgYXJlIG9mdGVuIHVzZWRcbiAqIGZvciBkZXZlbG9waW5nIGVsZXZhdGlvbiBjb250b3VyIG1hcHMgb3Igc3RlcHBlZCBoZWF0IHZpc3VhbGl6YXRpb25zLlxuICpcbiAqIFRoaXMgdHJpYW5ndWxhdGVzIHRoZSBwb2ludHMsIGFzIHdlbGwgYXMgYWRkcyBwcm9wZXJ0aWVzIGNhbGxlZCBgYWAsIGBiYCxcbiAqIGFuZCBgY2AgcmVwcmVzZW50aW5nIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gYHByb3BlcnR5TmFtZWAgYXQgZWFjaCBvZlxuICogdGhlIHBvaW50cyB0aGF0IHJlcHJlc2VudCB0aGUgY29ybmVycyBvZiB0aGUgdHJpYW5nbGUuXG4gKlxuICogQG1vZHVsZSB0dXJmL3RpblxuICogQGNhdGVnb3J5IGludGVycG9sYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyAtIGEgR2VvSlNPTiBGZWF0dXJlQ29sbGVjdGlvbiBjb250YWluaW5nXG4gKiBGZWF0dXJlcyB3aXRoIHtAbGluayBQb2ludH0gZ2VvbWV0cmllc1xuICogQHBhcmFtIHtzdHJpbmc9fSBwcm9wZXJ0eU5hbWUgLSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBmcm9tIHdoaWNoIHRvIHB1bGwgeiB2YWx1ZXMuXG4gKiBUaGlzIGlzIG9wdGlvbmFsOiBpZiBub3QgZ2l2ZW4sIHRoZW4gdGhlcmUgd2lsbCBiZSBubyBleHRyYSBkYXRhIGFkZGVkIHRvIHRoZSBkZXJpdmVkIHRyaWFuZ2xlcy5cbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBUSU4gb3V0cHV0XG4gKiBAZXhhbXBsZVxuICogLy8gZ2VuZXJhdGUgc29tZSByYW5kb20gcG9pbnQgZGF0YVxuICogdmFyIHBvaW50cyA9IHR1cmYucmFuZG9tKCdwb2ludHMnLCAzMCwge1xuICogICBiYm94OiBbNTAsIDMwLCA3MCwgNTBdXG4gKiB9KTtcbiAqIC8vPXBvaW50c1xuICogLy8gYWRkIGEgcmFuZG9tIHByb3BlcnR5IHRvIGVhY2ggcG9pbnQgYmV0d2VlbiAwIGFuZCA5XG4gKiBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50cy5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICogICBwb2ludHMuZmVhdHVyZXNbaV0ucHJvcGVydGllcy56ID0gfn4oTWF0aC5yYW5kb20oKSAqIDkpO1xuICogfVxuICogdmFyIHRpbiA9IHR1cmYudGluKHBvaW50cywgJ3onKVxuICogZm9yICh2YXIgaSA9IDA7IGkgPCB0aW4uZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAqICAgdmFyIHByb3BlcnRpZXMgID0gdGluLmZlYXR1cmVzW2ldLnByb3BlcnRpZXM7XG4gKiAgIC8vIHJvdWdobHkgdHVybiB0aGUgcHJvcGVydGllcyBvZiBlYWNoXG4gKiAgIC8vIHRyaWFuZ2xlIGludG8gYSBmaWxsIGNvbG9yXG4gKiAgIC8vIHNvIHdlIGNhbiB2aXN1YWxpemUgdGhlIHJlc3VsdFxuICogICBwcm9wZXJ0aWVzLmZpbGwgPSAnIycgKyBwcm9wZXJ0aWVzLmEgK1xuICogICAgIHByb3BlcnRpZXMuYiArIHByb3BlcnRpZXMuYztcbiAqIH1cbiAqIC8vPXRpblxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvaW50cywgeikge1xuICAvL2JyZWFrIGRvd24gcG9pbnRzXG4gIHJldHVybiBmZWF0dXJlY29sbGVjdGlvbih0cmlhbmd1bGF0ZShwb2ludHMuZmVhdHVyZXMubWFwKGZ1bmN0aW9uKHApIHtcbiAgICB2YXIgcG9pbnQgPSB7XG4gICAgICB4OiBwLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgeTogcC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXVxuICAgIH07XG4gICAgaWYgKHopIHBvaW50LnogPSBwLnByb3BlcnRpZXNbel07XG4gICAgcmV0dXJuIHBvaW50O1xuICB9KSkubWFwKGZ1bmN0aW9uKHRyaWFuZ2xlKSB7XG4gICAgcmV0dXJuIHBvbHlnb24oW1tcbiAgICAgICAgW3RyaWFuZ2xlLmEueCwgdHJpYW5nbGUuYS55XSxcbiAgICAgICAgW3RyaWFuZ2xlLmIueCwgdHJpYW5nbGUuYi55XSxcbiAgICAgICAgW3RyaWFuZ2xlLmMueCwgdHJpYW5nbGUuYy55XSxcbiAgICAgICAgW3RyaWFuZ2xlLmEueCwgdHJpYW5nbGUuYS55XVxuICAgIF1dLCB7XG4gICAgICAgIGE6IHRyaWFuZ2xlLmEueixcbiAgICAgICAgYjogdHJpYW5nbGUuYi56LFxuICAgICAgICBjOiB0cmlhbmdsZS5jLnpcbiAgICAgIH0pO1xuICB9KSk7XG59O1xuXG5mdW5jdGlvbiBUcmlhbmdsZShhLCBiLCBjKSB7XG4gIHRoaXMuYSA9IGE7XG4gIHRoaXMuYiA9IGI7XG4gIHRoaXMuYyA9IGM7XG5cbiAgdmFyIEEgPSBiLnggLSBhLngsXG4gICAgQiA9IGIueSAtIGEueSxcbiAgICBDID0gYy54IC0gYS54LFxuICAgIEQgPSBjLnkgLSBhLnksXG4gICAgRSA9IEEgKiAoYS54ICsgYi54KSArIEIgKiAoYS55ICsgYi55KSxcbiAgICBGID0gQyAqIChhLnggKyBjLngpICsgRCAqIChhLnkgKyBjLnkpLFxuICAgIEcgPSAyICogKEEgKiAoYy55IC0gYi55KSAtIEIgKiAoYy54IC0gYi54KSksXG4gICAgbWlueCwgbWlueSwgZHgsIGR5O1xuXG4gIC8vIElmIHRoZSBwb2ludHMgb2YgdGhlIHRyaWFuZ2xlIGFyZSBjb2xsaW5lYXIsIHRoZW4ganVzdCBmaW5kIHRoZVxuICAvLyBleHRyZW1lcyBhbmQgdXNlIHRoZSBtaWRwb2ludCBhcyB0aGUgY2VudGVyIG9mIHRoZSBjaXJjdW1jaXJjbGUuXG4gIGlmIChNYXRoLmFicyhHKSA8IDAuMDAwMDAxKSB7XG4gICAgbWlueCA9IE1hdGgubWluKGEueCwgYi54LCBjLngpO1xuICAgIG1pbnkgPSBNYXRoLm1pbihhLnksIGIueSwgYy55KTtcbiAgICBkeCA9IChNYXRoLm1heChhLngsIGIueCwgYy54KSAtIG1pbngpICogMC41O1xuICAgIGR5ID0gKE1hdGgubWF4KGEueSwgYi55LCBjLnkpIC0gbWlueSkgKiAwLjU7XG5cbiAgICB0aGlzLnggPSBtaW54ICsgZHg7XG4gICAgdGhpcy55ID0gbWlueSArIGR5O1xuICAgIHRoaXMuciA9IGR4ICogZHggKyBkeSAqIGR5O1xuICB9IGVsc2Uge1xuICAgIHRoaXMueCA9IChEICogRSAtIEIgKiBGKSAvIEc7XG4gICAgdGhpcy55ID0gKEEgKiBGIC0gQyAqIEUpIC8gRztcbiAgICBkeCA9IHRoaXMueCAtIGEueDtcbiAgICBkeSA9IHRoaXMueSAtIGEueTtcbiAgICB0aGlzLnIgPSBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgfVxufVxuXG5mdW5jdGlvbiBieVgoYSwgYikge1xuICByZXR1cm4gYi54IC0gYS54O1xufVxuXG5mdW5jdGlvbiBkZWR1cChlZGdlcykge1xuICB2YXIgaiA9IGVkZ2VzLmxlbmd0aCxcbiAgICBhLCBiLCBpLCBtLCBuO1xuXG4gIG91dGVyOlxuICB3aGlsZSAoaikge1xuICAgIGIgPSBlZGdlc1stLWpdO1xuICAgIGEgPSBlZGdlc1stLWpdO1xuICAgIGkgPSBqO1xuICAgIHdoaWxlIChpKSB7XG4gICAgICBuID0gZWRnZXNbLS1pXTtcbiAgICAgIG0gPSBlZGdlc1stLWldO1xuICAgICAgaWYgKChhID09PSBtICYmIGIgPT09IG4pIHx8IChhID09PSBuICYmIGIgPT09IG0pKSB7XG4gICAgICAgIGVkZ2VzLnNwbGljZShqLCAyKTtcbiAgICAgICAgZWRnZXMuc3BsaWNlKGksIDIpO1xuICAgICAgICBqIC09IDI7XG4gICAgICAgIGNvbnRpbnVlIG91dGVyO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiB0cmlhbmd1bGF0ZSh2ZXJ0aWNlcykge1xuICAvLyBCYWlsIGlmIHRoZXJlIGFyZW4ndCBlbm91Z2ggdmVydGljZXMgdG8gZm9ybSBhbnkgdHJpYW5nbGVzLlxuICBpZiAodmVydGljZXMubGVuZ3RoIDwgMylcbiAgICByZXR1cm4gW107XG5cbiAgICAvLyBFbnN1cmUgdGhlIHZlcnRleCBhcnJheSBpcyBpbiBvcmRlciBvZiBkZXNjZW5kaW5nIFggY29vcmRpbmF0ZVxuICAgIC8vICh3aGljaCBpcyBuZWVkZWQgdG8gZW5zdXJlIGEgc3VicXVhZHJhdGljIHJ1bnRpbWUpLCBhbmQgdGhlbiBmaW5kXG4gICAgLy8gdGhlIGJvdW5kaW5nIGJveCBhcm91bmQgdGhlIHBvaW50cy4gXG4gIHZlcnRpY2VzLnNvcnQoYnlYKTtcblxuICB2YXIgaSA9IHZlcnRpY2VzLmxlbmd0aCAtIDEsXG4gICAgeG1pbiA9IHZlcnRpY2VzW2ldLngsXG4gICAgeG1heCA9IHZlcnRpY2VzWzBdLngsXG4gICAgeW1pbiA9IHZlcnRpY2VzW2ldLnksXG4gICAgeW1heCA9IHltaW47XG5cbiAgd2hpbGUgKGktLSkge1xuICAgIGlmICh2ZXJ0aWNlc1tpXS55IDwgeW1pbilcbiAgICAgIHltaW4gPSB2ZXJ0aWNlc1tpXS55O1xuICAgIGlmICh2ZXJ0aWNlc1tpXS55ID4geW1heClcbiAgICAgIHltYXggPSB2ZXJ0aWNlc1tpXS55O1xuICB9XG5cbiAgLy9GaW5kIGEgc3VwZXJ0cmlhbmdsZSwgd2hpY2ggaXMgYSB0cmlhbmdsZSB0aGF0IHN1cnJvdW5kcyBhbGwgdGhlXG4gIC8vdmVydGljZXMuIFRoaXMgaXMgdXNlZCBsaWtlIHNvbWV0aGluZyBvZiBhIHNlbnRpbmVsIHZhbHVlIHRvIHJlbW92ZVxuICAvL2Nhc2VzIGluIHRoZSBtYWluIGFsZ29yaXRobSwgYW5kIGlzIHJlbW92ZWQgYmVmb3JlIHdlIHJldHVybiBhbnlcbiAgLy8gcmVzdWx0cy5cbiBcbiAgLy8gT25jZSBmb3VuZCwgcHV0IGl0IGluIHRoZSBcIm9wZW5cIiBsaXN0LiAoVGhlIFwib3BlblwiIGxpc3QgaXMgZm9yXG4gIC8vIHRyaWFuZ2xlcyB3aG8gbWF5IHN0aWxsIG5lZWQgdG8gYmUgY29uc2lkZXJlZDsgdGhlIFwiY2xvc2VkXCIgbGlzdCBpc1xuICAvLyBmb3IgdHJpYW5nbGVzIHdoaWNoIGRvIG5vdC4pXG4gIHZhciBkeCA9IHhtYXggLSB4bWluLFxuICAgIGR5ID0geW1heCAtIHltaW4sXG4gICAgZG1heCA9IChkeCA+IGR5KSA/IGR4IDogZHksXG4gICAgeG1pZCA9ICh4bWF4ICsgeG1pbikgKiAwLjUsXG4gICAgeW1pZCA9ICh5bWF4ICsgeW1pbikgKiAwLjUsXG4gICAgb3BlbiA9IFtcbiAgICAgIG5ldyBUcmlhbmdsZSh7XG4gICAgICAgIHg6IHhtaWQgLSAyMCAqIGRtYXgsXG4gICAgICAgIHk6IHltaWQgLSBkbWF4LFxuICAgICAgICBfX3NlbnRpbmVsOiB0cnVlXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB4OiB4bWlkLFxuICAgICAgICB5OiB5bWlkICsgMjAgKiBkbWF4LFxuICAgICAgICBfX3NlbnRpbmVsOiB0cnVlXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB4OiB4bWlkICsgMjAgKiBkbWF4LFxuICAgICAgICB5OiB5bWlkIC0gZG1heCxcbiAgICAgICAgX19zZW50aW5lbDogdHJ1ZVxuICAgICAgfVxuICAgICldLFxuICAgIGNsb3NlZCA9IFtdLFxuICAgIGVkZ2VzID0gW10sXG4gICAgaiwgYSwgYjtcblxuICAgIC8vIEluY3JlbWVudGFsbHkgYWRkIGVhY2ggdmVydGV4IHRvIHRoZSBtZXNoLlxuICBpID0gdmVydGljZXMubGVuZ3RoO1xuICB3aGlsZSAoaS0tKSB7XG4gICAgLy8gRm9yIGVhY2ggb3BlbiB0cmlhbmdsZSwgY2hlY2sgdG8gc2VlIGlmIHRoZSBjdXJyZW50IHBvaW50IGlzXG4gICAgLy8gaW5zaWRlIGl0J3MgY2lyY3VtY2lyY2xlLiBJZiBpdCBpcywgcmVtb3ZlIHRoZSB0cmlhbmdsZSBhbmQgYWRkXG4gICAgLy8gaXQncyBlZGdlcyB0byBhbiBlZGdlIGxpc3QuXG4gICAgZWRnZXMubGVuZ3RoID0gMDtcbiAgICBqID0gb3Blbi5sZW5ndGg7XG4gICAgd2hpbGUgKGotLSkge1xuICAgICAgLy8gSWYgdGhpcyBwb2ludCBpcyB0byB0aGUgcmlnaHQgb2YgdGhpcyB0cmlhbmdsZSdzIGNpcmN1bWNpcmNsZSxcbiAgICAgIC8vIHRoZW4gdGhpcyB0cmlhbmdsZSBzaG91bGQgbmV2ZXIgZ2V0IGNoZWNrZWQgYWdhaW4uIFJlbW92ZSBpdFxuICAgICAgLy8gZnJvbSB0aGUgb3BlbiBsaXN0LCBhZGQgaXQgdG8gdGhlIGNsb3NlZCBsaXN0LCBhbmQgc2tpcC5cbiAgICAgIGR4ID0gdmVydGljZXNbaV0ueCAtIG9wZW5bal0ueDtcbiAgICAgIGlmIChkeCA+IDAgJiYgZHggKiBkeCA+IG9wZW5bal0ucikge1xuICAgICAgICBjbG9zZWQucHVzaChvcGVuW2pdKTtcbiAgICAgICAgb3Blbi5zcGxpY2UoaiwgMSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiBub3QsIHNraXAgdGhpcyB0cmlhbmdsZS5cbiAgICAgIGR5ID0gdmVydGljZXNbaV0ueSAtIG9wZW5bal0ueTtcbiAgICAgIGlmIChkeCAqIGR4ICsgZHkgKiBkeSA+IG9wZW5bal0ucilcbiAgICAgICAgY29udGludWU7XG5cbiAgICAgIC8vIFJlbW92ZSB0aGUgdHJpYW5nbGUgYW5kIGFkZCBpdCdzIGVkZ2VzIHRvIHRoZSBlZGdlIGxpc3QuXG4gICAgICBlZGdlcy5wdXNoKFxuICAgICAgICBvcGVuW2pdLmEsIG9wZW5bal0uYixcbiAgICAgICAgb3BlbltqXS5iLCBvcGVuW2pdLmMsXG4gICAgICAgIG9wZW5bal0uYywgb3BlbltqXS5hXG4gICAgICApO1xuICAgICAgb3Blbi5zcGxpY2UoaiwgMSk7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGFueSBkb3VibGVkIGVkZ2VzLlxuICAgIGRlZHVwKGVkZ2VzKTtcblxuICAgIC8vIEFkZCBhIG5ldyB0cmlhbmdsZSBmb3IgZWFjaCBlZGdlLlxuICAgIGogPSBlZGdlcy5sZW5ndGg7XG4gICAgd2hpbGUgKGopIHtcbiAgICAgIGIgPSBlZGdlc1stLWpdO1xuICAgICAgYSA9IGVkZ2VzWy0tal07XG4gICAgICBvcGVuLnB1c2gobmV3IFRyaWFuZ2xlKGEsIGIsIHZlcnRpY2VzW2ldKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ29weSBhbnkgcmVtYWluaW5nIG9wZW4gdHJpYW5nbGVzIHRvIHRoZSBjbG9zZWQgbGlzdCwgYW5kIHRoZW5cbiAgLy8gcmVtb3ZlIGFueSB0cmlhbmdsZXMgdGhhdCBzaGFyZSBhIHZlcnRleCB3aXRoIHRoZSBzdXBlcnRyaWFuZ2xlLlxuICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShjbG9zZWQsIG9wZW4pO1xuXG4gIGkgPSBjbG9zZWQubGVuZ3RoO1xuICB3aGlsZSAoaS0tKVxuICBpZiAoY2xvc2VkW2ldLmEuX19zZW50aW5lbCB8fFxuICAgICAgY2xvc2VkW2ldLmIuX19zZW50aW5lbCB8fFxuICAgICAgY2xvc2VkW2ldLmMuX19zZW50aW5lbClcbiAgICAgIGNsb3NlZC5zcGxpY2UoaSwgMSk7XG5cbiAgcmV0dXJuIGNsb3NlZDtcbn1cbiIsInZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcbnZhciBwb2x5Z29uID0gcmVxdWlyZSgndHVyZi1wb2x5Z29uJyk7XG52YXIgZGlzdGFuY2UgPSByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyk7XG5cbi8qKlxuICogVGFrZXMgYSBib3VuZGluZyBib3ggYW5kIGEgY2VsbCBkZXB0aCBhbmQgcmV0dXJucyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGluIGEgZ3JpZC5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvdHJpYW5nbGUtZ3JpZFxuICogQGNhdGVnb3J5IGludGVycG9sYXRpb25cbiAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gZXh0ZW50IGV4dGVudCBpbiBbbWluWCwgbWluWSwgbWF4WCwgbWF4WV0gb3JkZXJcbiAqIEBwYXJhbSB7TnVtYmVyfSBjZWxsV2lkdGggd2lkdGggb2YgZWFjaCBjZWxsXG4gKiBAcGFyYW0ge1N0cmluZ30gdW5pdHMgdW5pdHMgdG8gdXNlIGZvciBjZWxsV2lkdGhcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBncmlkIGFzIEZlYXR1cmVDb2xsZWN0aW9uIHdpdGgge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGV4dGVudCA9IFstNzcuMzg3Njk1MzEyNSwzOC43MTk4MDQ3NDI2NDIzOSwtNzYuOTQ4MjQyMTg3NSwzOS4wMjc3MTg4NDAyMTE2MDVdO1xuICogdmFyIGNlbGxXaWR0aCA9IDEwO1xuICogdmFyIHVuaXRzID0gJ21pbGVzJztcbiAqXG4gKiB2YXIgdHJpYW5nbGVHcmlkID0gdHVyZi50cmlhbmdsZUdyaWQoZXh0ZW50LCBjZWxsV2lkdGgsIHVuaXRzKTtcbiAqXG4gKiAvLz10cmlhbmdsZUdyaWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYmJveCwgY2VsbCwgdW5pdHMpIHtcbiAgdmFyIGZjID0gZmVhdHVyZWNvbGxlY3Rpb24oW10pO1xuICB2YXIgeEZyYWN0aW9uID0gY2VsbCAvIChkaXN0YW5jZShwb2ludChbYmJveFswXSwgYmJveFsxXV0pLCBwb2ludChbYmJveFsyXSwgYmJveFsxXV0pLCB1bml0cykpO1xuICB2YXIgY2VsbFdpZHRoID0geEZyYWN0aW9uICogKGJib3hbMl0gLSBiYm94WzBdKTtcbiAgdmFyIHlGcmFjdGlvbiA9IGNlbGwgLyAoZGlzdGFuY2UocG9pbnQoW2Jib3hbMF0sIGJib3hbMV1dKSwgcG9pbnQoW2Jib3hbMF0sIGJib3hbM11dKSwgdW5pdHMpKTtcbiAgdmFyIGNlbGxIZWlnaHQgPSB5RnJhY3Rpb24gKiAoYmJveFszXSAtIGJib3hbMV0pO1xuXG4gIHZhciB4aSA9IDA7XG4gIHZhciBjdXJyZW50WCA9IGJib3hbMF07XG4gIHdoaWxlIChjdXJyZW50WCA8PSBiYm94WzJdKSB7XG4gICAgdmFyIHlpID0gMDtcbiAgICB2YXIgY3VycmVudFkgPSBiYm94WzFdO1xuICAgIHdoaWxlIChjdXJyZW50WSA8PSBiYm94WzNdKSB7XG4gICAgICBpZih4aSUyPT09MCAmJiB5aSUyPT09MCkge1xuICAgICAgICB2YXIgY2VsbDEgPSBwb2x5Z29uKFtbXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXSxcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgICBbY3VycmVudFgrY2VsbFdpZHRoLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXVxuICAgICAgICAgIF1dKTtcbiAgICAgICAgZmMuZmVhdHVyZXMucHVzaChjZWxsMSk7XG4gICAgICAgIHZhciBjZWxsMiA9IHBvbHlnb24oW1tcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgICBbY3VycmVudFgrY2VsbFdpZHRoLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZXSxcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFkrY2VsbEhlaWdodF1cbiAgICAgICAgICBdXSk7XG4gICAgICAgIGZjLmZlYXR1cmVzLnB1c2goY2VsbDIpO1xuICAgICAgfSBlbHNlIGlmKHhpJTI9PT0wICYmIHlpJTI9PT0xKSB7XG4gICAgICAgIHZhciBjZWxsMSA9IHBvbHlnb24oW1tcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgICBbY3VycmVudFgrY2VsbFdpZHRoLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXVxuICAgICAgICAgIF1dKTtcbiAgICAgICAgZmMuZmVhdHVyZXMucHVzaChjZWxsMSk7XG4gICAgICAgIHZhciBjZWxsMiA9IHBvbHlnb24oW1tcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV1cbiAgICAgICAgICBdXSk7XG4gICAgICAgIGZjLmZlYXR1cmVzLnB1c2goY2VsbDIpO1xuICAgICAgfSBlbHNlIGlmKHlpJTI9PT0wICYmIHhpJTI9PT0xKSB7XG4gICAgICAgIHZhciBjZWxsMSA9IHBvbHlnb24oW1tcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV1cbiAgICAgICAgICBdXSk7XG4gICAgICAgIGZjLmZlYXR1cmVzLnB1c2goY2VsbDEpO1xuICAgICAgICB2YXIgY2VsbDIgPSBwb2x5Z29uKFtbXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV1cbiAgICAgICAgICBdXSk7XG4gICAgICAgIGZjLmZlYXR1cmVzLnB1c2goY2VsbDIpO1xuICAgICAgfSBlbHNlIGlmKHlpJTI9PT0xICYmIHhpJTI9PT0xKSB7XG4gICAgICAgIHZhciBjZWxsMSA9IHBvbHlnb24oW1tcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZXSxcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldXG4gICAgICAgICAgXV0pO1xuICAgICAgICBmYy5mZWF0dXJlcy5wdXNoKGNlbGwxKTtcbiAgICAgICAgdmFyIGNlbGwyID0gcG9seWdvbihbW1xuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XVxuICAgICAgICAgIF1dKTtcbiAgICAgICAgZmMuZmVhdHVyZXMucHVzaChjZWxsMik7XG4gICAgICB9XG4gICAgICBjdXJyZW50WSArPSBjZWxsSGVpZ2h0O1xuICAgICAgeWkrKztcbiAgICB9XG4gICAgeGkrKztcbiAgICBjdXJyZW50WCArPSBjZWxsV2lkdGg7XG4gIH1cbiAgcmV0dXJuIGZjO1xufTtcblxuIiwiLy8gbG9vayBoZXJlIGZvciBoZWxwIGh0dHA6Ly9zdm4ub3NnZW8ub3JnL2dyYXNzL2dyYXNzL2JyYW5jaGVzL3JlbGVhc2VicmFuY2hfNl80L3ZlY3Rvci92Lm92ZXJsYXkvbWFpbi5jXG4vL211c3QgYmUgYXJyYXkgb2YgcG9seWdvbnNcblxuLy8gZGVwZW5kIG9uIGpzdHMgZm9yIG5vdyBodHRwczovL2dpdGh1Yi5jb20vYmpvcm5oYXJydGVsbC9qc3RzL2Jsb2IvbWFzdGVyL2V4YW1wbGVzL292ZXJsYXkuaHRtbFxuXG52YXIganN0cyA9IHJlcXVpcmUoJ2pzdHMnKTtcblxuLyoqXG4gKiBUYWtlcyB0d28ge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGFuZCByZXR1cm5lcyBhIGNvbWJpbmVkIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlLiBJZiB0aGUgaW5wdXQgUG9seWdvbiBmZWF0dXJlcyBhcmUgbm90IGNvbnRpZ3VvdXMsIHRoaXMgZnVuY3Rpb24gcmV0dXJucyBhIHtAbGluayBNdWx0aVBvbHlnb259IGZlYXR1cmUuXG4gKlxuICogQG1vZHVsZSB0dXJmL3VuaW9uXG4gKiBAY2F0ZWdvcnkgdHJhbnNmb3JtYXRpb25cbiAqIEBwYXJhbSB7UG9seWdvbn0gcG9seTEgYW4gaW5wdXQgUG9seWdvblxuICogQHBhcmFtIHtQb2x5Z29ufSBwb2x5MiBhbm90aGVyIGlucHV0IFBvbHlnb25cbiAqIEByZXR1cm4ge0ZlYXR1cmV9IGEgY29tYmluZWQge0BsaW5rIFBvbHlnb259IG9yIHtAbGluayBNdWx0aVBvbHlnb259IGZlYXR1cmVcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9seTEgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcImZpbGxcIjogXCIjMGYwXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstODIuNTc0Nzg3LCAzNS41OTQwODddLFxuICogICAgICAgWy04Mi41NzQ3ODcsIDM1LjYxNTU4MV0sXG4gKiAgICAgICBbLTgyLjU0NTI2MSwgMzUuNjE1NTgxXSxcbiAqICAgICAgIFstODIuNTQ1MjYxLCAzNS41OTQwODddLFxuICogICAgICAgWy04Mi41NzQ3ODcsIDM1LjU5NDA4N11cbiAqICAgICBdXVxuICogICB9XG4gKiB9O1xuICogdmFyIHBvbHkyID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJmaWxsXCI6IFwiIzAwZlwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICBbLTgyLjU2MDAyNCwgMzUuNTg1MTUzXSxcbiAqICAgICAgIFstODIuNTYwMDI0LCAzNS42MDI2MDJdLFxuICogICAgICAgWy04Mi41Mjk2NCwgMzUuNjAyNjAyXSxcbiAqICAgICAgIFstODIuNTI5NjQsIDM1LjU4NTE1M10sXG4gKiAgICAgICBbLTgyLjU2MDAyNCwgMzUuNTg1MTUzXVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcG9seWdvbnMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW3BvbHkxLCBwb2x5Ml1cbiAqIH07XG4gKlxuICogdmFyIHVuaW9uID0gdHVyZi51bmlvbihwb2x5MSwgcG9seTIpO1xuICpcbiAqIC8vPXBvbHlnb25zXG4gKlxuICogLy89dW5pb25cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5MSwgcG9seTIpe1xuICB2YXIgcmVhZGVyID0gbmV3IGpzdHMuaW8uR2VvSlNPTlJlYWRlcigpO1xuICB2YXIgYSA9IHJlYWRlci5yZWFkKEpTT04uc3RyaW5naWZ5KHBvbHkxLmdlb21ldHJ5KSk7XG4gIHZhciBiID0gcmVhZGVyLnJlYWQoSlNPTi5zdHJpbmdpZnkocG9seTIuZ2VvbWV0cnkpKTtcbiAgdmFyIHVuaW9uID0gYS51bmlvbihiKTtcbiAgdmFyIHBhcnNlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05QYXJzZXIoKTtcblxuICB1bmlvbiA9IHBhcnNlci53cml0ZSh1bmlvbik7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgIGdlb21ldHJ5OiB1bmlvbixcbiAgICBwcm9wZXJ0aWVzOiBwb2x5MS5wcm9wZXJ0aWVzXG4gIH07XG59XG4iLCIvKlxuICBqYXZhc2NyaXB0LnV0aWwgaXMgYSBwb3J0IG9mIHNlbGVjdGVkIHBhcnRzIG9mIGphdmEudXRpbCB0byBKYXZhU2NyaXB0IHdoaWNoXG4gIG1haW4gcHVycG9zZSBpcyB0byBlYXNlIHBvcnRpbmcgSmF2YSBjb2RlIHRvIEphdmFTY3JpcHQuXG4gIFxuICBUaGUgTUlUIExpY2Vuc2UgKE1JVClcblxuICBDb3B5cmlnaHQgKEMpIDIwMTEtMjAxNCBieSBUaGUgQXV0aG9yc1xuXG4gIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cbiAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAgYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG5cbiAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICBUSEUgU09GVFdBUkUuXG4qL1xuOyhmdW5jdGlvbigpe3ZhciBlPXRoaXM7ZnVuY3Rpb24gZihhLGIpe3ZhciBjPWEuc3BsaXQoXCIuXCIpLGQ9ZTtjWzBdaW4gZHx8IWQuZXhlY1NjcmlwdHx8ZC5leGVjU2NyaXB0KFwidmFyIFwiK2NbMF0pO2Zvcih2YXIgdDtjLmxlbmd0aCYmKHQ9Yy5zaGlmdCgpKTspYy5sZW5ndGh8fHZvaWQgMD09PWI/ZD1kW3RdP2RbdF06ZFt0XT17fTpkW3RdPWJ9ZnVuY3Rpb24gZyhhLGIpe2Z1bmN0aW9uIGMoKXt9Yy5wcm90b3R5cGU9Yi5wcm90b3R5cGU7YS5xPWIucHJvdG90eXBlO2EucHJvdG90eXBlPW5ldyBjO2EucHJvdG90eXBlLmNvbnN0cnVjdG9yPWE7YS5wPWZ1bmN0aW9uKGEsYyxPKXt2YXIgTT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGIucHJvdG90eXBlW2NdLmFwcGx5KGEsTSl9fTtmdW5jdGlvbiBoKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcoaCxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5FbXB0eVN0YWNrRXhjZXB0aW9uXCIsaCk7aC5wcm90b3R5cGUubmFtZT1cIkVtcHR5U3RhY2tFeGNlcHRpb25cIjtmdW5jdGlvbiBrKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcoayxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5JbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXCIsayk7ay5wcm90b3R5cGUubmFtZT1cIkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25cIjtmdW5jdGlvbiBsKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuSXRlcmF0b3JcIixsKTtsLnByb3RvdHlwZS5oYXNOZXh0PWwucHJvdG90eXBlLmM7bC5wcm90b3R5cGUubmV4dD1sLnByb3RvdHlwZS5uZXh0O2wucHJvdG90eXBlLnJlbW92ZT1sLnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gbSgpe31mKFwiamF2YXNjcmlwdC51dGlsLkNvbGxlY3Rpb25cIixtKTtmdW5jdGlvbiBuKCl7fWcobixtKTtmKFwiamF2YXNjcmlwdC51dGlsLkxpc3RcIixuKTtmdW5jdGlvbiBwKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuTWFwXCIscCk7ZnVuY3Rpb24gcShhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKHEsRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuTm9TdWNoRWxlbWVudEV4Y2VwdGlvblwiLHEpO3EucHJvdG90eXBlLm5hbWU9XCJOb1N1Y2hFbGVtZW50RXhjZXB0aW9uXCI7ZnVuY3Rpb24gcihhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKHIsRXJyb3IpO3IucHJvdG90eXBlLm5hbWU9XCJPcGVyYXRpb25Ob3RTdXBwb3J0ZWRcIjtmdW5jdGlvbiBzKGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcocyxuKTtmKFwiamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdFwiLHMpO3MucHJvdG90eXBlLmE9bnVsbDtzLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O3MucHJvdG90eXBlLmFkZD1zLnByb3RvdHlwZS5hZGQ7cy5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTtzLnByb3RvdHlwZS5hZGRBbGw9cy5wcm90b3R5cGUuZTtzLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmFbYV07dGhpcy5hW2FdPWI7cmV0dXJuIGN9O3MucHJvdG90eXBlLnNldD1zLnByb3RvdHlwZS5zZXQ7cy5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgdSh0aGlzKX07cy5wcm90b3R5cGUuaXRlcmF0b3I9cy5wcm90b3R5cGUuZjtcbnMucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtpZigwPmF8fGE+PXRoaXMuc2l6ZSgpKXRocm93IG5ldyBrO3JldHVybiB0aGlzLmFbYV19O3MucHJvdG90eXBlLmdldD1zLnByb3RvdHlwZS5nZXQ7cy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07cy5wcm90b3R5cGUuaXNFbXB0eT1zLnByb3RvdHlwZS5nO3MucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07cy5wcm90b3R5cGUuc2l6ZT1zLnByb3RvdHlwZS5zaXplO3MucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtzLnByb3RvdHlwZS50b0FycmF5PXMucHJvdG90eXBlLmg7XG5zLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPSExLGM9MCxkPXRoaXMuYS5sZW5ndGg7YzxkO2MrKylpZih0aGlzLmFbY109PT1hKXt0aGlzLmEuc3BsaWNlKGMsMSk7Yj0hMDticmVha31yZXR1cm4gYn07cy5wcm90b3R5cGUucmVtb3ZlPXMucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiB1KGEpe3RoaXMuaj1hfWYoXCIkanNjb21wLnNjb3BlLkl0ZXJhdG9yX1wiLHUpO3UucHJvdG90eXBlLmo9bnVsbDt1LnByb3RvdHlwZS5iPTA7dS5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKHRoaXMuYj09PXRoaXMuai5zaXplKCkpdGhyb3cgbmV3IHE7cmV0dXJuIHRoaXMuai5nZXQodGhpcy5iKyspfTt1LnByb3RvdHlwZS5uZXh0PXUucHJvdG90eXBlLm5leHQ7dS5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5qLnNpemUoKT8hMDohMX07dS5wcm90b3R5cGUuaGFzTmV4dD11LnByb3RvdHlwZS5jO1xudS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt1LnByb3RvdHlwZS5yZW1vdmU9dS5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIHYoKXt9ZihcImphdmFzY3JpcHQudXRpbC5BcnJheXNcIix2KTtcbnYuc29ydD1mdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50c1swXSxiLGMsZDtpZigxPT09YXJndW1lbnRzLmxlbmd0aClhLnNvcnQoKTtlbHNlIGlmKDI9PT1hcmd1bWVudHMubGVuZ3RoKWM9YXJndW1lbnRzWzFdLGQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYy5jb21wYXJlKGEsYil9LGEuc29ydChkKTtlbHNlIGlmKDM9PT1hcmd1bWVudHMubGVuZ3RoKWZvcihiPWEuc2xpY2UoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSksYi5zb3J0KCksZD1hLnNsaWNlKDAsYXJndW1lbnRzWzFdKS5jb25jYXQoYixhLnNsaWNlKGFyZ3VtZW50c1syXSxhLmxlbmd0aCkpLGEuc3BsaWNlKDAsYS5sZW5ndGgpLGI9MDtiPGQubGVuZ3RoO2IrKylhLnB1c2goZFtiXSk7ZWxzZSBpZig0PT09YXJndW1lbnRzLmxlbmd0aClmb3IoYj1hLnNsaWNlKGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pLGM9YXJndW1lbnRzWzNdLGQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYy5jb21wYXJlKGEsYil9LGIuc29ydChkKSxcbmQ9YS5zbGljZSgwLGFyZ3VtZW50c1sxXSkuY29uY2F0KGIsYS5zbGljZShhcmd1bWVudHNbMl0sYS5sZW5ndGgpKSxhLnNwbGljZSgwLGEubGVuZ3RoKSxiPTA7YjxkLmxlbmd0aDtiKyspYS5wdXNoKGRbYl0pfTt2LmFzTGlzdD1mdW5jdGlvbihhKXtmb3IodmFyIGI9bmV3IHMsYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKyliLmFkZChhW2NdKTtyZXR1cm4gYn07ZnVuY3Rpb24gdygpe3RoaXMuaT17fX1nKHcscCk7ZihcImphdmFzY3JpcHQudXRpbC5IYXNoTWFwXCIsdyk7dy5wcm90b3R5cGUuaT1udWxsO3cucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5pW2FdfHxudWxsfTt3LnByb3RvdHlwZS5nZXQ9dy5wcm90b3R5cGUuZ2V0O3cucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmlbYV09Yn07dy5wcm90b3R5cGUucHV0PXcucHJvdG90eXBlLnB1dDt3LnByb3RvdHlwZS5tPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IHMsYjtmb3IoYiBpbiB0aGlzLmkpdGhpcy5pLmhhc093blByb3BlcnR5KGIpJiZhLmFkZCh0aGlzLmlbYl0pO3JldHVybiBhfTt3LnByb3RvdHlwZS52YWx1ZXM9dy5wcm90b3R5cGUubTt3LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubSgpLnNpemUoKX07dy5wcm90b3R5cGUuc2l6ZT13LnByb3RvdHlwZS5zaXplO2Z1bmN0aW9uIHgoKXt9Zyh4LG0pO2YoXCJqYXZhc2NyaXB0LnV0aWwuU2V0XCIseCk7ZnVuY3Rpb24geShhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKHkseCk7ZihcImphdmFzY3JpcHQudXRpbC5IYXNoU2V0XCIseSk7eS5wcm90b3R5cGUuYT1udWxsO3kucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWlmKHRoaXMuYVtiXT09PWEpcmV0dXJuITA7cmV0dXJuITF9O3kucHJvdG90eXBlLmNvbnRhaW5zPXkucHJvdG90eXBlLmNvbnRhaW5zO3kucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXtpZih0aGlzLmNvbnRhaW5zKGEpKXJldHVybiExO3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTt5LnByb3RvdHlwZS5hZGQ9eS5wcm90b3R5cGUuYWRkO3kucHJvdG90eXBlLmU9ZnVuY3Rpb24oYSl7Zm9yKGE9YS5mKCk7YS5jKCk7KXRoaXMuYWRkKGEubmV4dCgpKTtyZXR1cm4hMH07eS5wcm90b3R5cGUuYWRkQWxsPXkucHJvdG90eXBlLmU7XG55LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3kucHJvdG90eXBlLnJlbW92ZT15LnByb3RvdHlwZS5yZW1vdmU7eS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTt5LnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTt5LnByb3RvdHlwZS5pc0VtcHR5PXkucHJvdG90eXBlLmc7eS5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O3kucHJvdG90eXBlLnRvQXJyYXk9eS5wcm90b3R5cGUuaDt5LnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB6KHRoaXMpfTt5LnByb3RvdHlwZS5pdGVyYXRvcj15LnByb3RvdHlwZS5mO2Z1bmN0aW9uIHooYSl7dGhpcy5rPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfJDFcIix6KTt6LnByb3RvdHlwZS5rPW51bGw7XG56LnByb3RvdHlwZS5iPTA7ei5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKHRoaXMuYj09PXRoaXMuay5zaXplKCkpdGhyb3cgbmV3IHE7cmV0dXJuIHRoaXMuay5hW3RoaXMuYisrXX07ei5wcm90b3R5cGUubmV4dD16LnByb3RvdHlwZS5uZXh0O3oucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMuay5zaXplKCk/ITA6ITF9O3oucHJvdG90eXBlLmhhc05leHQ9ei5wcm90b3R5cGUuYzt6LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3oucHJvdG90eXBlLnJlbW92ZT16LnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gQSgpe31nKEEscCk7ZihcImphdmFzY3JpcHQudXRpbC5Tb3J0ZWRNYXBcIixBKTtmdW5jdGlvbiBCKCl7fWcoQix4KTtmKFwiamF2YXNjcmlwdC51dGlsLlNvcnRlZFNldFwiLEIpO2Z1bmN0aW9uIEMoKXt0aGlzLmE9W119ZyhDLG4pO2YoXCJqYXZhc2NyaXB0LnV0aWwuU3RhY2tcIixDKTtDLnByb3RvdHlwZS5hPW51bGw7Qy5wcm90b3R5cGUucHVzaD1mdW5jdGlvbihhKXt0aGlzLmEucHVzaChhKTtyZXR1cm4gYX07Qy5wcm90b3R5cGUucHVzaD1DLnByb3RvdHlwZS5wdXNoO0MucHJvdG90eXBlLnBvcD1mdW5jdGlvbigpe2lmKDA9PT10aGlzLmEubGVuZ3RoKXRocm93IG5ldyBoO3JldHVybiB0aGlzLmEucG9wKCl9O0MucHJvdG90eXBlLnBvcD1DLnByb3RvdHlwZS5wb3A7Qy5wcm90b3R5cGUubz1mdW5jdGlvbigpe2lmKDA9PT10aGlzLmEubGVuZ3RoKXRocm93IG5ldyBoO3JldHVybiB0aGlzLmFbdGhpcy5hLmxlbmd0aC0xXX07Qy5wcm90b3R5cGUucGVlaz1DLnByb3RvdHlwZS5vO0MucHJvdG90eXBlLmVtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RoPyEwOiExfTtDLnByb3RvdHlwZS5lbXB0eT1DLnByb3RvdHlwZS5lbXB0eTtcbkMucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbXB0eSgpfTtDLnByb3RvdHlwZS5pc0VtcHR5PUMucHJvdG90eXBlLmc7Qy5wcm90b3R5cGUuc2VhcmNoPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmEuaW5kZXhPZihhKX07Qy5wcm90b3R5cGUuc2VhcmNoPUMucHJvdG90eXBlLnNlYXJjaDtDLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O0MucHJvdG90eXBlLnNpemU9Qy5wcm90b3R5cGUuc2l6ZTtDLnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07Qy5wcm90b3R5cGUudG9BcnJheT1DLnByb3RvdHlwZS5oO2Z1bmN0aW9uIEQoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLnBhcmVudH1mdW5jdGlvbiBFKGEsYil7bnVsbCE9PWEmJihhLmNvbG9yPWIpfWZ1bmN0aW9uIEYoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLmxlZnR9ZnVuY3Rpb24gRyhhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEucmlnaHR9ZnVuY3Rpb24gSCgpe3RoaXMuZD1udWxsO3RoaXMubj0wfWcoSCxBKTtmKFwiamF2YXNjcmlwdC51dGlsLlRyZWVNYXBcIixIKTtILnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuZDtudWxsIT09Yjspe3ZhciBjPWEuY29tcGFyZVRvKGIua2V5KTtpZigwPmMpYj1iLmxlZnQ7ZWxzZSBpZigwPGMpYj1iLnJpZ2h0O2Vsc2UgcmV0dXJuIGIudmFsdWV9cmV0dXJuIG51bGx9O0gucHJvdG90eXBlLmdldD1ILnByb3RvdHlwZS5nZXQ7XG5ILnByb3RvdHlwZS5wdXQ9ZnVuY3Rpb24oYSxiKXtpZihudWxsPT09dGhpcy5kKXJldHVybiB0aGlzLmQ9e2tleTphLHZhbHVlOmIsbGVmdDpudWxsLHJpZ2h0Om51bGwscGFyZW50Om51bGwsY29sb3I6MH0sdGhpcy5uPTEsbnVsbDt2YXIgYz10aGlzLmQsZCx0O2RvIGlmKGQ9Yyx0PWEuY29tcGFyZVRvKGMua2V5KSwwPnQpYz1jLmxlZnQ7ZWxzZSBpZigwPHQpYz1jLnJpZ2h0O2Vsc2UgcmV0dXJuIGQ9Yy52YWx1ZSxjLnZhbHVlPWIsZDt3aGlsZShudWxsIT09Yyk7Yz17a2V5OmEsbGVmdDpudWxsLHJpZ2h0Om51bGwsdmFsdWU6YixwYXJlbnQ6ZCxjb2xvcjowfTswPnQ/ZC5sZWZ0PWM6ZC5yaWdodD1jO2ZvcihjLmNvbG9yPTE7bnVsbCE9YyYmYyE9dGhpcy5kJiYxPT1jLnBhcmVudC5jb2xvcjspRChjKT09RihEKEQoYykpKT8oZD1HKEQoRChjKSkpLDE9PShudWxsPT1kPzA6ZC5jb2xvcik/KEUoRChjKSwwKSxFKGQsMCksRShEKEQoYykpLDEpLGM9RChEKGMpKSk6KGM9PUcoRChjKSkmJlxuKGM9RChjKSxJKHRoaXMsYykpLEUoRChjKSwwKSxFKEQoRChjKSksMSksSih0aGlzLEQoRChjKSkpKSk6KGQ9RihEKEQoYykpKSwxPT0obnVsbD09ZD8wOmQuY29sb3IpPyhFKEQoYyksMCksRShkLDApLEUoRChEKGMpKSwxKSxjPUQoRChjKSkpOihjPT1GKEQoYykpJiYoYz1EKGMpLEoodGhpcyxjKSksRShEKGMpLDApLEUoRChEKGMpKSwxKSxJKHRoaXMsRChEKGMpKSkpKTt0aGlzLmQuY29sb3I9MDt0aGlzLm4rKztyZXR1cm4gbnVsbH07SC5wcm90b3R5cGUucHV0PUgucHJvdG90eXBlLnB1dDtILnByb3RvdHlwZS5tPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IHMsYjtiPXRoaXMuZDtpZihudWxsIT1iKWZvcig7bnVsbCE9Yi5sZWZ0OyliPWIubGVmdDtpZihudWxsIT09Yilmb3IoYS5hZGQoYi52YWx1ZSk7bnVsbCE9PShiPUsoYikpOylhLmFkZChiLnZhbHVlKTtyZXR1cm4gYX07SC5wcm90b3R5cGUudmFsdWVzPUgucHJvdG90eXBlLm07XG5mdW5jdGlvbiBJKGEsYil7aWYobnVsbCE9Yil7dmFyIGM9Yi5yaWdodDtiLnJpZ2h0PWMubGVmdDtudWxsIT1jLmxlZnQmJihjLmxlZnQucGFyZW50PWIpO2MucGFyZW50PWIucGFyZW50O251bGw9PWIucGFyZW50P2EuZD1jOmIucGFyZW50LmxlZnQ9PWI/Yi5wYXJlbnQubGVmdD1jOmIucGFyZW50LnJpZ2h0PWM7Yy5sZWZ0PWI7Yi5wYXJlbnQ9Y319ZnVuY3Rpb24gSihhLGIpe2lmKG51bGwhPWIpe3ZhciBjPWIubGVmdDtiLmxlZnQ9Yy5yaWdodDtudWxsIT1jLnJpZ2h0JiYoYy5yaWdodC5wYXJlbnQ9Yik7Yy5wYXJlbnQ9Yi5wYXJlbnQ7bnVsbD09Yi5wYXJlbnQ/YS5kPWM6Yi5wYXJlbnQucmlnaHQ9PWI/Yi5wYXJlbnQucmlnaHQ9YzpiLnBhcmVudC5sZWZ0PWM7Yy5yaWdodD1iO2IucGFyZW50PWN9fVxuZnVuY3Rpb24gSyhhKXtpZihudWxsPT09YSlyZXR1cm4gbnVsbDtpZihudWxsIT09YS5yaWdodClmb3IodmFyIGI9YS5yaWdodDtudWxsIT09Yi5sZWZ0OyliPWIubGVmdDtlbHNlIGZvcihiPWEucGFyZW50O251bGwhPT1iJiZhPT09Yi5yaWdodDspYT1iLGI9Yi5wYXJlbnQ7cmV0dXJuIGJ9SC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm59O0gucHJvdG90eXBlLnNpemU9SC5wcm90b3R5cGUuc2l6ZTtmdW5jdGlvbiBMKGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcoTCxCKTtmKFwiamF2YXNjcmlwdC51dGlsLlRyZWVTZXRcIixMKTtMLnByb3RvdHlwZS5hPW51bGw7TC5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYoMD09PXRoaXMuYVtiXS5jb21wYXJlVG8oYSkpcmV0dXJuITA7cmV0dXJuITF9O0wucHJvdG90eXBlLmNvbnRhaW5zPUwucHJvdG90eXBlLmNvbnRhaW5zO0wucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXtpZih0aGlzLmNvbnRhaW5zKGEpKXJldHVybiExO2Zvcih2YXIgYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWlmKDE9PT10aGlzLmFbYl0uY29tcGFyZVRvKGEpKXJldHVybiB0aGlzLmEuc3BsaWNlKGIsMCxhKSwhMDt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07TC5wcm90b3R5cGUuYWRkPUwucHJvdG90eXBlLmFkZDtcbkwucHJvdG90eXBlLmU9ZnVuY3Rpb24oYSl7Zm9yKGE9YS5mKCk7YS5jKCk7KXRoaXMuYWRkKGEubmV4dCgpKTtyZXR1cm4hMH07TC5wcm90b3R5cGUuYWRkQWxsPUwucHJvdG90eXBlLmU7TC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTtMLnByb3RvdHlwZS5yZW1vdmU9TC5wcm90b3R5cGUucmVtb3ZlO0wucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07TC5wcm90b3R5cGUuc2l6ZT1MLnByb3RvdHlwZS5zaXplO0wucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O0wucHJvdG90eXBlLmlzRW1wdHk9TC5wcm90b3R5cGUuZztMLnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07TC5wcm90b3R5cGUudG9BcnJheT1MLnByb3RvdHlwZS5oO0wucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IE4odGhpcyl9O1xuTC5wcm90b3R5cGUuaXRlcmF0b3I9TC5wcm90b3R5cGUuZjtmdW5jdGlvbiBOKGEpe3RoaXMubD1hfWYoXCIkanNjb21wLnNjb3BlLkl0ZXJhdG9yXyQyXCIsTik7Ti5wcm90b3R5cGUubD1udWxsO04ucHJvdG90eXBlLmI9MDtOLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5sLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5sLmFbdGhpcy5iKytdfTtOLnByb3RvdHlwZS5uZXh0PU4ucHJvdG90eXBlLm5leHQ7Ti5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5sLnNpemUoKT8hMDohMX07Ti5wcm90b3R5cGUuaGFzTmV4dD1OLnByb3RvdHlwZS5jO04ucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307Ti5wcm90b3R5cGUucmVtb3ZlPU4ucHJvdG90eXBlLnJlbW92ZTtcInVuZGVmaW5lZFwiIT09dHlwZW9mIGdsb2JhbCYmKGdsb2JhbC5qYXZhc2NyaXB0PXt9LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWw9e30sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q9cyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkFycmF5cz12LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQ29sbGVjdGlvbj1tLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuRW1wdHlTdGFja0V4Y2VwdGlvbj1oLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSGFzaE1hcD13LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSGFzaFNldD15LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbj1rLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuSXRlcmF0b3I9bCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkxpc3Q9bixnbG9iYWwuamF2YXNjcmlwdC51dGlsLk1hcD1wLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTm9TdWNoRWxlbWVudEV4Y2VwdGlvbj1xLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuT3BlcmF0aW9uTm90U3VwcG9ydGVkPVxucixnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNldD14LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU29ydGVkTWFwPUEsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Tb3J0ZWRTZXQ9QixnbG9iYWwuamF2YXNjcmlwdC51dGlsLlN0YWNrPUMsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5UcmVlTWFwPUgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5UcmVlU2V0PUwpO30pLmNhbGwodGhpcyk7XG4iLCJ2YXIgc3MgPSByZXF1aXJlKCdzaW1wbGUtc3RhdGlzdGljcycpO1xudmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0aGUgdmFyaWFuY2UgdmFsdWUgb2YgYSBmaWVsZCBmb3Ige0BsaW5rIFBvaW50fSBmZWF0dXJlcyB3aXRoaW4gYSBzZXQgb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi92YXJpYW5jZVxuICogQGNhdGVnb3J5IGFnZ3JlZ2F0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtzdHJpbmd9IGluRmllbGQgdGhlIGZpZWxkIGluIGlucHV0IGRhdGEgdG8gYW5hbHl6ZVxuICogQHBhcmFtIHtzdHJpbmd9IG91dEZpZWxkIHRoZSBmaWVsZCBpbiB3aGljaCB0byBzdG9yZSByZXN1bHRzXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIHdpdGggcHJvcGVydGllcyBsaXN0ZWQgYXMgYG91dEZpZWxkYFxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstOTcuNDE0Mzk4LCAzNy42ODQwOTJdLFxuICogICAgICAgICAgIFstOTcuNDE0Mzk4LCAzNy43MzEzNTNdLFxuICogICAgICAgICAgIFstOTcuMzMyMzQ0LCAzNy43MzEzNTNdLFxuICogICAgICAgICAgIFstOTcuMzMyMzQ0LCAzNy42ODQwOTJdLFxuICogICAgICAgICAgIFstOTcuNDE0Mzk4LCAzNy42ODQwOTJdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstOTcuMzMzNzE3LCAzNy42MDYwNzJdLFxuICogICAgICAgICAgIFstOTcuMzMzNzE3LCAzNy42NzUzOTddLFxuICogICAgICAgICAgIFstOTcuMjM3NTg2LCAzNy42NzUzOTddLFxuICogICAgICAgICAgIFstOTcuMjM3NTg2LCAzNy42MDYwNzJdLFxuICogICAgICAgICAgIFstOTcuMzMzNzE3LCAzNy42MDYwNzJdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNDAxMzUxLCAzNy43MTk2NzZdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDYwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuMzU1MzQ2LCAzNy43MDY2MzldXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDEwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuMzg3OTYyLCAzNy43MDAxMl1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny4zMDE3ODgsIDM3LjY2NTA3XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAzMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjI2NTA1MiwgMzcuNjQzMzI1XVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgYWdncmVnYXRlZCA9IHR1cmYudmFyaWFuY2UoXG4gKiAgIHBvbHlnb25zLCBwb2ludHMsICdwb3B1bGF0aW9uJywgJ3ZhcmlhbmNlJyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChcbiAqICAgYWdncmVnYXRlZC5mZWF0dXJlcyk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChwb2x5RkMsIHB0RkMsIGluRmllbGQsIG91dEZpZWxkKSB7XG4gIHBvbHlGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHBvbHkpe1xuICAgIGlmKCFwb2x5LnByb3BlcnRpZXMpe1xuICAgICAgcG9seS5wcm9wZXJ0aWVzID0ge307XG4gICAgfVxuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICBwdEZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocHQpe1xuICAgICAgaWYgKGluc2lkZShwdCwgcG9seSkpIHtcbiAgICAgICAgdmFsdWVzLnB1c2gocHQucHJvcGVydGllc1tpbkZpZWxkXSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcG9seS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IHNzLnZhcmlhbmNlKHZhbHVlcyk7XG4gIH0pO1xuXG4gIHJldHVybiBwb2x5RkM7XG59O1xuIiwidmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG52YXIgZmVhdHVyZUNvbGxlY3Rpb24gPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYW5kIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGFuZCByZXR1cm5zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgUG9pbnQgZmVhdHVyZXMgcmVwcmVzZW50aW5nIGFsbCBwb2ludHMgdGhhdCBmYWxsIHdpdGhpbiBhIGNvbGxlY3Rpb24gb2YgcG9seWdvbnMuXG4gKlxuICogQG1vZHVsZSB0dXJmL3dpdGhpblxuICogQGNhdGVnb3J5IGpvaW5zXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgY29sbGVjdGlvbiBvZiBhbGwgcG9pbnRzIHRoYXQgbGFuZFxuICogd2l0aGluIGF0IGxlYXN0IG9uZSBwb2x5Z29uXG4gKiBAZXhhbXBsZVxuICogdmFyIHNlYXJjaFdpdGhpbiA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstNDYuNjUzLC0yMy41NDNdLFxuICogICAgICAgICAgIFstNDYuNjM0LC0yMy41MzQ2XSxcbiAqICAgICAgICAgICBbLTQ2LjYxMywtMjMuNTQzXSxcbiAqICAgICAgICAgICBbLTQ2LjYxNCwtMjMuNTU5XSxcbiAqICAgICAgICAgICBbLTQ2LjYzMSwtMjMuNTY3XSxcbiAqICAgICAgICAgICBbLTQ2LjY1MywtMjMuNTYwXSxcbiAqICAgICAgICAgICBbLTQ2LjY1MywtMjMuNTQzXVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNDYuNjMxOCwgLTIzLjU1MjNdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42MjQ2LCAtMjMuNTMyNV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTQ2LjYwNjIsIC0yMy41NTEzXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNDYuNjYzLCAtMjMuNTU0XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNDYuNjQzLCAtMjMuNTU3XVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgcHRzV2l0aGluID0gdHVyZi53aXRoaW4ocG9pbnRzLCBzZWFyY2hXaXRoaW4pO1xuICpcbiAqIC8vPXBvaW50c1xuICpcbiAqIC8vPXNlYXJjaFdpdGhpblxuICpcbiAqIC8vPXB0c1dpdGhpblxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHB0RkMsIHBvbHlGQyl7XG4gIHZhciBwb2ludHNXaXRoaW4gPSBmZWF0dXJlQ29sbGVjdGlvbihbXSk7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcG9seUZDLmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBwdEZDLmZlYXR1cmVzLmxlbmd0aDsgaisrKSB7XG4gICAgICB2YXIgaXNJbnNpZGUgPSBpbnNpZGUocHRGQy5mZWF0dXJlc1tqXSwgcG9seUZDLmZlYXR1cmVzW2ldKTtcbiAgICAgIGlmKGlzSW5zaWRlKXtcbiAgICAgICAgcG9pbnRzV2l0aGluLmZlYXR1cmVzLnB1c2gocHRGQy5mZWF0dXJlc1tqXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBwb2ludHNXaXRoaW47XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgd2luZG93ID0gcmVxdWlyZShcImdsb2JhbC93aW5kb3dcIilcbnZhciBvbmNlID0gcmVxdWlyZShcIm9uY2VcIilcbnZhciBwYXJzZUhlYWRlcnMgPSByZXF1aXJlKFwicGFyc2UtaGVhZGVyc1wiKVxuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVYSFJcbmNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCA9IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCB8fCBub29wXG5jcmVhdGVYSFIuWERvbWFpblJlcXVlc3QgPSBcIndpdGhDcmVkZW50aWFsc1wiIGluIChuZXcgY3JlYXRlWEhSLlhNTEh0dHBSZXF1ZXN0KCkpID8gY3JlYXRlWEhSLlhNTEh0dHBSZXF1ZXN0IDogd2luZG93LlhEb21haW5SZXF1ZXN0XG5cblxuZnVuY3Rpb24gaXNFbXB0eShvYmope1xuICAgIGZvcih2YXIgaSBpbiBvYmope1xuICAgICAgICBpZihvYmouaGFzT3duUHJvcGVydHkoaSkpIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxufVxuXG5mdW5jdGlvbiBjcmVhdGVYSFIob3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICBmdW5jdGlvbiByZWFkeXN0YXRlY2hhbmdlKCkge1xuICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcbiAgICAgICAgICAgIGxvYWRGdW5jKClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEJvZHkoKSB7XG4gICAgICAgIC8vIENocm9tZSB3aXRoIHJlcXVlc3RUeXBlPWJsb2IgdGhyb3dzIGVycm9ycyBhcnJvdW5kIHdoZW4gZXZlbiB0ZXN0aW5nIGFjY2VzcyB0byByZXNwb25zZVRleHRcbiAgICAgICAgdmFyIGJvZHkgPSB1bmRlZmluZWRcblxuICAgICAgICBpZiAoeGhyLnJlc3BvbnNlKSB7XG4gICAgICAgICAgICBib2R5ID0geGhyLnJlc3BvbnNlXG4gICAgICAgIH0gZWxzZSBpZiAoeGhyLnJlc3BvbnNlVHlwZSA9PT0gXCJ0ZXh0XCIgfHwgIXhoci5yZXNwb25zZVR5cGUpIHtcbiAgICAgICAgICAgIGJvZHkgPSB4aHIucmVzcG9uc2VUZXh0IHx8IHhoci5yZXNwb25zZVhNTFxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzSnNvbikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBib2R5ID0gSlNPTi5wYXJzZShib2R5KVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBib2R5XG4gICAgfVxuXG4gICAgdmFyIGZhaWx1cmVSZXNwb25zZSA9IHtcbiAgICAgICAgICAgICAgICBib2R5OiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge30sXG4gICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogMCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICB1cmw6IHVyaSxcbiAgICAgICAgICAgICAgICByYXdSZXF1ZXN0OiB4aHJcbiAgICAgICAgICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yRnVuYyhldnQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRUaW1lcilcbiAgICAgICAgaWYoIShldnQgaW5zdGFuY2VvZiBFcnJvcikpe1xuICAgICAgICAgICAgZXZ0ID0gbmV3IEVycm9yKFwiXCIgKyAoZXZ0IHx8IFwiVW5rbm93biBYTUxIdHRwUmVxdWVzdCBFcnJvclwiKSApXG4gICAgICAgIH1cbiAgICAgICAgZXZ0LnN0YXR1c0NvZGUgPSAwXG4gICAgICAgIGNhbGxiYWNrKGV2dCwgZmFpbHVyZVJlc3BvbnNlKVxuICAgIH1cblxuICAgIC8vIHdpbGwgbG9hZCB0aGUgZGF0YSAmIHByb2Nlc3MgdGhlIHJlc3BvbnNlIGluIGEgc3BlY2lhbCByZXNwb25zZSBvYmplY3RcbiAgICBmdW5jdGlvbiBsb2FkRnVuYygpIHtcbiAgICAgICAgaWYgKGFib3J0ZWQpIHJldHVyblxuICAgICAgICB2YXIgc3RhdHVzXG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0VGltZXIpXG4gICAgICAgIGlmKG9wdGlvbnMudXNlWERSICYmIHhoci5zdGF0dXM9PT11bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vSUU4IENPUlMgR0VUIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgZG9lc24ndCBoYXZlIGEgc3RhdHVzIGZpZWxkLCBidXQgYm9keSBpcyBmaW5lXG4gICAgICAgICAgICBzdGF0dXMgPSAyMDBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0YXR1cyA9ICh4aHIuc3RhdHVzID09PSAxMjIzID8gMjA0IDogeGhyLnN0YXR1cylcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzcG9uc2UgPSBmYWlsdXJlUmVzcG9uc2VcbiAgICAgICAgdmFyIGVyciA9IG51bGxcblxuICAgICAgICBpZiAoc3RhdHVzICE9PSAwKXtcbiAgICAgICAgICAgIHJlc3BvbnNlID0ge1xuICAgICAgICAgICAgICAgIGJvZHk6IGdldEJvZHkoKSxcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXMsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge30sXG4gICAgICAgICAgICAgICAgdXJsOiB1cmksXG4gICAgICAgICAgICAgICAgcmF3UmVxdWVzdDogeGhyXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKXsgLy9yZW1lbWJlciB4aHIgY2FuIGluIGZhY3QgYmUgWERSIGZvciBDT1JTIGluIElFXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuaGVhZGVycyA9IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnIgPSBuZXcgRXJyb3IoXCJJbnRlcm5hbCBYTUxIdHRwUmVxdWVzdCBFcnJvclwiKVxuICAgICAgICB9XG4gICAgICAgIGNhbGxiYWNrKGVyciwgcmVzcG9uc2UsIHJlc3BvbnNlLmJvZHkpXG5cbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgb3B0aW9ucyA9IHsgdXJpOiBvcHRpb25zIH1cbiAgICB9XG5cbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICAgIGlmKHR5cGVvZiBjYWxsYmFjayA9PT0gXCJ1bmRlZmluZWRcIil7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbGxiYWNrIGFyZ3VtZW50IG1pc3NpbmdcIilcbiAgICB9XG4gICAgY2FsbGJhY2sgPSBvbmNlKGNhbGxiYWNrKVxuXG4gICAgdmFyIHhociA9IG9wdGlvbnMueGhyIHx8IG51bGxcblxuICAgIGlmICgheGhyKSB7XG4gICAgICAgIGlmIChvcHRpb25zLmNvcnMgfHwgb3B0aW9ucy51c2VYRFIpIHtcbiAgICAgICAgICAgIHhociA9IG5ldyBjcmVhdGVYSFIuWERvbWFpblJlcXVlc3QoKVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHhociA9IG5ldyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGtleVxuICAgIHZhciBhYm9ydGVkXG4gICAgdmFyIHVyaSA9IHhoci51cmwgPSBvcHRpb25zLnVyaSB8fCBvcHRpb25zLnVybFxuICAgIHZhciBtZXRob2QgPSB4aHIubWV0aG9kID0gb3B0aW9ucy5tZXRob2QgfHwgXCJHRVRcIlxuICAgIHZhciBib2R5ID0gb3B0aW9ucy5ib2R5IHx8IG9wdGlvbnMuZGF0YVxuICAgIHZhciBoZWFkZXJzID0geGhyLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnMgfHwge31cbiAgICB2YXIgc3luYyA9ICEhb3B0aW9ucy5zeW5jXG4gICAgdmFyIGlzSnNvbiA9IGZhbHNlXG4gICAgdmFyIHRpbWVvdXRUaW1lclxuXG4gICAgaWYgKFwianNvblwiIGluIG9wdGlvbnMpIHtcbiAgICAgICAgaXNKc29uID0gdHJ1ZVxuICAgICAgICBoZWFkZXJzW1wiYWNjZXB0XCJdIHx8IGhlYWRlcnNbXCJBY2NlcHRcIl0gfHwgKGhlYWRlcnNbXCJBY2NlcHRcIl0gPSBcImFwcGxpY2F0aW9uL2pzb25cIikgLy9Eb24ndCBvdmVycmlkZSBleGlzdGluZyBhY2NlcHQgaGVhZGVyIGRlY2xhcmVkIGJ5IHVzZXJcbiAgICAgICAgaWYgKG1ldGhvZCAhPT0gXCJHRVRcIiAmJiBtZXRob2QgIT09IFwiSEVBRFwiKSB7XG4gICAgICAgICAgICBoZWFkZXJzW1wiY29udGVudC10eXBlXCJdIHx8IGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl0gfHwgKGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl0gPSBcImFwcGxpY2F0aW9uL2pzb25cIikgLy9Eb24ndCBvdmVycmlkZSBleGlzdGluZyBhY2NlcHQgaGVhZGVyIGRlY2xhcmVkIGJ5IHVzZXJcbiAgICAgICAgICAgIGJvZHkgPSBKU09OLnN0cmluZ2lmeShvcHRpb25zLmpzb24pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gcmVhZHlzdGF0ZWNoYW5nZVxuICAgIHhoci5vbmxvYWQgPSBsb2FkRnVuY1xuICAgIHhoci5vbmVycm9yID0gZXJyb3JGdW5jXG4gICAgLy8gSUU5IG11c3QgaGF2ZSBvbnByb2dyZXNzIGJlIHNldCB0byBhIHVuaXF1ZSBmdW5jdGlvbi5cbiAgICB4aHIub25wcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSUUgbXVzdCBkaWVcbiAgICB9XG4gICAgeGhyLm9udGltZW91dCA9IGVycm9yRnVuY1xuICAgIHhoci5vcGVuKG1ldGhvZCwgdXJpLCAhc3luYywgb3B0aW9ucy51c2VybmFtZSwgb3B0aW9ucy5wYXNzd29yZClcbiAgICAvL2hhcyB0byBiZSBhZnRlciBvcGVuXG4gICAgaWYoIXN5bmMpIHtcbiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9ICEhb3B0aW9ucy53aXRoQ3JlZGVudGlhbHNcbiAgICB9XG4gICAgLy8gQ2Fubm90IHNldCB0aW1lb3V0IHdpdGggc3luYyByZXF1ZXN0XG4gICAgLy8gbm90IHNldHRpbmcgdGltZW91dCBvbiB0aGUgeGhyIG9iamVjdCwgYmVjYXVzZSBvZiBvbGQgd2Via2l0cyBldGMuIG5vdCBoYW5kbGluZyB0aGF0IGNvcnJlY3RseVxuICAgIC8vIGJvdGggbnBtJ3MgcmVxdWVzdCBhbmQganF1ZXJ5IDEueCB1c2UgdGhpcyBraW5kIG9mIHRpbWVvdXQsIHNvIHRoaXMgaXMgYmVpbmcgY29uc2lzdGVudFxuICAgIGlmICghc3luYyAmJiBvcHRpb25zLnRpbWVvdXQgPiAwICkge1xuICAgICAgICB0aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBhYm9ydGVkPXRydWUvL0lFOSBtYXkgc3RpbGwgY2FsbCByZWFkeXN0YXRlY2hhbmdlXG4gICAgICAgICAgICB4aHIuYWJvcnQoXCJ0aW1lb3V0XCIpXG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBFcnJvcihcIlhNTEh0dHBSZXF1ZXN0IHRpbWVvdXRcIilcbiAgICAgICAgICAgIGUuY29kZSA9IFwiRVRJTUVET1VUXCJcbiAgICAgICAgICAgIGVycm9yRnVuYyhlKVxuICAgICAgICB9LCBvcHRpb25zLnRpbWVvdXQgKVxuICAgIH1cblxuICAgIGlmICh4aHIuc2V0UmVxdWVzdEhlYWRlcikge1xuICAgICAgICBmb3Ioa2V5IGluIGhlYWRlcnMpe1xuICAgICAgICAgICAgaWYoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKXtcbiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5oZWFkZXJzICYmICFpc0VtcHR5KG9wdGlvbnMuaGVhZGVycykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSGVhZGVycyBjYW5ub3QgYmUgc2V0IG9uIGFuIFhEb21haW5SZXF1ZXN0IG9iamVjdFwiKVxuICAgIH1cblxuICAgIGlmIChcInJlc3BvbnNlVHlwZVwiIGluIG9wdGlvbnMpIHtcbiAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IG9wdGlvbnMucmVzcG9uc2VUeXBlXG4gICAgfVxuXG4gICAgaWYgKFwiYmVmb3JlU2VuZFwiIGluIG9wdGlvbnMgJiZcbiAgICAgICAgdHlwZW9mIG9wdGlvbnMuYmVmb3JlU2VuZCA9PT0gXCJmdW5jdGlvblwiXG4gICAgKSB7XG4gICAgICAgIG9wdGlvbnMuYmVmb3JlU2VuZCh4aHIpXG4gICAgfVxuXG4gICAgeGhyLnNlbmQoYm9keSlcblxuICAgIHJldHVybiB4aHJcblxuXG59XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuIiwiaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHdpbmRvdztcbn0gZWxzZSBpZiAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsO1xufSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIil7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBzZWxmO1xufSBlbHNlIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHt9O1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBvbmNlXG5cbm9uY2UucHJvdG8gPSBvbmNlKGZ1bmN0aW9uICgpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZ1bmN0aW9uLnByb3RvdHlwZSwgJ29uY2UnLCB7XG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBvbmNlKHRoaXMpXG4gICAgfSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbiAgfSlcbn0pXG5cbmZ1bmN0aW9uIG9uY2UgKGZuKSB7XG4gIHZhciBjYWxsZWQgPSBmYWxzZVxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjYWxsZWQpIHJldHVyblxuICAgIGNhbGxlZCA9IHRydWVcbiAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICB9XG59XG4iLCJ2YXIgaXNGdW5jdGlvbiA9IHJlcXVpcmUoJ2lzLWZ1bmN0aW9uJylcblxubW9kdWxlLmV4cG9ydHMgPSBmb3JFYWNoXG5cbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdcbnZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHlcblxuZnVuY3Rpb24gZm9yRWFjaChsaXN0LCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGlmICghaXNGdW5jdGlvbihpdGVyYXRvcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaXRlcmF0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uJylcbiAgICB9XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgY29udGV4dCA9IHRoaXNcbiAgICB9XG4gICAgXG4gICAgaWYgKHRvU3RyaW5nLmNhbGwobGlzdCkgPT09ICdbb2JqZWN0IEFycmF5XScpXG4gICAgICAgIGZvckVhY2hBcnJheShsaXN0LCBpdGVyYXRvciwgY29udGV4dClcbiAgICBlbHNlIGlmICh0eXBlb2YgbGlzdCA9PT0gJ3N0cmluZycpXG4gICAgICAgIGZvckVhY2hTdHJpbmcobGlzdCwgaXRlcmF0b3IsIGNvbnRleHQpXG4gICAgZWxzZVxuICAgICAgICBmb3JFYWNoT2JqZWN0KGxpc3QsIGl0ZXJhdG9yLCBjb250ZXh0KVxufVxuXG5mdW5jdGlvbiBmb3JFYWNoQXJyYXkoYXJyYXksIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGFycmF5LCBpKSkge1xuICAgICAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBhcnJheVtpXSwgaSwgYXJyYXkpXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZvckVhY2hTdHJpbmcoc3RyaW5nLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBzdHJpbmcubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgLy8gbm8gc3VjaCB0aGluZyBhcyBhIHNwYXJzZSBzdHJpbmcuXG4gICAgICAgIGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgc3RyaW5nLmNoYXJBdChpKSwgaSwgc3RyaW5nKVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9yRWFjaE9iamVjdChvYmplY3QsIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgZm9yICh2YXIgayBpbiBvYmplY3QpIHtcbiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrKSkge1xuICAgICAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBvYmplY3Rba10sIGssIG9iamVjdClcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gaXNGdW5jdGlvblxuXG52YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nXG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24gKGZuKSB7XG4gIHZhciBzdHJpbmcgPSB0b1N0cmluZy5jYWxsKGZuKVxuICByZXR1cm4gc3RyaW5nID09PSAnW29iamVjdCBGdW5jdGlvbl0nIHx8XG4gICAgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyAmJiBzdHJpbmcgIT09ICdbb2JqZWN0IFJlZ0V4cF0nKSB8fFxuICAgICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAvLyBJRTggYW5kIGJlbG93XG4gICAgIChmbiA9PT0gd2luZG93LnNldFRpbWVvdXQgfHxcbiAgICAgIGZuID09PSB3aW5kb3cuYWxlcnQgfHxcbiAgICAgIGZuID09PSB3aW5kb3cuY29uZmlybSB8fFxuICAgICAgZm4gPT09IHdpbmRvdy5wcm9tcHQpKVxufTtcbiIsIlxuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gdHJpbTtcblxuZnVuY3Rpb24gdHJpbShzdHIpe1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMqfFxccyokL2csICcnKTtcbn1cblxuZXhwb3J0cy5sZWZ0ID0gZnVuY3Rpb24oc3RyKXtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKi8sICcnKTtcbn07XG5cbmV4cG9ydHMucmlnaHQgPSBmdW5jdGlvbihzdHIpe1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL1xccyokLywgJycpO1xufTtcbiIsInZhciB0cmltID0gcmVxdWlyZSgndHJpbScpXG4gICwgZm9yRWFjaCA9IHJlcXVpcmUoJ2Zvci1lYWNoJylcbiAgLCBpc0FycmF5ID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gICAgfVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChoZWFkZXJzKSB7XG4gIGlmICghaGVhZGVycylcbiAgICByZXR1cm4ge31cblxuICB2YXIgcmVzdWx0ID0ge31cblxuICBmb3JFYWNoKFxuICAgICAgdHJpbShoZWFkZXJzKS5zcGxpdCgnXFxuJylcbiAgICAsIGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gcm93LmluZGV4T2YoJzonKVxuICAgICAgICAgICwga2V5ID0gdHJpbShyb3cuc2xpY2UoMCwgaW5kZXgpKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgLCB2YWx1ZSA9IHRyaW0ocm93LnNsaWNlKGluZGV4ICsgMSkpXG5cbiAgICAgICAgaWYgKHR5cGVvZihyZXN1bHRba2V5XSkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZVxuICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkocmVzdWx0W2tleV0pKSB7XG4gICAgICAgICAgcmVzdWx0W2tleV0ucHVzaCh2YWx1ZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IFsgcmVzdWx0W2tleV0sIHZhbHVlIF1cbiAgICAgICAgfVxuICAgICAgfVxuICApXG5cbiAgcmV0dXJuIHJlc3VsdFxufSIsImNvbnN0IENPTE9SUyA9IHtcbiAgICAwOiAnI2Y1MWExYScsIC8vIHJlZCBzcXVhcmVcbiAgICAxOiAnI2EyMWFmZicsIC8vIGtyZW1saW4sXG4gICAgMjogJyNiMzRiMDAnLCAvLyBib3VsZXZhcmRcbiAgICAzOiAnIzE4ZGJmZicsIC8vIGdhcmRlbiByaW5nXG4gICAgNDogJyNmZjE1MTgnLCAvLyB0aGlyZCByaW5nXG4gICAgNTogJyM4OGZhNjAnICAvLyBNS0FEXG59XG5cbmV4cG9ydCBkZWZhdWx0IENPTE9SUztcbiIsImNvbnN0IEwgPSBnbG9iYWwuTCB8fCByZXF1aXJlKCdsZWFmbGV0Jyk7XG5cbmltcG9ydCB4aHIgZnJvbSAneGhyJztcbmltcG9ydCAqIGFzIFNwaW5uZXIgZnJvbSAnc3Bpbi5qcyc7XG5pbXBvcnQgKiBhcyBjb25maWcgZnJvbSAnLi4vY29uZmlnLmpzb24nO1xuaW1wb3J0ICogYXMgQ09MT1JTIGZyb20gJy4vY29sb3JzJztcbmltcG9ydCBsZWFmbGV0S25uIGZyb20gJ2xlYWZsZXQta25uJztcbmltcG9ydCB0dXJmIGZyb20gJ3R1cmYnO1xuaW1wb3J0ICdsZWFmbGV0LWhhc2gnO1xuXG5jb25zb2xlLmxvZyhsZWFmbGV0S25uKTtcblxuY29uc3QgTUFQX1NUWUxFID0gJ21hcGJveC5kYXJrJztcbmNvbnN0IExJTkVfV0lEVEggPSA0O1xuXG5sZXQgbWFwID0gZ2xvYmFsLm1hcCA9IEwubWFwKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYXAnKSk7XG5sZXQgaGFzaCA9IEwuaGFzaChtYXApO1xubGV0IGluZGV4LCBnaiwgZ2VvanNvbjtcblxubGV0IHRpbGVzID0gTC50aWxlTGF5ZXIoXG4gICdodHRwczovL2FwaS5tYXBib3guY29tL3Y0LycgK1xuICBNQVBfU1RZTEUgK1xuICAnL3t6fS97eH0ve3l9LnBuZz9hY2Nlc3NfdG9rZW49JyArXG4gIGNvbmZpZy5hcGlfdG9rZW4sIHtcbiAgICBhdHRyaWJ1dGlvbjogJ01hcGJveCAmY29weTsgT1NNIGNvbnRyaWJ1dG9ycydcbiAgfSkuYWRkVG8obWFwKTtcblxueGhyKHtcbiAgdXJsOiAnZGF0YS9kYXRhLmpzb24nXG59LCAoZXJyLCByZXEsIGRhdGEpID0+IHtcbiAgaWYgKCFlcnIpIHtcbiAgICBnZW9qc29uID0gZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgZ2ogPSBMLmdlb0pzb24oZGF0YSwge1xuICAgICAgc3R5bGU6IChmZWF0dXJlKSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29sb3I6IENPTE9SU1tmZWF0dXJlLnByb3BlcnRpZXMuaWRdLFxuICAgICAgICAgIHdlaWdodDogTElORV9XSURUSCAvIChmZWF0dXJlLnByb3BlcnRpZXMuaWQgKyAxKSxcbiAgICAgICAgICBmaWxsT3BhY2l0eTogMC4xLFxuICAgICAgICAgIGNsaWNrYWJsZTogZmFsc2VcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIGxldCBib3VuZHMgPSBnai5nZXRCb3VuZHMoKTtcbiAgICBtYXAuZml0Qm91bmRzKGJvdW5kcywge3BhZGRpbmc6IFsyMCwgMjBdfSk7XG4gICAgZ2ouYWRkVG8obWFwKTtcbiAgICBpbmRleCA9IGxlYWZsZXRLbm4oZ2opO1xuICB9XG59KTtcblxubGV0IG1hcmtlcjtcblxubWFwLm9uKCdjbGljaycsIChldnQpID0+IHtcbiAgaWYgKCFtYXJrZXIpIHtcbiAgICBtYXJrZXIgPSBMLm1hcmtlcihldnQubGF0bG5nKS5hZGRUbyhtYXApO1xuICB9IGVsc2Uge1xuICAgIG1hcmtlci5zZXRMYXRMbmcoZXZ0LmxhdGxuZyk7XG4gIH1cbiAgbGV0IG5lYXJlc3QgPSBpbmRleC5uZWFyZXN0KGV2dC5sYXRsbmcpO1xuICBjb25zb2xlLmxvZyhuZWFyZXN0KTtcbn0pO1xuXG5cbiJdfQ==
