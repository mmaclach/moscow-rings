(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports={
  "api_token": "pk.eyJ1IjoidzhyIiwiYSI6InBWVUZaSDAifQ.lQUJXO6rqqAiKRR6VW8TEg"
}

},{}],2:[function(require,module,exports){
module.exports = { "default": require("core-js/library/fn/object/define-property"), __esModule: true };
},{"core-js/library/fn/object/define-property":8}],3:[function(require,module,exports){
"use strict";

exports["default"] = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

exports.__esModule = true;
},{}],4:[function(require,module,exports){
"use strict";

var _Object$defineProperty = require("babel-runtime/core-js/object/define-property")["default"];

exports["default"] = (function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;

      _Object$defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
})();

exports.__esModule = true;
},{"babel-runtime/core-js/object/define-property":2}],5:[function(require,module,exports){
"use strict";

var _Object$defineProperty = require("babel-runtime/core-js/object/define-property")["default"];

exports["default"] = function (obj, key, value) {
  if (key in obj) {
    _Object$defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
};

exports.__esModule = true;
},{"babel-runtime/core-js/object/define-property":2}],6:[function(require,module,exports){
"use strict";

exports["default"] = function (obj) {
  return obj && obj.__esModule ? obj : {
    "default": obj
  };
};

exports.__esModule = true;
},{}],7:[function(require,module,exports){
"use strict";

exports["default"] = function (obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};

    if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
      }
    }

    newObj["default"] = obj;
    return newObj;
  }
};

exports.__esModule = true;
},{}],8:[function(require,module,exports){
var $ = require('../../modules/$');
module.exports = function defineProperty(it, key, desc){
  return $.setDesc(it, key, desc);
};
},{"../../modules/$":9}],9:[function(require,module,exports){
var $Object = Object;
module.exports = {
  create:     $Object.create,
  getProto:   $Object.getPrototypeOf,
  isEnum:     {}.propertyIsEnumerable,
  getDesc:    $Object.getOwnPropertyDescriptor,
  setDesc:    $Object.defineProperty,
  setDescs:   $Object.defineProperties,
  getKeys:    $Object.keys,
  getNames:   $Object.getOwnPropertyNames,
  getSymbols: $Object.getOwnPropertySymbols,
  each:       [].forEach
};
},{}],10:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('is-array')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50
Buffer.poolSize = 8192 // not used by this implementation

var rootParent = {}

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Safari 5-7 lacks support for changing the `Object.prototype.constructor` property
 *     on objects.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

function typedArraySupport () {
  function Bar () {}
  try {
    var arr = new Uint8Array(1)
    arr.foo = function () { return 42 }
    arr.constructor = Bar
    return arr.foo() === 42 && // typed array instances can be augmented
        arr.constructor === Bar && // constructor can be set
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

/**
 * Class: Buffer
 * =============
 *
 * The Buffer constructor returns instances of `Uint8Array` that are augmented
 * with function properties for all the node `Buffer` API functions. We use
 * `Uint8Array` so that square bracket notation works as expected -- it returns
 * a single octet.
 *
 * By augmenting the instances, we can avoid modifying the `Uint8Array`
 * prototype.
 */
function Buffer (arg) {
  if (!(this instanceof Buffer)) {
    // Avoid going through an ArgumentsAdaptorTrampoline in the common case.
    if (arguments.length > 1) return new Buffer(arg, arguments[1])
    return new Buffer(arg)
  }

  this.length = 0
  this.parent = undefined

  // Common case.
  if (typeof arg === 'number') {
    return fromNumber(this, arg)
  }

  // Slightly less common case.
  if (typeof arg === 'string') {
    return fromString(this, arg, arguments.length > 1 ? arguments[1] : 'utf8')
  }

  // Unusual.
  return fromObject(this, arg)
}

function fromNumber (that, length) {
  that = allocate(that, length < 0 ? 0 : checked(length) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < length; i++) {
      that[i] = 0
    }
  }
  return that
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') encoding = 'utf8'

  // Assumption: byteLength() return value is always < kMaxLength.
  var length = byteLength(string, encoding) | 0
  that = allocate(that, length)

  that.write(string, encoding)
  return that
}

function fromObject (that, object) {
  if (Buffer.isBuffer(object)) return fromBuffer(that, object)

  if (isArray(object)) return fromArray(that, object)

  if (object == null) {
    throw new TypeError('must start with number, buffer, array or string')
  }

  if (typeof ArrayBuffer !== 'undefined') {
    if (object.buffer instanceof ArrayBuffer) {
      return fromTypedArray(that, object)
    }
    if (object instanceof ArrayBuffer) {
      return fromArrayBuffer(that, object)
    }
  }

  if (object.length) return fromArrayLike(that, object)

  return fromJsonObject(that, object)
}

function fromBuffer (that, buffer) {
  var length = checked(buffer.length) | 0
  that = allocate(that, length)
  buffer.copy(that, 0, 0, length)
  return that
}

function fromArray (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

// Duplicate of fromArray() to keep fromArray() monomorphic.
function fromTypedArray (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  // Truncating the elements is probably not what people expect from typed
  // arrays with BYTES_PER_ELEMENT > 1 but it's compatible with the behavior
  // of the old Buffer constructor.
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array) {
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    array.byteLength
    that = Buffer._augment(new Uint8Array(array))
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromTypedArray(that, new Uint8Array(array))
  }
  return that
}

function fromArrayLike (that, array) {
  var length = checked(array.length) | 0
  that = allocate(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

// Deserialize { type: 'Buffer', data: [1,2,3,...] } into a Buffer object.
// Returns a zero-length buffer for inputs that don't conform to the spec.
function fromJsonObject (that, object) {
  var array
  var length = 0

  if (object.type === 'Buffer' && isArray(object.data)) {
    array = object.data
    length = checked(array.length) | 0
  }
  that = allocate(that, length)

  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
}

function allocate (that, length) {
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = Buffer._augment(new Uint8Array(length))
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that.length = length
    that._isBuffer = true
  }

  var fromPool = length !== 0 && length <= Buffer.poolSize >>> 1
  if (fromPool) that.parent = rootParent

  return that
}

function checked (length) {
  // Note: cannot use `length < kMaxLength` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (subject, encoding) {
  if (!(this instanceof SlowBuffer)) return new SlowBuffer(subject, encoding)

  var buf = new Buffer(subject, encoding)
  delete buf.parent
  return buf
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  var i = 0
  var len = Math.min(x, y)
  while (i < len) {
    if (a[i] !== b[i]) break

    ++i
  }

  if (i !== len) {
    x = a[i]
    y = b[i]
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'binary':
    case 'base64':
    case 'raw':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) throw new TypeError('list argument must be an Array of Buffers.')

  if (list.length === 0) {
    return new Buffer(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; i++) {
      length += list[i].length
    }
  }

  var buf = new Buffer(length)
  var pos = 0
  for (i = 0; i < list.length; i++) {
    var item = list[i]
    item.copy(buf, pos)
    pos += item.length
  }
  return buf
}

function byteLength (string, encoding) {
  if (typeof string !== 'string') string = '' + string

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'binary':
      // Deprecated
      case 'raw':
      case 'raws':
        return len
      case 'utf8':
      case 'utf-8':
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

// pre-set for values that may exist in the future
Buffer.prototype.length = undefined
Buffer.prototype.parent = undefined

function slowToString (encoding, start, end) {
  var loweredCase = false

  start = start | 0
  end = end === undefined || end === Infinity ? this.length : end | 0

  if (!encoding) encoding = 'utf8'
  if (start < 0) start = 0
  if (end > this.length) end = this.length
  if (end <= start) return ''

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'binary':
        return binarySlice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return 0
  return Buffer.compare(this, b)
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset) {
  if (byteOffset > 0x7fffffff) byteOffset = 0x7fffffff
  else if (byteOffset < -0x80000000) byteOffset = -0x80000000
  byteOffset >>= 0

  if (this.length === 0) return -1
  if (byteOffset >= this.length) return -1

  // Negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = Math.max(this.length + byteOffset, 0)

  if (typeof val === 'string') {
    if (val.length === 0) return -1 // special case: looking for empty string always fails
    return String.prototype.indexOf.call(this, val, byteOffset)
  }
  if (Buffer.isBuffer(val)) {
    return arrayIndexOf(this, val, byteOffset)
  }
  if (typeof val === 'number') {
    if (Buffer.TYPED_ARRAY_SUPPORT && Uint8Array.prototype.indexOf === 'function') {
      return Uint8Array.prototype.indexOf.call(this, val, byteOffset)
    }
    return arrayIndexOf(this, [ val ], byteOffset)
  }

  function arrayIndexOf (arr, val, byteOffset) {
    var foundIndex = -1
    for (var i = 0; byteOffset + i < arr.length; i++) {
      if (arr[byteOffset + i] === val[foundIndex === -1 ? 0 : i - foundIndex]) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === val.length) return byteOffset + foundIndex
      } else {
        foundIndex = -1
      }
    }
    return -1
  }

  throw new TypeError('val must be string, number or Buffer')
}

// `get` is deprecated
Buffer.prototype.get = function get (offset) {
  console.log('.get() is deprecated. Access using array indexes instead.')
  return this.readUInt8(offset)
}

// `set` is deprecated
Buffer.prototype.set = function set (v, offset) {
  console.log('.set() is deprecated. Access using array indexes instead.')
  return this.writeUInt8(v, offset)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new Error('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; i++) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) throw new Error('Invalid hex string')
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function binaryWrite (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    var swap = encoding
    encoding = offset
    offset = length | 0
    length = swap
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'binary':
        return binaryWrite(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function binarySlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; i++) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; i++) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = Buffer._augment(this.subarray(start, end))
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; i++) {
      newBuf[i] = this[i + start]
    }
  }

  if (newBuf.length) newBuf.parent = this.parent || this

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('buffer must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('value is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; i++) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; i++) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = value < 0 ? 1 : 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = value < 0 ? 1 : 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (value > max || value < min) throw new RangeError('value is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('index out of range')
  if (offset < 0) throw new RangeError('index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; i--) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; i++) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    target._set(this.subarray(start, start + len), targetStart)
  }

  return len
}

// fill(value, start=0, end=buffer.length)
Buffer.prototype.fill = function fill (value, start, end) {
  if (!value) value = 0
  if (!start) start = 0
  if (!end) end = this.length

  if (end < start) throw new RangeError('end < start')

  // Fill 0 bytes; we're done
  if (end === start) return
  if (this.length === 0) return

  if (start < 0 || start >= this.length) throw new RangeError('start out of bounds')
  if (end < 0 || end > this.length) throw new RangeError('end out of bounds')

  var i
  if (typeof value === 'number') {
    for (i = start; i < end; i++) {
      this[i] = value
    }
  } else {
    var bytes = utf8ToBytes(value.toString())
    var len = bytes.length
    for (i = start; i < end; i++) {
      this[i] = bytes[i % len]
    }
  }

  return this
}

/**
 * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.
 * Added in Node 0.12. Only available in browsers that support ArrayBuffer.
 */
Buffer.prototype.toArrayBuffer = function toArrayBuffer () {
  if (typeof Uint8Array !== 'undefined') {
    if (Buffer.TYPED_ARRAY_SUPPORT) {
      return (new Buffer(this)).buffer
    } else {
      var buf = new Uint8Array(this.length)
      for (var i = 0, len = buf.length; i < len; i += 1) {
        buf[i] = this[i]
      }
      return buf.buffer
    }
  } else {
    throw new TypeError('Buffer.toArrayBuffer not supported in this browser')
  }
}

// HELPER FUNCTIONS
// ================

var BP = Buffer.prototype

/**
 * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods
 */
Buffer._augment = function _augment (arr) {
  arr.constructor = Buffer
  arr._isBuffer = true

  // save reference to original Uint8Array set method before overwriting
  arr._set = arr.set

  // deprecated
  arr.get = BP.get
  arr.set = BP.set

  arr.write = BP.write
  arr.toString = BP.toString
  arr.toLocaleString = BP.toString
  arr.toJSON = BP.toJSON
  arr.equals = BP.equals
  arr.compare = BP.compare
  arr.indexOf = BP.indexOf
  arr.copy = BP.copy
  arr.slice = BP.slice
  arr.readUIntLE = BP.readUIntLE
  arr.readUIntBE = BP.readUIntBE
  arr.readUInt8 = BP.readUInt8
  arr.readUInt16LE = BP.readUInt16LE
  arr.readUInt16BE = BP.readUInt16BE
  arr.readUInt32LE = BP.readUInt32LE
  arr.readUInt32BE = BP.readUInt32BE
  arr.readIntLE = BP.readIntLE
  arr.readIntBE = BP.readIntBE
  arr.readInt8 = BP.readInt8
  arr.readInt16LE = BP.readInt16LE
  arr.readInt16BE = BP.readInt16BE
  arr.readInt32LE = BP.readInt32LE
  arr.readInt32BE = BP.readInt32BE
  arr.readFloatLE = BP.readFloatLE
  arr.readFloatBE = BP.readFloatBE
  arr.readDoubleLE = BP.readDoubleLE
  arr.readDoubleBE = BP.readDoubleBE
  arr.writeUInt8 = BP.writeUInt8
  arr.writeUIntLE = BP.writeUIntLE
  arr.writeUIntBE = BP.writeUIntBE
  arr.writeUInt16LE = BP.writeUInt16LE
  arr.writeUInt16BE = BP.writeUInt16BE
  arr.writeUInt32LE = BP.writeUInt32LE
  arr.writeUInt32BE = BP.writeUInt32BE
  arr.writeIntLE = BP.writeIntLE
  arr.writeIntBE = BP.writeIntBE
  arr.writeInt8 = BP.writeInt8
  arr.writeInt16LE = BP.writeInt16LE
  arr.writeInt16BE = BP.writeInt16BE
  arr.writeInt32LE = BP.writeInt32LE
  arr.writeInt32BE = BP.writeInt32BE
  arr.writeFloatLE = BP.writeFloatLE
  arr.writeFloatBE = BP.writeFloatBE
  arr.writeDoubleLE = BP.writeDoubleLE
  arr.writeDoubleBE = BP.writeDoubleBE
  arr.fill = BP.fill
  arr.inspect = BP.inspect
  arr.toArrayBuffer = BP.toArrayBuffer

  return arr
}

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; i++) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00 | 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; i++) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; i++) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":11,"ieee754":12,"is-array":13}],11:[function(require,module,exports){
var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';

;(function (exports) {
	'use strict';

  var Arr = (typeof Uint8Array !== 'undefined')
    ? Uint8Array
    : Array

	var PLUS   = '+'.charCodeAt(0)
	var SLASH  = '/'.charCodeAt(0)
	var NUMBER = '0'.charCodeAt(0)
	var LOWER  = 'a'.charCodeAt(0)
	var UPPER  = 'A'.charCodeAt(0)
	var PLUS_URL_SAFE = '-'.charCodeAt(0)
	var SLASH_URL_SAFE = '_'.charCodeAt(0)

	function decode (elt) {
		var code = elt.charCodeAt(0)
		if (code === PLUS ||
		    code === PLUS_URL_SAFE)
			return 62 // '+'
		if (code === SLASH ||
		    code === SLASH_URL_SAFE)
			return 63 // '/'
		if (code < NUMBER)
			return -1 //no match
		if (code < NUMBER + 10)
			return code - NUMBER + 26 + 26
		if (code < UPPER + 26)
			return code - UPPER
		if (code < LOWER + 26)
			return code - LOWER + 26
	}

	function b64ToByteArray (b64) {
		var i, j, l, tmp, placeHolders, arr

		if (b64.length % 4 > 0) {
			throw new Error('Invalid string. Length must be a multiple of 4')
		}

		// the number of equal signs (place holders)
		// if there are two placeholders, than the two characters before it
		// represent one byte
		// if there is only one, then the three characters before it represent 2 bytes
		// this is just a cheap hack to not do indexOf twice
		var len = b64.length
		placeHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0

		// base64 is 4/3 + up to two characters of the original data
		arr = new Arr(b64.length * 3 / 4 - placeHolders)

		// if there are placeholders, only get up to the last complete 4 chars
		l = placeHolders > 0 ? b64.length - 4 : b64.length

		var L = 0

		function push (v) {
			arr[L++] = v
		}

		for (i = 0, j = 0; i < l; i += 4, j += 3) {
			tmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))
			push((tmp & 0xFF0000) >> 16)
			push((tmp & 0xFF00) >> 8)
			push(tmp & 0xFF)
		}

		if (placeHolders === 2) {
			tmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)
			push(tmp & 0xFF)
		} else if (placeHolders === 1) {
			tmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)
			push((tmp >> 8) & 0xFF)
			push(tmp & 0xFF)
		}

		return arr
	}

	function uint8ToBase64 (uint8) {
		var i,
			extraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes
			output = "",
			temp, length

		function encode (num) {
			return lookup.charAt(num)
		}

		function tripletToBase64 (num) {
			return encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)
		}

		// go through the array every three bytes, we'll deal with trailing stuff later
		for (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {
			temp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
			output += tripletToBase64(temp)
		}

		// pad the end with zeros, but make sure to not forget the extra bytes
		switch (extraBytes) {
			case 1:
				temp = uint8[uint8.length - 1]
				output += encode(temp >> 2)
				output += encode((temp << 4) & 0x3F)
				output += '=='
				break
			case 2:
				temp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])
				output += encode(temp >> 10)
				output += encode((temp >> 4) & 0x3F)
				output += encode((temp << 2) & 0x3F)
				output += '='
				break
		}

		return output
	}

	exports.toByteArray = b64ToByteArray
	exports.fromByteArray = uint8ToBase64
}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))

},{}],12:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],13:[function(require,module,exports){

/**
 * isArray
 */

var isArray = Array.isArray;

/**
 * toString
 */

var str = Object.prototype.toString;

/**
 * Whether or not the given `val`
 * is an array.
 *
 * example:
 *
 *        isArray([]);
 *        // > true
 *        isArray(arguments);
 *        // > false
 *        isArray('');
 *        // > false
 *
 * @param {mixed} val
 * @return {bool}
 */

module.exports = isArray || function (val) {
  return !! val && '[object Array]' == str.call(val);
};

},{}],14:[function(require,module,exports){
(function () {
  var gju = this.gju = {};

  // Export the geojson object for **CommonJS**
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = gju;
  }

  // adapted from http://www.kevlindev.com/gui/math/intersection/Intersection.js
  gju.lineStringsIntersect = function (l1, l2) {
    var intersects = [];
    for (var i = 0; i <= l1.coordinates.length - 2; ++i) {
      for (var j = 0; j <= l2.coordinates.length - 2; ++j) {
        var a1 = {
          x: l1.coordinates[i][1],
          y: l1.coordinates[i][0]
        },
          a2 = {
            x: l1.coordinates[i + 1][1],
            y: l1.coordinates[i + 1][0]
          },
          b1 = {
            x: l2.coordinates[j][1],
            y: l2.coordinates[j][0]
          },
          b2 = {
            x: l2.coordinates[j + 1][1],
            y: l2.coordinates[j + 1][0]
          },
          ua_t = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x),
          ub_t = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x),
          u_b = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);
        if (u_b != 0) {
          var ua = ua_t / u_b,
            ub = ub_t / u_b;
          if (0 <= ua && ua <= 1 && 0 <= ub && ub <= 1) {
            intersects.push({
              'type': 'Point',
              'coordinates': [a1.x + ua * (a2.x - a1.x), a1.y + ua * (a2.y - a1.y)]
            });
          }
        }
      }
    }
    if (intersects.length == 0) intersects = false;
    return intersects;
  }

  // Bounding Box

  function boundingBoxAroundPolyCoords (coords) {
    var xAll = [], yAll = []

    for (var i = 0; i < coords[0].length; i++) {
      xAll.push(coords[0][i][1])
      yAll.push(coords[0][i][0])
    }

    xAll = xAll.sort(function (a,b) { return a - b })
    yAll = yAll.sort(function (a,b) { return a - b })

    return [ [xAll[0], yAll[0]], [xAll[xAll.length - 1], yAll[yAll.length - 1]] ]
  }

  gju.pointInBoundingBox = function (point, bounds) {
    return !(point.coordinates[1] < bounds[0][0] || point.coordinates[1] > bounds[1][0] || point.coordinates[0] < bounds[0][1] || point.coordinates[0] > bounds[1][1]) 
  }

  // Point in Polygon
  // http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html#Listing the Vertices

  function pnpoly (x,y,coords) {
    var vert = [ [0,0] ]

    for (var i = 0; i < coords.length; i++) {
      for (var j = 0; j < coords[i].length; j++) {
        vert.push(coords[i][j])
      }
	  vert.push(coords[i][0])
      vert.push([0,0])
    }

    var inside = false
    for (var i = 0, j = vert.length - 1; i < vert.length; j = i++) {
      if (((vert[i][0] > y) != (vert[j][0] > y)) && (x < (vert[j][1] - vert[i][1]) * (y - vert[i][0]) / (vert[j][0] - vert[i][0]) + vert[i][1])) inside = !inside
    }

    return inside
  }

  gju.pointInPolygon = function (p, poly) {
    var coords = (poly.type == "Polygon") ? [ poly.coordinates ] : poly.coordinates

    var insideBox = false
    for (var i = 0; i < coords.length; i++) {
      if (gju.pointInBoundingBox(p, boundingBoxAroundPolyCoords(coords[i]))) insideBox = true
    }
    if (!insideBox) return false

    var insidePoly = false
    for (var i = 0; i < coords.length; i++) {
      if (pnpoly(p.coordinates[1], p.coordinates[0], coords[i])) insidePoly = true
    }

    return insidePoly
  }

  // support multi (but not donut) polygons
  gju.pointInMultiPolygon = function (p, poly) {
    var coords_array = (poly.type == "MultiPolygon") ? [ poly.coordinates ] : poly.coordinates

    var insideBox = false
    var insidePoly = false
    for (var i = 0; i < coords_array.length; i++){
      var coords = coords_array[i];
      for (var j = 0; j < coords.length; j++) {
        if (!insideBox){
          if (gju.pointInBoundingBox(p, boundingBoxAroundPolyCoords(coords[j]))) {
            insideBox = true
          }
        }
      }
      if (!insideBox) return false
      for (var j = 0; j < coords.length; j++) {
        if (!insidePoly){
          if (pnpoly(p.coordinates[1], p.coordinates[0], coords[j])) {
            insidePoly = true
          }
        }
      }
    }

    return insidePoly
  }

  gju.numberToRadius = function (number) {
    return number * Math.PI / 180;
  }

  gju.numberToDegree = function (number) {
    return number * 180 / Math.PI;
  }

  // written with help from @tautologe
  gju.drawCircle = function (radiusInMeters, centerPoint, steps) {
    var center = [centerPoint.coordinates[1], centerPoint.coordinates[0]],
      dist = (radiusInMeters / 1000) / 6371,
      // convert meters to radiant
      radCenter = [gju.numberToRadius(center[0]), gju.numberToRadius(center[1])],
      steps = steps || 15,
      // 15 sided circle
      poly = [[center[0], center[1]]];
    for (var i = 0; i < steps; i++) {
      var brng = 2 * Math.PI * i / steps;
      var lat = Math.asin(Math.sin(radCenter[0]) * Math.cos(dist)
              + Math.cos(radCenter[0]) * Math.sin(dist) * Math.cos(brng));
      var lng = radCenter[1] + Math.atan2(Math.sin(brng) * Math.sin(dist) * Math.cos(radCenter[0]),
                                          Math.cos(dist) - Math.sin(radCenter[0]) * Math.sin(lat));
      poly[i] = [];
      poly[i][1] = gju.numberToDegree(lat);
      poly[i][0] = gju.numberToDegree(lng);
    }
    return {
      "type": "Polygon",
      "coordinates": [poly]
    };
  }

  // assumes rectangle starts at lower left point
  gju.rectangleCentroid = function (rectangle) {
    var bbox = rectangle.coordinates[0];
    var xmin = bbox[0][0],
      ymin = bbox[0][1],
      xmax = bbox[2][0],
      ymax = bbox[2][1];
    var xwidth = xmax - xmin;
    var ywidth = ymax - ymin;
    return {
      'type': 'Point',
      'coordinates': [xmin + xwidth / 2, ymin + ywidth / 2]
    };
  }

  // from http://www.movable-type.co.uk/scripts/latlong.html
  gju.pointDistance = function (pt1, pt2) {
    var lon1 = pt1.coordinates[0],
      lat1 = pt1.coordinates[1],
      lon2 = pt2.coordinates[0],
      lat2 = pt2.coordinates[1],
      dLat = gju.numberToRadius(lat2 - lat1),
      dLon = gju.numberToRadius(lon2 - lon1),
      a = Math.pow(Math.sin(dLat / 2), 2) + Math.cos(gju.numberToRadius(lat1))
        * Math.cos(gju.numberToRadius(lat2)) * Math.pow(Math.sin(dLon / 2), 2),
      c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return (6371 * c) * 1000; // returns meters
  },

  // checks if geometry lies entirely within a circle
  // works with Point, LineString, Polygon
  gju.geometryWithinRadius = function (geometry, center, radius) {
    if (geometry.type == 'Point') {
      return gju.pointDistance(geometry, center) <= radius;
    } else if (geometry.type == 'LineString' || geometry.type == 'Polygon') {
      var point = {};
      var coordinates;
      if (geometry.type == 'Polygon') {
        // it's enough to check the exterior ring of the Polygon
        coordinates = geometry.coordinates[0];
      } else {
        coordinates = geometry.coordinates;
      }
      for (var i in coordinates) {
        point.coordinates = coordinates[i];
        if (gju.pointDistance(point, center) > radius) {
          return false;
        }
      }
    }
    return true;
  }

  // adapted from http://paulbourke.net/geometry/polyarea/javascript.txt
  gju.area = function (polygon) {
    var area = 0;
    // TODO: polygon holes at coordinates[1]
    var points = polygon.coordinates[0];
    var j = points.length - 1;
    var p1, p2;

    for (var i = 0; i < points.length; j = i++) {
      var p1 = {
        x: points[i][1],
        y: points[i][0]
      };
      var p2 = {
        x: points[j][1],
        y: points[j][0]
      };
      area += p1.x * p2.y;
      area -= p1.y * p2.x;
    }

    area /= 2;
    return area;
  },

  // adapted from http://paulbourke.net/geometry/polyarea/javascript.txt
  gju.centroid = function (polygon) {
    var f, x = 0,
      y = 0;
    // TODO: polygon holes at coordinates[1]
    var points = polygon.coordinates[0];
    var j = points.length - 1;
    var p1, p2;

    for (var i = 0; i < points.length; j = i++) {
      var p1 = {
        x: points[i][1],
        y: points[i][0]
      };
      var p2 = {
        x: points[j][1],
        y: points[j][0]
      };
      f = p1.x * p2.y - p2.x * p1.y;
      x += (p1.x + p2.x) * f;
      y += (p1.y + p2.y) * f;
    }

    f = gju.area(polygon) * 6;
    return {
      'type': 'Point',
      'coordinates': [y / f, x / f]
    };
  },

  gju.simplify = function (source, kink) { /* source[] array of geojson points */
    /* kink	in metres, kinks above this depth kept  */
    /* kink depth is the height of the triangle abc where a-b and b-c are two consecutive line segments */
    kink = kink || 20;
    source = source.map(function (o) {
      return {
        lng: o.coordinates[0],
        lat: o.coordinates[1]
      }
    });

    var n_source, n_stack, n_dest, start, end, i, sig;
    var dev_sqr, max_dev_sqr, band_sqr;
    var x12, y12, d12, x13, y13, d13, x23, y23, d23;
    var F = (Math.PI / 180.0) * 0.5;
    var index = new Array(); /* aray of indexes of source points to include in the reduced line */
    var sig_start = new Array(); /* indices of start & end of working section */
    var sig_end = new Array();

    /* check for simple cases */

    if (source.length < 3) return (source); /* one or two points */

    /* more complex case. initialize stack */

    n_source = source.length;
    band_sqr = kink * 360.0 / (2.0 * Math.PI * 6378137.0); /* Now in degrees */
    band_sqr *= band_sqr;
    n_dest = 0;
    sig_start[0] = 0;
    sig_end[0] = n_source - 1;
    n_stack = 1;

    /* while the stack is not empty  ... */
    while (n_stack > 0) {

      /* ... pop the top-most entries off the stacks */

      start = sig_start[n_stack - 1];
      end = sig_end[n_stack - 1];
      n_stack--;

      if ((end - start) > 1) { /* any intermediate points ? */

        /* ... yes, so find most deviant intermediate point to
        either side of line joining start & end points */

        x12 = (source[end].lng() - source[start].lng());
        y12 = (source[end].lat() - source[start].lat());
        if (Math.abs(x12) > 180.0) x12 = 360.0 - Math.abs(x12);
        x12 *= Math.cos(F * (source[end].lat() + source[start].lat())); /* use avg lat to reduce lng */
        d12 = (x12 * x12) + (y12 * y12);

        for (i = start + 1, sig = start, max_dev_sqr = -1.0; i < end; i++) {

          x13 = source[i].lng() - source[start].lng();
          y13 = source[i].lat() - source[start].lat();
          if (Math.abs(x13) > 180.0) x13 = 360.0 - Math.abs(x13);
          x13 *= Math.cos(F * (source[i].lat() + source[start].lat()));
          d13 = (x13 * x13) + (y13 * y13);

          x23 = source[i].lng() - source[end].lng();
          y23 = source[i].lat() - source[end].lat();
          if (Math.abs(x23) > 180.0) x23 = 360.0 - Math.abs(x23);
          x23 *= Math.cos(F * (source[i].lat() + source[end].lat()));
          d23 = (x23 * x23) + (y23 * y23);

          if (d13 >= (d12 + d23)) dev_sqr = d23;
          else if (d23 >= (d12 + d13)) dev_sqr = d13;
          else dev_sqr = (x13 * y12 - y13 * x12) * (x13 * y12 - y13 * x12) / d12; // solve triangle
          if (dev_sqr > max_dev_sqr) {
            sig = i;
            max_dev_sqr = dev_sqr;
          }
        }

        if (max_dev_sqr < band_sqr) { /* is there a sig. intermediate point ? */
          /* ... no, so transfer current start point */
          index[n_dest] = start;
          n_dest++;
        } else { /* ... yes, so push two sub-sections on stack for further processing */
          n_stack++;
          sig_start[n_stack - 1] = sig;
          sig_end[n_stack - 1] = end;
          n_stack++;
          sig_start[n_stack - 1] = start;
          sig_end[n_stack - 1] = sig;
        }
      } else { /* ... no intermediate points, so transfer current start point */
        index[n_dest] = start;
        n_dest++;
      }
    }

    /* transfer last point */
    index[n_dest] = n_source - 1;
    n_dest++;

    /* make return array */
    var r = new Array();
    for (var i = 0; i < n_dest; i++)
      r.push(source[index[i]]);

    return r.map(function (o) {
      return {
        type: "Point",
        coordinates: [o.lng, o.lat]
      }
    });
  }

  // http://www.movable-type.co.uk/scripts/latlong.html#destPoint
  gju.destinationPoint = function (pt, brng, dist) {
    dist = dist/6371;  // convert dist to angular distance in radians
    brng = gju.numberToRadius(brng);

    var lon1 = gju.numberToRadius(pt.coordinates[0]);
    var lat1 = gju.numberToRadius(pt.coordinates[1]);

    var lat2 = Math.asin( Math.sin(lat1)*Math.cos(dist) +
                          Math.cos(lat1)*Math.sin(dist)*Math.cos(brng) );
    var lon2 = lon1 + Math.atan2(Math.sin(brng)*Math.sin(dist)*Math.cos(lat1),
                                 Math.cos(dist)-Math.sin(lat1)*Math.sin(lat2));
    lon2 = (lon2+3*Math.PI) % (2*Math.PI) - Math.PI;  // normalise to -180..+180º

    return {
      'type': 'Point',
      'coordinates': [gju.numberToDegree(lon2), gju.numberToDegree(lat2)]
    };
  };

})();

},{}],15:[function(require,module,exports){
// Packaging/modules magic dance.
(function (factory) {
    var L;
    if (typeof define === 'function' && define.amd) {
        // AMD
        define(['leaflet'], factory);
    } else if (typeof module !== 'undefined') {
        // Node/CommonJS
        L = require('leaflet');
        module.exports = factory(L);
    } else {
        // Browser globals
        if (typeof window.L === 'undefined')
            throw 'Leaflet must be loaded first';
        factory(window.L);
    }
}(function (L) {
"use strict";

/**
 * @fileOverview Leaflet Geometry utilities for distances and linear referencing.
 * @name L.GeometryUtil
 */

L.GeometryUtil = L.extend(L.GeometryUtil || {}, {

    /**
        Shortcut function for planar distance between two {L.LatLng} at current zoom.
        @param {L.Map} map
        @param {L.LatLng} latlngA
        @param {L.LatLng} latlngB
        @returns {Number} in pixels
     */
    distance: function (map, latlngA, latlngB) {
        return map.latLngToLayerPoint(latlngA).distanceTo(map.latLngToLayerPoint(latlngB));
    },

    /**
        Shortcut function for planar distance between a {L.LatLng} and a segment (A-B).
        @param {L.Map} map
        @param {L.LatLng} latlng
        @param {L.LatLng} latlngA
        @param {L.LatLng} latlngB
        @returns {Number} in pixels
    */
    distanceSegment: function (map, latlng, latlngA, latlngB) {
        var p = map.latLngToLayerPoint(latlng),
           p1 = map.latLngToLayerPoint(latlngA),
           p2 = map.latLngToLayerPoint(latlngB);
        return L.LineUtil.pointToSegmentDistance(p, p1, p2);
    },

    /**
        Shortcut function for converting distance to readable distance.
        @param {Number} distance
        @param {String} unit ('metric' or 'imperial')
        @returns {Number} in yard or miles
    */
    readableDistance: function (distance, unit) {
        var isMetric = (unit !== 'imperial'),
            distanceStr;
        if (isMetric) {
            // show metres when distance is < 1km, then show km
            if (distance > 1000) {
                distanceStr = (distance  / 1000).toFixed(2) + ' km';
            }
            else {
                distanceStr = Math.ceil(distance) + ' m';
            }
        }
        else {
            distance *= 1.09361;
            if (distance > 1760) {
                distanceStr = (distance / 1760).toFixed(2) + ' miles';
            }
            else {
                distanceStr = Math.ceil(distance) + ' yd';
            }
        }
        return distanceStr;
    },

    /**
        Returns true if the latlng belongs to segment.
        param {L.LatLng} latlng
        @param {L.LatLng} latlngA
        @param {L.LatLng} latlngB
        @param {?Number} [tolerance=0.2]
        @returns {boolean}
     */
    belongsSegment: function(latlng, latlngA, latlngB, tolerance) {
        tolerance = tolerance === undefined ? 0.2 : tolerance;
        var hypotenuse = latlngA.distanceTo(latlngB),
            delta = latlngA.distanceTo(latlng) + latlng.distanceTo(latlngB) - hypotenuse;
        return delta/hypotenuse < tolerance;
    },

    /**
     * Returns total length of line
     * @param {L.Polyline|Array<L.Point>|Array<L.LatLng>}
     * @returns {Number} in meters
     */
    length: function (coords) {
        var accumulated = L.GeometryUtil.accumulatedLengths(coords);
        return accumulated.length > 0 ? accumulated[accumulated.length-1] : 0;
    },

    /**
     * Returns a list of accumulated length along a line.
     * @param {L.Polyline|Array<L.Point>|Array<L.LatLng>}
     * @returns {Number} in meters
     */
    accumulatedLengths: function (coords) {
        if (typeof coords.getLatLngs == 'function') {
            coords = coords.getLatLngs();
        }
        if (coords.length === 0)
            return [];
        var total = 0,
            lengths = [0];
        for (var i = 0, n = coords.length - 1; i< n; i++) {
            total += coords[i].distanceTo(coords[i+1]);
            lengths.push(total);
        }
        return lengths;
    },

    /**
        Returns the closest point of a {L.LatLng} on the segment (A-B)
        @param {L.Map} map
        @param {L.LatLng} latlng
        @param {L.LatLng} latlngA
        @param {L.LatLng} latlngB
        @returns {L.LatLng}
    */
    closestOnSegment: function (map, latlng, latlngA, latlngB) {
        var maxzoom = map.getMaxZoom();
        if (maxzoom === Infinity)
            maxzoom = map.getZoom();
        var p = map.project(latlng, maxzoom),
           p1 = map.project(latlngA, maxzoom),
           p2 = map.project(latlngB, maxzoom),
           closest = L.LineUtil.closestPointOnSegment(p, p1, p2);
        return map.unproject(closest, maxzoom);
    },

    /**
        Returns the closest latlng on layer.
        @param {L.Map} map
        @param {Array<L.LatLng>|L.PolyLine} layer - Layer that contains the result.
        @param {L.LatLng} latlng
        @param {?boolean} [vertices=false] - Whether to restrict to path vertices.
        @returns {L.LatLng}
    */
    closest: function (map, layer, latlng, vertices) {
        if (typeof layer.getLatLngs != 'function')
            layer = L.polyline(layer);

        var latlngs = layer.getLatLngs().slice(0),
            mindist = Infinity,
            result = null,
            i, n, distance;

        // Lookup vertices
        if (vertices) {
            for(i = 0, n = latlngs.length; i < n; i++) {
                var ll = latlngs[i];
                distance = L.GeometryUtil.distance(map, latlng, ll);
                if (distance < mindist) {
                    mindist = distance;
                    result = ll;
                    result.distance = distance;
                }
            }
            return result;
        }

        if (layer instanceof L.Polygon) {
            latlngs.push(latlngs[0]);
        }

        // Keep the closest point of all segments
        for (i = 0, n = latlngs.length; i < n-1; i++) {
            var latlngA = latlngs[i],
                latlngB = latlngs[i+1];
            distance = L.GeometryUtil.distanceSegment(map, latlng, latlngA, latlngB);
            if (distance <= mindist) {
                mindist = distance;
                result = L.GeometryUtil.closestOnSegment(map, latlng, latlngA, latlngB);
                result.distance = distance;
            }
        }
        return result;
    },

    /**
        Returns the closest layer to latlng among a list of layers.
        @param {L.Map} map
        @param {Array<L.ILayer>} layers
        @param {L.LatLng} latlng
        @returns {object} with layer, latlng and distance or {null} if list is empty;
    */
    closestLayer: function (map, layers, latlng) {
        var mindist = Infinity,
            result = null,
            ll = null,
            distance = Infinity;

        for (var i = 0, n = layers.length; i < n; i++) {
            var layer = layers[i];
            // Single dimension, snap on points, else snap on closest
            if (typeof layer.getLatLng == 'function') {
                ll = layer.getLatLng();
                distance = L.GeometryUtil.distance(map, latlng, ll);
            }
            else {
                ll = L.GeometryUtil.closest(map, layer, latlng);
                if (ll) distance = ll.distance;  // Can return null if layer has no points.
            }
            if (distance < mindist) {
                mindist = distance;
                result = {layer: layer, latlng: ll, distance: distance};
            }
        }
        return result;
    },

    /**
        Returns the closest position from specified {LatLng} among specified layers,
        with a maximum tolerance in pixels, providing snapping behaviour.
        @param {L.Map} map
        @param {Array<ILayer>} layers - A list of layers to snap on.
        @param {L.LatLng} latlng - The position to snap.
        @param {?Number} [tolerance=Infinity] - Maximum number of pixels.
        @param {?boolean} [withVertices=true] - Snap to layers vertices.
        @returns {object} with snapped {LatLng} and snapped {Layer} or null if tolerance exceeded.
    */
    closestLayerSnap: function (map, layers, latlng, tolerance, withVertices) {
        tolerance = typeof tolerance == 'number' ? tolerance : Infinity;
        withVertices = typeof withVertices == 'boolean' ? withVertices : true;

        var result = L.GeometryUtil.closestLayer(map, layers, latlng);
        if (!result || result.distance > tolerance)
            return null;

        // If snapped layer is linear, try to snap on vertices (extremities and middle points)
        if (withVertices && typeof result.layer.getLatLngs == 'function') {
            var closest = L.GeometryUtil.closest(map, result.layer, result.latlng, true);
            if (closest.distance < tolerance) {
                result.latlng = closest;
                result.distance = L.GeometryUtil.distance(map, closest, latlng);
            }
        }
        return result;
    },

    /**
        Returns the Point located on a segment at the specified ratio of the segment length.
        @param {L.Point} pA
        @param {L.Point} pB
        @param {Number} the length ratio, expressed as a decimal between 0 and 1, inclusive.
        @returns {L.Point} the interpolated point.
    */
    interpolateOnPointSegment: function (pA, pB, ratio) {
        return L.point(
            (pA.x * (1 - ratio)) + (ratio * pB.x),
            (pA.y * (1 - ratio)) + (ratio * pB.y)
        );
    },

    /**
        Returns the coordinate of the point located on a line at the specified ratio of the line length.
        @param {L.Map} map
        @param {Array<L.LatLng>|L.PolyLine} latlngs
        @param {Number} the length ratio, expressed as a decimal between 0 and 1, inclusive
        @returns {Object} an object with latLng ({LatLng}) and predecessor ({Number}), the index of the preceding vertex in the Polyline
        (-1 if the interpolated point is the first vertex)
    */
    interpolateOnLine: function (map, latLngs, ratio) {
        latLngs = (latLngs instanceof L.Polyline) ? latLngs.getLatLngs() : latLngs;
        var n = latLngs.length;
        if (n < 2) {
            return null;
        }

        if (ratio === 0) {
            return {
                latLng: latLngs[0] instanceof L.LatLng ? latLngs[0] : L.latLng(latLngs[0]),
                predecessor: -1
            };
        }
        if (ratio == 1) {
            return {
                latLng: latLngs[latLngs.length -1] instanceof L.LatLng ? latLngs[latLngs.length -1] : L.latLng(latLngs[latLngs.length -1]),
                predecessor: latLngs.length - 2
            };
        }

        // ensure the ratio is between 0 and 1;
        ratio = Math.max(Math.min(ratio, 1), 0);

        // project the LatLngs as Points,
        // and compute total planar length of the line at max precision
        var maxzoom = map.getMaxZoom();
        if (maxzoom === Infinity)
            maxzoom = map.getZoom();
        var pts = [];
        var lineLength = 0;
        for(var i = 0; i < n; i++) {
            pts[i] = map.project(latLngs[i], maxzoom);
            if(i > 0)
              lineLength += pts[i-1].distanceTo(pts[i]);
        }

        var ratioDist = lineLength * ratio;
        var a = pts[0],
            b = pts[1],
            distA = 0,
            distB = a.distanceTo(b);
        // follow the line segments [ab], adding lengths,
        // until we find the segment where the points should lie on
        var index = 1;
        for (; index < n && distB < ratioDist; index++) {
            a = b;
            distA = distB;
            b = pts[index];
            distB += a.distanceTo(b);
        }
        // compute the ratio relative to the segment [ab]
        var segmentRatio = ((distB - distA) !== 0) ? ((ratioDist - distA) / (distB - distA)) : 0;
        var interpolatedPoint = L.GeometryUtil.interpolateOnPointSegment(a, b, segmentRatio);
        return {
            latLng: map.unproject(interpolatedPoint, maxzoom),
            predecessor: index-2
        };
    },

    /**
        Returns a float between 0 and 1 representing the location of the
        closest point on polyline to the given latlng, as a fraction of total 2d line length.
        (opposite of L.GeometryUtil.interpolateOnLine())
        @param {L.Map} map
        @param {L.PolyLine} polyline
        @param {L.LatLng} latlng
        @returns {Number}
    */
    locateOnLine: function (map, polyline, latlng) {
        var latlngs = polyline.getLatLngs();
        if (latlng.equals(latlngs[0]))
            return 0.0;
        if (latlng.equals(latlngs[latlngs.length-1]))
            return 1.0;

        var point = L.GeometryUtil.closest(map, polyline, latlng, false),
            lengths = L.GeometryUtil.accumulatedLengths(latlngs),
            total_length = lengths[lengths.length-1],
            portion = 0,
            found = false;
        for (var i=0, n = latlngs.length-1; i < n; i++) {
            var l1 = latlngs[i],
                l2 = latlngs[i+1];
            portion = lengths[i];
            if (L.GeometryUtil.belongsSegment(point, l1, l2)) {
                portion += l1.distanceTo(point);
                found = true;
                break;
            }
        }
        if (!found) {
            throw "Could not interpolate " + latlng.toString() + " within " + polyline.toString();
        }
        return portion / total_length;
    },

    /**
        Returns a clone with reversed coordinates.
        @param {L.PolyLine} polyline
        @returns {L.PolyLine}
    */
    reverse: function (polyline) {
        return L.polyline(polyline.getLatLngs().slice(0).reverse());
    },

    /**
        Returns a sub-part of the polyline, from start to end.
        If start is superior to end, returns extraction from inverted line.
        @param {L.Map} map
        @param {L.PolyLine} latlngs
        @param {Number} start ratio, expressed as a decimal between 0 and 1, inclusive
        @param {Number} end ratio, expressed as a decimal between 0 and 1, inclusive
        @returns {Array<L.LatLng>}
     */
    extract: function (map, polyline, start, end) {
        if (start > end) {
            return L.GeometryUtil.extract(map, L.GeometryUtil.reverse(polyline), 1.0-start, 1.0-end);
        }

        // Bound start and end to [0-1]
        start = Math.max(Math.min(start, 1), 0);
        end = Math.max(Math.min(end, 1), 0);

        var latlngs = polyline.getLatLngs(),
            startpoint = L.GeometryUtil.interpolateOnLine(map, polyline, start),
            endpoint = L.GeometryUtil.interpolateOnLine(map, polyline, end);
        // Return single point if start == end
        if (start == end) {
            var point = L.GeometryUtil.interpolateOnLine(map, polyline, end);
            return [point.latLng];
        }
        // Array.slice() works indexes at 0
        if (startpoint.predecessor == -1)
            startpoint.predecessor = 0;
        if (endpoint.predecessor == -1)
            endpoint.predecessor = 0;
        var result = latlngs.slice(startpoint.predecessor+1, endpoint.predecessor+1);
        result.unshift(startpoint.latLng);
        result.push(endpoint.latLng);
        return result;
    },

    /**
        Returns true if first polyline ends where other second starts.
        @param {L.PolyLine} polyline
        @param {L.PolyLine} other
        @returns {bool}
    */
    isBefore: function (polyline, other) {
        if (!other) return false;
        var lla = polyline.getLatLngs(),
            llb = other.getLatLngs();
        return (lla[lla.length-1]).equals(llb[0]);
    },

    /**
        Returns true if first polyline starts where second ends.
        @param {L.PolyLine} polyline
        @param {L.PolyLine} other
        @returns {bool}
    */
    isAfter: function (polyline, other) {
        if (!other) return false;
        var lla = polyline.getLatLngs(),
            llb = other.getLatLngs();
        return (lla[0]).equals(llb[llb.length-1]);
    },

    /**
        Returns true if first polyline starts where second ends or start.
        @param {L.PolyLine} polyline
        @param {L.PolyLine} other
        @returns {bool}
    */
    startsAtExtremity: function (polyline, other) {
        if (!other) return false;
        var lla = polyline.getLatLngs(),
            llb = other.getLatLngs(),
            start = lla[0];
        return start.equals(llb[0]) || start.equals(llb[llb.length-1]);
    },

    /**
        Returns horizontal angle in degres between two points.
        @param {L.Point} a
        @param {L.Point} b
        @returns {float}
     */
    computeAngle: function(a, b) {
        return (Math.atan2(b.y - a.y, b.x - a.x) * 180 / Math.PI);
    },

    /**
       Returns slope (Ax+B) between two points.
        @param {L.Point} a
        @param {L.Point} b
        @returns {Object} with ``a`` and ``b`` properties.
     */
    computeSlope: function(a, b) {
        var s = (b.y - a.y) / (b.x - a.x),
            o = a.y - (s * a.x);
        return {'a': s, 'b': o};
    },

    /**
       Returns LatLng of rotated point around specified LatLng center.
        @param {L.LatLng} latlngPoint: point to rotate
        @param {double} angleDeg: angle to rotate in degrees
        @param {L.LatLng} latlngCenter: center of rotation
        @returns {L.LatLng} rotated point
     */
    rotatePoint: function(map, latlngPoint, angleDeg, latlngCenter) {
        var maxzoom = map.getMaxZoom();
        if (maxzoom === Infinity)
            maxzoom = map.getZoom();
        var angleRad = angleDeg*Math.PI/180,
            pPoint = map.project(latlngPoint, maxzoom),
            pCenter = map.project(latlngCenter, maxzoom),
            x2 = Math.cos(angleRad)*(pPoint.x-pCenter.x) - Math.sin(angleRad)*(pPoint.y-pCenter.y) + pCenter.x,
            y2 = Math.sin(angleRad)*(pPoint.x-pCenter.x) + Math.cos(angleRad)*(pPoint.y-pCenter.y) + pCenter.y;
        return map.unproject(new L.Point(x2,y2), maxzoom);
    },

    /**
       Returns the bearing in degrees clockwise from north (0 degrees)
       from the first L.LatLng to the second, at the first LatLng 
       @param {L.LatLng} latlng1: origin point of the bearing
       @param {L.LatLng} latlng2: destination point of the bearing
       @returns {float} degrees clockwise from north.
    */
    bearing: function(latlng1, latlng2) {
        var rad = Math.PI / 180,
            lat1 = latlng1.lat * rad,
            lat2 = latlng2.lat * rad,
            lon1 = latlng1.lng * rad,
            lon2 = latlng2.lng * rad,
            y = Math.sin(lon2 - lon1) * Math.cos(lat2),
            x = Math.cos(lat1) * Math.sin(lat2) -
                Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon2 - lon1);

        var bearing = ((Math.atan2(y, x) * 180 / Math.PI) + 360) % 360;
        return bearing >= 180 ? bearing-360 : bearing;
    },

    /**
       Returns the point that is a distance and heading away from
       the given origin point.
       @param {L.LatLng} latlng: origin point
       @param {float}: heading in degrees, clockwise from 0 degrees north.
       @param {float}: distance in meters
       @returns {L.latLng} the destination point.
       Many thanks to Chris Veness at http://www.movable-type.co.uk/scripts/latlong.html
       for a great reference and examples.
    */
    destination: function(latlng, heading, distance) {
        heading = (heading + 360) % 360;
        var rad = Math.PI / 180,
            radInv = 180 / Math.PI,
            R = 6378137, // approximation of Earth's radius
            lon1 = latlng.lng * rad,
            lat1 = latlng.lat * rad,
            rheading = heading * rad,
            sinLat1 = Math.sin(lat1),
            cosLat1 = Math.cos(lat1),
            cosDistR = Math.cos(distance / R),
            sinDistR = Math.sin(distance / R),
            lat2 = Math.asin(sinLat1 * cosDistR + cosLat1 *
                sinDistR * Math.cos(rheading)),
            lon2 = lon1 + Math.atan2(Math.sin(rheading) * sinDistR *
                cosLat1, cosDistR - sinLat1 * Math.sin(lat2));
        lon2 = lon2 * radInv;
        lon2 = lon2 > 180 ? lon2 - 360 : lon2 < -180 ? lon2 + 360 : lon2;
        return L.latLng([lat2 * radInv, lon2]);
    }
});

return L.GeometryUtil;

}));

},{"leaflet":22}],16:[function(require,module,exports){
(function(window) {
	var HAS_HASHCHANGE = (function() {
		var doc_mode = window.documentMode;
		return ('onhashchange' in window) &&
			(doc_mode === undefined || doc_mode > 7);
	})();

	L.Hash = function(map) {
		this.onHashChange = L.Util.bind(this.onHashChange, this);

		if (map) {
			this.init(map);
		}
	};

	L.Hash.parseHash = function(hash) {
		if(hash.indexOf('#') === 0) {
			hash = hash.substr(1);
		}
		var args = hash.split("/");
		if (args.length == 3) {
			var zoom = parseInt(args[0], 10),
			lat = parseFloat(args[1]),
			lon = parseFloat(args[2]);
			if (isNaN(zoom) || isNaN(lat) || isNaN(lon)) {
				return false;
			} else {
				return {
					center: new L.LatLng(lat, lon),
					zoom: zoom
				};
			}
		} else {
			return false;
		}
	};

	L.Hash.formatHash = function(map) {
		var center = map.getCenter(),
		    zoom = map.getZoom(),
		    precision = Math.max(0, Math.ceil(Math.log(zoom) / Math.LN2));

		return "#" + [zoom,
			center.lat.toFixed(precision),
			center.lng.toFixed(precision)
		].join("/");
	},

	L.Hash.prototype = {
		map: null,
		lastHash: null,

		parseHash: L.Hash.parseHash,
		formatHash: L.Hash.formatHash,

		init: function(map) {
			this.map = map;

			// reset the hash
			this.lastHash = null;
			this.onHashChange();

			if (!this.isListening) {
				this.startListening();
			}
		},

		removeFrom: function(map) {
			if (this.changeTimeout) {
				clearTimeout(this.changeTimeout);
			}

			if (this.isListening) {
				this.stopListening();
			}

			this.map = null;
		},

		onMapMove: function() {
			// bail if we're moving the map (updating from a hash),
			// or if the map is not yet loaded

			if (this.movingMap || !this.map._loaded) {
				return false;
			}

			var hash = this.formatHash(this.map);
			if (this.lastHash != hash) {
				location.replace(hash);
				this.lastHash = hash;
			}
		},

		movingMap: false,
		update: function() {
			var hash = location.hash;
			if (hash === this.lastHash) {
				return;
			}
			var parsed = this.parseHash(hash);
			if (parsed) {
				this.movingMap = true;

				this.map.setView(parsed.center, parsed.zoom);

				this.movingMap = false;
			} else {
				this.onMapMove(this.map);
			}
		},

		// defer hash change updates every 100ms
		changeDefer: 100,
		changeTimeout: null,
		onHashChange: function() {
			// throttle calls to update() so that they only happen every
			// `changeDefer` ms
			if (!this.changeTimeout) {
				var that = this;
				this.changeTimeout = setTimeout(function() {
					that.update();
					that.changeTimeout = null;
				}, this.changeDefer);
			}
		},

		isListening: false,
		hashChangeInterval: null,
		startListening: function() {
			this.map.on("moveend", this.onMapMove, this);

			if (HAS_HASHCHANGE) {
				L.DomEvent.addListener(window, "hashchange", this.onHashChange);
			} else {
				clearInterval(this.hashChangeInterval);
				this.hashChangeInterval = setInterval(this.onHashChange, 50);
			}
			this.isListening = true;
		},

		stopListening: function() {
			this.map.off("moveend", this.onMapMove, this);

			if (HAS_HASHCHANGE) {
				L.DomEvent.removeListener(window, "hashchange", this.onHashChange);
			} else {
				clearInterval(this.hashChangeInterval);
			}
			this.isListening = false;
		}
	};
	L.hash = function(map) {
		return new L.Hash(map);
	};
	L.Map.prototype.addHash = function() {
		this._hash = L.hash(this);
	};
	L.Map.prototype.removeHash = function() {
		this._hash.removeFrom();
	};
})(window);

},{}],17:[function(require,module,exports){
var sphereKnn = require('sphere-knn');

module.exports = function(layer) {
    'use strict';

    if (!(layer instanceof L.GeoJSON)) throw new Error('must be L.GeoJSON');

    var points = [];

    layer.eachLayer(collectPoints);

    function collectPoints(l) {
        points = points.concat(reformat(flat(l.feature.geometry.coordinates), l));
    }

    var sknn = sphereKnn(points);

    sknn.nearest = function(p, n, max_distance) {
        if (p instanceof L.LatLng) p = [p.lng, p.lat];
        return sknn(p[1], p[0], n, max_distance);
    };

    sknn.nearestLayer = function(p, n, max_distance) {
        if (p instanceof L.LatLng) p = [p.lng, p.lat];
        return collapse(sknn(p[1], p[0], n, max_distance));
    };

    return sknn;
};

function collapse(results) {
    var l = [], included = {};
    for (var i = 0; i < results.length; i++) {
        if (included[L.stamp(results[i].layer)] == undefined) {
            l.push(results[i]);
            included[L.stamp(results[i].layer)] = true;
        }
    }
    return l;
}

function reformat(coords, layer) {
    var l = [];
    for (var i = 0; i < coords.length; i++) {
        l.push({ lon: coords[i][0], lat: coords[i][1], layer: layer });
    }
    return l;
}

function flat(coords) {
    var i = 0, j = 0, k = 0, l = [];
    if (typeof coords[0] === 'object' &&
        typeof coords[0][0] === 'object' &&
        typeof coords[0][0][0] === 'object') {
        for (;i < coords.length; i++) {
            for (;j < coords[i].length; j++) {
                for (;k < coords[i][j].length; k++) l.push(coords[i][j][k]);
            }
        }
        return l;
    } else if (typeof coords[0] === 'object' &&
        typeof coords[0][0] === 'object') {
        for (;i < coords.length; i++) {
            for (;j < coords[i].length; j++) l.push(coords[i][j]);
        }
        return l;
    } else if (typeof coords[0] === 'object') {
        return coords;
    } else {
        return [coords];
    }
}

},{"sphere-knn":18}],18:[function(require,module,exports){
var spherekd = require("./lib/spherekd")

module.exports = function(points) {
  /* Inflate the toad! */
  var root = spherekd.build(points)

  /* Lurch off into the sunset! */
  return function(lat, lon, n, max) {
    return spherekd.lookup(lat, lon, root, n, max)
  }
}

},{"./lib/spherekd":21}],19:[function(require,module,exports){
function defaultComparator(a, b) {
  return a - b
}

exports.search = function(item, array, comparator) {
  if(!comparator)
    comparator = defaultComparator

  var low  = 0,
      high = array.length - 1,
      mid, comp

  while(low <= high) {
    mid  = (low + high) >>> 1
    comp = comparator(array[mid], item)

    if(comp < 0)
      low = mid + 1

    else if(comp > 0)
      high = mid - 1

    else
      return mid
  }

  return -(low + 1)
}

exports.insert = function(item, array, comparator) {
  var i = exports.search(item, array, comparator)

  if(i < 0)
    i = -(i + 1)

  array.splice(i, 0, item)
}

},{}],20:[function(require,module,exports){
var binary = require("./binary")

function Node(axis, split, left, right) {
  this.axis  = axis
  this.split = split
  this.left  = left
  this.right = right
}

function distance(a, b) {
  var i = Math.min(a.length, b.length),
      d = 0,
      k

  while(i--) {
    k  = b[i] - a[i]
    d += k * k
  }

  return d
}

function byDistance(a, b) {
  return a.dist - b.dist
}

function buildrec(array, depth) {
  /* This should only happen if you request a kd-tree with zero elements. */
  if(array.length === 0)
    return null

  /* If there's only one item, then it's a leaf node! */
  if(array.length === 1)
    return array[0]

  /* Uh oh. Well, we have to partition the data set and recurse. Start by
   * finding the bounding box of the given points; whichever side is the
   * longest is the one we'll use for the splitting plane. */
  var axis = depth % array[0].position.length

  /* Sort the points along the splitting plane. */
  /* FIXME: For very large trees, it would be faster to use some sort of median
   * finding and partitioning algorithm. It'd also be a lot more complicated. */
  array.sort(function(a, b) {
    return a.position[axis] - b.position[axis]
  })

  /* Find the median point. It's position is going to be the location of the
   * splitting plane. */
  var i = Math.floor(array.length * 0.5)

  /* Split, recurse, yadda yadda. */
  ++depth

  return new Node(
    axis,
    array[i].position[axis],
    buildrec(array.slice(0, i), depth),
    buildrec(array.slice(i   ), depth)
  )
}

function build(array) {
  return buildrec(array, 0)
}

function lookup(position, node, n, max) {
  if(!(max > 0))
    max = Number.POSITIVE_INFINITY

  var array = []

  /* Degenerate cases. */
  if(node === null || n <= 0)
    return array

  var stack = [node, 0],
      dist, i

  while(stack.length) {
    dist = stack.pop()
    node = stack.pop()

    /* If this subtree is further away than we care about, then skip it. */
    if(dist > max)
      continue

    /* If we've already found enough locations, and the furthest one is closer
     * than this subtree possibly could be, just skip the subtree. */
    if(array.length === n && array[array.length - 1].dist < dist * dist)
      continue

    /* Iterate all the way down the tree, adding nodes that we need to remember
     * to visit later onto the stack. */
    while(node instanceof Node) {
      if(position[node.axis] < node.split) {
        stack.push(node.right, node.split - position[node.axis])
        node = node.left
      }

      else {
        stack.push(node.left, position[node.axis] - node.split)
        node = node.right
      }
    }

    /* Once we've hit a leaf node, insert it into the array of candidates,
     * making sure to keep the array in sorted order. */
    dist = distance(position, node.position)
    if(dist <= max * max)
      binary.insert({object: node, dist: dist}, array, byDistance)

    /* If the array's too long, cull it. */
    if(array.length > n)
      array.pop()
  }

  /* Strip candidate wrapper objects. */
  i = array.length

  while(i--)
    array[i] = array[i].object

  return array
}

exports.build  = build
exports.lookup = lookup

},{"./binary":19}],21:[function(require,module,exports){
var kd               = require("./kd"),
    rad              = Math.PI / 180,
    invEarthDiameter = 1 / 12742018 /* meters */

function spherical2cartesian(lat, lon) {
  lat *= rad
  lon *= rad
  var cos = Math.cos(lat)
  return [cos * Math.cos(lon), Math.sin(lat), cos * Math.sin(lon)]
}

function Position(object) {
  var lat, lon;

  /* Find latitude. */
  if(object.hasOwnProperty("lat"))
    lat = object.lat;

  else if(object.hasOwnProperty("latitude"))
    lat = object.latitude;

  else if(object.hasOwnProperty("location") &&
          Array.isArray(object.location) &&
          object.location.length === 2)
    lat = object.location[0];

  /* Find longitude. */
  if(object.hasOwnProperty("lon"))
    lon = object.lon;

  else if(object.hasOwnProperty("longitude"))
    lon = object.longitude;

  else if(object.hasOwnProperty("lng"))
    lon = object.lng;

  else if(object.hasOwnProperty("long"))
    lon = object.long;

  else if(object.hasOwnProperty("location") &&
          Array.isArray(object.location) &&
          object.location.length === 2)
    lon = object.location[1];

  /* Finally, set this object's properties. */
  this.object = object;
  this.position = spherical2cartesian(lat, lon);
}

function build(array) {
  var i   = array.length,
      out = new Array(i)

  while(i--)
    out[i] = new Position(array[i])

  return kd.build(out)
}

function lookup(lat, lon, node, n, max) {
  var array = kd.lookup(
        spherical2cartesian(lat, lon),
        node,
        n,
        max > 0 ? 2 * Math.sin(max * invEarthDiameter) : undefined
      ),
      i     = array.length

  /* Strip off position wrapper objects. */
  while(i--)
    array[i] = array[i].object

  return array
}

exports.build  = build
exports.lookup = lookup

},{"./kd":20}],22:[function(require,module,exports){
/*
 Leaflet, a JavaScript library for mobile-friendly interactive maps. http://leafletjs.com
 (c) 2010-2013, Vladimir Agafonkin
 (c) 2010-2011, CloudMade
*/
(function (window, document, undefined) {
var oldL = window.L,
    L = {};

L.version = '0.7.5';

// define Leaflet for Node module pattern loaders, including Browserify
if (typeof module === 'object' && typeof module.exports === 'object') {
	module.exports = L;

// define Leaflet as an AMD module
} else if (typeof define === 'function' && define.amd) {
	define(L);
}

// define Leaflet as a global L variable, saving the original L to restore later if needed

L.noConflict = function () {
	window.L = oldL;
	return this;
};

window.L = L;


/*
 * L.Util contains various utility functions used throughout Leaflet code.
 */

L.Util = {
	extend: function (dest) { // (Object[, Object, ...]) ->
		var sources = Array.prototype.slice.call(arguments, 1),
		    i, j, len, src;

		for (j = 0, len = sources.length; j < len; j++) {
			src = sources[j] || {};
			for (i in src) {
				if (src.hasOwnProperty(i)) {
					dest[i] = src[i];
				}
			}
		}
		return dest;
	},

	bind: function (fn, obj) { // (Function, Object) -> Function
		var args = arguments.length > 2 ? Array.prototype.slice.call(arguments, 2) : null;
		return function () {
			return fn.apply(obj, args || arguments);
		};
	},

	stamp: (function () {
		var lastId = 0,
		    key = '_leaflet_id';
		return function (obj) {
			obj[key] = obj[key] || ++lastId;
			return obj[key];
		};
	}()),

	invokeEach: function (obj, method, context) {
		var i, args;

		if (typeof obj === 'object') {
			args = Array.prototype.slice.call(arguments, 3);

			for (i in obj) {
				method.apply(context, [i, obj[i]].concat(args));
			}
			return true;
		}

		return false;
	},

	limitExecByInterval: function (fn, time, context) {
		var lock, execOnUnlock;

		return function wrapperFn() {
			var args = arguments;

			if (lock) {
				execOnUnlock = true;
				return;
			}

			lock = true;

			setTimeout(function () {
				lock = false;

				if (execOnUnlock) {
					wrapperFn.apply(context, args);
					execOnUnlock = false;
				}
			}, time);

			fn.apply(context, args);
		};
	},

	falseFn: function () {
		return false;
	},

	formatNum: function (num, digits) {
		var pow = Math.pow(10, digits || 5);
		return Math.round(num * pow) / pow;
	},

	trim: function (str) {
		return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g, '');
	},

	splitWords: function (str) {
		return L.Util.trim(str).split(/\s+/);
	},

	setOptions: function (obj, options) {
		obj.options = L.extend({}, obj.options, options);
		return obj.options;
	},

	getParamString: function (obj, existingUrl, uppercase) {
		var params = [];
		for (var i in obj) {
			params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));
		}
		return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');
	},
	template: function (str, data) {
		return str.replace(/\{ *([\w_]+) *\}/g, function (str, key) {
			var value = data[key];
			if (value === undefined) {
				throw new Error('No value provided for variable ' + str);
			} else if (typeof value === 'function') {
				value = value(data);
			}
			return value;
		});
	},

	isArray: Array.isArray || function (obj) {
		return (Object.prototype.toString.call(obj) === '[object Array]');
	},

	emptyImageUrl: 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='
};

(function () {

	// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/

	function getPrefixed(name) {
		var i, fn,
		    prefixes = ['webkit', 'moz', 'o', 'ms'];

		for (i = 0; i < prefixes.length && !fn; i++) {
			fn = window[prefixes[i] + name];
		}

		return fn;
	}

	var lastTime = 0;

	function timeoutDefer(fn) {
		var time = +new Date(),
		    timeToCall = Math.max(0, 16 - (time - lastTime));

		lastTime = time + timeToCall;
		return window.setTimeout(fn, timeToCall);
	}

	var requestFn = window.requestAnimationFrame ||
	        getPrefixed('RequestAnimationFrame') || timeoutDefer;

	var cancelFn = window.cancelAnimationFrame ||
	        getPrefixed('CancelAnimationFrame') ||
	        getPrefixed('CancelRequestAnimationFrame') ||
	        function (id) { window.clearTimeout(id); };


	L.Util.requestAnimFrame = function (fn, context, immediate, element) {
		fn = L.bind(fn, context);

		if (immediate && requestFn === timeoutDefer) {
			fn();
		} else {
			return requestFn.call(window, fn, element);
		}
	};

	L.Util.cancelAnimFrame = function (id) {
		if (id) {
			cancelFn.call(window, id);
		}
	};

}());

// shortcuts for most used utility functions
L.extend = L.Util.extend;
L.bind = L.Util.bind;
L.stamp = L.Util.stamp;
L.setOptions = L.Util.setOptions;


/*
 * L.Class powers the OOP facilities of the library.
 * Thanks to John Resig and Dean Edwards for inspiration!
 */

L.Class = function () {};

L.Class.extend = function (props) {

	// extended class with the new prototype
	var NewClass = function () {

		// call the constructor
		if (this.initialize) {
			this.initialize.apply(this, arguments);
		}

		// call all constructor hooks
		if (this._initHooks) {
			this.callInitHooks();
		}
	};

	// instantiate class without calling constructor
	var F = function () {};
	F.prototype = this.prototype;

	var proto = new F();
	proto.constructor = NewClass;

	NewClass.prototype = proto;

	//inherit parent's statics
	for (var i in this) {
		if (this.hasOwnProperty(i) && i !== 'prototype') {
			NewClass[i] = this[i];
		}
	}

	// mix static properties into the class
	if (props.statics) {
		L.extend(NewClass, props.statics);
		delete props.statics;
	}

	// mix includes into the prototype
	if (props.includes) {
		L.Util.extend.apply(null, [proto].concat(props.includes));
		delete props.includes;
	}

	// merge options
	if (props.options && proto.options) {
		props.options = L.extend({}, proto.options, props.options);
	}

	// mix given properties into the prototype
	L.extend(proto, props);

	proto._initHooks = [];

	var parent = this;
	// jshint camelcase: false
	NewClass.__super__ = parent.prototype;

	// add method for calling all hooks
	proto.callInitHooks = function () {

		if (this._initHooksCalled) { return; }

		if (parent.prototype.callInitHooks) {
			parent.prototype.callInitHooks.call(this);
		}

		this._initHooksCalled = true;

		for (var i = 0, len = proto._initHooks.length; i < len; i++) {
			proto._initHooks[i].call(this);
		}
	};

	return NewClass;
};


// method for adding properties to prototype
L.Class.include = function (props) {
	L.extend(this.prototype, props);
};

// merge new default options to the Class
L.Class.mergeOptions = function (options) {
	L.extend(this.prototype.options, options);
};

// add a constructor hook
L.Class.addInitHook = function (fn) { // (Function) || (String, args...)
	var args = Array.prototype.slice.call(arguments, 1);

	var init = typeof fn === 'function' ? fn : function () {
		this[fn].apply(this, args);
	};

	this.prototype._initHooks = this.prototype._initHooks || [];
	this.prototype._initHooks.push(init);
};


/*
 * L.Mixin.Events is used to add custom events functionality to Leaflet classes.
 */

var eventsKey = '_leaflet_events';

L.Mixin = {};

L.Mixin.Events = {

	addEventListener: function (types, fn, context) { // (String, Function[, Object]) or (Object[, Object])

		// types can be a map of types/handlers
		if (L.Util.invokeEach(types, this.addEventListener, this, fn, context)) { return this; }

		var events = this[eventsKey] = this[eventsKey] || {},
		    contextId = context && context !== this && L.stamp(context),
		    i, len, event, type, indexKey, indexLenKey, typeIndex;

		// types can be a string of space-separated words
		types = L.Util.splitWords(types);

		for (i = 0, len = types.length; i < len; i++) {
			event = {
				action: fn,
				context: context || this
			};
			type = types[i];

			if (contextId) {
				// store listeners of a particular context in a separate hash (if it has an id)
				// gives a major performance boost when removing thousands of map layers

				indexKey = type + '_idx';
				indexLenKey = indexKey + '_len';

				typeIndex = events[indexKey] = events[indexKey] || {};

				if (!typeIndex[contextId]) {
					typeIndex[contextId] = [];

					// keep track of the number of keys in the index to quickly check if it's empty
					events[indexLenKey] = (events[indexLenKey] || 0) + 1;
				}

				typeIndex[contextId].push(event);


			} else {
				events[type] = events[type] || [];
				events[type].push(event);
			}
		}

		return this;
	},

	hasEventListeners: function (type) { // (String) -> Boolean
		var events = this[eventsKey];
		return !!events && ((type in events && events[type].length > 0) ||
		                    (type + '_idx' in events && events[type + '_idx_len'] > 0));
	},

	removeEventListener: function (types, fn, context) { // ([String, Function, Object]) or (Object[, Object])

		if (!this[eventsKey]) {
			return this;
		}

		if (!types) {
			return this.clearAllEventListeners();
		}

		if (L.Util.invokeEach(types, this.removeEventListener, this, fn, context)) { return this; }

		var events = this[eventsKey],
		    contextId = context && context !== this && L.stamp(context),
		    i, len, type, listeners, j, indexKey, indexLenKey, typeIndex, removed;

		types = L.Util.splitWords(types);

		for (i = 0, len = types.length; i < len; i++) {
			type = types[i];
			indexKey = type + '_idx';
			indexLenKey = indexKey + '_len';

			typeIndex = events[indexKey];

			if (!fn) {
				// clear all listeners for a type if function isn't specified
				delete events[type];
				delete events[indexKey];
				delete events[indexLenKey];

			} else {
				listeners = contextId && typeIndex ? typeIndex[contextId] : events[type];

				if (listeners) {
					for (j = listeners.length - 1; j >= 0; j--) {
						if ((listeners[j].action === fn) && (!context || (listeners[j].context === context))) {
							removed = listeners.splice(j, 1);
							// set the old action to a no-op, because it is possible
							// that the listener is being iterated over as part of a dispatch
							removed[0].action = L.Util.falseFn;
						}
					}

					if (context && typeIndex && (listeners.length === 0)) {
						delete typeIndex[contextId];
						events[indexLenKey]--;
					}
				}
			}
		}

		return this;
	},

	clearAllEventListeners: function () {
		delete this[eventsKey];
		return this;
	},

	fireEvent: function (type, data) { // (String[, Object])
		if (!this.hasEventListeners(type)) {
			return this;
		}

		var event = L.Util.extend({}, data, { type: type, target: this });

		var events = this[eventsKey],
		    listeners, i, len, typeIndex, contextId;

		if (events[type]) {
			// make sure adding/removing listeners inside other listeners won't cause infinite loop
			listeners = events[type].slice();

			for (i = 0, len = listeners.length; i < len; i++) {
				listeners[i].action.call(listeners[i].context, event);
			}
		}

		// fire event for the context-indexed listeners as well
		typeIndex = events[type + '_idx'];

		for (contextId in typeIndex) {
			listeners = typeIndex[contextId].slice();

			if (listeners) {
				for (i = 0, len = listeners.length; i < len; i++) {
					listeners[i].action.call(listeners[i].context, event);
				}
			}
		}

		return this;
	},

	addOneTimeEventListener: function (types, fn, context) {

		if (L.Util.invokeEach(types, this.addOneTimeEventListener, this, fn, context)) { return this; }

		var handler = L.bind(function () {
			this
			    .removeEventListener(types, fn, context)
			    .removeEventListener(types, handler, context);
		}, this);

		return this
		    .addEventListener(types, fn, context)
		    .addEventListener(types, handler, context);
	}
};

L.Mixin.Events.on = L.Mixin.Events.addEventListener;
L.Mixin.Events.off = L.Mixin.Events.removeEventListener;
L.Mixin.Events.once = L.Mixin.Events.addOneTimeEventListener;
L.Mixin.Events.fire = L.Mixin.Events.fireEvent;


/*
 * L.Browser handles different browser and feature detections for internal Leaflet use.
 */

(function () {

	var ie = 'ActiveXObject' in window,
		ielt9 = ie && !document.addEventListener,

	    // terrible browser detection to work around Safari / iOS / Android browser bugs
	    ua = navigator.userAgent.toLowerCase(),
	    webkit = ua.indexOf('webkit') !== -1,
	    chrome = ua.indexOf('chrome') !== -1,
	    phantomjs = ua.indexOf('phantom') !== -1,
	    android = ua.indexOf('android') !== -1,
	    android23 = ua.search('android [23]') !== -1,
		gecko = ua.indexOf('gecko') !== -1,

	    mobile = typeof orientation !== undefined + '',
	    msPointer = !window.PointerEvent && window.MSPointerEvent,
		pointer = (window.PointerEvent && window.navigator.pointerEnabled && window.navigator.maxTouchPoints) ||
				  msPointer,
	    retina = ('devicePixelRatio' in window && window.devicePixelRatio > 1) ||
	             ('matchMedia' in window && window.matchMedia('(min-resolution:144dpi)') &&
	              window.matchMedia('(min-resolution:144dpi)').matches),

	    doc = document.documentElement,
	    ie3d = ie && ('transition' in doc.style),
	    webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23,
	    gecko3d = 'MozPerspective' in doc.style,
	    opera3d = 'OTransition' in doc.style,
	    any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d || opera3d) && !phantomjs;

	var touch = !window.L_NO_TOUCH && !phantomjs && (pointer || 'ontouchstart' in window ||
		(window.DocumentTouch && document instanceof window.DocumentTouch));

	L.Browser = {
		ie: ie,
		ielt9: ielt9,
		webkit: webkit,
		gecko: gecko && !webkit && !window.opera && !ie,

		android: android,
		android23: android23,

		chrome: chrome,

		ie3d: ie3d,
		webkit3d: webkit3d,
		gecko3d: gecko3d,
		opera3d: opera3d,
		any3d: any3d,

		mobile: mobile,
		mobileWebkit: mobile && webkit,
		mobileWebkit3d: mobile && webkit3d,
		mobileOpera: mobile && window.opera,

		touch: touch,
		msPointer: msPointer,
		pointer: pointer,

		retina: retina
	};

}());


/*
 * L.Point represents a point with x and y coordinates.
 */

L.Point = function (/*Number*/ x, /*Number*/ y, /*Boolean*/ round) {
	this.x = (round ? Math.round(x) : x);
	this.y = (round ? Math.round(y) : y);
};

L.Point.prototype = {

	clone: function () {
		return new L.Point(this.x, this.y);
	},

	// non-destructive, returns a new point
	add: function (point) {
		return this.clone()._add(L.point(point));
	},

	// destructive, used directly for performance in situations where it's safe to modify existing point
	_add: function (point) {
		this.x += point.x;
		this.y += point.y;
		return this;
	},

	subtract: function (point) {
		return this.clone()._subtract(L.point(point));
	},

	_subtract: function (point) {
		this.x -= point.x;
		this.y -= point.y;
		return this;
	},

	divideBy: function (num) {
		return this.clone()._divideBy(num);
	},

	_divideBy: function (num) {
		this.x /= num;
		this.y /= num;
		return this;
	},

	multiplyBy: function (num) {
		return this.clone()._multiplyBy(num);
	},

	_multiplyBy: function (num) {
		this.x *= num;
		this.y *= num;
		return this;
	},

	round: function () {
		return this.clone()._round();
	},

	_round: function () {
		this.x = Math.round(this.x);
		this.y = Math.round(this.y);
		return this;
	},

	floor: function () {
		return this.clone()._floor();
	},

	_floor: function () {
		this.x = Math.floor(this.x);
		this.y = Math.floor(this.y);
		return this;
	},

	distanceTo: function (point) {
		point = L.point(point);

		var x = point.x - this.x,
		    y = point.y - this.y;

		return Math.sqrt(x * x + y * y);
	},

	equals: function (point) {
		point = L.point(point);

		return point.x === this.x &&
		       point.y === this.y;
	},

	contains: function (point) {
		point = L.point(point);

		return Math.abs(point.x) <= Math.abs(this.x) &&
		       Math.abs(point.y) <= Math.abs(this.y);
	},

	toString: function () {
		return 'Point(' +
		        L.Util.formatNum(this.x) + ', ' +
		        L.Util.formatNum(this.y) + ')';
	}
};

L.point = function (x, y, round) {
	if (x instanceof L.Point) {
		return x;
	}
	if (L.Util.isArray(x)) {
		return new L.Point(x[0], x[1]);
	}
	if (x === undefined || x === null) {
		return x;
	}
	return new L.Point(x, y, round);
};


/*
 * L.Bounds represents a rectangular area on the screen in pixel coordinates.
 */

L.Bounds = function (a, b) { //(Point, Point) or Point[]
	if (!a) { return; }

	var points = b ? [a, b] : a;

	for (var i = 0, len = points.length; i < len; i++) {
		this.extend(points[i]);
	}
};

L.Bounds.prototype = {
	// extend the bounds to contain the given point
	extend: function (point) { // (Point)
		point = L.point(point);

		if (!this.min && !this.max) {
			this.min = point.clone();
			this.max = point.clone();
		} else {
			this.min.x = Math.min(point.x, this.min.x);
			this.max.x = Math.max(point.x, this.max.x);
			this.min.y = Math.min(point.y, this.min.y);
			this.max.y = Math.max(point.y, this.max.y);
		}
		return this;
	},

	getCenter: function (round) { // (Boolean) -> Point
		return new L.Point(
		        (this.min.x + this.max.x) / 2,
		        (this.min.y + this.max.y) / 2, round);
	},

	getBottomLeft: function () { // -> Point
		return new L.Point(this.min.x, this.max.y);
	},

	getTopRight: function () { // -> Point
		return new L.Point(this.max.x, this.min.y);
	},

	getSize: function () {
		return this.max.subtract(this.min);
	},

	contains: function (obj) { // (Bounds) or (Point) -> Boolean
		var min, max;

		if (typeof obj[0] === 'number' || obj instanceof L.Point) {
			obj = L.point(obj);
		} else {
			obj = L.bounds(obj);
		}

		if (obj instanceof L.Bounds) {
			min = obj.min;
			max = obj.max;
		} else {
			min = max = obj;
		}

		return (min.x >= this.min.x) &&
		       (max.x <= this.max.x) &&
		       (min.y >= this.min.y) &&
		       (max.y <= this.max.y);
	},

	intersects: function (bounds) { // (Bounds) -> Boolean
		bounds = L.bounds(bounds);

		var min = this.min,
		    max = this.max,
		    min2 = bounds.min,
		    max2 = bounds.max,
		    xIntersects = (max2.x >= min.x) && (min2.x <= max.x),
		    yIntersects = (max2.y >= min.y) && (min2.y <= max.y);

		return xIntersects && yIntersects;
	},

	isValid: function () {
		return !!(this.min && this.max);
	}
};

L.bounds = function (a, b) { // (Bounds) or (Point, Point) or (Point[])
	if (!a || a instanceof L.Bounds) {
		return a;
	}
	return new L.Bounds(a, b);
};


/*
 * L.Transformation is an utility class to perform simple point transformations through a 2d-matrix.
 */

L.Transformation = function (a, b, c, d) {
	this._a = a;
	this._b = b;
	this._c = c;
	this._d = d;
};

L.Transformation.prototype = {
	transform: function (point, scale) { // (Point, Number) -> Point
		return this._transform(point.clone(), scale);
	},

	// destructive transform (faster)
	_transform: function (point, scale) {
		scale = scale || 1;
		point.x = scale * (this._a * point.x + this._b);
		point.y = scale * (this._c * point.y + this._d);
		return point;
	},

	untransform: function (point, scale) {
		scale = scale || 1;
		return new L.Point(
		        (point.x / scale - this._b) / this._a,
		        (point.y / scale - this._d) / this._c);
	}
};


/*
 * L.DomUtil contains various utility functions for working with DOM.
 */

L.DomUtil = {
	get: function (id) {
		return (typeof id === 'string' ? document.getElementById(id) : id);
	},

	getStyle: function (el, style) {

		var value = el.style[style];

		if (!value && el.currentStyle) {
			value = el.currentStyle[style];
		}

		if ((!value || value === 'auto') && document.defaultView) {
			var css = document.defaultView.getComputedStyle(el, null);
			value = css ? css[style] : null;
		}

		return value === 'auto' ? null : value;
	},

	getViewportOffset: function (element) {

		var top = 0,
		    left = 0,
		    el = element,
		    docBody = document.body,
		    docEl = document.documentElement,
		    pos;

		do {
			top  += el.offsetTop  || 0;
			left += el.offsetLeft || 0;

			//add borders
			top += parseInt(L.DomUtil.getStyle(el, 'borderTopWidth'), 10) || 0;
			left += parseInt(L.DomUtil.getStyle(el, 'borderLeftWidth'), 10) || 0;

			pos = L.DomUtil.getStyle(el, 'position');

			if (el.offsetParent === docBody && pos === 'absolute') { break; }

			if (pos === 'fixed') {
				top  += docBody.scrollTop  || docEl.scrollTop  || 0;
				left += docBody.scrollLeft || docEl.scrollLeft || 0;
				break;
			}

			if (pos === 'relative' && !el.offsetLeft) {
				var width = L.DomUtil.getStyle(el, 'width'),
				    maxWidth = L.DomUtil.getStyle(el, 'max-width'),
				    r = el.getBoundingClientRect();

				if (width !== 'none' || maxWidth !== 'none') {
					left += r.left + el.clientLeft;
				}

				//calculate full y offset since we're breaking out of the loop
				top += r.top + (docBody.scrollTop  || docEl.scrollTop  || 0);

				break;
			}

			el = el.offsetParent;

		} while (el);

		el = element;

		do {
			if (el === docBody) { break; }

			top  -= el.scrollTop  || 0;
			left -= el.scrollLeft || 0;

			el = el.parentNode;
		} while (el);

		return new L.Point(left, top);
	},

	documentIsLtr: function () {
		if (!L.DomUtil._docIsLtrCached) {
			L.DomUtil._docIsLtrCached = true;
			L.DomUtil._docIsLtr = L.DomUtil.getStyle(document.body, 'direction') === 'ltr';
		}
		return L.DomUtil._docIsLtr;
	},

	create: function (tagName, className, container) {

		var el = document.createElement(tagName);
		el.className = className;

		if (container) {
			container.appendChild(el);
		}

		return el;
	},

	hasClass: function (el, name) {
		if (el.classList !== undefined) {
			return el.classList.contains(name);
		}
		var className = L.DomUtil._getClass(el);
		return className.length > 0 && new RegExp('(^|\\s)' + name + '(\\s|$)').test(className);
	},

	addClass: function (el, name) {
		if (el.classList !== undefined) {
			var classes = L.Util.splitWords(name);
			for (var i = 0, len = classes.length; i < len; i++) {
				el.classList.add(classes[i]);
			}
		} else if (!L.DomUtil.hasClass(el, name)) {
			var className = L.DomUtil._getClass(el);
			L.DomUtil._setClass(el, (className ? className + ' ' : '') + name);
		}
	},

	removeClass: function (el, name) {
		if (el.classList !== undefined) {
			el.classList.remove(name);
		} else {
			L.DomUtil._setClass(el, L.Util.trim((' ' + L.DomUtil._getClass(el) + ' ').replace(' ' + name + ' ', ' ')));
		}
	},

	_setClass: function (el, name) {
		if (el.className.baseVal === undefined) {
			el.className = name;
		} else {
			// in case of SVG element
			el.className.baseVal = name;
		}
	},

	_getClass: function (el) {
		return el.className.baseVal === undefined ? el.className : el.className.baseVal;
	},

	setOpacity: function (el, value) {

		if ('opacity' in el.style) {
			el.style.opacity = value;

		} else if ('filter' in el.style) {

			var filter = false,
			    filterName = 'DXImageTransform.Microsoft.Alpha';

			// filters collection throws an error if we try to retrieve a filter that doesn't exist
			try {
				filter = el.filters.item(filterName);
			} catch (e) {
				// don't set opacity to 1 if we haven't already set an opacity,
				// it isn't needed and breaks transparent pngs.
				if (value === 1) { return; }
			}

			value = Math.round(value * 100);

			if (filter) {
				filter.Enabled = (value !== 100);
				filter.Opacity = value;
			} else {
				el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';
			}
		}
	},

	testProp: function (props) {

		var style = document.documentElement.style;

		for (var i = 0; i < props.length; i++) {
			if (props[i] in style) {
				return props[i];
			}
		}
		return false;
	},

	getTranslateString: function (point) {
		// on WebKit browsers (Chrome/Safari/iOS Safari/Android) using translate3d instead of translate
		// makes animation smoother as it ensures HW accel is used. Firefox 13 doesn't care
		// (same speed either way), Opera 12 doesn't support translate3d

		var is3d = L.Browser.webkit3d,
		    open = 'translate' + (is3d ? '3d' : '') + '(',
		    close = (is3d ? ',0' : '') + ')';

		return open + point.x + 'px,' + point.y + 'px' + close;
	},

	getScaleString: function (scale, origin) {

		var preTranslateStr = L.DomUtil.getTranslateString(origin.add(origin.multiplyBy(-1 * scale))),
		    scaleStr = ' scale(' + scale + ') ';

		return preTranslateStr + scaleStr;
	},

	setPosition: function (el, point, disable3D) { // (HTMLElement, Point[, Boolean])

		// jshint camelcase: false
		el._leaflet_pos = point;

		if (!disable3D && L.Browser.any3d) {
			el.style[L.DomUtil.TRANSFORM] =  L.DomUtil.getTranslateString(point);
		} else {
			el.style.left = point.x + 'px';
			el.style.top = point.y + 'px';
		}
	},

	getPosition: function (el) {
		// this method is only used for elements previously positioned using setPosition,
		// so it's safe to cache the position for performance

		// jshint camelcase: false
		return el._leaflet_pos;
	}
};


// prefix style property names

L.DomUtil.TRANSFORM = L.DomUtil.testProp(
        ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);

// webkitTransition comes first because some browser versions that drop vendor prefix don't do
// the same for the transitionend event, in particular the Android 4.1 stock browser

L.DomUtil.TRANSITION = L.DomUtil.testProp(
        ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);

L.DomUtil.TRANSITION_END =
        L.DomUtil.TRANSITION === 'webkitTransition' || L.DomUtil.TRANSITION === 'OTransition' ?
        L.DomUtil.TRANSITION + 'End' : 'transitionend';

(function () {
    if ('onselectstart' in document) {
        L.extend(L.DomUtil, {
            disableTextSelection: function () {
                L.DomEvent.on(window, 'selectstart', L.DomEvent.preventDefault);
            },

            enableTextSelection: function () {
                L.DomEvent.off(window, 'selectstart', L.DomEvent.preventDefault);
            }
        });
    } else {
        var userSelectProperty = L.DomUtil.testProp(
            ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);

        L.extend(L.DomUtil, {
            disableTextSelection: function () {
                if (userSelectProperty) {
                    var style = document.documentElement.style;
                    this._userSelect = style[userSelectProperty];
                    style[userSelectProperty] = 'none';
                }
            },

            enableTextSelection: function () {
                if (userSelectProperty) {
                    document.documentElement.style[userSelectProperty] = this._userSelect;
                    delete this._userSelect;
                }
            }
        });
    }

	L.extend(L.DomUtil, {
		disableImageDrag: function () {
			L.DomEvent.on(window, 'dragstart', L.DomEvent.preventDefault);
		},

		enableImageDrag: function () {
			L.DomEvent.off(window, 'dragstart', L.DomEvent.preventDefault);
		}
	});
})();


/*
 * L.LatLng represents a geographical point with latitude and longitude coordinates.
 */

L.LatLng = function (lat, lng, alt) { // (Number, Number, Number)
	lat = parseFloat(lat);
	lng = parseFloat(lng);

	if (isNaN(lat) || isNaN(lng)) {
		throw new Error('Invalid LatLng object: (' + lat + ', ' + lng + ')');
	}

	this.lat = lat;
	this.lng = lng;

	if (alt !== undefined) {
		this.alt = parseFloat(alt);
	}
};

L.extend(L.LatLng, {
	DEG_TO_RAD: Math.PI / 180,
	RAD_TO_DEG: 180 / Math.PI,
	MAX_MARGIN: 1.0E-9 // max margin of error for the "equals" check
});

L.LatLng.prototype = {
	equals: function (obj) { // (LatLng) -> Boolean
		if (!obj) { return false; }

		obj = L.latLng(obj);

		var margin = Math.max(
		        Math.abs(this.lat - obj.lat),
		        Math.abs(this.lng - obj.lng));

		return margin <= L.LatLng.MAX_MARGIN;
	},

	toString: function (precision) { // (Number) -> String
		return 'LatLng(' +
		        L.Util.formatNum(this.lat, precision) + ', ' +
		        L.Util.formatNum(this.lng, precision) + ')';
	},

	// Haversine distance formula, see http://en.wikipedia.org/wiki/Haversine_formula
	// TODO move to projection code, LatLng shouldn't know about Earth
	distanceTo: function (other) { // (LatLng) -> Number
		other = L.latLng(other);

		var R = 6378137, // earth radius in meters
		    d2r = L.LatLng.DEG_TO_RAD,
		    dLat = (other.lat - this.lat) * d2r,
		    dLon = (other.lng - this.lng) * d2r,
		    lat1 = this.lat * d2r,
		    lat2 = other.lat * d2r,
		    sin1 = Math.sin(dLat / 2),
		    sin2 = Math.sin(dLon / 2);

		var a = sin1 * sin1 + sin2 * sin2 * Math.cos(lat1) * Math.cos(lat2);

		return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
	},

	wrap: function (a, b) { // (Number, Number) -> LatLng
		var lng = this.lng;

		a = a || -180;
		b = b ||  180;

		lng = (lng + b) % (b - a) + (lng < a || lng === b ? b : a);

		return new L.LatLng(this.lat, lng);
	}
};

L.latLng = function (a, b) { // (LatLng) or ([Number, Number]) or (Number, Number)
	if (a instanceof L.LatLng) {
		return a;
	}
	if (L.Util.isArray(a)) {
		if (typeof a[0] === 'number' || typeof a[0] === 'string') {
			return new L.LatLng(a[0], a[1], a[2]);
		} else {
			return null;
		}
	}
	if (a === undefined || a === null) {
		return a;
	}
	if (typeof a === 'object' && 'lat' in a) {
		return new L.LatLng(a.lat, 'lng' in a ? a.lng : a.lon);
	}
	if (b === undefined) {
		return null;
	}
	return new L.LatLng(a, b);
};



/*
 * L.LatLngBounds represents a rectangular area on the map in geographical coordinates.
 */

L.LatLngBounds = function (southWest, northEast) { // (LatLng, LatLng) or (LatLng[])
	if (!southWest) { return; }

	var latlngs = northEast ? [southWest, northEast] : southWest;

	for (var i = 0, len = latlngs.length; i < len; i++) {
		this.extend(latlngs[i]);
	}
};

L.LatLngBounds.prototype = {
	// extend the bounds to contain the given point or bounds
	extend: function (obj) { // (LatLng) or (LatLngBounds)
		if (!obj) { return this; }

		var latLng = L.latLng(obj);
		if (latLng !== null) {
			obj = latLng;
		} else {
			obj = L.latLngBounds(obj);
		}

		if (obj instanceof L.LatLng) {
			if (!this._southWest && !this._northEast) {
				this._southWest = new L.LatLng(obj.lat, obj.lng);
				this._northEast = new L.LatLng(obj.lat, obj.lng);
			} else {
				this._southWest.lat = Math.min(obj.lat, this._southWest.lat);
				this._southWest.lng = Math.min(obj.lng, this._southWest.lng);

				this._northEast.lat = Math.max(obj.lat, this._northEast.lat);
				this._northEast.lng = Math.max(obj.lng, this._northEast.lng);
			}
		} else if (obj instanceof L.LatLngBounds) {
			this.extend(obj._southWest);
			this.extend(obj._northEast);
		}
		return this;
	},

	// extend the bounds by a percentage
	pad: function (bufferRatio) { // (Number) -> LatLngBounds
		var sw = this._southWest,
		    ne = this._northEast,
		    heightBuffer = Math.abs(sw.lat - ne.lat) * bufferRatio,
		    widthBuffer = Math.abs(sw.lng - ne.lng) * bufferRatio;

		return new L.LatLngBounds(
		        new L.LatLng(sw.lat - heightBuffer, sw.lng - widthBuffer),
		        new L.LatLng(ne.lat + heightBuffer, ne.lng + widthBuffer));
	},

	getCenter: function () { // -> LatLng
		return new L.LatLng(
		        (this._southWest.lat + this._northEast.lat) / 2,
		        (this._southWest.lng + this._northEast.lng) / 2);
	},

	getSouthWest: function () {
		return this._southWest;
	},

	getNorthEast: function () {
		return this._northEast;
	},

	getNorthWest: function () {
		return new L.LatLng(this.getNorth(), this.getWest());
	},

	getSouthEast: function () {
		return new L.LatLng(this.getSouth(), this.getEast());
	},

	getWest: function () {
		return this._southWest.lng;
	},

	getSouth: function () {
		return this._southWest.lat;
	},

	getEast: function () {
		return this._northEast.lng;
	},

	getNorth: function () {
		return this._northEast.lat;
	},

	contains: function (obj) { // (LatLngBounds) or (LatLng) -> Boolean
		if (typeof obj[0] === 'number' || obj instanceof L.LatLng) {
			obj = L.latLng(obj);
		} else {
			obj = L.latLngBounds(obj);
		}

		var sw = this._southWest,
		    ne = this._northEast,
		    sw2, ne2;

		if (obj instanceof L.LatLngBounds) {
			sw2 = obj.getSouthWest();
			ne2 = obj.getNorthEast();
		} else {
			sw2 = ne2 = obj;
		}

		return (sw2.lat >= sw.lat) && (ne2.lat <= ne.lat) &&
		       (sw2.lng >= sw.lng) && (ne2.lng <= ne.lng);
	},

	intersects: function (bounds) { // (LatLngBounds)
		bounds = L.latLngBounds(bounds);

		var sw = this._southWest,
		    ne = this._northEast,
		    sw2 = bounds.getSouthWest(),
		    ne2 = bounds.getNorthEast(),

		    latIntersects = (ne2.lat >= sw.lat) && (sw2.lat <= ne.lat),
		    lngIntersects = (ne2.lng >= sw.lng) && (sw2.lng <= ne.lng);

		return latIntersects && lngIntersects;
	},

	toBBoxString: function () {
		return [this.getWest(), this.getSouth(), this.getEast(), this.getNorth()].join(',');
	},

	equals: function (bounds) { // (LatLngBounds)
		if (!bounds) { return false; }

		bounds = L.latLngBounds(bounds);

		return this._southWest.equals(bounds.getSouthWest()) &&
		       this._northEast.equals(bounds.getNorthEast());
	},

	isValid: function () {
		return !!(this._southWest && this._northEast);
	}
};

//TODO International date line?

L.latLngBounds = function (a, b) { // (LatLngBounds) or (LatLng, LatLng)
	if (!a || a instanceof L.LatLngBounds) {
		return a;
	}
	return new L.LatLngBounds(a, b);
};


/*
 * L.Projection contains various geographical projections used by CRS classes.
 */

L.Projection = {};


/*
 * Spherical Mercator is the most popular map projection, used by EPSG:3857 CRS used by default.
 */

L.Projection.SphericalMercator = {
	MAX_LATITUDE: 85.0511287798,

	project: function (latlng) { // (LatLng) -> Point
		var d = L.LatLng.DEG_TO_RAD,
		    max = this.MAX_LATITUDE,
		    lat = Math.max(Math.min(max, latlng.lat), -max),
		    x = latlng.lng * d,
		    y = lat * d;

		y = Math.log(Math.tan((Math.PI / 4) + (y / 2)));

		return new L.Point(x, y);
	},

	unproject: function (point) { // (Point, Boolean) -> LatLng
		var d = L.LatLng.RAD_TO_DEG,
		    lng = point.x * d,
		    lat = (2 * Math.atan(Math.exp(point.y)) - (Math.PI / 2)) * d;

		return new L.LatLng(lat, lng);
	}
};


/*
 * Simple equirectangular (Plate Carree) projection, used by CRS like EPSG:4326 and Simple.
 */

L.Projection.LonLat = {
	project: function (latlng) {
		return new L.Point(latlng.lng, latlng.lat);
	},

	unproject: function (point) {
		return new L.LatLng(point.y, point.x);
	}
};


/*
 * L.CRS is a base object for all defined CRS (Coordinate Reference Systems) in Leaflet.
 */

L.CRS = {
	latLngToPoint: function (latlng, zoom) { // (LatLng, Number) -> Point
		var projectedPoint = this.projection.project(latlng),
		    scale = this.scale(zoom);

		return this.transformation._transform(projectedPoint, scale);
	},

	pointToLatLng: function (point, zoom) { // (Point, Number[, Boolean]) -> LatLng
		var scale = this.scale(zoom),
		    untransformedPoint = this.transformation.untransform(point, scale);

		return this.projection.unproject(untransformedPoint);
	},

	project: function (latlng) {
		return this.projection.project(latlng);
	},

	scale: function (zoom) {
		return 256 * Math.pow(2, zoom);
	},

	getSize: function (zoom) {
		var s = this.scale(zoom);
		return L.point(s, s);
	}
};


/*
 * A simple CRS that can be used for flat non-Earth maps like panoramas or game maps.
 */

L.CRS.Simple = L.extend({}, L.CRS, {
	projection: L.Projection.LonLat,
	transformation: new L.Transformation(1, 0, -1, 0),

	scale: function (zoom) {
		return Math.pow(2, zoom);
	}
});


/*
 * L.CRS.EPSG3857 (Spherical Mercator) is the most common CRS for web mapping
 * and is used by Leaflet by default.
 */

L.CRS.EPSG3857 = L.extend({}, L.CRS, {
	code: 'EPSG:3857',

	projection: L.Projection.SphericalMercator,
	transformation: new L.Transformation(0.5 / Math.PI, 0.5, -0.5 / Math.PI, 0.5),

	project: function (latlng) { // (LatLng) -> Point
		var projectedPoint = this.projection.project(latlng),
		    earthRadius = 6378137;
		return projectedPoint.multiplyBy(earthRadius);
	}
});

L.CRS.EPSG900913 = L.extend({}, L.CRS.EPSG3857, {
	code: 'EPSG:900913'
});


/*
 * L.CRS.EPSG4326 is a CRS popular among advanced GIS specialists.
 */

L.CRS.EPSG4326 = L.extend({}, L.CRS, {
	code: 'EPSG:4326',

	projection: L.Projection.LonLat,
	transformation: new L.Transformation(1 / 360, 0.5, -1 / 360, 0.5)
});


/*
 * L.Map is the central class of the API - it is used to create a map.
 */

L.Map = L.Class.extend({

	includes: L.Mixin.Events,

	options: {
		crs: L.CRS.EPSG3857,

		/*
		center: LatLng,
		zoom: Number,
		layers: Array,
		*/

		fadeAnimation: L.DomUtil.TRANSITION && !L.Browser.android23,
		trackResize: true,
		markerZoomAnimation: L.DomUtil.TRANSITION && L.Browser.any3d
	},

	initialize: function (id, options) { // (HTMLElement or String, Object)
		options = L.setOptions(this, options);


		this._initContainer(id);
		this._initLayout();

		// hack for https://github.com/Leaflet/Leaflet/issues/1980
		this._onResize = L.bind(this._onResize, this);

		this._initEvents();

		if (options.maxBounds) {
			this.setMaxBounds(options.maxBounds);
		}

		if (options.center && options.zoom !== undefined) {
			this.setView(L.latLng(options.center), options.zoom, {reset: true});
		}

		this._handlers = [];

		this._layers = {};
		this._zoomBoundLayers = {};
		this._tileLayersNum = 0;

		this.callInitHooks();

		this._addLayers(options.layers);
	},


	// public methods that modify map state

	// replaced by animation-powered implementation in Map.PanAnimation.js
	setView: function (center, zoom) {
		zoom = zoom === undefined ? this.getZoom() : zoom;
		this._resetView(L.latLng(center), this._limitZoom(zoom));
		return this;
	},

	setZoom: function (zoom, options) {
		if (!this._loaded) {
			this._zoom = this._limitZoom(zoom);
			return this;
		}
		return this.setView(this.getCenter(), zoom, {zoom: options});
	},

	zoomIn: function (delta, options) {
		return this.setZoom(this._zoom + (delta || 1), options);
	},

	zoomOut: function (delta, options) {
		return this.setZoom(this._zoom - (delta || 1), options);
	},

	setZoomAround: function (latlng, zoom, options) {
		var scale = this.getZoomScale(zoom),
		    viewHalf = this.getSize().divideBy(2),
		    containerPoint = latlng instanceof L.Point ? latlng : this.latLngToContainerPoint(latlng),

		    centerOffset = containerPoint.subtract(viewHalf).multiplyBy(1 - 1 / scale),
		    newCenter = this.containerPointToLatLng(viewHalf.add(centerOffset));

		return this.setView(newCenter, zoom, {zoom: options});
	},

	fitBounds: function (bounds, options) {

		options = options || {};
		bounds = bounds.getBounds ? bounds.getBounds() : L.latLngBounds(bounds);

		var paddingTL = L.point(options.paddingTopLeft || options.padding || [0, 0]),
		    paddingBR = L.point(options.paddingBottomRight || options.padding || [0, 0]),

		    zoom = this.getBoundsZoom(bounds, false, paddingTL.add(paddingBR));

		zoom = (options.maxZoom) ? Math.min(options.maxZoom, zoom) : zoom;

		var paddingOffset = paddingBR.subtract(paddingTL).divideBy(2),

		    swPoint = this.project(bounds.getSouthWest(), zoom),
		    nePoint = this.project(bounds.getNorthEast(), zoom),
		    center = this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset), zoom);

		return this.setView(center, zoom, options);
	},

	fitWorld: function (options) {
		return this.fitBounds([[-90, -180], [90, 180]], options);
	},

	panTo: function (center, options) { // (LatLng)
		return this.setView(center, this._zoom, {pan: options});
	},

	panBy: function (offset) { // (Point)
		// replaced with animated panBy in Map.PanAnimation.js
		this.fire('movestart');

		this._rawPanBy(L.point(offset));

		this.fire('move');
		return this.fire('moveend');
	},

	setMaxBounds: function (bounds) {
		bounds = L.latLngBounds(bounds);

		this.options.maxBounds = bounds;

		if (!bounds) {
			return this.off('moveend', this._panInsideMaxBounds, this);
		}

		if (this._loaded) {
			this._panInsideMaxBounds();
		}

		return this.on('moveend', this._panInsideMaxBounds, this);
	},

	panInsideBounds: function (bounds, options) {
		var center = this.getCenter(),
			newCenter = this._limitCenter(center, this._zoom, bounds);

		if (center.equals(newCenter)) { return this; }

		return this.panTo(newCenter, options);
	},

	addLayer: function (layer) {
		// TODO method is too big, refactor

		var id = L.stamp(layer);

		if (this._layers[id]) { return this; }

		this._layers[id] = layer;

		// TODO getMaxZoom, getMinZoom in ILayer (instead of options)
		if (layer.options && (!isNaN(layer.options.maxZoom) || !isNaN(layer.options.minZoom))) {
			this._zoomBoundLayers[id] = layer;
			this._updateZoomLevels();
		}

		// TODO looks ugly, refactor!!!
		if (this.options.zoomAnimation && L.TileLayer && (layer instanceof L.TileLayer)) {
			this._tileLayersNum++;
			this._tileLayersToLoad++;
			layer.on('load', this._onTileLayerLoad, this);
		}

		if (this._loaded) {
			this._layerAdd(layer);
		}

		return this;
	},

	removeLayer: function (layer) {
		var id = L.stamp(layer);

		if (!this._layers[id]) { return this; }

		if (this._loaded) {
			layer.onRemove(this);
		}

		delete this._layers[id];

		if (this._loaded) {
			this.fire('layerremove', {layer: layer});
		}

		if (this._zoomBoundLayers[id]) {
			delete this._zoomBoundLayers[id];
			this._updateZoomLevels();
		}

		// TODO looks ugly, refactor
		if (this.options.zoomAnimation && L.TileLayer && (layer instanceof L.TileLayer)) {
			this._tileLayersNum--;
			this._tileLayersToLoad--;
			layer.off('load', this._onTileLayerLoad, this);
		}

		return this;
	},

	hasLayer: function (layer) {
		if (!layer) { return false; }

		return (L.stamp(layer) in this._layers);
	},

	eachLayer: function (method, context) {
		for (var i in this._layers) {
			method.call(context, this._layers[i]);
		}
		return this;
	},

	invalidateSize: function (options) {
		if (!this._loaded) { return this; }

		options = L.extend({
			animate: false,
			pan: true
		}, options === true ? {animate: true} : options);

		var oldSize = this.getSize();
		this._sizeChanged = true;
		this._initialCenter = null;

		var newSize = this.getSize(),
		    oldCenter = oldSize.divideBy(2).round(),
		    newCenter = newSize.divideBy(2).round(),
		    offset = oldCenter.subtract(newCenter);

		if (!offset.x && !offset.y) { return this; }

		if (options.animate && options.pan) {
			this.panBy(offset);

		} else {
			if (options.pan) {
				this._rawPanBy(offset);
			}

			this.fire('move');

			if (options.debounceMoveend) {
				clearTimeout(this._sizeTimer);
				this._sizeTimer = setTimeout(L.bind(this.fire, this, 'moveend'), 200);
			} else {
				this.fire('moveend');
			}
		}

		return this.fire('resize', {
			oldSize: oldSize,
			newSize: newSize
		});
	},

	// TODO handler.addTo
	addHandler: function (name, HandlerClass) {
		if (!HandlerClass) { return this; }

		var handler = this[name] = new HandlerClass(this);

		this._handlers.push(handler);

		if (this.options[name]) {
			handler.enable();
		}

		return this;
	},

	remove: function () {
		if (this._loaded) {
			this.fire('unload');
		}

		this._initEvents('off');

		try {
			// throws error in IE6-8
			delete this._container._leaflet;
		} catch (e) {
			this._container._leaflet = undefined;
		}

		this._clearPanes();
		if (this._clearControlPos) {
			this._clearControlPos();
		}

		this._clearHandlers();

		return this;
	},


	// public methods for getting map state

	getCenter: function () { // (Boolean) -> LatLng
		this._checkIfLoaded();

		if (this._initialCenter && !this._moved()) {
			return this._initialCenter;
		}
		return this.layerPointToLatLng(this._getCenterLayerPoint());
	},

	getZoom: function () {
		return this._zoom;
	},

	getBounds: function () {
		var bounds = this.getPixelBounds(),
		    sw = this.unproject(bounds.getBottomLeft()),
		    ne = this.unproject(bounds.getTopRight());

		return new L.LatLngBounds(sw, ne);
	},

	getMinZoom: function () {
		return this.options.minZoom === undefined ?
			(this._layersMinZoom === undefined ? 0 : this._layersMinZoom) :
			this.options.minZoom;
	},

	getMaxZoom: function () {
		return this.options.maxZoom === undefined ?
			(this._layersMaxZoom === undefined ? Infinity : this._layersMaxZoom) :
			this.options.maxZoom;
	},

	getBoundsZoom: function (bounds, inside, padding) { // (LatLngBounds[, Boolean, Point]) -> Number
		bounds = L.latLngBounds(bounds);

		var zoom = this.getMinZoom() - (inside ? 1 : 0),
		    maxZoom = this.getMaxZoom(),
		    size = this.getSize(),

		    nw = bounds.getNorthWest(),
		    se = bounds.getSouthEast(),

		    zoomNotFound = true,
		    boundsSize;

		padding = L.point(padding || [0, 0]);

		do {
			zoom++;
			boundsSize = this.project(se, zoom).subtract(this.project(nw, zoom)).add(padding);
			zoomNotFound = !inside ? size.contains(boundsSize) : boundsSize.x < size.x || boundsSize.y < size.y;

		} while (zoomNotFound && zoom <= maxZoom);

		if (zoomNotFound && inside) {
			return null;
		}

		return inside ? zoom : zoom - 1;
	},

	getSize: function () {
		if (!this._size || this._sizeChanged) {
			this._size = new L.Point(
				this._container.clientWidth,
				this._container.clientHeight);

			this._sizeChanged = false;
		}
		return this._size.clone();
	},

	getPixelBounds: function () {
		var topLeftPoint = this._getTopLeftPoint();
		return new L.Bounds(topLeftPoint, topLeftPoint.add(this.getSize()));
	},

	getPixelOrigin: function () {
		this._checkIfLoaded();
		return this._initialTopLeftPoint;
	},

	getPanes: function () {
		return this._panes;
	},

	getContainer: function () {
		return this._container;
	},


	// TODO replace with universal implementation after refactoring projections

	getZoomScale: function (toZoom) {
		var crs = this.options.crs;
		return crs.scale(toZoom) / crs.scale(this._zoom);
	},

	getScaleZoom: function (scale) {
		return this._zoom + (Math.log(scale) / Math.LN2);
	},


	// conversion methods

	project: function (latlng, zoom) { // (LatLng[, Number]) -> Point
		zoom = zoom === undefined ? this._zoom : zoom;
		return this.options.crs.latLngToPoint(L.latLng(latlng), zoom);
	},

	unproject: function (point, zoom) { // (Point[, Number]) -> LatLng
		zoom = zoom === undefined ? this._zoom : zoom;
		return this.options.crs.pointToLatLng(L.point(point), zoom);
	},

	layerPointToLatLng: function (point) { // (Point)
		var projectedPoint = L.point(point).add(this.getPixelOrigin());
		return this.unproject(projectedPoint);
	},

	latLngToLayerPoint: function (latlng) { // (LatLng)
		var projectedPoint = this.project(L.latLng(latlng))._round();
		return projectedPoint._subtract(this.getPixelOrigin());
	},

	containerPointToLayerPoint: function (point) { // (Point)
		return L.point(point).subtract(this._getMapPanePos());
	},

	layerPointToContainerPoint: function (point) { // (Point)
		return L.point(point).add(this._getMapPanePos());
	},

	containerPointToLatLng: function (point) {
		var layerPoint = this.containerPointToLayerPoint(L.point(point));
		return this.layerPointToLatLng(layerPoint);
	},

	latLngToContainerPoint: function (latlng) {
		return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));
	},

	mouseEventToContainerPoint: function (e) { // (MouseEvent)
		return L.DomEvent.getMousePosition(e, this._container);
	},

	mouseEventToLayerPoint: function (e) { // (MouseEvent)
		return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));
	},

	mouseEventToLatLng: function (e) { // (MouseEvent)
		return this.layerPointToLatLng(this.mouseEventToLayerPoint(e));
	},


	// map initialization methods

	_initContainer: function (id) {
		var container = this._container = L.DomUtil.get(id);

		if (!container) {
			throw new Error('Map container not found.');
		} else if (container._leaflet) {
			throw new Error('Map container is already initialized.');
		}

		container._leaflet = true;
	},

	_initLayout: function () {
		var container = this._container;

		L.DomUtil.addClass(container, 'leaflet-container' +
			(L.Browser.touch ? ' leaflet-touch' : '') +
			(L.Browser.retina ? ' leaflet-retina' : '') +
			(L.Browser.ielt9 ? ' leaflet-oldie' : '') +
			(this.options.fadeAnimation ? ' leaflet-fade-anim' : ''));

		var position = L.DomUtil.getStyle(container, 'position');

		if (position !== 'absolute' && position !== 'relative' && position !== 'fixed') {
			container.style.position = 'relative';
		}

		this._initPanes();

		if (this._initControlPos) {
			this._initControlPos();
		}
	},

	_initPanes: function () {
		var panes = this._panes = {};

		this._mapPane = panes.mapPane = this._createPane('leaflet-map-pane', this._container);

		this._tilePane = panes.tilePane = this._createPane('leaflet-tile-pane', this._mapPane);
		panes.objectsPane = this._createPane('leaflet-objects-pane', this._mapPane);
		panes.shadowPane = this._createPane('leaflet-shadow-pane');
		panes.overlayPane = this._createPane('leaflet-overlay-pane');
		panes.markerPane = this._createPane('leaflet-marker-pane');
		panes.popupPane = this._createPane('leaflet-popup-pane');

		var zoomHide = ' leaflet-zoom-hide';

		if (!this.options.markerZoomAnimation) {
			L.DomUtil.addClass(panes.markerPane, zoomHide);
			L.DomUtil.addClass(panes.shadowPane, zoomHide);
			L.DomUtil.addClass(panes.popupPane, zoomHide);
		}
	},

	_createPane: function (className, container) {
		return L.DomUtil.create('div', className, container || this._panes.objectsPane);
	},

	_clearPanes: function () {
		this._container.removeChild(this._mapPane);
	},

	_addLayers: function (layers) {
		layers = layers ? (L.Util.isArray(layers) ? layers : [layers]) : [];

		for (var i = 0, len = layers.length; i < len; i++) {
			this.addLayer(layers[i]);
		}
	},


	// private methods that modify map state

	_resetView: function (center, zoom, preserveMapOffset, afterZoomAnim) {

		var zoomChanged = (this._zoom !== zoom);

		if (!afterZoomAnim) {
			this.fire('movestart');

			if (zoomChanged) {
				this.fire('zoomstart');
			}
		}

		this._zoom = zoom;
		this._initialCenter = center;

		this._initialTopLeftPoint = this._getNewTopLeftPoint(center);

		if (!preserveMapOffset) {
			L.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));
		} else {
			this._initialTopLeftPoint._add(this._getMapPanePos());
		}

		this._tileLayersToLoad = this._tileLayersNum;

		var loading = !this._loaded;
		this._loaded = true;

		this.fire('viewreset', {hard: !preserveMapOffset});

		if (loading) {
			this.fire('load');
			this.eachLayer(this._layerAdd, this);
		}

		this.fire('move');

		if (zoomChanged || afterZoomAnim) {
			this.fire('zoomend');
		}

		this.fire('moveend', {hard: !preserveMapOffset});
	},

	_rawPanBy: function (offset) {
		L.DomUtil.setPosition(this._mapPane, this._getMapPanePos().subtract(offset));
	},

	_getZoomSpan: function () {
		return this.getMaxZoom() - this.getMinZoom();
	},

	_updateZoomLevels: function () {
		var i,
			minZoom = Infinity,
			maxZoom = -Infinity,
			oldZoomSpan = this._getZoomSpan();

		for (i in this._zoomBoundLayers) {
			var layer = this._zoomBoundLayers[i];
			if (!isNaN(layer.options.minZoom)) {
				minZoom = Math.min(minZoom, layer.options.minZoom);
			}
			if (!isNaN(layer.options.maxZoom)) {
				maxZoom = Math.max(maxZoom, layer.options.maxZoom);
			}
		}

		if (i === undefined) { // we have no tilelayers
			this._layersMaxZoom = this._layersMinZoom = undefined;
		} else {
			this._layersMaxZoom = maxZoom;
			this._layersMinZoom = minZoom;
		}

		if (oldZoomSpan !== this._getZoomSpan()) {
			this.fire('zoomlevelschange');
		}
	},

	_panInsideMaxBounds: function () {
		this.panInsideBounds(this.options.maxBounds);
	},

	_checkIfLoaded: function () {
		if (!this._loaded) {
			throw new Error('Set map center and zoom first.');
		}
	},

	// map events

	_initEvents: function (onOff) {
		if (!L.DomEvent) { return; }

		onOff = onOff || 'on';

		L.DomEvent[onOff](this._container, 'click', this._onMouseClick, this);

		var events = ['dblclick', 'mousedown', 'mouseup', 'mouseenter',
		              'mouseleave', 'mousemove', 'contextmenu'],
		    i, len;

		for (i = 0, len = events.length; i < len; i++) {
			L.DomEvent[onOff](this._container, events[i], this._fireMouseEvent, this);
		}

		if (this.options.trackResize) {
			L.DomEvent[onOff](window, 'resize', this._onResize, this);
		}
	},

	_onResize: function () {
		L.Util.cancelAnimFrame(this._resizeRequest);
		this._resizeRequest = L.Util.requestAnimFrame(
		        function () { this.invalidateSize({debounceMoveend: true}); }, this, false, this._container);
	},

	_onMouseClick: function (e) {
		if (!this._loaded || (!e._simulated &&
		        ((this.dragging && this.dragging.moved()) ||
		         (this.boxZoom  && this.boxZoom.moved()))) ||
		            L.DomEvent._skipped(e)) { return; }

		this.fire('preclick');
		this._fireMouseEvent(e);
	},

	_fireMouseEvent: function (e) {
		if (!this._loaded || L.DomEvent._skipped(e)) { return; }

		var type = e.type;

		type = (type === 'mouseenter' ? 'mouseover' : (type === 'mouseleave' ? 'mouseout' : type));

		if (!this.hasEventListeners(type)) { return; }

		if (type === 'contextmenu') {
			L.DomEvent.preventDefault(e);
		}

		var containerPoint = this.mouseEventToContainerPoint(e),
		    layerPoint = this.containerPointToLayerPoint(containerPoint),
		    latlng = this.layerPointToLatLng(layerPoint);

		this.fire(type, {
			latlng: latlng,
			layerPoint: layerPoint,
			containerPoint: containerPoint,
			originalEvent: e
		});
	},

	_onTileLayerLoad: function () {
		this._tileLayersToLoad--;
		if (this._tileLayersNum && !this._tileLayersToLoad) {
			this.fire('tilelayersload');
		}
	},

	_clearHandlers: function () {
		for (var i = 0, len = this._handlers.length; i < len; i++) {
			this._handlers[i].disable();
		}
	},

	whenReady: function (callback, context) {
		if (this._loaded) {
			callback.call(context || this, this);
		} else {
			this.on('load', callback, context);
		}
		return this;
	},

	_layerAdd: function (layer) {
		layer.onAdd(this);
		this.fire('layeradd', {layer: layer});
	},


	// private methods for getting map state

	_getMapPanePos: function () {
		return L.DomUtil.getPosition(this._mapPane);
	},

	_moved: function () {
		var pos = this._getMapPanePos();
		return pos && !pos.equals([0, 0]);
	},

	_getTopLeftPoint: function () {
		return this.getPixelOrigin().subtract(this._getMapPanePos());
	},

	_getNewTopLeftPoint: function (center, zoom) {
		var viewHalf = this.getSize()._divideBy(2);
		// TODO round on display, not calculation to increase precision?
		return this.project(center, zoom)._subtract(viewHalf)._round();
	},

	_latLngToNewLayerPoint: function (latlng, newZoom, newCenter) {
		var topLeft = this._getNewTopLeftPoint(newCenter, newZoom).add(this._getMapPanePos());
		return this.project(latlng, newZoom)._subtract(topLeft);
	},

	// layer point of the current center
	_getCenterLayerPoint: function () {
		return this.containerPointToLayerPoint(this.getSize()._divideBy(2));
	},

	// offset of the specified place to the current center in pixels
	_getCenterOffset: function (latlng) {
		return this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());
	},

	// adjust center for view to get inside bounds
	_limitCenter: function (center, zoom, bounds) {

		if (!bounds) { return center; }

		var centerPoint = this.project(center, zoom),
		    viewHalf = this.getSize().divideBy(2),
		    viewBounds = new L.Bounds(centerPoint.subtract(viewHalf), centerPoint.add(viewHalf)),
		    offset = this._getBoundsOffset(viewBounds, bounds, zoom);

		return this.unproject(centerPoint.add(offset), zoom);
	},

	// adjust offset for view to get inside bounds
	_limitOffset: function (offset, bounds) {
		if (!bounds) { return offset; }

		var viewBounds = this.getPixelBounds(),
		    newBounds = new L.Bounds(viewBounds.min.add(offset), viewBounds.max.add(offset));

		return offset.add(this._getBoundsOffset(newBounds, bounds));
	},

	// returns offset needed for pxBounds to get inside maxBounds at a specified zoom
	_getBoundsOffset: function (pxBounds, maxBounds, zoom) {
		var nwOffset = this.project(maxBounds.getNorthWest(), zoom).subtract(pxBounds.min),
		    seOffset = this.project(maxBounds.getSouthEast(), zoom).subtract(pxBounds.max),

		    dx = this._rebound(nwOffset.x, -seOffset.x),
		    dy = this._rebound(nwOffset.y, -seOffset.y);

		return new L.Point(dx, dy);
	},

	_rebound: function (left, right) {
		return left + right > 0 ?
			Math.round(left - right) / 2 :
			Math.max(0, Math.ceil(left)) - Math.max(0, Math.floor(right));
	},

	_limitZoom: function (zoom) {
		var min = this.getMinZoom(),
		    max = this.getMaxZoom();

		return Math.max(min, Math.min(max, zoom));
	}
});

L.map = function (id, options) {
	return new L.Map(id, options);
};


/*
 * Mercator projection that takes into account that the Earth is not a perfect sphere.
 * Less popular than spherical mercator; used by projections like EPSG:3395.
 */

L.Projection.Mercator = {
	MAX_LATITUDE: 85.0840591556,

	R_MINOR: 6356752.314245179,
	R_MAJOR: 6378137,

	project: function (latlng) { // (LatLng) -> Point
		var d = L.LatLng.DEG_TO_RAD,
		    max = this.MAX_LATITUDE,
		    lat = Math.max(Math.min(max, latlng.lat), -max),
		    r = this.R_MAJOR,
		    r2 = this.R_MINOR,
		    x = latlng.lng * d * r,
		    y = lat * d,
		    tmp = r2 / r,
		    eccent = Math.sqrt(1.0 - tmp * tmp),
		    con = eccent * Math.sin(y);

		con = Math.pow((1 - con) / (1 + con), eccent * 0.5);

		var ts = Math.tan(0.5 * ((Math.PI * 0.5) - y)) / con;
		y = -r * Math.log(ts);

		return new L.Point(x, y);
	},

	unproject: function (point) { // (Point, Boolean) -> LatLng
		var d = L.LatLng.RAD_TO_DEG,
		    r = this.R_MAJOR,
		    r2 = this.R_MINOR,
		    lng = point.x * d / r,
		    tmp = r2 / r,
		    eccent = Math.sqrt(1 - (tmp * tmp)),
		    ts = Math.exp(- point.y / r),
		    phi = (Math.PI / 2) - 2 * Math.atan(ts),
		    numIter = 15,
		    tol = 1e-7,
		    i = numIter,
		    dphi = 0.1,
		    con;

		while ((Math.abs(dphi) > tol) && (--i > 0)) {
			con = eccent * Math.sin(phi);
			dphi = (Math.PI / 2) - 2 * Math.atan(ts *
			            Math.pow((1.0 - con) / (1.0 + con), 0.5 * eccent)) - phi;
			phi += dphi;
		}

		return new L.LatLng(phi * d, lng);
	}
};



L.CRS.EPSG3395 = L.extend({}, L.CRS, {
	code: 'EPSG:3395',

	projection: L.Projection.Mercator,

	transformation: (function () {
		var m = L.Projection.Mercator,
		    r = m.R_MAJOR,
		    scale = 0.5 / (Math.PI * r);

		return new L.Transformation(scale, 0.5, -scale, 0.5);
	}())
});


/*
 * L.TileLayer is used for standard xyz-numbered tile layers.
 */

L.TileLayer = L.Class.extend({
	includes: L.Mixin.Events,

	options: {
		minZoom: 0,
		maxZoom: 18,
		tileSize: 256,
		subdomains: 'abc',
		errorTileUrl: '',
		attribution: '',
		zoomOffset: 0,
		opacity: 1,
		/*
		maxNativeZoom: null,
		zIndex: null,
		tms: false,
		continuousWorld: false,
		noWrap: false,
		zoomReverse: false,
		detectRetina: false,
		reuseTiles: false,
		bounds: false,
		*/
		unloadInvisibleTiles: L.Browser.mobile,
		updateWhenIdle: L.Browser.mobile
	},

	initialize: function (url, options) {
		options = L.setOptions(this, options);

		// detecting retina displays, adjusting tileSize and zoom levels
		if (options.detectRetina && L.Browser.retina && options.maxZoom > 0) {

			options.tileSize = Math.floor(options.tileSize / 2);
			options.zoomOffset++;

			if (options.minZoom > 0) {
				options.minZoom--;
			}
			this.options.maxZoom--;
		}

		if (options.bounds) {
			options.bounds = L.latLngBounds(options.bounds);
		}

		this._url = url;

		var subdomains = this.options.subdomains;

		if (typeof subdomains === 'string') {
			this.options.subdomains = subdomains.split('');
		}
	},

	onAdd: function (map) {
		this._map = map;
		this._animated = map._zoomAnimated;

		// create a container div for tiles
		this._initContainer();

		// set up events
		map.on({
			'viewreset': this._reset,
			'moveend': this._update
		}, this);

		if (this._animated) {
			map.on({
				'zoomanim': this._animateZoom,
				'zoomend': this._endZoomAnim
			}, this);
		}

		if (!this.options.updateWhenIdle) {
			this._limitedUpdate = L.Util.limitExecByInterval(this._update, 150, this);
			map.on('move', this._limitedUpdate, this);
		}

		this._reset();
		this._update();
	},

	addTo: function (map) {
		map.addLayer(this);
		return this;
	},

	onRemove: function (map) {
		this._container.parentNode.removeChild(this._container);

		map.off({
			'viewreset': this._reset,
			'moveend': this._update
		}, this);

		if (this._animated) {
			map.off({
				'zoomanim': this._animateZoom,
				'zoomend': this._endZoomAnim
			}, this);
		}

		if (!this.options.updateWhenIdle) {
			map.off('move', this._limitedUpdate, this);
		}

		this._container = null;
		this._map = null;
	},

	bringToFront: function () {
		var pane = this._map._panes.tilePane;

		if (this._container) {
			pane.appendChild(this._container);
			this._setAutoZIndex(pane, Math.max);
		}

		return this;
	},

	bringToBack: function () {
		var pane = this._map._panes.tilePane;

		if (this._container) {
			pane.insertBefore(this._container, pane.firstChild);
			this._setAutoZIndex(pane, Math.min);
		}

		return this;
	},

	getAttribution: function () {
		return this.options.attribution;
	},

	getContainer: function () {
		return this._container;
	},

	setOpacity: function (opacity) {
		this.options.opacity = opacity;

		if (this._map) {
			this._updateOpacity();
		}

		return this;
	},

	setZIndex: function (zIndex) {
		this.options.zIndex = zIndex;
		this._updateZIndex();

		return this;
	},

	setUrl: function (url, noRedraw) {
		this._url = url;

		if (!noRedraw) {
			this.redraw();
		}

		return this;
	},

	redraw: function () {
		if (this._map) {
			this._reset({hard: true});
			this._update();
		}
		return this;
	},

	_updateZIndex: function () {
		if (this._container && this.options.zIndex !== undefined) {
			this._container.style.zIndex = this.options.zIndex;
		}
	},

	_setAutoZIndex: function (pane, compare) {

		var layers = pane.children,
		    edgeZIndex = -compare(Infinity, -Infinity), // -Infinity for max, Infinity for min
		    zIndex, i, len;

		for (i = 0, len = layers.length; i < len; i++) {

			if (layers[i] !== this._container) {
				zIndex = parseInt(layers[i].style.zIndex, 10);

				if (!isNaN(zIndex)) {
					edgeZIndex = compare(edgeZIndex, zIndex);
				}
			}
		}

		this.options.zIndex = this._container.style.zIndex =
		        (isFinite(edgeZIndex) ? edgeZIndex : 0) + compare(1, -1);
	},

	_updateOpacity: function () {
		var i,
		    tiles = this._tiles;

		if (L.Browser.ielt9) {
			for (i in tiles) {
				L.DomUtil.setOpacity(tiles[i], this.options.opacity);
			}
		} else {
			L.DomUtil.setOpacity(this._container, this.options.opacity);
		}
	},

	_initContainer: function () {
		var tilePane = this._map._panes.tilePane;

		if (!this._container) {
			this._container = L.DomUtil.create('div', 'leaflet-layer');

			this._updateZIndex();

			if (this._animated) {
				var className = 'leaflet-tile-container';

				this._bgBuffer = L.DomUtil.create('div', className, this._container);
				this._tileContainer = L.DomUtil.create('div', className, this._container);

			} else {
				this._tileContainer = this._container;
			}

			tilePane.appendChild(this._container);

			if (this.options.opacity < 1) {
				this._updateOpacity();
			}
		}
	},

	_reset: function (e) {
		for (var key in this._tiles) {
			this.fire('tileunload', {tile: this._tiles[key]});
		}

		this._tiles = {};
		this._tilesToLoad = 0;

		if (this.options.reuseTiles) {
			this._unusedTiles = [];
		}

		this._tileContainer.innerHTML = '';

		if (this._animated && e && e.hard) {
			this._clearBgBuffer();
		}

		this._initContainer();
	},

	_getTileSize: function () {
		var map = this._map,
		    zoom = map.getZoom() + this.options.zoomOffset,
		    zoomN = this.options.maxNativeZoom,
		    tileSize = this.options.tileSize;

		if (zoomN && zoom > zoomN) {
			tileSize = Math.round(map.getZoomScale(zoom) / map.getZoomScale(zoomN) * tileSize);
		}

		return tileSize;
	},

	_update: function () {

		if (!this._map) { return; }

		var map = this._map,
		    bounds = map.getPixelBounds(),
		    zoom = map.getZoom(),
		    tileSize = this._getTileSize();

		if (zoom > this.options.maxZoom || zoom < this.options.minZoom) {
			return;
		}

		var tileBounds = L.bounds(
		        bounds.min.divideBy(tileSize)._floor(),
		        bounds.max.divideBy(tileSize)._floor());

		this._addTilesFromCenterOut(tileBounds);

		if (this.options.unloadInvisibleTiles || this.options.reuseTiles) {
			this._removeOtherTiles(tileBounds);
		}
	},

	_addTilesFromCenterOut: function (bounds) {
		var queue = [],
		    center = bounds.getCenter();

		var j, i, point;

		for (j = bounds.min.y; j <= bounds.max.y; j++) {
			for (i = bounds.min.x; i <= bounds.max.x; i++) {
				point = new L.Point(i, j);

				if (this._tileShouldBeLoaded(point)) {
					queue.push(point);
				}
			}
		}

		var tilesToLoad = queue.length;

		if (tilesToLoad === 0) { return; }

		// load tiles in order of their distance to center
		queue.sort(function (a, b) {
			return a.distanceTo(center) - b.distanceTo(center);
		});

		var fragment = document.createDocumentFragment();

		// if its the first batch of tiles to load
		if (!this._tilesToLoad) {
			this.fire('loading');
		}

		this._tilesToLoad += tilesToLoad;

		for (i = 0; i < tilesToLoad; i++) {
			this._addTile(queue[i], fragment);
		}

		this._tileContainer.appendChild(fragment);
	},

	_tileShouldBeLoaded: function (tilePoint) {
		if ((tilePoint.x + ':' + tilePoint.y) in this._tiles) {
			return false; // already loaded
		}

		var options = this.options;

		if (!options.continuousWorld) {
			var limit = this._getWrapTileNum();

			// don't load if exceeds world bounds
			if ((options.noWrap && (tilePoint.x < 0 || tilePoint.x >= limit.x)) ||
				tilePoint.y < 0 || tilePoint.y >= limit.y) { return false; }
		}

		if (options.bounds) {
			var tileSize = this._getTileSize(),
			    nwPoint = tilePoint.multiplyBy(tileSize),
			    sePoint = nwPoint.add([tileSize, tileSize]),
			    nw = this._map.unproject(nwPoint),
			    se = this._map.unproject(sePoint);

			// TODO temporary hack, will be removed after refactoring projections
			// https://github.com/Leaflet/Leaflet/issues/1618
			if (!options.continuousWorld && !options.noWrap) {
				nw = nw.wrap();
				se = se.wrap();
			}

			if (!options.bounds.intersects([nw, se])) { return false; }
		}

		return true;
	},

	_removeOtherTiles: function (bounds) {
		var kArr, x, y, key;

		for (key in this._tiles) {
			kArr = key.split(':');
			x = parseInt(kArr[0], 10);
			y = parseInt(kArr[1], 10);

			// remove tile if it's out of bounds
			if (x < bounds.min.x || x > bounds.max.x || y < bounds.min.y || y > bounds.max.y) {
				this._removeTile(key);
			}
		}
	},

	_removeTile: function (key) {
		var tile = this._tiles[key];

		this.fire('tileunload', {tile: tile, url: tile.src});

		if (this.options.reuseTiles) {
			L.DomUtil.removeClass(tile, 'leaflet-tile-loaded');
			this._unusedTiles.push(tile);

		} else if (tile.parentNode === this._tileContainer) {
			this._tileContainer.removeChild(tile);
		}

		// for https://github.com/CloudMade/Leaflet/issues/137
		if (!L.Browser.android) {
			tile.onload = null;
			tile.src = L.Util.emptyImageUrl;
		}

		delete this._tiles[key];
	},

	_addTile: function (tilePoint, container) {
		var tilePos = this._getTilePos(tilePoint);

		// get unused tile - or create a new tile
		var tile = this._getTile();

		/*
		Chrome 20 layouts much faster with top/left (verify with timeline, frames)
		Android 4 browser has display issues with top/left and requires transform instead
		(other browsers don't currently care) - see debug/hacks/jitter.html for an example
		*/
		L.DomUtil.setPosition(tile, tilePos, L.Browser.chrome);

		this._tiles[tilePoint.x + ':' + tilePoint.y] = tile;

		this._loadTile(tile, tilePoint);

		if (tile.parentNode !== this._tileContainer) {
			container.appendChild(tile);
		}
	},

	_getZoomForUrl: function () {

		var options = this.options,
		    zoom = this._map.getZoom();

		if (options.zoomReverse) {
			zoom = options.maxZoom - zoom;
		}

		zoom += options.zoomOffset;

		return options.maxNativeZoom ? Math.min(zoom, options.maxNativeZoom) : zoom;
	},

	_getTilePos: function (tilePoint) {
		var origin = this._map.getPixelOrigin(),
		    tileSize = this._getTileSize();

		return tilePoint.multiplyBy(tileSize).subtract(origin);
	},

	// image-specific code (override to implement e.g. Canvas or SVG tile layer)

	getTileUrl: function (tilePoint) {
		return L.Util.template(this._url, L.extend({
			s: this._getSubdomain(tilePoint),
			z: tilePoint.z,
			x: tilePoint.x,
			y: tilePoint.y
		}, this.options));
	},

	_getWrapTileNum: function () {
		var crs = this._map.options.crs,
		    size = crs.getSize(this._map.getZoom());
		return size.divideBy(this._getTileSize())._floor();
	},

	_adjustTilePoint: function (tilePoint) {

		var limit = this._getWrapTileNum();

		// wrap tile coordinates
		if (!this.options.continuousWorld && !this.options.noWrap) {
			tilePoint.x = ((tilePoint.x % limit.x) + limit.x) % limit.x;
		}

		if (this.options.tms) {
			tilePoint.y = limit.y - tilePoint.y - 1;
		}

		tilePoint.z = this._getZoomForUrl();
	},

	_getSubdomain: function (tilePoint) {
		var index = Math.abs(tilePoint.x + tilePoint.y) % this.options.subdomains.length;
		return this.options.subdomains[index];
	},

	_getTile: function () {
		if (this.options.reuseTiles && this._unusedTiles.length > 0) {
			var tile = this._unusedTiles.pop();
			this._resetTile(tile);
			return tile;
		}
		return this._createTile();
	},

	// Override if data stored on a tile needs to be cleaned up before reuse
	_resetTile: function (/*tile*/) {},

	_createTile: function () {
		var tile = L.DomUtil.create('img', 'leaflet-tile');
		tile.style.width = tile.style.height = this._getTileSize() + 'px';
		tile.galleryimg = 'no';

		tile.onselectstart = tile.onmousemove = L.Util.falseFn;

		if (L.Browser.ielt9 && this.options.opacity !== undefined) {
			L.DomUtil.setOpacity(tile, this.options.opacity);
		}
		// without this hack, tiles disappear after zoom on Chrome for Android
		// https://github.com/Leaflet/Leaflet/issues/2078
		if (L.Browser.mobileWebkit3d) {
			tile.style.WebkitBackfaceVisibility = 'hidden';
		}
		return tile;
	},

	_loadTile: function (tile, tilePoint) {
		tile._layer  = this;
		tile.onload  = this._tileOnLoad;
		tile.onerror = this._tileOnError;

		this._adjustTilePoint(tilePoint);
		tile.src     = this.getTileUrl(tilePoint);

		this.fire('tileloadstart', {
			tile: tile,
			url: tile.src
		});
	},

	_tileLoaded: function () {
		this._tilesToLoad--;

		if (this._animated) {
			L.DomUtil.addClass(this._tileContainer, 'leaflet-zoom-animated');
		}

		if (!this._tilesToLoad) {
			this.fire('load');

			if (this._animated) {
				// clear scaled tiles after all new tiles are loaded (for performance)
				clearTimeout(this._clearBgBufferTimer);
				this._clearBgBufferTimer = setTimeout(L.bind(this._clearBgBuffer, this), 500);
			}
		}
	},

	_tileOnLoad: function () {
		var layer = this._layer;

		//Only if we are loading an actual image
		if (this.src !== L.Util.emptyImageUrl) {
			L.DomUtil.addClass(this, 'leaflet-tile-loaded');

			layer.fire('tileload', {
				tile: this,
				url: this.src
			});
		}

		layer._tileLoaded();
	},

	_tileOnError: function () {
		var layer = this._layer;

		layer.fire('tileerror', {
			tile: this,
			url: this.src
		});

		var newUrl = layer.options.errorTileUrl;
		if (newUrl) {
			this.src = newUrl;
		}

		layer._tileLoaded();
	}
});

L.tileLayer = function (url, options) {
	return new L.TileLayer(url, options);
};


/*
 * L.TileLayer.WMS is used for putting WMS tile layers on the map.
 */

L.TileLayer.WMS = L.TileLayer.extend({

	defaultWmsParams: {
		service: 'WMS',
		request: 'GetMap',
		version: '1.1.1',
		layers: '',
		styles: '',
		format: 'image/jpeg',
		transparent: false
	},

	initialize: function (url, options) { // (String, Object)

		this._url = url;

		var wmsParams = L.extend({}, this.defaultWmsParams),
		    tileSize = options.tileSize || this.options.tileSize;

		if (options.detectRetina && L.Browser.retina) {
			wmsParams.width = wmsParams.height = tileSize * 2;
		} else {
			wmsParams.width = wmsParams.height = tileSize;
		}

		for (var i in options) {
			// all keys that are not TileLayer options go to WMS params
			if (!this.options.hasOwnProperty(i) && i !== 'crs') {
				wmsParams[i] = options[i];
			}
		}

		this.wmsParams = wmsParams;

		L.setOptions(this, options);
	},

	onAdd: function (map) {

		this._crs = this.options.crs || map.options.crs;

		this._wmsVersion = parseFloat(this.wmsParams.version);

		var projectionKey = this._wmsVersion >= 1.3 ? 'crs' : 'srs';
		this.wmsParams[projectionKey] = this._crs.code;

		L.TileLayer.prototype.onAdd.call(this, map);
	},

	getTileUrl: function (tilePoint) { // (Point, Number) -> String

		var map = this._map,
		    tileSize = this.options.tileSize,

		    nwPoint = tilePoint.multiplyBy(tileSize),
		    sePoint = nwPoint.add([tileSize, tileSize]),

		    nw = this._crs.project(map.unproject(nwPoint, tilePoint.z)),
		    se = this._crs.project(map.unproject(sePoint, tilePoint.z)),
		    bbox = this._wmsVersion >= 1.3 && this._crs === L.CRS.EPSG4326 ?
		        [se.y, nw.x, nw.y, se.x].join(',') :
		        [nw.x, se.y, se.x, nw.y].join(','),

		    url = L.Util.template(this._url, {s: this._getSubdomain(tilePoint)});

		return url + L.Util.getParamString(this.wmsParams, url, true) + '&BBOX=' + bbox;
	},

	setParams: function (params, noRedraw) {

		L.extend(this.wmsParams, params);

		if (!noRedraw) {
			this.redraw();
		}

		return this;
	}
});

L.tileLayer.wms = function (url, options) {
	return new L.TileLayer.WMS(url, options);
};


/*
 * L.TileLayer.Canvas is a class that you can use as a base for creating
 * dynamically drawn Canvas-based tile layers.
 */

L.TileLayer.Canvas = L.TileLayer.extend({
	options: {
		async: false
	},

	initialize: function (options) {
		L.setOptions(this, options);
	},

	redraw: function () {
		if (this._map) {
			this._reset({hard: true});
			this._update();
		}

		for (var i in this._tiles) {
			this._redrawTile(this._tiles[i]);
		}
		return this;
	},

	_redrawTile: function (tile) {
		this.drawTile(tile, tile._tilePoint, this._map._zoom);
	},

	_createTile: function () {
		var tile = L.DomUtil.create('canvas', 'leaflet-tile');
		tile.width = tile.height = this.options.tileSize;
		tile.onselectstart = tile.onmousemove = L.Util.falseFn;
		return tile;
	},

	_loadTile: function (tile, tilePoint) {
		tile._layer = this;
		tile._tilePoint = tilePoint;

		this._redrawTile(tile);

		if (!this.options.async) {
			this.tileDrawn(tile);
		}
	},

	drawTile: function (/*tile, tilePoint*/) {
		// override with rendering code
	},

	tileDrawn: function (tile) {
		this._tileOnLoad.call(tile);
	}
});


L.tileLayer.canvas = function (options) {
	return new L.TileLayer.Canvas(options);
};


/*
 * L.ImageOverlay is used to overlay images over the map (to specific geographical bounds).
 */

L.ImageOverlay = L.Class.extend({
	includes: L.Mixin.Events,

	options: {
		opacity: 1
	},

	initialize: function (url, bounds, options) { // (String, LatLngBounds, Object)
		this._url = url;
		this._bounds = L.latLngBounds(bounds);

		L.setOptions(this, options);
	},

	onAdd: function (map) {
		this._map = map;

		if (!this._image) {
			this._initImage();
		}

		map._panes.overlayPane.appendChild(this._image);

		map.on('viewreset', this._reset, this);

		if (map.options.zoomAnimation && L.Browser.any3d) {
			map.on('zoomanim', this._animateZoom, this);
		}

		this._reset();
	},

	onRemove: function (map) {
		map.getPanes().overlayPane.removeChild(this._image);

		map.off('viewreset', this._reset, this);

		if (map.options.zoomAnimation) {
			map.off('zoomanim', this._animateZoom, this);
		}
	},

	addTo: function (map) {
		map.addLayer(this);
		return this;
	},

	setOpacity: function (opacity) {
		this.options.opacity = opacity;
		this._updateOpacity();
		return this;
	},

	// TODO remove bringToFront/bringToBack duplication from TileLayer/Path
	bringToFront: function () {
		if (this._image) {
			this._map._panes.overlayPane.appendChild(this._image);
		}
		return this;
	},

	bringToBack: function () {
		var pane = this._map._panes.overlayPane;
		if (this._image) {
			pane.insertBefore(this._image, pane.firstChild);
		}
		return this;
	},

	setUrl: function (url) {
		this._url = url;
		this._image.src = this._url;
	},

	getAttribution: function () {
		return this.options.attribution;
	},

	_initImage: function () {
		this._image = L.DomUtil.create('img', 'leaflet-image-layer');

		if (this._map.options.zoomAnimation && L.Browser.any3d) {
			L.DomUtil.addClass(this._image, 'leaflet-zoom-animated');
		} else {
			L.DomUtil.addClass(this._image, 'leaflet-zoom-hide');
		}

		this._updateOpacity();

		//TODO createImage util method to remove duplication
		L.extend(this._image, {
			galleryimg: 'no',
			onselectstart: L.Util.falseFn,
			onmousemove: L.Util.falseFn,
			onload: L.bind(this._onImageLoad, this),
			src: this._url
		});
	},

	_animateZoom: function (e) {
		var map = this._map,
		    image = this._image,
		    scale = map.getZoomScale(e.zoom),
		    nw = this._bounds.getNorthWest(),
		    se = this._bounds.getSouthEast(),

		    topLeft = map._latLngToNewLayerPoint(nw, e.zoom, e.center),
		    size = map._latLngToNewLayerPoint(se, e.zoom, e.center)._subtract(topLeft),
		    origin = topLeft._add(size._multiplyBy((1 / 2) * (1 - 1 / scale)));

		image.style[L.DomUtil.TRANSFORM] =
		        L.DomUtil.getTranslateString(origin) + ' scale(' + scale + ') ';
	},

	_reset: function () {
		var image   = this._image,
		    topLeft = this._map.latLngToLayerPoint(this._bounds.getNorthWest()),
		    size = this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(topLeft);

		L.DomUtil.setPosition(image, topLeft);

		image.style.width  = size.x + 'px';
		image.style.height = size.y + 'px';
	},

	_onImageLoad: function () {
		this.fire('load');
	},

	_updateOpacity: function () {
		L.DomUtil.setOpacity(this._image, this.options.opacity);
	}
});

L.imageOverlay = function (url, bounds, options) {
	return new L.ImageOverlay(url, bounds, options);
};


/*
 * L.Icon is an image-based icon class that you can use with L.Marker for custom markers.
 */

L.Icon = L.Class.extend({
	options: {
		/*
		iconUrl: (String) (required)
		iconRetinaUrl: (String) (optional, used for retina devices if detected)
		iconSize: (Point) (can be set through CSS)
		iconAnchor: (Point) (centered by default, can be set in CSS with negative margins)
		popupAnchor: (Point) (if not specified, popup opens in the anchor point)
		shadowUrl: (String) (no shadow by default)
		shadowRetinaUrl: (String) (optional, used for retina devices if detected)
		shadowSize: (Point)
		shadowAnchor: (Point)
		*/
		className: ''
	},

	initialize: function (options) {
		L.setOptions(this, options);
	},

	createIcon: function (oldIcon) {
		return this._createIcon('icon', oldIcon);
	},

	createShadow: function (oldIcon) {
		return this._createIcon('shadow', oldIcon);
	},

	_createIcon: function (name, oldIcon) {
		var src = this._getIconUrl(name);

		if (!src) {
			if (name === 'icon') {
				throw new Error('iconUrl not set in Icon options (see the docs).');
			}
			return null;
		}

		var img;
		if (!oldIcon || oldIcon.tagName !== 'IMG') {
			img = this._createImg(src);
		} else {
			img = this._createImg(src, oldIcon);
		}
		this._setIconStyles(img, name);

		return img;
	},

	_setIconStyles: function (img, name) {
		var options = this.options,
		    size = L.point(options[name + 'Size']),
		    anchor;

		if (name === 'shadow') {
			anchor = L.point(options.shadowAnchor || options.iconAnchor);
		} else {
			anchor = L.point(options.iconAnchor);
		}

		if (!anchor && size) {
			anchor = size.divideBy(2, true);
		}

		img.className = 'leaflet-marker-' + name + ' ' + options.className;

		if (anchor) {
			img.style.marginLeft = (-anchor.x) + 'px';
			img.style.marginTop  = (-anchor.y) + 'px';
		}

		if (size) {
			img.style.width  = size.x + 'px';
			img.style.height = size.y + 'px';
		}
	},

	_createImg: function (src, el) {
		el = el || document.createElement('img');
		el.src = src;
		return el;
	},

	_getIconUrl: function (name) {
		if (L.Browser.retina && this.options[name + 'RetinaUrl']) {
			return this.options[name + 'RetinaUrl'];
		}
		return this.options[name + 'Url'];
	}
});

L.icon = function (options) {
	return new L.Icon(options);
};


/*
 * L.Icon.Default is the blue marker icon used by default in Leaflet.
 */

L.Icon.Default = L.Icon.extend({

	options: {
		iconSize: [25, 41],
		iconAnchor: [12, 41],
		popupAnchor: [1, -34],

		shadowSize: [41, 41]
	},

	_getIconUrl: function (name) {
		var key = name + 'Url';

		if (this.options[key]) {
			return this.options[key];
		}

		if (L.Browser.retina && name === 'icon') {
			name += '-2x';
		}

		var path = L.Icon.Default.imagePath;

		if (!path) {
			throw new Error('Couldn\'t autodetect L.Icon.Default.imagePath, set it manually.');
		}

		return path + '/marker-' + name + '.png';
	}
});

L.Icon.Default.imagePath = (function () {
	var scripts = document.getElementsByTagName('script'),
	    leafletRe = /[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;

	var i, len, src, matches, path;

	for (i = 0, len = scripts.length; i < len; i++) {
		src = scripts[i].src;
		matches = src.match(leafletRe);

		if (matches) {
			path = src.split(leafletRe)[0];
			return (path ? path + '/' : '') + 'images';
		}
	}
}());


/*
 * L.Marker is used to display clickable/draggable icons on the map.
 */

L.Marker = L.Class.extend({

	includes: L.Mixin.Events,

	options: {
		icon: new L.Icon.Default(),
		title: '',
		alt: '',
		clickable: true,
		draggable: false,
		keyboard: true,
		zIndexOffset: 0,
		opacity: 1,
		riseOnHover: false,
		riseOffset: 250
	},

	initialize: function (latlng, options) {
		L.setOptions(this, options);
		this._latlng = L.latLng(latlng);
	},

	onAdd: function (map) {
		this._map = map;

		map.on('viewreset', this.update, this);

		this._initIcon();
		this.update();
		this.fire('add');

		if (map.options.zoomAnimation && map.options.markerZoomAnimation) {
			map.on('zoomanim', this._animateZoom, this);
		}
	},

	addTo: function (map) {
		map.addLayer(this);
		return this;
	},

	onRemove: function (map) {
		if (this.dragging) {
			this.dragging.disable();
		}

		this._removeIcon();
		this._removeShadow();

		this.fire('remove');

		map.off({
			'viewreset': this.update,
			'zoomanim': this._animateZoom
		}, this);

		this._map = null;
	},

	getLatLng: function () {
		return this._latlng;
	},

	setLatLng: function (latlng) {
		this._latlng = L.latLng(latlng);

		this.update();

		return this.fire('move', { latlng: this._latlng });
	},

	setZIndexOffset: function (offset) {
		this.options.zIndexOffset = offset;
		this.update();

		return this;
	},

	setIcon: function (icon) {

		this.options.icon = icon;

		if (this._map) {
			this._initIcon();
			this.update();
		}

		if (this._popup) {
			this.bindPopup(this._popup);
		}

		return this;
	},

	update: function () {
		if (this._icon) {
			this._setPos(this._map.latLngToLayerPoint(this._latlng).round());
		}
		return this;
	},

	_initIcon: function () {
		var options = this.options,
		    map = this._map,
		    animation = (map.options.zoomAnimation && map.options.markerZoomAnimation),
		    classToAdd = animation ? 'leaflet-zoom-animated' : 'leaflet-zoom-hide';

		var icon = options.icon.createIcon(this._icon),
			addIcon = false;

		// if we're not reusing the icon, remove the old one and init new one
		if (icon !== this._icon) {
			if (this._icon) {
				this._removeIcon();
			}
			addIcon = true;

			if (options.title) {
				icon.title = options.title;
			}

			if (options.alt) {
				icon.alt = options.alt;
			}
		}

		L.DomUtil.addClass(icon, classToAdd);

		if (options.keyboard) {
			icon.tabIndex = '0';
		}

		this._icon = icon;

		this._initInteraction();

		if (options.riseOnHover) {
			L.DomEvent
				.on(icon, 'mouseover', this._bringToFront, this)
				.on(icon, 'mouseout', this._resetZIndex, this);
		}

		var newShadow = options.icon.createShadow(this._shadow),
			addShadow = false;

		if (newShadow !== this._shadow) {
			this._removeShadow();
			addShadow = true;
		}

		if (newShadow) {
			L.DomUtil.addClass(newShadow, classToAdd);
		}
		this._shadow = newShadow;


		if (options.opacity < 1) {
			this._updateOpacity();
		}


		var panes = this._map._panes;

		if (addIcon) {
			panes.markerPane.appendChild(this._icon);
		}

		if (newShadow && addShadow) {
			panes.shadowPane.appendChild(this._shadow);
		}
	},

	_removeIcon: function () {
		if (this.options.riseOnHover) {
			L.DomEvent
			    .off(this._icon, 'mouseover', this._bringToFront)
			    .off(this._icon, 'mouseout', this._resetZIndex);
		}

		this._map._panes.markerPane.removeChild(this._icon);

		this._icon = null;
	},

	_removeShadow: function () {
		if (this._shadow) {
			this._map._panes.shadowPane.removeChild(this._shadow);
		}
		this._shadow = null;
	},

	_setPos: function (pos) {
		L.DomUtil.setPosition(this._icon, pos);

		if (this._shadow) {
			L.DomUtil.setPosition(this._shadow, pos);
		}

		this._zIndex = pos.y + this.options.zIndexOffset;

		this._resetZIndex();
	},

	_updateZIndex: function (offset) {
		this._icon.style.zIndex = this._zIndex + offset;
	},

	_animateZoom: function (opt) {
		var pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center).round();

		this._setPos(pos);
	},

	_initInteraction: function () {

		if (!this.options.clickable) { return; }

		// TODO refactor into something shared with Map/Path/etc. to DRY it up

		var icon = this._icon,
		    events = ['dblclick', 'mousedown', 'mouseover', 'mouseout', 'contextmenu'];

		L.DomUtil.addClass(icon, 'leaflet-clickable');
		L.DomEvent.on(icon, 'click', this._onMouseClick, this);
		L.DomEvent.on(icon, 'keypress', this._onKeyPress, this);

		for (var i = 0; i < events.length; i++) {
			L.DomEvent.on(icon, events[i], this._fireMouseEvent, this);
		}

		if (L.Handler.MarkerDrag) {
			this.dragging = new L.Handler.MarkerDrag(this);

			if (this.options.draggable) {
				this.dragging.enable();
			}
		}
	},

	_onMouseClick: function (e) {
		var wasDragged = this.dragging && this.dragging.moved();

		if (this.hasEventListeners(e.type) || wasDragged) {
			L.DomEvent.stopPropagation(e);
		}

		if (wasDragged) { return; }

		if ((!this.dragging || !this.dragging._enabled) && this._map.dragging && this._map.dragging.moved()) { return; }

		this.fire(e.type, {
			originalEvent: e,
			latlng: this._latlng
		});
	},

	_onKeyPress: function (e) {
		if (e.keyCode === 13) {
			this.fire('click', {
				originalEvent: e,
				latlng: this._latlng
			});
		}
	},

	_fireMouseEvent: function (e) {

		this.fire(e.type, {
			originalEvent: e,
			latlng: this._latlng
		});

		// TODO proper custom event propagation
		// this line will always be called if marker is in a FeatureGroup
		if (e.type === 'contextmenu' && this.hasEventListeners(e.type)) {
			L.DomEvent.preventDefault(e);
		}
		if (e.type !== 'mousedown') {
			L.DomEvent.stopPropagation(e);
		} else {
			L.DomEvent.preventDefault(e);
		}
	},

	setOpacity: function (opacity) {
		this.options.opacity = opacity;
		if (this._map) {
			this._updateOpacity();
		}

		return this;
	},

	_updateOpacity: function () {
		L.DomUtil.setOpacity(this._icon, this.options.opacity);
		if (this._shadow) {
			L.DomUtil.setOpacity(this._shadow, this.options.opacity);
		}
	},

	_bringToFront: function () {
		this._updateZIndex(this.options.riseOffset);
	},

	_resetZIndex: function () {
		this._updateZIndex(0);
	}
});

L.marker = function (latlng, options) {
	return new L.Marker(latlng, options);
};


/*
 * L.DivIcon is a lightweight HTML-based icon class (as opposed to the image-based L.Icon)
 * to use with L.Marker.
 */

L.DivIcon = L.Icon.extend({
	options: {
		iconSize: [12, 12], // also can be set through CSS
		/*
		iconAnchor: (Point)
		popupAnchor: (Point)
		html: (String)
		bgPos: (Point)
		*/
		className: 'leaflet-div-icon',
		html: false
	},

	createIcon: function (oldIcon) {
		var div = (oldIcon && oldIcon.tagName === 'DIV') ? oldIcon : document.createElement('div'),
		    options = this.options;

		if (options.html !== false) {
			div.innerHTML = options.html;
		} else {
			div.innerHTML = '';
		}

		if (options.bgPos) {
			div.style.backgroundPosition =
			        (-options.bgPos.x) + 'px ' + (-options.bgPos.y) + 'px';
		}

		this._setIconStyles(div, 'icon');
		return div;
	},

	createShadow: function () {
		return null;
	}
});

L.divIcon = function (options) {
	return new L.DivIcon(options);
};


/*
 * L.Popup is used for displaying popups on the map.
 */

L.Map.mergeOptions({
	closePopupOnClick: true
});

L.Popup = L.Class.extend({
	includes: L.Mixin.Events,

	options: {
		minWidth: 50,
		maxWidth: 300,
		// maxHeight: null,
		autoPan: true,
		closeButton: true,
		offset: [0, 7],
		autoPanPadding: [5, 5],
		// autoPanPaddingTopLeft: null,
		// autoPanPaddingBottomRight: null,
		keepInView: false,
		className: '',
		zoomAnimation: true
	},

	initialize: function (options, source) {
		L.setOptions(this, options);

		this._source = source;
		this._animated = L.Browser.any3d && this.options.zoomAnimation;
		this._isOpen = false;
	},

	onAdd: function (map) {
		this._map = map;

		if (!this._container) {
			this._initLayout();
		}

		var animFade = map.options.fadeAnimation;

		if (animFade) {
			L.DomUtil.setOpacity(this._container, 0);
		}
		map._panes.popupPane.appendChild(this._container);

		map.on(this._getEvents(), this);

		this.update();

		if (animFade) {
			L.DomUtil.setOpacity(this._container, 1);
		}

		this.fire('open');

		map.fire('popupopen', {popup: this});

		if (this._source) {
			this._source.fire('popupopen', {popup: this});
		}
	},

	addTo: function (map) {
		map.addLayer(this);
		return this;
	},

	openOn: function (map) {
		map.openPopup(this);
		return this;
	},

	onRemove: function (map) {
		map._panes.popupPane.removeChild(this._container);

		L.Util.falseFn(this._container.offsetWidth); // force reflow

		map.off(this._getEvents(), this);

		if (map.options.fadeAnimation) {
			L.DomUtil.setOpacity(this._container, 0);
		}

		this._map = null;

		this.fire('close');

		map.fire('popupclose', {popup: this});

		if (this._source) {
			this._source.fire('popupclose', {popup: this});
		}
	},

	getLatLng: function () {
		return this._latlng;
	},

	setLatLng: function (latlng) {
		this._latlng = L.latLng(latlng);
		if (this._map) {
			this._updatePosition();
			this._adjustPan();
		}
		return this;
	},

	getContent: function () {
		return this._content;
	},

	setContent: function (content) {
		this._content = content;
		this.update();
		return this;
	},

	update: function () {
		if (!this._map) { return; }

		this._container.style.visibility = 'hidden';

		this._updateContent();
		this._updateLayout();
		this._updatePosition();

		this._container.style.visibility = '';

		this._adjustPan();
	},

	_getEvents: function () {
		var events = {
			viewreset: this._updatePosition
		};

		if (this._animated) {
			events.zoomanim = this._zoomAnimation;
		}
		if ('closeOnClick' in this.options ? this.options.closeOnClick : this._map.options.closePopupOnClick) {
			events.preclick = this._close;
		}
		if (this.options.keepInView) {
			events.moveend = this._adjustPan;
		}

		return events;
	},

	_close: function () {
		if (this._map) {
			this._map.closePopup(this);
		}
	},

	_initLayout: function () {
		var prefix = 'leaflet-popup',
			containerClass = prefix + ' ' + this.options.className + ' leaflet-zoom-' +
			        (this._animated ? 'animated' : 'hide'),
			container = this._container = L.DomUtil.create('div', containerClass),
			closeButton;

		if (this.options.closeButton) {
			closeButton = this._closeButton =
			        L.DomUtil.create('a', prefix + '-close-button', container);
			closeButton.href = '#close';
			closeButton.innerHTML = '&#215;';
			L.DomEvent.disableClickPropagation(closeButton);

			L.DomEvent.on(closeButton, 'click', this._onCloseButtonClick, this);
		}

		var wrapper = this._wrapper =
		        L.DomUtil.create('div', prefix + '-content-wrapper', container);
		L.DomEvent.disableClickPropagation(wrapper);

		this._contentNode = L.DomUtil.create('div', prefix + '-content', wrapper);

		L.DomEvent.disableScrollPropagation(this._contentNode);
		L.DomEvent.on(wrapper, 'contextmenu', L.DomEvent.stopPropagation);

		this._tipContainer = L.DomUtil.create('div', prefix + '-tip-container', container);
		this._tip = L.DomUtil.create('div', prefix + '-tip', this._tipContainer);
	},

	_updateContent: function () {
		if (!this._content) { return; }

		if (typeof this._content === 'string') {
			this._contentNode.innerHTML = this._content;
		} else {
			while (this._contentNode.hasChildNodes()) {
				this._contentNode.removeChild(this._contentNode.firstChild);
			}
			this._contentNode.appendChild(this._content);
		}
		this.fire('contentupdate');
	},

	_updateLayout: function () {
		var container = this._contentNode,
		    style = container.style;

		style.width = '';
		style.whiteSpace = 'nowrap';

		var width = container.offsetWidth;
		width = Math.min(width, this.options.maxWidth);
		width = Math.max(width, this.options.minWidth);

		style.width = (width + 1) + 'px';
		style.whiteSpace = '';

		style.height = '';

		var height = container.offsetHeight,
		    maxHeight = this.options.maxHeight,
		    scrolledClass = 'leaflet-popup-scrolled';

		if (maxHeight && height > maxHeight) {
			style.height = maxHeight + 'px';
			L.DomUtil.addClass(container, scrolledClass);
		} else {
			L.DomUtil.removeClass(container, scrolledClass);
		}

		this._containerWidth = this._container.offsetWidth;
	},

	_updatePosition: function () {
		if (!this._map) { return; }

		var pos = this._map.latLngToLayerPoint(this._latlng),
		    animated = this._animated,
		    offset = L.point(this.options.offset);

		if (animated) {
			L.DomUtil.setPosition(this._container, pos);
		}

		this._containerBottom = -offset.y - (animated ? 0 : pos.y);
		this._containerLeft = -Math.round(this._containerWidth / 2) + offset.x + (animated ? 0 : pos.x);

		// bottom position the popup in case the height of the popup changes (images loading etc)
		this._container.style.bottom = this._containerBottom + 'px';
		this._container.style.left = this._containerLeft + 'px';
	},

	_zoomAnimation: function (opt) {
		var pos = this._map._latLngToNewLayerPoint(this._latlng, opt.zoom, opt.center);

		L.DomUtil.setPosition(this._container, pos);
	},

	_adjustPan: function () {
		if (!this.options.autoPan) { return; }

		var map = this._map,
		    containerHeight = this._container.offsetHeight,
		    containerWidth = this._containerWidth,

		    layerPos = new L.Point(this._containerLeft, -containerHeight - this._containerBottom);

		if (this._animated) {
			layerPos._add(L.DomUtil.getPosition(this._container));
		}

		var containerPos = map.layerPointToContainerPoint(layerPos),
		    padding = L.point(this.options.autoPanPadding),
		    paddingTL = L.point(this.options.autoPanPaddingTopLeft || padding),
		    paddingBR = L.point(this.options.autoPanPaddingBottomRight || padding),
		    size = map.getSize(),
		    dx = 0,
		    dy = 0;

		if (containerPos.x + containerWidth + paddingBR.x > size.x) { // right
			dx = containerPos.x + containerWidth - size.x + paddingBR.x;
		}
		if (containerPos.x - dx - paddingTL.x < 0) { // left
			dx = containerPos.x - paddingTL.x;
		}
		if (containerPos.y + containerHeight + paddingBR.y > size.y) { // bottom
			dy = containerPos.y + containerHeight - size.y + paddingBR.y;
		}
		if (containerPos.y - dy - paddingTL.y < 0) { // top
			dy = containerPos.y - paddingTL.y;
		}

		if (dx || dy) {
			map
			    .fire('autopanstart')
			    .panBy([dx, dy]);
		}
	},

	_onCloseButtonClick: function (e) {
		this._close();
		L.DomEvent.stop(e);
	}
});

L.popup = function (options, source) {
	return new L.Popup(options, source);
};


L.Map.include({
	openPopup: function (popup, latlng, options) { // (Popup) or (String || HTMLElement, LatLng[, Object])
		this.closePopup();

		if (!(popup instanceof L.Popup)) {
			var content = popup;

			popup = new L.Popup(options)
			    .setLatLng(latlng)
			    .setContent(content);
		}
		popup._isOpen = true;

		this._popup = popup;
		return this.addLayer(popup);
	},

	closePopup: function (popup) {
		if (!popup || popup === this._popup) {
			popup = this._popup;
			this._popup = null;
		}
		if (popup) {
			this.removeLayer(popup);
			popup._isOpen = false;
		}
		return this;
	}
});


/*
 * Popup extension to L.Marker, adding popup-related methods.
 */

L.Marker.include({
	openPopup: function () {
		if (this._popup && this._map && !this._map.hasLayer(this._popup)) {
			this._popup.setLatLng(this._latlng);
			this._map.openPopup(this._popup);
		}

		return this;
	},

	closePopup: function () {
		if (this._popup) {
			this._popup._close();
		}
		return this;
	},

	togglePopup: function () {
		if (this._popup) {
			if (this._popup._isOpen) {
				this.closePopup();
			} else {
				this.openPopup();
			}
		}
		return this;
	},

	bindPopup: function (content, options) {
		var anchor = L.point(this.options.icon.options.popupAnchor || [0, 0]);

		anchor = anchor.add(L.Popup.prototype.options.offset);

		if (options && options.offset) {
			anchor = anchor.add(options.offset);
		}

		options = L.extend({offset: anchor}, options);

		if (!this._popupHandlersAdded) {
			this
			    .on('click', this.togglePopup, this)
			    .on('remove', this.closePopup, this)
			    .on('move', this._movePopup, this);
			this._popupHandlersAdded = true;
		}

		if (content instanceof L.Popup) {
			L.setOptions(content, options);
			this._popup = content;
			content._source = this;
		} else {
			this._popup = new L.Popup(options, this)
				.setContent(content);
		}

		return this;
	},

	setPopupContent: function (content) {
		if (this._popup) {
			this._popup.setContent(content);
		}
		return this;
	},

	unbindPopup: function () {
		if (this._popup) {
			this._popup = null;
			this
			    .off('click', this.togglePopup, this)
			    .off('remove', this.closePopup, this)
			    .off('move', this._movePopup, this);
			this._popupHandlersAdded = false;
		}
		return this;
	},

	getPopup: function () {
		return this._popup;
	},

	_movePopup: function (e) {
		this._popup.setLatLng(e.latlng);
	}
});


/*
 * L.LayerGroup is a class to combine several layers into one so that
 * you can manipulate the group (e.g. add/remove it) as one layer.
 */

L.LayerGroup = L.Class.extend({
	initialize: function (layers) {
		this._layers = {};

		var i, len;

		if (layers) {
			for (i = 0, len = layers.length; i < len; i++) {
				this.addLayer(layers[i]);
			}
		}
	},

	addLayer: function (layer) {
		var id = this.getLayerId(layer);

		this._layers[id] = layer;

		if (this._map) {
			this._map.addLayer(layer);
		}

		return this;
	},

	removeLayer: function (layer) {
		var id = layer in this._layers ? layer : this.getLayerId(layer);

		if (this._map && this._layers[id]) {
			this._map.removeLayer(this._layers[id]);
		}

		delete this._layers[id];

		return this;
	},

	hasLayer: function (layer) {
		if (!layer) { return false; }

		return (layer in this._layers || this.getLayerId(layer) in this._layers);
	},

	clearLayers: function () {
		this.eachLayer(this.removeLayer, this);
		return this;
	},

	invoke: function (methodName) {
		var args = Array.prototype.slice.call(arguments, 1),
		    i, layer;

		for (i in this._layers) {
			layer = this._layers[i];

			if (layer[methodName]) {
				layer[methodName].apply(layer, args);
			}
		}

		return this;
	},

	onAdd: function (map) {
		this._map = map;
		this.eachLayer(map.addLayer, map);
	},

	onRemove: function (map) {
		this.eachLayer(map.removeLayer, map);
		this._map = null;
	},

	addTo: function (map) {
		map.addLayer(this);
		return this;
	},

	eachLayer: function (method, context) {
		for (var i in this._layers) {
			method.call(context, this._layers[i]);
		}
		return this;
	},

	getLayer: function (id) {
		return this._layers[id];
	},

	getLayers: function () {
		var layers = [];

		for (var i in this._layers) {
			layers.push(this._layers[i]);
		}
		return layers;
	},

	setZIndex: function (zIndex) {
		return this.invoke('setZIndex', zIndex);
	},

	getLayerId: function (layer) {
		return L.stamp(layer);
	}
});

L.layerGroup = function (layers) {
	return new L.LayerGroup(layers);
};


/*
 * L.FeatureGroup extends L.LayerGroup by introducing mouse events and additional methods
 * shared between a group of interactive layers (like vectors or markers).
 */

L.FeatureGroup = L.LayerGroup.extend({
	includes: L.Mixin.Events,

	statics: {
		EVENTS: 'click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose'
	},

	addLayer: function (layer) {
		if (this.hasLayer(layer)) {
			return this;
		}

		if ('on' in layer) {
			layer.on(L.FeatureGroup.EVENTS, this._propagateEvent, this);
		}

		L.LayerGroup.prototype.addLayer.call(this, layer);

		if (this._popupContent && layer.bindPopup) {
			layer.bindPopup(this._popupContent, this._popupOptions);
		}

		return this.fire('layeradd', {layer: layer});
	},

	removeLayer: function (layer) {
		if (!this.hasLayer(layer)) {
			return this;
		}
		if (layer in this._layers) {
			layer = this._layers[layer];
		}

		layer.off(L.FeatureGroup.EVENTS, this._propagateEvent, this);

		L.LayerGroup.prototype.removeLayer.call(this, layer);

		if (this._popupContent) {
			this.invoke('unbindPopup');
		}

		return this.fire('layerremove', {layer: layer});
	},

	bindPopup: function (content, options) {
		this._popupContent = content;
		this._popupOptions = options;
		return this.invoke('bindPopup', content, options);
	},

	openPopup: function (latlng) {
		// open popup on the first layer
		for (var id in this._layers) {
			this._layers[id].openPopup(latlng);
			break;
		}
		return this;
	},

	setStyle: function (style) {
		return this.invoke('setStyle', style);
	},

	bringToFront: function () {
		return this.invoke('bringToFront');
	},

	bringToBack: function () {
		return this.invoke('bringToBack');
	},

	getBounds: function () {
		var bounds = new L.LatLngBounds();

		this.eachLayer(function (layer) {
			bounds.extend(layer instanceof L.Marker ? layer.getLatLng() : layer.getBounds());
		});

		return bounds;
	},

	_propagateEvent: function (e) {
		e = L.extend({
			layer: e.target,
			target: this
		}, e);
		this.fire(e.type, e);
	}
});

L.featureGroup = function (layers) {
	return new L.FeatureGroup(layers);
};


/*
 * L.Path is a base class for rendering vector paths on a map. Inherited by Polyline, Circle, etc.
 */

L.Path = L.Class.extend({
	includes: [L.Mixin.Events],

	statics: {
		// how much to extend the clip area around the map view
		// (relative to its size, e.g. 0.5 is half the screen in each direction)
		// set it so that SVG element doesn't exceed 1280px (vectors flicker on dragend if it is)
		CLIP_PADDING: (function () {
			var max = L.Browser.mobile ? 1280 : 2000,
			    target = (max / Math.max(window.outerWidth, window.outerHeight) - 1) / 2;
			return Math.max(0, Math.min(0.5, target));
		})()
	},

	options: {
		stroke: true,
		color: '#0033ff',
		dashArray: null,
		lineCap: null,
		lineJoin: null,
		weight: 5,
		opacity: 0.5,

		fill: false,
		fillColor: null, //same as color by default
		fillOpacity: 0.2,

		clickable: true
	},

	initialize: function (options) {
		L.setOptions(this, options);
	},

	onAdd: function (map) {
		this._map = map;

		if (!this._container) {
			this._initElements();
			this._initEvents();
		}

		this.projectLatlngs();
		this._updatePath();

		if (this._container) {
			this._map._pathRoot.appendChild(this._container);
		}

		this.fire('add');

		map.on({
			'viewreset': this.projectLatlngs,
			'moveend': this._updatePath
		}, this);
	},

	addTo: function (map) {
		map.addLayer(this);
		return this;
	},

	onRemove: function (map) {
		map._pathRoot.removeChild(this._container);

		// Need to fire remove event before we set _map to null as the event hooks might need the object
		this.fire('remove');
		this._map = null;

		if (L.Browser.vml) {
			this._container = null;
			this._stroke = null;
			this._fill = null;
		}

		map.off({
			'viewreset': this.projectLatlngs,
			'moveend': this._updatePath
		}, this);
	},

	projectLatlngs: function () {
		// do all projection stuff here
	},

	setStyle: function (style) {
		L.setOptions(this, style);

		if (this._container) {
			this._updateStyle();
		}

		return this;
	},

	redraw: function () {
		if (this._map) {
			this.projectLatlngs();
			this._updatePath();
		}
		return this;
	}
});

L.Map.include({
	_updatePathViewport: function () {
		var p = L.Path.CLIP_PADDING,
		    size = this.getSize(),
		    panePos = L.DomUtil.getPosition(this._mapPane),
		    min = panePos.multiplyBy(-1)._subtract(size.multiplyBy(p)._round()),
		    max = min.add(size.multiplyBy(1 + p * 2)._round());

		this._pathViewport = new L.Bounds(min, max);
	}
});


/*
 * Extends L.Path with SVG-specific rendering code.
 */

L.Path.SVG_NS = 'http://www.w3.org/2000/svg';

L.Browser.svg = !!(document.createElementNS && document.createElementNS(L.Path.SVG_NS, 'svg').createSVGRect);

L.Path = L.Path.extend({
	statics: {
		SVG: L.Browser.svg
	},

	bringToFront: function () {
		var root = this._map._pathRoot,
		    path = this._container;

		if (path && root.lastChild !== path) {
			root.appendChild(path);
		}
		return this;
	},

	bringToBack: function () {
		var root = this._map._pathRoot,
		    path = this._container,
		    first = root.firstChild;

		if (path && first !== path) {
			root.insertBefore(path, first);
		}
		return this;
	},

	getPathString: function () {
		// form path string here
	},

	_createElement: function (name) {
		return document.createElementNS(L.Path.SVG_NS, name);
	},

	_initElements: function () {
		this._map._initPathRoot();
		this._initPath();
		this._initStyle();
	},

	_initPath: function () {
		this._container = this._createElement('g');

		this._path = this._createElement('path');

		if (this.options.className) {
			L.DomUtil.addClass(this._path, this.options.className);
		}

		this._container.appendChild(this._path);
	},

	_initStyle: function () {
		if (this.options.stroke) {
			this._path.setAttribute('stroke-linejoin', 'round');
			this._path.setAttribute('stroke-linecap', 'round');
		}
		if (this.options.fill) {
			this._path.setAttribute('fill-rule', 'evenodd');
		}
		if (this.options.pointerEvents) {
			this._path.setAttribute('pointer-events', this.options.pointerEvents);
		}
		if (!this.options.clickable && !this.options.pointerEvents) {
			this._path.setAttribute('pointer-events', 'none');
		}
		this._updateStyle();
	},

	_updateStyle: function () {
		if (this.options.stroke) {
			this._path.setAttribute('stroke', this.options.color);
			this._path.setAttribute('stroke-opacity', this.options.opacity);
			this._path.setAttribute('stroke-width', this.options.weight);
			if (this.options.dashArray) {
				this._path.setAttribute('stroke-dasharray', this.options.dashArray);
			} else {
				this._path.removeAttribute('stroke-dasharray');
			}
			if (this.options.lineCap) {
				this._path.setAttribute('stroke-linecap', this.options.lineCap);
			}
			if (this.options.lineJoin) {
				this._path.setAttribute('stroke-linejoin', this.options.lineJoin);
			}
		} else {
			this._path.setAttribute('stroke', 'none');
		}
		if (this.options.fill) {
			this._path.setAttribute('fill', this.options.fillColor || this.options.color);
			this._path.setAttribute('fill-opacity', this.options.fillOpacity);
		} else {
			this._path.setAttribute('fill', 'none');
		}
	},

	_updatePath: function () {
		var str = this.getPathString();
		if (!str) {
			// fix webkit empty string parsing bug
			str = 'M0 0';
		}
		this._path.setAttribute('d', str);
	},

	// TODO remove duplication with L.Map
	_initEvents: function () {
		if (this.options.clickable) {
			if (L.Browser.svg || !L.Browser.vml) {
				L.DomUtil.addClass(this._path, 'leaflet-clickable');
			}

			L.DomEvent.on(this._container, 'click', this._onMouseClick, this);

			var events = ['dblclick', 'mousedown', 'mouseover',
			              'mouseout', 'mousemove', 'contextmenu'];
			for (var i = 0; i < events.length; i++) {
				L.DomEvent.on(this._container, events[i], this._fireMouseEvent, this);
			}
		}
	},

	_onMouseClick: function (e) {
		if (this._map.dragging && this._map.dragging.moved()) { return; }

		this._fireMouseEvent(e);
	},

	_fireMouseEvent: function (e) {
		if (!this.hasEventListeners(e.type)) { return; }

		var map = this._map,
		    containerPoint = map.mouseEventToContainerPoint(e),
		    layerPoint = map.containerPointToLayerPoint(containerPoint),
		    latlng = map.layerPointToLatLng(layerPoint);

		this.fire(e.type, {
			latlng: latlng,
			layerPoint: layerPoint,
			containerPoint: containerPoint,
			originalEvent: e
		});

		if (e.type === 'contextmenu') {
			L.DomEvent.preventDefault(e);
		}
		if (e.type !== 'mousemove') {
			L.DomEvent.stopPropagation(e);
		}
	}
});

L.Map.include({
	_initPathRoot: function () {
		if (!this._pathRoot) {
			this._pathRoot = L.Path.prototype._createElement('svg');
			this._panes.overlayPane.appendChild(this._pathRoot);

			if (this.options.zoomAnimation && L.Browser.any3d) {
				L.DomUtil.addClass(this._pathRoot, 'leaflet-zoom-animated');

				this.on({
					'zoomanim': this._animatePathZoom,
					'zoomend': this._endPathZoom
				});
			} else {
				L.DomUtil.addClass(this._pathRoot, 'leaflet-zoom-hide');
			}

			this.on('moveend', this._updateSvgViewport);
			this._updateSvgViewport();
		}
	},

	_animatePathZoom: function (e) {
		var scale = this.getZoomScale(e.zoom),
		    offset = this._getCenterOffset(e.center)._multiplyBy(-scale)._add(this._pathViewport.min);

		this._pathRoot.style[L.DomUtil.TRANSFORM] =
		        L.DomUtil.getTranslateString(offset) + ' scale(' + scale + ') ';

		this._pathZooming = true;
	},

	_endPathZoom: function () {
		this._pathZooming = false;
	},

	_updateSvgViewport: function () {

		if (this._pathZooming) {
			// Do not update SVGs while a zoom animation is going on otherwise the animation will break.
			// When the zoom animation ends we will be updated again anyway
			// This fixes the case where you do a momentum move and zoom while the move is still ongoing.
			return;
		}

		this._updatePathViewport();

		var vp = this._pathViewport,
		    min = vp.min,
		    max = vp.max,
		    width = max.x - min.x,
		    height = max.y - min.y,
		    root = this._pathRoot,
		    pane = this._panes.overlayPane;

		// Hack to make flicker on drag end on mobile webkit less irritating
		if (L.Browser.mobileWebkit) {
			pane.removeChild(root);
		}

		L.DomUtil.setPosition(root, min);
		root.setAttribute('width', width);
		root.setAttribute('height', height);
		root.setAttribute('viewBox', [min.x, min.y, width, height].join(' '));

		if (L.Browser.mobileWebkit) {
			pane.appendChild(root);
		}
	}
});


/*
 * Popup extension to L.Path (polylines, polygons, circles), adding popup-related methods.
 */

L.Path.include({

	bindPopup: function (content, options) {

		if (content instanceof L.Popup) {
			this._popup = content;
		} else {
			if (!this._popup || options) {
				this._popup = new L.Popup(options, this);
			}
			this._popup.setContent(content);
		}

		if (!this._popupHandlersAdded) {
			this
			    .on('click', this._openPopup, this)
			    .on('remove', this.closePopup, this);

			this._popupHandlersAdded = true;
		}

		return this;
	},

	unbindPopup: function () {
		if (this._popup) {
			this._popup = null;
			this
			    .off('click', this._openPopup)
			    .off('remove', this.closePopup);

			this._popupHandlersAdded = false;
		}
		return this;
	},

	openPopup: function (latlng) {

		if (this._popup) {
			// open the popup from one of the path's points if not specified
			latlng = latlng || this._latlng ||
			         this._latlngs[Math.floor(this._latlngs.length / 2)];

			this._openPopup({latlng: latlng});
		}

		return this;
	},

	closePopup: function () {
		if (this._popup) {
			this._popup._close();
		}
		return this;
	},

	_openPopup: function (e) {
		this._popup.setLatLng(e.latlng);
		this._map.openPopup(this._popup);
	}
});


/*
 * Vector rendering for IE6-8 through VML.
 * Thanks to Dmitry Baranovsky and his Raphael library for inspiration!
 */

L.Browser.vml = !L.Browser.svg && (function () {
	try {
		var div = document.createElement('div');
		div.innerHTML = '<v:shape adj="1"/>';

		var shape = div.firstChild;
		shape.style.behavior = 'url(#default#VML)';

		return shape && (typeof shape.adj === 'object');

	} catch (e) {
		return false;
	}
}());

L.Path = L.Browser.svg || !L.Browser.vml ? L.Path : L.Path.extend({
	statics: {
		VML: true,
		CLIP_PADDING: 0.02
	},

	_createElement: (function () {
		try {
			document.namespaces.add('lvml', 'urn:schemas-microsoft-com:vml');
			return function (name) {
				return document.createElement('<lvml:' + name + ' class="lvml">');
			};
		} catch (e) {
			return function (name) {
				return document.createElement(
				        '<' + name + ' xmlns="urn:schemas-microsoft.com:vml" class="lvml">');
			};
		}
	}()),

	_initPath: function () {
		var container = this._container = this._createElement('shape');

		L.DomUtil.addClass(container, 'leaflet-vml-shape' +
			(this.options.className ? ' ' + this.options.className : ''));

		if (this.options.clickable) {
			L.DomUtil.addClass(container, 'leaflet-clickable');
		}

		container.coordsize = '1 1';

		this._path = this._createElement('path');
		container.appendChild(this._path);

		this._map._pathRoot.appendChild(container);
	},

	_initStyle: function () {
		this._updateStyle();
	},

	_updateStyle: function () {
		var stroke = this._stroke,
		    fill = this._fill,
		    options = this.options,
		    container = this._container;

		container.stroked = options.stroke;
		container.filled = options.fill;

		if (options.stroke) {
			if (!stroke) {
				stroke = this._stroke = this._createElement('stroke');
				stroke.endcap = 'round';
				container.appendChild(stroke);
			}
			stroke.weight = options.weight + 'px';
			stroke.color = options.color;
			stroke.opacity = options.opacity;

			if (options.dashArray) {
				stroke.dashStyle = L.Util.isArray(options.dashArray) ?
				    options.dashArray.join(' ') :
				    options.dashArray.replace(/( *, *)/g, ' ');
			} else {
				stroke.dashStyle = '';
			}
			if (options.lineCap) {
				stroke.endcap = options.lineCap.replace('butt', 'flat');
			}
			if (options.lineJoin) {
				stroke.joinstyle = options.lineJoin;
			}

		} else if (stroke) {
			container.removeChild(stroke);
			this._stroke = null;
		}

		if (options.fill) {
			if (!fill) {
				fill = this._fill = this._createElement('fill');
				container.appendChild(fill);
			}
			fill.color = options.fillColor || options.color;
			fill.opacity = options.fillOpacity;

		} else if (fill) {
			container.removeChild(fill);
			this._fill = null;
		}
	},

	_updatePath: function () {
		var style = this._container.style;

		style.display = 'none';
		this._path.v = this.getPathString() + ' '; // the space fixes IE empty path string bug
		style.display = '';
	}
});

L.Map.include(L.Browser.svg || !L.Browser.vml ? {} : {
	_initPathRoot: function () {
		if (this._pathRoot) { return; }

		var root = this._pathRoot = document.createElement('div');
		root.className = 'leaflet-vml-container';
		this._panes.overlayPane.appendChild(root);

		this.on('moveend', this._updatePathViewport);
		this._updatePathViewport();
	}
});


/*
 * Vector rendering for all browsers that support canvas.
 */

L.Browser.canvas = (function () {
	return !!document.createElement('canvas').getContext;
}());

L.Path = (L.Path.SVG && !window.L_PREFER_CANVAS) || !L.Browser.canvas ? L.Path : L.Path.extend({
	statics: {
		//CLIP_PADDING: 0.02, // not sure if there's a need to set it to a small value
		CANVAS: true,
		SVG: false
	},

	redraw: function () {
		if (this._map) {
			this.projectLatlngs();
			this._requestUpdate();
		}
		return this;
	},

	setStyle: function (style) {
		L.setOptions(this, style);

		if (this._map) {
			this._updateStyle();
			this._requestUpdate();
		}
		return this;
	},

	onRemove: function (map) {
		map
		    .off('viewreset', this.projectLatlngs, this)
		    .off('moveend', this._updatePath, this);

		if (this.options.clickable) {
			this._map.off('click', this._onClick, this);
			this._map.off('mousemove', this._onMouseMove, this);
		}

		this._requestUpdate();
		
		this.fire('remove');
		this._map = null;
	},

	_requestUpdate: function () {
		if (this._map && !L.Path._updateRequest) {
			L.Path._updateRequest = L.Util.requestAnimFrame(this._fireMapMoveEnd, this._map);
		}
	},

	_fireMapMoveEnd: function () {
		L.Path._updateRequest = null;
		this.fire('moveend');
	},

	_initElements: function () {
		this._map._initPathRoot();
		this._ctx = this._map._canvasCtx;
	},

	_updateStyle: function () {
		var options = this.options;

		if (options.stroke) {
			this._ctx.lineWidth = options.weight;
			this._ctx.strokeStyle = options.color;
		}
		if (options.fill) {
			this._ctx.fillStyle = options.fillColor || options.color;
		}

		if (options.lineCap) {
			this._ctx.lineCap = options.lineCap;
		}
		if (options.lineJoin) {
			this._ctx.lineJoin = options.lineJoin;
		}
	},

	_drawPath: function () {
		var i, j, len, len2, point, drawMethod;

		this._ctx.beginPath();

		for (i = 0, len = this._parts.length; i < len; i++) {
			for (j = 0, len2 = this._parts[i].length; j < len2; j++) {
				point = this._parts[i][j];
				drawMethod = (j === 0 ? 'move' : 'line') + 'To';

				this._ctx[drawMethod](point.x, point.y);
			}
			// TODO refactor ugly hack
			if (this instanceof L.Polygon) {
				this._ctx.closePath();
			}
		}
	},

	_checkIfEmpty: function () {
		return !this._parts.length;
	},

	_updatePath: function () {
		if (this._checkIfEmpty()) { return; }

		var ctx = this._ctx,
		    options = this.options;

		this._drawPath();
		ctx.save();
		this._updateStyle();

		if (options.fill) {
			ctx.globalAlpha = options.fillOpacity;
			ctx.fill(options.fillRule || 'evenodd');
		}

		if (options.stroke) {
			ctx.globalAlpha = options.opacity;
			ctx.stroke();
		}

		ctx.restore();

		// TODO optimization: 1 fill/stroke for all features with equal style instead of 1 for each feature
	},

	_initEvents: function () {
		if (this.options.clickable) {
			this._map.on('mousemove', this._onMouseMove, this);
			this._map.on('click dblclick contextmenu', this._fireMouseEvent, this);
		}
	},

	_fireMouseEvent: function (e) {
		if (this._containsPoint(e.layerPoint)) {
			this.fire(e.type, e);
		}
	},

	_onMouseMove: function (e) {
		if (!this._map || this._map._animatingZoom) { return; }

		// TODO don't do on each move
		if (this._containsPoint(e.layerPoint)) {
			this._ctx.canvas.style.cursor = 'pointer';
			this._mouseInside = true;
			this.fire('mouseover', e);

		} else if (this._mouseInside) {
			this._ctx.canvas.style.cursor = '';
			this._mouseInside = false;
			this.fire('mouseout', e);
		}
	}
});

L.Map.include((L.Path.SVG && !window.L_PREFER_CANVAS) || !L.Browser.canvas ? {} : {
	_initPathRoot: function () {
		var root = this._pathRoot,
		    ctx;

		if (!root) {
			root = this._pathRoot = document.createElement('canvas');
			root.style.position = 'absolute';
			ctx = this._canvasCtx = root.getContext('2d');

			ctx.lineCap = 'round';
			ctx.lineJoin = 'round';

			this._panes.overlayPane.appendChild(root);

			if (this.options.zoomAnimation) {
				this._pathRoot.className = 'leaflet-zoom-animated';
				this.on('zoomanim', this._animatePathZoom);
				this.on('zoomend', this._endPathZoom);
			}
			this.on('moveend', this._updateCanvasViewport);
			this._updateCanvasViewport();
		}
	},

	_updateCanvasViewport: function () {
		// don't redraw while zooming. See _updateSvgViewport for more details
		if (this._pathZooming) { return; }
		this._updatePathViewport();

		var vp = this._pathViewport,
		    min = vp.min,
		    size = vp.max.subtract(min),
		    root = this._pathRoot;

		//TODO check if this works properly on mobile webkit
		L.DomUtil.setPosition(root, min);
		root.width = size.x;
		root.height = size.y;
		root.getContext('2d').translate(-min.x, -min.y);
	}
});


/*
 * L.LineUtil contains different utility functions for line segments
 * and polylines (clipping, simplification, distances, etc.)
 */

/*jshint bitwise:false */ // allow bitwise operations for this file

L.LineUtil = {

	// Simplify polyline with vertex reduction and Douglas-Peucker simplification.
	// Improves rendering performance dramatically by lessening the number of points to draw.

	simplify: function (/*Point[]*/ points, /*Number*/ tolerance) {
		if (!tolerance || !points.length) {
			return points.slice();
		}

		var sqTolerance = tolerance * tolerance;

		// stage 1: vertex reduction
		points = this._reducePoints(points, sqTolerance);

		// stage 2: Douglas-Peucker simplification
		points = this._simplifyDP(points, sqTolerance);

		return points;
	},

	// distance from a point to a segment between two points
	pointToSegmentDistance:  function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2) {
		return Math.sqrt(this._sqClosestPointOnSegment(p, p1, p2, true));
	},

	closestPointOnSegment: function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2) {
		return this._sqClosestPointOnSegment(p, p1, p2);
	},

	// Douglas-Peucker simplification, see http://en.wikipedia.org/wiki/Douglas-Peucker_algorithm
	_simplifyDP: function (points, sqTolerance) {

		var len = points.length,
		    ArrayConstructor = typeof Uint8Array !== undefined + '' ? Uint8Array : Array,
		    markers = new ArrayConstructor(len);

		markers[0] = markers[len - 1] = 1;

		this._simplifyDPStep(points, markers, sqTolerance, 0, len - 1);

		var i,
		    newPoints = [];

		for (i = 0; i < len; i++) {
			if (markers[i]) {
				newPoints.push(points[i]);
			}
		}

		return newPoints;
	},

	_simplifyDPStep: function (points, markers, sqTolerance, first, last) {

		var maxSqDist = 0,
		    index, i, sqDist;

		for (i = first + 1; i <= last - 1; i++) {
			sqDist = this._sqClosestPointOnSegment(points[i], points[first], points[last], true);

			if (sqDist > maxSqDist) {
				index = i;
				maxSqDist = sqDist;
			}
		}

		if (maxSqDist > sqTolerance) {
			markers[index] = 1;

			this._simplifyDPStep(points, markers, sqTolerance, first, index);
			this._simplifyDPStep(points, markers, sqTolerance, index, last);
		}
	},

	// reduce points that are too close to each other to a single point
	_reducePoints: function (points, sqTolerance) {
		var reducedPoints = [points[0]];

		for (var i = 1, prev = 0, len = points.length; i < len; i++) {
			if (this._sqDist(points[i], points[prev]) > sqTolerance) {
				reducedPoints.push(points[i]);
				prev = i;
			}
		}
		if (prev < len - 1) {
			reducedPoints.push(points[len - 1]);
		}
		return reducedPoints;
	},

	// Cohen-Sutherland line clipping algorithm.
	// Used to avoid rendering parts of a polyline that are not currently visible.

	clipSegment: function (a, b, bounds, useLastCode) {
		var codeA = useLastCode ? this._lastCode : this._getBitCode(a, bounds),
		    codeB = this._getBitCode(b, bounds),

		    codeOut, p, newCode;

		// save 2nd code to avoid calculating it on the next segment
		this._lastCode = codeB;

		while (true) {
			// if a,b is inside the clip window (trivial accept)
			if (!(codeA | codeB)) {
				return [a, b];
			// if a,b is outside the clip window (trivial reject)
			} else if (codeA & codeB) {
				return false;
			// other cases
			} else {
				codeOut = codeA || codeB;
				p = this._getEdgeIntersection(a, b, codeOut, bounds);
				newCode = this._getBitCode(p, bounds);

				if (codeOut === codeA) {
					a = p;
					codeA = newCode;
				} else {
					b = p;
					codeB = newCode;
				}
			}
		}
	},

	_getEdgeIntersection: function (a, b, code, bounds) {
		var dx = b.x - a.x,
		    dy = b.y - a.y,
		    min = bounds.min,
		    max = bounds.max;

		if (code & 8) { // top
			return new L.Point(a.x + dx * (max.y - a.y) / dy, max.y);
		} else if (code & 4) { // bottom
			return new L.Point(a.x + dx * (min.y - a.y) / dy, min.y);
		} else if (code & 2) { // right
			return new L.Point(max.x, a.y + dy * (max.x - a.x) / dx);
		} else if (code & 1) { // left
			return new L.Point(min.x, a.y + dy * (min.x - a.x) / dx);
		}
	},

	_getBitCode: function (/*Point*/ p, bounds) {
		var code = 0;

		if (p.x < bounds.min.x) { // left
			code |= 1;
		} else if (p.x > bounds.max.x) { // right
			code |= 2;
		}
		if (p.y < bounds.min.y) { // bottom
			code |= 4;
		} else if (p.y > bounds.max.y) { // top
			code |= 8;
		}

		return code;
	},

	// square distance (to avoid unnecessary Math.sqrt calls)
	_sqDist: function (p1, p2) {
		var dx = p2.x - p1.x,
		    dy = p2.y - p1.y;
		return dx * dx + dy * dy;
	},

	// return closest point on segment or distance to that point
	_sqClosestPointOnSegment: function (p, p1, p2, sqDist) {
		var x = p1.x,
		    y = p1.y,
		    dx = p2.x - x,
		    dy = p2.y - y,
		    dot = dx * dx + dy * dy,
		    t;

		if (dot > 0) {
			t = ((p.x - x) * dx + (p.y - y) * dy) / dot;

			if (t > 1) {
				x = p2.x;
				y = p2.y;
			} else if (t > 0) {
				x += dx * t;
				y += dy * t;
			}
		}

		dx = p.x - x;
		dy = p.y - y;

		return sqDist ? dx * dx + dy * dy : new L.Point(x, y);
	}
};


/*
 * L.Polyline is used to display polylines on a map.
 */

L.Polyline = L.Path.extend({
	initialize: function (latlngs, options) {
		L.Path.prototype.initialize.call(this, options);

		this._latlngs = this._convertLatLngs(latlngs);
	},

	options: {
		// how much to simplify the polyline on each zoom level
		// more = better performance and smoother look, less = more accurate
		smoothFactor: 1.0,
		noClip: false
	},

	projectLatlngs: function () {
		this._originalPoints = [];

		for (var i = 0, len = this._latlngs.length; i < len; i++) {
			this._originalPoints[i] = this._map.latLngToLayerPoint(this._latlngs[i]);
		}
	},

	getPathString: function () {
		for (var i = 0, len = this._parts.length, str = ''; i < len; i++) {
			str += this._getPathPartStr(this._parts[i]);
		}
		return str;
	},

	getLatLngs: function () {
		return this._latlngs;
	},

	setLatLngs: function (latlngs) {
		this._latlngs = this._convertLatLngs(latlngs);
		return this.redraw();
	},

	addLatLng: function (latlng) {
		this._latlngs.push(L.latLng(latlng));
		return this.redraw();
	},

	spliceLatLngs: function () { // (Number index, Number howMany)
		var removed = [].splice.apply(this._latlngs, arguments);
		this._convertLatLngs(this._latlngs, true);
		this.redraw();
		return removed;
	},

	closestLayerPoint: function (p) {
		var minDistance = Infinity, parts = this._parts, p1, p2, minPoint = null;

		for (var j = 0, jLen = parts.length; j < jLen; j++) {
			var points = parts[j];
			for (var i = 1, len = points.length; i < len; i++) {
				p1 = points[i - 1];
				p2 = points[i];
				var sqDist = L.LineUtil._sqClosestPointOnSegment(p, p1, p2, true);
				if (sqDist < minDistance) {
					minDistance = sqDist;
					minPoint = L.LineUtil._sqClosestPointOnSegment(p, p1, p2);
				}
			}
		}
		if (minPoint) {
			minPoint.distance = Math.sqrt(minDistance);
		}
		return minPoint;
	},

	getBounds: function () {
		return new L.LatLngBounds(this.getLatLngs());
	},

	_convertLatLngs: function (latlngs, overwrite) {
		var i, len, target = overwrite ? latlngs : [];

		for (i = 0, len = latlngs.length; i < len; i++) {
			if (L.Util.isArray(latlngs[i]) && typeof latlngs[i][0] !== 'number') {
				return;
			}
			target[i] = L.latLng(latlngs[i]);
		}
		return target;
	},

	_initEvents: function () {
		L.Path.prototype._initEvents.call(this);
	},

	_getPathPartStr: function (points) {
		var round = L.Path.VML;

		for (var j = 0, len2 = points.length, str = '', p; j < len2; j++) {
			p = points[j];
			if (round) {
				p._round();
			}
			str += (j ? 'L' : 'M') + p.x + ' ' + p.y;
		}
		return str;
	},

	_clipPoints: function () {
		var points = this._originalPoints,
		    len = points.length,
		    i, k, segment;

		if (this.options.noClip) {
			this._parts = [points];
			return;
		}

		this._parts = [];

		var parts = this._parts,
		    vp = this._map._pathViewport,
		    lu = L.LineUtil;

		for (i = 0, k = 0; i < len - 1; i++) {
			segment = lu.clipSegment(points[i], points[i + 1], vp, i);
			if (!segment) {
				continue;
			}

			parts[k] = parts[k] || [];
			parts[k].push(segment[0]);

			// if segment goes out of screen, or it's the last one, it's the end of the line part
			if ((segment[1] !== points[i + 1]) || (i === len - 2)) {
				parts[k].push(segment[1]);
				k++;
			}
		}
	},

	// simplify each clipped part of the polyline
	_simplifyPoints: function () {
		var parts = this._parts,
		    lu = L.LineUtil;

		for (var i = 0, len = parts.length; i < len; i++) {
			parts[i] = lu.simplify(parts[i], this.options.smoothFactor);
		}
	},

	_updatePath: function () {
		if (!this._map) { return; }

		this._clipPoints();
		this._simplifyPoints();

		L.Path.prototype._updatePath.call(this);
	}
});

L.polyline = function (latlngs, options) {
	return new L.Polyline(latlngs, options);
};


/*
 * L.PolyUtil contains utility functions for polygons (clipping, etc.).
 */

/*jshint bitwise:false */ // allow bitwise operations here

L.PolyUtil = {};

/*
 * Sutherland-Hodgeman polygon clipping algorithm.
 * Used to avoid rendering parts of a polygon that are not currently visible.
 */
L.PolyUtil.clipPolygon = function (points, bounds) {
	var clippedPoints,
	    edges = [1, 4, 2, 8],
	    i, j, k,
	    a, b,
	    len, edge, p,
	    lu = L.LineUtil;

	for (i = 0, len = points.length; i < len; i++) {
		points[i]._code = lu._getBitCode(points[i], bounds);
	}

	// for each edge (left, bottom, right, top)
	for (k = 0; k < 4; k++) {
		edge = edges[k];
		clippedPoints = [];

		for (i = 0, len = points.length, j = len - 1; i < len; j = i++) {
			a = points[i];
			b = points[j];

			// if a is inside the clip window
			if (!(a._code & edge)) {
				// if b is outside the clip window (a->b goes out of screen)
				if (b._code & edge) {
					p = lu._getEdgeIntersection(b, a, edge, bounds);
					p._code = lu._getBitCode(p, bounds);
					clippedPoints.push(p);
				}
				clippedPoints.push(a);

			// else if b is inside the clip window (a->b enters the screen)
			} else if (!(b._code & edge)) {
				p = lu._getEdgeIntersection(b, a, edge, bounds);
				p._code = lu._getBitCode(p, bounds);
				clippedPoints.push(p);
			}
		}
		points = clippedPoints;
	}

	return points;
};


/*
 * L.Polygon is used to display polygons on a map.
 */

L.Polygon = L.Polyline.extend({
	options: {
		fill: true
	},

	initialize: function (latlngs, options) {
		L.Polyline.prototype.initialize.call(this, latlngs, options);
		this._initWithHoles(latlngs);
	},

	_initWithHoles: function (latlngs) {
		var i, len, hole;
		if (latlngs && L.Util.isArray(latlngs[0]) && (typeof latlngs[0][0] !== 'number')) {
			this._latlngs = this._convertLatLngs(latlngs[0]);
			this._holes = latlngs.slice(1);

			for (i = 0, len = this._holes.length; i < len; i++) {
				hole = this._holes[i] = this._convertLatLngs(this._holes[i]);
				if (hole[0].equals(hole[hole.length - 1])) {
					hole.pop();
				}
			}
		}

		// filter out last point if its equal to the first one
		latlngs = this._latlngs;

		if (latlngs.length >= 2 && latlngs[0].equals(latlngs[latlngs.length - 1])) {
			latlngs.pop();
		}
	},

	projectLatlngs: function () {
		L.Polyline.prototype.projectLatlngs.call(this);

		// project polygon holes points
		// TODO move this logic to Polyline to get rid of duplication
		this._holePoints = [];

		if (!this._holes) { return; }

		var i, j, len, len2;

		for (i = 0, len = this._holes.length; i < len; i++) {
			this._holePoints[i] = [];

			for (j = 0, len2 = this._holes[i].length; j < len2; j++) {
				this._holePoints[i][j] = this._map.latLngToLayerPoint(this._holes[i][j]);
			}
		}
	},

	setLatLngs: function (latlngs) {
		if (latlngs && L.Util.isArray(latlngs[0]) && (typeof latlngs[0][0] !== 'number')) {
			this._initWithHoles(latlngs);
			return this.redraw();
		} else {
			return L.Polyline.prototype.setLatLngs.call(this, latlngs);
		}
	},

	_clipPoints: function () {
		var points = this._originalPoints,
		    newParts = [];

		this._parts = [points].concat(this._holePoints);

		if (this.options.noClip) { return; }

		for (var i = 0, len = this._parts.length; i < len; i++) {
			var clipped = L.PolyUtil.clipPolygon(this._parts[i], this._map._pathViewport);
			if (clipped.length) {
				newParts.push(clipped);
			}
		}

		this._parts = newParts;
	},

	_getPathPartStr: function (points) {
		var str = L.Polyline.prototype._getPathPartStr.call(this, points);
		return str + (L.Browser.svg ? 'z' : 'x');
	}
});

L.polygon = function (latlngs, options) {
	return new L.Polygon(latlngs, options);
};


/*
 * Contains L.MultiPolyline and L.MultiPolygon layers.
 */

(function () {
	function createMulti(Klass) {

		return L.FeatureGroup.extend({

			initialize: function (latlngs, options) {
				this._layers = {};
				this._options = options;
				this.setLatLngs(latlngs);
			},

			setLatLngs: function (latlngs) {
				var i = 0,
				    len = latlngs.length;

				this.eachLayer(function (layer) {
					if (i < len) {
						layer.setLatLngs(latlngs[i++]);
					} else {
						this.removeLayer(layer);
					}
				}, this);

				while (i < len) {
					this.addLayer(new Klass(latlngs[i++], this._options));
				}

				return this;
			},

			getLatLngs: function () {
				var latlngs = [];

				this.eachLayer(function (layer) {
					latlngs.push(layer.getLatLngs());
				});

				return latlngs;
			}
		});
	}

	L.MultiPolyline = createMulti(L.Polyline);
	L.MultiPolygon = createMulti(L.Polygon);

	L.multiPolyline = function (latlngs, options) {
		return new L.MultiPolyline(latlngs, options);
	};

	L.multiPolygon = function (latlngs, options) {
		return new L.MultiPolygon(latlngs, options);
	};
}());


/*
 * L.Rectangle extends Polygon and creates a rectangle when passed a LatLngBounds object.
 */

L.Rectangle = L.Polygon.extend({
	initialize: function (latLngBounds, options) {
		L.Polygon.prototype.initialize.call(this, this._boundsToLatLngs(latLngBounds), options);
	},

	setBounds: function (latLngBounds) {
		this.setLatLngs(this._boundsToLatLngs(latLngBounds));
	},

	_boundsToLatLngs: function (latLngBounds) {
		latLngBounds = L.latLngBounds(latLngBounds);
		return [
			latLngBounds.getSouthWest(),
			latLngBounds.getNorthWest(),
			latLngBounds.getNorthEast(),
			latLngBounds.getSouthEast()
		];
	}
});

L.rectangle = function (latLngBounds, options) {
	return new L.Rectangle(latLngBounds, options);
};


/*
 * L.Circle is a circle overlay (with a certain radius in meters).
 */

L.Circle = L.Path.extend({
	initialize: function (latlng, radius, options) {
		L.Path.prototype.initialize.call(this, options);

		this._latlng = L.latLng(latlng);
		this._mRadius = radius;
	},

	options: {
		fill: true
	},

	setLatLng: function (latlng) {
		this._latlng = L.latLng(latlng);
		return this.redraw();
	},

	setRadius: function (radius) {
		this._mRadius = radius;
		return this.redraw();
	},

	projectLatlngs: function () {
		var lngRadius = this._getLngRadius(),
		    latlng = this._latlng,
		    pointLeft = this._map.latLngToLayerPoint([latlng.lat, latlng.lng - lngRadius]);

		this._point = this._map.latLngToLayerPoint(latlng);
		this._radius = Math.max(this._point.x - pointLeft.x, 1);
	},

	getBounds: function () {
		var lngRadius = this._getLngRadius(),
		    latRadius = (this._mRadius / 40075017) * 360,
		    latlng = this._latlng;

		return new L.LatLngBounds(
		        [latlng.lat - latRadius, latlng.lng - lngRadius],
		        [latlng.lat + latRadius, latlng.lng + lngRadius]);
	},

	getLatLng: function () {
		return this._latlng;
	},

	getPathString: function () {
		var p = this._point,
		    r = this._radius;

		if (this._checkIfEmpty()) {
			return '';
		}

		if (L.Browser.svg) {
			return 'M' + p.x + ',' + (p.y - r) +
			       'A' + r + ',' + r + ',0,1,1,' +
			       (p.x - 0.1) + ',' + (p.y - r) + ' z';
		} else {
			p._round();
			r = Math.round(r);
			return 'AL ' + p.x + ',' + p.y + ' ' + r + ',' + r + ' 0,' + (65535 * 360);
		}
	},

	getRadius: function () {
		return this._mRadius;
	},

	// TODO Earth hardcoded, move into projection code!

	_getLatRadius: function () {
		return (this._mRadius / 40075017) * 360;
	},

	_getLngRadius: function () {
		return this._getLatRadius() / Math.cos(L.LatLng.DEG_TO_RAD * this._latlng.lat);
	},

	_checkIfEmpty: function () {
		if (!this._map) {
			return false;
		}
		var vp = this._map._pathViewport,
		    r = this._radius,
		    p = this._point;

		return p.x - r > vp.max.x || p.y - r > vp.max.y ||
		       p.x + r < vp.min.x || p.y + r < vp.min.y;
	}
});

L.circle = function (latlng, radius, options) {
	return new L.Circle(latlng, radius, options);
};


/*
 * L.CircleMarker is a circle overlay with a permanent pixel radius.
 */

L.CircleMarker = L.Circle.extend({
	options: {
		radius: 10,
		weight: 2
	},

	initialize: function (latlng, options) {
		L.Circle.prototype.initialize.call(this, latlng, null, options);
		this._radius = this.options.radius;
	},

	projectLatlngs: function () {
		this._point = this._map.latLngToLayerPoint(this._latlng);
	},

	_updateStyle : function () {
		L.Circle.prototype._updateStyle.call(this);
		this.setRadius(this.options.radius);
	},

	setLatLng: function (latlng) {
		L.Circle.prototype.setLatLng.call(this, latlng);
		if (this._popup && this._popup._isOpen) {
			this._popup.setLatLng(latlng);
		}
		return this;
	},

	setRadius: function (radius) {
		this.options.radius = this._radius = radius;
		return this.redraw();
	},

	getRadius: function () {
		return this._radius;
	}
});

L.circleMarker = function (latlng, options) {
	return new L.CircleMarker(latlng, options);
};


/*
 * Extends L.Polyline to be able to manually detect clicks on Canvas-rendered polylines.
 */

L.Polyline.include(!L.Path.CANVAS ? {} : {
	_containsPoint: function (p, closed) {
		var i, j, k, len, len2, dist, part,
		    w = this.options.weight / 2;

		if (L.Browser.touch) {
			w += 10; // polyline click tolerance on touch devices
		}

		for (i = 0, len = this._parts.length; i < len; i++) {
			part = this._parts[i];
			for (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {
				if (!closed && (j === 0)) {
					continue;
				}

				dist = L.LineUtil.pointToSegmentDistance(p, part[k], part[j]);

				if (dist <= w) {
					return true;
				}
			}
		}
		return false;
	}
});


/*
 * Extends L.Polygon to be able to manually detect clicks on Canvas-rendered polygons.
 */

L.Polygon.include(!L.Path.CANVAS ? {} : {
	_containsPoint: function (p) {
		var inside = false,
		    part, p1, p2,
		    i, j, k,
		    len, len2;

		// TODO optimization: check if within bounds first

		if (L.Polyline.prototype._containsPoint.call(this, p, true)) {
			// click on polygon border
			return true;
		}

		// ray casting algorithm for detecting if point is in polygon

		for (i = 0, len = this._parts.length; i < len; i++) {
			part = this._parts[i];

			for (j = 0, len2 = part.length, k = len2 - 1; j < len2; k = j++) {
				p1 = part[j];
				p2 = part[k];

				if (((p1.y > p.y) !== (p2.y > p.y)) &&
						(p.x < (p2.x - p1.x) * (p.y - p1.y) / (p2.y - p1.y) + p1.x)) {
					inside = !inside;
				}
			}
		}

		return inside;
	}
});


/*
 * Extends L.Circle with Canvas-specific code.
 */

L.Circle.include(!L.Path.CANVAS ? {} : {
	_drawPath: function () {
		var p = this._point;
		this._ctx.beginPath();
		this._ctx.arc(p.x, p.y, this._radius, 0, Math.PI * 2, false);
	},

	_containsPoint: function (p) {
		var center = this._point,
		    w2 = this.options.stroke ? this.options.weight / 2 : 0;

		return (p.distanceTo(center) <= this._radius + w2);
	}
});


/*
 * CircleMarker canvas specific drawing parts.
 */

L.CircleMarker.include(!L.Path.CANVAS ? {} : {
	_updateStyle: function () {
		L.Path.prototype._updateStyle.call(this);
	}
});


/*
 * L.GeoJSON turns any GeoJSON data into a Leaflet layer.
 */

L.GeoJSON = L.FeatureGroup.extend({

	initialize: function (geojson, options) {
		L.setOptions(this, options);

		this._layers = {};

		if (geojson) {
			this.addData(geojson);
		}
	},

	addData: function (geojson) {
		var features = L.Util.isArray(geojson) ? geojson : geojson.features,
		    i, len, feature;

		if (features) {
			for (i = 0, len = features.length; i < len; i++) {
				// Only add this if geometry or geometries are set and not null
				feature = features[i];
				if (feature.geometries || feature.geometry || feature.features || feature.coordinates) {
					this.addData(features[i]);
				}
			}
			return this;
		}

		var options = this.options;

		if (options.filter && !options.filter(geojson)) { return; }

		var layer = L.GeoJSON.geometryToLayer(geojson, options.pointToLayer, options.coordsToLatLng, options);
		layer.feature = L.GeoJSON.asFeature(geojson);

		layer.defaultOptions = layer.options;
		this.resetStyle(layer);

		if (options.onEachFeature) {
			options.onEachFeature(geojson, layer);
		}

		return this.addLayer(layer);
	},

	resetStyle: function (layer) {
		var style = this.options.style;
		if (style) {
			// reset any custom styles
			L.Util.extend(layer.options, layer.defaultOptions);

			this._setLayerStyle(layer, style);
		}
	},

	setStyle: function (style) {
		this.eachLayer(function (layer) {
			this._setLayerStyle(layer, style);
		}, this);
	},

	_setLayerStyle: function (layer, style) {
		if (typeof style === 'function') {
			style = style(layer.feature);
		}
		if (layer.setStyle) {
			layer.setStyle(style);
		}
	}
});

L.extend(L.GeoJSON, {
	geometryToLayer: function (geojson, pointToLayer, coordsToLatLng, vectorOptions) {
		var geometry = geojson.type === 'Feature' ? geojson.geometry : geojson,
		    coords = geometry.coordinates,
		    layers = [],
		    latlng, latlngs, i, len;

		coordsToLatLng = coordsToLatLng || this.coordsToLatLng;

		switch (geometry.type) {
		case 'Point':
			latlng = coordsToLatLng(coords);
			return pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng);

		case 'MultiPoint':
			for (i = 0, len = coords.length; i < len; i++) {
				latlng = coordsToLatLng(coords[i]);
				layers.push(pointToLayer ? pointToLayer(geojson, latlng) : new L.Marker(latlng));
			}
			return new L.FeatureGroup(layers);

		case 'LineString':
			latlngs = this.coordsToLatLngs(coords, 0, coordsToLatLng);
			return new L.Polyline(latlngs, vectorOptions);

		case 'Polygon':
			if (coords.length === 2 && !coords[1].length) {
				throw new Error('Invalid GeoJSON object.');
			}
			latlngs = this.coordsToLatLngs(coords, 1, coordsToLatLng);
			return new L.Polygon(latlngs, vectorOptions);

		case 'MultiLineString':
			latlngs = this.coordsToLatLngs(coords, 1, coordsToLatLng);
			return new L.MultiPolyline(latlngs, vectorOptions);

		case 'MultiPolygon':
			latlngs = this.coordsToLatLngs(coords, 2, coordsToLatLng);
			return new L.MultiPolygon(latlngs, vectorOptions);

		case 'GeometryCollection':
			for (i = 0, len = geometry.geometries.length; i < len; i++) {

				layers.push(this.geometryToLayer({
					geometry: geometry.geometries[i],
					type: 'Feature',
					properties: geojson.properties
				}, pointToLayer, coordsToLatLng, vectorOptions));
			}
			return new L.FeatureGroup(layers);

		default:
			throw new Error('Invalid GeoJSON object.');
		}
	},

	coordsToLatLng: function (coords) { // (Array[, Boolean]) -> LatLng
		return new L.LatLng(coords[1], coords[0], coords[2]);
	},

	coordsToLatLngs: function (coords, levelsDeep, coordsToLatLng) { // (Array[, Number, Function]) -> Array
		var latlng, i, len,
		    latlngs = [];

		for (i = 0, len = coords.length; i < len; i++) {
			latlng = levelsDeep ?
			        this.coordsToLatLngs(coords[i], levelsDeep - 1, coordsToLatLng) :
			        (coordsToLatLng || this.coordsToLatLng)(coords[i]);

			latlngs.push(latlng);
		}

		return latlngs;
	},

	latLngToCoords: function (latlng) {
		var coords = [latlng.lng, latlng.lat];

		if (latlng.alt !== undefined) {
			coords.push(latlng.alt);
		}
		return coords;
	},

	latLngsToCoords: function (latLngs) {
		var coords = [];

		for (var i = 0, len = latLngs.length; i < len; i++) {
			coords.push(L.GeoJSON.latLngToCoords(latLngs[i]));
		}

		return coords;
	},

	getFeature: function (layer, newGeometry) {
		return layer.feature ? L.extend({}, layer.feature, {geometry: newGeometry}) : L.GeoJSON.asFeature(newGeometry);
	},

	asFeature: function (geoJSON) {
		if (geoJSON.type === 'Feature') {
			return geoJSON;
		}

		return {
			type: 'Feature',
			properties: {},
			geometry: geoJSON
		};
	}
});

var PointToGeoJSON = {
	toGeoJSON: function () {
		return L.GeoJSON.getFeature(this, {
			type: 'Point',
			coordinates: L.GeoJSON.latLngToCoords(this.getLatLng())
		});
	}
};

L.Marker.include(PointToGeoJSON);
L.Circle.include(PointToGeoJSON);
L.CircleMarker.include(PointToGeoJSON);

L.Polyline.include({
	toGeoJSON: function () {
		return L.GeoJSON.getFeature(this, {
			type: 'LineString',
			coordinates: L.GeoJSON.latLngsToCoords(this.getLatLngs())
		});
	}
});

L.Polygon.include({
	toGeoJSON: function () {
		var coords = [L.GeoJSON.latLngsToCoords(this.getLatLngs())],
		    i, len, hole;

		coords[0].push(coords[0][0]);

		if (this._holes) {
			for (i = 0, len = this._holes.length; i < len; i++) {
				hole = L.GeoJSON.latLngsToCoords(this._holes[i]);
				hole.push(hole[0]);
				coords.push(hole);
			}
		}

		return L.GeoJSON.getFeature(this, {
			type: 'Polygon',
			coordinates: coords
		});
	}
});

(function () {
	function multiToGeoJSON(type) {
		return function () {
			var coords = [];

			this.eachLayer(function (layer) {
				coords.push(layer.toGeoJSON().geometry.coordinates);
			});

			return L.GeoJSON.getFeature(this, {
				type: type,
				coordinates: coords
			});
		};
	}

	L.MultiPolyline.include({toGeoJSON: multiToGeoJSON('MultiLineString')});
	L.MultiPolygon.include({toGeoJSON: multiToGeoJSON('MultiPolygon')});

	L.LayerGroup.include({
		toGeoJSON: function () {

			var geometry = this.feature && this.feature.geometry,
				jsons = [],
				json;

			if (geometry && geometry.type === 'MultiPoint') {
				return multiToGeoJSON('MultiPoint').call(this);
			}

			var isGeometryCollection = geometry && geometry.type === 'GeometryCollection';

			this.eachLayer(function (layer) {
				if (layer.toGeoJSON) {
					json = layer.toGeoJSON();
					jsons.push(isGeometryCollection ? json.geometry : L.GeoJSON.asFeature(json));
				}
			});

			if (isGeometryCollection) {
				return L.GeoJSON.getFeature(this, {
					geometries: jsons,
					type: 'GeometryCollection'
				});
			}

			return {
				type: 'FeatureCollection',
				features: jsons
			};
		}
	});
}());

L.geoJson = function (geojson, options) {
	return new L.GeoJSON(geojson, options);
};


/*
 * L.DomEvent contains functions for working with DOM events.
 */

L.DomEvent = {
	/* inspired by John Resig, Dean Edwards and YUI addEvent implementations */
	addListener: function (obj, type, fn, context) { // (HTMLElement, String, Function[, Object])

		var id = L.stamp(fn),
		    key = '_leaflet_' + type + id,
		    handler, originalHandler, newType;

		if (obj[key]) { return this; }

		handler = function (e) {
			return fn.call(context || obj, e || L.DomEvent._getEvent());
		};

		if (L.Browser.pointer && type.indexOf('touch') === 0) {
			return this.addPointerListener(obj, type, handler, id);
		}
		if (L.Browser.touch && (type === 'dblclick') && this.addDoubleTapListener) {
			this.addDoubleTapListener(obj, handler, id);
		}

		if ('addEventListener' in obj) {

			if (type === 'mousewheel') {
				obj.addEventListener('DOMMouseScroll', handler, false);
				obj.addEventListener(type, handler, false);

			} else if ((type === 'mouseenter') || (type === 'mouseleave')) {

				originalHandler = handler;
				newType = (type === 'mouseenter' ? 'mouseover' : 'mouseout');

				handler = function (e) {
					if (!L.DomEvent._checkMouse(obj, e)) { return; }
					return originalHandler(e);
				};

				obj.addEventListener(newType, handler, false);

			} else if (type === 'click' && L.Browser.android) {
				originalHandler = handler;
				handler = function (e) {
					return L.DomEvent._filterClick(e, originalHandler);
				};

				obj.addEventListener(type, handler, false);
			} else {
				obj.addEventListener(type, handler, false);
			}

		} else if ('attachEvent' in obj) {
			obj.attachEvent('on' + type, handler);
		}

		obj[key] = handler;

		return this;
	},

	removeListener: function (obj, type, fn) {  // (HTMLElement, String, Function)

		var id = L.stamp(fn),
		    key = '_leaflet_' + type + id,
		    handler = obj[key];

		if (!handler) { return this; }

		if (L.Browser.pointer && type.indexOf('touch') === 0) {
			this.removePointerListener(obj, type, id);
		} else if (L.Browser.touch && (type === 'dblclick') && this.removeDoubleTapListener) {
			this.removeDoubleTapListener(obj, id);

		} else if ('removeEventListener' in obj) {

			if (type === 'mousewheel') {
				obj.removeEventListener('DOMMouseScroll', handler, false);
				obj.removeEventListener(type, handler, false);

			} else if ((type === 'mouseenter') || (type === 'mouseleave')) {
				obj.removeEventListener((type === 'mouseenter' ? 'mouseover' : 'mouseout'), handler, false);
			} else {
				obj.removeEventListener(type, handler, false);
			}
		} else if ('detachEvent' in obj) {
			obj.detachEvent('on' + type, handler);
		}

		obj[key] = null;

		return this;
	},

	stopPropagation: function (e) {

		if (e.stopPropagation) {
			e.stopPropagation();
		} else {
			e.cancelBubble = true;
		}
		L.DomEvent._skipped(e);

		return this;
	},

	disableScrollPropagation: function (el) {
		var stop = L.DomEvent.stopPropagation;

		return L.DomEvent
			.on(el, 'mousewheel', stop)
			.on(el, 'MozMousePixelScroll', stop);
	},

	disableClickPropagation: function (el) {
		var stop = L.DomEvent.stopPropagation;

		for (var i = L.Draggable.START.length - 1; i >= 0; i--) {
			L.DomEvent.on(el, L.Draggable.START[i], stop);
		}

		return L.DomEvent
			.on(el, 'click', L.DomEvent._fakeStop)
			.on(el, 'dblclick', stop);
	},

	preventDefault: function (e) {

		if (e.preventDefault) {
			e.preventDefault();
		} else {
			e.returnValue = false;
		}
		return this;
	},

	stop: function (e) {
		return L.DomEvent
			.preventDefault(e)
			.stopPropagation(e);
	},

	getMousePosition: function (e, container) {
		if (!container) {
			return new L.Point(e.clientX, e.clientY);
		}

		var rect = container.getBoundingClientRect();

		return new L.Point(
			e.clientX - rect.left - container.clientLeft,
			e.clientY - rect.top - container.clientTop);
	},

	getWheelDelta: function (e) {

		var delta = 0;

		if (e.wheelDelta) {
			delta = e.wheelDelta / 120;
		}
		if (e.detail) {
			delta = -e.detail / 3;
		}
		return delta;
	},

	_skipEvents: {},

	_fakeStop: function (e) {
		// fakes stopPropagation by setting a special event flag, checked/reset with L.DomEvent._skipped(e)
		L.DomEvent._skipEvents[e.type] = true;
	},

	_skipped: function (e) {
		var skipped = this._skipEvents[e.type];
		// reset when checking, as it's only used in map container and propagates outside of the map
		this._skipEvents[e.type] = false;
		return skipped;
	},

	// check if element really left/entered the event target (for mouseenter/mouseleave)
	_checkMouse: function (el, e) {

		var related = e.relatedTarget;

		if (!related) { return true; }

		try {
			while (related && (related !== el)) {
				related = related.parentNode;
			}
		} catch (err) {
			return false;
		}
		return (related !== el);
	},

	_getEvent: function () { // evil magic for IE
		/*jshint noarg:false */
		var e = window.event;
		if (!e) {
			var caller = arguments.callee.caller;
			while (caller) {
				e = caller['arguments'][0];
				if (e && window.Event === e.constructor) {
					break;
				}
				caller = caller.caller;
			}
		}
		return e;
	},

	// this is a horrible workaround for a bug in Android where a single touch triggers two click events
	_filterClick: function (e, handler) {
		var timeStamp = (e.timeStamp || e.originalEvent.timeStamp),
			elapsed = L.DomEvent._lastClick && (timeStamp - L.DomEvent._lastClick);

		// are they closer together than 500ms yet more than 100ms?
		// Android typically triggers them ~300ms apart while multiple listeners
		// on the same event should be triggered far faster;
		// or check if click is simulated on the element, and if it is, reject any non-simulated events

		if ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {
			L.DomEvent.stop(e);
			return;
		}
		L.DomEvent._lastClick = timeStamp;

		return handler(e);
	}
};

L.DomEvent.on = L.DomEvent.addListener;
L.DomEvent.off = L.DomEvent.removeListener;


/*
 * L.Draggable allows you to add dragging capabilities to any element. Supports mobile devices too.
 */

L.Draggable = L.Class.extend({
	includes: L.Mixin.Events,

	statics: {
		START: L.Browser.touch ? ['touchstart', 'mousedown'] : ['mousedown'],
		END: {
			mousedown: 'mouseup',
			touchstart: 'touchend',
			pointerdown: 'touchend',
			MSPointerDown: 'touchend'
		},
		MOVE: {
			mousedown: 'mousemove',
			touchstart: 'touchmove',
			pointerdown: 'touchmove',
			MSPointerDown: 'touchmove'
		}
	},

	initialize: function (element, dragStartTarget) {
		this._element = element;
		this._dragStartTarget = dragStartTarget || element;
	},

	enable: function () {
		if (this._enabled) { return; }

		for (var i = L.Draggable.START.length - 1; i >= 0; i--) {
			L.DomEvent.on(this._dragStartTarget, L.Draggable.START[i], this._onDown, this);
		}

		this._enabled = true;
	},

	disable: function () {
		if (!this._enabled) { return; }

		for (var i = L.Draggable.START.length - 1; i >= 0; i--) {
			L.DomEvent.off(this._dragStartTarget, L.Draggable.START[i], this._onDown, this);
		}

		this._enabled = false;
		this._moved = false;
	},

	_onDown: function (e) {
		this._moved = false;

		if (e.shiftKey || ((e.which !== 1) && (e.button !== 1) && !e.touches)) { return; }

		L.DomEvent.stopPropagation(e);

		if (L.Draggable._disabled) { return; }

		L.DomUtil.disableImageDrag();
		L.DomUtil.disableTextSelection();

		if (this._moving) { return; }

		var first = e.touches ? e.touches[0] : e;

		this._startPoint = new L.Point(first.clientX, first.clientY);
		this._startPos = this._newPos = L.DomUtil.getPosition(this._element);

		L.DomEvent
		    .on(document, L.Draggable.MOVE[e.type], this._onMove, this)
		    .on(document, L.Draggable.END[e.type], this._onUp, this);
	},

	_onMove: function (e) {
		if (e.touches && e.touches.length > 1) {
			this._moved = true;
			return;
		}

		var first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),
		    newPoint = new L.Point(first.clientX, first.clientY),
		    offset = newPoint.subtract(this._startPoint);

		if (!offset.x && !offset.y) { return; }
		if (L.Browser.touch && Math.abs(offset.x) + Math.abs(offset.y) < 3) { return; }

		L.DomEvent.preventDefault(e);

		if (!this._moved) {
			this.fire('dragstart');

			this._moved = true;
			this._startPos = L.DomUtil.getPosition(this._element).subtract(offset);

			L.DomUtil.addClass(document.body, 'leaflet-dragging');
			this._lastTarget = e.target || e.srcElement;
			L.DomUtil.addClass(this._lastTarget, 'leaflet-drag-target');
		}

		this._newPos = this._startPos.add(offset);
		this._moving = true;

		L.Util.cancelAnimFrame(this._animRequest);
		this._animRequest = L.Util.requestAnimFrame(this._updatePosition, this, true, this._dragStartTarget);
	},

	_updatePosition: function () {
		this.fire('predrag');
		L.DomUtil.setPosition(this._element, this._newPos);
		this.fire('drag');
	},

	_onUp: function () {
		L.DomUtil.removeClass(document.body, 'leaflet-dragging');

		if (this._lastTarget) {
			L.DomUtil.removeClass(this._lastTarget, 'leaflet-drag-target');
			this._lastTarget = null;
		}

		for (var i in L.Draggable.MOVE) {
			L.DomEvent
			    .off(document, L.Draggable.MOVE[i], this._onMove)
			    .off(document, L.Draggable.END[i], this._onUp);
		}

		L.DomUtil.enableImageDrag();
		L.DomUtil.enableTextSelection();

		if (this._moved && this._moving) {
			// ensure drag is not fired after dragend
			L.Util.cancelAnimFrame(this._animRequest);

			this.fire('dragend', {
				distance: this._newPos.distanceTo(this._startPos)
			});
		}

		this._moving = false;
	}
});


/*
	L.Handler is a base class for handler classes that are used internally to inject
	interaction features like dragging to classes like Map and Marker.
*/

L.Handler = L.Class.extend({
	initialize: function (map) {
		this._map = map;
	},

	enable: function () {
		if (this._enabled) { return; }

		this._enabled = true;
		this.addHooks();
	},

	disable: function () {
		if (!this._enabled) { return; }

		this._enabled = false;
		this.removeHooks();
	},

	enabled: function () {
		return !!this._enabled;
	}
});


/*
 * L.Handler.MapDrag is used to make the map draggable (with panning inertia), enabled by default.
 */

L.Map.mergeOptions({
	dragging: true,

	inertia: !L.Browser.android23,
	inertiaDeceleration: 3400, // px/s^2
	inertiaMaxSpeed: Infinity, // px/s
	inertiaThreshold: L.Browser.touch ? 32 : 18, // ms
	easeLinearity: 0.25,

	// TODO refactor, move to CRS
	worldCopyJump: false
});

L.Map.Drag = L.Handler.extend({
	addHooks: function () {
		if (!this._draggable) {
			var map = this._map;

			this._draggable = new L.Draggable(map._mapPane, map._container);

			this._draggable.on({
				'dragstart': this._onDragStart,
				'drag': this._onDrag,
				'dragend': this._onDragEnd
			}, this);

			if (map.options.worldCopyJump) {
				this._draggable.on('predrag', this._onPreDrag, this);
				map.on('viewreset', this._onViewReset, this);

				map.whenReady(this._onViewReset, this);
			}
		}
		this._draggable.enable();
	},

	removeHooks: function () {
		this._draggable.disable();
	},

	moved: function () {
		return this._draggable && this._draggable._moved;
	},

	_onDragStart: function () {
		var map = this._map;

		if (map._panAnim) {
			map._panAnim.stop();
		}

		map
		    .fire('movestart')
		    .fire('dragstart');

		if (map.options.inertia) {
			this._positions = [];
			this._times = [];
		}
	},

	_onDrag: function () {
		if (this._map.options.inertia) {
			var time = this._lastTime = +new Date(),
			    pos = this._lastPos = this._draggable._newPos;

			this._positions.push(pos);
			this._times.push(time);

			if (time - this._times[0] > 200) {
				this._positions.shift();
				this._times.shift();
			}
		}

		this._map
		    .fire('move')
		    .fire('drag');
	},

	_onViewReset: function () {
		// TODO fix hardcoded Earth values
		var pxCenter = this._map.getSize()._divideBy(2),
		    pxWorldCenter = this._map.latLngToLayerPoint([0, 0]);

		this._initialWorldOffset = pxWorldCenter.subtract(pxCenter).x;
		this._worldWidth = this._map.project([0, 180]).x;
	},

	_onPreDrag: function () {
		// TODO refactor to be able to adjust map pane position after zoom
		var worldWidth = this._worldWidth,
		    halfWidth = Math.round(worldWidth / 2),
		    dx = this._initialWorldOffset,
		    x = this._draggable._newPos.x,
		    newX1 = (x - halfWidth + dx) % worldWidth + halfWidth - dx,
		    newX2 = (x + halfWidth + dx) % worldWidth - halfWidth - dx,
		    newX = Math.abs(newX1 + dx) < Math.abs(newX2 + dx) ? newX1 : newX2;

		this._draggable._newPos.x = newX;
	},

	_onDragEnd: function (e) {
		var map = this._map,
		    options = map.options,
		    delay = +new Date() - this._lastTime,

		    noInertia = !options.inertia || delay > options.inertiaThreshold || !this._positions[0];

		map.fire('dragend', e);

		if (noInertia) {
			map.fire('moveend');

		} else {

			var direction = this._lastPos.subtract(this._positions[0]),
			    duration = (this._lastTime + delay - this._times[0]) / 1000,
			    ease = options.easeLinearity,

			    speedVector = direction.multiplyBy(ease / duration),
			    speed = speedVector.distanceTo([0, 0]),

			    limitedSpeed = Math.min(options.inertiaMaxSpeed, speed),
			    limitedSpeedVector = speedVector.multiplyBy(limitedSpeed / speed),

			    decelerationDuration = limitedSpeed / (options.inertiaDeceleration * ease),
			    offset = limitedSpeedVector.multiplyBy(-decelerationDuration / 2).round();

			if (!offset.x || !offset.y) {
				map.fire('moveend');

			} else {
				offset = map._limitOffset(offset, map.options.maxBounds);

				L.Util.requestAnimFrame(function () {
					map.panBy(offset, {
						duration: decelerationDuration,
						easeLinearity: ease,
						noMoveStart: true
					});
				});
			}
		}
	}
});

L.Map.addInitHook('addHandler', 'dragging', L.Map.Drag);


/*
 * L.Handler.DoubleClickZoom is used to handle double-click zoom on the map, enabled by default.
 */

L.Map.mergeOptions({
	doubleClickZoom: true
});

L.Map.DoubleClickZoom = L.Handler.extend({
	addHooks: function () {
		this._map.on('dblclick', this._onDoubleClick, this);
	},

	removeHooks: function () {
		this._map.off('dblclick', this._onDoubleClick, this);
	},

	_onDoubleClick: function (e) {
		var map = this._map,
		    zoom = map.getZoom() + (e.originalEvent.shiftKey ? -1 : 1);

		if (map.options.doubleClickZoom === 'center') {
			map.setZoom(zoom);
		} else {
			map.setZoomAround(e.containerPoint, zoom);
		}
	}
});

L.Map.addInitHook('addHandler', 'doubleClickZoom', L.Map.DoubleClickZoom);


/*
 * L.Handler.ScrollWheelZoom is used by L.Map to enable mouse scroll wheel zoom on the map.
 */

L.Map.mergeOptions({
	scrollWheelZoom: true
});

L.Map.ScrollWheelZoom = L.Handler.extend({
	addHooks: function () {
		L.DomEvent.on(this._map._container, 'mousewheel', this._onWheelScroll, this);
		L.DomEvent.on(this._map._container, 'MozMousePixelScroll', L.DomEvent.preventDefault);
		this._delta = 0;
	},

	removeHooks: function () {
		L.DomEvent.off(this._map._container, 'mousewheel', this._onWheelScroll);
		L.DomEvent.off(this._map._container, 'MozMousePixelScroll', L.DomEvent.preventDefault);
	},

	_onWheelScroll: function (e) {
		var delta = L.DomEvent.getWheelDelta(e);

		this._delta += delta;
		this._lastMousePos = this._map.mouseEventToContainerPoint(e);

		if (!this._startTime) {
			this._startTime = +new Date();
		}

		var left = Math.max(40 - (+new Date() - this._startTime), 0);

		clearTimeout(this._timer);
		this._timer = setTimeout(L.bind(this._performZoom, this), left);

		L.DomEvent.preventDefault(e);
		L.DomEvent.stopPropagation(e);
	},

	_performZoom: function () {
		var map = this._map,
		    delta = this._delta,
		    zoom = map.getZoom();

		delta = delta > 0 ? Math.ceil(delta) : Math.floor(delta);
		delta = Math.max(Math.min(delta, 4), -4);
		delta = map._limitZoom(zoom + delta) - zoom;

		this._delta = 0;
		this._startTime = null;

		if (!delta) { return; }

		if (map.options.scrollWheelZoom === 'center') {
			map.setZoom(zoom + delta);
		} else {
			map.setZoomAround(this._lastMousePos, zoom + delta);
		}
	}
});

L.Map.addInitHook('addHandler', 'scrollWheelZoom', L.Map.ScrollWheelZoom);


/*
 * Extends the event handling code with double tap support for mobile browsers.
 */

L.extend(L.DomEvent, {

	_touchstart: L.Browser.msPointer ? 'MSPointerDown' : L.Browser.pointer ? 'pointerdown' : 'touchstart',
	_touchend: L.Browser.msPointer ? 'MSPointerUp' : L.Browser.pointer ? 'pointerup' : 'touchend',

	// inspired by Zepto touch code by Thomas Fuchs
	addDoubleTapListener: function (obj, handler, id) {
		var last,
		    doubleTap = false,
		    delay = 250,
		    touch,
		    pre = '_leaflet_',
		    touchstart = this._touchstart,
		    touchend = this._touchend,
		    trackedTouches = [];

		function onTouchStart(e) {
			var count;

			if (L.Browser.pointer) {
				trackedTouches.push(e.pointerId);
				count = trackedTouches.length;
			} else {
				count = e.touches.length;
			}
			if (count > 1) {
				return;
			}

			var now = Date.now(),
				delta = now - (last || now);

			touch = e.touches ? e.touches[0] : e;
			doubleTap = (delta > 0 && delta <= delay);
			last = now;
		}

		function onTouchEnd(e) {
			if (L.Browser.pointer) {
				var idx = trackedTouches.indexOf(e.pointerId);
				if (idx === -1) {
					return;
				}
				trackedTouches.splice(idx, 1);
			}

			if (doubleTap) {
				if (L.Browser.pointer) {
					// work around .type being readonly with MSPointer* events
					var newTouch = { },
						prop;

					// jshint forin:false
					for (var i in touch) {
						prop = touch[i];
						if (typeof prop === 'function') {
							newTouch[i] = prop.bind(touch);
						} else {
							newTouch[i] = prop;
						}
					}
					touch = newTouch;
				}
				touch.type = 'dblclick';
				handler(touch);
				last = null;
			}
		}
		obj[pre + touchstart + id] = onTouchStart;
		obj[pre + touchend + id] = onTouchEnd;

		// on pointer we need to listen on the document, otherwise a drag starting on the map and moving off screen
		// will not come through to us, so we will lose track of how many touches are ongoing
		var endElement = L.Browser.pointer ? document.documentElement : obj;

		obj.addEventListener(touchstart, onTouchStart, false);
		endElement.addEventListener(touchend, onTouchEnd, false);

		if (L.Browser.pointer) {
			endElement.addEventListener(L.DomEvent.POINTER_CANCEL, onTouchEnd, false);
		}

		return this;
	},

	removeDoubleTapListener: function (obj, id) {
		var pre = '_leaflet_';

		obj.removeEventListener(this._touchstart, obj[pre + this._touchstart + id], false);
		(L.Browser.pointer ? document.documentElement : obj).removeEventListener(
		        this._touchend, obj[pre + this._touchend + id], false);

		if (L.Browser.pointer) {
			document.documentElement.removeEventListener(L.DomEvent.POINTER_CANCEL, obj[pre + this._touchend + id],
				false);
		}

		return this;
	}
});


/*
 * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.
 */

L.extend(L.DomEvent, {

	//static
	POINTER_DOWN: L.Browser.msPointer ? 'MSPointerDown' : 'pointerdown',
	POINTER_MOVE: L.Browser.msPointer ? 'MSPointerMove' : 'pointermove',
	POINTER_UP: L.Browser.msPointer ? 'MSPointerUp' : 'pointerup',
	POINTER_CANCEL: L.Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',

	_pointers: [],
	_pointerDocumentListener: false,

	// Provides a touch events wrapper for (ms)pointer events.
	// Based on changes by veproza https://github.com/CloudMade/Leaflet/pull/1019
	//ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890

	addPointerListener: function (obj, type, handler, id) {

		switch (type) {
		case 'touchstart':
			return this.addPointerListenerStart(obj, type, handler, id);
		case 'touchend':
			return this.addPointerListenerEnd(obj, type, handler, id);
		case 'touchmove':
			return this.addPointerListenerMove(obj, type, handler, id);
		default:
			throw 'Unknown touch event type';
		}
	},

	addPointerListenerStart: function (obj, type, handler, id) {
		var pre = '_leaflet_',
		    pointers = this._pointers;

		var cb = function (e) {

			L.DomEvent.preventDefault(e);

			var alreadyInArray = false;
			for (var i = 0; i < pointers.length; i++) {
				if (pointers[i].pointerId === e.pointerId) {
					alreadyInArray = true;
					break;
				}
			}
			if (!alreadyInArray) {
				pointers.push(e);
			}

			e.touches = pointers.slice();
			e.changedTouches = [e];

			handler(e);
		};

		obj[pre + 'touchstart' + id] = cb;
		obj.addEventListener(this.POINTER_DOWN, cb, false);

		// need to also listen for end events to keep the _pointers list accurate
		// this needs to be on the body and never go away
		if (!this._pointerDocumentListener) {
			var internalCb = function (e) {
				for (var i = 0; i < pointers.length; i++) {
					if (pointers[i].pointerId === e.pointerId) {
						pointers.splice(i, 1);
						break;
					}
				}
			};
			//We listen on the documentElement as any drags that end by moving the touch off the screen get fired there
			document.documentElement.addEventListener(this.POINTER_UP, internalCb, false);
			document.documentElement.addEventListener(this.POINTER_CANCEL, internalCb, false);

			this._pointerDocumentListener = true;
		}

		return this;
	},

	addPointerListenerMove: function (obj, type, handler, id) {
		var pre = '_leaflet_',
		    touches = this._pointers;

		function cb(e) {

			// don't fire touch moves when mouse isn't down
			if ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }

			for (var i = 0; i < touches.length; i++) {
				if (touches[i].pointerId === e.pointerId) {
					touches[i] = e;
					break;
				}
			}

			e.touches = touches.slice();
			e.changedTouches = [e];

			handler(e);
		}

		obj[pre + 'touchmove' + id] = cb;
		obj.addEventListener(this.POINTER_MOVE, cb, false);

		return this;
	},

	addPointerListenerEnd: function (obj, type, handler, id) {
		var pre = '_leaflet_',
		    touches = this._pointers;

		var cb = function (e) {
			for (var i = 0; i < touches.length; i++) {
				if (touches[i].pointerId === e.pointerId) {
					touches.splice(i, 1);
					break;
				}
			}

			e.touches = touches.slice();
			e.changedTouches = [e];

			handler(e);
		};

		obj[pre + 'touchend' + id] = cb;
		obj.addEventListener(this.POINTER_UP, cb, false);
		obj.addEventListener(this.POINTER_CANCEL, cb, false);

		return this;
	},

	removePointerListener: function (obj, type, id) {
		var pre = '_leaflet_',
		    cb = obj[pre + type + id];

		switch (type) {
		case 'touchstart':
			obj.removeEventListener(this.POINTER_DOWN, cb, false);
			break;
		case 'touchmove':
			obj.removeEventListener(this.POINTER_MOVE, cb, false);
			break;
		case 'touchend':
			obj.removeEventListener(this.POINTER_UP, cb, false);
			obj.removeEventListener(this.POINTER_CANCEL, cb, false);
			break;
		}

		return this;
	}
});


/*
 * L.Handler.TouchZoom is used by L.Map to add pinch zoom on supported mobile browsers.
 */

L.Map.mergeOptions({
	touchZoom: L.Browser.touch && !L.Browser.android23,
	bounceAtZoomLimits: true
});

L.Map.TouchZoom = L.Handler.extend({
	addHooks: function () {
		L.DomEvent.on(this._map._container, 'touchstart', this._onTouchStart, this);
	},

	removeHooks: function () {
		L.DomEvent.off(this._map._container, 'touchstart', this._onTouchStart, this);
	},

	_onTouchStart: function (e) {
		var map = this._map;

		if (!e.touches || e.touches.length !== 2 || map._animatingZoom || this._zooming) { return; }

		var p1 = map.mouseEventToLayerPoint(e.touches[0]),
		    p2 = map.mouseEventToLayerPoint(e.touches[1]),
		    viewCenter = map._getCenterLayerPoint();

		this._startCenter = p1.add(p2)._divideBy(2);
		this._startDist = p1.distanceTo(p2);

		this._moved = false;
		this._zooming = true;

		this._centerOffset = viewCenter.subtract(this._startCenter);

		if (map._panAnim) {
			map._panAnim.stop();
		}

		L.DomEvent
		    .on(document, 'touchmove', this._onTouchMove, this)
		    .on(document, 'touchend', this._onTouchEnd, this);

		L.DomEvent.preventDefault(e);
	},

	_onTouchMove: function (e) {
		var map = this._map;

		if (!e.touches || e.touches.length !== 2 || !this._zooming) { return; }

		var p1 = map.mouseEventToLayerPoint(e.touches[0]),
		    p2 = map.mouseEventToLayerPoint(e.touches[1]);

		this._scale = p1.distanceTo(p2) / this._startDist;
		this._delta = p1._add(p2)._divideBy(2)._subtract(this._startCenter);

		if (this._scale === 1) { return; }

		if (!map.options.bounceAtZoomLimits) {
			if ((map.getZoom() === map.getMinZoom() && this._scale < 1) ||
			    (map.getZoom() === map.getMaxZoom() && this._scale > 1)) { return; }
		}

		if (!this._moved) {
			L.DomUtil.addClass(map._mapPane, 'leaflet-touching');

			map
			    .fire('movestart')
			    .fire('zoomstart');

			this._moved = true;
		}

		L.Util.cancelAnimFrame(this._animRequest);
		this._animRequest = L.Util.requestAnimFrame(
		        this._updateOnMove, this, true, this._map._container);

		L.DomEvent.preventDefault(e);
	},

	_updateOnMove: function () {
		var map = this._map,
		    origin = this._getScaleOrigin(),
		    center = map.layerPointToLatLng(origin),
		    zoom = map.getScaleZoom(this._scale);

		map._animateZoom(center, zoom, this._startCenter, this._scale, this._delta, false, true);
	},

	_onTouchEnd: function () {
		if (!this._moved || !this._zooming) {
			this._zooming = false;
			return;
		}

		var map = this._map;

		this._zooming = false;
		L.DomUtil.removeClass(map._mapPane, 'leaflet-touching');
		L.Util.cancelAnimFrame(this._animRequest);

		L.DomEvent
		    .off(document, 'touchmove', this._onTouchMove)
		    .off(document, 'touchend', this._onTouchEnd);

		var origin = this._getScaleOrigin(),
		    center = map.layerPointToLatLng(origin),

		    oldZoom = map.getZoom(),
		    floatZoomDelta = map.getScaleZoom(this._scale) - oldZoom,
		    roundZoomDelta = (floatZoomDelta > 0 ?
		            Math.ceil(floatZoomDelta) : Math.floor(floatZoomDelta)),

		    zoom = map._limitZoom(oldZoom + roundZoomDelta),
		    scale = map.getZoomScale(zoom) / this._scale;

		map._animateZoom(center, zoom, origin, scale);
	},

	_getScaleOrigin: function () {
		var centerOffset = this._centerOffset.subtract(this._delta).divideBy(this._scale);
		return this._startCenter.add(centerOffset);
	}
});

L.Map.addInitHook('addHandler', 'touchZoom', L.Map.TouchZoom);


/*
 * L.Map.Tap is used to enable mobile hacks like quick taps and long hold.
 */

L.Map.mergeOptions({
	tap: true,
	tapTolerance: 15
});

L.Map.Tap = L.Handler.extend({
	addHooks: function () {
		L.DomEvent.on(this._map._container, 'touchstart', this._onDown, this);
	},

	removeHooks: function () {
		L.DomEvent.off(this._map._container, 'touchstart', this._onDown, this);
	},

	_onDown: function (e) {
		if (!e.touches) { return; }

		L.DomEvent.preventDefault(e);

		this._fireClick = true;

		// don't simulate click or track longpress if more than 1 touch
		if (e.touches.length > 1) {
			this._fireClick = false;
			clearTimeout(this._holdTimeout);
			return;
		}

		var first = e.touches[0],
		    el = first.target;

		this._startPos = this._newPos = new L.Point(first.clientX, first.clientY);

		// if touching a link, highlight it
		if (el.tagName && el.tagName.toLowerCase() === 'a') {
			L.DomUtil.addClass(el, 'leaflet-active');
		}

		// simulate long hold but setting a timeout
		this._holdTimeout = setTimeout(L.bind(function () {
			if (this._isTapValid()) {
				this._fireClick = false;
				this._onUp();
				this._simulateEvent('contextmenu', first);
			}
		}, this), 1000);

		L.DomEvent
			.on(document, 'touchmove', this._onMove, this)
			.on(document, 'touchend', this._onUp, this);
	},

	_onUp: function (e) {
		clearTimeout(this._holdTimeout);

		L.DomEvent
			.off(document, 'touchmove', this._onMove, this)
			.off(document, 'touchend', this._onUp, this);

		if (this._fireClick && e && e.changedTouches) {

			var first = e.changedTouches[0],
			    el = first.target;

			if (el && el.tagName && el.tagName.toLowerCase() === 'a') {
				L.DomUtil.removeClass(el, 'leaflet-active');
			}

			// simulate click if the touch didn't move too much
			if (this._isTapValid()) {
				this._simulateEvent('click', first);
			}
		}
	},

	_isTapValid: function () {
		return this._newPos.distanceTo(this._startPos) <= this._map.options.tapTolerance;
	},

	_onMove: function (e) {
		var first = e.touches[0];
		this._newPos = new L.Point(first.clientX, first.clientY);
	},

	_simulateEvent: function (type, e) {
		var simulatedEvent = document.createEvent('MouseEvents');

		simulatedEvent._simulated = true;
		e.target._simulatedClick = true;

		simulatedEvent.initMouseEvent(
		        type, true, true, window, 1,
		        e.screenX, e.screenY,
		        e.clientX, e.clientY,
		        false, false, false, false, 0, null);

		e.target.dispatchEvent(simulatedEvent);
	}
});

if (L.Browser.touch && !L.Browser.pointer) {
	L.Map.addInitHook('addHandler', 'tap', L.Map.Tap);
}


/*
 * L.Handler.ShiftDragZoom is used to add shift-drag zoom interaction to the map
  * (zoom to a selected bounding box), enabled by default.
 */

L.Map.mergeOptions({
	boxZoom: true
});

L.Map.BoxZoom = L.Handler.extend({
	initialize: function (map) {
		this._map = map;
		this._container = map._container;
		this._pane = map._panes.overlayPane;
		this._moved = false;
	},

	addHooks: function () {
		L.DomEvent.on(this._container, 'mousedown', this._onMouseDown, this);
	},

	removeHooks: function () {
		L.DomEvent.off(this._container, 'mousedown', this._onMouseDown);
		this._moved = false;
	},

	moved: function () {
		return this._moved;
	},

	_onMouseDown: function (e) {
		this._moved = false;

		if (!e.shiftKey || ((e.which !== 1) && (e.button !== 1))) { return false; }

		L.DomUtil.disableTextSelection();
		L.DomUtil.disableImageDrag();

		this._startLayerPoint = this._map.mouseEventToLayerPoint(e);

		L.DomEvent
		    .on(document, 'mousemove', this._onMouseMove, this)
		    .on(document, 'mouseup', this._onMouseUp, this)
		    .on(document, 'keydown', this._onKeyDown, this);
	},

	_onMouseMove: function (e) {
		if (!this._moved) {
			this._box = L.DomUtil.create('div', 'leaflet-zoom-box', this._pane);
			L.DomUtil.setPosition(this._box, this._startLayerPoint);

			//TODO refactor: move cursor to styles
			this._container.style.cursor = 'crosshair';
			this._map.fire('boxzoomstart');
		}

		var startPoint = this._startLayerPoint,
		    box = this._box,

		    layerPoint = this._map.mouseEventToLayerPoint(e),
		    offset = layerPoint.subtract(startPoint),

		    newPos = new L.Point(
		        Math.min(layerPoint.x, startPoint.x),
		        Math.min(layerPoint.y, startPoint.y));

		L.DomUtil.setPosition(box, newPos);

		this._moved = true;

		// TODO refactor: remove hardcoded 4 pixels
		box.style.width  = (Math.max(0, Math.abs(offset.x) - 4)) + 'px';
		box.style.height = (Math.max(0, Math.abs(offset.y) - 4)) + 'px';
	},

	_finish: function () {
		if (this._moved) {
			this._pane.removeChild(this._box);
			this._container.style.cursor = '';
		}

		L.DomUtil.enableTextSelection();
		L.DomUtil.enableImageDrag();

		L.DomEvent
		    .off(document, 'mousemove', this._onMouseMove)
		    .off(document, 'mouseup', this._onMouseUp)
		    .off(document, 'keydown', this._onKeyDown);
	},

	_onMouseUp: function (e) {

		this._finish();

		var map = this._map,
		    layerPoint = map.mouseEventToLayerPoint(e);

		if (this._startLayerPoint.equals(layerPoint)) { return; }

		var bounds = new L.LatLngBounds(
		        map.layerPointToLatLng(this._startLayerPoint),
		        map.layerPointToLatLng(layerPoint));

		map.fitBounds(bounds);

		map.fire('boxzoomend', {
			boxZoomBounds: bounds
		});
	},

	_onKeyDown: function (e) {
		if (e.keyCode === 27) {
			this._finish();
		}
	}
});

L.Map.addInitHook('addHandler', 'boxZoom', L.Map.BoxZoom);


/*
 * L.Map.Keyboard is handling keyboard interaction with the map, enabled by default.
 */

L.Map.mergeOptions({
	keyboard: true,
	keyboardPanOffset: 80,
	keyboardZoomOffset: 1
});

L.Map.Keyboard = L.Handler.extend({

	keyCodes: {
		left:    [37],
		right:   [39],
		down:    [40],
		up:      [38],
		zoomIn:  [187, 107, 61, 171],
		zoomOut: [189, 109, 173]
	},

	initialize: function (map) {
		this._map = map;

		this._setPanOffset(map.options.keyboardPanOffset);
		this._setZoomOffset(map.options.keyboardZoomOffset);
	},

	addHooks: function () {
		var container = this._map._container;

		// make the container focusable by tabbing
		if (container.tabIndex === -1) {
			container.tabIndex = '0';
		}

		L.DomEvent
		    .on(container, 'focus', this._onFocus, this)
		    .on(container, 'blur', this._onBlur, this)
		    .on(container, 'mousedown', this._onMouseDown, this);

		this._map
		    .on('focus', this._addHooks, this)
		    .on('blur', this._removeHooks, this);
	},

	removeHooks: function () {
		this._removeHooks();

		var container = this._map._container;

		L.DomEvent
		    .off(container, 'focus', this._onFocus, this)
		    .off(container, 'blur', this._onBlur, this)
		    .off(container, 'mousedown', this._onMouseDown, this);

		this._map
		    .off('focus', this._addHooks, this)
		    .off('blur', this._removeHooks, this);
	},

	_onMouseDown: function () {
		if (this._focused) { return; }

		var body = document.body,
		    docEl = document.documentElement,
		    top = body.scrollTop || docEl.scrollTop,
		    left = body.scrollLeft || docEl.scrollLeft;

		this._map._container.focus();

		window.scrollTo(left, top);
	},

	_onFocus: function () {
		this._focused = true;
		this._map.fire('focus');
	},

	_onBlur: function () {
		this._focused = false;
		this._map.fire('blur');
	},

	_setPanOffset: function (pan) {
		var keys = this._panKeys = {},
		    codes = this.keyCodes,
		    i, len;

		for (i = 0, len = codes.left.length; i < len; i++) {
			keys[codes.left[i]] = [-1 * pan, 0];
		}
		for (i = 0, len = codes.right.length; i < len; i++) {
			keys[codes.right[i]] = [pan, 0];
		}
		for (i = 0, len = codes.down.length; i < len; i++) {
			keys[codes.down[i]] = [0, pan];
		}
		for (i = 0, len = codes.up.length; i < len; i++) {
			keys[codes.up[i]] = [0, -1 * pan];
		}
	},

	_setZoomOffset: function (zoom) {
		var keys = this._zoomKeys = {},
		    codes = this.keyCodes,
		    i, len;

		for (i = 0, len = codes.zoomIn.length; i < len; i++) {
			keys[codes.zoomIn[i]] = zoom;
		}
		for (i = 0, len = codes.zoomOut.length; i < len; i++) {
			keys[codes.zoomOut[i]] = -zoom;
		}
	},

	_addHooks: function () {
		L.DomEvent.on(document, 'keydown', this._onKeyDown, this);
	},

	_removeHooks: function () {
		L.DomEvent.off(document, 'keydown', this._onKeyDown, this);
	},

	_onKeyDown: function (e) {
		var key = e.keyCode,
		    map = this._map;

		if (key in this._panKeys) {

			if (map._panAnim && map._panAnim._inProgress) { return; }

			map.panBy(this._panKeys[key]);

			if (map.options.maxBounds) {
				map.panInsideBounds(map.options.maxBounds);
			}

		} else if (key in this._zoomKeys) {
			map.setZoom(map.getZoom() + this._zoomKeys[key]);

		} else {
			return;
		}

		L.DomEvent.stop(e);
	}
});

L.Map.addInitHook('addHandler', 'keyboard', L.Map.Keyboard);


/*
 * L.Handler.MarkerDrag is used internally by L.Marker to make the markers draggable.
 */

L.Handler.MarkerDrag = L.Handler.extend({
	initialize: function (marker) {
		this._marker = marker;
	},

	addHooks: function () {
		var icon = this._marker._icon;
		if (!this._draggable) {
			this._draggable = new L.Draggable(icon, icon);
		}

		this._draggable
			.on('dragstart', this._onDragStart, this)
			.on('drag', this._onDrag, this)
			.on('dragend', this._onDragEnd, this);
		this._draggable.enable();
		L.DomUtil.addClass(this._marker._icon, 'leaflet-marker-draggable');
	},

	removeHooks: function () {
		this._draggable
			.off('dragstart', this._onDragStart, this)
			.off('drag', this._onDrag, this)
			.off('dragend', this._onDragEnd, this);

		this._draggable.disable();
		L.DomUtil.removeClass(this._marker._icon, 'leaflet-marker-draggable');
	},

	moved: function () {
		return this._draggable && this._draggable._moved;
	},

	_onDragStart: function () {
		this._marker
		    .closePopup()
		    .fire('movestart')
		    .fire('dragstart');
	},

	_onDrag: function () {
		var marker = this._marker,
		    shadow = marker._shadow,
		    iconPos = L.DomUtil.getPosition(marker._icon),
		    latlng = marker._map.layerPointToLatLng(iconPos);

		// update shadow position
		if (shadow) {
			L.DomUtil.setPosition(shadow, iconPos);
		}

		marker._latlng = latlng;

		marker
		    .fire('move', {latlng: latlng})
		    .fire('drag');
	},

	_onDragEnd: function (e) {
		this._marker
		    .fire('moveend')
		    .fire('dragend', e);
	}
});


/*
 * L.Control is a base class for implementing map controls. Handles positioning.
 * All other controls extend from this class.
 */

L.Control = L.Class.extend({
	options: {
		position: 'topright'
	},

	initialize: function (options) {
		L.setOptions(this, options);
	},

	getPosition: function () {
		return this.options.position;
	},

	setPosition: function (position) {
		var map = this._map;

		if (map) {
			map.removeControl(this);
		}

		this.options.position = position;

		if (map) {
			map.addControl(this);
		}

		return this;
	},

	getContainer: function () {
		return this._container;
	},

	addTo: function (map) {
		this._map = map;

		var container = this._container = this.onAdd(map),
		    pos = this.getPosition(),
		    corner = map._controlCorners[pos];

		L.DomUtil.addClass(container, 'leaflet-control');

		if (pos.indexOf('bottom') !== -1) {
			corner.insertBefore(container, corner.firstChild);
		} else {
			corner.appendChild(container);
		}

		return this;
	},

	removeFrom: function (map) {
		var pos = this.getPosition(),
		    corner = map._controlCorners[pos];

		corner.removeChild(this._container);
		this._map = null;

		if (this.onRemove) {
			this.onRemove(map);
		}

		return this;
	},

	_refocusOnMap: function () {
		if (this._map) {
			this._map.getContainer().focus();
		}
	}
});

L.control = function (options) {
	return new L.Control(options);
};


// adds control-related methods to L.Map

L.Map.include({
	addControl: function (control) {
		control.addTo(this);
		return this;
	},

	removeControl: function (control) {
		control.removeFrom(this);
		return this;
	},

	_initControlPos: function () {
		var corners = this._controlCorners = {},
		    l = 'leaflet-',
		    container = this._controlContainer =
		            L.DomUtil.create('div', l + 'control-container', this._container);

		function createCorner(vSide, hSide) {
			var className = l + vSide + ' ' + l + hSide;

			corners[vSide + hSide] = L.DomUtil.create('div', className, container);
		}

		createCorner('top', 'left');
		createCorner('top', 'right');
		createCorner('bottom', 'left');
		createCorner('bottom', 'right');
	},

	_clearControlPos: function () {
		this._container.removeChild(this._controlContainer);
	}
});


/*
 * L.Control.Zoom is used for the default zoom buttons on the map.
 */

L.Control.Zoom = L.Control.extend({
	options: {
		position: 'topleft',
		zoomInText: '+',
		zoomInTitle: 'Zoom in',
		zoomOutText: '-',
		zoomOutTitle: 'Zoom out'
	},

	onAdd: function (map) {
		var zoomName = 'leaflet-control-zoom',
		    container = L.DomUtil.create('div', zoomName + ' leaflet-bar');

		this._map = map;

		this._zoomInButton  = this._createButton(
		        this.options.zoomInText, this.options.zoomInTitle,
		        zoomName + '-in',  container, this._zoomIn,  this);
		this._zoomOutButton = this._createButton(
		        this.options.zoomOutText, this.options.zoomOutTitle,
		        zoomName + '-out', container, this._zoomOut, this);

		this._updateDisabled();
		map.on('zoomend zoomlevelschange', this._updateDisabled, this);

		return container;
	},

	onRemove: function (map) {
		map.off('zoomend zoomlevelschange', this._updateDisabled, this);
	},

	_zoomIn: function (e) {
		this._map.zoomIn(e.shiftKey ? 3 : 1);
	},

	_zoomOut: function (e) {
		this._map.zoomOut(e.shiftKey ? 3 : 1);
	},

	_createButton: function (html, title, className, container, fn, context) {
		var link = L.DomUtil.create('a', className, container);
		link.innerHTML = html;
		link.href = '#';
		link.title = title;

		var stop = L.DomEvent.stopPropagation;

		L.DomEvent
		    .on(link, 'click', stop)
		    .on(link, 'mousedown', stop)
		    .on(link, 'dblclick', stop)
		    .on(link, 'click', L.DomEvent.preventDefault)
		    .on(link, 'click', fn, context)
		    .on(link, 'click', this._refocusOnMap, context);

		return link;
	},

	_updateDisabled: function () {
		var map = this._map,
			className = 'leaflet-disabled';

		L.DomUtil.removeClass(this._zoomInButton, className);
		L.DomUtil.removeClass(this._zoomOutButton, className);

		if (map._zoom === map.getMinZoom()) {
			L.DomUtil.addClass(this._zoomOutButton, className);
		}
		if (map._zoom === map.getMaxZoom()) {
			L.DomUtil.addClass(this._zoomInButton, className);
		}
	}
});

L.Map.mergeOptions({
	zoomControl: true
});

L.Map.addInitHook(function () {
	if (this.options.zoomControl) {
		this.zoomControl = new L.Control.Zoom();
		this.addControl(this.zoomControl);
	}
});

L.control.zoom = function (options) {
	return new L.Control.Zoom(options);
};



/*
 * L.Control.Attribution is used for displaying attribution on the map (added by default).
 */

L.Control.Attribution = L.Control.extend({
	options: {
		position: 'bottomright',
		prefix: '<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'
	},

	initialize: function (options) {
		L.setOptions(this, options);

		this._attributions = {};
	},

	onAdd: function (map) {
		this._container = L.DomUtil.create('div', 'leaflet-control-attribution');
		L.DomEvent.disableClickPropagation(this._container);

		for (var i in map._layers) {
			if (map._layers[i].getAttribution) {
				this.addAttribution(map._layers[i].getAttribution());
			}
		}
		
		map
		    .on('layeradd', this._onLayerAdd, this)
		    .on('layerremove', this._onLayerRemove, this);

		this._update();

		return this._container;
	},

	onRemove: function (map) {
		map
		    .off('layeradd', this._onLayerAdd)
		    .off('layerremove', this._onLayerRemove);

	},

	setPrefix: function (prefix) {
		this.options.prefix = prefix;
		this._update();
		return this;
	},

	addAttribution: function (text) {
		if (!text) { return; }

		if (!this._attributions[text]) {
			this._attributions[text] = 0;
		}
		this._attributions[text]++;

		this._update();

		return this;
	},

	removeAttribution: function (text) {
		if (!text) { return; }

		if (this._attributions[text]) {
			this._attributions[text]--;
			this._update();
		}

		return this;
	},

	_update: function () {
		if (!this._map) { return; }

		var attribs = [];

		for (var i in this._attributions) {
			if (this._attributions[i]) {
				attribs.push(i);
			}
		}

		var prefixAndAttribs = [];

		if (this.options.prefix) {
			prefixAndAttribs.push(this.options.prefix);
		}
		if (attribs.length) {
			prefixAndAttribs.push(attribs.join(', '));
		}

		this._container.innerHTML = prefixAndAttribs.join(' | ');
	},

	_onLayerAdd: function (e) {
		if (e.layer.getAttribution) {
			this.addAttribution(e.layer.getAttribution());
		}
	},

	_onLayerRemove: function (e) {
		if (e.layer.getAttribution) {
			this.removeAttribution(e.layer.getAttribution());
		}
	}
});

L.Map.mergeOptions({
	attributionControl: true
});

L.Map.addInitHook(function () {
	if (this.options.attributionControl) {
		this.attributionControl = (new L.Control.Attribution()).addTo(this);
	}
});

L.control.attribution = function (options) {
	return new L.Control.Attribution(options);
};


/*
 * L.Control.Scale is used for displaying metric/imperial scale on the map.
 */

L.Control.Scale = L.Control.extend({
	options: {
		position: 'bottomleft',
		maxWidth: 100,
		metric: true,
		imperial: true,
		updateWhenIdle: false
	},

	onAdd: function (map) {
		this._map = map;

		var className = 'leaflet-control-scale',
		    container = L.DomUtil.create('div', className),
		    options = this.options;

		this._addScales(options, className, container);

		map.on(options.updateWhenIdle ? 'moveend' : 'move', this._update, this);
		map.whenReady(this._update, this);

		return container;
	},

	onRemove: function (map) {
		map.off(this.options.updateWhenIdle ? 'moveend' : 'move', this._update, this);
	},

	_addScales: function (options, className, container) {
		if (options.metric) {
			this._mScale = L.DomUtil.create('div', className + '-line', container);
		}
		if (options.imperial) {
			this._iScale = L.DomUtil.create('div', className + '-line', container);
		}
	},

	_update: function () {
		var bounds = this._map.getBounds(),
		    centerLat = bounds.getCenter().lat,
		    halfWorldMeters = 6378137 * Math.PI * Math.cos(centerLat * Math.PI / 180),
		    dist = halfWorldMeters * (bounds.getNorthEast().lng - bounds.getSouthWest().lng) / 180,

		    size = this._map.getSize(),
		    options = this.options,
		    maxMeters = 0;

		if (size.x > 0) {
			maxMeters = dist * (options.maxWidth / size.x);
		}

		this._updateScales(options, maxMeters);
	},

	_updateScales: function (options, maxMeters) {
		if (options.metric && maxMeters) {
			this._updateMetric(maxMeters);
		}

		if (options.imperial && maxMeters) {
			this._updateImperial(maxMeters);
		}
	},

	_updateMetric: function (maxMeters) {
		var meters = this._getRoundNum(maxMeters);

		this._mScale.style.width = this._getScaleWidth(meters / maxMeters) + 'px';
		this._mScale.innerHTML = meters < 1000 ? meters + ' m' : (meters / 1000) + ' km';
	},

	_updateImperial: function (maxMeters) {
		var maxFeet = maxMeters * 3.2808399,
		    scale = this._iScale,
		    maxMiles, miles, feet;

		if (maxFeet > 5280) {
			maxMiles = maxFeet / 5280;
			miles = this._getRoundNum(maxMiles);

			scale.style.width = this._getScaleWidth(miles / maxMiles) + 'px';
			scale.innerHTML = miles + ' mi';

		} else {
			feet = this._getRoundNum(maxFeet);

			scale.style.width = this._getScaleWidth(feet / maxFeet) + 'px';
			scale.innerHTML = feet + ' ft';
		}
	},

	_getScaleWidth: function (ratio) {
		return Math.round(this.options.maxWidth * ratio) - 10;
	},

	_getRoundNum: function (num) {
		var pow10 = Math.pow(10, (Math.floor(num) + '').length - 1),
		    d = num / pow10;

		d = d >= 10 ? 10 : d >= 5 ? 5 : d >= 3 ? 3 : d >= 2 ? 2 : 1;

		return pow10 * d;
	}
});

L.control.scale = function (options) {
	return new L.Control.Scale(options);
};


/*
 * L.Control.Layers is a control to allow users to switch between different layers on the map.
 */

L.Control.Layers = L.Control.extend({
	options: {
		collapsed: true,
		position: 'topright',
		autoZIndex: true
	},

	initialize: function (baseLayers, overlays, options) {
		L.setOptions(this, options);

		this._layers = {};
		this._lastZIndex = 0;
		this._handlingClick = false;

		for (var i in baseLayers) {
			this._addLayer(baseLayers[i], i);
		}

		for (i in overlays) {
			this._addLayer(overlays[i], i, true);
		}
	},

	onAdd: function (map) {
		this._initLayout();
		this._update();

		map
		    .on('layeradd', this._onLayerChange, this)
		    .on('layerremove', this._onLayerChange, this);

		return this._container;
	},

	onRemove: function (map) {
		map
		    .off('layeradd', this._onLayerChange, this)
		    .off('layerremove', this._onLayerChange, this);
	},

	addBaseLayer: function (layer, name) {
		this._addLayer(layer, name);
		this._update();
		return this;
	},

	addOverlay: function (layer, name) {
		this._addLayer(layer, name, true);
		this._update();
		return this;
	},

	removeLayer: function (layer) {
		var id = L.stamp(layer);
		delete this._layers[id];
		this._update();
		return this;
	},

	_initLayout: function () {
		var className = 'leaflet-control-layers',
		    container = this._container = L.DomUtil.create('div', className);

		//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released
		container.setAttribute('aria-haspopup', true);

		if (!L.Browser.touch) {
			L.DomEvent
				.disableClickPropagation(container)
				.disableScrollPropagation(container);
		} else {
			L.DomEvent.on(container, 'click', L.DomEvent.stopPropagation);
		}

		var form = this._form = L.DomUtil.create('form', className + '-list');

		if (this.options.collapsed) {
			if (!L.Browser.android) {
				L.DomEvent
				    .on(container, 'mouseover', this._expand, this)
				    .on(container, 'mouseout', this._collapse, this);
			}
			var link = this._layersLink = L.DomUtil.create('a', className + '-toggle', container);
			link.href = '#';
			link.title = 'Layers';

			if (L.Browser.touch) {
				L.DomEvent
				    .on(link, 'click', L.DomEvent.stop)
				    .on(link, 'click', this._expand, this);
			}
			else {
				L.DomEvent.on(link, 'focus', this._expand, this);
			}
			//Work around for Firefox android issue https://github.com/Leaflet/Leaflet/issues/2033
			L.DomEvent.on(form, 'click', function () {
				setTimeout(L.bind(this._onInputClick, this), 0);
			}, this);

			this._map.on('click', this._collapse, this);
			// TODO keyboard accessibility
		} else {
			this._expand();
		}

		this._baseLayersList = L.DomUtil.create('div', className + '-base', form);
		this._separator = L.DomUtil.create('div', className + '-separator', form);
		this._overlaysList = L.DomUtil.create('div', className + '-overlays', form);

		container.appendChild(form);
	},

	_addLayer: function (layer, name, overlay) {
		var id = L.stamp(layer);

		this._layers[id] = {
			layer: layer,
			name: name,
			overlay: overlay
		};

		if (this.options.autoZIndex && layer.setZIndex) {
			this._lastZIndex++;
			layer.setZIndex(this._lastZIndex);
		}
	},

	_update: function () {
		if (!this._container) {
			return;
		}

		this._baseLayersList.innerHTML = '';
		this._overlaysList.innerHTML = '';

		var baseLayersPresent = false,
		    overlaysPresent = false,
		    i, obj;

		for (i in this._layers) {
			obj = this._layers[i];
			this._addItem(obj);
			overlaysPresent = overlaysPresent || obj.overlay;
			baseLayersPresent = baseLayersPresent || !obj.overlay;
		}

		this._separator.style.display = overlaysPresent && baseLayersPresent ? '' : 'none';
	},

	_onLayerChange: function (e) {
		var obj = this._layers[L.stamp(e.layer)];

		if (!obj) { return; }

		if (!this._handlingClick) {
			this._update();
		}

		var type = obj.overlay ?
			(e.type === 'layeradd' ? 'overlayadd' : 'overlayremove') :
			(e.type === 'layeradd' ? 'baselayerchange' : null);

		if (type) {
			this._map.fire(type, obj);
		}
	},

	// IE7 bugs out if you create a radio dynamically, so you have to do it this hacky way (see http://bit.ly/PqYLBe)
	_createRadioElement: function (name, checked) {

		var radioHtml = '<input type="radio" class="leaflet-control-layers-selector" name="' + name + '"';
		if (checked) {
			radioHtml += ' checked="checked"';
		}
		radioHtml += '/>';

		var radioFragment = document.createElement('div');
		radioFragment.innerHTML = radioHtml;

		return radioFragment.firstChild;
	},

	_addItem: function (obj) {
		var label = document.createElement('label'),
		    input,
		    checked = this._map.hasLayer(obj.layer);

		if (obj.overlay) {
			input = document.createElement('input');
			input.type = 'checkbox';
			input.className = 'leaflet-control-layers-selector';
			input.defaultChecked = checked;
		} else {
			input = this._createRadioElement('leaflet-base-layers', checked);
		}

		input.layerId = L.stamp(obj.layer);

		L.DomEvent.on(input, 'click', this._onInputClick, this);

		var name = document.createElement('span');
		name.innerHTML = ' ' + obj.name;

		label.appendChild(input);
		label.appendChild(name);

		var container = obj.overlay ? this._overlaysList : this._baseLayersList;
		container.appendChild(label);

		return label;
	},

	_onInputClick: function () {
		var i, input, obj,
		    inputs = this._form.getElementsByTagName('input'),
		    inputsLen = inputs.length;

		this._handlingClick = true;

		for (i = 0; i < inputsLen; i++) {
			input = inputs[i];
			obj = this._layers[input.layerId];

			if (input.checked && !this._map.hasLayer(obj.layer)) {
				this._map.addLayer(obj.layer);

			} else if (!input.checked && this._map.hasLayer(obj.layer)) {
				this._map.removeLayer(obj.layer);
			}
		}

		this._handlingClick = false;

		this._refocusOnMap();
	},

	_expand: function () {
		L.DomUtil.addClass(this._container, 'leaflet-control-layers-expanded');
	},

	_collapse: function () {
		this._container.className = this._container.className.replace(' leaflet-control-layers-expanded', '');
	}
});

L.control.layers = function (baseLayers, overlays, options) {
	return new L.Control.Layers(baseLayers, overlays, options);
};


/*
 * L.PosAnimation is used by Leaflet internally for pan animations.
 */

L.PosAnimation = L.Class.extend({
	includes: L.Mixin.Events,

	run: function (el, newPos, duration, easeLinearity) { // (HTMLElement, Point[, Number, Number])
		this.stop();

		this._el = el;
		this._inProgress = true;
		this._newPos = newPos;

		this.fire('start');

		el.style[L.DomUtil.TRANSITION] = 'all ' + (duration || 0.25) +
		        's cubic-bezier(0,0,' + (easeLinearity || 0.5) + ',1)';

		L.DomEvent.on(el, L.DomUtil.TRANSITION_END, this._onTransitionEnd, this);
		L.DomUtil.setPosition(el, newPos);

		// toggle reflow, Chrome flickers for some reason if you don't do this
		L.Util.falseFn(el.offsetWidth);

		// there's no native way to track value updates of transitioned properties, so we imitate this
		this._stepTimer = setInterval(L.bind(this._onStep, this), 50);
	},

	stop: function () {
		if (!this._inProgress) { return; }

		// if we just removed the transition property, the element would jump to its final position,
		// so we need to make it stay at the current position

		L.DomUtil.setPosition(this._el, this._getPos());
		this._onTransitionEnd();
		L.Util.falseFn(this._el.offsetWidth); // force reflow in case we are about to start a new animation
	},

	_onStep: function () {
		var stepPos = this._getPos();
		if (!stepPos) {
			this._onTransitionEnd();
			return;
		}
		// jshint camelcase: false
		// make L.DomUtil.getPosition return intermediate position value during animation
		this._el._leaflet_pos = stepPos;

		this.fire('step');
	},

	// you can't easily get intermediate values of properties animated with CSS3 Transitions,
	// we need to parse computed style (in case of transform it returns matrix string)

	_transformRe: /([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,

	_getPos: function () {
		var left, top, matches,
		    el = this._el,
		    style = window.getComputedStyle(el);

		if (L.Browser.any3d) {
			matches = style[L.DomUtil.TRANSFORM].match(this._transformRe);
			if (!matches) { return; }
			left = parseFloat(matches[1]);
			top  = parseFloat(matches[2]);
		} else {
			left = parseFloat(style.left);
			top  = parseFloat(style.top);
		}

		return new L.Point(left, top, true);
	},

	_onTransitionEnd: function () {
		L.DomEvent.off(this._el, L.DomUtil.TRANSITION_END, this._onTransitionEnd, this);

		if (!this._inProgress) { return; }
		this._inProgress = false;

		this._el.style[L.DomUtil.TRANSITION] = '';

		// jshint camelcase: false
		// make sure L.DomUtil.getPosition returns the final position value after animation
		this._el._leaflet_pos = this._newPos;

		clearInterval(this._stepTimer);

		this.fire('step').fire('end');
	}

});


/*
 * Extends L.Map to handle panning animations.
 */

L.Map.include({

	setView: function (center, zoom, options) {

		zoom = zoom === undefined ? this._zoom : this._limitZoom(zoom);
		center = this._limitCenter(L.latLng(center), zoom, this.options.maxBounds);
		options = options || {};

		if (this._panAnim) {
			this._panAnim.stop();
		}

		if (this._loaded && !options.reset && options !== true) {

			if (options.animate !== undefined) {
				options.zoom = L.extend({animate: options.animate}, options.zoom);
				options.pan = L.extend({animate: options.animate}, options.pan);
			}

			// try animating pan or zoom
			var animated = (this._zoom !== zoom) ?
				this._tryAnimatedZoom && this._tryAnimatedZoom(center, zoom, options.zoom) :
				this._tryAnimatedPan(center, options.pan);

			if (animated) {
				// prevent resize handler call, the view will refresh after animation anyway
				clearTimeout(this._sizeTimer);
				return this;
			}
		}

		// animation didn't start, just reset the map view
		this._resetView(center, zoom);

		return this;
	},

	panBy: function (offset, options) {
		offset = L.point(offset).round();
		options = options || {};

		if (!offset.x && !offset.y) {
			return this;
		}

		if (!this._panAnim) {
			this._panAnim = new L.PosAnimation();

			this._panAnim.on({
				'step': this._onPanTransitionStep,
				'end': this._onPanTransitionEnd
			}, this);
		}

		// don't fire movestart if animating inertia
		if (!options.noMoveStart) {
			this.fire('movestart');
		}

		// animate pan unless animate: false specified
		if (options.animate !== false) {
			L.DomUtil.addClass(this._mapPane, 'leaflet-pan-anim');

			var newPos = this._getMapPanePos().subtract(offset);
			this._panAnim.run(this._mapPane, newPos, options.duration || 0.25, options.easeLinearity);
		} else {
			this._rawPanBy(offset);
			this.fire('move').fire('moveend');
		}

		return this;
	},

	_onPanTransitionStep: function () {
		this.fire('move');
	},

	_onPanTransitionEnd: function () {
		L.DomUtil.removeClass(this._mapPane, 'leaflet-pan-anim');
		this.fire('moveend');
	},

	_tryAnimatedPan: function (center, options) {
		// difference between the new and current centers in pixels
		var offset = this._getCenterOffset(center)._floor();

		// don't animate too far unless animate: true specified in options
		if ((options && options.animate) !== true && !this.getSize().contains(offset)) { return false; }

		this.panBy(offset, options);

		return true;
	}
});


/*
 * L.PosAnimation fallback implementation that powers Leaflet pan animations
 * in browsers that don't support CSS3 Transitions.
 */

L.PosAnimation = L.DomUtil.TRANSITION ? L.PosAnimation : L.PosAnimation.extend({

	run: function (el, newPos, duration, easeLinearity) { // (HTMLElement, Point[, Number, Number])
		this.stop();

		this._el = el;
		this._inProgress = true;
		this._duration = duration || 0.25;
		this._easeOutPower = 1 / Math.max(easeLinearity || 0.5, 0.2);

		this._startPos = L.DomUtil.getPosition(el);
		this._offset = newPos.subtract(this._startPos);
		this._startTime = +new Date();

		this.fire('start');

		this._animate();
	},

	stop: function () {
		if (!this._inProgress) { return; }

		this._step();
		this._complete();
	},

	_animate: function () {
		// animation loop
		this._animId = L.Util.requestAnimFrame(this._animate, this);
		this._step();
	},

	_step: function () {
		var elapsed = (+new Date()) - this._startTime,
		    duration = this._duration * 1000;

		if (elapsed < duration) {
			this._runFrame(this._easeOut(elapsed / duration));
		} else {
			this._runFrame(1);
			this._complete();
		}
	},

	_runFrame: function (progress) {
		var pos = this._startPos.add(this._offset.multiplyBy(progress));
		L.DomUtil.setPosition(this._el, pos);

		this.fire('step');
	},

	_complete: function () {
		L.Util.cancelAnimFrame(this._animId);

		this._inProgress = false;
		this.fire('end');
	},

	_easeOut: function (t) {
		return 1 - Math.pow(1 - t, this._easeOutPower);
	}
});


/*
 * Extends L.Map to handle zoom animations.
 */

L.Map.mergeOptions({
	zoomAnimation: true,
	zoomAnimationThreshold: 4
});

if (L.DomUtil.TRANSITION) {

	L.Map.addInitHook(function () {
		// don't animate on browsers without hardware-accelerated transitions or old Android/Opera
		this._zoomAnimated = this.options.zoomAnimation && L.DomUtil.TRANSITION &&
				L.Browser.any3d && !L.Browser.android23 && !L.Browser.mobileOpera;

		// zoom transitions run with the same duration for all layers, so if one of transitionend events
		// happens after starting zoom animation (propagating to the map pane), we know that it ended globally
		if (this._zoomAnimated) {
			L.DomEvent.on(this._mapPane, L.DomUtil.TRANSITION_END, this._catchTransitionEnd, this);
		}
	});
}

L.Map.include(!L.DomUtil.TRANSITION ? {} : {

	_catchTransitionEnd: function (e) {
		if (this._animatingZoom && e.propertyName.indexOf('transform') >= 0) {
			this._onZoomTransitionEnd();
		}
	},

	_nothingToAnimate: function () {
		return !this._container.getElementsByClassName('leaflet-zoom-animated').length;
	},

	_tryAnimatedZoom: function (center, zoom, options) {

		if (this._animatingZoom) { return true; }

		options = options || {};

		// don't animate if disabled, not supported or zoom difference is too large
		if (!this._zoomAnimated || options.animate === false || this._nothingToAnimate() ||
		        Math.abs(zoom - this._zoom) > this.options.zoomAnimationThreshold) { return false; }

		// offset is the pixel coords of the zoom origin relative to the current center
		var scale = this.getZoomScale(zoom),
		    offset = this._getCenterOffset(center)._divideBy(1 - 1 / scale),
			origin = this._getCenterLayerPoint()._add(offset);

		// don't animate if the zoom origin isn't within one screen from the current center, unless forced
		if (options.animate !== true && !this.getSize().contains(offset)) { return false; }

		this
		    .fire('movestart')
		    .fire('zoomstart');

		this._animateZoom(center, zoom, origin, scale, null, true);

		return true;
	},

	_animateZoom: function (center, zoom, origin, scale, delta, backwards, forTouchZoom) {

		if (!forTouchZoom) {
			this._animatingZoom = true;
		}

		// put transform transition on all layers with leaflet-zoom-animated class
		L.DomUtil.addClass(this._mapPane, 'leaflet-zoom-anim');

		// remember what center/zoom to set after animation
		this._animateToCenter = center;
		this._animateToZoom = zoom;

		// disable any dragging during animation
		if (L.Draggable) {
			L.Draggable._disabled = true;
		}

		L.Util.requestAnimFrame(function () {
			this.fire('zoomanim', {
				center: center,
				zoom: zoom,
				origin: origin,
				scale: scale,
				delta: delta,
				backwards: backwards
			});
			// horrible hack to work around a Chrome bug https://github.com/Leaflet/Leaflet/issues/3689
			setTimeout(L.bind(this._onZoomTransitionEnd, this), 250);
		}, this);
	},

	_onZoomTransitionEnd: function () {
		if (!this._animatingZoom) { return; }

		this._animatingZoom = false;

		L.DomUtil.removeClass(this._mapPane, 'leaflet-zoom-anim');

		this._resetView(this._animateToCenter, this._animateToZoom, true, true);

		if (L.Draggable) {
			L.Draggable._disabled = false;
		}
	}
});


/*
	Zoom animation logic for L.TileLayer.
*/

L.TileLayer.include({
	_animateZoom: function (e) {
		if (!this._animating) {
			this._animating = true;
			this._prepareBgBuffer();
		}

		var bg = this._bgBuffer,
		    transform = L.DomUtil.TRANSFORM,
		    initialTransform = e.delta ? L.DomUtil.getTranslateString(e.delta) : bg.style[transform],
		    scaleStr = L.DomUtil.getScaleString(e.scale, e.origin);

		bg.style[transform] = e.backwards ?
				scaleStr + ' ' + initialTransform :
				initialTransform + ' ' + scaleStr;
	},

	_endZoomAnim: function () {
		var front = this._tileContainer,
		    bg = this._bgBuffer;

		front.style.visibility = '';
		front.parentNode.appendChild(front); // Bring to fore

		// force reflow
		L.Util.falseFn(bg.offsetWidth);

		var zoom = this._map.getZoom();
		if (zoom > this.options.maxZoom || zoom < this.options.minZoom) {
			this._clearBgBuffer();
		}

		this._animating = false;
	},

	_clearBgBuffer: function () {
		var map = this._map;

		if (map && !map._animatingZoom && !map.touchZoom._zooming) {
			this._bgBuffer.innerHTML = '';
			this._bgBuffer.style[L.DomUtil.TRANSFORM] = '';
		}
	},

	_prepareBgBuffer: function () {

		var front = this._tileContainer,
		    bg = this._bgBuffer;

		// if foreground layer doesn't have many tiles but bg layer does,
		// keep the existing bg layer and just zoom it some more

		var bgLoaded = this._getLoadedTilesPercentage(bg),
		    frontLoaded = this._getLoadedTilesPercentage(front);

		if (bg && bgLoaded > 0.5 && frontLoaded < 0.5) {

			front.style.visibility = 'hidden';
			this._stopLoadingImages(front);
			return;
		}

		// prepare the buffer to become the front tile pane
		bg.style.visibility = 'hidden';
		bg.style[L.DomUtil.TRANSFORM] = '';

		// switch out the current layer to be the new bg layer (and vice-versa)
		this._tileContainer = bg;
		bg = this._bgBuffer = front;

		this._stopLoadingImages(bg);

		//prevent bg buffer from clearing right after zoom
		clearTimeout(this._clearBgBufferTimer);
	},

	_getLoadedTilesPercentage: function (container) {
		var tiles = container.getElementsByTagName('img'),
		    i, len, count = 0;

		for (i = 0, len = tiles.length; i < len; i++) {
			if (tiles[i].complete) {
				count++;
			}
		}
		return count / len;
	},

	// stops loading all tiles in the background layer
	_stopLoadingImages: function (container) {
		var tiles = Array.prototype.slice.call(container.getElementsByTagName('img')),
		    i, len, tile;

		for (i = 0, len = tiles.length; i < len; i++) {
			tile = tiles[i];

			if (!tile.complete) {
				tile.onload = L.Util.falseFn;
				tile.onerror = L.Util.falseFn;
				tile.src = L.Util.emptyImageUrl;

				tile.parentNode.removeChild(tile);
			}
		}
	}
});


/*
 * Provides L.Map with convenient shortcuts for using browser geolocation features.
 */

L.Map.include({
	_defaultLocateOptions: {
		watch: false,
		setView: false,
		maxZoom: Infinity,
		timeout: 10000,
		maximumAge: 0,
		enableHighAccuracy: false
	},

	locate: function (/*Object*/ options) {

		options = this._locateOptions = L.extend(this._defaultLocateOptions, options);

		if (!navigator.geolocation) {
			this._handleGeolocationError({
				code: 0,
				message: 'Geolocation not supported.'
			});
			return this;
		}

		var onResponse = L.bind(this._handleGeolocationResponse, this),
			onError = L.bind(this._handleGeolocationError, this);

		if (options.watch) {
			this._locationWatchId =
			        navigator.geolocation.watchPosition(onResponse, onError, options);
		} else {
			navigator.geolocation.getCurrentPosition(onResponse, onError, options);
		}
		return this;
	},

	stopLocate: function () {
		if (navigator.geolocation) {
			navigator.geolocation.clearWatch(this._locationWatchId);
		}
		if (this._locateOptions) {
			this._locateOptions.setView = false;
		}
		return this;
	},

	_handleGeolocationError: function (error) {
		var c = error.code,
		    message = error.message ||
		            (c === 1 ? 'permission denied' :
		            (c === 2 ? 'position unavailable' : 'timeout'));

		if (this._locateOptions.setView && !this._loaded) {
			this.fitWorld();
		}

		this.fire('locationerror', {
			code: c,
			message: 'Geolocation error: ' + message + '.'
		});
	},

	_handleGeolocationResponse: function (pos) {
		var lat = pos.coords.latitude,
		    lng = pos.coords.longitude,
		    latlng = new L.LatLng(lat, lng),

		    latAccuracy = 180 * pos.coords.accuracy / 40075017,
		    lngAccuracy = latAccuracy / Math.cos(L.LatLng.DEG_TO_RAD * lat),

		    bounds = L.latLngBounds(
		            [lat - latAccuracy, lng - lngAccuracy],
		            [lat + latAccuracy, lng + lngAccuracy]),

		    options = this._locateOptions;

		if (options.setView) {
			var zoom = Math.min(this.getBoundsZoom(bounds), options.maxZoom);
			this.setView(latlng, zoom);
		}

		var data = {
			latlng: latlng,
			bounds: bounds,
			timestamp: pos.timestamp
		};

		for (var i in pos.coords) {
			if (typeof pos.coords[i] === 'number') {
				data[i] = pos.coords[i];
			}
		}

		this.fire('locationfound', data);
	}
});


}(window, document));
},{}],23:[function(require,module,exports){
/**
 * Copyright (c) 2011-2014 Felix Gnass
 * Licensed under the MIT license
 * http://spin.js.org/
 *
 * Example:
    var opts = {
      lines: 12             // The number of lines to draw
    , length: 7             // The length of each line
    , width: 5              // The line thickness
    , radius: 10            // The radius of the inner circle
    , scale: 1.0            // Scales overall size of the spinner
    , corners: 1            // Roundness (0..1)
    , color: '#000'         // #rgb or #rrggbb
    , opacity: 1/4          // Opacity of the lines
    , rotate: 0             // Rotation offset
    , direction: 1          // 1: clockwise, -1: counterclockwise
    , speed: 1              // Rounds per second
    , trail: 100            // Afterglow percentage
    , fps: 20               // Frames per second when using setTimeout()
    , zIndex: 2e9           // Use a high z-index by default
    , className: 'spinner'  // CSS class to assign to the element
    , top: '50%'            // center vertically
    , left: '50%'           // center horizontally
    , shadow: false         // Whether to render a shadow
    , hwaccel: false        // Whether to use hardware acceleration (might be buggy)
    , position: 'absolute'  // Element positioning
    }
    var target = document.getElementById('foo')
    var spinner = new Spinner(opts).spin(target)
 */
;(function (root, factory) {

  /* CommonJS */
  if (typeof module == 'object' && module.exports) module.exports = factory()

  /* AMD module */
  else if (typeof define == 'function' && define.amd) define(factory)

  /* Browser global */
  else root.Spinner = factory()
}(this, function () {
  "use strict"

  var prefixes = ['webkit', 'Moz', 'ms', 'O'] /* Vendor prefixes */
    , animations = {} /* Animation rules keyed by their name */
    , useCssAnimations /* Whether to use CSS animations or setTimeout */
    , sheet /* A stylesheet to hold the @keyframe or VML rules. */

  /**
   * Utility function to create elements. If no tag name is given,
   * a DIV is created. Optionally properties can be passed.
   */
  function createEl (tag, prop) {
    var el = document.createElement(tag || 'div')
      , n

    for (n in prop) el[n] = prop[n]
    return el
  }

  /**
   * Appends children and returns the parent.
   */
  function ins (parent /* child1, child2, ...*/) {
    for (var i = 1, n = arguments.length; i < n; i++) {
      parent.appendChild(arguments[i])
    }

    return parent
  }

  /**
   * Creates an opacity keyframe animation rule and returns its name.
   * Since most mobile Webkits have timing issues with animation-delay,
   * we create separate rules for each line/segment.
   */
  function addAnimation (alpha, trail, i, lines) {
    var name = ['opacity', trail, ~~(alpha * 100), i, lines].join('-')
      , start = 0.01 + i/lines * 100
      , z = Math.max(1 - (1-alpha) / trail * (100-start), alpha)
      , prefix = useCssAnimations.substring(0, useCssAnimations.indexOf('Animation')).toLowerCase()
      , pre = prefix && '-' + prefix + '-' || ''

    if (!animations[name]) {
      sheet.insertRule(
        '@' + pre + 'keyframes ' + name + '{' +
        '0%{opacity:' + z + '}' +
        start + '%{opacity:' + alpha + '}' +
        (start+0.01) + '%{opacity:1}' +
        (start+trail) % 100 + '%{opacity:' + alpha + '}' +
        '100%{opacity:' + z + '}' +
        '}', sheet.cssRules.length)

      animations[name] = 1
    }

    return name
  }

  /**
   * Tries various vendor prefixes and returns the first supported property.
   */
  function vendor (el, prop) {
    var s = el.style
      , pp
      , i

    prop = prop.charAt(0).toUpperCase() + prop.slice(1)
    if (s[prop] !== undefined) return prop
    for (i = 0; i < prefixes.length; i++) {
      pp = prefixes[i]+prop
      if (s[pp] !== undefined) return pp
    }
  }

  /**
   * Sets multiple style properties at once.
   */
  function css (el, prop) {
    for (var n in prop) {
      el.style[vendor(el, n) || n] = prop[n]
    }

    return el
  }

  /**
   * Fills in default values.
   */
  function merge (obj) {
    for (var i = 1; i < arguments.length; i++) {
      var def = arguments[i]
      for (var n in def) {
        if (obj[n] === undefined) obj[n] = def[n]
      }
    }
    return obj
  }

  /**
   * Returns the line color from the given string or array.
   */
  function getColor (color, idx) {
    return typeof color == 'string' ? color : color[idx % color.length]
  }

  // Built-in defaults

  var defaults = {
    lines: 12             // The number of lines to draw
  , length: 7             // The length of each line
  , width: 5              // The line thickness
  , radius: 10            // The radius of the inner circle
  , scale: 1.0            // Scales overall size of the spinner
  , corners: 1            // Roundness (0..1)
  , color: '#000'         // #rgb or #rrggbb
  , opacity: 1/4          // Opacity of the lines
  , rotate: 0             // Rotation offset
  , direction: 1          // 1: clockwise, -1: counterclockwise
  , speed: 1              // Rounds per second
  , trail: 100            // Afterglow percentage
  , fps: 20               // Frames per second when using setTimeout()
  , zIndex: 2e9           // Use a high z-index by default
  , className: 'spinner'  // CSS class to assign to the element
  , top: '50%'            // center vertically
  , left: '50%'           // center horizontally
  , shadow: false         // Whether to render a shadow
  , hwaccel: false        // Whether to use hardware acceleration (might be buggy)
  , position: 'absolute'  // Element positioning
  }

  /** The constructor */
  function Spinner (o) {
    this.opts = merge(o || {}, Spinner.defaults, defaults)
  }

  // Global defaults that override the built-ins:
  Spinner.defaults = {}

  merge(Spinner.prototype, {
    /**
     * Adds the spinner to the given target element. If this instance is already
     * spinning, it is automatically removed from its previous target b calling
     * stop() internally.
     */
    spin: function (target) {
      this.stop()

      var self = this
        , o = self.opts
        , el = self.el = createEl(null, {className: o.className})

      css(el, {
        position: o.position
      , width: 0
      , zIndex: o.zIndex
      , left: o.left
      , top: o.top
      })

      if (target) {
        target.insertBefore(el, target.firstChild || null)
      }

      el.setAttribute('role', 'progressbar')
      self.lines(el, self.opts)

      if (!useCssAnimations) {
        // No CSS animation support, use setTimeout() instead
        var i = 0
          , start = (o.lines - 1) * (1 - o.direction) / 2
          , alpha
          , fps = o.fps
          , f = fps / o.speed
          , ostep = (1 - o.opacity) / (f * o.trail / 100)
          , astep = f / o.lines

        ;(function anim () {
          i++
          for (var j = 0; j < o.lines; j++) {
            alpha = Math.max(1 - (i + (o.lines - j) * astep) % f * ostep, o.opacity)

            self.opacity(el, j * o.direction + start, alpha, o)
          }
          self.timeout = self.el && setTimeout(anim, ~~(1000 / fps))
        })()
      }
      return self
    }

    /**
     * Stops and removes the Spinner.
     */
  , stop: function () {
      var el = this.el
      if (el) {
        clearTimeout(this.timeout)
        if (el.parentNode) el.parentNode.removeChild(el)
        this.el = undefined
      }
      return this
    }

    /**
     * Internal method that draws the individual lines. Will be overwritten
     * in VML fallback mode below.
     */
  , lines: function (el, o) {
      var i = 0
        , start = (o.lines - 1) * (1 - o.direction) / 2
        , seg

      function fill (color, shadow) {
        return css(createEl(), {
          position: 'absolute'
        , width: o.scale * (o.length + o.width) + 'px'
        , height: o.scale * o.width + 'px'
        , background: color
        , boxShadow: shadow
        , transformOrigin: 'left'
        , transform: 'rotate(' + ~~(360/o.lines*i + o.rotate) + 'deg) translate(' + o.scale*o.radius + 'px' + ',0)'
        , borderRadius: (o.corners * o.scale * o.width >> 1) + 'px'
        })
      }

      for (; i < o.lines; i++) {
        seg = css(createEl(), {
          position: 'absolute'
        , top: 1 + ~(o.scale * o.width / 2) + 'px'
        , transform: o.hwaccel ? 'translate3d(0,0,0)' : ''
        , opacity: o.opacity
        , animation: useCssAnimations && addAnimation(o.opacity, o.trail, start + i * o.direction, o.lines) + ' ' + 1 / o.speed + 's linear infinite'
        })

        if (o.shadow) ins(seg, css(fill('#000', '0 0 4px #000'), {top: '2px'}))
        ins(el, ins(seg, fill(getColor(o.color, i), '0 0 1px rgba(0,0,0,.1)')))
      }
      return el
    }

    /**
     * Internal method that adjusts the opacity of a single line.
     * Will be overwritten in VML fallback mode below.
     */
  , opacity: function (el, i, val) {
      if (i < el.childNodes.length) el.childNodes[i].style.opacity = val
    }

  })


  function initVML () {

    /* Utility function to create a VML tag */
    function vml (tag, attr) {
      return createEl('<' + tag + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', attr)
    }

    // No CSS transforms but VML support, add a CSS rule for VML elements:
    sheet.addRule('.spin-vml', 'behavior:url(#default#VML)')

    Spinner.prototype.lines = function (el, o) {
      var r = o.scale * (o.length + o.width)
        , s = o.scale * 2 * r

      function grp () {
        return css(
          vml('group', {
            coordsize: s + ' ' + s
          , coordorigin: -r + ' ' + -r
          })
        , { width: s, height: s }
        )
      }

      var margin = -(o.width + o.length) * o.scale * 2 + 'px'
        , g = css(grp(), {position: 'absolute', top: margin, left: margin})
        , i

      function seg (i, dx, filter) {
        ins(
          g
        , ins(
            css(grp(), {rotation: 360 / o.lines * i + 'deg', left: ~~dx})
          , ins(
              css(
                vml('roundrect', {arcsize: o.corners})
              , { width: r
                , height: o.scale * o.width
                , left: o.scale * o.radius
                , top: -o.scale * o.width >> 1
                , filter: filter
                }
              )
            , vml('fill', {color: getColor(o.color, i), opacity: o.opacity})
            , vml('stroke', {opacity: 0}) // transparent stroke to fix color bleeding upon opacity change
            )
          )
        )
      }

      if (o.shadow)
        for (i = 1; i <= o.lines; i++) {
          seg(i, -2, 'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)')
        }

      for (i = 1; i <= o.lines; i++) seg(i)
      return ins(el, g)
    }

    Spinner.prototype.opacity = function (el, i, val, o) {
      var c = el.firstChild
      o = o.shadow && o.lines || 0
      if (c && i + o < c.childNodes.length) {
        c = c.childNodes[i + o]; c = c && c.firstChild; c = c && c.firstChild
        if (c) c.opacity = val
      }
    }
  }

  if (typeof document !== 'undefined') {
    sheet = (function () {
      var el = createEl('style', {type : 'text/css'})
      ins(document.getElementsByTagName('head')[0], el)
      return el.sheet || el.styleSheet
    }())

    var probe = css(createEl('group'), {behavior: 'url(#default#VML)'})

    if (!vendor(probe, 'transform') && probe.adj) initVML()
    else useCssAnimations = vendor(probe, 'animation')
  }

  return Spinner

}));

},{}],24:[function(require,module,exports){
/**
 * Turf is a modular GIS engine written in JavaScript. It performs geospatial
 * processing tasks with GeoJSON data and can be run on a server or in a browser.
 *
 * @module turf
 * @summary GIS For Web Maps
 */
module.exports = {
  isolines: require('turf-isolines'),
  merge: require('turf-merge'),
  convex: require('turf-convex'),
  within: require('turf-within'),
  concave: require('turf-concave'),
  count: require('turf-count'),
  erase: require('turf-erase'),
  variance: require('turf-variance'),
  deviation: require('turf-deviation'),
  median: require('turf-median'),
  min: require('turf-min'),
  max: require('turf-max'),
  aggregate: require('turf-aggregate'),
  flip: require('turf-flip'),
  simplify: require('turf-simplify'),
  sum: require('turf-sum'),
  average: require('turf-average'),
  bezier: require('turf-bezier'),
  tag: require('turf-tag'),
  size: require('turf-size'),
  sample: require('turf-sample'),
  jenks: require('turf-jenks'),
  quantile: require('turf-quantile'),
  envelope: require('turf-envelope'),
  square: require('turf-square'),
  midpoint: require('turf-midpoint'),
  buffer: require('turf-buffer'),
  center: require('turf-center'),
  centroid: require('turf-centroid'),
  combine: require('turf-combine'),
  distance: require('turf-distance'),
  explode: require('turf-explode'),
  extent: require('turf-extent'),
  bboxPolygon: require('turf-bbox-polygon'),
  featurecollection: require('turf-featurecollection'),
  filter: require('turf-filter'),
  inside: require('turf-inside'),
  intersect: require('turf-intersect'),
  linestring: require('turf-linestring'),
  nearest: require('turf-nearest'),
  planepoint: require('turf-planepoint'),
  point: require('turf-point'),
  polygon: require('turf-polygon'),
  random: require('turf-random'),
  reclass: require('turf-reclass'),
  remove: require('turf-remove'),
  tin: require('turf-tin'),
  union: require('turf-union'),
  bearing: require('turf-bearing'),
  destination: require('turf-destination'),
  kinks: require('turf-kinks'),
  pointOnSurface: require('turf-point-on-surface'),
  area: require('turf-area'),
  along: require('turf-along'),
  lineDistance: require('turf-line-distance'),
  lineSlice: require('turf-line-slice'),
  pointOnLine: require('turf-point-on-line'),
  pointGrid: require('turf-point-grid'),
  squareGrid: require('turf-square-grid'),
  triangleGrid: require('turf-triangle-grid'),
  hexGrid: require('turf-hex-grid')
};

},{"turf-aggregate":25,"turf-along":26,"turf-area":27,"turf-average":30,"turf-bbox-polygon":31,"turf-bearing":32,"turf-bezier":33,"turf-buffer":35,"turf-center":40,"turf-centroid":41,"turf-combine":43,"turf-concave":44,"turf-convex":45,"turf-count":75,"turf-destination":76,"turf-deviation":77,"turf-distance":79,"turf-envelope":81,"turf-erase":82,"turf-explode":87,"turf-extent":89,"turf-featurecollection":91,"turf-filter":92,"turf-flip":93,"turf-hex-grid":94,"turf-inside":95,"turf-intersect":96,"turf-isolines":102,"turf-jenks":104,"turf-kinks":106,"turf-line-distance":107,"turf-line-slice":108,"turf-linestring":109,"turf-max":110,"turf-median":111,"turf-merge":112,"turf-midpoint":114,"turf-min":115,"turf-nearest":116,"turf-planepoint":117,"turf-point":121,"turf-point-grid":118,"turf-point-on-line":119,"turf-point-on-surface":120,"turf-polygon":122,"turf-quantile":123,"turf-random":125,"turf-reclass":127,"turf-remove":128,"turf-sample":129,"turf-simplify":130,"turf-size":132,"turf-square":134,"turf-square-grid":133,"turf-sum":135,"turf-tag":136,"turf-tin":137,"turf-triangle-grid":138,"turf-union":139,"turf-variance":144,"turf-within":146}],25:[function(require,module,exports){
var average = require('turf-average');
var sum = require('turf-sum');
var median = require('turf-median');
var min = require('turf-min');
var max = require('turf-max');
var deviation = require('turf-deviation');
var variance = require('turf-variance');
var count = require('turf-count');
var operations = {};
operations.average = average;
operations.sum = sum;
operations.median = median;
operations.min = min;
operations.max = max;
operations.deviation = deviation;
operations.variance = variance;
operations.count = count;

/**
* Calculates a series of aggregations for a set of {@link Point} features within a set of {@link Polygon} features. Sum, average, count, min, max, and deviation are supported.
*
* @module turf/aggregate
* @category aggregation
* @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
* @param {FeatureCollection} points a FeatureCollection of {@link Point} features
* @param {Array} aggregations an array of aggregation objects
* @return {FeatureCollection} a FeatureCollection of {@link Polygon} features with properties listed as `outField` values in `aggregations`
* @example
* var polygons = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [1.669921, 48.632908],
*           [1.669921, 49.382372],
*           [3.636474, 49.382372],
*           [3.636474, 48.632908],
*           [1.669921, 48.632908]
*         ]]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [2.230224, 47.85003],
*           [2.230224, 48.611121],
*           [4.361572, 48.611121],
*           [4.361572, 47.85003],
*           [2.230224, 47.85003]
*         ]]
*       }
*     }
*   ]
* };
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [2.054443,49.138596]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [3.065185,48.850258]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [2.329101,48.79239]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [2.614746,48.334343]
*       }
*     },
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [3.416748,48.056053]
*       }
*     }
*   ]
* };
* var aggregations = [
*   {
*     aggregation: 'sum',
*     inField: 'population',
*     outField: 'pop_sum'
*   },
*   {
*     aggregation: 'average',
*     inField: 'population',
*     outField: 'pop_avg'
*   },
*   {
*     aggregation: 'median',
*     inField: 'population',
*     outField: 'pop_median'
*   },
*   {
*     aggregation: 'min',
*     inField: 'population',
*     outField: 'pop_min'
*   },
*   {
*     aggregation: 'max',
*     inField: 'population',
*     outField: 'pop_max'
*   },
*   {
*     aggregation: 'deviation',
*     inField: 'population',
*     outField: 'pop_deviation'
*   },
*   {
*     aggregation: 'variance',
*     inField: 'population',
*     outField: 'pop_variance'
*   },
*   {
*     aggregation: 'count',
*     inField: '',
*     outField: 'point_count'
*   }
* ];
*
* var aggregated = turf.aggregate(
*   polygons, points, aggregations);
*
* var result = turf.featurecollection(
*   points.features.concat(aggregated.features));
*
* //=result
*/

module.exports = function(polygons, points, aggregations){
  for (var i = 0, len = aggregations.length; i < len; i++) {
    var agg = aggregations[i],
      operation = agg.aggregation,
      unrecognizedError;

    if (isAggregationOperation(operation)) {
      if (operation === 'count') {
        polygons = operations[operation](polygons, points, agg.outField);
      } else {
        polygons = operations[operation](polygons, points, agg.inField, agg.outField);
      }
    } else {
      throw new Error('"'+ operation +'" is not a recognized aggregation operation.');
    }
  }

  return polygons;
};

function isAggregationOperation(operation) {
  return operation === 'average' ||
    operation === 'sum' ||
    operation === 'median' ||
    operation === 'min' ||
    operation === 'max' ||
    operation === 'deviation' ||
    operation === 'variance' ||
    operation === 'count';
}

},{"turf-average":30,"turf-count":75,"turf-deviation":77,"turf-max":110,"turf-median":111,"turf-min":115,"turf-sum":135,"turf-variance":144}],26:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');
var bearing = require('turf-bearing');
var destination = require('turf-destination');

/**
 * Takes a {@link LineString} feature and returns a {@link Point} feature at a specified distance along a line.
 *
 * @module turf/along
 * @category measurement
 * @param {LineString} line a LineString feature
 * @param {Number} distance distance along the line
 * @param {String} [units=miles] can be degrees, radians, miles, or kilometers
 * @return {Point} Point along the line at `distance` distance
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 *
 * var along = turf.along(line, 1, 'miles');
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [line, along]
 * };
 *
 * //=result
 */
module.exports = function (line, dist, units) {
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  var travelled = 0;
  for(var i = 0; i < coords.length; i++) {
    if (dist >= travelled && i === coords.length - 1) break;
    else if(travelled >= dist) {
      var overshot = dist - travelled;
      if(!overshot) return point(coords[i]);
      else {
        var direction = bearing(point(coords[i]), point(coords[i-1])) - 180;
        var interpolated = destination(point(coords[i]), overshot, direction, units);
        return interpolated;
      }
    }
    else {
      travelled += distance(point(coords[i]), point(coords[i+1]), units);
    }
  }
  return point(coords[coords.length - 1]);
}

},{"turf-bearing":32,"turf-destination":76,"turf-distance":79,"turf-point":121}],27:[function(require,module,exports){
var geometryArea = require('geojson-area').geometry;

/**
 * Takes a {@link GeoJSON} feature or {@link FeatureCollection} of any type and returns the area of that feature
 * in square meters.
 *
 * @module turf/area
 * @category measurement
 * @param {GeoJSON} input a {@link Feature} or {@link FeatureCollection} of any type
 * @return {Number} area in square meters
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-67.031021, 10.458102],
 *           [-67.031021, 10.53372],
 *           [-66.929397, 10.53372],
 *           [-66.929397, 10.458102],
 *           [-67.031021, 10.458102]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-66.919784, 10.397325],
 *           [-66.919784, 10.513467],
 *           [-66.805114, 10.513467],
 *           [-66.805114, 10.397325],
 *           [-66.919784, 10.397325]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 *
 * var area = turf.area(polygons);
 *
 * //=area
 */
module.exports = function(_) {
    if (_.type === 'FeatureCollection') {
        for (var i = 0, sum = 0; i < _.features.length; i++) {
            if (_.features[i].geometry) {
                sum += geometryArea(_.features[i].geometry);
            }
        }
        return sum;
    } else if (_.type === 'Feature') {
        return geometryArea(_.geometry);
    } else {
        return geometryArea(_);
    }
};

},{"geojson-area":28}],28:[function(require,module,exports){
var wgs84 = require('wgs84');

module.exports.geometry = geometry;
module.exports.ring = ringArea;

function geometry(_) {
    var area = 0, i;
    switch (_.type) {
        case 'Polygon':
            return polygonArea(_.coordinates);
        case 'MultiPolygon':
            for (i = 0; i < _.coordinates.length; i++) {
                area += polygonArea(_.coordinates[i]);
            }
            return area;
        case 'Point':
        case 'MultiPoint':
        case 'LineString':
        case 'MultiLineString':
            return 0;
        case 'GeometryCollection':
            for (i = 0; i < _.geometries.length; i++) {
                area += geometry(_.geometries[i]);
            }
            return area;
    }
}

function polygonArea(coords) {
    var area = 0;
    if (coords && coords.length > 0) {
        area += Math.abs(ringArea(coords[0]));
        for (var i = 1; i < coords.length; i++) {
            area -= Math.abs(ringArea(coords[i]));
        }
    }
    return area;
}

/**
 * Calculate the approximate area of the polygon were it projected onto
 *     the earth.  Note that this area will be positive if ring is oriented
 *     clockwise, otherwise it will be negative.
 *
 * Reference:
 * Robert. G. Chamberlain and William H. Duquette, "Some Algorithms for
 *     Polygons on a Sphere", JPL Publication 07-03, Jet Propulsion
 *     Laboratory, Pasadena, CA, June 2007 http://trs-new.jpl.nasa.gov/dspace/handle/2014/40409
 *
 * Returns:
 * {float} The approximate signed geodesic area of the polygon in square
 *     meters.
 */

function ringArea(coords) {
    var area = 0;

    if (coords.length > 2) {
        var p1, p2;
        for (var i = 0; i < coords.length - 1; i++) {
            p1 = coords[i];
            p2 = coords[i + 1];
            area += rad(p2[0] - p1[0]) * (2 + Math.sin(rad(p1[1])) + Math.sin(rad(p2[1])));
        }

        area = area * wgs84.RADIUS * wgs84.RADIUS / 2;
    }

    return area;
}

function rad(_) {
    return _ * Math.PI / 180;
}

},{"wgs84":29}],29:[function(require,module,exports){
module.exports.RADIUS = 6378137;
module.exports.FLATTENING = 1/298.257223563;
module.exports.POLAR_RADIUS = 6356752.3142;

},{}],30:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the average value of a field for a set of {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/average
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} field the field in the `points` features from which to pull values to average
 * @param {string} outputField the field in the `polygons` FeatureCollection to put results of the averages
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features with the value of `outField` set to the calculated average
 * @example
* var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [10.666351, 59.890659],
 *           [10.666351, 59.936784],
 *           [10.762481, 59.936784],
 *           [10.762481, 59.890659],
 *           [10.666351, 59.890659]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [10.764541, 59.889281],
 *           [10.764541, 59.937128],
 *           [10.866165, 59.937128],
 *           [10.866165, 59.889281],
 *           [10.764541, 59.889281]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.724029, 59.926807]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.715789, 59.904778]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.746002, 59.908566]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.806427, 59.908910]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.79544, 59.931624]
 *       }
 *     }
 *   ]
 * };
 *
 * var averaged = turf.average(
 *  polygons, points, 'population', 'pop_avg');
 *
 * var resultFeatures = points.features.concat(
 *   averaged.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField, done){
  polyFC.features.forEach(function(poly){
    if(!poly.properties) poly.properties = {};
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) values.push(pt.properties[inField]);
    });
    poly.properties[outField] = average(values);
  });

  return polyFC;
}

function average(values) {
  var sum = 0;
  for (var i = 0; i < values.length; i++) {
    sum += values[i];
  }
  return sum / values.length;
}

},{"turf-inside":95}],31:[function(require,module,exports){
var polygon = require('turf-polygon');

/**
 * Takes a bbox and returns the equivalent {@link Polygon} feature.
 *
 * @module turf/bbox-polygon
 * @category measurement
 * @param {Array<number>} bbox an Array of bounding box coordinates in the form: ```[xLow, yLow, xHigh, yHigh]```
 * @return {Polygon} a Polygon representation of the bounding box
 * @example
 * var bbox = [0, 0, 10, 10];
 *
 * var poly = turf.bboxPolygon(bbox);
 *
 * //=poly
 */

module.exports = function(bbox){
  var lowLeft = [bbox[0], bbox[1]];
  var topLeft = [bbox[0], bbox[3]];
  var topRight = [bbox[2], bbox[3]];
  var lowRight = [bbox[2], bbox[1]];

  var poly = polygon([[
    lowLeft,
    lowRight,
    topRight,
    topLeft,
    lowLeft
  ]]);
  return poly;
}

},{"turf-polygon":122}],32:[function(require,module,exports){
//http://en.wikipedia.org/wiki/Haversine_formula
//http://www.movable-type.co.uk/scripts/latlong.html

/**
 * Takes two {@link Point} features and finds the bearing between them.
 *
 * @module turf/bearing
 * @category measurement
 * @param {Point} start starting Point
 * @param {Point} end ending Point
 * @category measurement
 * @returns {Number} bearing in decimal degrees
 * @example
 * var point1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": '#f00'
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.343, 39.984]
 *   }
 * };
 * var point2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": '#0f0'
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.534, 39.123]
 *   }
 * };
 *
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [point1, point2]
 * };
 *
 * //=points
 *
 * var bearing = turf.bearing(point1, point2);
 *
 * //=bearing
 */
module.exports = function (point1, point2) {
    var coordinates1 = point1.geometry.coordinates;
    var coordinates2 = point2.geometry.coordinates;

    var lon1 = toRad(coordinates1[0]);
    var lon2 = toRad(coordinates2[0]);
    var lat1 = toRad(coordinates1[1]);
    var lat2 = toRad(coordinates2[1]);
    var a = Math.sin(lon2 - lon1) * Math.cos(lat2);
    var b = Math.cos(lat1) * Math.sin(lat2) -
        Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon2 - lon1);

    var bearing = toDeg(Math.atan2(a, b));

    return bearing;
};

function toRad(degree) {
    return degree * Math.PI / 180;
}

function toDeg(radian) {
    return radian * 180 / Math.PI;
}

},{}],33:[function(require,module,exports){
var linestring = require('turf-linestring');
var Spline = require('./spline.js');

/**
 * Takes a {@link LineString} feature and returns a curved version of the line
 * by applying a [Bezier spline](http://en.wikipedia.org/wiki/B%C3%A9zier_spline)
 * algorithm.
 *
 * The bezier spline implementation is by [Leszek Rybicki](http://leszek.rybicki.cc/).
 *
 * @module turf/bezier
 * @category transformation
 * @param {LineString} line the input LineString
 * @param {number} [resolution=10000] time in milliseconds between points
 * @param {number} [sharpness=0.85] a measure of how curvy the path should be between splines
 * @returns {LineString} curved line
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {
 *     "stroke": "#f00"
 *   },
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-76.091308, 18.427501],
 *       [-76.695556, 18.729501],
 *       [-76.552734, 19.40443],
 *       [-74.61914, 19.134789],
 *       [-73.652343, 20.07657],
 *       [-73.157958, 20.210656]
 *     ]
 *   }
 * };
 *
 * var curved = turf.bezier(line);
 * curved.properties = { stroke: '#0f0' };
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [line, curved]
 * };
 *
 * //=result
 */
module.exports = function(line, resolution, sharpness){
  var lineOut = linestring([]);

  lineOut.properties = line.properties;
  var pts = line.geometry.coordinates.map(function(pt){
    return {x: pt[0], y: pt[1]};
  });

  var spline = new Spline({
    points: pts,
    duration: resolution,
    sharpness: sharpness
  });
  for (var i=0; i<spline.duration; i+=10) {
    var pos = spline.pos(i);
    if (Math.floor(i/100)%2===0) {
        lineOut.geometry.coordinates.push([pos.x, pos.y]);
    }
  }

  return lineOut;
};

},{"./spline.js":34,"turf-linestring":109}],34:[function(require,module,exports){
 /**
   * BezierSpline
   * http://leszekr.github.com/
   *
   * @copyright
   * Copyright (C) 2012 Leszek Rybicki.
   *
   * @license
   * This file is part of BezierSpline
   *
   * BezierSpline is free software: you can redistribute it and/or modify
   * it under the terms of the GNU Lesser General Public License as published by
   * the Free Software Foundation, either version 3 of the License, or
   * (at your option) any later version.
   *
   * BezierSpline is distributed in the hope that it will be useful,
   * but WITHOUT ANY WARRANTY; without even the implied warranty of
   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   * GNU General Public License for more details.
   *
   * You should have received a copy of the GNU General Public License
   * along with BezierSpline.  If not, see <http://www.gnu.org/copyleft/lesser.html>.
   */

  /*
  Usage:

    var spline = new Spline({
      points: array_of_control_points,
      duration: time_in_miliseconds,
      sharpness: how_curvy,
      stepLength: distance_between_points_to_cache
    });

  */
var Spline = function(options){
    this.points = options.points || [];
    this.duration = options.duration || 10000;
    this.sharpness = options.sharpness || 0.85;
    this.centers = [];
    this.controls = [];
    this.stepLength = options.stepLength || 60;
    this.length = this.points.length;
    this.delay = 0;
    // this is to ensure compatibility with the 2d version
    for(var i=0; i<this.length; i++) this.points[i].z = this.points[i].z || 0;
    for(var i=0; i<this.length-1; i++){
      var p1 = this.points[i];
      var p2 = this.points[i+1];
      this.centers.push({x:(p1.x+p2.x)/2, y:(p1.y+p2.y)/2, z:(p1.z+p2.z)/2});
    }
    this.controls.push([this.points[0],this.points[0]]);
    for(var i=0; i<this.centers.length-1; i++){
      var p1 = this.centers[i];
      var p2 = this.centers[i+1];
      var dx = this.points[i+1].x-(this.centers[i].x+this.centers[i+1].x)/2;
      var dy = this.points[i+1].y-(this.centers[i].y+this.centers[i+1].y)/2;
      var dz = this.points[i+1].z-(this.centers[i].y+this.centers[i+1].z)/2;
      this.controls.push([{
        x:(1.0-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i].x+dx),
        y:(1.0-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i].y+dy),
        z:(1.0-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i].z+dz)},
      {
        x:(1.0-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i+1].x+dx),
        y:(1.0-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i+1].y+dy),
        z:(1.0-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i+1].z+dz)}]);
    }
    this.controls.push([this.points[this.length-1],this.points[this.length-1]]);
    this.steps = this.cacheSteps(this.stepLength);
    return this;
  };

  /*
    Caches an array of equidistant (more or less) points on the curve.
  */
  Spline.prototype.cacheSteps = function(mindist){
    var steps = [];
    var laststep = this.pos(0);
    steps.push(0);
    for(var t=0; t<this.duration; t+=10){
      var step = this.pos(t);
      var dist = Math.sqrt((step.x-laststep.x)*(step.x-laststep.x)+(step.y-laststep.y)*(step.y-laststep.y)+(step.z-laststep.z)*(step.z-laststep.z));
      if(dist>mindist){
        steps.push(t);
        laststep = step;
      }
    }
    return steps;
  };

  /*
    returns angle and speed in the given point in the curve
  */
  Spline.prototype.vector = function(t){
    var p1 = this.pos(t+10);
    var p2 = this.pos(t-10);
    return {
      angle:180*Math.atan2(p1.y-p2.y, p1.x-p2.x)/3.14,
      speed:Math.sqrt((p2.x-p1.x)*(p2.x-p1.x)+(p2.y-p1.y)*(p2.y-p1.y)+(p2.z-p1.z)*(p2.z-p1.z))
    };
  };

  /*
    Gets the position of the point, given time.

    WARNING: The speed is not constant. The time it takes between control points is constant.

    For constant speed, use Spline.steps[i];
  */
  Spline.prototype.pos = function(time){

    function bezier(t, p1, c1, c2, p2){
      var B = function(t) {
        var t2=t*t, t3=t2*t;
        return [(t3),(3*t2*(1-t)),(3*t*(1-t)*(1-t)),((1-t)*(1-t)*(1-t))]
      }
      var b = B(t)
      var pos = {
        x : p2.x * b[0] + c2.x * b[1] +c1.x * b[2] + p1.x * b[3],
        y : p2.y * b[0] + c2.y * b[1] +c1.y * b[2] + p1.y * b[3],
        z : p2.z * b[0] + c2.z * b[1] +c1.z * b[2] + p1.z * b[3]
      }
      return pos;
    }
    var t = time-this.delay;
    if(t<0) t=0;
    if(t>this.duration) t=this.duration-1;
    //t = t-this.delay;
    var t2 = (t)/this.duration;
    if(t2>=1) return this.points[this.length-1];

    var n = Math.floor((this.points.length-1)*t2);
    var t1 = (this.length-1)*t2-n;
    return bezier(t1,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1]);
  }

  module.exports = Spline;

},{}],35:[function(require,module,exports){
// http://stackoverflow.com/questions/839899/how-do-i-calculate-a-point-on-a-circles-circumference
// radians = degrees * (pi/180)
// https://github.com/bjornharrtell/jsts/blob/master/examples/buffer.html

var featurecollection = require('turf-featurecollection');
var polygon = require('turf-polygon');
var combine = require('turf-combine');
var jsts = require('jsts');

/**
* Calculates a buffer for a {@link Point}, {@link LineString}, or {@link Polygon} {@link Feature}/{@link FeatureCollection} for a given radius. Units supported are miles, kilometers, and degrees.
*
* @module turf/buffer
* @category transformation
* @param {FeatureCollection} feature a Feature or FeatureCollection of any type
* @param {Number} distance distance to draw the buffer
* @param {String} unit 'miles' or 'kilometers'
* @return {FeatureCollection} a FeatureCollection containing {@link Polygon} features representing buffers
*
* @example
* var pt = {
*   "type": "Feature",
*   "properties": {},
*   "geometry": {
*     "type": "Point",
*     "coordinates": [-90.548630, 14.616599]
*   }
* };
* var unit = 'miles';
*
* var buffered = turf.buffer(pt, 500, unit);
*
* var resultFeatures = buffered.features.concat(pt);
* var result = {
*   "type": "FeatureCollection",
*   "features": resultFeatures
* };
*
* //=result
*/

module.exports = function(feature, radius, units){
  var buffered;

  switch(units){
    case 'miles':
      radius = radius / 69.047;
      break
    case 'feet':
      radius = radius / 364568.0;
      break
    case 'kilometers':
      radius = radius / 111.12;
      break
    case 'meters':
      radius = radius / 111120.0;
      break
    case 'degrees':
      break
  }

  if(feature.type === 'FeatureCollection'){
    var multi = combine(feature);
    multi.properties = {};
    buffered = bufferOp(multi, radius);
    return buffered;
  }
  else{
    buffered = bufferOp(feature, radius);
    return buffered;
  }
}

var bufferOp = function(feature, radius){
  var reader = new jsts.io.GeoJSONReader();
  var geom = reader.read(JSON.stringify(feature.geometry));
  var buffered = geom.buffer(radius);
  var parser = new jsts.io.GeoJSONParser();
  buffered = parser.write(buffered);

  if(buffered.type === 'MultiPolygon'){
    buffered = {
      type: 'Feature',
      geometry: buffered,
      properties: {}
    };
    buffered = featurecollection([buffered]);
  }
  else{
    buffered = featurecollection([polygon(buffered.coordinates)]);
  }

  return buffered;
}

},{"jsts":36,"turf-combine":43,"turf-featurecollection":91,"turf-polygon":122}],36:[function(require,module,exports){
require('javascript.util');
var jsts = require('./lib/jsts');
module.exports = jsts

},{"./lib/jsts":37,"javascript.util":39}],37:[function(require,module,exports){
/* The JSTS Topology Suite is a collection of JavaScript classes that
implement the fundamental operations required to validate a given
geo-spatial data set to a known topological specification.

Copyright (C) 2011 The Authors

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA */
jsts={version:'0.15.0',algorithm:{distance:{},locate:{}},error:{},geom:{util:{}},geomgraph:{index:{}},index:{bintree:{},chain:{},kdtree:{},quadtree:{},strtree:{}},io:{},noding:{snapround:{}},operation:{buffer:{},distance:{},overlay:{snap:{}},polygonize:{},predicate:{},relate:{},union:{},valid:{}},planargraph:{},simplify:{},triangulate:{quadedge:{}},util:{}};if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
jsts.abstractFunc=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.error={};jsts.error.IllegalArgumentError=function(message){this.name='IllegalArgumentError';this.message=message;};jsts.error.IllegalArgumentError.prototype=new Error();jsts.error.TopologyError=function(message,pt){this.name='TopologyError';this.message=pt?message+' [ '+pt+' ]':message;};jsts.error.TopologyError.prototype=new Error();jsts.error.AbstractMethodInvocationError=function(){this.name='AbstractMethodInvocationError';this.message='Abstract method called, should be implemented in subclass.';};jsts.error.AbstractMethodInvocationError.prototype=new Error();jsts.error.NotImplementedError=function(){this.name='NotImplementedError';this.message='This method has not yet been implemented.';};jsts.error.NotImplementedError.prototype=new Error();jsts.error.NotRepresentableError=function(message){this.name='NotRepresentableError';this.message=message;};jsts.error.NotRepresentableError.prototype=new Error();jsts.error.LocateFailureError=function(message){this.name='LocateFailureError';this.message=message;};jsts.error.LocateFailureError.prototype=new Error();if(typeof module!=="undefined")module.exports=jsts;jsts.geom.GeometryFilter=function(){};jsts.geom.GeometryFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.PolygonExtracter=function(comps){this.comps=comps;};jsts.geom.util.PolygonExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PolygonExtracter.prototype.comps=null;jsts.geom.util.PolygonExtracter.getPolygons=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Polygon){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection){geom.apply(new jsts.geom.util.PolygonExtracter(list));}
return list;};jsts.geom.util.PolygonExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Polygon)
this.comps.push(geom);};jsts.io.WKTParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.regExes={'typeStr':/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,'emptyTypeStr':/^\s*(\w+)\s*EMPTY\s*$/,'spaces':/\s+/,'parenComma':/\)\s*,\s*\(/,'doubleParenComma':/\)\s*\)\s*,\s*\(\s*\(/,'trimParens':/^\s*\(?(.*?)\)?\s*$/};};jsts.io.WKTParser.prototype.read=function(wkt){var geometry,type,str;wkt=wkt.replace(/[\n\r]/g,' ');var matches=this.regExes.typeStr.exec(wkt);if(wkt.search('EMPTY')!==-1){matches=this.regExes.emptyTypeStr.exec(wkt);matches[2]=undefined;}
if(matches){type=matches[1].toLowerCase();str=matches[2];if(this.parse[type]){geometry=this.parse[type].apply(this,[str]);}}
if(geometry===undefined)
throw new Error('Could not parse WKT '+wkt);return geometry;};jsts.io.WKTParser.prototype.write=function(geometry){return this.extractGeometry(geometry);};jsts.io.WKTParser.prototype.extractGeometry=function(geometry){var type=geometry.CLASS_NAME.split('.')[2].toLowerCase();if(!this.extract[type]){return null;}
var wktType=type.toUpperCase();var data;if(geometry.isEmpty()){data=wktType+' EMPTY';}else{data=wktType+'('+this.extract[type].apply(this,[geometry])+')';}
return data;};jsts.io.WKTParser.prototype.extract={'coordinate':function(coordinate){return coordinate.x+' '+coordinate.y;},'point':function(point){return point.coordinate.x+' '+point.coordinate.y;},'multipoint':function(multipoint){var array=[];for(var i=0,len=multipoint.geometries.length;i<len;++i){array.push('('+
this.extract.point.apply(this,[multipoint.geometries[i]])+')');}
return array.join(',');},'linestring':function(linestring){var array=[];for(var i=0,len=linestring.points.length;i<len;++i){array.push(this.extract.coordinate.apply(this,[linestring.points[i]]));}
return array.join(',');},'multilinestring':function(multilinestring){var array=[];for(var i=0,len=multilinestring.geometries.length;i<len;++i){array.push('('+
this.extract.linestring.apply(this,[multilinestring.geometries[i]])+')');}
return array.join(',');},'polygon':function(polygon){var array=[];array.push('('+this.extract.linestring.apply(this,[polygon.shell])+')');for(var i=0,len=polygon.holes.length;i<len;++i){array.push('('+this.extract.linestring.apply(this,[polygon.holes[i]])+')');}
return array.join(',');},'multipolygon':function(multipolygon){var array=[];for(var i=0,len=multipolygon.geometries.length;i<len;++i){array.push('('+this.extract.polygon.apply(this,[multipolygon.geometries[i]])+')');}
return array.join(',');},'geometrycollection':function(collection){var array=[];for(var i=0,len=collection.geometries.length;i<len;++i){array.push(this.extractGeometry.apply(this,[collection.geometries[i]]));}
return array.join(',');}};jsts.io.WKTParser.prototype.parse={'point':function(str){if(str===undefined){return this.geometryFactory.createPoint(null);}
var coords=str.trim().split(this.regExes.spaces);return this.geometryFactory.createPoint(new jsts.geom.Coordinate(coords[0],coords[1]));},'multipoint':function(str){if(str===undefined){return this.geometryFactory.createMultiPoint(null);}
var point;var points=str.trim().split(',');var components=[];for(var i=0,len=points.length;i<len;++i){point=points[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.point.apply(this,[point]));}
return this.geometryFactory.createMultiPoint(components);},'linestring':function(str){if(str===undefined){return this.geometryFactory.createLineString(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLineString(components);},'linearring':function(str){if(str===undefined){return this.geometryFactory.createLinearRing(null);}
var points=str.trim().split(',');var components=[];var coords;for(var i=0,len=points.length;i<len;++i){coords=points[i].trim().split(this.regExes.spaces);components.push(new jsts.geom.Coordinate(coords[0],coords[1]));}
return this.geometryFactory.createLinearRing(components);},'multilinestring':function(str){if(str===undefined){return this.geometryFactory.createMultiLineString(null);}
var line;var lines=str.trim().split(this.regExes.parenComma);var components=[];for(var i=0,len=lines.length;i<len;++i){line=lines[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.linestring.apply(this,[line]));}
return this.geometryFactory.createMultiLineString(components);},'polygon':function(str){if(str===undefined){return this.geometryFactory.createPolygon(null);}
var ring,linestring,linearring;var rings=str.trim().split(this.regExes.parenComma);var shell;var holes=[];for(var i=0,len=rings.length;i<len;++i){ring=rings[i].replace(this.regExes.trimParens,'$1');linestring=this.parse.linestring.apply(this,[ring]);linearring=this.geometryFactory.createLinearRing(linestring.points);if(i===0){shell=linearring;}else{holes.push(linearring);}}
return this.geometryFactory.createPolygon(shell,holes);},'multipolygon':function(str){if(str===undefined){return this.geometryFactory.createMultiPolygon(null);}
var polygon;var polygons=str.trim().split(this.regExes.doubleParenComma);var components=[];for(var i=0,len=polygons.length;i<len;++i){polygon=polygons[i].replace(this.regExes.trimParens,'$1');components.push(this.parse.polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(components);},'geometrycollection':function(str){if(str===undefined){return this.geometryFactory.createGeometryCollection(null);}
str=str.replace(/,\s*([A-Za-z])/g,'|$1');var wktArray=str.trim().split('|');var components=[];for(var i=0,len=wktArray.length;i<len;++i){components.push(jsts.io.WKTParser.prototype.read.apply(this,[wktArray[i]]));}
return this.geometryFactory.createGeometryCollection(components);}};jsts.index.ItemVisitor=function(){};jsts.index.ItemVisitor.prototype.visitItem=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.CGAlgorithms=function(){};jsts.algorithm.CGAlgorithms.CLOCKWISE=-1;jsts.algorithm.CGAlgorithms.RIGHT=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE=1;jsts.algorithm.CGAlgorithms.LEFT=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.CGAlgorithms.COLLINEAR=0;jsts.algorithm.CGAlgorithms.STRAIGHT=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.CGAlgorithms.orientationIndex=function(p1,p2,q){var dx1,dy1,dx2,dy2;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dx2=q.x-p2.x;dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.algorithm.CGAlgorithms.isPointInRing=function(p,ring){return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.CGAlgorithms.locatePointInRing=function(p,ring){return jsts.algorithm.RayCrossingCounter.locatePointInRing(p,ring);};jsts.algorithm.CGAlgorithms.isOnLine=function(p,pt){var lineIntersector,i,il,p0,p1;lineIntersector=new jsts.algorithm.RobustLineIntersector();for(i=1,il=pt.length;i<il;i++){p0=pt[i-1];p1=pt[i];lineIntersector.computeIntersection(p,p0,p1);if(lineIntersector.hasIntersection()){return true;}}
return false;};jsts.algorithm.CGAlgorithms.isCCW=function(ring){var nPts,hiPt,hiIndex,p,iPrev,iNext,prev,next,i,disc,isCCW;nPts=ring.length-1;if(nPts<3){throw new jsts.IllegalArgumentError('Ring has fewer than 3 points, so orientation cannot be determined');}
hiPt=ring[0];hiIndex=0;i=1;for(i;i<=nPts;i++){p=ring[i];if(p.y>hiPt.y){hiPt=p;hiIndex=i;}}
iPrev=hiIndex;do{iPrev=iPrev-1;if(iPrev<0){iPrev=nPts;}}while(ring[iPrev].equals2D(hiPt)&&iPrev!==hiIndex);iNext=hiIndex;do{iNext=(iNext+1)%nPts;}while(ring[iNext].equals2D(hiPt)&&iNext!==hiIndex);prev=ring[iPrev];next=ring[iNext];if(prev.equals2D(hiPt)||next.equals2D(hiPt)||prev.equals2D(next)){return false;}
disc=jsts.algorithm.CGAlgorithms.computeOrientation(prev,hiPt,next);isCCW=false;if(disc===0){isCCW=(prev.x>next.x);}else{isCCW=(disc>0);}
return isCCW;};jsts.algorithm.CGAlgorithms.computeOrientation=function(p1,p2,q){return jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q);};jsts.algorithm.CGAlgorithms.distancePointLine=function(p,A,B){if(!(A instanceof jsts.geom.Coordinate)){jsts.algorithm.CGAlgorithms.distancePointLine2.apply(this,arguments);}
if(A.x===B.x&&A.y===B.y){return p.distance(A);}
var r,s;r=((p.x-A.x)*(B.x-A.x)+(p.y-A.y)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));if(r<=0.0){return p.distance(A);}
if(r>=1.0){return p.distance(B);}
s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular=function(p,A,B){var s=((A.y-p.y)*(B.x-A.x)-(A.x-p.x)*(B.y-A.y))/((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y));return Math.abs(s)*Math.sqrt(((B.x-A.x)*(B.x-A.x)+(B.y-A.y)*(B.y-A.y)));};jsts.algorithm.CGAlgorithms.distancePointLine2=function(p,line){var minDistance,i,il,dist;if(line.length===0){throw new jsts.error.IllegalArgumentError('Line array must contain at least one vertex');}
minDistance=p.distance(line[0]);for(i=0,il=line.length-1;i<il;i++){dist=jsts.algorithm.CGAlgorithms.distancePointLine(p,line[i],line[i+1]);if(dist<minDistance){minDistance=dist;}}
return minDistance;};jsts.algorithm.CGAlgorithms.distanceLineLine=function(A,B,C,D){if(A.equals(B)){return jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D);}
if(C.equals(D)){return jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B);}
var r_top,r_bot,s_top,s_bot,s,r;r_top=(A.y-C.y)*(D.x-C.x)-(A.x-C.x)*(D.y-C.y);r_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);s_top=(A.y-C.y)*(B.x-A.x)-(A.x-C.x)*(B.y-A.y);s_bot=(B.x-A.x)*(D.y-C.y)-(B.y-A.y)*(D.x-C.x);if((r_bot===0)||(s_bot===0)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
s=s_top/s_bot;r=r_top/r_bot;if((r<0)||(r>1)||(s<0)||(s>1)){return Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(A,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(B,C,D),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(C,A,B),jsts.algorithm.CGAlgorithms.distancePointLine(D,A,B))));}
return 0.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){if(ring.length<3){return 0.0;}
var sum,i,il,bx,by,cx,cy;sum=0.0;for(i=0,il=ring.length-1;i<il;i++){bx=ring[i].x;by=ring[i].y;cx=ring[i+1].x;cy=ring[i+1].y;sum+=(bx+cx)*(cy-by);}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.signedArea=function(ring){var n,sum,p,bx,by,i,cx,cy;n=ring.length;if(n<3){return 0.0;}
sum=0.0;p=ring[0];bx=p.x;by=p.y;for(i=1;i<n;i++){p=ring[i];cx=p.x;cy=p.y;sum+=(bx+cx)*(cy-by);bx=cx;by=cy;}
return-sum/2.0;};jsts.algorithm.CGAlgorithms.computeLength=function(pts){var n=pts.length,len,x0,y0,x1,y1,dx,dy,p,i,il;if(n<=1){return 0.0;}
len=0.0;p=pts[0];x0=p.x;y0=p.y;i=1,il=n;for(i;i<n;i++){p=pts[i];x1=p.x;y1=p.y;dx=x1-x0;dy=y1-y0;len+=Math.sqrt(dx*dx+dy*dy);x0=x1;y0=y1;}
return len;};jsts.algorithm.CGAlgorithms.length=function(){};jsts.algorithm.Angle=function(){};jsts.algorithm.Angle.PI_TIMES_2=2.0*Math.PI;jsts.algorithm.Angle.PI_OVER_2=Math.PI/2.0;jsts.algorithm.Angle.PI_OVER_4=Math.PI/4.0;jsts.algorithm.Angle.COUNTERCLOCKWISE=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.algorithm.Angle.CLOCKWISE=jsts.algorithm.CGAlgorithms.CLOCKWISE;jsts.algorithm.Angle.NONE=jsts.algorithm.CGAlgorithms.COLLINEAR;jsts.algorithm.Angle.toDegrees=function(radians){return(radians*180)/Math.PI;};jsts.algorithm.Angle.toRadians=function(angleDegrees){return(angleDegrees*Math.PI)/180.0;};jsts.algorithm.Angle.angle=function(){if(arguments.length===1){return jsts.algorithm.Angle.angleFromOrigo(arguments[0]);}else{return jsts.algorithm.Angle.angleBetweenCoords(arguments[0],arguments[1]);}};jsts.algorithm.Angle.angleBetweenCoords=function(p0,p1){var dx,dy;dx=p1.x-p0.x;dy=p1.y-p0.y;return Math.atan2(dy,dx);};jsts.algorithm.Angle.angleFromOrigo=function(p){return Math.atan2(p.y,p.x);};jsts.algorithm.Angle.isAcute=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod>0;};jsts.algorithm.Angle.isObtuse=function(p0,p1,p2){var dx0,dy0,dx1,dy1,dotprod;dx0=p0.x-p1.x;dy0=p0.y-p1.y;dx1=p2.x-p1.x;dy1=p2.y-p1.y;dotprod=dx0*dx1+dy0*dy1;return dotprod<0;};jsts.algorithm.Angle.angleBetween=function(tip1,tail,tip2){var a1,a2;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);return jsts.algorithm.Angle.diff(a1,a2);};jsts.algorithm.Angle.angleBetweenOriented=function(tip1,tail,tip2){var a1,a2,angDel;a1=jsts.algorithm.Angle.angle(tail,tip1);a2=jsts.algorithm.Angle.angle(tail,tip2);angDel=a2-a1;if(angDel<=-Math.PI){return angDel+jsts.algorithm.Angle.PI_TIMES_2;}
if(angDel>Math.PI){return angDel-jsts.algorithm.Angle.PI_TIMES_2;}
return angDel;};jsts.algorithm.Angle.interiorAngle=function(p0,p1,p2){var anglePrev,angleNext;anglePrev=jsts.algorithm.Angle.angle(p1,p0);angleNext=jsts.algorithm.Angle.angle(p1,p2);return Math.abs(angleNext-anglePrev);};jsts.algorithm.Angle.getTurn=function(ang1,ang2){var crossproduct=Math.sin(ang2-ang1);if(crossproduct>0){return jsts.algorithm.Angle.COUNTERCLOCKWISE;}
if(crossproduct<0){return jsts.algorithm.Angle.CLOCKWISE;}
return jsts.algorithm.Angle.NONE;};jsts.algorithm.Angle.normalize=function(angle){while(angle>Math.PI){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
while(angle<=-Math.PI){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
return angle;};jsts.algorithm.Angle.normalizePositive=function(angle){if(angle<0.0){while(angle<0.0){angle+=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle=0.0;}}
else{while(angle>=jsts.algorithm.Angle.PI_TIMES_2){angle-=jsts.algorithm.Angle.PI_TIMES_2;}
if(angle<0.0){angle=0.0;}}
return angle;};jsts.algorithm.Angle.diff=function(ang1,ang2){var delAngle;if(ang1<ang2){delAngle=ang2-ang1;}else{delAngle=ang1-ang2;}
if(delAngle>Math.PI){delAngle=(2*Math.PI)-delAngle;}
return delAngle;};jsts.geom.GeometryComponentFilter=function(){};jsts.geom.GeometryComponentFilter.prototype.filter=function(geom){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.util.LinearComponentExtracter=function(lines,isForcedToLineString){this.lines=lines;this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype=new jsts.geom.GeometryComponentFilter();jsts.geom.util.LinearComponentExtracter.prototype.lines=null;jsts.geom.util.LinearComponentExtracter.prototype.isForcedToLineString=false;jsts.geom.util.LinearComponentExtracter.getLines=function(geoms,lines){if(arguments.length==1){return jsts.geom.util.LinearComponentExtracter.getLines5.apply(this,arguments);}
else if(arguments.length==2&&typeof lines==='boolean'){return jsts.geom.util.LinearComponentExtracter.getLines6.apply(this,arguments);}
else if(arguments.length==2&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines3.apply(this,arguments);}
else if(arguments.length==3&&geoms instanceof jsts.geom.Geometry){return jsts.geom.util.LinearComponentExtracter.getLines4.apply(this,arguments);}
else if(arguments.length==3){return jsts.geom.util.LinearComponentExtracter.getLines2.apply(this,arguments);}
for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines3(g,lines);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines2=function(geoms,lines,forceToLineString){for(var i=0;i<geoms.length;i++){var g=geoms[i];jsts.geom.util.LinearComponentExtracter.getLines4(g,lines,forceToLineString);}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines3=function(geom,lines){if(geom instanceof LineString){lines.add(geom);}else{geom.apply(new jsts.geom.util.LinearComponentExtracter(lines));}
return lines;};jsts.geom.util.LinearComponentExtracter.getLines4=function(geom,lines,forceToLineString){geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.getLines5=function(geom){return jsts.geom.util.LinearComponentExtracter.getLines6(geom,false);};jsts.geom.util.LinearComponentExtracter.getLines6=function(geom,forceToLineString){var lines=[];geom.apply(new jsts.geom.util.LinearComponentExtracter(lines,forceToLineString));return lines;};jsts.geom.util.LinearComponentExtracter.prototype.setForceToLineString=function(isForcedToLineString){this.isForcedToLineString=isForcedToLineString;};jsts.geom.util.LinearComponentExtracter.prototype.filter=function(geom){if(this.isForcedToLineString&&geom instanceof jsts.geom.LinearRing){var line=geom.getFactory().createLineString(geom.getCoordinateSequence());this.lines.push(line);return;}
if(geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.LinearRing)
this.lines.push(geom);};jsts.geom.Location=function(){};jsts.geom.Location.INTERIOR=0;jsts.geom.Location.BOUNDARY=1;jsts.geom.Location.EXTERIOR=2;jsts.geom.Location.NONE=-1;jsts.geom.Location.toLocationSymbol=function(locationValue){switch(locationValue){case jsts.geom.Location.EXTERIOR:return'e';case jsts.geom.Location.BOUNDARY:return'b';case jsts.geom.Location.INTERIOR:return'i';case jsts.geom.Location.NONE:return'-';}
throw new jsts.IllegalArgumentError('Unknown location value: '+
locationValue);};(function(){jsts.io.GeoJSONReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONReader.prototype.read=function(geoJson){var geometry=this.parser.read(geoJson);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.GeoJSONReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};})();jsts.geom.Geometry=function(factory){this.factory=factory;};jsts.geom.Geometry.prototype.envelope=null;jsts.geom.Geometry.prototype.factory=null;jsts.geom.Geometry.prototype.getGeometryType=function(){return'Geometry';};jsts.geom.Geometry.hasNonEmptyElements=function(geometries){var i;for(i=0;i<geometries.length;i++){if(!geometries[i].isEmpty()){return true;}}
return false;};jsts.geom.Geometry.hasNullElements=function(array){var i;for(i=0;i<array.length;i++){if(array[i]===null){return true;}}
return false;};jsts.geom.Geometry.prototype.getFactory=function(){if(this.factory===null||this.factory===undefined){this.factory=new jsts.geom.GeometryFactory();}
return this.factory;};jsts.geom.Geometry.prototype.getNumGeometries=function(){return 1;};jsts.geom.Geometry.prototype.getGeometryN=function(n){return this;};jsts.geom.Geometry.prototype.getPrecisionModel=function(){return this.getFactory().getPrecisionModel();};jsts.geom.Geometry.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getCoordinates=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getNumPoints=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.isSimple=function(){this.checkNotGeometryCollection(this);var op=new jsts.operation.IsSimpleOp(this);return op.isSimple();};jsts.geom.Geometry.prototype.isValid=function(){var isValidOp=new jsts.operation.valid.IsValidOp(this);return isValidOp.isValid();};jsts.geom.Geometry.prototype.isEmpty=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.distance=function(g){return jsts.operation.distance.DistanceOp.distance(this,g);};jsts.geom.Geometry.prototype.isWithinDistance=function(geom,distance){var envDist=this.getEnvelopeInternal().distance(geom.getEnvelopeInternal());if(envDist>distance){return false;}
return DistanceOp.isWithinDistance(this,geom,distance);};jsts.geom.Geometry.prototype.isRectangle=function(){return false;};jsts.geom.Geometry.prototype.getArea=function(){return 0.0;};jsts.geom.Geometry.prototype.getLength=function(){return 0.0;};jsts.geom.Geometry.prototype.getCentroid=function(){if(this.isEmpty()){return null;}
var cent;var centPt=null;var dim=this.getDimension();if(dim===0){cent=new jsts.algorithm.CentroidPoint();cent.add(this);centPt=cent.getCentroid();}else if(dim===1){cent=new jsts.algorithm.CentroidLine();cent.add(this);centPt=cent.getCentroid();}else{cent=new jsts.algorithm.CentroidArea();cent.add(this);centPt=cent.getCentroid();}
return this.createPointFromInternalCoord(centPt,this);};jsts.geom.Geometry.prototype.getInteriorPoint=function(){var intPt;var interiorPt=null;var dim=this.getDimension();if(dim===0){intPt=new jsts.algorithm.InteriorPointPoint(this);interiorPt=intPt.getInteriorPoint();}else if(dim===1){intPt=new jsts.algorithm.InteriorPointLine(this);interiorPt=intPt.getInteriorPoint();}else{intPt=new jsts.algorithm.InteriorPointArea(this);interiorPt=intPt.getInteriorPoint();}
return this.createPointFromInternalCoord(interiorPt,this);};jsts.geom.Geometry.prototype.getDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundary=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getBoundaryDimension=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal());};jsts.geom.Geometry.prototype.getEnvelopeInternal=function(){if(this.envelope===null){this.envelope=this.computeEnvelopeInternal();}
return this.envelope;};jsts.geom.Geometry.prototype.disjoint=function(g){return!this.intersects(g);};jsts.geom.Geometry.prototype.touches=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isTouches(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.intersects=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(this,g);}
if(g.isRectangle()){return jsts.operation.predicate.RectangleIntersects.intersects(g,this);}
return this.relate(g).isIntersects();};jsts.geom.Geometry.prototype.crosses=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isCrosses(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.within=function(g){return g.contains(this);};jsts.geom.Geometry.prototype.contains=function(g){if(!this.getEnvelopeInternal().contains(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return jsts.operation.predicate.RectangleContains.contains(this,g);}
return this.relate(g).isContains();};jsts.geom.Geometry.prototype.overlaps=function(g){if(!this.getEnvelopeInternal().intersects(g.getEnvelopeInternal())){return false;}
return this.relate(g).isOverlaps(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.covers=function(g){if(!this.getEnvelopeInternal().covers(g.getEnvelopeInternal())){return false;}
if(this.isRectangle()){return true;}
return this.relate(g).isCovers();};jsts.geom.Geometry.prototype.coveredBy=function(g){return g.covers(this);};jsts.geom.Geometry.prototype.relate=function(g,intersectionPattern){if(arguments.length===1){return this.relate2.apply(this,arguments);}
return this.relate2(g).matches(intersectionPattern);};jsts.geom.Geometry.prototype.relate2=function(g){this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(g);return jsts.operation.relate.RelateOp.relate(this,g);};jsts.geom.Geometry.prototype.equalsTopo=function(g){if(!this.getEnvelopeInternal().equals(g.getEnvelopeInternal())){return false;}
return this.relate(g).isEquals(this.getDimension(),g.getDimension());};jsts.geom.Geometry.prototype.equals=function(o){if(o instanceof jsts.geom.Geometry||o instanceof jsts.geom.LinearRing||o instanceof jsts.geom.Polygon||o instanceof jsts.geom.GeometryCollection||o instanceof jsts.geom.MultiPoint||o instanceof jsts.geom.MultiLineString||o instanceof jsts.geom.MultiPolygon){return this.equalsExact(o);}
return false;};jsts.geom.Geometry.prototype.buffer=function(distance,quadrantSegments,endCapStyle){var params=new jsts.operation.buffer.BufferParameters(quadrantSegments,endCapStyle)
return jsts.operation.buffer.BufferOp.bufferOp2(this,distance,params);};jsts.geom.Geometry.prototype.convexHull=function(){return new jsts.algorithm.ConvexHull(this).getConvexHull();};jsts.geom.Geometry.prototype.intersection=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(this.isGeometryCollection(this)){var g2=other;}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.INTERSECTION);};jsts.geom.Geometry.prototype.union=function(other){if(arguments.length===0){return jsts.operation.union.UnaryUnionOp.union(this);}
if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.UNION);};jsts.geom.Geometry.prototype.difference=function(other){if(this.isEmpty()){return this.getFactory().createGeometryCollection(null);}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.DIFFERENCE);};jsts.geom.Geometry.prototype.symDifference=function(other){if(this.isEmpty()){return other.clone();}
if(other.isEmpty()){return this.clone();}
this.checkNotGeometryCollection(this);this.checkNotGeometryCollection(other);return jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,other,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE);};jsts.geom.Geometry.prototype.equalsExact=function(other,tolerance){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.equalsNorm=function(g){if(g===null||g===undefined)
return false;return this.norm().equalsExact(g.norm());};jsts.geom.Geometry.prototype.apply=function(filter){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.clone=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.normalize=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.norm=function(){var copy=this.clone();copy.normalize();return copy;};jsts.geom.Geometry.prototype.compareTo=function(o){var other=o;if(this.getClassSortIndex()!==other.getClassSortIndex()){return this.getClassSortIndex()-other.getClassSortIndex();}
if(this.isEmpty()&&other.isEmpty()){return 0;}
if(this.isEmpty()){return-1;}
if(other.isEmpty()){return 1;}
return this.compareToSameClass(o);};jsts.geom.Geometry.prototype.isEquivalentClass=function(other){if(this instanceof jsts.geom.Point&&other instanceof jsts.geom.Point){return true;}else if(this instanceof jsts.geom.LineString&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.LinearRing&&(other instanceof jsts.geom.LineString|other instanceof jsts.geom.LinearRing)){return true;}else if(this instanceof jsts.geom.Polygon&&(other instanceof jsts.geom.Polygon)){return true;}else if(this instanceof jsts.geom.MultiPoint&&(other instanceof jsts.geom.MultiPoint)){return true;}else if(this instanceof jsts.geom.MultiLineString&&(other instanceof jsts.geom.MultiLineString)){return true;}else if(this instanceof jsts.geom.MultiPolygon&&(other instanceof jsts.geom.MultiPolygon)){return true;}else if(this instanceof jsts.geom.GeometryCollection&&(other instanceof jsts.geom.GeometryCollection)){return true;}
return false;};jsts.geom.Geometry.prototype.checkNotGeometryCollection=function(g){if(g.isGeometryCollectionBase()){throw new jsts.error.IllegalArgumentError('This method does not support GeometryCollection');}};jsts.geom.Geometry.prototype.isGeometryCollection=function(){return(this instanceof jsts.geom.GeometryCollection);};jsts.geom.Geometry.prototype.isGeometryCollectionBase=function(){return(this.CLASS_NAME==='jsts.geom.GeometryCollection');};jsts.geom.Geometry.prototype.computeEnvelopeInternal=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compareToSameClass=function(o){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.Geometry.prototype.compare=function(a,b){var i=a.iterator();var j=b.iterator();while(i.hasNext()&&j.hasNext()){var aElement=i.next();var bElement=j.next();var comparison=aElement.compareTo(bElement);if(comparison!==0){return comparison;}}
if(i.hasNext()){return 1;}
if(j.hasNext()){return-1;}
return 0;};jsts.geom.Geometry.prototype.equal=function(a,b,tolerance){if(tolerance===undefined||tolerance===null||tolerance===0){return a.equals(b);}
return a.distance(b)<=tolerance;};jsts.geom.Geometry.prototype.getClassSortIndex=function(){var sortedClasses=[jsts.geom.Point,jsts.geom.MultiPoint,jsts.geom.LineString,jsts.geom.LinearRing,jsts.geom.MultiLineString,jsts.geom.Polygon,jsts.geom.MultiPolygon,jsts.geom.GeometryCollection];for(var i=0;i<sortedClasses.length;i++){if(this instanceof sortedClasses[i])
return i;}
jsts.util.Assert.shouldNeverReachHere('Class not supported: '+this);return-1;};jsts.geom.Geometry.prototype.toString=function(){return new jsts.io.WKTWriter().write(this);};jsts.geom.Geometry.prototype.createPointFromInternalCoord=function(coord,exemplar){exemplar.getPrecisionModel().makePrecise(coord);return exemplar.getFactory().createPoint(coord);};(function(){jsts.geom.Coordinate=function(x,y){if(typeof x==='number'){this.x=x;this.y=y;}else if(x instanceof jsts.geom.Coordinate){this.x=parseFloat(x.x);this.y=parseFloat(x.y);}else if(x===undefined||x===null){this.x=0;this.y=0;}else if(typeof x==='string'){this.x=parseFloat(x);this.y=parseFloat(y);}};jsts.geom.Coordinate.prototype.setCoordinate=function(other){this.x=other.x;this.y=other.y;};jsts.geom.Coordinate.prototype.clone=function(){return new jsts.geom.Coordinate(this.x,this.y);};jsts.geom.Coordinate.prototype.distance=function(p){var dx=this.x-p.x;var dy=this.y-p.y;return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Coordinate.prototype.equals2D=function(other){if(this.x!==other.x){return false;}
if(this.y!==other.y){return false;}
return true;};jsts.geom.Coordinate.prototype.equals=function(other){if(!other instanceof jsts.geom.Coordinate||other===undefined){return false;}
return this.equals2D(other);};jsts.geom.Coordinate.prototype.compareTo=function(other){if(this.x<other.x){return-1;}
if(this.x>other.x){return 1;}
if(this.y<other.y){return-1;}
if(this.y>other.y){return 1;}
return 0;};jsts.geom.Coordinate.prototype.toString=function(){return'('+this.x+', '+this.y+')';};})();jsts.geom.Envelope=function(){jsts.geom.Envelope.prototype.init.apply(this,arguments);};jsts.geom.Envelope.prototype.minx=null;jsts.geom.Envelope.prototype.maxx=null;jsts.geom.Envelope.prototype.miny=null;jsts.geom.Envelope.prototype.maxy=null;jsts.geom.Envelope.prototype.init=function(){if(typeof arguments[0]==='number'&&arguments.length===4){this.initFromValues(arguments[0],arguments[1],arguments[2],arguments[3]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===1){this.initFromCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate&&arguments.length===2){this.initFromCoordinates(arguments[0],arguments[1]);}else if(arguments[0]instanceof jsts.geom.Envelope&&arguments.length===1){this.initFromEnvelope(arguments[0]);}else{this.setToNull();}};jsts.geom.Envelope.prototype.initFromValues=function(x1,x2,y1,y2){if(x1<x2){this.minx=x1;this.maxx=x2;}else{this.minx=x2;this.maxx=x1;}
if(y1<y2){this.miny=y1;this.maxy=y2;}else{this.miny=y2;this.maxy=y1;}};jsts.geom.Envelope.prototype.initFromCoordinates=function(p1,p2){this.initFromValues(p1.x,p2.x,p1.y,p2.y);};jsts.geom.Envelope.prototype.initFromCoordinate=function(p){this.initFromValues(p.x,p.x,p.y,p.y);};jsts.geom.Envelope.prototype.initFromEnvelope=function(env){this.minx=env.minx;this.maxx=env.maxx;this.miny=env.miny;this.maxy=env.maxy;};jsts.geom.Envelope.prototype.setToNull=function(){this.minx=0;this.maxx=-1;this.miny=0;this.maxy=-1;};jsts.geom.Envelope.prototype.isNull=function(){return this.maxx<this.minx;};jsts.geom.Envelope.prototype.getHeight=function(){if(this.isNull()){return 0;}
return this.maxy-this.miny;};jsts.geom.Envelope.prototype.getWidth=function(){if(this.isNull()){return 0;}
return this.maxx-this.minx;};jsts.geom.Envelope.prototype.getMinX=function(){return this.minx;};jsts.geom.Envelope.prototype.getMaxX=function(){return this.maxx;};jsts.geom.Envelope.prototype.getMinY=function(){return this.miny;};jsts.geom.Envelope.prototype.getMaxY=function(){return this.maxy;};jsts.geom.Envelope.prototype.getArea=function(){return this.getWidth()*this.getHeight();};jsts.geom.Envelope.prototype.expandToInclude=function(){if(arguments[0]instanceof jsts.geom.Coordinate){this.expandToIncludeCoordinate(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Envelope){this.expandToIncludeEnvelope(arguments[0]);}else{this.expandToIncludeValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandToIncludeCoordinate=function(p){this.expandToIncludeValues(p.x,p.y);};jsts.geom.Envelope.prototype.expandToIncludeValues=function(x,y){if(this.isNull()){this.minx=x;this.maxx=x;this.miny=y;this.maxy=y;}else{if(x<this.minx){this.minx=x;}
if(x>this.maxx){this.maxx=x;}
if(y<this.miny){this.miny=y;}
if(y>this.maxy){this.maxy=y;}}};jsts.geom.Envelope.prototype.expandToIncludeEnvelope=function(other){if(other.isNull()){return;}
if(this.isNull()){this.minx=other.getMinX();this.maxx=other.getMaxX();this.miny=other.getMinY();this.maxy=other.getMaxY();}else{if(other.minx<this.minx){this.minx=other.minx;}
if(other.maxx>this.maxx){this.maxx=other.maxx;}
if(other.miny<this.miny){this.miny=other.miny;}
if(other.maxy>this.maxy){this.maxy=other.maxy;}}};jsts.geom.Envelope.prototype.expandBy=function(){if(arguments.length===1){this.expandByDistance(arguments[0]);}else{this.expandByDistances(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.expandByDistance=function(distance){this.expandByDistances(distance,distance);};jsts.geom.Envelope.prototype.expandByDistances=function(deltaX,deltaY){if(this.isNull()){return;}
this.minx-=deltaX;this.maxx+=deltaX;this.miny-=deltaY;this.maxy+=deltaY;if(this.minx>this.maxx||this.miny>this.maxy){this.setToNull();}};jsts.geom.Envelope.prototype.translate=function(transX,transY){if(this.isNull()){return;}
this.init(this.minx+transX,this.maxx+transX,this.miny+transY,this.maxy+transY);};jsts.geom.Envelope.prototype.centre=function(){if(this.isNull()){return null;}
return new jsts.geom.Coordinate((this.minx+this.maxx)/2.0,(this.miny+this.maxy)/2.0);};jsts.geom.Envelope.prototype.intersection=function(env){if(this.isNull()||env.isNull()||!this.intersects(env)){return new jsts.geom.Envelope();}
var intMinX=this.minx>env.minx?this.minx:env.minx;var intMinY=this.miny>env.miny?this.miny:env.miny;var intMaxX=this.maxx<env.maxx?this.maxx:env.maxx;var intMaxY=this.maxy<env.maxy?this.maxy:env.maxy;return new jsts.geom.Envelope(intMinX,intMaxX,intMinY,intMaxY);};jsts.geom.Envelope.prototype.intersects=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.intersectsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.intersectsCoordinate(arguments[0]);}else{return this.intersectsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.intersectsEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
var result=!(other.minx>this.maxx||other.maxx<this.minx||other.miny>this.maxy||other.maxy<this.miny);return result;};jsts.geom.Envelope.prototype.intersectsCoordinate=function(p){return this.intersectsValues(p.x,p.y);};jsts.geom.Envelope.prototype.intersectsValues=function(x,y){if(this.isNull()){return false;}
return!(x>this.maxx||x<this.minx||y>this.maxy||y<this.miny);};jsts.geom.Envelope.prototype.contains=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.containsEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.containsCoordinate(arguments[0]);}else{return this.containsValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.containsEnvelope=function(other){return this.coversEnvelope(other);};jsts.geom.Envelope.prototype.containsCoordinate=function(p){return this.coversCoordinate(p);};jsts.geom.Envelope.prototype.containsValues=function(x,y){return this.coversValues(x,y);};jsts.geom.Envelope.prototype.covers=function(){if(arguments[0]instanceof jsts.geom.Envelope){return this.coversEnvelope(arguments[0]);}else if(arguments[0]instanceof jsts.geom.Coordinate){return this.coversCoordinate(arguments[0]);}else{return this.coversValues(arguments[0],arguments[1]);}};jsts.geom.Envelope.prototype.coversValues=function(x,y){if(this.isNull()){return false;}
return x>=this.minx&&x<=this.maxx&&y>=this.miny&&y<=this.maxy;};jsts.geom.Envelope.prototype.coversCoordinate=function(p){return this.coversValues(p.x,p.y);};jsts.geom.Envelope.prototype.coversEnvelope=function(other){if(this.isNull()||other.isNull()){return false;}
return other.minx>=this.minx&&other.maxx<=this.maxx&&other.miny>=this.miny&&other.maxy<=this.maxy;};jsts.geom.Envelope.prototype.distance=function(env){if(this.intersects(env)){return 0;}
var dx=0.0;if(this.maxx<env.minx){dx=env.minx-this.maxx;}
if(this.minx>env.maxx){dx=this.minx-env.maxx;}
var dy=0.0;if(this.maxy<env.miny){dy=env.miny-this.maxy;}
if(this.miny>env.maxy){dy=this.miny-env.maxy;}
if(dx===0.0){return dy;}
if(dy===0.0){return dx;}
return Math.sqrt(dx*dx+dy*dy);};jsts.geom.Envelope.prototype.equals=function(other){if(this.isNull()){return other.isNull();}
return this.maxx===other.maxx&&this.maxy===other.maxy&&this.minx===other.minx&&this.miny===other.miny;};jsts.geom.Envelope.prototype.toString=function(){return'Env['+this.minx+' : '+this.maxx+', '+this.miny+' : '+
this.maxy+']';};jsts.geom.Envelope.intersects=function(p1,p2,q){if(arguments.length===4){return jsts.geom.Envelope.intersectsEnvelope(arguments[0],arguments[1],arguments[2],arguments[3]);}
var xc1=p1.x<p2.x?p1.x:p2.x;var xc2=p1.x>p2.x?p1.x:p2.x;var yc1=p1.y<p2.y?p1.y:p2.y;var yc2=p1.y>p2.y?p1.y:p2.y;if(((q.x>=xc1)&&(q.x<=xc2))&&((q.y>=yc1)&&(q.y<=yc2))){return true;}
return false;};jsts.geom.Envelope.intersectsEnvelope=function(p1,p2,q1,q2){var minq=Math.min(q1.x,q2.x);var maxq=Math.max(q1.x,q2.x);var minp=Math.min(p1.x,p2.x);var maxp=Math.max(p1.x,p2.x);if(minp>maxq){return false;}
if(maxp<minq){return false;}
minq=Math.min(q1.y,q2.y);maxq=Math.max(q1.y,q2.y);minp=Math.min(p1.y,p2.y);maxp=Math.max(p1.y,p2.y);if(minp>maxq){return false;}
if(maxp<minq){return false;}
return true;};jsts.geom.Envelope.prototype.clone=function(){return new jsts.geom.Envelope(this.minx,this.maxx,this.miny,this.maxy);};jsts.geom.util.GeometryCombiner=function(geoms){this.geomFactory=jsts.geom.util.GeometryCombiner.extractFactory(geoms);this.inputGeoms=geoms;};jsts.geom.util.GeometryCombiner.combine=function(geoms){if(arguments.length>1)return this.combine2.apply(this,arguments);var combiner=new jsts.geom.util.GeometryCombiner(geoms);return combiner.combine();};jsts.geom.util.GeometryCombiner.combine2=function(){var arrayList=new javascript.util.ArrayList();Array.prototype.slice.call(arguments).forEach(function(a){arrayList.add(a);});var combiner=new jsts.geom.util.GeometryCombiner(arrayList);return combiner.combine();};jsts.geom.util.GeometryCombiner.prototype.geomFactory=null;jsts.geom.util.GeometryCombiner.prototype.skipEmpty=false;jsts.geom.util.GeometryCombiner.prototype.inputGeoms;jsts.geom.util.GeometryCombiner.extractFactory=function(geoms){if(geoms.isEmpty())return null;return geoms.iterator().next().getFactory();};jsts.geom.util.GeometryCombiner.prototype.combine=function(){var elems=new javascript.util.ArrayList(),i;for(i=this.inputGeoms.iterator();i.hasNext();){var g=i.next();this.extractElements(g,elems);}
if(elems.size()===0){if(this.geomFactory!==null){return this.geomFactory.createGeometryCollection(null);}
return null;}
return this.geomFactory.buildGeometry(elems);};jsts.geom.util.GeometryCombiner.prototype.extractElements=function(geom,elems){if(geom===null){return;}
for(var i=0;i<geom.getNumGeometries();i++){var elemGeom=geom.getGeometryN(i);if(this.skipEmpty&&elemGeom.isEmpty()){continue;}
elems.add(elemGeom);}};jsts.geom.PrecisionModel=function(modelType){if(typeof modelType==='number'){this.modelType=jsts.geom.PrecisionModel.FIXED;this.scale=modelType;return;}
this.modelType=modelType||jsts.geom.PrecisionModel.FLOATING;if(this.modelType===jsts.geom.PrecisionModel.FIXED){this.scale=1.0;}};jsts.geom.PrecisionModel.FLOATING='FLOATING';jsts.geom.PrecisionModel.FIXED='FIXED';jsts.geom.PrecisionModel.FLOATING_SINGLE='FLOATING_SINGLE';jsts.geom.PrecisionModel.prototype.scale=null;jsts.geom.PrecisionModel.prototype.modelType=null;jsts.geom.PrecisionModel.prototype.isFloating=function(){return this.modelType===jsts.geom.PrecisionModel.FLOATING||this.modelType===jsts.geom.PrecisionModel.FLOATING_SINLGE;};jsts.geom.PrecisionModel.prototype.getScale=function(){return this.scale;};jsts.geom.PrecisionModel.prototype.getType=function(){return this.modelType;};jsts.geom.PrecisionModel.prototype.equals=function(other){return true;if(!(other instanceof jsts.geom.PrecisionModel)){return false;}
var otherPrecisionModel=other;return this.modelType===otherPrecisionModel.modelType&&this.scale===otherPrecisionModel.scale;};jsts.geom.PrecisionModel.prototype.makePrecise=function(val){if(val instanceof jsts.geom.Coordinate){this.makePrecise2(val);return;}
if(isNaN(val))
return val;if(this.modelType===jsts.geom.PrecisionModel.FIXED){return Math.round(val*this.scale)/this.scale;}
return val;};jsts.geom.PrecisionModel.prototype.makePrecise2=function(coord){if(this.modelType===jsts.geom.PrecisionModel.FLOATING)
return;coord.x=this.makePrecise(coord.x);coord.y=this.makePrecise(coord.y);};jsts.geom.PrecisionModel.prototype.compareTo=function(o){var other=o;return 0;};jsts.geom.CoordinateFilter=function(){};jsts.geom.CoordinateFilter.prototype.filter=function(coord){throw new jsts.error.AbstractMethodInvocationError();};jsts.simplify.DouglasPeuckerLineSimplifier=function(pts){this.pts=pts;this.seg=new jsts.geom.LineSegment();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.pts=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.usePt=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerLineSimplifier.simplify=function(pts,distanceTolerance){var simp=new jsts.simplify.DouglasPeuckerLineSimplifier(pts);simp.setDistanceTolerance(distanceTolerance);return simp.simplify();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplify=function(){this.usePt=[];for(var i=0;i<this.pts.length;i++){this.usePt[i]=true;}
this.simplifySection(0,this.pts.length-1);var coordList=new jsts.geom.CoordinateList();for(var j=0;j<this.pts.length;j++){if(this.usePt[j]){coordList.add(new jsts.geom.Coordinate(this.pts[j]));}}
return coordList.toCoordinateArray();};jsts.simplify.DouglasPeuckerLineSimplifier.prototype.seg=null;jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplifySection=function(i,j){if(i+1==j){return;}
this.seg.p0=this.pts[i];this.seg.p1=this.pts[j];var maxDistance=-1.0;var maxIndex=i;for(var k=i+1;k<j;k++){var distance=this.seg.distance(this.pts[k]);if(distance>maxDistance){maxDistance=distance;maxIndex=k;}}
if(maxDistance<=this.distanceTolerance){for(var l=i+1;l<j;l++){this.usePt[l]=false;}}else{this.simplifySection(i,maxIndex);this.simplifySection(maxIndex,j);}};jsts.geomgraph.EdgeIntersection=function(coord,segmentIndex,dist){this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.dist=dist;};jsts.geomgraph.EdgeIntersection.prototype.coord=null;jsts.geomgraph.EdgeIntersection.prototype.segmentIndex=null;jsts.geomgraph.EdgeIntersection.prototype.dist=null;jsts.geomgraph.EdgeIntersection.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.EdgeIntersection.prototype.getSegmentIndex=function(){return this.segmentIndex;};jsts.geomgraph.EdgeIntersection.prototype.getDistance=function(){return this.dist;};jsts.geomgraph.EdgeIntersection.prototype.compareTo=function(other){return this.compare(other.segmentIndex,other.dist);};jsts.geomgraph.EdgeIntersection.prototype.compare=function(segmentIndex,dist){if(this.segmentIndex<segmentIndex)
return-1;if(this.segmentIndex>segmentIndex)
return 1;if(this.dist<dist)
return-1;if(this.dist>dist)
return 1;return 0;};jsts.geomgraph.EdgeIntersection.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&this.dist===0.0)
return true;if(this.segmentIndex===maxSegmentIndex)
return true;return false;};jsts.geomgraph.EdgeIntersection.prototype.toString=function(){return''+this.segmentIndex+this.dist;};(function(){var EdgeIntersection=jsts.geomgraph.EdgeIntersection;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeIntersectionList=function(edge){this.nodeMap=new TreeMap();this.edge=edge;};jsts.geomgraph.EdgeIntersectionList.prototype.nodeMap=null;jsts.geomgraph.EdgeIntersectionList.prototype.edge=null;jsts.geomgraph.EdgeIntersectionList.prototype.isIntersection=function(pt){for(var it=this.iterator();it.hasNext();){var ei=it.next();if(ei.coord.equals(pt)){return true;}}
return false;};jsts.geomgraph.EdgeIntersectionList.prototype.add=function(intPt,segmentIndex,dist){var eiNew=new EdgeIntersection(intPt,segmentIndex,dist);var ei=this.nodeMap.get(eiNew);if(ei!==null){return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.geomgraph.EdgeIntersectionList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.geomgraph.EdgeIntersectionList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0.0);this.add(this.edge.pts[maxSegIndex],maxSegIndex,0.0);};jsts.geomgraph.EdgeIntersectionList.prototype.addSplitEdges=function(edgeList)
{this.addEndpoints();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.geomgraph.EdgeIntersectionList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.pts[ei1.segmentIndex];var useIntPt1=ei1.dist>0.0||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.pts[i];}
if(useIntPt1)pts[ipt]=ei1.coord;return new jsts.geomgraph.Edge(pts,new jsts.geomgraph.Label(this.edge.label));};})();(function(){var AssertionFailedException=function(message){this.message=message;};AssertionFailedException.prototype=new Error();AssertionFailedException.prototype.name='AssertionFailedException';jsts.util.AssertionFailedException=AssertionFailedException;})();(function(){var AssertionFailedException=jsts.util.AssertionFailedException;jsts.util.Assert=function(){};jsts.util.Assert.isTrue=function(assertion,message){if(!assertion){if(message===null){throw new AssertionFailedException();}else{throw new AssertionFailedException(message);}}};jsts.util.Assert.equals=function(expectedValue,actualValue,message){if(!actualValue.equals(expectedValue)){throw new AssertionFailedException('Expected '+expectedValue+' but encountered '+actualValue+
(message!=null?': '+message:''));}};jsts.util.Assert.shouldNeverReachHere=function(message){throw new AssertionFailedException('Should never reach here'+
(message!=null?': '+message:''));};})();(function(){var Location=jsts.geom.Location;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.relate.RelateComputer=function(arg){this.li=new jsts.algorithm.RobustLineIntersector();this.ptLocator=new jsts.algorithm.PointLocator();this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());this.isolatedEdges=new ArrayList();this.arg=arg;};jsts.operation.relate.RelateComputer.prototype.li=null;jsts.operation.relate.RelateComputer.prototype.ptLocator=null;jsts.operation.relate.RelateComputer.prototype.arg=null;jsts.operation.relate.RelateComputer.prototype.nodes=null;jsts.operation.relate.RelateComputer.prototype.im=null;jsts.operation.relate.RelateComputer.prototype.isolatedEdges=null;jsts.operation.relate.RelateComputer.prototype.invalidPoint=null;jsts.operation.relate.RelateComputer.prototype.computeIM=function(){var im=new jsts.geom.IntersectionMatrix();im.set(Location.EXTERIOR,Location.EXTERIOR,2);if(!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal())){this.computeDisjointIM(im);return im;}
this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);var intersector=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,false);this.computeIntersectionNodes(0);this.computeIntersectionNodes(1);this.copyNodesAndLabels(0);this.copyNodesAndLabels(1);this.labelIsolatedNodes();this.computeProperIntersectionIM(intersector,im);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var ee0=eeBuilder.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(ee0);var ee1=eeBuilder.computeEdgeEnds(this.arg[1].getEdgeIterator());this.insertEdgeEnds(ee1);this.labelNodeEdges();this.labelIsolatedEdges(0,1);this.labelIsolatedEdges(1,0);this.updateIM(im);return im;};jsts.operation.relate.RelateComputer.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateComputer.prototype.computeProperIntersectionIM=function(intersector,im){var dimA=this.arg[0].getGeometry().getDimension();var dimB=this.arg[1].getGeometry().getDimension();var hasProper=intersector.hasProperIntersection();var hasProperInterior=intersector.hasProperInteriorIntersection();if(dimA===2&&dimB===2){if(hasProper)
im.setAtLeast('212101212');}
else if(dimA===2&&dimB===1){if(hasProper)
im.setAtLeast('FFF0FFFF2');if(hasProperInterior)
im.setAtLeast('1FFFFF1FF');}else if(dimA===1&&dimB===2){if(hasProper)
im.setAtLeast('F0FFFFFF2');if(hasProperInterior)
im.setAtLeast('1F1FFFFFF');}
else if(dimA===1&&dimB===1){if(hasProperInterior)
im.setAtLeast('0FFFFFFFF');}};jsts.operation.relate.RelateComputer.prototype.copyNodesAndLabels=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateComputer.prototype.computeIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.labelIntersectionNodes=function(argIndex){for(var i=this.arg[argIndex].getEdgeIterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.find(ei.coord);if(n.getLabel().isNull(argIndex)){if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateComputer.prototype.computeDisjointIM=function(im){var ga=this.arg[0].getGeometry();if(!ga.isEmpty()){im.set(Location.INTERIOR,Location.EXTERIOR,ga.getDimension());im.set(Location.BOUNDARY,Location.EXTERIOR,ga.getBoundaryDimension());}
var gb=this.arg[1].getGeometry();if(!gb.isEmpty()){im.set(Location.EXTERIOR,Location.INTERIOR,gb.getDimension());im.set(Location.EXTERIOR,Location.BOUNDARY,gb.getBoundaryDimension());}};jsts.operation.relate.RelateComputer.prototype.labelNodeEdges=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.getEdges().computeLabelling(this.arg);}};jsts.operation.relate.RelateComputer.prototype.updateIM=function(im){for(var ei=this.isolatedEdges.iterator();ei.hasNext();){var e=ei.next();e.updateIM(im);}
for(var ni=this.nodes.iterator();ni.hasNext();){var node=ni.next();node.updateIM(im);node.updateIMFromEdges(im);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdges=function(thisIndex,targetIndex){for(var ei=this.arg[thisIndex].getEdgeIterator();ei.hasNext();){var e=ei.next();if(e.isIsolated()){this.labelIsolatedEdge(e,targetIndex,this.arg[targetIndex].getGeometry());this.isolatedEdges.add(e);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdge=function(e,targetIndex,target){if(target.getDimension()>0){var loc=this.ptLocator.locate(e.getCoordinate(),target);e.getLabel().setAllLocations(targetIndex,loc);}else{e.getLabel().setAllLocations(targetIndex,Location.EXTERIOR);}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNodes=function(){for(var ni=this.nodes.iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();Assert.isTrue(label.getGeometryCount()>0,'node with empty label found');if(n.isIsolated()){if(label.isNull(0))
this.labelIsolatedNode(n,0);else
this.labelIsolatedNode(n,1);}}};jsts.operation.relate.RelateComputer.prototype.labelIsolatedNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setAllLocations(targetIndex,loc);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.GraphComponent=function(label){this.label=label;};jsts.geomgraph.GraphComponent.prototype.label=null;jsts.geomgraph.GraphComponent.prototype._isInResult=false;jsts.geomgraph.GraphComponent.prototype._isCovered=false;jsts.geomgraph.GraphComponent.prototype._isCoveredSet=false;jsts.geomgraph.GraphComponent.prototype._isVisited=false;jsts.geomgraph.GraphComponent.prototype.getLabel=function(){return this.label;};jsts.geomgraph.GraphComponent.prototype.setLabel=function(label){if(arguments.length===2){this.setLabel2.apply(this,arguments);return;}
this.label=label;};jsts.geomgraph.GraphComponent.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.GraphComponent.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.GraphComponent.prototype.setCovered=function(isCovered){this._isCovered=isCovered;this._isCoveredSet=true;};jsts.geomgraph.GraphComponent.prototype.isCovered=function(){return this._isCovered;};jsts.geomgraph.GraphComponent.prototype.isCoveredSet=function(){return this._isCoveredSet;};jsts.geomgraph.GraphComponent.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.GraphComponent.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.computeIM=function(im){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.isIsolated=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.GraphComponent.prototype.updateIM=function(im){Assert.isTrue(this.label.getGeometryCount()>=2,'found partial label');this.computeIM(im);};})();jsts.geomgraph.Node=function(coord,edges){this.coord=coord;this.edges=edges;this.label=new jsts.geomgraph.Label(0,jsts.geom.Location.NONE);};jsts.geomgraph.Node.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Node.prototype.coord=null;jsts.geomgraph.Node.prototype.edges=null;jsts.geomgraph.Node.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.Node.prototype.setLabel2=function(argIndex,onLocation){if(this.label===null){this.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
this.label.setLocation(argIndex,onLocation);};jsts.geomgraph.Node.prototype.setLabelBoundary=function(argIndex){var loc=jsts.geom.Location.NONE;if(this.label!==null)
loc=this.label.getLocation(argIndex);var newLoc;switch(loc){case jsts.geom.Location.BOUNDARY:newLoc=jsts.geom.Location.INTERIOR;break;case jsts.geom.Location.INTERIOR:newLoc=jsts.geom.Location.BOUNDARY;break;default:newLoc=jsts.geom.Location.BOUNDARY;break;}
this.label.setLocation(argIndex,newLoc);};jsts.geomgraph.Node.prototype.add=function(e){this.edges.insert(e);e.setNode(this);};jsts.geomgraph.Node.prototype.getCoordinate=function(){return this.coord;};jsts.geomgraph.Node.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.Node.prototype.isIncidentEdgeInResult=function(){for(var it=this.getEdges().getEdges().iterator();it.hasNext();){var de=it.next();if(de.getEdge().isInResult())
return true;}
return false;};jsts.geom.Point=function(coordinate,factory){this.factory=factory;if(coordinate===undefined)
return;this.coordinate=coordinate;};jsts.geom.Point.prototype=new jsts.geom.Geometry();jsts.geom.Point.constructor=jsts.geom.Point;jsts.geom.Point.CLASS_NAME='jsts.geom.Point';jsts.geom.Point.prototype.coordinate=null;jsts.geom.Point.prototype.getX=function(){return this.coordinate.x;};jsts.geom.Point.prototype.getY=function(){return this.coordinate.y;};jsts.geom.Point.prototype.getCoordinate=function(){return this.coordinate;};jsts.geom.Point.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.getCoordinateSequence=function(){return this.isEmpty()?[]:[this.coordinate];};jsts.geom.Point.prototype.isEmpty=function(){return this.coordinate===null;};jsts.geom.Point.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.equal(other.getCoordinate(),this.getCoordinate(),tolerance);};jsts.geom.Point.prototype.getNumPoints=function(){return this.isEmpty()?0:1;};jsts.geom.Point.prototype.isSimple=function(){return true;};jsts.geom.Point.prototype.getBoundary=function(){return new jsts.geom.GeometryCollection(null);};jsts.geom.Point.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
return new jsts.geom.Envelope(this.coordinate);};jsts.geom.Point.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){if(this.isEmpty()){return;}
filter.filter(this.getCoordinate());}};jsts.geom.Point.prototype.clone=function(){return new jsts.geom.Point(this.coordinate.clone(),this.factory);};jsts.geom.Point.prototype.getDimension=function(){return 0;};jsts.geom.Point.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.Point.prototype.reverse=function(){return this.clone();};jsts.geom.Point.prototype.isValid=function(){if(!jsts.operation.valid.IsValidOp.isValid(this.getCoordinate())){return false;}
return true;};jsts.geom.Point.prototype.normalize=function(){};jsts.geom.Point.prototype.compareToSameClass=function(other){var point=other;return this.getCoordinate().compareTo(point.getCoordinate());};jsts.geom.Point.prototype.getGeometryType=function(){return'Point';};jsts.geom.Point.prototype.hashCode=function(){return'Point_'+this.coordinate.hashCode();};jsts.geom.Point.prototype.CLASS_NAME='jsts.geom.Point';jsts.geom.Dimension=function(){};jsts.geom.Dimension.P=0;jsts.geom.Dimension.L=1;jsts.geom.Dimension.A=2;jsts.geom.Dimension.FALSE=-1;jsts.geom.Dimension.TRUE=-2;jsts.geom.Dimension.DONTCARE=-3;jsts.geom.Dimension.toDimensionSymbol=function(dimensionValue){switch(dimensionValue){case jsts.geom.Dimension.FALSE:return'F';case jsts.geom.Dimension.TRUE:return'T';case jsts.geom.Dimension.DONTCARE:return'*';case jsts.geom.Dimension.P:return'0';case jsts.geom.Dimension.L:return'1';case jsts.geom.Dimension.A:return'2';}
throw new jsts.IllegalArgumentError('Unknown dimension value: '+
dimensionValue);};jsts.geom.Dimension.toDimensionValue=function(dimensionSymbol){switch(dimensionSymbol.toUpperCase()){case'F':return jsts.geom.Dimension.FALSE;case'T':return jsts.geom.Dimension.TRUE;case'*':return jsts.geom.Dimension.DONTCARE;case'0':return jsts.geom.Dimension.P;case'1':return jsts.geom.Dimension.L;case'2':return jsts.geom.Dimension.A;}
throw new jsts.error.IllegalArgumentError('Unknown dimension symbol: '+
dimensionSymbol);};(function(){var Dimension=jsts.geom.Dimension;jsts.geom.LineString=function(points,factory){this.factory=factory;this.points=points||[];};jsts.geom.LineString.prototype=new jsts.geom.Geometry();jsts.geom.LineString.constructor=jsts.geom.LineString;jsts.geom.LineString.prototype.points=null;jsts.geom.LineString.prototype.getCoordinates=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateSequence=function(){return this.points;};jsts.geom.LineString.prototype.getCoordinateN=function(n){return this.points[n];};jsts.geom.LineString.prototype.getCoordinate=function(){if(this.isEmpty()){return null;}
return this.getCoordinateN(0);};jsts.geom.LineString.prototype.getDimension=function(){return 1;};jsts.geom.LineString.prototype.getBoundaryDimension=function(){if(this.isClosed()){return Dimension.FALSE;}
return 0;};jsts.geom.LineString.prototype.isEmpty=function(){return this.points.length===0;};jsts.geom.LineString.prototype.getNumPoints=function(){return this.points.length;};jsts.geom.LineString.prototype.getPointN=function(n){return this.getFactory().createPoint(this.points[n]);};jsts.geom.LineString.prototype.getStartPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(0);};jsts.geom.LineString.prototype.getEndPoint=function(){if(this.isEmpty()){return null;}
return this.getPointN(this.getNumPoints()-1);};jsts.geom.LineString.prototype.isClosed=function(){if(this.isEmpty()){return false;}
return this.getCoordinateN(0).equals2D(this.getCoordinateN(this.points.length-1));};jsts.geom.LineString.prototype.isRing=function(){return this.isClosed()&&this.isSimple();};jsts.geom.LineString.prototype.getGeometryType=function(){return'LineString';};jsts.geom.LineString.prototype.getLength=function(){return jsts.algorithm.CGAlgorithms.computeLength(this.points);};jsts.geom.LineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.LineString.prototype.computeEnvelopeInternal=function(){if(this.isEmpty()){return new jsts.geom.Envelope();}
var env=new jsts.geom.Envelope();this.points.forEach(function(component){env.expandToInclude(component);});return env;};jsts.geom.LineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.points.length!==other.points.length){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
return this.points.reduce(function(equal,point,i){return equal&&jsts.geom.Geometry.prototype.equal(point,other.points[i],tolerance);});};jsts.geom.LineString.prototype.isEquivalentClass=function(other){return other instanceof jsts.geom.LineString;};jsts.geom.LineString.prototype.compareToSameClass=function(o){var line=o;var i=0,il=this.points.length;var j=0,jl=line.points.length;while(i<il&&j<jl){var comparison=this.points[i].compareTo(line.points[j]);if(comparison!==0){return comparison;}
i++;j++;}
if(i<il){return 1;}
if(j<jl){return-1;}
return 0;};jsts.geom.LineString.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.points.length;i<len;i++){filter.filter(this.points[i]);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.LineString.prototype.apply2=function(filter){if(this.points.length===0)
return;for(var i=0;i<this.points.length;i++){filter.filter(this.points,i);if(filter.isDone())
break;}
if(filter.isGeometryChanged()){}};jsts.geom.LineString.prototype.clone=function(){var points=[];for(var i=0,len=this.points.length;i<len;i++){points.push(this.points[i].clone());}
return this.factory.createLineString(points);};jsts.geom.LineString.prototype.normalize=function(){var i,il,j,ci,cj,len;len=this.points.length;il=parseInt(len/2);for(i=0;i<il;i++){j=len-1-i;ci=this.points[i];cj=this.points[j];if(!ci.equals(cj)){if(ci.compareTo(cj)>0){this.points.reverse();}
return;}}};jsts.geom.LineString.prototype.CLASS_NAME='jsts.geom.LineString';})();(function(){jsts.geom.Polygon=function(shell,holes,factory){this.shell=shell||factory.createLinearRing(null);this.holes=holes||[];this.factory=factory;};jsts.geom.Polygon.prototype=new jsts.geom.Geometry();jsts.geom.Polygon.constructor=jsts.geom.Polygon;jsts.geom.Polygon.prototype.getCoordinate=function(){return this.shell.getCoordinate();};jsts.geom.Polygon.prototype.getCoordinates=function(){if(this.isEmpty()){return[];}
var coordinates=[];var k=-1;var shellCoordinates=this.shell.getCoordinates();for(var x=0;x<shellCoordinates.length;x++){k++;coordinates[k]=shellCoordinates[x];}
for(var i=0;i<this.holes.length;i++){var childCoordinates=this.holes[i].getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.Polygon.prototype.getNumPoints=function(){var numPoints=this.shell.getNumPoints();for(var i=0;i<this.holes.length;i++){numPoints+=this.holes[i].getNumPoints();}
return numPoints;};jsts.geom.Polygon.prototype.isEmpty=function(){return this.shell.isEmpty();};jsts.geom.Polygon.prototype.isRectangle=function(){if(this.getNumInteriorRing()!=0)return false;if(this.shell==null)return false;if(this.shell.getNumPoints()!=5)return false;var seq=this.shell.getCoordinateSequence();var env=this.getEnvelopeInternal();for(var i=0;i<5;i++){var x=seq[i].x;if(!(x==env.getMinX()||x==env.getMaxX()))return false;var y=seq[i].y;if(!(y==env.getMinY()||y==env.getMaxY()))return false;}
var prevX=seq[0].x;var prevY=seq[0].y;for(var i=1;i<=4;i++){var x=seq[i].x;var y=seq[i].y;var xChanged=x!=prevX;var yChanged=y!=prevY;if(xChanged==yChanged)
return false;prevX=x;prevY=y;}
return true;};jsts.geom.Polygon.prototype.getExteriorRing=function(){return this.shell;};jsts.geom.Polygon.prototype.getInteriorRingN=function(n){return this.holes[n];};jsts.geom.Polygon.prototype.getNumInteriorRing=function(){return this.holes.length;};jsts.geom.Polygon.prototype.getArea=function(){var area=0.0;area+=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.shell.getCoordinateSequence()));for(var i=0;i<this.holes.length;i++){area-=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.holes[i].getCoordinateSequence()));}
return area;};jsts.geom.Polygon.prototype.getLength=function(){var len=0.0;len+=this.shell.getLength();for(var i=0;i<this.holes.length;i++){len+=this.holes[i].getLength();}
return len;};jsts.geom.Polygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var rings=[];rings[0]=this.shell.clone();for(var i=0,len=this.holes.length;i<len;i++){rings[i+1]=this.holes[i].clone();}
if(rings.length<=1)
return rings[0];return this.getFactory().createMultiLineString(rings);};jsts.geom.Polygon.prototype.computeEnvelopeInternal=function(){return this.shell.getEnvelopeInternal();};jsts.geom.Polygon.prototype.getDimension=function(){return 2;};jsts.geom.Polygon.prototype.getBoundaryDimension=function(){return 1;};jsts.geom.Polygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.isEmpty()&&other.isEmpty()){return true;}
if(this.isEmpty()!==other.isEmpty()){return false;}
if(!this.shell.equalsExact(other.shell,tolerance)){return false;}
if(this.holes.length!==other.holes.length){return false;}
if(this.holes.length!==other.holes.length){return false;}
for(var i=0;i<this.holes.length;i++){if(!(this.holes[i]).equalsExact(other.holes[i],tolerance)){return false;}}
return true;};jsts.geom.Polygon.prototype.compareToSameClass=function(o){return this.shell.compareToSameClass(o.shell);};jsts.geom.Polygon.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.GeometryFilter){filter.filter(this);}else if(filter instanceof jsts.geom.CoordinateFilter){this.shell.apply(filter);for(var i=0,len=this.holes.length;i<len;i++){this.holes[i].apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.Polygon.prototype.apply2=function(filter){this.shell.apply(filter);if(!filter.isDone()){for(var i=0;i<this.holes.length;i++){this.holes[i].apply(filter);if(filter.isDone())
break;}}
if(filter.isGeometryChanged()){}};jsts.geom.Polygon.prototype.clone=function(){var holes=[];for(var i=0,len=this.holes.length;i<len;i++){holes.push(this.holes[i].clone());}
return this.factory.createPolygon(this.shell.clone(),holes);};jsts.geom.Polygon.prototype.normalize=function(){this.normalize2(this.shell,true);for(var i=0,len=this.holes.length;i<len;i++){this.normalize2(this.holes[i],false);}
this.holes.sort();};jsts.geom.Polygon.prototype.normalize2=function(ring,clockwise){if(ring.isEmpty()){return;}
var uniqueCoordinates=ring.points.slice(0,ring.points.length-1);var minCoordinate=jsts.geom.CoordinateArrays.minCoordinate(ring.points);jsts.geom.CoordinateArrays.scroll(uniqueCoordinates,minCoordinate);ring.points=uniqueCoordinates.concat();ring.points[uniqueCoordinates.length]=uniqueCoordinates[0];if(jsts.algorithm.CGAlgorithms.isCCW(ring.points)===clockwise){ring.points.reverse();}};jsts.geom.Polygon.prototype.getGeometryType=function(){return'Polygon';};jsts.geom.Polygon.prototype.CLASS_NAME='jsts.geom.Polygon';})();(function(){var Geometry=jsts.geom.Geometry;var TreeSet=javascript.util.TreeSet;var Arrays=javascript.util.Arrays;jsts.geom.GeometryCollection=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.GeometryCollection.prototype=new Geometry();jsts.geom.GeometryCollection.constructor=jsts.geom.GeometryCollection;jsts.geom.GeometryCollection.prototype.isEmpty=function(){for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.isEmpty()){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.getArea=function(){var area=0.0;for(var i=0,len=this.geometries.length;i<len;i++){area+=this.getGeometryN(i).getArea();}
return area;};jsts.geom.GeometryCollection.prototype.getLength=function(){var length=0.0;for(var i=0,len=this.geometries.length;i<len;i++){length+=this.getGeometryN(i).getLength();}
return length;};jsts.geom.GeometryCollection.prototype.getCoordinate=function(){if(this.isEmpty())
return null;return this.getGeometryN(0).getCoordinate();};jsts.geom.GeometryCollection.prototype.getCoordinates=function(){var coordinates=[];var k=-1;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);var childCoordinates=geometry.getCoordinates();for(var j=0;j<childCoordinates.length;j++){k++;coordinates[k]=childCoordinates[j];}}
return coordinates;};jsts.geom.GeometryCollection.prototype.getNumGeometries=function(){return this.geometries.length;};jsts.geom.GeometryCollection.prototype.getGeometryN=function(n){var geometry=this.geometries[n];if(geometry instanceof jsts.geom.Coordinate){geometry=new jsts.geom.Point(geometry);}
return geometry;};jsts.geom.GeometryCollection.prototype.getNumPoints=function(n){var numPoints=0;for(var i=0;i<this.geometries.length;i++){numPoints+=this.geometries[i].getNumPoints();}
return numPoints;}
jsts.geom.GeometryCollection.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
if(this.geometries.length!==other.geometries.length){return false;}
for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);if(!geometry.equalsExact(other.getGeometryN(i),tolerance)){return false;}}
return true;};jsts.geom.GeometryCollection.prototype.clone=function(){var geometries=[];for(var i=0,len=this.geometries.length;i<len;i++){geometries.push(this.geometries[i].clone());}
return this.factory.createGeometryCollection(geometries);};jsts.geom.GeometryCollection.prototype.normalize=function(){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).normalize();}
this.geometries.sort();};jsts.geom.GeometryCollection.prototype.compareToSameClass=function(o){var theseElements=new TreeSet(Arrays.asList(this.geometries));var otherElements=new TreeSet(Arrays.asList(o.geometries));return this.compare(theseElements,otherElements);};jsts.geom.GeometryCollection.prototype.apply=function(filter){if(filter instanceof jsts.geom.GeometryFilter||filter instanceof jsts.geom.GeometryComponentFilter){filter.filter(this);for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateFilter){for(var i=0,len=this.geometries.length;i<len;i++){this.getGeometryN(i).apply(filter);}}else if(filter instanceof jsts.geom.CoordinateSequenceFilter){this.apply2.apply(this,arguments);}};jsts.geom.GeometryCollection.prototype.apply2=function(filter){if(this.geometries.length==0)
return;for(var i=0;i<this.geometries.length;i++){this.geometries[i].apply(filter);if(filter.isDone()){break;}}
if(filter.isGeometryChanged()){}};jsts.geom.GeometryCollection.prototype.getDimension=function(){var dimension=jsts.geom.Dimension.FALSE;for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);dimension=Math.max(dimension,geometry.getDimension());}
return dimension;};jsts.geom.GeometryCollection.prototype.computeEnvelopeInternal=function(){var envelope=new jsts.geom.Envelope();for(var i=0,len=this.geometries.length;i<len;i++){var geometry=this.getGeometryN(i);envelope.expandToInclude(geometry.getEnvelopeInternal());}
return envelope;};jsts.geom.GeometryCollection.prototype.CLASS_NAME='jsts.geom.GeometryCollection';})();jsts.algorithm.Centroid=function(geometry){this.areaBasePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.areasum2=0;this.cg3=new jsts.geom.Coordinate();this.lineCentSum=new jsts.geom.Coordinate();this.totalLength=0;this.ptCount=0;this.ptCentSum=new jsts.geom.Coordinate();this.add(geometry);};jsts.algorithm.Centroid.getCentroid=function(geometry){var cent=new jsts.algorithm.Centroid(geometry);return cent.getCentroid();};jsts.algorithm.Centroid.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;};jsts.algorithm.Centroid.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.Centroid.prototype.add=function(geom){if(geom.isEmpty()){return;}
if(geom instanceof jsts.geom.Point){this.addPoint(geom.getCoordinate());}else if(geom instanceof jsts.geom.LineString){this.addLineSegments(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){this.addPolygon(geom);}else if(geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){this.add(geom.getGeometryN(i));}}};jsts.algorithm.Centroid.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else if(this.totalLength>0){cent.x=this.lineCentSum.x/this.totalLength;cent.y=this.lineCentSum.y/this.totalLength;}else if(this.ptCount>0){cent.x=this.ptCentSum.x/this.ptCount;cent.y=this.ptCentSum.y/this.ptCount;}else{return null;}
return cent;};jsts.algorithm.Centroid.prototype.setBasePoint=function(basePt){if(this.areaBasePt===null){this.areaBasePt=basePt;}};jsts.algorithm.Centroid.prototype.addPolygon=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.Centroid.prototype.addShell=function(pts){if(pts.length>0){this.setBasePoint(pts[0]);}
var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.areaBasePt,pts[i],pts[i+1],isPositiveArea);}
this.addLineSegments(pts);};jsts.algorithm.Centroid.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1:-1;jsts.algorithm.Centroid.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.Centroid.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.Centroid.prototype.addLineSegments=function(pts){var lineLen=0;for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);if(segmentLen===0){continue;}
lineLen+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.lineCentSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.lineCentSum.y+=segmentLen*midy;}
this.totalLength+=lineLen;if(lineLen===0&&pts.length>0){this.addPoint(pts[0]);}};jsts.algorithm.Centroid.prototype.addPoint=function(pt){this.ptCount+=1;this.ptCentSum.x+=pt.x;this.ptCentSum.y+=pt.y;};(function(){var EdgeRing=function(factory){this.deList=new javascript.util.ArrayList();this.factory=factory;};EdgeRing.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var it=shellList.iterator();it.hasNext();){var tryShell=it.next();var tryRing=tryShell.getRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!=null)
minEnv=minShell.getRing().getEnvelopeInternal();var isContained=false;if(tryEnv.equals(testEnv))
continue;testPt=jsts.geom.CoordinateArrays.ptNotInList(testRing.getCoordinates(),tryRing.getCoordinates());if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};EdgeRing.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(!isInList(testPt,pts))
return testPt;}
return null;};EdgeRing.isInList=function(pt,pts){for(var i=0;i<pts.length;i++){if(pt.equals(pts[i]))
return true;}
return false;}
EdgeRing.prototype.factory=null;EdgeRing.prototype.deList=null;EdgeRing.prototype.ring=null;EdgeRing.prototype.ringPts=null;EdgeRing.prototype.holes=null;EdgeRing.prototype.add=function(de){this.deList.add(de);};EdgeRing.prototype.isHole=function(){var ring=this.getRing();return jsts.algorithm.CGAlgorithms.isCCW(ring.getCoordinates());};EdgeRing.prototype.addHole=function(hole){if(this.holes==null)
this.holes=new javascript.util.ArrayList();this.holes.add(hole);};EdgeRing.prototype.getPolygon=function(){var holeLR=null;if(this.holes!=null){holeLR=[];for(var i=0;i<this.holes.size();i++){holeLR[i]=this.holes.get(i);}}
var poly=this.factory.createPolygon(this.ring,holeLR);return poly;};EdgeRing.prototype.isValid=function(){this.getCoordinates();if(this.ringPts.length<=3)
return false;this.getRing();return this.ring.isValid();};EdgeRing.prototype.getCoordinates=function(){if(this.ringPts==null){var coordList=new jsts.geom.CoordinateList();for(var i=this.deList.iterator();i.hasNext();){var de=i.next();var edge=de.getEdge();EdgeRing.addEdge(edge.getLine().getCoordinates(),de.getEdgeDirection(),coordList);}
this.ringPts=coordList.toCoordinateArray();}
return this.ringPts;};EdgeRing.prototype.getLineString=function(){this.getCoordinates();return this.factory.createLineString(this.ringPts);};EdgeRing.prototype.getRing=function(){if(this.ring!=null)
return this.ring;this.getCoordinates();if(this.ringPts.length<3)
console.log(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts);}catch(ex){console.log(this.ringPts);}
return this.ring;};EdgeRing.addEdge=function(coords,isForward,coordList){if(isForward){for(var i=0;i<coords.length;i++){coordList.add(coords[i],false);}}else{for(var i=coords.length-1;i>=0;i--){coordList.add(coords[i],false);}}};jsts.operation.polygonize.EdgeRing=EdgeRing;})();(function(){var GraphComponent=function(){};GraphComponent.setVisited=function(i,visited){while(i.hasNext()){var comp=i.next();comp.setVisited(visited);}};GraphComponent.setMarked=function(i,marked){while(i.hasNext()){var comp=i.next();comp.setMarked(marked);}};GraphComponent.getComponentWithVisitedState=function(i,visitedState){while(i.hasNext()){var comp=i.next();if(comp.isVisited()==visitedState)
return comp;}
return null;};GraphComponent.prototype._isMarked=false;GraphComponent.prototype._isVisited=false;GraphComponent.prototype.data;GraphComponent.prototype.isVisited=function(){return this._isVisited;};GraphComponent.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};GraphComponent.prototype.isMarked=function(){return this._isMarked;};GraphComponent.prototype.setMarked=function(isMarked){this._isMarked=isMarked;};GraphComponent.prototype.setContext=function(data){this.data=data;};GraphComponent.prototype.getContext=function(){return data;};GraphComponent.prototype.setData=function(data){this.data=data;};GraphComponent.prototype.getData=function(){return data;};GraphComponent.prototype.isRemoved=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.planargraph.GraphComponent=GraphComponent;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var Edge=function(de0,de1){if(de0===undefined){return;}
this.setDirectedEdges(de0,de1);};Edge.prototype=new GraphComponent();Edge.prototype.dirEdge=null;Edge.prototype.setDirectedEdges=function(de0,de1){this.dirEdge=[de0,de1];de0.setEdge(this);de1.setEdge(this);de0.setSym(de1);de1.setSym(de0);de0.getFromNode().addOutEdge(de0);de1.getFromNode().addOutEdge(de1);};Edge.prototype.getDirEdge=function(i){if(i instanceof jsts.planargraph.Node){this.getDirEdge2(i);}
return this.dirEdge[i];};Edge.prototype.getDirEdge2=function(fromNode){if(this.dirEdge[0].getFromNode()==fromNode)
return this.dirEdge[0];if(this.dirEdge[1].getFromNode()==fromNode)
return this.dirEdge[1];return null;};Edge.prototype.getOppositeNode=function(node){if(this.dirEdge[0].getFromNode()==node)
return this.dirEdge[0].getToNode();if(this.dirEdge[1].getFromNode()==node)
return this.dirEdge[1].getToNode();return null;};Edge.prototype.remove=function(){this.dirEdge=null;};Edge.prototype.isRemoved=function(){return dirEdge==null;};jsts.planargraph.Edge=Edge;})();jsts.operation.polygonize.PolygonizeEdge=function(line){this.line=line;};jsts.operation.polygonize.PolygonizeEdge.prototype=new jsts.planargraph.Edge();jsts.operation.polygonize.PolygonizeEdge.prototype.line=null;jsts.operation.polygonize.PolygonizeEdge.prototype.getLine=function(){return this.line;};(function(){var ArrayList=javascript.util.ArrayList;var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdge=function(from,to,directionPt,edgeDirection){if(from===undefined){return;}
this.from=from;this.to=to;this.edgeDirection=edgeDirection;this.p0=from.getCoordinate();this.p1=directionPt;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(dx,dy);this.angle=Math.atan2(dy,dx);};DirectedEdge.prototype=new GraphComponent();DirectedEdge.toEdges=function(dirEdges){var edges=new ArrayList();for(var i=dirEdges.iterator();i.hasNext();){edges.add((i.next()).parentEdge);}
return edges;};DirectedEdge.prototype.parentEdge=null;DirectedEdge.prototype.from=null;DirectedEdge.prototype.to=null;DirectedEdge.prototype.p0=null;DirectedEdge.prototype.p1=null;DirectedEdge.prototype.sym=null;DirectedEdge.prototype.edgeDirection=null;DirectedEdge.prototype.quadrant=null;DirectedEdge.prototype.angle=null;DirectedEdge.prototype.getEdge=function(){return this.parentEdge;};DirectedEdge.prototype.setEdge=function(parentEdge){this.parentEdge=parentEdge;};DirectedEdge.prototype.getQuadrant=function(){return this.quadrant;};DirectedEdge.prototype.getDirectionPt=function(){return this.p1;};DirectedEdge.prototype.getEdgeDirection=function(){return this.edgeDirection;};DirectedEdge.prototype.getFromNode=function(){return this.from;};DirectedEdge.prototype.getToNode=function(){return this.to;};DirectedEdge.prototype.getCoordinate=function(){return this.from.getCoordinate();};DirectedEdge.prototype.getAngle=function(){return this.angle;};DirectedEdge.prototype.getSym=function(){return this.sym;};DirectedEdge.prototype.setSym=function(sym){this.sym=sym;};DirectedEdge.prototype.remove=function(){this.sym=null;this.parentEdge=null;};DirectedEdge.prototype.isRemoved=function(){return this.parentEdge==null;};DirectedEdge.prototype.compareTo=function(obj){var de=obj;return this.compareDirection(de);};DirectedEdge.prototype.compareDirection=function(e){if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.planargraph.DirectedEdge=DirectedEdge;})();(function(){var DirectedEdge=jsts.planargraph.DirectedEdge;var PolygonizeDirectedEdge=function(from,to,directionPt,edgeDirection){DirectedEdge.apply(this,arguments);};PolygonizeDirectedEdge.prototype=new DirectedEdge();PolygonizeDirectedEdge.prototype.edgeRing=null;PolygonizeDirectedEdge.prototype.next=null;PolygonizeDirectedEdge.prototype.label=-1;PolygonizeDirectedEdge.prototype.getLabel=function(){return this.label;};PolygonizeDirectedEdge.prototype.setLabel=function(label){this.label=label;};PolygonizeDirectedEdge.prototype.getNext=function(){return this.next;};PolygonizeDirectedEdge.prototype.setNext=function(next){this.next=next;};PolygonizeDirectedEdge.prototype.isInRing=function(){return this.edgeRing!=null;};PolygonizeDirectedEdge.prototype.setRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.operation.polygonize.PolygonizeDirectedEdge=PolygonizeDirectedEdge;})();(function(){var ArrayList=javascript.util.ArrayList;var DirectedEdgeStar=function(){this.outEdges=new ArrayList();};DirectedEdgeStar.prototype.outEdges=null;DirectedEdgeStar.prototype.sorted=false;DirectedEdgeStar.prototype.add=function(de){this.outEdges.add(de);this.sorted=false;};DirectedEdgeStar.prototype.remove=function(de){this.outEdges.remove(de);};DirectedEdgeStar.prototype.iterator=function(){this.sortEdges();return this.outEdges.iterator();};DirectedEdgeStar.prototype.getDegree=function(){return this.outEdges.size();};DirectedEdgeStar.prototype.getCoordinate=function(){var it=iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};DirectedEdgeStar.prototype.getEdges=function(){this.sortEdges();return this.outEdges;};DirectedEdgeStar.prototype.sortEdges=function(){if(!this.sorted){var array=this.outEdges.toArray();array.sort(function(a,b){return a.compareTo(b);});this.outEdges=javascript.util.Arrays.asList(array);this.sorted=true;}};DirectedEdgeStar.prototype.getIndex=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.getIndex2(edge);}else if(typeof(edge)==='number'){return this.getIndex3(edge);}
this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de.getEdge()==edge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex2=function(dirEdge){this.sortEdges();for(var i=0;i<this.outEdges.size();i++){var de=this.outEdges.get(i);if(de==dirEdge)
return i;}
return-1;};DirectedEdgeStar.prototype.getIndex3=function(i){var modi=toInt(i%this.outEdges.size());if(modi<0)
modi+=this.outEdges.size();return modi;};DirectedEdgeStar.prototype.getNextEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i+1));};DirectedEdgeStar.prototype.getNextCWEdge=function(dirEdge){var i=this.getIndex(dirEdge);return this.outEdges.get(getIndex(i-1));};jsts.planargraph.DirectedEdgeStar=DirectedEdgeStar;})();(function(){var GraphComponent=jsts.planargraph.GraphComponent;var DirectedEdgeStar=jsts.planargraph.DirectedEdgeStar;var Node=function(pt,deStar){this.pt=pt;this.deStar=deStar||new DirectedEdgeStar();};Node.prototype=new GraphComponent();Node.getEdgesBetween=function(node0,node1){var edges0=DirectedEdge.toEdges(node0.getOutEdges().getEdges());var commonEdges=new javascript.util.HashSet(edges0);var edges1=DirectedEdge.toEdges(node1.getOutEdges().getEdges());commonEdges.retainAll(edges1);return commonEdges;};Node.prototype.pt=null;Node.prototype.deStar=null;Node.prototype.getCoordinate=function(){return this.pt;};Node.prototype.addOutEdge=function(de){this.deStar.add(de);};Node.prototype.getOutEdges=function(){return this.deStar;};Node.prototype.getDegree=function(){return this.deStar.getDegree();};Node.prototype.getIndex=function(edge){return this.deStar.getIndex(edge);};Node.prototype.remove=function(de){if(de===undefined){return this.remove2();}
this.deStar.remove(de);};Node.prototype.remove2=function(){this.pt=null;};Node.prototype.isRemoved=function(){return this.pt==null;};jsts.planargraph.Node=Node;})();(function(){var NodeMap=function(){this.nodeMap=new javascript.util.TreeMap();};NodeMap.prototype.nodeMap=null;NodeMap.prototype.add=function(n){this.nodeMap.put(n.getCoordinate(),n);return n;};NodeMap.prototype.remove=function(pt){return this.nodeMap.remove(pt);};NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};NodeMap.prototype.iterator=function(){return this.nodeMap.values().iterator();};NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.planargraph.NodeMap=NodeMap;})();(function(){var ArrayList=javascript.util.ArrayList;var PlanarGraph=function(){this.edges=new javascript.util.HashSet();this.dirEdges=new javascript.util.HashSet();this.nodeMap=new jsts.planargraph.NodeMap();};PlanarGraph.prototype.edges=null;PlanarGraph.prototype.dirEdges=null;PlanarGraph.prototype.nodeMap=null;PlanarGraph.prototype.findNode=function(pt){return this.nodeMap.find(pt);};PlanarGraph.prototype.add=function(node){if(node instanceof jsts.planargraph.Edge){return this.add2(node);}else if(node instanceof jsts.planargraph.DirectedEdge){return this.add3(node);}
this.nodeMap.add(node);};PlanarGraph.prototype.add2=function(edge){this.edges.add(edge);this.add(edge.getDirEdge(0));this.add(edge.getDirEdge(1));};PlanarGraph.prototype.add3=function(dirEdge){this.dirEdges.add(dirEdge);};PlanarGraph.prototype.nodeIterator=function(){return this.nodeMap.iterator();};PlanarGraph.prototype.contains=function(e){if(e instanceof jsts.planargraph.DirectedEdge){return this.contains2(e);}
return this.edges.contains(e);};PlanarGraph.prototype.contains2=function(de){return this.dirEdges.contains(de);};PlanarGraph.prototype.getNodes=function(){return this.nodeMap.values();};PlanarGraph.prototype.dirEdgeIterator=function(){return this.dirEdges.iterator();};PlanarGraph.prototype.edgeIterator=function(){return this.edges.iterator();};PlanarGraph.prototype.getEdges=function(){return this.edges;};PlanarGraph.prototype.remove=function(edge){if(edge instanceof jsts.planargraph.DirectedEdge){return this.remove2(edge);}
this.remove(edge.getDirEdge(0));this.remove(edge.getDirEdge(1));this.edges.remove(edge);this.edge.remove();};PlanarGraph.prototype.remove2=function(de){if(de instanceof jsts.planargraph.Node){return this.remove3(de);}
var sym=de.getSym();if(sym!=null)
sym.setSym(null);de.getFromNode().remove(de);de.remove();this.dirEdges.remove(de);};PlanarGraph.prototype.remove3=function(node){var outEdges=node.getOutEdges().getEdges();for(var i=outEdges.iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym!=null)
this.remove(sym);this.dirEdges.remove(de);var edge=de.getEdge();if(edge!=null){this.edges.remove(edge);}}
this.nodeMap.remove(node.getCoordinate());node.remove();};PlanarGraph.prototype.findNodesOfDegree=function(degree){var nodesFound=new ArrayList();for(var i=this.nodeIterator();i.hasNext();){var node=i.next();if(node.getDegree()==degree)
nodesFound.add(node);}
return nodesFound;};jsts.planargraph.PlanarGraph=PlanarGraph;})();(function(){var ArrayList=javascript.util.ArrayList;var Stack=javascript.util.Stack;var HashSet=javascript.util.HashSet;var Assert=jsts.util.Assert;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeEdge=jsts.operation.polygonize.PolygonizeEdge;var PolygonizeDirectedEdge=jsts.operation.polygonize.PolygonizeDirectedEdge;var PlanarGraph=jsts.planargraph.PlanarGraph;var Node=jsts.planargraph.Node;var PolygonizeGraph=function(factory){PlanarGraph.apply(this);this.factory=factory;};PolygonizeGraph.prototype=new PlanarGraph();PolygonizeGraph.getDegreeNonDeleted=function(node){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(!de.isMarked())
degree++;}
return degree;};PolygonizeGraph.getDegree=function(node,label){var edges=node.getOutEdges().getEdges();var degree=0;for(var i=edges.iterator();i.hasNext();){var de=i.next();if(de.getLabel()==label)
degree++;}
return degree;};PolygonizeGraph.deleteAllEdges=function(node){var edges=node.getOutEdges().getEdges();for(var i=edges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);}};PolygonizeGraph.prototype.factory=null;PolygonizeGraph.prototype.addEdge=function(line){if(line.isEmpty()){return;}
var linePts=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(linePts.length<2){return;}
var startPt=linePts[0];var endPt=linePts[linePts.length-1];var nStart=this.getNode(startPt);var nEnd=this.getNode(endPt);var de0=new PolygonizeDirectedEdge(nStart,nEnd,linePts[1],true);var de1=new PolygonizeDirectedEdge(nEnd,nStart,linePts[linePts.length-2],false);var edge=new PolygonizeEdge(line);edge.setDirectedEdges(de0,de1);this.add(edge);};PolygonizeGraph.prototype.getNode=function(pt){var node=this.findNode(pt);if(node==null){node=new Node(pt);this.add(node);}
return node;};PolygonizeGraph.prototype.computeNextCWEdges=function(){for(var iNode=this.nodeIterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCWEdges(node);}};PolygonizeGraph.prototype.convertMaximalToMinimalEdgeRings=function(ringEdges){for(var i=ringEdges.iterator();i.hasNext();){var de=i.next();var label=de.getLabel();var intNodes=PolygonizeGraph.findIntersectionNodes(de,label);if(intNodes==null)
continue;for(var iNode=intNodes.iterator();iNode.hasNext();){var node=iNode.next();PolygonizeGraph.computeNextCCWEdges(node,label);}}};PolygonizeGraph.findIntersectionNodes=function(startDE,label){var de=startDE;var intNodes=null;do{var node=de.getFromNode();if(PolygonizeGraph.getDegree(node,label)>1){if(intNodes==null)
intNodes=new ArrayList();intNodes.add(node);}
de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return intNodes;};PolygonizeGraph.prototype.getEdgeRings=function(){this.computeNextCWEdges();PolygonizeGraph.label(this.dirEdges,-1);var maximalRings=PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(maximalRings);var edgeRingList=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.isInRing())
continue;var er=this.findEdgeRing(de);edgeRingList.add(er);}
return edgeRingList;};PolygonizeGraph.findLabeledEdgeRings=function(dirEdges){var edgeRingStarts=new ArrayList();var currLabel=1;for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;if(de.getLabel()>=0)
continue;edgeRingStarts.add(de);var edges=PolygonizeGraph.findDirEdgesInRing(de);PolygonizeGraph.label(edges,currLabel);currLabel++;}
return edgeRingStarts;};PolygonizeGraph.prototype.deleteCutEdges=function(){this.computeNextCWEdges();PolygonizeGraph.findLabeledEdgeRings(this.dirEdges);var cutLines=new ArrayList();for(var i=this.dirEdges.iterator();i.hasNext();){var de=i.next();if(de.isMarked())
continue;var sym=de.getSym();if(de.getLabel()==sym.getLabel()){de.setMarked(true);sym.setMarked(true);var e=de.getEdge();cutLines.add(e.getLine());}}
return cutLines;};PolygonizeGraph.label=function(dirEdges,label){for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();de.setLabel(label);}};PolygonizeGraph.computeNextCWEdges=function(node){var deStar=node.getOutEdges();var startDE=null;var prevDE=null;for(var i=deStar.getEdges().iterator();i.hasNext();){var outDE=i.next();if(outDE.isMarked())
continue;if(startDE==null)
startDE=outDE;if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(outDE);}
prevDE=outDE;}
if(prevDE!=null){var sym=prevDE.getSym();sym.setNext(startDE);}};PolygonizeGraph.computeNextCCWEdges=function(node,label){var deStar=node.getOutEdges();var firstOutDE=null;var prevInDE=null;var edges=deStar.getEdges();for(var i=edges.size()-1;i>=0;i--){var de=edges.get(i);var sym=de.getSym();var outDE=null;if(de.getLabel()==label)
outDE=de;var inDE=null;if(sym.getLabel()==label)
inDE=sym;if(outDE==null&&inDE==null)
continue;if(inDE!=null){prevInDE=inDE;}
if(outDE!=null){if(prevInDE!=null){prevInDE.setNext(outDE);prevInDE=null;}
if(firstOutDE==null)
firstOutDE=outDE;}}
if(prevInDE!=null){Assert.isTrue(firstOutDE!=null);prevInDE.setNext(firstOutDE);}};PolygonizeGraph.findDirEdgesInRing=function(startDE){var de=startDE;var edges=new ArrayList();do{edges.add(de);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return edges;};PolygonizeGraph.prototype.findEdgeRing=function(startDE){var de=startDE;var er=new EdgeRing(this.factory);do{er.add(de);de.setRing(er);de=de.getNext();Assert.isTrue(de!=null,'found null DE in ring');Assert.isTrue(de==startDE||!de.isInRing(),'found DE already in ring');}while(de!=startDE);return er;};PolygonizeGraph.prototype.deleteDangles=function(){var nodesToRemove=this.findNodesOfDegree(1);var dangleLines=new HashSet();var nodeStack=new Stack();for(var i=nodesToRemove.iterator();i.hasNext();){nodeStack.push(i.next());}
while(!nodeStack.isEmpty()){var node=nodeStack.pop();PolygonizeGraph.deleteAllEdges(node);var nodeOutEdges=node.getOutEdges().getEdges();for(var i=nodeOutEdges.iterator();i.hasNext();){var de=i.next();de.setMarked(true);var sym=de.getSym();if(sym!=null)
sym.setMarked(true);var e=de.getEdge();dangleLines.add(e.getLine());var toNode=de.getToNode();if(PolygonizeGraph.getDegreeNonDeleted(toNode)==1)
nodeStack.push(toNode);}}
return dangleLines;};PolygonizeGraph.prototype.computeDepthParity=function(){while(true){var de=null;if(de==null)
return;this.computeDepthParity(de);}};PolygonizeGraph.prototype.computeDepthParity=function(de){};jsts.operation.polygonize.PolygonizeGraph=PolygonizeGraph;})();jsts.index.strtree.Interval=function(){var other;if(arguments.length===1){other=arguments[0];return jsts.index.strtree.Interval(other.min,other.max);}else if(arguments.length===2){jsts.util.Assert.isTrue(this.min<=this.max);this.min=arguments[0];this.max=arguments[1];}};jsts.index.strtree.Interval.prototype.min=null;jsts.index.strtree.Interval.prototype.max=null;jsts.index.strtree.Interval.prototype.getCentre=function(){return(this.min+this.max)/2;};jsts.index.strtree.Interval.prototype.expandToInclude=function(other){this.max=Math.max(this.max,other.max);this.min=Math.min(this.min,other.min);return this;};jsts.index.strtree.Interval.prototype.intersects=function(other){return!(other.min>this.max||other.max<this.min);};jsts.index.strtree.Interval.prototype.equals=function(o){if(!(o instanceof jsts.index.strtree.Interval)){return false;}
other=o;return this.min===other.min&&this.max===other.max;};jsts.geom.GeometryFactory=function(precisionModel){this.precisionModel=precisionModel||new jsts.geom.PrecisionModel();};jsts.geom.GeometryFactory.prototype.precisionModel=null;jsts.geom.GeometryFactory.prototype.getPrecisionModel=function(){return this.precisionModel;};jsts.geom.GeometryFactory.prototype.createPoint=function(coordinate){var point=new jsts.geom.Point(coordinate,this);return point;};jsts.geom.GeometryFactory.prototype.createLineString=function(coordinates){var lineString=new jsts.geom.LineString(coordinates,this);return lineString;};jsts.geom.GeometryFactory.prototype.createLinearRing=function(coordinates){var linearRing=new jsts.geom.LinearRing(coordinates,this);return linearRing;};jsts.geom.GeometryFactory.prototype.createPolygon=function(shell,holes){var polygon=new jsts.geom.Polygon(shell,holes,this);return polygon;};jsts.geom.GeometryFactory.prototype.createMultiPoint=function(points){if(points&&points[0]instanceof jsts.geom.Coordinate){var converted=[];var i;for(i=0;i<points.length;i++){converted.push(this.createPoint(points[i]));}
points=converted;}
return new jsts.geom.MultiPoint(points,this);};jsts.geom.GeometryFactory.prototype.createMultiLineString=function(lineStrings){return new jsts.geom.MultiLineString(lineStrings,this);};jsts.geom.GeometryFactory.prototype.createMultiPolygon=function(polygons){return new jsts.geom.MultiPolygon(polygons,this);};jsts.geom.GeometryFactory.prototype.buildGeometry=function(geomList){var geomClass=null;var isHeterogeneous=false;var hasGeometryCollection=false;for(var i=geomList.iterator();i.hasNext();){var geom=i.next();var partClass=geom.CLASS_NAME;if(geomClass===null){geomClass=partClass;}
if(!(partClass===geomClass)){isHeterogeneous=true;}
if(geom.isGeometryCollectionBase())
hasGeometryCollection=true;}
if(geomClass===null){return this.createGeometryCollection(null);}
if(isHeterogeneous||hasGeometryCollection){return this.createGeometryCollection(geomList.toArray());}
var geom0=geomList.get(0);var isCollection=geomList.size()>1;if(isCollection){if(geom0 instanceof jsts.geom.Polygon){return this.createMultiPolygon(geomList.toArray());}else if(geom0 instanceof jsts.geom.LineString){return this.createMultiLineString(geomList.toArray());}else if(geom0 instanceof jsts.geom.Point){return this.createMultiPoint(geomList.toArray());}
jsts.util.Assert.shouldNeverReachHere('Unhandled class: '+geom0);}
return geom0;};jsts.geom.GeometryFactory.prototype.createGeometryCollection=function(geometries){return new jsts.geom.GeometryCollection(geometries,this);};jsts.geom.GeometryFactory.prototype.toGeometry=function(envelope){if(envelope.isNull()){return this.createPoint(null);}
if(envelope.getMinX()===envelope.getMaxX()&&envelope.getMinY()===envelope.getMaxY()){return this.createPoint(new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()));}
if(envelope.getMinX()===envelope.getMaxX()||envelope.getMinY()===envelope.getMaxY()){return this.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY())]);}
return this.createPolygon(this.createLinearRing([new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMaxY()),new jsts.geom.Coordinate(envelope.getMaxX(),envelope.getMinY()),new jsts.geom.Coordinate(envelope.getMinX(),envelope.getMinY())]),null);};jsts.geomgraph.NodeFactory=function(){};jsts.geomgraph.NodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,null);};(function(){jsts.geomgraph.Position=function(){};jsts.geomgraph.Position.ON=0;jsts.geomgraph.Position.LEFT=1;jsts.geomgraph.Position.RIGHT=2;jsts.geomgraph.Position.opposite=function(position){if(position===jsts.geomgraph.Position.LEFT){return jsts.geomgraph.Position.RIGHT;}
if(position===jsts.geomgraph.Position.RIGHT){return jsts.geomgraph.Position.LEFT;}
return position;};})();jsts.geomgraph.TopologyLocation=function(){this.location=[];if(arguments.length===3){var on=arguments[0];var left=arguments[1];var right=arguments[2];this.init(3);this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;}else if(arguments[0]instanceof jsts.geomgraph.TopologyLocation){var gl=arguments[0];this.init(gl.location.length);if(gl!=null){for(var i=0;i<this.location.length;i++){this.location[i]=gl.location[i];}}}else if(typeof arguments[0]==='number'){var on=arguments[0];this.init(1);this.location[jsts.geomgraph.Position.ON]=on;}else if(arguments[0]instanceof Array){var location=arguments[0];this.init(location.length);}};jsts.geomgraph.TopologyLocation.prototype.location=null;jsts.geomgraph.TopologyLocation.prototype.init=function(size){this.location[size-1]=null;this.setAllLocations(jsts.geom.Location.NONE);};jsts.geomgraph.TopologyLocation.prototype.get=function(posIndex){if(posIndex<this.location.length)
return this.location[posIndex];return jsts.geom.Location.NONE;};jsts.geomgraph.TopologyLocation.prototype.isNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]!==jsts.geom.Location.NONE)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.isAnyNull=function(){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
return true;}
return false;};jsts.geomgraph.TopologyLocation.prototype.isEqualOnSide=function(le,locIndex){return this.location[locIndex]==le.location[locIndex];};jsts.geomgraph.TopologyLocation.prototype.isArea=function(){return this.location.length>1;};jsts.geomgraph.TopologyLocation.prototype.isLine=function(){return this.location.length===1;};jsts.geomgraph.TopologyLocation.prototype.flip=function(){if(this.location.length<=1)
return;var temp=this.location[jsts.geomgraph.Position.LEFT];this.location[jsts.geomgraph.Position.LEFT]=this.location[jsts.geomgraph.Position.RIGHT];this.location[jsts.geomgraph.Position.RIGHT]=temp;};jsts.geomgraph.TopologyLocation.prototype.setAllLocations=function(locValue){for(var i=0;i<this.location.length;i++){this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setAllLocationsIfNull=function(locValue){for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE)
this.location[i]=locValue;}};jsts.geomgraph.TopologyLocation.prototype.setLocation=function(locIndex,locValue){if(locValue!==undefined){this.location[locIndex]=locValue;}else{this.setLocation(jsts.geomgraph.Position.ON,locIndex);}};jsts.geomgraph.TopologyLocation.prototype.getLocations=function(){return location;};jsts.geomgraph.TopologyLocation.prototype.setLocations=function(on,left,right){this.location[jsts.geomgraph.Position.ON]=on;this.location[jsts.geomgraph.Position.LEFT]=left;this.location[jsts.geomgraph.Position.RIGHT]=right;};jsts.geomgraph.TopologyLocation.prototype.allPositionsEqual=function(loc){for(var i=0;i<this.location.length;i++){if(this.location[i]!==loc)
return false;}
return true;};jsts.geomgraph.TopologyLocation.prototype.merge=function(gl){if(gl.location.length>this.location.length){var newLoc=[];newLoc[jsts.geomgraph.Position.ON]=this.location[jsts.geomgraph.Position.ON];newLoc[jsts.geomgraph.Position.LEFT]=jsts.geom.Location.NONE;newLoc[jsts.geomgraph.Position.RIGHT]=jsts.geom.Location.NONE;this.location=newLoc;}
for(var i=0;i<this.location.length;i++){if(this.location[i]===jsts.geom.Location.NONE&&i<gl.location.length)
this.location[i]=gl.location[i];}};jsts.geomgraph.Label=function(){this.elt=[];var geomIndex,onLoc,leftLoc,lbl,rightLoc;if(arguments.length===4){geomIndex=arguments[0];onLoc=arguments[1];leftLoc=arguments[2];rightLoc=arguments[3];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);this.elt[geomIndex].setLocations(onLoc,leftLoc,rightLoc);}else if(arguments.length===3){onLoc=arguments[0];leftLoc=arguments[1];rightLoc=arguments[2];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc,leftLoc,rightLoc);}else if(arguments.length===2){geomIndex=arguments[0];onLoc=arguments[1];this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE);this.elt[geomIndex].setLocation(onLoc);}else if(arguments[0]instanceof jsts.geomgraph.Label){lbl=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(lbl.elt[0]);this.elt[1]=new jsts.geomgraph.TopologyLocation(lbl.elt[1]);}else if(typeof arguments[0]==='number'){onLoc=arguments[0];this.elt[0]=new jsts.geomgraph.TopologyLocation(onLoc);this.elt[1]=new jsts.geomgraph.TopologyLocation(onLoc);}};jsts.geomgraph.Label.toLineLabel=function(label){var i,lineLabel=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(i=0;i<2;i++){lineLabel.setLocation(i,label.getLocation(i));}
return lineLabel;};jsts.geomgraph.Label.prototype.elt=null;jsts.geomgraph.Label.prototype.flip=function(){this.elt[0].flip();this.elt[1].flip();};jsts.geomgraph.Label.prototype.getLocation=function(geomIndex,posIndex){if(arguments.length==1){return this.getLocation2.apply(this,arguments);}
return this.elt[geomIndex].get(posIndex);};jsts.geomgraph.Label.prototype.getLocation2=function(geomIndex){return this.elt[geomIndex].get(jsts.geomgraph.Position.ON);};jsts.geomgraph.Label.prototype.setLocation=function(geomIndex,posIndex,location){if(arguments.length==2){this.setLocation2.apply(this,arguments);return;}
this.elt[geomIndex].setLocation(posIndex,location);};jsts.geomgraph.Label.prototype.setLocation2=function(geomIndex,location){this.elt[geomIndex].setLocation(jsts.geomgraph.Position.ON,location);};jsts.geomgraph.Label.prototype.setAllLocations=function(geomIndex,location){this.elt[geomIndex].setAllLocations(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull=function(geomIndex,location){if(arguments.length==1){this.setAllLocationsIfNull2.apply(this,arguments);return;}
this.elt[geomIndex].setAllLocationsIfNull(location);};jsts.geomgraph.Label.prototype.setAllLocationsIfNull2=function(location){this.setAllLocationsIfNull(0,location);this.setAllLocationsIfNull(1,location);};jsts.geomgraph.Label.prototype.merge=function(lbl){var i;for(i=0;i<2;i++){if(this.elt[i]===null&&lbl.elt[i]!==null){this.elt[i]=new jsts.geomgraph.TopologyLocation(lbl.elt[i]);}else{this.elt[i].merge(lbl.elt[i]);}}};jsts.geomgraph.Label.prototype.getGeometryCount=function(){var count=0;if(!this.elt[0].isNull()){count++;}
if(!this.elt[1].isNull()){count++;}
return count;};jsts.geomgraph.Label.prototype.isNull=function(geomIndex){return this.elt[geomIndex].isNull();};jsts.geomgraph.Label.prototype.isAnyNull=function(geomIndex){return this.elt[geomIndex].isAnyNull();};jsts.geomgraph.Label.prototype.isArea=function(){if(arguments.length==1){return this.isArea2(arguments[0]);}
return this.elt[0].isArea()||this.elt[1].isArea();};jsts.geomgraph.Label.prototype.isArea2=function(geomIndex){return this.elt[geomIndex].isArea();};jsts.geomgraph.Label.prototype.isLine=function(geomIndex){return this.elt[geomIndex].isLine();};jsts.geomgraph.Label.prototype.isEqualOnSide=function(lbl,side){return this.elt[0].isEqualOnSide(lbl.elt[0],side)&&this.elt[1].isEqualOnSide(lbl.elt[1],side);};jsts.geomgraph.Label.prototype.allPositionsEqual=function(geomIndex,loc){return this.elt[geomIndex].allPositionsEqual(loc);};jsts.geomgraph.Label.prototype.toLine=function(geomIndex){if(this.elt[geomIndex].isArea()){this.elt[geomIndex]=new jsts.geomgraph.TopologyLocation(this.elt[geomIndex].location[0]);}};jsts.geomgraph.EdgeRing=function(start,geometryFactory){this.edges=[];this.pts=[];this.holes=[];this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);this.geometryFactory=geometryFactory;if(start){this.computePoints(start);this.computeRing();}};jsts.geomgraph.EdgeRing.prototype.startDe=null;jsts.geomgraph.EdgeRing.prototype.maxNodeDegree=-1;jsts.geomgraph.EdgeRing.prototype.edges=null;jsts.geomgraph.EdgeRing.prototype.pts=null;jsts.geomgraph.EdgeRing.prototype.label=null;jsts.geomgraph.EdgeRing.prototype.ring=null;jsts.geomgraph.EdgeRing.prototype._isHole=null;jsts.geomgraph.EdgeRing.prototype.shell=null;jsts.geomgraph.EdgeRing.prototype.holes=null;jsts.geomgraph.EdgeRing.prototype.geometryFactory=null;jsts.geomgraph.EdgeRing.prototype.isIsolated=function(){return(this.label.getGeometryCount()==1);};jsts.geomgraph.EdgeRing.prototype.isHole=function(){return this._isHole;};jsts.geomgraph.EdgeRing.prototype.getCoordinate=function(i){return this.pts[i];};jsts.geomgraph.EdgeRing.prototype.getLinearRing=function(){return this.ring;};jsts.geomgraph.EdgeRing.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeRing.prototype.isShell=function(){return this.shell===null;};jsts.geomgraph.EdgeRing.prototype.getShell=function(){return this.shell;};jsts.geomgraph.EdgeRing.prototype.setShell=function(shell){this.shell=shell;if(shell!==null)
shell.addHole(this);};jsts.geomgraph.EdgeRing.prototype.addHole=function(ring){this.holes.push(ring);};jsts.geomgraph.EdgeRing.prototype.toPolygon=function(geometryFactory){var holeLR=[];for(var i=0;i<this.holes.length;i++){holeLR[i]=this.holes[i].getLinearRing();}
var poly=this.geometryFactory.createPolygon(this.getLinearRing(),holeLR);return poly;};jsts.geomgraph.EdgeRing.prototype.computeRing=function(){if(this.ring!==null)
return;var coord=[];for(var i=0;i<this.pts.length;i++){coord[i]=this.pts[i];}
this.ring=this.geometryFactory.createLinearRing(coord);this._isHole=jsts.algorithm.CGAlgorithms.isCCW(this.ring.getCoordinates());};jsts.geomgraph.EdgeRing.prototype.getNext=function(de){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.setEdgeRing=function(de,er){throw new jsts.error.AbstractInvocationError();};jsts.geomgraph.EdgeRing.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeRing.prototype.computePoints=function(start){this.startDe=start;var de=start;var isFirstEdge=true;do{if(de===null)
throw new jsts.error.TopologyError('Found null DirectedEdge');if(de.getEdgeRing()===this)
throw new jsts.error.TopologyError('Directed Edge visited twice during ring-building at '+
de.getCoordinate());this.edges.push(de);var label=de.getLabel();jsts.util.Assert.isTrue(label.isArea());this.mergeLabel(label);this.addPoints(de.getEdge(),de.isForward(),isFirstEdge);isFirstEdge=false;this.setEdgeRing(de,this);de=this.getNext(de);}while(de!==this.startDe);};jsts.geomgraph.EdgeRing.prototype.getMaxNodeDegree=function(){if(this.maxNodeDegree<0)
this.computeMaxNodeDegree();return this.maxNodeDegree;};jsts.geomgraph.EdgeRing.prototype.computeMaxNodeDegree=function(){this.maxNodeDegree=0;var de=this.startDe;do{var node=de.getNode();var degree=node.getEdges().getOutgoingDegree(this);if(degree>this.maxNodeDegree)
this.maxNodeDegree=degree;de=this.getNext(de);}while(de!==this.startDe);this.maxNodeDegree*=2;};jsts.geomgraph.EdgeRing.prototype.setInResult=function(){var de=this.startDe;do{de.getEdge().setInResult(true);de=de.getNext();}while(de!=this.startDe);};jsts.geomgraph.EdgeRing.prototype.mergeLabel=function(deLabel){this.mergeLabel2(deLabel,0);this.mergeLabel2(deLabel,1);};jsts.geomgraph.EdgeRing.prototype.mergeLabel2=function(deLabel,geomIndex){var loc=deLabel.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(loc==jsts.geom.Location.NONE)
return;if(this.label.getLocation(geomIndex)===jsts.geom.Location.NONE){this.label.setLocation(geomIndex,loc);return;}};jsts.geomgraph.EdgeRing.prototype.addPoints=function(edge,isForward,isFirstEdge){var edgePts=edge.getCoordinates();if(isForward){var startIndex=1;if(isFirstEdge)
startIndex=0;for(var i=startIndex;i<edgePts.length;i++){this.pts.push(edgePts[i]);}}else{var startIndex=edgePts.length-2;if(isFirstEdge)
startIndex=edgePts.length-1;for(var i=startIndex;i>=0;i--){this.pts.push(edgePts[i]);}}};jsts.geomgraph.EdgeRing.prototype.containsPoint=function(p){var shell=this.getLinearRing();var env=shell.getEnvelopeInternal();if(!env.contains(p))
return false;if(!jsts.algorithm.CGAlgorithms.isPointInRing(p,shell.getCoordinates()))
return false;for(var i=0;i<this.holes.length;i++){var hole=this.holes[i];if(hole.containsPoint(p))
return false;}
return true;};(function(){jsts.geom.LinearRing=function(points,factory){jsts.geom.LineString.apply(this,arguments);};jsts.geom.LinearRing.prototype=new jsts.geom.LineString();jsts.geom.LinearRing.constructor=jsts.geom.LinearRing;jsts.geom.LinearRing.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE;};jsts.geom.LinearRing.prototype.isSimple=function(){return true;};jsts.geom.LinearRing.prototype.getGeometryType=function(){return'LinearRing';};jsts.geom.LinearRing.MINIMUM_VALID_SIZE=4;jsts.geom.LinearRing.prototype.CLASS_NAME='jsts.geom.LinearRing';})();jsts.index.strtree.Boundable=function(){};jsts.index.strtree.Boundable.prototype.getBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode=function(level){this.level=level;this.childBoundables=[];};jsts.index.strtree.AbstractNode.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.AbstractNode.constructor=jsts.index.strtree.AbstractNode;jsts.index.strtree.AbstractNode.prototype.childBoundables=null;jsts.index.strtree.AbstractNode.prototype.bounds=null;jsts.index.strtree.AbstractNode.prototype.level=null;jsts.index.strtree.AbstractNode.prototype.getChildBoundables=function(){return this.childBoundables;};jsts.index.strtree.AbstractNode.prototype.computeBounds=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractNode.prototype.getBounds=function(){if(this.bounds===null){this.bounds=this.computeBounds();}
return this.bounds;};jsts.index.strtree.AbstractNode.prototype.getLevel=function(){return this.level;};jsts.index.strtree.AbstractNode.prototype.addChildBoundable=function(childBoundable){this.childBoundables.push(childBoundable);};(function(){jsts.noding.Noder=function(){};jsts.noding.Noder.prototype.computeNodes=jsts.abstractFunc;jsts.noding.Noder.prototype.getNodedSubstrings=jsts.abstractFunc;})();(function(){var Noder=jsts.noding.Noder;jsts.noding.SinglePassNoder=function(){};jsts.noding.SinglePassNoder.prototype=new Noder();jsts.noding.SinglePassNoder.constructor=jsts.noding.SinglePassNoder;jsts.noding.SinglePassNoder.prototype.segInt=null;jsts.noding.SinglePassNoder.prototype.setSegmentIntersector=function(segInt){this.segInt=segInt;};})();jsts.index.SpatialIndex=function(){};jsts.index.SpatialIndex.prototype.insert=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.query=function(searchEnv,visitor){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.SpatialIndex.prototype.remove=function(itemEnv,item){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree=function(nodeCapacity){if(nodeCapacity===undefined)
return;this.itemBoundables=[];jsts.util.Assert.isTrue(nodeCapacity>1,'Node capacity must be greater than 1');this.nodeCapacity=nodeCapacity;};jsts.index.strtree.AbstractSTRtree.IntersectsOp=function(){};jsts.index.strtree.AbstractSTRtree.IntersectsOp.prototype.intersects=function(aBounds,bBounds){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.root=null;jsts.index.strtree.AbstractSTRtree.prototype.built=false;jsts.index.strtree.AbstractSTRtree.prototype.itemBoundables=null;jsts.index.strtree.AbstractSTRtree.prototype.nodeCapacity=null;jsts.index.strtree.AbstractSTRtree.prototype.build=function(){jsts.util.Assert.isTrue(!this.built);this.root=this.itemBoundables.length===0?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1);this.built=true;};jsts.index.strtree.AbstractSTRtree.prototype.createNode=function(level){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var parentBoundables=[];parentBoundables.push(this.createNode(newLevel));var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.getComparator());for(var i=0;i<sortedChildBoundables.length;i++){var childBoundable=sortedChildBoundables[i];if(this.lastNode(parentBoundables).getChildBoundables().length===this.getNodeCapacity()){parentBoundables.push(this.createNode(newLevel));}
this.lastNode(parentBoundables).addChildBoundable(childBoundable);}
return parentBoundables;};jsts.index.strtree.AbstractSTRtree.prototype.lastNode=function(nodes){return nodes[nodes.length-1];};jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles=function(a,b){return a>b?1:a<b?-1:0;};jsts.index.strtree.AbstractSTRtree.prototype.createHigherLevels=function(boundablesOfALevel,level){jsts.util.Assert.isTrue(!(boundablesOfALevel.length===0));var parentBoundables=this.createParentBoundables(boundablesOfALevel,level+1);if(parentBoundables.length===1){return parentBoundables[0];}
return this.createHigherLevels(parentBoundables,level+1);};jsts.index.strtree.AbstractSTRtree.prototype.getRoot=function(){if(!this.built)
this.build();return this.root;};jsts.index.strtree.AbstractSTRtree.prototype.getNodeCapacity=function(){return this.nodeCapacity;};jsts.index.strtree.AbstractSTRtree.prototype.size=function(){if(arguments.length===1){return this.size2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.size2(root);};jsts.index.strtree.AbstractSTRtree.prototype.size2=function(node){var size=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){size+=this.size(childBoundable);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){size+=1;}}
return size;};jsts.index.strtree.AbstractSTRtree.prototype.depth=function(){if(arguments.length===1){return this.depth2(arguments[0]);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){return 0;}
return this.depth2(root);};jsts.index.strtree.AbstractSTRtree.prototype.depth2=function(){var maxChildDepth=0;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var childDepth=this.depth(childBoundable);if(childDepth>maxChildDepth)
maxChildDepth=childDepth;}}
return maxChildDepth+1;};jsts.index.strtree.AbstractSTRtree.prototype.insert=function(bounds,item){jsts.util.Assert.isTrue(!this.built,'Cannot insert items into an STR packed R-tree after it has been built.');this.itemBoundables.push(new jsts.index.strtree.ItemBoundable(bounds,item));};jsts.index.strtree.AbstractSTRtree.prototype.query=function(searchBounds){if(arguments.length>1){this.query2.apply(this,arguments);}
if(!this.built){this.build();}
var matches=[];if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);return matches;}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query3(searchBounds,this.root,matches);}
return matches;};jsts.index.strtree.AbstractSTRtree.prototype.query2=function(searchBounds,visitor){if(arguments.length>2){this.query3.apply(this,arguments);}
if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()===null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){this.query4(searchBounds,this.root,visitor);}};jsts.index.strtree.AbstractSTRtree.prototype.query3=function(searchBounds,node,matches){if(!(arguments[2]instanceof Array)){this.query4.apply(this,arguments);}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query3(searchBounds,childBoundable,matches);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){matches.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.query4=function(searchBounds,node,visitor){var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){this.query4(searchBounds,childBoundable,visitor);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){visitor.visitItem(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}};jsts.index.strtree.AbstractSTRtree.prototype.getIntersectsOp=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree=function(){if(arguments.length===1){return this.itemsTree2.apply(this,arguments);}
if(!this.built){this.build();}
var valuesTree=this.itemsTree2(this.root);if(valuesTree===null)
return[];return valuesTree;};jsts.index.strtree.AbstractSTRtree.prototype.itemsTree2=function(node){var valuesTreeForNode=[];var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.AbstractNode){var valuesTreeForChild=this.itemsTree(childBoundable);if(valuesTreeForChild!=null)
valuesTreeForNode.push(valuesTreeForChild);}else if(childBoundable instanceof jsts.index.strtree.ItemBoundable){valuesTreeForNode.push(childBoundable.getItem());}else{jsts.util.Assert.shouldNeverReachHere();}}
if(valuesTreeForNode.length<=0)
return null;return valuesTreeForNode;};jsts.index.strtree.AbstractSTRtree.prototype.remove=function(searchBounds,item){if(!this.built){this.build();}
if(this.itemBoundables.length===0){jsts.util.Assert.isTrue(this.root.getBounds()==null);}
if(this.getIntersectsOp().intersects(this.root.getBounds(),searchBounds)){return this.remove2(searchBounds,this.root,item);}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.remove2=function(searchBounds,node,item){var found=this.removeItem(node,item);if(found)
return true;var childToPrune=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(!this.getIntersectsOp().intersects(childBoundable.getBounds(),searchBounds)){continue;}
if(childBoundable instanceof jsts.index.strtree.AbstractNode){found=this.remove(searchBounds,childBoundable,item);if(found){childToPrune=childBoundable;break;}}}
if(childToPrune!=null){if(childToPrune.getChildBoundables().length===0){childBoundables.splice(childBoundables.indexOf(childToPrune),1);}}
return found;};jsts.index.strtree.AbstractSTRtree.prototype.removeItem=function(node,item){var childToRemove=null;var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(childBoundable instanceof jsts.index.strtree.ItemBoundable){if(childBoundable.getItem()===item)
childToRemove=childBoundable;}}
if(childToRemove!==null){childBoundables.splice(childBoundables.indexOf(childToRemove),1);return true;}
return false;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel=function(level){if(arguments.length>1){this.boundablesAtLevel2.apply(this,arguments);return;}
var boundables=[];this.boundablesAtLevel2(level,this.root,boundables);return boundables;};jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel2=function(level,top,boundables){jsts.util.Assert.isTrue(level>-2);if(top.getLevel()===level){boundables.add(top);return;}
var childBoundables=node.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var boundable=childBoundables[i];if(boundable instanceof jsts.index.strtree.AbstractNode){this.boundablesAtLevel(level,boundable,boundables);}else{jsts.util.Assert.isTrue(boundable instanceof jsts.index.strtree.ItemBoundable);if(level===-1){boundables.add(boundable);}}}
return;};jsts.index.strtree.AbstractSTRtree.prototype.getComparator=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.index.strtree.STRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.STRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.STRtree.constructor=jsts.index.strtree.STRtree;jsts.index.strtree.STRtree.prototype.xComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreX(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreX(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.yComparator=function(o1,o2){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreY(o1.getBounds()),jsts.index.strtree.STRtree.prototype.centreY(o2.getBounds()));};jsts.index.strtree.STRtree.prototype.centreX=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinX(),e.getMaxX());};jsts.index.strtree.STRtree.prototype.centreY=function(e){return jsts.index.strtree.STRtree.prototype.avg(e.getMinY(),e.getMaxY());};jsts.index.strtree.STRtree.prototype.avg=function(a,b){return(a+b)/2.0;};jsts.index.strtree.STRtree.prototype.intersectsOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.STRtree.prototype.createParentBoundables=function(childBoundables,newLevel){jsts.util.Assert.isTrue(!(childBoundables.length===0));var minLeafCount=Math.ceil(childBoundables.length/this.getNodeCapacity());var sortedChildBoundables=[];for(var i=0;i<childBoundables.length;i++){sortedChildBoundables.push(childBoundables[i]);}
sortedChildBoundables.sort(this.xComparator);var verticalSlices=this.verticalSlices(sortedChildBoundables,Math.ceil(Math.sqrt(minLeafCount)));return this.createParentBoundablesFromVerticalSlices(verticalSlices,newLevel);};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlices=function(verticalSlices,newLevel){jsts.util.Assert.isTrue(verticalSlices.length>0);var parentBoundables=[];for(var i=0;i<verticalSlices.length;i++){parentBoundables=parentBoundables.concat(this.createParentBoundablesFromVerticalSlice(verticalSlices[i],newLevel));}
return parentBoundables;};jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlice=function(childBoundables,newLevel){return jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables.call(this,childBoundables,newLevel);};jsts.index.strtree.STRtree.prototype.verticalSlices=function(childBoundables,sliceCount){var sliceCapacity=Math.ceil(childBoundables.length/sliceCount);var slices=[];var i=0,boundablesAddedToSlice,childBoundable;for(var j=0;j<sliceCount;j++){slices[j]=[];boundablesAddedToSlice=0;while(i<childBoundables.length&&boundablesAddedToSlice<sliceCapacity){childBoundable=childBoundables[i++];slices[j].push(childBoundable);boundablesAddedToSlice++;}}
return slices;};jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY=10;jsts.index.strtree.STRtree.prototype.createNode=function(level){var abstractNode=new jsts.index.strtree.AbstractNode(level);abstractNode.computeBounds=function(){var bounds=null;var childBoundables=this.getChildBoundables();for(var i=0;i<childBoundables.length;i++){var childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.geom.Envelope(childBoundable.getBounds());}else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return abstractNode;};jsts.index.strtree.STRtree.prototype.getIntersectsOp=function(){return this.intersectsOp;};jsts.index.strtree.STRtree.prototype.insert=function(itemEnv,item){if(itemEnv.isNull()){return;}
jsts.index.strtree.AbstractSTRtree.prototype.insert.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.query=function(searchEnv,visitor){return jsts.index.strtree.AbstractSTRtree.prototype.query.apply(this,arguments);};jsts.index.strtree.STRtree.prototype.remove=function(itemEnv,item){return jsts.index.strtree.AbstractSTRtree.prototype.remove.call(this,itemEnv,item);};jsts.index.strtree.STRtree.prototype.size=function(){return jsts.index.strtree.AbstractSTRtree.prototype.size.call(this);};jsts.index.strtree.STRtree.prototype.depth=function(){return jsts.index.strtree.AbstractSTRtree.prototype.depth.call(this);};jsts.index.strtree.STRtree.prototype.getComparator=function(){return this.yComparator;};jsts.index.strtree.STRtree.prototype.nearestNeighbour=function(itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),this.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour2=function(env,item,itemDist){var bnd=new jsts.index.strtree.ItemBoundable(env,item);var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),bnd,itemDist);return this.nearestNeighbour4(bp)[0];};jsts.index.strtree.STRtree.prototype.nearestNeighbour3=function(tree,itemDist){var bp=new jsts.index.strtree.BoundablePair(this.getRoot(),tree.getRoot(),itemDist);return this.nearestNeighbour4(bp);};jsts.index.strtree.STRtree.prototype.nearestNeighbour4=function(initBndPair){return this.nearestNeighbour5(initBndPair,Double.POSITIVE_INFINITY);};jsts.index.strtree.STRtree.prototype.nearestNeighbour5=function(initBndPair,maxDistance){var distanceLowerBound=maxDistance;var minPair=null;var priQ=[];priQ.push(initBndPair);while(!priQ.isEmpty()&&distanceLowerBound>0.0){var bndPair=priQ.pop();var currentDistance=bndPair.getDistance();if(currentDistance>=distanceLowerBound)
break;if(bndPair.isLeaves()){distanceLowerBound=currentDistance;minPair=bndPair;}else{bndPair.expandToQueue(priQ,distanceLowerBound);}}
return[minPair.getBoundable(0).getItem(),minPair.getBoundable(1).getItem()];};jsts.noding.SegmentString=function(){};jsts.noding.SegmentString.prototype.getData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.setData=jsts.abstractFunc;jsts.noding.SegmentString.prototype.size=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinate=jsts.abstractFunc;jsts.noding.SegmentString.prototype.getCoordinates=jsts.abstractFunc;jsts.noding.SegmentString.prototype.isClosed=jsts.abstractFunc;jsts.noding.NodableSegmentString=function(){};jsts.noding.NodableSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.NodableSegmentString.prototype.addIntersection=jsts.abstractFunc;jsts.noding.NodedSegmentString=function(pts,data){this.nodeList=new jsts.noding.SegmentNodeList(this);this.pts=pts;this.data=data;};jsts.noding.NodedSegmentString.prototype=new jsts.noding.NodableSegmentString();jsts.noding.NodedSegmentString.constructor=jsts.noding.NodedSegmentString;jsts.noding.NodedSegmentString.getNodedSubstrings=function(segStrings){if(arguments.length===2){jsts.noding.NodedSegmentString.getNodedSubstrings2.apply(this,arguments);return;}
var resultEdgelist=new javascript.util.ArrayList();jsts.noding.NodedSegmentString.getNodedSubstrings2(segStrings,resultEdgelist);return resultEdgelist;};jsts.noding.NodedSegmentString.getNodedSubstrings2=function(segStrings,resultEdgelist){for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();ss.getNodeList().addSplitEdges(resultEdgelist);}};jsts.noding.NodedSegmentString.prototype.nodeList=null;jsts.noding.NodedSegmentString.prototype.pts=null;jsts.noding.NodedSegmentString.prototype.data=null;jsts.noding.NodedSegmentString.prototype.getData=function(){return this.data;};jsts.noding.NodedSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.NodedSegmentString.prototype.getNodeList=function(){return this.nodeList;};jsts.noding.NodedSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.NodedSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.NodedSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.NodedSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.NodedSegmentString.prototype.getSegmentOctant=function(index){if(index===this.pts.length-1)
return-1;return this.safeOctant(this.getCoordinate(index),this.getCoordinate(index+1));};jsts.noding.NodedSegmentString.prototype.safeOctant=function(p0,p1){if(p0.equals2D(p1))
return 0;return jsts.noding.Octant.octant(p0,p1);};jsts.noding.NodedSegmentString.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.noding.NodedSegmentString.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){if(li instanceof jsts.geom.Coordinate){this.addIntersection2.apply(this,arguments);return;}
var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));this.addIntersection2(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersection2=function(intPt,segmentIndex){this.addIntersectionNode(intPt,segmentIndex);};jsts.noding.NodedSegmentString.prototype.addIntersectionNode=function(intPt,segmentIndex){var normalizedSegmentIndex=segmentIndex;var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;}}
var ei=this.nodeList.add(intPt,normalizedSegmentIndex);return ei;};jsts.noding.NodedSegmentString.prototype.toString=function(){var geometryFactory=new jsts.geom.GeometryFactory();return new jsts.io.WKTWriter().write(geometryFactory.createLineString(this.pts));};jsts.index.chain.MonotoneChainBuilder=function(){};jsts.index.chain.MonotoneChainBuilder.toIntArray=function(list){var array=[];for(var i=0;i<list.length;i++){array[i]=list[i];}
return array;};jsts.index.chain.MonotoneChainBuilder.getChains=function(pts){if(arguments.length===2){return jsts.index.chain.MonotoneChainBuilder.getChains2.apply(this,arguments);}
return jsts.index.chain.MonotoneChainBuilder.getChains2(pts,null);};jsts.index.chain.MonotoneChainBuilder.getChains2=function(pts,context){var mcList=[];var startIndex=jsts.index.chain.MonotoneChainBuilder.getChainStartIndices(pts);for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.index.chain.MonotoneChain(pts,startIndex[i],startIndex[i+1],context);mcList.push(mc);}
return mcList;};jsts.index.chain.MonotoneChainBuilder.getChainStartIndices=function(pts){var start=0;var startIndexList=[];startIndexList.push(start);do{var last=jsts.index.chain.MonotoneChainBuilder.findChainEnd(pts,start);startIndexList.push(last);start=last;}while(start<pts.length-1);var startIndex=jsts.index.chain.MonotoneChainBuilder.toIntArray(startIndexList);return startIndex;};jsts.index.chain.MonotoneChainBuilder.findChainEnd=function(pts,start){var safeStart=start;while(safeStart<pts.length-1&&pts[safeStart].equals2D(pts[safeStart+1])){safeStart++;}
if(safeStart>=pts.length-1){return pts.length-1;}
var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[safeStart],pts[safeStart+1]);var last=start+1;while(last<pts.length){if(!pts[last-1].equals2D(pts[last])){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!==chainQuad)
break;}
last++;}
return last-1;};jsts.algorithm.LineIntersector=function(){this.inputLines=[[],[]];this.intPt=[null,null];this.pa=this.intPt[0];this.pb=this.intPt[1];this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.NO_INTERSECTION=0;jsts.algorithm.LineIntersector.POINT_INTERSECTION=1;jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION=2;jsts.algorithm.LineIntersector.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.algorithm.LineIntersector.prototype.getEndpoint=function(segmentIndex,ptIndex){return this.inputLines[segmentIndex][ptIndex];};jsts.algorithm.LineIntersector.computeEdgeDistance=function(p,p0,p1){var dx=Math.abs(p1.x-p0.x);var dy=Math.abs(p1.y-p0.y);var dist=-1.0;if(p.equals(p0)){dist=0.0;}else if(p.equals(p1)){if(dx>dy){dist=dx;}else{dist=dy;}}else{var pdx=Math.abs(p.x-p0.x);var pdy=Math.abs(p.y-p0.y);if(dx>dy){dist=pdx;}else{dist=pdy;}
if(dist===0.0&&!p.equals(p0)){dist=Math.max(pdx,pdy);}}
if(dist===0.0&&!p.equals(p0)){throw new jsts.error.IllegalArgumentError('Bad distance calculation');}
return dist;};jsts.algorithm.LineIntersector.nonRobustComputeEdgeDistance=function(p,p1,p2){var dx=p.x-p1.x;var dy=p.y-p1.y;var dist=Math.sqrt(dx*dx+dy*dy);if(!(dist===0.0&&!p.equals(p1))){throw new jsts.error.IllegalArgumentError('Invalid distance calculation');}
return dist;};jsts.algorithm.LineIntersector.prototype.result=null;jsts.algorithm.LineIntersector.prototype.inputLines=null;jsts.algorithm.LineIntersector.prototype.intPt=null;jsts.algorithm.LineIntersector.prototype.intLineIndex=null;jsts.algorithm.LineIntersector.prototype._isProper=null;jsts.algorithm.LineIntersector.prototype.pa=null;jsts.algorithm.LineIntersector.prototype.pb=null;jsts.algorithm.LineIntersector.prototype.precisionModel=null;jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p,p1,p2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isCollinear=function(){return this.result===jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.computeIntersection=function(p1,p2,p3,p4){this.inputLines[0][0]=p1;this.inputLines[0][1]=p2;this.inputLines[1][0]=p3;this.inputLines[1][1]=p4;this.result=this.computeIntersect(p1,p2,p3,p4);};jsts.algorithm.LineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.LineIntersector.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper;};jsts.algorithm.LineIntersector.prototype.hasIntersection=function(){return this.result!==jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.LineIntersector.prototype.getIntersectionNum=function(){return this.result;};jsts.algorithm.LineIntersector.prototype.getIntersection=function(intIndex){return this.intPt[intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(){if(this.intLineIndex===null){this.intLineIndex=[[],[]];this.computeIntLineIndex(0);this.computeIntLineIndex(1);}};jsts.algorithm.LineIntersector.prototype.isIntersection=function(pt){var i;for(i=0;i<this.result;i++){if(this.intPt[i].equals2D(pt)){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection=function(){if(arguments.length===1){return this.isInteriorIntersection2.apply(this,arguments);}
if(this.isInteriorIntersection(0)){return true;}
if(this.isInteriorIntersection(1)){return true;}
return false;};jsts.algorithm.LineIntersector.prototype.isInteriorIntersection2=function(inputLineIndex){var i;for(i=0;i<this.result;i++){if(!(this.intPt[i].equals2D(this.inputLines[inputLineIndex][0])||this.intPt[i].equals2D(this.inputLines[inputLineIndex][1]))){return true;}}
return false;};jsts.algorithm.LineIntersector.prototype.isProper=function(){return this.hasIntersection()&&this._isProper;};jsts.algorithm.LineIntersector.prototype.getIntersectionAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intPt[intLineIndex[segmentIndex][intIndex]];};jsts.algorithm.LineIntersector.prototype.getIndexAlongSegment=function(segmentIndex,intIndex){this.computeIntLineIndex();return this.intLineIndex[segmentIndex][intIndex];};jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(segmentIndex){var dist0=this.getEdgeDistance(segmentIndex,0);var dist1=this.getEdgeDistance(segmentIndex,1);if(dist0>dist1){this.intLineIndex[segmentIndex][0]=0;this.intLineIndex[segmentIndex][1]=1;}else{this.intLineIndex[segmentIndex][0]=1;this.intLineIndex[segmentIndex][1]=0;}};jsts.algorithm.LineIntersector.prototype.getEdgeDistance=function(segmentIndex,intIndex){var dist=jsts.algorithm.LineIntersector.computeEdgeDistance(this.intPt[intIndex],this.inputLines[segmentIndex][0],this.inputLines[segmentIndex][1]);return dist;};jsts.algorithm.RobustLineIntersector=function(){jsts.algorithm.RobustLineIntersector.prototype.constructor.call(this);};jsts.algorithm.RobustLineIntersector.prototype=new jsts.algorithm.LineIntersector();jsts.algorithm.RobustLineIntersector.prototype.computeIntersection=function(p,p1,p2){if(arguments.length===4){jsts.algorithm.LineIntersector.prototype.computeIntersection.apply(this,arguments);return;}
this._isProper=false;if(jsts.geom.Envelope.intersects(p1,p2,p)){if((jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,p)===0)&&(jsts.algorithm.CGAlgorithms.orientationIndex(p2,p1,p)===0)){this._isProper=true;if(p.equals(p1)||p.equals(p2)){this._isProper=false;}
this.result=jsts.algorithm.LineIntersector.POINT_INTERSECTION;return;}}
this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeIntersect=function(p1,p2,q1,q2){this._isProper=false;if(!jsts.geom.Envelope.intersects(p1,p2,q1,q2)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Pq1=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q1);var Pq2=jsts.algorithm.CGAlgorithms.orientationIndex(p1,p2,q2);if((Pq1>0&&Pq2>0)||(Pq1<0&&Pq2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var Qp1=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p1);var Qp2=jsts.algorithm.CGAlgorithms.orientationIndex(q1,q2,p2);if((Qp1>0&&Qp2>0)||(Qp1<0&&Qp2<0)){return jsts.algorithm.LineIntersector.NO_INTERSECTION;}
var collinear=Pq1===0&&Pq2===0&&Qp1===0&&Qp2===0;if(collinear){return this.computeCollinearIntersection(p1,p2,q1,q2);}
if(Pq1===0||Pq2===0||Qp1===0||Qp2===0){this._isProper=false;if(p1.equals2D(q1)||p1.equals2D(q2)){this.intPt[0]=p1;}else if(p2.equals2D(q1)||p2.equals2D(q2)){this.intPt[0]=p2;}
else if(Pq1===0){this.intPt[0]=new jsts.geom.Coordinate(q1);}else if(Pq2===0){this.intPt[0]=new jsts.geom.Coordinate(q2);}else if(Qp1===0){this.intPt[0]=new jsts.geom.Coordinate(p1);}else if(Qp2===0){this.intPt[0]=new jsts.geom.Coordinate(p2);}}else{this._isProper=true;this.intPt[0]=this.intersection(p1,p2,q1,q2);}
return jsts.algorithm.LineIntersector.POINT_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.computeCollinearIntersection=function(p1,p2,q1,q2){var p1q1p2=jsts.geom.Envelope.intersects(p1,p2,q1);var p1q2p2=jsts.geom.Envelope.intersects(p1,p2,q2);var q1p1q2=jsts.geom.Envelope.intersects(q1,q2,p1);var q1p2q2=jsts.geom.Envelope.intersects(q1,q2,p2);if(p1q1p2&&p1q2p2){this.intPt[0]=q1;this.intPt[1]=q2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(q1p1q2&&q1p2q2){this.intPt[0]=p1;this.intPt[1]=p2;return jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p1q2){this.intPt[0]=q1;this.intPt[1]=p1;return q1.equals(p1)&&!p1q2p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q1p2&&q1p2q2){this.intPt[0]=q1;this.intPt[1]=p2;return q1.equals(p2)&&!p1q2p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p1q2){this.intPt[0]=q2;this.intPt[1]=p1;return q2.equals(p1)&&!p1q1p2&&!q1p2q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
if(p1q2p2&&q1p2q2){this.intPt[0]=q2;this.intPt[1]=p2;return q2.equals(p2)&&!p1q1p2&&!q1p1q2?jsts.algorithm.LineIntersector.POINT_INTERSECTION:jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION;}
return jsts.algorithm.LineIntersector.NO_INTERSECTION;};jsts.algorithm.RobustLineIntersector.prototype.intersection=function(p1,p2,q1,q2){var intPt=this.intersectionWithNormalization(p1,p2,q1,q2);if(!this.isInSegmentEnvelopes(intPt)){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}
if(this.precisionModel!==null){this.precisionModel.makePrecise(intPt);}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.intersectionWithNormalization=function(p1,p2,q1,q2){var n1=new jsts.geom.Coordinate(p1);var n2=new jsts.geom.Coordinate(p2);var n3=new jsts.geom.Coordinate(q1);var n4=new jsts.geom.Coordinate(q2);var normPt=new jsts.geom.Coordinate();this.normalizeToEnvCentre(n1,n2,n3,n4,normPt);var intPt=this.safeHCoordinateIntersection(n1,n2,n3,n4);intPt.x+=normPt.x;intPt.y+=normPt.y;return intPt;};jsts.algorithm.RobustLineIntersector.prototype.safeHCoordinateIntersection=function(p1,p2,q1,q2){var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(p1,p2,q1,q2);}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=jsts.algorithm.CentralEndpointIntersector.getIntersection(p1,p2,q1,q2);}else{throw e;}}
return intPt;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToMinimum=function(n1,n2,n3,n4,normPt){normPt.x=this.smallestInAbsValue(n1.x,n2.x,n3.x,n4.x);normPt.y=this.smallestInAbsValue(n1.y,n2.y,n3.y,n4.y);n1.x-=normPt.x;n1.y-=normPt.y;n2.x-=normPt.x;n2.y-=normPt.y;n3.x-=normPt.x;n3.y-=normPt.y;n4.x-=normPt.x;n4.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.normalizeToEnvCentre=function(n00,n01,n10,n11,normPt){var minX0=n00.x<n01.x?n00.x:n01.x;var minY0=n00.y<n01.y?n00.y:n01.y;var maxX0=n00.x>n01.x?n00.x:n01.x;var maxY0=n00.y>n01.y?n00.y:n01.y;var minX1=n10.x<n11.x?n10.x:n11.x;var minY1=n10.y<n11.y?n10.y:n11.y;var maxX1=n10.x>n11.x?n10.x:n11.x;var maxY1=n10.y>n11.y?n10.y:n11.y;var intMinX=minX0>minX1?minX0:minX1;var intMaxX=maxX0<maxX1?maxX0:maxX1;var intMinY=minY0>minY1?minY0:minY1;var intMaxY=maxY0<maxY1?maxY0:maxY1;var intMidX=(intMinX+intMaxX)/2.0;var intMidY=(intMinY+intMaxY)/2.0;normPt.x=intMidX;normPt.y=intMidY;n00.x-=normPt.x;n00.y-=normPt.y;n01.x-=normPt.x;n01.y-=normPt.y;n10.x-=normPt.x;n10.y-=normPt.y;n11.x-=normPt.x;n11.y-=normPt.y;};jsts.algorithm.RobustLineIntersector.prototype.smallestInAbsValue=function(x1,x2,x3,x4){var x=x1;var xabs=Math.abs(x);if(Math.abs(x2)<xabs){x=x2;xabs=Math.abs(x2);}
if(Math.abs(x3)<xabs){x=x3;xabs=Math.abs(x3);}
if(Math.abs(x4)<xabs){x=x4;}
return x;};jsts.algorithm.RobustLineIntersector.prototype.isInSegmentEnvelopes=function(intPt){var env0=new jsts.geom.Envelope(this.inputLines[0][0],this.inputLines[0][1]);var env1=new jsts.geom.Envelope(this.inputLines[1][0],this.inputLines[1][1]);return env0.contains(intPt)&&env1.contains(intPt);};jsts.algorithm.HCoordinate=function(){this.x=0.0;this.y=0.0;this.w=1.0;if(arguments.length===1){this.initFrom1Coordinate(arguments[0]);}else if(arguments.length===2&&arguments[0]instanceof jsts.geom.Coordinate){this.initFrom2Coordinates(arguments[0],arguments[1]);}else if(arguments.length===2&&arguments[0]instanceof jsts.algorithm.HCoordinate){this.initFrom2HCoordinates(arguments[0],arguments[1]);}else if(arguments.length===2){this.initFromXY(arguments[0],arguments[1]);}else if(arguments.length===3){this.initFromXYW(arguments[0],arguments[1],arguments[2]);}else if(arguments.length===4){this.initFromXYW(arguments[0],arguments[1],arguments[2],arguments[3]);}};jsts.algorithm.HCoordinate.intersection=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw,x,y,w,xInt,yInt;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;x=py*qw-qy*pw;y=qx*pw-px*qw;w=px*qy-qx*py;xInt=x/w;yInt=y/w;if(!isFinite(xInt)||!isFinite(yInt)){throw new jsts.error.NotRepresentableError();}
return new jsts.geom.Coordinate(xInt,yInt);};jsts.algorithm.HCoordinate.prototype.initFrom1Coordinate=function(p){this.x=p.x;this.y=p.y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom2Coordinates=function(p1,p2){this.x=p1.y-p2.y;this.y=p2.x-p1.x;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFrom2HCoordinates=function(p1,p2){this.x=p1.y*p2.w-p2.y*p1.w;this.y=p2.x*p1.w-p1.x*p2.w;this.w=p1.x*p2.y-p2.x*p1.y;};jsts.algorithm.HCoordinate.prototype.initFromXYW=function(x,y,w){this.x=x;this.y=y;this.w=w;};jsts.algorithm.HCoordinate.prototype.initFromXY=function(x,y){this.x=x;this.y=y;this.w=1.0;};jsts.algorithm.HCoordinate.prototype.initFrom4Coordinates=function(p1,p2,q1,q2){var px,py,pw,qx,qy,qw;px=p1.y-p2.y;py=p2.x-p1.x;pw=p1.x*p2.y-p2.x*p1.y;qx=q1.y-q2.y;qy=q2.x-q1.x;qw=q1.x*q2.y-q2.x*q1.y;this.x=py*qw-qy*pw;this.y=qx*pw-px*qw;this.w=px*qy-qx*py;};jsts.algorithm.HCoordinate.prototype.getX=function(){var a=this.x/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getY=function(){var a=this.y/this.w;if(!isFinite(a)){throw new jsts.error.NotRepresentableError();}
return a;};jsts.algorithm.HCoordinate.prototype.getCoordinate=function(){var p=new jsts.geom.Coordinate();p.x=this.getX();p.y=this.getY();return p;};jsts.geom.LineSegment=function(){if(arguments.length===0){this.p0=new jsts.geom.Coordinate();this.p1=new jsts.geom.Coordinate();}else if(arguments.length===1){this.p0=arguments[0].p0;this.p1=arguments[0].p1;}else if(arguments.length===2){this.p0=arguments[0];this.p1=arguments[1];}else if(arguments.length===4){this.p0=new jsts.geom.Coordinate(arguments[0],arguments[1]);this.p1=new jsts.geom.Coordinate(arguments[2],arguments[3]);}};jsts.geom.LineSegment.prototype.p0=null;jsts.geom.LineSegment.prototype.p1=null;jsts.geom.LineSegment.midPoint=function(p0,p1){return new jsts.geom.Coordinate((p0.x+p1.x)/2,(p0.y+p1.y)/2);};jsts.geom.LineSegment.prototype.getCoordinate=function(i){if(i===0)return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.getLength=function(){return this.p0.distance(this.p1);};jsts.geom.LineSegment.prototype.isHorizontal=function(){return this.p0.y===this.p1.y;};jsts.geom.LineSegment.prototype.isVertical=function(){return this.p0.x===this.p1.x;};jsts.geom.LineSegment.prototype.orientationIndex=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.orientationIndex1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.orientationIndex2(arg);}};jsts.geom.LineSegment.prototype.orientationIndex1=function(seg){var orient0=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p0);var orient1=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,seg.p1);if(orient0>=0&&orient1>=0){return Math.max(orient0,orient1);}
if(orient0<=0&&orient1<=0){return Math.max(orient0,orient1);}
return 0;};jsts.geom.LineSegment.prototype.orientationIndex2=function(p){return jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,p);};jsts.geom.LineSegment.prototype.reverse=function(){var temp=this.p0;this.p0=this.p1;this.p1=temp;};jsts.geom.LineSegment.prototype.normalize=function(){if(this.p1.compareTo(this.p0)<0)this.reverse();};jsts.geom.LineSegment.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x);};jsts.geom.LineSegment.prototype.midPoint=function(){return jsts.geom.LineSegment.midPoint(this.p0,this.p1);};jsts.geom.LineSegment.prototype.distance=function(arg){if(arg instanceof jsts.geom.LineSegment){return this.distance1(arg);}else if(arg instanceof jsts.geom.Coordinate){return this.distance2(arg);}};jsts.geom.LineSegment.prototype.distance1=function(ls){return jsts.algorithm.CGAlgorithms.distanceLineLine(this.p0,this.p1,ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.distance2=function(p){return jsts.algorithm.CGAlgorithms.distancePointLine(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.pointAlong=function(segmentLengthFraction){var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);coord.y=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.pointAlongOffset=function(segmentLengthFraction,offsetDistance){var segx=this.p0.x+segmentLengthFraction*(this.p1.x-this.p0.x);var segy=this.p0.y+segmentLengthFraction*(this.p1.y-this.p0.y);var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=0;var uy=0;if(offsetDistance!==0){if(len<=0){throw"Cannot compute offset from zero-length line segment";}
ux=offsetDistance*dx/len;uy=offsetDistance*dy/len;}
var offsetx=segx-uy;var offsety=segy+ux;var coord=new jsts.geom.Coordinate(offsetx,offsety);return coord;};jsts.geom.LineSegment.prototype.projectionFactor=function(p){if(p.equals(this.p0))
return 0.0;if(p.equals(this.p1))
return 1.0;var dx=this.p1.x-this.p0.x;var dy=this.p1.y-this.p0.y;var len2=dx*dx+dy*dy;var r=((p.x-this.p0.x)*dx+(p.y-this.p0.y)*dy)/len2;return r;};jsts.geom.LineSegment.prototype.segmentFraction=function(inputPt){var segFrac=this.projectionFactor(inputPt);if(segFrac<0){segFrac=0;}else if(segFrac>1||isNaN(segFrac)){segFrac=1;}
return segFrac;};jsts.geom.LineSegment.prototype.project=function(arg){if(arg instanceof jsts.geom.Coordinate){return this.project1(arg);}else if(arg instanceof jsts.geom.LineSegment){return this.project2(arg);}};jsts.geom.LineSegment.prototype.project1=function(p){if(p.equals(this.p0)||p.equals(this.p1)){return new jsts.geom.Coordinate(p);}
var r=this.projectionFactor(p);var coord=new jsts.geom.Coordinate();coord.x=this.p0.x+r*(this.p1.x-this.p0.x);coord.y=this.p0.y+r*(this.p1.y-this.p0.y);return coord;};jsts.geom.LineSegment.prototype.project2=function(seg){var pf0=this.projectionFactor(seg.p0);var pf1=this.projectionFactor(seg.p1);if(pf0>=1&&pf1>=1)return null;if(pf0<=0&&pf1<=0)return null;var newp0=this.project(seg.p0);if(pf0<0)newp0=p0;if(pf0>1)newp0=p1;var newp1=this.project(seg.p1);if(pf1<0.0)newp1=p0;if(pf1>1.0)newp1=p1;return new jsts.geom.LineSegment(newp0,newp1);};jsts.geom.LineSegment.prototype.closestPoint=function(p){var factor=this.projectionFactor(p);if(factor>0&&factor<1){return this.project(p);}
var dist0=this.p0.distance(p);var dist1=this.p1.distance(p);if(dist0<dist1)
return this.p0;return this.p1;};jsts.geom.LineSegment.prototype.closestPoints=function(line){var intPt=this.intersection(line);if(intPt!==null){return[intPt,intPt];}
var closestPt=[];var minDistance=Number.MAX_VALUE;var dist;var close00=this.closestPoint(line.p0);minDistance=close00.distance(line.p0);closestPt[0]=close00;closestPt[1]=line.p0;var close01=this.closestPoint(line.p1);dist=close01.distance(line.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=close01;closestPt[1]=line.p1;}
var close10=line.closestPoint(this.p0);dist=close10.distance(this.p0);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p0;closestPt[1]=close10;}
var close11=line.closestPoint(this.p1);dist=close11.distance(this.p1);if(dist<minDistance){minDistance=dist;closestPt[0]=this.p1;closestPt[1]=close11;}
return closestPt;};jsts.geom.LineSegment.prototype.intersection=function(line){var li=new jsts.algorithm.RobustLineIntersector();li.computeIntersection(this.p0,this.p1,line.p0,line.p1);if(li.hasIntersection())
return li.getIntersection(0);return null;};jsts.geom.LineSegment.prototype.setCoordinates=function(ls){if(ls instanceof jsts.geom.Coordinate){this.setCoordinates2.apply(this,arguments);return;}
this.setCoordinates2(ls.p0,ls.p1);};jsts.geom.LineSegment.prototype.setCoordinates2=function(p0,p1){this.p0.x=p0.x;this.p0.y=p0.y;this.p1.x=p1.x;this.p1.y=p1.y;};jsts.geom.LineSegment.prototype.distancePerpendicular=function(p){return jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular(p,this.p0,this.p1);};jsts.geom.LineSegment.prototype.lineIntersection=function(line){try{var intPt=jsts.algorithm.HCoordinate.intersection(this.p0,this.p1,line.p0,line.p1);return intPt;}catch(ex){}
return null;};jsts.geom.LineSegment.prototype.toGeometry=function(geomFactory){return geomFactory.createLineString([this.p0,this.p1]);};jsts.geom.LineSegment.prototype.equals=function(o){if(!(o instanceof jsts.geom.LineSegment)){return false;}
return this.p0.equals(o.p0)&&this.p1.equals(o.p1);};jsts.geom.LineSegment.prototype.compareTo=function(o){var comp0=this.p0.compareTo(o.p0);if(comp0!==0)return comp0;return this.p1.compareTo(o.p1);};jsts.geom.LineSegment.prototype.equalsTopo=function(other){return this.p0.equals(other.p0)&&this.p1.equals(other.p1)||this.p0.equals(other.p1)&&this.p1.equals(other.p0);};jsts.geom.LineSegment.prototype.toString=function(){return"LINESTRING("+
this.p0.x+" "+this.p0.y
+", "+
this.p1.x+" "+this.p1.y+")";};jsts.index.chain.MonotoneChainOverlapAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.tempEnv2=new jsts.geom.Envelope();this.overlapSeg1=new jsts.geom.LineSegment();this.overlapSeg2=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg1=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg2=null;jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){this.mc1.getLineSegment(start1,this.overlapSeg1);this.mc2.getLineSegment(start2,this.overlapSeg2);this.overlap2(this.overlapSeg1,this.overlapSeg2);};jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap2=function(seg1,seg2){};(function(){var MonotoneChainOverlapAction=jsts.index.chain.MonotoneChainOverlapAction;var SinglePassNoder=jsts.noding.SinglePassNoder;var STRtree=jsts.index.strtree.STRtree;var NodedSegmentString=jsts.noding.NodedSegmentString;var MonotoneChainBuilder=jsts.index.chain.MonotoneChainBuilder;var SegmentOverlapAction=function(si){this.si=si;};SegmentOverlapAction.prototype=new MonotoneChainOverlapAction();SegmentOverlapAction.constructor=SegmentOverlapAction;SegmentOverlapAction.prototype.si=null;SegmentOverlapAction.prototype.overlap=function(mc1,start1,mc2,start2){var ss1=mc1.getContext();var ss2=mc2.getContext();this.si.processIntersections(ss1,start1,ss2,start2);};jsts.noding.MCIndexNoder=function(){this.monoChains=[];this.index=new STRtree();};jsts.noding.MCIndexNoder.prototype=new SinglePassNoder();jsts.noding.MCIndexNoder.constructor=jsts.noding.MCIndexNoder;jsts.noding.MCIndexNoder.prototype.monoChains=null;jsts.noding.MCIndexNoder.prototype.index=null;jsts.noding.MCIndexNoder.prototype.idCounter=0;jsts.noding.MCIndexNoder.prototype.nodedSegStrings=null;jsts.noding.MCIndexNoder.prototype.nOverlaps=0;jsts.noding.MCIndexNoder.prototype.getMonotoneChains=function(){return this.monoChains;};jsts.noding.MCIndexNoder.prototype.getIndex=function(){return this.index;};jsts.noding.MCIndexNoder.prototype.getNodedSubstrings=function(){return NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.MCIndexNoder.prototype.computeNodes=function(inputSegStrings){this.nodedSegStrings=inputSegStrings;for(var i=inputSegStrings.iterator();i.hasNext();){this.add(i.next());}
this.intersectChains();};jsts.noding.MCIndexNoder.prototype.intersectChains=function(){var overlapAction=new SegmentOverlapAction(this.segInt);for(var i=0;i<this.monoChains.length;i++){var queryChain=this.monoChains[i];var overlapChains=this.index.query(queryChain.getEnvelope());for(var j=0;j<overlapChains.length;j++){var testChain=overlapChains[j];if(testChain.getId()>queryChain.getId()){queryChain.computeOverlaps(testChain,overlapAction);this.nOverlaps++;}
if(this.segInt.isDone())
return;}}};jsts.noding.MCIndexNoder.prototype.add=function(segStr){var segChains=MonotoneChainBuilder.getChains(segStr.getCoordinates(),segStr);for(var i=0;i<segChains.length;i++){var mc=segChains[i];mc.setId(this.idCounter++);this.index.insert(mc.getEnvelope(),mc);this.monoChains.push(mc);}};})();jsts.simplify.LineSegmentIndex=function(){this.index=new jsts.index.quadtree.Quadtree();};jsts.simplify.LineSegmentIndex.prototype.index=null;jsts.simplify.LineSegmentIndex.prototype.add=function(line){if(line instanceof jsts.geom.LineSegment){this.add2(line);return;}
var segs=line.getSegments();for(var i=0;i<segs.length;i++){var seg=segs[i];this.add2(seg);}};jsts.simplify.LineSegmentIndex.prototype.add2=function(seg){this.index.insert(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.remove=function(seg){this.index.remove(new jsts.geom.Envelope(seg.p0,seg.p1),seg);};jsts.simplify.LineSegmentIndex.prototype.query=function(querySeg){var env=new jsts.geom.Envelope(querySeg.p0,querySeg.p1);var visitor=new jsts.simplify.LineSegmentIndex.LineSegmentVisitor(querySeg);this.index.query(env,visitor);var itemsFound=visitor.getItems();return itemsFound;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor=function(querySeg){this.items=[];this.querySeg=querySeg;};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype=new jsts.index.ItemVisitor();jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.querySeg=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.items=null;jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.visitItem=function(item){var seg=item;if(jsts.geom.Envelope.intersects(seg.p0,seg.p1,this.querySeg.p0,this.querySeg.p1))
this.items.push(item);};jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.getItems=function(){return this.items;};jsts.geomgraph.EdgeEndStar=function(){this.edgeMap=new javascript.util.TreeMap();this.edgeList=null;this.ptInAreaLocation=[jsts.geom.Location.NONE,jsts.geom.Location.NONE];};jsts.geomgraph.EdgeEndStar.prototype.edgeMap=null;jsts.geomgraph.EdgeEndStar.prototype.edgeList=null;jsts.geomgraph.EdgeEndStar.prototype.ptInAreaLocation=null;jsts.geomgraph.EdgeEndStar.prototype.insert=function(e){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.EdgeEndStar.prototype.insertEdgeEnd=function(e,obj){this.edgeMap.put(e,obj);this.edgeList=null;};jsts.geomgraph.EdgeEndStar.prototype.getCoordinate=function(){var it=this.iterator();if(!it.hasNext())
return null;var e=it.next();return e.getCoordinate();};jsts.geomgraph.EdgeEndStar.prototype.getDegree=function(){return this.edgeMap.size();};jsts.geomgraph.EdgeEndStar.prototype.iterator=function(){return this.getEdges().iterator();};jsts.geomgraph.EdgeEndStar.prototype.getEdges=function(){if(this.edgeList===null){this.edgeList=new javascript.util.ArrayList(this.edgeMap.values());}
return this.edgeList;};jsts.geomgraph.EdgeEndStar.prototype.getNextCW=function(ee){this.getEdges();var i=this.edgeList.indexOf(ee);var iNextCW=i-1;if(i===0)
iNextCW=this.edgeList.length-1;return this.edgeList[iNextCW];};jsts.geomgraph.EdgeEndStar.prototype.computeLabelling=function(geomGraph){this.computeEdgeEndLabels(geomGraph[0].getBoundaryNodeRule());this.propagateSideLabels(0);this.propagateSideLabels(1);var hasDimensionalCollapseEdge=[false,false];for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isLine(geomi)&&label.getLocation(geomi)===jsts.geom.Location.BOUNDARY)
hasDimensionalCollapseEdge[geomi]=true;}}
for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();for(var geomi=0;geomi<2;geomi++){if(label.isAnyNull(geomi)){var loc=jsts.geom.Location.NONE;if(hasDimensionalCollapseEdge[geomi]){loc=jsts.geom.Location.EXTERIOR;}else{var p=e.getCoordinate();loc=this.getLocation(geomi,p,geomGraph);}
label.setAllLocationsIfNull(geomi,loc);}}}};jsts.geomgraph.EdgeEndStar.prototype.computeEdgeEndLabels=function(boundaryNodeRule){for(var it=this.iterator();it.hasNext();){var ee=it.next();ee.computeLabel(boundaryNodeRule);}};jsts.geomgraph.EdgeEndStar.prototype.getLocation=function(geomIndex,p,geom){if(this.ptInAreaLocation[geomIndex]===jsts.geom.Location.NONE){this.ptInAreaLocation[geomIndex]=jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom[geomIndex].getGeometry());}
return this.ptInAreaLocation[geomIndex];};jsts.geomgraph.EdgeEndStar.prototype.isAreaLabelsConsistent=function(geomGraph){this.computeEdgeEndLabels(geomGraph.getBoundaryNodeRule());return this.checkAreaLabelsConsistent(0);};jsts.geomgraph.EdgeEndStar.prototype.checkAreaLabelsConsistent=function(geomIndex){var edges=this.getEdges();if(edges.size()<=0)
return true;var lastEdgeIndex=edges.size()-1;var startLabel=edges.get(lastEdgeIndex).getLabel();var startLoc=startLabel.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);jsts.util.Assert.isTrue(startLoc!=jsts.geom.Location.NONE,'Found unlabelled area edge');var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();jsts.util.Assert.isTrue(label.isArea(geomIndex),'Found non-area edge');var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(leftLoc===rightLoc){return false;}
if(rightLoc!==currLoc){return false;}
currLoc=leftLoc;}
return true;};jsts.geomgraph.EdgeEndStar.prototype.propagateSideLabels=function(geomIndex){var startLoc=jsts.geom.Location.NONE;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.isArea(geomIndex)&&label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)!==jsts.geom.Location.NONE)
startLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);}
if(startLoc===jsts.geom.Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(label.getLocation(geomIndex,jsts.geomgraph.Position.ON)===jsts.geom.Location.NONE)
label.setLocation(geomIndex,jsts.geomgraph.Position.ON,currLoc);if(label.isArea(geomIndex)){var leftLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT);var rightLoc=label.getLocation(geomIndex,jsts.geomgraph.Position.RIGHT);if(rightLoc!==jsts.geom.Location.NONE){if(rightLoc!==currLoc)
throw new jsts.error.TopologyError('side location conflict',e.getCoordinate());if(leftLoc===jsts.geom.Location.NONE){jsts.util.Assert.shouldNeverReachHere('found single null side (at '+
e.getCoordinate()+')');}
currLoc=leftLoc;}else{jsts.util.Assert.isTrue(label.getLocation(geomIndex,jsts.geomgraph.Position.LEFT)===jsts.geom.Location.NONE,'found single null side');label.setLocation(geomIndex,jsts.geomgraph.Position.RIGHT,currLoc);label.setLocation(geomIndex,jsts.geomgraph.Position.LEFT,currLoc);}}}};jsts.geomgraph.EdgeEndStar.prototype.findIndex=function(eSearch){this.iterator();for(var i=0;i<this.edgeList.size();i++){var e=this.edgeList.get(i);if(e===eSearch)
return i;}
return-1;};jsts.operation.relate.EdgeEndBundleStar=function(){jsts.geomgraph.EdgeEndStar.apply(this,arguments);};jsts.operation.relate.EdgeEndBundleStar.prototype=new jsts.geomgraph.EdgeEndStar();jsts.operation.relate.EdgeEndBundleStar.prototype.insert=function(e){var eb=this.edgeMap.get(e);if(eb===null){eb=new jsts.operation.relate.EdgeEndBundle(e);this.insertEdgeEnd(e,eb);}
else{eb.insert(e);}};jsts.operation.relate.EdgeEndBundleStar.prototype.updateIM=function(im){for(var it=this.iterator();it.hasNext();){var esb=it.next();esb.updateIM(im);}};jsts.index.ArrayListVisitor=function(){this.items=[];};jsts.index.ArrayListVisitor.prototype.visitItem=function(item){this.items.push(item);};jsts.index.ArrayListVisitor.prototype.getItems=function(){return this.items;};jsts.algorithm.distance.DistanceToPoint=function(){};jsts.algorithm.distance.DistanceToPoint.computeDistance=function(geom,pt,ptDist){if(geom instanceof jsts.geom.LineString){jsts.algorithm.distance.DistanceToPoint.computeDistance2(geom,pt,ptDist);}else if(geom instanceof jsts.geom.Polygon){jsts.algorithm.distance.DistanceToPoint.computeDistance4(geom,pt,ptDist);}else if(geom instanceof jsts.geom.GeometryCollection){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);jsts.algorithm.distance.DistanceToPoint.computeDistance(g,pt,ptDist);}}else{ptDist.setMinimum(geom.getCoordinate(),pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance2=function(line,pt,ptDist){var tempSegment=new jsts.geom.LineSegment();var coords=line.getCoordinates();for(var i=0;i<coords.length-1;i++){tempSegment.setCoordinates(coords[i],coords[i+1]);var closestPt=tempSegment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);}};jsts.algorithm.distance.DistanceToPoint.computeDistance3=function(segment,pt,ptDist){var closestPt=segment.closestPoint(pt);ptDist.setMinimum(closestPt,pt);};jsts.algorithm.distance.DistanceToPoint.computeDistance4=function(poly,pt,ptDist){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getExteriorRing(),pt,ptDist);for(var i=0;i<poly.getNumInteriorRing();i++){jsts.algorithm.distance.DistanceToPoint.computeDistance2(poly.getInteriorRingN(i),pt,ptDist);}};jsts.index.strtree.ItemBoundable=function(bounds,item){this.bounds=bounds;this.item=item;};jsts.index.strtree.ItemBoundable.prototype=new jsts.index.strtree.Boundable();jsts.index.strtree.ItemBoundable.constructor=jsts.index.strtree.ItemBoundable;jsts.index.strtree.ItemBoundable.prototype.bounds=null;jsts.index.strtree.ItemBoundable.prototype.item=null;jsts.index.strtree.ItemBoundable.prototype.getBounds=function(){return this.bounds;};jsts.index.strtree.ItemBoundable.prototype.getItem=function(){return this.item;};(function(){var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.EdgeList=function(){this.edges=new ArrayList();this.ocaMap=new TreeMap();};jsts.geomgraph.EdgeList.prototype.edges=null;jsts.geomgraph.EdgeList.prototype.ocaMap=null;jsts.geomgraph.EdgeList.prototype.add=function(e){this.edges.add(e);var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());this.ocaMap.put(oca,e);};jsts.geomgraph.EdgeList.prototype.addAll=function(edgeColl){for(var i=edgeColl.iterator();i.hasNext();){this.add(i.next());}};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.findEqualEdge=function(e){var oca=new jsts.noding.OrientedCoordinateArray(e.getCoordinates());var matchEdge=this.ocaMap.get(oca);return matchEdge;};jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges;};jsts.geomgraph.EdgeList.prototype.iterator=function(){return this.edges.iterator();};jsts.geomgraph.EdgeList.prototype.get=function(i){return this.edges.get(i);};jsts.geomgraph.EdgeList.prototype.findEdgeIndex=function(e){for(var i=0;i<this.edges.size();i++){if(this.edges.get(i).equals(e))
return i;}
return-1;};})();jsts.operation.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.geom=null;jsts.operation.IsSimpleOp.prototype.isClosedEndpointsInInterior=true;jsts.operation.IsSimpleOp.prototype.nonSimpleLocation=null;jsts.operation.IsSimpleOp.prototype.IsSimpleOp=function(geom){this.geom=geom;};jsts.operation.IsSimpleOp.prototype.isSimple=function(){this.nonSimpleLocation=null;if(this.geom instanceof jsts.geom.LineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiLineString){return this.isSimpleLinearGeometry(this.geom);}
if(this.geom instanceof jsts.geom.MultiPoint){return this.isSimpleMultiPoint(this.geom);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleMultiPoint=function(mp){if(mp.isEmpty())
return true;var points=[];for(var i=0;i<mp.getNumGeometries();i++){var pt=mp.getGeometryN(i);var p=pt.getCoordinate();for(var j=0;j<points.length;j++){var point=points[j];if(p.equals2D(point)){this.nonSimpleLocation=p;return false;}}
points.push(p);}
return true;};jsts.operation.IsSimpleOp.prototype.isSimpleLinearGeometry=function(geom){if(geom.isEmpty())
return true;var graph=new jsts.geomgraph.GeometryGraph(0,geom);var li=new jsts.algorithm.RobustLineIntersector();var si=graph.computeSelfNodes(li,true);if(!si.hasIntersection())
return true;if(si.hasProperIntersection()){this.nonSimpleLocation=si.getProperIntersectionPoint();return false;}
if(this.hasNonEndpointIntersection(graph))
return false;if(this.isClosedEndpointsInInterior){if(this.hasClosedEndpointIntersection(graph))
return false;}
return true;};jsts.operation.IsSimpleOp.prototype.hasNonEndpointIntersection=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();if(!ei.isEndPoint(maxSegmentIndex)){this.nonSimpleLocation=ei.getCoordinate();return true;}}}
return false;};jsts.operation.IsSimpleOp.prototype.hasClosedEndpointIntersection=function(graph){var endPoints=new javascript.util.TreeMap();for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();var maxSegmentIndex=e.getMaximumSegmentIndex();var isClosed=e.isClosed();var p0=e.getCoordinate(0);this.addEndpoint(endPoints,p0,isClosed);var p1=e.getCoordinate(e.getNumPoints()-1);this.addEndpoint(endPoints,p1,isClosed);}
for(var i=endPoints.values().iterator();i.hasNext();){var eiInfo=i.next();if(eiInfo.isClosed&&eiInfo.degree!=2){this.nonSimpleLocation=eiInfo.getCoordinate();return true;}}
return false;};jsts.operation.IsSimpleOp.EndpointInfo=function(pt){this.pt=pt;this.isClosed=false;this.degree=0;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.pt=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.isClosed=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.degree=null;jsts.operation.IsSimpleOp.EndpointInfo.prototype.getCoordinate=function(){return this.pt;};jsts.operation.IsSimpleOp.EndpointInfo.prototype.addEndpoint=function(isClosed){this.degree++;this.isClosed=this.isClosed||isClosed;};jsts.operation.IsSimpleOp.prototype.addEndpoint=function(endPoints,p,isClosed){var eiInfo=endPoints.get(p);if(eiInfo===null){eiInfo=new jsts.operation.IsSimpleOp.EndpointInfo(p);endPoints.put(p,eiInfo);}
eiInfo.addEndpoint(isClosed);};(function(){var LineStringSnapper=function(){this.snapTolerance=0.0;this.seg=new jsts.geom.LineSegment();this.allowSnappingToSourceVertices=false;this.isClosed=false;this.srcPts=[];if(arguments[0]instanceof jsts.geom.LineString){this.initFromLine.apply(this,arguments);}else{this.initFromPoints.apply(this,arguments);}};LineStringSnapper.prototype.initFromLine=function(srcLine,snapTolerance){this.initFromPoints(srcLine.getCoordinates(),snapTolerance);};LineStringSnapper.prototype.initFromPoints=function(srcPts,snapTolerance){this.srcPts=srcPts;this.isClosed=this.calcIsClosed(srcPts);this.snapTolerance=snapTolerance;};LineStringSnapper.prototype.setAllowSnappingToSourceVertices=function(allowSnappingToSourceVertices){this.allowSnappingToSourceVertices=allowSnappingToSourceVertices;};LineStringSnapper.prototype.calcIsClosed=function(pts){if(pts.length<=1){return false;}
return pts[0].equals(pts[pts.length-1]);};LineStringSnapper.prototype.snapTo=function(snapPts){var coordList=new jsts.geom.CoordinateList(this.srcPts);this.snapVertices(coordList,snapPts);this.snapSegments(coordList,snapPts);return coordList.toCoordinateArray();};LineStringSnapper.prototype.snapVertices=function(srcCoords,snapPts){var end=this.isClosed?srcCoords.size()-1:srcCoords.size(),i=0,srcPt,snapVert;for(i;i<end;i++){srcPt=srcCoords.get(i);snapVert=this.findSnapForVertex(srcPt,snapPts);if(snapVert!==null){srcCoords.set(i,new jsts.geom.Coordinate(snapVert));if(i===0&&this.isClosed)
srcCoords.set(srcCoords.size()-1,new jsts.geom.Coordinate(snapVert));}}};LineStringSnapper.prototype.findSnapForVertex=function(pt,snapPts){var i=0,il=snapPts.length;for(i=0;i<il;i++){if(pt.equals(snapPts[i])){return null;}
if(pt.distance(snapPts[i])<this.snapTolerance){return snapPts[i];}}
return null;};LineStringSnapper.prototype.snapSegments=function(srcCoords,snapPts){if(snapPts.length===0){return;}
var distinctPtCount=snapPts.length,i,snapPt,index;if(snapPts.length>1&&snapPts[0].equals2D(snapPts[snapPts.length-1])){distinctPtCount=snapPts.length-1;}
i=0;for(i;i<distinctPtCount;i++){snapPt=snapPts[i];index=this.findSegmentIndexToSnap(snapPt,srcCoords);if(index>=0){srcCoords.add(index+1,new jsts.geom.Coordinate(snapPt),false);}}};LineStringSnapper.prototype.findSegmentIndexToSnap=function(snapPt,srcCoords){var minDist=Number.MAX_VALUE,snapIndex=-1,i=0,dist;for(i;i<srcCoords.size()-1;i++){this.seg.p0=srcCoords.get(i);this.seg.p1=srcCoords.get(i+1);if(this.seg.p0.equals(snapPt)||this.seg.p1.equals(snapPt)){if(this.allowSnappingToSourceVertices){continue;}else{return-1;}}
dist=this.seg.distance(snapPt);if(dist<this.snapTolerance&&dist<minDist){minDist=dist;snapIndex=i;}}
return snapIndex;};jsts.operation.overlay.snap.LineStringSnapper=LineStringSnapper;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryComponentFilter=jsts.geom.GeometryComponentFilter;var LineString=jsts.geom.LineString;var EdgeRing=jsts.operation.polygonize.EdgeRing;var PolygonizeGraph=jsts.operation.polygonize.PolygonizeGraph;var Polygonizer=function(){var that=this;var LineStringAdder=function(){};LineStringAdder.prototype=new GeometryComponentFilter();LineStringAdder.prototype.filter=function(g){if(g instanceof LineString)
that.add(g);};this.lineStringAdder=new LineStringAdder();this.dangles=new ArrayList();this.cutEdges=new ArrayList();this.invalidRingLines=new ArrayList();};Polygonizer.prototype.lineStringAdder=null;Polygonizer.prototype.graph=null;Polygonizer.prototype.dangles=null;Polygonizer.prototype.cutEdges=null;Polygonizer.prototype.invalidRingLines=null;Polygonizer.prototype.holeList=null;Polygonizer.prototype.shellList=null;Polygonizer.prototype.polyList=null;Polygonizer.prototype.add=function(geomList){if(geomList instanceof jsts.geom.LineString){return this.add3(geomList);}else if(geomList instanceof jsts.geom.Geometry){return this.add2(geomList);}
for(var i=geomList.iterator();i.hasNext();){var geometry=i.next();this.add2(geometry);}};Polygonizer.prototype.add2=function(g){g.apply(this.lineStringAdder);};Polygonizer.prototype.add3=function(line){if(this.graph==null)
this.graph=new PolygonizeGraph(line.getFactory());this.graph.addEdge(line);};Polygonizer.prototype.getPolygons=function(){this.polygonize();return this.polyList;};Polygonizer.prototype.getDangles=function(){this.polygonize();return this.dangles;};Polygonizer.prototype.getCutEdges=function(){this.polygonize();return this.cutEdges;};Polygonizer.prototype.getInvalidRingLines=function(){this.polygonize();return this.invalidRingLines;};Polygonizer.prototype.polygonize=function(){if(this.polyList!=null)
return;this.polyList=new ArrayList();if(this.graph==null)
return;this.dangles=this.graph.deleteDangles();this.cutEdges=this.graph.deleteCutEdges();var edgeRingList=this.graph.getEdgeRings();var validEdgeRingList=new ArrayList();this.invalidRingLines=new ArrayList();this.findValidRings(edgeRingList,validEdgeRingList,this.invalidRingLines);this.findShellsAndHoles(validEdgeRingList);Polygonizer.assignHolesToShells(this.holeList,this.shellList);this.polyList=new ArrayList();for(var i=this.shellList.iterator();i.hasNext();){var er=i.next();this.polyList.add(er.getPolygon());}};Polygonizer.prototype.findValidRings=function(edgeRingList,validEdgeRingList,invalidRingList){for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isValid())
validEdgeRingList.add(er);else
invalidRingList.add(er.getLineString());}};Polygonizer.prototype.findShellsAndHoles=function(edgeRingList){this.holeList=new ArrayList();this.shellList=new ArrayList();for(var i=edgeRingList.iterator();i.hasNext();){var er=i.next();if(er.isHole())
this.holeList.add(er);else
this.shellList.add(er);}};Polygonizer.assignHolesToShells=function(holeList,shellList){for(var i=holeList.iterator();i.hasNext();){var holeER=i.next();Polygonizer.assignHoleToShell(holeER,shellList);}};Polygonizer.assignHoleToShell=function(holeER,shellList){var shell=EdgeRing.findEdgeRingContaining(holeER,shellList);if(shell!=null)
shell.addHole(holeER.getRing());};jsts.operation.polygonize.Polygonizer=Polygonizer;})();(function(){var ArrayList=javascript.util.ArrayList;var GeometryTransformer=function(){};GeometryTransformer.prototype.inputGeom=null;GeometryTransformer.prototype.factory=null;GeometryTransformer.prototype.pruneEmptyGeometry=true;GeometryTransformer.prototype.preserveGeometryCollectionType=true;GeometryTransformer.prototype.preserveCollections=false;GeometryTransformer.prototype.reserveType=false;GeometryTransformer.prototype.getInputGeometry=function(){return this.inputGeom;};GeometryTransformer.prototype.transform=function(inputGeom){this.inputGeom=inputGeom;this.factory=inputGeom.getFactory();if(inputGeom instanceof jsts.geom.Point)
return this.transformPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPoint)
return this.transformMultiPoint(inputGeom,null);if(inputGeom instanceof jsts.geom.LinearRing)
return this.transformLinearRing(inputGeom,null);if(inputGeom instanceof jsts.geom.LineString)
return this.transformLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiLineString)
return this.transformMultiLineString(inputGeom,null);if(inputGeom instanceof jsts.geom.Polygon)
return this.transformPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.MultiPolygon)
return this.transformMultiPolygon(inputGeom,null);if(inputGeom instanceof jsts.geom.GeometryCollection)
return this.transformGeometryCollection(inputGeom,null);throw new jsts.error.IllegalArgumentException('Unknown Geometry subtype: '+
inputGeom.getClass().getName());};GeometryTransformer.prototype.createCoordinateSequence=function(coords){return this.factory.getCoordinateSequenceFactory().create(coords);};GeometryTransformer.prototype.copy=function(seq){return seq.clone();};GeometryTransformer.prototype.transformCoordinates=function(coords,parent){return this.copy(coords);};GeometryTransformer.prototype.transformPoint=function(geom,parent){return this.factory.createPoint(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiPoint=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPoint(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformLinearRing=function(geom,parent){var seq=this.transformCoordinates(geom.getCoordinateSequence(),geom);var seqSize=seq.length;if(seqSize>0&&seqSize<4&&!this.preserveType)
return this.factory.createLineString(seq);return this.factory.createLinearRing(seq);};GeometryTransformer.prototype.transformLineString=function(geom,parent){return this.factory.createLineString(this.transformCoordinates(geom.getCoordinateSequence(),geom));};GeometryTransformer.prototype.transformMultiLineString=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformLineString(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformPolygon=function(geom,parent){var isAllValidLinearRings=true;var shell=this.transformLinearRing(geom.getExteriorRing(),geom);if(shell==null||!(shell instanceof jsts.geom.LinearRing)||shell.isEmpty())
isAllValidLinearRings=false;var holes=new ArrayList();for(var i=0;i<geom.getNumInteriorRing();i++){var hole=this.transformLinearRing(geom.getInteriorRingN(i),geom);if(hole==null||hole.isEmpty()){continue;}
if(!(hole instanceof jsts.geom.LinearRing))
isAllValidLinearRings=false;holes.add(hole);}
if(isAllValidLinearRings)
return this.factory.createPolygon(shell,holes.toArray());else{var components=new ArrayList();if(shell!=null)
components.add(shell);components.addAll(holes);return this.factory.buildGeometry(components);}};GeometryTransformer.prototype.transformMultiPolygon=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transformPolygon(geom.getGeometryN(i),geom);if(transformGeom==null)
continue;if(transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
return this.factory.buildGeometry(transGeomList);};GeometryTransformer.prototype.transformGeometryCollection=function(geom,parent){var transGeomList=new ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var transformGeom=this.transform(geom.getGeometryN(i));if(transformGeom==null)
continue;if(this.pruneEmptyGeometry&&transformGeom.isEmpty())
continue;transGeomList.add(transformGeom);}
if(this.preserveGeometryCollectionType)
return this.factory.createGeometryCollection(GeometryFactory.toGeometryArray(transGeomList));return this.factory.buildGeometry(transGeomList);};jsts.geom.util.GeometryTransformer=GeometryTransformer;})();(function(){var LineStringSnapper=jsts.operation.overlay.snap.LineStringSnapper;var PrecisionModel=jsts.geom.PrecisionModel;var TreeSet=javascript.util.TreeSet;var SnapTransformer=function(snapTolerance,snapPts,isSelfSnap){this.snapTolerance=snapTolerance;this.snapPts=snapPts;this.isSelfSnap=isSelfSnap||false;};SnapTransformer.prototype=new jsts.geom.util.GeometryTransformer();SnapTransformer.prototype.snapTolerance=null;SnapTransformer.prototype.snapPts=null;SnapTransformer.prototype.isSelfSnap=false;SnapTransformer.prototype.transformCoordinates=function(coords,parent){var srcPts=coords;var newPts=this.snapLine(srcPts,this.snapPts);return newPts;};SnapTransformer.prototype.snapLine=function(srcPts,snapPts){var snapper=new LineStringSnapper(srcPts,this.snapTolerance);snapper.setAllowSnappingToSourceVertices(this.isSelfSnap);return snapper.snapTo(snapPts);};var GeometrySnapper=function(srcGeom){this.srcGeom=srcGeom;};GeometrySnapper.SNAP_PRECISION_FACTOR=1e-9;GeometrySnapper.computeOverlaySnapTolerance=function(g){if(arguments.length===2){return GeometrySnapper.computeOverlaySnapTolerance2.apply(this,arguments);}
var snapTolerance=this.computeSizeBasedSnapTolerance(g);var pm=g.getPrecisionModel();if(pm.getType()==PrecisionModel.FIXED){var fixedSnapTol=(1/pm.getScale())*2/1.415;if(fixedSnapTol>snapTolerance)
snapTolerance=fixedSnapTol;}
return snapTolerance;};GeometrySnapper.computeSizeBasedSnapTolerance=function(g){var env=g.getEnvelopeInternal();var minDimension=Math.min(env.getHeight(),env.getWidth());var snapTol=minDimension*GeometrySnapper.SNAP_PRECISION_FACTOR;return snapTol;};GeometrySnapper.computeOverlaySnapTolerance2=function(g0,g1){return Math.min(this.computeOverlaySnapTolerance(g0),this.computeOverlaySnapTolerance(g1));};GeometrySnapper.snap=function(g0,g1,snapTolerance){var snapGeom=[];var snapper0=new GeometrySnapper(g0);snapGeom[0]=snapper0.snapTo(g1,snapTolerance);var snapper1=new GeometrySnapper(g1);snapGeom[1]=snapper1.snapTo(snapGeom[0],snapTolerance);return snapGeom;};GeometrySnapper.snapToSelf=function(g0,snapTolerance,cleanResult){var snapper0=new GeometrySnapper(g0);return snapper0.snapToSelf(snapTolerance,cleanResult);};GeometrySnapper.prototype.srcGeom=null;GeometrySnapper.prototype.snapTo=function(snapGeom,snapTolerance){var snapPts=this.extractTargetCoordinates(snapGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts);return snapTrans.transform(this.srcGeom);};GeometrySnapper.prototype.snapToSelf=function(snapTolerance,cleanResult){var snapPts=this.extractTargetCoordinates(srcGeom);var snapTrans=new SnapTransformer(snapTolerance,snapPts,true);var snappedGeom=snapTrans.transform(srcGeom);var result=snappedGeom;if(cleanResult&&result instanceof Polygonal){result=snappedGeom.buffer(0);}
return result;};GeometrySnapper.prototype.extractTargetCoordinates=function(g){var ptSet=new TreeSet();var pts=g.getCoordinates();for(var i=0;i<pts.length;i++){ptSet.add(pts[i]);}
return ptSet.toArray();};GeometrySnapper.prototype.computeSnapTolerance=function(ringPts){var minSegLen=this.computeMinimumSegmentLength(ringPts);var snapTol=minSegLen/10;return snapTol;};GeometrySnapper.prototype.computeMinimumSegmentLength=function(pts){var minSegLen=Number.MAX_VALUE;for(var i=0;i<pts.length-1;i++){var segLen=pts[i].distance(pts[i+1]);if(segLen<minSegLen)
minSegLen=segLen;}
return minSegLen;};jsts.operation.overlay.snap.GeometrySnapper=GeometrySnapper;})();jsts.algorithm.PointLocator=function(boundaryRule){this.boundaryRule=boundaryRule?boundaryRule:jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;};jsts.algorithm.PointLocator.prototype.boundaryRule=null;jsts.algorithm.PointLocator.prototype.isIn=null;jsts.algorithm.PointLocator.prototype.numBoundaries=null;jsts.algorithm.PointLocator.prototype.intersects=function(p,geom){return this.locate(p,geom)!==jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(geom instanceof jsts.geom.Point){return this.locate2(p,geom);}else if(geom instanceof jsts.geom.LineString){return this.locate3(p,geom);}else if(geom instanceof jsts.geom.Polygon){return this.locate4(p,geom);}
this.isIn=false;this.numBoundaries=0;this.computeLocation(p,geom);if(this.boundaryRule.isInBoundary(this.numBoundaries))
return jsts.geom.Location.BOUNDARY;if(this.numBoundaries>0||this.isIn)
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.computeLocation=function(p,geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon){this.updateLocationInfo(this.locate(p,geom));}else if(geom instanceof jsts.geom.MultiLineString){var ml=geom;for(var i=0;i<ml.getNumGeometries();i++){var l=ml.getGeometryN(i);this.updateLocationInfo(this.locate(p,l));}}else if(geom instanceof jsts.geom.MultiPolygon){var mpoly=geom;for(var i=0;i<mpoly.getNumGeometries();i++){var poly=mpoly.getGeometryN(i);this.updateLocationInfo(this.locate(p,poly));}}else if(geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.GeometryCollection){for(var i=0;i<geom.getNumGeometries();i++){var part=geom.getGeometryN(i);if(part!==geom){this.computeLocation(p,part);}}}};jsts.algorithm.PointLocator.prototype.updateLocationInfo=function(loc){if(loc===jsts.geom.Location.INTERIOR)
this.isIn=true;if(loc===jsts.geom.Location.BOUNDARY)
this.numBoundaries++;};jsts.algorithm.PointLocator.prototype.locate2=function(p,pt){var ptCoord=pt.getCoordinate();if(ptCoord.equals2D(p))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locate3=function(p,l){if(!l.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;var pt=l.getCoordinates();if(!l.isClosed()){if(p.equals(pt[0])||p.equals(pt[pt.length-1])){return jsts.geom.Location.BOUNDARY;}}
if(jsts.algorithm.CGAlgorithms.isOnLine(p,pt))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.PointLocator.prototype.locateInPolygonRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return jsts.geom.Location.EXTERIOR;return jsts.algorithm.CGAlgorithms.locatePointInRing(p,ring.getCoordinates());};jsts.algorithm.PointLocator.prototype.locate4=function(p,poly){if(poly.isEmpty())
return jsts.geom.Location.EXTERIOR;var shell=poly.getExteriorRing();var shellLoc=this.locateInPolygonRing(p,shell);if(shellLoc===jsts.geom.Location.EXTERIOR)
return jsts.geom.Location.EXTERIOR;if(shellLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);var holeLoc=this.locateInPolygonRing(p,hole);if(holeLoc===jsts.geom.Location.INTERIOR)
return jsts.geom.Location.EXTERIOR;if(holeLoc===jsts.geom.Location.BOUNDARY)
return jsts.geom.Location.BOUNDARY;}
return jsts.geom.Location.INTERIOR;};(function(){var Location=jsts.geom.Location;var ArrayList=javascript.util.ArrayList;var TreeMap=javascript.util.TreeMap;jsts.geomgraph.NodeMap=function(nodeFactory){this.nodeMap=new TreeMap();this.nodeFact=nodeFactory;};jsts.geomgraph.NodeMap.prototype.nodeMap=null;jsts.geomgraph.NodeMap.prototype.nodeFact=null;jsts.geomgraph.NodeMap.prototype.addNode=function(arg){var node,coord;if(arg instanceof jsts.geom.Coordinate){coord=arg;node=this.nodeMap.get(coord);if(node===null){node=this.nodeFact.createNode(coord);this.nodeMap.put(coord,node);}
return node;}else if(arg instanceof jsts.geomgraph.Node){var n=arg;coord=n.getCoordinate();node=this.nodeMap.get(coord);if(node===null){this.nodeMap.put(coord,n);return n;}
node.mergeLabel(n);return node;}};jsts.geomgraph.NodeMap.prototype.add=function(e){var p=e.getCoordinate();var n=this.addNode(p);n.add(e);};jsts.geomgraph.NodeMap.prototype.find=function(coord){return this.nodeMap.get(coord);};jsts.geomgraph.NodeMap.prototype.values=function(){return this.nodeMap.values();};jsts.geomgraph.NodeMap.prototype.iterator=function(){return this.values().iterator();};jsts.geomgraph.NodeMap.prototype.getBoundaryNodes=function(geomIndex){var bdyNodes=new ArrayList();for(var i=this.iterator();i.hasNext();){var node=i.next();if(node.getLabel().getLocation(geomIndex)===Location.BOUNDARY){bdyNodes.add(node);}}
return bdyNodes;};})();(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.PlanarGraph=function(nodeFactory){this.edges=new ArrayList();this.edgeEndList=new ArrayList();this.nodes=new jsts.geomgraph.NodeMap(nodeFactory||new jsts.geomgraph.NodeFactory());};jsts.geomgraph.PlanarGraph.prototype.edges=null;jsts.geomgraph.PlanarGraph.prototype.nodes=null;jsts.geomgraph.PlanarGraph.prototype.edgeEndList=null;jsts.geomgraph.PlanarGraph.linkResultDirectedEdges=function(nodes){for(var nodeit=nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.getEdgeIterator=function(){return this.edges.iterator();};jsts.geomgraph.PlanarGraph.prototype.getEdgeEnds=function(){return this.edgeEndList;};jsts.geomgraph.PlanarGraph.prototype.isBoundaryNode=function(geomIndex,coord){var node=this.nodes.find(coord);if(node===null)
return false;var label=node.getLabel();if(label!==null&&label.getLocation(geomIndex)===jsts.geom.Location.BOUNDARY)
return true;return false;};jsts.geomgraph.PlanarGraph.prototype.insertEdge=function(e){this.edges.add(e);};jsts.geomgraph.PlanarGraph.prototype.add=function(e){this.nodes.add(e);this.edgeEndList.add(e);};jsts.geomgraph.PlanarGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};jsts.geomgraph.PlanarGraph.prototype.getNodes=function(){return this.nodes.values();};jsts.geomgraph.PlanarGraph.prototype.addNode=function(node){return this.nodes.addNode(node);};jsts.geomgraph.PlanarGraph.prototype.addEdges=function(edgesToAdd){for(var it=edgesToAdd.iterator();it.hasNext();){var e=it.next();this.edges.add(e);var de1=new jsts.geomgraph.DirectedEdge(e,true);var de2=new jsts.geomgraph.DirectedEdge(e,false);de1.setSym(de2);de2.setSym(de1);this.add(de1);this.add(de2);}};jsts.geomgraph.PlanarGraph.prototype.linkResultDirectedEdges=function(){for(var nodeit=this.nodes.iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().linkResultDirectedEdges();}};jsts.geomgraph.PlanarGraph.prototype.findEdgeInSameDirection=function(p0,p1){var i=0,il=this.edges.size(),e,eCoord;for(i;i<il;i++){e=this.edges.get(i);eCoord=e.getCoordinates();if(this.matchInSameDirection(p0,p1,eCoord[0],eCoord[1])){return e;}
if(this.matchInSameDirection(p0,p1,eCoord[eCoord.length-1],eCoord[eCoord.length-2])){return e;}}
return null;};jsts.geomgraph.PlanarGraph.prototype.matchInSameDirection=function(p0,p1,ep0,ep1){if(!p0.equals(ep0)){return false;}
if(jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,ep1)===jsts.algorithm.CGAlgorithms.COLLINEAR&&jsts.geomgraph.Quadrant.quadrant(p0,p1)===jsts.geomgraph.Quadrant.quadrant(ep0,ep1)){return true;}
return false;};jsts.geomgraph.PlanarGraph.prototype.findEdgeEnd=function(e){for(var i=this.getEdgeEnds().iterator();i.hasNext();){var ee=i.next();if(ee.getEdge()===e){return ee;}}
return null;};})();jsts.noding.SegmentIntersector=function(){};jsts.noding.SegmentIntersector.prototype.processIntersections=jsts.abstractFunc;jsts.noding.SegmentIntersector.prototype.isDone=jsts.abstractFunc;(function(){var SegmentIntersector=jsts.noding.SegmentIntersector;var ArrayList=javascript.util.ArrayList;jsts.noding.InteriorIntersectionFinder=function(li){this.li=li;this.intersections=new ArrayList();this.interiorIntersection=null;};jsts.noding.InteriorIntersectionFinder.prototype=new SegmentIntersector();jsts.noding.InteriorIntersectionFinder.constructor=jsts.noding.InteriorIntersectionFinder;jsts.noding.InteriorIntersectionFinder.prototype.findAllIntersections=false;jsts.noding.InteriorIntersectionFinder.prototype.isCheckEndSegmentsOnly=false;jsts.noding.InteriorIntersectionFinder.prototype.li=null;jsts.noding.InteriorIntersectionFinder.prototype.interiorIntersection=null;jsts.noding.InteriorIntersectionFinder.prototype.intSegments=null;jsts.noding.InteriorIntersectionFinder.prototype.intersections=null;jsts.noding.InteriorIntersectionFinder.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersections=function(){return intersections;};jsts.noding.InteriorIntersectionFinder.prototype.setCheckEndSegmentsOnly=function(isCheckEndSegmentsOnly){this.isCheckEndSegmentsOnly=isCheckEndSegmentsOnly;}
jsts.noding.InteriorIntersectionFinder.prototype.hasIntersection=function(){return this.interiorIntersection!=null;};jsts.noding.InteriorIntersectionFinder.prototype.getInteriorIntersection=function(){return this.interiorIntersection;};jsts.noding.InteriorIntersectionFinder.prototype.getIntersectionSegments=function(){return this.intSegments;};jsts.noding.InteriorIntersectionFinder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(this.hasIntersection())
return;if(e0==e1&&segIndex0==segIndex1)
return;if(this.isCheckEndSegmentsOnly){var isEndSegPresent=this.isEndSegment(e0,segIndex0)||isEndSegment(e1,segIndex1);if(!isEndSegPresent)
return;}
var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){this.intSegments=[];this.intSegments[0]=p00;this.intSegments[1]=p01;this.intSegments[2]=p10;this.intSegments[3]=p11;this.interiorIntersection=this.li.getIntersection(0);this.intersections.add(this.interiorIntersection);}}};jsts.noding.InteriorIntersectionFinder.prototype.isEndSegment=function(segStr,index){if(index==0)
return true;if(index>=segStr.size()-2)
return true;return false;};jsts.noding.InteriorIntersectionFinder.prototype.isDone=function(){if(this.findAllIntersections)
return false;return this.interiorIntersection!=null;};})();(function(){var RobustLineIntersector=jsts.algorithm.RobustLineIntersector;var InteriorIntersectionFinder=jsts.noding.InteriorIntersectionFinder;var MCIndexNoder=jsts.noding.MCIndexNoder;jsts.noding.FastNodingValidator=function(segStrings){this.li=new RobustLineIntersector();this.segStrings=segStrings;};jsts.noding.FastNodingValidator.prototype.li=null;jsts.noding.FastNodingValidator.prototype.segStrings=null;jsts.noding.FastNodingValidator.prototype.findAllIntersections=false;jsts.noding.FastNodingValidator.prototype.segInt=null;jsts.noding.FastNodingValidator.prototype._isValid=true;jsts.noding.FastNodingValidator.prototype.setFindAllIntersections=function(findAllIntersections){this.findAllIntersections=findAllIntersections;};jsts.noding.FastNodingValidator.prototype.getIntersections=function(){return segInt.getIntersections();};jsts.noding.FastNodingValidator.prototype.isValid=function(){this.execute();return this._isValid;};jsts.noding.FastNodingValidator.prototype.getErrorMessage=function(){if(this._isValid)
return'no intersections found';var intSegs=this.segInt.getIntersectionSegments();return'found non-noded intersection between '+
jsts.io.WKTWriter.toLineString(intSegs[0],intSegs[1])+' and '+
jsts.io.WKTWriter.toLineString(intSegs[2],intSegs[3]);};jsts.noding.FastNodingValidator.prototype.checkValid=function(){this.execute();if(!this._isValid)
throw new jsts.error.TopologyError(this.getErrorMessage(),this.segInt.getInteriorIntersection());};jsts.noding.FastNodingValidator.prototype.execute=function(){if(this.segInt!=null)
return;this.checkInteriorIntersections();};jsts.noding.FastNodingValidator.prototype.checkInteriorIntersections=function(){this._isValid=true;this.segInt=new InteriorIntersectionFinder(this.li);this.segInt.setFindAllIntersections(this.findAllIntersections);var noder=new MCIndexNoder();noder.setSegmentIntersector(this.segInt);noder.computeNodes(this.segStrings);if(this.segInt.hasIntersection()){this._isValid=false;return;}};})();(function(){jsts.noding.BasicSegmentString=function(pts,data){this.pts=pts;this.data=data;};jsts.noding.BasicSegmentString.prototype=new jsts.noding.SegmentString();jsts.noding.BasicSegmentString.prototype.pts=null;jsts.noding.BasicSegmentString.prototype.data=null;jsts.noding.BasicSegmentString.prototype.getData=function(){return this.data;}
jsts.noding.BasicSegmentString.prototype.setData=function(data){this.data=data;};jsts.noding.BasicSegmentString.prototype.size=function(){return this.pts.length;};jsts.noding.BasicSegmentString.prototype.getCoordinate=function(i){return this.pts[i];};jsts.noding.BasicSegmentString.prototype.getCoordinates=function(){return this.pts;};jsts.noding.BasicSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.noding.BasicSegmentString.prototype.getSegmentOctant=function(index){if(index==this.pts.length-1)
return-1;return jsts.noding.Octant.octant(this.getCoordinate(index),this.getCoordinate(index+1));};})();(function(){var FastNodingValidator=jsts.noding.FastNodingValidator;var BasicSegmentString=jsts.noding.BasicSegmentString;var ArrayList=javascript.util.ArrayList;jsts.geomgraph.EdgeNodingValidator=function(edges){this.nv=new FastNodingValidator(jsts.geomgraph.EdgeNodingValidator.toSegmentStrings(edges));};jsts.geomgraph.EdgeNodingValidator.checkValid=function(edges){var validator=new jsts.geomgraph.EdgeNodingValidator(edges);validator.checkValid();};jsts.geomgraph.EdgeNodingValidator.toSegmentStrings=function(edges){var segStrings=new ArrayList();for(var i=edges.iterator();i.hasNext();){var e=i.next();segStrings.add(new BasicSegmentString(e.getCoordinates(),e));}
return segStrings;};jsts.geomgraph.EdgeNodingValidator.prototype.nv=null;jsts.geomgraph.EdgeNodingValidator.prototype.checkValid=function(){this.nv.checkValid();};})();jsts.operation.GeometryGraphOperation=function(g0,g1,boundaryNodeRule){this.li=new jsts.algorithm.RobustLineIntersector();this.arg=[];if(g0===undefined){return;}
if(g1===undefined){this.setComputationPrecision(g0.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0);return;}
boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(g0.getPrecisionModel().compareTo(g1.getPrecisionModel())>=0)
this.setComputationPrecision(g0.getPrecisionModel());else
this.setComputationPrecision(g1.getPrecisionModel());this.arg[0]=new jsts.geomgraph.GeometryGraph(0,g0,boundaryNodeRule);this.arg[1]=new jsts.geomgraph.GeometryGraph(1,g1,boundaryNodeRule);};jsts.operation.GeometryGraphOperation.prototype.li=null;jsts.operation.GeometryGraphOperation.prototype.resultPrecisionModel=null;jsts.operation.GeometryGraphOperation.prototype.arg=null;jsts.operation.GeometryGraphOperation.prototype.getArgGeometry=function(i){return arg[i].getGeometry();};jsts.operation.GeometryGraphOperation.prototype.setComputationPrecision=function(pm){this.resultPrecisionModel=pm;this.li.setPrecisionModel(this.resultPrecisionModel);};jsts.operation.overlay.OverlayNodeFactory=function(){};jsts.operation.overlay.OverlayNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.overlay.OverlayNodeFactory.constructor=jsts.operation.overlay.OverlayNodeFactory;jsts.operation.overlay.OverlayNodeFactory.prototype.createNode=function(coord){return new jsts.geomgraph.Node(coord,new jsts.geomgraph.DirectedEdgeStar());};jsts.operation.overlay.PolygonBuilder=function(geometryFactory){this.shellList=[];this.geometryFactory=geometryFactory;};jsts.operation.overlay.PolygonBuilder.prototype.geometryFactory=null;jsts.operation.overlay.PolygonBuilder.prototype.shellList=null;jsts.operation.overlay.PolygonBuilder.prototype.add=function(graph){if(arguments.length===2){this.add2.apply(this,arguments);return;}
this.add2(graph.getEdgeEnds(),graph.getNodes());};jsts.operation.overlay.PolygonBuilder.prototype.add2=function(dirEdges,nodes){jsts.geomgraph.PlanarGraph.linkResultDirectedEdges(nodes);var maxEdgeRings=this.buildMaximalEdgeRings(dirEdges);var freeHoleList=[];var edgeRings=this.buildMinimalEdgeRings(maxEdgeRings,this.shellList,freeHoleList);this.sortShellsAndHoles(edgeRings,this.shellList,freeHoleList);this.placeFreeHoles(this.shellList,freeHoleList);};jsts.operation.overlay.PolygonBuilder.prototype.getPolygons=function(){var resultPolyList=this.computePolygons(this.shellList);return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.buildMaximalEdgeRings=function(dirEdges){var maxEdgeRings=[];for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getLabel().isArea()){if(de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);maxEdgeRings.push(er);er.setInResult();}}}
return maxEdgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.buildMinimalEdgeRings=function(maxEdgeRings,shellList,freeHoleList){var edgeRings=[];for(var i=0;i<maxEdgeRings.length;i++){var er=maxEdgeRings[i];if(er.getMaxNodeDegree()>2){er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var shell=this.findShell(minEdgeRings);if(shell!==null){this.placePolygonHoles(shell,minEdgeRings);shellList.push(shell);}else{freeHoleList=freeHoleList.concat(minEdgeRings);}}else{edgeRings.push(er);}}
return edgeRings;};jsts.operation.overlay.PolygonBuilder.prototype.findShell=function(minEdgeRings){var shellCount=0;var shell=null;for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(!er.isHole()){shell=er;shellCount++;}}
jsts.util.Assert.isTrue(shellCount<=1,'found two shells in MinimalEdgeRing list');return shell;};jsts.operation.overlay.PolygonBuilder.prototype.placePolygonHoles=function(shell,minEdgeRings){for(var i=0;i<minEdgeRings.length;i++){var er=minEdgeRings[i];if(er.isHole()){er.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.sortShellsAndHoles=function(edgeRings,shellList,freeHoleList){for(var i=0;i<edgeRings.length;i++){var er=edgeRings[i];if(er.isHole()){freeHoleList.push(er);}else{shellList.push(er);}}};jsts.operation.overlay.PolygonBuilder.prototype.placeFreeHoles=function(shellList,freeHoleList){for(var i=0;i<freeHoleList.length;i++){var hole=freeHoleList[i];if(hole.getShell()==null){var shell=this.findEdgeRingContaining(hole,shellList);if(shell===null)
throw new jsts.error.TopologyError('unable to assign hole to a shell',hole.getCoordinate(0));hole.setShell(shell);}}};jsts.operation.overlay.PolygonBuilder.prototype.findEdgeRingContaining=function(testEr,shellList){var testRing=testEr.getLinearRing();var testEnv=testRing.getEnvelopeInternal();var testPt=testRing.getCoordinateN(0);var minShell=null;var minEnv=null;for(var i=0;i<shellList.length;i++){var tryShell=shellList[i];var tryRing=tryShell.getLinearRing();var tryEnv=tryRing.getEnvelopeInternal();if(minShell!==null)
minEnv=minShell.getLinearRing().getEnvelopeInternal();var isContained=false;if(tryEnv.contains(testEnv)&&jsts.algorithm.CGAlgorithms.isPointInRing(testPt,tryRing.getCoordinates()))
isContained=true;if(isContained){if(minShell==null||minEnv.contains(tryEnv)){minShell=tryShell;}}}
return minShell;};jsts.operation.overlay.PolygonBuilder.prototype.computePolygons=function(shellList){var resultPolyList=new javascript.util.ArrayList();for(var i=0;i<shellList.length;i++){var er=shellList[i];var poly=er.toPolygon(this.geometryFactory);resultPolyList.add(poly);}
return resultPolyList;};jsts.operation.overlay.PolygonBuilder.prototype.containsPoint=function(p){for(var i=0;i<this.shellList.length;i++){var er=this.shellList[i];if(er.containsPoint(p))
return true;}
return false;};(function(){var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;var LineBuilder=function(op,geometryFactory,ptLocator){this.lineEdgesList=new ArrayList();this.resultLineList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;this.ptLocator=ptLocator;};LineBuilder.prototype.op=null;LineBuilder.prototype.geometryFactory=null;LineBuilder.prototype.ptLocator=null;LineBuilder.prototype.lineEdgesList=null;LineBuilder.prototype.resultLineList=null;LineBuilder.prototype.build=function(opCode){this.findCoveredLineEdges();this.collectLines(opCode);this.buildLines(opCode);return this.resultLineList;};LineBuilder.prototype.findCoveredLineEdges=function(){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().findCoveredLineEdges();}
for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();var e=de.getEdge();if(de.isLineEdge()&&!e.isCoveredSet()){var isCovered=this.op.isCoveredByA(de.getCoordinate());e.setCovered(isCovered);}}};LineBuilder.prototype.collectLines=function(opCode){for(var it=this.op.getGraph().getEdgeEnds().iterator();it.hasNext();){var de=it.next();this.collectLineEdge(de,opCode,this.lineEdgesList);this.collectBoundaryTouchEdge(de,opCode,this.lineEdgesList);}};LineBuilder.prototype.collectLineEdge=function(de,opCode,edges){var label=de.getLabel();var e=de.getEdge();if(de.isLineEdge()){if(!de.isVisited()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&!e.isCovered()){edges.add(e);de.setVisitedEdge(true);}}};LineBuilder.prototype.collectBoundaryTouchEdge=function(de,opCode,edges){var label=de.getLabel();if(de.isLineEdge())
return;if(de.isVisited())
return;if(de.isInteriorAreaEdge())
return;if(de.getEdge().isInResult())
return;Assert.isTrue(!(de.isInResult()||de.getSym().isInResult())||!de.getEdge().isInResult());if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)&&opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){edges.add(de.getEdge());de.setVisitedEdge(true);}};LineBuilder.prototype.buildLines=function(opCode){for(var it=this.lineEdgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();var line=this.geometryFactory.createLineString(e.getCoordinates());this.resultLineList.add(line);e.setInResult(true);}};LineBuilder.prototype.labelIsolatedLines=function(edgesList){for(var it=edgesList.iterator();it.hasNext();){var e=it.next();var label=e.getLabel();if(e.isIsolated()){if(label.isNull(0))
this.labelIsolatedLine(e,0);else
this.labelIsolatedLine(e,1);}}};LineBuilder.prototype.labelIsolatedLine=function(e,targetIndex){var loc=ptLocator.locate(e.getCoordinate(),op.getArgGeometry(targetIndex));e.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.LineBuilder=LineBuilder;})();(function(){var ArrayList=javascript.util.ArrayList;var PointBuilder=function(op,geometryFactory,ptLocator){this.resultPointList=new ArrayList();this.op=op;this.geometryFactory=geometryFactory;};PointBuilder.prototype.op=null;PointBuilder.prototype.geometryFactory=null;PointBuilder.prototype.resultPointList=null;PointBuilder.prototype.build=function(opCode){this.extractNonCoveredResultNodes(opCode);return this.resultPointList;};PointBuilder.prototype.extractNonCoveredResultNodes=function(opCode){for(var nodeit=this.op.getGraph().getNodes().iterator();nodeit.hasNext();){var n=nodeit.next();if(n.isInResult())
continue;if(n.isIncidentEdgeInResult())
continue;if(n.getEdges().getDegree()===0||opCode===jsts.operation.overlay.OverlayOp.INTERSECTION){var label=n.getLabel();if(jsts.operation.overlay.OverlayOp.isResultOfOp(label,opCode)){this.filterCoveredNodeToPoint(n);}}}};PointBuilder.prototype.filterCoveredNodeToPoint=function(n){var coord=n.getCoordinate();if(!this.op.isCoveredByLA(coord)){var pt=this.geometryFactory.createPoint(coord);this.resultPointList.add(pt);}};jsts.operation.overlay.PointBuilder=PointBuilder;})();(function(){var PointLocator=jsts.algorithm.PointLocator;var Location=jsts.geom.Location;var EdgeList=jsts.geomgraph.EdgeList;var Label=jsts.geomgraph.Label;var PlanarGraph=jsts.geomgraph.PlanarGraph;var Position=jsts.geomgraph.Position;var EdgeNodingValidator=jsts.geomgraph.EdgeNodingValidator;var GeometryGraphOperation=jsts.operation.GeometryGraphOperation;var OverlayNodeFactory=jsts.operation.overlay.OverlayNodeFactory;var PolygonBuilder=jsts.operation.overlay.PolygonBuilder;var LineBuilder=jsts.operation.overlay.LineBuilder;var PointBuilder=jsts.operation.overlay.PointBuilder;var Assert=jsts.util.Assert;var ArrayList=javascript.util.ArrayList;jsts.operation.overlay.OverlayOp=function(g0,g1){this.ptLocator=new PointLocator();this.edgeList=new EdgeList();this.resultPolyList=new ArrayList();this.resultLineList=new ArrayList();this.resultPointList=new ArrayList();GeometryGraphOperation.call(this,g0,g1);this.graph=new PlanarGraph(new OverlayNodeFactory());this.geomFact=g0.getFactory();};jsts.operation.overlay.OverlayOp.prototype=new GeometryGraphOperation();jsts.operation.overlay.OverlayOp.constructor=jsts.operation.overlay.OverlayOp;jsts.operation.overlay.OverlayOp.INTERSECTION=1;jsts.operation.overlay.OverlayOp.UNION=2;jsts.operation.overlay.OverlayOp.DIFFERENCE=3;jsts.operation.overlay.OverlayOp.SYMDIFFERENCE=4;jsts.operation.overlay.OverlayOp.overlayOp=function(geom0,geom1,opCode){var gov=new jsts.operation.overlay.OverlayOp(geom0,geom1);var geomOv=gov.getResultGeometry(opCode);return geomOv;}
jsts.operation.overlay.OverlayOp.isResultOfOp=function(label,opCode){if(arguments.length===3){return jsts.operation.overlay.OverlayOp.isResultOfOp2.apply(this,arguments);}
var loc0=label.getLocation(0);var loc1=label.getLocation(1);return jsts.operation.overlay.OverlayOp.isResultOfOp2(loc0,loc1,opCode);}
jsts.operation.overlay.OverlayOp.isResultOfOp2=function(loc0,loc1,opCode){if(loc0==Location.BOUNDARY)
loc0=Location.INTERIOR;if(loc1==Location.BOUNDARY)
loc1=Location.INTERIOR;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:return loc0==Location.INTERIOR&&loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.UNION:return loc0==Location.INTERIOR||loc1==Location.INTERIOR;case jsts.operation.overlay.OverlayOp.DIFFERENCE:return loc0==Location.INTERIOR&&loc1!=Location.INTERIOR;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:return(loc0==Location.INTERIOR&&loc1!=Location.INTERIOR)||(loc0!=Location.INTERIOR&&loc1==Location.INTERIOR);}
return false;}
jsts.operation.overlay.OverlayOp.prototype.ptLocator=null;jsts.operation.overlay.OverlayOp.prototype.geomFact=null;jsts.operation.overlay.OverlayOp.prototype.resultGeom=null;jsts.operation.overlay.OverlayOp.prototype.graph=null;jsts.operation.overlay.OverlayOp.prototype.edgeList=null;jsts.operation.overlay.OverlayOp.prototype.resultPolyList=null;jsts.operation.overlay.OverlayOp.prototype.resultLineList=null;jsts.operation.overlay.OverlayOp.prototype.resultPointList=null;jsts.operation.overlay.OverlayOp.prototype.getResultGeometry=function(funcCode){this.computeOverlay(funcCode);return this.resultGeom;}
jsts.operation.overlay.OverlayOp.prototype.getGraph=function(){return this.graph;}
jsts.operation.overlay.OverlayOp.prototype.computeOverlay=function(opCode){this.copyPoints(0);this.copyPoints(1);this.arg[0].computeSelfNodes(this.li,false);this.arg[1].computeSelfNodes(this.li,false);this.arg[0].computeEdgeIntersections(this.arg[1],this.li,true);var baseSplitEdges=new ArrayList();this.arg[0].computeSplitEdges(baseSplitEdges);this.arg[1].computeSplitEdges(baseSplitEdges);var splitEdges=baseSplitEdges;this.insertUniqueEdges(baseSplitEdges);this.computeLabelsFromDepths();this.replaceCollapsedEdges();EdgeNodingValidator.checkValid(this.edgeList.getEdges());this.graph.addEdges(this.edgeList.getEdges());this.computeLabelling();this.labelIncompleteNodes();this.findResultAreaEdges(opCode);this.cancelDuplicateResultEdges();var polyBuilder=new PolygonBuilder(this.geomFact);polyBuilder.add(this.graph);this.resultPolyList=polyBuilder.getPolygons();var lineBuilder=new LineBuilder(this,this.geomFact,this.ptLocator);this.resultLineList=lineBuilder.build(opCode);var pointBuilder=new PointBuilder(this,this.geomFact,this.ptLocator);this.resultPointList=pointBuilder.build(opCode);this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,opCode);}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdges=function(edges){for(var i=edges.iterator();i.hasNext();){var e=i.next();this.insertUniqueEdge(e);}}
jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!==null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new Label(e.getLabel());labelToMerge.flip();}
var depth=existingEdge.getDepth();if(depth.isNull()){depth.add(existingLabel);}
depth.add(labelToMerge);existingLabel.merge(labelToMerge);}else{this.edgeList.add(e);}};jsts.operation.overlay.OverlayOp.prototype.computeLabelsFromDepths=function(){for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();var lbl=e.getLabel();var depth=e.getDepth();if(!depth.isNull()){depth.normalize();for(var i=0;i<2;i++){if(!lbl.isNull(i)&&lbl.isArea()&&!depth.isNull(i)){if(depth.getDelta(i)==0){lbl.toLine(i);}else{Assert.isTrue(!depth.isNull(i,Position.LEFT),'depth of LEFT side has not been initialized');lbl.setLocation(i,Position.LEFT,depth.getLocation(i,Position.LEFT));Assert.isTrue(!depth.isNull(i,Position.RIGHT),'depth of RIGHT side has not been initialized');lbl.setLocation(i,Position.RIGHT,depth.getLocation(i,Position.RIGHT));}}}}}}
jsts.operation.overlay.OverlayOp.prototype.replaceCollapsedEdges=function(){var newEdges=new ArrayList();for(var it=this.edgeList.iterator();it.hasNext();){var e=it.next();if(e.isCollapsed()){it.remove();newEdges.add(e.getCollapsedEdge());}}
this.edgeList.addAll(newEdges);}
jsts.operation.overlay.OverlayOp.prototype.copyPoints=function(argIndex){for(var i=this.arg[argIndex].getNodeIterator();i.hasNext();){var graphNode=i.next();var newNode=this.graph.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}}
jsts.operation.overlay.OverlayOp.prototype.computeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().computeLabelling(this.arg);}
this.mergeSymLabels();this.updateNodeLabelling();}
jsts.operation.overlay.OverlayOp.prototype.mergeSymLabels=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();node.getEdges().mergeSymLabels();}}
jsts.operation.overlay.OverlayOp.prototype.updateNodeLabelling=function(){for(var nodeit=this.graph.getNodes().iterator();nodeit.hasNext();){var node=nodeit.next();var lbl=node.getEdges().getLabel();node.getLabel().merge(lbl);}}
jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNodes=function(){var nodeCount=0;for(var ni=this.graph.getNodes().iterator();ni.hasNext();){var n=ni.next();var label=n.getLabel();if(n.isIsolated()){nodeCount++;if(label.isNull(0))
this.labelIncompleteNode(n,0);else
this.labelIncompleteNode(n,1);}
n.getEdges().updateLabelling(label);}};jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNode=function(n,targetIndex){var loc=this.ptLocator.locate(n.getCoordinate(),this.arg[targetIndex].getGeometry());n.getLabel().setLocation(targetIndex,loc);};jsts.operation.overlay.OverlayOp.prototype.findResultAreaEdges=function(opCode){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var label=de.getLabel();if(label.isArea()&&!de.isInteriorAreaEdge()&&jsts.operation.overlay.OverlayOp.isResultOfOp(label.getLocation(0,Position.RIGHT),label.getLocation(1,Position.RIGHT),opCode)){de.setInResult(true);}}};jsts.operation.overlay.OverlayOp.prototype.cancelDuplicateResultEdges=function(){for(var it=this.graph.getEdgeEnds().iterator();it.hasNext();){var de=it.next();var sym=de.getSym();if(de.isInResult()&&sym.isInResult()){de.setInResult(false);sym.setInResult(false);}}};jsts.operation.overlay.OverlayOp.prototype.isCoveredByLA=function(coord){if(this.isCovered(coord,this.resultLineList))
return true;if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCoveredByA=function(coord){if(this.isCovered(coord,this.resultPolyList))
return true;return false;};jsts.operation.overlay.OverlayOp.prototype.isCovered=function(coord,geomList){for(var it=geomList.iterator();it.hasNext();){var geom=it.next();var loc=this.ptLocator.locate(coord,geom);if(loc!=Location.EXTERIOR)
return true;}
return false;};jsts.operation.overlay.OverlayOp.prototype.computeGeometry=function(resultPointList,resultLineList,resultPolyList,opcode){var geomList=new ArrayList();geomList.addAll(resultPointList);geomList.addAll(resultLineList);geomList.addAll(resultPolyList);return this.geomFact.buildGeometry(geomList);};jsts.operation.overlay.OverlayOp.prototype.createEmptyResult=function(opCode){var result=null;switch(resultDimension(opCode,this.arg[0].getGeometry(),this.arg[1].getGeometry())){case-1:result=geomFact.createGeometryCollection();break;case 0:result=geomFact.createPoint(null);break;case 1:result=geomFact.createLineString(null);break;case 2:result=geomFact.createPolygon(null,null);break;}
return result;};jsts.operation.overlay.OverlayOp.prototype.resultDimension=function(opCode,g0,g1){var dim0=g0.getDimension();var dim1=g1.getDimension();var resultDimension=-1;switch(opCode){case jsts.operation.overlay.OverlayOp.INTERSECTION:resultDimension=Math.min(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.UNION:resultDimension=Math.max(dim0,dim1);break;case jsts.operation.overlay.OverlayOp.DIFFERENCE:resultDimension=dim0;break;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:resultDimension=Math.max(dim0,dim1);break;}
return resultDimension;};})();(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var GeometrySnapper=jsts.operation.overlay.snap.GeometrySnapper;var SnapOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;this.computeSnapTolerance();};SnapOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapOverlayOp.intersection=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapOverlayOp.union=function(g0,g1){return this.overlayOp(g0,g1,OverlayOp.UNION);};SnapOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapOverlayOp.prototype.geom=null;SnapOverlayOp.prototype.snapTolerance=null;SnapOverlayOp.prototype.computeSnapTolerance=function(){this.snapTolerance=GeometrySnapper.computeOverlaySnapTolerance(this.geom[0],this.geom[1]);};SnapOverlayOp.prototype.getResultGeometry=function(opCode){var prepGeom=this.snap(this.geom);var result=OverlayOp.overlayOp(prepGeom[0],prepGeom[1],opCode);return this.prepareResult(result);};SnapOverlayOp.prototype.selfSnap=function(geom){var snapper0=new GeometrySnapper(geom);var snapGeom=snapper0.snapTo(geom,this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.snap=function(geom){var remGeom=geom;var snapGeom=GeometrySnapper.snap(remGeom[0],remGeom[1],this.snapTolerance);return snapGeom;};SnapOverlayOp.prototype.prepareResult=function(geom){return geom;};SnapOverlayOp.prototype.cbr=null;SnapOverlayOp.prototype.removeCommonBits=function(geom){this.cbr=new jsts.precision.CommonBitsRemover();this.cbr.add(this.geom[0]);this.cbr.add(this.geom[1]);var remGeom=[];remGeom[0]=cbr.removeCommonBits(this.geom[0].clone());remGeom[1]=cbr.removeCommonBits(this.geom[1].clone());return remGeom;};jsts.operation.overlay.snap.SnapOverlayOp=SnapOverlayOp;})();jsts.geomgraph.index.EdgeSetIntersector=function(){};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){throw new jsts.error.AbstractMethodInvocationError();};jsts.geomgraph.index.SimpleMCSweepLineIntersector=function(){this.events=[];};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.events=null;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.addList2(edges,null);}else{this.addList(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.addList2(edges0,edges0);this.addList2(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.addList.apply(this,arguments);return;}
var mce=edge.getMonotoneChainEdge();var startIndex=mce.getStartIndexes();for(var i=0;i<startIndex.length-1;i++){var mc=new jsts.geomgraph.index.MonotoneChain(mce,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(mce.getMinX(i),mc,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(mce.getMaxX(i),insertEvent));}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList=function(edges){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edge);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();this.add(edge,edgeSet);}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var mc0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var mc1=ev1.getObject();if(!ev0.isSameLabel(ev1)){mc0.computeIntersections(mc1,si);this.nOverlaps++;}}}};jsts.algorithm.locate.SimplePointInAreaLocator=function(geom){this.geom=geom;};jsts.algorithm.locate.SimplePointInAreaLocator.locate=function(p,geom){if(geom.isEmpty())
return jsts.geom.Location.EXTERIOR;if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,geom))
return jsts.geom.Location.INTERIOR;return jsts.geom.Location.EXTERIOR;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint=function(p,geom){if(geom instanceof jsts.geom.Polygon){return jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon(p,geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){for(var i=0;i<geom.geometries.length;i++){var g2=geom.geometries[i];if(g2!==geom)
if(jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(p,g2))
return true;}}
return false;};jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon=function(p,poly){if(poly.isEmpty())
return false;var shell=poly.getExteriorRing();if(!jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,shell))
return false;for(var i=0;i<poly.getNumInteriorRing();i++){var hole=poly.getInteriorRingN(i);if(jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(p,hole))
return false;}
return true;};jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing=function(p,ring){if(!ring.getEnvelopeInternal().intersects(p))
return false;return jsts.algorithm.CGAlgorithms.isPointInRing(p,ring.getCoordinates());};jsts.algorithm.locate.SimplePointInAreaLocator.prototype.geom=null;jsts.algorithm.locate.SimplePointInAreaLocator.prototype.locate=function(p){return jsts.algorithm.locate.SimplePointInAreaLocator.locate(p,geom);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEndStar=jsts.geomgraph.EdgeEndStar;var Assert=jsts.util.Assert;jsts.geomgraph.DirectedEdgeStar=function(){jsts.geomgraph.EdgeEndStar.call(this);};jsts.geomgraph.DirectedEdgeStar.prototype=new EdgeEndStar();jsts.geomgraph.DirectedEdgeStar.constructor=jsts.geomgraph.DirectedEdgeStar;jsts.geomgraph.DirectedEdgeStar.prototype.resultAreaEdgeList=null;jsts.geomgraph.DirectedEdgeStar.prototype.label=null;jsts.geomgraph.DirectedEdgeStar.prototype.insert=function(ee){var de=ee;this.insertEdgeEnd(de,de);};jsts.geomgraph.DirectedEdgeStar.prototype.getLabel=function(){return this.label;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult())
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(er){var degree=0;for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.getEdgeRing()===er)
degree++;}
return degree;};jsts.geomgraph.DirectedEdgeStar.prototype.getRightmostEdge=function(){var edges=this.getEdges();var size=edges.size();if(size<1)
return null;var de0=edges.get(0);if(size==1)
return de0;var deLast=edges.get(size-1);var quad0=de0.getQuadrant();var quad1=deLast.getQuadrant();if(jsts.geomgraph.Quadrant.isNorthern(quad0)&&jsts.geomgraph.Quadrant.isNorthern(quad1))
return de0;else if(!jsts.geomgraph.Quadrant.isNorthern(quad0)&&!jsts.geomgraph.Quadrant.isNorthern(quad1))
return deLast;else{var nonHorizontalEdge=null;if(de0.getDy()!=0)
return de0;else if(deLast.getDy()!=0)
return deLast;}
Assert.shouldNeverReachHere('found two horizontal edges incident on node');return null;};jsts.geomgraph.DirectedEdgeStar.prototype.computeLabelling=function(geom){EdgeEndStar.prototype.computeLabelling.call(this,geom);this.label=new jsts.geomgraph.Label(Location.NONE);for(var it=this.iterator();it.hasNext();){var ee=it.next();var e=ee.getEdge();var eLabel=e.getLabel();for(var i=0;i<2;i++){var eLoc=eLabel.getLocation(i);if(eLoc===Location.INTERIOR||eLoc===Location.BOUNDARY)
this.label.setLocation(i,Location.INTERIOR);}}};jsts.geomgraph.DirectedEdgeStar.prototype.mergeSymLabels=function(){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.merge(de.getSym().getLabel());}};jsts.geomgraph.DirectedEdgeStar.prototype.updateLabelling=function(nodeLabel){for(var it=this.iterator();it.hasNext();){var de=it.next();var label=de.getLabel();label.setAllLocationsIfNull(0,nodeLabel.getLocation(0));label.setAllLocationsIfNull(1,nodeLabel.getLocation(1));}};jsts.geomgraph.DirectedEdgeStar.prototype.getResultAreaEdges=function(){if(this.resultAreaEdgeList!==null)
return this.resultAreaEdgeList;this.resultAreaEdgeList=new javascript.util.ArrayList();for(var it=this.iterator();it.hasNext();){var de=it.next();if(de.isInResult()||de.getSym().isInResult())
this.resultAreaEdgeList.add(de);}
return this.resultAreaEdgeList;};jsts.geomgraph.DirectedEdgeStar.prototype.SCANNING_FOR_INCOMING=1;jsts.geomgraph.DirectedEdgeStar.prototype.LINKING_TO_OUTGOING=2;jsts.geomgraph.DirectedEdgeStar.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=0;i<this.resultAreaEdgeList.size();i++){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(!nextOut.getLabel().isArea())
continue;if(firstOut===null&&nextOut.isInResult())
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(!nextIn.isInResult())
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!nextOut.isInResult())
continue;incoming.setNext(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){if(firstOut===null)
throw new jsts.error.TopologyError('no outgoing dirEdge found',this.getCoordinate());Assert.isTrue(firstOut.isInResult(),'unable to link last incoming dirEdge');incoming.setNext(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkMinimalDirectedEdges=function(er){var firstOut=null;var incoming=null;var state=this.SCANNING_FOR_INCOMING;for(var i=this.resultAreaEdgeList.size()-1;i>=0;i--){var nextOut=this.resultAreaEdgeList.get(i);var nextIn=nextOut.getSym();if(firstOut===null&&nextOut.getEdgeRing()===er)
firstOut=nextOut;switch(state){case this.SCANNING_FOR_INCOMING:if(nextIn.getEdgeRing()!=er)
continue;incoming=nextIn;state=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(nextOut.getEdgeRing()!==er)
continue;incoming.setNextMin(nextOut);state=this.SCANNING_FOR_INCOMING;break;}}
if(state===this.LINKING_TO_OUTGOING){Assert.isTrue(firstOut!==null,'found null for first outgoing dirEdge');Assert.isTrue(firstOut.getEdgeRing()===er,'unable to link last incoming dirEdge');incoming.setNextMin(firstOut);}};jsts.geomgraph.DirectedEdgeStar.prototype.linkAllDirectedEdges=function(){this.getEdges();var prevOut=null;var firstIn=null;for(var i=this.edgeList.size()-1;i>=0;i--){var nextOut=this.edgeList.get(i);var nextIn=nextOut.getSym();if(firstIn===null)
firstIn=nextIn;if(prevOut!==null)
nextIn.setNext(prevOut);prevOut=nextOut;}
firstIn.setNext(prevOut);};jsts.geomgraph.DirectedEdgeStar.prototype.findCoveredLineEdges=function(){var startLoc=Location.NONE;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(!nextOut.isLineEdge()){if(nextOut.isInResult()){startLoc=Location.INTERIOR;break;}
if(nextIn.isInResult()){startLoc=Location.EXTERIOR;break;}}}
if(startLoc===Location.NONE)
return;var currLoc=startLoc;for(var it=this.iterator();it.hasNext();){var nextOut=it.next();var nextIn=nextOut.getSym();if(nextOut.isLineEdge()){nextOut.getEdge().setCovered(currLoc===Location.INTERIOR);}else{if(nextOut.isInResult())
currLoc=Location.EXTERIOR;if(nextIn.isInResult())
currLoc=Location.INTERIOR;}}};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths=function(de){if(arguments.length===2){this.computeDepths2.apply(this,arguments);return;}
var edgeIndex=this.findIndex(de);var label=de.getLabel();var startDepth=de.getDepth(Position.LEFT);var targetLastDepth=de.getDepth(Position.RIGHT);var nextDepth=this.computeDepths2(edgeIndex+1,this.edgeList.size(),startDepth);var lastDepth=this.computeDepths2(0,edgeIndex,nextDepth);if(lastDepth!=targetLastDepth)
throw new jsts.error.TopologyError('depth mismatch at '+
de.getCoordinate());};jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths2=function(startIndex,endIndex,startDepth){var currDepth=startDepth;for(var i=startIndex;i<endIndex;i++){var nextDe=this.edgeList.get(i);var label=nextDe.getLabel();nextDe.setEdgeDepths(Position.RIGHT,currDepth);currDepth=nextDe.getDepth(Position.LEFT);}
return currDepth;};})();jsts.algorithm.CentroidLine=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidLine.prototype.centSum=null;jsts.algorithm.CentroidLine.prototype.totalLength=0.0;jsts.algorithm.CentroidLine.prototype.add=function(geom){if(geom instanceof Array){this.add2.apply(this,arguments);return;}
if(geom instanceof jsts.geom.LineString){this.add(geom.getCoordinates());}else if(geom instanceof jsts.geom.Polygon){var poly=geom;this.add(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.add(poly.getInteriorRingN(i).getCoordinates());}}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidLine.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;return cent;};jsts.algorithm.CentroidLine.prototype.add2=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.index.IntervalSize=function(){};jsts.index.IntervalSize.MIN_BINARY_EXPONENT=-50;jsts.index.IntervalSize.isZeroWidth=function(min,max){var width=max-min;if(width===0.0){return true;}
var maxAbs,scaledInterval,level;maxAbs=Math.max(Math.abs(min),Math.abs(max));scaledInterval=width/maxAbs;level=jsts.index.DoubleBits.exponent(scaledInterval);return level<=jsts.index.IntervalSize.MIN_BINARY_EXPONENT;};jsts.geomgraph.index.SimpleEdgeSetIntersector=function(){};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.nOverlaps=0;jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
this.nOverlaps=0;for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges.iterator();i1.hasNext();){var edge1=i1.next();if(testAllSegments||edge0!=edge1)
this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.nOverlaps=0;for(var i0=edges0.iterator();i0.hasNext();){var edge0=i0.next();for(var i1=edges1.iterator();i1.hasNext();){var edge1=i1.next();this.computeIntersects(edge0,edge1,si);}}};jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersects=function(e0,e1,si){var pts0=e0.getCoordinates();var pts1=e1.getCoordinates();var i0,i1;for(i0=0;i0<pts0.length-1;i0++){for(i1=0;i1<pts1.length-1;i1++){si.addIntersections(e0,i0,e1,i1);}}};jsts.geomgraph.Edge=function(pts,label){this.pts=pts;this.label=label;this.eiList=new jsts.geomgraph.EdgeIntersectionList(this);this.depth=new jsts.geomgraph.Depth();};jsts.geomgraph.Edge.prototype=new jsts.geomgraph.GraphComponent();jsts.geomgraph.Edge.constructor=jsts.geomgraph.Edge;jsts.geomgraph.Edge.updateIM=function(label,im){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.ON),label.getLocation(1,jsts.geomgraph.Position.ON),1);if(label.isArea()){im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.LEFT),label.getLocation(1,jsts.geomgraph.Position.LEFT),2);im.setAtLeastIfValid(label.getLocation(0,jsts.geomgraph.Position.RIGHT),label.getLocation(1,jsts.geomgraph.Position.RIGHT),2);}};jsts.geomgraph.Edge.prototype.pts=null;jsts.geomgraph.Edge.prototype.env=null;jsts.geomgraph.Edge.prototype.name=null;jsts.geomgraph.Edge.prototype.mce=null;jsts.geomgraph.Edge.prototype._isIsolated=true;jsts.geomgraph.Edge.prototype.depth=null;jsts.geomgraph.Edge.prototype.depthDelta=0;jsts.geomgraph.Edge.prototype.eiList=null;jsts.geomgraph.Edge.prototype.getNumPoints=function(){return this.pts.length;};jsts.geomgraph.Edge.prototype.getEnvelope=function(){if(this.env===null){this.env=new jsts.geom.Envelope();for(var i=0;i<this.pts.length;i++){this.env.expandToInclude(pts[i]);}}
return env;};jsts.geomgraph.Edge.prototype.getDepth=function(){return this.depth;};jsts.geomgraph.Edge.prototype.getDepthDelta=function(){return this.depthDelta;};jsts.geomgraph.Edge.prototype.setDepthDelta=function(depthDelta){this.depthDelta=depthDelta;};jsts.geomgraph.Edge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.Edge.prototype.getCoordinate=function(i){if(i===undefined){if(this.pts.length>0){return this.pts[0];}else{return null;}}
return this.pts[i];};jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.setIsolated=function(isIsolated){this._isIsolated=isIsolated;};jsts.geomgraph.Edge.prototype.isIsolated=function(){return this._isIsolated;};jsts.geomgraph.Edge.prototype.addIntersections=function(li,segmentIndex,geomIndex){for(var i=0;i<li.getIntersectionNum();i++){this.addIntersection(li,segmentIndex,geomIndex,i);}};jsts.geomgraph.Edge.prototype.addIntersection=function(li,segmentIndex,geomIndex,intIndex){var intPt=new jsts.geom.Coordinate(li.getIntersection(intIndex));var normalizedSegmentIndex=segmentIndex;var dist=li.getEdgeDistance(geomIndex,intIndex);var nextSegIndex=normalizedSegmentIndex+1;if(nextSegIndex<this.pts.length){var nextPt=this.pts[nextSegIndex];if(intPt.equals2D(nextPt)){normalizedSegmentIndex=nextSegIndex;dist=0.0;}}
var ei=this.eiList.add(intPt,normalizedSegmentIndex,dist);};jsts.geomgraph.Edge.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1;};jsts.geomgraph.Edge.prototype.getEdgeIntersectionList=function(){return this.eiList;};jsts.geomgraph.Edge.prototype.getMonotoneChainEdge=function(){if(this.mce==null){this.mce=new jsts.geomgraph.index.MonotoneChainEdge(this);}
return this.mce;};jsts.geomgraph.Edge.prototype.isClosed=function()
{return this.pts[0].equals(this.pts[this.pts.length-1]);};jsts.geomgraph.Edge.prototype.isCollapsed=function()
{if(!this.label.isArea())return false;if(this.pts.length!=3)return false;if(this.pts[0].equals(this.pts[2]))return true;return false;};jsts.geomgraph.Edge.prototype.getCollapsedEdge=function()
{var newPts=[];newPts[0]=this.pts[0];newPts[1]=this.pts[1];var newe=new jsts.geomgraph.Edge(newPts,jsts.geomgraph.Label.toLineLabel(this.label));return newe;};jsts.geomgraph.Edge.prototype.computeIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.geomgraph.Edge.prototype.isPointwiseEqual=function(e)
{if(this.pts.length!=e.pts.length)return false;for(var i=0;i<this.pts.length;i++){if(!this.pts[i].equals2D(e.pts[i])){return false;}}
return true;};jsts.noding.Octant=function(){throw jsts.error.AbstractMethodInvocationError();};jsts.noding.Octant.octant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.noding.Octant.octant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for point ( '+dx+', '+dy+' )');var adx=Math.abs(dx);var ady=Math.abs(dy);if(dx>=0){if(dy>=0){if(adx>=ady)
return 0;else
return 1;}
else{if(adx>=ady)
return 7;else
return 6;}}
else{if(dy>=0){if(adx>=ady)
return 3;else
return 2;}
else{if(adx>=ady)
return 4;else
return 5;}}};jsts.noding.Octant.octant2=function(p0,p1){var dx=p1.x-p0.x;var dy=p1.y-p0.y;if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the octant for two identical points '+p0);return jsts.noding.Octant.octant(dx,dy);};jsts.operation.union.UnionInteracting=function(g0,g1){this.g0=g0;this.g1=g1;this.geomFactory=g0.getFactory();this.interacts0=[];this.interacts1=[];};jsts.operation.union.UnionInteracting.union=function(g0,g1){var uue=new jsts.operation.union.UnionInteracting(g0,g1);return uue.union();};jsts.operation.union.UnionInteracting.prototype.geomFactory=null;jsts.operation.union.UnionInteracting.prototype.g0=null;jsts.operation.union.UnionInteracting.prototype.g1=null;jsts.operation.union.UnionInteracting.prototype.interacts0=null;jsts.operation.union.UnionInteracting.prototype.interacts1=null;jsts.operation.union.UnionInteracting.prototype.union=function(){this.computeInteracting();var int0=this.extractElements(this.g0,this.interacts0,true);var int1=this.extractElements(this.g1,this.interacts1,true);if(int0.isEmpty()||int1.isEmpty()){}
var union=in0.union(int1);var disjoint0=this.extractElements(this.g0,this.interacts0,false);var disjoint1=this.extractElements(this.g1,this.interacts1,false);var overallUnion=jsts.geom.util.GeometryCombiner.combine(union,disjoint0,disjoint1);return overallUnion;};jsts.operation.union.UnionInteracting.prototype.bufferUnion=function(g0,g1){var factory=g0.getFactory();var gColl=factory.createGeometryCollection([g0,g1]);var unionAll=gColl.buffer(0.0);return unionAll;};jsts.operation.union.UnionInteracting.prototype.computeInteracting=function(elem0){if(!elem0){for(var i=0,l=this.g0.getNumGeometries();i<l;i++){var elem=this.g0.getGeometryN(i);this.interacts0[i]=this.computeInteracting(elem);}}
else{var interactsWithAny=false;for(var i=0,l=g1.getNumGeometries();i<l;i++){var elem1=this.g1.getGeometryN(i);var interacts=elem1.getEnvelopeInternal().intersects(elem0.getEnvelopeInternal());if(interacts){this.interacts1[i]=true;interactsWithAny=true;}}
return interactsWithAny;}};jsts.operation.union.UnionInteracting.prototype.extractElements=function(geom,interacts,isInteracting){var extractedGeoms=[];for(var i=0,l=geom.getNumGeometries();i<l;i++){var elem=geom.getGeometryN(i);if(interacts[i]===isInteracting){extractedGeoms.push(elem);}}
return this.geomFactory.buildGeometry(extractedGeoms);};jsts.triangulate.quadedge.TrianglePredicate=function(){};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNonRobust=function(a,b,c,p){var isInCircle=(a.x*a.x+a.y*a.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(b,c,p)-
(b.x*b.x+b.y*b.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,c,p)+
(c.x*c.x+c.y*c.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,p)-
(p.x*p.x+p.y*p.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(a,b,c)>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,disc;adx=a.x-p.x;ady=a.y-p.y;bdx=b.x-p.x;bdy=b.y-p.y;cdx=c.x-p.x;cdy=c.y-p.y;abdet=adx*bdy-bdx*ady;bcdet=bdx*cdy-cdx*bdy;cadet=cdx*ady-adx*cdy;alift=adx*adx+ady*ady;blift=bdx*bdx+bdy*bdy;clift=cdx*cdx+cdy*cdy;disc=alift*bcdet+blift*cadet+clift*abdet;return disc>0;};jsts.triangulate.quadedge.TrianglePredicate.triArea=function(a,b,c){return(b.x-a.x)*(c.y-a.y)-(b.y-a.y)*(c.x-a.x);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust=function(a,b,c,p){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized(a,b,c,p);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDSlow=function(a,b,c,p){var px,py,ax,ay,bx,by,cx,cy,aTerm,bTerm,cTerm,pTerm,sum,isInCircle;px=jsts.math.DD.valueOf(p.x);py=jsts.math.DD.valueOf(p.y);ax=jsts.math.DD.valueOf(a.x);ay=jsts.math.DD.valueOf(a.y);bx=jsts.math.DD.valueOf(b.x);by=jsts.math.DD.valueOf(b.y);cx=jsts.math.DD.valueOf(c.x);cy=jsts.math.DD.valueOf(c.y);aTerm=(ax.multiply(ax).add(ay.multiply(ay))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(bx,by,cx,cy,px,py));bTerm=(bx.multiply(bx).add(by.multiply(by))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,cx,cy,px,py));cTerm=(cx.multiply(cx).add(cy.multiply(cy))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,px,py));pTerm=(px.multiply(px).add(py.multiply(py))).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(ax,ay,bx,by,cx,cy));sum=aTerm.subtract(bTerm).add(cTerm).subtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow=function(ax,ay,bx,by,cx,cy){return(bx.subtract(ax).multiply(cy.subtract(ay)).subtract(by.subtract(ay).multiply(cx.subtract(ax))));};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDFast=function(a,b,c,p){var aTerm,bTerm,cTerm,pTerm,sum,isInCircle;aTerm=(jsts.math.DD.sqr(a.x).selfAdd(jsts.math.DD.sqr(a.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(b,c,p));bTerm=(jsts.math.DD.sqr(b.x).selfAdd(jsts.math.DD.sqr(b.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,c,p));cTerm=(jsts.math.DD.sqr(c.x).selfAdd(jsts.math.DD.sqr(c.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,p));pTerm=(jsts.math.DD.sqr(p.x).selfAdd(jsts.math.DD.sqr(p.y))).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(a,b,c));sum=aTerm.selfSubtract(bTerm).selfAdd(cTerm).selfSubtract(pTerm);isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast=function(a,b,c){var t1,t2;t1=jsts.math.DD.valueOf(b.x).selfSubtract(a.x).selfMultiply(jsts.math.DD.valueOf(c.y).selfSubtract(a.y));t2=jsts.math.DD.valueOf(b.y).selSubtract(a.y).selfMultiply(jsts.math.DD.valueOf(c.x).selfSubtract(a.x));return t1.selfSubtract(t2);};jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDNormalized=function(a,b,c,p){var adx,ady,bdx,bdy,cdx,cdy,abdet,bcdet,cadet,alift,blift,clift,sum,isInCircle;adx=jsts.math.DD.valueOf(a.x).selfSubtract(p.x);ady=jsts.math.DD.valueOf(a.y).selfSubtract(p.y);bdx=jsts.math.DD.valueOf(b.x).selfSubtract(p.x);bdx=jsts.math.DD.valueOf(b.y).selfSubtract(p.y);cdx=jsts.math.DD.valueOf(c.x).selfSubtract(p.x);cdx=jsts.math.DD.valueOf(c.y).selfSubtract(p.y);abdet=adx.multiply(bdy).selfSubtract(bdx.multiply(ady));bcdet=bdx.multiply(cdy).selfSubtract(cdx.multiply(bdy));cadet=cdx.multiply(ady).selfSubtract(adx.multiply(cdy));alift=adx.multiply(adx).selfAdd(ady.multiply(ady));blift=bdx.multiply(bdx).selfAdd(bdy.multiply(bdy));clift=cdx.multiply(cdx).selfAdd(cdy.multiply(cdy));sum=alift.selfMultiply(bcdet).selfAdd(blift.selfMultiply(cadet)).selfAdd(clift.selfMultiply(abdet));isInCircle=sum.doubleValue()>0;return isInCircle;};jsts.triangulate.quadedge.TrianglePredicate.isInCircleCC=function(a,b,c,p){var cc,ccRadius,pRadiusDiff;cc=jsts.geom.Triangle.circumcentre(a,b,c);ccRadius=a.distance(cc);pRadiusDiff=p.distance(cc)-ccRadius;return pRadiusDiff<=0;};jsts.operation.union.PointGeometryUnion=function(pointGeom,otherGeom){this.pointGeom=pointGeom;this.otherGeom=otherGeom;this.geomFact=otherGeom.getFactory();};jsts.operation.union.PointGeometryUnion.union=function(pointGeom,otherGeom){var unioner=new jsts.operation.union.PointGeometryUnion(pointGeom,otherGeom);return unioner.union();};jsts.operation.union.PointGeometryUnion.prototype.pointGeom=null;jsts.operation.union.PointGeometryUnion.prototype.otherGeom=null;jsts.operation.union.PointGeometryUnion.prototype.geomFact=null;jsts.operation.union.PointGeometryUnion.prototype.union=function(){var locator=new jsts.algorithm.PointLocator();var exteriorCoords=[];for(var i=0,l=this.pointGeom.getNumGeometries();i<l;i++){var point=this.pointGeom.getGeometryN(i);var coord=point.getCoordinate();var loc=locator.locate(coord,this.otherGeom);if(loc===jsts.geom.Location.EXTERIOR){var include=true;for(var j=exteriorCoords.length;i--;){if(exteriorCoords[j].equals(coord)){include=false;break;}}
if(include){exteriorCoords.push(coord);}}}
exteriorCoords.sort(function(x,y){return x.compareTo(y);});if(exteriorCoords.length===0){return this.otherGeom;}
var ptComp=null;var coords=jsts.geom.CoordinateArrays.toCoordinateArray(exteriorCoords);if(coords.length===1){ptComp=this.geomFact.createPoint(coords[0]);}
else{ptComp=this.geomFact.createMultiPoint(coords);}
return jsts.geom.util.GeometryCombiner.combine(ptComp,this.otherGeom);};jsts.noding.IntersectionFinderAdder=function(li){this.li=li;this.interiorIntersections=new javascript.util.ArrayList();};jsts.noding.IntersectionFinderAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionFinderAdder.constructor=jsts.noding.IntersectionFinderAdder;jsts.noding.IntersectionFinderAdder.prototype.li=null;jsts.noding.IntersectionFinderAdder.prototype.interiorIntersections=null;jsts.noding.IntersectionFinderAdder.prototype.getInteriorIntersections=function(){return this.interiorIntersections;};jsts.noding.IntersectionFinderAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.li.isInteriorIntersection()){for(var intIndex=0;intIndex<this.li.getIntersectionNum();intIndex++){this.interiorIntersections.add(this.li.getIntersection(intIndex));}
e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}}};jsts.noding.IntersectionFinderAdder.prototype.isDone=function(){return false;};jsts.noding.snapround.MCIndexSnapRounder=function(pm){this.pm=pm;this.li=new jsts.algorithm.RobustLineIntersector();this.li.setPrecisionModel(pm);this.scaleFactor=pm.getScale();};jsts.noding.snapround.MCIndexSnapRounder.prototype=new jsts.noding.Noder();jsts.noding.snapround.MCIndexSnapRounder.constructor=jsts.noding.snapround.MCIndexSnapRounder;jsts.noding.snapround.MCIndexSnapRounder.prototype.pm=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.li=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.scaleFactor=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.noder=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.pointSnapper=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.nodedSegStrings=null;jsts.noding.snapround.MCIndexSnapRounder.prototype.getNodedSubstrings=function(){return jsts.noding.NodedSegmentString.getNodedSubstrings(this.nodedSegStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeNodes=function(inputSegmentStrings){this.nodedSegStrings=inputSegmentStrings;this.noder=new jsts.noding.MCIndexNoder();this.pointSnapper=new jsts.noding.snapround.MCIndexPointSnapper(this.noder.getIndex());this.snapRound(inputSegmentStrings,this.li);};jsts.noding.snapround.MCIndexSnapRounder.prototype.snapRound=function(segStrings,li){var intersections=this.findInteriorIntersections(segStrings,li);this.computeIntersectionSnaps(intersections);this.computeVertexSnaps(segStrings);};jsts.noding.snapround.MCIndexSnapRounder.prototype.findInteriorIntersections=function(segStrings,li){var intFinderAdder=new jsts.noding.IntersectionFinderAdder(li);this.noder.setSegmentIntersector(intFinderAdder);this.noder.computeNodes(segStrings);return intFinderAdder.getInteriorIntersections();};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeIntersectionSnaps=function(snapPts){for(var it=snapPts.iterator();it.hasNext();){var snapPt=it.next();var hotPixel=new jsts.noding.snapround.HotPixel(snapPt,this.scaleFactor,this.li);this.pointSnapper.snap(hotPixel);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps=function(edges){if(edges instanceof jsts.noding.NodedSegmentString){this.computeVertexSnaps2.apply(this,arguments);return;}
for(var i0=edges.iterator();i0.hasNext();){var edge0=i0.next();this.computeVertexSnaps(edge0);}};jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps2=function(e){var pts0=e.getCoordinates();for(var i=0;i<pts0.length-1;i++){var hotPixel=new jsts.noding.snapround.HotPixel(pts0[i],this.scaleFactor,this.li);var isNodeAdded=this.pointSnapper.snap(hotPixel,e,i);if(isNodeAdded){e.addIntersection(pts0[i],i);}}};jsts.operation.valid.ConnectedInteriorTester=function(geomGraph){this.geomGraph=geomGraph;this.geometryFactory=new jsts.geom.GeometryFactory();this.disconnectedRingcoord=null;};jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint=function(coord,pt){var i=0,il=coord.length;for(i;i<il;i++){if(!coord[i].equals(pt))
return coord[i];}
return null;};jsts.operation.valid.ConnectedInteriorTester.prototype.getCoordinate=function(){return this.disconnectedRingcoord;};jsts.operation.valid.ConnectedInteriorTester.prototype.isInteriorsConnected=function(){var splitEdges=new javascript.util.ArrayList();this.geomGraph.computeSplitEdges(splitEdges);var graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());graph.addEdges(splitEdges);this.setInteriorEdgesInResult(graph);graph.linkResultDirectedEdges();var edgeRings=this.buildEdgeRings(graph.getEdgeEnds());this.visitShellInteriors(this.geomGraph.getGeometry(),graph);return!this.hasUnvisitedShellEdge(edgeRings);};jsts.operation.valid.ConnectedInteriorTester.prototype.setInteriorEdgesInResult=function(graph){var it=graph.getEdgeEnds().iterator(),de;while(it.hasNext()){de=it.next();if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){de.setInResult(true);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.buildEdgeRings=function(dirEdges){var edgeRings=new javascript.util.ArrayList();for(var it=dirEdges.iterator();it.hasNext();){var de=it.next();if(de.isInResult()&&de.getEdgeRing()==null){var er=new jsts.operation.overlay.MaximalEdgeRing(de,this.geometryFactory);er.linkDirectedEdgesForMinimalEdgeRings();var minEdgeRings=er.buildMinimalRings();var i=0,il=minEdgeRings.length;for(i;i<il;i++){edgeRings.add(minEdgeRings[i]);}}}
return edgeRings;};jsts.operation.valid.ConnectedInteriorTester.prototype.visitShellInteriors=function(g,graph){if(g instanceof jsts.geom.Polygon){var p=g;this.visitInteriorRing(p.getExteriorRing(),graph);}
if(g instanceof jsts.geom.MultiPolygon){var mp=g;for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);this.visitInteriorRing(p.getExteriorRing(),graph);}}};jsts.operation.valid.ConnectedInteriorTester.prototype.visitInteriorRing=function(ring,graph){var pts=ring.getCoordinates();var pt0=pts[0];var pt1=jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint(pts,pt0);var e=graph.findEdgeInSameDirection(pt0,pt1);var de=graph.findEdgeEnd(e);var intDe=null;if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de;}else if(de.getSym().getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR){intDe=de.getSym();}
this.visitLinkedDirectedEdges(intDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.visitLinkedDirectedEdges=function(start){var startDe=start;var de=start;do{de.setVisited(true);de=de.getNext();}while(de!=startDe);};jsts.operation.valid.ConnectedInteriorTester.prototype.hasUnvisitedShellEdge=function(edgeRings){for(var i=0;i<edgeRings.size();i++){var er=edgeRings.get(i);if(er.isHole()){continue;}
var edges=er.getEdges();var de=edges[0];if(de.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)!=jsts.geom.Location.INTERIOR){continue;}
for(var j=0;j<edges.length;j++){de=edges[j];if(!de.isVisited()){disconnectedRingcoord=de.getCoordinate();return true;}}}
return false;};jsts.algorithm.InteriorPointLine=function(geometry){this.centroid;this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.addInterior(geometry);if(this.interiorPoint==null){this.addEndpoints(geometry);}};jsts.algorithm.InteriorPointLine.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointLine.prototype.addInterior=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addInteriorCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addInterior(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addInteriorCoord=function(pts){for(var i=1;i<pts.length-1;i++){this.add(pts[i]);}};jsts.algorithm.InteriorPointLine.prototype.addEndpoints=function(geometry){if(geometry instanceof jsts.geom.LineString){this.addEndpointsCoord(geometry.getCoordinates());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.addEndpoints(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointLine.prototype.addEndpointsCoord=function(pts){this.add(pts[0]);this.add(pts[pts.length-1]);};jsts.algorithm.InteriorPointLine.prototype.add=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.index.chain.MonotoneChainSelectAction=function(){this.tempEnv1=new jsts.geom.Envelope();this.selectedSegment=new jsts.geom.LineSegment();};jsts.index.chain.MonotoneChainSelectAction.prototype.tempEnv1=null;jsts.index.chain.MonotoneChainSelectAction.prototype.selectedSegment=null;jsts.index.chain.MonotoneChainSelectAction.prototype.select=function(mc,start){mc.getLineSegment(start,this.selectedSegment);this.select2(this.selectedSegment);};jsts.index.chain.MonotoneChainSelectAction.prototype.select2=function(seg){};jsts.algorithm.MCPointInRing=function(ring){this.ring=ring;this.tree=null;this.crossings=0;this.interval=new jsts.index.bintree.Interval();this.buildIndex();};jsts.algorithm.MCPointInRing.MCSelecter=function(p,parent){this.parent=parent;this.p=p;};jsts.algorithm.MCPointInRing.MCSelecter.prototype=new jsts.index.chain.MonotoneChainSelectAction;jsts.algorithm.MCPointInRing.MCSelecter.prototype.constructor=jsts.algorithm.MCPointInRing.MCSelecter;jsts.algorithm.MCPointInRing.MCSelecter.prototype.select2=function(ls){this.parent.testLineSegment.apply(this.parent,[this.p,ls]);};jsts.algorithm.MCPointInRing.prototype.buildIndex=function(){this.tree=new jsts.index.bintree.Bintree();var pts=jsts.geom.CoordinateArrays.removeRepeatedPoints(this.ring.getCoordinates());var mcList=jsts.index.chain.MonotoneChainBuilder.getChains(pts);for(var i=0;i<mcList.length;i++){var mc=mcList[i];var mcEnv=mc.getEnvelope();this.interval.min=mcEnv.getMinY();this.interval.max=mcEnv.getMaxY();this.tree.insert(this.interval,mc);}};jsts.algorithm.MCPointInRing.prototype.isInside=function(pt){this.crossings=0;var rayEnv=new jsts.geom.Envelope(-Number.MAX_VALUE,Number.MAX_VALUE,pt.y,pt.y);this.interval.min=pt.y;this.interval.max=pt.y;var segs=this.tree.query(this.interval);var mcSelecter=new jsts.algorithm.MCPointInRing.MCSelecter(pt,this);for(var i=segs.iterator();i.hasNext();){var mc=i.next();this.testMonotoneChain(rayEnv,mcSelecter,mc);}
if((this.crossings%2)==1){return true;}
return false;};jsts.algorithm.MCPointInRing.prototype.testMonotoneChain=function(rayEnv,mcSelecter,mc){mc.select(rayEnv,mcSelecter);};jsts.algorithm.MCPointInRing.prototype.testLineSegment=function(p,seg){var xInt,x1,y1,x2,y2,p1,p2;p1=seg.p0;p2=seg.p1;x1=p1.x-p.x;y1=p1.y-p.y;x2=p2.x-p.x;y2=p2.y-p.y;if(((y1>0)&&(y2<=0))||((y2>0)&&(y1<=0))){xInt=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2)/(y2-y1);if(0.0<xInt){this.crossings++;}}};jsts.operation.valid.TopologyValidationError=function(errorType,pt){this.errorType=errorType;this.pt=null;if(pt!=null){this.pt=pt.clone();}};jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL=2;jsts.operation.valid.TopologyValidationError.NESTED_HOLES=3;jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR=4;jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION=5;jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION=6;jsts.operation.valid.TopologyValidationError.NESTED_SHELLS=7;jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS=8;jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS=9;jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE=10;jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED=11;jsts.operation.valid.TopologyValidationError.prototype.errMsg=['Topology Validation Error','Repeated Point','Hole lies outside shell','Holes are nested','Interior is disconnected','Self-intersection','Ring Self-intersection','Nested shells','Duplicate Rings','Too few distinct points in geometry component','Invalid Coordinate','Ring is not closed'];jsts.operation.valid.TopologyValidationError.prototype.getCoordinate=function(){return this.pt;};jsts.operation.valid.TopologyValidationError.prototype.getErrorType=function(){return this.errorType;};jsts.operation.valid.TopologyValidationError.prototype.getMessage=function(){return this.errMsg[this.errorType];};jsts.operation.valid.TopologyValidationError.prototype.toString=function(){var locStr='';if(this.pt!=null){locStr=' at or near point '+this.pt;return this.getMessage()+locStr;}
return locStr;};(function(){jsts.geom.MultiPolygon=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiPolygon.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPolygon.constructor=jsts.geom.MultiPolygon;jsts.geom.MultiPolygon.prototype.getBoundary=function(){if(this.isEmpty()){return this.getFactory().createMultiLineString(null);}
var allRings=[];for(var i=0;i<this.geometries.length;i++){var polygon=this.geometries[i];var rings=polygon.getBoundary();for(var j=0;j<rings.getNumGeometries();j++){allRings.push(rings.getGeometryN(j));}}
return this.getFactory().createMultiLineString(allRings);};jsts.geom.MultiPolygon.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPolygon.prototype.CLASS_NAME='jsts.geom.MultiPolygon';})();jsts.geom.CoordinateSequenceFilter=function(){};jsts.geom.CoordinateSequenceFilter.prototype.filter=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isDone=jsts.abstractFunc;jsts.geom.CoordinateSequenceFilter.prototype.isGeometryChanged=jsts.abstractFunc;(function(){var Interval=function(){this.min=0.0;this.max=0.0;if(arguments.length===1){var interval=arguments[0];this.init(interval.min,interval.max);}else if(arguments.length===2){this.init(arguments[0],arguments[1]);}};Interval.prototype.init=function(min,max){this.min=min;this.max=max;if(min>max){this.min=max;this.max=min;}};Interval.prototype.getMin=function(){return this.min;};Interval.prototype.getMax=function(){return this.max;};Interval.prototype.getWidth=function(){return(this.max-this.min);};Interval.prototype.expandToInclude=function(interval){if(interval.max>this.max){this.max=interval.max;}
if(interval.min<this.min){this.min=interval.min;}};Interval.prototype.overlaps=function(){if(arguments.length===1){return this.overlapsInterval.apply(this,arguments);}else{return this.overlapsMinMax.apply(this,arguments);}};Interval.prototype.overlapsInterval=function(interval){return this.overlaps(interval.min,interval.max);};Interval.prototype.overlapsMinMax=function(min,max){if(this.min>max||this.max<min){return false;}
return true;};Interval.prototype.contains=function(){var interval;if(arguments[0]instanceof jsts.index.bintree.Interval){interval=arguments[0];return this.containsMinMax(interval.min,interval.max);}else if(arguments.length===1){return this.containsPoint(arguments[0]);}else{return this.containsMinMax(arguments[0],arguments[1]);}};Interval.prototype.containsMinMax=function(min,max){return(min>=this.min&&max<=this.max);};Interval.prototype.containsPoint=function(p){return(p>=this.min&&p<=this.max);};jsts.index.bintree.Interval=Interval;})();jsts.index.DoubleBits=function(){};jsts.index.DoubleBits.powerOf2=function(exp){return Math.pow(2,exp);};jsts.index.DoubleBits.exponent=function(d){return jsts.index.DoubleBits.CVTFWD(64,d)-1023;};jsts.index.DoubleBits.CVTFWD=function(NumW,Qty){var Sign,Expo,Mant,Bin,nb01='';var Inf={32:{d:0x7F,c:0x80,b:0,a:0},64:{d:0x7FF0,c:0,b:0,a:0}};var ExW={32:8,64:11}[NumW],MtW=NumW-ExW-1;if(!Bin){Sign=Qty<0||1/Qty<0;if(!isFinite(Qty)){Bin=Inf[NumW];if(Sign){Bin.d+=1<<(NumW/4-1);}
Expo=Math.pow(2,ExW)-1;Mant=0;}}
if(!Bin){Expo={32:127,64:1023}[NumW];Mant=Math.abs(Qty);while(Mant>=2){Expo++;Mant/=2;}
while(Mant<1&&Expo>0){Expo--;Mant*=2;}
if(Expo<=0){Mant/=2;nb01='Zero or Denormal';}
if(NumW===32&&Expo>254){nb01='Too big for Single';Bin={d:Sign?0xFF:0x7F,c:0x80,b:0,a:0};Expo=Math.pow(2,ExW)-1;Mant=0;}}
return Expo;};(function(){var DoubleBits=jsts.index.DoubleBits;var Interval=jsts.index.bintree.Interval;var Key=function(interval){this.pt=0.0;this.level=0;this.computeKey(interval);};Key.computeLevel=function(interval){var dx=interval.getWidth(),level;level=DoubleBits.exponent(dx)+1;return level;};Key.prototype.getPoint=function(){return this.pt;};Key.prototype.getLevel=function(){return this.level;};Key.prototype.getInterval=function(){return this.interval;};Key.prototype.computeKey=function(itemInterval){this.level=Key.computeLevel(itemInterval);this.interval=new Interval();this.computeInterval(this.level,itemInterval);while(!this.interval.contains(itemInterval)){this.level+=1;this.computeInterval(this.level,itemInterval);}};Key.prototype.computeInterval=function(level,itemInterval){var size=DoubleBits.powerOf2(level);this.pt=Math.floor(itemInterval.getMin()/size)*size;this.interval.init(this.pt,this.pt+size);};jsts.index.bintree.Key=Key;})();jsts.operation.buffer.SubgraphDepthLocater=function(subgraphs){this.subgraphs=[];this.seg=new jsts.geom.LineSegment();this.subgraphs=subgraphs;};jsts.operation.buffer.SubgraphDepthLocater.prototype.subgraphs=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.seg=null;jsts.operation.buffer.SubgraphDepthLocater.prototype.getDepth=function(p){var stabbedSegments=this.findStabbedSegments(p);if(stabbedSegments.length===0)
return 0;stabbedSegments.sort();var ds=stabbedSegments[0];return ds.leftDepth;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments=function(stabbingRayLeftPt){if(arguments.length===3){this.findStabbedSegments2.apply(this,arguments);return;}
var stabbedSegments=[];for(var i=0;i<this.subgraphs.length;i++){var bsg=this.subgraphs[i];var env=bsg.getEnvelope();if(stabbingRayLeftPt.y<env.getMinY()||stabbingRayLeftPt.y>env.getMaxY())
continue;this.findStabbedSegments2(stabbingRayLeftPt,bsg.getDirectedEdges(),stabbedSegments);}
return stabbedSegments;};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments2=function(stabbingRayLeftPt,dirEdges,stabbedSegments){if(arguments[1]instanceof jsts.geomgraph.DirectedEdge){this.findStabbedSegments3(stabbingRayLeftPt,dirEdges,stabbedSegments);return;}
for(var i=dirEdges.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.findStabbedSegments3(stabbingRayLeftPt,de,stabbedSegments);}};jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments3=function(stabbingRayLeftPt,dirEdge,stabbedSegments){var pts=dirEdge.getEdge().getCoordinates();for(var i=0;i<pts.length-1;i++){this.seg.p0=pts[i];this.seg.p1=pts[i+1];if(this.seg.p0.y>this.seg.p1.y)
this.seg.reverse();var maxx=Math.max(this.seg.p0.x,this.seg.p1.x);if(maxx<stabbingRayLeftPt.x)
continue;if(this.seg.isHorizontal())
continue;if(stabbingRayLeftPt.y<this.seg.p0.y||stabbingRayLeftPt.y>this.seg.p1.y)
continue;if(jsts.algorithm.CGAlgorithms.computeOrientation(this.seg.p0,this.seg.p1,stabbingRayLeftPt)===jsts.algorithm.CGAlgorithms.RIGHT)
continue;var depth=dirEdge.getDepth(jsts.geomgraph.Position.LEFT);if(!this.seg.p0.equals(pts[i]))
depth=dirEdge.getDepth(jsts.geomgraph.Position.RIGHT);var ds=new jsts.operation.buffer.SubgraphDepthLocater.DepthSegment(this.seg,depth);stabbedSegments.push(ds);}};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment=function(seg,depth){this.upwardSeg=new jsts.geom.LineSegment(seg);this.leftDepth=depth;};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.upwardSeg=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.leftDepth=null;jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareTo=function(obj){var other=obj;var orientIndex=this.upwardSeg.orientationIndex(other.upwardSeg);if(orientIndex===0)
orientIndex=-1*other.upwardSeg.orientationIndex(upwardSeg);if(orientIndex!==0)
return orientIndex;return this.compareX(this.upwardSeg,other.upwardSeg);};jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareX=function(seg0,seg1){var compare0=seg0.p0.compareTo(seg1.p0);if(compare0!==0)
return compare0;return seg0.p1.compareTo(seg1.p1);};jsts.noding.snapround.HotPixel=function(pt,scaleFactor,li){this.corner=[];this.originalPt=pt;this.pt=pt;this.scaleFactor=scaleFactor;this.li=li;if(this.scaleFactor!==1.0){this.pt=new jsts.geom.Coordinate(this.scale(pt.x),this.scale(pt.y));this.p0Scaled=new jsts.geom.Coordinate();this.p1Scaled=new jsts.geom.Coordinate();}
this.initCorners(this.pt);};jsts.noding.snapround.HotPixel.prototype.li=null;jsts.noding.snapround.HotPixel.prototype.pt=null;jsts.noding.snapround.HotPixel.prototype.originalPt=null;jsts.noding.snapround.HotPixel.prototype.ptScaled=null;jsts.noding.snapround.HotPixel.prototype.p0Scaled=null;jsts.noding.snapround.HotPixel.prototype.p1Scaled=null;jsts.noding.snapround.HotPixel.prototype.scaleFactor=undefined;jsts.noding.snapround.HotPixel.prototype.minx=undefined;jsts.noding.snapround.HotPixel.prototype.maxx=undefined;jsts.noding.snapround.HotPixel.prototype.miny=undefined;jsts.noding.snapround.HotPixel.prototype.maxy=undefined;jsts.noding.snapround.HotPixel.prototype.corner=null;jsts.noding.snapround.HotPixel.prototype.safeEnv=null;jsts.noding.snapround.HotPixel.prototype.getCoordinate=function(){return this.originalPt;};jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR=0.75;jsts.noding.snapround.HotPixel.prototype.getSafeEnvelope=function(){if(this.safeEnv===null){var safeTolerance=jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new jsts.geom.Envelope(this.originalPt.x-safeTolerance,this.originalPt.x+safeTolerance,this.originalPt.y-safeTolerance,this.originalPt.y+safeTolerance);}
return this.safeEnv;};jsts.noding.snapround.HotPixel.prototype.initCorners=function(pt){var tolerance=0.5;this.minx=pt.x-tolerance;this.maxx=pt.x+tolerance;this.miny=pt.y-tolerance;this.maxy=pt.y+tolerance;this.corner[0]=new jsts.geom.Coordinate(this.maxx,this.maxy);this.corner[1]=new jsts.geom.Coordinate(this.minx,this.maxy);this.corner[2]=new jsts.geom.Coordinate(this.minx,this.miny);this.corner[3]=new jsts.geom.Coordinate(this.maxx,this.miny);};jsts.noding.snapround.HotPixel.prototype.scale=function(val){return Math.round(val*this.scaleFactor);};jsts.noding.snapround.HotPixel.prototype.intersects=function(p0,p1){if(this.scaleFactor===1.0)
return this.intersectsScaled(p0,p1);this.copyScaled(p0,this.p0Scaled);this.copyScaled(p1,this.p1Scaled);return this.intersectsScaled(this.p0Scaled,this.p1Scaled);};jsts.noding.snapround.HotPixel.prototype.copyScaled=function(p,pScaled){pScaled.x=this.scale(p.x);pScaled.y=this.scale(p.y);};jsts.noding.snapround.HotPixel.prototype.intersectsScaled=function(p0,p1){var segMinx=Math.min(p0.x,p1.x);var segMaxx=Math.max(p0.x,p1.x);var segMiny=Math.min(p0.y,p1.y);var segMaxy=Math.max(p0.y,p1.y);var isOutsidePixelEnv=this.maxx<segMinx||this.minx>segMaxx||this.maxy<segMiny||this.miny>segMaxy;if(isOutsidePixelEnv)
return false;var intersects=this.intersectsToleranceSquare(p0,p1);jsts.util.Assert.isTrue(!(isOutsidePixelEnv&&intersects),'Found bad envelope test');return intersects;};jsts.noding.snapround.HotPixel.prototype.intersectsToleranceSquare=function(p0,p1){var intersectsLeft=false;var intersectsBottom=false;this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.isProper())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsLeft=true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.isProper())
return true;if(this.li.hasIntersection())
intersectsBottom=true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.isProper())
return true;if(intersectsLeft&&intersectsBottom)
return true;if(p0.equals(this.pt))
return true;if(p1.equals(this.pt))
return true;return false;};jsts.noding.snapround.HotPixel.prototype.intersectsPixelClosure=function(p0,p1){this.li.computeIntersection(p0,p1,this.corner[0],this.corner[1]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[1],this.corner[2]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[2],this.corner[3]);if(this.li.hasIntersection())
return true;this.li.computeIntersection(p0,p1,this.corner[3],this.corner[0]);if(this.li.hasIntersection())
return true;return false;};jsts.noding.snapround.HotPixel.prototype.addSnappedNode=function(segStr,segIndex){var p0=segStr.getCoordinate(segIndex);var p1=segStr.getCoordinate(segIndex+1);if(this.intersects(p0,p1)){segStr.addIntersection(this.getCoordinate(),segIndex);return true;}
return false;};jsts.operation.buffer.BufferInputLineSimplifier=function(inputLine){this.inputLine=inputLine;};jsts.operation.buffer.BufferInputLineSimplifier.simplify=function(inputLine,distanceTol){var simp=new jsts.operation.buffer.BufferInputLineSimplifier(inputLine);return simp.simplify(distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.INIT=0;jsts.operation.buffer.BufferInputLineSimplifier.DELETE=1;jsts.operation.buffer.BufferInputLineSimplifier.KEEP=1;jsts.operation.buffer.BufferInputLineSimplifier.prototype.inputLine=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.distanceTol=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeleted=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.angleOrientation=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE;jsts.operation.buffer.BufferInputLineSimplifier.prototype.simplify=function(distanceTol){this.distanceTol=Math.abs(distanceTol);if(distanceTol<0)
this.angleOrientation=jsts.algorithm.CGAlgorithms.CLOCKWISE;this.isDeleted=[];this.isDeleted.length=this.inputLine.length;var isChanged=false;do{isChanged=this.deleteShallowConcavities();}while(isChanged);return this.collapseLine();};jsts.operation.buffer.BufferInputLineSimplifier.prototype.deleteShallowConcavities=function(){var index=1;var maxIndex=this.inputLine.length-1;var midIndex=this.findNextNonDeletedIndex(index);var lastIndex=this.findNextNonDeletedIndex(midIndex);var isChanged=false;while(lastIndex<this.inputLine.length){var isMiddleVertexDeleted=false;if(this.isDeletable(index,midIndex,lastIndex,this.distanceTol)){this.isDeleted[midIndex]=jsts.operation.buffer.BufferInputLineSimplifier.DELETE;isMiddleVertexDeleted=true;isChanged=true;}
if(isMiddleVertexDeleted)
index=lastIndex;else
index=midIndex;midIndex=this.findNextNonDeletedIndex(index);lastIndex=this.findNextNonDeletedIndex(midIndex);}
return isChanged;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.findNextNonDeletedIndex=function(index){var next=index+1;while(next<this.inputLine.length&&this.isDeleted[next]===jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
next++;return next;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.collapseLine=function(){var coordList=[];for(var i=0;i<this.inputLine.length;i++){if(this.isDeleted[i]!==jsts.operation.buffer.BufferInputLineSimplifier.DELETE)
coordList.push(this.inputLine[i]);}
return coordList;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeletable=function(i0,i1,i2,distanceTol){var p0=this.inputLine[i0];var p1=this.inputLine[i1];var p2=this.inputLine[i2];if(!this.isConcave(p0,p1,p2))
return false;if(!this.isShallow(p0,p1,p2,distanceTol))
return false;return this.isShallowSampled(p0,p1,i0,i2,distanceTol);};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowConcavity=function(p0,p1,p2,distanceTol){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isAngleToSimplify=(orientation===this.angleOrientation);if(!isAngleToSimplify)
return false;var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK=10;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowSampled=function(p0,p2,i0,i2,distanceTol){var inc=parseInt((i2-i0)/jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK);if(inc<=0)
inc=1;for(var i=i0;i<i2;i+=inc){if(!this.isShallow(p0,p2,this.inputLine[i],distanceTol))
return false;}
return true;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallow=function(p0,p1,p2,distanceTol){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(p1,p0,p2);return dist<distanceTol;};jsts.operation.buffer.BufferInputLineSimplifier.prototype.isConcave=function(p0,p1,p2){var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(p0,p1,p2);var isConcave=(orientation===this.angleOrientation);return isConcave;};jsts.geomgraph.index.SweepLineEvent=function(x,obj,label){if(!(obj instanceof jsts.geomgraph.index.SweepLineEvent)){this.eventType=jsts.geomgraph.index.SweepLineEvent.INSERT;this.label=label;this.xValue=x;this.obj=obj;return;}
this.eventType=jsts.geomgraph.index.SweepLineEvent.DELETE;this.xValue=x;this.insertEvent=obj;};jsts.geomgraph.index.SweepLineEvent.INSERT=1;jsts.geomgraph.index.SweepLineEvent.DELETE=2;jsts.geomgraph.index.SweepLineEvent.prototype.label=null;jsts.geomgraph.index.SweepLineEvent.prototype.xValue=null;jsts.geomgraph.index.SweepLineEvent.prototype.eventType=null;jsts.geomgraph.index.SweepLineEvent.prototype.insertEvent=null;jsts.geomgraph.index.SweepLineEvent.prototype.deleteEventIndex=null;jsts.geomgraph.index.SweepLineEvent.prototype.obj=null;jsts.geomgraph.index.SweepLineEvent.prototype.isInsert=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.INSERT;};jsts.geomgraph.index.SweepLineEvent.prototype.isDelete=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.DELETE;};jsts.geomgraph.index.SweepLineEvent.prototype.getInsertEvent=function(){return this.insertEvent;};jsts.geomgraph.index.SweepLineEvent.prototype.getDeleteEventIndex=function(){return this.deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.setDeleteEventIndex=function(deleteEventIndex){this.deleteEventIndex=deleteEventIndex;};jsts.geomgraph.index.SweepLineEvent.prototype.getObject=function(){return this.obj;};jsts.geomgraph.index.SweepLineEvent.prototype.isSameLabel=function(ev){if(this.label==null){return false;}
return this.label==ev.label;};jsts.geomgraph.index.SweepLineEvent.prototype.compareTo=function(pe){if(this.xValue<pe.xValue){return-1;}
if(this.xValue>pe.xValue){return 1;}
if(this.eventType<pe.eventType){return-1;}
if(this.eventType>pe.eventType){return 1;}
return 0;};jsts.geom.CoordinateList=function(coord,allowRepeated){this.array=[];allowRepeated=(allowRepeated===undefined)?true:allowRepeated;if(coord!==undefined){this.add(coord,allowRepeated);}};jsts.geom.CoordinateList.prototype=new javascript.util.ArrayList();jsts.geom.CoordinateList.prototype.iterator=null;jsts.geom.CoordinateList.prototype.remove=null;jsts.geom.CoordinateList.prototype.get=function(i){return this.array[i];};jsts.geom.CoordinateList.prototype.set=function(i,e){var o=this.array[i];this.array[i]=e;return o;};jsts.geom.CoordinateList.prototype.size=function(){return this.array.length;};jsts.geom.CoordinateList.prototype.add=function(){if(arguments.length>1){return this.addCoordinates.apply(this,arguments);}else{return this.array.push(arguments[0]);}};jsts.geom.CoordinateList.prototype.addCoordinates=function(coord,allowRepeated,direction){if(coord instanceof jsts.geom.Coordinate){return this.addCoordinate.apply(this,arguments);}else if(typeof coord==='number'){return this.insertCoordinate.apply(this,arguments);}
direction=direction||true;if(direction){for(var i=0;i<coord.length;i++){this.addCoordinate(coord[i],allowRepeated);}}else{for(var i=coord.length-1;i>=0;i--){this.addCoordinate(coord[i],allowRepeated);}}
return true;};jsts.geom.CoordinateList.prototype.addCoordinate=function(coord,allowRepeated){if(!allowRepeated){if(this.size()>=1){var last=this.get(this.size()-1);if(last.equals2D(coord))return;}}
this.add(coord);};jsts.geom.CoordinateList.prototype.insertCoordinate=function(index,coord,allowRepeated){if(!allowRepeated){var before=index>0?index-1:-1;if(before!==-1&&this.get(before).equals2D(coord)){return;}
var after=index<this.size()-1?index+1:-1;if(after!==-1&&this.get(after).equals2D(coord)){return;}}
this.array.splice(index,0,coord);};jsts.geom.CoordinateList.prototype.closeRing=function(){if(this.size()>0){this.addCoordinate(new jsts.geom.Coordinate(this.get(0)),false);}};jsts.geom.CoordinateList.prototype.toArray=function(){return this.array;};jsts.geom.CoordinateList.prototype.toCoordinateArray=function(){return this.array;};jsts.operation.buffer.OffsetSegmentGenerator=function(precisionModel,bufParams,distance){this.seg0=new jsts.geom.LineSegment();this.seg1=new jsts.geom.LineSegment();this.offset0=new jsts.geom.LineSegment();this.offset1=new jsts.geom.LineSegment();this.precisionModel=precisionModel;this.bufParams=bufParams;this.li=new jsts.algorithm.RobustLineIntersector();this.filletAngleQuantum=Math.PI/2.0/bufParams.getQuadrantSegments();if(this.bufParams.getQuadrantSegments()>=8&&this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.closingSegLengthFactor=jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR;}
this.init(distance);};jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-3;jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1.0E-6;jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR=80;jsts.operation.buffer.OffsetSegmentGenerator.prototype.maxCurveSegmentError=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.filletAngleQuantum=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.closingSegLengthFactor=1;jsts.operation.buffer.OffsetSegmentGenerator.prototype.segList=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.distance=0.0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.bufParams=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.li=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.s2=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset0=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset1=null;jsts.operation.buffer.OffsetSegmentGenerator.prototype.side=0;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=false;jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=function(){return this.hasNarrowConcaveAngle;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.init=function(distance){this.distance=distance;this.maxCurveSegmentError=this.distance*(1-Math.cos(this.filletAngleQuantum/2.0));this.segList=new jsts.operation.buffer.OffsetSegmentString();this.segList.setPrecisionModel(this.precisionModel);this.segList.setMinimumVertexDistance(this.distance*jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.initSideSegments=function(s1,s2,side){this.s1=s1;this.s2=s2;this.side=side;this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.getCoordinates=function(){return this.segList.getCoordinates();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.closeRing=function(){this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addSegments=function(pt,isForward){this.segList.addPts(pt,isForward);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFirstSegment=function(){this.segList.addPt(this.offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLastSegment=function(){this.segList.addPt(this.offset1.p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addNextSegment=function(p,addStartPoint){this.s0=this.s1;this.s1=this.s2;this.s2=p;this.seg0.setCoordinates(this.s0,this.s1);this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0);this.seg1.setCoordinates(this.s1,this.s2);this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1);if(this.s1.equals(this.s2))
return;var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.s0,this.s1,this.s2);var outsideTurn=(orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE&&this.side===jsts.geomgraph.Position.LEFT)||(orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE&&this.side===jsts.geomgraph.Position.RIGHT);if(orientation==0){this.addCollinear(addStartPoint);}else if(outsideTurn){this.addOutsideTurn(orientation,addStartPoint);}else{this.addInsideTurn(orientation,addStartPoint);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addCollinear=function(addStartPoint){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2);var numInt=this.li.getIntersectionNum();if(numInt>=2){if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL||this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.segList.addPt(this.offset1.p0);}else{this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addOutsideTurn=function(orientation,addStartPoint){if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR){this.segList.addPt(this.offset0.p1);return;}
if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE){this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance);}else if(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL){this.addBevelJoin(this.offset0,this.offset1);}else{if(addStartPoint)
this.segList.addPt(this.offset0.p1);this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,orientation,this.distance);this.segList.addPt(this.offset1.p0);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addInsideTurn=function(orientation,addStartPoint){this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1);if(this.li.hasIntersection()){this.segList.addPt(this.li.getIntersection(0));}else{this.hasNarrowConcaveAngle=true;if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR){this.segList.addPt(this.offset0.p1);}else{this.segList.addPt(this.offset0.p1);if(this.closingSegLengthFactor>0){var mid0=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid0);var mid1=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(mid1);}else{this.segList.addPt(this.s1);}
this.segList.addPt(this.offset1.p0);}}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.computeOffsetSegment=function(seg,side,distance,offset){var sideSign=side===jsts.geomgraph.Position.LEFT?1:-1;var dx=seg.p1.x-seg.p0.x;var dy=seg.p1.y-seg.p0.y;var len=Math.sqrt(dx*dx+dy*dy);var ux=sideSign*distance*dx/len;var uy=sideSign*distance*dy/len;offset.p0.x=seg.p0.x-uy;offset.p0.y=seg.p0.y+ux;offset.p1.x=seg.p1.x-uy;offset.p1.y=seg.p1.y+ux;};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLineEndCap=function(p0,p1){var seg=new jsts.geom.LineSegment(p0,p1);var offsetL=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.LEFT,this.distance,offsetL);var offsetR=new jsts.geom.LineSegment();this.computeOffsetSegment(seg,jsts.geomgraph.Position.RIGHT,this.distance,offsetR);var dx=p1.x-p0.x;var dy=p1.y-p0.y;var angle=Math.atan2(dy,dx);switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:this.segList.addPt(offsetL.p1);this.addFillet(p1,angle+Math.PI/2,angle-Math.PI/2,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_FLAT:this.segList.addPt(offsetL.p1);this.segList.addPt(offsetR.p1);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:var squareCapSideOffset=new jsts.geom.Coordinate();squareCapSideOffset.x=Math.abs(this.distance)*Math.cos(angle);squareCapSideOffset.y=Math.abs(this.distance)*Math.sin(angle);var squareCapLOffset=new jsts.geom.Coordinate(offsetL.p1.x+
squareCapSideOffset.x,offsetL.p1.y+squareCapSideOffset.y);var squareCapROffset=new jsts.geom.Coordinate(offsetR.p1.x+
squareCapSideOffset.x,offsetR.p1.y+squareCapSideOffset.y);this.segList.addPt(squareCapLOffset);this.segList.addPt(squareCapROffset);break;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addMitreJoin=function(p,offset0,offset1,distance){var isMitreWithinLimit=true;var intPt=null;try{intPt=jsts.algorithm.HCoordinate.intersection(offset0.p0,offset0.p1,offset1.p0,offset1.p1);var mitreRatio=distance<=0.0?1.0:intPt.distance(p)/Math.abs(distance);if(mitreRatio>this.bufParams.getMitreLimit())
this.isMitreWithinLimit=false;}catch(e){if(e instanceof jsts.error.NotRepresentableError){intPt=new jsts.geom.Coordinate(0,0);this.isMitreWithinLimit=false;}}
if(isMitreWithinLimit){this.segList.addPt(intPt);}else{this.addLimitedMitreJoin(offset0,offset1,distance,bufParams.getMitreLimit());}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLimitedMitreJoin=function(offset0,offset1,distance,mitreLimit){var basePt=this.seg0.p1;var ang0=jsts.algorithm.Angle.angle(basePt,this.seg0.p0);var ang1=jsts.algorithm.Angle.angle(basePt,this.seg1.p1);var angDiff=jsts.algorithm.Angle.angleBetweenOriented(this.seg0.p0,basePt,this.seg1.p1);var angDiffHalf=angDiff/2;var midAng=jsts.algorithm.Angle.normalize(ang0+angDiffHalf);var mitreMidAng=jsts.algorithm.Angle.normalize(midAng+Math.PI);var mitreDist=mitreLimit*distance;var bevelDelta=mitreDist*Math.abs(Math.sin(angDiffHalf));var bevelHalfLen=distance-bevelDelta;var bevelMidX=basePt.x+mitreDist*Math.cos(mitreMidAng);var bevelMidY=basePt.y+mitreDist*Math.sin(mitreMidAng);var bevelMidPt=new jsts.geom.Coordinate(bevelMidX,bevelMidY);var mitreMidLine=new jsts.geom.LineSegment(basePt,bevelMidPt);var bevelEndLeft=mitreMidLine.pointAlongOffset(1.0,bevelHalfLen);var bevelEndRight=mitreMidLine.pointAlongOffset(1.0,-bevelHalfLen);if(this.side==jsts.geomgraph.Position.LEFT){this.segList.addPt(bevelEndLeft);this.segList.addPt(bevelEndRight);}else{this.segList.addPt(bevelEndRight);this.segList.addPt(bevelEndLeft);}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addBevelJoin=function(offset0,offset1){this.segList.addPt(offset0.p1);this.segList.addPt(offset1.p0);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet=function(p,p0,p1,direction,radius){if(!(p1 instanceof jsts.geom.Coordinate)){this.addFillet2.apply(this,arguments);return;}
var dx0=p0.x-p.x;var dy0=p0.y-p.y;var startAngle=Math.atan2(dy0,dx0);var dx1=p1.x-p.x;var dy1=p1.y-p.y;var endAngle=Math.atan2(dy1,dx1);if(direction===jsts.algorithm.CGAlgorithms.CLOCKWISE){if(startAngle<=endAngle)
startAngle+=2.0*Math.PI;}else{if(startAngle>=endAngle)
startAngle-=2.0*Math.PI;}
this.segList.addPt(p0);this.addFillet(p,startAngle,endAngle,direction,radius);this.segList.addPt(p1);};jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet2=function(p,startAngle,endAngle,direction,radius){var directionFactor=direction===jsts.algorithm.CGAlgorithms.CLOCKWISE?-1:1;var totalAngle=Math.abs(startAngle-endAngle);var nSegs=parseInt((totalAngle/this.filletAngleQuantum+0.5));if(nSegs<1)
return;var initAngle,currAngleInc;initAngle=0.0;currAngleInc=totalAngle/nSegs;var currAngle=initAngle;var pt=new jsts.geom.Coordinate();while(currAngle<totalAngle){var angle=startAngle+directionFactor*currAngle;pt.x=p.x+radius*Math.cos(angle);pt.y=p.y+radius*Math.sin(angle);this.segList.addPt(pt);currAngle+=currAngleInc;}};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createCircle=function(p){var pt=new jsts.geom.Coordinate(p.x+this.distance,p.y);this.segList.addPt(pt);this.addFillet(p,0.0,2.0*Math.PI,-1,this.distance);this.segList.closeRing();};jsts.operation.buffer.OffsetSegmentGenerator.prototype.createSquare=function(p){this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y+distance));this.segList.addPt(new jsts.geom.Coordinate(p.x+distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y-distance));this.segList.addPt(new jsts.geom.Coordinate(p.x-distance,p.y+distance));this.segList.closeRing();};jsts.operation.overlay.MaximalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MaximalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MaximalEdgeRing.constructor=jsts.operation.overlay.MaximalEdgeRing;jsts.operation.overlay.MaximalEdgeRing.prototype.getNext=function(de)
{return de.getNext();};jsts.operation.overlay.MaximalEdgeRing.prototype.setEdgeRing=function(de,er)
{de.setEdgeRing(er);};jsts.operation.overlay.MaximalEdgeRing.prototype.linkDirectedEdgesForMinimalEdgeRings=function()
{var de=this.startDe;do{var node=de.getNode();node.getEdges().linkMinimalDirectedEdges(this);de=de.getNext();}while(de!=this.startDe);};jsts.operation.overlay.MaximalEdgeRing.prototype.buildMinimalRings=function()
{var minEdgeRings=[];var de=this.startDe;do{if(de.getMinEdgeRing()===null){var minEr=new jsts.operation.overlay.MinimalEdgeRing(de,this.geometryFactory);minEdgeRings.push(minEr);}
de=de.getNext();}while(de!=this.startDe);return minEdgeRings;};jsts.algorithm.CentroidPoint=function(){this.centSum=new jsts.geom.Coordinate();};jsts.algorithm.CentroidPoint.prototype.ptCount=0;jsts.algorithm.CentroidPoint.prototype.centSum=null;jsts.algorithm.CentroidPoint.prototype.add=function(geom){if(geom instanceof jsts.geom.Point){this.add2(geom.getCoordinate());}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}};jsts.algorithm.CentroidPoint.prototype.add2=function(pt){this.ptCount+=1;this.centSum.x+=pt.x;this.centSum.y+=pt.y;};jsts.algorithm.CentroidPoint.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();cent.x=this.centSum.x/this.ptCount;cent.y=this.centSum.y/this.ptCount;return cent;};jsts.operation.distance.ConnectedElementLocationFilter=function(locations){this.locations=locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype=new jsts.geom.GeometryFilter();jsts.operation.distance.ConnectedElementLocationFilter.prototype.locations=null;jsts.operation.distance.ConnectedElementLocationFilter.getLocations=function(geom){var locations=[];geom.apply(new jsts.operation.distance.ConnectedElementLocationFilter(locations));return locations;};jsts.operation.distance.ConnectedElementLocationFilter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point||geom instanceof jsts.geom.LineString||geom instanceof jsts.geom.Polygon)
this.locations.push(new jsts.operation.distance.GeometryLocation(geom,0,geom.getCoordinate()));};jsts.geomgraph.index.MonotoneChainEdge=function(e){this.e=e;this.pts=e.getCoordinates();var mcb=new jsts.geomgraph.index.MonotoneChainIndexer();this.startIndex=mcb.getChainStartIndices(this.pts);};jsts.geomgraph.index.MonotoneChainEdge.prototype.e=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.pts=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.startIndex=null;jsts.geomgraph.index.MonotoneChainEdge.prototype.env1=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.env2=new jsts.geom.Envelope();jsts.geomgraph.index.MonotoneChainEdge.prototype.getCoordinates=function(){return this.pts;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getStartIndexes=function(){return this.startIndex;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMinX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.getMaxX=function(chainIndex){var x1=this.pts[this.startIndex[chainIndex]].x;var x2=this.pts[this.startIndex[chainIndex+1]].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersects=function(mce,si){for(var i=0;i<this.startIndex.length-1;i++){for(var j=0;j<mce.startIndex.length-1;j++){this.computeIntersectsForChain(i,mce,j,si);}}};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain=function(chainIndex0,mce,chainIndex1,si){this.computeIntersectsForChain2(this.startIndex[chainIndex0],this.startIndex[chainIndex0+1],mce,mce.startIndex[chainIndex1],mce.startIndex[chainIndex1+1],si);};jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain2=function(start0,end0,mce,start1,end1,ei){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mce.pts[start1];var p11=mce.pts[end1];if(end0-start0==1&&end1-start1==1){ei.addIntersections(this.e,start0,mce.e,start1);return;}
this.env1.init(p00,p01);this.env2.init(p10,p11);if(!this.env1.intersects(this.env2)){return;}
var mid0=Math.floor((start0+end0)/2);var mid1=Math.floor((start1+end1)/2);if(start0<mid0){if(start1<mid1){this.computeIntersectsForChain2(start0,mid0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(start0,mid0,mce,mid1,end1,ei);}}
if(mid0<end0){if(start1<mid1){this.computeIntersectsForChain2(mid0,end0,mce,start1,mid1,ei);}
if(mid1<end1){this.computeIntersectsForChain2(mid0,end0,mce,mid1,end1,ei);}}};(function(){var ArrayList=javascript.util.ArrayList;jsts.operation.relate.EdgeEndBuilder=function(){};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds=function(edges){if(arguments.length==2){this.computeEdgeEnds2.apply(this,arguments);return;}
var l=new ArrayList();for(var i=edges;i.hasNext();){var e=i.next();this.computeEdgeEnds2(e,l);}
return l;};jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds2=function(edge,l){var eiList=edge.getEdgeIntersectionList();eiList.addEndpoints();var it=eiList.iterator();var eiPrev=null;var eiCurr=null;if(!it.hasNext())
return;var eiNext=it.next();do{eiPrev=eiCurr;eiCurr=eiNext;eiNext=null;if(it.hasNext())
eiNext=it.next();if(eiCurr!==null){this.createEdgeEndForPrev(edge,l,eiCurr,eiPrev);this.createEdgeEndForNext(edge,l,eiCurr,eiNext);}}while(eiCurr!==null);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForPrev=function(edge,l,eiCurr,eiPrev){var iPrev=eiCurr.segmentIndex;if(eiCurr.dist===0.0){if(iPrev===0)
return;iPrev--;}
var pPrev=edge.getCoordinate(iPrev);if(eiPrev!==null&&eiPrev.segmentIndex>=iPrev)
pPrev=eiPrev.coord;var label=new jsts.geomgraph.Label(edge.getLabel());label.flip();var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pPrev,label);l.add(e);};jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForNext=function(edge,l,eiCurr,eiNext){var iNext=eiCurr.segmentIndex+1;if(iNext>=edge.getNumPoints()&&eiNext===null)
return;var pNext=edge.getCoordinate(iNext);if(eiNext!==null&&eiNext.segmentIndex===eiCurr.segmentIndex)
pNext=eiNext.coord;var e=new jsts.geomgraph.EdgeEnd(edge,eiCurr.coord,pNext,new jsts.geomgraph.Label(edge.getLabel()));l.add(e);};})();(function(){var ArrayList=javascript.util.ArrayList;var TreeSet=javascript.util.TreeSet;var CoordinateFilter=jsts.geom.CoordinateFilter;jsts.util.UniqueCoordinateArrayFilter=function(){this.treeSet=new TreeSet();this.list=new ArrayList();};jsts.util.UniqueCoordinateArrayFilter.prototype=new CoordinateFilter();jsts.util.UniqueCoordinateArrayFilter.prototype.treeSet=null;jsts.util.UniqueCoordinateArrayFilter.prototype.list=null;jsts.util.UniqueCoordinateArrayFilter.prototype.getCoordinates=function(){return this.list.toArray();};jsts.util.UniqueCoordinateArrayFilter.prototype.filter=function(coord){if(!this.treeSet.contains(coord)){this.list.add(coord);this.treeSet.add(coord);}};})();(function(){var CGAlgorithms=jsts.algorithm.CGAlgorithms;var UniqueCoordinateArrayFilter=jsts.util.UniqueCoordinateArrayFilter;var Assert=jsts.util.Assert;var Stack=javascript.util.Stack;var ArrayList=javascript.util.ArrayList;var Arrays=javascript.util.Arrays;var RadialComparator=function(origin){this.origin=origin;};RadialComparator.prototype.origin=null;RadialComparator.prototype.compare=function(o1,o2){var p1=o1;var p2=o2;return RadialComparator.polarCompare(this.origin,p1,p2);};RadialComparator.polarCompare=function(o,p,q){var dxp=p.x-o.x;var dyp=p.y-o.y;var dxq=q.x-o.x;var dyq=q.y-o.y;var orient=CGAlgorithms.computeOrientation(o,p,q);if(orient==CGAlgorithms.COUNTERCLOCKWISE)
return 1;if(orient==CGAlgorithms.CLOCKWISE)
return-1;var op=dxp*dxp+dyp*dyp;var oq=dxq*dxq+dyq*dyq;if(op<oq){return-1;}
if(op>oq){return 1;}
return 0;};jsts.algorithm.ConvexHull=function(){if(arguments.length===1){var geometry=arguments[0];this.inputPts=jsts.algorithm.ConvexHull.extractCoordinates(geometry);this.geomFactory=geometry.getFactory();}else{this.pts=arguments[0];this.geomFactory=arguments[1];}};jsts.algorithm.ConvexHull.prototype.geomFactory=null;jsts.algorithm.ConvexHull.prototype.inputPts=null;jsts.algorithm.ConvexHull.extractCoordinates=function(geom){var filter=new UniqueCoordinateArrayFilter();geom.apply(filter);return filter.getCoordinates();};jsts.algorithm.ConvexHull.prototype.getConvexHull=function(){if(this.inputPts.length==0){return this.geomFactory.createGeometryCollection(null);}
if(this.inputPts.length==1){return this.geomFactory.createPoint(this.inputPts[0]);}
if(this.inputPts.length==2){return this.geomFactory.createLineString(this.inputPts);}
var reducedPts=this.inputPts;if(this.inputPts.length>50){reducedPts=this.reduce(this.inputPts);}
var sortedPts=this.preSort(reducedPts);var cHS=this.grahamScan(sortedPts);var cH=cHS.toArray();return this.lineOrPolygon(cH);};jsts.algorithm.ConvexHull.prototype.reduce=function(inputPts){var polyPts=this.computeOctRing(inputPts);if(polyPts==null)
return this.inputPts;var reducedSet=new javascript.util.TreeSet();for(var i=0;i<polyPts.length;i++){reducedSet.add(polyPts[i]);}
for(var i=0;i<inputPts.length;i++){if(!CGAlgorithms.isPointInRing(inputPts[i],polyPts)){reducedSet.add(inputPts[i]);}}
var reducedPts=reducedSet.toArray();if(reducedPts.length<3)
return this.padArray3(reducedPts);return reducedPts;};jsts.algorithm.ConvexHull.prototype.padArray3=function(pts){var pad=[];for(var i=0;i<pad.length;i++){if(i<pts.length){pad[i]=pts[i];}else
pad[i]=pts[0];}
return pad;};jsts.algorithm.ConvexHull.prototype.preSort=function(pts){var t;for(var i=1;i<pts.length;i++){if((pts[i].y<pts[0].y)||((pts[i].y==pts[0].y)&&(pts[i].x<pts[0].x))){t=pts[0];pts[0]=pts[i];pts[i]=t;}}
Arrays.sort(pts,1,pts.length,new RadialComparator(pts[0]));return pts;};jsts.algorithm.ConvexHull.prototype.grahamScan=function(c){var p;var ps=new Stack();p=ps.push(c[0]);p=ps.push(c[1]);p=ps.push(c[2]);for(var i=3;i<c.length;i++){p=ps.pop();while(!ps.empty()&&CGAlgorithms.computeOrientation(ps.peek(),p,c[i])>0){p=ps.pop();}
p=ps.push(p);p=ps.push(c[i]);}
p=ps.push(c[0]);return ps;};jsts.algorithm.ConvexHull.prototype.isBetween=function(c1,c2,c3){if(CGAlgorithms.computeOrientation(c1,c2,c3)!==0){return false;}
if(c1.x!=c3.x){if(c1.x<=c2.x&&c2.x<=c3.x){return true;}
if(c3.x<=c2.x&&c2.x<=c1.x){return true;}}
if(c1.y!=c3.y){if(c1.y<=c2.y&&c2.y<=c3.y){return true;}
if(c3.y<=c2.y&&c2.y<=c1.y){return true;}}
return false;};jsts.algorithm.ConvexHull.prototype.computeOctRing=function(inputPts){var octPts=this.computeOctPts(inputPts);var coordList=new jsts.geom.CoordinateList();coordList.add(octPts,false);if(coordList.size()<3){return null;}
coordList.closeRing();return coordList.toCoordinateArray();};jsts.algorithm.ConvexHull.prototype.computeOctPts=function(inputPts){var pts=[];for(var j=0;j<8;j++){pts[j]=inputPts[0];}
for(var i=1;i<inputPts.length;i++){if(inputPts[i].x<pts[0].x){pts[0]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y<pts[1].x-pts[1].y){pts[1]=inputPts[i];}
if(inputPts[i].y>pts[2].y){pts[2]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y>pts[3].x+pts[3].y){pts[3]=inputPts[i];}
if(inputPts[i].x>pts[4].x){pts[4]=inputPts[i];}
if(inputPts[i].x-inputPts[i].y>pts[5].x-pts[5].y){pts[5]=inputPts[i];}
if(inputPts[i].y<pts[6].y){pts[6]=inputPts[i];}
if(inputPts[i].x+inputPts[i].y<pts[7].x+pts[7].y){pts[7]=inputPts[i];}}
return pts;};jsts.algorithm.ConvexHull.prototype.lineOrPolygon=function(coordinates){coordinates=this.cleanRing(coordinates);if(coordinates.length==3){return this.geomFactory.createLineString([coordinates[0],coordinates[1]]);}
var linearRing=this.geomFactory.createLinearRing(coordinates);return this.geomFactory.createPolygon(linearRing,null);};jsts.algorithm.ConvexHull.prototype.cleanRing=function(original){Assert.equals(original[0],original[original.length-1]);var cleanedRing=new ArrayList();var previousDistinctCoordinate=null;for(var i=0;i<=original.length-2;i++){var currentCoordinate=original[i];var nextCoordinate=original[i+1];if(currentCoordinate.equals(nextCoordinate)){continue;}
if(previousDistinctCoordinate!=null&&this.isBetween(previousDistinctCoordinate,currentCoordinate,nextCoordinate)){continue;}
cleanedRing.add(currentCoordinate);previousDistinctCoordinate=currentCoordinate;}
cleanedRing.add(original[original.length-1]);var cleanedRingCoordinates=[];return cleanedRing.toArray(cleanedRingCoordinates);};})();jsts.algorithm.MinimumDiameter=function(inputGeom,isConvex){this.convexHullPts=null;this.minBaseSeg=new jsts.geom.LineSegment();this.minWidthPt=null;this.minPtIndex=0;this.minWidth=0;jsts.algorithm.MinimumDiameter.inputGeom=inputGeom;jsts.algorithm.MinimumDiameter.isConvex=isConvex||false;};jsts.algorithm.MinimumDiameter.inputGeom=null;jsts.algorithm.MinimumDiameter.isConvex=false;jsts.algorithm.MinimumDiameter.nextIndex=function(pts,index){index++;if(index>=pts.length){index=0;}
return index;};jsts.algorithm.MinimumDiameter.computeC=function(a,b,p){return a*p.y-b*p.x;};jsts.algorithm.MinimumDiameter.computeSegmentForLine=function(a,b,c){var p0;var p1;if(Math.abs(b)>Math.abs(a)){p0=new jsts.geom.Coordinate(0,c/b);p1=new jsts.geom.Coordinate(1,c/b-a/b);}
else{p0=new jsts.geom.Coordinate(c/a,0);p1=new jsts.geom.Coordinate(c/a-b/a,1);}
return new jsts.geom.LineSegment(p0,p1);};jsts.algorithm.MinimumDiameter.prototype.getLength=function(){this.computeMinimumDiameter();return this.minWidth;};jsts.algorithm.MinimumDiameter.prototype.getWidthCoordinate=function(){this.computeMinimumDiameter();return this.minWidthPt;};jsts.algorithm.MinimumDiameter.prototype.getSupportingSegment=function(){this.computeMinimumDiameter();var coord=[this.minBaseSeg.p0,this.minBaseSeg.p1];return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(coord);};jsts.algorithm.MinimumDiameter.prototype.getDiameter=function(){this.computeMinimumDiameter();if(this.minWidthPt===null){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(null);}
var basePt=this.minBaseSeg.project(this.minWidthPt);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString([basePt,this.minWidthPt]);};jsts.algorithm.MinimumDiameter.prototype.computeMinimumDiameter=function(){if(this.minWidthPt!==null){return;}
if(jsts.algorithm.MinimumDiameter.isConvex)
this.computeWidthConvex(jsts.algorithm.MinimumDiameter.inputGeom);else{var convexGeom=new jsts.algorithm.ConvexHull(jsts.algorithm.MinimumDiameter.inputGeom).getConvexHull();this.computeWidthConvex(convexGeom);}};jsts.algorithm.MinimumDiameter.prototype.computeWidthConvex=function(convexGeom){if(convexGeom instanceof jsts.geom.Polygon){this.convexHullPts=convexGeom.getExteriorRing().getCoordinates();}else{this.convexHullPts=convexGeom.getCoordinates();}
if(this.convexHullPts.length===0){this.minWidth=0;this.minWidthPt=null;this.minBaseSeg=null;}else if(this.convexHullPts.length===1){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[0];}else if(this.convexHullPts.length===2||this.convexHullPts.length===3){this.minWidth=0;this.minWidthPt=this.convexHullPts[0];this.minBaseSeg.p0=this.convexHullPts[0];this.minBaseSeg.p1=this.convexHullPts[1];}else{this.computeConvexRingMinDiameter(this.convexHullPts);}};jsts.algorithm.MinimumDiameter.prototype.computeConvexRingMinDiameter=function(pts){this.minWidth=Number.MAX_VALUE;var currMaxIndex=1;var seg=new jsts.geom.LineSegment();for(var i=0;i<pts.length-1;i++){seg.p0=pts[i];seg.p1=pts[i+1];currMaxIndex=this.findMaxPerpDistance(pts,seg,currMaxIndex);}};jsts.algorithm.MinimumDiameter.prototype.findMaxPerpDistance=function(pts,seg,startIndex){var maxPerpDistance=seg.distancePerpendicular(pts[startIndex]);var nextPerpDistance=maxPerpDistance;var maxIndex=startIndex;var nextIndex=maxIndex;while(nextPerpDistance>=maxPerpDistance){maxPerpDistance=nextPerpDistance;maxIndex=nextIndex;nextIndex=jsts.algorithm.MinimumDiameter.nextIndex(pts,maxIndex);nextPerpDistance=seg.distancePerpendicular(pts[nextIndex]);}
if(maxPerpDistance<this.minWidth){this.minPtIndex=maxIndex;this.minWidth=maxPerpDistance;this.minWidthPt=pts[this.minPtIndex];this.minBaseSeg=new jsts.geom.LineSegment(seg);}
return maxIndex;};jsts.algorithm.MinimumDiameter.prototype.getMinimumRectangle=function(){this.computeMinimumDiameter();if(this.minWidth===0){if(this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)){return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPoint(this.minBaseSeg.p0);}
return this.minBaseSeg.toGeometry(jsts.algorithm.MinimumDiameter.inputGeom.getFactory());}
var dx=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x;var dy=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y;var minPara=Number.MAX_VALUE;var maxPara=-Number.MAX_VALUE;var minPerp=Number.MAX_VALUE;var maxPerp=-Number.MAX_VALUE;for(var i=0;i<this.convexHullPts.length;i++){var paraC=jsts.algorithm.MinimumDiameter.computeC(dx,dy,this.convexHullPts[i]);if(paraC>maxPara)maxPara=paraC;if(paraC<minPara)minPara=paraC;var perpC=jsts.algorithm.MinimumDiameter.computeC(-dy,dx,this.convexHullPts[i]);if(perpC>maxPerp)maxPerp=perpC;if(perpC<minPerp)minPerp=perpC;}
var maxPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,maxPerp);var minPerpLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dx,-dy,minPerp);var maxParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,maxPara);var minParaLine=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-dy,dx,minPara);var p0=maxParaLine.lineIntersection(maxPerpLine);var p1=minParaLine.lineIntersection(maxPerpLine);var p2=minParaLine.lineIntersection(minPerpLine);var p3=maxParaLine.lineIntersection(minPerpLine);var shell=jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLinearRing([p0,p1,p2,p3,p0]);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPolygon(shell,null);};(function(){jsts.io.GeoJSONParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.geometryTypes=['Point','MultiPoint','LineString','MultiLineString','Polygon','MultiPolygon'];};jsts.io.GeoJSONParser.prototype.read=function(json){var obj;if(typeof json==='string'){obj=JSON.parse(json);}else{obj=json;}
var type=obj.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
if(this.geometryTypes.indexOf(type)!=-1){return this.parse[type].apply(this,[obj.coordinates]);}else if(type==='GeometryCollection'){return this.parse[type].apply(this,[obj.geometries]);}
return this.parse[type].apply(this,[obj]);};jsts.io.GeoJSONParser.prototype.parse={'Feature':function(obj){var feature={};for(var key in obj){feature[key]=obj[key];}
if(obj.geometry){var type=obj.geometry.type;if(!this.parse[type]){throw new Error('Unknown GeoJSON type: '+obj.type);}
feature.geometry=this.read(obj.geometry);}
if(obj.bbox){feature.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return feature;},'FeatureCollection':function(obj){var featureCollection={};if(obj.features){featureCollection.features=[];for(var i=0;i<obj.features.length;++i){featureCollection.features.push(this.read(obj.features[i]));}}
if(obj.bbox){featureCollection.bbox=this.parse.bbox.apply(this,[obj.bbox]);}
return featureCollection;},'coordinates':function(array){var coordinates=[];for(var i=0;i<array.length;++i){var sub=array[i];coordinates.push(new jsts.geom.Coordinate(sub[0],sub[1]));}
return coordinates;},'bbox':function(array){return this.geometryFactory.createLinearRing([new jsts.geom.Coordinate(array[0],array[1]),new jsts.geom.Coordinate(array[2],array[1]),new jsts.geom.Coordinate(array[2],array[3]),new jsts.geom.Coordinate(array[0],array[3]),new jsts.geom.Coordinate(array[0],array[1])]);},'Point':function(array){var coordinate=new jsts.geom.Coordinate(array[0],array[1]);return this.geometryFactory.createPoint(coordinate);},'MultiPoint':function(array){var points=[];for(var i=0;i<array.length;++i){points.push(this.parse.Point.apply(this,[array[i]]));}
return this.geometryFactory.createMultiPoint(points);},'LineString':function(array){var coordinates=this.parse.coordinates.apply(this,[array]);return this.geometryFactory.createLineString(coordinates);},'MultiLineString':function(array){var lineStrings=[];for(var i=0;i<array.length;++i){lineStrings.push(this.parse.LineString.apply(this,[array[i]]));}
return this.geometryFactory.createMultiLineString(lineStrings);},'Polygon':function(array){var shellCoordinates=this.parse.coordinates.apply(this,[array[0]]);var shell=this.geometryFactory.createLinearRing(shellCoordinates);var holes=[];for(var i=1;i<array.length;++i){var hole=array[i];var coordinates=this.parse.coordinates.apply(this,[hole]);var linearRing=this.geometryFactory.createLinearRing(coordinates);holes.push(linearRing);}
return this.geometryFactory.createPolygon(shell,holes);},'MultiPolygon':function(array){var polygons=[];for(var i=0;i<array.length;++i){var polygon=array[i];polygons.push(this.parse.Polygon.apply(this,[polygon]));}
return this.geometryFactory.createMultiPolygon(polygons);},'GeometryCollection':function(array){var geometries=[];for(var i=0;i<array.length;++i){var geometry=array[i];geometries.push(this.read(geometry));}
return this.geometryFactory.createGeometryCollection(geometries);}};jsts.io.GeoJSONParser.prototype.write=function(geometry){var type=geometry.CLASS_NAME.slice(10);if(!this.extract[type]){throw new Error('Geometry is not supported');}
return this.extract[type].apply(this,[geometry]);};jsts.io.GeoJSONParser.prototype.extract={'coordinate':function(coordinate){return[coordinate.x,coordinate.y];},'Point':function(point){var array=this.extract.coordinate.apply(this,[point.coordinate]);return{type:'Point',coordinates:array};},'MultiPoint':function(multipoint){var array=[];for(var i=0;i<multipoint.geometries.length;++i){var point=multipoint.geometries[i];var geoJson=this.extract.Point.apply(this,[point]);array.push(geoJson.coordinates);}
return{type:'MultiPoint',coordinates:array};},'LineString':function(linestring){var array=[];for(var i=0;i<linestring.points.length;++i){var coordinate=linestring.points[i];array.push(this.extract.coordinate.apply(this,[coordinate]));}
return{type:'LineString',coordinates:array};},'MultiLineString':function(multilinestring){var array=[];for(var i=0;i<multilinestring.geometries.length;++i){var linestring=multilinestring.geometries[i];var geoJson=this.extract.LineString.apply(this,[linestring]);array.push(geoJson.coordinates);}
return{type:'MultiLineString',coordinates:array};},'Polygon':function(polygon){var array=[];var shellGeoJson=this.extract.LineString.apply(this,[polygon.shell]);array.push(shellGeoJson.coordinates);for(var i=0;i<polygon.holes.length;++i){var hole=polygon.holes[i];var holeGeoJson=this.extract.LineString.apply(this,[hole]);array.push(holeGeoJson.coordinates);}
return{type:'Polygon',coordinates:array};},'MultiPolygon':function(multipolygon){var array=[];for(var i=0;i<multipolygon.geometries.length;++i){var polygon=multipolygon.geometries[i];var geoJson=this.extract.Polygon.apply(this,[polygon]);array.push(geoJson.coordinates);}
return{type:'MultiPolygon',coordinates:array};},'GeometryCollection':function(collection){var array=[];for(var i=0;i<collection.geometries.length;++i){var geometry=collection.geometries[i];var type=geometry.CLASS_NAME.slice(10);array.push(this.extract[type].apply(this,[geometry]));}
return{type:'GeometryCollection',geometries:array};}};})();jsts.triangulate.quadedge.Vertex=function(){if(arguments.length===1){this.initFromCoordinate(arguments[0]);}else{this.initFromXY(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.LEFT=0;jsts.triangulate.quadedge.Vertex.RIGHT=1;jsts.triangulate.quadedge.Vertex.BEYOND=2;jsts.triangulate.quadedge.Vertex.BEHIND=3;jsts.triangulate.quadedge.Vertex.BETWEEN=4;jsts.triangulate.quadedge.Vertex.ORIGIN=5;jsts.triangulate.quadedge.Vertex.DESTINATION=6;jsts.triangulate.quadedge.Vertex.prototype.initFromXY=function(x,y){this.p=new jsts.geom.Coordinate(x,y);};jsts.triangulate.quadedge.Vertex.prototype.initFromCoordinate=function(_p){this.p=new jsts.geom.Coordinate(_p);};jsts.triangulate.quadedge.Vertex.prototype.getX=function(){return this.p.x;};jsts.triangulate.quadedge.Vertex.prototype.getY=function(){return this.p.y;};jsts.triangulate.quadedge.Vertex.prototype.getZ=function(){return this.p.z;};jsts.triangulate.quadedge.Vertex.prototype.setZ=function(z){this.p.z=z;};jsts.triangulate.quadedge.Vertex.prototype.getCoordinate=function(){return this.p;};jsts.triangulate.quadedge.Vertex.prototype.toString=function(){return'POINT ('+this.p.x+' '+this.p.y+')';};jsts.triangulate.quadedge.Vertex.prototype.equals=function(){if(arguments.length===1){return this.equalsExact(arguments[0]);}else{return this.equalsWithTolerance(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.Vertex.prototype.equalsExact=function(other){return(this.p.x===other.getX()&&this.p.y===other.getY());};jsts.triangulate.quadedge.Vertex.prototype.equalsWithTolerance=function(other,tolerance){return(this.p.distance(other.getCoordinate())<tolerance);};jsts.triangulate.quadedge.Vertex.prototype.classify=function(p0,p1){var p2,a,b,sa;p2=this;a=p1.sub(p0);b=p2.sub(p0);sa=a.crossProduct(b);if(sa>0.0){return jsts.triangulate.quadedge.Vertex.LEFT;}
if(sa<0.0){return jsts.triangulate.quadedge.Vertex.RIGHT;}
if((a.getX()*b.getX()<0.0)||(a.getY()*b.getY()<0.0)){return jsts.triangulate.quadedge.Vertex.BEHIND;}
if(a.magn()<b.magn()){return jsts.triangulate.quadedge.Vertex.BEYOND;}
if(p0.equals(p2)){return jsts.triangulate.quadedge.Vertex.ORIGIN;}
if(p1.equals(p2)){return jsts.triangulate.quadedge.Vertex.DESTINATION;}
return jsts.triangulate.quadedge.Vertex.BETWEEN;};jsts.triangulate.quadedge.Vertex.prototype.crossProduct=function(v){return((this.p.x*v.getY())-(this.p.y*v.getX()));};jsts.triangulate.quadedge.Vertex.prototype.dot=function(v){return((this.p.x*v.getX())+(this.p.y*v.getY()));};jsts.triangulate.quadedge.Vertex.prototype.times=function(c){return new jsts.triangulate.quadedge.Vertex(c*this.p.x,c*this.p.y);};jsts.triangulate.quadedge.Vertex.prototype.sum=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x+v.getX(),this.p.y+
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.sub=function(v){return new jsts.triangulate.quadedge.Vertex(this.p.x-v.getX(),this.p.y-
v.getY());};jsts.triangulate.quadedge.Vertex.prototype.magn=function(){return(Math.sqrt((this.p.x*this.p.x)+(this.p.y*this.p.y)));};jsts.triangulate.quadedge.Vertex.prototype.cross=function(){return new Vertex(this.p.y,-this.p.x);};jsts.triangulate.quadedge.Vertex.prototype.isInCircle=function(a,b,c){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust(a.p,b.p,c.p,this.p);};jsts.triangulate.quadedge.Vertex.prototype.isCCW=function(b,c){return((b.p.x-this.p.x)*(c.p.y-this.p.y)-(b.p.y-this.p.y)*(c.p.x-this.p.x)>0);};jsts.triangulate.quadedge.Vertex.prototype.rightOf=function(e){return this.isCCW(e.dest(),e.orig());};jsts.triangulate.quadedge.Vertex.prototype.leftOf=function(e){return this.isCCW(e.orig(),e.dest());};jsts.triangulate.quadedge.Vertex.prototype.bisector=function(a,b){var dx,dy,l1,l2;dx=b.getX()-a.getX();dy=b.getY()-a.getY();l1=new jsts.algorithm.HCoordinate(a.getX()+(dx/2.0),a.getY()+
(dy/2.0),1.0);l2=new jsts.algorithm.HCoordinate(a.getX()-dy+(dx/2.0),a.getY()+
dx+(dy/2.0),1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.triangulate.quadedge.Vertex.prototype.distance=function(v1,v2){return v1.p.distance(v2.p);};jsts.triangulate.quadedge.Vertex.prototype.circumRadiusRatio=function(b,c){var x,radius,edgeLength,el;x=this.circleCenter(b,c);radius=this.distance(x,b);edgeLength=this.distance(this,b);el=this.distance(b,c);if(el<edgeLength){edgeLength=el;}
el=this.distance(c,this);if(el<edgeLength){edgeLength=el;}
return radius/edgeLength;};jsts.triangulate.quadedge.Vertex.prototype.midPoint=function(a){var xm,ym;xm=(this.p.x+a.getX())/2.0;ym=(this.p.y+a.getY())/2.0;return new jsts.triangulate.quadedge.Vertex(xm,ym);};jsts.triangulate.quadedge.Vertex.prototype.circleCenter=function(b,c){var a,cab,cbc,hcc,cc;a=new jsts.triangulate.quadedge.Vertex(this.getX(),this.getY());cab=this.bisector(a,b);cbc=this.bisector(b,c);hcc=new jsts.algorithm.HCoordinate(cab,cbc);cc=null;try{cc=new jsts.triangulate.quadedge.Vertex(hcc.getX(),hcc.getY());}catch(err){}
return cc;};jsts.operation.valid.IsValidOp=function(parentGeometry){this.parentGeometry=parentGeometry;this.isSelfTouchingRingFormingHoleValid=false;this.validErr=null;};jsts.operation.valid.IsValidOp.isValid=function(arg){if(arguments[0]instanceof jsts.geom.Coordinate){if(isNaN(arg.x)){return false;}
if(!isFinite(arg.x)&&!isNaN(arg.x)){return false;}
if(isNaN(arg.y)){return false;}
if(!isFinite(arg.y)&&!isNaN(arg.y)){return false;}
return true;}else{var isValidOp=new jsts.operation.valid.IsValidOp(arg);return isValidOp.isValid();}};jsts.operation.valid.IsValidOp.findPtNotNode=function(testCoords,searchRing,graph){var searchEdge=graph.findEdge(searchRing);var eiList=searchEdge.getEdgeIntersectionList();for(var i=0;i<testCoords.length;i++){var pt=testCoords[i];if(!eiList.isIntersection(pt)){return pt;}}
return null;};jsts.operation.valid.IsValidOp.prototype.setSelfTouchingRingFormingHoleValid=function(isValid){this.isSelfTouchingRingFormingHoleValid=isValid;};jsts.operation.valid.IsValidOp.prototype.isValid=function(){this.checkValid(this.parentGeometry);return this.validErr==null;};jsts.operation.valid.IsValidOp.prototype.getValidationError=function(){this.checkValid(this.parentGeometry);return this.validErr;};jsts.operation.valid.IsValidOp.prototype.checkValid=function(g){this.validErr=null;if(g.isEmpty()){return;}
if(g instanceof jsts.geom.Point){this.checkValidPoint(g);}else if(g instanceof jsts.geom.MultiPoint){this.checkValidMultiPoint(g);}else if(g instanceof jsts.geom.LinearRing){this.checkValidLinearRing(g);}else if(g instanceof jsts.geom.LineString){this.checkValidLineString(g);}else if(g instanceof jsts.geom.Polygon){this.checkValidPolygon(g);}else if(g instanceof jsts.geom.MultiPolygon){this.checkValidMultiPolygon(g);}else if(g instanceof jsts.geom.GeometryCollection){this.checkValidGeometryCollection(g);}else{throw g.constructor;}};jsts.operation.valid.IsValidOp.prototype.checkValidPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPoint=function(g){this.checkInvalidCoordinates(g.getCoordinates());};jsts.operation.valid.IsValidOp.prototype.checkValidLineString=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidLinearRing=function(g){this.checkInvalidCoordinates(g.getCoordinates());if(this.validErr!=null){return;}
this.checkClosedRing(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
var li=new jsts.algorithm.RobustLineIntersector();graph.computeSelfNodes(li,true);this.checkNoSelfIntersectingRings(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidPolygon=function(g){this.checkInvalidCoordinates(g);if(this.validErr!=null){return;}
this.checkClosedRings(g);if(this.validErr!=null){return;}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
this.checkHolesInShell(g,graph);if(this.validErr!=null){return;}
this.checkHolesNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidMultiPolygon=function(g){var il=g.getNumGeometries();for(var i=0;i<il;i++){var p=g.getGeometryN(i);this.checkInvalidCoordinates(p);if(this.validErr!=null){return;}
this.checkClosedRings(p);if(this.validErr!=null){return;}}
var graph=new jsts.geomgraph.GeometryGraph(0,g);this.checkTooFewPoints(graph);if(this.validErr!=null){return;}
this.checkConsistentArea(graph);if(this.validErr!=null){return;}
if(!this.isSelfTouchingRingFormingHoleValid){this.checkNoSelfIntersectingRings(graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesInShell(p,graph);if(this.validErr!=null){return;}}
for(var i=0;i<g.getNumGeometries();i++){var p=g.getGeometryN(i);this.checkHolesNotNested(p,graph);if(this.validErr!=null){return;}}
this.checkShellsNotNested(g,graph);if(this.validErr!=null){return;}
this.checkConnectedInteriors(graph);};jsts.operation.valid.IsValidOp.prototype.checkValidGeometryCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.checkValid(g);if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkInvalidCoordinates=function(arg){if(arg instanceof jsts.geom.Polygon){var poly=arg;this.checkInvalidCoordinates(poly.getExteriorRing().getCoordinates());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkInvalidCoordinates(poly.getInteriorRingN(i).getCoordinates());if(this.validErr!=null){return;}}}else{var coords=arg;for(var i=0;i<coords.length;i++){if(!jsts.operation.valid.IsValidOp.isValid(coords[i])){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE,coords[i]);return;}}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRings=function(poly){this.checkClosedRing(poly.getExteriorRing());if(this.validErr!=null){return;}
for(var i=0;i<poly.getNumInteriorRing();i++){this.checkClosedRing(poly.getInteriorRingN(i));if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkClosedRing=function(ring){if(!ring.isClosed()){var pt=null;if(ring.getNumPoints()>=1){pt=ring.getCoordinateN(0);}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED,pt);}};jsts.operation.valid.IsValidOp.prototype.checkTooFewPoints=function(graph){if(graph.hasTooFewPoints){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS,graph.getInvalidPoint());return;}};jsts.operation.valid.IsValidOp.prototype.checkConsistentArea=function(graph){var cat=new jsts.operation.valid.ConsistentAreaTester(graph);var isValidArea=cat.isNodeConsistentArea();if(!isValidArea){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION,cat.getInvalidPoint());return;}
if(cat.hasDuplicateRings()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS,cat.getInvalidPoint());}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRings=function(graph){for(var i=graph.getEdgeIterator();i.hasNext();){var e=i.next();this.checkNoSelfIntersectingRing(e.getEdgeIntersectionList());if(this.validErr!=null){return;}}};jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRing=function(eiList){var nodeSet=[];var isFirst=true;for(var i=eiList.iterator();i.hasNext();){var ei=i.next();if(isFirst){isFirst=false;continue;}
if(nodeSet.indexOf(ei.coord)>=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION,ei.coord);return;}else{nodeSet.push(ei.coord);}}};jsts.operation.valid.IsValidOp.prototype.checkHolesInShell=function(p,graph){var shell=p.getExteriorRing();var pir=new jsts.algorithm.MCPointInRing(shell);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(hole.getCoordinates(),shell,graph);if(holePt==null){return;}
var outside=!pir.isInside(holePt);if(outside){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL,holePt);return;}}};jsts.operation.valid.IsValidOp.prototype.checkHolesNotNested=function(p,graph){var nestedTester=new jsts.operation.valid.IndexedNestedRingTester(graph);for(var i=0;i<p.getNumInteriorRing();i++){var innerHole=p.getInteriorRingN(i);nestedTester.add(innerHole);}
var isNonNested=nestedTester.isNonNested();if(!isNonNested){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_HOLES,nestedTester.getNestedPoint());}};jsts.operation.valid.IsValidOp.prototype.checkShellsNotNested=function(mp,graph){for(var i=0;i<mp.getNumGeometries();i++){var p=mp.getGeometryN(i);var shell=p.getExteriorRing();for(var j=0;j<mp.getNumGeometries();j++){if(i==j){continue;}
var p2=mp.getGeometryN(j);this.checkShellNotNested(shell,p2,graph);if(this.validErr!=null){return;}}}};jsts.operation.valid.IsValidOp.prototype.checkShellNotNested=function(shell,p,graph){var shellPts=shell.getCoordinates();var polyShell=p.getExteriorRing();var polyPts=polyShell.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,polyShell,graph);if(shellPt==null){return;}
var insidePolyShell=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,polyPts);if(!insidePolyShell){return;}
if(p.getNumInteriorRing()<=0){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,shellPt);return;}
var badNestedPt=null;for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);badNestedPt=this.checkShellInsideHole(shell,hole,graph);if(badNestedPt==null){return;}}
this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,badNestedPt);};jsts.operation.valid.IsValidOp.prototype.checkShellInsideHole=function(shell,hole,graph){var shellPts=shell.getCoordinates();var holePts=hole.getCoordinates();var shellPt=jsts.operation.valid.IsValidOp.findPtNotNode(shellPts,hole,graph);if(shellPt!=null){var insideHole=jsts.algorithm.CGAlgorithms.isPointInRing(shellPt,holePts);if(!insideHole){return shellPt;}}
var holePt=jsts.operation.valid.IsValidOp.findPtNotNode(holePts,shell,graph);if(holePt!=null){var insideShell=jsts.algorithm.CGAlgorithms.isPointInRing(holePt,shellPts);if(insideShell){return holePt;}
return null;}
jsts.util.Assert.shouldNeverReachHere('points in shell and hole appear to be equal');return null;};jsts.operation.valid.IsValidOp.prototype.checkConnectedInteriors=function(graph){var cit=new jsts.operation.valid.ConnectedInteriorTester(graph);if(!cit.isInteriorsConnected()){this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR,cit.getCoordinate());}};jsts.algorithm.RobustDeterminant=function(){};jsts.algorithm.RobustDeterminant.signOfDet2x2=function(x1,y1,x2,y2){var sign,swap,k,count;count=0;sign=1;if((x1===0.0)||(y2===0.0)){if((y1===0.0)||(x2===0.0)){return 0;}
else if(y1>0){if(x2>0){return-sign;}
else{return sign;}}
else{if(x2>0){return sign;}
else{return-sign;}}}
if((y1===0.0)||(x2===0.0)){if(y2>0){if(x1>0){return sign;}
else{return-sign;}}
else{if(x1>0){return-sign;}
else{return sign;}}}
if(0.0<y1){if(0.0<y2){if(y1>y2){sign=-sign;swap=x1;x1=x2;x2=swap;swap=y1;y1=y2;y2=swap;}}
else{if(y1<=-y2){sign=-sign;x2=-x2;y2=-y2;}
else{swap=x1;x1=-x2;x2=swap;swap=y1;y1=-y2;y2=swap;}}}
else{if(0.0<y2){if(-y1<=y2){sign=-sign;x1=-x1;y1=-y1;}
else{swap=-x1;x1=x2;x2=swap;swap=-y1;y1=y2;y2=swap;}}
else{if(y1>=y2){x1=-x1;y1=-y1;x2=-x2;y2=-y2;}
else{sign=-sign;swap=-x1;x1=-x2;x2=swap;swap=-y1;y1=-y2;y2=swap;}}}
if(0.0<x1){if(0.0<x2){if(x1>x2){return sign;}}
else{return sign;}}
else{if(0.0<x2){return-sign;}
else{if(x1>=x2){sign=-sign;x1=-x1;x2=-x2;}
else{return-sign;}}}
while(true){count=count+1;k=Math.floor(x2/x1);x2=x2-k*x1;y2=y2-k*y1;if(y2<0.0){return-sign;}
if(y2>y1){return sign;}
if(x1>x2+x2){if(y1<y2+y2){return sign;}}
else{if(y1>y2+y2){return-sign;}
else{x2=x1-x2;y2=y1-y2;sign=-sign;}}
if(y2===0.0){if(x2===0.0){return 0;}
else{return-sign;}}
if(x2===0.0){return sign;}
k=Math.floor(x1/x2);x1=x1-k*x2;y1=y1-k*y2;if(y1<0.0){return sign;}
if(y1>y2){return-sign;}
if(x2>x1+x1){if(y2<y1+y1){return-sign;}}
else{if(y2>y1+y1){return sign;}
else{x1=x2-x1;y1=y2-y1;sign=-sign;}}
if(y1===0.0){if(x1===0.0){return 0;}
else{return sign;}}
if(x1===0.0){return-sign;}}};jsts.algorithm.RobustDeterminant.orientationIndex=function(p1,p2,q){var dx1=p2.x-p1.x;var dy1=p2.y-p1.y;var dx2=q.x-p2.x;var dy2=q.y-p2.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(dx1,dy1,dx2,dy2);};jsts.index.quadtree.NodeBase=function(){this.subnode=new Array(4);this.subnode[0]=null;this.subnode[1]=null;this.subnode[2]=null;this.subnode[3]=null;this.items=[];};jsts.index.quadtree.NodeBase.prototype.getSubnodeIndex=function(env,centre){var subnodeIndex=-1;if(env.getMinX()>=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=3;}
if(env.getMaxY()<=centre.y){subnodeIndex=1;}}
if(env.getMaxX()<=centre.x){if(env.getMinY()>=centre.y){subnodeIndex=2;}
if(env.getMaxY()<=centre.y){subnodeIndex=0;}}
return subnodeIndex;};jsts.index.quadtree.NodeBase.prototype.getItems=function(){return this.items;};jsts.index.quadtree.NodeBase.prototype.hasItems=function(){return(this.items.length>0);};jsts.index.quadtree.NodeBase.prototype.add=function(item){this.items.push(item);};jsts.index.quadtree.NodeBase.prototype.remove=function(itemEnv,item){if(!this.isSearchMatch(itemEnv)){return false;}
var found=false,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemEnv,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
if(this.items.indexOf(item)!==-1){for(var i=this.items.length-1;i>=0;i--){if(this.items[i]===item){this.items.splice(i,1);}}
found=true;}
return found;};jsts.index.quadtree.NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};jsts.index.quadtree.NodeBase.prototype.hasChildren=function(){var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){return true;}}
return false;};jsts.index.quadtree.NodeBase.prototype.isEmpty=function(){var isEmpty=true;if(this.items.length>0){isEmpty=false;}
var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){if(!this.subnode[i].isEmpty()){isEmpty=false;}}}
return isEmpty;};jsts.index.quadtree.NodeBase.prototype.addAllItems=function(resultItems){resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItems(resultItems);}}
return resultItems;};jsts.index.quadtree.NodeBase.prototype.addAllItemsFromOverlapping=function(searchEnv,resultItems){if(!this.isSearchMatch(searchEnv)){return;}
resultItems=resultItems.concat(this.items);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){resultItems=this.subnode[i].addAllItemsFromOverlapping(searchEnv,resultItems);}}};jsts.index.quadtree.NodeBase.prototype.visit=function(searchEnv,visitor){if(!this.isSearchMatch(searchEnv)){return;}
this.visitItems(searchEnv,visitor);var i=0;for(i;i<4;i++){if(this.subnode[i]!==null){this.subnode[i].visit(searchEnv,visitor);}}};jsts.index.quadtree.NodeBase.prototype.visitItems=function(env,visitor){var i=0,il=this.items.length;for(i;i<il;i++){visitor.visitItem(this.items[i]);}};jsts.index.quadtree.NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,sqd;for(i;i<4;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};jsts.index.quadtree.NodeBase.prototype.size=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.length;};jsts.index.quadtree.NodeBase.prototype.getNodeCount=function(){var subSize=0,i=0;for(i;i<4;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+1;};jsts.index.quadtree.Node=function(env,level){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.env=env;this.level=level;this.centre=new jsts.geom.Coordinate();this.centre.x=(env.getMinX()+env.getMaxX())/2;this.centre.y=(env.getMinY()+env.getMaxY())/2;};jsts.index.quadtree.Node.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Node.createNode=function(env){var key,node;key=new jsts.index.quadtree.Key(env);node=new jsts.index.quadtree.Node(key.getEnvelope(),key.getLevel());return node;};jsts.index.quadtree.Node.createExpanded=function(node,addEnv){var expandEnv=new jsts.geom.Envelope(addEnv),largerNode;if(node!==null){expandEnv.expandToInclude(node.env);}
largerNode=jsts.index.quadtree.Node.createNode(expandEnv);if(node!==null){largerNode.insertNode(node);}
return largerNode;};jsts.index.quadtree.Node.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Node.prototype.isSearchMatch=function(searchEnv){return this.env.intersects(searchEnv);};jsts.index.quadtree.Node.prototype.getNode=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex!==-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchEnv);}else{return this;}};jsts.index.quadtree.Node.prototype.find=function(searchEnv){var subnodeIndex=this.getSubnodeIndex(searchEnv,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchEnv);}
return this;};jsts.index.quadtree.Node.prototype.insertNode=function(node){var index=this.getSubnodeIndex(node.env,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insertNode(node);this.subnode[index]=childNode;}};jsts.index.quadtree.Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};jsts.index.quadtree.Node.prototype.createSubnode=function(index){var minx=0.0,maxx=0.0,miny=0.0,maxy=0.0,sqEnv,node;switch(index){case 0:minx=this.env.getMinX();maxx=this.centre.x;miny=this.env.getMinY();maxy=this.centre.y;break;case 1:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.env.getMinY();maxy=this.centre.y;break;case 2:minx=this.env.getMinX();maxx=this.centre.x;miny=this.centre.y;maxy=this.env.getMaxY();break;case 3:minx=this.centre.x;maxx=this.env.getMaxX();miny=this.centre.y;maxy=this.env.getMaxY();break;}
sqEnv=new jsts.geom.Envelope(minx,maxx,miny,maxy);node=new jsts.index.quadtree.Node(sqEnv,this.level-1);return node;};(function(){jsts.triangulate.quadedge.QuadEdge=function(){this.rot=null;this.vertex=null;this.next=null;this.data=null;};var QuadEdge=jsts.triangulate.quadedge.QuadEdge;jsts.triangulate.quadedge.QuadEdge.makeEdge=function(o,d){var q0,q1,q2,q3,base;q0=new QuadEdge();q1=new QuadEdge();q2=new QuadEdge();q3=new QuadEdge();q0.rot=q1;q1.rot=q2;q2.rot=q3;q3.rot=q0;q0.setNext(q0);q1.setNext(q3);q2.setNext(q2);q3.setNext(q1);base=q0;base.setOrig(o);base.setDest(d);return base;};jsts.triangulate.quadedge.QuadEdge.connect=function(a,b){var e=QuadEdge.makeEdge(a.dest(),b.orig());QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b);return e;};jsts.triangulate.quadedge.QuadEdge.splice=function(a,b){var alpha,beta,t1,t2,t3,t4;alpha=a.oNext().rot;beta=b.oNext().rot;t1=b.oNext();t2=a.oNext();t3=beta.oNext();t4=alpha.oNext();a.setNext(t1);b.setNext(t2);alpha.setNext(t3);beta.setNext(t4);};jsts.triangulate.quadedge.QuadEdge.swap=function(e){var a,b;a=e.oPrev();b=e.sym().oPrev();QuadEdge.splice(e,a);QuadEdge.splice(e.sym(),b);QuadEdge.splice(e,a.lNext());QuadEdge.splice(e.sym(),b.lNext());e.setOrig(a.dest());e.setDest(b.dest());};jsts.triangulate.quadedge.QuadEdge.prototype.getPrimary=function(){if(this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0){return this;}
else{return this.sym();}};jsts.triangulate.quadedge.QuadEdge.prototype.setData=function(data){this.data=data;};jsts.triangulate.quadedge.QuadEdge.prototype.getData=function(){return this.data;};jsts.triangulate.quadedge.QuadEdge.prototype.delete_jsts=function(){this.rot=null;};jsts.triangulate.quadedge.QuadEdge.prototype.isLive=function(){return this.rot!==null;};jsts.triangulate.quadedge.QuadEdge.prototype.setNext=function(next){this.next=next;};jsts.triangulate.quadedge.QuadEdge.prototype.invRot=function(){return this.rot.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.sym=function(){return this.rot.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.oNext=function(){return this.next;};jsts.triangulate.quadedge.QuadEdge.prototype.oPrev=function(){return this.rot.next.rot;};jsts.triangulate.quadedge.QuadEdge.prototype.dNext=function(){return this.sym().oNext().sym();};jsts.triangulate.quadedge.QuadEdge.prototype.dPrev=function(){return this.invRot().oNext().invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.lNext=function(){return this.invRot().oNext().rot;};jsts.triangulate.quadedge.QuadEdge.prototype.lPrev=function(){return this.next.sym();};jsts.triangulate.quadedge.QuadEdge.prototype.rNext=function(){return this.rot.next.invRot();};jsts.triangulate.quadedge.QuadEdge.prototype.rPrev=function(){return this.sym().oNext();};jsts.triangulate.quadedge.QuadEdge.prototype.setOrig=function(o){this.vertex=o;};jsts.triangulate.quadedge.QuadEdge.prototype.setDest=function(d){this.sym().setOrig(d);};jsts.triangulate.quadedge.QuadEdge.prototype.orig=function(){return this.vertex;};jsts.triangulate.quadedge.QuadEdge.prototype.dest=function(){return this.sym().orig();};jsts.triangulate.quadedge.QuadEdge.prototype.getLength=function(){return this.orig().getCoordinate().distance(dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.equalsNonOriented=function(qe){if(this.equalsOriented(qe)){return true;}
if(this.equalsOriented(qe.sym())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.equalsOriented=function(qe){if(this.orig().getCoordinate().equals2D(qe.orig().getCoordinate())&&this.dest().getCoordinate().equals2D(qe.dest().getCoordinate())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdge.prototype.toLineSegment=function()
{return new jsts.geom.LineSegment(this.vertex.getCoordinate(),this.dest().getCoordinate());};jsts.triangulate.quadedge.QuadEdge.prototype.toString=function(){var p0,p1;p0=this.vertex.getCoordinate();p1=this.dest().getCoordinate();return jsts.io.WKTWriter.toLineString(p0,p1);};})();(function(){var Assert=jsts.util.Assert;jsts.geomgraph.EdgeEnd=function(edge,p0,p1,label){this.edge=edge;if(p0&&p1){this.init(p0,p1);}
if(label){this.label=label||null;}};jsts.geomgraph.EdgeEnd.prototype.edge=null;jsts.geomgraph.EdgeEnd.prototype.label=null;jsts.geomgraph.EdgeEnd.prototype.node=null;jsts.geomgraph.EdgeEnd.prototype.p0=null;jsts.geomgraph.EdgeEnd.prototype.p1=null;jsts.geomgraph.EdgeEnd.prototype.dx=null;jsts.geomgraph.EdgeEnd.prototype.dy=null;jsts.geomgraph.EdgeEnd.prototype.quadrant=null;jsts.geomgraph.EdgeEnd.prototype.init=function(p0,p1){this.p0=p0;this.p1=p1;this.dx=p1.x-p0.x;this.dy=p1.y-p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(this.dx,this.dy);Assert.isTrue(!(this.dx===0&&this.dy===0),'EdgeEnd with identical endpoints found');};jsts.geomgraph.EdgeEnd.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.EdgeEnd.prototype.getLabel=function(){return this.label;};jsts.geomgraph.EdgeEnd.prototype.getCoordinate=function(){return this.p0;};jsts.geomgraph.EdgeEnd.prototype.getDirectedCoordinate=function(){return this.p1;};jsts.geomgraph.EdgeEnd.prototype.getQuadrant=function(){return this.quadrant;};jsts.geomgraph.EdgeEnd.prototype.getDx=function(){return this.dx;};jsts.geomgraph.EdgeEnd.prototype.getDy=function(){return this.dy;};jsts.geomgraph.EdgeEnd.prototype.setNode=function(node){this.node=node;};jsts.geomgraph.EdgeEnd.prototype.getNode=function(){return this.node;};jsts.geomgraph.EdgeEnd.prototype.compareTo=function(e){return this.compareDirection(e);};jsts.geomgraph.EdgeEnd.prototype.compareDirection=function(e){if(this.dx===e.dx&&this.dy===e.dy)
return 0;if(this.quadrant>e.quadrant)
return 1;if(this.quadrant<e.quadrant)
return-1;return jsts.algorithm.CGAlgorithms.computeOrientation(e.p0,e.p1,this.p1);};jsts.geomgraph.EdgeEnd.prototype.computeLabel=function(boundaryNodeRule){};})();jsts.operation.buffer.RightmostEdgeFinder=function(){};jsts.operation.buffer.RightmostEdgeFinder.prototype.minIndex=-1;jsts.operation.buffer.RightmostEdgeFinder.prototype.minCoord=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.minDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.orientedDe=null;jsts.operation.buffer.RightmostEdgeFinder.prototype.getEdge=function(){return this.orientedDe;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getCoordinate=function(){return this.minCoord;};jsts.operation.buffer.RightmostEdgeFinder.prototype.findEdge=function(dirEdgeList){for(var i=dirEdgeList.iterator();i.hasNext();){var de=i.next();if(!de.isForward())
continue;this.checkForRightmostCoordinate(de);}
jsts.util.Assert.isTrue(this.minIndex!==0||this.minCoord.equals(this.minDe.getCoordinate()),'inconsistency in rightmost processing');if(this.minIndex===0){this.findRightmostEdgeAtNode();}else{this.findRightmostEdgeAtVertex();}
this.orientedDe=this.minDe;var rightmostSide=this.getRightmostSide(this.minDe,this.minIndex);if(rightmostSide==jsts.geomgraph.Position.LEFT){this.orientedDe=this.minDe.getSym();}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtNode=function(){var node=this.minDe.getNode();var star=node.getEdges();this.minDe=star.getRightmostEdge();if(!this.minDe.isForward()){this.minDe=this.minDe.getSym();this.minIndex=this.minDe.getEdge().getCoordinates().length-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtVertex=function(){var pts=this.minDe.getEdge().getCoordinates();jsts.util.Assert.isTrue(this.minIndex>0&&this.minIndex<pts.length,'rightmost point expected to be interior vertex of edge');var pPrev=pts[this.minIndex-1];var pNext=pts[this.minIndex+1];var orientation=jsts.algorithm.CGAlgorithms.computeOrientation(this.minCoord,pNext,pPrev);var usePrev=false;if(pPrev.y<this.minCoord.y&&pNext.y<this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE){usePrev=true;}else if(pPrev.y>this.minCoord.y&&pNext.y>this.minCoord.y&&orientation===jsts.algorithm.CGAlgorithms.CLOCKWISE){usePrev=true;}
if(usePrev){this.minIndex=this.minIndex-1;}};jsts.operation.buffer.RightmostEdgeFinder.prototype.checkForRightmostCoordinate=function(de){var coord=de.getEdge().getCoordinates();for(var i=0;i<coord.length-1;i++){if(this.minCoord===null||coord[i].x>this.minCoord.x){this.minDe=de;this.minIndex=i;this.minCoord=coord[i];}}};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSide=function(de,index){var side=this.getRightmostSideOfSegment(de,index);if(side<0)
side=this.getRightmostSideOfSegment(de,index-1);if(side<0){this.minCoord=null;this.checkForRightmostCoordinate(de);}
return side;};jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSideOfSegment=function(de,i){var e=de.getEdge();var coord=e.getCoordinates();if(i<0||i+1>=coord.length)
return-1;if(coord[i].y==coord[i+1].y)
return-1;var pos=jsts.geomgraph.Position.LEFT;if(coord[i].y<coord[i+1].y)
pos=jsts.geomgraph.Position.RIGHT;return pos;};(function(){jsts.triangulate.IncrementalDelaunayTriangulator=function(subdiv){this.subdiv=subdiv;this.isUsingTolerance=subdiv.getTolerance()>0.0;};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSites=function(vertices){var i=0,il=vertices.length,v;for(i;i<il;i++){v=vertices[i];this.insertSite(v);}};jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSite=function(v){var e,base,startEdge,t;e=this.subdiv.locate(v);if(this.subdiv.isVertexOfEdge(e,v)){return e;}
else if(this.subdiv.isOnEdge(e,v.getCoordinate())){e=e.oPrev();this.subdiv.delete_jsts(e.oNext());}
base=this.subdiv.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.subdiv.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);do{t=e.oPrev();if(t.dest().rightOf(e)&&v.isInCircle(e.orig(),t.dest(),e.dest())){jsts.triangulate.quadedge.QuadEdge.swap(e);e=e.oPrev();}else if(e.oNext()==startEdge){return base;}else{e=e.oNext().lPrev();}}while(true);};}());jsts.algorithm.CentroidArea=function(){this.basePt=null;this.triangleCent3=new jsts.geom.Coordinate();this.centSum=new jsts.geom.Coordinate();this.cg3=new jsts.geom.Coordinate();};jsts.algorithm.CentroidArea.prototype.basePt=null;jsts.algorithm.CentroidArea.prototype.triangleCent3=null;jsts.algorithm.CentroidArea.prototype.areasum2=0;jsts.algorithm.CentroidArea.prototype.cg3=null;jsts.algorithm.CentroidArea.prototype.centSum=null;jsts.algorithm.CentroidArea.prototype.totalLength=0.0;jsts.algorithm.CentroidArea.prototype.add=function(geom){if(geom instanceof jsts.geom.Polygon){var poly=geom;this.setBasePoint(poly.getExteriorRing().getCoordinateN(0));this.add3(poly);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPolygon){var gc=geom;for(var i=0;i<gc.getNumGeometries();i++){this.add(gc.getGeometryN(i));}}else if(geom instanceof Array){this.add2(geom);}};jsts.algorithm.CentroidArea.prototype.add2=function(ring){this.setBasePoint(ring[0]);this.addShell(ring);};jsts.algorithm.CentroidArea.prototype.getCentroid=function(){var cent=new jsts.geom.Coordinate();if(Math.abs(this.areasum2)>0.0){cent.x=this.cg3.x/3/this.areasum2;cent.y=this.cg3.y/3/this.areasum2;}else{cent.x=this.centSum.x/this.totalLength;cent.y=this.centSum.y/this.totalLength;}
return cent;};jsts.algorithm.CentroidArea.prototype.setBasePoint=function(basePt){if(this.basePt==null)
this.basePt=basePt;};jsts.algorithm.CentroidArea.prototype.add3=function(poly){this.addShell(poly.getExteriorRing().getCoordinates());for(var i=0;i<poly.getNumInteriorRing();i++){this.addHole(poly.getInteriorRingN(i).getCoordinates());}};jsts.algorithm.CentroidArea.prototype.addShell=function(pts){var isPositiveArea=!jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addHole=function(pts){var isPositiveArea=jsts.algorithm.CGAlgorithms.isCCW(pts);for(var i=0;i<pts.length-1;i++){this.addTriangle(this.basePt,pts[i],pts[i+1],isPositiveArea);}
this.addLinearSegments(pts);};jsts.algorithm.CentroidArea.prototype.addTriangle=function(p0,p1,p2,isPositiveArea){var sign=(isPositiveArea)?1.0:-1.0;jsts.algorithm.CentroidArea.centroid3(p0,p1,p2,this.triangleCent3);var area2=jsts.algorithm.CentroidArea.area2(p0,p1,p2);this.cg3.x+=sign*area2*this.triangleCent3.x;this.cg3.y+=sign*area2*this.triangleCent3.y;this.areasum2+=sign*area2;};jsts.algorithm.CentroidArea.centroid3=function(p1,p2,p3,c){c.x=p1.x+p2.x+p3.x;c.y=p1.y+p2.y+p3.y;return;};jsts.algorithm.CentroidArea.area2=function(p1,p2,p3){return(p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y);};jsts.algorithm.CentroidArea.prototype.addLinearSegments=function(pts){for(var i=0;i<pts.length-1;i++){var segmentLen=pts[i].distance(pts[i+1]);this.totalLength+=segmentLen;var midx=(pts[i].x+pts[i+1].x)/2;this.centSum.x+=segmentLen*midx;var midy=(pts[i].y+pts[i+1].y)/2;this.centSum.y+=segmentLen*midy;}};jsts.geomgraph.index.SweepLineSegment=function(edge,ptIndex){this.edge=edge;this.ptIndex=ptIndex;this.pts=edge.getCoordinates();};jsts.geomgraph.index.SweepLineSegment.prototype.edge=null;jsts.geomgraph.index.SweepLineSegment.prototype.pts=null;jsts.geomgraph.index.SweepLineSegment.prototype.ptIndex=null;jsts.geomgraph.index.SweepLineSegment.prototype.getMinX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1<x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.getMaxX=function(){var x1=this.pts[this.ptIndex].x;var x2=this.pts[this.ptIndex+1].x;if(x1>x2){return x1;}
return x2;};jsts.geomgraph.index.SweepLineSegment.prototype.computeIntersections=function(ss,si){si.addIntersections(this.edge,this.ptIndex,ss.edge,ss.ptIndex);};jsts.index.quadtree.Root=function(){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments);this.origin=new jsts.geom.Coordinate(0.0,0.0);};jsts.index.quadtree.Root.prototype=new jsts.index.quadtree.NodeBase();jsts.index.quadtree.Root.prototype.insert=function(itemEnv,item){var index=this.getSubnodeIndex(itemEnv,this.origin);if(index===-1){this.add(item);return;}
var node=this.subnode[index];if(node===null||!node.getEnvelope().contains(itemEnv)){var largerNode=jsts.index.quadtree.Node.createExpanded(node,itemEnv);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemEnv,item);};jsts.index.quadtree.Root.prototype.insertContained=function(tree,itemEnv,item){var isZeroX,isZeroY,node;isZeroX=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinX(),itemEnv.getMaxX());isZeroY=jsts.index.IntervalSize.isZeroWidth(itemEnv.getMinY(),itemEnv.getMaxY());if(isZeroX||isZeroY){node=tree.find(itemEnv);}else{node=tree.getNode(itemEnv);}
node.add(item);};jsts.index.quadtree.Root.prototype.isSearchMatch=function(searchEnv){return true;};jsts.geomgraph.index.MonotoneChainIndexer=function(){};jsts.geomgraph.index.MonotoneChainIndexer.toIntArray=function(list){var array=[];for(var i=list.iterator();i.hasNext();){var element=i.next();array.push(element);}
return array;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.getChainStartIndices=function(pts){var start=0;var startIndexList=new javascript.util.ArrayList();startIndexList.add(start);do{var last=this.findChainEnd(pts,start);startIndexList.add(last);start=last;}while(start<pts.length-1);var startIndex=jsts.geomgraph.index.MonotoneChainIndexer.toIntArray(startIndexList);return startIndex;};jsts.geomgraph.index.MonotoneChainIndexer.prototype.findChainEnd=function(pts,start){var chainQuad=jsts.geomgraph.Quadrant.quadrant(pts[start],pts[start+1]);var last=start+1;while(last<pts.length){var quad=jsts.geomgraph.Quadrant.quadrant(pts[last-1],pts[last]);if(quad!=chainQuad){break;}
last++;}
return last-1;};jsts.noding.IntersectionAdder=function(li){this.li=li;};jsts.noding.IntersectionAdder.prototype=new jsts.noding.SegmentIntersector();jsts.noding.IntersectionAdder.constructor=jsts.noding.IntersectionAdder;jsts.noding.IntersectionAdder.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.noding.IntersectionAdder.prototype._hasIntersection=false;jsts.noding.IntersectionAdder.prototype.hasProper=false;jsts.noding.IntersectionAdder.prototype.hasProperInterior=false;jsts.noding.IntersectionAdder.prototype.hasInterior=false;jsts.noding.IntersectionAdder.prototype.properIntersectionPoint=null;jsts.noding.IntersectionAdder.prototype.li=null;jsts.noding.IntersectionAdder.prototype.isSelfIntersection=null;jsts.noding.IntersectionAdder.prototype.numIntersections=0;jsts.noding.IntersectionAdder.prototype.numInteriorIntersections=0;jsts.noding.IntersectionAdder.prototype.numProperIntersections=0;jsts.noding.IntersectionAdder.prototype.numTests=0;jsts.noding.IntersectionAdder.prototype.getLineIntersector=function(){return this.li;};jsts.noding.IntersectionAdder.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.noding.IntersectionAdder.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.noding.IntersectionAdder.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.noding.IntersectionAdder.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.noding.IntersectionAdder.prototype.hasInteriorIntersection=function(){return this.hasInterior;};jsts.noding.IntersectionAdder.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0==e1){if(this.li.getIntersectionNum()==1){if(jsts.noding.IntersectionAdder.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.size()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.noding.IntersectionAdder.prototype.processIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){this.numIntersections++;if(this.li.isInteriorIntersection()){this.numInteriorIntersections++;this.hasInterior=true;}
if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);if(this.li.isProper()){this.numProperIntersections++;this.hasProper=true;this.hasProperInterior=true;}}}};jsts.noding.IntersectionAdder.prototype.isDone=function(){return false;};jsts.operation.union.CascadedPolygonUnion=function(polys){this.inputPolys=polys;};jsts.operation.union.CascadedPolygonUnion.union=function(polys){var op=new jsts.operation.union.CascadedPolygonUnion(polys);return op.union();};jsts.operation.union.CascadedPolygonUnion.prototype.inputPolys;jsts.operation.union.CascadedPolygonUnion.prototype.geomFactory=null;jsts.operation.union.CascadedPolygonUnion.prototype.STRTREE_NODE_CAPACITY=4;jsts.operation.union.CascadedPolygonUnion.prototype.union=function(){if(this.inputPolys.length===0){return null;}
this.geomFactory=this.inputPolys[0].getFactory();var index=new jsts.index.strtree.STRtree(this.STRTREE_NODE_CAPACITY);for(var i=0,l=this.inputPolys.length;i<l;i++){var item=this.inputPolys[i];index.insert(item.getEnvelopeInternal(),item);}
var itemTree=index.itemsTree();var unionAll=this.unionTree(itemTree);return unionAll;};jsts.operation.union.CascadedPolygonUnion.prototype.unionTree=function(geomTree){var geoms=this.reduceToGeometries(geomTree);var union=this.binaryUnion(geoms);return union;};jsts.operation.union.CascadedPolygonUnion.prototype.binaryUnion=function(geoms,start,end){start=start||0;end=end||geoms.length;if(end-start<=1){var g0=this.getGeometry(geoms,start);return this.unionSafe(g0,null);}
else if(end-start===2){return this.unionSafe(this.getGeometry(geoms,start),this.getGeometry(geoms,start+1));}
else{var mid=parseInt((end+start)/2);var g0=this.binaryUnion(geoms,start,mid);var g1=this.binaryUnion(geoms,mid,end);return this.unionSafe(g0,g1);}};jsts.operation.union.CascadedPolygonUnion.prototype.getGeometry=function(list,index){if(index>=list.length){return null;}
return list[index];};jsts.operation.union.CascadedPolygonUnion.prototype.reduceToGeometries=function(geomTree){var geoms=[];for(var i=0,l=geomTree.length;i<l;i++){var o=geomTree[i],geom=null;if(o instanceof Array){geom=this.unionTree(o);}
else if(o instanceof jsts.geom.Geometry){geom=o;}
geoms.push(geom);}
return geoms;};jsts.operation.union.CascadedPolygonUnion.prototype.unionSafe=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g0===null){return g1.clone();}
if(g1===null){return g0.clone();}
return this.unionOptimized(g0,g1);};jsts.operation.union.CascadedPolygonUnion.prototype.unionOptimized=function(g0,g1){var g0Env=g0.getEnvelopeInternal(),g1Env=g1.getEnvelopeInternal();if(!g0Env.intersects(g1Env)){var combo=jsts.geom.util.GeometryCombiner.combine(g0,g1);return combo;}
if(g0.getNumGeometries<=1&&g1.getNumGeometries<=1){return this.unionActual(g0,g1);}
var commonEnv=g0Env.intersection(g1Env);return this.unionUsingEnvelopeIntersection(g0,g1,commonEnv);};jsts.operation.union.CascadedPolygonUnion.prototype.unionUsingEnvelopeIntersection=function(g0,g1,common){var disjointPolys=new javascript.util.ArrayList();var g0Int=this.extractByEnvelope(common,g0,disjointPolys);var g1Int=this.extractByEnvelope(common,g1,disjointPolys);var union=this.unionActual(g0Int,g1Int);disjointPolys.add(union);var overallUnion=jsts.geom.util.GeometryCombiner.combine(disjointPolys);return overallUnion;};jsts.operation.union.CascadedPolygonUnion.prototype.extractByEnvelope=function(env,geom,disjointGeoms){var intersectingGeoms=new javascript.util.ArrayList();for(var i=0;i<geom.getNumGeometries();i++){var elem=geom.getGeometryN(i);if(elem.getEnvelopeInternal().intersects(env)){intersectingGeoms.add(elem);}
else{disjointGeoms.add(elem);}}
return this.geomFactory.buildGeometry(intersectingGeoms);};jsts.operation.union.CascadedPolygonUnion.prototype.unionActual=function(g0,g1){return g0.union(g1);};(function(){jsts.geom.MultiPoint=function(points,factory){this.geometries=points||[];this.factory=factory;};jsts.geom.MultiPoint.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiPoint.constructor=jsts.geom.MultiPoint;jsts.geom.MultiPoint.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null);};jsts.geom.MultiPoint.prototype.getGeometryN=function(n){return this.geometries[n];};jsts.geom.MultiPoint.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiPoint.prototype.CLASS_NAME='jsts.geom.MultiPoint';})();jsts.operation.buffer.OffsetCurveBuilder=function(precisionModel,bufParams){this.precisionModel=precisionModel;this.bufParams=bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.distance=0.0;jsts.operation.buffer.OffsetCurveBuilder.prototype.precisionModel=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.bufParams=null;jsts.operation.buffer.OffsetCurveBuilder.prototype.getBufferParameters=function(){return this.bufParams;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getLineCurve=function(inputPts,distance){this.distance=distance;if(this.distance<0.0&&!this.bufParams.isSingleSided())
return null;if(this.distance==0.0)
return null;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{if(this.bufParams.isSingleSided()){var isRightSide=distance<0.0;this.computeSingleSidedBufferCurve(inputPts,isRightSide,segGen);}else
this.computeLineBufferCurve(inputPts,segGen);}
var lineCoord=segGen.getCoordinates();return lineCoord;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getRingCurve=function(inputPts,side,distance){this.distance=distance;if(inputPts.length<=2)
return this.getLineCurve(inputPts,distance);if(this.distance==0.0){return jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates(inputPts);}
var segGen=this.getSegGen(this.distance);this.computeRingBufferCurve(inputPts,side,segGen);return segGen.getCoordinates();};jsts.operation.buffer.OffsetCurveBuilder.prototype.getOffsetCurve=function(inputPts,distance){this.distance=distance;if(this.distance===0.0)
return null;var isRightSide=this.distance<0.0;var posDistance=Math.abs(this.distance);var segGen=this.getSegGen(posDistance);if(inputPts.length<=1){this.computePointCurve(inputPts[0],segGen);}else{this.computeOffsetCurve(inputPts,isRightSide,segGen);}
var curvePts=segGen.getCoordinates();if(isRightSide)
curvePts.reverse();return curvePts;};jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates=function(pts){var copy=[];for(var i=0;i<pts.length;i++){copy.push(pts[i].clone());}
return copy;};jsts.operation.buffer.OffsetCurveBuilder.prototype.getSegGen=function(distance){return new jsts.operation.buffer.OffsetSegmentGenerator(this.precisionModel,this.bufParams,distance);};jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR=100.0;jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance=function(bufDistance){return bufDistance/jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR;};jsts.operation.buffer.OffsetCurveBuilder.prototype.computePointCurve=function(pt,segGen){switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:segGen.createCircle(pt);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:segGen.createSquare(pt);break;}};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeLineBufferCurve=function(inputPts,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp1[n1-1],simp1[n1]);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}
segGen.addLastSegment();segGen.addLineEndCap(simp2[1],simp2[0]);segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeSingleSidedBufferCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){segGen.addSegments(inputPts,true);var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{segGen.addSegments(inputPts,false);var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();segGen.closeRing();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeOffsetCurve=function(inputPts,isRightSide,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(isRightSide){var simp2=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,-distTol);var n2=simp2.length-1;segGen.initSideSegments(simp2[n2],simp2[n2-1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=n2-2;i>=0;i--){segGen.addNextSegment(simp2[i],true);}}else{var simp1=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n1=simp1.length-1;segGen.initSideSegments(simp1[0],simp1[1],jsts.geomgraph.Position.LEFT);segGen.addFirstSegment();for(var i=2;i<=n1;i++){segGen.addNextSegment(simp1[i],true);}}
segGen.addLastSegment();};jsts.operation.buffer.OffsetCurveBuilder.prototype.computeRingBufferCurve=function(inputPts,side,segGen){var distTol=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(side===jsts.geomgraph.Position.RIGHT)
distTol=-distTol;var simp=jsts.operation.buffer.BufferInputLineSimplifier.simplify(inputPts,distTol);var n=simp.length-1;segGen.initSideSegments(simp[n-1],simp[0],side);for(var i=1;i<=n;i++){var addStartPoint=i!==1;segGen.addNextSegment(simp[i],addStartPoint);}
segGen.closeRing();};(function(){var HotPixelSnapAction=function(hotPixel,parentEdge,vertexIndex){this.hotPixel=hotPixel;this.parentEdge=parentEdge;this.vertexIndex=vertexIndex;};HotPixelSnapAction.prototype=new jsts.index.chain.MonotoneChainSelectAction();HotPixelSnapAction.constructor=HotPixelSnapAction;HotPixelSnapAction.prototype.hotPixel=null;HotPixelSnapAction.prototype.parentEdge=null;HotPixelSnapAction.prototype.vertexIndex=null;HotPixelSnapAction.prototype._isNodeAdded=false;HotPixelSnapAction.prototype.isNodeAdded=function(){return this._isNodeAdded;};HotPixelSnapAction.prototype.select=function(mc,startIndex){var ss=mc.getContext();if(this.parentEdge!==null){if(ss===this.parentEdge&&startIndex===this.vertexIndex)
return;}
this._isNodeAdded=this.hotPixel.addSnappedNode(ss,startIndex);};jsts.noding.snapround.MCIndexPointSnapper=function(index){this.index=index;};jsts.noding.snapround.MCIndexPointSnapper.prototype.index=null;jsts.noding.snapround.MCIndexPointSnapper.prototype.snap=function(hotPixel,parentEdge,vertexIndex){if(arguments.length===1){this.snap2.apply(this,arguments);return;}
var pixelEnv=hotPixel.getSafeEnvelope();var hotPixelSnapAction=new HotPixelSnapAction(hotPixel,parentEdge,vertexIndex);this.index.query(pixelEnv,{visitItem:function(testChain){testChain.select(pixelEnv,hotPixelSnapAction);}});return hotPixelSnapAction.isNodeAdded();};jsts.noding.snapround.MCIndexPointSnapper.prototype.snap2=function(hotPixel){return this.snap(hotPixel,null,-1);};})();(function(){var NodeBase=function(){this.items=new javascript.util.ArrayList();this.subnode=[null,null];};NodeBase.getSubnodeIndex=function(interval,centre){var subnodeIndex=-1;if(interval.min>=centre){subnodeIndex=1;}
if(interval.max<=centre){subnodeIndex=0;}
return subnodeIndex;};NodeBase.prototype.getItems=function(){return this.items;};NodeBase.prototype.add=function(item){this.items.add(item);};NodeBase.prototype.addAllItems=function(items){items.addAll(this.items);var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){this.subnode[i].addAllItems(items);}}
return items;};NodeBase.prototype.addAllItemsFromOverlapping=function(interval,resultItems){if(interval!==null&&!this.isSearchMatch(interval)){return;}
resultItems.addAll(this.items);if(this.subnode[0]!==null){this.subnode[0].addAllItemsFromOverlapping(interval,resultItems);}
if(this.subnode[1]!==null){this.subnode[1].addAllItemsFromOverlapping(interval,resultItems);}};NodeBase.prototype.remove=function(itemInterval,item){if(!this.isSearchMatch(itemInterval)){return false;}
var found=false,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){found=this.subnode[i].remove(itemInterval,item);if(found){if(this.subnode[i].isPrunable()){this.subnode[i]=null;}
break;}}}
if(found){return found;}
found=this.items.remove(item);return found;};NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems());};NodeBase.prototype.hasChildren=function(){var i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){return true;}}
return false;};NodeBase.prototype.hasItems=function(){return!this.items.isEmpty();};NodeBase.prototype.depth=function(){var maxSubDepth=0,i=0,il=2,sqd;for(i;i<il;i++){if(this.subnode[i]!==null){sqd=this.subnode[i].depth();if(sqd>maxSubDepth){maxSubDepth=sqd;}}}
return maxSubDepth+1;};NodeBase.prototype.size=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].size();}}
return subSize+this.items.size();};NodeBase.prototype.nodeSize=function(){var subSize=0,i=0,il=2;for(i;i<il;i++){if(this.subnode[i]!==null){subSize+=this.subnode[i].nodeSize();}}
return subSize+1;};jsts.index.bintree.NodeBase=NodeBase;})();(function(){var NodeBase=jsts.index.bintree.NodeBase;var Key=jsts.index.bintree.Key;var Interval=jsts.index.bintree.Interval;var Node=function(interval,level){this.items=new javascript.util.ArrayList();this.subnode=[null,null];this.interval=interval;this.level=level;this.centre=(interval.getMin()+interval.getMax())/2;};Node.prototype=new NodeBase();Node.constructor=Node;Node.createNode=function(itemInterval){var key,node;key=new Key(itemInterval);node=new Node(key.getInterval(),key.getLevel());return node;};Node.createExpanded=function(node,addInterval){var expandInt,largerNode;expandInt=new Interval(addInterval);if(node!==null){expandInt.expandToInclude(node.interval);}
largerNode=Node.createNode(expandInt);if(node!==null){largerNode.insert(node);}
return largerNode;};Node.prototype.getInterval=function(){return this.interval;};Node.prototype.isSearchMatch=function(itemInterval){return itemInterval.overlaps(this.interval);};Node.prototype.getNode=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex!=-1){node=this.getSubnode(subnodeIndex);return node.getNode(searchInterval);}else{return this;}};Node.prototype.find=function(searchInterval){var subnodeIndex=NodeBase.getSubnodeIndex(searchInterval,this.centre),node;if(subnodeIndex===-1){return this;}
if(this.subnode[subnodeIndex]!==null){node=this.subnode[subnodeIndex];return node.find(searchInterval);}
return this;};Node.prototype.insert=function(node){var index=NodeBase.getSubnodeIndex(node.interval,this.centre),childNode;if(node.level===this.level-1){this.subnode[index]=node;}else{childNode=this.createSubnode(index);childNode.insert(node);this.subnode[index]=childNode;}};Node.prototype.getSubnode=function(index){if(this.subnode[index]===null){this.subnode[index]=this.createSubnode(index);}
return this.subnode[index];};Node.prototype.createSubnode=function(index){var min,max,subInt,node;min=0.0;max=0.0;switch(index){case 0:min=this.interval.getMin();max=this.centre;break;case 1:min=this.centre;max=this.interval.getMax();break;}
subInt=new Interval(min,max);node=new Node(subInt,this.level-1);return node;};jsts.index.bintree.Node=Node;})();(function(){var Node=jsts.index.bintree.Node;var NodeBase=jsts.index.bintree.NodeBase;var Root=function(){this.subnode=[null,null];this.items=new javascript.util.ArrayList();};Root.prototype=new jsts.index.bintree.NodeBase();Root.constructor=Root;Root.origin=0.0;Root.prototype.insert=function(itemInterval,item){var index=NodeBase.getSubnodeIndex(itemInterval,Root.origin),node,largerNode;if(index===-1){this.add(item);return;}
node=this.subnode[index];if(node===null||!node.getInterval().contains(itemInterval)){largerNode=Node.createExpanded(node,itemInterval);this.subnode[index]=largerNode;}
this.insertContained(this.subnode[index],itemInterval,item);};Root.prototype.insertContained=function(tree,itemInterval,item){var isZeroArea,node;isZeroArea=jsts.index.IntervalSize.isZeroWidth(itemInterval.getMin(),itemInterval.getMax());node=isZeroArea?tree.find(itemInterval):tree.getNode(itemInterval);node.add(item);};Root.prototype.isSearchMatch=function(interval){return true;};jsts.index.bintree.Root=Root;})();jsts.geomgraph.Quadrant=function(){};jsts.geomgraph.Quadrant.NE=0;jsts.geomgraph.Quadrant.NW=1;jsts.geomgraph.Quadrant.SW=2;jsts.geomgraph.Quadrant.SE=3;jsts.geomgraph.Quadrant.quadrant=function(dx,dy){if(dx instanceof jsts.geom.Coordinate){return jsts.geomgraph.Quadrant.quadrant2.apply(this,arguments);}
if(dx===0.0&&dy===0.0)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for point ( '+dx+', '+dy+' )');if(dx>=0.0){if(dy>=0.0)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(dy>=0.0)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.quadrant2=function(p0,p1){if(p1.x===p0.x&&p1.y===p0.y)
throw new jsts.error.IllegalArgumentError('Cannot compute the quadrant for two identical points '+p0);if(p1.x>=p0.x){if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NE;else
return jsts.geomgraph.Quadrant.SE;}else{if(p1.y>=p0.y)
return jsts.geomgraph.Quadrant.NW;else
return jsts.geomgraph.Quadrant.SW;}};jsts.geomgraph.Quadrant.isOpposite=function(quad1,quad2){if(quad1===quad2)
return false;var diff=(quad1-quad2+4)%4;if(diff===2)
return true;return false;};jsts.geomgraph.Quadrant.commonHalfPlane=function(quad1,quad2){if(quad1===quad2)
return quad1;var diff=(quad1-quad2+4)%4;if(diff===2)
return-1;var min=(quad1<quad2)?quad1:quad2;var max=(quad1>quad2)?quad1:quad2;if(min===0&&max===3)
return 3;return min;};jsts.geomgraph.Quadrant.isInHalfPlane=function(quad,halfPlane){if(halfPlane===jsts.geomgraph.Quadrant.SE){return quad===jsts.geomgraph.Quadrant.SE||quad===jsts.geomgraph.Quadrant.SW;}
return quad===halfPlane||quad===halfPlane+1;};jsts.geomgraph.Quadrant.isNorthern=function(quad){return quad===jsts.geomgraph.Quadrant.NE||quad===jsts.geomgraph.Quadrant.NW;};jsts.operation.valid.ConsistentAreaTester=function(geomGraph){this.geomGraph=geomGraph;this.li=new jsts.algorithm.RobustLineIntersector();this.nodeGraph=new jsts.operation.relate.RelateNodeGraph();this.invalidPoint=null;};jsts.operation.valid.ConsistentAreaTester.prototype.getInvalidPoint=function(){return this.invalidPoint;};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeConsistentArea=function(){var intersector=this.geomGraph.computeSelfNodes(this.li,true);if(intersector.hasProperIntersection()){this.invalidPoint=intersector.getProperIntersectionPoint();return false;}
this.nodeGraph.build(this.geomGraph);return this.isNodeEdgeAreaLabelsConsistent();};jsts.operation.valid.ConsistentAreaTester.prototype.isNodeEdgeAreaLabelsConsistent=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();if(!node.getEdges().isAreaLabelsConsistent(this.geomGraph)){this.invalidPoint=node.getCoordinate().clone();return false;}}
return true;};jsts.operation.valid.ConsistentAreaTester.prototype.hasDuplicateRings=function(){for(var nodeIt=this.nodeGraph.getNodeIterator();nodeIt.hasNext();){var node=nodeIt.next();for(var i=node.getEdges().iterator();i.hasNext();){var eeb=i.next();if(eeb.getEdgeEnds().length>1){invalidPoint=eeb.getEdge().getCoordinate(0);return true;}}}
return false;};jsts.operation.relate.RelateNode=function(coord,edges){jsts.geomgraph.Node.apply(this,arguments);};jsts.operation.relate.RelateNode.prototype=new jsts.geomgraph.Node();jsts.operation.relate.RelateNode.prototype.computeIM=function(im){im.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0);};jsts.operation.relate.RelateNode.prototype.updateIMFromEdges=function(im){this.edges.updateIM(im);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var EdgeEnd=jsts.geomgraph.EdgeEnd;jsts.geomgraph.DirectedEdge=function(edge,isForward){EdgeEnd.call(this,edge);this.depth=[0,-999,-999];this._isForward=isForward;if(isForward){this.init(edge.getCoordinate(0),edge.getCoordinate(1));}else{var n=edge.getNumPoints()-1;this.init(edge.getCoordinate(n),edge.getCoordinate(n-1));}
this.computeDirectedLabel();};jsts.geomgraph.DirectedEdge.prototype=new EdgeEnd();jsts.geomgraph.DirectedEdge.constructor=jsts.geomgraph.DirectedEdge;jsts.geomgraph.DirectedEdge.depthFactor=function(currLocation,nextLocation){if(currLocation===Location.EXTERIOR&&nextLocation===Location.INTERIOR)
return 1;else if(currLocation===Location.INTERIOR&&nextLocation===Location.EXTERIOR)
return-1;return 0;};jsts.geomgraph.DirectedEdge.prototype._isForward=null;jsts.geomgraph.DirectedEdge.prototype._isInResult=false;jsts.geomgraph.DirectedEdge.prototype._isVisited=false;jsts.geomgraph.DirectedEdge.prototype.sym=null;jsts.geomgraph.DirectedEdge.prototype.next=null;jsts.geomgraph.DirectedEdge.prototype.nextMin=null;jsts.geomgraph.DirectedEdge.prototype.edgeRing=null;jsts.geomgraph.DirectedEdge.prototype.minEdgeRing=null;jsts.geomgraph.DirectedEdge.prototype.depth=null;jsts.geomgraph.DirectedEdge.prototype.getEdge=function(){return this.edge;};jsts.geomgraph.DirectedEdge.prototype.setInResult=function(isInResult){this._isInResult=isInResult;};jsts.geomgraph.DirectedEdge.prototype.isInResult=function(){return this._isInResult;};jsts.geomgraph.DirectedEdge.prototype.isVisited=function(){return this._isVisited;};jsts.geomgraph.DirectedEdge.prototype.setVisited=function(isVisited){this._isVisited=isVisited;};jsts.geomgraph.DirectedEdge.prototype.setEdgeRing=function(edgeRing){this.edgeRing=edgeRing;};jsts.geomgraph.DirectedEdge.prototype.getEdgeRing=function(){return this.edgeRing;};jsts.geomgraph.DirectedEdge.prototype.setMinEdgeRing=function(minEdgeRing){this.minEdgeRing=minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getMinEdgeRing=function(){return this.minEdgeRing;};jsts.geomgraph.DirectedEdge.prototype.getDepth=function(position){return this.depth[position];};jsts.geomgraph.DirectedEdge.prototype.setDepth=function(position,depthVal){if(this.depth[position]!==-999){if(this.depth[position]!==depthVal)
throw new jsts.error.TopologyError('assigned depths do not match',this.getCoordinate());}
this.depth[position]=depthVal;};jsts.geomgraph.DirectedEdge.prototype.getDepthDelta=function(){var depthDelta=this.edge.getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;return depthDelta;};jsts.geomgraph.DirectedEdge.prototype.setVisitedEdge=function(isVisited){this.setVisited(isVisited);this.sym.setVisited(isVisited);};jsts.geomgraph.DirectedEdge.prototype.getSym=function(){return this.sym;};jsts.geomgraph.DirectedEdge.prototype.isForward=function(){return this._isForward;};jsts.geomgraph.DirectedEdge.prototype.setSym=function(de){this.sym=de;};jsts.geomgraph.DirectedEdge.prototype.getNext=function(){return this.next;};jsts.geomgraph.DirectedEdge.prototype.setNext=function(next){this.next=next;};jsts.geomgraph.DirectedEdge.prototype.getNextMin=function(){return this.nextMin;};jsts.geomgraph.DirectedEdge.prototype.setNextMin=function(nextMin){this.nextMin=nextMin;};jsts.geomgraph.DirectedEdge.prototype.isLineEdge=function(){var isLine=this.label.isLine(0)||this.label.isLine(1);var isExteriorIfArea0=!this.label.isArea(0)||this.label.allPositionsEqual(0,Location.EXTERIOR);var isExteriorIfArea1=!this.label.isArea(1)||this.label.allPositionsEqual(1,Location.EXTERIOR);return isLine&&isExteriorIfArea0&&isExteriorIfArea1;};jsts.geomgraph.DirectedEdge.prototype.isInteriorAreaEdge=function(){var isInteriorAreaEdge=true;for(var i=0;i<2;i++){if(!(this.label.isArea(i)&&this.label.getLocation(i,Position.LEFT)===Location.INTERIOR&&this.label.getLocation(i,Position.RIGHT)===Location.INTERIOR)){isInteriorAreaEdge=false;}}
return isInteriorAreaEdge;};jsts.geomgraph.DirectedEdge.prototype.computeDirectedLabel=function(){this.label=new jsts.geomgraph.Label(this.edge.getLabel());if(!this._isForward)
this.label.flip();};jsts.geomgraph.DirectedEdge.prototype.setEdgeDepths=function(position,depth){var depthDelta=this.getEdge().getDepthDelta();if(!this._isForward)
depthDelta=-depthDelta;var directionFactor=1;if(position===Position.LEFT)
directionFactor=-1;var oppositePos=Position.opposite(position);var delta=depthDelta*directionFactor;var oppositeDepth=depth+delta;this.setDepth(position,depth);this.setDepth(oppositePos,oppositeDepth);};})();jsts.operation.distance.DistanceOp=function(g0,g1,terminateDistance){this.ptLocator=new jsts.algorithm.PointLocator();this.geom=[];this.geom[0]=g0;this.geom[1]=g1;this.terminateDistance=terminateDistance;};jsts.operation.distance.DistanceOp.prototype.geom=null;jsts.operation.distance.DistanceOp.prototype.terminateDistance=0.0;jsts.operation.distance.DistanceOp.prototype.ptLocator=null;jsts.operation.distance.DistanceOp.prototype.minDistanceLocation=null;jsts.operation.distance.DistanceOp.prototype.minDistance=Number.MAX_VALUE;jsts.operation.distance.DistanceOp.distance=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.distance();};jsts.operation.distance.DistanceOp.isWithinDistance=function(g0,g1,distance){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,distance);return distOp.distance()<=distance;};jsts.operation.distance.DistanceOp.nearestPoints=function(g0,g1){var distOp=new jsts.operation.distance.DistanceOp(g0,g1,0.0);return distOp.nearestPoints();};jsts.operation.distance.DistanceOp.prototype.distance=function(){if(this.geom[0]===null||this.geom[1]===null)
throw new jsts.error.IllegalArgumentError('null geometries are not supported');if(this.geom[0].isEmpty()||this.geom[1].isEmpty())
return 0.0;this.computeMinDistance();return this.minDistance;};jsts.operation.distance.DistanceOp.prototype.nearestPoints=function(){this.computeMinDistance();var nearestPts=[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()];return nearestPts;};jsts.operation.distance.DistanceOp.prototype.nearestLocations=function(){this.computeMinDistance();return this.minDistanceLocation;};jsts.operation.distance.DistanceOp.prototype.updateMinDistance=function(locGeom,flip){if(locGeom[0]===null)
return;if(flip){this.minDistanceLocation[0]=locGeom[1];this.minDistanceLocation[1]=locGeom[0];}else{this.minDistanceLocation[0]=locGeom[0];this.minDistanceLocation[1]=locGeom[1];}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance=function(){if(arguments.length>0){this.computeMinDistance2.apply(this,arguments);return;}
if(this.minDistanceLocation!==null)
return;this.minDistanceLocation=[];this.computeContainmentDistance();if(this.minDistance<=this.terminateDistance)
return;this.computeFacetDistance();};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance=function(){if(arguments.length===2){this.computeContainmentDistance2.apply(this,arguments);return;}else if(arguments.length===3&&(!arguments[0]instanceof jsts.operation.distance.GeometryLocation)){this.computeContainmentDistance3.apply(this,arguments);return;}else if(arguments.length===3){this.computeContainmentDistance4.apply(this,arguments);return;}
var locPtPoly=[];this.computeContainmentDistance2(0,locPtPoly);if(this.minDistance<=this.terminateDistance)
return;this.computeContainmentDistance2(1,locPtPoly);};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance2=function(polyGeomIndex,locPtPoly){var locationsIndex=1-polyGeomIndex;var polys=jsts.geom.util.PolygonExtracter.getPolygons(this.geom[polyGeomIndex]);if(polys.length>0){var insideLocs=jsts.operation.distance.ConnectedElementLocationFilter.getLocations(this.geom[locationsIndex]);this.computeContainmentDistance3(insideLocs,polys,locPtPoly);if(this.minDistance<=this.terminateDistance){this.minDistanceLocation[locationsIndex]=locPtPoly[0];this.minDistanceLocation[polyGeomIndex]=locPtPoly[1];return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance3=function(locs,polys,locPtPoly){for(var i=0;i<locs.length;i++){var loc=locs[i];for(var j=0;j<polys.length;j++){this.computeContainmentDistance4(loc,polys[j],locPtPoly);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance4=function(ptLoc,poly,locPtPoly){var pt=ptLoc.getCoordinate();if(jsts.geom.Location.EXTERIOR!==this.ptLocator.locate(pt,poly)){this.minDistance=0.0;locPtPoly[0]=ptLoc;locPtPoly[1]=new jsts.operation.distance.GeometryLocation(poly,pt);return;}};jsts.operation.distance.DistanceOp.prototype.computeFacetDistance=function(){var locGeom=[];var lines0=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[0]);var lines1=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[1]);var pts0=jsts.geom.util.PointExtracter.getPoints(this.geom[0]);var pts1=jsts.geom.util.PointExtracter.getPoints(this.geom[1]);this.computeMinDistanceLines(lines0,lines1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines0,pts1,locGeom);this.updateMinDistance(locGeom,false);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistanceLinesPoints(lines1,pts0,locGeom);this.updateMinDistance(locGeom,true);if(this.minDistance<=this.terminateDistance)
return;locGeom[0]=null;locGeom[1]=null;this.computeMinDistancePoints(pts0,pts1,locGeom);this.updateMinDistance(locGeom,false);};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLines=function(lines0,lines1,locGeom){for(var i=0;i<lines0.length;i++){var line0=lines0[i];for(var j=0;j<lines1.length;j++){var line1=lines1[j];this.computeMinDistance(line0,line1,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistancePoints=function(points0,points1,locGeom){for(var i=0;i<points0.length;i++){var pt0=points0[i];for(var j=0;j<points1.length;j++){var pt1=points1[j];var dist=pt0.getCoordinate().distance(pt1.getCoordinate());if(dist<this.minDistance){this.minDistance=dist;locGeom[0]=new jsts.operation.distance.GeometryLocation(pt0,0,pt0.getCoordinate());locGeom[1]=new jsts.operation.distance.GeometryLocation(pt1,0,pt1.getCoordinate());}
if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLinesPoints=function(lines,points,locGeom){for(var i=0;i<lines.length;i++){var line=lines[i];for(var j=0;j<points.length;j++){var pt=points[j];this.computeMinDistance(line,pt,locGeom);if(this.minDistance<=this.terminateDistance)
return;}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance2=function(line0,line1,locGeom){if(line1 instanceof jsts.geom.Point){this.computeMinDistance3(line0,line1,locGeom);return;}
if(line0.getEnvelopeInternal().distance(line1.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line0.getCoordinates();var coord1=line1.getCoordinates();for(var i=0;i<coord0.length-1;i++){for(var j=0;j<coord1.length-1;j++){var dist=jsts.algorithm.CGAlgorithms.distanceLineLine(coord0[i],coord0[i+1],coord1[j],coord1[j+1]);if(dist<this.minDistance){this.minDistance=dist;var seg0=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var seg1=new jsts.geom.LineSegment(coord1[j],coord1[j+1]);var closestPt=seg0.closestPoints(seg1);locGeom[0]=new jsts.operation.distance.GeometryLocation(line0,i,closestPt[0]);locGeom[1]=new jsts.operation.distance.GeometryLocation(line1,j,closestPt[1]);}
if(this.minDistance<=this.terminateDistance){return;}}}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance3=function(line,pt,locGeom){if(line.getEnvelopeInternal().distance(pt.getEnvelopeInternal())>this.minDistance){return;}
var coord0=line.getCoordinates();var coord=pt.getCoordinate();for(var i=0;i<coord0.length-1;i++){var dist=jsts.algorithm.CGAlgorithms.distancePointLine(coord,coord0[i],coord0[i+1]);if(dist<this.minDistance){this.minDistance=dist;var seg=new jsts.geom.LineSegment(coord0[i],coord0[i+1]);var segClosestPoint=seg.closestPoint(coord);locGeom[0]=new jsts.operation.distance.GeometryLocation(line,i,segClosestPoint);locGeom[1]=new jsts.operation.distance.GeometryLocation(pt,0,coord);}
if(this.minDistance<=this.terminateDistance){return;}}};jsts.index.strtree.SIRtree=function(nodeCapacity){nodeCapacity=nodeCapacity||10;jsts.index.strtree.AbstractSTRtree.call(this,nodeCapacity);};jsts.index.strtree.SIRtree.prototype=new jsts.index.strtree.AbstractSTRtree();jsts.index.strtree.SIRtree.constructor=jsts.index.strtree.SIRtree;jsts.index.strtree.SIRtree.prototype.comperator={compare:function(o1,o2){return o1.getBounds().getCentre()-o2.getBounds().getCentre();}};jsts.index.strtree.SIRtree.prototype.intersectionOp={intersects:function(aBounds,bBounds){return aBounds.intersects(bBounds);}};jsts.index.strtree.SIRtree.prototype.createNode=function(level){var AbstractNode=function(level){jsts.index.strtree.AbstractNode.apply(this,arguments);};AbstractNode.prototype=new jsts.index.strtree.AbstractNode();AbstractNode.constructor=AbstractNode;AbstractNode.prototype.computeBounds=function(){var bounds=null,childBoundables=this.getChildBoundables(),childBoundable;for(var i=0,l=childBoundables.length;i<l;i++){childBoundable=childBoundables[i];if(bounds===null){bounds=new jsts.index.strtree.Interval(childBoundable.getBounds());}
else{bounds.expandToInclude(childBoundable.getBounds());}}
return bounds;};return AbstractNode;};jsts.index.strtree.SIRtree.prototype.insert=function(x1,x2,item){jsts.index.strtree.AbstractSTRtree.prototype.insert(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)),item);};jsts.index.strtree.SIRtree.prototype.query=function(x1,x2){x2=x2||x1;jsts.index.strtree.AbstractSTRtree.prototype.query(new jsts.index.strtree.Interval(Math.min(x1,x2),Math.max(x1,x2)));};jsts.index.strtree.SIRtree.prototype.getIntersectsOp=function(){return this.intersectionOp;};jsts.index.strtree.SIRtree.prototype.getComparator=function(){return this.comperator;};jsts.simplify.DouglasPeuckerSimplifier=function(inputGeom){this.inputGeom=inputGeom;this.isEnsureValidTopology=true;};jsts.simplify.DouglasPeuckerSimplifier.prototype.inputGeom=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.distanceTolerance=null;jsts.simplify.DouglasPeuckerSimplifier.prototype.isEnsureValidTopology=null;jsts.simplify.DouglasPeuckerSimplifier.simplify=function(geom,distanceTolerance){var tss=new jsts.simplify.DouglasPeuckerSimplifier(geom);tss.setDistanceTolerance(distanceTolerance);return tss.getResultGeometry();};jsts.simplify.DouglasPeuckerSimplifier.prototype.setDistanceTolerance=function(distanceTolerance){if(distanceTolerance<0.0){throw"Tolerance must be non-negative";}
this.distanceTolerance=distanceTolerance;};jsts.simplify.DouglasPeuckerSimplifier.prototype.setEnsureValid=function(isEnsureValidTopology){this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DouglasPeuckerSimplifier.prototype.getResultGeometry=function(){if(this.inputGeom.isEmpty()){return this.inputGeom.clone();}
return(new jsts.simplify.DPTransformer(this.distanceTolerance,this.isEnsureValidTopology)).transform(this.inputGeom);};(function(){jsts.operation.predicate.RectangleContains=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleContains.contains=function(rectangle,b){var rc=new jsts.operation.predicate.RectangleContains(rectangle);return rc.contains(b);}
jsts.operation.predicate.RectangleContains.prototype.rectEnv=null;jsts.operation.predicate.RectangleContains.prototype.contains=function(geom){if(!this.rectEnv.contains(geom.getEnvelopeInternal()))
return false;if(this.isContainedInBoundary(geom))
return false;return true;}
jsts.operation.predicate.RectangleContains.prototype.isContainedInBoundary=function(geom){if(geom instanceof jsts.geom.Polygon)return false;if(geom instanceof jsts.geom.Point)return this.isPointContainedInBoundary(geom.getCoordinate());if(geom instanceof jsts.geom.LineString)return this.isLineStringContainedInBoundary(geom);for(var i=0;i<geom.getNumGeometries();i++){var comp=geom.getGeometryN(i);if(!this.isContainedInBoundary(comp))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isPointContainedInBoundary=function(pt){return pt.x==this.rectEnv.getMinX()||pt.x==this.rectEnv.getMaxX()||pt.y==this.rectEnv.getMinY()||pt.y==this.rectEnv.getMaxY();}
jsts.operation.predicate.RectangleContains.prototype.isLineStringContainedInBoundary=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length-1;i++){var p0=seq[i];var p1=seq[i+1];if(!this.isLineSegmentContainedInBoundary(p0,p1))
return false;}
return true;}
jsts.operation.predicate.RectangleContains.prototype.isLineSegmentContainedInBoundary=function(p0,p1){if(p0.equals(p1))
return this.isPointContainedInBoundary(p0);if(p0.x==p1.x){if(p0.x==this.rectEnv.getMinX()||p0.x==this.rectEnv.getMaxX())
return true;}
else if(p0.y==p1.y){if(p0.y==this.rectEnv.getMinY()||p0.y==this.rectEnv.getMaxY())
return true;}
return false;}})();(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;jsts.geomgraph.Depth=function(){this.depth=[[],[]];for(var i=0;i<2;i++){for(var j=0;j<3;j++){this.depth[i][j]=jsts.geomgraph.Depth.NULL_VALUE;}}};jsts.geomgraph.Depth.NULL_VALUE=-1;jsts.geomgraph.Depth.depthAtLocation=function(location){if(location===Location.EXTERIOR)
return 0;if(location===Location.INTERIOR)
return 1;return jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.depth=null;jsts.geomgraph.Depth.prototype.getDepth=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex];};jsts.geomgraph.Depth.prototype.setDepth=function(geomIndex,posIndex,depthValue){this.depth[geomIndex][posIndex]=depthValue;};jsts.geomgraph.Depth.prototype.getLocation=function(geomIndex,posIndex){if(this.depth[geomIndex][posIndex]<=0)
return Location.EXTERIOR;return Location.INTERIOR;};jsts.geomgraph.Depth.prototype.add=function(geomIndex,posIndex,location){if(location===Location.INTERIOR)
this.depth[geomIndex][posIndex]++;};jsts.geomgraph.Depth.prototype.isNull=function(){if(arguments.length>0){return this.isNull2.apply(this,arguments);}
for(var i=0;i<2;i++){for(var j=0;j<3;j++){if(this.depth[i][j]!==jsts.geomgraph.Depth.NULL_VALUE)
return false;}}
return true;};jsts.geomgraph.Depth.prototype.isNull2=function(geomIndex){if(arguments.length>1){return this.isNull3.apply(this,arguments);}
return this.depth[geomIndex][1]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.isNull3=function(geomIndex,posIndex){return this.depth[geomIndex][posIndex]==jsts.geomgraph.Depth.NULL_VALUE;};jsts.geomgraph.Depth.prototype.add=function(lbl){for(var i=0;i<2;i++){for(var j=1;j<3;j++){var loc=lbl.getLocation(i,j);if(loc===Location.EXTERIOR||loc===Location.INTERIOR){if(this.isNull(i,j)){this.depth[i][j]=jsts.geomgraph.Depth.depthAtLocation(loc);}else
this.depth[i][j]+=jsts.geomgraph.Depth.depthAtLocation(loc);}}}};jsts.geomgraph.Depth.prototype.getDelta=function(geomIndex){return this.depth[geomIndex][Position.RIGHT]-
this.depth[geomIndex][Position.LEFT];};jsts.geomgraph.Depth.prototype.normalize=function(){for(var i=0;i<2;i++){if(!this.isNull(i)){var minDepth=this.depth[i][1];if(this.depth[i][2]<minDepth)
minDepth=this.depth[i][2];if(minDepth<0)
minDepth=0;for(var j=1;j<3;j++){var newValue=0;if(this.depth[i][j]>minDepth)
newValue=1;this.depth[i][j]=newValue;}}}};jsts.geomgraph.Depth.prototype.toString=function(){return'A: '+this.depth[0][1]+','+this.depth[0][2]+' B: '+
this.depth[1][1]+','+this.depth[1][2];};})();jsts.algorithm.BoundaryNodeRule=function(){};jsts.algorithm.BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){throw new jsts.error.AbstractMethodInvocationError();};jsts.algorithm.Mod2BoundaryNodeRule=function(){};jsts.algorithm.Mod2BoundaryNodeRule.prototype=new jsts.algorithm.BoundaryNodeRule();jsts.algorithm.Mod2BoundaryNodeRule.prototype.isInBoundary=function(boundaryCount){return boundaryCount%2===1;};jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE=new jsts.algorithm.Mod2BoundaryNodeRule();jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE=jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;jsts.operation.distance.GeometryLocation=function(component,segIndex,pt){this.component=component;this.segIndex=segIndex;this.pt=pt;};jsts.operation.distance.GeometryLocation.INSIDE_AREA=-1;jsts.operation.distance.GeometryLocation.prototype.component=null;jsts.operation.distance.GeometryLocation.prototype.segIndex=null;jsts.operation.distance.GeometryLocation.prototype.pt=null;jsts.operation.distance.GeometryLocation.prototype.getGeometryComponent=function(){return this.component;};jsts.operation.distance.GeometryLocation.prototype.getSegmentIndex=function(){return this.segIndex;};jsts.operation.distance.GeometryLocation.prototype.getCoordinate=function(){return this.pt;};jsts.operation.distance.GeometryLocation.prototype.isInsideArea=function(){return this.segIndex===jsts.operation.distance.GeometryLocation.INSIDE_AREA;};jsts.geom.util.PointExtracter=function(pts){this.pts=pts;};jsts.geom.util.PointExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.PointExtracter.prototype.pts=null;jsts.geom.util.PointExtracter.getPoints=function(geom,list){if(list===undefined){list=[];}
if(geom instanceof jsts.geom.Point){list.push(geom);}else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.PointExtracter(list));}
return list;};jsts.geom.util.PointExtracter.prototype.filter=function(geom){if(geom instanceof jsts.geom.Point)
this.pts.push(geom);};(function(){var Location=jsts.geom.Location;jsts.operation.relate.RelateNodeGraph=function(){this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory());};jsts.operation.relate.RelateNodeGraph.prototype.nodes=null;jsts.operation.relate.RelateNodeGraph.prototype.build=function(geomGraph){this.computeIntersectionNodes(geomGraph,0);this.copyNodesAndLabels(geomGraph,0);var eeBuilder=new jsts.operation.relate.EdgeEndBuilder();var eeList=eeBuilder.computeEdgeEnds(geomGraph.getEdgeIterator());this.insertEdgeEnds(eeList);};jsts.operation.relate.RelateNodeGraph.prototype.computeIntersectionNodes=function(geomGraph,argIndex){for(var edgeIt=geomGraph.getEdgeIterator();edgeIt.hasNext();){var e=edgeIt.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.getEdgeIntersectionList().iterator();eiIt.hasNext();){var ei=eiIt.next();var n=this.nodes.addNode(ei.coord);if(eLoc===Location.BOUNDARY)
n.setLabelBoundary(argIndex);else{if(n.getLabel().isNull(argIndex))
n.setLabel(argIndex,Location.INTERIOR);}}}};jsts.operation.relate.RelateNodeGraph.prototype.copyNodesAndLabels=function(geomGraph,argIndex){for(var nodeIt=geomGraph.getNodeIterator();nodeIt.hasNext();){var graphNode=nodeIt.next();var newNode=this.nodes.addNode(graphNode.getCoordinate());newNode.setLabel(argIndex,graphNode.getLabel().getLocation(argIndex));}};jsts.operation.relate.RelateNodeGraph.prototype.insertEdgeEnds=function(ee){for(var i=ee.iterator();i.hasNext();){var e=i.next();this.nodes.add(e);}};jsts.operation.relate.RelateNodeGraph.prototype.getNodeIterator=function(){return this.nodes.iterator();};})();jsts.geomgraph.index.SimpleSweepLineIntersector=function(){};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector();jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.events=[];jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.nOverlaps=null;jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections=function(edges,si,testAllSegments){if(si instanceof javascript.util.List){this.computeIntersections2.apply(this,arguments);return;}
if(testAllSegments){this.add(edges,null);}else{this.add(edges);}
this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections2=function(edges0,edges1,si){this.add(edges0,edges0);this.add(edges1,edges1);this.computeIntersections3(si);};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add=function(edge,edgeSet){if(edge instanceof javascript.util.List){this.add2.apply(this,arguments);return;}
var pts=edge.getCoordinates();for(var i=0;i<pts.length-1;i++){var ss=new jsts.geomgraph.index.SweepLineSegment(edge,i);var insertEvent=new jsts.geomgraph.index.SweepLineEvent(ss.getMinX(),ss,edgeSet);this.events.push(insertEvent);this.events.push(new jsts.geomgraph.index.SweepLineEvent(ss.getMaxX(),insertEvent));}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add2=function(edges,edgeSet){for(var i=edges.iterator();i.hasNext();){var edge=i.next();if(edgeSet){this.add(edge,edgeSet);}else{this.add(edge,edge);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(a,b){return a.compareTo(b);});for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isDelete()){ev.getInsertEvent().setDeleteEventIndex(i);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections3=function(si){this.nOverlaps=0;this.prepareEvents();for(var i=0;i<this.events.length;i++){var ev=this.events[i];if(ev.isInsert()){this.processOverlaps(i,ev.getDeleteEventIndex(),ev,si);}}};jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.processOverlaps=function(start,end,ev0,si){var ss0=ev0.getObject();for(var i=start;i<end;i++){var ev1=this.events[i];if(ev1.isInsert()){var ss1=ev1.getObject();if(!ev0.isSameLabel(ev1)){ss0.computeIntersections(ss1,si);this.nOverlaps++;}}}}
jsts.triangulate.VoronoiDiagramBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;this.clipEnv=null;this.diagramEnv=null;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesByGeometry(arg);}else{this.setSitesByArray(arg);}};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByArray=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.VoronoiDiagramBuilder.prototype.setClipEnvelope=function(clipEnv){this.clipEnv=clipEnv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.setTolerance=function(tolerance)
{this.tolerance=tolerance;};jsts.triangulate.VoronoiDiagramBuilder.prototype.create=function(){if(this.subdiv!==null){return;}
var siteEnv,expandBy,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);this.diagramEnv=siteEnv;expandBy=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(expandBy);if(this.clipEnv!==null){this.diagramEnv.expandToInclude(this.clipEnv);}
vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);};jsts.triangulate.VoronoiDiagramBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.VoronoiDiagramBuilder.prototype.getDiagram=function(geomFact){this.create();var polys=this.subdiv.getVoronoiDiagram(geomFact);return this.clipGeometryCollection(polys,this.diagramEnv);};jsts.triangulate.VoronoiDiagramBuilder.prototype.clipGeometryCollection=function(geom,clipEnv){var clipPoly,clipped,i,il,g,result;clipPoly=geom.getFactory().toGeometry(clipEnv);clipped=[];i=0,il=geom.getNumGeometries();for(i;i<il;i++){g=geom.getGeometryN(i);result=null;if(clipEnv.contains(g.getEnvelopeInternal())){result=g;}
else if(clipEnv.intersects(g.getEnvelopeInternal())){result=clipPoly.intersection(g);}
if(result!==null&&!result.isEmpty()){clipped.push(result);}}
return geom.getFactory().createGeometryCollection(clipped);};jsts.operation.valid.IndexedNestedRingTester=function(graph){this.graph=graph;this.rings=new javascript.util.ArrayList();this.totalEnv=new jsts.geom.Envelope();this.index=null;this.nestedPt=null;};jsts.operation.valid.IndexedNestedRingTester.prototype.getNestedPoint=function(){return this.nestedPt;};jsts.operation.valid.IndexedNestedRingTester.prototype.add=function(ring){this.rings.add(ring);this.totalEnv.expandToInclude(ring.getEnvelopeInternal());};jsts.operation.valid.IndexedNestedRingTester.prototype.isNonNested=function(){this.buildIndex();for(var i=0;i<this.rings.size();i++){var innerRing=this.rings.get(i);var innerRingPts=innerRing.getCoordinates();var results=this.index.query(innerRing.getEnvelopeInternal());for(var j=0;j<results.length;j++){var searchRing=results[j];var searchRingPts=searchRing.getCoordinates();if(innerRing==searchRing){continue;}
if(!innerRing.getEnvelopeInternal().intersects(searchRing.getEnvelopeInternal())){continue;}
var innerRingPt=jsts.operation.valid.IsValidOp.findPtNotNode(innerRingPts,searchRing,this.graph);if(innerRingPt==null){continue;}
var isInside=jsts.algorithm.CGAlgorithms.isPointInRing(innerRingPt,searchRingPts);if(isInside){this.nestedPt=innerRingPt;return false;}}}
return true;};jsts.operation.valid.IndexedNestedRingTester.prototype.buildIndex=function(){this.index=new jsts.index.strtree.STRtree();for(var i=0;i<this.rings.size();i++){var ring=this.rings.get(i);var env=ring.getEnvelopeInternal();this.index.insert(env,ring);}};jsts.geomgraph.index.MonotoneChain=function(mce,chainIndex){this.mce=mce;this.chainIndex=chainIndex;};jsts.geomgraph.index.MonotoneChain.prototype.mce=null;jsts.geomgraph.index.MonotoneChain.prototype.chainIndex=null;jsts.geomgraph.index.MonotoneChain.prototype.computeIntersections=function(mc,si){this.mce.computeIntersectsForChain(this.chainIndex,mc.mce,mc.chainIndex,si);};jsts.noding.SegmentNode=function(segString,coord,segmentIndex,segmentOctant){this.segString=segString;this.coord=new jsts.geom.Coordinate(coord);this.segmentIndex=segmentIndex;this.segmentOctant=segmentOctant;this._isInterior=!coord.equals2D(segString.getCoordinate(segmentIndex));};jsts.noding.SegmentNode.prototype.segString=null;jsts.noding.SegmentNode.prototype.coord=null;jsts.noding.SegmentNode.prototype.segmentIndex=null;jsts.noding.SegmentNode.prototype.segmentOctant=null;jsts.noding.SegmentNode.prototype._isInterior=null;jsts.noding.SegmentNode.prototype.getCoordinate=function(){return this.coord;};jsts.noding.SegmentNode.prototype.isInterior=function(){return this._isInterior;};jsts.noding.SegmentNode.prototype.isEndPoint=function(maxSegmentIndex){if(this.segmentIndex===0&&!this._isInterior)return true;if(this.segmentIndex===this.maxSegmentIndex)return true;return false;};jsts.noding.SegmentNode.prototype.compareTo=function(obj){var other=obj;if(this.segmentIndex<other.segmentIndex)return-1;if(this.segmentIndex>other.segmentIndex)return 1;if(this.coord.equals2D(other.coord))return 0;return jsts.noding.SegmentPointComparator.compare(this.segmentOctant,this.coord,other.coord);};(function(){jsts.io.GeoJSONWriter=function(){this.parser=new jsts.io.GeoJSONParser(this.geometryFactory);};jsts.io.GeoJSONWriter.prototype.write=function(geometry){var geoJson=this.parser.write(geometry);return geoJson;};})();jsts.io.OpenLayersParser=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();};jsts.io.OpenLayersParser.prototype.read=function(geometry){if(geometry.CLASS_NAME==='OpenLayers.Geometry.Point'){return this.convertFromPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LineString'){return this.convertFromLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.LinearRing'){return this.convertFromLinearRing(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Polygon'){return this.convertFromPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPoint'){return this.convertFromMultiPoint(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiLineString'){return this.convertFromMultiLineString(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.MultiPolygon'){return this.convertFromMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='OpenLayers.Geometry.Collection'){return this.convertFromCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertFromPoint=function(point){return this.geometryFactory.createPoint(new jsts.geom.Coordinate(point.x,point.y));};jsts.io.OpenLayersParser.prototype.convertFromLineString=function(lineString){var i;var coordinates=[];for(i=0;i<lineString.components.length;i++){coordinates.push(new jsts.geom.Coordinate(lineString.components[i].x,lineString.components[i].y));}
return this.geometryFactory.createLineString(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromLinearRing=function(linearRing){var i;var coordinates=[];for(i=0;i<linearRing.components.length;i++){coordinates.push(new jsts.geom.Coordinate(linearRing.components[i].x,linearRing.components[i].y));}
return this.geometryFactory.createLinearRing(coordinates);};jsts.io.OpenLayersParser.prototype.convertFromPolygon=function(polygon){var i;var shell=null;var holes=[];for(i=0;i<polygon.components.length;i++){var linearRing=this.convertFromLinearRing(polygon.components[i]);if(i===0){shell=linearRing;}else{holes.push(linearRing);}}
return this.geometryFactory.createPolygon(shell,holes);};jsts.io.OpenLayersParser.prototype.convertFromMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.components.length;i++){points.push(this.convertFromPoint(multiPoint.components[i]));}
return this.geometryFactory.createMultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertFromMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.components.length;i++){lineStrings.push(this.convertFromLineString(multiLineString.components[i]));}
return this.geometryFactory.createMultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertFromMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.components.length;i++){polygons.push(this.convertFromPolygon(multiPolygon.components[i]));}
return this.geometryFactory.createMultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertFromCollection=function(collection){var i;var geometries=[];for(i=0;i<collection.components.length;i++){geometries.push(this.read(collection.components[i]));}
return this.geometryFactory.createGeometryCollection(geometries);};jsts.io.OpenLayersParser.prototype.write=function(geometry){if(geometry.CLASS_NAME==='jsts.geom.Point'){return this.convertToPoint(geometry.coordinate);}else if(geometry.CLASS_NAME==='jsts.geom.LineString'){return this.convertToLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.LinearRing'){return this.convertToLinearRing(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.Polygon'){return this.convertToPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPoint'){return this.convertToMultiPoint(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiLineString'){return this.convertToMultiLineString(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.MultiPolygon'){return this.convertToMultiPolygon(geometry);}else if(geometry.CLASS_NAME==='jsts.geom.GeometryCollection'){return this.convertToCollection(geometry);}};jsts.io.OpenLayersParser.prototype.convertToPoint=function(coordinate){return new OpenLayers.Geometry.Point(coordinate.x,coordinate.y);};jsts.io.OpenLayersParser.prototype.convertToLineString=function(lineString){var i;var points=[];for(i=0;i<lineString.points.length;i++){var coordinate=lineString.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LineString(points);};jsts.io.OpenLayersParser.prototype.convertToLinearRing=function(linearRing){var i;var points=[];for(i=0;i<linearRing.points.length;i++){var coordinate=linearRing.points[i];points.push(this.convertToPoint(coordinate));}
return new OpenLayers.Geometry.LinearRing(points);};jsts.io.OpenLayersParser.prototype.convertToPolygon=function(polygon){var i;var rings=[];rings.push(this.convertToLinearRing(polygon.shell));for(i=0;i<polygon.holes.length;i++){var ring=polygon.holes[i];rings.push(this.convertToLinearRing(ring));}
return new OpenLayers.Geometry.Polygon(rings);};jsts.io.OpenLayersParser.prototype.convertToMultiPoint=function(multiPoint){var i;var points=[];for(i=0;i<multiPoint.geometries.length;i++){var coordinate=multiPoint.geometries[i].coordinate;points.push(new OpenLayers.Geometry.Point(coordinate.x,coordinate.y));}
return new OpenLayers.Geometry.MultiPoint(points);};jsts.io.OpenLayersParser.prototype.convertToMultiLineString=function(multiLineString){var i;var lineStrings=[];for(i=0;i<multiLineString.geometries.length;i++){lineStrings.push(this.convertToLineString(multiLineString.geometries[i]));}
return new OpenLayers.Geometry.MultiLineString(lineStrings);};jsts.io.OpenLayersParser.prototype.convertToMultiPolygon=function(multiPolygon){var i;var polygons=[];for(i=0;i<multiPolygon.geometries.length;i++){polygons.push(this.convertToPolygon(multiPolygon.geometries[i]));}
return new OpenLayers.Geometry.MultiPolygon(polygons);};jsts.io.OpenLayersParser.prototype.convertToCollection=function(geometryCollection){var i;var geometries=[];for(i=0;i<geometryCollection.geometries.length;i++){var geometry=geometryCollection.geometries[i];var geometryOpenLayers=this.write(geometry);geometries.push(geometryOpenLayers);}
return new OpenLayers.Geometry.Collection(geometries);};jsts.index.quadtree.Quadtree=function(){this.root=new jsts.index.quadtree.Root();this.minExtent=1.0;};jsts.index.quadtree.Quadtree.ensureExtent=function(itemEnv,minExtent){var minx,maxx,miny,maxy;minx=itemEnv.getMinX();maxx=itemEnv.getMaxX();miny=itemEnv.getMinY();maxy=itemEnv.getMaxY();if(minx!==maxx&&miny!==maxy){return itemEnv;}
if(minx===maxx){minx=minx-(minExtent/2.0);maxx=minx+(minExtent/2.0);}
if(miny===maxy){miny=miny-(minExtent/2.0);maxy=miny+(minExtent/2.0);}
return new jsts.geom.Envelope(minx,maxx,miny,maxy);};jsts.index.quadtree.Quadtree.prototype.depth=function(){return this.root.depth();};jsts.index.quadtree.Quadtree.prototype.size=function(){return this.root.size();};jsts.index.quadtree.Quadtree.prototype.insert=function(itemEnv,item){this.collectStats(itemEnv);var insertEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);this.root.insert(insertEnv,item);};jsts.index.quadtree.Quadtree.prototype.remove=function(itemEnv,item){var posEnv=jsts.index.quadtree.Quadtree.ensureExtent(itemEnv,this.minExtent);return this.root.remove(posEnv,item);};jsts.index.quadtree.Quadtree.prototype.query=function(){if(arguments.length===1){return jsts.index.quadtree.Quadtree.prototype.queryByEnvelope.apply(this,arguments);}else{jsts.index.quadtree.Quadtree.prototype.queryWithVisitor.apply(this,arguments);}};jsts.index.quadtree.Quadtree.prototype.queryByEnvelope=function(searchEnv){var visitor=new jsts.index.ArrayListVisitor();this.query(searchEnv,visitor);return visitor.getItems();};jsts.index.quadtree.Quadtree.prototype.queryWithVisitor=function(searchEnv,visitor){this.root.visit(searchEnv,visitor);};jsts.index.quadtree.Quadtree.prototype.queryAll=function(){var foundItems=[];foundItems=this.root.addAllItems(foundItems);return foundItems;};jsts.index.quadtree.Quadtree.prototype.collectStats=function(itemEnv){var delX=itemEnv.getWidth();if(delX<this.minExtent&&delX>0.0){this.minExtent=delX;}
var delY=itemEnv.getHeight();if(delY<this.minExtent&&delY>0.0){this.minExtent=delY;}};jsts.operation.relate.RelateNodeFactory=function(){};jsts.operation.relate.RelateNodeFactory.prototype=new jsts.geomgraph.NodeFactory();jsts.operation.relate.RelateNodeFactory.prototype.createNode=function(coord){return new jsts.operation.relate.RelateNode(coord,new jsts.operation.relate.EdgeEndBundleStar());};jsts.index.quadtree.Key=function(itemEnv){this.pt=new jsts.geom.Coordinate();this.level=0;this.env=null;this.computeKey(itemEnv);};jsts.index.quadtree.Key.computeQuadLevel=function(env){var dx,dy,dMax,level;dx=env.getWidth();dy=env.getHeight();dMax=dx>dy?dx:dy;level=jsts.index.DoubleBits.exponent(dMax)+1;return level;};jsts.index.quadtree.Key.prototype.getPoint=function(){return this.pt;};jsts.index.quadtree.Key.prototype.getLevel=function(){return this.level;};jsts.index.quadtree.Key.prototype.getEnvelope=function(){return this.env;};jsts.index.quadtree.Key.prototype.getCentre=function(){var x,y;x=(this.env.getMinX()+this.env.getMaxX())/2;y=(this.env.getMinY()+this.env.getMaxY())/2;return new jsts.geom.Coordinate(x,y);};jsts.index.quadtree.Key.prototype.computeKey=function(){if(arguments[0]instanceof jsts.geom.Envelope){this.computeKeyFromEnvelope(arguments[0]);}else{this.computeKeyFromLevel(arguments[0],arguments[1]);}};jsts.index.quadtree.Key.prototype.computeKeyFromEnvelope=function(env){this.level=jsts.index.quadtree.Key.computeQuadLevel(env);this.env=new jsts.geom.Envelope();this.computeKey(this.level,env);while(!this.env.contains(env)){this.level+=1;this.computeKey(this.level,env);}};jsts.index.quadtree.Key.prototype.computeKeyFromLevel=function(level,env){var quadSize=jsts.index.DoubleBits.powerOf2(level);this.pt.x=Math.floor(env.getMinX()/quadSize)*quadSize;this.pt.y=Math.floor(env.getMinY()/quadSize)*quadSize;this.env.init(this.pt.x,this.pt.x+quadSize,this.pt.y,this.pt.y+
quadSize);};jsts.geom.CoordinateArrays=function(){throw new jsts.error.AbstractMethodInvocationError();};jsts.geom.CoordinateArrays.copyDeep=function(){if(arguments.length===1){return jsts.geom.CoordinateArrays.copyDeep1(arguments[0]);}else if(arguments.length===5){jsts.geom.CoordinateArrays.copyDeep2(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);}};jsts.geom.CoordinateArrays.copyDeep1=function(coordinates){var copy=[];for(var i=0;i<coordinates.length;i++){copy[i]=new jsts.geom.Coordinate(coordinates[i]);}
return copy;};jsts.geom.CoordinateArrays.copyDeep2=function(src,srcStart,dest,destStart,length){for(var i=0;i<length;i++){dest[destStart+i]=new jsts.geom.Coordinate(src[srcStart+i]);}};jsts.geom.CoordinateArrays.removeRepeatedPoints=function(coord){var coordList;if(!this.hasRepeatedPoints(coord)){return coord;}
coordList=new jsts.geom.CoordinateList(coord,false);return coordList.toCoordinateArray();};jsts.geom.CoordinateArrays.hasRepeatedPoints=function(coord){var i;for(i=1;i<coord.length;i++){if(coord[i-1].equals(coord[i])){return true;}}
return false;};jsts.geom.CoordinateArrays.ptNotInList=function(testPts,pts){for(var i=0;i<testPts.length;i++){var testPt=testPts[i];if(jsts.geom.CoordinateArrays.indexOf(testPt,pts)<0)
return testPt;}
return null;};jsts.geom.CoordinateArrays.increasingDirection=function(pts){for(var i=0;i<parseInt(pts.length/2);i++){var j=pts.length-1-i;var comp=pts[i].compareTo(pts[j]);if(comp!=0)
return comp;}
return 1;};jsts.geom.CoordinateArrays.minCoordinate=function(coordinates){var minCoord=null;for(var i=0;i<coordinates.length;i++){if(minCoord===null||minCoord.compareTo(coordinates[i])>0){minCoord=coordinates[i];}}
return minCoord;};jsts.geom.CoordinateArrays.scroll=function(coordinates,firstCoordinate){var i=jsts.geom.CoordinateArrays.indexOf(firstCoordinate,coordinates);if(i<0)
return;var newCoordinates=coordinates.slice(i).concat(coordinates.slice(0,i));for(i=0;i<newCoordinates.length;i++){coordinates[i]=newCoordinates[i];}};jsts.geom.CoordinateArrays.indexOf=function(coordinate,coordinates){for(var i=0;i<coordinates.length;i++){if(coordinate.equals(coordinates[i])){return i;}}
return-1;};jsts.operation.overlay.MinimalEdgeRing=function(start,geometryFactory){jsts.geomgraph.EdgeRing.call(this,start,geometryFactory);};jsts.operation.overlay.MinimalEdgeRing.prototype=new jsts.geomgraph.EdgeRing();jsts.operation.overlay.MinimalEdgeRing.constructor=jsts.operation.overlay.MinimalEdgeRing;jsts.operation.overlay.MinimalEdgeRing.prototype.getNext=function(de){return de.getNextMin();};jsts.operation.overlay.MinimalEdgeRing.prototype.setEdgeRing=function(de,er){de.setMinEdgeRing(er);};jsts.triangulate.DelaunayTriangulationBuilder=function(){this.siteCoords=null;this.tolerance=0.0;this.subdiv=null;};jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates=function(geom){if(geom===undefined||geom===null){return new jsts.geom.CoordinateList([],false).toArray();}
var coords=geom.getCoordinates();return jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.unique=function(coords){coords.sort(function(a,b){return a.compareTo(b);});var coordList=new jsts.geom.CoordinateList(coords,false);return coordList.toArray();};jsts.triangulate.DelaunayTriangulationBuilder.toVertices=function(coords){var verts=new Array(coords.length),i=0,il=coords.length,coord;for(i;i<il;i++){coord=coords[i];verts[i]=new jsts.triangulate.quadedge.Vertex(coord);}
return verts;};jsts.triangulate.DelaunayTriangulationBuilder.envelope=function(coords){var env=new jsts.geom.Envelope(),i=0,il=coords.length;for(i;i<il;i++){env.expandToInclude(coords[i]);}
return env;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSites=function(){var arg=arguments[0];if(arg instanceof jsts.geom.Geometry||arg instanceof jsts.geom.Coordinate||arg instanceof jsts.geom.Point||arg instanceof jsts.geom.MultiPoint||arg instanceof jsts.geom.LineString||arg instanceof jsts.geom.MultiLineString||arg instanceof jsts.geom.LinearRing||arg instanceof jsts.geom.Polygon||arg instanceof jsts.geom.MultiPolygon){this.setSitesFromGeometry(arg);}else{this.setSitesFromCollection(arg);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromGeometry=function(geom){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(geom);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromCollection=function(coords){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(coords);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.setTolerance=function(tolerance){this.tolerance=tolerance;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.create=function(){if(this.subdiv===null){var siteEnv,vertices,triangulator;siteEnv=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords);vertices=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords);this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(siteEnv,this.tolerance);triangulator=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv);triangulator.insertSites(vertices);}};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getSubdivision=function(){this.create();return this.subdiv;};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getEdges=function(geomFact){this.create();return this.subdiv.getEdges(geomFact);};jsts.triangulate.DelaunayTriangulationBuilder.prototype.getTriangles=function(geomFact){this.create();return this.subdiv.getTriangles(geomFact);};jsts.algorithm.RayCrossingCounter=function(p){this.p=p;};jsts.algorithm.RayCrossingCounter.locatePointInRing=function(p,ring){var counter=new jsts.algorithm.RayCrossingCounter(p);for(var i=1;i<ring.length;i++){var p1=ring[i];var p2=ring[i-1];counter.countSegment(p1,p2);if(counter.isOnSegment())
return counter.getLocation();}
return counter.getLocation();};jsts.algorithm.RayCrossingCounter.prototype.p=null;jsts.algorithm.RayCrossingCounter.prototype.crossingCount=0;jsts.algorithm.RayCrossingCounter.prototype.isPointOnSegment=false;jsts.algorithm.RayCrossingCounter.prototype.countSegment=function(p1,p2){if(p1.x<this.p.x&&p2.x<this.p.x)
return;if(this.p.x==p2.x&&this.p.y===p2.y){this.isPointOnSegment=true;return;}
if(p1.y===this.p.y&&p2.y===this.p.y){var minx=p1.x;var maxx=p2.x;if(minx>maxx){minx=p2.x;maxx=p1.x;}
if(this.p.x>=minx&&this.p.x<=maxx){this.isPointOnSegment=true;}
return;}
if(((p1.y>this.p.y)&&(p2.y<=this.p.y))||((p2.y>this.p.y)&&(p1.y<=this.p.y))){var x1=p1.x-this.p.x;var y1=p1.y-this.p.y;var x2=p2.x-this.p.x;var y2=p2.y-this.p.y;var xIntSign=jsts.algorithm.RobustDeterminant.signOfDet2x2(x1,y1,x2,y2);if(xIntSign===0.0){this.isPointOnSegment=true;return;}
if(y2<y1)
xIntSign=-xIntSign;if(xIntSign>0.0){this.crossingCount++;}}};jsts.algorithm.RayCrossingCounter.prototype.isOnSegment=function(){return jsts.geom.isPointOnSegment;};jsts.algorithm.RayCrossingCounter.prototype.getLocation=function(){if(this.isPointOnSegment)
return jsts.geom.Location.BOUNDARY;if((this.crossingCount%2)===1){return jsts.geom.Location.INTERIOR;}
return jsts.geom.Location.EXTERIOR;};jsts.algorithm.RayCrossingCounter.prototype.isPointInPolygon=function(){return this.getLocation()!==jsts.geom.Location.EXTERIOR;};jsts.operation.BoundaryOp=function(geom,bnRule){this.geom=geom;this.geomFact=geom.getFactory();this.bnRule=bnRule||jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE;};jsts.operation.BoundaryOp.prototype.geom=null;jsts.operation.BoundaryOp.prototype.geomFact=null;jsts.operation.BoundaryOp.prototype.bnRule=null;jsts.operation.BoundaryOp.prototype.getBoundary=function(){if(this.geom instanceof jsts.geom.LineString)return this.boundaryLineString(this.geom);if(this.geom instanceof jsts.geom.MultiLineString)return this.boundaryMultiLineString(this.geom);return this.geom.getBoundary();};jsts.operation.BoundaryOp.prototype.getEmptyMultiPoint=function(){return this.geomFact.createMultiPoint(null);};jsts.operation.BoundaryOp.prototype.boundaryMultiLineString=function(mLine){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
var bdyPts=this.computeBoundaryCoordinates(mLine);if(bdyPts.length==1){return this.geomFact.createPoint(bdyPts[0]);}
return this.geomFact.createMultiPoint(bdyPts);};jsts.operation.BoundaryOp.prototype.endpoints=null;jsts.operation.BoundaryOp.prototype.computeBoundaryCoordinates=function(mLine){var i,line,endpoint,bdyPts=[];this.endpoints=[];for(i=0;i<mLine.getNumGeometries();i++){line=mLine.getGeometryN(i);if(line.getNumPoints()==0)
continue;this.addEndpoint(line.getCoordinateN(0));this.addEndpoint(line.getCoordinateN(line.getNumPoints()-1));}
for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(this.bnRule.isInBoundary(endpoint.count)){bdyPts.push(endpoint.coordinate);}}
return bdyPts;};jsts.operation.BoundaryOp.prototype.addEndpoint=function(pt){var i,endpoint,found=false;for(i=0;i<this.endpoints.length;i++){endpoint=this.endpoints[i];if(endpoint.coordinate.equals(pt)){found=true;break;}}
if(!found){endpoint={};endpoint.coordinate=pt;endpoint.count=0;this.endpoints.push(endpoint);}
endpoint.count++;};jsts.operation.BoundaryOp.prototype.boundaryLineString=function(line){if(this.geom.isEmpty()){return this.getEmptyMultiPoint();}
if(line.isClosed()){var closedEndpointOnBoundary=this.bnRule.isInBoundary(2);if(closedEndpointOnBoundary){return line.getStartPoint();}
else{return this.geomFact.createMultiPoint(null);}}
return this.geomFact.createMultiPoint([line.getStartPoint(),line.getEndPoint()]);};jsts.operation.buffer.OffsetCurveSetBuilder=function(inputGeom,distance,curveBuilder){this.inputGeom=inputGeom;this.distance=distance;this.curveBuilder=curveBuilder;this.curveList=new javascript.util.ArrayList();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.inputGeom=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.distance=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveBuilder=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveList=null;jsts.operation.buffer.OffsetCurveSetBuilder.prototype.getCurves=function(){this.add(this.inputGeom);return this.curveList;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCurve=function(coord,leftLoc,rightLoc){if(coord==null||coord.length<2)
return;var e=new jsts.noding.NodedSegmentString(coord,new jsts.geomgraph.Label(0,jsts.geom.Location.BOUNDARY,leftLoc,rightLoc));this.curveList.add(e);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.add=function(g){if(g.isEmpty())
return;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError();};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPoint=function(p){if(this.distance<=0.0)
return;var coord=p.getCoordinates();var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addLineString=function(line){if(this.distance<=0.0&&!this.curveBuilder.getBufferParameters().isSingleSided())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());var curve=this.curveBuilder.getLineCurve(coord,this.distance);this.addCurve(curve,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygon=function(p){var offsetDistance=this.distance;var offsetSide=jsts.geomgraph.Position.LEFT;if(this.distance<0.0){offsetDistance=-this.distance;offsetSide=jsts.geomgraph.Position.RIGHT;}
var shell=p.getExteriorRing();var shellCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(shell.getCoordinates());if(this.distance<0.0&&this.isErodedCompletely(shell,this.distance))
return;if(this.distance<=0.0&&shellCoord.length<3)
return;this.addPolygonRing(shellCoord,offsetDistance,offsetSide,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);var holeCoord=jsts.geom.CoordinateArrays.removeRepeatedPoints(hole.getCoordinates());if(this.distance>0.0&&this.isErodedCompletely(hole,-this.distance))
continue;this.addPolygonRing(holeCoord,offsetDistance,jsts.geomgraph.Position.opposite(offsetSide),jsts.geom.Location.INTERIOR,jsts.geom.Location.EXTERIOR);}};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygonRing=function(coord,offsetDistance,side,cwLeftLoc,cwRightLoc){if(offsetDistance==0.0&&coord.length<jsts.geom.LinearRing.MINIMUM_VALID_SIZE)
return;var leftLoc=cwLeftLoc;var rightLoc=cwRightLoc;if(coord.length>=jsts.geom.LinearRing.MINIMUM_VALID_SIZE&&jsts.algorithm.CGAlgorithms.isCCW(coord)){leftLoc=cwRightLoc;rightLoc=cwLeftLoc;side=jsts.geomgraph.Position.opposite(side);}
var curve=this.curveBuilder.getRingCurve(coord,side,offsetDistance);this.addCurve(curve,leftLoc,rightLoc);};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isErodedCompletely=function(ring,bufferDistance){var ringCoord=ring.getCoordinates();var minDiam=0.0;if(ringCoord.length<4)
return bufferDistance<0;if(ringCoord.length==4)
return this.isTriangleErodedCompletely(ringCoord,bufferDistance);var env=ring.getEnvelopeInternal();var envMinDimension=Math.min(env.getHeight(),env.getWidth());if(bufferDistance<0.0&&2*Math.abs(bufferDistance)>envMinDimension)
return true;return false;};jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isTriangleErodedCompletely=function(triangleCoord,bufferDistance){var tri=new jsts.geom.Triangle(triangleCoord[0],triangleCoord[1],triangleCoord[2]);var inCentre=tri.inCentre();var distToCentre=jsts.algorithm.CGAlgorithms.distancePointLine(inCentre,tri.p0,tri.p1);return distToCentre<Math.abs(bufferDistance);};jsts.operation.buffer.BufferSubgraph=function(){this.dirEdgeList=new javascript.util.ArrayList();this.nodes=new javascript.util.ArrayList();this.finder=new jsts.operation.buffer.RightmostEdgeFinder();};jsts.operation.buffer.BufferSubgraph.prototype.finder=null;jsts.operation.buffer.BufferSubgraph.prototype.dirEdgeList=null;jsts.operation.buffer.BufferSubgraph.prototype.nodes=null;jsts.operation.buffer.BufferSubgraph.prototype.rightMostCoord=null;jsts.operation.buffer.BufferSubgraph.prototype.env=null;jsts.operation.buffer.BufferSubgraph.prototype.getDirectedEdges=function(){return this.dirEdgeList;};jsts.operation.buffer.BufferSubgraph.prototype.getNodes=function(){return this.nodes;};jsts.operation.buffer.BufferSubgraph.prototype.getEnvelope=function(){if(this.env===null){var edgeEnv=new jsts.geom.Envelope();for(var it=this.dirEdgeList.iterator();it.hasNext();){var dirEdge=it.next();var pts=dirEdge.getEdge().getCoordinates();for(var j=0;j<pts.length-1;j++){edgeEnv.expandToInclude(pts[j]);}}
this.env=edgeEnv;}
return this.env;};jsts.operation.buffer.BufferSubgraph.prototype.getRightmostCoordinate=function(){return this.rightMostCoord;};jsts.operation.buffer.BufferSubgraph.prototype.create=function(node){this.addReachable(node);this.finder.findEdge(this.dirEdgeList);this.rightMostCoord=this.finder.getCoordinate();};jsts.operation.buffer.BufferSubgraph.prototype.addReachable=function(startNode){var nodeStack=[];nodeStack.push(startNode);while(nodeStack.length!==0){var node=nodeStack.pop();this.add(node,nodeStack);}};jsts.operation.buffer.BufferSubgraph.prototype.add=function(node,nodeStack){node.setVisited(true);this.nodes.add(node);for(var i=node.getEdges().iterator();i.hasNext();){var de=i.next();this.dirEdgeList.add(de);var sym=de.getSym();var symNode=sym.getNode();if(!symNode.isVisited())
nodeStack.push(symNode);}};jsts.operation.buffer.BufferSubgraph.prototype.clearVisitedEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();de.setVisited(false);}};jsts.operation.buffer.BufferSubgraph.prototype.computeDepth=function(outsideDepth){this.clearVisitedEdges();var de=this.finder.getEdge();var n=de.getNode();var label=de.getLabel();de.setEdgeDepths(jsts.geomgraph.Position.RIGHT,outsideDepth);this.copySymDepths(de);this.computeDepths(de);};jsts.operation.buffer.BufferSubgraph.prototype.computeDepths=function(startEdge){var nodesVisited=[];var nodeQueue=[];var startNode=startEdge.getNode();nodeQueue.push(startNode);nodesVisited.push(startNode);startEdge.setVisited(true);while(nodeQueue.length!==0){var n=nodeQueue.shift();nodesVisited.push(n);this.computeNodeDepth(n);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();var sym=de.getSym();if(sym.isVisited())
continue;var adjNode=sym.getNode();if(nodesVisited.indexOf(adjNode)===-1){nodeQueue.push(adjNode);nodesVisited.push(adjNode);}}}};jsts.operation.buffer.BufferSubgraph.prototype.computeNodeDepth=function(n){var startEdge=null;for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();if(de.isVisited()||de.getSym().isVisited()){startEdge=de;break;}}
if(startEdge==null)
throw new jsts.error.TopologyError('unable to find edge to compute depths at '+n.getCoordinate());n.getEdges().computeDepths(startEdge);for(var i=n.getEdges().iterator();i.hasNext();){var de=i.next();de.setVisited(true);this.copySymDepths(de);}};jsts.operation.buffer.BufferSubgraph.prototype.copySymDepths=function(de){var sym=de.getSym();sym.setDepth(jsts.geomgraph.Position.LEFT,de.getDepth(jsts.geomgraph.Position.RIGHT));sym.setDepth(jsts.geomgraph.Position.RIGHT,de.getDepth(jsts.geomgraph.Position.LEFT));};jsts.operation.buffer.BufferSubgraph.prototype.findResultEdges=function(){for(var it=this.dirEdgeList.iterator();it.hasNext();){var de=it.next();if(de.getDepth(jsts.geomgraph.Position.RIGHT)>=1&&de.getDepth(jsts.geomgraph.Position.LEFT)<=0&&!de.isInteriorAreaEdge()){de.setInResult(true);}}};jsts.operation.buffer.BufferSubgraph.prototype.compareTo=function(o){var graph=o;if(this.rightMostCoord.x<graph.rightMostCoord.x){return-1;}
if(this.rightMostCoord.x>graph.rightMostCoord.x){return 1;}
return 0;};jsts.simplify.DPTransformer=function(distanceTolerance,isEnsureValidTopology){this.distanceTolerance=distanceTolerance;this.isEnsureValidTopology=isEnsureValidTopology;};jsts.simplify.DPTransformer.prototype=new jsts.geom.util.GeometryTransformer();jsts.simplify.DPTransformer.prototype.distanceTolerance=null;jsts.simplify.DPTransformer.prototype.isEnsureValidTopology=null;jsts.simplify.DPTransformer.prototype.transformCoordinates=function(coords,parent){var inputPts=coords;var newPts=null;if(inputPts.length==0){newPts=[];}else{newPts=jsts.simplify.DouglasPeuckerLineSimplifier.simplify(inputPts,this.distanceTolerance);}
return newPts;};jsts.simplify.DPTransformer.prototype.transformPolygon=function(geom,parent){if(geom.isEmpty()){return null;}
var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformPolygon.apply(this,arguments);if(parent instanceof jsts.geom.MultiPolygon){return rawGeom;}
return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.transformLinearRing=function(geom,parent){var removeDegenerateRings=parent instanceof jsts.geom.Polygon;var simpResult=jsts.geom.util.GeometryTransformer.prototype.transformLinearRing.apply(this,arguments);if(removeDegenerateRings&&!(simpResult instanceof jsts.geom.LinearRing)){return null;}
return simpResult;};jsts.simplify.DPTransformer.prototype.transformMultiPolygon=function(geom,parent){var rawGeom=jsts.geom.util.GeometryTransformer.prototype.transformMultiPolygon.apply(this,arguments);return this.createValidArea(rawGeom);};jsts.simplify.DPTransformer.prototype.createValidArea=function(rawAreaGeom){if(this.isEnsureValidTopology){return rawAreaGeom.buffer(0.0);}
return rawAreaGeom;};jsts.geom.util.GeometryExtracter=function(clz,comps){this.clz=clz;this.comps=comps;};jsts.geom.util.GeometryExtracter.prototype=new jsts.geom.GeometryFilter();jsts.geom.util.GeometryExtracter.prototype.clz=null;jsts.geom.util.GeometryExtracter.prototype.comps=null;jsts.geom.util.GeometryExtracter.extract=function(geom,clz,list){list=list||new javascript.util.ArrayList();if(geom instanceof clz){list.add(geom);}
else if(geom instanceof jsts.geom.GeometryCollection||geom instanceof jsts.geom.MultiPoint||geom instanceof jsts.geom.MultiLineString||geom instanceof jsts.geom.MultiPolygon){geom.apply(new jsts.geom.util.GeometryExtracter(clz,list));}
return list;};jsts.geom.util.GeometryExtracter.prototype.filter=function(geom){if(this.clz===null||geom instanceof this.clz){this.comps.add(geom);}};(function(){var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapOverlayOp=jsts.operation.overlay.snap.SnapOverlayOp;var SnapIfNeededOverlayOp=function(g1,g2){this.geom=[];this.geom[0]=g1;this.geom[1]=g2;};SnapIfNeededOverlayOp.overlayOp=function(g0,g1,opCode){var op=new SnapIfNeededOverlayOp(g0,g1);return op.getResultGeometry(opCode);};SnapIfNeededOverlayOp.intersection=function(g0,g1){return overlayOp(g0,g1,OverlayOp.INTERSECTION);};SnapIfNeededOverlayOp.union=function(g0,g1){return overlayOp(g0,g1,OverlayOp.UNION);};SnapIfNeededOverlayOp.difference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.DIFFERENCE);};SnapIfNeededOverlayOp.symDifference=function(g0,g1){return overlayOp(g0,g1,OverlayOp.SYMDIFFERENCE);};SnapIfNeededOverlayOp.prototype.geom=null;SnapIfNeededOverlayOp.prototype.getResultGeometry=function(opCode){var result=null;var isSuccess=false;var savedException=null;try{result=OverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);var isValid=true;if(isValid)
isSuccess=true;}catch(ex){savedException=ex;}
if(!isSuccess){try{result=SnapOverlayOp.overlayOp(this.geom[0],this.geom[1],opCode);}catch(ex){throw savedException;}}
return result;};jsts.operation.overlay.snap.SnapIfNeededOverlayOp=SnapIfNeededOverlayOp;})();(function(){var GeometryExtracter=jsts.geom.util.GeometryExtracter;var CascadedPolygonUnion=jsts.operation.union.CascadedPolygonUnion;var PointGeometryUnion=jsts.operation.union.PointGeometryUnion;var OverlayOp=jsts.operation.overlay.OverlayOp;var SnapIfNeededOverlayOp=jsts.operation.overlay.snap.SnapIfNeededOverlayOp;var ArrayList=javascript.util.ArrayList;jsts.operation.union.UnaryUnionOp=function(geoms,geomFact){this.polygons=new ArrayList();this.lines=new ArrayList();this.points=new ArrayList();if(geomFact){this.geomFact=geomFact;}
this.extract(geoms);};jsts.operation.union.UnaryUnionOp.union=function(geoms,geomFact){var op=new jsts.operation.union.UnaryUnionOp(geoms,geomFact);return op.union();};jsts.operation.union.UnaryUnionOp.prototype.polygons=null;jsts.operation.union.UnaryUnionOp.prototype.lines=null;jsts.operation.union.UnaryUnionOp.prototype.points=null;jsts.operation.union.UnaryUnionOp.prototype.geomFact=null;jsts.operation.union.UnaryUnionOp.prototype.extract=function(geoms){if(geoms instanceof ArrayList){for(var i=geoms.iterator();i.hasNext();){var geom=i.next();this.extract(geom);}}else{if(this.geomFact===null){this.geomFact=geoms.getFactory();}
GeometryExtracter.extract(geoms,jsts.geom.Polygon,this.polygons);GeometryExtracter.extract(geoms,jsts.geom.LineString,this.lines);GeometryExtracter.extract(geoms,jsts.geom.Point,this.points);}};jsts.operation.union.UnaryUnionOp.prototype.union=function(){if(this.geomFact===null){return null;}
var unionPoints=null;if(this.points.size()>0){var ptGeom=this.geomFact.buildGeometry(this.points);unionPoints=this.unionNoOpt(ptGeom);}
var unionLines=null;if(this.lines.size()>0){var lineGeom=this.geomFact.buildGeometry(this.lines);unionLines=this.unionNoOpt(lineGeom);}
var unionPolygons=null;if(this.polygons.size()>0){unionPolygons=CascadedPolygonUnion.union(this.polygons);}
var unionLA=this.unionWithNull(unionLines,unionPolygons);var union=null;if(unionPoints===null){union=unionLA;}else if(unionLA===null){union=unionPoints;}else{union=PointGeometryUnion(unionPoints,unionLA);}
if(union===null){return this.geomFact.createGeometryCollection(null);}
return union;};jsts.operation.union.UnaryUnionOp.prototype.unionWithNull=function(g0,g1){if(g0===null&&g1===null){return null;}
if(g1===null){return g0;}
if(g0===null){return g1;}
return g0.union(g1);};jsts.operation.union.UnaryUnionOp.prototype.unionNoOpt=function(g0){var empty=this.geomFact.createPoint(null);return SnapIfNeededOverlayOp.overlayOp(g0,empty,OverlayOp.UNION);};}());jsts.index.kdtree.KdNode=function(){this.left=null;this.right=null;this.count=1;if(arguments.length===2){this.initializeFromCoordinate.apply(this,arguments[0],arguments[1]);}else if(arguments.length===3){this.initializeFromXY.apply(this,arguments[0],arguments[1],arguments[2]);}};jsts.index.kdtree.KdNode.prototype.initializeFromXY=function(x,y,data){this.p=new jsts.geom.Coordinate(x,y);this.data=data;};jsts.index.kdtree.KdNode.prototype.initializeFromCoordinate=function(p,data){this.p=p;this.data=data;};jsts.index.kdtree.KdNode.prototype.getX=function(){return this.p.x;};jsts.index.kdtree.KdNode.prototype.getY=function(){return this.p.y;};jsts.index.kdtree.KdNode.prototype.getCoordinate=function(){return this.p;};jsts.index.kdtree.KdNode.prototype.getData=function(){return this.data;};jsts.index.kdtree.KdNode.prototype.getLeft=function(){return this.left;};jsts.index.kdtree.KdNode.prototype.getRight=function(){return this.right;};jsts.index.kdtree.KdNode.prototype.increment=function(){this.count+=1;};jsts.index.kdtree.KdNode.prototype.getCount=function(){return this.count;};jsts.index.kdtree.KdNode.prototype.isRepeated=function(){return count>1;};jsts.index.kdtree.KdNode.prototype.setLeft=function(left){this.left=left;};jsts.index.kdtree.KdNode.prototype.setRight=function(right){this.right=right;};jsts.algorithm.InteriorPointPoint=function(geometry){this.minDistance=Number.MAX_VALUE;this.interiorPoint=null;this.centroid=geometry.getCentroid().getCoordinate();this.add(geometry);};jsts.algorithm.InteriorPointPoint.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Point){this.addPoint(geometry.getCoordinate());}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointPoint.prototype.addPoint=function(point){var dist=point.distance(this.centroid);if(dist<this.minDistance){this.interiorPoint=new jsts.geom.Coordinate(point);this.minDistance=dist;}};jsts.algorithm.InteriorPointPoint.prototype.getInteriorPoint=function(){return this.interiorPoint;};(function(){jsts.geom.MultiLineString=function(geometries,factory){this.geometries=geometries||[];this.factory=factory;};jsts.geom.MultiLineString.prototype=new jsts.geom.GeometryCollection();jsts.geom.MultiLineString.constructor=jsts.geom.MultiLineString;jsts.geom.MultiLineString.prototype.getBoundary=function(){return(new jsts.operation.BoundaryOp(this)).getBoundary();};jsts.geom.MultiLineString.prototype.equalsExact=function(other,tolerance){if(!this.isEquivalentClass(other)){return false;}
return jsts.geom.GeometryCollection.prototype.equalsExact.call(this,other,tolerance);};jsts.geom.MultiLineString.prototype.CLASS_NAME='jsts.geom.MultiLineString';})();(function(){var Interval=jsts.index.bintree.Interval;var Root=jsts.index.bintree.Root;var Bintree=function(){this.root=new Root();this.minExtent=1.0;};Bintree.ensureExtent=function(itemInterval,minExtent){var min,max;min=itemInterval.getMin();max=itemInterval.getMax();if(min!==max){return itemInterval;}
if(min===max){min=min-(minExtent/2.0);max=min+(minExtent/2.0);}
return new Interval(min,max);};Bintree.prototype.depth=function(){if(this.root!==null){return this.root.depth();}
return 0;};Bintree.prototype.size=function(){if(this.root!==null){return this.root.size();}
return 0;};Bintree.prototype.nodeSize=function(){if(this.root!==null){return this.root.nodeSize();}
return 0;};Bintree.prototype.insert=function(itemInterval,item){this.collectStats(itemInterval);var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);this.root.insert(insertInterval,item);};Bintree.prototype.remove=function(itemInterval,item){var insertInterval=Bintree.ensureExtent(itemInterval,this.minExtent);return this.root.remove(insertInterval,item);};Bintree.prototype.iterator=function(){var foundItems=new javascript.util.ArrayList();this.root.addAllItems(foundItems);return foundItems.iterator();};Bintree.prototype.query=function(){if(arguments.length===2){this.queryAndAdd(arguments[0],arguments[1]);}else{var x=arguments[0];if(!x instanceof Interval){x=new Interval(x,x);}
return this.queryInterval(x);}};Bintree.prototype.queryInterval=function(interval){var foundItems=new javascript.util.ArrayList();this.query(interval,foundItems);return foundItems;};Bintree.prototype.queryAndAdd=function(interval,foundItems){this.root.addAllItemsFromOverlapping(interval,foundItems);};Bintree.prototype.collectStats=function(interval){var del=interval.getWidth();if(del<this.minExtent&&del>0.0){this.minExtent=del;}};jsts.index.bintree.Bintree=Bintree;})();jsts.algorithm.InteriorPointArea=function(geometry){this.factory;this.interiorPoint=null;this.maxWidth=0;this.factory=geometry.getFactory();this.add(geometry);};jsts.algorithm.InteriorPointArea.avg=function(a,b){return(a+b)/2;};jsts.algorithm.InteriorPointArea.prototype.getInteriorPoint=function(){return this.interiorPoint;};jsts.algorithm.InteriorPointArea.prototype.add=function(geometry){if(geometry instanceof jsts.geom.Polygon){this.addPolygon(geometry);}else if(geometry instanceof jsts.geom.GeometryCollection){for(var i=0;i<geometry.getNumGeometries();i++){this.add(geometry.getGeometryN(i));}}};jsts.algorithm.InteriorPointArea.prototype.addPolygon=function(geometry){if(geometry.isEmpty()){return;}
var intPt;var width=0;var bisector=this.horizontalBisector(geometry);if(bisector.getLength()==0.0){width=0;intPt=bisector.getCoordinate();}else{var intersections=bisector.intersection(geometry);var widestIntersection=this.widestGeometry(intersections);width=widestIntersection.getEnvelopeInternal().getWidth();intPt=this.centre(widestIntersection.getEnvelopeInternal());}
if(this.interiorPoint==null||width>this.maxWidth){this.interiorPoint=intPt;this.maxWidth=width;}};jsts.algorithm.InteriorPointArea.prototype.widestGeometry=function(obj){if(obj instanceof jsts.geom.GeometryCollection){var gc=obj;if(gc.isEmpty()){return gc;}
var widestGeometry=gc.getGeometryN(0);for(var i=1;i<gc.getNumGeometries();i++){if(gc.getGeometryN(i).getEnvelopeInternal().getWidth()>widestGeometry.getEnvelopeInternal().getWidth()){widestGeometry=gc.getGeometryN(i);}}
return widestGeometry;}else if(obj instanceof jsts.geom.Geometry){return obj;}};jsts.algorithm.InteriorPointArea.prototype.horizontalBisector=function(geometry){var envelope=geometry.getEnvelopeInternal();var bisectY=jsts.algorithm.SafeBisectorFinder.getBisectorY(geometry);return this.factory.createLineString([new jsts.geom.Coordinate(envelope.getMinX(),bisectY),new jsts.geom.Coordinate(envelope.getMaxX(),bisectY)]);};jsts.algorithm.InteriorPointArea.prototype.centre=function(envelope){return new jsts.geom.Coordinate(jsts.algorithm.InteriorPointArea.avg(envelope.getMinX(),envelope.getMaxX()),jsts.algorithm.InteriorPointArea.avg(envelope.getMinY(),envelope.getMaxY()));};jsts.algorithm.SafeBisectorFinder=function(poly){this.poly;this.centreY;this.hiY=Number.MAX_VALUE;this.loY=-Number.MAX_VALUE;this.poly=poly;this.hiY=poly.getEnvelopeInternal().getMaxY();this.loY=poly.getEnvelopeInternal().getMinY();this.centreY=jsts.algorithm.InteriorPointArea.avg(this.loY,this.hiY);};jsts.algorithm.SafeBisectorFinder.getBisectorY=function(poly){var finder=new jsts.algorithm.SafeBisectorFinder(poly);return finder.getBisectorY();};jsts.algorithm.SafeBisectorFinder.prototype.getBisectorY=function(){this.process(this.poly.getExteriorRing());for(var i=0;i<this.poly.getNumInteriorRing();i++){this.process(this.poly.getInteriorRingN(i));}
var bisectY=jsts.algorithm.InteriorPointArea.avg(this.hiY,this.loY);return bisectY;};jsts.algorithm.SafeBisectorFinder.prototype.process=function(line){var seq=line.getCoordinateSequence();for(var i=0;i<seq.length;i++){var y=seq[i].y;this.updateInterval(y);}};jsts.algorithm.SafeBisectorFinder.prototype.updateInterval=function(y){if(y<=this.centreY){if(y>this.loY){this.loY=y;}}else if(y>this.centreY){if(y<this.hiY){this.hiY=y;}}};jsts.operation.buffer.BufferParameters=function(quadrantSegments,endCapStyle,joinStyle,mitreLimit){if(quadrantSegments)
this.setQuadrantSegments(quadrantSegments);if(endCapStyle)
this.setEndCapStyle(endCapStyle);if(joinStyle)
this.setJoinStyle(joinStyle);if(mitreLimit)
this.setMitreLimit(mitreLimit);};jsts.operation.buffer.BufferParameters.CAP_ROUND=1;jsts.operation.buffer.BufferParameters.CAP_FLAT=2;jsts.operation.buffer.BufferParameters.CAP_SQUARE=3;jsts.operation.buffer.BufferParameters.JOIN_ROUND=1;jsts.operation.buffer.BufferParameters.JOIN_MITRE=2;jsts.operation.buffer.BufferParameters.JOIN_BEVEL=3;jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS=8;jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT=5.0;jsts.operation.buffer.BufferParameters.prototype.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;jsts.operation.buffer.BufferParameters.prototype.endCapStyle=jsts.operation.buffer.BufferParameters.CAP_ROUND;jsts.operation.buffer.BufferParameters.prototype.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_ROUND;jsts.operation.buffer.BufferParameters.prototype.mitreLimit=jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT;jsts.operation.buffer.BufferParameters.prototype._isSingleSided=false;jsts.operation.buffer.BufferParameters.prototype.getQuadrantSegments=function(){return this.quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadrantSegments){this.quadrantSegments=quadrantSegments;};jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(quadSegs){this.quadrantSegments=quadSegs;if(this.quadrantSegments===0)
this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_BEVEL;if(this.quadrantSegments<0){this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_MITRE;this.mitreLimit=Math.abs(this.quadrantSegments);}
if(quadSegs<=0){this.quadrantSegments=1;}
if(this.joinStyle!==jsts.operation.buffer.BufferParameters.JOIN_ROUND){this.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS;}};jsts.operation.buffer.BufferParameters.bufferDistanceError=function(quadSegs){var alpha=Math.PI/2.0/quadSegs;return 1-Math.cos(alpha/2.0);};jsts.operation.buffer.BufferParameters.prototype.getEndCapStyle=function(){return this.endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.setEndCapStyle=function(endCapStyle){this.endCapStyle=endCapStyle;};jsts.operation.buffer.BufferParameters.prototype.getJoinStyle=function(){return this.joinStyle;};jsts.operation.buffer.BufferParameters.prototype.setJoinStyle=function(joinStyle){this.joinStyle=joinStyle;};jsts.operation.buffer.BufferParameters.prototype.getMitreLimit=function(){return this.mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setMitreLimit=function(mitreLimit){this.mitreLimit=mitreLimit;};jsts.operation.buffer.BufferParameters.prototype.setSingleSided=function(isSingleSided){this._isSingleSided=isSingleSided;};jsts.operation.buffer.BufferParameters.prototype.isSingleSided=function(){return this._isSingleSided;};(function(){jsts.geom.util.ShortCircuitedGeometryVisitor=function(){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=false;jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.applyTo=function(geom){for(var i=0;i<geom.getNumGeometries()&&!this.isDone;i++){var element=geom.getGeometryN(i);if(!(element instanceof jsts.geom.GeometryCollection)){this.visit(element);if(this.isDone()){this.isDone=true;return;}}
else
this.applyTo(element);}}
jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.visit=function(element){};jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=function(){};})();(function(){var EnvelopeIntersectsVisitor=function(rectEnv){this.rectEnv=rectEnv;};EnvelopeIntersectsVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();EnvelopeIntersectsVisitor.constructor=EnvelopeIntersectsVisitor;EnvelopeIntersectsVisitor.prototype.rectEnv=null;EnvelopeIntersectsVisitor.prototype.intersects=false;EnvelopeIntersectsVisitor.prototype.intersects=function(){return this.intersects;}
EnvelopeIntersectsVisitor.prototype.visit=function(element){var elementEnv=element.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv)){return;}
if(this.rectEnv.contains(elementEnv)){this.intersects=true;return;}
if(elementEnv.getMinX()>=rectEnv.getMinX()&&elementEnv.getMaxX()<=rectEnv.getMaxX()){this.intersects=true;return;}
if(elementEnv.getMinY()>=rectEnv.getMinY()&&elementEnv.getMaxY()<=rectEnv.getMaxY()){this.intersects=true;return;}}
EnvelopeIntersectsVisitor.prototype.isDone=function(){return this.intersects==true;}
var GeometryContainsPointVisitor=function(rectangle){this.rectSeq=rectangle.getExteriorRing().getCoordinateSequence();this.rectEnv=rectangle.getEnvelopeInternal();};GeometryContainsPointVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();GeometryContainsPointVisitor.constructor=GeometryContainsPointVisitor;GeometryContainsPointVisitor.prototype.rectSeq=null;GeometryContainsPointVisitor.prototype.rectEnv=null;GeometryContainsPointVisitor.prototype.containsPoint=false;GeometryContainsPointVisitor.prototype.containsPoint=function(){return this.containsPoint;}
GeometryContainsPointVisitor.prototype.visit=function(geom){if(!(geom instanceof jsts.geom.Polygon))
return;var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var rectPt=new jsts.geom.Coordinate();for(var i=0;i<4;i++){this.rectSeq.getCoordinate(i,rectPt);if(!elementEnv.contains(rectPt))
continue;if(SimplePointInAreaLocator.containsPointInPolygon(rectPt,geom)){this.containsPoint=true;return;}}}
GeometryContainsPointVisitor.prototype.isDone=function(){return this.containsPoint==true;}
var RectangleIntersectsSegmentVisitor=function(rectangle){this.rectEnv=rectangle.getEnvelopeInternal();this.rectIntersector=new RectangleLineIntersector(rectEnv);};RectangleIntersectsSegmentVisitor.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor();RectangleIntersectsSegmentVisitor.constructor=RectangleIntersectsSegmentVisitor;RectangleIntersectsSegmentVisitor.prototype.rectEnv=null;RectangleIntersectsSegmentVisitor.prototype.rectIntersector=null;RectangleIntersectsSegmentVisitor.prototype.hasIntersection=false;RectangleIntersectsSegmentVisitor.prototype.p0=null;RectangleIntersectsSegmentVisitor.prototype.p1=null;RectangleIntersectsSegmentVisitor.prototype.intersects=function(){return this.hasIntersection;}
RectangleIntersectsSegmentVisitor.prototype.visit=function(geom){var elementEnv=geom.getEnvelopeInternal();if(!this.rectEnv.intersects(elementEnv))
return;var lines=LinearComponentExtracter.getLines(geom);this.checkIntersectionWithLineStrings(lines);}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithLineStrings=function(lines){for(var i=lines.iterator();i.hasNext();){var testLine=i.next();this.checkIntersectionWithSegments(testLine);if(this.hasIntersection)
return;}}
RectangleIntersectsSegmentVisitor.prototype.checkIntersectionWithSegments=function(testLine){var seq1=testLine.getCoordinateSequence();for(var j=1;j<seq1.length;j++){this.p0=seq1[j-1];this.p1=seq1[j];if(rectIntersector.intersects(p0,p1)){this.hasIntersection=true;return;}}}
RectangleIntersectsSegmentVisitor.prototype.isDone=function(){return this.hasIntersection==true;}
jsts.operation.predicate.RectangleIntersects=function(rectangle){this.rectangle=rectangle;this.rectEnv=rectangle.getEnvelopeInternal();}
jsts.operation.predicate.RectangleIntersects.intersects=function(rectangle,b){var rp=new jsts.operation.predicate.RectangleIntersects(rectangle);return rp.intersects(b);}
jsts.operation.predicate.RectangleIntersects.prototype.rectangle=null;jsts.operation.predicate.RectangleIntersects.prototype.rectEnv=null;jsts.operation.predicate.RectangleIntersects.prototype.intersects=function(geom){if(!this.rectEnv.intersects(geom.getEnvelopeInternal()))
return false;var visitor=new EnvelopeIntersectsVisitor(this.rectEnv);visitor.applyTo(geom);if(visitor.intersects())
return true;var ecpVisitor=new GeometryContainsPointVisitor(rectangle);ecpVisitor.applyTo(geom);if(ecpVisitor.containsPoint())
return true;var riVisitor=new RectangleIntersectsSegmentVisitor(rectangle);riVisitor.applyTo(geom);if(riVisitor.intersects())
return true;return false;}})();jsts.operation.buffer.BufferBuilder=function(bufParams){this.bufParams=bufParams;this.edgeList=new jsts.geomgraph.EdgeList();};jsts.operation.buffer.BufferBuilder.depthDelta=function(label){var lLoc=label.getLocation(0,jsts.geomgraph.Position.LEFT);var rLoc=label.getLocation(0,jsts.geomgraph.Position.RIGHT);if(lLoc===jsts.geom.Location.INTERIOR&&rLoc===jsts.geom.Location.EXTERIOR)
return 1;else if(lLoc===jsts.geom.Location.EXTERIOR&&rLoc===jsts.geom.Location.INTERIOR)
return-1;return 0;};jsts.operation.buffer.BufferBuilder.prototype.bufParams=null;jsts.operation.buffer.BufferBuilder.prototype.workingPrecisionModel=null;jsts.operation.buffer.BufferBuilder.prototype.workingNoder=null;jsts.operation.buffer.BufferBuilder.prototype.geomFact=null;jsts.operation.buffer.BufferBuilder.prototype.graph=null;jsts.operation.buffer.BufferBuilder.prototype.edgeList=null;jsts.operation.buffer.BufferBuilder.prototype.setWorkingPrecisionModel=function(pm){this.workingPrecisionModel=pm;};jsts.operation.buffer.BufferBuilder.prototype.setNoder=function(noder){this.workingNoder=noder;};jsts.operation.buffer.BufferBuilder.prototype.buffer=function(g,distance){var precisionModel=this.workingPrecisionModel;if(precisionModel===null)
precisionModel=g.getPrecisionModel();this.geomFact=g.getFactory();var curveBuilder=new jsts.operation.buffer.OffsetCurveBuilder(precisionModel,this.bufParams);var curveSetBuilder=new jsts.operation.buffer.OffsetCurveSetBuilder(g,distance,curveBuilder);var bufferSegStrList=curveSetBuilder.getCurves();if(bufferSegStrList.size()<=0){return this.createEmptyResultGeometry();}
this.computeNodedEdges(bufferSegStrList,precisionModel);this.graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory());this.graph.addEdges(this.edgeList.getEdges());var subgraphList=this.createSubgraphs(this.graph);var polyBuilder=new jsts.operation.overlay.PolygonBuilder(this.geomFact);this.buildSubgraphs(subgraphList,polyBuilder);var resultPolyList=polyBuilder.getPolygons();if(resultPolyList.size()<=0){return this.createEmptyResultGeometry();}
var resultGeom=this.geomFact.buildGeometry(resultPolyList);return resultGeom;};jsts.operation.buffer.BufferBuilder.prototype.getNoder=function(precisionModel){if(this.workingNoder!==null)
return this.workingNoder;var noder=new jsts.noding.MCIndexNoder();var li=new jsts.algorithm.RobustLineIntersector();li.setPrecisionModel(precisionModel);noder.setSegmentIntersector(new jsts.noding.IntersectionAdder(li));return noder;};jsts.operation.buffer.BufferBuilder.prototype.computeNodedEdges=function(bufferSegStrList,precisionModel){var noder=this.getNoder(precisionModel);noder.computeNodes(bufferSegStrList);var nodedSegStrings=noder.getNodedSubstrings();for(var i=nodedSegStrings.iterator();i.hasNext();){var segStr=i.next();var oldLabel=segStr.getData();var edge=new jsts.geomgraph.Edge(segStr.getCoordinates(),new jsts.geomgraph.Label(oldLabel));this.insertUniqueEdge(edge);}};jsts.operation.buffer.BufferBuilder.prototype.insertUniqueEdge=function(e){var existingEdge=this.edgeList.findEqualEdge(e);if(existingEdge!=null){var existingLabel=existingEdge.getLabel();var labelToMerge=e.getLabel();if(!existingEdge.isPointwiseEqual(e)){labelToMerge=new jsts.geomgraph.Label(e.getLabel());labelToMerge.flip();}
existingLabel.merge(labelToMerge);var mergeDelta=jsts.operation.buffer.BufferBuilder.depthDelta(labelToMerge);var existingDelta=existingEdge.getDepthDelta();var newDelta=existingDelta+mergeDelta;existingEdge.setDepthDelta(newDelta);}else{this.edgeList.add(e);e.setDepthDelta(jsts.operation.buffer.BufferBuilder.depthDelta(e.getLabel()));}};jsts.operation.buffer.BufferBuilder.prototype.createSubgraphs=function(graph){var subgraphList=[];for(var i=graph.getNodes().iterator();i.hasNext();){var node=i.next();if(!node.isVisited()){var subgraph=new jsts.operation.buffer.BufferSubgraph();subgraph.create(node);subgraphList.push(subgraph);}}
var compare=function(a,b){return a.compareTo(b);};subgraphList.sort(compare);subgraphList.reverse();return subgraphList;};jsts.operation.buffer.BufferBuilder.prototype.buildSubgraphs=function(subgraphList,polyBuilder){var processedGraphs=[];for(var i=0;i<subgraphList.length;i++){var subgraph=subgraphList[i];var p=subgraph.getRightmostCoordinate();var locater=new jsts.operation.buffer.SubgraphDepthLocater(processedGraphs);var outsideDepth=locater.getDepth(p);subgraph.computeDepth(outsideDepth);subgraph.findResultEdges();processedGraphs.push(subgraph);polyBuilder.add(subgraph.getDirectedEdges(),subgraph.getNodes());}};jsts.operation.buffer.BufferBuilder.convertSegStrings=function(it){var fact=new jsts.geom.GeometryFactory();var lines=new javascript.util.ArrayList();while(it.hasNext()){var ss=it.next();var line=fact.createLineString(ss.getCoordinates());lines.add(line);}
return fact.buildGeometry(lines);};jsts.operation.buffer.BufferBuilder.prototype.createEmptyResultGeometry=function(){var emptyGeom=this.geomFact.createPolygon(null,null);return emptyGeom;};jsts.noding.SegmentPointComparator=function(){};jsts.noding.SegmentPointComparator.compare=function(octant,p0,p1){if(p0.equals2D(p1))
return 0;var xSign=jsts.noding.SegmentPointComparator.relativeSign(p0.x,p1.x);var ySign=jsts.noding.SegmentPointComparator.relativeSign(p0.y,p1.y);switch(octant){case 0:return jsts.noding.SegmentPointComparator.compareValue(xSign,ySign);case 1:return jsts.noding.SegmentPointComparator.compareValue(ySign,xSign);case 2:return jsts.noding.SegmentPointComparator.compareValue(ySign,-xSign);case 3:return jsts.noding.SegmentPointComparator.compareValue(-xSign,ySign);case 4:return jsts.noding.SegmentPointComparator.compareValue(-xSign,-ySign);case 5:return jsts.noding.SegmentPointComparator.compareValue(-ySign,-xSign);case 6:return jsts.noding.SegmentPointComparator.compareValue(-ySign,xSign);case 7:return jsts.noding.SegmentPointComparator.compareValue(xSign,-ySign);}
return 0;};jsts.noding.SegmentPointComparator.relativeSign=function(x0,x1){if(x0<x1)
return-1;if(x0>x1)
return 1;return 0;};jsts.noding.SegmentPointComparator.compareValue=function(compareSign0,compareSign1){if(compareSign0<0)
return-1;if(compareSign0>0)
return 1;if(compareSign1<0)
return-1;if(compareSign1>0)
return 1;return 0;};jsts.operation.relate.RelateOp=function(){jsts.operation.GeometryGraphOperation.apply(this,arguments);this._relate=new jsts.operation.relate.RelateComputer(this.arg);};jsts.operation.relate.RelateOp.prototype=new jsts.operation.GeometryGraphOperation();jsts.operation.relate.RelateOp.relate=function(a,b,boundaryNodeRule){var relOp=new jsts.operation.relate.RelateOp(a,b,boundaryNodeRule);var im=relOp.getIntersectionMatrix();return im;};jsts.operation.relate.RelateOp.prototype._relate=null;jsts.operation.relate.RelateOp.prototype.getIntersectionMatrix=function(){return this._relate.computeIM();};jsts.index.chain.MonotoneChain=function(pts,start,end,context){this.pts=pts;this.start=start;this.end=end;this.context=context;};jsts.index.chain.MonotoneChain.prototype.pts=null;jsts.index.chain.MonotoneChain.prototype.start=null;jsts.index.chain.MonotoneChain.prototype.end=null;jsts.index.chain.MonotoneChain.prototype.env=null;jsts.index.chain.MonotoneChain.prototype.context=null;jsts.index.chain.MonotoneChain.prototype.id=null;jsts.index.chain.MonotoneChain.prototype.setId=function(id){this.id=id;};jsts.index.chain.MonotoneChain.prototype.getId=function(){return this.id;};jsts.index.chain.MonotoneChain.prototype.getContext=function(){return this.context;};jsts.index.chain.MonotoneChain.prototype.getEnvelope=function(){if(this.env==null){var p0=this.pts[this.start];var p1=this.pts[this.end];this.env=new jsts.geom.Envelope(p0,p1);}
return this.env;};jsts.index.chain.MonotoneChain.prototype.getStartIndex=function(){return this.start;};jsts.index.chain.MonotoneChain.prototype.getEndIndex=function(){return this.end;};jsts.index.chain.MonotoneChain.prototype.getLineSegment=function(index,ls){ls.p0=this.pts[index];ls.p1=this.pts[index+1];};jsts.index.chain.MonotoneChain.prototype.getCoordinates=function(){var coord=[];var index=0;for(var i=this.start;i<=this.end;i++){coord[index++]=this.pts[i];}
return coord;};jsts.index.chain.MonotoneChain.prototype.select=function(searchEnv,mcs){this.computeSelect2(searchEnv,this.start,this.end,mcs);};jsts.index.chain.MonotoneChain.prototype.computeSelect2=function(searchEnv,start0,end0,mcs){var p0=this.pts[start0];var p1=this.pts[end0];mcs.tempEnv1.init(p0,p1);if(end0-start0===1){mcs.select(this,start0);return;}
if(!searchEnv.intersects(mcs.tempEnv1))
return;var mid=parseInt((start0+end0)/2);if(start0<mid){this.computeSelect2(searchEnv,start0,mid,mcs);}
if(mid<end0){this.computeSelect2(searchEnv,mid,end0,mcs);}};jsts.index.chain.MonotoneChain.prototype.computeOverlaps=function(mc,mco){if(arguments.length===6){return this.computeOverlaps2.apply(this,arguments);}
this.computeOverlaps2(this.start,this.end,mc,mc.start,mc.end,mco);};jsts.index.chain.MonotoneChain.prototype.computeOverlaps2=function(start0,end0,mc,start1,end1,mco){var p00=this.pts[start0];var p01=this.pts[end0];var p10=mc.pts[start1];var p11=mc.pts[end1];if(end0-start0===1&&end1-start1===1){mco.overlap(this,start0,mc,start1);return;}
mco.tempEnv1.init(p00,p01);mco.tempEnv2.init(p10,p11);if(!mco.tempEnv1.intersects(mco.tempEnv2))
return;var mid0=parseInt((start0+end0)/2);var mid1=parseInt((start1+end1)/2);if(start0<mid0){if(start1<mid1)
this.computeOverlaps2(start0,mid0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(start0,mid0,mc,mid1,end1,mco);}
if(mid0<end0){if(start1<mid1)
this.computeOverlaps2(mid0,end0,mc,start1,mid1,mco);if(mid1<end1)
this.computeOverlaps2(mid0,end0,mc,mid1,end1,mco);}};(function(){var Location=jsts.geom.Location;var Dimension=jsts.geom.Dimension;jsts.geom.IntersectionMatrix=function(elements){var other=elements;if(elements===undefined||elements===null){this.matrix=[[],[],[]];this.setAll(Dimension.FALSE);}else if(typeof elements==='string'){this.set(elements);}else if(other instanceof jsts.geom.IntersectionMatrix){this.matrix[Location.INTERIOR][Location.INTERIOR]=other.matrix[Location.INTERIOR][Location.INTERIOR];this.matrix[Location.INTERIOR][Location.BOUNDARY]=other.matrix[Location.INTERIOR][Location.BOUNDARY];this.matrix[Location.INTERIOR][Location.EXTERIOR]=other.matrix[Location.INTERIOR][Location.EXTERIOR];this.matrix[Location.BOUNDARY][Location.INTERIOR]=other.matrix[Location.BOUNDARY][Location.INTERIOR];this.matrix[Location.BOUNDARY][Location.BOUNDARY]=other.matrix[Location.BOUNDARY][Location.BOUNDARY];this.matrix[Location.BOUNDARY][Location.EXTERIOR]=other.matrix[Location.BOUNDARY][Location.EXTERIOR];this.matrix[Location.EXTERIOR][Location.INTERIOR]=other.matrix[Location.EXTERIOR][Location.INTERIOR];this.matrix[Location.EXTERIOR][Location.BOUNDARY]=other.matrix[Location.EXTERIOR][Location.BOUNDARY];this.matrix[Location.EXTERIOR][Location.EXTERIOR]=other.matrix[Location.EXTERIOR][Location.EXTERIOR];}};jsts.geom.IntersectionMatrix.prototype.matrix=null;jsts.geom.IntersectionMatrix.prototype.add=function(im){var i,j;for(i=0;i<3;i++){for(j=0;j<3;j++){this.setAtLeast(i,j,im.get(i,j));}}};jsts.geom.IntersectionMatrix.matches=function(actualDimensionValue,requiredDimensionSymbol){if(typeof actualDimensionValue==='string'){return jsts.geom.IntersectionMatrix.matches2.call(this,arguments);}
if(requiredDimensionSymbol==='*'){return true;}
if(requiredDimensionSymbol==='T'&&(actualDimensionValue>=0||actualDimensionValue===Dimension.TRUE)){return true;}
if(requiredDimensionSymbol==='F'&&actualDimensionValue===Dimension.FALSE){return true;}
if(requiredDimensionSymbol==='0'&&actualDimensionValue===Dimension.P){return true;}
if(requiredDimensionSymbol==='1'&&actualDimensionValue===Dimension.L){return true;}
if(requiredDimensionSymbol==='2'&&actualDimensionValue===Dimension.A){return true;}
return false;};jsts.geom.IntersectionMatrix.matches2=function(actualDimensionSymbols,requiredDimensionSymbols){var m=new jsts.geom.IntersectionMatrix(actualDimensionSymbols);return m.matches(requiredDimensionSymbols);};jsts.geom.IntersectionMatrix.prototype.set=function(row,column,dimensionValue){if(typeof row==='string'){this.set2(row);return;}
this.matrix[row][column]=dimensionValue;};jsts.geom.IntersectionMatrix.prototype.set2=function(dimensionSymbols){for(var i=0;i<dimensionSymbols.length();i++){var row=i/3;var col=i%3;this.matrix[row][col]=Dimension.toDimensionValue(dimensionSymbols.charAt(i));}};jsts.geom.IntersectionMatrix.prototype.setAtLeast=function(row,column,minimumDimensionValue){if(arguments.length===1){this.setAtLeast2(arguments[0]);return;}
if(this.matrix[row][column]<minimumDimensionValue){this.matrix[row][column]=minimumDimensionValue;}};jsts.geom.IntersectionMatrix.prototype.setAtLeastIfValid=function(row,column,minimumDimensionValue){if(row>=0&&column>=0){this.setAtLeast(row,column,minimumDimensionValue);}};jsts.geom.IntersectionMatrix.prototype.setAtLeast2=function(minimumDimensionSymbols){var i;for(i=0;i<minimumDimensionSymbols.length;i++){var row=parseInt(i/3);var col=parseInt(i%3);this.setAtLeast(row,col,jsts.geom.Dimension.toDimensionValue(minimumDimensionSymbols.charAt(i)));}};jsts.geom.IntersectionMatrix.prototype.setAll=function(dimensionValue){var ai,bi;for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){this.matrix[ai][bi]=dimensionValue;}}};jsts.geom.IntersectionMatrix.prototype.get=function(row,column){return this.matrix[row][column];};jsts.geom.IntersectionMatrix.prototype.isDisjoint=function(){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.BOUNDARY]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isIntersects=function(){return!this.isDisjoint();};jsts.geom.IntersectionMatrix.prototype.isTouches=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA>dimensionOfGeometryB){return this.isTouches(dimensionOfGeometryB,dimensionOfGeometryA);}
if((dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)){return this.matrix[Location.INTERIOR][Location.INTERIOR]===Dimension.FALSE&&(jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T'));}
return false;};jsts.geom.IntersectionMatrix.prototype.isCrosses=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.L)||(dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB==Dimension.A)||(dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T');}
if((dimensionOfGeometryA==Dimension.L&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB==Dimension.L)){return jsts.geom.IntersectionMatrix.matches(matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]===0;}
return false;};jsts.geom.IntersectionMatrix.prototype.isWithin=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.INTERIOR][Location.EXTERIOR]==Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isContains=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCovers=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.EXTERIOR][Location.INTERIOR]==Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]==Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isCoveredBy=function(){var hasPointInCommon=jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.BOUNDARY],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.INTERIOR],'T')||jsts.geom.IntersectionMatrix.matches(this.matrix[Location.BOUNDARY][Location.BOUNDARY],'T');return hasPointInCommon&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isEquals=function(dimensionOfGeometryA,dimensionOfGeometryB){if(dimensionOfGeometryA!==dimensionOfGeometryB){return false;}
return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&this.matrix[Location.EXTERIOR][Location.INTERIOR]===Dimension.FALSE&&this.matrix[Location.INTERIOR][Location.EXTERIOR]===Dimension.FALSE&&this.matrix[Location.EXTERIOR][Location.BOUNDARY]===Dimension.FALSE&&this.matrix[Location.BOUNDARY][Location.EXTERIOR]===Dimension.FALSE;};jsts.geom.IntersectionMatrix.prototype.isOverlaps=function(dimensionOfGeometryA,dimensionOfGeometryB){if((dimensionOfGeometryA==Dimension.P&&dimensionOfGeometryB===Dimension.P)||(dimensionOfGeometryA==Dimension.A&&dimensionOfGeometryB===Dimension.A)){return jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.INTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
if(dimensionOfGeometryA===Dimension.L&&dimensionOfGeometryB===Dimension.L){return this.matrix[Location.INTERIOR][Location.INTERIOR]==1&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.INTERIOR][Location.EXTERIOR],'T')&&jsts.geom.IntersectionMatrix.matches(this.matrix[Location.EXTERIOR][Location.INTERIOR],'T');}
return false;};jsts.geom.IntersectionMatrix.prototype.matches=function(requiredDimensionSymbols){if(requiredDimensionSymbols.length!=9){throw new jsts.error.IllegalArgumentException('Should be length 9: '+
requiredDimensionSymbols);}
for(var ai=0;ai<3;ai++){for(var bi=0;bi<3;bi++){if(!jsts.geom.IntersectionMatrix.matches(this.matrix[ai][bi],requiredDimensionSymbols.charAt(3*ai+bi))){return false;}}}
return true;};jsts.geom.IntersectionMatrix.prototype.transpose=function(){var temp=matrix[1][0];this.matrix[1][0]=this.matrix[0][1];this.matrix[0][1]=temp;temp=this.matrix[2][0];this.matrix[2][0]=this.matrix[0][2];this.matrix[0][2]=temp;temp=this.matrix[2][1];this.matrix[2][1]=this.matrix[1][2];this.matrix[1][2]=temp;return this;};jsts.geom.IntersectionMatrix.prototype.toString=function(){var ai,bi,buf='';for(ai=0;ai<3;ai++){for(bi=0;bi<3;bi++){buf+=Dimension.toDimensionSymbol(this.matrix[ai][bi]);}}
return buf;};})();jsts.triangulate.quadedge.LastFoundQuadEdgeLocator=function(subdiv){this.subdiv=subdiv;this.lastEdge=null;this.init();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.init=function(){this.lastEdge=this.findEdge();};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.findEdge=function(){var edges=this.subdiv.getEdges();return edges[0];};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.locate=function(v){if(!this.lastEdge.isLive()){this.init();}
var e=this.subdiv.locateFromEdge(v,this.lastEdge);this.lastEdge=e;return e;};jsts.noding.SegmentNodeList=function(edge){this.nodeMap=new javascript.util.TreeMap();this.edge=edge;};jsts.noding.SegmentNodeList.prototype.nodeMap=null;jsts.noding.SegmentNodeList.prototype.iterator=function(){return this.nodeMap.values().iterator();};jsts.noding.SegmentNodeList.prototype.edge=null;jsts.noding.SegmentNodeList.prototype.getEdge=function(){return this.edge;};jsts.noding.SegmentNodeList.prototype.add=function(intPt,segmentIndex){var eiNew=new jsts.noding.SegmentNode(this.edge,intPt,segmentIndex,this.edge.getSegmentOctant(segmentIndex));var ei=this.nodeMap.get(eiNew);if(ei!==null){jsts.util.Assert.isTrue(ei.coord.equals2D(intPt),'Found equal nodes with different coordinates');return ei;}
this.nodeMap.put(eiNew,eiNew);return eiNew;};jsts.noding.SegmentNodeList.prototype.addEndpoints=function(){var maxSegIndex=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0);this.add(this.edge.getCoordinate(maxSegIndex),maxSegIndex);};jsts.noding.SegmentNodeList.prototype.addCollapsedNodes=function(){var collapsedVertexIndexes=[];this.findCollapsesFromInsertedNodes(collapsedVertexIndexes);this.findCollapsesFromExistingVertices(collapsedVertexIndexes);for(var i=0;i<collapsedVertexIndexes.length;i++){var vertexIndex=collapsedVertexIndexes[i];this.add(this.edge.getCoordinate(vertexIndex),vertexIndex);}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromExistingVertices=function(collapsedVertexIndexes){for(var i=0;i<this.edge.size()-2;i++){var p0=this.edge.getCoordinate(i);var p1=this.edge.getCoordinate(i+1);var p2=this.edge.getCoordinate(i+2);if(p0.equals2D(p2)){collapsedVertexIndexes.push(i+1);}}};jsts.noding.SegmentNodeList.prototype.findCollapsesFromInsertedNodes=function(collapsedVertexIndexes){var collapsedVertexIndex=[null];var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var isCollapsed=this.findCollapseIndex(eiPrev,ei,collapsedVertexIndex);if(isCollapsed)
collapsedVertexIndexes.push(collapsedVertexIndex[0]);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.findCollapseIndex=function(ei0,ei1,collapsedVertexIndex){if(!ei0.coord.equals2D(ei1.coord))
return false;var numVerticesBetween=ei1.segmentIndex-ei0.segmentIndex;if(!ei1.isInterior()){numVerticesBetween--;}
if(numVerticesBetween===1){collapsedVertexIndex[0]=ei0.segmentIndex+1;return true;}
return false;};jsts.noding.SegmentNodeList.prototype.addSplitEdges=function(edgeList){this.addEndpoints();this.addCollapsedNodes();var it=this.iterator();var eiPrev=it.next();while(it.hasNext()){var ei=it.next();var newEdge=this.createSplitEdge(eiPrev,ei);edgeList.add(newEdge);eiPrev=ei;}};jsts.noding.SegmentNodeList.prototype.checkSplitEdgesCorrectness=function(splitEdges){var edgePts=edge.getCoordinates();var split0=splitEdges[0];var pt0=split0.getCoordinate(0);if(!pt0.equals2D(edgePts[0]))
throw new Error('bad split edge start point at '+pt0);var splitn=splitEdges[splitEdges.length-1];var splitnPts=splitn.getCoordinates();var ptn=splitnPts[splitnPts.length-1];if(!ptn.equals2D(edgePts[edgePts.length-1]))
throw new Error('bad split edge end point at '+ptn);};jsts.noding.SegmentNodeList.prototype.createSplitEdge=function(ei0,ei1){var npts=ei1.segmentIndex-ei0.segmentIndex+2;var lastSegStartPt=this.edge.getCoordinate(ei1.segmentIndex);var useIntPt1=ei1.isInterior()||!ei1.coord.equals2D(lastSegStartPt);if(!useIntPt1){npts--;}
var pts=[];var ipt=0;pts[ipt++]=new jsts.geom.Coordinate(ei0.coord);for(var i=ei0.segmentIndex+1;i<=ei1.segmentIndex;i++){pts[ipt++]=this.edge.getCoordinate(i);}
if(useIntPt1)
pts[ipt]=ei1.coord;return new jsts.noding.NodedSegmentString(pts,this.edge.getData());};jsts.io.WKTWriter=function(){this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTWriter.prototype.write=function(geometry){var wkt=this.parser.write(geometry);return wkt;};jsts.io.WKTWriter.toLineString=function(p0,p1){if(arguments.length!==2){throw new jsts.error.NotImplementedError();}
return'LINESTRING ( '+p0.x+' '+p0.y+', '+p1.x+' '+p1.y+' )';};jsts.io.WKTReader=function(geometryFactory){this.geometryFactory=geometryFactory||new jsts.geom.GeometryFactory();this.precisionModel=this.geometryFactory.getPrecisionModel();this.parser=new jsts.io.WKTParser(this.geometryFactory);};jsts.io.WKTReader.prototype.read=function(wkt){var geometry=this.parser.read(wkt);if(this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED){this.reducePrecision(geometry);}
return geometry;};jsts.io.WKTReader.prototype.reducePrecision=function(geometry){var i,len;if(geometry.coordinate){this.precisionModel.makePrecise(geometry.coordinate);}else if(geometry.points){for(i=0,len=geometry.points.length;i<len;i++){this.precisionModel.makePrecise(geometry.points[i]);}}else if(geometry.geometries){for(i=0,len=geometry.geometries.length;i<len;i++){this.reducePrecision(geometry.geometries[i]);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision=function(env,tolerance){this.tolerance=tolerance;this.edgeCoincidenceTolerance=tolerance/jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR;this.visitedKey=0;this.quadEdges=[];this.startingEdge;this.tolerance;this.edgeCoincidenceTolerance;this.frameEnv;this.locator=null;this.seg=new jsts.geom.LineSegment();this.triEdges=new Array(3);this.frameVertex=new Array(3);this.createFrame(env);this.startingEdge=this.initSubdiv();this.locator=new jsts.triangulate.quadedge.LastFoundQuadEdgeLocator(this);};jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR=1000;jsts.triangulate.quadedge.QuadEdgeSubdivision.getTriangleEdges=function(startQE,triEdge){triEdge[0]=startQE;triEdge[1]=triEdge[0].lNext();triEdge[2]=triEdge[1].lNext();if(triEdge[2].lNext()!=triEdge[0]){throw new jsts.IllegalArgumentError('Edges do not form a triangle');}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.createFrame=function(env){var deltaX,deltaY,offset;deltaX=env.getWidth();deltaY=env.getHeight();offset=0.0;if(deltaX>deltaY){offset=deltaX*10.0;}else{offset=deltaY*10.0;}
this.frameVertex[0]=new jsts.triangulate.quadedge.Vertex((env.getMaxX()+env.getMinX())/2.0,env.getMaxY()
+offset);this.frameVertex[1]=new jsts.triangulate.quadedge.Vertex(env.getMinX()-offset,env.getMinY()-offset);this.frameVertex[2]=new jsts.triangulate.quadedge.Vertex(env.getMaxX()+offset,env.getMinY()-offset);this.frameEnv=new jsts.geom.Envelope(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate());this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate());};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.initSubdiv=function(){var ea,eb,ec;ea=this.makeEdge(this.frameVertex[0],this.frameVertex[1]);eb=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);jsts.triangulate.quadedge.QuadEdge.splice(ea.sym(),eb);ec=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);jsts.triangulate.quadedge.QuadEdge.splice(eb.sym(),ec);jsts.triangulate.quadedge.QuadEdge.splice(ec.sym(),ea);return ea;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTolerance=function(){return this.tolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEnvelope=function(){return new jsts.geom.Envelope(this.frameEnv);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdges=function(){if(arguments.length>0){return this.getEdgesByFactory(arguments[0]);}else{return this.quadEdges;}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.setLocator=function(locator){this.locator=locator;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.makeEdge=function(o,d){var q=jsts.triangulate.quadedge.QuadEdge.makeEdge(o,d);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.connect=function(a,b){var q=jsts.triangulate.quadedge.QuadEdge.connect(a,b);this.quadEdges.push(q);return q;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.delete_jsts=function(e){jsts.triangulate.quadedge.QuadEdge.splice(e,e.oPrev());jsts.triangulate.quadedge.QuadEdge.splice(e.sym(),e.sym().oPrev());var eSym,eRot,eRotSym;e.eSym=e.sym();eRot=e.rot;eRotSym=e.rot.sym();var idx=this.quadEdges.indexOf(e);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRot);if(idx!==-1){this.quadEdges.splice(idx,1);}
idx=this.quadEdges.indexOf(eRotSym);if(idx!==-1){this.quadEdges.splice(idx,1);}
e.delete_jsts();eSym.delete_jsts();eRot.delete_jsts();eRotSym.delete_jsts();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateFromEdge=function(v,startEdge){var iter=0,maxIter=this.quadEdges.length,e;e=startEdge;while(true){iter++;if(iter>maxIter){throw new jsts.error.LocateFailureError(e.toLineSegment());}
if((v.equals(e.orig()))||(v.equals(e.dest()))){break;}else if(v.rightOf(e)){e=e.sym();}else if(!v.rightOf(e.oNext())){e=e.oNext();}else if(!v.rightOf(e.dPrev())){e=e.dPrev();}else{break;}}
return e;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locate=function(){if(arguments.length===1){if(arguments[0]instanceof jsts.triangulate.quadedge.Vertex){return this.locateByVertex(arguments[0]);}else{return this.locateByCoordinate(arguments[0]);}}else{return this.locateByCoordinates(arguments[0],arguments[1]);}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByVertex=function(v){return this.locator.locate(v);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinate=function(p){return this.locator.locate(new jsts.triangulate.quadedge.Vertex(p));};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinates=function(p0,p1){var e,base,locEdge;var e=this.locator.locate(new jsts.triangulate.quadedge.Vertex(p0));if(e===null){return null;}
base=e;if(e.dest().getCoordinate().equals2D(p0)){base=e.sym();}
locEdge=base;do{if(locEdge.dest().getCoordinate().equals2D(p1)){return locEdge;}
locEdge=locEdge.oNext();}while(locEdge!=base);return null;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.insertSite=function(v){var e,base,startEdge;e=this.locate(v);if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return e;}
base=this.makeEdge(e.orig(),v);jsts.triangulate.quadedge.QuadEdge.splice(base,e);startEdge=base;do{base=this.connect(e,base.sym());e=base.oPrev();}while(e.lNext()!=startEdge);return startEdge;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameEdge=function(e){if(this.isFrameVertex(e.orig())||this.isFrameVertex(e.dest())){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameBorderEdge=function(e){var leftTri,rightTri,vLeftTriOther,vRightTriOther;leftTri=new Array(3);this.getTriangleEdges(e,leftTri);rightTri=new Array(3);this.getTriangleEdges(e.sym(),rightTri);vLeftTriOther=e.lNext().dest();if(this.isFrameVertex(vLeftTriOther)){return true;}
vRightTriOther=e.sym().lNext().dest();if(this.isFrameVertex(vRightTriOther)){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameVertex=function(v){if(v.equals(this.frameVertex[0])){return true;}
if(v.equals(this.frameVertex[1])){return true;}
if(v.equals(this.frameVertex[2])){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isOnEdge=function(e,p){this.seg.setCoordinates(e.orig().getCoordinate(),e.dest().getCoordinate());var dist=this.seg.distance(p);return dist<this.edgeCoincidenceTolerance;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isVertexOfEdge=function(e,v){if((v.equals(e.orig(),this.tolerance))||(v.equals(e.dest(),this.tolerance))){return true;}
return false;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertices=function(includeFrame)
{var vertices=[],i,il,qe,v,vd;i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(includeFrame||!this.isFrameVertex(v)){vertices.push(v);}
vd=qe.dest();if(includeFrame||!this.isFrameVertex(vd)){vertices.push(vd);}}
return vertices;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertexUniqueEdges=function(includeFrame)
{var edges,visitedVertices,i,il,qe,v,qd,vd;edges=[];visitedVertices=[];i=0,il=this.quadEdges.length;for(i;i<il;i++){qe=this.quadEdges[i];v=qe.orig();if(visitedVertices.indexOf(v)===-1){visitedVertices.push(v);if(includeFrame||!this.isFrameVertex(v)){edges.push(qe);}}
qd=qe.sym();vd=qd.orig();if(visitedVertices.indexOf(vd)===-1){visitedVertices.push(vd);if(includeFrame||!this.isFrameVertex(vd)){edges.push(qd);}}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getPrimaryEdges=function(includeFrame){this.visitedKey++;var edges,edgeStack,visitedEdges,edge,priQE;edges=[];edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){priQE=edge.getPrimary();if(includeFrame||!this.isFrameEdge(priQE)){edges.push(priQE);}
edgeStack.push(edge.oNext());edgeStack.push(edge.sym().oNext());visitedEdges.push(edge);visitedEdges.push(edge.sym());}}
return edges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.visitTriangles=function(triVisitor,includeFrame){this.visitedKey++;var edgeStack,visitedEdges,edge,triEdges;edgeStack=[];edgeStack.push(this.startingEdge);visitedEdges=[];while(edgeStack.length>0){edge=edgeStack.pop();if(visitedEdges.indexOf(edge)===-1){triEdges=this.fetchTriangleToVisit(edge,edgeStack,includeFrame,visitedEdges);if(triEdges!==null)
triVisitor.visit(triEdges);}}};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.fetchTriangleToVisit=function(edge,edgeStack,includeFrame,visitedEdges){var curr,edgeCount,isFrame,sym;curr=edge;edgeCount=0;isFrame=false;do{this.triEdges[edgeCount]=curr;if(this.isFrameEdge(curr)){isFrame=true;}
sym=curr.sym();if(visitedEdges.indexOf(sym)===-1){edgeStack.push(sym);}
visitedEdges.push(curr);edgeCount++;curr=curr.lNext();}while(curr!==edge);if(isFrame&&!includeFrame){return null;}
return this.triEdges;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleEdges=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleEdgesListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleEdges();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleVertices=function(includeFrame){var visitor=new TriangleVertexListVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangleVertices();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleCoordinates=function(includeFrame){var visitor=new jsts.triangulate.quadedge.TriangleCoordinatesVisitor();this.visitTriangles(visitor,includeFrame);return visitor.getTriangles();};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdgesByFactory=function(geomFact){var quadEdges,edges,i,il,qe,coords;quadEdges=this.getPrimaryEdges(false);edges=[];i=0;il=quadEdges.length;for(i;i<il;i++){qe=quadEdges[i];coords=[];coords[0]=(qe.orig().getCoordinate());coords[1]=(qe.dest().getCoordinate());edges[i]=geomFact.createLineString(coords);}
return geomFact.createMultiLineString(edges);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangles=function(geomFact){var triPtsList,tris,triPt,i,il;triPtsList=this.getTriangleCoordinates(false);tris=new Array(triPtsList.length);i=0,il=triPtsList.length;for(i;i<il;i++){triPt=triPtsList[i];tris[i]=geomFact.createPolygon(geomFact.createLinearRing(triPt,null));}
return geomFact.createGeometryCollection(tris);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiDiagram=function(geomFact)
{var vorCells=this.getVoronoiCellPolygons(geomFact);return geomFact.createGeometryCollection(vorCells);};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygons=function(geomFact)
{this.visitTriangles(new jsts.triangulate.quadedge.TriangleCircumcentreVisitor(),true);var cells,edges,i,il,qe;cells=[];edges=this.getVertexUniqueEdges(false);i=0,il=edges.length;for(i;i<il;i++){qe=edges[i];cells.push(this.getVoronoiCellPolygon(qe,geomFact));}
return cells;};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygon=function(qe,geomFact)
{var cellPts,startQe,cc,coordList,cellPoly,v;cellPts=[];startQE=qe;do{cc=qe.rot.orig().getCoordinate();cellPts.push(cc);qe=qe.oPrev();}while(qe!==startQE);coordList=new jsts.geom.CoordinateList([],false);coordList.add(cellPts,false);coordList.closeRing();if(coordList.size()<4){coordList.add(coordList.get(coordList.size()-1),true);}
cellPoly=geomFact.createPolygon(geomFact.createLinearRing(coordList.toArray()),null);v=startQE.orig();return cellPoly;};jsts.triangulate.quadedge.TriangleCircumcentreVisitor=function(){};jsts.triangulate.quadedge.TriangleCircumcentreVisitor.prototype.visit=function(triEdges){var a,b,c,cc,ccVertex,i;a=triEdges[0].orig().getCoordinate();b=triEdges[1].orig().getCoordinate();c=triEdges[2].orig().getCoordinate();cc=jsts.geom.Triangle.circumcentre(a,b,c);ccVertex=new jsts.triangulate.quadedge.Vertex(cc);i=0;for(i;i<3;i++){triEdges[i].rot.setOrig(ccVertex);}};jsts.triangulate.quadedge.TriangleEdgesListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.visit=function(triEdges){var clone=triEdges.concat();this.triList.push(clone);};jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.getTriangleEdges=function(){return this.triList;};jsts.triangulate.quadedge.TriangleVertexListVisitor=function(){this.triList=[];};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.visit=function(triEdges){var vertices=[];vertices.push(trieEdges[0].orig());vertices.push(trieEdges[1].orig());vertices.push(trieEdges[2].orig());this.triList.push(vertices);};jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.getTriangleVertices=function(){return this.triList;};jsts.triangulate.quadedge.TriangleCoordinatesVisitor=function(){this.coordList=new jsts.geom.CoordinateList([],false);this.triCoords=[];};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.visit=function(triEdges){this.coordList=new jsts.geom.CoordinateList([],false);var i=0,v,pts;for(i;i<3;i++){v=triEdges[i].orig();this.coordList.add(v.getCoordinate());}
if(this.coordList.size()>0){this.coordList.closeRing();pts=this.coordList.toArray();if(pts.length!==4){return;}
this.triCoords.push(pts);}};jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.getTriangles=function(){return this.triCoords;};jsts.operation.relate.EdgeEndBundle=function(){this.edgeEnds=[];var e=arguments[0]instanceof jsts.geomgraph.EdgeEnd?arguments[0]:arguments[1];var edge=e.getEdge();var coord=e.getCoordinate();var dirCoord=e.getDirectedCoordinate();var label=new jsts.geomgraph.Label(e.getLabel());jsts.geomgraph.EdgeEnd.call(this,edge,coord,dirCoord,label);this.insert(e);};jsts.operation.relate.EdgeEndBundle.prototype=new jsts.geomgraph.EdgeEnd();jsts.operation.relate.EdgeEndBundle.prototype.edgeEnds=null;jsts.operation.relate.EdgeEndBundle.prototype.getLabel=function(){return this.label;};jsts.operation.relate.EdgeEndBundle.prototype.getEdgeEnds=function(){return this.edgeEnds;};jsts.operation.relate.EdgeEndBundle.prototype.insert=function(e){this.edgeEnds.push(e);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabel=function(boundaryNodeRule){var isArea=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea())
isArea=true;}
if(isArea)
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE);else
this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(var i=0;i<2;i++){this.computeLabelOn(i,boundaryNodeRule);if(isArea)
this.computeLabelSides(i);}};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelOn=function(geomIndex,boundaryNodeRule){var boundaryCount=0;var foundInterior=false;for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];var loc=e.getLabel().getLocation(geomIndex);if(loc==jsts.geom.Location.BOUNDARY)
boundaryCount++;if(loc==jsts.geom.Location.INTERIOR)
foundInterior=true;}
var loc=jsts.geom.Location.NONE;if(foundInterior)
loc=jsts.geom.Location.INTERIOR;if(boundaryCount>0){loc=jsts.geomgraph.GeometryGraph.determineBoundary(boundaryNodeRule,boundaryCount);}
this.label.setLocation(geomIndex,loc);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSides=function(geomIndex){this.computeLabelSide(geomIndex,jsts.geomgraph.Position.LEFT);this.computeLabelSide(geomIndex,jsts.geomgraph.Position.RIGHT);};jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSide=function(geomIndex,side){for(var i=0;i<this.edgeEnds.length;i++){var e=this.edgeEnds[i];if(e.getLabel().isArea()){var loc=e.getLabel().getLocation(geomIndex,side);if(loc===jsts.geom.Location.INTERIOR){this.label.setLocation(geomIndex,side,jsts.geom.Location.INTERIOR);return;}else if(loc===jsts.geom.Location.EXTERIOR)
this.label.setLocation(geomIndex,side,jsts.geom.Location.EXTERIOR);}}};jsts.operation.relate.EdgeEndBundle.prototype.updateIM=function(im){jsts.geomgraph.Edge.updateIM(this.label,im);};jsts.index.kdtree.KdTree=function(tolerance){var tol=0.0;if(tolerance!==undefined){tol=tolerance;}
this.root=null;this.last=null;this.numberOfNodes=0;this.tolerance=tol;};jsts.index.kdtree.KdTree.prototype.insert=function(){if(arguments.length===1){return this.insertCoordinate.apply(this,arguments[0]);}else{return this.insertWithData.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.insertCoordinate=function(p){return this.insertWithData(p,null);};jsts.index.kdtree.KdTree.prototype.insertWithData=function(p,data){if(this.root===null){this.root=new jsts.index.kdtree.KdNode(p,data);return this.root;}
var currentNode=this.root,leafNode=this.root,isOddLevel=true,isLessThan=true;while(currentNode!==last){if(isOddLevel){isLessThan=p.x<currentNode.getX();}else{isLessThan=p.y<currentNode.getY();}
leafNode=currentNode;if(isLessThan){currentNode=currentNode.getLeft();}else{currentNode=currentNode.getRight();}
if(currentNode!==null){var isInTolerance=p.distance(currentNode.getCoordinate())<=this.tolerance;if(isInTolerance){currentNode.increment();return currentNode;}}
isOddLevel=!isOddLevel;}
this.numberOfNodes=numberOfNodes+1;var node=new jsts.index.kdtree.KdNode(p,data);node.setLeft(this.last);node.setRight(this.last);if(isLessThan){leafNode.setLeft(node);}else{leafNode.setRight(node);}
return node;};jsts.index.kdtree.KdTree.prototype.queryNode=function(currentNode,bottomNode,queryEnv,odd,result){if(currentNode===bottomNode){return;}
var min,max,discriminant;if(odd){min=queryEnv.getMinX();max=queryEnv.getMaxX();discriminant=currentNode.getX();}else{min=queryEnv.getMinY();max=queryEnv.getMaxY();discriminant=currentNode.getY();}
var searchLeft=min<discriminant;var searchRight=discriminant<=max;if(searchLeft){this.queryNode(currentNode.getLeft(),bottomNode,queryEnv,!odd,result);}
if(queryEnv.contains(currentNode.getCoordinate())){result.add(currentNode);}
if(searchRight){this.queryNode(currentNode.getRight(),bottomNode,queryEnv,!odd,result);}};jsts.index.kdtree.KdTree.prototype.query=function(){if(arguments.length===1){return this.queryByEnvelope.apply(this,arguments[0]);}else{return this.queryWithArray.apply(this,arguments[0],arguments[1]);}};jsts.index.kdtree.KdTree.prototype.queryByEnvelope=function(queryEnv){var result=[];this.queryNode(this.root,this.last,queryEnv,true,result);return result;};jsts.index.kdtree.KdTree.prototype.queryWithArray=function(queryEnv,result){this.queryNode(this.root,this.last,queryEnv,true,result);};jsts.geom.Triangle=function(p0,p1,p2){this.p0=p0;this.p1=p1;this.p2=p2;};jsts.geom.Triangle.isAcute=function(a,b,c){if(!jsts.algorithm.Angle.isAcute(a,b,c)){return false;}
if(!jsts.algorithm.Angle.isAcute(b,c,a)){return false;}
if(!jsts.algorithm.Angle.isAcute(c,a,b)){return false;}
return true;};jsts.geom.Triangle.perpendicularBisector=function(a,b){var dx,dy,l1,l2;dx=b.x-a.x;dy=b.y-a.y;l1=new jsts.algorithm.HCoordinate(a.x+dx/2.0,a.y+dy/2.0,1.0);l2=new jsts.algorithm.HCoordinate(a.x-dy+dx/2.0,a.y+dx+dy/2.0,1.0);return new jsts.algorithm.HCoordinate(l1,l2);};jsts.geom.Triangle.circumcentre=function(a,b,c){var cx,cy,ax,ay,bx,by,denom,numx,numy,ccx,ccy;cx=c.x;cy=c.y;ax=a.x-cx;ay=a.y-cy;bx=b.x-cx;by=b.y-cy;denom=2*jsts.geom.Triangle.det(ax,ay,bx,by);numx=jsts.geom.Triangle.det(ay,ax*ax+ay*ay,by,bx*bx+by*by);numy=jsts.geom.Triangle.det(ax,ax*ax+ay*ay,bx,bx*bx+by*by);ccx=cx-numx/denom;ccy=cy+numy/denom;return new jsts.geom.Coordinate(ccx,ccy);};jsts.geom.Triangle.det=function(m00,m01,m10,m11){return m00*m11-m01*m10;};jsts.geom.Triangle.inCentre=function(a,b,c){var len0,len1,len2,circum,inCentreX,inCentreY;len0=b.distance(c);len1=a.distance(c);len2=a.distance(b);circum=len0+len1+len2;inCentreX=(len0*a.x+len1*b.x+len2*c.x)/circum;inCentreY=(len0*a.y+len1*b.y+len2*c.y)/circum;return new jsts.geom.Coordinate(inCentreX,inCentreY);};jsts.geom.Triangle.centroid=function(a,b,c){var x,y;x=(a.x+b.x+c.x)/3;y=(a.y+b.y+c.y)/3;return new jsts.geom.Coordinate(x,y);};jsts.geom.Triangle.longestSideLength=function(a,b,c){var lenAB,lenBC,lenCA,maxLen;lenAB=a.distance(b);lenBC=b.distance(c);lenCA=c.distance(a);maxLen=lenAB;if(lenBC>maxLen){maxLen=lenBC;}
if(lenCA>maxLen){maxLen=lenCA;}
return maxLen;};jsts.geom.Triangle.angleBisector=function(a,b,c){var len0,len2,frac,dx,dy,splitPt;len0=b.distance(a);len2=b.distance(c);frac=len0/(len0+len2);dx=c.x-a.x;dy=c.y-a.y;splitPt=new jsts.geom.Coordinate(a.x+frac*dx,a.y+frac*dy);return splitPt;};jsts.geom.Triangle.area=function(a,b,c){return Math.abs(((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0);};jsts.geom.Triangle.signedArea=function(a,b,c){return((c.x-a.x)*(b.y-a.y)-(b.x-a.x)*(c.y-a.y))/2.0;};jsts.geom.Triangle.prototype.inCentre=function(){return jsts.geom.Triangle.inCentre(this.p0,this.p1,this.p2);};jsts.noding.OrientedCoordinateArray=function(pts){this.pts=pts;this._orientation=jsts.noding.OrientedCoordinateArray.orientation(pts);};jsts.noding.OrientedCoordinateArray.prototype.pts=null;jsts.noding.OrientedCoordinateArray.prototype._orientation=undefined;jsts.noding.OrientedCoordinateArray.orientation=function(pts){return jsts.geom.CoordinateArrays.increasingDirection(pts)===1;};jsts.noding.OrientedCoordinateArray.prototype.compareTo=function(o1){var oca=o1;var comp=jsts.noding.OrientedCoordinateArray.compareOriented(this.pts,this._orientation,oca.pts,oca._orientation);return comp;};jsts.noding.OrientedCoordinateArray.compareOriented=function(pts1,orientation1,pts2,orientation2){var dir1=orientation1?1:-1;var dir2=orientation2?1:-1;var limit1=orientation1?pts1.length:-1;var limit2=orientation2?pts2.length:-1;var i1=orientation1?0:pts1.length-1;var i2=orientation2?0:pts2.length-1;var comp=0;while(true){var compPt=pts1[i1].compareTo(pts2[i2]);if(compPt!==0)
return compPt;i1+=dir1;i2+=dir2;var done1=i1===limit1;var done2=i2===limit2;if(done1&&!done2)
return-1;if(!done1&&done2)
return 1;if(done1&&done2)
return 0;}};jsts.algorithm.CentralEndpointIntersector=function(p00,p01,p10,p11){this.pts=[p00,p01,p10,p11];this.compute();};jsts.algorithm.CentralEndpointIntersector.getIntersection=function(p00,p01,p10,p11){var intor=new jsts.algorithm.CentralEndpointIntersector(p00,p01,p10,p11);return intor.getIntersection();};jsts.algorithm.CentralEndpointIntersector.prototype.pts=null;jsts.algorithm.CentralEndpointIntersector.prototype.intPt=null;jsts.algorithm.CentralEndpointIntersector.prototype.compute=function(){var centroid=jsts.algorithm.CentralEndpointIntersector.average(this.pts);this.intPt=this.findNearestPoint(centroid,this.pts);};jsts.algorithm.CentralEndpointIntersector.prototype.getIntersection=function(){return this.intPt;};jsts.algorithm.CentralEndpointIntersector.average=function(pts){var avg=new jsts.geom.Coordinate();var i,n=pts.length;for(i=0;i<n;i++){avg.x+=pts[i].x;avg.y+=pts[i].y;}
if(n>0){avg.x/=n;avg.y/=n;}
return avg;};jsts.algorithm.CentralEndpointIntersector.prototype.findNearestPoint=function(p,pts){var minDist=Number.MAX_VALUE;var i,result=null,dist;for(i=0;i<pts.length;i++){dist=p.distance(pts[i]);if(dist<minDist){minDist=dist;result=pts[i];}}
return result;};jsts.operation.buffer.BufferOp=function(g,bufParams){this.argGeom=g;this.bufParams=bufParams?bufParams:new jsts.operation.buffer.BufferParameters();};jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS=12;jsts.operation.buffer.BufferOp.precisionScaleFactor=function(g,distance,maxPrecisionDigits){var env=g.getEnvelopeInternal();var envSize=Math.max(env.getHeight(),env.getWidth());var expandByDistance=distance>0.0?distance:0.0;var bufEnvSize=envSize+2*expandByDistance;var bufEnvLog10=(Math.log(bufEnvSize)/Math.log(10)+1.0);var minUnitLog10=bufEnvLog10-maxPrecisionDigits;var scaleFactor=Math.pow(10.0,-minUnitLog10);return scaleFactor;};jsts.operation.buffer.BufferOp.bufferOp=function(g,distance){if(arguments.length>2){return jsts.operation.buffer.BufferOp.bufferOp2.apply(this,arguments);}
var gBuf=new jsts.operation.buffer.BufferOp(g);var geomBuf=gBuf.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp2=function(g,distance,params){if(arguments.length>3){return jsts.operation.buffer.BufferOp.bufferOp3.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g,params);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp3=function(g,distance,quadrantSegments){if(arguments.length>4){return jsts.operation.buffer.BufferOp.bufferOp4.apply(this,arguments);}
var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.bufferOp4=function(g,distance,quadrantSegments,endCapStyle){var bufOp=new jsts.operation.buffer.BufferOp(g);bufOp.setQuadrantSegments(quadrantSegments);bufOp.setEndCapStyle(endCapStyle);var geomBuf=bufOp.getResultGeometry(distance);return geomBuf;};jsts.operation.buffer.BufferOp.prototype.argGeom=null;jsts.operation.buffer.BufferOp.prototype.distance=null;jsts.operation.buffer.BufferOp.prototype.bufParams=null;jsts.operation.buffer.BufferOp.prototype.resultGeometry=null;jsts.operation.buffer.BufferOp.prototype.setEndCapStyle=function(endCapStyle){this.bufParams.setEndCapStyle(endCapStyle);};jsts.operation.buffer.BufferOp.prototype.setQuadrantSegments=function(quadrantSegments){this.bufParams.setQuadrantSegments(quadrantSegments);};jsts.operation.buffer.BufferOp.prototype.getResultGeometry=function(dist){this.distance=dist;this.computeGeometry();return this.resultGeometry;};jsts.operation.buffer.BufferOp.prototype.computeGeometry=function(){this.bufferOriginalPrecision();if(this.resultGeometry!==null){return;}
var argPM=this.argGeom.getPrecisionModel();if(argPM.getType()===jsts.geom.PrecisionModel.FIXED){this.bufferFixedPrecision(argPM);}else{this.bufferReducedPrecision();}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision=function(){var precDigits;var saveException=null;for(precDigits=jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS;precDigits>=0;precDigits--){try{this.bufferReducedPrecision2(precDigits);}catch(ex){saveException=ex;}
if(this.resultGeometry!==null){return;}}
throw saveException;};jsts.operation.buffer.BufferOp.prototype.bufferOriginalPrecision=function(){try{var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);}catch(e){}};jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision2=function(precisionDigits){var sizeBasedScaleFactor=jsts.operation.buffer.BufferOp.precisionScaleFactor(this.argGeom,this.distance,precisionDigits);var fixedPM=new jsts.geom.PrecisionModel(sizeBasedScaleFactor);this.bufferFixedPrecision(fixedPM);};jsts.operation.buffer.BufferOp.prototype.bufferFixedPrecision=function(fixedPM){var noder=new jsts.noding.ScaledNoder(new jsts.noding.snapround.MCIndexSnapRounder(new jsts.geom.PrecisionModel(1.0)),fixedPM.getScale());var bufBuilder=new jsts.operation.buffer.BufferBuilder(this.bufParams);bufBuilder.setWorkingPrecisionModel(fixedPM);bufBuilder.setNoder(noder);this.resultGeometry=bufBuilder.buffer(this.argGeom,this.distance);};(function(){var Location=jsts.geom.Location;var Position=jsts.geomgraph.Position;var Assert=jsts.util.Assert;jsts.geomgraph.GeometryGraph=function(argIndex,parentGeom,boundaryNodeRule){jsts.geomgraph.PlanarGraph.call(this);this.lineEdgeMap=new javascript.util.HashMap();this.ptLocator=new jsts.algorithm.PointLocator();this.argIndex=argIndex;this.parentGeom=parentGeom;this.boundaryNodeRule=boundaryNodeRule||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE;if(parentGeom!==null){this.add(parentGeom);}};jsts.geomgraph.GeometryGraph.prototype=new jsts.geomgraph.PlanarGraph();jsts.geomgraph.GeometryGraph.constructor=jsts.geomgraph.GeometryGraph;jsts.geomgraph.GeometryGraph.prototype.createEdgeSetIntersector=function(){return new jsts.geomgraph.index.SimpleMCSweepLineIntersector();};jsts.geomgraph.GeometryGraph.determineBoundary=function(boundaryNodeRule,boundaryCount){return boundaryNodeRule.isInBoundary(boundaryCount)?Location.BOUNDARY:Location.INTERIOR;};jsts.geomgraph.GeometryGraph.prototype.parentGeom=null;jsts.geomgraph.GeometryGraph.prototype.lineEdgeMap=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodeRule=null;jsts.geomgraph.GeometryGraph.prototype.useBoundaryDeterminationRule=true;jsts.geomgraph.GeometryGraph.prototype.argIndex=null;jsts.geomgraph.GeometryGraph.prototype.boundaryNodes=null;jsts.geomgraph.GeometryGraph.prototype.hasTooFewPoints=false;jsts.geomgraph.GeometryGraph.prototype.invalidPoint=null;jsts.geomgraph.GeometryGraph.prototype.areaPtLocator=null;jsts.geomgraph.GeometryGraph.prototype.ptLocator=null;jsts.geomgraph.GeometryGraph.prototype.getGeometry=function(){return this.parentGeom;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodes=function(){if(this.boundaryNodes===null)
this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex);return this.boundaryNodes;};jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodeRule=function(){return this.boundaryNodeRule;};jsts.geomgraph.GeometryGraph.prototype.findEdge=function(line){return this.lineEdgeMap.get(line);};jsts.geomgraph.GeometryGraph.prototype.computeSplitEdges=function(edgelist){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();e.eiList.addSplitEdges(edgelist);}}
jsts.geomgraph.GeometryGraph.prototype.add=function(g){if(g.isEmpty()){return;}
if(g instanceof jsts.geom.MultiPolygon)
this.useBoundaryDeterminationRule=false;if(g instanceof jsts.geom.Polygon)
this.addPolygon(g);else if(g instanceof jsts.geom.LineString)
this.addLineString(g);else if(g instanceof jsts.geom.Point)
this.addPoint(g);else if(g instanceof jsts.geom.MultiPoint)
this.addCollection(g);else if(g instanceof jsts.geom.MultiLineString)
this.addCollection(g);else if(g instanceof jsts.geom.MultiPolygon)
this.addCollection(g);else if(g instanceof jsts.geom.GeometryCollection)
this.addCollection(g);else
throw new jsts.error.IllegalArgumentError('Geometry type not supported.');};jsts.geomgraph.GeometryGraph.prototype.addCollection=function(gc){for(var i=0;i<gc.getNumGeometries();i++){var g=gc.getGeometryN(i);this.add(g);}};jsts.geomgraph.GeometryGraph.prototype.addEdge=function(e){this.insertEdge(e);var coord=e.getCoordinates();this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);this.insertPoint(this.argIndex,coord[coord.length-1],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPoint=function(p){var coord=p.getCoordinate();this.insertPoint(this.argIndex,coord,Location.INTERIOR);};jsts.geomgraph.GeometryGraph.prototype.addLineString=function(line){var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(line.getCoordinates());if(coord.length<2){this.hasTooFewPoints=true;this.invalidPoint=coords[0];return;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.INTERIOR));this.lineEdgeMap.put(line,e);this.insertEdge(e);Assert.isTrue(coord.length>=2,'found LineString with single point');this.insertBoundaryPoint(this.argIndex,coord[0]);this.insertBoundaryPoint(this.argIndex,coord[coord.length-1]);};jsts.geomgraph.GeometryGraph.prototype.addPolygonRing=function(lr,cwLeft,cwRight){if(lr.isEmpty())
return;var coord=jsts.geom.CoordinateArrays.removeRepeatedPoints(lr.getCoordinates());if(coord.length<4){this.hasTooFewPoints=true;this.invalidPoint=coord[0];return;}
var left=cwLeft;var right=cwRight;if(jsts.algorithm.CGAlgorithms.isCCW(coord)){left=cwRight;right=cwLeft;}
var e=new jsts.geomgraph.Edge(coord,new jsts.geomgraph.Label(this.argIndex,Location.BOUNDARY,left,right));this.lineEdgeMap.put(lr,e);this.insertEdge(e);this.insertPoint(this.argIndex,coord[0],Location.BOUNDARY);};jsts.geomgraph.GeometryGraph.prototype.addPolygon=function(p){this.addPolygonRing(p.getExteriorRing(),Location.EXTERIOR,Location.INTERIOR);for(var i=0;i<p.getNumInteriorRing();i++){var hole=p.getInteriorRingN(i);this.addPolygonRing(hole,Location.INTERIOR,Location.EXTERIOR);}};jsts.geomgraph.GeometryGraph.prototype.computeEdgeIntersections=function(g,li,includeProper){var si=new jsts.geomgraph.index.SegmentIntersector(li,includeProper,true);si.setBoundaryNodes(this.getBoundaryNodes(),g.getBoundaryNodes());var esi=this.createEdgeSetIntersector();esi.computeIntersections(this.edges,g.edges,si);return si;};jsts.geomgraph.GeometryGraph.prototype.computeSelfNodes=function(li,computeRingSelfNodes){var si=new jsts.geomgraph.index.SegmentIntersector(li,true,false);var esi=this.createEdgeSetIntersector();if(!computeRingSelfNodes&&(this.parentGeom instanceof jsts.geom.LinearRing||this.parentGeom instanceof jsts.geom.Polygon||this.parentGeom instanceof jsts.geom.MultiPolygon)){esi.computeIntersections(this.edges,si,false);}else{esi.computeIntersections(this.edges,si,true);}
this.addSelfIntersectionNodes(this.argIndex);return si;};jsts.geomgraph.GeometryGraph.prototype.insertPoint=function(argIndex,coord,onLocation){var n=this.nodes.addNode(coord);var lbl=n.getLabel();if(lbl==null){n.label=new jsts.geomgraph.Label(argIndex,onLocation);}else
lbl.setLocation(argIndex,onLocation);};jsts.geomgraph.GeometryGraph.prototype.insertBoundaryPoint=function(argIndex,coord){var n=this.nodes.addNode(coord);var lbl=n.getLabel();var boundaryCount=1;var loc=Location.NONE;if(lbl!==null)
loc=lbl.getLocation(argIndex,Position.ON);if(loc===Location.BOUNDARY)
boundaryCount++;var newLoc=jsts.geomgraph.GeometryGraph.determineBoundary(this.boundaryNodeRule,boundaryCount);lbl.setLocation(argIndex,newLoc);};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNodes=function(argIndex){for(var i=this.edges.iterator();i.hasNext();){var e=i.next();var eLoc=e.getLabel().getLocation(argIndex);for(var eiIt=e.eiList.iterator();eiIt.hasNext();){var ei=eiIt.next();this.addSelfIntersectionNode(argIndex,ei.coord,eLoc);}}};jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNode=function(argIndex,coord,loc){if(this.isBoundaryNode(argIndex,coord))
return;if(loc===Location.BOUNDARY&&this.useBoundaryDeterminationRule)
this.insertBoundaryPoint(argIndex,coord);else
this.insertPoint(argIndex,coord,loc);};jsts.geomgraph.GeometryGraph.prototype.getInvalidPoint=function(){return this.invalidPoint;};})();jsts.operation.buffer.OffsetSegmentString=function(){this.ptList=[];};jsts.operation.buffer.OffsetSegmentString.prototype.ptList=null;jsts.operation.buffer.OffsetSegmentString.prototype.precisionModel=null;jsts.operation.buffer.OffsetSegmentString.prototype.minimimVertexDistance=0.0;jsts.operation.buffer.OffsetSegmentString.prototype.setPrecisionModel=function(precisionModel){this.precisionModel=precisionModel;};jsts.operation.buffer.OffsetSegmentString.prototype.setMinimumVertexDistance=function(minimimVertexDistance){this.minimimVertexDistance=minimimVertexDistance;};jsts.operation.buffer.OffsetSegmentString.prototype.addPt=function(pt){var bufPt=new jsts.geom.Coordinate(pt);this.precisionModel.makePrecise(bufPt);if(this.isRedundant(bufPt))
return;this.ptList.push(bufPt);};jsts.operation.buffer.OffsetSegmentString.prototype.addPts=function(pt,isForward){if(isForward){for(var i=0;i<pt.length;i++){this.addPt(pt[i]);}}else{for(var i=pt.length-1;i>=0;i--){this.addPt(pt[i]);}}};jsts.operation.buffer.OffsetSegmentString.prototype.isRedundant=function(pt){if(this.ptList.length<1)
return false;var lastPt=this.ptList[this.ptList.length-1];var ptDist=pt.distance(lastPt);if(ptDist<this.minimimVertexDistance)
return true;return false;};jsts.operation.buffer.OffsetSegmentString.prototype.closeRing=function(){if(this.ptList.length<1)
return;var startPt=new jsts.geom.Coordinate(this.ptList[0]);var lastPt=this.ptList[this.ptList.length-1];var last2Pt=null;if(this.ptList.length>=2)
last2Pt=this.ptList[this.ptList.length-2];if(startPt.equals(lastPt))
return;this.ptList.push(startPt);};jsts.operation.buffer.OffsetSegmentString.prototype.reverse=function(){};jsts.operation.buffer.OffsetSegmentString.prototype.getCoordinates=function(){return this.ptList;};jsts.algorithm.distance.PointPairDistance=function(){this.pt=[new jsts.geom.Coordinate(),new jsts.geom.Coordinate()];};jsts.algorithm.distance.PointPairDistance.prototype.pt=null;jsts.algorithm.distance.PointPairDistance.prototype.distance=NaN;jsts.algorithm.distance.PointPairDistance.prototype.isNull=true;jsts.algorithm.distance.PointPairDistance.prototype.initialize=function(p0,p1,distance){if(p0===undefined){this.isNull=true;return;}
this.pt[0].setCoordinate(p0);this.pt[1].setCoordinate(p1);this.distance=distance!==undefined?distance:p0.distance(p1);this.isNull=false;};jsts.algorithm.distance.PointPairDistance.prototype.getDistance=function(){return this.distance;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinates=function(){return this.pt;};jsts.algorithm.distance.PointPairDistance.prototype.getCoordinate=function(i){return this.pt[i];};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum=function(ptDist){if(arguments.length===2){this.setMaximum2.apply(this,arguments);return;}
this.setMaximum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMaximum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist>this.distance)
this.initialize(p0,p1,dist);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum=function(ptDist){if(arguments.length===2){this.setMinimum2.apply(this,arguments);return;}
this.setMinimum(ptDist.pt[0],ptDist.pt[1]);};jsts.algorithm.distance.PointPairDistance.prototype.setMinimum2=function(p0,p1){if(this.isNull){this.initialize(p0,p1);return;}
var dist=p0.distance(p1);if(dist<this.distance)
this.initialize(p0,p1,dist);};(function(){var PointPairDistance=jsts.algorithm.distance.PointPairDistance;var DistanceToPoint=jsts.algorithm.distance.DistanceToPoint;var MaxPointDistanceFilter=function(geom){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.euclideanDist=new DistanceToPoint();this.geom=geom;};MaxPointDistanceFilter.prototype=new jsts.geom.CoordinateFilter();MaxPointDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxPointDistanceFilter.prototype.euclideanDist=new DistanceToPoint();MaxPointDistanceFilter.prototype.geom;MaxPointDistanceFilter.prototype.filter=function(pt){this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);};MaxPointDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};var MaxDensifiedByFractionDistanceFilter=function(geom,fraction){this.maxPtDist=new PointPairDistance();this.minPtDist=new PointPairDistance();this.geom=geom;this.numSubSegs=Math.round(1.0/fraction);};MaxDensifiedByFractionDistanceFilter.prototype=new jsts.geom.CoordinateSequenceFilter();MaxDensifiedByFractionDistanceFilter.prototype.maxPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.minPtDist=new PointPairDistance();MaxDensifiedByFractionDistanceFilter.prototype.geom;MaxDensifiedByFractionDistanceFilter.prototype.numSubSegs=0;MaxDensifiedByFractionDistanceFilter.prototype.filter=function(seq,index){if(index==0)
return;var p0=seq[index-1];var p1=seq[index];var delx=(p1.x-p0.x)/this.numSubSegs;var dely=(p1.y-p0.y)/this.numSubSegs;for(var i=0;i<this.numSubSegs;i++){var x=p0.x+i*delx;var y=p0.y+i*dely;var pt=new jsts.geom.Coordinate(x,y);this.minPtDist.initialize();DistanceToPoint.computeDistance(this.geom,pt,this.minPtDist);this.maxPtDist.setMaximum(this.minPtDist);}};MaxDensifiedByFractionDistanceFilter.prototype.isGeometryChanged=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.isDone=function(){return false;};MaxDensifiedByFractionDistanceFilter.prototype.getMaxPointDistance=function(){return this.maxPtDist;};jsts.algorithm.distance.DiscreteHausdorffDistance=function(g0,g1){this.g0=g0;this.g1=g1;this.ptDist=new jsts.algorithm.distance.PointPairDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g0=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g1=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.ptDist=null;jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.densifyFrac=0.0;jsts.algorithm.distance.DiscreteHausdorffDistance.distance=function(g0,g1,densifyFrac){var dist=new jsts.algorithm.distance.DiscreteHausdorffDistance(g0,g1);if(densifyFrac!==undefined)
dist.setDensifyFraction(densifyFrac);return dist.distance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.setDensifyFraction=function(densifyFrac){if(densifyFrac>1.0||densifyFrac<=0.0)
throw new jsts.error.IllegalArgumentError('Fraction is not in range (0.0 - 1.0]');this.densifyFrac=densifyFrac;};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.distance=function(){this.compute(this.g0,this.g1);return ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.orientedDistance=function(){this.computeOrientedDistance(this.g0,this.g1,this.ptDist);return this.ptDist.getDistance();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.getCoordinates=function(){return ptDist.getCoordinates();};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.compute=function(g0,g1){this.computeOrientedDistance(g0,g1,this.ptDist);this.computeOrientedDistance(g1,g0,this.ptDist);};jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.computeOrientedDistance=function(discreteGeom,geom,ptDist){var distFilter=new MaxPointDistanceFilter(geom);discreteGeom.apply(distFilter);ptDist.setMaximum(distFilter.getMaxPointDistance());if(this.densifyFrac>0){var fracFilter=new MaxDensifiedByFractionDistanceFilter(geom,this.densifyFrac);discreteGeom.apply(fracFilter);ptDist.setMaximum(fracFilter.getMaxPointDistance());}};})();jsts.algorithm.MinimumBoundingCircle=function(geom){this.input=null;this.extremalPts=null;this.centre=null;this.radius=0;this.input=geom;};jsts.algorithm.MinimumBoundingCircle.prototype.getCircle=function(){this.compute();if(this.centre===null){return this.input.getFactory().createPolygon(null,null);}
var centrePoint=this.input.getFactory().createPoint(this.centre);if(this.radius===0){return centrePoint;}
return centrePoint.buffer(this.radius);};jsts.algorithm.MinimumBoundingCircle.prototype.getExtremalPoints=function(){this.compute();return this.extremalPts;};jsts.algorithm.MinimumBoundingCircle.prototype.getCentre=function(){this.compute();return this.centre;};jsts.algorithm.MinimumBoundingCircle.prototype.getRadius=function(){this.compute();return this.radius;};jsts.algorithm.MinimumBoundingCircle.prototype.computeCentre=function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new jsts.geom.Coordinate((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=jsts.geom.Triangle.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2]);break;}};jsts.algorithm.MinimumBoundingCircle.prototype.compute=function(){if(this.extremalPts!==null){return;}
this.computeCirclePoints();this.computeCentre();if(this.centre!==null){this.radius=this.centre.distance(this.extremalPts[0]);}};jsts.algorithm.MinimumBoundingCircle.prototype.computeCirclePoints=function(){if(this.input.isEmpty()){this.extremalPts=[];return;}
var pts;if(this.input.getNumPoints()===1){pts=this.input.getCoordinates();this.extremalPts=[new jsts.geom.Coordinate(pts[0])];return;}
var convexHull=this.input.convexHull();var hullPts=convexHull.getCoordinates();pts=hullPts;if(hullPts[0].equals2D(hullPts[hullPts.length-1])){pts=[];jsts.geom.CoordinateArrays.copyDeep(hullPts,0,pts,0,hullPts.length-1);}
if(pts.length<=2){this.extremalPts=jsts.geom.CoordinateArrays.copyDeep(pts);return;}
var P=jsts.algorithm.MinimumBoundingCircle.lowestPoint(pts);var Q=jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX(pts,P);for(var i=0;i<pts.length;i++){var R=jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment(pts,P,Q);if(jsts.algorithm.Angle.isObtuse(P,R,Q)){this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q)];return;}
if(jsts.algorithm.Angle.isObtuse(R,P,Q)){P=R;continue;}
if(jsts.algorithm.Angle.isObtuse(R,Q,P)){Q=R;continue;}
this.extremalPts=[new jsts.geom.Coordinate(P),new jsts.geom.Coordinate(Q),new jsts.geom.Coordinate(R)];return;}
throw new Error("Logic failure in Minimum Bounding Circle algorithm!");};jsts.algorithm.MinimumBoundingCircle.lowestPoint=function(pts){var min=pts[0];for(var i=1;i<pts.length;i++){if(pts[i].y<min.y){min=pts[i];}}
return min;};jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX=function(pts,P){var minSin=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;var dx=p.x-P.x;var dy=p.y-P.y;if(dy<0)dy=-dy;var len=Math.sqrt(dx*dx+dy*dy);var sin=dy/len;if(sin<minSin){minSin=sin;minAngPt=p;}}
return minAngPt;};jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment=function(pts,P,Q){var minAng=Number.MAX_VALUE;var minAngPt=null;for(var i=0;i<pts.length;i++){var p=pts[i];if(p===P)continue;if(p===Q)continue;var ang=jsts.algorithm.Angle.angleBetween(P,p,Q);if(ang<minAng){minAng=ang;minAngPt=p;}}
return minAngPt;};jsts.noding.ScaledNoder=function(noder,scaleFactor,offsetX,offsetY){this.offsetX=offsetX?offsetX:0;this.offsetY=offsetY?offsetY:0;this.noder=noder;this.scaleFactor=scaleFactor;this.isScaled=!this.isIntegerPrecision();};jsts.noding.ScaledNoder.prototype=new jsts.noding.Noder();jsts.noding.ScaledNoder.constructor=jsts.noding.ScaledNoder;jsts.noding.ScaledNoder.prototype.noder=null;jsts.noding.ScaledNoder.prototype.scaleFactor=undefined;jsts.noding.ScaledNoder.prototype.offsetX=undefined;jsts.noding.ScaledNoder.prototype.offsetY=undefined;jsts.noding.ScaledNoder.prototype.isScaled=false;jsts.noding.ScaledNoder.prototype.isIntegerPrecision=function(){return this.scaleFactor===1.0;};jsts.noding.ScaledNoder.prototype.getNodedSubstrings=function(){var splitSS=this.noder.getNodedSubstrings();if(this.isScaled)
this.rescale(splitSS);return splitSS;};jsts.noding.ScaledNoder.prototype.computeNodes=function(inputSegStrings){var intSegStrings=inputSegStrings;if(this.isScaled)
intSegStrings=this.scale(inputSegStrings);this.noder.computeNodes(intSegStrings);};jsts.noding.ScaledNoder.prototype.scale=function(segStrings){if(segStrings instanceof Array){return this.scale2(segStrings);}
var transformed=new javascript.util.ArrayList();for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();transformed.add(new jsts.noding.NodedSegmentString(this.scale(ss.getCoordinates()),ss.getData()));}
return transformed;};jsts.noding.ScaledNoder.prototype.scale2=function(pts){var roundPts=[];for(var i=0;i<pts.length;i++){roundPts[i]=new jsts.geom.Coordinate(Math.round((pts[i].x-this.offsetX)*this.scaleFactor),Math.round((pts[i].y-this.offsetY)*this.scaleFactor));}
var roundPtsNoDup=jsts.geom.CoordinateArrays.removeRepeatedPoints(roundPts);return roundPtsNoDup;};jsts.noding.ScaledNoder.prototype.rescale=function(segStrings){if(segStrings instanceof Array){this.rescale2(segStrings);return;}
for(var i=segStrings.iterator();i.hasNext();){var ss=i.next();this.rescale(ss.getCoordinates());}};jsts.noding.ScaledNoder.prototype.rescale2=function(pts){for(var i=0;i<pts.length;i++){pts[i].x=pts[i].x/this.scaleFactor+this.offsetX;pts[i].y=pts[i].y/this.scaleFactor+this.offsetY;}};(function(){var ArrayList=javascript.util.ArrayList;jsts.geomgraph.index.SegmentIntersector=function(li,includeProper,recordIsolated){this.li=li;this.includeProper=includeProper;this.recordIsolated=recordIsolated;};jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments=function(i1,i2){return Math.abs(i1-i2)===1;};jsts.geomgraph.index.SegmentIntersector.prototype._hasIntersection=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProper=false;jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInterior=false;jsts.geomgraph.index.SegmentIntersector.prototype.properIntersectionPoint=null;jsts.geomgraph.index.SegmentIntersector.prototype.li=null;jsts.geomgraph.index.SegmentIntersector.prototype.includeProper=null;jsts.geomgraph.index.SegmentIntersector.prototype.recordIsolated=null;jsts.geomgraph.index.SegmentIntersector.prototype.isSelfIntersection=null;jsts.geomgraph.index.SegmentIntersector.prototype.numIntersections=0;jsts.geomgraph.index.SegmentIntersector.prototype.numTests=0;jsts.geomgraph.index.SegmentIntersector.prototype.bdyNodes=null;jsts.geomgraph.index.SegmentIntersector.prototype.setBoundaryNodes=function(bdyNodes0,bdyNodes1){this.bdyNodes=[];this.bdyNodes[0]=bdyNodes0;this.bdyNodes[1]=bdyNodes1;};jsts.geomgraph.index.SegmentIntersector.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint;};jsts.geomgraph.index.SegmentIntersector.prototype.hasIntersection=function(){return this._hasIntersection;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperIntersection=function(){return this.hasProper;};jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior;};jsts.geomgraph.index.SegmentIntersector.prototype.isTrivialIntersection=function(e0,segIndex0,e1,segIndex1){if(e0===e1){if(this.li.getIntersectionNum()===1){if(jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments(segIndex0,segIndex1))
return true;if(e0.isClosed()){var maxSegIndex=e0.getNumPoints()-1;if((segIndex0===0&&segIndex1===maxSegIndex)||(segIndex1===0&&segIndex0===maxSegIndex)){return true;}}}}
return false;};jsts.geomgraph.index.SegmentIntersector.prototype.addIntersections=function(e0,segIndex0,e1,segIndex1){if(e0===e1&&segIndex0===segIndex1)
return;this.numTests++;var p00=e0.getCoordinates()[segIndex0];var p01=e0.getCoordinates()[segIndex0+1];var p10=e1.getCoordinates()[segIndex1];var p11=e1.getCoordinates()[segIndex1+1];this.li.computeIntersection(p00,p01,p10,p11);if(this.li.hasIntersection()){if(this.recordIsolated){e0.setIsolated(false);e1.setIsolated(false);}
this.numIntersections++;if(!this.isTrivialIntersection(e0,segIndex0,e1,segIndex1)){this._hasIntersection=true;if(this.includeProper||!this.li.isProper()){e0.addIntersections(this.li,segIndex0,0);e1.addIntersections(this.li,segIndex1,1);}
if(this.li.isProper()){this.properIntersectionPoint=this.li.getIntersection(0).clone();this.hasProper=true;if(!this.isBoundaryPoint(this.li,this.bdyNodes))
this.hasProperInterior=true;}}}};jsts.geomgraph.index.SegmentIntersector.prototype.isBoundaryPoint=function(li,bdyNodes){if(bdyNodes===null)
return false;if(bdyNodes instanceof Array){if(this.isBoundaryPoint(li,bdyNodes[0]))
return true;if(this.isBoundaryPoint(li,bdyNodes[1]))
return true;return false;}else{for(var i=bdyNodes.iterator();i.hasNext();){var node=i.next();var pt=node.getCoordinate();if(li.isIntersection(pt))
return true;}
return false;}};})();
},{}],38:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],39:[function(require,module,exports){
require('./dist/javascript.util-node.min.js');

},{"./dist/javascript.util-node.min.js":38}],40:[function(require,module,exports){
var extent = require('turf-extent'),
    point = require('turf-point');

/**
 * Takes a {@link FeatureCollection} of any type and returns the absolute center point of all features.
 *
 * @module turf/center
 * @category measurement
 * @param {FeatureCollection} features a FeatureCollection of any type
 * @return {Point} a Point feature at the
 * absolute center point of all input features
 * @example
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.522259, 35.4691]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.502754, 35.463455]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.508269, 35.463245]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.516809, 35.465779]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.515372, 35.467072]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.509363, 35.463053]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.511123, 35.466601]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.518547, 35.469327]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.519706, 35.469659]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.517839, 35.466998]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.508678, 35.464942]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.514914, 35.463453]
 *       }
 *     }
 *   ]
 * };
 *
 * var centerPt = turf.center(features);
 * centerPt.properties['marker-size'] = 'large';
 * centerPt.properties['marker-color'] = '#000';
 *
 * var resultFeatures = features.features.concat(centerPt);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(layer, done){
  var ext = extent(layer);
  var x = (ext[0] + ext[2])/2;
  var y = (ext[1] + ext[3])/2;
  return point([x, y]);
};

},{"turf-extent":89,"turf-point":121}],41:[function(require,module,exports){
var each = require('turf-meta').coordEach;
var point = require('turf-point');

/**
 * Takes a {@link Feature} or {@link FeatureCollection} of any type and calculates the centroid using the arithmetic mean of all vertices.
 * This lessens the effect of small islands and artifacts when calculating
 * the centroid of a set of polygons.
 *
 * @module turf/centroid
 * @category measurement
 * @param {GeoJSON} features a {@link Feature} or FeatureCollection of any type
 * @return {Point} a Point feature at the centroid of the input feature(s)
 * @example
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [105.818939,21.004714],
 *       [105.818939,21.061754],
 *       [105.890007,21.061754],
 *       [105.890007,21.004714],
 *       [105.818939,21.004714]
 *     ]]
 *   }
 * };
 *
 * var centroidPt = turf.centroid(poly);
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [poly, centroidPt]
 * };
 *
 * //=result
 */
module.exports = function(features){
  var xSum = 0, ySum = 0, len = 0;
  each(features, function(coord) {
    xSum += coord[0];
    ySum += coord[1];
    len++;
  }, true);
  return point([xSum / len, ySum / len]);
};

},{"turf-meta":42,"turf-point":121}],42:[function(require,module,exports){
/**
 * Lazily iterate over coordinates in any GeoJSON object, similar to
 * Array.forEach.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (value)
 * @param {boolean=} excludeWrapCoord whether or not to include
 * the final coordinate of LinearRings that wraps the ring in its iteration.
 * @example
 * var point = { type: 'Point', coordinates: [0, 0] };
 * coordEach(point, function(coords) {
 *   // coords is equal to [0, 0]
 * });
 */
function coordEach(layer, callback, excludeWrapCoord) {
  var i, j, k, g, geometry, stopG, coords,
    geometryMaybeCollection,
    wrapShrink = 0,
    isGeometryCollection,
    isFeatureCollection = layer.type === 'FeatureCollection',
    isFeature = layer.type === 'Feature',
    stop = isFeatureCollection ? layer.features.length : 1;

  // This logic may look a little weird. The reason why it is that way
  // is because it's trying to be fast. GeoJSON supports multiple kinds
  // of objects at its root: FeatureCollection, Features, Geometries.
  // This function has the responsibility of handling all of them, and that
  // means that some of the `for` loops you see below actually just don't apply
  // to certain inputs. For instance, if you give this just a
  // Point geometry, then both loops are short-circuited and all we do
  // is gradually rename the input until it's called 'geometry'.
  //
  // This also aims to allocate as few resources as possible: just a
  // few numbers and booleans, rather than any temporary arrays as would
  // be required with the normalization approach.
  for (i = 0; i < stop; i++) {

    geometryMaybeCollection = (isFeatureCollection ? layer.features[i].geometry :
        (isFeature ? layer.geometry : layer));
    isGeometryCollection = geometryMaybeCollection.type === 'GeometryCollection';
    stopG = isGeometryCollection ? geometryMaybeCollection.geometries.length : 1;

    for (g = 0; g < stopG; g++) {

      geometry = isGeometryCollection ?
          geometryMaybeCollection.geometries[g] : geometryMaybeCollection;
      coords = geometry.coordinates;

      wrapShrink = (excludeWrapCoord &&
        (geometry.type === 'Polygon' || geometry.type === 'MultiPolygon')) ?
        1 : 0;

      if (geometry.type === 'Point') {
        callback(coords);
      } else if (geometry.type === 'LineString' || geometry.type === 'MultiPoint') {
        for (j = 0; j < coords.length; j++) callback(coords[j]);
      } else if (geometry.type === 'Polygon' || geometry.type === 'MultiLineString') {
        for (j = 0; j < coords.length; j++)
          for (k = 0; k < coords[j].length - wrapShrink; k++)
            callback(coords[j][k]);
      } else if (geometry.type === 'MultiPolygon') {
        for (j = 0; j < coords.length; j++)
          for (k = 0; k < coords[j].length; k++)
            for (l = 0; l < coords[j][k].length - wrapShrink; l++)
              callback(coords[j][k][l]);
      } else {
        throw new Error('Unknown Geometry Type');
      }
    }
  }
}
module.exports.coordEach = coordEach;

/**
 * Lazily reduce coordinates in any GeoJSON object into a single value,
 * similar to how Array.reduce works. However, in this case we lazily run
 * the reduction, so an array of all coordinates is unnecessary.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (memo, value) and returns
 * a new memo
 * @param {boolean=} excludeWrapCoord whether or not to include
 * the final coordinate of LinearRings that wraps the ring in its iteration.
 * @param {*} memo the starting value of memo: can be any type.
 */
function coordReduce(layer, callback, memo, excludeWrapCoord) {
  coordEach(layer, function(coord) {
    memo = callback(memo, coord);
  }, excludeWrapCoord);
  return memo;
}
module.exports.coordReduce = coordReduce;

/**
 * Lazily iterate over property objects in any GeoJSON object, similar to
 * Array.forEach.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (value)
 * @example
 * var point = { type: 'Feature', geometry: null, properties: { foo: 1 } };
 * propEach(point, function(props) {
 *   // props is equal to { foo: 1}
 * });
 */
function propEach(layer, callback) {
  var i;
  switch (layer.type) {
      case 'FeatureCollection':
        features = layer.features;
        for (i = 0; i < layer.features.length; i++) {
            callback(layer.features[i].properties);
        }
        break;
      case 'Feature':
        callback(layer.properties);
        break;
  }
}
module.exports.propEach = propEach;

/**
 * Lazily reduce properties in any GeoJSON object into a single value,
 * similar to how Array.reduce works. However, in this case we lazily run
 * the reduction, so an array of all properties is unnecessary.
 *
 * @param {Object} layer any GeoJSON object
 * @param {Function} callback a method that takes (memo, coord) and returns
 * a new memo
 * @param {*} memo the starting value of memo: can be any type.
 */
function propReduce(layer, callback, memo) {
  propEach(layer, function(prop) {
    memo = callback(memo, prop);
  });
  return memo;
}
module.exports.propReduce = propReduce;

},{}],43:[function(require,module,exports){
/**
 * Combines a {@link FeatureCollection} of {@link Point}, {@link LineString}, or {@link Polygon} features into {@link MultiPoint}, {@link MultiLineString}, or {@link MultiPolygon} features.
 *
 * @module turf/combine
 * @category misc
 * @param {FeatureCollection} fc a FeatureCollection of any type
 * @return {FeatureCollection} a FeatureCollection of corresponding type to input
 * @example
 * var fc = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [19.026432, 47.49134]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [19.074497, 47.509548]
 *       }
 *     }
 *   ]
 * };
 *
 * var combined = turf.combine(fc);
 *
 * //=combined
 */

module.exports = function(fc) {
  var type = fc.features[0].geometry.type;
  var geometries = fc.features.map(function(f) {
    return f.geometry;
  });

  switch (type) {
    case 'Point':
      return {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiPoint',
          coordinates: pluckCoods(geometries)
        }
      };
    case 'LineString':
      return {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiLineString',
          coordinates: pluckCoods(geometries)
        }
      };
    case 'Polygon':
      return {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiPolygon',
          coordinates: pluckCoods(geometries)
        }
      };
    default:
      return fc;
  }
};

function pluckCoods(multi){
  return multi.map(function(geom){
    return geom.coordinates;
  });
}

},{}],44:[function(require,module,exports){
// 1. run tin on points
// 2. calculate lenth of all edges and area of all triangles
// 3. remove triangles that fail the max length test
// 4. buffer the results slightly
// 5. merge the results
var t = {};
t.tin = require('turf-tin');
t.merge = require('turf-merge');
t.distance = require('turf-distance');
t.point = require('turf-point');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and
 * returns a concave hull.
 *
 * Internally, this implements
 * a [Monotone chain algorithm](http://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain#JavaScript).
 *
 * @module turf/concave
 * @category transformation
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {number} maxEdge the size of an edge necessary for part of the
 * hull to become concave (in miles)
 * @param {String} units used for maxEdge distance (miles or kilometers)
 * @returns {Feature} a {@link Polygon} feature
 * @throws {Error} if maxEdge parameter is missing
 * @example
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.601226, 44.642643]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.591442, 44.651436]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.580799, 44.648749]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.573589, 44.641788]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.587665, 44.64533]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-63.595218, 44.64765]
 *       }
 *     }
 *   ]
 * };
 *
 * var hull = turf.concave(points, 1, 'miles');
 *
 * var resultFeatures = points.features.concat(hull);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */


module.exports = function(points, maxEdge, units) {
  if (typeof maxEdge !== 'number') throw new Error('maxEdge parameter is required');
  if (typeof units !== 'string') throw new Error('units parameter is required');

  var tinPolys = t.tin(points);
  var filteredPolys = tinPolys.features.filter(filterTriangles);
  tinPolys.features = filteredPolys;

  function filterTriangles(triangle) {
    var pt1 = t.point(triangle.geometry.coordinates[0][0]);
    var pt2 = t.point(triangle.geometry.coordinates[0][1]);
    var pt3 = t.point(triangle.geometry.coordinates[0][2]);
    var dist1 = t.distance(pt1, pt2, units);
    var dist2 = t.distance(pt2, pt3, units);
    var dist3 = t.distance(pt1, pt3, units);
    return (dist1 <= maxEdge && dist2 <= maxEdge && dist3 <= maxEdge);
  }

  return t.merge(tinPolys);
};

},{"turf-distance":79,"turf-merge":112,"turf-point":121,"turf-tin":137}],45:[function(require,module,exports){
var each = require('turf-meta').coordEach,
    convexHull = require('convex-hull'),
    polygon = require('turf-polygon');

/**
 * Takes any {@link GeoJSON} object and returns a
 * [convex hull](http://en.wikipedia.org/wiki/Convex_hull) polygon.
 *
 * Internally this uses
 * the [convex-hull](https://github.com/mikolalysenko/convex-hull) module that
 * implements a [monotone chain hull](http://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain).
 *
 * @module turf/convex
 * @category transformation
 * @param {GeoJSON} input any GeoJSON object
 * @returns {Feature} a {@link Polygon} feature
 * @example
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.195312, 43.755225]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.404052, 43.8424511]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.579833, 43.659924]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.360107, 43.516688]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.14038, 43.588348]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [10.195312, 43.755225]
 *       }
 *     }
 *   ]
 * };
 *
 * var hull = turf.convex(points);
 *
 * var resultFeatures = points.features.concat(hull);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(fc) {
  var points = [];
  each(fc, function(coord) { points.push(coord); });
  var hull = convexHull(points);
  var ring = [];
  for (var i = 0; i < hull.length; i++) {
      ring.push(points[hull[i][0]]);
  }
  ring.push(points[hull[hull.length - 1][1]]);
  return polygon([ring]);
};

},{"convex-hull":46,"turf-meta":74,"turf-polygon":122}],46:[function(require,module,exports){
"use strict"

var convexHull1d = require('./lib/ch1d')
var convexHull2d = require('./lib/ch2d')
var convexHullnd = require('./lib/chnd')

module.exports = convexHull

function convexHull(points) {
  var n = points.length
  if(n === 0) {
    return []
  } else if(n === 1) {
    return [[0]]
  }
  var d = points[0].length
  if(d === 0) {
    return []
  } else if(d === 1) {
    return convexHull1d(points)
  } else if(d === 2) {
    return convexHull2d(points)
  }
  return convexHullnd(points, d)
}
},{"./lib/ch1d":47,"./lib/ch2d":48,"./lib/chnd":49}],47:[function(require,module,exports){
"use strict"

module.exports = convexHull1d

function convexHull1d(points) {
  var lo = 0
  var hi = 0
  for(var i=1; i<points.length; ++i) {
    if(points[i][0] < points[lo][0]) {
      lo = i
    }
    if(points[i][0] > points[hi][0]) {
      hi = i
    }
  }
  if(lo < hi) {
    return [[lo], [hi]]
  } else if(lo > hi) {
    return [[hi], [lo]]
  } else {
    return [[lo]]
  }
}
},{}],48:[function(require,module,exports){
'use strict'

module.exports = convexHull2D

var monotoneHull = require('monotone-convex-hull-2d')

function convexHull2D(points) {
  var hull = monotoneHull(points)
  var h = hull.length
  if(h <= 2) {
    return []
  }
  var edges = new Array(h)
  var a = hull[h-1]
  for(var i=0; i<h; ++i) {
    var b = hull[i]
    edges[i] = [a,b]
    a = b
  }
  return edges
}

},{"monotone-convex-hull-2d":67}],49:[function(require,module,exports){
'use strict'

module.exports = convexHullnD

var ich = require('incremental-convex-hull')
var aff = require('affine-hull')

function permute(points, front) {
  var n = points.length
  var npoints = new Array(n)
  for(var i=0; i<front.length; ++i) {
    npoints[i] = points[front[i]]
  }
  var ptr = front.length
  for(var i=0; i<n; ++i) {
    if(front.indexOf(i) < 0) {
      npoints[ptr++] = points[i]
    }
  }
  return npoints
}

function invPermute(cells, front) {
  var nc = cells.length
  var nf = front.length
  for(var i=0; i<nc; ++i) {
    var c = cells[i]
    for(var j=0; j<c.length; ++j) {
      var x = c[j]
      if(x < nf) {
        c[j] = front[x]
      } else {
        x = x - nf
        for(var k=0; k<nf; ++k) {
          if(x >= front[k]) {
            x += 1
          }
        }
        c[j] = x
      }
    }
  }
  return cells
}

function convexHullnD(points, d) {
  try {
    return ich(points, true)
  } catch(e) {
    //If point set is degenerate, try to find a basis and rerun it
    var ah = aff(points)
    if(ah.length <= d) {
      //No basis, no try
      return []
    }
    var npoints = permute(points, ah)
    var nhull   = ich(npoints, true)
    return invPermute(nhull, ah)
  }
}
},{"affine-hull":50,"incremental-convex-hull":57}],50:[function(require,module,exports){
'use strict'

module.exports = affineHull

var orient = require('robust-orientation')

function linearlyIndependent(points, d) {
  var nhull = new Array(d+1)
  for(var i=0; i<points.length; ++i) {
    nhull[i] = points[i]
  }
  for(var i=0; i<=points.length; ++i) {
    for(var j=points.length; j<=d; ++j) {
      var x = new Array(d)
      for(var k=0; k<d; ++k) {
        x[k] = Math.pow(j+1-i, k)
      }
      nhull[j] = x
    }
    var o = orient.apply(void 0, nhull)
    if(o) {
      return true
    }
  }
  return false
}

function affineHull(points) {
  var n = points.length
  if(n === 0) {
    return []
  }
  if(n === 1) {
    return [0]
  }
  var d = points[0].length
  var frame = [ points[0] ]
  var index = [ 0 ]
  for(var i=1; i<n; ++i) {
    frame.push(points[i])
    if(!linearlyIndependent(frame, d)) {
      frame.pop()
      continue
    }
    index.push(i)
    if(index.length === d+1) {
      return index
    }
  }
  return index
}
},{"robust-orientation":56}],51:[function(require,module,exports){
"use strict"

module.exports = fastTwoSum

function fastTwoSum(a, b, result) {
	var x = a + b
	var bv = x - a
	var av = x - bv
	var br = b - bv
	var ar = a - av
	if(result) {
		result[0] = ar + br
		result[1] = x
		return result
	}
	return [ar+br, x]
}
},{}],52:[function(require,module,exports){
"use strict"

var twoProduct = require("two-product")
var twoSum = require("two-sum")

module.exports = scaleLinearExpansion

function scaleLinearExpansion(e, scale) {
  var n = e.length
  if(n === 1) {
    var ts = twoProduct(e[0], scale)
    if(ts[0]) {
      return ts
    }
    return [ ts[1] ]
  }
  var g = new Array(2 * n)
  var q = [0.1, 0.1]
  var t = [0.1, 0.1]
  var count = 0
  twoProduct(e[0], scale, q)
  if(q[0]) {
    g[count++] = q[0]
  }
  for(var i=1; i<n; ++i) {
    twoProduct(e[i], scale, t)
    var pq = q[1]
    twoSum(pq, t[0], q)
    if(q[0]) {
      g[count++] = q[0]
    }
    var a = t[1]
    var b = q[1]
    var x = a + b
    var bv = x - a
    var y = b - bv
    q[1] = x
    if(y) {
      g[count++] = y
    }
  }
  if(q[1]) {
    g[count++] = q[1]
  }
  if(count === 0) {
    g[count++] = 0.0
  }
  g.length = count
  return g
}
},{"two-product":55,"two-sum":51}],53:[function(require,module,exports){
"use strict"

module.exports = robustSubtract

//Easy case: Add two scalars
function scalarScalar(a, b) {
  var x = a + b
  var bv = x - a
  var av = x - bv
  var br = b - bv
  var ar = a - av
  var y = ar + br
  if(y) {
    return [y, x]
  }
  return [x]
}

function robustSubtract(e, f) {
  var ne = e.length|0
  var nf = f.length|0
  if(ne === 1 && nf === 1) {
    return scalarScalar(e[0], -f[0])
  }
  var n = ne + nf
  var g = new Array(n)
  var count = 0
  var eptr = 0
  var fptr = 0
  var abs = Math.abs
  var ei = e[eptr]
  var ea = abs(ei)
  var fi = -f[fptr]
  var fa = abs(fi)
  var a, b
  if(ea < fa) {
    b = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    b = fi
    fptr += 1
    if(fptr < nf) {
      fi = -f[fptr]
      fa = abs(fi)
    }
  }
  if((eptr < ne && ea < fa) || (fptr >= nf)) {
    a = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    a = fi
    fptr += 1
    if(fptr < nf) {
      fi = -f[fptr]
      fa = abs(fi)
    }
  }
  var x = a + b
  var bv = x - a
  var y = b - bv
  var q0 = y
  var q1 = x
  var _x, _bv, _av, _br, _ar
  while(eptr < ne && fptr < nf) {
    if(ea < fa) {
      a = ei
      eptr += 1
      if(eptr < ne) {
        ei = e[eptr]
        ea = abs(ei)
      }
    } else {
      a = fi
      fptr += 1
      if(fptr < nf) {
        fi = -f[fptr]
        fa = abs(fi)
      }
    }
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
  }
  while(eptr < ne) {
    a = ei
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
    }
  }
  while(fptr < nf) {
    a = fi
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    } 
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    fptr += 1
    if(fptr < nf) {
      fi = -f[fptr]
    }
  }
  if(q0) {
    g[count++] = q0
  }
  if(q1) {
    g[count++] = q1
  }
  if(!count) {
    g[count++] = 0.0  
  }
  g.length = count
  return g
}
},{}],54:[function(require,module,exports){
"use strict"

module.exports = linearExpansionSum

//Easy case: Add two scalars
function scalarScalar(a, b) {
  var x = a + b
  var bv = x - a
  var av = x - bv
  var br = b - bv
  var ar = a - av
  var y = ar + br
  if(y) {
    return [y, x]
  }
  return [x]
}

function linearExpansionSum(e, f) {
  var ne = e.length|0
  var nf = f.length|0
  if(ne === 1 && nf === 1) {
    return scalarScalar(e[0], f[0])
  }
  var n = ne + nf
  var g = new Array(n)
  var count = 0
  var eptr = 0
  var fptr = 0
  var abs = Math.abs
  var ei = e[eptr]
  var ea = abs(ei)
  var fi = f[fptr]
  var fa = abs(fi)
  var a, b
  if(ea < fa) {
    b = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    b = fi
    fptr += 1
    if(fptr < nf) {
      fi = f[fptr]
      fa = abs(fi)
    }
  }
  if((eptr < ne && ea < fa) || (fptr >= nf)) {
    a = ei
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
      ea = abs(ei)
    }
  } else {
    a = fi
    fptr += 1
    if(fptr < nf) {
      fi = f[fptr]
      fa = abs(fi)
    }
  }
  var x = a + b
  var bv = x - a
  var y = b - bv
  var q0 = y
  var q1 = x
  var _x, _bv, _av, _br, _ar
  while(eptr < ne && fptr < nf) {
    if(ea < fa) {
      a = ei
      eptr += 1
      if(eptr < ne) {
        ei = e[eptr]
        ea = abs(ei)
      }
    } else {
      a = fi
      fptr += 1
      if(fptr < nf) {
        fi = f[fptr]
        fa = abs(fi)
      }
    }
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
  }
  while(eptr < ne) {
    a = ei
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    }
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    eptr += 1
    if(eptr < ne) {
      ei = e[eptr]
    }
  }
  while(fptr < nf) {
    a = fi
    b = q0
    x = a + b
    bv = x - a
    y = b - bv
    if(y) {
      g[count++] = y
    } 
    _x = q1 + x
    _bv = _x - q1
    _av = _x - _bv
    _br = x - _bv
    _ar = q1 - _av
    q0 = _ar + _br
    q1 = _x
    fptr += 1
    if(fptr < nf) {
      fi = f[fptr]
    }
  }
  if(q0) {
    g[count++] = q0
  }
  if(q1) {
    g[count++] = q1
  }
  if(!count) {
    g[count++] = 0.0  
  }
  g.length = count
  return g
}
},{}],55:[function(require,module,exports){
"use strict"

module.exports = twoProduct

var SPLITTER = +(Math.pow(2, 27) + 1.0)

function twoProduct(a, b, result) {
  var x = a * b

  var c = SPLITTER * a
  var abig = c - a
  var ahi = c - abig
  var alo = a - ahi

  var d = SPLITTER * b
  var bbig = d - b
  var bhi = d - bbig
  var blo = b - bhi

  var err1 = x - (ahi * bhi)
  var err2 = err1 - (alo * bhi)
  var err3 = err2 - (ahi * blo)

  var y = alo * blo - err3

  if(result) {
    result[0] = y
    result[1] = x
    return result
  }

  return [ y, x ]
}
},{}],56:[function(require,module,exports){
"use strict"

var twoProduct = require("two-product")
var robustSum = require("robust-sum")
var robustScale = require("robust-scale")
var robustSubtract = require("robust-subtract")

var NUM_EXPAND = 5

var EPSILON     = 1.1102230246251565e-16
var ERRBOUND3   = (3.0 + 16.0 * EPSILON) * EPSILON
var ERRBOUND4   = (7.0 + 56.0 * EPSILON) * EPSILON

function cofactor(m, c) {
  var result = new Array(m.length-1)
  for(var i=1; i<m.length; ++i) {
    var r = result[i-1] = new Array(m.length-1)
    for(var j=0,k=0; j<m.length; ++j) {
      if(j === c) {
        continue
      }
      r[k++] = m[i][j]
    }
  }
  return result
}

function matrix(n) {
  var result = new Array(n)
  for(var i=0; i<n; ++i) {
    result[i] = new Array(n)
    for(var j=0; j<n; ++j) {
      result[i][j] = ["m", j, "[", (n-i-1), "]"].join("")
    }
  }
  return result
}

function sign(n) {
  if(n & 1) {
    return "-"
  }
  return ""
}

function generateSum(expr) {
  if(expr.length === 1) {
    return expr[0]
  } else if(expr.length === 2) {
    return ["sum(", expr[0], ",", expr[1], ")"].join("")
  } else {
    var m = expr.length>>1
    return ["sum(", generateSum(expr.slice(0, m)), ",", generateSum(expr.slice(m)), ")"].join("")
  }
}

function determinant(m) {
  if(m.length === 2) {
    return [["sum(prod(", m[0][0], ",", m[1][1], "),prod(-", m[0][1], ",", m[1][0], "))"].join("")]
  } else {
    var expr = []
    for(var i=0; i<m.length; ++i) {
      expr.push(["scale(", generateSum(determinant(cofactor(m, i))), ",", sign(i), m[0][i], ")"].join(""))
    }
    return expr
  }
}

function orientation(n) {
  var pos = []
  var neg = []
  var m = matrix(n)
  var args = []
  for(var i=0; i<n; ++i) {
    if((i&1)===0) {
      pos.push.apply(pos, determinant(cofactor(m, i)))
    } else {
      neg.push.apply(neg, determinant(cofactor(m, i)))
    }
    args.push("m" + i)
  }
  var posExpr = generateSum(pos)
  var negExpr = generateSum(neg)
  var funcName = "orientation" + n + "Exact"
  var code = ["function ", funcName, "(", args.join(), "){var p=", posExpr, ",n=", negExpr, ",d=sub(p,n);\
return d[d.length-1];};return ", funcName].join("")
  var proc = new Function("sum", "prod", "scale", "sub", code)
  return proc(robustSum, twoProduct, robustScale, robustSubtract)
}

var orientation3Exact = orientation(3)
var orientation4Exact = orientation(4)

var CACHED = [
  function orientation0() { return 0 },
  function orientation1() { return 0 },
  function orientation2(a, b) { 
    return b[0] - a[0]
  },
  function orientation3(a, b, c) {
    var l = (a[1] - c[1]) * (b[0] - c[0])
    var r = (a[0] - c[0]) * (b[1] - c[1])
    var det = l - r
    var s
    if(l > 0) {
      if(r <= 0) {
        return det
      } else {
        s = l + r
      }
    } else if(l < 0) {
      if(r >= 0) {
        return det
      } else {
        s = -(l + r)
      }
    } else {
      return det
    }
    var tol = ERRBOUND3 * s
    if(det >= tol || det <= -tol) {
      return det
    }
    return orientation3Exact(a, b, c)
  },
  function orientation4(a,b,c,d) {
    var adx = a[0] - d[0]
    var bdx = b[0] - d[0]
    var cdx = c[0] - d[0]
    var ady = a[1] - d[1]
    var bdy = b[1] - d[1]
    var cdy = c[1] - d[1]
    var adz = a[2] - d[2]
    var bdz = b[2] - d[2]
    var cdz = c[2] - d[2]
    var bdxcdy = bdx * cdy
    var cdxbdy = cdx * bdy
    var cdxady = cdx * ady
    var adxcdy = adx * cdy
    var adxbdy = adx * bdy
    var bdxady = bdx * ady
    var det = adz * (bdxcdy - cdxbdy) 
            + bdz * (cdxady - adxcdy)
            + cdz * (adxbdy - bdxady)
    var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz)
                  + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz)
                  + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz)
    var tol = ERRBOUND4 * permanent
    if ((det > tol) || (-det > tol)) {
      return det
    }
    return orientation4Exact(a,b,c,d)
  }
]

function slowOrient(args) {
  var proc = CACHED[args.length]
  if(!proc) {
    proc = CACHED[args.length] = orientation(args.length)
  }
  return proc.apply(undefined, args)
}

function generateOrientationProc() {
  while(CACHED.length <= NUM_EXPAND) {
    CACHED.push(orientation(CACHED.length))
  }
  var args = []
  var procArgs = ["slow"]
  for(var i=0; i<=NUM_EXPAND; ++i) {
    args.push("a" + i)
    procArgs.push("o" + i)
  }
  var code = [
    "function getOrientation(", args.join(), "){switch(arguments.length){case 0:case 1:return 0;"
  ]
  for(var i=2; i<=NUM_EXPAND; ++i) {
    code.push("case ", i, ":return o", i, "(", args.slice(0, i).join(), ");")
  }
  code.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation")
  procArgs.push(code.join(""))

  var proc = Function.apply(undefined, procArgs)
  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED))
  for(var i=0; i<=NUM_EXPAND; ++i) {
    module.exports[i] = CACHED[i]
  }
}

generateOrientationProc()
},{"robust-scale":52,"robust-subtract":53,"robust-sum":54,"two-product":55}],57:[function(require,module,exports){
"use strict"

//High level idea:
// 1. Use Clarkson's incremental construction to find convex hull
// 2. Point location in triangulation by jump and walk

module.exports = incrementalConvexHull

var orient = require("robust-orientation")
var compareCell = require("simplicial-complex").compareCells

function compareInt(a, b) {
  return a - b
}

function Simplex(vertices, adjacent, boundary) {
  this.vertices = vertices
  this.adjacent = adjacent
  this.boundary = boundary
  this.lastVisited = -1
}

Simplex.prototype.flip = function() {
  var t = this.vertices[0]
  this.vertices[0] = this.vertices[1]
  this.vertices[1] = t
  var u = this.adjacent[0]
  this.adjacent[0] = this.adjacent[1]
  this.adjacent[1] = u
}

function GlueFacet(vertices, cell, index) {
  this.vertices = vertices
  this.cell = cell
  this.index = index
}

function compareGlue(a, b) {
  return compareCell(a.vertices, b.vertices)
}

function bakeOrient(d) {
  var code = ["function orient(){var tuple=this.tuple;return test("]
  for(var i=0; i<=d; ++i) {
    if(i > 0) {
      code.push(",")
    }
    code.push("tuple[", i, "]")
  }
  code.push(")}return orient")
  var proc = new Function("test", code.join(""))
  var test = orient[d+1]
  if(!test) {
    test = orient
  }
  return proc(test)
}

var BAKED = []

function Triangulation(dimension, vertices, simplices) {
  this.dimension = dimension
  this.vertices = vertices
  this.simplices = simplices
  this.interior = simplices.filter(function(c) {
    return !c.boundary
  })

  this.tuple = new Array(dimension+1)
  for(var i=0; i<=dimension; ++i) {
    this.tuple[i] = this.vertices[i]
  }

  var o = BAKED[dimension]
  if(!o) {
    o = BAKED[dimension] = bakeOrient(dimension)
  }
  this.orient = o
}

var proto = Triangulation.prototype

//Degenerate situation where we are on boundary, but coplanar to face
proto.handleBoundaryDegeneracy = function(cell, point) {
  var d = this.dimension
  var n = this.vertices.length - 1
  var tuple = this.tuple
  var verts = this.vertices

  //Dumb solution: Just do dfs from boundary cell until we find any peak, or terminate
  var toVisit = [ cell ]
  cell.lastVisited = -n
  while(toVisit.length > 0) {
    cell = toVisit.pop()
    var cellVerts = cell.vertices
    var cellAdj = cell.adjacent
    for(var i=0; i<=d; ++i) {
      var neighbor = cellAdj[i]
      if(!neighbor.boundary || neighbor.lastVisited <= -n) {
        continue
      }
      var nv = neighbor.vertices
      for(var j=0; j<=d; ++j) {
        var vv = nv[j]
        if(vv < 0) {
          tuple[j] = point
        } else {
          tuple[j] = verts[vv]
        }
      }
      var o = this.orient()
      if(o > 0) {
        return neighbor
      }
      neighbor.lastVisited = -n
      if(o === 0) {
        toVisit.push(neighbor)
      }
    }
  }
  return null
}

proto.walk = function(point, random) {
  //Alias local properties
  var n = this.vertices.length - 1
  var d = this.dimension
  var verts = this.vertices
  var tuple = this.tuple

  //Compute initial jump cell
  var initIndex = random ? (this.interior.length * Math.random())|0 : (this.interior.length-1)
  var cell = this.interior[ initIndex ]

  //Start walking
outerLoop:
  while(!cell.boundary) {
    var cellVerts = cell.vertices
    var cellAdj = cell.adjacent

    for(var i=0; i<=d; ++i) {
      tuple[i] = verts[cellVerts[i]]
    }
    cell.lastVisited = n

    //Find farthest adjacent cell
    for(var i=0; i<=d; ++i) {
      var neighbor = cellAdj[i]
      if(neighbor.lastVisited >= n) {
        continue
      }
      var prev = tuple[i]
      tuple[i] = point
      var o = this.orient()
      tuple[i] = prev
      if(o < 0) {
        cell = neighbor
        continue outerLoop
      } else {
        if(!neighbor.boundary) {
          neighbor.lastVisited = n
        } else {
          neighbor.lastVisited = -n
        }
      }
    }
    return
  }

  return cell
}

proto.addPeaks = function(point, cell) {
  var n = this.vertices.length - 1
  var d = this.dimension
  var verts = this.vertices
  var tuple = this.tuple
  var interior = this.interior
  var simplices = this.simplices

  //Walking finished at boundary, time to add peaks
  var tovisit = [ cell ]

  //Stretch initial boundary cell into a peak
  cell.lastVisited = n
  cell.vertices[cell.vertices.indexOf(-1)] = n
  cell.boundary = false
  interior.push(cell)

  //Record a list of all new boundaries created by added peaks so we can glue them together when we are all done
  var glueFacets = []

  //Do a traversal of the boundary walking outward from starting peak
  while(tovisit.length > 0) {
    //Pop off peak and walk over adjacent cells
    var cell = tovisit.pop()
    var cellVerts = cell.vertices
    var cellAdj = cell.adjacent
    var indexOfN = cellVerts.indexOf(n)
    if(indexOfN < 0) {
      continue
    }

    for(var i=0; i<=d; ++i) {
      if(i === indexOfN) {
        continue
      }

      //For each boundary neighbor of the cell
      var neighbor = cellAdj[i]
      if(!neighbor.boundary || neighbor.lastVisited >= n) {
        continue
      }

      var nv = neighbor.vertices

      //Test if neighbor is a peak
      if(neighbor.lastVisited !== -n) {      
        //Compute orientation of p relative to each boundary peak
        var indexOfNeg1 = 0
        for(var j=0; j<=d; ++j) {
          if(nv[j] < 0) {
            indexOfNeg1 = j
            tuple[j] = point
          } else {
            tuple[j] = verts[nv[j]]
          }
        }
        var o = this.orient()

        //Test if neighbor cell is also a peak
        if(o > 0) {
          nv[indexOfNeg1] = n
          neighbor.boundary = false
          interior.push(neighbor)
          tovisit.push(neighbor)
          neighbor.lastVisited = n
          continue
        } else {
          neighbor.lastVisited = -n
        }
      }

      var na = neighbor.adjacent

      //Otherwise, replace neighbor with new face
      var vverts = cellVerts.slice()
      var vadj = cellAdj.slice()
      var ncell = new Simplex(vverts, vadj, true)
      simplices.push(ncell)

      //Connect to neighbor
      var opposite = na.indexOf(cell)
      if(opposite < 0) {
        continue
      }
      na[opposite] = ncell
      vadj[indexOfN] = neighbor

      //Connect to cell
      vverts[i] = -1
      vadj[i] = cell
      cellAdj[i] = ncell

      //Flip facet
      ncell.flip()

      //Add to glue list
      for(var j=0; j<=d; ++j) {
        var uu = vverts[j]
        if(uu < 0 || uu === n) {
          continue
        }
        var nface = new Array(d-1)
        var nptr = 0
        for(var k=0; k<=d; ++k) {
          var vv = vverts[k]
          if(vv < 0 || k === j) {
            continue
          }
          nface[nptr++] = vv
        }
        glueFacets.push(new GlueFacet(nface, ncell, j))
      }
    }
  }

  //Glue boundary facets together
  glueFacets.sort(compareGlue)

  for(var i=0; i+1<glueFacets.length; i+=2) {
    var a = glueFacets[i]
    var b = glueFacets[i+1]
    var ai = a.index
    var bi = b.index
    if(ai < 0 || bi < 0) {
      continue
    }
    a.cell.adjacent[a.index] = b.cell
    b.cell.adjacent[b.index] = a.cell
  }
}

proto.insert = function(point, random) {
  //Add point
  var verts = this.vertices
  verts.push(point)

  var cell = this.walk(point, random)
  if(!cell) {
    return
  }

  //Alias local properties
  var d = this.dimension
  var tuple = this.tuple

  //Degenerate case: If point is coplanar to cell, then walk until we find a non-degenerate boundary
  for(var i=0; i<=d; ++i) {
    var vv = cell.vertices[i]
    if(vv < 0) {
      tuple[i] = point
    } else {
      tuple[i] = verts[vv]
    }
  }
  var o = this.orient(tuple)
  if(o < 0) {
    return
  } else if(o === 0) {
    cell = this.handleBoundaryDegeneracy(cell, point)
    if(!cell) {
      return
    }
  }

  //Add peaks
  this.addPeaks(point, cell)
}

//Extract all boundary cells
proto.boundary = function() {
  var d = this.dimension
  var boundary = []
  var cells = this.simplices
  var nc = cells.length
  for(var i=0; i<nc; ++i) {
    var c = cells[i]
    if(c.boundary) {
      var bcell = new Array(d)
      var cv = c.vertices
      var ptr = 0
      var parity = 0
      for(var j=0; j<=d; ++j) {
        if(cv[j] >= 0) {
          bcell[ptr++] = cv[j]
        } else {
          parity = j&1
        }
      }
      if(parity === (d&1)) {
        var t = bcell[0]
        bcell[0] = bcell[1]
        bcell[1] = t
      }
      boundary.push(bcell)
    }
  }
  return boundary
}

function incrementalConvexHull(points, randomSearch) {
  var n = points.length
  if(n === 0) {
    throw new Error("Must have at least d+1 points")
  }
  var d = points[0].length
  if(n <= d) {
    throw new Error("Must input at least d+1 points")
  }

  //FIXME: This could be degenerate, but need to select d+1 non-coplanar points to bootstrap process
  var initialSimplex = points.slice(0, d+1)

  //Make sure initial simplex is positively oriented
  var o = orient.apply(void 0, initialSimplex)
  if(o === 0) {
    throw new Error("Input not in general position")
  }
  var initialCoords = new Array(d+1)
  for(var i=0; i<=d; ++i) {
    initialCoords[i] = i
  }
  if(o < 0) {
    initialCoords[0] = 1
    initialCoords[1] = 0
  }

  //Create initial topological index, glue pointers together (kind of messy)
  var initialCell = new Simplex(initialCoords, new Array(d+1), false)
  var boundary = initialCell.adjacent
  var list = new Array(d+2)
  for(var i=0; i<=d; ++i) {
    var verts = initialCoords.slice()
    for(var j=0; j<=d; ++j) {
      if(j === i) {
        verts[j] = -1
      }
    }
    var t = verts[0]
    verts[0] = verts[1]
    verts[1] = t
    var cell = new Simplex(verts, new Array(d+1), true)
    boundary[i] = cell
    list[i] = cell
  }
  list[d+1] = initialCell
  for(var i=0; i<=d; ++i) {
    var verts = boundary[i].vertices
    var adj = boundary[i].adjacent
    for(var j=0; j<=d; ++j) {
      var v = verts[j]
      if(v < 0) {
        adj[j] = initialCell
        continue
      }
      for(var k=0; k<=d; ++k) {
        if(boundary[k].vertices.indexOf(v) < 0) {
          adj[j] = boundary[k]
        }
      }
    }
  }

  //Initialize triangles
  var triangles = new Triangulation(d, initialSimplex, list)

  //Insert remaining points
  var useRandom = !!randomSearch
  for(var i=d+1; i<n; ++i) {
    triangles.insert(points[i], useRandom)
  }
  
  //Extract boundary cells
  return triangles.boundary()
}
},{"robust-orientation":63,"simplicial-complex":66}],58:[function(require,module,exports){
arguments[4][51][0].apply(exports,arguments)
},{"dup":51}],59:[function(require,module,exports){
arguments[4][52][0].apply(exports,arguments)
},{"dup":52,"two-product":62,"two-sum":58}],60:[function(require,module,exports){
arguments[4][53][0].apply(exports,arguments)
},{"dup":53}],61:[function(require,module,exports){
arguments[4][54][0].apply(exports,arguments)
},{"dup":54}],62:[function(require,module,exports){
arguments[4][55][0].apply(exports,arguments)
},{"dup":55}],63:[function(require,module,exports){
arguments[4][56][0].apply(exports,arguments)
},{"dup":56,"robust-scale":59,"robust-subtract":60,"robust-sum":61,"two-product":62}],64:[function(require,module,exports){
/**
 * Bit twiddling hacks for JavaScript.
 *
 * Author: Mikola Lysenko
 *
 * Ported from Stanford bit twiddling hack library:
 *    http://graphics.stanford.edu/~seander/bithacks.html
 */

"use strict"; "use restrict";

//Number of bits in an integer
var INT_BITS = 32;

//Constants
exports.INT_BITS  = INT_BITS;
exports.INT_MAX   =  0x7fffffff;
exports.INT_MIN   = -1<<(INT_BITS-1);

//Returns -1, 0, +1 depending on sign of x
exports.sign = function(v) {
  return (v > 0) - (v < 0);
}

//Computes absolute value of integer
exports.abs = function(v) {
  var mask = v >> (INT_BITS-1);
  return (v ^ mask) - mask;
}

//Computes minimum of integers x and y
exports.min = function(x, y) {
  return y ^ ((x ^ y) & -(x < y));
}

//Computes maximum of integers x and y
exports.max = function(x, y) {
  return x ^ ((x ^ y) & -(x < y));
}

//Checks if a number is a power of two
exports.isPow2 = function(v) {
  return !(v & (v-1)) && (!!v);
}

//Computes log base 2 of v
exports.log2 = function(v) {
  var r, shift;
  r =     (v > 0xFFFF) << 4; v >>>= r;
  shift = (v > 0xFF  ) << 3; v >>>= shift; r |= shift;
  shift = (v > 0xF   ) << 2; v >>>= shift; r |= shift;
  shift = (v > 0x3   ) << 1; v >>>= shift; r |= shift;
  return r | (v >> 1);
}

//Computes log base 10 of v
exports.log10 = function(v) {
  return  (v >= 1000000000) ? 9 : (v >= 100000000) ? 8 : (v >= 10000000) ? 7 :
          (v >= 1000000) ? 6 : (v >= 100000) ? 5 : (v >= 10000) ? 4 :
          (v >= 1000) ? 3 : (v >= 100) ? 2 : (v >= 10) ? 1 : 0;
}

//Counts number of bits
exports.popCount = function(v) {
  v = v - ((v >>> 1) & 0x55555555);
  v = (v & 0x33333333) + ((v >>> 2) & 0x33333333);
  return ((v + (v >>> 4) & 0xF0F0F0F) * 0x1010101) >>> 24;
}

//Counts number of trailing zeros
function countTrailingZeros(v) {
  var c = 32;
  v &= -v;
  if (v) c--;
  if (v & 0x0000FFFF) c -= 16;
  if (v & 0x00FF00FF) c -= 8;
  if (v & 0x0F0F0F0F) c -= 4;
  if (v & 0x33333333) c -= 2;
  if (v & 0x55555555) c -= 1;
  return c;
}
exports.countTrailingZeros = countTrailingZeros;

//Rounds to next power of 2
exports.nextPow2 = function(v) {
  v += v === 0;
  --v;
  v |= v >>> 1;
  v |= v >>> 2;
  v |= v >>> 4;
  v |= v >>> 8;
  v |= v >>> 16;
  return v + 1;
}

//Rounds down to previous power of 2
exports.prevPow2 = function(v) {
  v |= v >>> 1;
  v |= v >>> 2;
  v |= v >>> 4;
  v |= v >>> 8;
  v |= v >>> 16;
  return v - (v>>>1);
}

//Computes parity of word
exports.parity = function(v) {
  v ^= v >>> 16;
  v ^= v >>> 8;
  v ^= v >>> 4;
  v &= 0xf;
  return (0x6996 >>> v) & 1;
}

var REVERSE_TABLE = new Array(256);

(function(tab) {
  for(var i=0; i<256; ++i) {
    var v = i, r = i, s = 7;
    for (v >>>= 1; v; v >>>= 1) {
      r <<= 1;
      r |= v & 1;
      --s;
    }
    tab[i] = (r << s) & 0xff;
  }
})(REVERSE_TABLE);

//Reverse bits in a 32 bit word
exports.reverse = function(v) {
  return  (REVERSE_TABLE[ v         & 0xff] << 24) |
          (REVERSE_TABLE[(v >>> 8)  & 0xff] << 16) |
          (REVERSE_TABLE[(v >>> 16) & 0xff] << 8)  |
           REVERSE_TABLE[(v >>> 24) & 0xff];
}

//Interleave bits of 2 coordinates with 16 bits.  Useful for fast quadtree codes
exports.interleave2 = function(x, y) {
  x &= 0xFFFF;
  x = (x | (x << 8)) & 0x00FF00FF;
  x = (x | (x << 4)) & 0x0F0F0F0F;
  x = (x | (x << 2)) & 0x33333333;
  x = (x | (x << 1)) & 0x55555555;

  y &= 0xFFFF;
  y = (y | (y << 8)) & 0x00FF00FF;
  y = (y | (y << 4)) & 0x0F0F0F0F;
  y = (y | (y << 2)) & 0x33333333;
  y = (y | (y << 1)) & 0x55555555;

  return x | (y << 1);
}

//Extracts the nth interleaved component
exports.deinterleave2 = function(v, n) {
  v = (v >>> n) & 0x55555555;
  v = (v | (v >>> 1))  & 0x33333333;
  v = (v | (v >>> 2))  & 0x0F0F0F0F;
  v = (v | (v >>> 4))  & 0x00FF00FF;
  v = (v | (v >>> 16)) & 0x000FFFF;
  return (v << 16) >> 16;
}


//Interleave bits of 3 coordinates, each with 10 bits.  Useful for fast octree codes
exports.interleave3 = function(x, y, z) {
  x &= 0x3FF;
  x  = (x | (x<<16)) & 4278190335;
  x  = (x | (x<<8))  & 251719695;
  x  = (x | (x<<4))  & 3272356035;
  x  = (x | (x<<2))  & 1227133513;

  y &= 0x3FF;
  y  = (y | (y<<16)) & 4278190335;
  y  = (y | (y<<8))  & 251719695;
  y  = (y | (y<<4))  & 3272356035;
  y  = (y | (y<<2))  & 1227133513;
  x |= (y << 1);
  
  z &= 0x3FF;
  z  = (z | (z<<16)) & 4278190335;
  z  = (z | (z<<8))  & 251719695;
  z  = (z | (z<<4))  & 3272356035;
  z  = (z | (z<<2))  & 1227133513;
  
  return x | (z << 2);
}

//Extracts nth interleaved component of a 3-tuple
exports.deinterleave3 = function(v, n) {
  v = (v >>> n)       & 1227133513;
  v = (v | (v>>>2))   & 3272356035;
  v = (v | (v>>>4))   & 251719695;
  v = (v | (v>>>8))   & 4278190335;
  v = (v | (v>>>16))  & 0x3FF;
  return (v<<22)>>22;
}

//Computes next combination in colexicographic order (this is mistakenly called nextPermutation on the bit twiddling hacks page)
exports.nextCombination = function(v) {
  var t = v | (v - 1);
  return (t + 1) | (((~t & -~t) - 1) >>> (countTrailingZeros(v) + 1));
}


},{}],65:[function(require,module,exports){
"use strict"; "use restrict";

module.exports = UnionFind;

function UnionFind(count) {
  this.roots = new Array(count);
  this.ranks = new Array(count);
  
  for(var i=0; i<count; ++i) {
    this.roots[i] = i;
    this.ranks[i] = 0;
  }
}

var proto = UnionFind.prototype

Object.defineProperty(proto, "length", {
  "get": function() {
    return this.roots.length
  }
})

proto.makeSet = function() {
  var n = this.roots.length;
  this.roots.push(n);
  this.ranks.push(0);
  return n;
}

proto.find = function(x) {
  var x0 = x
  var roots = this.roots;
  while(roots[x] !== x) {
    x = roots[x]
  }
  while(roots[x0] !== x) {
    var y = roots[x0]
    roots[x0] = x
    x0 = y
  }
  return x;
}

proto.link = function(x, y) {
  var xr = this.find(x)
    , yr = this.find(y);
  if(xr === yr) {
    return;
  }
  var ranks = this.ranks
    , roots = this.roots
    , xd    = ranks[xr]
    , yd    = ranks[yr];
  if(xd < yd) {
    roots[xr] = yr;
  } else if(yd < xd) {
    roots[yr] = xr;
  } else {
    roots[yr] = xr;
    ++ranks[xr];
  }
}
},{}],66:[function(require,module,exports){
"use strict"; "use restrict";

var bits      = require("bit-twiddle")
  , UnionFind = require("union-find")

//Returns the dimension of a cell complex
function dimension(cells) {
  var d = 0
    , max = Math.max
  for(var i=0, il=cells.length; i<il; ++i) {
    d = max(d, cells[i].length)
  }
  return d-1
}
exports.dimension = dimension

//Counts the number of vertices in faces
function countVertices(cells) {
  var vc = -1
    , max = Math.max
  for(var i=0, il=cells.length; i<il; ++i) {
    var c = cells[i]
    for(var j=0, jl=c.length; j<jl; ++j) {
      vc = max(vc, c[j])
    }
  }
  return vc+1
}
exports.countVertices = countVertices

//Returns a deep copy of cells
function cloneCells(cells) {
  var ncells = new Array(cells.length)
  for(var i=0, il=cells.length; i<il; ++i) {
    ncells[i] = cells[i].slice(0)
  }
  return ncells
}
exports.cloneCells = cloneCells

//Ranks a pair of cells up to permutation
function compareCells(a, b) {
  var n = a.length
    , t = a.length - b.length
    , min = Math.min
  if(t) {
    return t
  }
  switch(n) {
    case 0:
      return 0;
    case 1:
      return a[0] - b[0];
    case 2:
      var d = a[0]+a[1]-b[0]-b[1]
      if(d) {
        return d
      }
      return min(a[0],a[1]) - min(b[0],b[1])
    case 3:
      var l1 = a[0]+a[1]
        , m1 = b[0]+b[1]
      d = l1+a[2] - (m1+b[2])
      if(d) {
        return d
      }
      var l0 = min(a[0], a[1])
        , m0 = min(b[0], b[1])
        , d  = min(l0, a[2]) - min(m0, b[2])
      if(d) {
        return d
      }
      return min(l0+a[2], l1) - min(m0+b[2], m1)
    
    //TODO: Maybe optimize n=4 as well?
    
    default:
      var as = a.slice(0)
      as.sort()
      var bs = b.slice(0)
      bs.sort()
      for(var i=0; i<n; ++i) {
        t = as[i] - bs[i]
        if(t) {
          return t
        }
      }
      return 0
  }
}
exports.compareCells = compareCells

function compareZipped(a, b) {
  return compareCells(a[0], b[0])
}

//Puts a cell complex into normal order for the purposes of findCell queries
function normalize(cells, attr) {
  if(attr) {
    var len = cells.length
    var zipped = new Array(len)
    for(var i=0; i<len; ++i) {
      zipped[i] = [cells[i], attr[i]]
    }
    zipped.sort(compareZipped)
    for(var i=0; i<len; ++i) {
      cells[i] = zipped[i][0]
      attr[i] = zipped[i][1]
    }
    return cells
  } else {
    cells.sort(compareCells)
    return cells
  }
}
exports.normalize = normalize

//Removes all duplicate cells in the complex
function unique(cells) {
  if(cells.length === 0) {
    return []
  }
  var ptr = 1
    , len = cells.length
  for(var i=1; i<len; ++i) {
    var a = cells[i]
    if(compareCells(a, cells[i-1])) {
      if(i === ptr) {
        ptr++
        continue
      }
      cells[ptr++] = a
    }
  }
  cells.length = ptr
  return cells
}
exports.unique = unique;

//Finds a cell in a normalized cell complex
function findCell(cells, c) {
  var lo = 0
    , hi = cells.length-1
    , r  = -1
  while (lo <= hi) {
    var mid = (lo + hi) >> 1
      , s   = compareCells(cells[mid], c)
    if(s <= 0) {
      if(s === 0) {
        r = mid
      }
      lo = mid + 1
    } else if(s > 0) {
      hi = mid - 1
    }
  }
  return r
}
exports.findCell = findCell;

//Builds an index for an n-cell.  This is more general than dual, but less efficient
function incidence(from_cells, to_cells) {
  var index = new Array(from_cells.length)
  for(var i=0, il=index.length; i<il; ++i) {
    index[i] = []
  }
  var b = []
  for(var i=0, n=to_cells.length; i<n; ++i) {
    var c = to_cells[i]
    var cl = c.length
    for(var k=1, kn=(1<<cl); k<kn; ++k) {
      b.length = bits.popCount(k)
      var l = 0
      for(var j=0; j<cl; ++j) {
        if(k & (1<<j)) {
          b[l++] = c[j]
        }
      }
      var idx=findCell(from_cells, b)
      if(idx < 0) {
        continue
      }
      while(true) {
        index[idx++].push(i)
        if(idx >= from_cells.length || compareCells(from_cells[idx], b) !== 0) {
          break
        }
      }
    }
  }
  return index
}
exports.incidence = incidence

//Computes the dual of the mesh.  This is basically an optimized version of buildIndex for the situation where from_cells is just the list of vertices
function dual(cells, vertex_count) {
  if(!vertex_count) {
    return incidence(unique(skeleton(cells, 0)), cells, 0)
  }
  var res = new Array(vertex_count)
  for(var i=0; i<vertex_count; ++i) {
    res[i] = []
  }
  for(var i=0, len=cells.length; i<len; ++i) {
    var c = cells[i]
    for(var j=0, cl=c.length; j<cl; ++j) {
      res[c[j]].push(i)
    }
  }
  return res
}
exports.dual = dual

//Enumerates all cells in the complex
function explode(cells) {
  var result = []
  for(var i=0, il=cells.length; i<il; ++i) {
    var c = cells[i]
      , cl = c.length|0
    for(var j=1, jl=(1<<cl); j<jl; ++j) {
      var b = []
      for(var k=0; k<cl; ++k) {
        if((j >>> k) & 1) {
          b.push(c[k])
        }
      }
      result.push(b)
    }
  }
  return normalize(result)
}
exports.explode = explode

//Enumerates all of the n-cells of a cell complex
function skeleton(cells, n) {
  if(n < 0) {
    return []
  }
  var result = []
    , k0     = (1<<(n+1))-1
  for(var i=0; i<cells.length; ++i) {
    var c = cells[i]
    for(var k=k0; k<(1<<c.length); k=bits.nextCombination(k)) {
      var b = new Array(n+1)
        , l = 0
      for(var j=0; j<c.length; ++j) {
        if(k & (1<<j)) {
          b[l++] = c[j]
        }
      }
      result.push(b)
    }
  }
  return normalize(result)
}
exports.skeleton = skeleton;

//Computes the boundary of all cells, does not remove duplicates
function boundary(cells) {
  var res = []
  for(var i=0,il=cells.length; i<il; ++i) {
    var c = cells[i]
    for(var j=0,cl=c.length; j<cl; ++j) {
      var b = new Array(c.length-1)
      for(var k=0, l=0; k<cl; ++k) {
        if(k !== j) {
          b[l++] = c[k]
        }
      }
      res.push(b)
    }
  }
  return normalize(res)
}
exports.boundary = boundary;

//Computes connected components for a dense cell complex
function connectedComponents_dense(cells, vertex_count) {
  var labels = new UnionFind(vertex_count)
  for(var i=0; i<cells.length; ++i) {
    var c = cells[i]
    for(var j=0; j<c.length; ++j) {
      for(var k=j+1; k<c.length; ++k) {
        labels.link(c[j], c[k])
      }
    }
  }
  var components = []
    , component_labels = labels.ranks
  for(var i=0; i<component_labels.length; ++i) {
    component_labels[i] = -1
  }
  for(var i=0; i<cells.length; ++i) {
    var l = labels.find(cells[i][0])
    if(component_labels[l] < 0) {
      component_labels[l] = components.length
      components.push([cells[i].slice(0)])
    } else {
      components[component_labels[l]].push(cells[i].slice(0))
    }
  }
  return components
}

//Computes connected components for a sparse graph
function connectedComponents_sparse(cells) {
  var vertices  = unique(normalize(skeleton(cells, 0)))
    , labels    = new UnionFind(vertices.length)
  for(var i=0; i<cells.length; ++i) {
    var c = cells[i]
    for(var j=0; j<c.length; ++j) {
      var vj = findCell(vertices, [c[j]])
      for(var k=j+1; k<c.length; ++k) {
        labels.link(vj, findCell(vertices, [c[k]]))
      }
    }
  }
  var components        = []
    , component_labels  = labels.ranks
  for(var i=0; i<component_labels.length; ++i) {
    component_labels[i] = -1
  }
  for(var i=0; i<cells.length; ++i) {
    var l = labels.find(findCell(vertices, [cells[i][0]]));
    if(component_labels[l] < 0) {
      component_labels[l] = components.length
      components.push([cells[i].slice(0)])
    } else {
      components[component_labels[l]].push(cells[i].slice(0))
    }
  }
  return components
}

//Computes connected components for a cell complex
function connectedComponents(cells, vertex_count) {
  if(vertex_count) {
    return connectedComponents_dense(cells, vertex_count)
  }
  return connectedComponents_sparse(cells)
}
exports.connectedComponents = connectedComponents

},{"bit-twiddle":64,"union-find":65}],67:[function(require,module,exports){
'use strict'

module.exports = monotoneConvexHull2D

var orient = require('robust-orientation')[3]

function monotoneConvexHull2D(points) {
  var n = points.length

  if(n < 3) {
    var result = new Array(n)
    for(var i=0; i<n; ++i) {
      result[i] = i
    }

    if(n === 2 &&
       points[0][0] === points[1][0] &&
       points[0][1] === points[1][1]) {
      return [0]
    }

    return result
  }

  //Sort point indices along x-axis
  var sorted = new Array(n)
  for(var i=0; i<n; ++i) {
    sorted[i] = i
  }
  sorted.sort(function(a,b) {
    var d = points[a][0]-points[b][0]
    if(d) {
      return d
    }
    return points[a][1] - points[b][1]
  })

  //Construct upper and lower hulls
  var lower = [sorted[0], sorted[1]]
  var upper = [sorted[0], sorted[1]]

  for(var i=2; i<n; ++i) {
    var idx = sorted[i]
    var p   = points[idx]

    //Insert into lower list
    var m = lower.length
    while(m > 1 && orient(
        points[lower[m-2]], 
        points[lower[m-1]], 
        p) <= 0) {
      m -= 1
      lower.pop()
    }
    lower.push(idx)

    //Insert into upper list
    m = upper.length
    while(m > 1 && orient(
        points[upper[m-2]], 
        points[upper[m-1]], 
        p) >= 0) {
      m -= 1
      upper.pop()
    }
    upper.push(idx)
  }

  //Merge lists together
  var result = new Array(upper.length + lower.length - 2)
  var ptr    = 0
  for(var i=0, nl=lower.length; i<nl; ++i) {
    result[ptr++] = lower[i]
  }
  for(var j=upper.length-2; j>0; --j) {
    result[ptr++] = upper[j]
  }

  //Return result
  return result
}
},{"robust-orientation":73}],68:[function(require,module,exports){
arguments[4][51][0].apply(exports,arguments)
},{"dup":51}],69:[function(require,module,exports){
arguments[4][52][0].apply(exports,arguments)
},{"dup":52,"two-product":72,"two-sum":68}],70:[function(require,module,exports){
arguments[4][53][0].apply(exports,arguments)
},{"dup":53}],71:[function(require,module,exports){
arguments[4][54][0].apply(exports,arguments)
},{"dup":54}],72:[function(require,module,exports){
arguments[4][55][0].apply(exports,arguments)
},{"dup":55}],73:[function(require,module,exports){
arguments[4][56][0].apply(exports,arguments)
},{"dup":56,"robust-scale":69,"robust-subtract":70,"robust-sum":71,"two-product":72}],74:[function(require,module,exports){
arguments[4][42][0].apply(exports,arguments)
},{"dup":42}],75:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a {@link FeatureCollection} of {@link Polygon} features and calculates the number of points that fall within the set of polygons.
 *
 * @module turf/count
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {String} countField a field to append to the attributes of the Polygon features representing Point counts
 * @return {FeatureCollection} a FeatureCollection of Polygon features with `countField` appended
 * @example
* var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-112.072391,46.586591],
 *           [-112.072391,46.61761],
 *           [-112.028102,46.61761],
 *           [-112.028102,46.586591],
 *           [-112.072391,46.586591]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-112.023983,46.570426],
 *           [-112.023983,46.615016],
 *           [-111.966133,46.615016],
 *           [-111.966133,46.570426],
 *           [-112.023983,46.570426]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-112.0372, 46.608058]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-112.045955, 46.596264]
 *       }
 *     }
 *   ]
 * };
 *
 * var counted = turf.count(polygons, points, 'pt_count');
 *
 * var resultFeatures = points.features.concat(counted.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(polyFC, ptFC, outField, done){
  for (var i = 0; i < polyFC.features.length; i++) {
    var poly = polyFC.features[i];
    if(!poly.properties) poly.properties = {};
    var values = 0;
    for (var j = 0; j < ptFC.features.length; j++) {
      var pt = ptFC.features[j];
      if (inside(pt, poly)) {
        values++;
      }
    }
    poly.properties[outField] = values;
  }

  return polyFC;
};

},{"turf-inside":95}],76:[function(require,module,exports){
//http://en.wikipedia.org/wiki/Haversine_formula
//http://www.movable-type.co.uk/scripts/latlong.html
var point = require('turf-point');

/**
 * Takes a {@link Point} feature and calculates the location of a destination point given a distance in degrees, radians, miles, or kilometers; and bearing in degrees. This uses the [Haversine formula](http://en.wikipedia.org/wiki/Haversine_formula) to account for global curvature.
 *
 * @module turf/destination
 * @category measurement
 * @param {Point} start a Point feature at the starting point
 * @param {Number} distance distance from the starting point
 * @param {Number} bearing ranging from -180 to 180
 * @param {String} units miles, kilometers, degrees, or radians
 * @returns {Point} a Point feature at the destination
 * @example
 * var point = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.343, 39.984]
 *   }
 * };
 * var distance = 50;
 * var bearing = 90;
 * var units = 'miles';
 *
 * var destination = turf.destination(point, distance, bearing, units);
 * destination.properties['marker-color'] = '#f00';
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [point, destination]
 * };
 *
 * //=result
 */
module.exports = function (point1, distance, bearing, units) {
    var coordinates1 = point1.geometry.coordinates;
    var longitude1 = toRad(coordinates1[0]);
    var latitude1 = toRad(coordinates1[1]);
    var bearing_rad = toRad(bearing);

    var R = 0;
    switch (units) {
    case 'miles':
        R = 3960;
        break
    case 'kilometers':
        R = 6373;
        break
    case 'degrees':
        R = 57.2957795;
        break
    case 'radians':
        R = 1;
        break
    }

    var latitude2 = Math.asin(Math.sin(latitude1) * Math.cos(distance / R) +
        Math.cos(latitude1) * Math.sin(distance / R) * Math.cos(bearing_rad));
    var longitude2 = longitude1 + Math.atan2(Math.sin(bearing_rad) * Math.sin(distance / R) * Math.cos(latitude1),
        Math.cos(distance / R) - Math.sin(latitude1) * Math.sin(latitude2));

    return point([toDeg(longitude2), toDeg(latitude2)]);
};

function toRad(degree) {
    return degree * Math.PI / 180;
}

function toDeg(rad) {
    return rad * 180 / Math.PI;
}

},{"turf-point":121}],77:[function(require,module,exports){
var ss = require('simple-statistics');
var inside = require('turf-inside');

/**
 * Calculates the standard deviation value of a field for points within a set of polygons.
 *
 * @module turf/deviation
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {String} inField the field in `points` from which to aggregate
 * @param {String} outField the field to append to `polygons` representing deviation
 * @return {FeatureCollection} a FeatureCollection of Polygon features with appended field representing deviation
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.807159, 30.270335],
 *           [-97.807159, 30.369913],
 *           [-97.612838, 30.369913],
 *           [-97.612838, 30.270335],
 *           [-97.807159, 30.270335]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.825698, 30.175405],
 *           [-97.825698, 30.264404],
 *           [-97.630691, 30.264404],
 *           [-97.630691, 30.175405],
 *           [-97.825698, 30.175405]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 500
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.709655, 30.311245]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 400
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.766647, 30.345028]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.765274, 30.294646]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 500
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.753601, 30.216355]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.667083, 30.208047]
 *       }
 *     }
 *   ]
 * };
 *
 * var inField = "population";
 * var outField = "pop_deviation";
 *
 * var deviated = turf.deviation(
 *   polygons, points, inField, outField);
 *
 * var resultFeatures = points.features.concat(
 *   deviated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(polyFC, ptFC, inField, outField, done){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = ss.standard_deviation(values);
  })

  return polyFC;
}

},{"simple-statistics":78,"turf-inside":95}],78:[function(require,module,exports){
/* global module */
// # simple-statistics
//
// A simple, literate statistics system. The code below uses the
// [Javascript module pattern](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth),
// eventually assigning `simple-statistics` to `ss` in browsers or the
// `exports` object for node.js
(function() {
    var ss = {};

    if (typeof module !== 'undefined') {
        // Assign the `ss` object to exports, so that you can require
        // it in [node.js](http://nodejs.org/)
        module.exports = ss;
    } else {
        // Otherwise, in a browser, we assign `ss` to the window object,
        // so you can simply refer to it as `ss`.
        this.ss = ss;
    }

    // # [Linear Regression](http://en.wikipedia.org/wiki/Linear_regression)
    //
    // [Simple linear regression](http://en.wikipedia.org/wiki/Simple_linear_regression)
    // is a simple way to find a fitted line
    // between a set of coordinates.
    function linear_regression() {
        var linreg = {},
            data = [];

        // Assign data to the model. Data is assumed to be an array.
        linreg.data = function(x) {
            if (!arguments.length) return data;
            data = x.slice();
            return linreg;
        };

        // Calculate the slope and y-intercept of the regression line
        // by calculating the least sum of squares
        linreg.mb = function() {
            var m, b;

            // Store data length in a local variable to reduce
            // repeated object property lookups
            var data_length = data.length;

            //if there's only one point, arbitrarily choose a slope of 0
            //and a y-intercept of whatever the y of the initial point is
            if (data_length === 1) {
                m = 0;
                b = data[0][1];
            } else {
                // Initialize our sums and scope the `m` and `b`
                // variables that define the line.
                var sum_x = 0, sum_y = 0,
                    sum_xx = 0, sum_xy = 0;

                // Use local variables to grab point values
                // with minimal object property lookups
                var point, x, y;

                // Gather the sum of all x values, the sum of all
                // y values, and the sum of x^2 and (x*y) for each
                // value.
                //
                // In math notation, these would be SS_x, SS_y, SS_xx, and SS_xy
                for (var i = 0; i < data_length; i++) {
                    point = data[i];
                    x = point[0];
                    y = point[1];

                    sum_x += x;
                    sum_y += y;

                    sum_xx += x * x;
                    sum_xy += x * y;
                }

                // `m` is the slope of the regression line
                m = ((data_length * sum_xy) - (sum_x * sum_y)) /
                    ((data_length * sum_xx) - (sum_x * sum_x));

                // `b` is the y-intercept of the line.
                b = (sum_y / data_length) - ((m * sum_x) / data_length);
            }

            // Return both values as an object.
            return { m: m, b: b };
        };

        // a shortcut for simply getting the slope of the regression line
        linreg.m = function() {
            return linreg.mb().m;
        };

        // a shortcut for simply getting the y-intercept of the regression
        // line.
        linreg.b = function() {
            return linreg.mb().b;
        };

        // ## Fitting The Regression Line
        //
        // This is called after `.data()` and returns the
        // equation `y = f(x)` which gives the position
        // of the regression line at each point in `x`.
        linreg.line = function() {

            // Get the slope, `m`, and y-intercept, `b`, of the line.
            var mb = linreg.mb(),
                m = mb.m,
                b = mb.b;

            // Return a function that computes a `y` value for each
            // x value it is given, based on the values of `b` and `a`
            // that we just computed.
            return function(x) {
                return b + (m * x);
            };
        };

        return linreg;
    }

    // # [R Squared](http://en.wikipedia.org/wiki/Coefficient_of_determination)
    //
    // The r-squared value of data compared with a function `f`
    // is the sum of the squared differences between the prediction
    // and the actual value.
    function r_squared(data, f) {
        if (data.length < 2) return 1;

        // Compute the average y value for the actual
        // data set in order to compute the
        // _total sum of squares_
        var sum = 0, average;
        for (var i = 0; i < data.length; i++) {
            sum += data[i][1];
        }
        average = sum / data.length;

        // Compute the total sum of squares - the
        // squared difference between each point
        // and the average of all points.
        var sum_of_squares = 0;
        for (var j = 0; j < data.length; j++) {
            sum_of_squares += Math.pow(average - data[j][1], 2);
        }

        // Finally estimate the error: the squared
        // difference between the estimate and the actual data
        // value at each point.
        var err = 0;
        for (var k = 0; k < data.length; k++) {
            err += Math.pow(data[k][1] - f(data[k][0]), 2);
        }

        // As the error grows larger, its ratio to the
        // sum of squares increases and the r squared
        // value grows lower.
        return 1 - (err / sum_of_squares);
    }


    // # [Bayesian Classifier](http://en.wikipedia.org/wiki/Naive_Bayes_classifier)
    //
    // This is a naïve bayesian classifier that takes
    // singly-nested objects.
    function bayesian() {
        // The `bayes_model` object is what will be exposed
        // by this closure, with all of its extended methods, and will
        // have access to all scope variables, like `total_count`.
        var bayes_model = {},
            // The number of items that are currently
            // classified in the model
            total_count = 0,
            // Every item classified in the model
            data = {};

        // ## Train
        // Train the classifier with a new item, which has a single
        // dimension of Javascript literal keys and values.
        bayes_model.train = function(item, category) {
            // If the data object doesn't have any values
            // for this category, create a new object for it.
            if (!data[category]) data[category] = {};

            // Iterate through each key in the item.
            for (var k in item) {
                var v = item[k];
                // Initialize the nested object `data[category][k][item[k]]`
                // with an object of keys that equal 0.
                if (data[category][k] === undefined) data[category][k] = {};
                if (data[category][k][v] === undefined) data[category][k][v] = 0;

                // And increment the key for this key/value combination.
                data[category][k][item[k]]++;
            }
            // Increment the number of items classified
            total_count++;
        };

        // ## Score
        // Generate a score of how well this item matches all
        // possible categories based on its attributes
        bayes_model.score = function(item) {
            // Initialize an empty array of odds per category.
            var odds = {}, category;
            // Iterate through each key in the item,
            // then iterate through each category that has been used
            // in previous calls to `.train()`
            for (var k in item) {
                var v = item[k];
                for (category in data) {
                    // Create an empty object for storing key - value combinations
                    // for this category.
                    if (odds[category] === undefined) odds[category] = {};

                    // If this item doesn't even have a property, it counts for nothing,
                    // but if it does have the property that we're looking for from
                    // the item to categorize, it counts based on how popular it is
                    // versus the whole population.
                    if (data[category][k]) {
                        odds[category][k + '_' + v] = (data[category][k][v] || 0) / total_count;
                    } else {
                        odds[category][k + '_' + v] = 0;
                    }
                }
            }

            // Set up a new object that will contain sums of these odds by category
            var odds_sums = {};

            for (category in odds) {
                // Tally all of the odds for each category-combination pair -
                // the non-existence of a category does not add anything to the
                // score.
                for (var combination in odds[category]) {
                    if (odds_sums[category] === undefined) odds_sums[category] = 0;
                    odds_sums[category] += odds[category][combination];
                }
            }

            return odds_sums;
        };

        // Return the completed model.
        return bayes_model;
    }

    // # sum
    //
    // is simply the result of adding all numbers
    // together, starting from zero.
    //
    // This runs on `O(n)`, linear time in respect to the array
    function sum(x) {
        var value = 0;
        for (var i = 0; i < x.length; i++) {
            value += x[i];
        }
        return value;
    }

    // # mean
    //
    // is the sum over the number of values
    //
    // This runs on `O(n)`, linear time in respect to the array
    function mean(x) {
        // The mean of no numbers is null
        if (x.length === 0) return null;

        return sum(x) / x.length;
    }

    // # geometric mean
    //
    // a mean function that is more useful for numbers in different
    // ranges.
    //
    // this is the nth root of the input numbers multiplied by each other
    //
    // This runs on `O(n)`, linear time in respect to the array
    function geometric_mean(x) {
        // The mean of no numbers is null
        if (x.length === 0) return null;

        // the starting value.
        var value = 1;

        for (var i = 0; i < x.length; i++) {
            // the geometric mean is only valid for positive numbers
            if (x[i] <= 0) return null;

            // repeatedly multiply the value by each number
            value *= x[i];
        }

        return Math.pow(value, 1 / x.length);
    }


    // # harmonic mean
    //
    // a mean function typically used to find the average of rates
    //
    // this is the reciprocal of the arithmetic mean of the reciprocals
    // of the input numbers
    //
    // This runs on `O(n)`, linear time in respect to the array
    function harmonic_mean(x) {
        // The mean of no numbers is null
        if (x.length === 0) return null;

        var reciprocal_sum = 0;

        for (var i = 0; i < x.length; i++) {
            // the harmonic mean is only valid for positive numbers
            if (x[i] <= 0) return null;

            reciprocal_sum += 1 / x[i];
        }

        // divide n by the the reciprocal sum
        return x.length / reciprocal_sum;
    }

    // root mean square (RMS)
    //
    // a mean function used as a measure of the magnitude of a set
    // of numbers, regardless of their sign
    //
    // this is the square root of the mean of the squares of the 
    // input numbers
    //
    // This runs on `O(n)`, linear time in respect to the array
    function root_mean_square(x) {
        if (x.length === 0) return null;

        var sum_of_squares = 0;
        for (var i = 0; i < x.length; i++) {
            sum_of_squares += Math.pow(x[i], 2);
        }

        return Math.sqrt(sum_of_squares / x.length);
    }

    // # min
    //
    // This is simply the minimum number in the set.
    //
    // This runs on `O(n)`, linear time in respect to the array
    function min(x) {
        var value;
        for (var i = 0; i < x.length; i++) {
            // On the first iteration of this loop, min is
            // undefined and is thus made the minimum element in the array
            if (x[i] < value || value === undefined) value = x[i];
        }
        return value;
    }

    // # max
    //
    // This is simply the maximum number in the set.
    //
    // This runs on `O(n)`, linear time in respect to the array
    function max(x) {
        var value;
        for (var i = 0; i < x.length; i++) {
            // On the first iteration of this loop, max is
            // undefined and is thus made the maximum element in the array
            if (x[i] > value || value === undefined) value = x[i];
        }
        return value;
    }

    // # [variance](http://en.wikipedia.org/wiki/Variance)
    //
    // is the sum of squared deviations from the mean
    //
    // depends on `mean()`
    function variance(x) {
        // The variance of no numbers is null
        if (x.length === 0) return null;

        var mean_value = mean(x),
            deviations = [];

        // Make a list of squared deviations from the mean.
        for (var i = 0; i < x.length; i++) {
            deviations.push(Math.pow(x[i] - mean_value, 2));
        }

        // Find the mean value of that list
        return mean(deviations);
    }

    // # [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)
    //
    // is just the square root of the variance.
    //
    // depends on `variance()`
    function standard_deviation(x) {
        // The standard deviation of no numbers is null
        if (x.length === 0) return null;

        return Math.sqrt(variance(x));
    }

    // The sum of deviations to the Nth power.
    // When n=2 it's the sum of squared deviations.
    // When n=3 it's the sum of cubed deviations.
    //
    // depends on `mean()`
    function sum_nth_power_deviations(x, n) {
        var mean_value = mean(x),
            sum = 0;

        for (var i = 0; i < x.length; i++) {
            sum += Math.pow(x[i] - mean_value, n);
        }

        return sum;
    }

    // # [variance](http://en.wikipedia.org/wiki/Variance)
    //
    // is the sum of squared deviations from the mean
    //
    // depends on `sum_nth_power_deviations`
    function sample_variance(x) {
        // The variance of no numbers is null
        if (x.length <= 1) return null;

        var sum_squared_deviations_value = sum_nth_power_deviations(x, 2);

        // Find the mean value of that list
        return sum_squared_deviations_value / (x.length - 1);
    }

    // # [standard deviation](http://en.wikipedia.org/wiki/Standard_deviation)
    //
    // is just the square root of the variance.
    //
    // depends on `sample_variance()`
    function sample_standard_deviation(x) {
        // The standard deviation of no numbers is null
        if (x.length <= 1) return null;

        return Math.sqrt(sample_variance(x));
    }

    // # [covariance](http://en.wikipedia.org/wiki/Covariance)
    //
    // sample covariance of two datasets:
    // how much do the two datasets move together?
    // x and y are two datasets, represented as arrays of numbers.
    //
    // depends on `mean()`
    function sample_covariance(x, y) {

        // The two datasets must have the same length which must be more than 1
        if (x.length <= 1 || x.length != y.length){
            return null;
        }

        // determine the mean of each dataset so that we can judge each
        // value of the dataset fairly as the difference from the mean. this
        // way, if one dataset is [1, 2, 3] and [2, 3, 4], their covariance
        // does not suffer because of the difference in absolute values
        var xmean = mean(x),
            ymean = mean(y),
            sum = 0;

        // for each pair of values, the covariance increases when their
        // difference from the mean is associated - if both are well above
        // or if both are well below
        // the mean, the covariance increases significantly.
        for (var i = 0; i < x.length; i++){
            sum += (x[i] - xmean) * (y[i] - ymean);
        }

        // the covariance is weighted by the length of the datasets.
        return sum / (x.length - 1);
    }

    // # [correlation](http://en.wikipedia.org/wiki/Correlation_and_dependence)
    //
    // Gets a measure of how correlated two datasets are, between -1 and 1
    //
    // depends on `sample_standard_deviation()` and `sample_covariance()`
    function sample_correlation(x, y) {
        var cov = sample_covariance(x, y),
            xstd = sample_standard_deviation(x),
            ystd = sample_standard_deviation(y);

        if (cov === null || xstd === null || ystd === null) {
            return null;
        }

        return cov / xstd / ystd;
    }

    // # [median](http://en.wikipedia.org/wiki/Median)
    //
    // The middle number of a list. This is often a good indicator of 'the middle'
    // when there are outliers that skew the `mean()` value.
    function median(x) {
        // The median of an empty list is null
        if (x.length === 0) return null;

        // Sorting the array makes it easy to find the center, but
        // use `.slice()` to ensure the original array `x` is not modified
        var sorted = x.slice().sort(function (a, b) { return a - b; });

        // If the length of the list is odd, it's the central number
        if (sorted.length % 2 === 1) {
            return sorted[(sorted.length - 1) / 2];
        // Otherwise, the median is the average of the two numbers
        // at the center of the list
        } else {
            var a = sorted[(sorted.length / 2) - 1];
            var b = sorted[(sorted.length / 2)];
            return (a + b) / 2;
        }
    }

    // # [mode](http://bit.ly/W5K4Yt)
    //
    // The mode is the number that appears in a list the highest number of times.
    // There can be multiple modes in a list: in the event of a tie, this
    // algorithm will return the most recently seen mode.
    //
    // This implementation is inspired by [science.js](https://github.com/jasondavies/science.js/blob/master/src/stats/mode.js)
    //
    // This runs on `O(n)`, linear time in respect to the array
    function mode(x) {

        // Handle edge cases:
        // The median of an empty list is null
        if (x.length === 0) return null;
        else if (x.length === 1) return x[0];

        // Sorting the array lets us iterate through it below and be sure
        // that every time we see a new number it's new and we'll never
        // see the same number twice
        var sorted = x.slice().sort(function (a, b) { return a - b; });

        // This assumes it is dealing with an array of size > 1, since size
        // 0 and 1 are handled immediately. Hence it starts at index 1 in the
        // array.
        var last = sorted[0],
            // store the mode as we find new modes
            value,
            // store how many times we've seen the mode
            max_seen = 0,
            // how many times the current candidate for the mode
            // has been seen
            seen_this = 1;

        // end at sorted.length + 1 to fix the case in which the mode is
        // the highest number that occurs in the sequence. the last iteration
        // compares sorted[i], which is undefined, to the highest number
        // in the series
        for (var i = 1; i < sorted.length + 1; i++) {
            // we're seeing a new number pass by
            if (sorted[i] !== last) {
                // the last number is the new mode since we saw it more
                // often than the old one
                if (seen_this > max_seen) {
                    max_seen = seen_this;
                    value = last;
                }
                seen_this = 1;
                last = sorted[i];
            // if this isn't a new number, it's one more occurrence of
            // the potential mode
            } else { seen_this++; }
        }
        return value;
    }

    // # [t-test](http://en.wikipedia.org/wiki/Student's_t-test)
    //
    // This is to compute a one-sample t-test, comparing the mean
    // of a sample to a known value, x.
    //
    // in this case, we're trying to determine whether the
    // population mean is equal to the value that we know, which is `x`
    // here. usually the results here are used to look up a
    // [p-value](http://en.wikipedia.org/wiki/P-value), which, for
    // a certain level of significance, will let you determine that the
    // null hypothesis can or cannot be rejected.
    //
    // Depends on `standard_deviation()` and `mean()`
    function t_test(sample, x) {
        // The mean of the sample
        var sample_mean = mean(sample);

        // The standard deviation of the sample
        var sd = standard_deviation(sample);

        // Square root the length of the sample
        var rootN = Math.sqrt(sample.length);

        // Compute the known value against the sample,
        // returning the t value
        return (sample_mean - x) / (sd / rootN);
    }

    // # [2-sample t-test](http://en.wikipedia.org/wiki/Student's_t-test)
    //
    // This is to compute two sample t-test.
    // Tests whether "mean(X)-mean(Y) = difference", (
    // in the most common case, we often have `difference == 0` to test if two samples
    // are likely to be taken from populations with the same mean value) with
    // no prior knowledge on standard deviations of both samples
    // other than the fact that they have the same standard deviation.
    //
    // Usually the results here are used to look up a
    // [p-value](http://en.wikipedia.org/wiki/P-value), which, for
    // a certain level of significance, will let you determine that the
    // null hypothesis can or cannot be rejected.
    //
    // `diff` can be omitted if it equals 0.
    //
    // [This is used to confirm or deny](http://www.monarchlab.org/Lab/Research/Stats/2SampleT.aspx)
    // a null hypothesis that the two populations that have been sampled into
    // `sample_x` and `sample_y` are equal to each other.
    //
    // Depends on `sample_variance()` and `mean()`
    function t_test_two_sample(sample_x, sample_y, difference) {
        var n = sample_x.length,
            m = sample_y.length;

        // If either sample doesn't actually have any values, we can't
        // compute this at all, so we return `null`.
        if (!n || !m) return null ;

        // default difference (mu) is zero
        if (!difference) difference = 0;

        var meanX = mean(sample_x),
            meanY = mean(sample_y);

        var weightedVariance = ((n - 1) * sample_variance(sample_x) +
            (m - 1) * sample_variance(sample_y)) / (n + m - 2);

        return (meanX - meanY - difference) /
            Math.sqrt(weightedVariance * (1 / n + 1 / m));
    }

    // # chunk
    //
    // Split an array into chunks of a specified size. This function
    // has the same behavior as [PHP's array_chunk](http://php.net/manual/en/function.array-chunk.php)
    // function, and thus will insert smaller-sized chunks at the end if
    // the input size is not divisible by the chunk size.
    //
    // `sample` is expected to be an array, and `chunkSize` a number.
    // The `sample` array can contain any kind of data.
    function chunk(sample, chunkSize) {

        // a list of result chunks, as arrays in an array
        var output = [];

        // `chunkSize` must be zero or higher - otherwise the loop below,
        // in which we call `start += chunkSize`, will loop infinitely.
        // So, we'll detect and return null in that case to indicate
        // invalid input.
        if (chunkSize <= 0) {
            return null;
        }

        // `start` is the index at which `.slice` will start selecting
        // new array elements
        for (var start = 0; start < sample.length; start += chunkSize) {

            // for each chunk, slice that part of the array and add it
            // to the output. The `.slice` function does not change
            // the original array.
            output.push(sample.slice(start, start + chunkSize));
        }
        return output;
    }

    // # shuffle_in_place
    //
    // A [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)
    // in-place - which means that it will change the order of the original
    // array by reference.
    function shuffle_in_place(sample, randomSource) {

        // a custom random number source can be provided if you want to use
        // a fixed seed or another random number generator, like
        // [random-js](https://www.npmjs.org/package/random-js)
        randomSource = randomSource || Math.random;

        // store the current length of the sample to determine
        // when no elements remain to shuffle.
        var length = sample.length;

        // temporary is used to hold an item when it is being
        // swapped between indices.
        var temporary;

        // The index to swap at each stage.
        var index;

        // While there are still items to shuffle
        while (length > 0) {
            // chose a random index within the subset of the array
            // that is not yet shuffled
            index = Math.floor(randomSource() * length--);

            // store the value that we'll move temporarily
            temporary = sample[length];

            // swap the value at `sample[length]` with `sample[index]`
            sample[length] = sample[index];
            sample[index] = temporary;
        }

        return sample;
    }

    // # shuffle
    //
    // A [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)
    // is a fast way to create a random permutation of a finite set.
    function shuffle(sample, randomSource) {
        // slice the original array so that it is not modified
        sample = sample.slice();

        // and then shuffle that shallow-copied array, in place
        return shuffle_in_place(sample.slice(), randomSource);
    }

    // # sample
    //
    // Create a [simple random sample](http://en.wikipedia.org/wiki/Simple_random_sample)
    // from a given array of `n` elements.
    function sample(array, n, randomSource) {
        // shuffle the original array using a fisher-yates shuffle
        var shuffled = shuffle(array, randomSource);

        // and then return a subset of it - the first `n` elements.
        return shuffled.slice(0, n);
    }

    // # quantile
    //
    // This is a population quantile, since we assume to know the entire
    // dataset in this library. Thus I'm trying to follow the
    // [Quantiles of a Population](http://en.wikipedia.org/wiki/Quantile#Quantiles_of_a_population)
    // algorithm from wikipedia.
    //
    // Sample is a one-dimensional array of numbers,
    // and p is either a decimal number from 0 to 1 or an array of decimal
    // numbers from 0 to 1.
    // In terms of a k/q quantile, p = k/q - it's just dealing with fractions or dealing
    // with decimal values.
    // When p is an array, the result of the function is also an array containing the appropriate
    // quantiles in input order
    function quantile(sample, p) {

        // We can't derive quantiles from an empty list
        if (sample.length === 0) return null;

        // Sort a copy of the array. We'll need a sorted array to index
        // the values in sorted order.
        var sorted = sample.slice().sort(function (a, b) { return a - b; });

        if (p.length) {
            // Initialize the result array
            var results = [];
            // For each requested quantile
            for (var i = 0; i < p.length; i++) {
                results[i] = quantile_sorted(sorted, p[i]);
            }
            return results;
        } else {
            return quantile_sorted(sorted, p);
        }
    }

    // # quantile
    //
    // This is the internal implementation of quantiles: when you know
    // that the order is sorted, you don't need to re-sort it, and the computations
    // are much faster.
    function quantile_sorted(sample, p) {
        var idx = (sample.length) * p;
        if (p < 0 || p > 1) {
            return null;
        } else if (p === 1) {
            // If p is 1, directly return the last element
            return sample[sample.length - 1];
        } else if (p === 0) {
            // If p is 0, directly return the first element
            return sample[0];
        } else if (idx % 1 !== 0) {
            // If p is not integer, return the next element in array
            return sample[Math.ceil(idx) - 1];
        } else if (sample.length % 2 === 0) {
            // If the list has even-length, we'll take the average of this number
            // and the next value, if there is one
            return (sample[idx - 1] + sample[idx]) / 2;
        } else {
            // Finally, in the simple case of an integer value
            // with an odd-length list, return the sample value at the index.
            return sample[idx];
        }
    }

    // # [Interquartile range](http://en.wikipedia.org/wiki/Interquartile_range)
    //
    // A measure of statistical dispersion, or how scattered, spread, or
    // concentrated a distribution is. It's computed as the difference between
    // the third quartile and first quartile.
    function iqr(sample) {
        // We can't derive quantiles from an empty list
        if (sample.length === 0) return null;

        // Interquartile range is the span between the upper quartile,
        // at `0.75`, and lower quartile, `0.25`
        return quantile(sample, 0.75) - quantile(sample, 0.25);
    }

    // # [Median Absolute Deviation](http://en.wikipedia.org/wiki/Median_absolute_deviation)
    //
    // The Median Absolute Deviation (MAD) is a robust measure of statistical
    // dispersion. It is more resilient to outliers than the standard deviation.
    function mad(x) {
        // The mad of nothing is null
        if (!x || x.length === 0) return null;

        var median_value = median(x),
            median_absolute_deviations = [];

        // Make a list of absolute deviations from the median
        for (var i = 0; i < x.length; i++) {
            median_absolute_deviations.push(Math.abs(x[i] - median_value));
        }

        // Find the median value of that list
        return median(median_absolute_deviations);
    }

    // ## Compute Matrices for Jenks
    //
    // Compute the matrices required for Jenks breaks. These matrices
    // can be used for any classing of data with `classes <= n_classes`
    function jenksMatrices(data, n_classes) {

        // in the original implementation, these matrices are referred to
        // as `LC` and `OP`
        //
        // * lower_class_limits (LC): optimal lower class limits
        // * variance_combinations (OP): optimal variance combinations for all classes
        var lower_class_limits = [],
            variance_combinations = [],
            // loop counters
            i, j,
            // the variance, as computed at each step in the calculation
            variance = 0;

        // Initialize and fill each matrix with zeroes
        for (i = 0; i < data.length + 1; i++) {
            var tmp1 = [], tmp2 = [];
            // despite these arrays having the same values, we need
            // to keep them separate so that changing one does not change
            // the other
            for (j = 0; j < n_classes + 1; j++) {
                tmp1.push(0);
                tmp2.push(0);
            }
            lower_class_limits.push(tmp1);
            variance_combinations.push(tmp2);
        }

        for (i = 1; i < n_classes + 1; i++) {
            lower_class_limits[1][i] = 1;
            variance_combinations[1][i] = 0;
            // in the original implementation, 9999999 is used but
            // since Javascript has `Infinity`, we use that.
            for (j = 2; j < data.length + 1; j++) {
                variance_combinations[j][i] = Infinity;
            }
        }

        for (var l = 2; l < data.length + 1; l++) {

            // `SZ` originally. this is the sum of the values seen thus
            // far when calculating variance.
            var sum = 0,
                // `ZSQ` originally. the sum of squares of values seen
                // thus far
                sum_squares = 0,
                // `WT` originally. This is the number of
                w = 0,
                // `IV` originally
                i4 = 0;

            // in several instances, you could say `Math.pow(x, 2)`
            // instead of `x * x`, but this is slower in some browsers
            // introduces an unnecessary concept.
            for (var m = 1; m < l + 1; m++) {

                // `III` originally
                var lower_class_limit = l - m + 1,
                    val = data[lower_class_limit - 1];

                // here we're estimating variance for each potential classing
                // of the data, for each potential number of classes. `w`
                // is the number of data points considered so far.
                w++;

                // increase the current sum and sum-of-squares
                sum += val;
                sum_squares += val * val;

                // the variance at this point in the sequence is the difference
                // between the sum of squares and the total x 2, over the number
                // of samples.
                variance = sum_squares - (sum * sum) / w;

                i4 = lower_class_limit - 1;

                if (i4 !== 0) {
                    for (j = 2; j < n_classes + 1; j++) {
                        // if adding this element to an existing class
                        // will increase its variance beyond the limit, break
                        // the class at this point, setting the `lower_class_limit`
                        // at this point.
                        if (variance_combinations[l][j] >=
                            (variance + variance_combinations[i4][j - 1])) {
                            lower_class_limits[l][j] = lower_class_limit;
                            variance_combinations[l][j] = variance +
                                variance_combinations[i4][j - 1];
                        }
                    }
                }
            }

            lower_class_limits[l][1] = 1;
            variance_combinations[l][1] = variance;
        }

        // return the two matrices. for just providing breaks, only
        // `lower_class_limits` is needed, but variances can be useful to
        // evaluate goodness of fit.
        return {
            lower_class_limits: lower_class_limits,
            variance_combinations: variance_combinations
        };
    }

    // ## Pull Breaks Values for Jenks
    //
    // the second part of the jenks recipe: take the calculated matrices
    // and derive an array of n breaks.
    function jenksBreaks(data, lower_class_limits, n_classes) {

        var k = data.length,
            kclass = [],
            countNum = n_classes;

        // the calculation of classes will never include the upper
        // bound, so we need to explicitly set it
        kclass[n_classes] = data[data.length - 1];

        // the lower_class_limits matrix is used as indices into itself
        // here: the `k` variable is reused in each iteration.
        while (countNum > 0) {
            kclass[countNum - 1] = data[lower_class_limits[k][countNum] - 1];
            k = lower_class_limits[k][countNum] - 1;
            countNum--;
        }

        return kclass;
    }

    // # [Jenks natural breaks optimization](http://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization)
    //
    // Implementations: [1](http://danieljlewis.org/files/2010/06/Jenks.pdf) (python),
    // [2](https://github.com/vvoovv/djeo-jenks/blob/master/main.js) (buggy),
    // [3](https://github.com/simogeo/geostats/blob/master/lib/geostats.js#L407) (works)
    //
    // Depends on `jenksBreaks()` and `jenksMatrices()`
    function jenks(data, n_classes) {

        if (n_classes > data.length) return null;

        // sort data in numerical order, since this is expected
        // by the matrices function
        data = data.slice().sort(function (a, b) { return a - b; });

        // get our basic matrices
        var matrices = jenksMatrices(data, n_classes),
            // we only need lower class limits here
            lower_class_limits = matrices.lower_class_limits;

        // extract n_classes out of the computed matrices
        return jenksBreaks(data, lower_class_limits, n_classes);

    }

    // # [Skewness](http://en.wikipedia.org/wiki/Skewness)
    //
    // A measure of the extent to which a probability distribution of a
    // real-valued random variable "leans" to one side of the mean.
    // The skewness value can be positive or negative, or even undefined.
    //
    // Implementation is based on the adjusted Fisher-Pearson standardized
    // moment coefficient, which is the version found in Excel and several
    // statistical packages including Minitab, SAS and SPSS.
    //
    // Depends on `sum_nth_power_deviations()` and `sample_standard_deviation`
    function sample_skewness(x) {
        // The skewness of less than three arguments is null
        if (x.length < 3) return null;

        var n = x.length,
            cubed_s = Math.pow(sample_standard_deviation(x), 3),
            sum_cubed_deviations = sum_nth_power_deviations(x, 3);

        return n * sum_cubed_deviations / ((n - 1) * (n - 2) * cubed_s);
    }

    // # Standard Normal Table
    // A standard normal table, also called the unit normal table or Z table,
    // is a mathematical table for the values of Φ (phi), which are the values of
    // the cumulative distribution function of the normal distribution.
    // It is used to find the probability that a statistic is observed below,
    // above, or between values on the standard normal distribution, and by
    // extension, any normal distribution.
    //
    // The probabilities are taken from http://en.wikipedia.org/wiki/Standard_normal_table
    // The table used is the cumulative, and not cumulative from 0 to mean
    // (even though the latter has 5 digits precision, instead of 4).
    var standard_normal_table = [
        /*  z      0.00    0.01    0.02    0.03    0.04    0.05    0.06    0.07    0.08    0.09 */
        /* 0.0 */
        0.5000, 0.5040, 0.5080, 0.5120, 0.5160, 0.5199, 0.5239, 0.5279, 0.5319, 0.5359,
        /* 0.1 */
        0.5398, 0.5438, 0.5478, 0.5517, 0.5557, 0.5596, 0.5636, 0.5675, 0.5714, 0.5753,
        /* 0.2 */
        0.5793, 0.5832, 0.5871, 0.5910, 0.5948, 0.5987, 0.6026, 0.6064, 0.6103, 0.6141,
        /* 0.3 */
        0.6179, 0.6217, 0.6255, 0.6293, 0.6331, 0.6368, 0.6406, 0.6443, 0.6480, 0.6517,
        /* 0.4 */
        0.6554, 0.6591, 0.6628, 0.6664, 0.6700, 0.6736, 0.6772, 0.6808, 0.6844, 0.6879,
        /* 0.5 */
        0.6915, 0.6950, 0.6985, 0.7019, 0.7054, 0.7088, 0.7123, 0.7157, 0.7190, 0.7224,
        /* 0.6 */
        0.7257, 0.7291, 0.7324, 0.7357, 0.7389, 0.7422, 0.7454, 0.7486, 0.7517, 0.7549,
        /* 0.7 */
        0.7580, 0.7611, 0.7642, 0.7673, 0.7704, 0.7734, 0.7764, 0.7794, 0.7823, 0.7852,
        /* 0.8 */
        0.7881, 0.7910, 0.7939, 0.7967, 0.7995, 0.8023, 0.8051, 0.8078, 0.8106, 0.8133,
        /* 0.9 */
        0.8159, 0.8186, 0.8212, 0.8238, 0.8264, 0.8289, 0.8315, 0.8340, 0.8365, 0.8389,
        /* 1.0 */
        0.8413, 0.8438, 0.8461, 0.8485, 0.8508, 0.8531, 0.8554, 0.8577, 0.8599, 0.8621,
        /* 1.1 */
        0.8643, 0.8665, 0.8686, 0.8708, 0.8729, 0.8749, 0.8770, 0.8790, 0.8810, 0.8830,
        /* 1.2 */
        0.8849, 0.8869, 0.8888, 0.8907, 0.8925, 0.8944, 0.8962, 0.8980, 0.8997, 0.9015,
        /* 1.3 */
        0.9032, 0.9049, 0.9066, 0.9082, 0.9099, 0.9115, 0.9131, 0.9147, 0.9162, 0.9177,
        /* 1.4 */
        0.9192, 0.9207, 0.9222, 0.9236, 0.9251, 0.9265, 0.9279, 0.9292, 0.9306, 0.9319,
        /* 1.5 */
        0.9332, 0.9345, 0.9357, 0.9370, 0.9382, 0.9394, 0.9406, 0.9418, 0.9429, 0.9441,
        /* 1.6 */
        0.9452, 0.9463, 0.9474, 0.9484, 0.9495, 0.9505, 0.9515, 0.9525, 0.9535, 0.9545,
        /* 1.7 */
        0.9554, 0.9564, 0.9573, 0.9582, 0.9591, 0.9599, 0.9608, 0.9616, 0.9625, 0.9633,
        /* 1.8 */
        0.9641, 0.9649, 0.9656, 0.9664, 0.9671, 0.9678, 0.9686, 0.9693, 0.9699, 0.9706,
        /* 1.9 */
        0.9713, 0.9719, 0.9726, 0.9732, 0.9738, 0.9744, 0.9750, 0.9756, 0.9761, 0.9767,
        /* 2.0 */
        0.9772, 0.9778, 0.9783, 0.9788, 0.9793, 0.9798, 0.9803, 0.9808, 0.9812, 0.9817,
        /* 2.1 */
        0.9821, 0.9826, 0.9830, 0.9834, 0.9838, 0.9842, 0.9846, 0.9850, 0.9854, 0.9857,
        /* 2.2 */
        0.9861, 0.9864, 0.9868, 0.9871, 0.9875, 0.9878, 0.9881, 0.9884, 0.9887, 0.9890,
        /* 2.3 */
        0.9893, 0.9896, 0.9898, 0.9901, 0.9904, 0.9906, 0.9909, 0.9911, 0.9913, 0.9916,
        /* 2.4 */
        0.9918, 0.9920, 0.9922, 0.9925, 0.9927, 0.9929, 0.9931, 0.9932, 0.9934, 0.9936,
        /* 2.5 */
        0.9938, 0.9940, 0.9941, 0.9943, 0.9945, 0.9946, 0.9948, 0.9949, 0.9951, 0.9952,
        /* 2.6 */
        0.9953, 0.9955, 0.9956, 0.9957, 0.9959, 0.9960, 0.9961, 0.9962, 0.9963, 0.9964,
        /* 2.7 */
        0.9965, 0.9966, 0.9967, 0.9968, 0.9969, 0.9970, 0.9971, 0.9972, 0.9973, 0.9974,
        /* 2.8 */
        0.9974, 0.9975, 0.9976, 0.9977, 0.9977, 0.9978, 0.9979, 0.9979, 0.9980, 0.9981,
        /* 2.9 */
        0.9981, 0.9982, 0.9982, 0.9983, 0.9984, 0.9984, 0.9985, 0.9985, 0.9986, 0.9986,
        /* 3.0 */
        0.9987, 0.9987, 0.9987, 0.9988, 0.9988, 0.9989, 0.9989, 0.9989, 0.9990, 0.9990
    ];

    // # [Gaussian error function](http://en.wikipedia.org/wiki/Error_function)
    //
    // The error_function(x/(sd * Math.sqrt(2))) is the probability that a value in a
    // normal distribution with standard deviation sd is within x of the mean.
    //
    // This function returns a numerical approximation to the exact value.
    function error_function(x) {
        var t = 1 / (1 + 0.5 * Math.abs(x));
        var tau = t * Math.exp(-Math.pow(x, 2) -
            1.26551223 +
            1.00002368 * t +
            0.37409196 * Math.pow(t, 2) +
            0.09678418 * Math.pow(t, 3) -
            0.18628806 * Math.pow(t, 4) +
            0.27886807 * Math.pow(t, 5) -
            1.13520398 * Math.pow(t, 6) +
            1.48851587 * Math.pow(t, 7) -
            0.82215223 * Math.pow(t, 8) +
            0.17087277 * Math.pow(t, 9));
        if (x >= 0) {
            return 1 - tau;
        } else {
            return tau - 1;
        }
    }

    // # [Cumulative Standard Normal Probability](http://en.wikipedia.org/wiki/Standard_normal_table)
    //
    // Since probability tables cannot be
    // printed for every normal distribution, as there are an infinite variety
    // of normal distributions, it is common practice to convert a normal to a
    // standard normal and then use the standard normal table to find probabilities.
    //
    // You can use .5 + .5 * error_function(x / Math.sqrt(2)) to calculate the probability
    // instead of looking it up in a table.
    function cumulative_std_normal_probability(z) {

        // Calculate the position of this value.
        var absZ = Math.abs(z),
            // Each row begins with a different
            // significant digit: 0.5, 0.6, 0.7, and so on. Each value in the table
            // corresponds to a range of 0.01 in the input values, so the value is
            // multiplied by 100.
            index = Math.min(Math.round(absZ * 100), standard_normal_table.length - 1);

        // The index we calculate must be in the table as a positive value,
        // but we still pay attention to whether the input is positive
        // or negative, and flip the output value as a last step.
        if (z >= 0) {
            return standard_normal_table[index];
        } else {
            // due to floating-point arithmetic, values in the table with
            // 4 significant figures can nevertheless end up as repeating
            // fractions when they're computed here.
            return +(1 - standard_normal_table[index]).toFixed(4);
        }
    }

    // # [Z-Score, or Standard Score](http://en.wikipedia.org/wiki/Standard_score)
    //
    // The standard score is the number of standard deviations an observation
    // or datum is above or below the mean. Thus, a positive standard score
    // represents a datum above the mean, while a negative standard score
    // represents a datum below the mean. It is a dimensionless quantity
    // obtained by subtracting the population mean from an individual raw
    // score and then dividing the difference by the population standard
    // deviation.
    //
    // The z-score is only defined if one knows the population parameters;
    // if one only has a sample set, then the analogous computation with
    // sample mean and sample standard deviation yields the
    // Student's t-statistic.
    function z_score(x, mean, standard_deviation) {
        return (x - mean) / standard_deviation;
    }

    // We use `ε`, epsilon, as a stopping criterion when we want to iterate
    // until we're "close enough".
    var epsilon = 0.0001;

    // # [Factorial](https://en.wikipedia.org/wiki/Factorial)
    //
    // A factorial, usually written n!, is the product of all positive
    // integers less than or equal to n. Often factorial is implemented
    // recursively, but this iterative approach is significantly faster
    // and simpler.
    function factorial(n) {

        // factorial is mathematically undefined for negative numbers
        if (n < 0 ) { return null; }

        // typically you'll expand the factorial function going down, like
        // 5! = 5 * 4 * 3 * 2 * 1. This is going in the opposite direction,
        // counting from 2 up to the number in question, and since anything
        // multiplied by 1 is itself, the loop only needs to start at 2.
        var accumulator = 1;
        for (var i = 2; i <= n; i++) {
            // for each number up to and including the number `n`, multiply
            // the accumulator my that number.
            accumulator *= i;
        }
        return accumulator;
    }

    // # Bernoulli Distribution
    //
    // The [Bernoulli distribution](http://en.wikipedia.org/wiki/Bernoulli_distribution)
    // is the probability discrete
    // distribution of a random variable which takes value 1 with success
    // probability `p` and value 0 with failure
    // probability `q` = 1 - `p`. It can be used, for example, to represent the
    // toss of a coin, where "1" is defined to mean "heads" and "0" is defined
    // to mean "tails" (or vice versa). It is
    // a special case of a Binomial Distribution
    // where `n` = 1.
    function bernoulli_distribution(p) {
        // Check that `p` is a valid probability (0 ≤ p ≤ 1)
        if (p < 0 || p > 1 ) { return null; }

        return binomial_distribution(1, p);
    }

    // # Binomial Distribution
    //
    // The [Binomial Distribution](http://en.wikipedia.org/wiki/Binomial_distribution) is the discrete probability
    // distribution of the number of successes in a sequence of n independent yes/no experiments, each of which yields
    // success with probability `probability`. Such a success/failure experiment is also called a Bernoulli experiment or
    // Bernoulli trial; when trials = 1, the Binomial Distribution is a Bernoulli Distribution.
    function binomial_distribution(trials, probability) {
        // Check that `p` is a valid probability (0 ≤ p ≤ 1),
        // that `n` is an integer, strictly positive.
        if (probability < 0 || probability > 1 ||
            trials <= 0 || trials % 1 !== 0) {
            return null;
        }

        // a [probability mass function](https://en.wikipedia.org/wiki/Probability_mass_function)
        function probability_mass(x, trials, probability) {
            return factorial(trials) /
                (factorial(x) * factorial(trials - x)) *
                (Math.pow(probability, x) * Math.pow(1 - probability, trials - x));
        }

        // We initialize `x`, the random variable, and `accumulator`, an accumulator
        // for the cumulative distribution function to 0. `distribution_functions`
        // is the object we'll return with the `probability_of_x` and the
        // `cumulative_probability_of_x`, as well as the calculated mean &
        // variance. We iterate until the `cumulative_probability_of_x` is
        // within `epsilon` of 1.0.
        var x = 0,
            cumulative_probability = 0,
            cells = {};

        // This algorithm iterates through each potential outcome,
        // until the `cumulative_probability` is very close to 1, at
        // which point we've defined the vast majority of outcomes
        do {
            cells[x] = probability_mass(x, trials, probability);
            cumulative_probability += cells[x];
            x++;
        // when the cumulative_probability is nearly 1, we've calculated
        // the useful range of this distribution
        } while (cumulative_probability < 1 - epsilon);

        return cells;
    }

    // # Poisson Distribution
    //
    // The [Poisson Distribution](http://en.wikipedia.org/wiki/Poisson_distribution)
    // is a discrete probability distribution that expresses the probability
    // of a given number of events occurring in a fixed interval of time
    // and/or space if these events occur with a known average rate and
    // independently of the time since the last event.
    //
    // The Poisson Distribution is characterized by the strictly positive
    // mean arrival or occurrence rate, `λ`.
    function poisson_distribution(lambda) {
        // Check that lambda is strictly positive
        if (lambda <= 0) { return null; }

        // our current place in the distribution
        var x = 0,
            // and we keep track of the current cumulative probability, in
            // order to know when to stop calculating chances.
            cumulative_probability = 0,
            // the calculated cells to be returned
            cells = {};

        // a [probability mass function](https://en.wikipedia.org/wiki/Probability_mass_function)
        function probability_mass(x, lambda) {
            return (Math.pow(Math.E, -lambda) * Math.pow(lambda, x)) /
                factorial(x);
        }

        // This algorithm iterates through each potential outcome,
        // until the `cumulative_probability` is very close to 1, at
        // which point we've defined the vast majority of outcomes
        do {
            cells[x] = probability_mass(x, lambda);
            cumulative_probability += cells[x];
            x++;
        // when the cumulative_probability is nearly 1, we've calculated
        // the useful range of this distribution
        } while (cumulative_probability < 1 - epsilon);

        return cells;
    }

    // # Percentage Points of the χ2 (Chi-Squared) Distribution
    // The [χ2 (Chi-Squared) Distribution](http://en.wikipedia.org/wiki/Chi-squared_distribution) is used in the common
    // chi-squared tests for goodness of fit of an observed distribution to a theoretical one, the independence of two
    // criteria of classification of qualitative data, and in confidence interval estimation for a population standard
    // deviation of a normal distribution from a sample standard deviation.
    //
    // Values from Appendix 1, Table III of William W. Hines & Douglas C. Montgomery, "Probability and Statistics in
    // Engineering and Management Science", Wiley (1980).
    var chi_squared_distribution_table = {
        1: { 0.995:  0.00, 0.99:  0.00, 0.975:  0.00, 0.95:  0.00, 0.9:  0.02, 0.5:  0.45, 0.1:  2.71, 0.05:  3.84, 0.025:  5.02, 0.01:  6.63, 0.005:  7.88 },
        2: { 0.995:  0.01, 0.99:  0.02, 0.975:  0.05, 0.95:  0.10, 0.9:  0.21, 0.5:  1.39, 0.1:  4.61, 0.05:  5.99, 0.025:  7.38, 0.01:  9.21, 0.005: 10.60 },
        3: { 0.995:  0.07, 0.99:  0.11, 0.975:  0.22, 0.95:  0.35, 0.9:  0.58, 0.5:  2.37, 0.1:  6.25, 0.05:  7.81, 0.025:  9.35, 0.01: 11.34, 0.005: 12.84 },
        4: { 0.995:  0.21, 0.99:  0.30, 0.975:  0.48, 0.95:  0.71, 0.9:  1.06, 0.5:  3.36, 0.1:  7.78, 0.05:  9.49, 0.025: 11.14, 0.01: 13.28, 0.005: 14.86 },
        5: { 0.995:  0.41, 0.99:  0.55, 0.975:  0.83, 0.95:  1.15, 0.9:  1.61, 0.5:  4.35, 0.1:  9.24, 0.05: 11.07, 0.025: 12.83, 0.01: 15.09, 0.005: 16.75 },
        6: { 0.995:  0.68, 0.99:  0.87, 0.975:  1.24, 0.95:  1.64, 0.9:  2.20, 0.5:  5.35, 0.1: 10.65, 0.05: 12.59, 0.025: 14.45, 0.01: 16.81, 0.005: 18.55 },
        7: { 0.995:  0.99, 0.99:  1.25, 0.975:  1.69, 0.95:  2.17, 0.9:  2.83, 0.5:  6.35, 0.1: 12.02, 0.05: 14.07, 0.025: 16.01, 0.01: 18.48, 0.005: 20.28 },
        8: { 0.995:  1.34, 0.99:  1.65, 0.975:  2.18, 0.95:  2.73, 0.9:  3.49, 0.5:  7.34, 0.1: 13.36, 0.05: 15.51, 0.025: 17.53, 0.01: 20.09, 0.005: 21.96 },
        9: { 0.995:  1.73, 0.99:  2.09, 0.975:  2.70, 0.95:  3.33, 0.9:  4.17, 0.5:  8.34, 0.1: 14.68, 0.05: 16.92, 0.025: 19.02, 0.01: 21.67, 0.005: 23.59 },
        10: { 0.995:  2.16, 0.99:  2.56, 0.975:  3.25, 0.95:  3.94, 0.9:  4.87, 0.5:  9.34, 0.1: 15.99, 0.05: 18.31, 0.025: 20.48, 0.01: 23.21, 0.005: 25.19 },
        11: { 0.995:  2.60, 0.99:  3.05, 0.975:  3.82, 0.95:  4.57, 0.9:  5.58, 0.5: 10.34, 0.1: 17.28, 0.05: 19.68, 0.025: 21.92, 0.01: 24.72, 0.005: 26.76 },
        12: { 0.995:  3.07, 0.99:  3.57, 0.975:  4.40, 0.95:  5.23, 0.9:  6.30, 0.5: 11.34, 0.1: 18.55, 0.05: 21.03, 0.025: 23.34, 0.01: 26.22, 0.005: 28.30 },
        13: { 0.995:  3.57, 0.99:  4.11, 0.975:  5.01, 0.95:  5.89, 0.9:  7.04, 0.5: 12.34, 0.1: 19.81, 0.05: 22.36, 0.025: 24.74, 0.01: 27.69, 0.005: 29.82 },
        14: { 0.995:  4.07, 0.99:  4.66, 0.975:  5.63, 0.95:  6.57, 0.9:  7.79, 0.5: 13.34, 0.1: 21.06, 0.05: 23.68, 0.025: 26.12, 0.01: 29.14, 0.005: 31.32 },
        15: { 0.995:  4.60, 0.99:  5.23, 0.975:  6.27, 0.95:  7.26, 0.9:  8.55, 0.5: 14.34, 0.1: 22.31, 0.05: 25.00, 0.025: 27.49, 0.01: 30.58, 0.005: 32.80 },
        16: { 0.995:  5.14, 0.99:  5.81, 0.975:  6.91, 0.95:  7.96, 0.9:  9.31, 0.5: 15.34, 0.1: 23.54, 0.05: 26.30, 0.025: 28.85, 0.01: 32.00, 0.005: 34.27 },
        17: { 0.995:  5.70, 0.99:  6.41, 0.975:  7.56, 0.95:  8.67, 0.9: 10.09, 0.5: 16.34, 0.1: 24.77, 0.05: 27.59, 0.025: 30.19, 0.01: 33.41, 0.005: 35.72 },
        18: { 0.995:  6.26, 0.99:  7.01, 0.975:  8.23, 0.95:  9.39, 0.9: 10.87, 0.5: 17.34, 0.1: 25.99, 0.05: 28.87, 0.025: 31.53, 0.01: 34.81, 0.005: 37.16 },
        19: { 0.995:  6.84, 0.99:  7.63, 0.975:  8.91, 0.95: 10.12, 0.9: 11.65, 0.5: 18.34, 0.1: 27.20, 0.05: 30.14, 0.025: 32.85, 0.01: 36.19, 0.005: 38.58 },
        20: { 0.995:  7.43, 0.99:  8.26, 0.975:  9.59, 0.95: 10.85, 0.9: 12.44, 0.5: 19.34, 0.1: 28.41, 0.05: 31.41, 0.025: 34.17, 0.01: 37.57, 0.005: 40.00 },
        21: { 0.995:  8.03, 0.99:  8.90, 0.975: 10.28, 0.95: 11.59, 0.9: 13.24, 0.5: 20.34, 0.1: 29.62, 0.05: 32.67, 0.025: 35.48, 0.01: 38.93, 0.005: 41.40 },
        22: { 0.995:  8.64, 0.99:  9.54, 0.975: 10.98, 0.95: 12.34, 0.9: 14.04, 0.5: 21.34, 0.1: 30.81, 0.05: 33.92, 0.025: 36.78, 0.01: 40.29, 0.005: 42.80 },
        23: { 0.995:  9.26, 0.99: 10.20, 0.975: 11.69, 0.95: 13.09, 0.9: 14.85, 0.5: 22.34, 0.1: 32.01, 0.05: 35.17, 0.025: 38.08, 0.01: 41.64, 0.005: 44.18 },
        24: { 0.995:  9.89, 0.99: 10.86, 0.975: 12.40, 0.95: 13.85, 0.9: 15.66, 0.5: 23.34, 0.1: 33.20, 0.05: 36.42, 0.025: 39.36, 0.01: 42.98, 0.005: 45.56 },
        25: { 0.995: 10.52, 0.99: 11.52, 0.975: 13.12, 0.95: 14.61, 0.9: 16.47, 0.5: 24.34, 0.1: 34.28, 0.05: 37.65, 0.025: 40.65, 0.01: 44.31, 0.005: 46.93 },
        26: { 0.995: 11.16, 0.99: 12.20, 0.975: 13.84, 0.95: 15.38, 0.9: 17.29, 0.5: 25.34, 0.1: 35.56, 0.05: 38.89, 0.025: 41.92, 0.01: 45.64, 0.005: 48.29 },
        27: { 0.995: 11.81, 0.99: 12.88, 0.975: 14.57, 0.95: 16.15, 0.9: 18.11, 0.5: 26.34, 0.1: 36.74, 0.05: 40.11, 0.025: 43.19, 0.01: 46.96, 0.005: 49.65 },
        28: { 0.995: 12.46, 0.99: 13.57, 0.975: 15.31, 0.95: 16.93, 0.9: 18.94, 0.5: 27.34, 0.1: 37.92, 0.05: 41.34, 0.025: 44.46, 0.01: 48.28, 0.005: 50.99 },
        29: { 0.995: 13.12, 0.99: 14.26, 0.975: 16.05, 0.95: 17.71, 0.9: 19.77, 0.5: 28.34, 0.1: 39.09, 0.05: 42.56, 0.025: 45.72, 0.01: 49.59, 0.005: 52.34 },
        30: { 0.995: 13.79, 0.99: 14.95, 0.975: 16.79, 0.95: 18.49, 0.9: 20.60, 0.5: 29.34, 0.1: 40.26, 0.05: 43.77, 0.025: 46.98, 0.01: 50.89, 0.005: 53.67 },
        40: { 0.995: 20.71, 0.99: 22.16, 0.975: 24.43, 0.95: 26.51, 0.9: 29.05, 0.5: 39.34, 0.1: 51.81, 0.05: 55.76, 0.025: 59.34, 0.01: 63.69, 0.005: 66.77 },
        50: { 0.995: 27.99, 0.99: 29.71, 0.975: 32.36, 0.95: 34.76, 0.9: 37.69, 0.5: 49.33, 0.1: 63.17, 0.05: 67.50, 0.025: 71.42, 0.01: 76.15, 0.005: 79.49 },
        60: { 0.995: 35.53, 0.99: 37.48, 0.975: 40.48, 0.95: 43.19, 0.9: 46.46, 0.5: 59.33, 0.1: 74.40, 0.05: 79.08, 0.025: 83.30, 0.01: 88.38, 0.005: 91.95 },
        70: { 0.995: 43.28, 0.99: 45.44, 0.975: 48.76, 0.95: 51.74, 0.9: 55.33, 0.5: 69.33, 0.1: 85.53, 0.05: 90.53, 0.025: 95.02, 0.01: 100.42, 0.005: 104.22 },
        80: { 0.995: 51.17, 0.99: 53.54, 0.975: 57.15, 0.95: 60.39, 0.9: 64.28, 0.5: 79.33, 0.1: 96.58, 0.05: 101.88, 0.025: 106.63, 0.01: 112.33, 0.005: 116.32 },
        90: { 0.995: 59.20, 0.99: 61.75, 0.975: 65.65, 0.95: 69.13, 0.9: 73.29, 0.5: 89.33, 0.1: 107.57, 0.05: 113.14, 0.025: 118.14, 0.01: 124.12, 0.005: 128.30 },
        100: { 0.995: 67.33, 0.99: 70.06, 0.975: 74.22, 0.95: 77.93, 0.9: 82.36, 0.5: 99.33, 0.1: 118.50, 0.05: 124.34, 0.025: 129.56, 0.01: 135.81, 0.005: 140.17 }
    };

    // # χ2 (Chi-Squared) Goodness-of-Fit Test
    //
    // The [χ2 (Chi-Squared) Goodness-of-Fit Test](http://en.wikipedia.org/wiki/Goodness_of_fit#Pearson.27s_chi-squared_test)
    // uses a measure of goodness of fit which is the sum of differences between observed and expected outcome frequencies
    // (that is, counts of observations), each squared and divided by the number of observations expected given the
    // hypothesized distribution. The resulting χ2 statistic, `chi_squared`, can be compared to the chi-squared distribution
    // to determine the goodness of fit. In order to determine the degrees of freedom of the chi-squared distribution, one
    // takes the total number of observed frequencies and subtracts the number of estimated parameters. The test statistic
    // follows, approximately, a chi-square distribution with (k − c) degrees of freedom where `k` is the number of non-empty
    // cells and `c` is the number of estimated parameters for the distribution.
    function chi_squared_goodness_of_fit(data, distribution_type, significance) {
        // Estimate from the sample data, a weighted mean.
        var input_mean = mean(data),
            // Calculated value of the χ2 statistic.
            chi_squared = 0,
            // Degrees of freedom, calculated as (number of class intervals -
            // number of hypothesized distribution parameters estimated - 1)
            degrees_of_freedom,
            // Number of hypothesized distribution parameters estimated, expected to be supplied in the distribution test.
            // Lose one degree of freedom for estimating `lambda` from the sample data.
            c = 1,
            // The hypothesized distribution.
            // Generate the hypothesized distribution.
            hypothesized_distribution = distribution_type(input_mean),
            observed_frequencies = [],
            expected_frequencies = [],
            k;

        // Create an array holding a histogram from the sample data, of
        // the form `{ value: numberOfOcurrences }`
        for (var i = 0; i < data.length; i++) {
            if (observed_frequencies[data[i]] === undefined) {
                observed_frequencies[data[i]] = 0;
            }
            observed_frequencies[data[i]]++;
        }

        // The histogram we created might be sparse - there might be gaps
        // between values. So we iterate through the histogram, making
        // sure that instead of undefined, gaps have 0 values.
        for (i = 0; i < observed_frequencies.length; i++) {
            if (observed_frequencies[i] === undefined) {
                observed_frequencies[i] = 0;
            }
        }

        // Create an array holding a histogram of expected data given the
        // sample size and hypothesized distribution.
        for (k in hypothesized_distribution) {
            if (k in observed_frequencies) {
                expected_frequencies[k] = hypothesized_distribution[k] * data.length;
            }
        }

        // Working backward through the expected frequencies, collapse classes
        // if less than three observations are expected for a class.
        // This transformation is applied to the observed frequencies as well.
        for (k = expected_frequencies.length - 1; k >= 0; k--) {
            if (expected_frequencies[k] < 3) {
                expected_frequencies[k - 1] += expected_frequencies[k];
                expected_frequencies.pop();

                observed_frequencies[k - 1] += observed_frequencies[k];
                observed_frequencies.pop();
            }
        }

        // Iterate through the squared differences between observed & expected
        // frequencies, accumulating the `chi_squared` statistic.
        for (k = 0; k < observed_frequencies.length; k++) {
            chi_squared += Math.pow(
                observed_frequencies[k] - expected_frequencies[k], 2) /
                expected_frequencies[k];
        }

        // Calculate degrees of freedom for this test and look it up in the
        // `chi_squared_distribution_table` in order to
        // accept or reject the goodness-of-fit of the hypothesized distribution.
        degrees_of_freedom = observed_frequencies.length - c - 1;
        return chi_squared_distribution_table[degrees_of_freedom][significance] < chi_squared;
    }

    // # Mixin
    //
    // Mixin simple_statistics to a single Array instance if provided
    // or the Array native object if not. This is an optional
    // feature that lets you treat simple_statistics as a native feature
    // of Javascript.
    function mixin(array) {
        var support = !!(Object.defineProperty && Object.defineProperties);
        if (!support) throw new Error('without defineProperty, simple-statistics cannot be mixed in');

        // only methods which work on basic arrays in a single step
        // are supported
        var arrayMethods = ['median', 'standard_deviation', 'sum',
            'sample_skewness',
            'mean', 'min', 'max', 'quantile', 'geometric_mean',
            'harmonic_mean', 'root_mean_square'];

        // create a closure with a method name so that a reference
        // like `arrayMethods[i]` doesn't follow the loop increment
        function wrap(method) {
            return function() {
                // cast any arguments into an array, since they're
                // natively objects
                var args = Array.prototype.slice.apply(arguments);
                // make the first argument the array itself
                args.unshift(this);
                // return the result of the ss method
                return ss[method].apply(ss, args);
            };
        }

        // select object to extend
        var extending;
        if (array) {
            // create a shallow copy of the array so that our internal
            // operations do not change it by reference
            extending = array.slice();
        } else {
            extending = Array.prototype;
        }

        // for each array function, define a function that gets
        // the array as the first argument.
        // We use [defineProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)
        // because it allows these properties to be non-enumerable:
        // `for (var in x)` loops will not run into problems with this
        // implementation.
        for (var i = 0; i < arrayMethods.length; i++) {
            Object.defineProperty(extending, arrayMethods[i], {
                value: wrap(arrayMethods[i]),
                configurable: true,
                enumerable: false,
                writable: true
            });
        }

        return extending;
    }

    ss.linear_regression = linear_regression;
    ss.standard_deviation = standard_deviation;
    ss.r_squared = r_squared;
    ss.median = median;
    ss.mean = mean;
    ss.mode = mode;
    ss.min = min;
    ss.max = max;
    ss.sum = sum;
    ss.quantile = quantile;
    ss.quantile_sorted = quantile_sorted;
    ss.iqr = iqr;
    ss.mad = mad;

    ss.chunk = chunk;
    ss.shuffle = shuffle;
    ss.shuffle_in_place = shuffle_in_place;

    ss.sample = sample;

    ss.sample_covariance = sample_covariance;
    ss.sample_correlation = sample_correlation;
    ss.sample_variance = sample_variance;
    ss.sample_standard_deviation = sample_standard_deviation;
    ss.sample_skewness = sample_skewness;

    ss.geometric_mean = geometric_mean;
    ss.harmonic_mean = harmonic_mean;
    ss.root_mean_square = root_mean_square;
    ss.variance = variance;
    ss.t_test = t_test;
    ss.t_test_two_sample = t_test_two_sample;

    // jenks
    ss.jenksMatrices = jenksMatrices;
    ss.jenksBreaks = jenksBreaks;
    ss.jenks = jenks;

    ss.bayesian = bayesian;

    // Distribution-related methods
    ss.epsilon = epsilon; // We make ε available to the test suite.
    ss.factorial = factorial;
    ss.bernoulli_distribution = bernoulli_distribution;
    ss.binomial_distribution = binomial_distribution;
    ss.poisson_distribution = poisson_distribution;
    ss.chi_squared_goodness_of_fit = chi_squared_goodness_of_fit;

    // Normal distribution
    ss.z_score = z_score;
    ss.cumulative_std_normal_probability = cumulative_std_normal_probability;
    ss.standard_normal_table = standard_normal_table;
    ss.error_function = error_function;

    // Alias this into its common name
    ss.average = mean;
    ss.interquartile_range = iqr;
    ss.mixin = mixin;
    ss.median_absolute_deviation = mad;
    ss.rms = root_mean_square;
    ss.erf = error_function;

})(this);

},{}],79:[function(require,module,exports){
var invariant = require('turf-invariant');
//http://en.wikipedia.org/wiki/Haversine_formula
//http://www.movable-type.co.uk/scripts/latlong.html

/**
 * Takes two {@link Point} features and calculates
 * the distance between them in degress, radians,
 * miles, or kilometers. This uses the
 * [Haversine formula](http://en.wikipedia.org/wiki/Haversine_formula)
 * to account for global curvature.
 *
 * @module turf/distance
 * @category measurement
 * @param {Feature} from origin point
 * @param {Feature} to destination point
 * @param {String} [units=kilometers] can be degrees, radians, miles, or kilometers
 * @return {Number} distance between the two points
 * @example
 * var point1 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.343, 39.984]
 *   }
 * };
 * var point2 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.534, 39.123]
 *   }
 * };
 * var units = "miles";
 *
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [point1, point2]
 * };
 *
 * //=points
 *
 * var distance = turf.distance(point1, point2, units);
 *
 * //=distance
 */
module.exports = function(point1, point2, units){
  invariant.featureOf(point1, 'Point', 'distance');
  invariant.featureOf(point2, 'Point', 'distance');
  var coordinates1 = point1.geometry.coordinates;
  var coordinates2 = point2.geometry.coordinates;

  var dLat = toRad(coordinates2[1] - coordinates1[1]);
  var dLon = toRad(coordinates2[0] - coordinates1[0]);
  var lat1 = toRad(coordinates1[1]);
  var lat2 = toRad(coordinates2[1]);
  var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
          Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2);
  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

  var R;
  switch(units){
    case 'miles':
      R = 3960;
      break;
    case 'kilometers':
      R = 6373;
      break;
    case 'degrees':
      R = 57.2957795;
      break;
    case 'radians':
      R = 1;
      break;
    case undefined:
      R = 6373;
      break;
    default:
      throw new Error('unknown option given to "units"');
  }

  var distance = R * c;
  return distance;
};

function toRad(degree) {
  return degree * Math.PI / 180;
}

},{"turf-invariant":80}],80:[function(require,module,exports){
module.exports.geojsonType = geojsonType;
module.exports.collectionOf = collectionOf;
module.exports.featureOf = featureOf;

/**
 * Enforce expectations about types of GeoJSON objects for Turf.
 *
 * @alias geojsonType
 * @param {GeoJSON} value any GeoJSON object
 * @param {string} type expected GeoJSON type
 * @param {String} name name of calling function
 * @throws Error if value is not the expected type.
 */
function geojsonType(value, type, name) {
    if (!type || !name) throw new Error('type and name required');

    if (!value || value.type !== type) {
        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + value.type);
    }
}

/**
 * Enforce expectations about types of {@link Feature} inputs for Turf.
 * Internally this uses {@link geojsonType} to judge geometry types.
 *
 * @alias featureOf
 * @param {Feature} feature a feature with an expected geometry type
 * @param {string} type expected GeoJSON type
 * @param {String} name name of calling function
 * @throws Error if value is not the expected type.
 */
function featureOf(value, type, name) {
    if (!name) throw new Error('.featureOf() requires a name');
    if (!value || value.type !== 'Feature' || !value.geometry) {
        throw new Error('Invalid input to ' + name + ', Feature with geometry required');
    }
    if (!value.geometry || value.geometry.type !== type) {
        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + value.geometry.type);
    }
}

/**
 * Enforce expectations about types of {@link FeatureCollection} inputs for Turf.
 * Internally this uses {@link geojsonType} to judge geometry types.
 *
 * @alias collectionOf
 * @param {FeatureCollection} featurecollection a featurecollection for which features will be judged
 * @param {string} type expected GeoJSON type
 * @param {String} name name of calling function
 * @throws Error if value is not the expected type.
 */
function collectionOf(value, type, name) {
    if (!name) throw new Error('.collectionOf() requires a name');
    if (!value || value.type !== 'FeatureCollection') {
        throw new Error('Invalid input to ' + name + ', FeatureCollection required');
    }
    for (var i = 0; i < value.features.length; i++) {
        var feature = value.features[i];
        if (!feature || feature.type !== 'Feature' || !feature.geometry) {
            throw new Error('Invalid input to ' + name + ', Feature with geometry required');
        }
        if (!feature.geometry || feature.geometry.type !== type) {
            throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + feature.geometry.type);
        }
    }
}

},{}],81:[function(require,module,exports){
var extent = require('turf-extent');
var bboxPolygon = require('turf-bbox-polygon');

/**
 * Takes a {@link Feature} or {@link FeatureCollection} and returns a rectangular {@link Polygon} feature that encompasses all vertices.
 *
 * @module turf/envelope
 * @category measurement
 * @param {FeatureCollection} fc a FeatureCollection of any type
 * @return {Polygon} a rectangular Polygon feature that encompasses all vertices
 * @example
 * var fc = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "name": "Location A"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-75.343, 39.984]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "name": "Location B"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-75.833, 39.284]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "name": "Location C"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-75.534, 39.123]
 *       }
 *     }
 *   ]
 * };
 *
 * var enveloped = turf.envelope(fc);
 *
 * var resultFeatures = fc.features.concat(enveloped);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

module.exports = function(features, done){
  var bbox = extent(features);
  var poly = bboxPolygon(bbox);
  return poly;
}

},{"turf-bbox-polygon":31,"turf-extent":89}],82:[function(require,module,exports){
// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html
var jsts = require('jsts');

/**
 * Finds the difference between two polygons by clipping the second
 * polygon from the first.
 *
 * @module turf/erase
 * @category transformation
 * @param {Polygon} poly1 input Polygon feaure
 * @param {Polygon} poly2 Polygon feature to erase from `poly1`
 * @return {Polygon} a Polygon feature showing the area of `poly1` excluding the area of `poly2`
 * @example
 * var poly1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-46.738586, -23.596711],
 *       [-46.738586, -23.458207],
 *       [-46.560058, -23.458207],
 *       [-46.560058, -23.596711],
 *       [-46.738586, -23.596711]
 *     ]]
 *   }
 * };
 * var poly2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#00f"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-46.650009, -23.631314],
 *       [-46.650009, -23.5237],
 *       [-46.509246, -23.5237],
 *       [-46.509246, -23.631314],
 *       [-46.650009, -23.631314]
 *     ]]
 *   }
 * };
 *
 * var erased = turf.erase(poly1, poly2);
 * erased.properties.fill = '#f00';
 *
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [poly1, poly2]
 * };
 *
 * //=polygons
 *
 * //=erased
 */

module.exports = function(p1, p2, done){
  var poly1 = JSON.parse(JSON.stringify(p1));
  var poly2 = JSON.parse(JSON.stringify(p2));
  if(poly1.type !== 'Feature') {
    poly1 = {
      type: 'Feature',
      properties: {},
      geometry: poly1
    };
  }
  if(poly2.type !== 'Feature') {
    poly2 = {
      type: 'Feature',
      properties: {},
      geometry: poly2
    };
  }

  var reader = new jsts.io.GeoJSONReader();
  var a = reader.read(JSON.stringify(poly1.geometry));
  var b = reader.read(JSON.stringify(poly2.geometry));
  var erased = a.difference(b);
  var parser = new jsts.io.GeoJSONParser();
  erased = parser.write(erased);

  poly1.geometry = erased;

  if (poly1.geometry.type === 'GeometryCollection' && poly1.geometry.geometries.length === 0) {
    return;
  } else {
    return {
      type: 'Feature',
      properties: poly1.properties,
      geometry: erased
    };
  }
};

},{"jsts":83}],83:[function(require,module,exports){
arguments[4][36][0].apply(exports,arguments)
},{"./lib/jsts":84,"dup":36,"javascript.util":86}],84:[function(require,module,exports){
arguments[4][37][0].apply(exports,arguments)
},{"dup":37}],85:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],86:[function(require,module,exports){
arguments[4][39][0].apply(exports,arguments)
},{"./dist/javascript.util-node.min.js":85,"dup":39}],87:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');
var each = require('turf-meta').coordEach;
var point = require('turf-point');

/**
 * Takes any {@link GeoJSON} object and return all positions as
 * a {@link FeatureCollection} of {@link Point} features.
 *
 * @module turf/explode
 * @category misc
 * @param {GeoJSON} input input features
 * @return {FeatureCollection} a FeatureCollection of {@link Point} features representing the exploded input features
 * @throws {Error} if it encounters an unknown geometry type
 * @example
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [177.434692, -17.77517],
 *       [177.402076, -17.779093],
 *       [177.38079, -17.803937],
 *       [177.40242, -17.826164],
 *       [177.438468, -17.824857],
 *       [177.454948, -17.796746],
 *       [177.434692, -17.77517]
 *     ]]
 *   }
 * };
 *
 * var points = turf.explode(poly);
 *
 * //=poly
 *
 * //=points
 */
module.exports = function(layer) {
  var points = [];
  each(layer, function(coord) {
    points.push(point(coord));
  });
  return featureCollection(points);
};

},{"turf-featurecollection":91,"turf-meta":88,"turf-point":121}],88:[function(require,module,exports){
arguments[4][42][0].apply(exports,arguments)
},{"dup":42}],89:[function(require,module,exports){
var each = require('turf-meta').coordEach;

/**
 * Takes any {@link GeoJSON} object, calculates the extent of all input features, and returns a bounding box.
 *
 * @module turf/extent
 * @category measurement
 * @param {GeoJSON} input any valid GeoJSON Object
 * @return {Array<number>} the bounding box of `input` given
 * as an array in WSEN order (west, south, east, north)
 * @example
 * var input = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.175329, 22.2524]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.170007, 22.267969]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.200649, 22.274641]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [114.186744, 22.265745]
 *       }
 *     }
 *   ]
 * };
 *
 * var bbox = turf.extent(input);
 *
 * var bboxPolygon = turf.bboxPolygon(bbox);
 *
 * var resultFeatures = input.features.concat(bboxPolygon);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(layer) {
    var extent = [Infinity, Infinity, -Infinity, -Infinity];
    each(layer, function(coord) {
      if (extent[0] > coord[0]) extent[0] = coord[0];
      if (extent[1] > coord[1]) extent[1] = coord[1];
      if (extent[2] < coord[0]) extent[2] = coord[0];
      if (extent[3] < coord[1]) extent[3] = coord[1];
    });
    return extent;
};

},{"turf-meta":90}],90:[function(require,module,exports){
arguments[4][42][0].apply(exports,arguments)
},{"dup":42}],91:[function(require,module,exports){
/**
 * Takes one or more {@link Feature|Features} and creates a {@link FeatureCollection}
 *
 * @module turf/featurecollection
 * @category helper
 * @param {Feature} features input Features
 * @returns {FeatureCollection} a FeatureCollection of input features
 * @example
 * var features = [
 *  turf.point([-75.343, 39.984], {name: 'Location A'}),
 *  turf.point([-75.833, 39.284], {name: 'Location B'}),
 *  turf.point([-75.534, 39.123], {name: 'Location C'})
 * ];
 *
 * var fc = turf.featurecollection(features);
 *
 * //=fc
 */
module.exports = function(features){
  return {
    type: "FeatureCollection",
    features: features
  };
};

},{}],92:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} and filters it by a given property and value
 *
 * @module turf/filter
 * @category data
 * @param {FeatureCollection} features input FeatureCollection of any type
 * @param {String} key the property on which to filter
 * @param {String} value the value of that property on which to filter
 * @return {FeatureCollection} a filtered collection with only features that match input `key` and `value`
 * @example
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "oak"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.581777, 44.260875]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "birch"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.570018, 44.260691]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "oak"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.576284, 44.257925]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "redwood"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.56916, 44.254605]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "maple"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.581691, 44.24858]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "species": "oak"
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-72.583837, 44.255773]
 *       }
 *     }
 *   ]
 * };
 *
 * var key = "species";
 * var value = "oak";
 *
 * var filtered = turf.filter(features, key, value);
 *
 * //=features
 *
 * //=filtered
 */
module.exports = function(collection, key, val) {
  var newFC = featureCollection([]);
  for(var i = 0; i < collection.features.length; i++) {
    if(collection.features[i].properties[key] === val) {
      newFC.features.push(collection.features[i]);
    }
  }
  return newFC;
};

},{"turf-featurecollection":91}],93:[function(require,module,exports){
/**
 * Takes a {@link GeoJSON} object of any type and flips all of its coordinates
 * from `[x, y]` to `[y, x]`.
 *
 * @module turf/flip
 * @category misc
 * @param {GeoJSON} input input GeoJSON object
 * @returns {GeoJSON} a GeoJSON object of the same type as `input` with flipped coordinates
 * @example
 * var serbia = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [20.566406, 43.421008]
 *   }
 * };
 *
 * //=serbia
 *
 * var saudiArabia = turf.flip(serbia);
 *
 * //=saudiArabia
 */
module.exports = flipAny;

function flipAny(_) {
    // ensure that we don't modify features in-place and changes to the
    // output do not change the previous feature, including changes to nested
    // properties.
    var input = JSON.parse(JSON.stringify(_));
    switch (input.type) {
        case 'FeatureCollection':
            for (var i = 0; i < input.features.length; i++)
                flipGeometry(input.features[i].geometry);
            return input;
        case 'Feature':
            flipGeometry(input.geometry);
            return input;
        default:
            flipGeometry(input);
            return input;
    }
}

function flipGeometry(geometry) {
    var coords = geometry.coordinates;
    switch(geometry.type) {
      case 'Point':
        flip0(coords);
        break;
      case 'LineString':
      case 'MultiPoint':
        flip1(coords);
        break;
      case 'Polygon':
      case 'MultiLineString':
        flip2(coords);
        break;
      case 'MultiPolygon':
        flip3(coords);
        break;
      case 'GeometryCollection':
        geometry.geometries.forEach(flipGeometry);
        break;
    }
}

function flip0(coord) {
    coord.reverse();
}

function flip1(coords) {
  for(var i = 0; i < coords.length; i++) coords[i].reverse();
}

function flip2(coords) {
  for(var i = 0; i < coords.length; i++)
    for(var j = 0; j < coords[i].length; j++) coords[i][j].reverse();
}

function flip3(coords) {
  for(var i = 0; i < coords.length; i++)
    for(var j = 0; j < coords[i].length; j++)
      for(var k = 0; k < coords[i][j].length; k++) coords[i][j][k].reverse();
}

},{}],94:[function(require,module,exports){
var point = require('turf-point');
var polygon = require('turf-polygon');
var distance = require('turf-distance');
var featurecollection = require('turf-featurecollection');

/**
 * Takes a bounding box and a cell size in degrees and returns a {@link FeatureCollection} of flat-topped
 * hexagons ({@link Polygon} features) aligned in an "odd-q" vertical grid as
 * described in [Hexagonal Grids](http://www.redblobgames.com/grids/hexagons/)
 *
 * @module turf/hex-grid
 * @category interpolation
 * @param {Array<number>} bbox bounding box in [minX, minY, maxX, maxY] order
 * @param {Number} cellWidth width of cell in specified units
 * @param {String} units used in calculating cellWidth ('miles' or 'kilometers')
 * @return {FeatureCollection} units used in calculating cellWidth ('miles' or 'kilometers')
 * @example
 * var bbox = [-96,31,-84,40];
 * var cellWidth = 50;
 * var units = 'miles';
 *
 * var hexgrid = turf.hexGrid(bbox, cellWidth, units);
 *
 * //=hexgrid
 */

//Precompute cosines and sines of angles used in hexagon creation
// for performance gain
var cosines = [];
var sines = [];
for (var i = 0; i < 6; i++) {
  var angle = 2 * Math.PI/6 * i;
  cosines.push(Math.cos(angle));
  sines.push(Math.sin(angle));
}

module.exports = function hexgrid(bbox, cell, units) {
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);
  var radius = cellWidth / 2;

  var hex_width = radius * 2;
  var hex_height = Math.sqrt(3)/2 * hex_width;

  var box_width = bbox[2] - bbox[0];
  var box_height = bbox[3] - bbox[1];

  var x_interval = 3/4 * hex_width;
  var y_interval = hex_height;

  var x_span = box_width / (hex_width - radius/2);
  var x_count = Math.ceil(x_span);
  if (Math.round(x_span) === x_count) {
    x_count++;
  }

  var x_adjust = ((x_count * x_interval - radius/2) - box_width)/2 - radius/2;

  var y_count = Math.ceil(box_height / hex_height);

  var y_adjust = (box_height - y_count * hex_height)/2;

  var hasOffsetY = y_count * hex_height - box_height > hex_height/2;
  if (hasOffsetY) {
    y_adjust -= hex_height/4;
  }

  var fc = featurecollection([]);
  for (var x = 0; x < x_count; x++) {
    for (var y = 0; y <= y_count; y++) {

      var isOdd = x % 2 === 1;
      if (y === 0 && isOdd) {
        continue;
      }

      if (y === 0 && hasOffsetY) {
        continue;
      }

      var center_x = x * x_interval + bbox[0] - x_adjust;
      var center_y = y * y_interval + bbox[1] + y_adjust;

      if (isOdd) {
        center_y -= hex_height/2;
      }
      fc.features.push(hexagon([center_x, center_y], radius));
    }
  }

  return fc;
};

//Center should be [x, y]
function hexagon(center, radius) {
  var vertices = [];
  for (var i = 0; i < 6; i++) {
    var x = center[0] + radius * cosines[i];
    var y = center[1] + radius * sines[i];
    vertices.push([x,y]);
  }
  //first and last vertex must be the same
  vertices.push(vertices[0]);
  return polygon([vertices]);
}
},{"turf-distance":79,"turf-featurecollection":91,"turf-point":121,"turf-polygon":122}],95:[function(require,module,exports){
// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule
// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js
// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html

/**
 * Takes a {@link Point} feature and a {@link Polygon} feature and determines if the Point resides inside the Polygon. The Polygon can
 * be convex or concave. The function accepts any valid Polygon or {@link MultiPolygon}
 * and accounts for holes.
 *
 * @module turf/inside
 * @category joins
 * @param {Point} point a Point feature
 * @param {Polygon} polygon a Polygon feature
 * @return {Boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon
 * @example
 * var pt1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#f00"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.467285, 40.75766]
 *   }
 * };
 * var pt2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-111.873779, 40.647303]
 *   }
 * };
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-112.074279, 40.52215],
 *       [-112.074279, 40.853293],
 *       [-111.610107, 40.853293],
 *       [-111.610107, 40.52215],
 *       [-112.074279, 40.52215]
 *     ]]
 *   }
 * };
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [pt1, pt2, poly]
 * };
 *
 * //=features
 *
 * var isInside1 = turf.inside(pt1, poly);
 * //=isInside1
 *
 * var isInside2 = turf.inside(pt2, poly);
 * //=isInside2
 */
module.exports = function(point, polygon) {
  var polys = polygon.geometry.coordinates;
  var pt = [point.geometry.coordinates[0], point.geometry.coordinates[1]];
  // normalize to multipolygon
  if(polygon.geometry.type === 'Polygon') polys = [polys];

  var insidePoly = false;
  var i = 0;
  while (i < polys.length && !insidePoly) {
    // check if it is in the outer ring first
    if(inRing(pt, polys[i][0])) {
      var inHole = false;
      var k = 1;
      // check for the point in any of the holes
      while(k < polys[i].length && !inHole) {
        if(inRing(pt, polys[i][k])) {
          inHole = true;
        }
        k++;
      }
      if(!inHole) insidePoly = true;
    }
    i++;
  }
  return insidePoly;
}

// pt is [x,y] and ring is [[x,y], [x,y],..]
function inRing (pt, ring) {
  var isInside = false;
  for (var i = 0, j = ring.length - 1; i < ring.length; j = i++) {
    var xi = ring[i][0], yi = ring[i][1];
    var xj = ring[j][0], yj = ring[j][1];
    
    var intersect = ((yi > pt[1]) != (yj > pt[1]))
        && (pt[0] < (xj - xi) * (pt[1] - yi) / (yj - yi) + xi);
    if (intersect) isInside = !isInside;
  }
  return isInside;
}


},{}],96:[function(require,module,exports){
// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html
var jsts = require('jsts');
var featurecollection = require('turf-featurecollection');

/**
 * Takes two {@link Polygon} features and finds their intersection.
 *
 * @module turf/intersect
 * @category transformation
 * @param {Polygon} poly1 the first Polygon
 * @param {Polygon} poly2 the second Polygon
 * @return {Polygon} a Polygon feature representing the area where `poly1` and `poly2` overlap
 * @example
 * var poly1 = turf.polygon([[
 *  [-122.801742, 45.48565],
 *  [-122.801742, 45.60491],
 *  [-122.584762, 45.60491],
 *  [-122.584762, 45.48565],
 *  [-122.801742, 45.48565]
 * ]]);
 * poly1.properties.fill = '#0f0';
 * var poly2 = turf.polygon([[
 *  [-122.520217, 45.535693],
 *  [-122.64038, 45.553967],
 *  [-122.720031, 45.526554],
 *  [-122.669906, 45.507309],
 *  [-122.723464, 45.446643],
 *  [-122.532577, 45.408574],
 *  [-122.487258, 45.477466],
 *  [-122.520217, 45.535693]
 * ]]);
 * poly2.properties.fill = '#00f';
 * var polygons = turf.featurecollection([poly1, poly2]);
 *
 * var intersection = turf.intersect(poly1, poly2);
 *
 * //=polygons
 *
 * //=intersection
 */
module.exports = function(poly1, poly2){
  var geom1;
  if(poly1.type === 'Feature') geom1 = poly1.geometry;
  else geom1 = poly1;
  if(poly2.type === 'Feature') geom2 = poly2.geometry;
  else geom2 = poly2;
  var reader = new jsts.io.GeoJSONReader();
  var a = reader.read(JSON.stringify(geom1));
  var b = reader.read(JSON.stringify(geom2));
  var intersection = a.intersection(b);
  var parser = new jsts.io.GeoJSONParser();

  intersection = parser.write(intersection);
  if(intersection.type === 'GeometryCollection' && intersection.geometries.length === 0) {
    return;
  } else {
    return {
      type: 'Feature',
      properties: {},
      geometry: intersection
    };
  }
};

},{"jsts":97,"turf-featurecollection":91}],97:[function(require,module,exports){
arguments[4][36][0].apply(exports,arguments)
},{"./lib/jsts":98,"dup":36,"javascript.util":100}],98:[function(require,module,exports){
arguments[4][37][0].apply(exports,arguments)
},{"dup":37}],99:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],100:[function(require,module,exports){
arguments[4][39][0].apply(exports,arguments)
},{"./dist/javascript.util-node.min.js":99,"dup":39}],101:[function(require,module,exports){
/**
 * Copyright (c) 2010, Jason Davies.
 *
 * All rights reserved.  This code is based on Bradley White's Java version,
 * which is in turn based on Nicholas Yue's C++ version, which in turn is based
 * on Paul D. Bourke's original Fortran version.  See below for the respective
 * copyright notices.
 *
 * See http://local.wasp.uwa.edu.au/~pbourke/papers/conrec/ for the original
 * paper by Paul D. Bourke.
 *
 * The vector conversion code is based on http://apptree.net/conrec.htm by
 * Graham Cox.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of the <organization> nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/*
 * Copyright (c) 1996-1997 Nicholas Yue
 *
 * This software is copyrighted by Nicholas Yue. This code is based on Paul D.
 * Bourke's CONREC.F routine.
 *
 * The authors hereby grant permission to use, copy, and distribute this
 * software and its documentation for any purpose, provided that existing
 * copyright notices are retained in all copies and that this notice is
 * included verbatim in any distributions. Additionally, the authors grant
 * permission to modify this software and its documentation for any purpose,
 * provided that such modifications are not distributed without the explicit
 * consent of the authors and that existing copyright notices are retained in
 * all copies. Some of the algorithms implemented by this software are
 * patented, observe all applicable patent law.
 *
 * IN NO EVENT SHALL THE AUTHORS OR DISTRIBUTORS BE LIABLE TO ANY PARTY FOR
 * DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT
 * OF THE USE OF THIS SOFTWARE, ITS DOCUMENTATION, OR ANY DERIVATIVES THEREOF,
 * EVEN IF THE AUTHORS HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * THE AUTHORS AND DISTRIBUTORS SPECIFICALLY DISCLAIM ANY WARRANTIES,
 * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.  THIS SOFTWARE IS
 * PROVIDED ON AN "AS IS" BASIS, AND THE AUTHORS AND DISTRIBUTORS HAVE NO
 * OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR
 * MODIFICATIONS.
 */


  module.exports = Conrec;

  var EPSILON = 1e-10;

  function pointsEqual(a, b) {
    var x = a.x - b.x, y = a.y - b.y;
    return x * x + y * y < EPSILON;
  }

  function reverseList(list) {
    var pp = list.head;

    while (pp) {
      // swap prev/next pointers
      var temp = pp.next;
      pp.next = pp.prev;
      pp.prev = temp;

      // continue through the list
      pp = temp;
    }

    // swap head/tail pointers
    var temp = list.head;
    list.head = list.tail;
    list.tail = temp;
  }

  function ContourBuilder(level) {
    this.level = level;
    this.s = null;
    this.count = 0;
  }
  ContourBuilder.prototype.remove_seq = function(list) {
    // if list is the first item, static ptr s is updated
    if (list.prev) {
      list.prev.next = list.next;
    } else {
      this.s = list.next;
    }

    if (list.next) {
      list.next.prev = list.prev;
    }
    --this.count;
  }
  ContourBuilder.prototype.addSegment = function(a, b) {
    var ss = this.s;
    var ma = null;
    var mb = null;
    var prependA = false;
    var prependB = false;

    while (ss) {
      if (ma == null) {
        // no match for a yet
        if (pointsEqual(a, ss.head.p)) {
          ma = ss;
          prependA = true;
        } else if (pointsEqual(a, ss.tail.p)) {
          ma = ss;
        }
      }
      if (mb == null) {
        // no match for b yet
        if (pointsEqual(b, ss.head.p)) {
          mb = ss;
          prependB = true;
        } else if (pointsEqual(b, ss.tail.p)) {
          mb = ss;
        }
      }
      // if we matched both no need to continue searching
      if (mb != null && ma != null) {
        break;
      } else {
        ss = ss.next;
      }
    }

    // c is the case selector based on which of ma and/or mb are set
    var c = ((ma != null) ? 1 : 0) | ((mb != null) ? 2 : 0);

    switch(c) {
      case 0:   // both unmatched, add as new sequence
        var aa = {p: a, prev: null};
        var bb = {p: b, next: null};
        aa.next = bb;
        bb.prev = aa;

        // create sequence element and push onto head of main list. The order
        // of items in this list is unimportant
        ma = {head: aa, tail: bb, next: this.s, prev: null, closed: false};
        if (this.s) {
          this.s.prev = ma;
        }
        this.s = ma;

        ++this.count;    // not essential - tracks number of unmerged sequences
      break;

      case 1:   // a matched, b did not - thus b extends sequence ma
        var pp = {p: b};

        if (prependA) {
          pp.next = ma.head;
          pp.prev = null;
          ma.head.prev = pp;
          ma.head = pp;
        } else {
          pp.next = null;
          pp.prev = ma.tail;
          ma.tail.next = pp;
          ma.tail = pp;
        }
      break;

      case 2:   // b matched, a did not - thus a extends sequence mb
        var pp = {p: a};

        if (prependB) {
          pp.next = mb.head;
          pp.prev = null;
          mb.head.prev = pp;
          mb.head = pp;
        } else {
          pp.next = null;
          pp.prev = mb.tail;
          mb.tail.next = pp;
          mb.tail = pp;
        }
      break;

      case 3:   // both matched, can merge sequences
        // if the sequences are the same, do nothing, as we are simply closing this path (could set a flag)

        if (ma === mb) {
          var pp = {p: ma.tail.p, next: ma.head, prev: null};
          ma.head.prev = pp;
          ma.head = pp;
          ma.closed = true;
          break;
        }

        // there are 4 ways the sequence pair can be joined. The current setting of prependA and
        // prependB will tell us which type of join is needed. For head/head and tail/tail joins
        // one sequence needs to be reversed
        switch((prependA ? 1 : 0) | (prependB ? 2 : 0)) {
          case 0:   // tail-tail
            // reverse ma and append to mb
            reverseList(ma);
            // fall through to head/tail case
          case 1:   // head-tail
            // ma is appended to mb and ma discarded
            mb.tail.next = ma.head;
            ma.head.prev = mb.tail;
            mb.tail = ma.tail;

            //discard ma sequence record
            this.remove_seq(ma);
          break;

          case 3:   // head-head
            // reverse ma and append mb to it
            reverseList(ma);
            // fall through to tail/head case
          case 2:   // tail-head
            // mb is appended to ma and mb is discarded
            ma.tail.next = mb.head;
            mb.head.prev = ma.tail;
            ma.tail = mb.tail;

            //discard mb sequence record
            this.remove_seq(mb);
        break;
      }
    }
  }

  /**
   * Implements CONREC.
   *
   * @param {function} drawContour function for drawing contour.  Defaults to a
   *                               custom "contour builder", which populates the
   *                               contours property.
   */
  function Conrec(drawContour) {
    if (!drawContour) {
      var c = this;
      c.contours = {};
      /**
       * drawContour - interface for implementing the user supplied method to
       * render the countours.
       *
       * Draws a line between the start and end coordinates.
       *
       * @param startX    - start coordinate for X
       * @param startY    - start coordinate for Y
       * @param endX      - end coordinate for X
       * @param endY      - end coordinate for Y
       * @param contourLevel - Contour level for line.
       */
      this.drawContour = function(startX, startY, endX, endY, contourLevel, k) {
        var cb = c.contours[k];
        if (!cb) {
          cb = c.contours[k] = new ContourBuilder(contourLevel);
        }
        cb.addSegment({x: startX, y: startY}, {x: endX, y: endY});
      }
      this.contourList = function() {
        var l = [];
        var a = c.contours;
        for (var k in a) {
          var s = a[k].s;
          var level = a[k].level;
          while (s) {
            var h = s.head;
            var l2 = [];
            l2.level = level;
            l2.k = k;
            while (h && h.p) {
              l2.push(h.p);
              h = h.next;
            }
            l.push(l2);
            s = s.next;
          }
        }
        l.sort(function(a, b) { return a.k - b.k });
        return l;
      }
    } else {
      this.drawContour = drawContour;
    }
    this.h  = new Array(5);
    this.sh = new Array(5);
    this.xh = new Array(5);
    this.yh = new Array(5);
  }

  /**
   * contour is a contouring subroutine for rectangularily spaced data
   *
   * It emits calls to a line drawing subroutine supplied by the user which
   * draws a contour map corresponding to real*4data on a randomly spaced
   * rectangular grid. The coordinates emitted are in the same units given in
   * the x() and y() arrays.
   *
   * Any number of contour levels may be specified but they must be in order of
   * increasing value.
   *
   *
   * @param {number[][]} d - matrix of data to contour
   * @param {number} ilb,iub,jlb,jub - index bounds of data matrix
   *
   *             The following two, one dimensional arrays (x and y) contain
   *             the horizontal and vertical coordinates of each sample points.
   * @param {number[]} x  - data matrix column coordinates
   * @param {number[]} y  - data matrix row coordinates
   * @param {number} nc   - number of contour levels
   * @param {number[]} z  - contour levels in increasing order.
   */
  Conrec.prototype.contour = function(d, ilb, iub, jlb, jub, x, y, nc, z) {
    var h = this.h, sh = this.sh, xh = this.xh, yh = this.yh;
    var drawContour = this.drawContour;
    this.contours = {};

    /** private */
    var xsect = function(p1, p2){
      return (h[p2]*xh[p1]-h[p1]*xh[p2])/(h[p2]-h[p1]);
    }

    var ysect = function(p1, p2){
      return (h[p2]*yh[p1]-h[p1]*yh[p2])/(h[p2]-h[p1]);
    }
    var m1;
    var m2;
    var m3;
    var case_value;
    var dmin;
    var dmax;
    var x1 = 0.0;
    var x2 = 0.0;
    var y1 = 0.0;
    var y2 = 0.0;

    // The indexing of im and jm should be noted as it has to start from zero
    // unlike the fortran counter part
    var im = [0, 1, 1, 0];
    var jm = [0, 0, 1, 1];

    // Note that castab is arranged differently from the FORTRAN code because
    // Fortran and C/C++ arrays are transposed of each other, in this case
    // it is more tricky as castab is in 3 dimensions
    var castab = [
      [
        [0, 0, 8], [0, 2, 5], [7, 6, 9]
      ],
      [
        [0, 3, 4], [1, 3, 1], [4, 3, 0]
      ],
      [
        [9, 6, 7], [5, 2, 0], [8, 0, 0]
      ]
    ];

    for (var j=(jub-1);j>=jlb;j--) {
      for (var i=ilb;i<=iub-1;i++) {
        var temp1, temp2;
        temp1 = Math.min(d[i][j],d[i][j+1]);
        temp2 = Math.min(d[i+1][j],d[i+1][j+1]);
        dmin  = Math.min(temp1,temp2);
        temp1 = Math.max(d[i][j],d[i][j+1]);
        temp2 = Math.max(d[i+1][j],d[i+1][j+1]);
        dmax  = Math.max(temp1,temp2);

        if (dmax>=z[0]&&dmin<=z[nc-1]) {
          for (var k=0;k<nc;k++) {
            if (z[k]>=dmin&&z[k]<=dmax) {
              for (var m=4;m>=0;m--) {
                if (m>0) {
                  // The indexing of im and jm should be noted as it has to
                  // start from zero
                  h[m] = d[i+im[m-1]][j+jm[m-1]]-z[k];
                  xh[m] = x[i+im[m-1]];
                  yh[m] = y[j+jm[m-1]];
                } else {
                  h[0] = 0.25*(h[1]+h[2]+h[3]+h[4]);
                  xh[0]=0.5*(x[i]+x[i+1]);
                  yh[0]=0.5*(y[j]+y[j+1]);
                }
                if (h[m]>EPSILON) {
                  sh[m] = 1;
                } else if (h[m]<-EPSILON) {
                  sh[m] = -1;
                } else
                  sh[m] = 0;
              }
              //
              // Note: at this stage the relative heights of the corners and the
              // centre are in the h array, and the corresponding coordinates are
              // in the xh and yh arrays. The centre of the box is indexed by 0
              // and the 4 corners by 1 to 4 as shown below.
              // Each triangle is then indexed by the parameter m, and the 3
              // vertices of each triangle are indexed by parameters m1,m2,and
              // m3.
              // It is assumed that the centre of the box is always vertex 2
              // though this isimportant only when all 3 vertices lie exactly on
              // the same contour level, in which case only the side of the box
              // is drawn.
              //
              //
              //      vertex 4 +-------------------+ vertex 3
              //               | \               / |
              //               |   \    m-3    /   |
              //               |     \       /     |
              //               |       \   /       |
              //               |  m=2    X   m=2   |       the centre is vertex 0
              //               |       /   \       |
              //               |     /       \     |
              //               |   /    m=1    \   |
              //               | /               \ |
              //      vertex 1 +-------------------+ vertex 2
              //
              //
              //
              //               Scan each triangle in the box
              //
              for (m=1;m<=4;m++) {
                m1 = m;
                m2 = 0;
                if (m!=4) {
                    m3 = m+1;
                } else {
                    m3 = 1;
                }
                case_value = castab[sh[m1]+1][sh[m2]+1][sh[m3]+1];
                if (case_value!=0) {
                  switch (case_value) {
                    case 1: // Line between vertices 1 and 2
                      x1=xh[m1];
                      y1=yh[m1];
                      x2=xh[m2];
                      y2=yh[m2];
                      break;
                    case 2: // Line between vertices 2 and 3
                      x1=xh[m2];
                      y1=yh[m2];
                      x2=xh[m3];
                      y2=yh[m3];
                      break;
                    case 3: // Line between vertices 3 and 1
                      x1=xh[m3];
                      y1=yh[m3];
                      x2=xh[m1];
                      y2=yh[m1];
                      break;
                    case 4: // Line between vertex 1 and side 2-3
                      x1=xh[m1];
                      y1=yh[m1];
                      x2=xsect(m2,m3);
                      y2=ysect(m2,m3);
                      break;
                    case 5: // Line between vertex 2 and side 3-1
                      x1=xh[m2];
                      y1=yh[m2];
                      x2=xsect(m3,m1);
                      y2=ysect(m3,m1);
                      break;
                    case 6: //  Line between vertex 3 and side 1-2
                      x1=xh[m3];
                      y1=yh[m3];
                      x2=xsect(m1,m2);
                      y2=ysect(m1,m2);
                      break;
                    case 7: // Line between sides 1-2 and 2-3
                      x1=xsect(m1,m2);
                      y1=ysect(m1,m2);
                      x2=xsect(m2,m3);
                      y2=ysect(m2,m3);
                      break;
                    case 8: // Line between sides 2-3 and 3-1
                      x1=xsect(m2,m3);
                      y1=ysect(m2,m3);
                      x2=xsect(m3,m1);
                      y2=ysect(m3,m1);
                      break;
                    case 9: // Line between sides 3-1 and 1-2
                      x1=xsect(m3,m1);
                      y1=ysect(m3,m1);
                      x2=xsect(m1,m2);
                      y2=ysect(m1,m2);
                      break;
                    default:
                      break;
                  }
                  // Put your processing code here and comment out the printf
                  //printf("%f %f %f %f %f\n",x1,y1,x2,y2,z[k]);
                  drawContour(x1,y1,x2,y2,z[k],k);
                }
              }
            }
          }
        }
      }
    }
  }

},{}],102:[function(require,module,exports){
//https://github.com/jasondavies/conrec.js
//http://stackoverflow.com/questions/263305/drawing-a-topographical-map
var tin = require('turf-tin');
var inside = require('turf-inside');
var grid = require('turf-grid');
var extent = require('turf-extent');
var planepoint = require('turf-planepoint');
var featurecollection = require('turf-featurecollection');
var linestring = require('turf-linestring');
var square = require('turf-square');
var Conrec = require('./conrec');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features with z-values and an array of
 * value breaks and generates [isolines](http://en.wikipedia.org/wiki/Isoline).
 *
 * @module turf/isolines
 * @category interpolation
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} z the property name in `points` from which z-values will be pulled
 * @param {number} resolution resolution of the underlying grid
 * @param {number[]} breaks where to draw contours
 * @returns {FeatureCollection} a FeatureCollection of {@link LineString} features representing isolines
 * @example
 * // create random points with random
 * // z-values in their properties
 * var points = turf.random('point', 100, {
 *   bbox: [0, 30, 20, 50]
 * });
 * for (var i = 0; i < points.features.length; i++) {
 *   points.features[i].properties.z = Math.random() * 10;
 * }
 * var breaks = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
 * var isolined = turf.isolines(points, 'z', 15, breaks);
 * //=isolined
 */
module.exports = function(points, z, resolution, breaks, done){
  var tinResult = tin(points, z);
  var extentBBox = extent(points);
  var squareBBox = square(extentBBox);
  var gridResult = grid(squareBBox, resolution);
  var data = [];

  for (var i = 0; i < gridResult.features.length; i++) {
    var pt = gridResult.features[i];
    for (var j = 0; j < tinResult.features.length; j++) {
      var triangle = tinResult.features[j];
      if (inside(pt, triangle)) {
        pt.properties = {};
        pt.properties[z] = planepoint(pt, triangle);
      }
    }
  }

  var depth = Math.sqrt(gridResult.features.length);
  for (var x=0; x<depth; x++){
    var xGroup = gridResult.features.slice(x * depth, (x + 1) * depth);
    var xFlat = [];
    xGroup.forEach(function(verticalPoint){
      if(verticalPoint.properties){
        xFlat.push(verticalPoint.properties[z]);
      } else{
        xFlat.push(0);
      }
    });
    data.push(xFlat);
  }
  var interval = (squareBBox[2] - squareBBox[0]) / depth;
  var xCoordinates = [];
  var yCoordinates = [];
  for (var x = 0; x < depth; x++) {
    xCoordinates.push(x * interval + squareBBox[0]);
    yCoordinates.push(x * interval + squareBBox[1]);
  }

  var c = new Conrec();
  c.contour(data, 0, resolution, 0, resolution, xCoordinates, yCoordinates, breaks.length, breaks);
  var contourList = c.contourList();

  var fc = featurecollection([]);
  contourList.forEach(function(c){
    if(c.length > 2){
      var polyCoordinates = [];
      c.forEach(function(coord){
        polyCoordinates.push([coord.x, coord.y]);
      });
      var poly = linestring(polyCoordinates);
      poly.properties = {};
      poly.properties[z] = c.level;

      fc.features.push(poly);
    }
  });

  return fc;
}




},{"./conrec":101,"turf-extent":89,"turf-featurecollection":91,"turf-grid":103,"turf-inside":95,"turf-linestring":109,"turf-planepoint":117,"turf-square":134,"turf-tin":137}],103:[function(require,module,exports){
var point = require('turf-point');

/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Point} features in a grid.
 *
 * @module turf/grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} depth how many cells to output
 * @return {FeatureCollection} grid as FeatureCollection with {@link Point} features
 * @example
 * var extent = [-70.823364, -33.553984, -70.473175, -33.302986];
 * var depth = 10;
 *
 * var grid = turf.grid(extent, depth);
 *
 * //=grid
 */
module.exports = function(extents, depth) {
  var xmin = extents[0];
  var ymin = extents[1];
  var xmax = extents[2];
  var ymax = extents[3];
  var interval = (xmax - xmin) / depth;
  var coords = [];
  var fc = {
    type: 'FeatureCollection',
    features: []
  };

  for (var x=0; x<=depth; x++){
    for (var y=0;y<=depth; y++){
      fc.features.push(point([(x * interval) + xmin, (y * interval) + ymin]));
    }
  }
  return fc;
}

},{"turf-point":121}],104:[function(require,module,exports){
var ss = require('simple-statistics');

/**
* Takes a {@FeatureCollection} of any type and returns an array of the [Jenks Natural breaks](http://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization)
* for a given property
* @module turf/jenks
* @param {FeatureCollection} input a FeatureCollection of any type
* @param {string} field the property in `input` on which to calculate Jenks natural breaks
* @param {number} numberOfBreaks number of classes in which to group the data
* @return {Array<number>} the break number for each class plus the minimum and maximum values
* @example
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.859733, 40.400424]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.83879, 40.401209]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.817848, 40.376889]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.840507, 40.386043]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [49.854583, 40.37532]
*       }
*     }
*   ]
* };
*
* var breaks = turf.jenks(points, 'population', 3);
*
* //=breaks
*/
module.exports = function(fc, field, num){
  var vals = [];
  var breaks = [];

  fc.features.forEach(function(feature){
    if(feature.properties[field]!==undefined){
      vals.push(feature.properties[field]);
    }
  });
  breaks = ss.jenks(vals, num);

  return breaks;
};

},{"simple-statistics":105}],105:[function(require,module,exports){
arguments[4][78][0].apply(exports,arguments)
},{"dup":78}],106:[function(require,module,exports){
/**
 * Takes a {@link Polygon} feature and returns a {@link FeatureCollection} of {@link Point} features at all self-intersections.
 *
 * @module turf/kinks
 * @category misc
 * @param {Polygon} polygon a Polygon feature
 * @returns {FeatureCollection} a FeatureCollection of {@link Point} features representing self-intersections
 * @example
 * var poly = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-12.034835, 8.901183],
 *       [-12.060413, 8.899826],
 *       [-12.03638, 8.873199],
 *       [-12.059383, 8.871418],
 *       [-12.034835, 8.901183]
 *     ]]
 *   }
 * };
 * 
 * var kinks = turf.kinks(poly);
 *
 * var resultFeatures = kinks.intersections.features.concat(poly);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */

var polygon = require('turf-polygon');
var point = require('turf-point');
var fc = require('turf-featurecollection');

module.exports = function(polyIn) {
  var poly;
  var results = {intersections: fc([]), fixed: null};
  if (polyIn.type === 'Feature') {
    poly = polyIn.geometry;
  } else {
    poly = polyIn;
  }
  var intersectionHash = {};
  poly.coordinates.forEach(function(ring1){
    poly.coordinates.forEach(function(ring2){
      for(var i = 0; i < ring1.length-1; i++) {
        for(var k = 0; k < ring2.length-1; k++) {
          var intersection = lineIntersects(ring1[i][0],ring1[i][1],ring1[i+1][0],ring1[i+1][1],
            ring2[k][0],ring2[k][1],ring2[k+1][0],ring2[k+1][1]);
          if(intersection) {
            results.intersections.features.push(point([intersection[0], intersection[1]]));
          }
        }
      }
    })
  })
  return results;
}


// modified from http://jsfiddle.net/justin_c_rounds/Gd2S2/light/
function lineIntersects(line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY) {
  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point
  var denominator, a, b, numerator1, numerator2, result = {
    x: null,
    y: null,
    onLine1: false,
    onLine2: false
  };
  denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY));
  if (denominator == 0) {
    if(result.x != null && result.y != null) {
      return result;
    } else {
      return false;
    }
  }
  a = line1StartY - line2StartY;
  b = line1StartX - line2StartX;
  numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b);
  numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b);
  a = numerator1 / denominator;
  b = numerator2 / denominator;

  // if we cast these lines infinitely in both directions, they intersect here:
  result.x = line1StartX + (a * (line1EndX - line1StartX));
  result.y = line1StartY + (a * (line1EndY - line1StartY));

  // if line1 is a segment and line2 is infinite, they intersect if:
  if (a > 0 && a < 1) {
    result.onLine1 = true;
  }
  // if line2 is a segment and line1 is infinite, they intersect if:
  if (b > 0 && b < 1) {
    result.onLine2 = true;
  }
  // if line1 and line2 are segments, they intersect if both of the above are true
  if(result.onLine1 && result.onLine2){
    return [result.x, result.y];
  }
  else {
    return false;
  }
}

},{"turf-featurecollection":91,"turf-point":121,"turf-polygon":122}],107:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');

/**
 * Takes a {@link LineString} feature and measures its length in the specified units.
 *
 * @module turf/line-distance
 * @category measurement
 * @param {LineString} Line to measure
 * @param {String} [units=miles] can be degrees, radians, miles, or kilometers
 * @return {Number} length of the LineString
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 *
 * var length = turf.lineDistance(line, 'miles');
 *
 * //=line
 *
 * //=length
 */

module.exports = function (line, units) {
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  var travelled = 0;
  for(var i = 0; i < coords.length - 1; i++) {
    travelled += distance(point(coords[i]), point(coords[i+1]), units);
  }
  return travelled;
}

},{"turf-distance":79,"turf-point":121}],108:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');
var linestring = require('turf-linestring');
var bearing = require('turf-bearing');
var destination = require('turf-destination');

/**
 * Slices a LineString at start and stop Points
 *
 * @module turf/line-slice
 *
 * @param {Point} Point to start the slice
 * @param {Point} Point to stop the slice
 * @param {LineString} Line to slice
 * @return {LineString} Sliced LineString
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 * var start = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-77.029609, 38.881946]
 *   }
 * };
 * var stop = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-77.021884, 38.889563]
 *   }
 * };
 * 
 * var sliced = turf.lineSlice(start, stop, line);
 *
 * //=line
 *
 * //=sliced
 */

module.exports = function (startPt, stopPt, line) {  
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  var startVertex = pointOnLine(startPt, coords);
  var stopVertex = pointOnLine(stopPt, coords);
  var ends;
  if(startVertex.properties.index <= stopVertex.properties.index) {
    ends = [startVertex, stopVertex];
  } else {
    ends = [stopVertex, startVertex];
  }
  var clipLine = linestring([ends[0].geometry.coordinates], {});
  for(var i = ends[0].properties.index+1; i < ends[1].properties.index+1; i++) {
    clipLine.geometry.coordinates.push(coords[i]);
  }
  clipLine.geometry.coordinates.push(ends[1].geometry.coordinates);
  return clipLine;
}

function pointOnLine (pt, coords) {
  var units = 'miles'
  var closestPt = point([Infinity, Infinity], {dist: Infinity});
  for(var i = 0; i < coords.length - 1; i++) {
    var start = point(coords[i])
    var stop = point(coords[i+1])
    //start
    start.properties.dist = distance(pt, start, units);
    //stop
    stop.properties.dist = distance(pt, stop, units);
    //perpendicular
    var direction = bearing(start, stop)
    var perpendicularPt = destination(pt, 1000 , direction + 90, units) // 1000 = gross
    var intersect = lineIntersects(
      pt.geometry.coordinates[0],
      pt.geometry.coordinates[1],
      perpendicularPt.geometry.coordinates[0],
      perpendicularPt.geometry.coordinates[1],
      start.geometry.coordinates[0],
      start.geometry.coordinates[1],
      stop.geometry.coordinates[0],
      stop.geometry.coordinates[1]
      );
    if(!intersect) {
      perpendicularPt = destination(pt, 1000 , direction - 90, units) // 1000 = gross
      intersect = lineIntersects(
        pt.geometry.coordinates[0],
        pt.geometry.coordinates[1],
        perpendicularPt.geometry.coordinates[0],
        perpendicularPt.geometry.coordinates[1],
        start.geometry.coordinates[0],
        start.geometry.coordinates[1],
        stop.geometry.coordinates[0],
        stop.geometry.coordinates[1]
        );
    }
    perpendicularPt.properties.dist = Infinity;
    var intersectPt;
    if(intersect) {
      var intersectPt = point(intersect);
      intersectPt.properties.dist = distance(pt, intersectPt, units);
    }
    
    if(start.properties.dist < closestPt.properties.dist) {
      closestPt = start;
      closestPt.properties.index = i;
    }
    if(stop.properties.dist < closestPt.properties.dist) {
     closestPt = stop;
     closestPt.properties.index = i;
    }
    if(intersectPt && intersectPt.properties.dist < closestPt.properties.dist){ 
      closestPt = intersectPt;
      closestPt.properties.index = i;
    }
  }
  
  return closestPt;
}

// modified from http://jsfiddle.net/justin_c_rounds/Gd2S2/light/
function lineIntersects(line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY) {
  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point
  var denominator, a, b, numerator1, numerator2, result = {
    x: null,
    y: null,
    onLine1: false,
    onLine2: false
  };
  denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY));
  if (denominator == 0) {
    if(result.x != null && result.y != null) {
      return result;
    } else {
      return false;
    }
  }
  a = line1StartY - line2StartY;
  b = line1StartX - line2StartX;
  numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b);
  numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b);
  a = numerator1 / denominator;
  b = numerator2 / denominator;

  // if we cast these lines infinitely in both directions, they intersect here:
  result.x = line1StartX + (a * (line1EndX - line1StartX));
  result.y = line1StartY + (a * (line1EndY - line1StartY));

  // if line1 is a segment and line2 is infinite, they intersect if:
  if (a > 0 && a < 1) {
    result.onLine1 = true;
  }
  // if line2 is a segment and line1 is infinite, they intersect if:
  if (b > 0 && b < 1) {
    result.onLine2 = true;
  }
  // if line1 and line2 are segments, they intersect if both of the above are true
  if(result.onLine1 && result.onLine2){
    return [result.x, result.y];
  }
  else {
    return false;
  }
}

},{"turf-bearing":32,"turf-destination":76,"turf-distance":79,"turf-linestring":109,"turf-point":121}],109:[function(require,module,exports){
/**
 * Creates a {@link LineString} {@link Feature} based on a
 * coordinate array. Properties can be added optionally.
 *
 * @module turf/linestring
 * @category helper
 * @param {Array<Array<Number>>} coordinates an array of Positions
 * @param {Object} properties an Object of key-value pairs to add as properties
 * @return {LineString} a LineString feature
 * @throws {Error} if no coordinates are passed
 * @example
 * var linestring1 = turf.linestring([
 *	[-21.964416, 64.148203],
 *	[-21.956176, 64.141316],
 *	[-21.93901, 64.135924],
 *	[-21.927337, 64.136673]
 * ]);
 * var linestring2 = turf.linestring([
 *	[-21.929054, 64.127985],
 *	[-21.912918, 64.134726],
 *	[-21.916007, 64.141016],
 * 	[-21.930084, 64.14446]
 * ], {name: 'line 1', distance: 145});
 *
 * //=linestring1
 *
 * //=linestring2
 */
module.exports = function(coordinates, properties){
  if (!coordinates) {
      throw new Error('No coordinates passed');
  }
  return {
    "type": "Feature",
    "geometry": {
      "type": "LineString",
      "coordinates": coordinates
    },
    "properties": properties || {}
  };
};

},{}],110:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the maximum value of a field for a set of {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/max
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} inField the field in input data to analyze
 * @param {string} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField` values
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [101.551437, 3.150114],
 *           [101.551437, 3.250208],
 *           [101.742324, 3.250208],
 *           [101.742324, 3.150114],
 *           [101.551437, 3.150114]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [101.659927, 3.011612],
 *           [101.659927, 3.143944],
 *           [101.913986, 3.143944],
 *           [101.913986, 3.011612],
 *           [101.659927, 3.011612]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.56105, 3.213874]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.709365, 3.211817]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.645507, 3.169311]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.708679, 3.071266]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [101.826782, 3.081551]
 *       }
 *     }
 *   ]
 * };
 *
 * var aggregated = turf.max(
 *   polygons, points, 'population', 'max');
 *
 * var resultFeatures = points.features.concat(
 *   aggregated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = max(values);
  });

  return polyFC;
}

function max(x) {
    var value;
    for (var i = 0; i < x.length; i++) {
        // On the first iteration of this loop, max is
        // undefined and is thus made the maximum element in the array
        if (x[i] > value || value === undefined) value = x[i];
    }
    return value;
}

},{"turf-inside":95}],111:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the median value of a field for a set of {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/median
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} inField the field in input data to analyze
 * @param {string} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField` values
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [18.400039, -33.970697],
 *           [18.400039, -33.818518],
 *           [18.665771, -33.818518],
 *           [18.665771, -33.970697],
 *           [18.400039, -33.970697]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [18.538742, -34.050383],
 *           [18.538742, -33.98721],
 *           [18.703536, -33.98721],
 *           [18.703536, -34.050383],
 *           [18.538742, -34.050383]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.514022, -33.860152]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.48999, -33.926269]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.583374, -33.905755]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.591613, -34.024778]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [18.653411, -34.017949]
 *       }
 *     }
 *   ]
 * };
 *
 * var medians = turf.median(
 *  polygons, points, 'population', 'median');
 *
 * var resultFeatures = points.features.concat(
 *   medians.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = median(values);
  });

  return polyFC;
};

function median(x) {
    // The median of an empty list is null
    if (x.length === 0) return null;

    // Sorting the array makes it easy to find the center, but
    // use `.slice()` to ensure the original array `x` is not modified
    var sorted = x.slice().sort(function (a, b) { return a - b; });

    // If the length of the list is odd, it's the central number
    if (sorted.length % 2 === 1) {
        return sorted[(sorted.length - 1) / 2];
    // Otherwise, the median is the average of the two numbers
    // at the center of the list
    } else {
        var a = sorted[(sorted.length / 2) - 1];
        var b = sorted[(sorted.length / 2)];
        return (a + b) / 2;
    }
}

},{"turf-inside":95}],112:[function(require,module,exports){
var clone = require('clone');
var union = require('turf-union');

/**
 * Takes a {@link FeatureCollection} of {@link Polygon} features and returns a single merged
 * polygon feature. If the input Polygon features are not contiguous, this function returns a {@link MultiPolygon} feature.
 * @module turf/merge
 * @category transformation
 * @param {FeatureCollection} fc a FeatureCollection of {@link Polygon} features
 * @return {Feature} a {@link Polygon} or {@link MultiPolygon} feature
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "fill": "#0f0"
 *       },
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [9.994812, 53.549487],
 *           [10.046997, 53.598209],
 *           [10.117721, 53.531737],
 *           [9.994812, 53.549487]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "fill": "#00f"
 *       },
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [10.000991, 53.50418],
 *           [10.03807, 53.562539],
 *           [9.926834, 53.551731],
 *           [10.000991, 53.50418]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 *
 * var merged = turf.merge(polygons);
 *
 * //=polygons
 *
 * //=merged
 */
module.exports = function(polygons, done){

  var merged = clone(polygons.features[0]),
    features = polygons.features;

  for (var i = 0, len = features.length; i < len; i++) {
    var poly = features[i];

    if(poly.geometry){
      merged = union(merged, poly);
    }
  }

  return merged;
};

},{"clone":113,"turf-union":139}],113:[function(require,module,exports){
(function (Buffer){
'use strict';

function objectToString(o) {
  return Object.prototype.toString.call(o);
}

// shim for Node's 'util' package
// DO NOT REMOVE THIS! It is required for compatibility with EnderJS (http://enderjs.com/).
var util = {
  isArray: function (ar) {
    return Array.isArray(ar) || (typeof ar === 'object' && objectToString(ar) === '[object Array]');
  },
  isDate: function (d) {
    return typeof d === 'object' && objectToString(d) === '[object Date]';
  },
  isRegExp: function (re) {
    return typeof re === 'object' && objectToString(re) === '[object RegExp]';
  },
  getRegExpFlags: function (re) {
    var flags = '';
    re.global && (flags += 'g');
    re.ignoreCase && (flags += 'i');
    re.multiline && (flags += 'm');
    return flags;
  }
};


if (typeof module === 'object')
  module.exports = clone;

/**
 * Clones (copies) an Object using deep copying.
 *
 * This function supports circular references by default, but if you are certain
 * there are no circular references in your object, you can save some CPU time
 * by calling clone(obj, false).
 *
 * Caution: if `circular` is false and `parent` contains circular references,
 * your program may enter an infinite loop and crash.
 *
 * @param `parent` - the object to be cloned
 * @param `circular` - set to true if the object to be cloned may contain
 *    circular references. (optional - true by default)
 * @param `depth` - set to a number if the object is only to be cloned to
 *    a particular depth. (optional - defaults to Infinity)
 * @param `prototype` - sets the prototype to be used when cloning an object.
 *    (optional - defaults to parent prototype).
*/

function clone(parent, circular, depth, prototype) {
  // maintain two arrays for circular references, where corresponding parents
  // and children have the same index
  var allParents = [];
  var allChildren = [];

  var useBuffer = typeof Buffer != 'undefined';

  if (typeof circular == 'undefined')
    circular = true;

  if (typeof depth == 'undefined')
    depth = Infinity;

  // recurse this function so we don't reset allParents and allChildren
  function _clone(parent, depth) {
    // cloning null always returns null
    if (parent === null)
      return null;

    if (depth == 0)
      return parent;

    var child;
    var proto;
    if (typeof parent != 'object') {
      return parent;
    }

    if (util.isArray(parent)) {
      child = [];
    } else if (util.isRegExp(parent)) {
      child = new RegExp(parent.source, util.getRegExpFlags(parent));
      if (parent.lastIndex) child.lastIndex = parent.lastIndex;
    } else if (util.isDate(parent)) {
      child = new Date(parent.getTime());
    } else if (useBuffer && Buffer.isBuffer(parent)) {
      child = new Buffer(parent.length);
      parent.copy(child);
      return child;
    } else {
      if (typeof prototype == 'undefined') {
        proto = Object.getPrototypeOf(parent);
        child = Object.create(proto);
      }
      else {
        child = Object.create(prototype);
        proto = prototype;
      }
    }

    if (circular) {
      var index = allParents.indexOf(parent);

      if (index != -1) {
        return allChildren[index];
      }
      allParents.push(parent);
      allChildren.push(child);
    }

    for (var i in parent) {
      var attrs;
      if (proto) {
        attrs = Object.getOwnPropertyDescriptor(proto, i);
      }
      
      if (attrs && attrs.set == null) {
        continue;
      }
      child[i] = _clone(parent[i], depth - 1);
    }

    return child;
  }

  return _clone(parent, depth);
}

/**
 * Simple flat clone using prototype, accepts only objects, usefull for property
 * override on FLAT configuration object (no nested props).
 *
 * USE WITH CAUTION! This may not behave as you wish if you do not know how this
 * works.
 */
clone.clonePrototype = function(parent) {
  if (parent === null)
    return null;

  var c = function () {};
  c.prototype = parent;
  return new c();
};

}).call(this,require("buffer").Buffer)

},{"buffer":10}],114:[function(require,module,exports){
// http://cs.selu.edu/~rbyrd/math/midpoint/
// ((x1+x2)/2), ((y1+y2)/2)
var point = require('turf-point');

/**
 * Takes two {@link Point} features and returns a Point midway between the two.
 *
 * @module turf/midpoint
 * @category measurement
 * @param {Point} pt1 first point
 * @param {Point} pt2 second point
 * @return {Point} a point between the two
 * @example
 * var pt1 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [144.834823, -37.771257]
 *   }
 * };
 * var pt2 = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [145.14244, -37.830937]
 *   }
 * };
 *
 * var midpointed = turf.midpoint(pt1, pt2);
 * midpointed.properties['marker-color'] = '#f00';
 *
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [pt1, pt2, midpointed]
 * };
 *
 * //=result
 */
module.exports = function(point1, point2) {
  if (point1 === null || point2 === null){
    throw new Error('Less than two points passed.');
  }

  var x1 = point1.geometry.coordinates[0];
  var x2 = point2.geometry.coordinates[0];
  var y1 = point1.geometry.coordinates[1];
  var y2 = point2.geometry.coordinates[1];

  var x3 = x1 + x2;
  var midX = x3/2;
  var y3 = y1 + y2;
  var midY = y3/2;

  return point([midX, midY]);
};

},{"turf-point":121}],115:[function(require,module,exports){
var inside = require('turf-inside');

/**
* Calculates the minimum value of a field for {@link Point} features within a set of {@link Polygon} features.
*
* @module turf/min
* @category aggregation
* @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
* @param {FeatureCollection} points a FeatureCollection of {@link Point} features
* @param {string} inField the field in input data to analyze
* @param {string} outField the field in which to store results
* @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
* with properties listed as `outField` values
* @example
* var polygons = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [72.809658, 18.961818],
*           [72.809658, 18.974805],
*           [72.827167, 18.974805],
*           [72.827167, 18.961818],
*           [72.809658, 18.961818]
*         ]]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {},
*       "geometry": {
*         "type": "Polygon",
*         "coordinates": [[
*           [72.820987, 18.947043],
*           [72.820987, 18.95922],
*           [72.841243, 18.95922],
*           [72.841243, 18.947043],
*           [72.820987, 18.947043]
*         ]]
*       }
*     }
*   ]
* };
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.814464, 18.971396]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.820043, 18.969772]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.817296, 18.964253]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.83575, 18.954837]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [72.828197, 18.95094]
*       }
*     }
*   ]
* };
*
* var minimums = turf.min(
*   polygons, points, 'population', 'min');
*
* var resultFeatures = points.features.concat(
*   minimums.features);
* var result = {
*   "type": "FeatureCollection",
*   "features": resultFeatures
* };
*
* //=result
*/
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = min(values);
  });

  return polyFC;
};

function min(x) {
    var value;
    for (var i = 0; i < x.length; i++) {
        // On the first iteration of this loop, min is
        // undefined and is thus made the minimum element in the array
        if (x[i] < value || value === undefined) value = x[i];
    }
    return value;
}

},{"turf-inside":95}],116:[function(require,module,exports){
var distance = require('turf-distance');

/**
 * Takes a {@link Point} feature and a {@link FeatureCollection} of Point features and returns the Point feature from the FeatureCollection closest to the input point.
 *
 * @module turf/nearest
 * @category classification
 * @param {Point} point the reference point
 * @param {FeatureCollection} against a FeatureCollection of Point features
 * @return {Feature} the closest Point feature in `against` to `point`
 * @example
 * var point = {
 *   "type": "Feature",
 *   "properties": {
 *     "marker-color": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [28.965797, 41.010086]
 *   }
 * };
 * var against = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [28.973865, 41.011122]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [28.948459, 41.024204]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [28.938674, 41.013324]
 *       }
 *     }
 *   ]
 * };
 *
 * var nearest = turf.nearest(point, against);
 * nearest.properties['marker-color'] = '#f00';
 *
 * var resultFeatures = against.features.concat(point);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(targetPoint, points){
  var nearestPoint;
  var count = 0;
  var dist = Infinity;
  points.features.forEach(function(pt){
    if(!nearestPoint){
      nearestPoint = pt;
      var dist = distance(targetPoint, pt, 'miles');
      nearestPoint.properties.distance = dist;
    }
    else{
      var dist = distance(targetPoint, pt, 'miles');
      if(dist < nearestPoint.properties.distance){
        nearestPoint = pt;
        nearestPoint.properties.distance = dist;
      }
    }
  });
  delete nearestPoint.properties.distance;
  return nearestPoint;
}

},{"turf-distance":79}],117:[function(require,module,exports){
/**
 * Takes a triangular plane as a {@link Polygon} feature
 * and a {@link Point} feature within that triangle and returns the z-value
 * at that point. The Polygon needs to have properties `a`, `b`, and `c`
 * that define the values at its three corners.
 *
 * @module turf/planepoint
 * @category interpolation
 * @param {Point} interpolatedPoint the Point for which a z-value will be calculated
 * @param {Polygon} triangle a Polygon feature with three vertices
 * @return {number} the z-value for `interpolatedPoint`
 * @example
 * var point = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-75.3221, 39.529]
 *   }
 * };
 * var point = turf.point([-75.3221, 39.529]);
 * // triangle is a polygon with "a", "b",
 * // and "c" values representing
 * // the values of the coordinates in order.
 * var triangle = {
 *   "type": "Feature",
 *   "properties": {
 *     "a": 11,
 *     "b": 122,
 *     "c": 44
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-75.1221, 39.57],
 *       [-75.58, 39.18],
 *       [-75.97, 39.86],
 *       [-75.1221, 39.57]
 *     ]]
 *   }
 * };
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [triangle, point]
 * };
 *
 * var zValue = turf.planepoint(point, triangle);
 *
 * //=features
 *
 * //=zValue
 */
module.exports = function(point, triangle){
  var x = point.geometry.coordinates[0],
      y = point.geometry.coordinates[1],
      x1 = triangle.geometry.coordinates[0][0][0],
      y1 = triangle.geometry.coordinates[0][0][1],
      z1 = triangle.properties.a,
      x2 = triangle.geometry.coordinates[0][1][0],
      y2 = triangle.geometry.coordinates[0][1][1],
      z2 = triangle.properties.b,
      x3 = triangle.geometry.coordinates[0][2][0],
      y3 = triangle.geometry.coordinates[0][2][1],
      z3 = triangle.properties.c;

  var z = (z3 * (x-x1) * (y-y2) + z1 * (x-x2) * (y-y3) + z2 * (x-x3) * (y-y1) -
      z2 * (x-x1) * (y-y3) - z3 * (x-x2) * (y-y1) - z1 * (x-x3) * (y-y2)) /
      ((x-x1) * (y-y2) + (x-x2) * (y-y3) +(x-x3) * (y-y1) -
       (x-x1) * (y-y3) - (x-x2) * (y-y1) - (x-x3) * (y-y2));

  return z;
};

},{}],118:[function(require,module,exports){
var point = require('turf-point');
var featurecollection = require('turf-featurecollection');
var distance = require('turf-distance');
/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Point} features in a grid.
 *
 * @module turf/point-grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} depth how many cells to output
 * @return {FeatureCollection} grid as FeatureCollection with {@link Point} features
 * @example
 * var extent = [-70.823364, -33.553984, -70.473175, -33.302986];
 * var depth = 10;
 *
 * var grid = turf.pointGrid(extent, depth);
 *
 * //=grid
 */
module.exports = function (bbox, cell, units) {
  var fc = featurecollection([]);
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);

  var currentX = bbox[0];
  while (currentX <= bbox[2]) {
    var currentY = bbox[1];
    while (currentY <= bbox[3]) {
      fc.features.push(point([currentX, currentY]));

      currentY += cellHeight;
    }
    currentX += cellWidth;
  }
  
  return fc;
}
},{"turf-distance":79,"turf-featurecollection":91,"turf-point":121}],119:[function(require,module,exports){
var distance = require('turf-distance');
var point = require('turf-point');
var linestring = require('turf-linestring');
var bearing = require('turf-bearing');
var destination = require('turf-destination');

/**
 * Takes a Point and a LineString and calculates the closest Point on the LineString
 *
 * @module turf/point-on-line
 *
 * @param {LineString} Line to snap to
 * @param {Point} Point to snap from
 * @return {Point} Closest Point on the Line
 * @example
 * var line = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "LineString",
 *     "coordinates": [
 *       [-77.031669, 38.878605],
 *       [-77.029609, 38.881946],
 *       [-77.020339, 38.884084],
 *       [-77.025661, 38.885821],
 *       [-77.021884, 38.889563],
 *       [-77.019824, 38.892368]
 *     ]
 *   }
 * };
 * var pt = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Point",
 *     "coordinates": [-77.037076, 38.884017]
 *   }
 * };
 * 
 * var snapped = turf.pointOnLine(line, pt);
 * snapped.properties['marker-color'] = '#00f'
 *
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": [line, pt, snapped]
 * };
 *
 * //=result
 */

module.exports = function (line, pt) {  
  var coords;
  if(line.type === 'Feature') coords = line.geometry.coordinates;
  else if(line.type === 'LineString') coords = line.geometry.coordinates;
  else throw new Error('input must be a LineString Feature or Geometry');

  return pointOnLine(pt, coords);
}

function pointOnLine (pt, coords) {
  var units = 'miles'
  var closestPt = point([Infinity, Infinity], {dist: Infinity});
  for(var i = 0; i < coords.length - 1; i++) {
    var start = point(coords[i])
    var stop = point(coords[i+1])
    //start
    start.properties.dist = distance(pt, start, units);
    //stop
    stop.properties.dist = distance(pt, stop, units);
    //perpendicular
    var direction = bearing(start, stop)
    var perpendicularPt = destination(pt, 1000 , direction + 90, units) // 1000 = gross
    var intersect = lineIntersects(
      pt.geometry.coordinates[0],
      pt.geometry.coordinates[1],
      perpendicularPt.geometry.coordinates[0],
      perpendicularPt.geometry.coordinates[1],
      start.geometry.coordinates[0],
      start.geometry.coordinates[1],
      stop.geometry.coordinates[0],
      stop.geometry.coordinates[1]
      );
    if(!intersect) {
      perpendicularPt = destination(pt, 1000 , direction - 90, units) // 1000 = gross
      intersect = lineIntersects(
        pt.geometry.coordinates[0],
        pt.geometry.coordinates[1],
        perpendicularPt.geometry.coordinates[0],
        perpendicularPt.geometry.coordinates[1],
        start.geometry.coordinates[0],
        start.geometry.coordinates[1],
        stop.geometry.coordinates[0],
        stop.geometry.coordinates[1]
        );
    }
    perpendicularPt.properties.dist = Infinity;
    var intersectPt;
    if(intersect) {
      var intersectPt = point(intersect);
      intersectPt.properties.dist = distance(pt, intersectPt, units);
    }
    
    if(start.properties.dist < closestPt.properties.dist) {
      closestPt = start;
      closestPt.properties.index = i;
    }
    if(stop.properties.dist < closestPt.properties.dist) {
     closestPt = stop;
     closestPt.properties.index = i;
    }
    if(intersectPt && intersectPt.properties.dist < closestPt.properties.dist){ 
      closestPt = intersectPt;
      closestPt.properties.index = i;
    }
  }
  
  return closestPt;
}

// modified from http://jsfiddle.net/justin_c_rounds/Gd2S2/light/
function lineIntersects(line1StartX, line1StartY, line1EndX, line1EndY, line2StartX, line2StartY, line2EndX, line2EndY) {
  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point
  var denominator, a, b, numerator1, numerator2, result = {
    x: null,
    y: null,
    onLine1: false,
    onLine2: false
  };
  denominator = ((line2EndY - line2StartY) * (line1EndX - line1StartX)) - ((line2EndX - line2StartX) * (line1EndY - line1StartY));
  if (denominator == 0) {
    if(result.x != null && result.y != null) {
      return result;
    } else {
      return false;
    }
  }
  a = line1StartY - line2StartY;
  b = line1StartX - line2StartX;
  numerator1 = ((line2EndX - line2StartX) * a) - ((line2EndY - line2StartY) * b);
  numerator2 = ((line1EndX - line1StartX) * a) - ((line1EndY - line1StartY) * b);
  a = numerator1 / denominator;
  b = numerator2 / denominator;

  // if we cast these lines infinitely in both directions, they intersect here:
  result.x = line1StartX + (a * (line1EndX - line1StartX));
  result.y = line1StartY + (a * (line1EndY - line1StartY));

  // if line1 is a segment and line2 is infinite, they intersect if:
  if (a > 0 && a < 1) {
    result.onLine1 = true;
  }
  // if line2 is a segment and line1 is infinite, they intersect if:
  if (b > 0 && b < 1) {
    result.onLine2 = true;
  }
  // if line1 and line2 are segments, they intersect if both of the above are true
  if(result.onLine1 && result.onLine2){
    return [result.x, result.y];
  }
  else {
    return false;
  }
}

},{"turf-bearing":32,"turf-destination":76,"turf-distance":79,"turf-linestring":109,"turf-point":121}],120:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');
var centroid = require('turf-center');
var distance = require('turf-distance');
var inside = require('turf-inside');
var explode = require('turf-explode');

/**
 * Finds a {@link Point} guaranteed to be on the surface of
 * {@link GeoJSON} object.
 *
 * * Given a {@link Polygon}, the point will be in the area of the polygon
 * * Given a {@link LineString}, the point will be along the string
 * * Given a {@link Point}, the point will the same as the input
 *
 * @module turf/point-on-surface
 * @category measurement
 * @param {GeoJSON} input any GeoJSON object
 * @returns {Feature} a point on the surface of `input`
 * @example
 * // create a random polygon
 * var polygon = turf.random('polygon');
 *
 * //=polygon
 *
 * var pointOnPolygon = turf.pointOnSurface(polygon);
 *
* var resultFeatures = polygon.features.concat(pointOnPolygon);
* var result = {
*   "type": "FeatureCollection",
*   "features": resultFeatures
* };
 *
 * //=result
 */
module.exports = function(fc) {
  // normalize
  if(fc.type != 'FeatureCollection') {
    if(fc.type != 'Feature') {
      fc = {
        type: 'Feature',
        geometry: fc,
        properties: {}
      };
    }
    fc = featureCollection([fc]);
  }

  //get centroid
  var cent = centroid(fc);

  // check to see if centroid is on surface
  var onSurface = false;
  var i = 0;
  while(!onSurface && i < fc.features.length) {
    var geom = fc.features[i].geometry;
    if (geom.type === 'Point') {
      if (cent.geometry.coordinates[0] === geom.coordinates[0] &&
        cent.geometry.coordinates[1] === geom.coordinates[1]) {
        onSurface = true;
      }
    } else if(geom.type === 'MultiPoint') {
      var onMultiPoint = false;
      var k = 0;
      while(!onMultiPoint && k < geom.coordinates.length) {
        if (cent.geometry.coordinates[0] === geom.coordinates[k][0] &&
          cent.geometry.coordinates[1] === geom.coordinates[k][1]) {
          onSurface = true;
          onMultiPoint = true;
        }
        k++;
      }
    } else if(geom.type === 'LineString') {
      var onLine = false;
      var k = 0;
      while(!onLine && k < geom.coordinates.length - 1) {
        var x = cent.geometry.coordinates[0];
        var y = cent.geometry.coordinates[1];
        var x1 = geom.coordinates[k][0];
        var y1 = geom.coordinates[k][1];
        var x2 = geom.coordinates[k+1][0];
        var y2 = geom.coordinates[k+1][1];
        if(pointOnSegment(x, y, x1, y1, x2, y2)) {
          onLine = true;
          onSurface = true;
        }
        k++;
      }
    } else if(geom.type === 'MultiLineString') {
      var onMultiLine = false;
      var j = 0;
      while(!onMultiLine && j < geom.coordinates.length) {
        var onLine = false;
        var k = 0;
        var line = geom.coordinates[j];
        while(!onLine && k < line.length - 1) {
          var x = cent.geometry.coordinates[0];
          var y = cent.geometry.coordinates[1];
          var x1 = line[k][0];
          var y1 = line[k][1];
          var x2 = line[k+1][0];
          var y2 = line[k+1][1];
          if(pointOnSegment(x, y, x1, y1, x2, y2)) {
            onLine = true;
            onSurface = true;
          }
          k++;
        }
        j++;
      }
    } else if(geom.type === 'Polygon' || geom.type === 'MultiPolygon') {
      var f = {
        type: 'Feature',
        geometry: geom,
        properties: {}
      };
      if(inside(cent, f)) {
        onSurface = true;
      }
    }
    i++;
  }
  if(onSurface) {
    return cent;
  } else {
    var vertices = featureCollection([]);
    for(var i = 0; i < fc.features.length; i++) {
      vertices.features = vertices.features.concat(explode(fc.features[i]).features);
    }
    var closestVertex;
    var closestDistance = Infinity;
    for(var i = 0; i < vertices.features.length; i++) {
      var dist = distance(cent, vertices.features[i], 'miles');
      if(dist < closestDistance) {
        closestDistance = dist;
        closestVertex = vertices.features[i];
      }
    }
    return closestVertex;
  }
};

function pointOnSegment (x, y, x1, y1, x2, y2) {
  var ab = Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));
  var ap = Math.sqrt((x-x1)*(x-x1)+(y-y1)*(y-y1));
  var pb = Math.sqrt((x2-x)*(x2-x)+(y2-y)*(y2-y));
  if(ab === ap + pb) {
    return true;
  }
}

},{"turf-center":40,"turf-distance":79,"turf-explode":87,"turf-featurecollection":91,"turf-inside":95}],121:[function(require,module,exports){
/**
 * Takes coordinates and properties (optional) and returns a new {@link Point} feature.
 *
 * @module turf/point
 * @category helper
 * @param {number} longitude position west to east in decimal degrees
 * @param {number} latitude position south to north in decimal degrees
 * @param {Object} properties an Object that is used as the {@link Feature}'s
 * properties
 * @return {Point} a Point feature
 * @example
 * var pt1 = turf.point([-75.343, 39.984]);
 *
 * //=pt1
 */
var isArray = Array.isArray || function(arg) {
  return Object.prototype.toString.call(arg) === '[object Array]';
};
module.exports = function(coordinates, properties) {
  if (!isArray(coordinates)) throw new Error('Coordinates must be an array');
  if (coordinates.length < 2) throw new Error('Coordinates must be at least 2 numbers long');
  return {
    type: "Feature",
    geometry: {
      type: "Point",
      coordinates: coordinates
    },
    properties: properties || {}
  };
};

},{}],122:[function(require,module,exports){
/**
 * Takes an array of LinearRings and optionally an {@link Object} with properties and returns a GeoJSON {@link Polygon} feature.
 *
 * @module turf/polygon
 * @category helper
 * @param {Array<Array<Number>>} rings an array of LinearRings
 * @param {Object} properties an optional properties object
 * @return {Polygon} a Polygon feature
 * @throws {Error} throw an error if a LinearRing of the polygon has too few positions
 * or if a LinearRing of the Polygon does not have matching Positions at the
 * beginning & end.
 * @example
 * var polygon = turf.polygon([[
 *  [-2.275543, 53.464547],
 *  [-2.275543, 53.489271],
 *  [-2.215118, 53.489271],
 *  [-2.215118, 53.464547],
 *  [-2.275543, 53.464547]
 * ]], { name: 'poly1', population: 400});
 *
 * //=polygon
 */
module.exports = function(coordinates, properties){

  if (coordinates === null) throw new Error('No coordinates passed');

  for (var i = 0; i < coordinates.length; i++) {
    var ring = coordinates[i];
    for (var j = 0; j < ring[ring.length - 1].length; j++) {
      if (ring.length < 4) {
        throw new Error('Each LinearRing of a Polygon must have 4 or more Positions.');
      }
      if (ring[ring.length - 1][j] !== ring[0][j]) {
        throw new Error('First and last Position are not equivalent.');
      }
    }
  }

  var polygon = {
    "type": "Feature",
    "geometry": {
      "type": "Polygon",
      "coordinates": coordinates
    },
    "properties": properties
  };

  if (!polygon.properties) {
    polygon.properties = {};
  }

  return polygon;
};

},{}],123:[function(require,module,exports){
var ss = require('simple-statistics');

/**
* Takes a {@link FeatureCollection}, a property name, and a set of percentiles and returns a quantile array.
* @module turf/quantile
* @category classification
* @param {FeatureCollection} input a FeatureCollection of any type
* @param {String} field the property in `input` from which to retrieve quantile values
* @param {Array<number>} percentiles an Array of percentiles on which to calculate quantile values
* @return {Array<number>} an array of the break values
* @example
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 5
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [5, 5]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 40
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [1, 3]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 80
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [14, 2]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 90
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13, 1]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [19, 7]
*       }
*     }
*   ]
* };
*
* var breaks = turf.quantile(
*   points, 'population', [25, 50, 75, 99]);
*
* //=breaks
*/
module.exports = function(fc, field, percentiles){
  var vals = [];
  var quantiles = [];

  fc.features.forEach(function(feature){
    vals.push(feature.properties[field]);
  });
  percentiles.forEach(function(percentile){
    quantiles.push(ss.quantile(vals, percentile * 0.01));
  });
  return quantiles;
};

},{"simple-statistics":124}],124:[function(require,module,exports){
arguments[4][78][0].apply(exports,arguments)
},{"dup":78}],125:[function(require,module,exports){
var random = require('geojson-random');

/**
 * Generates random {@link GeoJSON} data, including {@link Point|Points} and {@link Polygon|Polygons}, for testing
 * and experimentation.
 *
 * @module turf/random
 * @category data
 * @param {String} [type='point'] type of features desired: 'points' or 'polygons'
 * @param {Number} [count=1] how many geometries should be generated.
 * @param {Object} options options relevant to the feature desired. Can include:
 * @param {Array<number>} options.bbox a bounding box inside of which geometries
 * are placed. In the case of {@link Point} features, they are guaranteed to be within this bounds,
 * while {@link Polygon} features have their centroid within the bounds.
 * @param {Number} [options.num_vertices=10] options.vertices the number of vertices added
 * to polygon features.
 * @param {Number} [options.max_radial_length=10] the total number of decimal
 * degrees longitude or latitude that a polygon can extent outwards to
 * from its center.
 * @return {FeatureCollection} generated random features
 * @example
 * var points = turf.random('points', 100, {
 *   bbox: [-70, 40, -60, 60]
 * });
 *
 * //=points
 *
 * var polygons = turf.random('polygons', 4, {
 *   bbox: [-70, 40, -60, 60]
 * });
 *
 * //=polygons
 */
module.exports = function(type, count, options) {
    options = options || {};
    count = count || 1;
    switch (type) {
        case 'point':
        case 'points':
        case undefined:
            return random.point(count, options.bbox);
        case 'polygon':
        case 'polygons':
            return random.polygon(
                count,
                options.num_vertices,
                options.max_radial_length,
                options.bbox);
        default:
            throw new Error('Unknown type given: valid options are points and polygons');
    }
};

},{"geojson-random":126}],126:[function(require,module,exports){
module.exports = function() {
    throw new Error('call .point() or .polygon() instead');
};

function position(bbox) {
    if (bbox) return coordInBBBOX(bbox);
    else return [lon(), lat()];
}

module.exports.position = position;

module.exports.point = function(count, bbox) {
    var features = [];
    for (i = 0; i < count; i++) {
        features.push(feature(bbox ? point(position(bbox)) : point()));
    }
    return collection(features);
};

module.exports.polygon = function(count, num_vertices, max_radial_length, bbox) {
    if (typeof num_vertices !== 'number') num_vertices = 10;
    if (typeof max_radial_length !== 'number') max_radial_length = 10;
    var features = [];
    for (i = 0; i < count; i++) {
        var vertices = [],
            circle_offsets = Array.apply(null,
                new Array(num_vertices + 1)).map(Math.random);

        circle_offsets.forEach(sumOffsets);
        circle_offsets.forEach(scaleOffsets);
        vertices[vertices.length - 1] = vertices[0]; // close the ring

        // center the polygon around something
        vertices = vertices.map(vertexToCoordinate(position(bbox)));
        features.push(feature(polygon([vertices])));
    }

    function sumOffsets(cur, index, arr) {
        arr[index] = (index > 0) ? cur + arr[index - 1] : cur;
    }

    function scaleOffsets(cur, index) {
        cur = cur * 2 * Math.PI / circle_offsets[circle_offsets.length - 1];
        var radial_scaler = Math.random();
        vertices.push([
            radial_scaler * max_radial_length * Math.sin(cur),
            radial_scaler * max_radial_length * Math.cos(cur)
        ]);
    }

    return collection(features);
};


function vertexToCoordinate(hub) {
    return function(cur, index) { return [cur[0] + hub[0], cur[1] + hub[1]]; };
}

function rnd() { return Math.random() - 0.5; }
function lon() { return rnd() * 360; }
function lat() { return rnd() * 180; }

function point(coordinates) {
    return {
        type: 'Point',
        coordinates: coordinates || [lon(), lat()]
    };
}

function coordInBBBOX(bbox) {
    return [
        (Math.random() * (bbox[2] - bbox[0])) + bbox[0],
        (Math.random() * (bbox[3] - bbox[1])) + bbox[1]];
}

function pointInBBBOX() {
    return {
        type: 'Point',
        coordinates: [lon(), lat()]
    };
}

function polygon(coordinates) {
    return {
        type: 'Polygon',
        coordinates: coordinates
    };
}

function feature(geom) {
    return {
        type: 'Feature',
        geometry: geom,
        properties: {}
    };
}

function collection(f) {
    return {
        type: 'FeatureCollection',
        features: f
    };
}

},{}],127:[function(require,module,exports){
var featurecollection = require('turf-featurecollection');
var reclass = require('./index.js');

/**
 * Takes a {@link FeatureCollection}, an input field, an output field, and
 * an array of translations and outputs an identical FeatureCollection with
 * the output field property populated.
* @module turf/reclass
* @category classification
* @param {FeatureCollection} input a FeatureCollection of any type
* @param {string} inField the field to translate
* @param {string} outField the field in which to store translated results
* @param {Array<number>} translations an array of translations
* @return {FeatureCollection} a FeatureCollection with identical geometries to `input` but with `outField` populated.
* @example
* var points = {
*   "type": "FeatureCollection",
*   "features": [
*     {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.170547, 32.888669]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 600
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.182048, 32.889533]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 100
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.17398, 32.882182]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 200
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.174324, 32.895011]
*       }
*     }, {
*       "type": "Feature",
*       "properties": {
*         "population": 300
*       },
*       "geometry": {
*         "type": "Point",
*         "coordinates": [13.185825, 32.884344]
*       }
*     }
*   ]
* };
* // 0 to 200 will map to "small", 200 to 400 will map to "medium", 400 to 600 will map to "large"
* var translations = [
*   [0, 200, "small"],
*   [200, 400, "medium"],
*   [400, 600, "large"]
* ];
*
* var reclassed = turf.reclass(
*   points, 'population', 'size', translations);
*
* //=reclassed
*
*/
module.exports = function(fc, inField, outField, translations, done){
  var reclassed = featurecollection([]);

  fc.features.forEach(function(feature){
    var reclassedFeature;
    var found = false;
    for(var i = 0; i < translations.length; i++){
      if(feature.properties[inField] >= translations[i][0] && feature.properties[inField] <= translations[i][1]) {
        feature.properties[outField] = translations[i][2];
      }
    }
    reclassed.features.push(feature);
  });

  return reclassed;
};

},{"./index.js":127,"turf-featurecollection":91}],128:[function(require,module,exports){
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} of any type, a property, and a value and
 * returns a FeatureCollection with features matching that
 * property-value pair removed.
 *
 * @module turf/remove
 * @category data
 * @param {FeatureCollection} features a FeatureCollection of any type
 * @param {String} property the property to filter
 * @param {String} value the value to filter
 * @return {FeatureCollection} the resulting FeatureCollection without features that match the property-value pair
 * @example
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#00f'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.235004, 5.551918]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#f00'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.209598, 5.56439]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#00f'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.197753, 5.556018]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#000'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.217323, 5.549526]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#0f0'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.211315, 5.543887]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#00f'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.202217, 5.547134]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         'marker-color': '#0f0'
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-0.231227, 5.56644]
 *       }
 *     }
 *   ]
 * };
 *
 * //=points
 *
 * var filtered = turf.remove(points, 'marker-color', '#00f');
 *
 * //=filtered
*/
module.exports = function(collection, key, val) {
  var newFC = featureCollection([]);
  for(var i = 0; i < collection.features.length; i++) {
    if(collection.features[i].properties[key] != val) {
      newFC.features.push(collection.features[i]);
    }
  }
  return newFC;
};

},{"turf-featurecollection":91}],129:[function(require,module,exports){
// http://stackoverflow.com/questions/11935175/sampling-a-random-subset-from-an-array
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} and returns a FeatureCollection with given number of {@link Feature|features} at random.
 *
 * @module turf/sample
 * @category data
 * @param {FeatureCollection} features a FeatureCollection of any type
 * @param {number} n number of features to select
 * @return {FeatureCollection} a FeatureCollection with `n` features
 * @example
 * var points = turf.random('points', 1000);
 *
 * //=points
 *
 * var sample = turf.sample(points, 10);
 *
 * //=sample
 */
module.exports = function(fc, num){
  var outFC = featureCollection(getRandomSubarray(fc.features, num));
  return outFC;
};

function getRandomSubarray(arr, size) {
  var shuffled = arr.slice(0), i = arr.length, min = i - size, temp, index;
  while (i-- > min) {
      index = Math.floor((i + 1) * Math.random());
      temp = shuffled[index];
      shuffled[index] = shuffled[i];
      shuffled[i] = temp;
  }
  return shuffled.slice(min);
}

},{"turf-featurecollection":91}],130:[function(require,module,exports){
var simplify = require('simplify-js');

/**
 * Takes a {@link LineString} or {@link Polygon} feature and returns a simplified version. Internally uses [simplify-js](http://mourner.github.io/simplify-js/) to perform simplification.
 *
 * @module turf/simplify
 * @category transformation
 * @param {Feature} feature a {@link LineString} or {@link Polygon} feature to be simplified
 * @param {number} tolerance simplification tolerance
 * @param {boolean} highQuality whether or not to spend more time to create
 * a higher-quality simplification with a different algorithm
 * @return {Feature} a simplified feature
 * @example
  * var feature = {
 *   "type": "Feature",
 *   "properties": {},
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-70.603637, -33.399918],
 *       [-70.614624, -33.395332],
 *       [-70.639343, -33.392466],
 *       [-70.659942, -33.394759],
 *       [-70.683975, -33.404504],
 *       [-70.697021, -33.419406],
 *       [-70.701141, -33.434306],
 *       [-70.700454, -33.446339],
 *       [-70.694274, -33.458369],
 *       [-70.682601, -33.465816],
 *       [-70.668869, -33.472117],
 *       [-70.646209, -33.473835],
 *       [-70.624923, -33.472117],
 *       [-70.609817, -33.468107],
 *       [-70.595397, -33.458369],
 *       [-70.587158, -33.442901],
 *       [-70.587158, -33.426283],
 *       [-70.590591, -33.414248],
 *       [-70.594711, -33.406224],
 *       [-70.603637, -33.399918]
 *     ]]
 *   }
 * };

 * var tolerance = 0.01;
 *
 * var simplified = turf.simplify(
 *  feature, tolerance, false);
 *
 * //=feature
 *
 * //=simplified
 */
module.exports = function(feature, tolerance, highQuality){
  if(feature.geometry.type === 'LineString') {
    var line = {
      type: 'LineString',
      coordinates: []
    };
    var pts = feature.geometry.coordinates.map(function(coord) {
      return {x: coord[0], y: coord[1]};
    });
    line.coordinates = simplify(pts, tolerance, highQuality).map(function(coords){
      return [coords.x, coords.y];
    });
    
    return simpleFeature(line, feature.properties);
  } else if(feature.geometry.type === 'Polygon') {
    var poly = {
      type: 'Polygon',
      coordinates: []
    };
    feature.geometry.coordinates.forEach(function(ring){
      var pts = ring.map(function(coord) {
        return {x: coord[0], y: coord[1]};
      });
      var simpleRing = simplify(pts, tolerance, highQuality).map(function(coords){
        return [coords.x, coords.y];
      });
      poly.coordinates.push(simpleRing);
    });
    return simpleFeature(poly, feature.properties)
  }
}

function simpleFeature (geom, properties) {
  return {
    type: 'Feature',
    geometry: geom,
    properties: properties
  };
}

},{"simplify-js":131}],131:[function(require,module,exports){
/*
 (c) 2013, Vladimir Agafonkin
 Simplify.js, a high-performance JS polyline simplification library
 mourner.github.io/simplify-js
*/

(function () { 'use strict';

// to suit your point format, run search/replace for '.x' and '.y';
// for 3D version, see 3d branch (configurability would draw significant performance overhead)

// square distance between 2 points
function getSqDist(p1, p2) {

    var dx = p1.x - p2.x,
        dy = p1.y - p2.y;

    return dx * dx + dy * dy;
}

// square distance from a point to a segment
function getSqSegDist(p, p1, p2) {

    var x = p1.x,
        y = p1.y,
        dx = p2.x - x,
        dy = p2.y - y;

    if (dx !== 0 || dy !== 0) {

        var t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);

        if (t > 1) {
            x = p2.x;
            y = p2.y;

        } else if (t > 0) {
            x += dx * t;
            y += dy * t;
        }
    }

    dx = p.x - x;
    dy = p.y - y;

    return dx * dx + dy * dy;
}
// rest of the code doesn't care about point format

// basic distance-based simplification
function simplifyRadialDist(points, sqTolerance) {

    var prevPoint = points[0],
        newPoints = [prevPoint],
        point;

    for (var i = 1, len = points.length; i < len; i++) {
        point = points[i];

        if (getSqDist(point, prevPoint) > sqTolerance) {
            newPoints.push(point);
            prevPoint = point;
        }
    }

    if (prevPoint !== point) newPoints.push(point);

    return newPoints;
}

// simplification using optimized Douglas-Peucker algorithm with recursion elimination
function simplifyDouglasPeucker(points, sqTolerance) {

    var len = points.length,
        MarkerArray = typeof Uint8Array !== 'undefined' ? Uint8Array : Array,
        markers = new MarkerArray(len),
        first = 0,
        last = len - 1,
        stack = [],
        newPoints = [],
        i, maxSqDist, sqDist, index;

    markers[first] = markers[last] = 1;

    while (last) {

        maxSqDist = 0;

        for (i = first + 1; i < last; i++) {
            sqDist = getSqSegDist(points[i], points[first], points[last]);

            if (sqDist > maxSqDist) {
                index = i;
                maxSqDist = sqDist;
            }
        }

        if (maxSqDist > sqTolerance) {
            markers[index] = 1;
            stack.push(first, index, index, last);
        }

        last = stack.pop();
        first = stack.pop();
    }

    for (i = 0; i < len; i++) {
        if (markers[i]) newPoints.push(points[i]);
    }

    return newPoints;
}

// both algorithms combined for awesome performance
function simplify(points, tolerance, highestQuality) {

    var sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1;

    points = highestQuality ? points : simplifyRadialDist(points, sqTolerance);
    points = simplifyDouglasPeucker(points, sqTolerance);

    return points;
}

// export as AMD module / Node module / browser or worker variable
if (typeof define === 'function' && define.amd) define(function() { return simplify; });
else if (typeof module !== 'undefined') module.exports = simplify;
else if (typeof self !== 'undefined') self.simplify = simplify;
else window.simplify = simplify;

})();

},{}],132:[function(require,module,exports){
/**
 * Takes a bounding box and returns a new bounding box with a size expanded or contracted
 * by a factor of X.
 *
 * @module turf/size
 * @category measurement
 * @param {Array<number>} bbox a bounding box
 * @param {number} factor the ratio of the new bbox to the input bbox
 * @return {Array<number>} the resized bbox
 * @example
 * var bbox = [0, 0, 10, 10]
 *
 * var resized = turf.size(bbox, 2);
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     turf.bboxPolygon(bbox),
 *     turf.bboxPolygon(resized)
 *   ]
 * };
 *
 * //=features
 */
module.exports = function(bbox, factor){
  var currentXDistance = (bbox[2] - bbox[0]);
  var currentYDistance = (bbox[3] - bbox[1]);
  var newXDistance = currentXDistance * factor;
  var newYDistance = currentYDistance * factor;
  var xChange = newXDistance - currentXDistance;
  var yChange = newYDistance - currentYDistance;

  var lowX = bbox[0] - (xChange / 2);
  var lowY = bbox[1] - (yChange / 2);
  var highX = (xChange / 2) + bbox[2];
  var highY = (yChange / 2) + bbox[3];

  var sized = [lowX, lowY, highX, highY];
  return sized;
}

},{}],133:[function(require,module,exports){
var featurecollection = require('turf-featurecollection');
var point = require('turf-point');
var polygon = require('turf-polygon');
var distance = require('turf-distance');

/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Polygon} features in a grid.
 *
 * @module turf/square-grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} cellWidth width of each cell
 * @param {String} units units to use for cellWidth
 * @return {FeatureCollection} grid as FeatureCollection with {@link Polygon} features
 * @example
 * var extent = [-77.3876953125,38.71980474264239,-76.9482421875,39.027718840211605];
 * var cellWidth = 10;
 * var units = 'miles';
 *
 * var squareGrid = turf.squareGrid(extent, cellWidth, units);
 *
 * //=squareGrid
 */
module.exports = function (bbox, cell, units) {
  var fc = featurecollection([]);
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);

  var currentX = bbox[0];
  while (currentX <= bbox[2]) {
    var currentY = bbox[1];
    while (currentY <= bbox[3]) {
      var cellPoly = polygon([[
          [currentX, currentY],
          [currentX, currentY+cellHeight],
          [currentX+cellWidth, currentY+cellHeight],
          [currentX+cellWidth, currentY],
          [currentX, currentY]
        ]]);
      fc.features.push(cellPoly);

      currentY += cellHeight;
    }
    currentX += cellWidth;
  }
  
  return fc;
}

},{"turf-distance":79,"turf-featurecollection":91,"turf-point":121,"turf-polygon":122}],134:[function(require,module,exports){
var midpoint = require('turf-midpoint');
var point = require('turf-point');
var distance = require('turf-distance');

/**
 * Takes a bounding box and calculates the minimum square bounding box that would contain the input.
 *
 * @module turf/square
 * @category measurement
 * @param {Array<number>} bbox a bounding box
 * @return {Array<number>} a square surrounding `bbox`
 * @example
 * var bbox = [-20,-20,-15,0];
 *
 * var squared = turf.square(bbox);
 *
 * var features = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     turf.bboxPolygon(bbox),
 *     turf.bboxPolygon(squared)
 *   ]
 * };
 *
 * //=features
 */
module.exports = function(bbox){
  var squareBbox = [0,0,0,0];
  var lowLeft = point([bbox[0], bbox[1]]);
  var topLeft = point([bbox[0], bbox[3]]);
  var topRight = point([bbox[2], bbox[3]]);
  var lowRight = point([bbox[2], bbox[1]]);

  var horizontalDistance = distance(lowLeft, lowRight, 'miles');
  var verticalDistance = distance(lowLeft, topLeft, 'miles');
  if(horizontalDistance >= verticalDistance){
    squareBbox[0] = bbox[0];
    squareBbox[2] = bbox[2];
    var verticalMidpoint = midpoint(lowLeft, topLeft);
    squareBbox[1] = verticalMidpoint.geometry.coordinates[1] - ((bbox[2] - bbox[0]) / 2);
    squareBbox[3] = verticalMidpoint.geometry.coordinates[1] + ((bbox[2] - bbox[0]) / 2);
    return squareBbox;
  }
  else {
    squareBbox[1] = bbox[1];
    squareBbox[3] = bbox[3];
    var horzontalMidpoint = midpoint(lowLeft, lowRight);
    squareBbox[0] = horzontalMidpoint.geometry.coordinates[0] - ((bbox[3] - bbox[1]) / 2);
    squareBbox[2] = horzontalMidpoint.geometry.coordinates[0] + ((bbox[3] - bbox[1]) / 2);
    return squareBbox;
  }
}


},{"turf-distance":79,"turf-midpoint":114,"turf-point":121}],135:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Calculates the sum of a field for {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/sum
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {String} inField the field in input data to analyze
 * @param {String} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField`
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-87.990188, 43.026486],
 *           [-87.990188, 43.062115],
 *           [-87.913284, 43.062115],
 *           [-87.913284, 43.026486],
 *           [-87.990188, 43.026486]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-87.973709, 42.962452],
 *           [-87.973709, 43.014689],
 *           [-87.904014, 43.014689],
 *           [-87.904014, 42.962452],
 *           [-87.973709, 42.962452]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.974052, 43.049321]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.957229, 43.037277]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.931137, 43.048568]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.963409, 42.99611]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-87.94178, 42.974762]
 *       }
 *     }
 *   ]
 * };
 *
 * var aggregated = turf.sum(
 *   polygons, points, 'population', 'sum');
 *
 * var resultFeatures = points.features.concat(
 *   aggregated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function(polyFC, ptFC, inField, outField){
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = sum(values);
  });

  return polyFC;
};

function sum(x) {
    var value = 0;
    for (var i = 0; i < x.length; i++) {
        value += x[i];
    }
    return value;
}

},{"turf-inside":95}],136:[function(require,module,exports){
var inside = require('turf-inside');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a FeatureCollection of {@link Polygon} features and performs a spatial join.
 *
 * @module turf/tag
 * @category joins
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {String} polyId property in `polygons` to add to joined Point features
 * @param {String} containingPolyId property in `points` in which to store joined property from `polygons
 * @return {FeatureCollection} a FeatureCollection of point features
 * @example
 * var bbox = [0, 0, 50, 50];
 * // create a triangular grid of polygons
 * var triangleGrid = turf.tin(turf.grid(bbox, 10));
 * triangleGrid.features.forEach(function(f) {
 *   f.properties.fill = '#' +
 *     (~~(Math.random() * 16)).toString(16) +
 *     (~~(Math.random() * 16)).toString(16) +
 *     (~~(Math.random() * 16)).toString(16);
 *   f.properties.stroke = 0;
 *   f.properties['fill-opacity'] = 1;
 * });
 * var randomPoints = turf.random('point', 30, {
 *   bbox: bbox
 * });
 * var both = turf.featurecollection(
 *   triangleGrid.features.concat(randomPoints.features));
 *
 * //=both
 *
 * var tagged = turf.tag(randomPoints, triangleGrid,
 *                       'fill', 'marker-color');
 *
 * //=tagged
 */
module.exports = function(points, polygons, field, outField){
  // prevent mutations
  points = JSON.parse(JSON.stringify(points));
  polygons = JSON.parse(JSON.stringify(polygons));
  points.features.forEach(function(pt) {
    if (!pt.properties) {
      pt.properties = {};
    }
    polygons.features.forEach(function(poly) {
      if (pt.properties[outField] === undefined) {
        var isInside = inside(pt, poly);
        if (isInside) {
          pt.properties[outField] = poly.properties[field];
        }
      }
    });
  });
  return points;
};

},{"turf-inside":95}],137:[function(require,module,exports){
//http://en.wikipedia.org/wiki/Delaunay_triangulation
//https://github.com/ironwallaby/delaunay
var polygon = require('turf-polygon');
var featurecollection = require('turf-featurecollection');

/**
 * Takes a set of points and the name of a z-value property and
 * creates a [Triangulated Irregular Network](http://en.wikipedia.org/wiki/Triangulated_irregular_network),
 * or a TIN for short, returned as a collection of Polygons. These are often used
 * for developing elevation contour maps or stepped heat visualizations.
 *
 * This triangulates the points, as well as adds properties called `a`, `b`,
 * and `c` representing the value of the given `propertyName` at each of
 * the points that represent the corners of the triangle.
 *
 * @module turf/tin
 * @category interpolation
 * @param {FeatureCollection} points - a GeoJSON FeatureCollection containing
 * Features with {@link Point} geometries
 * @param {string=} propertyName - name of the property from which to pull z values.
 * This is optional: if not given, then there will be no extra data added to the derived triangles.
 * @return {FeatureCollection} TIN output
 * @example
 * // generate some random point data
 * var points = turf.random('points', 30, {
 *   bbox: [50, 30, 70, 50]
 * });
 * //=points
 * // add a random property to each point between 0 and 9
 * for (var i = 0; i < points.features.length; i++) {
 *   points.features[i].properties.z = ~~(Math.random() * 9);
 * }
 * var tin = turf.tin(points, 'z')
 * for (var i = 0; i < tin.features.length; i++) {
 *   var properties  = tin.features[i].properties;
 *   // roughly turn the properties of each
 *   // triangle into a fill color
 *   // so we can visualize the result
 *   properties.fill = '#' + properties.a +
 *     properties.b + properties.c;
 * }
 * //=tin
 */
module.exports = function(points, z) {
  //break down points
  return featurecollection(triangulate(points.features.map(function(p) {
    var point = {
      x: p.geometry.coordinates[0],
      y: p.geometry.coordinates[1]
    };
    if (z) point.z = p.properties[z];
    return point;
  })).map(function(triangle) {
    return polygon([[
        [triangle.a.x, triangle.a.y],
        [triangle.b.x, triangle.b.y],
        [triangle.c.x, triangle.c.y],
        [triangle.a.x, triangle.a.y]
    ]], {
        a: triangle.a.z,
        b: triangle.b.z,
        c: triangle.c.z
      });
  }));
};

function Triangle(a, b, c) {
  this.a = a;
  this.b = b;
  this.c = c;

  var A = b.x - a.x,
    B = b.y - a.y,
    C = c.x - a.x,
    D = c.y - a.y,
    E = A * (a.x + b.x) + B * (a.y + b.y),
    F = C * (a.x + c.x) + D * (a.y + c.y),
    G = 2 * (A * (c.y - b.y) - B * (c.x - b.x)),
    minx, miny, dx, dy;

  // If the points of the triangle are collinear, then just find the
  // extremes and use the midpoint as the center of the circumcircle.
  if (Math.abs(G) < 0.000001) {
    minx = Math.min(a.x, b.x, c.x);
    miny = Math.min(a.y, b.y, c.y);
    dx = (Math.max(a.x, b.x, c.x) - minx) * 0.5;
    dy = (Math.max(a.y, b.y, c.y) - miny) * 0.5;

    this.x = minx + dx;
    this.y = miny + dy;
    this.r = dx * dx + dy * dy;
  } else {
    this.x = (D * E - B * F) / G;
    this.y = (A * F - C * E) / G;
    dx = this.x - a.x;
    dy = this.y - a.y;
    this.r = dx * dx + dy * dy;
  }
}

function byX(a, b) {
  return b.x - a.x;
}

function dedup(edges) {
  var j = edges.length,
    a, b, i, m, n;

  outer:
  while (j) {
    b = edges[--j];
    a = edges[--j];
    i = j;
    while (i) {
      n = edges[--i];
      m = edges[--i];
      if ((a === m && b === n) || (a === n && b === m)) {
        edges.splice(j, 2);
        edges.splice(i, 2);
        j -= 2;
        continue outer;
      }
    }
  }
}

function triangulate(vertices) {
  // Bail if there aren't enough vertices to form any triangles.
  if (vertices.length < 3)
    return [];

    // Ensure the vertex array is in order of descending X coordinate
    // (which is needed to ensure a subquadratic runtime), and then find
    // the bounding box around the points. 
  vertices.sort(byX);

  var i = vertices.length - 1,
    xmin = vertices[i].x,
    xmax = vertices[0].x,
    ymin = vertices[i].y,
    ymax = ymin;

  while (i--) {
    if (vertices[i].y < ymin)
      ymin = vertices[i].y;
    if (vertices[i].y > ymax)
      ymax = vertices[i].y;
  }

  //Find a supertriangle, which is a triangle that surrounds all the
  //vertices. This is used like something of a sentinel value to remove
  //cases in the main algorithm, and is removed before we return any
  // results.
 
  // Once found, put it in the "open" list. (The "open" list is for
  // triangles who may still need to be considered; the "closed" list is
  // for triangles which do not.)
  var dx = xmax - xmin,
    dy = ymax - ymin,
    dmax = (dx > dy) ? dx : dy,
    xmid = (xmax + xmin) * 0.5,
    ymid = (ymax + ymin) * 0.5,
    open = [
      new Triangle({
        x: xmid - 20 * dmax,
        y: ymid - dmax,
        __sentinel: true
      },
      {
        x: xmid,
        y: ymid + 20 * dmax,
        __sentinel: true
      },
      {
        x: xmid + 20 * dmax,
        y: ymid - dmax,
        __sentinel: true
      }
    )],
    closed = [],
    edges = [],
    j, a, b;

    // Incrementally add each vertex to the mesh.
  i = vertices.length;
  while (i--) {
    // For each open triangle, check to see if the current point is
    // inside it's circumcircle. If it is, remove the triangle and add
    // it's edges to an edge list.
    edges.length = 0;
    j = open.length;
    while (j--) {
      // If this point is to the right of this triangle's circumcircle,
      // then this triangle should never get checked again. Remove it
      // from the open list, add it to the closed list, and skip.
      dx = vertices[i].x - open[j].x;
      if (dx > 0 && dx * dx > open[j].r) {
        closed.push(open[j]);
        open.splice(j, 1);
        continue;
      }

      // If not, skip this triangle.
      dy = vertices[i].y - open[j].y;
      if (dx * dx + dy * dy > open[j].r)
        continue;

      // Remove the triangle and add it's edges to the edge list.
      edges.push(
        open[j].a, open[j].b,
        open[j].b, open[j].c,
        open[j].c, open[j].a
      );
      open.splice(j, 1);
    }

    // Remove any doubled edges.
    dedup(edges);

    // Add a new triangle for each edge.
    j = edges.length;
    while (j) {
      b = edges[--j];
      a = edges[--j];
      open.push(new Triangle(a, b, vertices[i]));
    }
  }

  // Copy any remaining open triangles to the closed list, and then
  // remove any triangles that share a vertex with the supertriangle.
  Array.prototype.push.apply(closed, open);

  i = closed.length;
  while (i--)
  if (closed[i].a.__sentinel ||
      closed[i].b.__sentinel ||
      closed[i].c.__sentinel)
      closed.splice(i, 1);

  return closed;
}

},{"turf-featurecollection":91,"turf-polygon":122}],138:[function(require,module,exports){
var featurecollection = require('turf-featurecollection');
var point = require('turf-point');
var polygon = require('turf-polygon');
var distance = require('turf-distance');

/**
 * Takes a bounding box and a cell depth and returns a {@link FeatureCollection} of {@link Polygon} features in a grid.
 *
 * @module turf/triangle-grid
 * @category interpolation
 * @param {Array<number>} extent extent in [minX, minY, maxX, maxY] order
 * @param {Number} cellWidth width of each cell
 * @param {String} units units to use for cellWidth
 * @return {FeatureCollection} grid as FeatureCollection with {@link Polygon} features
 * @example
 * var extent = [-77.3876953125,38.71980474264239,-76.9482421875,39.027718840211605];
 * var cellWidth = 10;
 * var units = 'miles';
 *
 * var triangleGrid = turf.triangleGrid(extent, cellWidth, units);
 *
 * //=triangleGrid
 */
module.exports = function (bbox, cell, units) {
  var fc = featurecollection([]);
  var xFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[2], bbox[1]]), units));
  var cellWidth = xFraction * (bbox[2] - bbox[0]);
  var yFraction = cell / (distance(point([bbox[0], bbox[1]]), point([bbox[0], bbox[3]]), units));
  var cellHeight = yFraction * (bbox[3] - bbox[1]);

  var xi = 0;
  var currentX = bbox[0];
  while (currentX <= bbox[2]) {
    var yi = 0;
    var currentY = bbox[1];
    while (currentY <= bbox[3]) {
      if(xi%2===0 && yi%2===0) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY+cellHeight]
          ]]);
        fc.features.push(cell2);
      } else if(xi%2===0 && yi%2===1) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX, currentY]
          ]]);
        fc.features.push(cell2);
      } else if(yi%2===0 && xi%2===1) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell2);
      } else if(yi%2===1 && xi%2===1) {
        var cell1 = polygon([[
            [currentX, currentY],
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY]
          ]]);
        fc.features.push(cell1);
        var cell2 = polygon([[
            [currentX, currentY+cellHeight],
            [currentX+cellWidth, currentY+cellHeight],
            [currentX+cellWidth, currentY],
            [currentX, currentY+cellHeight]
          ]]);
        fc.features.push(cell2);
      }
      currentY += cellHeight;
      yi++;
    }
    xi++;
    currentX += cellWidth;
  }
  return fc;
};


},{"turf-distance":79,"turf-featurecollection":91,"turf-point":121,"turf-polygon":122}],139:[function(require,module,exports){
// look here for help http://svn.osgeo.org/grass/grass/branches/releasebranch_6_4/vector/v.overlay/main.c
//must be array of polygons

// depend on jsts for now https://github.com/bjornharrtell/jsts/blob/master/examples/overlay.html

var jsts = require('jsts');

/**
 * Takes two {@link Polygon} features and returnes a combined {@link Polygon} feature. If the input Polygon features are not contiguous, this function returns a {@link MultiPolygon} feature.
 *
 * @module turf/union
 * @category transformation
 * @param {Polygon} poly1 an input Polygon
 * @param {Polygon} poly2 another input Polygon
 * @return {Feature} a combined {@link Polygon} or {@link MultiPolygon} feature
 * @example
 * var poly1 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#0f0"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-82.574787, 35.594087],
 *       [-82.574787, 35.615581],
 *       [-82.545261, 35.615581],
 *       [-82.545261, 35.594087],
 *       [-82.574787, 35.594087]
 *     ]]
 *   }
 * };
 * var poly2 = {
 *   "type": "Feature",
 *   "properties": {
 *     "fill": "#00f"
 *   },
 *   "geometry": {
 *     "type": "Polygon",
 *     "coordinates": [[
 *       [-82.560024, 35.585153],
 *       [-82.560024, 35.602602],
 *       [-82.52964, 35.602602],
 *       [-82.52964, 35.585153],
 *       [-82.560024, 35.585153]
 *     ]]
 *   }
 * };
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [poly1, poly2]
 * };
 *
 * var union = turf.union(poly1, poly2);
 *
 * //=polygons
 *
 * //=union
 */
module.exports = function(poly1, poly2){
  var reader = new jsts.io.GeoJSONReader();
  var a = reader.read(JSON.stringify(poly1.geometry));
  var b = reader.read(JSON.stringify(poly2.geometry));
  var union = a.union(b);
  var parser = new jsts.io.GeoJSONParser();

  union = parser.write(union);
  return {
    type: 'Feature',
    geometry: union,
    properties: poly1.properties
  };
}

},{"jsts":140}],140:[function(require,module,exports){
arguments[4][36][0].apply(exports,arguments)
},{"./lib/jsts":141,"dup":36,"javascript.util":143}],141:[function(require,module,exports){
arguments[4][37][0].apply(exports,arguments)
},{"dup":37}],142:[function(require,module,exports){
(function (global){
/*
  javascript.util is a port of selected parts of java.util to JavaScript which
  main purpose is to ease porting Java code to JavaScript.
  
  The MIT License (MIT)

  Copyright (C) 2011-2014 by The Authors

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.
*/
;(function(){var e=this;function f(a,b){var c=a.split("."),d=e;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var t;c.length&&(t=c.shift());)c.length||void 0===b?d=d[t]?d[t]:d[t]={}:d[t]=b}function g(a,b){function c(){}c.prototype=b.prototype;a.q=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.p=function(a,c,O){var M=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,M)}};function h(a){this.message=a||""}g(h,Error);f("javascript.util.EmptyStackException",h);h.prototype.name="EmptyStackException";function k(a){this.message=a||""}g(k,Error);f("javascript.util.IndexOutOfBoundsException",k);k.prototype.name="IndexOutOfBoundsException";function l(){}f("javascript.util.Iterator",l);l.prototype.hasNext=l.prototype.c;l.prototype.next=l.prototype.next;l.prototype.remove=l.prototype.remove;function m(){}f("javascript.util.Collection",m);function n(){}g(n,m);f("javascript.util.List",n);function p(){}f("javascript.util.Map",p);function q(a){this.message=a||""}g(q,Error);f("javascript.util.NoSuchElementException",q);q.prototype.name="NoSuchElementException";function r(a){this.message=a||""}g(r,Error);r.prototype.name="OperationNotSupported";function s(a){this.a=[];a instanceof m&&this.e(a)}g(s,n);f("javascript.util.ArrayList",s);s.prototype.a=null;s.prototype.add=function(a){this.a.push(a);return!0};s.prototype.add=s.prototype.add;s.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};s.prototype.addAll=s.prototype.e;s.prototype.set=function(a,b){var c=this.a[a];this.a[a]=b;return c};s.prototype.set=s.prototype.set;s.prototype.f=function(){return new u(this)};s.prototype.iterator=s.prototype.f;
s.prototype.get=function(a){if(0>a||a>=this.size())throw new k;return this.a[a]};s.prototype.get=s.prototype.get;s.prototype.g=function(){return 0===this.a.length};s.prototype.isEmpty=s.prototype.g;s.prototype.size=function(){return this.a.length};s.prototype.size=s.prototype.size;s.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};s.prototype.toArray=s.prototype.h;
s.prototype.remove=function(a){for(var b=!1,c=0,d=this.a.length;c<d;c++)if(this.a[c]===a){this.a.splice(c,1);b=!0;break}return b};s.prototype.remove=s.prototype.remove;function u(a){this.j=a}f("$jscomp.scope.Iterator_",u);u.prototype.j=null;u.prototype.b=0;u.prototype.next=function(){if(this.b===this.j.size())throw new q;return this.j.get(this.b++)};u.prototype.next=u.prototype.next;u.prototype.c=function(){return this.b<this.j.size()?!0:!1};u.prototype.hasNext=u.prototype.c;
u.prototype.remove=function(){throw new r;};u.prototype.remove=u.prototype.remove;function v(){}f("javascript.util.Arrays",v);
v.sort=function(){var a=arguments[0],b,c,d;if(1===arguments.length)a.sort();else if(2===arguments.length)c=arguments[1],d=function(a,b){return c.compare(a,b)},a.sort(d);else if(3===arguments.length)for(b=a.slice(arguments[1],arguments[2]),b.sort(),d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b]);else if(4===arguments.length)for(b=a.slice(arguments[1],arguments[2]),c=arguments[3],d=function(a,b){return c.compare(a,b)},b.sort(d),
d=a.slice(0,arguments[1]).concat(b,a.slice(arguments[2],a.length)),a.splice(0,a.length),b=0;b<d.length;b++)a.push(d[b])};v.asList=function(a){for(var b=new s,c=0,d=a.length;c<d;c++)b.add(a[c]);return b};function w(){this.i={}}g(w,p);f("javascript.util.HashMap",w);w.prototype.i=null;w.prototype.get=function(a){return this.i[a]||null};w.prototype.get=w.prototype.get;w.prototype.put=function(a,b){return this.i[a]=b};w.prototype.put=w.prototype.put;w.prototype.m=function(){var a=new s,b;for(b in this.i)this.i.hasOwnProperty(b)&&a.add(this.i[b]);return a};w.prototype.values=w.prototype.m;w.prototype.size=function(){return this.m().size()};w.prototype.size=w.prototype.size;function x(){}g(x,m);f("javascript.util.Set",x);function y(a){this.a=[];a instanceof m&&this.e(a)}g(y,x);f("javascript.util.HashSet",y);y.prototype.a=null;y.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(this.a[b]===a)return!0;return!1};y.prototype.contains=y.prototype.contains;y.prototype.add=function(a){if(this.contains(a))return!1;this.a.push(a);return!0};y.prototype.add=y.prototype.add;y.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};y.prototype.addAll=y.prototype.e;
y.prototype.remove=function(){throw new r;};y.prototype.remove=y.prototype.remove;y.prototype.size=function(){return this.a.length};y.prototype.g=function(){return 0===this.a.length};y.prototype.isEmpty=y.prototype.g;y.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};y.prototype.toArray=y.prototype.h;y.prototype.f=function(){return new z(this)};y.prototype.iterator=y.prototype.f;function z(a){this.k=a}f("$jscomp.scope.Iterator_$1",z);z.prototype.k=null;
z.prototype.b=0;z.prototype.next=function(){if(this.b===this.k.size())throw new q;return this.k.a[this.b++]};z.prototype.next=z.prototype.next;z.prototype.c=function(){return this.b<this.k.size()?!0:!1};z.prototype.hasNext=z.prototype.c;z.prototype.remove=function(){throw new r;};z.prototype.remove=z.prototype.remove;function A(){}g(A,p);f("javascript.util.SortedMap",A);function B(){}g(B,x);f("javascript.util.SortedSet",B);function C(){this.a=[]}g(C,n);f("javascript.util.Stack",C);C.prototype.a=null;C.prototype.push=function(a){this.a.push(a);return a};C.prototype.push=C.prototype.push;C.prototype.pop=function(){if(0===this.a.length)throw new h;return this.a.pop()};C.prototype.pop=C.prototype.pop;C.prototype.o=function(){if(0===this.a.length)throw new h;return this.a[this.a.length-1]};C.prototype.peek=C.prototype.o;C.prototype.empty=function(){return 0===this.a.length?!0:!1};C.prototype.empty=C.prototype.empty;
C.prototype.g=function(){return this.empty()};C.prototype.isEmpty=C.prototype.g;C.prototype.search=function(a){return this.a.indexOf(a)};C.prototype.search=C.prototype.search;C.prototype.size=function(){return this.a.length};C.prototype.size=C.prototype.size;C.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};C.prototype.toArray=C.prototype.h;function D(a){return null==a?null:a.parent}function E(a,b){null!==a&&(a.color=b)}function F(a){return null==a?null:a.left}function G(a){return null==a?null:a.right}function H(){this.d=null;this.n=0}g(H,A);f("javascript.util.TreeMap",H);H.prototype.get=function(a){for(var b=this.d;null!==b;){var c=a.compareTo(b.key);if(0>c)b=b.left;else if(0<c)b=b.right;else return b.value}return null};H.prototype.get=H.prototype.get;
H.prototype.put=function(a,b){if(null===this.d)return this.d={key:a,value:b,left:null,right:null,parent:null,color:0},this.n=1,null;var c=this.d,d,t;do if(d=c,t=a.compareTo(c.key),0>t)c=c.left;else if(0<t)c=c.right;else return d=c.value,c.value=b,d;while(null!==c);c={key:a,left:null,right:null,value:b,parent:d,color:0};0>t?d.left=c:d.right=c;for(c.color=1;null!=c&&c!=this.d&&1==c.parent.color;)D(c)==F(D(D(c)))?(d=G(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==G(D(c))&&
(c=D(c),I(this,c)),E(D(c),0),E(D(D(c)),1),J(this,D(D(c))))):(d=F(D(D(c))),1==(null==d?0:d.color)?(E(D(c),0),E(d,0),E(D(D(c)),1),c=D(D(c))):(c==F(D(c))&&(c=D(c),J(this,c)),E(D(c),0),E(D(D(c)),1),I(this,D(D(c)))));this.d.color=0;this.n++;return null};H.prototype.put=H.prototype.put;H.prototype.m=function(){var a=new s,b;b=this.d;if(null!=b)for(;null!=b.left;)b=b.left;if(null!==b)for(a.add(b.value);null!==(b=K(b));)a.add(b.value);return a};H.prototype.values=H.prototype.m;
function I(a,b){if(null!=b){var c=b.right;b.right=c.left;null!=c.left&&(c.left.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.left==b?b.parent.left=c:b.parent.right=c;c.left=b;b.parent=c}}function J(a,b){if(null!=b){var c=b.left;b.left=c.right;null!=c.right&&(c.right.parent=b);c.parent=b.parent;null==b.parent?a.d=c:b.parent.right==b?b.parent.right=c:b.parent.left=c;c.right=b;b.parent=c}}
function K(a){if(null===a)return null;if(null!==a.right)for(var b=a.right;null!==b.left;)b=b.left;else for(b=a.parent;null!==b&&a===b.right;)a=b,b=b.parent;return b}H.prototype.size=function(){return this.n};H.prototype.size=H.prototype.size;function L(a){this.a=[];a instanceof m&&this.e(a)}g(L,B);f("javascript.util.TreeSet",L);L.prototype.a=null;L.prototype.contains=function(a){for(var b=0,c=this.a.length;b<c;b++)if(0===this.a[b].compareTo(a))return!0;return!1};L.prototype.contains=L.prototype.contains;L.prototype.add=function(a){if(this.contains(a))return!1;for(var b=0,c=this.a.length;b<c;b++)if(1===this.a[b].compareTo(a))return this.a.splice(b,0,a),!0;this.a.push(a);return!0};L.prototype.add=L.prototype.add;
L.prototype.e=function(a){for(a=a.f();a.c();)this.add(a.next());return!0};L.prototype.addAll=L.prototype.e;L.prototype.remove=function(){throw new r;};L.prototype.remove=L.prototype.remove;L.prototype.size=function(){return this.a.length};L.prototype.size=L.prototype.size;L.prototype.g=function(){return 0===this.a.length};L.prototype.isEmpty=L.prototype.g;L.prototype.h=function(){for(var a=[],b=0,c=this.a.length;b<c;b++)a.push(this.a[b]);return a};L.prototype.toArray=L.prototype.h;L.prototype.f=function(){return new N(this)};
L.prototype.iterator=L.prototype.f;function N(a){this.l=a}f("$jscomp.scope.Iterator_$2",N);N.prototype.l=null;N.prototype.b=0;N.prototype.next=function(){if(this.b===this.l.size())throw new q;return this.l.a[this.b++]};N.prototype.next=N.prototype.next;N.prototype.c=function(){return this.b<this.l.size()?!0:!1};N.prototype.hasNext=N.prototype.c;N.prototype.remove=function(){throw new r;};N.prototype.remove=N.prototype.remove;"undefined"!==typeof global&&(global.javascript={},global.javascript.util={},global.javascript.util.ArrayList=s,global.javascript.util.Arrays=v,global.javascript.util.Collection=m,global.javascript.util.EmptyStackException=h,global.javascript.util.HashMap=w,global.javascript.util.HashSet=y,global.javascript.util.IndexOutOfBoundsException=k,global.javascript.util.Iterator=l,global.javascript.util.List=n,global.javascript.util.Map=p,global.javascript.util.NoSuchElementException=q,global.javascript.util.OperationNotSupported=
r,global.javascript.util.Set=x,global.javascript.util.SortedMap=A,global.javascript.util.SortedSet=B,global.javascript.util.Stack=C,global.javascript.util.TreeMap=H,global.javascript.util.TreeSet=L);}).call(this);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],143:[function(require,module,exports){
arguments[4][39][0].apply(exports,arguments)
},{"./dist/javascript.util-node.min.js":142,"dup":39}],144:[function(require,module,exports){
var ss = require('simple-statistics');
var inside = require('turf-inside');

/**
 * Calculates the variance value of a field for {@link Point} features within a set of {@link Polygon} features.
 *
 * @module turf/variance
 * @category aggregation
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {string} inField the field in input data to analyze
 * @param {string} outField the field in which to store results
 * @return {FeatureCollection} a FeatureCollection of {@link Polygon} features
 * with properties listed as `outField`
 * @example
 * var polygons = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.414398, 37.684092],
 *           [-97.414398, 37.731353],
 *           [-97.332344, 37.731353],
 *           [-97.332344, 37.684092],
 *           [-97.414398, 37.684092]
 *         ]]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-97.333717, 37.606072],
 *           [-97.333717, 37.675397],
 *           [-97.237586, 37.675397],
 *           [-97.237586, 37.606072],
 *           [-97.333717, 37.606072]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.401351, 37.719676]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 600
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.355346, 37.706639]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 100
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.387962, 37.70012]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 200
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.301788, 37.66507]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {
 *         "population": 300
 *       },
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-97.265052, 37.643325]
 *       }
 *     }
 *   ]
 * };
 *
 * var aggregated = turf.variance(
 *   polygons, points, 'population', 'variance');
 *
 * var resultFeatures = points.features.concat(
 *   aggregated.features);
 * var result = {
 *   "type": "FeatureCollection",
 *   "features": resultFeatures
 * };
 *
 * //=result
 */
module.exports = function (polyFC, ptFC, inField, outField) {
  polyFC.features.forEach(function(poly){
    if(!poly.properties){
      poly.properties = {};
    }
    var values = [];
    ptFC.features.forEach(function(pt){
      if (inside(pt, poly)) {
        values.push(pt.properties[inField]);
      }
    });
    poly.properties[outField] = ss.variance(values);
  });

  return polyFC;
};

},{"simple-statistics":145,"turf-inside":95}],145:[function(require,module,exports){
arguments[4][78][0].apply(exports,arguments)
},{"dup":78}],146:[function(require,module,exports){
var inside = require('turf-inside');
var featureCollection = require('turf-featurecollection');

/**
 * Takes a {@link FeatureCollection} of {@link Point} features and a FeatureCollection of {@link Polygon} features and returns a FeatureCollection of Point features representing all points that fall within a collection of polygons.
 *
 * @module turf/within
 * @category joins
 * @param {FeatureCollection} points a FeatureCollection of {@link Point} features
 * @param {FeatureCollection} polygons a FeatureCollection of {@link Polygon} features
 * @return {FeatureCollection} a collection of all points that land
 * within at least one polygon
 * @example
 * var searchWithin = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Polygon",
 *         "coordinates": [[
 *           [-46.653,-23.543],
 *           [-46.634,-23.5346],
 *           [-46.613,-23.543],
 *           [-46.614,-23.559],
 *           [-46.631,-23.567],
 *           [-46.653,-23.560],
 *           [-46.653,-23.543]
 *         ]]
 *       }
 *     }
 *   ]
 * };
 * var points = {
 *   "type": "FeatureCollection",
 *   "features": [
 *     {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6318, -23.5523]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6246, -23.5325]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.6062, -23.5513]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.663, -23.554]
 *       }
 *     }, {
 *       "type": "Feature",
 *       "properties": {},
 *       "geometry": {
 *         "type": "Point",
 *         "coordinates": [-46.643, -23.557]
 *       }
 *     }
 *   ]
 * };
 *
 * var ptsWithin = turf.within(points, searchWithin);
 *
 * //=points
 *
 * //=searchWithin
 *
 * //=ptsWithin
 */
module.exports = function(ptFC, polyFC){
  var pointsWithin = featureCollection([]);
  for (var i = 0; i < polyFC.features.length; i++) {
    for (var j = 0; j < ptFC.features.length; j++) {
      var isInside = inside(ptFC.features[j], polyFC.features[i]);
      if(isInside){
        pointsWithin.features.push(ptFC.features[j]);
      }
    }
  }
  return pointsWithin;
};

},{"turf-featurecollection":91,"turf-inside":95}],147:[function(require,module,exports){
"use strict";
var window = require("global/window")
var once = require("once")
var parseHeaders = require("parse-headers")



module.exports = createXHR
createXHR.XMLHttpRequest = window.XMLHttpRequest || noop
createXHR.XDomainRequest = "withCredentials" in (new createXHR.XMLHttpRequest()) ? createXHR.XMLHttpRequest : window.XDomainRequest


function isEmpty(obj){
    for(var i in obj){
        if(obj.hasOwnProperty(i)) return false
    }
    return true
}

function createXHR(options, callback) {
    function readystatechange() {
        if (xhr.readyState === 4) {
            loadFunc()
        }
    }

    function getBody() {
        // Chrome with requestType=blob throws errors arround when even testing access to responseText
        var body = undefined

        if (xhr.response) {
            body = xhr.response
        } else if (xhr.responseType === "text" || !xhr.responseType) {
            body = xhr.responseText || xhr.responseXML
        }

        if (isJson) {
            try {
                body = JSON.parse(body)
            } catch (e) {}
        }

        return body
    }

    var failureResponse = {
                body: undefined,
                headers: {},
                statusCode: 0,
                method: method,
                url: uri,
                rawRequest: xhr
            }

    function errorFunc(evt) {
        clearTimeout(timeoutTimer)
        if(!(evt instanceof Error)){
            evt = new Error("" + (evt || "Unknown XMLHttpRequest Error") )
        }
        evt.statusCode = 0
        callback(evt, failureResponse)
    }

    // will load the data & process the response in a special response object
    function loadFunc() {
        if (aborted) return
        var status
        clearTimeout(timeoutTimer)
        if(options.useXDR && xhr.status===undefined) {
            //IE8 CORS GET successful response doesn't have a status field, but body is fine
            status = 200
        } else {
            status = (xhr.status === 1223 ? 204 : xhr.status)
        }
        var response = failureResponse
        var err = null

        if (status !== 0){
            response = {
                body: getBody(),
                statusCode: status,
                method: method,
                headers: {},
                url: uri,
                rawRequest: xhr
            }
            if(xhr.getAllResponseHeaders){ //remember xhr can in fact be XDR for CORS in IE
                response.headers = parseHeaders(xhr.getAllResponseHeaders())
            }
        } else {
            err = new Error("Internal XMLHttpRequest Error")
        }
        callback(err, response, response.body)

    }

    if (typeof options === "string") {
        options = { uri: options }
    }

    options = options || {}
    if(typeof callback === "undefined"){
        throw new Error("callback argument missing")
    }
    callback = once(callback)

    var xhr = options.xhr || null

    if (!xhr) {
        if (options.cors || options.useXDR) {
            xhr = new createXHR.XDomainRequest()
        }else{
            xhr = new createXHR.XMLHttpRequest()
        }
    }

    var key
    var aborted
    var uri = xhr.url = options.uri || options.url
    var method = xhr.method = options.method || "GET"
    var body = options.body || options.data
    var headers = xhr.headers = options.headers || {}
    var sync = !!options.sync
    var isJson = false
    var timeoutTimer

    if ("json" in options) {
        isJson = true
        headers["accept"] || headers["Accept"] || (headers["Accept"] = "application/json") //Don't override existing accept header declared by user
        if (method !== "GET" && method !== "HEAD") {
            headers["content-type"] || headers["Content-Type"] || (headers["Content-Type"] = "application/json") //Don't override existing accept header declared by user
            body = JSON.stringify(options.json)
        }
    }

    xhr.onreadystatechange = readystatechange
    xhr.onload = loadFunc
    xhr.onerror = errorFunc
    // IE9 must have onprogress be set to a unique function.
    xhr.onprogress = function () {
        // IE must die
    }
    xhr.ontimeout = errorFunc
    xhr.open(method, uri, !sync, options.username, options.password)
    //has to be after open
    if(!sync) {
        xhr.withCredentials = !!options.withCredentials
    }
    // Cannot set timeout with sync request
    // not setting timeout on the xhr object, because of old webkits etc. not handling that correctly
    // both npm's request and jquery 1.x use this kind of timeout, so this is being consistent
    if (!sync && options.timeout > 0 ) {
        timeoutTimer = setTimeout(function(){
            aborted=true//IE9 may still call readystatechange
            xhr.abort("timeout")
            var e = new Error("XMLHttpRequest timeout")
            e.code = "ETIMEDOUT"
            errorFunc(e)
        }, options.timeout )
    }

    if (xhr.setRequestHeader) {
        for(key in headers){
            if(headers.hasOwnProperty(key)){
                xhr.setRequestHeader(key, headers[key])
            }
        }
    } else if (options.headers && !isEmpty(options.headers)) {
        throw new Error("Headers cannot be set on an XDomainRequest object")
    }

    if ("responseType" in options) {
        xhr.responseType = options.responseType
    }

    if ("beforeSend" in options &&
        typeof options.beforeSend === "function"
    ) {
        options.beforeSend(xhr)
    }

    xhr.send(body)

    return xhr


}

function noop() {}

},{"global/window":148,"once":149,"parse-headers":153}],148:[function(require,module,exports){
(function (global){
if (typeof window !== "undefined") {
    module.exports = window;
} else if (typeof global !== "undefined") {
    module.exports = global;
} else if (typeof self !== "undefined"){
    module.exports = self;
} else {
    module.exports = {};
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],149:[function(require,module,exports){
module.exports = once

once.proto = once(function () {
  Object.defineProperty(Function.prototype, 'once', {
    value: function () {
      return once(this)
    },
    configurable: true
  })
})

function once (fn) {
  var called = false
  return function () {
    if (called) return
    called = true
    return fn.apply(this, arguments)
  }
}

},{}],150:[function(require,module,exports){
var isFunction = require('is-function')

module.exports = forEach

var toString = Object.prototype.toString
var hasOwnProperty = Object.prototype.hasOwnProperty

function forEach(list, iterator, context) {
    if (!isFunction(iterator)) {
        throw new TypeError('iterator must be a function')
    }

    if (arguments.length < 3) {
        context = this
    }
    
    if (toString.call(list) === '[object Array]')
        forEachArray(list, iterator, context)
    else if (typeof list === 'string')
        forEachString(list, iterator, context)
    else
        forEachObject(list, iterator, context)
}

function forEachArray(array, iterator, context) {
    for (var i = 0, len = array.length; i < len; i++) {
        if (hasOwnProperty.call(array, i)) {
            iterator.call(context, array[i], i, array)
        }
    }
}

function forEachString(string, iterator, context) {
    for (var i = 0, len = string.length; i < len; i++) {
        // no such thing as a sparse string.
        iterator.call(context, string.charAt(i), i, string)
    }
}

function forEachObject(object, iterator, context) {
    for (var k in object) {
        if (hasOwnProperty.call(object, k)) {
            iterator.call(context, object[k], k, object)
        }
    }
}

},{"is-function":151}],151:[function(require,module,exports){
module.exports = isFunction

var toString = Object.prototype.toString

function isFunction (fn) {
  var string = toString.call(fn)
  return string === '[object Function]' ||
    (typeof fn === 'function' && string !== '[object RegExp]') ||
    (typeof window !== 'undefined' &&
     // IE8 and below
     (fn === window.setTimeout ||
      fn === window.alert ||
      fn === window.confirm ||
      fn === window.prompt))
};

},{}],152:[function(require,module,exports){

exports = module.exports = trim;

function trim(str){
  return str.replace(/^\s*|\s*$/g, '');
}

exports.left = function(str){
  return str.replace(/^\s*/, '');
};

exports.right = function(str){
  return str.replace(/\s*$/, '');
};

},{}],153:[function(require,module,exports){
var trim = require('trim')
  , forEach = require('for-each')
  , isArray = function(arg) {
      return Object.prototype.toString.call(arg) === '[object Array]';
    }

module.exports = function (headers) {
  if (!headers)
    return {}

  var result = {}

  forEach(
      trim(headers).split('\n')
    , function (row) {
        var index = row.indexOf(':')
          , key = trim(row.slice(0, index)).toLowerCase()
          , value = trim(row.slice(index + 1))

        if (typeof(result[key]) === 'undefined') {
          result[key] = value
        } else if (isArray(result[key])) {
          result[key].push(value)
        } else {
          result[key] = [ result[key], value ]
        }
      }
  )

  return result
}
},{"for-each":150,"trim":152}],154:[function(require,module,exports){
(function (global){
'use strict';

var _createClass = require('babel-runtime/helpers/create-class')['default'];

var _classCallCheck = require('babel-runtime/helpers/class-call-check')['default'];

var _defineProperty = require('babel-runtime/helpers/define-property')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _interopRequireWildcard = require('babel-runtime/helpers/interop-require-wildcard')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _xhr = require('xhr');

var _xhr2 = _interopRequireDefault(_xhr);

var _spinJs = require('spin.js');

var Spinner = _interopRequireWildcard(_spinJs);

var _configJson = require('../config.json');

var config = _interopRequireWildcard(_configJson);

var _colors = require('./colors');

var _colors2 = _interopRequireDefault(_colors);

var _leafletKnn = require('leaflet-knn');

var _leafletKnn2 = _interopRequireDefault(_leafletKnn);

var _turf = require('turf');

var _turf2 = _interopRequireDefault(_turf);

var _geojsonUtils = require('geojson-utils');

var _geojsonUtils2 = _interopRequireDefault(_geojsonUtils);

var _leafletGeometryutil = require('leaflet-geometryutil');

var _leafletGeometryutil2 = _interopRequireDefault(_leafletGeometryutil);

require('leaflet-hash');

var L = global.L || require('leaflet');

global.turf = _turf2['default'];

var MAP_STYLE = 'mapbox.dark';
var LINE_WIDTH = 4;

var POSITION_STYLE = {
  color: '#f51a1a',
  fillOpacity: 0.5,
  weight: 2,
  radius: 6
};

function ringStyle(feature) {
  return {
    color: _colors2['default'][feature.properties.id],
    weight: LINE_WIDTH / (feature.properties.id + 1),
    fillOpacity: 0.1,
    clickable: false
  };
}

function bufferStyle(feature) {
  console.log(feature);
  return {
    color: _colors2['default'][feature.properties.id] || '#00f',
    weight: 1, //LINE_WIDTH / (feature.properties.id + 1),
    fillOpacity: 0,
    dashArray: [5, 5],
    clickable: false
  };
}

var App = (function () {
  function App(mapContainer, dataUrl) {
    _classCallCheck(this, App);

    var _L$Hash$parseHash = L.Hash.parseHash(location.hash);

    var center = _L$Hash$parseHash.center;
    var zoom = _L$Hash$parseHash.zoom;

    this._map = global.map = L.map(document.querySelector(mapContainer));

    this._positioned = center && zoom;
    if (this._positioned) {
      this._map.setView(center, zoom);
    }

    this._intersects = L.layerGroup().addTo(this._map);

    this._buffers = L.geoJson(null, { style: bufferStyle }).addTo(this._map);

    this._hash = L.hash(map);

    this._data = null;

    this._geojson = null;

    this._index = null;

    this._marker = null;

    this._info = document.querySelector('.info');

    // this._tiles = L.tileLayer(
    //   'https://api.mapbox.com/v4/' +
    //   MAP_STYLE +
    //   '/{z}/{x}/{y}.png?access_token=' +
    //   config.api_token, {
    //     attribution: 'Mapbox &copy; OSM contributors'
    // }).addTo(map);

    this._load(dataUrl);

    this._init();
  }

  _createClass(App, [{
    key: '_load',
    value: function _load(url) {
      (0, _xhr2['default'])({ url: url }, this._onLoad.bind(this));
    }
  }, {
    key: '_onLoad',
    value: function _onLoad(err, req, data) {
      if (err) throw new Error('failed to fetch data');

      this._data = data = JSON.parse(data);
      data.features.forEach(function (f) {
        f.properties.centroid = _geojsonUtils2['default'].centroid(f.geometry).coordinates;
      });

      this._geojson = L.geoJson(data, { style: ringStyle });

      if (!this._positioned) {
        map.fitBounds(this._geojson.getBounds(), { padding: [20, 20] });
      }
      this._geojson.addTo(map);
      this._index = (0, _leafletKnn2['default'])(this._geojson);
    }
  }, {
    key: '_init',
    value: function _init() {
      this._map.on('click', this._onMapClick, this);
      // let nearest = index.nearest(evt.latlng);
      // console.log(nearest);
    }
  }, {
    key: '_onMapClick',
    value: function _onMapClick(evt) {
      var _this = this;

      if (!this._marker) {
        this._marker = L.circleMarker(evt.latlng, POSITION_STYLE).addTo(this._map);
      } else {
        this._marker.setLatLng(evt.latlng);
      }
      this._intersects.clearLayers();

      L.Util.requestAnimFrame(function () {
        return _this._calculateDistances(evt.latlng);
      }, this);
    }
  }, {
    key: '_calculateDistances',
    value: function _calculateDistances(latlng) {
      var _this2 = this;

      var intersections = [];
      var point = _turf2['default'].point([latlng.lng, latlng.lat]);
      this._geojson.eachLayer(function (layer) {
        var f = layer.feature;
        var centroid = L.latLng(f.properties.centroid.slice().reverse());

        var intersects = _geojsonUtils2['default'].lineStringsIntersect({ coordinates: f.geometry.coordinates[0] }, { coordinates: [f.properties.centroid.slice(), [latlng.lng, latlng.lat]] });

        if (intersects) {
          intersects = intersects.pop();
          intersects.coordinates.reverse();
          L.circleMarker(intersects.coordinates.slice().reverse(), {
            radius: 2,
            color: _colors2['default'][f.properties.id]
          }); // .addTo(this._intersects);
          intersects = _turf2['default'].point(intersects.coordinates, { feature: f });
          // intersections.push(intersects);
        }

        var nearest = _turf2['default'].pointOnLine(_turf2['default'].linestring(f.geometry.coordinates[0]), point);
        L.circleMarker(nearest.geometry.coordinates.slice().reverse(), {
          radius: 2,
          color: _colors2['default'][f.properties.id]
        }).addTo(_this2._intersects);
        nearest.properties.feature = f;
        intersections.push(nearest);

        // visual
        // L.polyline([latlng, centroid], {
        //   weight: 1
        // }).addTo(this._map);
      }, this);

      this._info.innerHTML = '<pre>' + JSON.stringify(intersections.map(function (i) {
        var distance = _turf2['default'].distance(point, _turf2['default'].point(i.geometry.coordinates.slice()), "kilometers");
        if (_turf2['default'].inside(point, i.properties.feature)) {
          distance = -distance;
        }
        i.properties.distance = distance;
        return _defineProperty({}, i.properties.feature.properties.name, distance.toFixed(1) + ' km');
      }), 0, 2) + '</pre>';

      L.Util.requestAnimFrame(function () {
        return _this2._calculateBuffers(intersections);
      }, this);
    }
  }, {
    key: '_calculateBuffers',
    value: function _calculateBuffers(intersections) {
      var buffers = [];
      intersections.forEach(function (i) {
        if (i.properties.distance > 0) {
          buffers = buffers.concat(_turf2['default'].buffer(i.properties.feature, i.properties.distance, 'kilometers').features.map(function (f) {
            console.log(f);
            f.properties.id = i.properties.feature.properties.id;
            return f;
          }));
        }
      });
      buffers = _turf2['default'].featurecollection(buffers);
      this._buffers.clearLayers();
      this._buffers.addData(buffers);
    }
  }]);

  return App;
})();

exports['default'] = App;
module.exports = exports['default'];

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../config.json":1,"./colors":155,"babel-runtime/helpers/class-call-check":3,"babel-runtime/helpers/create-class":4,"babel-runtime/helpers/define-property":5,"babel-runtime/helpers/interop-require-default":6,"babel-runtime/helpers/interop-require-wildcard":7,"geojson-utils":14,"leaflet":22,"leaflet-geometryutil":15,"leaflet-hash":16,"leaflet-knn":17,"spin.js":23,"turf":24,"xhr":147}],155:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
    value: true
});
var COLORS = {
    0: '#f51a1a', // red square
    1: '#a21aff', // kremlin,
    2: '#b34b00', // boulevard
    3: '#18dbff', // garden ring
    4: '#ff1518', // third ring
    5: '#88fa60' // MKAD
};

exports['default'] = COLORS;
module.exports = exports['default'];

},{}],156:[function(require,module,exports){
(function (global){
'use strict';

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _app = require('./app');

var _app2 = _interopRequireDefault(_app);

var app = global.app = new _app2['default']('.map', 'data/data.json');

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./app":154,"babel-runtime/helpers/interop-require-default":6}]},{},[156])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjb25maWcuanNvbiIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eS5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3MtY2FsbC1jaGVjay5qcyIsIm5vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlLWNsYXNzLmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9oZWxwZXJzL2ludGVyb3AtcmVxdWlyZS1kZWZhdWx0LmpzIiwibm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy9pbnRlcm9wLXJlcXVpcmUtd2lsZGNhcmQuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9ub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHkuanMiLCJub2RlX21vZHVsZXMvYmFiZWwtcnVudGltZS9ub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvJC5qcyIsIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnVmZmVyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvbGliL2I2NC5qcyIsIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9idWZmZXIvbm9kZV9tb2R1bGVzL2llZWU3NTQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnVmZmVyL25vZGVfbW9kdWxlcy9pcy1hcnJheS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9nZW9qc29uLXV0aWxzL2dlb2pzb24tdXRpbHMuanMiLCJub2RlX21vZHVsZXMvbGVhZmxldC1nZW9tZXRyeXV0aWwvZGlzdC9sZWFmbGV0Lmdlb21ldHJ5dXRpbC5qcyIsIm5vZGVfbW9kdWxlcy9sZWFmbGV0LWhhc2gvbGVhZmxldC1oYXNoLmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL25vZGVfbW9kdWxlcy9zcGhlcmUta25uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL25vZGVfbW9kdWxlcy9zcGhlcmUta25uL2xpYi9iaW5hcnkuanMiLCJub2RlX21vZHVsZXMvbGVhZmxldC1rbm4vbm9kZV9tb2R1bGVzL3NwaGVyZS1rbm4vbGliL2tkLmpzIiwibm9kZV9tb2R1bGVzL2xlYWZsZXQta25uL25vZGVfbW9kdWxlcy9zcGhlcmUta25uL2xpYi9zcGhlcmVrZC5qcyIsIm5vZGVfbW9kdWxlcy9sZWFmbGV0L2Rpc3QvbGVhZmxldC1zcmMuanMiLCJub2RlX21vZHVsZXMvc3Bpbi5qcy9zcGluLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1hZ2dyZWdhdGUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1hbG9uZy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWFyZWEvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1hcmVhL25vZGVfbW9kdWxlcy9nZW9qc29uLWFyZWEvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1hcmVhL25vZGVfbW9kdWxlcy9nZW9qc29uLWFyZWEvbm9kZV9tb2R1bGVzL3dnczg0L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYXZlcmFnZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWJib3gtcG9seWdvbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWJlYXJpbmcvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1iZXppZXIvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1iZXppZXIvc3BsaW5lLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYnVmZmVyL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYnVmZmVyL25vZGVfbW9kdWxlcy9qc3RzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYnVmZmVyL25vZGVfbW9kdWxlcy9qc3RzL2xpYi9qc3RzLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtYnVmZmVyL25vZGVfbW9kdWxlcy9qc3RzL25vZGVfbW9kdWxlcy9qYXZhc2NyaXB0LnV0aWwvZGlzdC9qYXZhc2NyaXB0LnV0aWwtbm9kZS5taW4uanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1idWZmZXIvbm9kZV9tb2R1bGVzL2pzdHMvbm9kZV9tb2R1bGVzL2phdmFzY3JpcHQudXRpbC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNlbnRlci9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNlbnRyb2lkL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY2VudHJvaWQvbm9kZV9tb2R1bGVzL3R1cmYtbWV0YS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbWJpbmUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb25jYXZlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9jaC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbGliL2NoMWQuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvbm9kZV9tb2R1bGVzL2NvbnZleC1odWxsL2xpYi9jaDJkLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9saWIvY2huZC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2FmZmluZS1odWxsL2FmZi5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2FmZmluZS1odWxsL25vZGVfbW9kdWxlcy9yb2J1c3Qtb3JpZW50YXRpb24vbm9kZV9tb2R1bGVzL3JvYnVzdC1zY2FsZS9ub2RlX21vZHVsZXMvdHdvLXN1bS90d28tc3VtLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvYWZmaW5lLWh1bGwvbm9kZV9tb2R1bGVzL3JvYnVzdC1vcmllbnRhdGlvbi9ub2RlX21vZHVsZXMvcm9idXN0LXNjYWxlL3JvYnVzdC1zY2FsZS5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2FmZmluZS1odWxsL25vZGVfbW9kdWxlcy9yb2J1c3Qtb3JpZW50YXRpb24vbm9kZV9tb2R1bGVzL3JvYnVzdC1zdWJ0cmFjdC9yb2J1c3QtZGlmZi5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2FmZmluZS1odWxsL25vZGVfbW9kdWxlcy9yb2J1c3Qtb3JpZW50YXRpb24vbm9kZV9tb2R1bGVzL3JvYnVzdC1zdW0vcm9idXN0LXN1bS5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2FmZmluZS1odWxsL25vZGVfbW9kdWxlcy9yb2J1c3Qtb3JpZW50YXRpb24vbm9kZV9tb2R1bGVzL3R3by1wcm9kdWN0L3R3by1wcm9kdWN0LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvYWZmaW5lLWh1bGwvbm9kZV9tb2R1bGVzL3JvYnVzdC1vcmllbnRhdGlvbi9vcmllbnRhdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2luY3JlbWVudGFsLWNvbnZleC1odWxsL2ljaC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL2luY3JlbWVudGFsLWNvbnZleC1odWxsL25vZGVfbW9kdWxlcy9zaW1wbGljaWFsLWNvbXBsZXgvbm9kZV9tb2R1bGVzL2JpdC10d2lkZGxlL3R3aWRkbGUuanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1jb252ZXgvbm9kZV9tb2R1bGVzL2NvbnZleC1odWxsL25vZGVfbW9kdWxlcy9pbmNyZW1lbnRhbC1jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvc2ltcGxpY2lhbC1jb21wbGV4L25vZGVfbW9kdWxlcy91bmlvbi1maW5kL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY29udmV4L25vZGVfbW9kdWxlcy9jb252ZXgtaHVsbC9ub2RlX21vZHVsZXMvaW5jcmVtZW50YWwtY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL3NpbXBsaWNpYWwtY29tcGxleC90b3BvbG9neS5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWNvbnZleC9ub2RlX21vZHVsZXMvY29udmV4LWh1bGwvbm9kZV9tb2R1bGVzL21vbm90b25lLWNvbnZleC1odWxsLTJkL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtY291bnQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1kZXN0aW5hdGlvbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWRldmlhdGlvbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWRldmlhdGlvbi9ub2RlX21vZHVsZXMvc2ltcGxlLXN0YXRpc3RpY3Mvc3JjL3NpbXBsZV9zdGF0aXN0aWNzLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZGlzdGFuY2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1kaXN0YW5jZS9ub2RlX21vZHVsZXMvdHVyZi1pbnZhcmlhbnQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1lbnZlbG9wZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWVyYXNlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtZXJhc2Uvbm9kZV9tb2R1bGVzL2pzdHMvbm9kZV9tb2R1bGVzL2phdmFzY3JpcHQudXRpbC9kaXN0L2phdmFzY3JpcHQudXRpbC1ub2RlLm1pbi5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWV4cGxvZGUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1leHRlbnQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1mZWF0dXJlY29sbGVjdGlvbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWZpbHRlci9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWZsaXAvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1oZXgtZ3JpZC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWluc2lkZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWludGVyc2VjdC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWludGVyc2VjdC9ub2RlX21vZHVsZXMvanN0cy9ub2RlX21vZHVsZXMvamF2YXNjcmlwdC51dGlsL2Rpc3QvamF2YXNjcmlwdC51dGlsLW5vZGUubWluLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtaXNvbGluZXMvY29ucmVjLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtaXNvbGluZXMvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1pc29saW5lcy9ub2RlX21vZHVsZXMvdHVyZi1ncmlkL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtamVua3MvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1raW5rcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLWxpbmUtZGlzdGFuY2UvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1saW5lLXNsaWNlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtbGluZXN0cmluZy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLW1heC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLW1lZGlhbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLW1lcmdlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtbWVyZ2Uvbm9kZV9tb2R1bGVzL2Nsb25lL2Nsb25lLmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtbWlkcG9pbnQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1taW4vaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1uZWFyZXN0L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcGxhbmVwb2ludC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXBvaW50LWdyaWQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1wb2ludC1vbi1saW5lL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcG9pbnQtb24tc3VyZmFjZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXBvaW50L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcG9seWdvbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXF1YW50aWxlL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcmFuZG9tL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3R1cmYvbm9kZV9tb2R1bGVzL3R1cmYtcmFuZG9tL25vZGVfbW9kdWxlcy9nZW9qc29uLXJhbmRvbS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXJlY2xhc3MvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1yZW1vdmUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1zYW1wbGUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1zaW1wbGlmeS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXNpbXBsaWZ5L25vZGVfbW9kdWxlcy9zaW1wbGlmeS1qcy9zaW1wbGlmeS5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXNpemUvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi1zcXVhcmUtZ3JpZC9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXNxdWFyZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXN1bS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXRhZy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXRpbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXRyaWFuZ2xlLWdyaWQvaW5kZXguanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi11bmlvbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXVuaW9uL25vZGVfbW9kdWxlcy9qc3RzL25vZGVfbW9kdWxlcy9qYXZhc2NyaXB0LnV0aWwvZGlzdC9qYXZhc2NyaXB0LnV0aWwtbm9kZS5taW4uanMiLCJub2RlX21vZHVsZXMvdHVyZi9ub2RlX21vZHVsZXMvdHVyZi12YXJpYW5jZS9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy90dXJmL25vZGVfbW9kdWxlcy90dXJmLXdpdGhpbi9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy94aHIvaW5kZXguanMiLCJub2RlX21vZHVsZXMveGhyL25vZGVfbW9kdWxlcy9nbG9iYWwvd2luZG93LmpzIiwibm9kZV9tb2R1bGVzL3hoci9ub2RlX21vZHVsZXMvb25jZS9vbmNlLmpzIiwibm9kZV9tb2R1bGVzL3hoci9ub2RlX21vZHVsZXMvcGFyc2UtaGVhZGVycy9ub2RlX21vZHVsZXMvZm9yLWVhY2gvaW5kZXguanMiLCJub2RlX21vZHVsZXMveGhyL25vZGVfbW9kdWxlcy9wYXJzZS1oZWFkZXJzL25vZGVfbW9kdWxlcy9mb3ItZWFjaC9ub2RlX21vZHVsZXMvaXMtZnVuY3Rpb24vaW5kZXguanMiLCJub2RlX21vZHVsZXMveGhyL25vZGVfbW9kdWxlcy9wYXJzZS1oZWFkZXJzL25vZGVfbW9kdWxlcy90cmltL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3hoci9ub2RlX21vZHVsZXMvcGFyc2UtaGVhZGVycy9wYXJzZS1oZWFkZXJzLmpzIiwiL1VzZXJzL3c4ci9Qcm9qZWN0cy9tb3Njb3ctcmluZ3Mvc3JjL2FwcC5qcyIsIi9Vc2Vycy93OHIvUHJvamVjdHMvbW9zY293LXJpbmdzL3NyYy9jb2xvcnMuanMiLCIvVXNlcnMvdzhyL1Byb2plY3RzL21vc2Nvdy1yaW5ncy9zcmMvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3hnREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4WkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzE4UkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDck1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlGQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM1cURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDMUNBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O0FDN2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7O0FDaEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqaURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FDaEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3BFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsZ0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNoRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2hKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25LQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FDekVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQy9IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQzdMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OzttQkM1QmdCLEtBQUs7Ozs7c0JBQ0ksU0FBUzs7SUFBdEIsT0FBTzs7MEJBQ0ssZ0JBQWdCOztJQUE1QixNQUFNOztzQkFDQyxVQUFVOzs7OzBCQUNOLGFBQWE7Ozs7b0JBQ25CLE1BQU07Ozs7NEJBQ0gsZUFBZTs7OzttQ0FDbEIsc0JBQXNCOzs7O1FBQ2hDLGNBQWM7O0FBVnJCLElBQU0sQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLElBQUksT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDOztBQVl6QyxNQUFNLENBQUMsSUFBSSxvQkFBTyxDQUFDOztBQUVuQixJQUFNLFNBQVMsR0FBRyxhQUFhLENBQUM7QUFDaEMsSUFBTSxVQUFVLEdBQUcsQ0FBQyxDQUFDOztBQUVyQixJQUFNLGNBQWMsR0FBRztBQUNyQixPQUFLLEVBQUUsU0FBUztBQUNoQixhQUFXLEVBQUUsR0FBRztBQUNoQixRQUFNLEVBQUUsQ0FBQztBQUNULFFBQU0sRUFBRSxDQUFDO0NBQ1YsQ0FBQTs7QUFFRCxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUU7QUFDMUIsU0FBTztBQUNMLFNBQUssRUFBRSxvQkFBTyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztBQUNwQyxVQUFNLEVBQUUsVUFBVSxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQSxBQUFDO0FBQ2hELGVBQVcsRUFBRSxHQUFHO0FBQ2hCLGFBQVMsRUFBRSxLQUFLO0dBQ2pCLENBQUM7Q0FDSDs7QUFFRCxTQUFTLFdBQVcsQ0FBQyxPQUFPLEVBQUU7QUFDNUIsU0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNyQixTQUFPO0FBQ0wsU0FBSyxFQUFFLG9CQUFPLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLElBQUksTUFBTTtBQUM5QyxVQUFNLEVBQUUsQ0FBQztBQUNULGVBQVcsRUFBRSxDQUFDO0FBQ2QsYUFBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNqQixhQUFTLEVBQUUsS0FBSztHQUNqQixDQUFDO0NBQ0g7O0lBRW9CLEdBQUc7QUFFWCxXQUZRLEdBQUcsQ0FFVixZQUFZLEVBQUUsT0FBTyxFQUFFOzBCQUZoQixHQUFHOzs0QkFJRyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDOztRQUFoRCxNQUFNLHFCQUFOLE1BQU07UUFBRSxJQUFJLHFCQUFKLElBQUk7O0FBRWxCLFFBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQzs7QUFFckUsUUFBSSxDQUFDLFdBQVcsR0FBSSxNQUFNLElBQUksSUFBSSxBQUFDLENBQUE7QUFDbkMsUUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO0FBQ3BCLFVBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztLQUNqQzs7QUFFRCxRQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDOztBQUVuRCxRQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzs7QUFFekUsUUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDOztBQUV6QixRQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQzs7QUFFbEIsUUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7O0FBRXJCLFFBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDOztBQUVuQixRQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQzs7QUFFcEIsUUFBSSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDOzs7Ozs7Ozs7O0FBVTdDLFFBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7O0FBRXBCLFFBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztHQUNkOztlQXhDa0IsR0FBRzs7V0EwQ2pCLGVBQUMsR0FBRyxFQUFFO0FBQ1QsNEJBQUksRUFBRSxHQUFHLEVBQUgsR0FBRyxFQUFFLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztLQUN2Qzs7O1dBRU0saUJBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUU7QUFDdEIsVUFBSSxHQUFHLEVBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDOztBQUVqRCxVQUFJLENBQUMsS0FBSyxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3JDLFVBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLFVBQUMsQ0FBQyxFQUFLO0FBQzNCLFNBQUMsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUNuQiwwQkFBUSxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsQ0FBQztPQUM1QyxDQUFDLENBQUM7O0FBRUgsVUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDOztBQUV0RCxVQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRTtBQUNwQixXQUFHLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFLEVBQUUsRUFBQyxPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDO09BQy9EO0FBQ0QsVUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDekIsVUFBSSxDQUFDLE1BQU0sR0FBRyw2QkFBVyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7S0FDekM7OztXQUVJLGlCQUFHO0FBQ04sVUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUM7OztLQUcvQzs7O1dBRVUscUJBQUMsR0FBRyxFQUFFOzs7QUFDZixVQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRTtBQUNqQixZQUFJLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsQ0FDdEQsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztPQUNyQixNQUFNO0FBQ0wsWUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO09BQ3BDO0FBQ0QsVUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUUsQ0FBQzs7QUFFL0IsT0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQztlQUFNLE1BQUssbUJBQW1CLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQztPQUFBLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDM0U7OztXQUVrQiw2QkFBQyxNQUFNLEVBQUU7OztBQUMxQixVQUFJLGFBQWEsR0FBRyxFQUFFLENBQUM7QUFDdkIsVUFBSSxLQUFLLEdBQUcsa0JBQUssS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNqRCxVQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxVQUFDLEtBQUssRUFBSztBQUNqQyxZQUFJLENBQUMsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDO0FBQ3RCLFlBQUksUUFBUSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQzs7QUFFakUsWUFBSSxVQUFVLEdBQUcsMEJBQVEsb0JBQW9CLENBQzNDLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQzFDLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQzNFLENBQUM7O0FBRUYsWUFBRyxVQUFVLEVBQUU7QUFDYixvQkFBVSxHQUFHLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUM5QixvQkFBVSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUNqQyxXQUFDLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUMsT0FBTyxFQUFFLEVBQUU7QUFDdkQsa0JBQU0sRUFBRSxDQUFDO0FBQ1QsaUJBQUssRUFBRSxvQkFBTyxDQUFDLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztXQUMvQixDQUFDLENBQUM7QUFDSCxvQkFBVSxHQUFHLGtCQUFLLEtBQUssQ0FBQyxVQUFVLENBQUMsV0FBVyxFQUFFLEVBQUUsT0FBTyxFQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7O1NBRWxFOztBQUVELFlBQUksT0FBTyxHQUFHLGtCQUFLLFdBQVcsQ0FDNUIsa0JBQUssVUFBVSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDckQsU0FBQyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRTtBQUMzRCxnQkFBTSxFQUFFLENBQUM7QUFDVCxlQUFLLEVBQUUsb0JBQU8sQ0FBQyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7U0FDL0IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFLLFdBQVcsQ0FBQyxDQUFDO0FBQzdCLGVBQU8sQ0FBQyxVQUFVLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQztBQUMvQixxQkFBYSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQzs7Ozs7O09BTTdCLEVBQUUsSUFBSSxDQUFDLENBQUM7O0FBRVQsVUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEdBQUcsT0FBTyxHQUMxQixJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDLEVBQUs7QUFDdEMsWUFBSSxRQUFRLEdBQUcsa0JBQUssUUFBUSxDQUN4QixLQUFLLEVBQUUsa0JBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQ2pELFlBQVksQ0FDZixDQUFDO0FBQ0YsWUFBSSxrQkFBSyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUU7QUFDNUMsa0JBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQztTQUN0QjtBQUNELFNBQUMsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztBQUNqQyxtQ0FDRyxDQUFDLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUNuQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLEtBQUssRUFDOUI7T0FDRixDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUNYLFFBQVEsQ0FBQzs7QUFFWCxPQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDO2VBQU0sT0FBSyxpQkFBaUIsQ0FBQyxhQUFhLENBQUM7T0FBQSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzVFOzs7V0FFZ0IsMkJBQUMsYUFBYSxFQUFFO0FBQy9CLFVBQUksT0FBTyxHQUFHLEVBQUUsQ0FBQztBQUNqQixtQkFBYSxDQUFDLE9BQU8sQ0FBQyxVQUFDLENBQUMsRUFBSztBQUMzQixZQUFJLENBQUMsQ0FBQyxVQUFVLENBQUMsUUFBUSxHQUFHLENBQUMsRUFBRTtBQUM3QixpQkFBTyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQ3RCLGtCQUFLLE1BQU0sQ0FDVCxDQUFDLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFDcEIsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDLENBQUMsUUFBUSxDQUM5QyxHQUFHLENBQUMsVUFBQyxDQUFDLEVBQUs7QUFDVixtQkFBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNmLGFBQUMsQ0FBQyxVQUFVLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7QUFDckQsbUJBQU8sQ0FBQyxDQUFDO1dBQ1YsQ0FBQyxDQUFDLENBQUM7U0FDUDtPQUNGLENBQUMsQ0FBQztBQUNILGFBQU8sR0FBRyxrQkFBSyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUMxQyxVQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDO0FBQzVCLFVBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0tBQ2hDOzs7U0E5SmtCLEdBQUc7OztxQkFBSCxHQUFHOzs7Ozs7Ozs7OztBQzVDeEIsSUFBTSxNQUFNLEdBQUc7QUFDWCxLQUFDLEVBQUUsU0FBUztBQUNaLEtBQUMsRUFBRSxTQUFTO0FBQ1osS0FBQyxFQUFFLFNBQVM7QUFDWixLQUFDLEVBQUUsU0FBUztBQUNaLEtBQUMsRUFBRSxTQUFTO0FBQ1osS0FBQyxFQUFFLFNBQVM7Q0FDZixDQUFBOztxQkFFYyxNQUFNOzs7Ozs7Ozs7bUJDVEwsT0FBTzs7OztBQUV2QixJQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsR0FBRyxHQUFHLHFCQUFRLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIm1vZHVsZS5leHBvcnRzPXtcbiAgXCJhcGlfdG9rZW5cIjogXCJway5leUoxSWpvaWR6aHlJaXdpWVNJNkluQldWVVphU0RBaWZRLmxRVUpYTzZycXFBaUtSUjZWVzhURWdcIlxufVxuIiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIiksIF9fZXNNb2R1bGU6IHRydWUgfTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9PYmplY3QkZGVmaW5lUHJvcGVydHkgPSByZXF1aXJlKFwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9kZWZpbmUtcHJvcGVydHlcIilbXCJkZWZhdWx0XCJdO1xuXG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IChmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG4gICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuXG4gICAgICBfT2JqZWN0JGRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICByZXR1cm4gQ29uc3RydWN0b3I7XG4gIH07XG59KSgpO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX09iamVjdCRkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoXCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eVwiKVtcImRlZmF1bHRcIl07XG5cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZnVuY3Rpb24gKG9iaiwga2V5LCB2YWx1ZSkge1xuICBpZiAoa2V5IGluIG9iaikge1xuICAgIF9PYmplY3QkZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gIH1cblxuICByZXR1cm4gb2JqO1xufTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBmdW5jdGlvbiAob2JqKSB7XG4gIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7XG4gICAgXCJkZWZhdWx0XCI6IG9ialxuICB9O1xufTtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTsiLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBmdW5jdGlvbiAob2JqKSB7XG4gIGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHtcbiAgICByZXR1cm4gb2JqO1xuICB9IGVsc2Uge1xuICAgIHZhciBuZXdPYmogPSB7fTtcblxuICAgIGlmIChvYmogIT0gbnVsbCkge1xuICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBuZXdPYmpbXCJkZWZhdWx0XCJdID0gb2JqO1xuICAgIHJldHVybiBuZXdPYmo7XG4gIH1cbn07XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7IiwidmFyICQgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzLyQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkoaXQsIGtleSwgZGVzYyl7XG4gIHJldHVybiAkLnNldERlc2MoaXQsIGtleSwgZGVzYyk7XG59OyIsInZhciAkT2JqZWN0ID0gT2JqZWN0O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNyZWF0ZTogICAgICRPYmplY3QuY3JlYXRlLFxuICBnZXRQcm90bzogICAkT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICBpc0VudW06ICAgICB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxcbiAgZ2V0RGVzYzogICAgJE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gIHNldERlc2M6ICAgICRPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gIHNldERlc2NzOiAgICRPYmplY3QuZGVmaW5lUHJvcGVydGllcyxcbiAgZ2V0S2V5czogICAgJE9iamVjdC5rZXlzLFxuICBnZXROYW1lczogICAkT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMsXG4gIGdldFN5bWJvbHM6ICRPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzLFxuICBlYWNoOiAgICAgICBbXS5mb3JFYWNoXG59OyIsIi8qIVxuICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+XG4gKiBAbGljZW5zZSAgTUlUXG4gKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovXG5cbnZhciBiYXNlNjQgPSByZXF1aXJlKCdiYXNlNjQtanMnKVxudmFyIGllZWU3NTQgPSByZXF1aXJlKCdpZWVlNzU0JylcbnZhciBpc0FycmF5ID0gcmVxdWlyZSgnaXMtYXJyYXknKVxuXG5leHBvcnRzLkJ1ZmZlciA9IEJ1ZmZlclxuZXhwb3J0cy5TbG93QnVmZmVyID0gU2xvd0J1ZmZlclxuZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUyA9IDUwXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxudmFyIHJvb3RQYXJlbnQgPSB7fVxuXG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuXG4gKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy5cbiAqXG4gKiBOb3RlOlxuICpcbiAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsXG4gKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguXG4gKlxuICogICAtIFNhZmFyaSA1LTcgbGFja3Mgc3VwcG9ydCBmb3IgY2hhbmdpbmcgdGhlIGBPYmplY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yYCBwcm9wZXJ0eVxuICogICAgIG9uIG9iamVjdHMuXG4gKlxuICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2ZcbiAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy5cblxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXlcbiAqIGdldCB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uLCB3aGljaCBpcyBzbG93ZXIgYnV0IGJlaGF2ZXMgY29ycmVjdGx5LlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUICE9PSB1bmRlZmluZWRcbiAgPyBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVFxuICA6IHR5cGVkQXJyYXlTdXBwb3J0KClcblxuZnVuY3Rpb24gdHlwZWRBcnJheVN1cHBvcnQgKCkge1xuICBmdW5jdGlvbiBCYXIgKCkge31cbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSlcbiAgICBhcnIuZm9vID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfVxuICAgIGFyci5jb25zdHJ1Y3RvciA9IEJhclxuICAgIHJldHVybiBhcnIuZm9vKCkgPT09IDQyICYmIC8vIHR5cGVkIGFycmF5IGluc3RhbmNlcyBjYW4gYmUgYXVnbWVudGVkXG4gICAgICAgIGFyci5jb25zdHJ1Y3RvciA9PT0gQmFyICYmIC8vIGNvbnN0cnVjdG9yIGNhbiBiZSBzZXRcbiAgICAgICAgdHlwZW9mIGFyci5zdWJhcnJheSA9PT0gJ2Z1bmN0aW9uJyAmJiAvLyBjaHJvbWUgOS0xMCBsYWNrIGBzdWJhcnJheWBcbiAgICAgICAgYXJyLnN1YmFycmF5KDEsIDEpLmJ5dGVMZW5ndGggPT09IDAgLy8gaWUxMCBoYXMgYnJva2VuIGBzdWJhcnJheWBcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbmZ1bmN0aW9uIGtNYXhMZW5ndGggKCkge1xuICByZXR1cm4gQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRcbiAgICA/IDB4N2ZmZmZmZmZcbiAgICA6IDB4M2ZmZmZmZmZcbn1cblxuLyoqXG4gKiBDbGFzczogQnVmZmVyXG4gKiA9PT09PT09PT09PT09XG4gKlxuICogVGhlIEJ1ZmZlciBjb25zdHJ1Y3RvciByZXR1cm5zIGluc3RhbmNlcyBvZiBgVWludDhBcnJheWAgdGhhdCBhcmUgYXVnbWVudGVkXG4gKiB3aXRoIGZ1bmN0aW9uIHByb3BlcnRpZXMgZm9yIGFsbCB0aGUgbm9kZSBgQnVmZmVyYCBBUEkgZnVuY3Rpb25zLiBXZSB1c2VcbiAqIGBVaW50OEFycmF5YCBzbyB0aGF0IHNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0IHJldHVybnNcbiAqIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIEJ5IGF1Z21lbnRpbmcgdGhlIGluc3RhbmNlcywgd2UgY2FuIGF2b2lkIG1vZGlmeWluZyB0aGUgYFVpbnQ4QXJyYXlgXG4gKiBwcm90b3R5cGUuXG4gKi9cbmZ1bmN0aW9uIEJ1ZmZlciAoYXJnKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBCdWZmZXIpKSB7XG4gICAgLy8gQXZvaWQgZ29pbmcgdGhyb3VnaCBhbiBBcmd1bWVudHNBZGFwdG9yVHJhbXBvbGluZSBpbiB0aGUgY29tbW9uIGNhc2UuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSByZXR1cm4gbmV3IEJ1ZmZlcihhcmcsIGFyZ3VtZW50c1sxXSlcbiAgICByZXR1cm4gbmV3IEJ1ZmZlcihhcmcpXG4gIH1cblxuICB0aGlzLmxlbmd0aCA9IDBcbiAgdGhpcy5wYXJlbnQgPSB1bmRlZmluZWRcblxuICAvLyBDb21tb24gY2FzZS5cbiAgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIGZyb21OdW1iZXIodGhpcywgYXJnKVxuICB9XG5cbiAgLy8gU2xpZ2h0bHkgbGVzcyBjb21tb24gY2FzZS5cbiAgaWYgKHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZyb21TdHJpbmcodGhpcywgYXJnLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6ICd1dGY4JylcbiAgfVxuXG4gIC8vIFVudXN1YWwuXG4gIHJldHVybiBmcm9tT2JqZWN0KHRoaXMsIGFyZylcbn1cblxuZnVuY3Rpb24gZnJvbU51bWJlciAodGhhdCwgbGVuZ3RoKSB7XG4gIHRoYXQgPSBhbGxvY2F0ZSh0aGF0LCBsZW5ndGggPCAwID8gMCA6IGNoZWNrZWQobGVuZ3RoKSB8IDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGF0W2ldID0gMFxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tU3RyaW5nICh0aGF0LCBzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmICh0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnIHx8IGVuY29kaW5nID09PSAnJykgZW5jb2RpbmcgPSAndXRmOCdcblxuICAvLyBBc3N1bXB0aW9uOiBieXRlTGVuZ3RoKCkgcmV0dXJuIHZhbHVlIGlzIGFsd2F5cyA8IGtNYXhMZW5ndGguXG4gIHZhciBsZW5ndGggPSBieXRlTGVuZ3RoKHN0cmluZywgZW5jb2RpbmcpIHwgMFxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuXG4gIHRoYXQud3JpdGUoc3RyaW5nLCBlbmNvZGluZylcbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqZWN0KSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqZWN0KSkgcmV0dXJuIGZyb21CdWZmZXIodGhhdCwgb2JqZWN0KVxuXG4gIGlmIChpc0FycmF5KG9iamVjdCkpIHJldHVybiBmcm9tQXJyYXkodGhhdCwgb2JqZWN0KVxuXG4gIGlmIChvYmplY3QgPT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ211c3Qgc3RhcnQgd2l0aCBudW1iZXIsIGJ1ZmZlciwgYXJyYXkgb3Igc3RyaW5nJylcbiAgfVxuXG4gIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKG9iamVjdC5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgcmV0dXJuIGZyb21UeXBlZEFycmF5KHRoYXQsIG9iamVjdClcbiAgICB9XG4gICAgaWYgKG9iamVjdCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICByZXR1cm4gZnJvbUFycmF5QnVmZmVyKHRoYXQsIG9iamVjdClcbiAgICB9XG4gIH1cblxuICBpZiAob2JqZWN0Lmxlbmd0aCkgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqZWN0KVxuXG4gIHJldHVybiBmcm9tSnNvbk9iamVjdCh0aGF0LCBvYmplY3QpXG59XG5cbmZ1bmN0aW9uIGZyb21CdWZmZXIgKHRoYXQsIGJ1ZmZlcikge1xuICB2YXIgbGVuZ3RoID0gY2hlY2tlZChidWZmZXIubGVuZ3RoKSB8IDBcbiAgdGhhdCA9IGFsbG9jYXRlKHRoYXQsIGxlbmd0aClcbiAgYnVmZmVyLmNvcHkodGhhdCwgMCwgMCwgbGVuZ3RoKVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXkgKHRoYXQsIGFycmF5KSB7XG4gIHZhciBsZW5ndGggPSBjaGVja2VkKGFycmF5Lmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBhbGxvY2F0ZSh0aGF0LCBsZW5ndGgpXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTVcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG4vLyBEdXBsaWNhdGUgb2YgZnJvbUFycmF5KCkgdG8ga2VlcCBmcm9tQXJyYXkoKSBtb25vbW9ycGhpYy5cbmZ1bmN0aW9uIGZyb21UeXBlZEFycmF5ICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuICAvLyBUcnVuY2F0aW5nIHRoZSBlbGVtZW50cyBpcyBwcm9iYWJseSBub3Qgd2hhdCBwZW9wbGUgZXhwZWN0IGZyb20gdHlwZWRcbiAgLy8gYXJyYXlzIHdpdGggQllURVNfUEVSX0VMRU1FTlQgPiAxIGJ1dCBpdCdzIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3JcbiAgLy8gb2YgdGhlIG9sZCBCdWZmZXIgY29uc3RydWN0b3IuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTVcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlCdWZmZXIgKHRoYXQsIGFycmF5KSB7XG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlLCBmb3IgYmVzdCBwZXJmb3JtYW5jZVxuICAgIGFycmF5LmJ5dGVMZW5ndGhcbiAgICB0aGF0ID0gQnVmZmVyLl9hdWdtZW50KG5ldyBVaW50OEFycmF5KGFycmF5KSlcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgdGhhdCA9IGZyb21UeXBlZEFycmF5KHRoYXQsIG5ldyBVaW50OEFycmF5KGFycmF5KSlcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB0aGF0ID0gYWxsb2NhdGUodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuLy8gRGVzZXJpYWxpemUgeyB0eXBlOiAnQnVmZmVyJywgZGF0YTogWzEsMiwzLC4uLl0gfSBpbnRvIGEgQnVmZmVyIG9iamVjdC5cbi8vIFJldHVybnMgYSB6ZXJvLWxlbmd0aCBidWZmZXIgZm9yIGlucHV0cyB0aGF0IGRvbid0IGNvbmZvcm0gdG8gdGhlIHNwZWMuXG5mdW5jdGlvbiBmcm9tSnNvbk9iamVjdCAodGhhdCwgb2JqZWN0KSB7XG4gIHZhciBhcnJheVxuICB2YXIgbGVuZ3RoID0gMFxuXG4gIGlmIChvYmplY3QudHlwZSA9PT0gJ0J1ZmZlcicgJiYgaXNBcnJheShvYmplY3QuZGF0YSkpIHtcbiAgICBhcnJheSA9IG9iamVjdC5kYXRhXG4gICAgbGVuZ3RoID0gY2hlY2tlZChhcnJheS5sZW5ndGgpIHwgMFxuICB9XG4gIHRoYXQgPSBhbGxvY2F0ZSh0aGF0LCBsZW5ndGgpXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIHRoYXRbaV0gPSBhcnJheVtpXSAmIDI1NVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbmlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICBCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlXG4gIEJ1ZmZlci5fX3Byb3RvX18gPSBVaW50OEFycmF5XG59XG5cbmZ1bmN0aW9uIGFsbG9jYXRlICh0aGF0LCBsZW5ndGgpIHtcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgLy8gUmV0dXJuIGFuIGF1Z21lbnRlZCBgVWludDhBcnJheWAgaW5zdGFuY2UsIGZvciBiZXN0IHBlcmZvcm1hbmNlXG4gICAgdGhhdCA9IEJ1ZmZlci5fYXVnbWVudChuZXcgVWludDhBcnJheShsZW5ndGgpKVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aFxuICAgIHRoYXQuX2lzQnVmZmVyID0gdHJ1ZVxuICB9XG5cbiAgdmFyIGZyb21Qb29sID0gbGVuZ3RoICE9PSAwICYmIGxlbmd0aCA8PSBCdWZmZXIucG9vbFNpemUgPj4+IDFcbiAgaWYgKGZyb21Qb29sKSB0aGF0LnBhcmVudCA9IHJvb3RQYXJlbnRcblxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBjaGVja2VkIChsZW5ndGgpIHtcbiAgLy8gTm90ZTogY2Fubm90IHVzZSBgbGVuZ3RoIDwga01heExlbmd0aGAgaGVyZSBiZWNhdXNlIHRoYXQgZmFpbHMgd2hlblxuICAvLyBsZW5ndGggaXMgTmFOICh3aGljaCBpcyBvdGhlcndpc2UgY29lcmNlZCB0byB6ZXJvLilcbiAgaWYgKGxlbmd0aCA+PSBrTWF4TGVuZ3RoKCkpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byBhbGxvY2F0ZSBCdWZmZXIgbGFyZ2VyIHRoYW4gbWF4aW11bSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAnc2l6ZTogMHgnICsga01heExlbmd0aCgpLnRvU3RyaW5nKDE2KSArICcgYnl0ZXMnKVxuICB9XG4gIHJldHVybiBsZW5ndGggfCAwXG59XG5cbmZ1bmN0aW9uIFNsb3dCdWZmZXIgKHN1YmplY3QsIGVuY29kaW5nKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBTbG93QnVmZmVyKSkgcmV0dXJuIG5ldyBTbG93QnVmZmVyKHN1YmplY3QsIGVuY29kaW5nKVxuXG4gIHZhciBidWYgPSBuZXcgQnVmZmVyKHN1YmplY3QsIGVuY29kaW5nKVxuICBkZWxldGUgYnVmLnBhcmVudFxuICByZXR1cm4gYnVmXG59XG5cbkJ1ZmZlci5pc0J1ZmZlciA9IGZ1bmN0aW9uIGlzQnVmZmVyIChiKSB7XG4gIHJldHVybiAhIShiICE9IG51bGwgJiYgYi5faXNCdWZmZXIpXG59XG5cbkJ1ZmZlci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYSwgYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihhKSB8fCAhQnVmZmVyLmlzQnVmZmVyKGIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnRzIG11c3QgYmUgQnVmZmVycycpXG4gIH1cblxuICBpZiAoYSA9PT0gYikgcmV0dXJuIDBcblxuICB2YXIgeCA9IGEubGVuZ3RoXG4gIHZhciB5ID0gYi5sZW5ndGhcblxuICB2YXIgaSA9IDBcbiAgdmFyIGxlbiA9IE1hdGgubWluKHgsIHkpXG4gIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgaWYgKGFbaV0gIT09IGJbaV0pIGJyZWFrXG5cbiAgICArK2lcbiAgfVxuXG4gIGlmIChpICE9PSBsZW4pIHtcbiAgICB4ID0gYVtpXVxuICAgIHkgPSBiW2ldXG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlICdoZXgnOlxuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICBjYXNlICdhc2NpaSc6XG4gICAgY2FzZSAnYmluYXJ5JzpcbiAgICBjYXNlICdiYXNlNjQnOlxuICAgIGNhc2UgJ3Jhdyc6XG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkge1xuICBpZiAoIWlzQXJyYXkobGlzdCkpIHRocm93IG5ldyBUeXBlRXJyb3IoJ2xpc3QgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzLicpXG5cbiAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG5ldyBCdWZmZXIoMClcbiAgfVxuXG4gIHZhciBpXG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGxlbmd0aCA9IDBcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgbGVuZ3RoICs9IGxpc3RbaV0ubGVuZ3RoXG4gICAgfVxuICB9XG5cbiAgdmFyIGJ1ZiA9IG5ldyBCdWZmZXIobGVuZ3RoKVxuICB2YXIgcG9zID0gMFxuICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgIHZhciBpdGVtID0gbGlzdFtpXVxuICAgIGl0ZW0uY29weShidWYsIHBvcylcbiAgICBwb3MgKz0gaXRlbS5sZW5ndGhcbiAgfVxuICByZXR1cm4gYnVmXG59XG5cbmZ1bmN0aW9uIGJ5dGVMZW5ndGggKHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSBzdHJpbmcgPSAnJyArIHN0cmluZ1xuXG4gIHZhciBsZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChsZW4gPT09IDApIHJldHVybiAwXG5cbiAgLy8gVXNlIGEgZm9yIGxvb3AgdG8gYXZvaWQgcmVjdXJzaW9uXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgLy8gRGVwcmVjYXRlZFxuICAgICAgY2FzZSAncmF3JzpcbiAgICAgIGNhc2UgJ3Jhd3MnOlxuICAgICAgICByZXR1cm4gbGVuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gbGVuICogMlxuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGxlbiA+Pj4gMVxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGhcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoIC8vIGFzc3VtZSB1dGY4XG4gICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5CdWZmZXIuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGhcblxuLy8gcHJlLXNldCBmb3IgdmFsdWVzIHRoYXQgbWF5IGV4aXN0IGluIHRoZSBmdXR1cmVcbkJ1ZmZlci5wcm90b3R5cGUubGVuZ3RoID0gdW5kZWZpbmVkXG5CdWZmZXIucHJvdG90eXBlLnBhcmVudCA9IHVuZGVmaW5lZFxuXG5mdW5jdGlvbiBzbG93VG9TdHJpbmcgKGVuY29kaW5nLCBzdGFydCwgZW5kKSB7XG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG5cbiAgc3RhcnQgPSBzdGFydCB8IDBcbiAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgfHwgZW5kID09PSBJbmZpbml0eSA/IHRoaXMubGVuZ3RoIDogZW5kIHwgMFxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG4gIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmIChlbmQgPD0gc3RhcnQpIHJldHVybiAnJ1xuXG4gIHdoaWxlICh0cnVlKSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGJpbmFyeVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdXRmMTZsZVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9IChlbmNvZGluZyArICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcgKCkge1xuICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggfCAwXG4gIGlmIChsZW5ndGggPT09IDApIHJldHVybiAnJ1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCAwLCBsZW5ndGgpXG4gIHJldHVybiBzbG93VG9TdHJpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIGVxdWFscyAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gdHJ1ZVxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYikgPT09IDBcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbnNwZWN0ID0gZnVuY3Rpb24gaW5zcGVjdCAoKSB7XG4gIHZhciBzdHIgPSAnJ1xuICB2YXIgbWF4ID0gZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFU1xuICBpZiAodGhpcy5sZW5ndGggPiAwKSB7XG4gICAgc3RyID0gdGhpcy50b1N0cmluZygnaGV4JywgMCwgbWF4KS5tYXRjaCgvLnsyfS9nKS5qb2luKCcgJylcbiAgICBpZiAodGhpcy5sZW5ndGggPiBtYXgpIHN0ciArPSAnIC4uLiAnXG4gIH1cbiAgcmV0dXJuICc8QnVmZmVyICcgKyBzdHIgKyAnPidcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSAoYikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIGlmICh0aGlzID09PSBiKSByZXR1cm4gMFxuICByZXR1cm4gQnVmZmVyLmNvbXBhcmUodGhpcywgYilcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gaW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0KSB7XG4gIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikgYnl0ZU9mZnNldCA9IDB4N2ZmZmZmZmZcbiAgZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSBieXRlT2Zmc2V0ID0gLTB4ODAwMDAwMDBcbiAgYnl0ZU9mZnNldCA+Pj0gMFxuXG4gIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xXG4gIGlmIChieXRlT2Zmc2V0ID49IHRoaXMubGVuZ3RoKSByZXR1cm4gLTFcblxuICAvLyBOZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IE1hdGgubWF4KHRoaXMubGVuZ3RoICsgYnl0ZU9mZnNldCwgMClcblxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAodmFsLmxlbmd0aCA9PT0gMCkgcmV0dXJuIC0xIC8vIHNwZWNpYWwgY2FzZTogbG9va2luZyBmb3IgZW1wdHkgc3RyaW5nIGFsd2F5cyBmYWlsc1xuICAgIHJldHVybiBTdHJpbmcucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0aGlzLCB2YWwsIGJ5dGVPZmZzZXQpXG4gIH1cbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQpXG4gIH1cbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmIFVpbnQ4QXJyYXkucHJvdG90eXBlLmluZGV4T2YgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwodGhpcywgdmFsLCBieXRlT2Zmc2V0KVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXlJbmRleE9mKHRoaXMsIFsgdmFsIF0sIGJ5dGVPZmZzZXQpXG4gIH1cblxuICBmdW5jdGlvbiBhcnJheUluZGV4T2YgKGFyciwgdmFsLCBieXRlT2Zmc2V0KSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAodmFyIGkgPSAwOyBieXRlT2Zmc2V0ICsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGFycltieXRlT2Zmc2V0ICsgaV0gPT09IHZhbFtmb3VuZEluZGV4ID09PSAtMSA/IDAgOiBpIC0gZm91bmRJbmRleF0pIHtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggPT09IC0xKSBmb3VuZEluZGV4ID0gaVxuICAgICAgICBpZiAoaSAtIGZvdW5kSW5kZXggKyAxID09PSB2YWwubGVuZ3RoKSByZXR1cm4gYnl0ZU9mZnNldCArIGZvdW5kSW5kZXhcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvdW5kSW5kZXggPSAtMVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTFcbiAgfVxuXG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ZhbCBtdXN0IGJlIHN0cmluZywgbnVtYmVyIG9yIEJ1ZmZlcicpXG59XG5cbi8vIGBnZXRgIGlzIGRlcHJlY2F0ZWRcbkJ1ZmZlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gZ2V0IChvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5nZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLnJlYWRVSW50OChvZmZzZXQpXG59XG5cbi8vIGBzZXRgIGlzIGRlcHJlY2F0ZWRcbkJ1ZmZlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gc2V0ICh2LCBvZmZzZXQpIHtcbiAgY29uc29sZS5sb2coJy5zZXQoKSBpcyBkZXByZWNhdGVkLiBBY2Nlc3MgdXNpbmcgYXJyYXkgaW5kZXhlcyBpbnN0ZWFkLicpXG4gIHJldHVybiB0aGlzLndyaXRlVUludDgodiwgb2Zmc2V0KVxufVxuXG5mdW5jdGlvbiBoZXhXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIG9mZnNldCA9IE51bWJlcihvZmZzZXQpIHx8IDBcbiAgdmFyIHJlbWFpbmluZyA9IGJ1Zi5sZW5ndGggLSBvZmZzZXRcbiAgaWYgKCFsZW5ndGgpIHtcbiAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgfSBlbHNlIHtcbiAgICBsZW5ndGggPSBOdW1iZXIobGVuZ3RoKVxuICAgIGlmIChsZW5ndGggPiByZW1haW5pbmcpIHtcbiAgICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICAgIH1cbiAgfVxuXG4gIC8vIG11c3QgYmUgYW4gZXZlbiBudW1iZXIgb2YgZGlnaXRzXG4gIHZhciBzdHJMZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChzdHJMZW4gJSAyICE9PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBoZXggc3RyaW5nJylcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWRcbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiB1dGY4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBhc2NpaVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIoYXNjaWlUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGJpbmFyeVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBiYXNlNjRXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGJhc2U2NFRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gdWNzMldyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmMTZsZVRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykge1xuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKVxuICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICBlbmNvZGluZyA9ICd1dGY4J1xuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZylcbiAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgIGVuY29kaW5nID0gb2Zmc2V0XG4gICAgbGVuZ3RoID0gdGhpcy5sZW5ndGhcbiAgICBvZmZzZXQgPSAwXG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pXG4gIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkge1xuICAgIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgICBpZiAoaXNGaW5pdGUobGVuZ3RoKSkge1xuICAgICAgbGVuZ3RoID0gbGVuZ3RoIHwgMFxuICAgICAgaWYgKGVuY29kaW5nID09PSB1bmRlZmluZWQpIGVuY29kaW5nID0gJ3V0ZjgnXG4gICAgfSBlbHNlIHtcbiAgICAgIGVuY29kaW5nID0gbGVuZ3RoXG4gICAgICBsZW5ndGggPSB1bmRlZmluZWRcbiAgICB9XG4gIC8vIGxlZ2FjeSB3cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXQsIGxlbmd0aCkgLSByZW1vdmUgaW4gdjAuMTNcbiAgfSBlbHNlIHtcbiAgICB2YXIgc3dhcCA9IGVuY29kaW5nXG4gICAgZW5jb2RpbmcgPSBvZmZzZXRcbiAgICBvZmZzZXQgPSBsZW5ndGggfCAwXG4gICAgbGVuZ3RoID0gc3dhcFxuICB9XG5cbiAgdmFyIHJlbWFpbmluZyA9IHRoaXMubGVuZ3RoIC0gb2Zmc2V0XG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCB8fCBsZW5ndGggPiByZW1haW5pbmcpIGxlbmd0aCA9IHJlbWFpbmluZ1xuXG4gIGlmICgoc3RyaW5nLmxlbmd0aCA+IDAgJiYgKGxlbmd0aCA8IDAgfHwgb2Zmc2V0IDwgMCkpIHx8IG9mZnNldCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ2F0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzJylcbiAgfVxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBiaW5hcnlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICAvLyBXYXJuaW5nOiBtYXhMZW5ndGggbm90IHRha2VuIGludG8gYWNjb3VudCBpbiBiYXNlNjRXcml0ZVxuICAgICAgICByZXR1cm4gYmFzZTY0V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIHVjczJXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICAgICAgZW5jb2RpbmcgPSAoJycgKyBlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04gKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdCdWZmZXInLFxuICAgIGRhdGE6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuX2FyciB8fCB0aGlzLCAwKVxuICB9XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKHN0YXJ0ID09PSAwICYmIGVuZCA9PT0gYnVmLmxlbmd0aCkge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1Zi5zbGljZShzdGFydCwgZW5kKSlcbiAgfVxufVxuXG5mdW5jdGlvbiB1dGY4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG4gIHZhciByZXMgPSBbXVxuXG4gIHZhciBpID0gc3RhcnRcbiAgd2hpbGUgKGkgPCBlbmQpIHtcbiAgICB2YXIgZmlyc3RCeXRlID0gYnVmW2ldXG4gICAgdmFyIGNvZGVQb2ludCA9IG51bGxcbiAgICB2YXIgYnl0ZXNQZXJTZXF1ZW5jZSA9IChmaXJzdEJ5dGUgPiAweEVGKSA/IDRcbiAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4REYpID8gM1xuICAgICAgOiAoZmlyc3RCeXRlID4gMHhCRikgPyAyXG4gICAgICA6IDFcblxuICAgIGlmIChpICsgYnl0ZXNQZXJTZXF1ZW5jZSA8PSBlbmQpIHtcbiAgICAgIHZhciBzZWNvbmRCeXRlLCB0aGlyZEJ5dGUsIGZvdXJ0aEJ5dGUsIHRlbXBDb2RlUG9pbnRcblxuICAgICAgc3dpdGNoIChieXRlc1BlclNlcXVlbmNlKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBpZiAoZmlyc3RCeXRlIDwgMHg4MCkge1xuICAgICAgICAgICAgY29kZVBvaW50ID0gZmlyc3RCeXRlXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4MUYpIDw8IDB4NiB8IChzZWNvbmRCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3Rikge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweEMgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4NiB8ICh0aGlyZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGRiAmJiAodGVtcENvZGVQb2ludCA8IDB4RDgwMCB8fCB0ZW1wQ29kZVBvaW50ID4gMHhERkZGKSkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBzZWNvbmRCeXRlID0gYnVmW2kgKyAxXVxuICAgICAgICAgIHRoaXJkQnl0ZSA9IGJ1ZltpICsgMl1cbiAgICAgICAgICBmb3VydGhCeXRlID0gYnVmW2kgKyAzXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAoZm91cnRoQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHgxMiB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHhDIHwgKHRoaXJkQnl0ZSAmIDB4M0YpIDw8IDB4NiB8IChmb3VydGhCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHhGRkZGICYmIHRlbXBDb2RlUG9pbnQgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICBjb2RlUG9pbnQgPSB0ZW1wQ29kZVBvaW50XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb2RlUG9pbnQgPT09IG51bGwpIHtcbiAgICAgIC8vIHdlIGRpZCBub3QgZ2VuZXJhdGUgYSB2YWxpZCBjb2RlUG9pbnQgc28gaW5zZXJ0IGFcbiAgICAgIC8vIHJlcGxhY2VtZW50IGNoYXIgKFUrRkZGRCkgYW5kIGFkdmFuY2Ugb25seSAxIGJ5dGVcbiAgICAgIGNvZGVQb2ludCA9IDB4RkZGRFxuICAgICAgYnl0ZXNQZXJTZXF1ZW5jZSA9IDFcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA+IDB4RkZGRikge1xuICAgICAgLy8gZW5jb2RlIHRvIHV0ZjE2IChzdXJyb2dhdGUgcGFpciBkYW5jZSlcbiAgICAgIGNvZGVQb2ludCAtPSAweDEwMDAwXG4gICAgICByZXMucHVzaChjb2RlUG9pbnQgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApXG4gICAgICBjb2RlUG9pbnQgPSAweERDMDAgfCBjb2RlUG9pbnQgJiAweDNGRlxuICAgIH1cblxuICAgIHJlcy5wdXNoKGNvZGVQb2ludClcbiAgICBpICs9IGJ5dGVzUGVyU2VxdWVuY2VcbiAgfVxuXG4gIHJldHVybiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkocmVzKVxufVxuXG4vLyBCYXNlZCBvbiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMjc0NzI3Mi82ODA3NDIsIHRoZSBicm93c2VyIHdpdGhcbi8vIHRoZSBsb3dlc3QgbGltaXQgaXMgQ2hyb21lLCB3aXRoIDB4MTAwMDAgYXJncy5cbi8vIFdlIGdvIDEgbWFnbml0dWRlIGxlc3MsIGZvciBzYWZldHlcbnZhciBNQVhfQVJHVU1FTlRTX0xFTkdUSCA9IDB4MTAwMFxuXG5mdW5jdGlvbiBkZWNvZGVDb2RlUG9pbnRzQXJyYXkgKGNvZGVQb2ludHMpIHtcbiAgdmFyIGxlbiA9IGNvZGVQb2ludHMubGVuZ3RoXG4gIGlmIChsZW4gPD0gTUFYX0FSR1VNRU5UU19MRU5HVEgpIHtcbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShTdHJpbmcsIGNvZGVQb2ludHMpIC8vIGF2b2lkIGV4dHJhIHNsaWNlKClcbiAgfVxuXG4gIC8vIERlY29kZSBpbiBjaHVua3MgdG8gYXZvaWQgXCJjYWxsIHN0YWNrIHNpemUgZXhjZWVkZWRcIi5cbiAgdmFyIHJlcyA9ICcnXG4gIHZhciBpID0gMFxuICB3aGlsZSAoaSA8IGxlbikge1xuICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFxuICAgICAgU3RyaW5nLFxuICAgICAgY29kZVBvaW50cy5zbGljZShpLCBpICs9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKVxuICAgIClcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbmZ1bmN0aW9uIGFzY2lpU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldICYgMHg3RilcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGJpbmFyeVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHJldCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSlcbiAgfVxuICByZXR1cm4gcmV0XG59XG5cbmZ1bmN0aW9uIGhleFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IGJ1Zi5sZW5ndGhcblxuICBpZiAoIXN0YXJ0IHx8IHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIGlmICghZW5kIHx8IGVuZCA8IDAgfHwgZW5kID4gbGVuKSBlbmQgPSBsZW5cblxuICB2YXIgb3V0ID0gJydcbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICBvdXQgKz0gdG9IZXgoYnVmW2ldKVxuICB9XG4gIHJldHVybiBvdXRcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGJ5dGVzID0gYnVmLnNsaWNlKHN0YXJ0LCBlbmQpXG4gIHZhciByZXMgPSAnJ1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGJ5dGVzLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0gKyBieXRlc1tpICsgMV0gKiAyNTYpXG4gIH1cbiAgcmV0dXJuIHJlc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gc2xpY2UgKHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIHN0YXJ0ID0gfn5zdGFydFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IH5+ZW5kXG5cbiAgaWYgKHN0YXJ0IDwgMCkge1xuICAgIHN0YXJ0ICs9IGxlblxuICAgIGlmIChzdGFydCA8IDApIHN0YXJ0ID0gMFxuICB9IGVsc2UgaWYgKHN0YXJ0ID4gbGVuKSB7XG4gICAgc3RhcnQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCAwKSB7XG4gICAgZW5kICs9IGxlblxuICAgIGlmIChlbmQgPCAwKSBlbmQgPSAwXG4gIH0gZWxzZSBpZiAoZW5kID4gbGVuKSB7XG4gICAgZW5kID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgdmFyIG5ld0J1ZlxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICBuZXdCdWYgPSBCdWZmZXIuX2F1Z21lbnQodGhpcy5zdWJhcnJheShzdGFydCwgZW5kKSlcbiAgfSBlbHNlIHtcbiAgICB2YXIgc2xpY2VMZW4gPSBlbmQgLSBzdGFydFxuICAgIG5ld0J1ZiA9IG5ldyBCdWZmZXIoc2xpY2VMZW4sIHVuZGVmaW5lZClcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWNlTGVuOyBpKyspIHtcbiAgICAgIG5ld0J1ZltpXSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfVxuXG4gIGlmIChuZXdCdWYubGVuZ3RoKSBuZXdCdWYucGFyZW50ID0gdGhpcy5wYXJlbnQgfHwgdGhpc1xuXG4gIHJldHVybiBuZXdCdWZcbn1cblxuLypcbiAqIE5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYnVmZmVyIGlzbid0IHRyeWluZyB0byB3cml0ZSBvdXQgb2YgYm91bmRzLlxuICovXG5mdW5jdGlvbiBjaGVja09mZnNldCAob2Zmc2V0LCBleHQsIGxlbmd0aCkge1xuICBpZiAoKG9mZnNldCAlIDEpICE9PSAwIHx8IG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdvZmZzZXQgaXMgbm90IHVpbnQnKVxuICBpZiAob2Zmc2V0ICsgZXh0ID4gbGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignVHJ5aW5nIHRvIGFjY2VzcyBiZXlvbmQgYnVmZmVyIGxlbmd0aCcpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRMRSA9IGZ1bmN0aW9uIHJlYWRVSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnRCRSA9IGZ1bmN0aW9uIHJlYWRVSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG4gIH1cblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdXG4gIHZhciBtdWwgPSAxXG4gIHdoaWxlIChieXRlTGVuZ3RoID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbiByZWFkVUludDggKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIHRoaXNbb2Zmc2V0XVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2QkUgPSBmdW5jdGlvbiByZWFkVUludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgOCkgfCB0aGlzW29mZnNldCArIDFdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkxFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICgodGhpc1tvZmZzZXRdKSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikpICtcbiAgICAgICh0aGlzW29mZnNldCArIDNdICogMHgxMDAwMDAwKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdICogMHgxMDAwMDAwKSArXG4gICAgKCh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgIHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludExFID0gZnVuY3Rpb24gcmVhZEludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XVxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludEJFID0gZnVuY3Rpb24gcmVhZEludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoXG4gIHZhciBtdWwgPSAxXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0taV1cbiAgd2hpbGUgKGkgPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1pXSAqIG11bFxuICB9XG4gIG11bCAqPSAweDgwXG5cbiAgaWYgKHZhbCA+PSBtdWwpIHZhbCAtPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aClcblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDggPSBmdW5jdGlvbiByZWFkSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICBpZiAoISh0aGlzW29mZnNldF0gJiAweDgwKSkgcmV0dXJuICh0aGlzW29mZnNldF0pXG4gIHJldHVybiAoKDB4ZmYgLSB0aGlzW29mZnNldF0gKyAxKSAqIC0xKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkxFID0gZnVuY3Rpb24gcmVhZEludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIDFdIHwgKHRoaXNbb2Zmc2V0XSA8PCA4KVxuICByZXR1cm4gKHZhbCAmIDB4ODAwMCkgPyB2YWwgfCAweEZGRkYwMDAwIDogdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyTEUgPSBmdW5jdGlvbiByZWFkSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdKSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10gPDwgMjQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDMyQkUgPSBmdW5jdGlvbiByZWFkSW50MzJCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDI0KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgM10pXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0TEUgPSBmdW5jdGlvbiByZWFkRmxvYXRMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEZsb2F0QkUgPSBmdW5jdGlvbiByZWFkRmxvYXRCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVMRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgdHJ1ZSwgNTIsIDgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUJFID0gZnVuY3Rpb24gcmVhZERvdWJsZUJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgNTIsIDgpXG59XG5cbmZ1bmN0aW9uIGNoZWNrSW50IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignYnVmZmVyIG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCd2YWx1ZSBpcyBvdXQgb2YgYm91bmRzJylcbiAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdpbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludExFID0gZnVuY3Rpb24gd3JpdGVVSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSwgMClcblxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludEJFID0gZnVuY3Rpb24gd3JpdGVVSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKSwgMClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxXG4gIHZhciBtdWwgPSAxXG4gIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDggPSBmdW5jdGlvbiB3cml0ZVVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4ZmYsIDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSlcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MTYgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmICsgdmFsdWUgKyAxXG4gIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgMik7IGkgPCBqOyBpKyspIHtcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgJiAoMHhmZiA8PCAoOCAqIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpKSkpID4+PlxuICAgICAgKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkgKiA4XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MzIgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDQpOyBpIDwgajsgaSsrKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlID4+PiAobGl0dGxlRW5kaWFuID8gaSA6IDMgLSBpKSAqIDgpICYgMHhmZlxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gd3JpdGVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKVxuXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpXG4gIH1cblxuICB2YXIgaSA9IDBcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHN1YiA9IHZhbHVlIDwgMCA/IDEgOiAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gdmFsdWUgPCAwID8gMSA6IDBcbiAgdGhpc1tvZmZzZXQgKyBpXSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoLS1pID49IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB0aGlzW29mZnNldCArIGldID0gKCh2YWx1ZSAvIG11bCkgPj4gMCkgLSBzdWIgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50OCA9IGZ1bmN0aW9uIHdyaXRlSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweDdmLCAtMHg4MClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKVxuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmYgKyB2YWx1ZSArIDFcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2TEUgPSBmdW5jdGlvbiB3cml0ZUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyQkUgPSBmdW5jdGlvbiB3cml0ZUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHg3ZmZmZmZmZiwgLTB4ODAwMDAwMDApXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuZnVuY3Rpb24gY2hlY2tJRUVFNzU0IChidWYsIHZhbHVlLCBvZmZzZXQsIGV4dCwgbWF4LCBtaW4pIHtcbiAgaWYgKHZhbHVlID4gbWF4IHx8IHZhbHVlIDwgbWluKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndmFsdWUgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignaW5kZXggb3V0IG9mIHJhbmdlJylcbiAgaWYgKG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdpbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5mdW5jdGlvbiB3cml0ZUZsb2F0IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDQsIDMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgsIC0zLjQwMjgyMzQ2NjM4NTI4ODZlKzM4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDIzLCA0KVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdEJFID0gZnVuY3Rpb24gd3JpdGVGbG9hdEJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbmZ1bmN0aW9uIHdyaXRlRG91YmxlIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDgsIDEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4LCAtMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgpXG4gIH1cbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgNTIsIDgpXG4gIHJldHVybiBvZmZzZXQgKyA4XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVMRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydClcbn1cblxuLy8gY29weSh0YXJnZXRCdWZmZXIsIHRhcmdldFN0YXJ0PTAsIHNvdXJjZVN0YXJ0PTAsIHNvdXJjZUVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gY29weSAodGFyZ2V0LCB0YXJnZXRTdGFydCwgc3RhcnQsIGVuZCkge1xuICBpZiAoIXN0YXJ0KSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgJiYgZW5kICE9PSAwKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAodGFyZ2V0U3RhcnQgPj0gdGFyZ2V0Lmxlbmd0aCkgdGFyZ2V0U3RhcnQgPSB0YXJnZXQubGVuZ3RoXG4gIGlmICghdGFyZ2V0U3RhcnQpIHRhcmdldFN0YXJ0ID0gMFxuICBpZiAoZW5kID4gMCAmJiBlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICAvLyBDb3B5IDAgYnl0ZXM7IHdlJ3JlIGRvbmVcbiAgaWYgKGVuZCA9PT0gc3RhcnQpIHJldHVybiAwXG4gIGlmICh0YXJnZXQubGVuZ3RoID09PSAwIHx8IHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnNcbiAgaWYgKHRhcmdldFN0YXJ0IDwgMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJylcbiAgfVxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKVxuXG4gIC8vIEFyZSB3ZSBvb2I/XG4gIGlmIChlbmQgPiB0aGlzLmxlbmd0aCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCA8IGVuZCAtIHN0YXJ0KSB7XG4gICAgZW5kID0gdGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0ICsgc3RhcnRcbiAgfVxuXG4gIHZhciBsZW4gPSBlbmQgLSBzdGFydFxuICB2YXIgaVxuXG4gIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkge1xuICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZFxuICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIGlmIChsZW4gPCAxMDAwIHx8ICFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIGFzY2VuZGluZyBjb3B5IGZyb20gc3RhcnRcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRhcmdldC5fc2V0KHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSwgdGFyZ2V0U3RhcnQpXG4gIH1cblxuICByZXR1cm4gbGVuXG59XG5cbi8vIGZpbGwodmFsdWUsIHN0YXJ0PTAsIGVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsdWUsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCF2YWx1ZSkgdmFsdWUgPSAwXG4gIGlmICghc3RhcnQpIHN0YXJ0ID0gMFxuICBpZiAoIWVuZCkgZW5kID0gdGhpcy5sZW5ndGhcblxuICBpZiAoZW5kIDwgc3RhcnQpIHRocm93IG5ldyBSYW5nZUVycm9yKCdlbmQgPCBzdGFydCcpXG5cbiAgLy8gRmlsbCAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm5cbiAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm5cblxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChlbmQgPCAwIHx8IGVuZCA+IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignZW5kIG91dCBvZiBib3VuZHMnKVxuXG4gIHZhciBpXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgZm9yIChpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgdGhpc1tpXSA9IHZhbHVlXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IHV0ZjhUb0J5dGVzKHZhbHVlLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgIHRoaXNbaV0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBgQXJyYXlCdWZmZXJgIHdpdGggdGhlICpjb3BpZWQqIG1lbW9yeSBvZiB0aGUgYnVmZmVyIGluc3RhbmNlLlxuICogQWRkZWQgaW4gTm9kZSAwLjEyLiBPbmx5IGF2YWlsYWJsZSBpbiBicm93c2VycyB0aGF0IHN1cHBvcnQgQXJyYXlCdWZmZXIuXG4gKi9cbkJ1ZmZlci5wcm90b3R5cGUudG9BcnJheUJ1ZmZlciA9IGZ1bmN0aW9uIHRvQXJyYXlCdWZmZXIgKCkge1xuICBpZiAodHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgICByZXR1cm4gKG5ldyBCdWZmZXIodGhpcykpLmJ1ZmZlclxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgYnVmID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5sZW5ndGgpXG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYnVmLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIGJ1ZltpXSA9IHRoaXNbaV1cbiAgICAgIH1cbiAgICAgIHJldHVybiBidWYuYnVmZmVyXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0J1ZmZlci50b0FycmF5QnVmZmVyIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyJylcbiAgfVxufVxuXG4vLyBIRUxQRVIgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09XG5cbnZhciBCUCA9IEJ1ZmZlci5wcm90b3R5cGVcblxuLyoqXG4gKiBBdWdtZW50IGEgVWludDhBcnJheSAqaW5zdGFuY2UqIChub3QgdGhlIFVpbnQ4QXJyYXkgY2xhc3MhKSB3aXRoIEJ1ZmZlciBtZXRob2RzXG4gKi9cbkJ1ZmZlci5fYXVnbWVudCA9IGZ1bmN0aW9uIF9hdWdtZW50IChhcnIpIHtcbiAgYXJyLmNvbnN0cnVjdG9yID0gQnVmZmVyXG4gIGFyci5faXNCdWZmZXIgPSB0cnVlXG5cbiAgLy8gc2F2ZSByZWZlcmVuY2UgdG8gb3JpZ2luYWwgVWludDhBcnJheSBzZXQgbWV0aG9kIGJlZm9yZSBvdmVyd3JpdGluZ1xuICBhcnIuX3NldCA9IGFyci5zZXRcblxuICAvLyBkZXByZWNhdGVkXG4gIGFyci5nZXQgPSBCUC5nZXRcbiAgYXJyLnNldCA9IEJQLnNldFxuXG4gIGFyci53cml0ZSA9IEJQLndyaXRlXG4gIGFyci50b1N0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0xvY2FsZVN0cmluZyA9IEJQLnRvU3RyaW5nXG4gIGFyci50b0pTT04gPSBCUC50b0pTT05cbiAgYXJyLmVxdWFscyA9IEJQLmVxdWFsc1xuICBhcnIuY29tcGFyZSA9IEJQLmNvbXBhcmVcbiAgYXJyLmluZGV4T2YgPSBCUC5pbmRleE9mXG4gIGFyci5jb3B5ID0gQlAuY29weVxuICBhcnIuc2xpY2UgPSBCUC5zbGljZVxuICBhcnIucmVhZFVJbnRMRSA9IEJQLnJlYWRVSW50TEVcbiAgYXJyLnJlYWRVSW50QkUgPSBCUC5yZWFkVUludEJFXG4gIGFyci5yZWFkVUludDggPSBCUC5yZWFkVUludDhcbiAgYXJyLnJlYWRVSW50MTZMRSA9IEJQLnJlYWRVSW50MTZMRVxuICBhcnIucmVhZFVJbnQxNkJFID0gQlAucmVhZFVJbnQxNkJFXG4gIGFyci5yZWFkVUludDMyTEUgPSBCUC5yZWFkVUludDMyTEVcbiAgYXJyLnJlYWRVSW50MzJCRSA9IEJQLnJlYWRVSW50MzJCRVxuICBhcnIucmVhZEludExFID0gQlAucmVhZEludExFXG4gIGFyci5yZWFkSW50QkUgPSBCUC5yZWFkSW50QkVcbiAgYXJyLnJlYWRJbnQ4ID0gQlAucmVhZEludDhcbiAgYXJyLnJlYWRJbnQxNkxFID0gQlAucmVhZEludDE2TEVcbiAgYXJyLnJlYWRJbnQxNkJFID0gQlAucmVhZEludDE2QkVcbiAgYXJyLnJlYWRJbnQzMkxFID0gQlAucmVhZEludDMyTEVcbiAgYXJyLnJlYWRJbnQzMkJFID0gQlAucmVhZEludDMyQkVcbiAgYXJyLnJlYWRGbG9hdExFID0gQlAucmVhZEZsb2F0TEVcbiAgYXJyLnJlYWRGbG9hdEJFID0gQlAucmVhZEZsb2F0QkVcbiAgYXJyLnJlYWREb3VibGVMRSA9IEJQLnJlYWREb3VibGVMRVxuICBhcnIucmVhZERvdWJsZUJFID0gQlAucmVhZERvdWJsZUJFXG4gIGFyci53cml0ZVVJbnQ4ID0gQlAud3JpdGVVSW50OFxuICBhcnIud3JpdGVVSW50TEUgPSBCUC53cml0ZVVJbnRMRVxuICBhcnIud3JpdGVVSW50QkUgPSBCUC53cml0ZVVJbnRCRVxuICBhcnIud3JpdGVVSW50MTZMRSA9IEJQLndyaXRlVUludDE2TEVcbiAgYXJyLndyaXRlVUludDE2QkUgPSBCUC53cml0ZVVJbnQxNkJFXG4gIGFyci53cml0ZVVJbnQzMkxFID0gQlAud3JpdGVVSW50MzJMRVxuICBhcnIud3JpdGVVSW50MzJCRSA9IEJQLndyaXRlVUludDMyQkVcbiAgYXJyLndyaXRlSW50TEUgPSBCUC53cml0ZUludExFXG4gIGFyci53cml0ZUludEJFID0gQlAud3JpdGVJbnRCRVxuICBhcnIud3JpdGVJbnQ4ID0gQlAud3JpdGVJbnQ4XG4gIGFyci53cml0ZUludDE2TEUgPSBCUC53cml0ZUludDE2TEVcbiAgYXJyLndyaXRlSW50MTZCRSA9IEJQLndyaXRlSW50MTZCRVxuICBhcnIud3JpdGVJbnQzMkxFID0gQlAud3JpdGVJbnQzMkxFXG4gIGFyci53cml0ZUludDMyQkUgPSBCUC53cml0ZUludDMyQkVcbiAgYXJyLndyaXRlRmxvYXRMRSA9IEJQLndyaXRlRmxvYXRMRVxuICBhcnIud3JpdGVGbG9hdEJFID0gQlAud3JpdGVGbG9hdEJFXG4gIGFyci53cml0ZURvdWJsZUxFID0gQlAud3JpdGVEb3VibGVMRVxuICBhcnIud3JpdGVEb3VibGVCRSA9IEJQLndyaXRlRG91YmxlQkVcbiAgYXJyLmZpbGwgPSBCUC5maWxsXG4gIGFyci5pbnNwZWN0ID0gQlAuaW5zcGVjdFxuICBhcnIudG9BcnJheUJ1ZmZlciA9IEJQLnRvQXJyYXlCdWZmZXJcblxuICByZXR1cm4gYXJyXG59XG5cbnZhciBJTlZBTElEX0JBU0U2NF9SRSA9IC9bXitcXC8wLTlBLVphLXotX10vZ1xuXG5mdW5jdGlvbiBiYXNlNjRjbGVhbiAoc3RyKSB7XG4gIC8vIE5vZGUgc3RyaXBzIG91dCBpbnZhbGlkIGNoYXJhY3RlcnMgbGlrZSBcXG4gYW5kIFxcdCBmcm9tIHRoZSBzdHJpbmcsIGJhc2U2NC1qcyBkb2VzIG5vdFxuICBzdHIgPSBzdHJpbmd0cmltKHN0cikucmVwbGFjZShJTlZBTElEX0JBU0U2NF9SRSwgJycpXG4gIC8vIE5vZGUgY29udmVydHMgc3RyaW5ncyB3aXRoIGxlbmd0aCA8IDIgdG8gJydcbiAgaWYgKHN0ci5sZW5ndGggPCAyKSByZXR1cm4gJydcbiAgLy8gTm9kZSBhbGxvd3MgZm9yIG5vbi1wYWRkZWQgYmFzZTY0IHN0cmluZ3MgKG1pc3NpbmcgdHJhaWxpbmcgPT09KSwgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHdoaWxlIChzdHIubGVuZ3RoICUgNCAhPT0gMCkge1xuICAgIHN0ciA9IHN0ciArICc9J1xuICB9XG4gIHJldHVybiBzdHJcbn1cblxuZnVuY3Rpb24gc3RyaW5ndHJpbSAoc3RyKSB7XG4gIGlmIChzdHIudHJpbSkgcmV0dXJuIHN0ci50cmltKClcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJylcbn1cblxuZnVuY3Rpb24gdG9IZXggKG4pIHtcbiAgaWYgKG4gPCAxNikgcmV0dXJuICcwJyArIG4udG9TdHJpbmcoMTYpXG4gIHJldHVybiBuLnRvU3RyaW5nKDE2KVxufVxuXG5mdW5jdGlvbiB1dGY4VG9CeXRlcyAoc3RyaW5nLCB1bml0cykge1xuICB1bml0cyA9IHVuaXRzIHx8IEluZmluaXR5XG4gIHZhciBjb2RlUG9pbnRcbiAgdmFyIGxlbmd0aCA9IHN0cmluZy5sZW5ndGhcbiAgdmFyIGxlYWRTdXJyb2dhdGUgPSBudWxsXG4gIHZhciBieXRlcyA9IFtdXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGNvZGVQb2ludCA9IHN0cmluZy5jaGFyQ29kZUF0KGkpXG5cbiAgICAvLyBpcyBzdXJyb2dhdGUgY29tcG9uZW50XG4gICAgaWYgKGNvZGVQb2ludCA+IDB4RDdGRiAmJiBjb2RlUG9pbnQgPCAweEUwMDApIHtcbiAgICAgIC8vIGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoIWxlYWRTdXJyb2dhdGUpIHtcbiAgICAgICAgLy8gbm8gbGVhZCB5ZXRcbiAgICAgICAgaWYgKGNvZGVQb2ludCA+IDB4REJGRikge1xuICAgICAgICAgIC8vIHVuZXhwZWN0ZWQgdHJhaWxcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2UgaWYgKGkgKyAxID09PSBsZW5ndGgpIHtcbiAgICAgICAgICAvLyB1bnBhaXJlZCBsZWFkXG4gICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHZhbGlkIGxlYWRcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIDIgbGVhZHMgaW4gYSByb3dcbiAgICAgIGlmIChjb2RlUG9pbnQgPCAweERDMDApIHtcbiAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnRcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gdmFsaWQgc3Vycm9nYXRlIHBhaXJcbiAgICAgIGNvZGVQb2ludCA9IGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDAgfCAweDEwMDAwXG4gICAgfSBlbHNlIGlmIChsZWFkU3Vycm9nYXRlKSB7XG4gICAgICAvLyB2YWxpZCBibXAgY2hhciwgYnV0IGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICB9XG5cbiAgICBsZWFkU3Vycm9nYXRlID0gbnVsbFxuXG4gICAgLy8gZW5jb2RlIHV0ZjhcbiAgICBpZiAoY29kZVBvaW50IDwgMHg4MCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAxKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKGNvZGVQb2ludClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4ODAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgfCAweEMwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMDAwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAzKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHhDIHwgMHhFMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gNCkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4MTIgfCAweEYwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHhDICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvZGUgcG9pbnQnKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBieXRlc1xufVxuXG5mdW5jdGlvbiBhc2NpaVRvQnl0ZXMgKHN0cikge1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi5cbiAgICBieXRlQXJyYXkucHVzaChzdHIuY2hhckNvZGVBdChpKSAmIDB4RkYpXG4gIH1cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiB1dGYxNmxlVG9CeXRlcyAoc3RyLCB1bml0cykge1xuICB2YXIgYywgaGksIGxvXG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVha1xuXG4gICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkpXG4gICAgaGkgPSBjID4+IDhcbiAgICBsbyA9IGMgJSAyNTZcbiAgICBieXRlQXJyYXkucHVzaChsbylcbiAgICBieXRlQXJyYXkucHVzaChoaSlcbiAgfVxuXG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyAoc3RyKSB7XG4gIHJldHVybiBiYXNlNjQudG9CeXRlQXJyYXkoYmFzZTY0Y2xlYW4oc3RyKSlcbn1cblxuZnVuY3Rpb24gYmxpdEJ1ZmZlciAoc3JjLCBkc3QsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoKGkgKyBvZmZzZXQgPj0gZHN0Lmxlbmd0aCkgfHwgKGkgPj0gc3JjLmxlbmd0aCkpIGJyZWFrXG4gICAgZHN0W2kgKyBvZmZzZXRdID0gc3JjW2ldXG4gIH1cbiAgcmV0dXJuIGlcbn1cbiIsInZhciBsb29rdXAgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7XG5cbjsoZnVuY3Rpb24gKGV4cG9ydHMpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG4gIHZhciBBcnIgPSAodHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnKVxuICAgID8gVWludDhBcnJheVxuICAgIDogQXJyYXlcblxuXHR2YXIgUExVUyAgID0gJysnLmNoYXJDb2RlQXQoMClcblx0dmFyIFNMQVNIICA9ICcvJy5jaGFyQ29kZUF0KDApXG5cdHZhciBOVU1CRVIgPSAnMCcuY2hhckNvZGVBdCgwKVxuXHR2YXIgTE9XRVIgID0gJ2EnLmNoYXJDb2RlQXQoMClcblx0dmFyIFVQUEVSICA9ICdBJy5jaGFyQ29kZUF0KDApXG5cdHZhciBQTFVTX1VSTF9TQUZFID0gJy0nLmNoYXJDb2RlQXQoMClcblx0dmFyIFNMQVNIX1VSTF9TQUZFID0gJ18nLmNoYXJDb2RlQXQoMClcblxuXHRmdW5jdGlvbiBkZWNvZGUgKGVsdCkge1xuXHRcdHZhciBjb2RlID0gZWx0LmNoYXJDb2RlQXQoMClcblx0XHRpZiAoY29kZSA9PT0gUExVUyB8fFxuXHRcdCAgICBjb2RlID09PSBQTFVTX1VSTF9TQUZFKVxuXHRcdFx0cmV0dXJuIDYyIC8vICcrJ1xuXHRcdGlmIChjb2RlID09PSBTTEFTSCB8fFxuXHRcdCAgICBjb2RlID09PSBTTEFTSF9VUkxfU0FGRSlcblx0XHRcdHJldHVybiA2MyAvLyAnLydcblx0XHRpZiAoY29kZSA8IE5VTUJFUilcblx0XHRcdHJldHVybiAtMSAvL25vIG1hdGNoXG5cdFx0aWYgKGNvZGUgPCBOVU1CRVIgKyAxMClcblx0XHRcdHJldHVybiBjb2RlIC0gTlVNQkVSICsgMjYgKyAyNlxuXHRcdGlmIChjb2RlIDwgVVBQRVIgKyAyNilcblx0XHRcdHJldHVybiBjb2RlIC0gVVBQRVJcblx0XHRpZiAoY29kZSA8IExPV0VSICsgMjYpXG5cdFx0XHRyZXR1cm4gY29kZSAtIExPV0VSICsgMjZcblx0fVxuXG5cdGZ1bmN0aW9uIGI2NFRvQnl0ZUFycmF5IChiNjQpIHtcblx0XHR2YXIgaSwgaiwgbCwgdG1wLCBwbGFjZUhvbGRlcnMsIGFyclxuXG5cdFx0aWYgKGI2NC5sZW5ndGggJSA0ID4gMCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0Jylcblx0XHR9XG5cblx0XHQvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKVxuXHRcdC8vIGlmIHRoZXJlIGFyZSB0d28gcGxhY2Vob2xkZXJzLCB0aGFuIHRoZSB0d28gY2hhcmFjdGVycyBiZWZvcmUgaXRcblx0XHQvLyByZXByZXNlbnQgb25lIGJ5dGVcblx0XHQvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXNcblx0XHQvLyB0aGlzIGlzIGp1c3QgYSBjaGVhcCBoYWNrIHRvIG5vdCBkbyBpbmRleE9mIHR3aWNlXG5cdFx0dmFyIGxlbiA9IGI2NC5sZW5ndGhcblx0XHRwbGFjZUhvbGRlcnMgPSAnPScgPT09IGI2NC5jaGFyQXQobGVuIC0gMikgPyAyIDogJz0nID09PSBiNjQuY2hhckF0KGxlbiAtIDEpID8gMSA6IDBcblxuXHRcdC8vIGJhc2U2NCBpcyA0LzMgKyB1cCB0byB0d28gY2hhcmFjdGVycyBvZiB0aGUgb3JpZ2luYWwgZGF0YVxuXHRcdGFyciA9IG5ldyBBcnIoYjY0Lmxlbmd0aCAqIDMgLyA0IC0gcGxhY2VIb2xkZXJzKVxuXG5cdFx0Ly8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuXHRcdGwgPSBwbGFjZUhvbGRlcnMgPiAwID8gYjY0Lmxlbmd0aCAtIDQgOiBiNjQubGVuZ3RoXG5cblx0XHR2YXIgTCA9IDBcblxuXHRcdGZ1bmN0aW9uIHB1c2ggKHYpIHtcblx0XHRcdGFycltMKytdID0gdlxuXHRcdH1cblxuXHRcdGZvciAoaSA9IDAsIGogPSAwOyBpIDwgbDsgaSArPSA0LCBqICs9IDMpIHtcblx0XHRcdHRtcCA9IChkZWNvZGUoYjY0LmNoYXJBdChpKSkgPDwgMTgpIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAxKSkgPDwgMTIpIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAyKSkgPDwgNikgfCBkZWNvZGUoYjY0LmNoYXJBdChpICsgMykpXG5cdFx0XHRwdXNoKCh0bXAgJiAweEZGMDAwMCkgPj4gMTYpXG5cdFx0XHRwdXNoKCh0bXAgJiAweEZGMDApID4+IDgpXG5cdFx0XHRwdXNoKHRtcCAmIDB4RkYpXG5cdFx0fVxuXG5cdFx0aWYgKHBsYWNlSG9sZGVycyA9PT0gMikge1xuXHRcdFx0dG1wID0gKGRlY29kZShiNjQuY2hhckF0KGkpKSA8PCAyKSB8IChkZWNvZGUoYjY0LmNoYXJBdChpICsgMSkpID4+IDQpXG5cdFx0XHRwdXNoKHRtcCAmIDB4RkYpXG5cdFx0fSBlbHNlIGlmIChwbGFjZUhvbGRlcnMgPT09IDEpIHtcblx0XHRcdHRtcCA9IChkZWNvZGUoYjY0LmNoYXJBdChpKSkgPDwgMTApIHwgKGRlY29kZShiNjQuY2hhckF0KGkgKyAxKSkgPDwgNCkgfCAoZGVjb2RlKGI2NC5jaGFyQXQoaSArIDIpKSA+PiAyKVxuXHRcdFx0cHVzaCgodG1wID4+IDgpICYgMHhGRilcblx0XHRcdHB1c2godG1wICYgMHhGRilcblx0XHR9XG5cblx0XHRyZXR1cm4gYXJyXG5cdH1cblxuXHRmdW5jdGlvbiB1aW50OFRvQmFzZTY0ICh1aW50OCkge1xuXHRcdHZhciBpLFxuXHRcdFx0ZXh0cmFCeXRlcyA9IHVpbnQ4Lmxlbmd0aCAlIDMsIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzXG5cdFx0XHRvdXRwdXQgPSBcIlwiLFxuXHRcdFx0dGVtcCwgbGVuZ3RoXG5cblx0XHRmdW5jdGlvbiBlbmNvZGUgKG51bSkge1xuXHRcdFx0cmV0dXJuIGxvb2t1cC5jaGFyQXQobnVtKVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7XG5cdFx0XHRyZXR1cm4gZW5jb2RlKG51bSA+PiAxOCAmIDB4M0YpICsgZW5jb2RlKG51bSA+PiAxMiAmIDB4M0YpICsgZW5jb2RlKG51bSA+PiA2ICYgMHgzRikgKyBlbmNvZGUobnVtICYgMHgzRilcblx0XHR9XG5cblx0XHQvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyXG5cdFx0Zm9yIChpID0gMCwgbGVuZ3RoID0gdWludDgubGVuZ3RoIC0gZXh0cmFCeXRlczsgaSA8IGxlbmd0aDsgaSArPSAzKSB7XG5cdFx0XHR0ZW1wID0gKHVpbnQ4W2ldIDw8IDE2KSArICh1aW50OFtpICsgMV0gPDwgOCkgKyAodWludDhbaSArIDJdKVxuXHRcdFx0b3V0cHV0ICs9IHRyaXBsZXRUb0Jhc2U2NCh0ZW1wKVxuXHRcdH1cblxuXHRcdC8vIHBhZCB0aGUgZW5kIHdpdGggemVyb3MsIGJ1dCBtYWtlIHN1cmUgdG8gbm90IGZvcmdldCB0aGUgZXh0cmEgYnl0ZXNcblx0XHRzd2l0Y2ggKGV4dHJhQnl0ZXMpIHtcblx0XHRcdGNhc2UgMTpcblx0XHRcdFx0dGVtcCA9IHVpbnQ4W3VpbnQ4Lmxlbmd0aCAtIDFdXG5cdFx0XHRcdG91dHB1dCArPSBlbmNvZGUodGVtcCA+PiAyKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKCh0ZW1wIDw8IDQpICYgMHgzRilcblx0XHRcdFx0b3V0cHV0ICs9ICc9PSdcblx0XHRcdFx0YnJlYWtcblx0XHRcdGNhc2UgMjpcblx0XHRcdFx0dGVtcCA9ICh1aW50OFt1aW50OC5sZW5ndGggLSAyXSA8PCA4KSArICh1aW50OFt1aW50OC5sZW5ndGggLSAxXSlcblx0XHRcdFx0b3V0cHV0ICs9IGVuY29kZSh0ZW1wID4+IDEwKVxuXHRcdFx0XHRvdXRwdXQgKz0gZW5jb2RlKCh0ZW1wID4+IDQpICYgMHgzRilcblx0XHRcdFx0b3V0cHV0ICs9IGVuY29kZSgodGVtcCA8PCAyKSAmIDB4M0YpXG5cdFx0XHRcdG91dHB1dCArPSAnPSdcblx0XHRcdFx0YnJlYWtcblx0XHR9XG5cblx0XHRyZXR1cm4gb3V0cHV0XG5cdH1cblxuXHRleHBvcnRzLnRvQnl0ZUFycmF5ID0gYjY0VG9CeXRlQXJyYXlcblx0ZXhwb3J0cy5mcm9tQnl0ZUFycmF5ID0gdWludDhUb0Jhc2U2NFxufSh0eXBlb2YgZXhwb3J0cyA9PT0gJ3VuZGVmaW5lZCcgPyAodGhpcy5iYXNlNjRqcyA9IHt9KSA6IGV4cG9ydHMpKVxuIiwiZXhwb3J0cy5yZWFkID0gZnVuY3Rpb24gKGJ1ZmZlciwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG1cbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBuQml0cyA9IC03XG4gIHZhciBpID0gaXNMRSA/IChuQnl0ZXMgLSAxKSA6IDBcbiAgdmFyIGQgPSBpc0xFID8gLTEgOiAxXG4gIHZhciBzID0gYnVmZmVyW29mZnNldCArIGldXG5cbiAgaSArPSBkXG5cbiAgZSA9IHMgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgcyA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gZUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBlID0gZSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIG0gPSBlICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpXG4gIGUgPj49ICgtbkJpdHMpXG4gIG5CaXRzICs9IG1MZW5cbiAgZm9yICg7IG5CaXRzID4gMDsgbSA9IG0gKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge31cblxuICBpZiAoZSA9PT0gMCkge1xuICAgIGUgPSAxIC0gZUJpYXNcbiAgfSBlbHNlIGlmIChlID09PSBlTWF4KSB7XG4gICAgcmV0dXJuIG0gPyBOYU4gOiAoKHMgPyAtMSA6IDEpICogSW5maW5pdHkpXG4gIH0gZWxzZSB7XG4gICAgbSA9IG0gKyBNYXRoLnBvdygyLCBtTGVuKVxuICAgIGUgPSBlIC0gZUJpYXNcbiAgfVxuICByZXR1cm4gKHMgPyAtMSA6IDEpICogbSAqIE1hdGgucG93KDIsIGUgLSBtTGVuKVxufVxuXG5leHBvcnRzLndyaXRlID0gZnVuY3Rpb24gKGJ1ZmZlciwgdmFsdWUsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtLCBjXG4gIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxXG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxXG4gIHZhciBlQmlhcyA9IGVNYXggPj4gMVxuICB2YXIgcnQgPSAobUxlbiA9PT0gMjMgPyBNYXRoLnBvdygyLCAtMjQpIC0gTWF0aC5wb3coMiwgLTc3KSA6IDApXG4gIHZhciBpID0gaXNMRSA/IDAgOiAobkJ5dGVzIC0gMSlcbiAgdmFyIGQgPSBpc0xFID8gMSA6IC0xXG4gIHZhciBzID0gdmFsdWUgPCAwIHx8ICh2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwKSA/IDEgOiAwXG5cbiAgdmFsdWUgPSBNYXRoLmFicyh2YWx1ZSlcblxuICBpZiAoaXNOYU4odmFsdWUpIHx8IHZhbHVlID09PSBJbmZpbml0eSkge1xuICAgIG0gPSBpc05hTih2YWx1ZSkgPyAxIDogMFxuICAgIGUgPSBlTWF4XG4gIH0gZWxzZSB7XG4gICAgZSA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5MTjIpXG4gICAgaWYgKHZhbHVlICogKGMgPSBNYXRoLnBvdygyLCAtZSkpIDwgMSkge1xuICAgICAgZS0tXG4gICAgICBjICo9IDJcbiAgICB9XG4gICAgaWYgKGUgKyBlQmlhcyA+PSAxKSB7XG4gICAgICB2YWx1ZSArPSBydCAvIGNcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgKz0gcnQgKiBNYXRoLnBvdygyLCAxIC0gZUJpYXMpXG4gICAgfVxuICAgIGlmICh2YWx1ZSAqIGMgPj0gMikge1xuICAgICAgZSsrXG4gICAgICBjIC89IDJcbiAgICB9XG5cbiAgICBpZiAoZSArIGVCaWFzID49IGVNYXgpIHtcbiAgICAgIG0gPSAwXG4gICAgICBlID0gZU1heFxuICAgIH0gZWxzZSBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IGUgKyBlQmlhc1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gdmFsdWUgKiBNYXRoLnBvdygyLCBlQmlhcyAtIDEpICogTWF0aC5wb3coMiwgbUxlbilcbiAgICAgIGUgPSAwXG4gICAgfVxuICB9XG5cbiAgZm9yICg7IG1MZW4gPj0gODsgYnVmZmVyW29mZnNldCArIGldID0gbSAmIDB4ZmYsIGkgKz0gZCwgbSAvPSAyNTYsIG1MZW4gLT0gOCkge31cblxuICBlID0gKGUgPDwgbUxlbikgfCBtXG4gIGVMZW4gKz0gbUxlblxuICBmb3IgKDsgZUxlbiA+IDA7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IGUgJiAweGZmLCBpICs9IGQsIGUgLz0gMjU2LCBlTGVuIC09IDgpIHt9XG5cbiAgYnVmZmVyW29mZnNldCArIGkgLSBkXSB8PSBzICogMTI4XG59XG4iLCJcbi8qKlxuICogaXNBcnJheVxuICovXG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcblxuLyoqXG4gKiB0b1N0cmluZ1xuICovXG5cbnZhciBzdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vKipcbiAqIFdoZXRoZXIgb3Igbm90IHRoZSBnaXZlbiBgdmFsYFxuICogaXMgYW4gYXJyYXkuXG4gKlxuICogZXhhbXBsZTpcbiAqXG4gKiAgICAgICAgaXNBcnJheShbXSk7XG4gKiAgICAgICAgLy8gPiB0cnVlXG4gKiAgICAgICAgaXNBcnJheShhcmd1bWVudHMpO1xuICogICAgICAgIC8vID4gZmFsc2VcbiAqICAgICAgICBpc0FycmF5KCcnKTtcbiAqICAgICAgICAvLyA+IGZhbHNlXG4gKlxuICogQHBhcmFtIHttaXhlZH0gdmFsXG4gKiBAcmV0dXJuIHtib29sfVxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gaXNBcnJheSB8fCBmdW5jdGlvbiAodmFsKSB7XG4gIHJldHVybiAhISB2YWwgJiYgJ1tvYmplY3QgQXJyYXldJyA9PSBzdHIuY2FsbCh2YWwpO1xufTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIHZhciBnanUgPSB0aGlzLmdqdSA9IHt9O1xuXG4gIC8vIEV4cG9ydCB0aGUgZ2VvanNvbiBvYmplY3QgZm9yICoqQ29tbW9uSlMqKlxuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGdqdTtcbiAgfVxuXG4gIC8vIGFkYXB0ZWQgZnJvbSBodHRwOi8vd3d3LmtldmxpbmRldi5jb20vZ3VpL21hdGgvaW50ZXJzZWN0aW9uL0ludGVyc2VjdGlvbi5qc1xuICBnanUubGluZVN0cmluZ3NJbnRlcnNlY3QgPSBmdW5jdGlvbiAobDEsIGwyKSB7XG4gICAgdmFyIGludGVyc2VjdHMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBsMS5jb29yZGluYXRlcy5sZW5ndGggLSAyOyArK2kpIHtcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDw9IGwyLmNvb3JkaW5hdGVzLmxlbmd0aCAtIDI7ICsraikge1xuICAgICAgICB2YXIgYTEgPSB7XG4gICAgICAgICAgeDogbDEuY29vcmRpbmF0ZXNbaV1bMV0sXG4gICAgICAgICAgeTogbDEuY29vcmRpbmF0ZXNbaV1bMF1cbiAgICAgICAgfSxcbiAgICAgICAgICBhMiA9IHtcbiAgICAgICAgICAgIHg6IGwxLmNvb3JkaW5hdGVzW2kgKyAxXVsxXSxcbiAgICAgICAgICAgIHk6IGwxLmNvb3JkaW5hdGVzW2kgKyAxXVswXVxuICAgICAgICAgIH0sXG4gICAgICAgICAgYjEgPSB7XG4gICAgICAgICAgICB4OiBsMi5jb29yZGluYXRlc1tqXVsxXSxcbiAgICAgICAgICAgIHk6IGwyLmNvb3JkaW5hdGVzW2pdWzBdXG4gICAgICAgICAgfSxcbiAgICAgICAgICBiMiA9IHtcbiAgICAgICAgICAgIHg6IGwyLmNvb3JkaW5hdGVzW2ogKyAxXVsxXSxcbiAgICAgICAgICAgIHk6IGwyLmNvb3JkaW5hdGVzW2ogKyAxXVswXVxuICAgICAgICAgIH0sXG4gICAgICAgICAgdWFfdCA9IChiMi54IC0gYjEueCkgKiAoYTEueSAtIGIxLnkpIC0gKGIyLnkgLSBiMS55KSAqIChhMS54IC0gYjEueCksXG4gICAgICAgICAgdWJfdCA9IChhMi54IC0gYTEueCkgKiAoYTEueSAtIGIxLnkpIC0gKGEyLnkgLSBhMS55KSAqIChhMS54IC0gYjEueCksXG4gICAgICAgICAgdV9iID0gKGIyLnkgLSBiMS55KSAqIChhMi54IC0gYTEueCkgLSAoYjIueCAtIGIxLngpICogKGEyLnkgLSBhMS55KTtcbiAgICAgICAgaWYgKHVfYiAhPSAwKSB7XG4gICAgICAgICAgdmFyIHVhID0gdWFfdCAvIHVfYixcbiAgICAgICAgICAgIHViID0gdWJfdCAvIHVfYjtcbiAgICAgICAgICBpZiAoMCA8PSB1YSAmJiB1YSA8PSAxICYmIDAgPD0gdWIgJiYgdWIgPD0gMSkge1xuICAgICAgICAgICAgaW50ZXJzZWN0cy5wdXNoKHtcbiAgICAgICAgICAgICAgJ3R5cGUnOiAnUG9pbnQnLFxuICAgICAgICAgICAgICAnY29vcmRpbmF0ZXMnOiBbYTEueCArIHVhICogKGEyLnggLSBhMS54KSwgYTEueSArIHVhICogKGEyLnkgLSBhMS55KV1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaW50ZXJzZWN0cy5sZW5ndGggPT0gMCkgaW50ZXJzZWN0cyA9IGZhbHNlO1xuICAgIHJldHVybiBpbnRlcnNlY3RzO1xuICB9XG5cbiAgLy8gQm91bmRpbmcgQm94XG5cbiAgZnVuY3Rpb24gYm91bmRpbmdCb3hBcm91bmRQb2x5Q29vcmRzIChjb29yZHMpIHtcbiAgICB2YXIgeEFsbCA9IFtdLCB5QWxsID0gW11cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzWzBdLmxlbmd0aDsgaSsrKSB7XG4gICAgICB4QWxsLnB1c2goY29vcmRzWzBdW2ldWzFdKVxuICAgICAgeUFsbC5wdXNoKGNvb3Jkc1swXVtpXVswXSlcbiAgICB9XG5cbiAgICB4QWxsID0geEFsbC5zb3J0KGZ1bmN0aW9uIChhLGIpIHsgcmV0dXJuIGEgLSBiIH0pXG4gICAgeUFsbCA9IHlBbGwuc29ydChmdW5jdGlvbiAoYSxiKSB7IHJldHVybiBhIC0gYiB9KVxuXG4gICAgcmV0dXJuIFsgW3hBbGxbMF0sIHlBbGxbMF1dLCBbeEFsbFt4QWxsLmxlbmd0aCAtIDFdLCB5QWxsW3lBbGwubGVuZ3RoIC0gMV1dIF1cbiAgfVxuXG4gIGdqdS5wb2ludEluQm91bmRpbmdCb3ggPSBmdW5jdGlvbiAocG9pbnQsIGJvdW5kcykge1xuICAgIHJldHVybiAhKHBvaW50LmNvb3JkaW5hdGVzWzFdIDwgYm91bmRzWzBdWzBdIHx8IHBvaW50LmNvb3JkaW5hdGVzWzFdID4gYm91bmRzWzFdWzBdIHx8IHBvaW50LmNvb3JkaW5hdGVzWzBdIDwgYm91bmRzWzBdWzFdIHx8IHBvaW50LmNvb3JkaW5hdGVzWzBdID4gYm91bmRzWzFdWzFdKSBcbiAgfVxuXG4gIC8vIFBvaW50IGluIFBvbHlnb25cbiAgLy8gaHR0cDovL3d3dy5lY3NlLnJwaS5lZHUvSG9tZXBhZ2VzL3dyZi9SZXNlYXJjaC9TaG9ydF9Ob3Rlcy9wbnBvbHkuaHRtbCNMaXN0aW5nIHRoZSBWZXJ0aWNlc1xuXG4gIGZ1bmN0aW9uIHBucG9seSAoeCx5LGNvb3Jkcykge1xuICAgIHZhciB2ZXJ0ID0gWyBbMCwwXSBdXG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb29yZHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdmVydC5wdXNoKGNvb3Jkc1tpXVtqXSlcbiAgICAgIH1cblx0ICB2ZXJ0LnB1c2goY29vcmRzW2ldWzBdKVxuICAgICAgdmVydC5wdXNoKFswLDBdKVxuICAgIH1cblxuICAgIHZhciBpbnNpZGUgPSBmYWxzZVxuICAgIGZvciAodmFyIGkgPSAwLCBqID0gdmVydC5sZW5ndGggLSAxOyBpIDwgdmVydC5sZW5ndGg7IGogPSBpKyspIHtcbiAgICAgIGlmICgoKHZlcnRbaV1bMF0gPiB5KSAhPSAodmVydFtqXVswXSA+IHkpKSAmJiAoeCA8ICh2ZXJ0W2pdWzFdIC0gdmVydFtpXVsxXSkgKiAoeSAtIHZlcnRbaV1bMF0pIC8gKHZlcnRbal1bMF0gLSB2ZXJ0W2ldWzBdKSArIHZlcnRbaV1bMV0pKSBpbnNpZGUgPSAhaW5zaWRlXG4gICAgfVxuXG4gICAgcmV0dXJuIGluc2lkZVxuICB9XG5cbiAgZ2p1LnBvaW50SW5Qb2x5Z29uID0gZnVuY3Rpb24gKHAsIHBvbHkpIHtcbiAgICB2YXIgY29vcmRzID0gKHBvbHkudHlwZSA9PSBcIlBvbHlnb25cIikgPyBbIHBvbHkuY29vcmRpbmF0ZXMgXSA6IHBvbHkuY29vcmRpbmF0ZXNcblxuICAgIHZhciBpbnNpZGVCb3ggPSBmYWxzZVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoZ2p1LnBvaW50SW5Cb3VuZGluZ0JveChwLCBib3VuZGluZ0JveEFyb3VuZFBvbHlDb29yZHMoY29vcmRzW2ldKSkpIGluc2lkZUJveCA9IHRydWVcbiAgICB9XG4gICAgaWYgKCFpbnNpZGVCb3gpIHJldHVybiBmYWxzZVxuXG4gICAgdmFyIGluc2lkZVBvbHkgPSBmYWxzZVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAocG5wb2x5KHAuY29vcmRpbmF0ZXNbMV0sIHAuY29vcmRpbmF0ZXNbMF0sIGNvb3Jkc1tpXSkpIGluc2lkZVBvbHkgPSB0cnVlXG4gICAgfVxuXG4gICAgcmV0dXJuIGluc2lkZVBvbHlcbiAgfVxuXG4gIC8vIHN1cHBvcnQgbXVsdGkgKGJ1dCBub3QgZG9udXQpIHBvbHlnb25zXG4gIGdqdS5wb2ludEluTXVsdGlQb2x5Z29uID0gZnVuY3Rpb24gKHAsIHBvbHkpIHtcbiAgICB2YXIgY29vcmRzX2FycmF5ID0gKHBvbHkudHlwZSA9PSBcIk11bHRpUG9seWdvblwiKSA/IFsgcG9seS5jb29yZGluYXRlcyBdIDogcG9seS5jb29yZGluYXRlc1xuXG4gICAgdmFyIGluc2lkZUJveCA9IGZhbHNlXG4gICAgdmFyIGluc2lkZVBvbHkgPSBmYWxzZVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzX2FycmF5Lmxlbmd0aDsgaSsrKXtcbiAgICAgIHZhciBjb29yZHMgPSBjb29yZHNfYXJyYXlbaV07XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvb3Jkcy5sZW5ndGg7IGorKykge1xuICAgICAgICBpZiAoIWluc2lkZUJveCl7XG4gICAgICAgICAgaWYgKGdqdS5wb2ludEluQm91bmRpbmdCb3gocCwgYm91bmRpbmdCb3hBcm91bmRQb2x5Q29vcmRzKGNvb3Jkc1tqXSkpKSB7XG4gICAgICAgICAgICBpbnNpZGVCb3ggPSB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIWluc2lkZUJveCkgcmV0dXJuIGZhbHNlXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvb3Jkcy5sZW5ndGg7IGorKykge1xuICAgICAgICBpZiAoIWluc2lkZVBvbHkpe1xuICAgICAgICAgIGlmIChwbnBvbHkocC5jb29yZGluYXRlc1sxXSwgcC5jb29yZGluYXRlc1swXSwgY29vcmRzW2pdKSkge1xuICAgICAgICAgICAgaW5zaWRlUG9seSA9IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gaW5zaWRlUG9seVxuICB9XG5cbiAgZ2p1Lm51bWJlclRvUmFkaXVzID0gZnVuY3Rpb24gKG51bWJlcikge1xuICAgIHJldHVybiBudW1iZXIgKiBNYXRoLlBJIC8gMTgwO1xuICB9XG5cbiAgZ2p1Lm51bWJlclRvRGVncmVlID0gZnVuY3Rpb24gKG51bWJlcikge1xuICAgIHJldHVybiBudW1iZXIgKiAxODAgLyBNYXRoLlBJO1xuICB9XG5cbiAgLy8gd3JpdHRlbiB3aXRoIGhlbHAgZnJvbSBAdGF1dG9sb2dlXG4gIGdqdS5kcmF3Q2lyY2xlID0gZnVuY3Rpb24gKHJhZGl1c0luTWV0ZXJzLCBjZW50ZXJQb2ludCwgc3RlcHMpIHtcbiAgICB2YXIgY2VudGVyID0gW2NlbnRlclBvaW50LmNvb3JkaW5hdGVzWzFdLCBjZW50ZXJQb2ludC5jb29yZGluYXRlc1swXV0sXG4gICAgICBkaXN0ID0gKHJhZGl1c0luTWV0ZXJzIC8gMTAwMCkgLyA2MzcxLFxuICAgICAgLy8gY29udmVydCBtZXRlcnMgdG8gcmFkaWFudFxuICAgICAgcmFkQ2VudGVyID0gW2dqdS5udW1iZXJUb1JhZGl1cyhjZW50ZXJbMF0pLCBnanUubnVtYmVyVG9SYWRpdXMoY2VudGVyWzFdKV0sXG4gICAgICBzdGVwcyA9IHN0ZXBzIHx8IDE1LFxuICAgICAgLy8gMTUgc2lkZWQgY2lyY2xlXG4gICAgICBwb2x5ID0gW1tjZW50ZXJbMF0sIGNlbnRlclsxXV1dO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RlcHM7IGkrKykge1xuICAgICAgdmFyIGJybmcgPSAyICogTWF0aC5QSSAqIGkgLyBzdGVwcztcbiAgICAgIHZhciBsYXQgPSBNYXRoLmFzaW4oTWF0aC5zaW4ocmFkQ2VudGVyWzBdKSAqIE1hdGguY29zKGRpc3QpXG4gICAgICAgICAgICAgICsgTWF0aC5jb3MocmFkQ2VudGVyWzBdKSAqIE1hdGguc2luKGRpc3QpICogTWF0aC5jb3MoYnJuZykpO1xuICAgICAgdmFyIGxuZyA9IHJhZENlbnRlclsxXSArIE1hdGguYXRhbjIoTWF0aC5zaW4oYnJuZykgKiBNYXRoLnNpbihkaXN0KSAqIE1hdGguY29zKHJhZENlbnRlclswXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLmNvcyhkaXN0KSAtIE1hdGguc2luKHJhZENlbnRlclswXSkgKiBNYXRoLnNpbihsYXQpKTtcbiAgICAgIHBvbHlbaV0gPSBbXTtcbiAgICAgIHBvbHlbaV1bMV0gPSBnanUubnVtYmVyVG9EZWdyZWUobGF0KTtcbiAgICAgIHBvbHlbaV1bMF0gPSBnanUubnVtYmVyVG9EZWdyZWUobG5nKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAgICAgIFwiY29vcmRpbmF0ZXNcIjogW3BvbHldXG4gICAgfTtcbiAgfVxuXG4gIC8vIGFzc3VtZXMgcmVjdGFuZ2xlIHN0YXJ0cyBhdCBsb3dlciBsZWZ0IHBvaW50XG4gIGdqdS5yZWN0YW5nbGVDZW50cm9pZCA9IGZ1bmN0aW9uIChyZWN0YW5nbGUpIHtcbiAgICB2YXIgYmJveCA9IHJlY3RhbmdsZS5jb29yZGluYXRlc1swXTtcbiAgICB2YXIgeG1pbiA9IGJib3hbMF1bMF0sXG4gICAgICB5bWluID0gYmJveFswXVsxXSxcbiAgICAgIHhtYXggPSBiYm94WzJdWzBdLFxuICAgICAgeW1heCA9IGJib3hbMl1bMV07XG4gICAgdmFyIHh3aWR0aCA9IHhtYXggLSB4bWluO1xuICAgIHZhciB5d2lkdGggPSB5bWF4IC0geW1pbjtcbiAgICByZXR1cm4ge1xuICAgICAgJ3R5cGUnOiAnUG9pbnQnLFxuICAgICAgJ2Nvb3JkaW5hdGVzJzogW3htaW4gKyB4d2lkdGggLyAyLCB5bWluICsgeXdpZHRoIC8gMl1cbiAgICB9O1xuICB9XG5cbiAgLy8gZnJvbSBodHRwOi8vd3d3Lm1vdmFibGUtdHlwZS5jby51ay9zY3JpcHRzL2xhdGxvbmcuaHRtbFxuICBnanUucG9pbnREaXN0YW5jZSA9IGZ1bmN0aW9uIChwdDEsIHB0Mikge1xuICAgIHZhciBsb24xID0gcHQxLmNvb3JkaW5hdGVzWzBdLFxuICAgICAgbGF0MSA9IHB0MS5jb29yZGluYXRlc1sxXSxcbiAgICAgIGxvbjIgPSBwdDIuY29vcmRpbmF0ZXNbMF0sXG4gICAgICBsYXQyID0gcHQyLmNvb3JkaW5hdGVzWzFdLFxuICAgICAgZExhdCA9IGdqdS5udW1iZXJUb1JhZGl1cyhsYXQyIC0gbGF0MSksXG4gICAgICBkTG9uID0gZ2p1Lm51bWJlclRvUmFkaXVzKGxvbjIgLSBsb24xKSxcbiAgICAgIGEgPSBNYXRoLnBvdyhNYXRoLnNpbihkTGF0IC8gMiksIDIpICsgTWF0aC5jb3MoZ2p1Lm51bWJlclRvUmFkaXVzKGxhdDEpKVxuICAgICAgICAqIE1hdGguY29zKGdqdS5udW1iZXJUb1JhZGl1cyhsYXQyKSkgKiBNYXRoLnBvdyhNYXRoLnNpbihkTG9uIC8gMiksIDIpLFxuICAgICAgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEgLSBhKSk7XG4gICAgcmV0dXJuICg2MzcxICogYykgKiAxMDAwOyAvLyByZXR1cm5zIG1ldGVyc1xuICB9LFxuXG4gIC8vIGNoZWNrcyBpZiBnZW9tZXRyeSBsaWVzIGVudGlyZWx5IHdpdGhpbiBhIGNpcmNsZVxuICAvLyB3b3JrcyB3aXRoIFBvaW50LCBMaW5lU3RyaW5nLCBQb2x5Z29uXG4gIGdqdS5nZW9tZXRyeVdpdGhpblJhZGl1cyA9IGZ1bmN0aW9uIChnZW9tZXRyeSwgY2VudGVyLCByYWRpdXMpIHtcbiAgICBpZiAoZ2VvbWV0cnkudHlwZSA9PSAnUG9pbnQnKSB7XG4gICAgICByZXR1cm4gZ2p1LnBvaW50RGlzdGFuY2UoZ2VvbWV0cnksIGNlbnRlcikgPD0gcmFkaXVzO1xuICAgIH0gZWxzZSBpZiAoZ2VvbWV0cnkudHlwZSA9PSAnTGluZVN0cmluZycgfHwgZ2VvbWV0cnkudHlwZSA9PSAnUG9seWdvbicpIHtcbiAgICAgIHZhciBwb2ludCA9IHt9O1xuICAgICAgdmFyIGNvb3JkaW5hdGVzO1xuICAgICAgaWYgKGdlb21ldHJ5LnR5cGUgPT0gJ1BvbHlnb24nKSB7XG4gICAgICAgIC8vIGl0J3MgZW5vdWdoIHRvIGNoZWNrIHRoZSBleHRlcmlvciByaW5nIG9mIHRoZSBQb2x5Z29uXG4gICAgICAgIGNvb3JkaW5hdGVzID0gZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb29yZGluYXRlcyA9IGdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICAgICAgfVxuICAgICAgZm9yICh2YXIgaSBpbiBjb29yZGluYXRlcykge1xuICAgICAgICBwb2ludC5jb29yZGluYXRlcyA9IGNvb3JkaW5hdGVzW2ldO1xuICAgICAgICBpZiAoZ2p1LnBvaW50RGlzdGFuY2UocG9pbnQsIGNlbnRlcikgPiByYWRpdXMpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBhZGFwdGVkIGZyb20gaHR0cDovL3BhdWxib3Vya2UubmV0L2dlb21ldHJ5L3BvbHlhcmVhL2phdmFzY3JpcHQudHh0XG4gIGdqdS5hcmVhID0gZnVuY3Rpb24gKHBvbHlnb24pIHtcbiAgICB2YXIgYXJlYSA9IDA7XG4gICAgLy8gVE9ETzogcG9seWdvbiBob2xlcyBhdCBjb29yZGluYXRlc1sxXVxuICAgIHZhciBwb2ludHMgPSBwb2x5Z29uLmNvb3JkaW5hdGVzWzBdO1xuICAgIHZhciBqID0gcG9pbnRzLmxlbmd0aCAtIDE7XG4gICAgdmFyIHAxLCBwMjtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaiA9IGkrKykge1xuICAgICAgdmFyIHAxID0ge1xuICAgICAgICB4OiBwb2ludHNbaV1bMV0sXG4gICAgICAgIHk6IHBvaW50c1tpXVswXVxuICAgICAgfTtcbiAgICAgIHZhciBwMiA9IHtcbiAgICAgICAgeDogcG9pbnRzW2pdWzFdLFxuICAgICAgICB5OiBwb2ludHNbal1bMF1cbiAgICAgIH07XG4gICAgICBhcmVhICs9IHAxLnggKiBwMi55O1xuICAgICAgYXJlYSAtPSBwMS55ICogcDIueDtcbiAgICB9XG5cbiAgICBhcmVhIC89IDI7XG4gICAgcmV0dXJuIGFyZWE7XG4gIH0sXG5cbiAgLy8gYWRhcHRlZCBmcm9tIGh0dHA6Ly9wYXVsYm91cmtlLm5ldC9nZW9tZXRyeS9wb2x5YXJlYS9qYXZhc2NyaXB0LnR4dFxuICBnanUuY2VudHJvaWQgPSBmdW5jdGlvbiAocG9seWdvbikge1xuICAgIHZhciBmLCB4ID0gMCxcbiAgICAgIHkgPSAwO1xuICAgIC8vIFRPRE86IHBvbHlnb24gaG9sZXMgYXQgY29vcmRpbmF0ZXNbMV1cbiAgICB2YXIgcG9pbnRzID0gcG9seWdvbi5jb29yZGluYXRlc1swXTtcbiAgICB2YXIgaiA9IHBvaW50cy5sZW5ndGggLSAxO1xuICAgIHZhciBwMSwgcDI7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGg7IGogPSBpKyspIHtcbiAgICAgIHZhciBwMSA9IHtcbiAgICAgICAgeDogcG9pbnRzW2ldWzFdLFxuICAgICAgICB5OiBwb2ludHNbaV1bMF1cbiAgICAgIH07XG4gICAgICB2YXIgcDIgPSB7XG4gICAgICAgIHg6IHBvaW50c1tqXVsxXSxcbiAgICAgICAgeTogcG9pbnRzW2pdWzBdXG4gICAgICB9O1xuICAgICAgZiA9IHAxLnggKiBwMi55IC0gcDIueCAqIHAxLnk7XG4gICAgICB4ICs9IChwMS54ICsgcDIueCkgKiBmO1xuICAgICAgeSArPSAocDEueSArIHAyLnkpICogZjtcbiAgICB9XG5cbiAgICBmID0gZ2p1LmFyZWEocG9seWdvbikgKiA2O1xuICAgIHJldHVybiB7XG4gICAgICAndHlwZSc6ICdQb2ludCcsXG4gICAgICAnY29vcmRpbmF0ZXMnOiBbeSAvIGYsIHggLyBmXVxuICAgIH07XG4gIH0sXG5cbiAgZ2p1LnNpbXBsaWZ5ID0gZnVuY3Rpb24gKHNvdXJjZSwga2luaykgeyAvKiBzb3VyY2VbXSBhcnJheSBvZiBnZW9qc29uIHBvaW50cyAqL1xuICAgIC8qIGtpbmtcdGluIG1ldHJlcywga2lua3MgYWJvdmUgdGhpcyBkZXB0aCBrZXB0ICAqL1xuICAgIC8qIGtpbmsgZGVwdGggaXMgdGhlIGhlaWdodCBvZiB0aGUgdHJpYW5nbGUgYWJjIHdoZXJlIGEtYiBhbmQgYi1jIGFyZSB0d28gY29uc2VjdXRpdmUgbGluZSBzZWdtZW50cyAqL1xuICAgIGtpbmsgPSBraW5rIHx8IDIwO1xuICAgIHNvdXJjZSA9IHNvdXJjZS5tYXAoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxuZzogby5jb29yZGluYXRlc1swXSxcbiAgICAgICAgbGF0OiBvLmNvb3JkaW5hdGVzWzFdXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB2YXIgbl9zb3VyY2UsIG5fc3RhY2ssIG5fZGVzdCwgc3RhcnQsIGVuZCwgaSwgc2lnO1xuICAgIHZhciBkZXZfc3FyLCBtYXhfZGV2X3NxciwgYmFuZF9zcXI7XG4gICAgdmFyIHgxMiwgeTEyLCBkMTIsIHgxMywgeTEzLCBkMTMsIHgyMywgeTIzLCBkMjM7XG4gICAgdmFyIEYgPSAoTWF0aC5QSSAvIDE4MC4wKSAqIDAuNTtcbiAgICB2YXIgaW5kZXggPSBuZXcgQXJyYXkoKTsgLyogYXJheSBvZiBpbmRleGVzIG9mIHNvdXJjZSBwb2ludHMgdG8gaW5jbHVkZSBpbiB0aGUgcmVkdWNlZCBsaW5lICovXG4gICAgdmFyIHNpZ19zdGFydCA9IG5ldyBBcnJheSgpOyAvKiBpbmRpY2VzIG9mIHN0YXJ0ICYgZW5kIG9mIHdvcmtpbmcgc2VjdGlvbiAqL1xuICAgIHZhciBzaWdfZW5kID0gbmV3IEFycmF5KCk7XG5cbiAgICAvKiBjaGVjayBmb3Igc2ltcGxlIGNhc2VzICovXG5cbiAgICBpZiAoc291cmNlLmxlbmd0aCA8IDMpIHJldHVybiAoc291cmNlKTsgLyogb25lIG9yIHR3byBwb2ludHMgKi9cblxuICAgIC8qIG1vcmUgY29tcGxleCBjYXNlLiBpbml0aWFsaXplIHN0YWNrICovXG5cbiAgICBuX3NvdXJjZSA9IHNvdXJjZS5sZW5ndGg7XG4gICAgYmFuZF9zcXIgPSBraW5rICogMzYwLjAgLyAoMi4wICogTWF0aC5QSSAqIDYzNzgxMzcuMCk7IC8qIE5vdyBpbiBkZWdyZWVzICovXG4gICAgYmFuZF9zcXIgKj0gYmFuZF9zcXI7XG4gICAgbl9kZXN0ID0gMDtcbiAgICBzaWdfc3RhcnRbMF0gPSAwO1xuICAgIHNpZ19lbmRbMF0gPSBuX3NvdXJjZSAtIDE7XG4gICAgbl9zdGFjayA9IDE7XG5cbiAgICAvKiB3aGlsZSB0aGUgc3RhY2sgaXMgbm90IGVtcHR5ICAuLi4gKi9cbiAgICB3aGlsZSAobl9zdGFjayA+IDApIHtcblxuICAgICAgLyogLi4uIHBvcCB0aGUgdG9wLW1vc3QgZW50cmllcyBvZmYgdGhlIHN0YWNrcyAqL1xuXG4gICAgICBzdGFydCA9IHNpZ19zdGFydFtuX3N0YWNrIC0gMV07XG4gICAgICBlbmQgPSBzaWdfZW5kW25fc3RhY2sgLSAxXTtcbiAgICAgIG5fc3RhY2stLTtcblxuICAgICAgaWYgKChlbmQgLSBzdGFydCkgPiAxKSB7IC8qIGFueSBpbnRlcm1lZGlhdGUgcG9pbnRzID8gKi9cblxuICAgICAgICAvKiAuLi4geWVzLCBzbyBmaW5kIG1vc3QgZGV2aWFudCBpbnRlcm1lZGlhdGUgcG9pbnQgdG9cbiAgICAgICAgZWl0aGVyIHNpZGUgb2YgbGluZSBqb2luaW5nIHN0YXJ0ICYgZW5kIHBvaW50cyAqL1xuXG4gICAgICAgIHgxMiA9IChzb3VyY2VbZW5kXS5sbmcoKSAtIHNvdXJjZVtzdGFydF0ubG5nKCkpO1xuICAgICAgICB5MTIgPSAoc291cmNlW2VuZF0ubGF0KCkgLSBzb3VyY2Vbc3RhcnRdLmxhdCgpKTtcbiAgICAgICAgaWYgKE1hdGguYWJzKHgxMikgPiAxODAuMCkgeDEyID0gMzYwLjAgLSBNYXRoLmFicyh4MTIpO1xuICAgICAgICB4MTIgKj0gTWF0aC5jb3MoRiAqIChzb3VyY2VbZW5kXS5sYXQoKSArIHNvdXJjZVtzdGFydF0ubGF0KCkpKTsgLyogdXNlIGF2ZyBsYXQgdG8gcmVkdWNlIGxuZyAqL1xuICAgICAgICBkMTIgPSAoeDEyICogeDEyKSArICh5MTIgKiB5MTIpO1xuXG4gICAgICAgIGZvciAoaSA9IHN0YXJ0ICsgMSwgc2lnID0gc3RhcnQsIG1heF9kZXZfc3FyID0gLTEuMDsgaSA8IGVuZDsgaSsrKSB7XG5cbiAgICAgICAgICB4MTMgPSBzb3VyY2VbaV0ubG5nKCkgLSBzb3VyY2Vbc3RhcnRdLmxuZygpO1xuICAgICAgICAgIHkxMyA9IHNvdXJjZVtpXS5sYXQoKSAtIHNvdXJjZVtzdGFydF0ubGF0KCk7XG4gICAgICAgICAgaWYgKE1hdGguYWJzKHgxMykgPiAxODAuMCkgeDEzID0gMzYwLjAgLSBNYXRoLmFicyh4MTMpO1xuICAgICAgICAgIHgxMyAqPSBNYXRoLmNvcyhGICogKHNvdXJjZVtpXS5sYXQoKSArIHNvdXJjZVtzdGFydF0ubGF0KCkpKTtcbiAgICAgICAgICBkMTMgPSAoeDEzICogeDEzKSArICh5MTMgKiB5MTMpO1xuXG4gICAgICAgICAgeDIzID0gc291cmNlW2ldLmxuZygpIC0gc291cmNlW2VuZF0ubG5nKCk7XG4gICAgICAgICAgeTIzID0gc291cmNlW2ldLmxhdCgpIC0gc291cmNlW2VuZF0ubGF0KCk7XG4gICAgICAgICAgaWYgKE1hdGguYWJzKHgyMykgPiAxODAuMCkgeDIzID0gMzYwLjAgLSBNYXRoLmFicyh4MjMpO1xuICAgICAgICAgIHgyMyAqPSBNYXRoLmNvcyhGICogKHNvdXJjZVtpXS5sYXQoKSArIHNvdXJjZVtlbmRdLmxhdCgpKSk7XG4gICAgICAgICAgZDIzID0gKHgyMyAqIHgyMykgKyAoeTIzICogeTIzKTtcblxuICAgICAgICAgIGlmIChkMTMgPj0gKGQxMiArIGQyMykpIGRldl9zcXIgPSBkMjM7XG4gICAgICAgICAgZWxzZSBpZiAoZDIzID49IChkMTIgKyBkMTMpKSBkZXZfc3FyID0gZDEzO1xuICAgICAgICAgIGVsc2UgZGV2X3NxciA9ICh4MTMgKiB5MTIgLSB5MTMgKiB4MTIpICogKHgxMyAqIHkxMiAtIHkxMyAqIHgxMikgLyBkMTI7IC8vIHNvbHZlIHRyaWFuZ2xlXG4gICAgICAgICAgaWYgKGRldl9zcXIgPiBtYXhfZGV2X3Nxcikge1xuICAgICAgICAgICAgc2lnID0gaTtcbiAgICAgICAgICAgIG1heF9kZXZfc3FyID0gZGV2X3NxcjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWF4X2Rldl9zcXIgPCBiYW5kX3NxcikgeyAvKiBpcyB0aGVyZSBhIHNpZy4gaW50ZXJtZWRpYXRlIHBvaW50ID8gKi9cbiAgICAgICAgICAvKiAuLi4gbm8sIHNvIHRyYW5zZmVyIGN1cnJlbnQgc3RhcnQgcG9pbnQgKi9cbiAgICAgICAgICBpbmRleFtuX2Rlc3RdID0gc3RhcnQ7XG4gICAgICAgICAgbl9kZXN0Kys7XG4gICAgICAgIH0gZWxzZSB7IC8qIC4uLiB5ZXMsIHNvIHB1c2ggdHdvIHN1Yi1zZWN0aW9ucyBvbiBzdGFjayBmb3IgZnVydGhlciBwcm9jZXNzaW5nICovXG4gICAgICAgICAgbl9zdGFjaysrO1xuICAgICAgICAgIHNpZ19zdGFydFtuX3N0YWNrIC0gMV0gPSBzaWc7XG4gICAgICAgICAgc2lnX2VuZFtuX3N0YWNrIC0gMV0gPSBlbmQ7XG4gICAgICAgICAgbl9zdGFjaysrO1xuICAgICAgICAgIHNpZ19zdGFydFtuX3N0YWNrIC0gMV0gPSBzdGFydDtcbiAgICAgICAgICBzaWdfZW5kW25fc3RhY2sgLSAxXSA9IHNpZztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHsgLyogLi4uIG5vIGludGVybWVkaWF0ZSBwb2ludHMsIHNvIHRyYW5zZmVyIGN1cnJlbnQgc3RhcnQgcG9pbnQgKi9cbiAgICAgICAgaW5kZXhbbl9kZXN0XSA9IHN0YXJ0O1xuICAgICAgICBuX2Rlc3QrKztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKiB0cmFuc2ZlciBsYXN0IHBvaW50ICovXG4gICAgaW5kZXhbbl9kZXN0XSA9IG5fc291cmNlIC0gMTtcbiAgICBuX2Rlc3QrKztcblxuICAgIC8qIG1ha2UgcmV0dXJuIGFycmF5ICovXG4gICAgdmFyIHIgPSBuZXcgQXJyYXkoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5fZGVzdDsgaSsrKVxuICAgICAgci5wdXNoKHNvdXJjZVtpbmRleFtpXV0pO1xuXG4gICAgcmV0dXJuIHIubWFwKGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcIlBvaW50XCIsXG4gICAgICAgIGNvb3JkaW5hdGVzOiBbby5sbmcsIG8ubGF0XVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLy8gaHR0cDovL3d3dy5tb3ZhYmxlLXR5cGUuY28udWsvc2NyaXB0cy9sYXRsb25nLmh0bWwjZGVzdFBvaW50XG4gIGdqdS5kZXN0aW5hdGlvblBvaW50ID0gZnVuY3Rpb24gKHB0LCBicm5nLCBkaXN0KSB7XG4gICAgZGlzdCA9IGRpc3QvNjM3MTsgIC8vIGNvbnZlcnQgZGlzdCB0byBhbmd1bGFyIGRpc3RhbmNlIGluIHJhZGlhbnNcbiAgICBicm5nID0gZ2p1Lm51bWJlclRvUmFkaXVzKGJybmcpO1xuXG4gICAgdmFyIGxvbjEgPSBnanUubnVtYmVyVG9SYWRpdXMocHQuY29vcmRpbmF0ZXNbMF0pO1xuICAgIHZhciBsYXQxID0gZ2p1Lm51bWJlclRvUmFkaXVzKHB0LmNvb3JkaW5hdGVzWzFdKTtcblxuICAgIHZhciBsYXQyID0gTWF0aC5hc2luKCBNYXRoLnNpbihsYXQxKSpNYXRoLmNvcyhkaXN0KSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguY29zKGxhdDEpKk1hdGguc2luKGRpc3QpKk1hdGguY29zKGJybmcpICk7XG4gICAgdmFyIGxvbjIgPSBsb24xICsgTWF0aC5hdGFuMihNYXRoLnNpbihicm5nKSpNYXRoLnNpbihkaXN0KSpNYXRoLmNvcyhsYXQxKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguY29zKGRpc3QpLU1hdGguc2luKGxhdDEpKk1hdGguc2luKGxhdDIpKTtcbiAgICBsb24yID0gKGxvbjIrMypNYXRoLlBJKSAlICgyKk1hdGguUEkpIC0gTWF0aC5QSTsgIC8vIG5vcm1hbGlzZSB0byAtMTgwLi4rMTgwwrpcblxuICAgIHJldHVybiB7XG4gICAgICAndHlwZSc6ICdQb2ludCcsXG4gICAgICAnY29vcmRpbmF0ZXMnOiBbZ2p1Lm51bWJlclRvRGVncmVlKGxvbjIpLCBnanUubnVtYmVyVG9EZWdyZWUobGF0MildXG4gICAgfTtcbiAgfTtcblxufSkoKTtcbiIsIi8vIFBhY2thZ2luZy9tb2R1bGVzIG1hZ2ljIGRhbmNlLlxuKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG4gICAgdmFyIEw7XG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICAvLyBBTURcbiAgICAgICAgZGVmaW5lKFsnbGVhZmxldCddLCBmYWN0b3J5KTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIE5vZGUvQ29tbW9uSlNcbiAgICAgICAgTCA9IHJlcXVpcmUoJ2xlYWZsZXQnKTtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KEwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEJyb3dzZXIgZ2xvYmFsc1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5MID09PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgIHRocm93ICdMZWFmbGV0IG11c3QgYmUgbG9hZGVkIGZpcnN0JztcbiAgICAgICAgZmFjdG9yeSh3aW5kb3cuTCk7XG4gICAgfVxufShmdW5jdGlvbiAoTCkge1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQGZpbGVPdmVydmlldyBMZWFmbGV0IEdlb21ldHJ5IHV0aWxpdGllcyBmb3IgZGlzdGFuY2VzIGFuZCBsaW5lYXIgcmVmZXJlbmNpbmcuXG4gKiBAbmFtZSBMLkdlb21ldHJ5VXRpbFxuICovXG5cbkwuR2VvbWV0cnlVdGlsID0gTC5leHRlbmQoTC5HZW9tZXRyeVV0aWwgfHwge30sIHtcblxuICAgIC8qKlxuICAgICAgICBTaG9ydGN1dCBmdW5jdGlvbiBmb3IgcGxhbmFyIGRpc3RhbmNlIGJldHdlZW4gdHdvIHtMLkxhdExuZ30gYXQgY3VycmVudCB6b29tLlxuICAgICAgICBAcGFyYW0ge0wuTWFwfSBtYXBcbiAgICAgICAgQHBhcmFtIHtMLkxhdExuZ30gbGF0bG5nQVxuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdCXG4gICAgICAgIEByZXR1cm5zIHtOdW1iZXJ9IGluIHBpeGVsc1xuICAgICAqL1xuICAgIGRpc3RhbmNlOiBmdW5jdGlvbiAobWFwLCBsYXRsbmdBLCBsYXRsbmdCKSB7XG4gICAgICAgIHJldHVybiBtYXAubGF0TG5nVG9MYXllclBvaW50KGxhdGxuZ0EpLmRpc3RhbmNlVG8obWFwLmxhdExuZ1RvTGF5ZXJQb2ludChsYXRsbmdCKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgICBTaG9ydGN1dCBmdW5jdGlvbiBmb3IgcGxhbmFyIGRpc3RhbmNlIGJldHdlZW4gYSB7TC5MYXRMbmd9IGFuZCBhIHNlZ21lbnQgKEEtQikuXG4gICAgICAgIEBwYXJhbSB7TC5NYXB9IG1hcFxuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdcbiAgICAgICAgQHBhcmFtIHtMLkxhdExuZ30gbGF0bG5nQVxuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdCXG4gICAgICAgIEByZXR1cm5zIHtOdW1iZXJ9IGluIHBpeGVsc1xuICAgICovXG4gICAgZGlzdGFuY2VTZWdtZW50OiBmdW5jdGlvbiAobWFwLCBsYXRsbmcsIGxhdGxuZ0EsIGxhdGxuZ0IpIHtcbiAgICAgICAgdmFyIHAgPSBtYXAubGF0TG5nVG9MYXllclBvaW50KGxhdGxuZyksXG4gICAgICAgICAgIHAxID0gbWFwLmxhdExuZ1RvTGF5ZXJQb2ludChsYXRsbmdBKSxcbiAgICAgICAgICAgcDIgPSBtYXAubGF0TG5nVG9MYXllclBvaW50KGxhdGxuZ0IpO1xuICAgICAgICByZXR1cm4gTC5MaW5lVXRpbC5wb2ludFRvU2VnbWVudERpc3RhbmNlKHAsIHAxLCBwMik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgICBTaG9ydGN1dCBmdW5jdGlvbiBmb3IgY29udmVydGluZyBkaXN0YW5jZSB0byByZWFkYWJsZSBkaXN0YW5jZS5cbiAgICAgICAgQHBhcmFtIHtOdW1iZXJ9IGRpc3RhbmNlXG4gICAgICAgIEBwYXJhbSB7U3RyaW5nfSB1bml0ICgnbWV0cmljJyBvciAnaW1wZXJpYWwnKVxuICAgICAgICBAcmV0dXJucyB7TnVtYmVyfSBpbiB5YXJkIG9yIG1pbGVzXG4gICAgKi9cbiAgICByZWFkYWJsZURpc3RhbmNlOiBmdW5jdGlvbiAoZGlzdGFuY2UsIHVuaXQpIHtcbiAgICAgICAgdmFyIGlzTWV0cmljID0gKHVuaXQgIT09ICdpbXBlcmlhbCcpLFxuICAgICAgICAgICAgZGlzdGFuY2VTdHI7XG4gICAgICAgIGlmIChpc01ldHJpYykge1xuICAgICAgICAgICAgLy8gc2hvdyBtZXRyZXMgd2hlbiBkaXN0YW5jZSBpcyA8IDFrbSwgdGhlbiBzaG93IGttXG4gICAgICAgICAgICBpZiAoZGlzdGFuY2UgPiAxMDAwKSB7XG4gICAgICAgICAgICAgICAgZGlzdGFuY2VTdHIgPSAoZGlzdGFuY2UgIC8gMTAwMCkudG9GaXhlZCgyKSArICcga20nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGlzdGFuY2VTdHIgPSBNYXRoLmNlaWwoZGlzdGFuY2UpICsgJyBtJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRpc3RhbmNlICo9IDEuMDkzNjE7XG4gICAgICAgICAgICBpZiAoZGlzdGFuY2UgPiAxNzYwKSB7XG4gICAgICAgICAgICAgICAgZGlzdGFuY2VTdHIgPSAoZGlzdGFuY2UgLyAxNzYwKS50b0ZpeGVkKDIpICsgJyBtaWxlcyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkaXN0YW5jZVN0ciA9IE1hdGguY2VpbChkaXN0YW5jZSkgKyAnIHlkJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlzdGFuY2VTdHI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgICBSZXR1cm5zIHRydWUgaWYgdGhlIGxhdGxuZyBiZWxvbmdzIHRvIHNlZ21lbnQuXG4gICAgICAgIHBhcmFtIHtMLkxhdExuZ30gbGF0bG5nXG4gICAgICAgIEBwYXJhbSB7TC5MYXRMbmd9IGxhdGxuZ0FcbiAgICAgICAgQHBhcmFtIHtMLkxhdExuZ30gbGF0bG5nQlxuICAgICAgICBAcGFyYW0gez9OdW1iZXJ9IFt0b2xlcmFuY2U9MC4yXVxuICAgICAgICBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBiZWxvbmdzU2VnbWVudDogZnVuY3Rpb24obGF0bG5nLCBsYXRsbmdBLCBsYXRsbmdCLCB0b2xlcmFuY2UpIHtcbiAgICAgICAgdG9sZXJhbmNlID0gdG9sZXJhbmNlID09PSB1bmRlZmluZWQgPyAwLjIgOiB0b2xlcmFuY2U7XG4gICAgICAgIHZhciBoeXBvdGVudXNlID0gbGF0bG5nQS5kaXN0YW5jZVRvKGxhdGxuZ0IpLFxuICAgICAgICAgICAgZGVsdGEgPSBsYXRsbmdBLmRpc3RhbmNlVG8obGF0bG5nKSArIGxhdGxuZy5kaXN0YW5jZVRvKGxhdGxuZ0IpIC0gaHlwb3RlbnVzZTtcbiAgICAgICAgcmV0dXJuIGRlbHRhL2h5cG90ZW51c2UgPCB0b2xlcmFuY2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdG90YWwgbGVuZ3RoIG9mIGxpbmVcbiAgICAgKiBAcGFyYW0ge0wuUG9seWxpbmV8QXJyYXk8TC5Qb2ludD58QXJyYXk8TC5MYXRMbmc+fVxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IGluIG1ldGVyc1xuICAgICAqL1xuICAgIGxlbmd0aDogZnVuY3Rpb24gKGNvb3Jkcykge1xuICAgICAgICB2YXIgYWNjdW11bGF0ZWQgPSBMLkdlb21ldHJ5VXRpbC5hY2N1bXVsYXRlZExlbmd0aHMoY29vcmRzKTtcbiAgICAgICAgcmV0dXJuIGFjY3VtdWxhdGVkLmxlbmd0aCA+IDAgPyBhY2N1bXVsYXRlZFthY2N1bXVsYXRlZC5sZW5ndGgtMV0gOiAwO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBhY2N1bXVsYXRlZCBsZW5ndGggYWxvbmcgYSBsaW5lLlxuICAgICAqIEBwYXJhbSB7TC5Qb2x5bGluZXxBcnJheTxMLlBvaW50PnxBcnJheTxMLkxhdExuZz59XG4gICAgICogQHJldHVybnMge051bWJlcn0gaW4gbWV0ZXJzXG4gICAgICovXG4gICAgYWNjdW11bGF0ZWRMZW5ndGhzOiBmdW5jdGlvbiAoY29vcmRzKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY29vcmRzLmdldExhdExuZ3MgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY29vcmRzID0gY29vcmRzLmdldExhdExuZ3MoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29vcmRzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgdmFyIHRvdGFsID0gMCxcbiAgICAgICAgICAgIGxlbmd0aHMgPSBbMF07XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBuID0gY29vcmRzLmxlbmd0aCAtIDE7IGk8IG47IGkrKykge1xuICAgICAgICAgICAgdG90YWwgKz0gY29vcmRzW2ldLmRpc3RhbmNlVG8oY29vcmRzW2krMV0pO1xuICAgICAgICAgICAgbGVuZ3Rocy5wdXNoKHRvdGFsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGVuZ3RocztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICAgIFJldHVybnMgdGhlIGNsb3Nlc3QgcG9pbnQgb2YgYSB7TC5MYXRMbmd9IG9uIHRoZSBzZWdtZW50IChBLUIpXG4gICAgICAgIEBwYXJhbSB7TC5NYXB9IG1hcFxuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdcbiAgICAgICAgQHBhcmFtIHtMLkxhdExuZ30gbGF0bG5nQVxuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdCXG4gICAgICAgIEByZXR1cm5zIHtMLkxhdExuZ31cbiAgICAqL1xuICAgIGNsb3Nlc3RPblNlZ21lbnQ6IGZ1bmN0aW9uIChtYXAsIGxhdGxuZywgbGF0bG5nQSwgbGF0bG5nQikge1xuICAgICAgICB2YXIgbWF4em9vbSA9IG1hcC5nZXRNYXhab29tKCk7XG4gICAgICAgIGlmIChtYXh6b29tID09PSBJbmZpbml0eSlcbiAgICAgICAgICAgIG1heHpvb20gPSBtYXAuZ2V0Wm9vbSgpO1xuICAgICAgICB2YXIgcCA9IG1hcC5wcm9qZWN0KGxhdGxuZywgbWF4em9vbSksXG4gICAgICAgICAgIHAxID0gbWFwLnByb2plY3QobGF0bG5nQSwgbWF4em9vbSksXG4gICAgICAgICAgIHAyID0gbWFwLnByb2plY3QobGF0bG5nQiwgbWF4em9vbSksXG4gICAgICAgICAgIGNsb3Nlc3QgPSBMLkxpbmVVdGlsLmNsb3Nlc3RQb2ludE9uU2VnbWVudChwLCBwMSwgcDIpO1xuICAgICAgICByZXR1cm4gbWFwLnVucHJvamVjdChjbG9zZXN0LCBtYXh6b29tKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICAgIFJldHVybnMgdGhlIGNsb3Nlc3QgbGF0bG5nIG9uIGxheWVyLlxuICAgICAgICBAcGFyYW0ge0wuTWFwfSBtYXBcbiAgICAgICAgQHBhcmFtIHtBcnJheTxMLkxhdExuZz58TC5Qb2x5TGluZX0gbGF5ZXIgLSBMYXllciB0aGF0IGNvbnRhaW5zIHRoZSByZXN1bHQuXG4gICAgICAgIEBwYXJhbSB7TC5MYXRMbmd9IGxhdGxuZ1xuICAgICAgICBAcGFyYW0gez9ib29sZWFufSBbdmVydGljZXM9ZmFsc2VdIC0gV2hldGhlciB0byByZXN0cmljdCB0byBwYXRoIHZlcnRpY2VzLlxuICAgICAgICBAcmV0dXJucyB7TC5MYXRMbmd9XG4gICAgKi9cbiAgICBjbG9zZXN0OiBmdW5jdGlvbiAobWFwLCBsYXllciwgbGF0bG5nLCB2ZXJ0aWNlcykge1xuICAgICAgICBpZiAodHlwZW9mIGxheWVyLmdldExhdExuZ3MgIT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgIGxheWVyID0gTC5wb2x5bGluZShsYXllcik7XG5cbiAgICAgICAgdmFyIGxhdGxuZ3MgPSBsYXllci5nZXRMYXRMbmdzKCkuc2xpY2UoMCksXG4gICAgICAgICAgICBtaW5kaXN0ID0gSW5maW5pdHksXG4gICAgICAgICAgICByZXN1bHQgPSBudWxsLFxuICAgICAgICAgICAgaSwgbiwgZGlzdGFuY2U7XG5cbiAgICAgICAgLy8gTG9va3VwIHZlcnRpY2VzXG4gICAgICAgIGlmICh2ZXJ0aWNlcykge1xuICAgICAgICAgICAgZm9yKGkgPSAwLCBuID0gbGF0bG5ncy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbGwgPSBsYXRsbmdzW2ldO1xuICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gTC5HZW9tZXRyeVV0aWwuZGlzdGFuY2UobWFwLCBsYXRsbmcsIGxsKTtcbiAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPCBtaW5kaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIG1pbmRpc3QgPSBkaXN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbGw7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kaXN0YW5jZSA9IGRpc3RhbmNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobGF5ZXIgaW5zdGFuY2VvZiBMLlBvbHlnb24pIHtcbiAgICAgICAgICAgIGxhdGxuZ3MucHVzaChsYXRsbmdzWzBdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEtlZXAgdGhlIGNsb3Nlc3QgcG9pbnQgb2YgYWxsIHNlZ21lbnRzXG4gICAgICAgIGZvciAoaSA9IDAsIG4gPSBsYXRsbmdzLmxlbmd0aDsgaSA8IG4tMTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbGF0bG5nQSA9IGxhdGxuZ3NbaV0sXG4gICAgICAgICAgICAgICAgbGF0bG5nQiA9IGxhdGxuZ3NbaSsxXTtcbiAgICAgICAgICAgIGRpc3RhbmNlID0gTC5HZW9tZXRyeVV0aWwuZGlzdGFuY2VTZWdtZW50KG1hcCwgbGF0bG5nLCBsYXRsbmdBLCBsYXRsbmdCKTtcbiAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8PSBtaW5kaXN0KSB7XG4gICAgICAgICAgICAgICAgbWluZGlzdCA9IGRpc3RhbmNlO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IEwuR2VvbWV0cnlVdGlsLmNsb3Nlc3RPblNlZ21lbnQobWFwLCBsYXRsbmcsIGxhdGxuZ0EsIGxhdGxuZ0IpO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5kaXN0YW5jZSA9IGRpc3RhbmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgICBSZXR1cm5zIHRoZSBjbG9zZXN0IGxheWVyIHRvIGxhdGxuZyBhbW9uZyBhIGxpc3Qgb2YgbGF5ZXJzLlxuICAgICAgICBAcGFyYW0ge0wuTWFwfSBtYXBcbiAgICAgICAgQHBhcmFtIHtBcnJheTxMLklMYXllcj59IGxheWVyc1xuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdcbiAgICAgICAgQHJldHVybnMge29iamVjdH0gd2l0aCBsYXllciwgbGF0bG5nIGFuZCBkaXN0YW5jZSBvciB7bnVsbH0gaWYgbGlzdCBpcyBlbXB0eTtcbiAgICAqL1xuICAgIGNsb3Nlc3RMYXllcjogZnVuY3Rpb24gKG1hcCwgbGF5ZXJzLCBsYXRsbmcpIHtcbiAgICAgICAgdmFyIG1pbmRpc3QgPSBJbmZpbml0eSxcbiAgICAgICAgICAgIHJlc3VsdCA9IG51bGwsXG4gICAgICAgICAgICBsbCA9IG51bGwsXG4gICAgICAgICAgICBkaXN0YW5jZSA9IEluZmluaXR5O1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBuID0gbGF5ZXJzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgdmFyIGxheWVyID0gbGF5ZXJzW2ldO1xuICAgICAgICAgICAgLy8gU2luZ2xlIGRpbWVuc2lvbiwgc25hcCBvbiBwb2ludHMsIGVsc2Ugc25hcCBvbiBjbG9zZXN0XG4gICAgICAgICAgICBpZiAodHlwZW9mIGxheWVyLmdldExhdExuZyA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgbGwgPSBsYXllci5nZXRMYXRMbmcoKTtcbiAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IEwuR2VvbWV0cnlVdGlsLmRpc3RhbmNlKG1hcCwgbGF0bG5nLCBsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsbCA9IEwuR2VvbWV0cnlVdGlsLmNsb3Nlc3QobWFwLCBsYXllciwgbGF0bG5nKTtcbiAgICAgICAgICAgICAgICBpZiAobGwpIGRpc3RhbmNlID0gbGwuZGlzdGFuY2U7ICAvLyBDYW4gcmV0dXJuIG51bGwgaWYgbGF5ZXIgaGFzIG5vIHBvaW50cy5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IG1pbmRpc3QpIHtcbiAgICAgICAgICAgICAgICBtaW5kaXN0ID0gZGlzdGFuY2U7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0ge2xheWVyOiBsYXllciwgbGF0bG5nOiBsbCwgZGlzdGFuY2U6IGRpc3RhbmNlfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICAgUmV0dXJucyB0aGUgY2xvc2VzdCBwb3NpdGlvbiBmcm9tIHNwZWNpZmllZCB7TGF0TG5nfSBhbW9uZyBzcGVjaWZpZWQgbGF5ZXJzLFxuICAgICAgICB3aXRoIGEgbWF4aW11bSB0b2xlcmFuY2UgaW4gcGl4ZWxzLCBwcm92aWRpbmcgc25hcHBpbmcgYmVoYXZpb3VyLlxuICAgICAgICBAcGFyYW0ge0wuTWFwfSBtYXBcbiAgICAgICAgQHBhcmFtIHtBcnJheTxJTGF5ZXI+fSBsYXllcnMgLSBBIGxpc3Qgb2YgbGF5ZXJzIHRvIHNuYXAgb24uXG4gICAgICAgIEBwYXJhbSB7TC5MYXRMbmd9IGxhdGxuZyAtIFRoZSBwb3NpdGlvbiB0byBzbmFwLlxuICAgICAgICBAcGFyYW0gez9OdW1iZXJ9IFt0b2xlcmFuY2U9SW5maW5pdHldIC0gTWF4aW11bSBudW1iZXIgb2YgcGl4ZWxzLlxuICAgICAgICBAcGFyYW0gez9ib29sZWFufSBbd2l0aFZlcnRpY2VzPXRydWVdIC0gU25hcCB0byBsYXllcnMgdmVydGljZXMuXG4gICAgICAgIEByZXR1cm5zIHtvYmplY3R9IHdpdGggc25hcHBlZCB7TGF0TG5nfSBhbmQgc25hcHBlZCB7TGF5ZXJ9IG9yIG51bGwgaWYgdG9sZXJhbmNlIGV4Y2VlZGVkLlxuICAgICovXG4gICAgY2xvc2VzdExheWVyU25hcDogZnVuY3Rpb24gKG1hcCwgbGF5ZXJzLCBsYXRsbmcsIHRvbGVyYW5jZSwgd2l0aFZlcnRpY2VzKSB7XG4gICAgICAgIHRvbGVyYW5jZSA9IHR5cGVvZiB0b2xlcmFuY2UgPT0gJ251bWJlcicgPyB0b2xlcmFuY2UgOiBJbmZpbml0eTtcbiAgICAgICAgd2l0aFZlcnRpY2VzID0gdHlwZW9mIHdpdGhWZXJ0aWNlcyA9PSAnYm9vbGVhbicgPyB3aXRoVmVydGljZXMgOiB0cnVlO1xuXG4gICAgICAgIHZhciByZXN1bHQgPSBMLkdlb21ldHJ5VXRpbC5jbG9zZXN0TGF5ZXIobWFwLCBsYXllcnMsIGxhdGxuZyk7XG4gICAgICAgIGlmICghcmVzdWx0IHx8IHJlc3VsdC5kaXN0YW5jZSA+IHRvbGVyYW5jZSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgIC8vIElmIHNuYXBwZWQgbGF5ZXIgaXMgbGluZWFyLCB0cnkgdG8gc25hcCBvbiB2ZXJ0aWNlcyAoZXh0cmVtaXRpZXMgYW5kIG1pZGRsZSBwb2ludHMpXG4gICAgICAgIGlmICh3aXRoVmVydGljZXMgJiYgdHlwZW9mIHJlc3VsdC5sYXllci5nZXRMYXRMbmdzID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHZhciBjbG9zZXN0ID0gTC5HZW9tZXRyeVV0aWwuY2xvc2VzdChtYXAsIHJlc3VsdC5sYXllciwgcmVzdWx0LmxhdGxuZywgdHJ1ZSk7XG4gICAgICAgICAgICBpZiAoY2xvc2VzdC5kaXN0YW5jZSA8IHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5sYXRsbmcgPSBjbG9zZXN0O1xuICAgICAgICAgICAgICAgIHJlc3VsdC5kaXN0YW5jZSA9IEwuR2VvbWV0cnlVdGlsLmRpc3RhbmNlKG1hcCwgY2xvc2VzdCwgbGF0bG5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICAgUmV0dXJucyB0aGUgUG9pbnQgbG9jYXRlZCBvbiBhIHNlZ21lbnQgYXQgdGhlIHNwZWNpZmllZCByYXRpbyBvZiB0aGUgc2VnbWVudCBsZW5ndGguXG4gICAgICAgIEBwYXJhbSB7TC5Qb2ludH0gcEFcbiAgICAgICAgQHBhcmFtIHtMLlBvaW50fSBwQlxuICAgICAgICBAcGFyYW0ge051bWJlcn0gdGhlIGxlbmd0aCByYXRpbywgZXhwcmVzc2VkIGFzIGEgZGVjaW1hbCBiZXR3ZWVuIDAgYW5kIDEsIGluY2x1c2l2ZS5cbiAgICAgICAgQHJldHVybnMge0wuUG9pbnR9IHRoZSBpbnRlcnBvbGF0ZWQgcG9pbnQuXG4gICAgKi9cbiAgICBpbnRlcnBvbGF0ZU9uUG9pbnRTZWdtZW50OiBmdW5jdGlvbiAocEEsIHBCLCByYXRpbykge1xuICAgICAgICByZXR1cm4gTC5wb2ludChcbiAgICAgICAgICAgIChwQS54ICogKDEgLSByYXRpbykpICsgKHJhdGlvICogcEIueCksXG4gICAgICAgICAgICAocEEueSAqICgxIC0gcmF0aW8pKSArIChyYXRpbyAqIHBCLnkpXG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgICBSZXR1cm5zIHRoZSBjb29yZGluYXRlIG9mIHRoZSBwb2ludCBsb2NhdGVkIG9uIGEgbGluZSBhdCB0aGUgc3BlY2lmaWVkIHJhdGlvIG9mIHRoZSBsaW5lIGxlbmd0aC5cbiAgICAgICAgQHBhcmFtIHtMLk1hcH0gbWFwXG4gICAgICAgIEBwYXJhbSB7QXJyYXk8TC5MYXRMbmc+fEwuUG9seUxpbmV9IGxhdGxuZ3NcbiAgICAgICAgQHBhcmFtIHtOdW1iZXJ9IHRoZSBsZW5ndGggcmF0aW8sIGV4cHJlc3NlZCBhcyBhIGRlY2ltYWwgYmV0d2VlbiAwIGFuZCAxLCBpbmNsdXNpdmVcbiAgICAgICAgQHJldHVybnMge09iamVjdH0gYW4gb2JqZWN0IHdpdGggbGF0TG5nICh7TGF0TG5nfSkgYW5kIHByZWRlY2Vzc29yICh7TnVtYmVyfSksIHRoZSBpbmRleCBvZiB0aGUgcHJlY2VkaW5nIHZlcnRleCBpbiB0aGUgUG9seWxpbmVcbiAgICAgICAgKC0xIGlmIHRoZSBpbnRlcnBvbGF0ZWQgcG9pbnQgaXMgdGhlIGZpcnN0IHZlcnRleClcbiAgICAqL1xuICAgIGludGVycG9sYXRlT25MaW5lOiBmdW5jdGlvbiAobWFwLCBsYXRMbmdzLCByYXRpbykge1xuICAgICAgICBsYXRMbmdzID0gKGxhdExuZ3MgaW5zdGFuY2VvZiBMLlBvbHlsaW5lKSA/IGxhdExuZ3MuZ2V0TGF0TG5ncygpIDogbGF0TG5ncztcbiAgICAgICAgdmFyIG4gPSBsYXRMbmdzLmxlbmd0aDtcbiAgICAgICAgaWYgKG4gPCAyKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyYXRpbyA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBsYXRMbmc6IGxhdExuZ3NbMF0gaW5zdGFuY2VvZiBMLkxhdExuZyA/IGxhdExuZ3NbMF0gOiBMLmxhdExuZyhsYXRMbmdzWzBdKSxcbiAgICAgICAgICAgICAgICBwcmVkZWNlc3NvcjogLTFcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJhdGlvID09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbGF0TG5nOiBsYXRMbmdzW2xhdExuZ3MubGVuZ3RoIC0xXSBpbnN0YW5jZW9mIEwuTGF0TG5nID8gbGF0TG5nc1tsYXRMbmdzLmxlbmd0aCAtMV0gOiBMLmxhdExuZyhsYXRMbmdzW2xhdExuZ3MubGVuZ3RoIC0xXSksXG4gICAgICAgICAgICAgICAgcHJlZGVjZXNzb3I6IGxhdExuZ3MubGVuZ3RoIC0gMlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVuc3VyZSB0aGUgcmF0aW8gaXMgYmV0d2VlbiAwIGFuZCAxO1xuICAgICAgICByYXRpbyA9IE1hdGgubWF4KE1hdGgubWluKHJhdGlvLCAxKSwgMCk7XG5cbiAgICAgICAgLy8gcHJvamVjdCB0aGUgTGF0TG5ncyBhcyBQb2ludHMsXG4gICAgICAgIC8vIGFuZCBjb21wdXRlIHRvdGFsIHBsYW5hciBsZW5ndGggb2YgdGhlIGxpbmUgYXQgbWF4IHByZWNpc2lvblxuICAgICAgICB2YXIgbWF4em9vbSA9IG1hcC5nZXRNYXhab29tKCk7XG4gICAgICAgIGlmIChtYXh6b29tID09PSBJbmZpbml0eSlcbiAgICAgICAgICAgIG1heHpvb20gPSBtYXAuZ2V0Wm9vbSgpO1xuICAgICAgICB2YXIgcHRzID0gW107XG4gICAgICAgIHZhciBsaW5lTGVuZ3RoID0gMDtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgcHRzW2ldID0gbWFwLnByb2plY3QobGF0TG5nc1tpXSwgbWF4em9vbSk7XG4gICAgICAgICAgICBpZihpID4gMClcbiAgICAgICAgICAgICAgbGluZUxlbmd0aCArPSBwdHNbaS0xXS5kaXN0YW5jZVRvKHB0c1tpXSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmF0aW9EaXN0ID0gbGluZUxlbmd0aCAqIHJhdGlvO1xuICAgICAgICB2YXIgYSA9IHB0c1swXSxcbiAgICAgICAgICAgIGIgPSBwdHNbMV0sXG4gICAgICAgICAgICBkaXN0QSA9IDAsXG4gICAgICAgICAgICBkaXN0QiA9IGEuZGlzdGFuY2VUbyhiKTtcbiAgICAgICAgLy8gZm9sbG93IHRoZSBsaW5lIHNlZ21lbnRzIFthYl0sIGFkZGluZyBsZW5ndGhzLFxuICAgICAgICAvLyB1bnRpbCB3ZSBmaW5kIHRoZSBzZWdtZW50IHdoZXJlIHRoZSBwb2ludHMgc2hvdWxkIGxpZSBvblxuICAgICAgICB2YXIgaW5kZXggPSAxO1xuICAgICAgICBmb3IgKDsgaW5kZXggPCBuICYmIGRpc3RCIDwgcmF0aW9EaXN0OyBpbmRleCsrKSB7XG4gICAgICAgICAgICBhID0gYjtcbiAgICAgICAgICAgIGRpc3RBID0gZGlzdEI7XG4gICAgICAgICAgICBiID0gcHRzW2luZGV4XTtcbiAgICAgICAgICAgIGRpc3RCICs9IGEuZGlzdGFuY2VUbyhiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb21wdXRlIHRoZSByYXRpbyByZWxhdGl2ZSB0byB0aGUgc2VnbWVudCBbYWJdXG4gICAgICAgIHZhciBzZWdtZW50UmF0aW8gPSAoKGRpc3RCIC0gZGlzdEEpICE9PSAwKSA/ICgocmF0aW9EaXN0IC0gZGlzdEEpIC8gKGRpc3RCIC0gZGlzdEEpKSA6IDA7XG4gICAgICAgIHZhciBpbnRlcnBvbGF0ZWRQb2ludCA9IEwuR2VvbWV0cnlVdGlsLmludGVycG9sYXRlT25Qb2ludFNlZ21lbnQoYSwgYiwgc2VnbWVudFJhdGlvKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxhdExuZzogbWFwLnVucHJvamVjdChpbnRlcnBvbGF0ZWRQb2ludCwgbWF4em9vbSksXG4gICAgICAgICAgICBwcmVkZWNlc3NvcjogaW5kZXgtMlxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICAgUmV0dXJucyBhIGZsb2F0IGJldHdlZW4gMCBhbmQgMSByZXByZXNlbnRpbmcgdGhlIGxvY2F0aW9uIG9mIHRoZVxuICAgICAgICBjbG9zZXN0IHBvaW50IG9uIHBvbHlsaW5lIHRvIHRoZSBnaXZlbiBsYXRsbmcsIGFzIGEgZnJhY3Rpb24gb2YgdG90YWwgMmQgbGluZSBsZW5ndGguXG4gICAgICAgIChvcHBvc2l0ZSBvZiBMLkdlb21ldHJ5VXRpbC5pbnRlcnBvbGF0ZU9uTGluZSgpKVxuICAgICAgICBAcGFyYW0ge0wuTWFwfSBtYXBcbiAgICAgICAgQHBhcmFtIHtMLlBvbHlMaW5lfSBwb2x5bGluZVxuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdcbiAgICAgICAgQHJldHVybnMge051bWJlcn1cbiAgICAqL1xuICAgIGxvY2F0ZU9uTGluZTogZnVuY3Rpb24gKG1hcCwgcG9seWxpbmUsIGxhdGxuZykge1xuICAgICAgICB2YXIgbGF0bG5ncyA9IHBvbHlsaW5lLmdldExhdExuZ3MoKTtcbiAgICAgICAgaWYgKGxhdGxuZy5lcXVhbHMobGF0bG5nc1swXSkpXG4gICAgICAgICAgICByZXR1cm4gMC4wO1xuICAgICAgICBpZiAobGF0bG5nLmVxdWFscyhsYXRsbmdzW2xhdGxuZ3MubGVuZ3RoLTFdKSlcbiAgICAgICAgICAgIHJldHVybiAxLjA7XG5cbiAgICAgICAgdmFyIHBvaW50ID0gTC5HZW9tZXRyeVV0aWwuY2xvc2VzdChtYXAsIHBvbHlsaW5lLCBsYXRsbmcsIGZhbHNlKSxcbiAgICAgICAgICAgIGxlbmd0aHMgPSBMLkdlb21ldHJ5VXRpbC5hY2N1bXVsYXRlZExlbmd0aHMobGF0bG5ncyksXG4gICAgICAgICAgICB0b3RhbF9sZW5ndGggPSBsZW5ndGhzW2xlbmd0aHMubGVuZ3RoLTFdLFxuICAgICAgICAgICAgcG9ydGlvbiA9IDAsXG4gICAgICAgICAgICBmb3VuZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpPTAsIG4gPSBsYXRsbmdzLmxlbmd0aC0xOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbDEgPSBsYXRsbmdzW2ldLFxuICAgICAgICAgICAgICAgIGwyID0gbGF0bG5nc1tpKzFdO1xuICAgICAgICAgICAgcG9ydGlvbiA9IGxlbmd0aHNbaV07XG4gICAgICAgICAgICBpZiAoTC5HZW9tZXRyeVV0aWwuYmVsb25nc1NlZ21lbnQocG9pbnQsIGwxLCBsMikpIHtcbiAgICAgICAgICAgICAgICBwb3J0aW9uICs9IGwxLmRpc3RhbmNlVG8ocG9pbnQpO1xuICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZvdW5kKSB7XG4gICAgICAgICAgICB0aHJvdyBcIkNvdWxkIG5vdCBpbnRlcnBvbGF0ZSBcIiArIGxhdGxuZy50b1N0cmluZygpICsgXCIgd2l0aGluIFwiICsgcG9seWxpbmUudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcG9ydGlvbiAvIHRvdGFsX2xlbmd0aDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICAgIFJldHVybnMgYSBjbG9uZSB3aXRoIHJldmVyc2VkIGNvb3JkaW5hdGVzLlxuICAgICAgICBAcGFyYW0ge0wuUG9seUxpbmV9IHBvbHlsaW5lXG4gICAgICAgIEByZXR1cm5zIHtMLlBvbHlMaW5lfVxuICAgICovXG4gICAgcmV2ZXJzZTogZnVuY3Rpb24gKHBvbHlsaW5lKSB7XG4gICAgICAgIHJldHVybiBMLnBvbHlsaW5lKHBvbHlsaW5lLmdldExhdExuZ3MoKS5zbGljZSgwKS5yZXZlcnNlKCkpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICAgUmV0dXJucyBhIHN1Yi1wYXJ0IG9mIHRoZSBwb2x5bGluZSwgZnJvbSBzdGFydCB0byBlbmQuXG4gICAgICAgIElmIHN0YXJ0IGlzIHN1cGVyaW9yIHRvIGVuZCwgcmV0dXJucyBleHRyYWN0aW9uIGZyb20gaW52ZXJ0ZWQgbGluZS5cbiAgICAgICAgQHBhcmFtIHtMLk1hcH0gbWFwXG4gICAgICAgIEBwYXJhbSB7TC5Qb2x5TGluZX0gbGF0bG5nc1xuICAgICAgICBAcGFyYW0ge051bWJlcn0gc3RhcnQgcmF0aW8sIGV4cHJlc3NlZCBhcyBhIGRlY2ltYWwgYmV0d2VlbiAwIGFuZCAxLCBpbmNsdXNpdmVcbiAgICAgICAgQHBhcmFtIHtOdW1iZXJ9IGVuZCByYXRpbywgZXhwcmVzc2VkIGFzIGEgZGVjaW1hbCBiZXR3ZWVuIDAgYW5kIDEsIGluY2x1c2l2ZVxuICAgICAgICBAcmV0dXJucyB7QXJyYXk8TC5MYXRMbmc+fVxuICAgICAqL1xuICAgIGV4dHJhY3Q6IGZ1bmN0aW9uIChtYXAsIHBvbHlsaW5lLCBzdGFydCwgZW5kKSB7XG4gICAgICAgIGlmIChzdGFydCA+IGVuZCkge1xuICAgICAgICAgICAgcmV0dXJuIEwuR2VvbWV0cnlVdGlsLmV4dHJhY3QobWFwLCBMLkdlb21ldHJ5VXRpbC5yZXZlcnNlKHBvbHlsaW5lKSwgMS4wLXN0YXJ0LCAxLjAtZW5kKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJvdW5kIHN0YXJ0IGFuZCBlbmQgdG8gWzAtMV1cbiAgICAgICAgc3RhcnQgPSBNYXRoLm1heChNYXRoLm1pbihzdGFydCwgMSksIDApO1xuICAgICAgICBlbmQgPSBNYXRoLm1heChNYXRoLm1pbihlbmQsIDEpLCAwKTtcblxuICAgICAgICB2YXIgbGF0bG5ncyA9IHBvbHlsaW5lLmdldExhdExuZ3MoKSxcbiAgICAgICAgICAgIHN0YXJ0cG9pbnQgPSBMLkdlb21ldHJ5VXRpbC5pbnRlcnBvbGF0ZU9uTGluZShtYXAsIHBvbHlsaW5lLCBzdGFydCksXG4gICAgICAgICAgICBlbmRwb2ludCA9IEwuR2VvbWV0cnlVdGlsLmludGVycG9sYXRlT25MaW5lKG1hcCwgcG9seWxpbmUsIGVuZCk7XG4gICAgICAgIC8vIFJldHVybiBzaW5nbGUgcG9pbnQgaWYgc3RhcnQgPT0gZW5kXG4gICAgICAgIGlmIChzdGFydCA9PSBlbmQpIHtcbiAgICAgICAgICAgIHZhciBwb2ludCA9IEwuR2VvbWV0cnlVdGlsLmludGVycG9sYXRlT25MaW5lKG1hcCwgcG9seWxpbmUsIGVuZCk7XG4gICAgICAgICAgICByZXR1cm4gW3BvaW50LmxhdExuZ107XG4gICAgICAgIH1cbiAgICAgICAgLy8gQXJyYXkuc2xpY2UoKSB3b3JrcyBpbmRleGVzIGF0IDBcbiAgICAgICAgaWYgKHN0YXJ0cG9pbnQucHJlZGVjZXNzb3IgPT0gLTEpXG4gICAgICAgICAgICBzdGFydHBvaW50LnByZWRlY2Vzc29yID0gMDtcbiAgICAgICAgaWYgKGVuZHBvaW50LnByZWRlY2Vzc29yID09IC0xKVxuICAgICAgICAgICAgZW5kcG9pbnQucHJlZGVjZXNzb3IgPSAwO1xuICAgICAgICB2YXIgcmVzdWx0ID0gbGF0bG5ncy5zbGljZShzdGFydHBvaW50LnByZWRlY2Vzc29yKzEsIGVuZHBvaW50LnByZWRlY2Vzc29yKzEpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChzdGFydHBvaW50LmxhdExuZyk7XG4gICAgICAgIHJlc3VsdC5wdXNoKGVuZHBvaW50LmxhdExuZyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgICBSZXR1cm5zIHRydWUgaWYgZmlyc3QgcG9seWxpbmUgZW5kcyB3aGVyZSBvdGhlciBzZWNvbmQgc3RhcnRzLlxuICAgICAgICBAcGFyYW0ge0wuUG9seUxpbmV9IHBvbHlsaW5lXG4gICAgICAgIEBwYXJhbSB7TC5Qb2x5TGluZX0gb3RoZXJcbiAgICAgICAgQHJldHVybnMge2Jvb2x9XG4gICAgKi9cbiAgICBpc0JlZm9yZTogZnVuY3Rpb24gKHBvbHlsaW5lLCBvdGhlcikge1xuICAgICAgICBpZiAoIW90aGVyKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHZhciBsbGEgPSBwb2x5bGluZS5nZXRMYXRMbmdzKCksXG4gICAgICAgICAgICBsbGIgPSBvdGhlci5nZXRMYXRMbmdzKCk7XG4gICAgICAgIHJldHVybiAobGxhW2xsYS5sZW5ndGgtMV0pLmVxdWFscyhsbGJbMF0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICAgUmV0dXJucyB0cnVlIGlmIGZpcnN0IHBvbHlsaW5lIHN0YXJ0cyB3aGVyZSBzZWNvbmQgZW5kcy5cbiAgICAgICAgQHBhcmFtIHtMLlBvbHlMaW5lfSBwb2x5bGluZVxuICAgICAgICBAcGFyYW0ge0wuUG9seUxpbmV9IG90aGVyXG4gICAgICAgIEByZXR1cm5zIHtib29sfVxuICAgICovXG4gICAgaXNBZnRlcjogZnVuY3Rpb24gKHBvbHlsaW5lLCBvdGhlcikge1xuICAgICAgICBpZiAoIW90aGVyKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHZhciBsbGEgPSBwb2x5bGluZS5nZXRMYXRMbmdzKCksXG4gICAgICAgICAgICBsbGIgPSBvdGhlci5nZXRMYXRMbmdzKCk7XG4gICAgICAgIHJldHVybiAobGxhWzBdKS5lcXVhbHMobGxiW2xsYi5sZW5ndGgtMV0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICAgUmV0dXJucyB0cnVlIGlmIGZpcnN0IHBvbHlsaW5lIHN0YXJ0cyB3aGVyZSBzZWNvbmQgZW5kcyBvciBzdGFydC5cbiAgICAgICAgQHBhcmFtIHtMLlBvbHlMaW5lfSBwb2x5bGluZVxuICAgICAgICBAcGFyYW0ge0wuUG9seUxpbmV9IG90aGVyXG4gICAgICAgIEByZXR1cm5zIHtib29sfVxuICAgICovXG4gICAgc3RhcnRzQXRFeHRyZW1pdHk6IGZ1bmN0aW9uIChwb2x5bGluZSwgb3RoZXIpIHtcbiAgICAgICAgaWYgKCFvdGhlcikgcmV0dXJuIGZhbHNlO1xuICAgICAgICB2YXIgbGxhID0gcG9seWxpbmUuZ2V0TGF0TG5ncygpLFxuICAgICAgICAgICAgbGxiID0gb3RoZXIuZ2V0TGF0TG5ncygpLFxuICAgICAgICAgICAgc3RhcnQgPSBsbGFbMF07XG4gICAgICAgIHJldHVybiBzdGFydC5lcXVhbHMobGxiWzBdKSB8fCBzdGFydC5lcXVhbHMobGxiW2xsYi5sZW5ndGgtMV0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICAgUmV0dXJucyBob3Jpem9udGFsIGFuZ2xlIGluIGRlZ3JlcyBiZXR3ZWVuIHR3byBwb2ludHMuXG4gICAgICAgIEBwYXJhbSB7TC5Qb2ludH0gYVxuICAgICAgICBAcGFyYW0ge0wuUG9pbnR9IGJcbiAgICAgICAgQHJldHVybnMge2Zsb2F0fVxuICAgICAqL1xuICAgIGNvbXB1dGVBbmdsZTogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICByZXR1cm4gKE1hdGguYXRhbjIoYi55IC0gYS55LCBiLnggLSBhLngpICogMTgwIC8gTWF0aC5QSSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgIFJldHVybnMgc2xvcGUgKEF4K0IpIGJldHdlZW4gdHdvIHBvaW50cy5cbiAgICAgICAgQHBhcmFtIHtMLlBvaW50fSBhXG4gICAgICAgIEBwYXJhbSB7TC5Qb2ludH0gYlxuICAgICAgICBAcmV0dXJucyB7T2JqZWN0fSB3aXRoIGBgYWBgIGFuZCBgYGJgYCBwcm9wZXJ0aWVzLlxuICAgICAqL1xuICAgIGNvbXB1dGVTbG9wZTogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICB2YXIgcyA9IChiLnkgLSBhLnkpIC8gKGIueCAtIGEueCksXG4gICAgICAgICAgICBvID0gYS55IC0gKHMgKiBhLngpO1xuICAgICAgICByZXR1cm4geydhJzogcywgJ2InOiBvfTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICAgUmV0dXJucyBMYXRMbmcgb2Ygcm90YXRlZCBwb2ludCBhcm91bmQgc3BlY2lmaWVkIExhdExuZyBjZW50ZXIuXG4gICAgICAgIEBwYXJhbSB7TC5MYXRMbmd9IGxhdGxuZ1BvaW50OiBwb2ludCB0byByb3RhdGVcbiAgICAgICAgQHBhcmFtIHtkb3VibGV9IGFuZ2xlRGVnOiBhbmdsZSB0byByb3RhdGUgaW4gZGVncmVlc1xuICAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmdDZW50ZXI6IGNlbnRlciBvZiByb3RhdGlvblxuICAgICAgICBAcmV0dXJucyB7TC5MYXRMbmd9IHJvdGF0ZWQgcG9pbnRcbiAgICAgKi9cbiAgICByb3RhdGVQb2ludDogZnVuY3Rpb24obWFwLCBsYXRsbmdQb2ludCwgYW5nbGVEZWcsIGxhdGxuZ0NlbnRlcikge1xuICAgICAgICB2YXIgbWF4em9vbSA9IG1hcC5nZXRNYXhab29tKCk7XG4gICAgICAgIGlmIChtYXh6b29tID09PSBJbmZpbml0eSlcbiAgICAgICAgICAgIG1heHpvb20gPSBtYXAuZ2V0Wm9vbSgpO1xuICAgICAgICB2YXIgYW5nbGVSYWQgPSBhbmdsZURlZypNYXRoLlBJLzE4MCxcbiAgICAgICAgICAgIHBQb2ludCA9IG1hcC5wcm9qZWN0KGxhdGxuZ1BvaW50LCBtYXh6b29tKSxcbiAgICAgICAgICAgIHBDZW50ZXIgPSBtYXAucHJvamVjdChsYXRsbmdDZW50ZXIsIG1heHpvb20pLFxuICAgICAgICAgICAgeDIgPSBNYXRoLmNvcyhhbmdsZVJhZCkqKHBQb2ludC54LXBDZW50ZXIueCkgLSBNYXRoLnNpbihhbmdsZVJhZCkqKHBQb2ludC55LXBDZW50ZXIueSkgKyBwQ2VudGVyLngsXG4gICAgICAgICAgICB5MiA9IE1hdGguc2luKGFuZ2xlUmFkKSoocFBvaW50LngtcENlbnRlci54KSArIE1hdGguY29zKGFuZ2xlUmFkKSoocFBvaW50LnktcENlbnRlci55KSArIHBDZW50ZXIueTtcbiAgICAgICAgcmV0dXJuIG1hcC51bnByb2plY3QobmV3IEwuUG9pbnQoeDIseTIpLCBtYXh6b29tKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICAgUmV0dXJucyB0aGUgYmVhcmluZyBpbiBkZWdyZWVzIGNsb2Nrd2lzZSBmcm9tIG5vcnRoICgwIGRlZ3JlZXMpXG4gICAgICAgZnJvbSB0aGUgZmlyc3QgTC5MYXRMbmcgdG8gdGhlIHNlY29uZCwgYXQgdGhlIGZpcnN0IExhdExuZyBcbiAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmcxOiBvcmlnaW4gcG9pbnQgb2YgdGhlIGJlYXJpbmdcbiAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmcyOiBkZXN0aW5hdGlvbiBwb2ludCBvZiB0aGUgYmVhcmluZ1xuICAgICAgIEByZXR1cm5zIHtmbG9hdH0gZGVncmVlcyBjbG9ja3dpc2UgZnJvbSBub3J0aC5cbiAgICAqL1xuICAgIGJlYXJpbmc6IGZ1bmN0aW9uKGxhdGxuZzEsIGxhdGxuZzIpIHtcbiAgICAgICAgdmFyIHJhZCA9IE1hdGguUEkgLyAxODAsXG4gICAgICAgICAgICBsYXQxID0gbGF0bG5nMS5sYXQgKiByYWQsXG4gICAgICAgICAgICBsYXQyID0gbGF0bG5nMi5sYXQgKiByYWQsXG4gICAgICAgICAgICBsb24xID0gbGF0bG5nMS5sbmcgKiByYWQsXG4gICAgICAgICAgICBsb24yID0gbGF0bG5nMi5sbmcgKiByYWQsXG4gICAgICAgICAgICB5ID0gTWF0aC5zaW4obG9uMiAtIGxvbjEpICogTWF0aC5jb3MobGF0MiksXG4gICAgICAgICAgICB4ID0gTWF0aC5jb3MobGF0MSkgKiBNYXRoLnNpbihsYXQyKSAtXG4gICAgICAgICAgICAgICAgTWF0aC5zaW4obGF0MSkgKiBNYXRoLmNvcyhsYXQyKSAqIE1hdGguY29zKGxvbjIgLSBsb24xKTtcblxuICAgICAgICB2YXIgYmVhcmluZyA9ICgoTWF0aC5hdGFuMih5LCB4KSAqIDE4MCAvIE1hdGguUEkpICsgMzYwKSAlIDM2MDtcbiAgICAgICAgcmV0dXJuIGJlYXJpbmcgPj0gMTgwID8gYmVhcmluZy0zNjAgOiBiZWFyaW5nO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICBSZXR1cm5zIHRoZSBwb2ludCB0aGF0IGlzIGEgZGlzdGFuY2UgYW5kIGhlYWRpbmcgYXdheSBmcm9tXG4gICAgICAgdGhlIGdpdmVuIG9yaWdpbiBwb2ludC5cbiAgICAgICBAcGFyYW0ge0wuTGF0TG5nfSBsYXRsbmc6IG9yaWdpbiBwb2ludFxuICAgICAgIEBwYXJhbSB7ZmxvYXR9OiBoZWFkaW5nIGluIGRlZ3JlZXMsIGNsb2Nrd2lzZSBmcm9tIDAgZGVncmVlcyBub3J0aC5cbiAgICAgICBAcGFyYW0ge2Zsb2F0fTogZGlzdGFuY2UgaW4gbWV0ZXJzXG4gICAgICAgQHJldHVybnMge0wubGF0TG5nfSB0aGUgZGVzdGluYXRpb24gcG9pbnQuXG4gICAgICAgTWFueSB0aGFua3MgdG8gQ2hyaXMgVmVuZXNzIGF0IGh0dHA6Ly93d3cubW92YWJsZS10eXBlLmNvLnVrL3NjcmlwdHMvbGF0bG9uZy5odG1sXG4gICAgICAgZm9yIGEgZ3JlYXQgcmVmZXJlbmNlIGFuZCBleGFtcGxlcy5cbiAgICAqL1xuICAgIGRlc3RpbmF0aW9uOiBmdW5jdGlvbihsYXRsbmcsIGhlYWRpbmcsIGRpc3RhbmNlKSB7XG4gICAgICAgIGhlYWRpbmcgPSAoaGVhZGluZyArIDM2MCkgJSAzNjA7XG4gICAgICAgIHZhciByYWQgPSBNYXRoLlBJIC8gMTgwLFxuICAgICAgICAgICAgcmFkSW52ID0gMTgwIC8gTWF0aC5QSSxcbiAgICAgICAgICAgIFIgPSA2Mzc4MTM3LCAvLyBhcHByb3hpbWF0aW9uIG9mIEVhcnRoJ3MgcmFkaXVzXG4gICAgICAgICAgICBsb24xID0gbGF0bG5nLmxuZyAqIHJhZCxcbiAgICAgICAgICAgIGxhdDEgPSBsYXRsbmcubGF0ICogcmFkLFxuICAgICAgICAgICAgcmhlYWRpbmcgPSBoZWFkaW5nICogcmFkLFxuICAgICAgICAgICAgc2luTGF0MSA9IE1hdGguc2luKGxhdDEpLFxuICAgICAgICAgICAgY29zTGF0MSA9IE1hdGguY29zKGxhdDEpLFxuICAgICAgICAgICAgY29zRGlzdFIgPSBNYXRoLmNvcyhkaXN0YW5jZSAvIFIpLFxuICAgICAgICAgICAgc2luRGlzdFIgPSBNYXRoLnNpbihkaXN0YW5jZSAvIFIpLFxuICAgICAgICAgICAgbGF0MiA9IE1hdGguYXNpbihzaW5MYXQxICogY29zRGlzdFIgKyBjb3NMYXQxICpcbiAgICAgICAgICAgICAgICBzaW5EaXN0UiAqIE1hdGguY29zKHJoZWFkaW5nKSksXG4gICAgICAgICAgICBsb24yID0gbG9uMSArIE1hdGguYXRhbjIoTWF0aC5zaW4ocmhlYWRpbmcpICogc2luRGlzdFIgKlxuICAgICAgICAgICAgICAgIGNvc0xhdDEsIGNvc0Rpc3RSIC0gc2luTGF0MSAqIE1hdGguc2luKGxhdDIpKTtcbiAgICAgICAgbG9uMiA9IGxvbjIgKiByYWRJbnY7XG4gICAgICAgIGxvbjIgPSBsb24yID4gMTgwID8gbG9uMiAtIDM2MCA6IGxvbjIgPCAtMTgwID8gbG9uMiArIDM2MCA6IGxvbjI7XG4gICAgICAgIHJldHVybiBMLmxhdExuZyhbbGF0MiAqIHJhZEludiwgbG9uMl0pO1xuICAgIH1cbn0pO1xuXG5yZXR1cm4gTC5HZW9tZXRyeVV0aWw7XG5cbn0pKTtcbiIsIihmdW5jdGlvbih3aW5kb3cpIHtcblx0dmFyIEhBU19IQVNIQ0hBTkdFID0gKGZ1bmN0aW9uKCkge1xuXHRcdHZhciBkb2NfbW9kZSA9IHdpbmRvdy5kb2N1bWVudE1vZGU7XG5cdFx0cmV0dXJuICgnb25oYXNoY2hhbmdlJyBpbiB3aW5kb3cpICYmXG5cdFx0XHQoZG9jX21vZGUgPT09IHVuZGVmaW5lZCB8fCBkb2NfbW9kZSA+IDcpO1xuXHR9KSgpO1xuXG5cdEwuSGFzaCA9IGZ1bmN0aW9uKG1hcCkge1xuXHRcdHRoaXMub25IYXNoQ2hhbmdlID0gTC5VdGlsLmJpbmQodGhpcy5vbkhhc2hDaGFuZ2UsIHRoaXMpO1xuXG5cdFx0aWYgKG1hcCkge1xuXHRcdFx0dGhpcy5pbml0KG1hcCk7XG5cdFx0fVxuXHR9O1xuXG5cdEwuSGFzaC5wYXJzZUhhc2ggPSBmdW5jdGlvbihoYXNoKSB7XG5cdFx0aWYoaGFzaC5pbmRleE9mKCcjJykgPT09IDApIHtcblx0XHRcdGhhc2ggPSBoYXNoLnN1YnN0cigxKTtcblx0XHR9XG5cdFx0dmFyIGFyZ3MgPSBoYXNoLnNwbGl0KFwiL1wiKTtcblx0XHRpZiAoYXJncy5sZW5ndGggPT0gMykge1xuXHRcdFx0dmFyIHpvb20gPSBwYXJzZUludChhcmdzWzBdLCAxMCksXG5cdFx0XHRsYXQgPSBwYXJzZUZsb2F0KGFyZ3NbMV0pLFxuXHRcdFx0bG9uID0gcGFyc2VGbG9hdChhcmdzWzJdKTtcblx0XHRcdGlmIChpc05hTih6b29tKSB8fCBpc05hTihsYXQpIHx8IGlzTmFOKGxvbikpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRjZW50ZXI6IG5ldyBMLkxhdExuZyhsYXQsIGxvbiksXG5cdFx0XHRcdFx0em9vbTogem9vbVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9O1xuXG5cdEwuSGFzaC5mb3JtYXRIYXNoID0gZnVuY3Rpb24obWFwKSB7XG5cdFx0dmFyIGNlbnRlciA9IG1hcC5nZXRDZW50ZXIoKSxcblx0XHQgICAgem9vbSA9IG1hcC5nZXRab29tKCksXG5cdFx0ICAgIHByZWNpc2lvbiA9IE1hdGgubWF4KDAsIE1hdGguY2VpbChNYXRoLmxvZyh6b29tKSAvIE1hdGguTE4yKSk7XG5cblx0XHRyZXR1cm4gXCIjXCIgKyBbem9vbSxcblx0XHRcdGNlbnRlci5sYXQudG9GaXhlZChwcmVjaXNpb24pLFxuXHRcdFx0Y2VudGVyLmxuZy50b0ZpeGVkKHByZWNpc2lvbilcblx0XHRdLmpvaW4oXCIvXCIpO1xuXHR9LFxuXG5cdEwuSGFzaC5wcm90b3R5cGUgPSB7XG5cdFx0bWFwOiBudWxsLFxuXHRcdGxhc3RIYXNoOiBudWxsLFxuXG5cdFx0cGFyc2VIYXNoOiBMLkhhc2gucGFyc2VIYXNoLFxuXHRcdGZvcm1hdEhhc2g6IEwuSGFzaC5mb3JtYXRIYXNoLFxuXG5cdFx0aW5pdDogZnVuY3Rpb24obWFwKSB7XG5cdFx0XHR0aGlzLm1hcCA9IG1hcDtcblxuXHRcdFx0Ly8gcmVzZXQgdGhlIGhhc2hcblx0XHRcdHRoaXMubGFzdEhhc2ggPSBudWxsO1xuXHRcdFx0dGhpcy5vbkhhc2hDaGFuZ2UoKTtcblxuXHRcdFx0aWYgKCF0aGlzLmlzTGlzdGVuaW5nKSB7XG5cdFx0XHRcdHRoaXMuc3RhcnRMaXN0ZW5pbmcoKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0cmVtb3ZlRnJvbTogZnVuY3Rpb24obWFwKSB7XG5cdFx0XHRpZiAodGhpcy5jaGFuZ2VUaW1lb3V0KSB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLmNoYW5nZVRpbWVvdXQpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGhpcy5pc0xpc3RlbmluZykge1xuXHRcdFx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcoKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5tYXAgPSBudWxsO1xuXHRcdH0sXG5cblx0XHRvbk1hcE1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gYmFpbCBpZiB3ZSdyZSBtb3ZpbmcgdGhlIG1hcCAodXBkYXRpbmcgZnJvbSBhIGhhc2gpLFxuXHRcdFx0Ly8gb3IgaWYgdGhlIG1hcCBpcyBub3QgeWV0IGxvYWRlZFxuXG5cdFx0XHRpZiAodGhpcy5tb3ZpbmdNYXAgfHwgIXRoaXMubWFwLl9sb2FkZWQpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgaGFzaCA9IHRoaXMuZm9ybWF0SGFzaCh0aGlzLm1hcCk7XG5cdFx0XHRpZiAodGhpcy5sYXN0SGFzaCAhPSBoYXNoKSB7XG5cdFx0XHRcdGxvY2F0aW9uLnJlcGxhY2UoaGFzaCk7XG5cdFx0XHRcdHRoaXMubGFzdEhhc2ggPSBoYXNoO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRtb3ZpbmdNYXA6IGZhbHNlLFxuXHRcdHVwZGF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaGFzaCA9IGxvY2F0aW9uLmhhc2g7XG5cdFx0XHRpZiAoaGFzaCA9PT0gdGhpcy5sYXN0SGFzaCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR2YXIgcGFyc2VkID0gdGhpcy5wYXJzZUhhc2goaGFzaCk7XG5cdFx0XHRpZiAocGFyc2VkKSB7XG5cdFx0XHRcdHRoaXMubW92aW5nTWFwID0gdHJ1ZTtcblxuXHRcdFx0XHR0aGlzLm1hcC5zZXRWaWV3KHBhcnNlZC5jZW50ZXIsIHBhcnNlZC56b29tKTtcblxuXHRcdFx0XHR0aGlzLm1vdmluZ01hcCA9IGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5vbk1hcE1vdmUodGhpcy5tYXApO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHQvLyBkZWZlciBoYXNoIGNoYW5nZSB1cGRhdGVzIGV2ZXJ5IDEwMG1zXG5cdFx0Y2hhbmdlRGVmZXI6IDEwMCxcblx0XHRjaGFuZ2VUaW1lb3V0OiBudWxsLFxuXHRcdG9uSGFzaENoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyB0aHJvdHRsZSBjYWxscyB0byB1cGRhdGUoKSBzbyB0aGF0IHRoZXkgb25seSBoYXBwZW4gZXZlcnlcblx0XHRcdC8vIGBjaGFuZ2VEZWZlcmAgbXNcblx0XHRcdGlmICghdGhpcy5jaGFuZ2VUaW1lb3V0KSB7XG5cdFx0XHRcdHZhciB0aGF0ID0gdGhpcztcblx0XHRcdFx0dGhpcy5jaGFuZ2VUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR0aGF0LnVwZGF0ZSgpO1xuXHRcdFx0XHRcdHRoYXQuY2hhbmdlVGltZW91dCA9IG51bGw7XG5cdFx0XHRcdH0sIHRoaXMuY2hhbmdlRGVmZXIpO1xuXHRcdFx0fVxuXHRcdH0sXG5cblx0XHRpc0xpc3RlbmluZzogZmFsc2UsXG5cdFx0aGFzaENoYW5nZUludGVydmFsOiBudWxsLFxuXHRcdHN0YXJ0TGlzdGVuaW5nOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMubWFwLm9uKFwibW92ZWVuZFwiLCB0aGlzLm9uTWFwTW92ZSwgdGhpcyk7XG5cblx0XHRcdGlmIChIQVNfSEFTSENIQU5HRSkge1xuXHRcdFx0XHRMLkRvbUV2ZW50LmFkZExpc3RlbmVyKHdpbmRvdywgXCJoYXNoY2hhbmdlXCIsIHRoaXMub25IYXNoQ2hhbmdlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNsZWFySW50ZXJ2YWwodGhpcy5oYXNoQ2hhbmdlSW50ZXJ2YWwpO1xuXHRcdFx0XHR0aGlzLmhhc2hDaGFuZ2VJbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMub25IYXNoQ2hhbmdlLCA1MCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmlzTGlzdGVuaW5nID0gdHJ1ZTtcblx0XHR9LFxuXG5cdFx0c3RvcExpc3RlbmluZzogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLm1hcC5vZmYoXCJtb3ZlZW5kXCIsIHRoaXMub25NYXBNb3ZlLCB0aGlzKTtcblxuXHRcdFx0aWYgKEhBU19IQVNIQ0hBTkdFKSB7XG5cdFx0XHRcdEwuRG9tRXZlbnQucmVtb3ZlTGlzdGVuZXIod2luZG93LCBcImhhc2hjaGFuZ2VcIiwgdGhpcy5vbkhhc2hDaGFuZ2UpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbCh0aGlzLmhhc2hDaGFuZ2VJbnRlcnZhbCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmlzTGlzdGVuaW5nID0gZmFsc2U7XG5cdFx0fVxuXHR9O1xuXHRMLmhhc2ggPSBmdW5jdGlvbihtYXApIHtcblx0XHRyZXR1cm4gbmV3IEwuSGFzaChtYXApO1xuXHR9O1xuXHRMLk1hcC5wcm90b3R5cGUuYWRkSGFzaCA9IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX2hhc2ggPSBMLmhhc2godGhpcyk7XG5cdH07XG5cdEwuTWFwLnByb3RvdHlwZS5yZW1vdmVIYXNoID0gZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faGFzaC5yZW1vdmVGcm9tKCk7XG5cdH07XG59KSh3aW5kb3cpO1xuIiwidmFyIHNwaGVyZUtubiA9IHJlcXVpcmUoJ3NwaGVyZS1rbm4nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihsYXllcikge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGlmICghKGxheWVyIGluc3RhbmNlb2YgTC5HZW9KU09OKSkgdGhyb3cgbmV3IEVycm9yKCdtdXN0IGJlIEwuR2VvSlNPTicpO1xuXG4gICAgdmFyIHBvaW50cyA9IFtdO1xuXG4gICAgbGF5ZXIuZWFjaExheWVyKGNvbGxlY3RQb2ludHMpO1xuXG4gICAgZnVuY3Rpb24gY29sbGVjdFBvaW50cyhsKSB7XG4gICAgICAgIHBvaW50cyA9IHBvaW50cy5jb25jYXQocmVmb3JtYXQoZmxhdChsLmZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpLCBsKSk7XG4gICAgfVxuXG4gICAgdmFyIHNrbm4gPSBzcGhlcmVLbm4ocG9pbnRzKTtcblxuICAgIHNrbm4ubmVhcmVzdCA9IGZ1bmN0aW9uKHAsIG4sIG1heF9kaXN0YW5jZSkge1xuICAgICAgICBpZiAocCBpbnN0YW5jZW9mIEwuTGF0TG5nKSBwID0gW3AubG5nLCBwLmxhdF07XG4gICAgICAgIHJldHVybiBza25uKHBbMV0sIHBbMF0sIG4sIG1heF9kaXN0YW5jZSk7XG4gICAgfTtcblxuICAgIHNrbm4ubmVhcmVzdExheWVyID0gZnVuY3Rpb24ocCwgbiwgbWF4X2Rpc3RhbmNlKSB7XG4gICAgICAgIGlmIChwIGluc3RhbmNlb2YgTC5MYXRMbmcpIHAgPSBbcC5sbmcsIHAubGF0XTtcbiAgICAgICAgcmV0dXJuIGNvbGxhcHNlKHNrbm4ocFsxXSwgcFswXSwgbiwgbWF4X2Rpc3RhbmNlKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBza25uO1xufTtcblxuZnVuY3Rpb24gY29sbGFwc2UocmVzdWx0cykge1xuICAgIHZhciBsID0gW10sIGluY2x1ZGVkID0ge307XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpbmNsdWRlZFtMLnN0YW1wKHJlc3VsdHNbaV0ubGF5ZXIpXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGwucHVzaChyZXN1bHRzW2ldKTtcbiAgICAgICAgICAgIGluY2x1ZGVkW0wuc3RhbXAocmVzdWx0c1tpXS5sYXllcildID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbDtcbn1cblxuZnVuY3Rpb24gcmVmb3JtYXQoY29vcmRzLCBsYXllcikge1xuICAgIHZhciBsID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbC5wdXNoKHsgbG9uOiBjb29yZHNbaV1bMF0sIGxhdDogY29vcmRzW2ldWzFdLCBsYXllcjogbGF5ZXIgfSk7XG4gICAgfVxuICAgIHJldHVybiBsO1xufVxuXG5mdW5jdGlvbiBmbGF0KGNvb3Jkcykge1xuICAgIHZhciBpID0gMCwgaiA9IDAsIGsgPSAwLCBsID0gW107XG4gICAgaWYgKHR5cGVvZiBjb29yZHNbMF0gPT09ICdvYmplY3QnICYmXG4gICAgICAgIHR5cGVvZiBjb29yZHNbMF1bMF0gPT09ICdvYmplY3QnICYmXG4gICAgICAgIHR5cGVvZiBjb29yZHNbMF1bMF1bMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAoO2kgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoO2ogPCBjb29yZHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKDtrIDwgY29vcmRzW2ldW2pdLmxlbmd0aDsgaysrKSBsLnB1c2goY29vcmRzW2ldW2pdW2tdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb29yZHNbMF0gPT09ICdvYmplY3QnICYmXG4gICAgICAgIHR5cGVvZiBjb29yZHNbMF1bMF0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAoO2kgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoO2ogPCBjb29yZHNbaV0ubGVuZ3RoOyBqKyspIGwucHVzaChjb29yZHNbaV1bal0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvb3Jkc1swXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgcmV0dXJuIGNvb3JkcztcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gW2Nvb3Jkc107XG4gICAgfVxufVxuIiwidmFyIHNwaGVyZWtkID0gcmVxdWlyZShcIi4vbGliL3NwaGVyZWtkXCIpXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnRzKSB7XG4gIC8qIEluZmxhdGUgdGhlIHRvYWQhICovXG4gIHZhciByb290ID0gc3BoZXJla2QuYnVpbGQocG9pbnRzKVxuXG4gIC8qIEx1cmNoIG9mZiBpbnRvIHRoZSBzdW5zZXQhICovXG4gIHJldHVybiBmdW5jdGlvbihsYXQsIGxvbiwgbiwgbWF4KSB7XG4gICAgcmV0dXJuIHNwaGVyZWtkLmxvb2t1cChsYXQsIGxvbiwgcm9vdCwgbiwgbWF4KVxuICB9XG59XG4iLCJmdW5jdGlvbiBkZWZhdWx0Q29tcGFyYXRvcihhLCBiKSB7XG4gIHJldHVybiBhIC0gYlxufVxuXG5leHBvcnRzLnNlYXJjaCA9IGZ1bmN0aW9uKGl0ZW0sIGFycmF5LCBjb21wYXJhdG9yKSB7XG4gIGlmKCFjb21wYXJhdG9yKVxuICAgIGNvbXBhcmF0b3IgPSBkZWZhdWx0Q29tcGFyYXRvclxuXG4gIHZhciBsb3cgID0gMCxcbiAgICAgIGhpZ2ggPSBhcnJheS5sZW5ndGggLSAxLFxuICAgICAgbWlkLCBjb21wXG5cbiAgd2hpbGUobG93IDw9IGhpZ2gpIHtcbiAgICBtaWQgID0gKGxvdyArIGhpZ2gpID4+PiAxXG4gICAgY29tcCA9IGNvbXBhcmF0b3IoYXJyYXlbbWlkXSwgaXRlbSlcblxuICAgIGlmKGNvbXAgPCAwKVxuICAgICAgbG93ID0gbWlkICsgMVxuXG4gICAgZWxzZSBpZihjb21wID4gMClcbiAgICAgIGhpZ2ggPSBtaWQgLSAxXG5cbiAgICBlbHNlXG4gICAgICByZXR1cm4gbWlkXG4gIH1cblxuICByZXR1cm4gLShsb3cgKyAxKVxufVxuXG5leHBvcnRzLmluc2VydCA9IGZ1bmN0aW9uKGl0ZW0sIGFycmF5LCBjb21wYXJhdG9yKSB7XG4gIHZhciBpID0gZXhwb3J0cy5zZWFyY2goaXRlbSwgYXJyYXksIGNvbXBhcmF0b3IpXG5cbiAgaWYoaSA8IDApXG4gICAgaSA9IC0oaSArIDEpXG5cbiAgYXJyYXkuc3BsaWNlKGksIDAsIGl0ZW0pXG59XG4iLCJ2YXIgYmluYXJ5ID0gcmVxdWlyZShcIi4vYmluYXJ5XCIpXG5cbmZ1bmN0aW9uIE5vZGUoYXhpcywgc3BsaXQsIGxlZnQsIHJpZ2h0KSB7XG4gIHRoaXMuYXhpcyAgPSBheGlzXG4gIHRoaXMuc3BsaXQgPSBzcGxpdFxuICB0aGlzLmxlZnQgID0gbGVmdFxuICB0aGlzLnJpZ2h0ID0gcmlnaHRcbn1cblxuZnVuY3Rpb24gZGlzdGFuY2UoYSwgYikge1xuICB2YXIgaSA9IE1hdGgubWluKGEubGVuZ3RoLCBiLmxlbmd0aCksXG4gICAgICBkID0gMCxcbiAgICAgIGtcblxuICB3aGlsZShpLS0pIHtcbiAgICBrICA9IGJbaV0gLSBhW2ldXG4gICAgZCArPSBrICoga1xuICB9XG5cbiAgcmV0dXJuIGRcbn1cblxuZnVuY3Rpb24gYnlEaXN0YW5jZShhLCBiKSB7XG4gIHJldHVybiBhLmRpc3QgLSBiLmRpc3Rcbn1cblxuZnVuY3Rpb24gYnVpbGRyZWMoYXJyYXksIGRlcHRoKSB7XG4gIC8qIFRoaXMgc2hvdWxkIG9ubHkgaGFwcGVuIGlmIHlvdSByZXF1ZXN0IGEga2QtdHJlZSB3aXRoIHplcm8gZWxlbWVudHMuICovXG4gIGlmKGFycmF5Lmxlbmd0aCA9PT0gMClcbiAgICByZXR1cm4gbnVsbFxuXG4gIC8qIElmIHRoZXJlJ3Mgb25seSBvbmUgaXRlbSwgdGhlbiBpdCdzIGEgbGVhZiBub2RlISAqL1xuICBpZihhcnJheS5sZW5ndGggPT09IDEpXG4gICAgcmV0dXJuIGFycmF5WzBdXG5cbiAgLyogVWggb2guIFdlbGwsIHdlIGhhdmUgdG8gcGFydGl0aW9uIHRoZSBkYXRhIHNldCBhbmQgcmVjdXJzZS4gU3RhcnQgYnlcbiAgICogZmluZGluZyB0aGUgYm91bmRpbmcgYm94IG9mIHRoZSBnaXZlbiBwb2ludHM7IHdoaWNoZXZlciBzaWRlIGlzIHRoZVxuICAgKiBsb25nZXN0IGlzIHRoZSBvbmUgd2UnbGwgdXNlIGZvciB0aGUgc3BsaXR0aW5nIHBsYW5lLiAqL1xuICB2YXIgYXhpcyA9IGRlcHRoICUgYXJyYXlbMF0ucG9zaXRpb24ubGVuZ3RoXG5cbiAgLyogU29ydCB0aGUgcG9pbnRzIGFsb25nIHRoZSBzcGxpdHRpbmcgcGxhbmUuICovXG4gIC8qIEZJWE1FOiBGb3IgdmVyeSBsYXJnZSB0cmVlcywgaXQgd291bGQgYmUgZmFzdGVyIHRvIHVzZSBzb21lIHNvcnQgb2YgbWVkaWFuXG4gICAqIGZpbmRpbmcgYW5kIHBhcnRpdGlvbmluZyBhbGdvcml0aG0uIEl0J2QgYWxzbyBiZSBhIGxvdCBtb3JlIGNvbXBsaWNhdGVkLiAqL1xuICBhcnJheS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gYS5wb3NpdGlvbltheGlzXSAtIGIucG9zaXRpb25bYXhpc11cbiAgfSlcblxuICAvKiBGaW5kIHRoZSBtZWRpYW4gcG9pbnQuIEl0J3MgcG9zaXRpb24gaXMgZ29pbmcgdG8gYmUgdGhlIGxvY2F0aW9uIG9mIHRoZVxuICAgKiBzcGxpdHRpbmcgcGxhbmUuICovXG4gIHZhciBpID0gTWF0aC5mbG9vcihhcnJheS5sZW5ndGggKiAwLjUpXG5cbiAgLyogU3BsaXQsIHJlY3Vyc2UsIHlhZGRhIHlhZGRhLiAqL1xuICArK2RlcHRoXG5cbiAgcmV0dXJuIG5ldyBOb2RlKFxuICAgIGF4aXMsXG4gICAgYXJyYXlbaV0ucG9zaXRpb25bYXhpc10sXG4gICAgYnVpbGRyZWMoYXJyYXkuc2xpY2UoMCwgaSksIGRlcHRoKSxcbiAgICBidWlsZHJlYyhhcnJheS5zbGljZShpICAgKSwgZGVwdGgpXG4gIClcbn1cblxuZnVuY3Rpb24gYnVpbGQoYXJyYXkpIHtcbiAgcmV0dXJuIGJ1aWxkcmVjKGFycmF5LCAwKVxufVxuXG5mdW5jdGlvbiBsb29rdXAocG9zaXRpb24sIG5vZGUsIG4sIG1heCkge1xuICBpZighKG1heCA+IDApKVxuICAgIG1heCA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWVxuXG4gIHZhciBhcnJheSA9IFtdXG5cbiAgLyogRGVnZW5lcmF0ZSBjYXNlcy4gKi9cbiAgaWYobm9kZSA9PT0gbnVsbCB8fCBuIDw9IDApXG4gICAgcmV0dXJuIGFycmF5XG5cbiAgdmFyIHN0YWNrID0gW25vZGUsIDBdLFxuICAgICAgZGlzdCwgaVxuXG4gIHdoaWxlKHN0YWNrLmxlbmd0aCkge1xuICAgIGRpc3QgPSBzdGFjay5wb3AoKVxuICAgIG5vZGUgPSBzdGFjay5wb3AoKVxuXG4gICAgLyogSWYgdGhpcyBzdWJ0cmVlIGlzIGZ1cnRoZXIgYXdheSB0aGFuIHdlIGNhcmUgYWJvdXQsIHRoZW4gc2tpcCBpdC4gKi9cbiAgICBpZihkaXN0ID4gbWF4KVxuICAgICAgY29udGludWVcblxuICAgIC8qIElmIHdlJ3ZlIGFscmVhZHkgZm91bmQgZW5vdWdoIGxvY2F0aW9ucywgYW5kIHRoZSBmdXJ0aGVzdCBvbmUgaXMgY2xvc2VyXG4gICAgICogdGhhbiB0aGlzIHN1YnRyZWUgcG9zc2libHkgY291bGQgYmUsIGp1c3Qgc2tpcCB0aGUgc3VidHJlZS4gKi9cbiAgICBpZihhcnJheS5sZW5ndGggPT09IG4gJiYgYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV0uZGlzdCA8IGRpc3QgKiBkaXN0KVxuICAgICAgY29udGludWVcblxuICAgIC8qIEl0ZXJhdGUgYWxsIHRoZSB3YXkgZG93biB0aGUgdHJlZSwgYWRkaW5nIG5vZGVzIHRoYXQgd2UgbmVlZCB0byByZW1lbWJlclxuICAgICAqIHRvIHZpc2l0IGxhdGVyIG9udG8gdGhlIHN0YWNrLiAqL1xuICAgIHdoaWxlKG5vZGUgaW5zdGFuY2VvZiBOb2RlKSB7XG4gICAgICBpZihwb3NpdGlvbltub2RlLmF4aXNdIDwgbm9kZS5zcGxpdCkge1xuICAgICAgICBzdGFjay5wdXNoKG5vZGUucmlnaHQsIG5vZGUuc3BsaXQgLSBwb3NpdGlvbltub2RlLmF4aXNdKVxuICAgICAgICBub2RlID0gbm9kZS5sZWZ0XG4gICAgICB9XG5cbiAgICAgIGVsc2Uge1xuICAgICAgICBzdGFjay5wdXNoKG5vZGUubGVmdCwgcG9zaXRpb25bbm9kZS5heGlzXSAtIG5vZGUuc3BsaXQpXG4gICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyogT25jZSB3ZSd2ZSBoaXQgYSBsZWFmIG5vZGUsIGluc2VydCBpdCBpbnRvIHRoZSBhcnJheSBvZiBjYW5kaWRhdGVzLFxuICAgICAqIG1ha2luZyBzdXJlIHRvIGtlZXAgdGhlIGFycmF5IGluIHNvcnRlZCBvcmRlci4gKi9cbiAgICBkaXN0ID0gZGlzdGFuY2UocG9zaXRpb24sIG5vZGUucG9zaXRpb24pXG4gICAgaWYoZGlzdCA8PSBtYXggKiBtYXgpXG4gICAgICBiaW5hcnkuaW5zZXJ0KHtvYmplY3Q6IG5vZGUsIGRpc3Q6IGRpc3R9LCBhcnJheSwgYnlEaXN0YW5jZSlcblxuICAgIC8qIElmIHRoZSBhcnJheSdzIHRvbyBsb25nLCBjdWxsIGl0LiAqL1xuICAgIGlmKGFycmF5Lmxlbmd0aCA+IG4pXG4gICAgICBhcnJheS5wb3AoKVxuICB9XG5cbiAgLyogU3RyaXAgY2FuZGlkYXRlIHdyYXBwZXIgb2JqZWN0cy4gKi9cbiAgaSA9IGFycmF5Lmxlbmd0aFxuXG4gIHdoaWxlKGktLSlcbiAgICBhcnJheVtpXSA9IGFycmF5W2ldLm9iamVjdFxuXG4gIHJldHVybiBhcnJheVxufVxuXG5leHBvcnRzLmJ1aWxkICA9IGJ1aWxkXG5leHBvcnRzLmxvb2t1cCA9IGxvb2t1cFxuIiwidmFyIGtkICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiLi9rZFwiKSxcbiAgICByYWQgICAgICAgICAgICAgID0gTWF0aC5QSSAvIDE4MCxcbiAgICBpbnZFYXJ0aERpYW1ldGVyID0gMSAvIDEyNzQyMDE4IC8qIG1ldGVycyAqL1xuXG5mdW5jdGlvbiBzcGhlcmljYWwyY2FydGVzaWFuKGxhdCwgbG9uKSB7XG4gIGxhdCAqPSByYWRcbiAgbG9uICo9IHJhZFxuICB2YXIgY29zID0gTWF0aC5jb3MobGF0KVxuICByZXR1cm4gW2NvcyAqIE1hdGguY29zKGxvbiksIE1hdGguc2luKGxhdCksIGNvcyAqIE1hdGguc2luKGxvbildXG59XG5cbmZ1bmN0aW9uIFBvc2l0aW9uKG9iamVjdCkge1xuICB2YXIgbGF0LCBsb247XG5cbiAgLyogRmluZCBsYXRpdHVkZS4gKi9cbiAgaWYob2JqZWN0Lmhhc093blByb3BlcnR5KFwibGF0XCIpKVxuICAgIGxhdCA9IG9iamVjdC5sYXQ7XG5cbiAgZWxzZSBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsYXRpdHVkZVwiKSlcbiAgICBsYXQgPSBvYmplY3QubGF0aXR1ZGU7XG5cbiAgZWxzZSBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsb2NhdGlvblwiKSAmJlxuICAgICAgICAgIEFycmF5LmlzQXJyYXkob2JqZWN0LmxvY2F0aW9uKSAmJlxuICAgICAgICAgIG9iamVjdC5sb2NhdGlvbi5sZW5ndGggPT09IDIpXG4gICAgbGF0ID0gb2JqZWN0LmxvY2F0aW9uWzBdO1xuXG4gIC8qIEZpbmQgbG9uZ2l0dWRlLiAqL1xuICBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsb25cIikpXG4gICAgbG9uID0gb2JqZWN0LmxvbjtcblxuICBlbHNlIGlmKG9iamVjdC5oYXNPd25Qcm9wZXJ0eShcImxvbmdpdHVkZVwiKSlcbiAgICBsb24gPSBvYmplY3QubG9uZ2l0dWRlO1xuXG4gIGVsc2UgaWYob2JqZWN0Lmhhc093blByb3BlcnR5KFwibG5nXCIpKVxuICAgIGxvbiA9IG9iamVjdC5sbmc7XG5cbiAgZWxzZSBpZihvYmplY3QuaGFzT3duUHJvcGVydHkoXCJsb25nXCIpKVxuICAgIGxvbiA9IG9iamVjdC5sb25nO1xuXG4gIGVsc2UgaWYob2JqZWN0Lmhhc093blByb3BlcnR5KFwibG9jYXRpb25cIikgJiZcbiAgICAgICAgICBBcnJheS5pc0FycmF5KG9iamVjdC5sb2NhdGlvbikgJiZcbiAgICAgICAgICBvYmplY3QubG9jYXRpb24ubGVuZ3RoID09PSAyKVxuICAgIGxvbiA9IG9iamVjdC5sb2NhdGlvblsxXTtcblxuICAvKiBGaW5hbGx5LCBzZXQgdGhpcyBvYmplY3QncyBwcm9wZXJ0aWVzLiAqL1xuICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgdGhpcy5wb3NpdGlvbiA9IHNwaGVyaWNhbDJjYXJ0ZXNpYW4obGF0LCBsb24pO1xufVxuXG5mdW5jdGlvbiBidWlsZChhcnJheSkge1xuICB2YXIgaSAgID0gYXJyYXkubGVuZ3RoLFxuICAgICAgb3V0ID0gbmV3IEFycmF5KGkpXG5cbiAgd2hpbGUoaS0tKVxuICAgIG91dFtpXSA9IG5ldyBQb3NpdGlvbihhcnJheVtpXSlcblxuICByZXR1cm4ga2QuYnVpbGQob3V0KVxufVxuXG5mdW5jdGlvbiBsb29rdXAobGF0LCBsb24sIG5vZGUsIG4sIG1heCkge1xuICB2YXIgYXJyYXkgPSBrZC5sb29rdXAoXG4gICAgICAgIHNwaGVyaWNhbDJjYXJ0ZXNpYW4obGF0LCBsb24pLFxuICAgICAgICBub2RlLFxuICAgICAgICBuLFxuICAgICAgICBtYXggPiAwID8gMiAqIE1hdGguc2luKG1heCAqIGludkVhcnRoRGlhbWV0ZXIpIDogdW5kZWZpbmVkXG4gICAgICApLFxuICAgICAgaSAgICAgPSBhcnJheS5sZW5ndGhcblxuICAvKiBTdHJpcCBvZmYgcG9zaXRpb24gd3JhcHBlciBvYmplY3RzLiAqL1xuICB3aGlsZShpLS0pXG4gICAgYXJyYXlbaV0gPSBhcnJheVtpXS5vYmplY3RcblxuICByZXR1cm4gYXJyYXlcbn1cblxuZXhwb3J0cy5idWlsZCAgPSBidWlsZFxuZXhwb3J0cy5sb29rdXAgPSBsb29rdXBcbiIsIi8qXG4gTGVhZmxldCwgYSBKYXZhU2NyaXB0IGxpYnJhcnkgZm9yIG1vYmlsZS1mcmllbmRseSBpbnRlcmFjdGl2ZSBtYXBzLiBodHRwOi8vbGVhZmxldGpzLmNvbVxuIChjKSAyMDEwLTIwMTMsIFZsYWRpbWlyIEFnYWZvbmtpblxuIChjKSAyMDEwLTIwMTEsIENsb3VkTWFkZVxuKi9cbihmdW5jdGlvbiAod2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XHJcbnZhciBvbGRMID0gd2luZG93LkwsXHJcbiAgICBMID0ge307XHJcblxyXG5MLnZlcnNpb24gPSAnMC43LjUnO1xyXG5cclxuLy8gZGVmaW5lIExlYWZsZXQgZm9yIE5vZGUgbW9kdWxlIHBhdHRlcm4gbG9hZGVycywgaW5jbHVkaW5nIEJyb3dzZXJpZnlcclxuaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuXHRtb2R1bGUuZXhwb3J0cyA9IEw7XHJcblxyXG4vLyBkZWZpbmUgTGVhZmxldCBhcyBhbiBBTUQgbW9kdWxlXHJcbn0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XHJcblx0ZGVmaW5lKEwpO1xyXG59XHJcblxyXG4vLyBkZWZpbmUgTGVhZmxldCBhcyBhIGdsb2JhbCBMIHZhcmlhYmxlLCBzYXZpbmcgdGhlIG9yaWdpbmFsIEwgdG8gcmVzdG9yZSBsYXRlciBpZiBuZWVkZWRcclxuXHJcbkwubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcclxuXHR3aW5kb3cuTCA9IG9sZEw7XHJcblx0cmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG53aW5kb3cuTCA9IEw7XHJcblxuXG4vKlxyXG4gKiBMLlV0aWwgY29udGFpbnMgdmFyaW91cyB1dGlsaXR5IGZ1bmN0aW9ucyB1c2VkIHRocm91Z2hvdXQgTGVhZmxldCBjb2RlLlxyXG4gKi9cclxuXHJcbkwuVXRpbCA9IHtcclxuXHRleHRlbmQ6IGZ1bmN0aW9uIChkZXN0KSB7IC8vIChPYmplY3RbLCBPYmplY3QsIC4uLl0pIC0+XHJcblx0XHR2YXIgc291cmNlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSksXHJcblx0XHQgICAgaSwgaiwgbGVuLCBzcmM7XHJcblxyXG5cdFx0Zm9yIChqID0gMCwgbGVuID0gc291cmNlcy5sZW5ndGg7IGogPCBsZW47IGorKykge1xyXG5cdFx0XHRzcmMgPSBzb3VyY2VzW2pdIHx8IHt9O1xyXG5cdFx0XHRmb3IgKGkgaW4gc3JjKSB7XHJcblx0XHRcdFx0aWYgKHNyYy5oYXNPd25Qcm9wZXJ0eShpKSkge1xyXG5cdFx0XHRcdFx0ZGVzdFtpXSA9IHNyY1tpXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBkZXN0O1xyXG5cdH0sXHJcblxyXG5cdGJpbmQ6IGZ1bmN0aW9uIChmbiwgb2JqKSB7IC8vIChGdW5jdGlvbiwgT2JqZWN0KSAtPiBGdW5jdGlvblxyXG5cdFx0dmFyIGFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMikgOiBudWxsO1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGZuLmFwcGx5KG9iaiwgYXJncyB8fCBhcmd1bWVudHMpO1xyXG5cdFx0fTtcclxuXHR9LFxyXG5cclxuXHRzdGFtcDogKGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBsYXN0SWQgPSAwLFxyXG5cdFx0ICAgIGtleSA9ICdfbGVhZmxldF9pZCc7XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24gKG9iaikge1xyXG5cdFx0XHRvYmpba2V5XSA9IG9ialtrZXldIHx8ICsrbGFzdElkO1xyXG5cdFx0XHRyZXR1cm4gb2JqW2tleV07XHJcblx0XHR9O1xyXG5cdH0oKSksXHJcblxyXG5cdGludm9rZUVhY2g6IGZ1bmN0aW9uIChvYmosIG1ldGhvZCwgY29udGV4dCkge1xyXG5cdFx0dmFyIGksIGFyZ3M7XHJcblxyXG5cdFx0aWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7XHJcblx0XHRcdGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDMpO1xyXG5cclxuXHRcdFx0Zm9yIChpIGluIG9iaikge1xyXG5cdFx0XHRcdG1ldGhvZC5hcHBseShjb250ZXh0LCBbaSwgb2JqW2ldXS5jb25jYXQoYXJncykpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHRsaW1pdEV4ZWNCeUludGVydmFsOiBmdW5jdGlvbiAoZm4sIHRpbWUsIGNvbnRleHQpIHtcclxuXHRcdHZhciBsb2NrLCBleGVjT25VbmxvY2s7XHJcblxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHdyYXBwZXJGbigpIHtcclxuXHRcdFx0dmFyIGFyZ3MgPSBhcmd1bWVudHM7XHJcblxyXG5cdFx0XHRpZiAobG9jaykge1xyXG5cdFx0XHRcdGV4ZWNPblVubG9jayA9IHRydWU7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsb2NrID0gdHJ1ZTtcclxuXHJcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdGxvY2sgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0aWYgKGV4ZWNPblVubG9jaykge1xyXG5cdFx0XHRcdFx0d3JhcHBlckZuLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG5cdFx0XHRcdFx0ZXhlY09uVW5sb2NrID0gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCB0aW1lKTtcclxuXHJcblx0XHRcdGZuLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG5cdFx0fTtcclxuXHR9LFxyXG5cclxuXHRmYWxzZUZuOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fSxcclxuXHJcblx0Zm9ybWF0TnVtOiBmdW5jdGlvbiAobnVtLCBkaWdpdHMpIHtcclxuXHRcdHZhciBwb3cgPSBNYXRoLnBvdygxMCwgZGlnaXRzIHx8IDUpO1xyXG5cdFx0cmV0dXJuIE1hdGgucm91bmQobnVtICogcG93KSAvIHBvdztcclxuXHR9LFxyXG5cclxuXHR0cmltOiBmdW5jdGlvbiAoc3RyKSB7XHJcblx0XHRyZXR1cm4gc3RyLnRyaW0gPyBzdHIudHJpbSgpIDogc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcclxuXHR9LFxyXG5cclxuXHRzcGxpdFdvcmRzOiBmdW5jdGlvbiAoc3RyKSB7XHJcblx0XHRyZXR1cm4gTC5VdGlsLnRyaW0oc3RyKS5zcGxpdCgvXFxzKy8pO1xyXG5cdH0sXHJcblxyXG5cdHNldE9wdGlvbnM6IGZ1bmN0aW9uIChvYmosIG9wdGlvbnMpIHtcclxuXHRcdG9iai5vcHRpb25zID0gTC5leHRlbmQoe30sIG9iai5vcHRpb25zLCBvcHRpb25zKTtcclxuXHRcdHJldHVybiBvYmoub3B0aW9ucztcclxuXHR9LFxyXG5cclxuXHRnZXRQYXJhbVN0cmluZzogZnVuY3Rpb24gKG9iaiwgZXhpc3RpbmdVcmwsIHVwcGVyY2FzZSkge1xyXG5cdFx0dmFyIHBhcmFtcyA9IFtdO1xyXG5cdFx0Zm9yICh2YXIgaSBpbiBvYmopIHtcclxuXHRcdFx0cGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KHVwcGVyY2FzZSA/IGkudG9VcHBlckNhc2UoKSA6IGkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG9ialtpXSkpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICgoIWV4aXN0aW5nVXJsIHx8IGV4aXN0aW5nVXJsLmluZGV4T2YoJz8nKSA9PT0gLTEpID8gJz8nIDogJyYnKSArIHBhcmFtcy5qb2luKCcmJyk7XHJcblx0fSxcclxuXHR0ZW1wbGF0ZTogZnVuY3Rpb24gKHN0ciwgZGF0YSkge1xyXG5cdFx0cmV0dXJuIHN0ci5yZXBsYWNlKC9cXHsgKihbXFx3X10rKSAqXFx9L2csIGZ1bmN0aW9uIChzdHIsIGtleSkge1xyXG5cdFx0XHR2YXIgdmFsdWUgPSBkYXRhW2tleV07XHJcblx0XHRcdGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdObyB2YWx1ZSBwcm92aWRlZCBmb3IgdmFyaWFibGUgJyArIHN0cik7XHJcblx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdFx0dmFsdWUgPSB2YWx1ZShkYXRhKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdmFsdWU7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cclxuXHRpc0FycmF5OiBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIChvYmopIHtcclxuXHRcdHJldHVybiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XScpO1xyXG5cdH0sXHJcblxyXG5cdGVtcHR5SW1hZ2VVcmw6ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUFEL0FDd0FBQUFBQVFBQkFBQUNBRHM9J1xyXG59O1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcblx0Ly8gaW5zcGlyZWQgYnkgaHR0cDovL3BhdWxpcmlzaC5jb20vMjAxMS9yZXF1ZXN0YW5pbWF0aW9uZnJhbWUtZm9yLXNtYXJ0LWFuaW1hdGluZy9cclxuXHJcblx0ZnVuY3Rpb24gZ2V0UHJlZml4ZWQobmFtZSkge1xyXG5cdFx0dmFyIGksIGZuLFxyXG5cdFx0ICAgIHByZWZpeGVzID0gWyd3ZWJraXQnLCAnbW96JywgJ28nLCAnbXMnXTtcclxuXHJcblx0XHRmb3IgKGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoICYmICFmbjsgaSsrKSB7XHJcblx0XHRcdGZuID0gd2luZG93W3ByZWZpeGVzW2ldICsgbmFtZV07XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGZuO1xyXG5cdH1cclxuXHJcblx0dmFyIGxhc3RUaW1lID0gMDtcclxuXHJcblx0ZnVuY3Rpb24gdGltZW91dERlZmVyKGZuKSB7XHJcblx0XHR2YXIgdGltZSA9ICtuZXcgRGF0ZSgpLFxyXG5cdFx0ICAgIHRpbWVUb0NhbGwgPSBNYXRoLm1heCgwLCAxNiAtICh0aW1lIC0gbGFzdFRpbWUpKTtcclxuXHJcblx0XHRsYXN0VGltZSA9IHRpbWUgKyB0aW1lVG9DYWxsO1xyXG5cdFx0cmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KGZuLCB0aW1lVG9DYWxsKTtcclxuXHR9XHJcblxyXG5cdHZhciByZXF1ZXN0Rm4gPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcblx0ICAgICAgICBnZXRQcmVmaXhlZCgnUmVxdWVzdEFuaW1hdGlvbkZyYW1lJykgfHwgdGltZW91dERlZmVyO1xyXG5cclxuXHR2YXIgY2FuY2VsRm4gPSB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUgfHxcclxuXHQgICAgICAgIGdldFByZWZpeGVkKCdDYW5jZWxBbmltYXRpb25GcmFtZScpIHx8XHJcblx0ICAgICAgICBnZXRQcmVmaXhlZCgnQ2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lJykgfHxcclxuXHQgICAgICAgIGZ1bmN0aW9uIChpZCkgeyB3aW5kb3cuY2xlYXJUaW1lb3V0KGlkKTsgfTtcclxuXHJcblxyXG5cdEwuVXRpbC5yZXF1ZXN0QW5pbUZyYW1lID0gZnVuY3Rpb24gKGZuLCBjb250ZXh0LCBpbW1lZGlhdGUsIGVsZW1lbnQpIHtcclxuXHRcdGZuID0gTC5iaW5kKGZuLCBjb250ZXh0KTtcclxuXHJcblx0XHRpZiAoaW1tZWRpYXRlICYmIHJlcXVlc3RGbiA9PT0gdGltZW91dERlZmVyKSB7XHJcblx0XHRcdGZuKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZXR1cm4gcmVxdWVzdEZuLmNhbGwod2luZG93LCBmbiwgZWxlbWVudCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0TC5VdGlsLmNhbmNlbEFuaW1GcmFtZSA9IGZ1bmN0aW9uIChpZCkge1xyXG5cdFx0aWYgKGlkKSB7XHJcblx0XHRcdGNhbmNlbEZuLmNhbGwod2luZG93LCBpZCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcbn0oKSk7XHJcblxyXG4vLyBzaG9ydGN1dHMgZm9yIG1vc3QgdXNlZCB1dGlsaXR5IGZ1bmN0aW9uc1xyXG5MLmV4dGVuZCA9IEwuVXRpbC5leHRlbmQ7XHJcbkwuYmluZCA9IEwuVXRpbC5iaW5kO1xyXG5MLnN0YW1wID0gTC5VdGlsLnN0YW1wO1xyXG5MLnNldE9wdGlvbnMgPSBMLlV0aWwuc2V0T3B0aW9ucztcclxuXG5cbi8qXHJcbiAqIEwuQ2xhc3MgcG93ZXJzIHRoZSBPT1AgZmFjaWxpdGllcyBvZiB0aGUgbGlicmFyeS5cclxuICogVGhhbmtzIHRvIEpvaG4gUmVzaWcgYW5kIERlYW4gRWR3YXJkcyBmb3IgaW5zcGlyYXRpb24hXHJcbiAqL1xyXG5cclxuTC5DbGFzcyA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cclxuTC5DbGFzcy5leHRlbmQgPSBmdW5jdGlvbiAocHJvcHMpIHtcclxuXHJcblx0Ly8gZXh0ZW5kZWQgY2xhc3Mgd2l0aCB0aGUgbmV3IHByb3RvdHlwZVxyXG5cdHZhciBOZXdDbGFzcyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHQvLyBjYWxsIHRoZSBjb25zdHJ1Y3RvclxyXG5cdFx0aWYgKHRoaXMuaW5pdGlhbGl6ZSkge1xyXG5cdFx0XHR0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBjYWxsIGFsbCBjb25zdHJ1Y3RvciBob29rc1xyXG5cdFx0aWYgKHRoaXMuX2luaXRIb29rcykge1xyXG5cdFx0XHR0aGlzLmNhbGxJbml0SG9va3MoKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvLyBpbnN0YW50aWF0ZSBjbGFzcyB3aXRob3V0IGNhbGxpbmcgY29uc3RydWN0b3JcclxuXHR2YXIgRiA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cdEYucHJvdG90eXBlID0gdGhpcy5wcm90b3R5cGU7XHJcblxyXG5cdHZhciBwcm90byA9IG5ldyBGKCk7XHJcblx0cHJvdG8uY29uc3RydWN0b3IgPSBOZXdDbGFzcztcclxuXHJcblx0TmV3Q2xhc3MucHJvdG90eXBlID0gcHJvdG87XHJcblxyXG5cdC8vaW5oZXJpdCBwYXJlbnQncyBzdGF0aWNzXHJcblx0Zm9yICh2YXIgaSBpbiB0aGlzKSB7XHJcblx0XHRpZiAodGhpcy5oYXNPd25Qcm9wZXJ0eShpKSAmJiBpICE9PSAncHJvdG90eXBlJykge1xyXG5cdFx0XHROZXdDbGFzc1tpXSA9IHRoaXNbaV07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBtaXggc3RhdGljIHByb3BlcnRpZXMgaW50byB0aGUgY2xhc3NcclxuXHRpZiAocHJvcHMuc3RhdGljcykge1xyXG5cdFx0TC5leHRlbmQoTmV3Q2xhc3MsIHByb3BzLnN0YXRpY3MpO1xyXG5cdFx0ZGVsZXRlIHByb3BzLnN0YXRpY3M7XHJcblx0fVxyXG5cclxuXHQvLyBtaXggaW5jbHVkZXMgaW50byB0aGUgcHJvdG90eXBlXHJcblx0aWYgKHByb3BzLmluY2x1ZGVzKSB7XHJcblx0XHRMLlV0aWwuZXh0ZW5kLmFwcGx5KG51bGwsIFtwcm90b10uY29uY2F0KHByb3BzLmluY2x1ZGVzKSk7XHJcblx0XHRkZWxldGUgcHJvcHMuaW5jbHVkZXM7XHJcblx0fVxyXG5cclxuXHQvLyBtZXJnZSBvcHRpb25zXHJcblx0aWYgKHByb3BzLm9wdGlvbnMgJiYgcHJvdG8ub3B0aW9ucykge1xyXG5cdFx0cHJvcHMub3B0aW9ucyA9IEwuZXh0ZW5kKHt9LCBwcm90by5vcHRpb25zLCBwcm9wcy5vcHRpb25zKTtcclxuXHR9XHJcblxyXG5cdC8vIG1peCBnaXZlbiBwcm9wZXJ0aWVzIGludG8gdGhlIHByb3RvdHlwZVxyXG5cdEwuZXh0ZW5kKHByb3RvLCBwcm9wcyk7XHJcblxyXG5cdHByb3RvLl9pbml0SG9va3MgPSBbXTtcclxuXHJcblx0dmFyIHBhcmVudCA9IHRoaXM7XHJcblx0Ly8ganNoaW50IGNhbWVsY2FzZTogZmFsc2VcclxuXHROZXdDbGFzcy5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlO1xyXG5cclxuXHQvLyBhZGQgbWV0aG9kIGZvciBjYWxsaW5nIGFsbCBob29rc1xyXG5cdHByb3RvLmNhbGxJbml0SG9va3MgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2luaXRIb29rc0NhbGxlZCkgeyByZXR1cm47IH1cclxuXHJcblx0XHRpZiAocGFyZW50LnByb3RvdHlwZS5jYWxsSW5pdEhvb2tzKSB7XHJcblx0XHRcdHBhcmVudC5wcm90b3R5cGUuY2FsbEluaXRIb29rcy5jYWxsKHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX2luaXRIb29rc0NhbGxlZCA9IHRydWU7XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IHByb3RvLl9pbml0SG9va3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0cHJvdG8uX2luaXRIb29rc1tpXS5jYWxsKHRoaXMpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHJldHVybiBOZXdDbGFzcztcclxufTtcclxuXHJcblxyXG4vLyBtZXRob2QgZm9yIGFkZGluZyBwcm9wZXJ0aWVzIHRvIHByb3RvdHlwZVxyXG5MLkNsYXNzLmluY2x1ZGUgPSBmdW5jdGlvbiAocHJvcHMpIHtcclxuXHRMLmV4dGVuZCh0aGlzLnByb3RvdHlwZSwgcHJvcHMpO1xyXG59O1xyXG5cclxuLy8gbWVyZ2UgbmV3IGRlZmF1bHQgb3B0aW9ucyB0byB0aGUgQ2xhc3NcclxuTC5DbGFzcy5tZXJnZU9wdGlvbnMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG5cdEwuZXh0ZW5kKHRoaXMucHJvdG90eXBlLm9wdGlvbnMsIG9wdGlvbnMpO1xyXG59O1xyXG5cclxuLy8gYWRkIGEgY29uc3RydWN0b3IgaG9va1xyXG5MLkNsYXNzLmFkZEluaXRIb29rID0gZnVuY3Rpb24gKGZuKSB7IC8vIChGdW5jdGlvbikgfHwgKFN0cmluZywgYXJncy4uLilcclxuXHR2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XHJcblxyXG5cdHZhciBpbml0ID0gdHlwZW9mIGZuID09PSAnZnVuY3Rpb24nID8gZm4gOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR0aGlzW2ZuXS5hcHBseSh0aGlzLCBhcmdzKTtcclxuXHR9O1xyXG5cclxuXHR0aGlzLnByb3RvdHlwZS5faW5pdEhvb2tzID0gdGhpcy5wcm90b3R5cGUuX2luaXRIb29rcyB8fCBbXTtcclxuXHR0aGlzLnByb3RvdHlwZS5faW5pdEhvb2tzLnB1c2goaW5pdCk7XHJcbn07XHJcblxuXG4vKlxyXG4gKiBMLk1peGluLkV2ZW50cyBpcyB1c2VkIHRvIGFkZCBjdXN0b20gZXZlbnRzIGZ1bmN0aW9uYWxpdHkgdG8gTGVhZmxldCBjbGFzc2VzLlxyXG4gKi9cclxuXHJcbnZhciBldmVudHNLZXkgPSAnX2xlYWZsZXRfZXZlbnRzJztcclxuXHJcbkwuTWl4aW4gPSB7fTtcclxuXHJcbkwuTWl4aW4uRXZlbnRzID0ge1xyXG5cclxuXHRhZGRFdmVudExpc3RlbmVyOiBmdW5jdGlvbiAodHlwZXMsIGZuLCBjb250ZXh0KSB7IC8vIChTdHJpbmcsIEZ1bmN0aW9uWywgT2JqZWN0XSkgb3IgKE9iamVjdFssIE9iamVjdF0pXHJcblxyXG5cdFx0Ly8gdHlwZXMgY2FuIGJlIGEgbWFwIG9mIHR5cGVzL2hhbmRsZXJzXHJcblx0XHRpZiAoTC5VdGlsLmludm9rZUVhY2godHlwZXMsIHRoaXMuYWRkRXZlbnRMaXN0ZW5lciwgdGhpcywgZm4sIGNvbnRleHQpKSB7IHJldHVybiB0aGlzOyB9XHJcblxyXG5cdFx0dmFyIGV2ZW50cyA9IHRoaXNbZXZlbnRzS2V5XSA9IHRoaXNbZXZlbnRzS2V5XSB8fCB7fSxcclxuXHRcdCAgICBjb250ZXh0SWQgPSBjb250ZXh0ICYmIGNvbnRleHQgIT09IHRoaXMgJiYgTC5zdGFtcChjb250ZXh0KSxcclxuXHRcdCAgICBpLCBsZW4sIGV2ZW50LCB0eXBlLCBpbmRleEtleSwgaW5kZXhMZW5LZXksIHR5cGVJbmRleDtcclxuXHJcblx0XHQvLyB0eXBlcyBjYW4gYmUgYSBzdHJpbmcgb2Ygc3BhY2Utc2VwYXJhdGVkIHdvcmRzXHJcblx0XHR0eXBlcyA9IEwuVXRpbC5zcGxpdFdvcmRzKHR5cGVzKTtcclxuXHJcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSB0eXBlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRldmVudCA9IHtcclxuXHRcdFx0XHRhY3Rpb246IGZuLFxyXG5cdFx0XHRcdGNvbnRleHQ6IGNvbnRleHQgfHwgdGhpc1xyXG5cdFx0XHR9O1xyXG5cdFx0XHR0eXBlID0gdHlwZXNbaV07XHJcblxyXG5cdFx0XHRpZiAoY29udGV4dElkKSB7XHJcblx0XHRcdFx0Ly8gc3RvcmUgbGlzdGVuZXJzIG9mIGEgcGFydGljdWxhciBjb250ZXh0IGluIGEgc2VwYXJhdGUgaGFzaCAoaWYgaXQgaGFzIGFuIGlkKVxyXG5cdFx0XHRcdC8vIGdpdmVzIGEgbWFqb3IgcGVyZm9ybWFuY2UgYm9vc3Qgd2hlbiByZW1vdmluZyB0aG91c2FuZHMgb2YgbWFwIGxheWVyc1xyXG5cclxuXHRcdFx0XHRpbmRleEtleSA9IHR5cGUgKyAnX2lkeCc7XHJcblx0XHRcdFx0aW5kZXhMZW5LZXkgPSBpbmRleEtleSArICdfbGVuJztcclxuXHJcblx0XHRcdFx0dHlwZUluZGV4ID0gZXZlbnRzW2luZGV4S2V5XSA9IGV2ZW50c1tpbmRleEtleV0gfHwge307XHJcblxyXG5cdFx0XHRcdGlmICghdHlwZUluZGV4W2NvbnRleHRJZF0pIHtcclxuXHRcdFx0XHRcdHR5cGVJbmRleFtjb250ZXh0SWRdID0gW107XHJcblxyXG5cdFx0XHRcdFx0Ly8ga2VlcCB0cmFjayBvZiB0aGUgbnVtYmVyIG9mIGtleXMgaW4gdGhlIGluZGV4IHRvIHF1aWNrbHkgY2hlY2sgaWYgaXQncyBlbXB0eVxyXG5cdFx0XHRcdFx0ZXZlbnRzW2luZGV4TGVuS2V5XSA9IChldmVudHNbaW5kZXhMZW5LZXldIHx8IDApICsgMTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHR5cGVJbmRleFtjb250ZXh0SWRdLnB1c2goZXZlbnQpO1xyXG5cclxuXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZXZlbnRzW3R5cGVdID0gZXZlbnRzW3R5cGVdIHx8IFtdO1xyXG5cdFx0XHRcdGV2ZW50c1t0eXBlXS5wdXNoKGV2ZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGhhc0V2ZW50TGlzdGVuZXJzOiBmdW5jdGlvbiAodHlwZSkgeyAvLyAoU3RyaW5nKSAtPiBCb29sZWFuXHJcblx0XHR2YXIgZXZlbnRzID0gdGhpc1tldmVudHNLZXldO1xyXG5cdFx0cmV0dXJuICEhZXZlbnRzICYmICgodHlwZSBpbiBldmVudHMgJiYgZXZlbnRzW3R5cGVdLmxlbmd0aCA+IDApIHx8XHJcblx0XHQgICAgICAgICAgICAgICAgICAgICh0eXBlICsgJ19pZHgnIGluIGV2ZW50cyAmJiBldmVudHNbdHlwZSArICdfaWR4X2xlbiddID4gMCkpO1xyXG5cdH0sXHJcblxyXG5cdHJlbW92ZUV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uICh0eXBlcywgZm4sIGNvbnRleHQpIHsgLy8gKFtTdHJpbmcsIEZ1bmN0aW9uLCBPYmplY3RdKSBvciAoT2JqZWN0WywgT2JqZWN0XSlcclxuXHJcblx0XHRpZiAoIXRoaXNbZXZlbnRzS2V5XSkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIXR5cGVzKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmNsZWFyQWxsRXZlbnRMaXN0ZW5lcnMoKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoTC5VdGlsLmludm9rZUVhY2godHlwZXMsIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lciwgdGhpcywgZm4sIGNvbnRleHQpKSB7IHJldHVybiB0aGlzOyB9XHJcblxyXG5cdFx0dmFyIGV2ZW50cyA9IHRoaXNbZXZlbnRzS2V5XSxcclxuXHRcdCAgICBjb250ZXh0SWQgPSBjb250ZXh0ICYmIGNvbnRleHQgIT09IHRoaXMgJiYgTC5zdGFtcChjb250ZXh0KSxcclxuXHRcdCAgICBpLCBsZW4sIHR5cGUsIGxpc3RlbmVycywgaiwgaW5kZXhLZXksIGluZGV4TGVuS2V5LCB0eXBlSW5kZXgsIHJlbW92ZWQ7XHJcblxyXG5cdFx0dHlwZXMgPSBMLlV0aWwuc3BsaXRXb3Jkcyh0eXBlcyk7XHJcblxyXG5cdFx0Zm9yIChpID0gMCwgbGVuID0gdHlwZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0dHlwZSA9IHR5cGVzW2ldO1xyXG5cdFx0XHRpbmRleEtleSA9IHR5cGUgKyAnX2lkeCc7XHJcblx0XHRcdGluZGV4TGVuS2V5ID0gaW5kZXhLZXkgKyAnX2xlbic7XHJcblxyXG5cdFx0XHR0eXBlSW5kZXggPSBldmVudHNbaW5kZXhLZXldO1xyXG5cclxuXHRcdFx0aWYgKCFmbikge1xyXG5cdFx0XHRcdC8vIGNsZWFyIGFsbCBsaXN0ZW5lcnMgZm9yIGEgdHlwZSBpZiBmdW5jdGlvbiBpc24ndCBzcGVjaWZpZWRcclxuXHRcdFx0XHRkZWxldGUgZXZlbnRzW3R5cGVdO1xyXG5cdFx0XHRcdGRlbGV0ZSBldmVudHNbaW5kZXhLZXldO1xyXG5cdFx0XHRcdGRlbGV0ZSBldmVudHNbaW5kZXhMZW5LZXldO1xyXG5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRsaXN0ZW5lcnMgPSBjb250ZXh0SWQgJiYgdHlwZUluZGV4ID8gdHlwZUluZGV4W2NvbnRleHRJZF0gOiBldmVudHNbdHlwZV07XHJcblxyXG5cdFx0XHRcdGlmIChsaXN0ZW5lcnMpIHtcclxuXHRcdFx0XHRcdGZvciAoaiA9IGxpc3RlbmVycy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoKGxpc3RlbmVyc1tqXS5hY3Rpb24gPT09IGZuKSAmJiAoIWNvbnRleHQgfHwgKGxpc3RlbmVyc1tqXS5jb250ZXh0ID09PSBjb250ZXh0KSkpIHtcclxuXHRcdFx0XHRcdFx0XHRyZW1vdmVkID0gbGlzdGVuZXJzLnNwbGljZShqLCAxKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBzZXQgdGhlIG9sZCBhY3Rpb24gdG8gYSBuby1vcCwgYmVjYXVzZSBpdCBpcyBwb3NzaWJsZVxyXG5cdFx0XHRcdFx0XHRcdC8vIHRoYXQgdGhlIGxpc3RlbmVyIGlzIGJlaW5nIGl0ZXJhdGVkIG92ZXIgYXMgcGFydCBvZiBhIGRpc3BhdGNoXHJcblx0XHRcdFx0XHRcdFx0cmVtb3ZlZFswXS5hY3Rpb24gPSBMLlV0aWwuZmFsc2VGbjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGlmIChjb250ZXh0ICYmIHR5cGVJbmRleCAmJiAobGlzdGVuZXJzLmxlbmd0aCA9PT0gMCkpIHtcclxuXHRcdFx0XHRcdFx0ZGVsZXRlIHR5cGVJbmRleFtjb250ZXh0SWRdO1xyXG5cdFx0XHRcdFx0XHRldmVudHNbaW5kZXhMZW5LZXldLS07XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0Y2xlYXJBbGxFdmVudExpc3RlbmVyczogZnVuY3Rpb24gKCkge1xyXG5cdFx0ZGVsZXRlIHRoaXNbZXZlbnRzS2V5XTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGZpcmVFdmVudDogZnVuY3Rpb24gKHR5cGUsIGRhdGEpIHsgLy8gKFN0cmluZ1ssIE9iamVjdF0pXHJcblx0XHRpZiAoIXRoaXMuaGFzRXZlbnRMaXN0ZW5lcnModHlwZSkpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGV2ZW50ID0gTC5VdGlsLmV4dGVuZCh7fSwgZGF0YSwgeyB0eXBlOiB0eXBlLCB0YXJnZXQ6IHRoaXMgfSk7XHJcblxyXG5cdFx0dmFyIGV2ZW50cyA9IHRoaXNbZXZlbnRzS2V5XSxcclxuXHRcdCAgICBsaXN0ZW5lcnMsIGksIGxlbiwgdHlwZUluZGV4LCBjb250ZXh0SWQ7XHJcblxyXG5cdFx0aWYgKGV2ZW50c1t0eXBlXSkge1xyXG5cdFx0XHQvLyBtYWtlIHN1cmUgYWRkaW5nL3JlbW92aW5nIGxpc3RlbmVycyBpbnNpZGUgb3RoZXIgbGlzdGVuZXJzIHdvbid0IGNhdXNlIGluZmluaXRlIGxvb3BcclxuXHRcdFx0bGlzdGVuZXJzID0gZXZlbnRzW3R5cGVdLnNsaWNlKCk7XHJcblxyXG5cdFx0XHRmb3IgKGkgPSAwLCBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0XHRsaXN0ZW5lcnNbaV0uYWN0aW9uLmNhbGwobGlzdGVuZXJzW2ldLmNvbnRleHQsIGV2ZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGZpcmUgZXZlbnQgZm9yIHRoZSBjb250ZXh0LWluZGV4ZWQgbGlzdGVuZXJzIGFzIHdlbGxcclxuXHRcdHR5cGVJbmRleCA9IGV2ZW50c1t0eXBlICsgJ19pZHgnXTtcclxuXHJcblx0XHRmb3IgKGNvbnRleHRJZCBpbiB0eXBlSW5kZXgpIHtcclxuXHRcdFx0bGlzdGVuZXJzID0gdHlwZUluZGV4W2NvbnRleHRJZF0uc2xpY2UoKTtcclxuXHJcblx0XHRcdGlmIChsaXN0ZW5lcnMpIHtcclxuXHRcdFx0XHRmb3IgKGkgPSAwLCBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0XHRcdGxpc3RlbmVyc1tpXS5hY3Rpb24uY2FsbChsaXN0ZW5lcnNbaV0uY29udGV4dCwgZXZlbnQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGFkZE9uZVRpbWVFdmVudExpc3RlbmVyOiBmdW5jdGlvbiAodHlwZXMsIGZuLCBjb250ZXh0KSB7XHJcblxyXG5cdFx0aWYgKEwuVXRpbC5pbnZva2VFYWNoKHR5cGVzLCB0aGlzLmFkZE9uZVRpbWVFdmVudExpc3RlbmVyLCB0aGlzLCBmbiwgY29udGV4dCkpIHsgcmV0dXJuIHRoaXM7IH1cclxuXHJcblx0XHR2YXIgaGFuZGxlciA9IEwuYmluZChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHRoaXNcclxuXHRcdFx0ICAgIC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGVzLCBmbiwgY29udGV4dClcclxuXHRcdFx0ICAgIC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGVzLCBoYW5kbGVyLCBjb250ZXh0KTtcclxuXHRcdH0sIHRoaXMpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzXHJcblx0XHQgICAgLmFkZEV2ZW50TGlzdGVuZXIodHlwZXMsIGZuLCBjb250ZXh0KVxyXG5cdFx0ICAgIC5hZGRFdmVudExpc3RlbmVyKHR5cGVzLCBoYW5kbGVyLCBjb250ZXh0KTtcclxuXHR9XHJcbn07XHJcblxyXG5MLk1peGluLkV2ZW50cy5vbiA9IEwuTWl4aW4uRXZlbnRzLmFkZEV2ZW50TGlzdGVuZXI7XHJcbkwuTWl4aW4uRXZlbnRzLm9mZiA9IEwuTWl4aW4uRXZlbnRzLnJlbW92ZUV2ZW50TGlzdGVuZXI7XHJcbkwuTWl4aW4uRXZlbnRzLm9uY2UgPSBMLk1peGluLkV2ZW50cy5hZGRPbmVUaW1lRXZlbnRMaXN0ZW5lcjtcclxuTC5NaXhpbi5FdmVudHMuZmlyZSA9IEwuTWl4aW4uRXZlbnRzLmZpcmVFdmVudDtcclxuXG5cbi8qXHJcbiAqIEwuQnJvd3NlciBoYW5kbGVzIGRpZmZlcmVudCBicm93c2VyIGFuZCBmZWF0dXJlIGRldGVjdGlvbnMgZm9yIGludGVybmFsIExlYWZsZXQgdXNlLlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG5cdHZhciBpZSA9ICdBY3RpdmVYT2JqZWN0JyBpbiB3aW5kb3csXHJcblx0XHRpZWx0OSA9IGllICYmICFkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyLFxyXG5cclxuXHQgICAgLy8gdGVycmlibGUgYnJvd3NlciBkZXRlY3Rpb24gdG8gd29yayBhcm91bmQgU2FmYXJpIC8gaU9TIC8gQW5kcm9pZCBicm93c2VyIGJ1Z3NcclxuXHQgICAgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCksXHJcblx0ICAgIHdlYmtpdCA9IHVhLmluZGV4T2YoJ3dlYmtpdCcpICE9PSAtMSxcclxuXHQgICAgY2hyb21lID0gdWEuaW5kZXhPZignY2hyb21lJykgIT09IC0xLFxyXG5cdCAgICBwaGFudG9tanMgPSB1YS5pbmRleE9mKCdwaGFudG9tJykgIT09IC0xLFxyXG5cdCAgICBhbmRyb2lkID0gdWEuaW5kZXhPZignYW5kcm9pZCcpICE9PSAtMSxcclxuXHQgICAgYW5kcm9pZDIzID0gdWEuc2VhcmNoKCdhbmRyb2lkIFsyM10nKSAhPT0gLTEsXHJcblx0XHRnZWNrbyA9IHVhLmluZGV4T2YoJ2dlY2tvJykgIT09IC0xLFxyXG5cclxuXHQgICAgbW9iaWxlID0gdHlwZW9mIG9yaWVudGF0aW9uICE9PSB1bmRlZmluZWQgKyAnJyxcclxuXHQgICAgbXNQb2ludGVyID0gIXdpbmRvdy5Qb2ludGVyRXZlbnQgJiYgd2luZG93Lk1TUG9pbnRlckV2ZW50LFxyXG5cdFx0cG9pbnRlciA9ICh3aW5kb3cuUG9pbnRlckV2ZW50ICYmIHdpbmRvdy5uYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQgJiYgd2luZG93Lm5hdmlnYXRvci5tYXhUb3VjaFBvaW50cykgfHxcclxuXHRcdFx0XHQgIG1zUG9pbnRlcixcclxuXHQgICAgcmV0aW5hID0gKCdkZXZpY2VQaXhlbFJhdGlvJyBpbiB3aW5kb3cgJiYgd2luZG93LmRldmljZVBpeGVsUmF0aW8gPiAxKSB8fFxyXG5cdCAgICAgICAgICAgICAoJ21hdGNoTWVkaWEnIGluIHdpbmRvdyAmJiB3aW5kb3cubWF0Y2hNZWRpYSgnKG1pbi1yZXNvbHV0aW9uOjE0NGRwaSknKSAmJlxyXG5cdCAgICAgICAgICAgICAgd2luZG93Lm1hdGNoTWVkaWEoJyhtaW4tcmVzb2x1dGlvbjoxNDRkcGkpJykubWF0Y2hlcyksXHJcblxyXG5cdCAgICBkb2MgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsXHJcblx0ICAgIGllM2QgPSBpZSAmJiAoJ3RyYW5zaXRpb24nIGluIGRvYy5zdHlsZSksXHJcblx0ICAgIHdlYmtpdDNkID0gKCdXZWJLaXRDU1NNYXRyaXgnIGluIHdpbmRvdykgJiYgKCdtMTEnIGluIG5ldyB3aW5kb3cuV2ViS2l0Q1NTTWF0cml4KCkpICYmICFhbmRyb2lkMjMsXHJcblx0ICAgIGdlY2tvM2QgPSAnTW96UGVyc3BlY3RpdmUnIGluIGRvYy5zdHlsZSxcclxuXHQgICAgb3BlcmEzZCA9ICdPVHJhbnNpdGlvbicgaW4gZG9jLnN0eWxlLFxyXG5cdCAgICBhbnkzZCA9ICF3aW5kb3cuTF9ESVNBQkxFXzNEICYmIChpZTNkIHx8IHdlYmtpdDNkIHx8IGdlY2tvM2QgfHwgb3BlcmEzZCkgJiYgIXBoYW50b21qcztcclxuXHJcblx0dmFyIHRvdWNoID0gIXdpbmRvdy5MX05PX1RPVUNIICYmICFwaGFudG9tanMgJiYgKHBvaW50ZXIgfHwgJ29udG91Y2hzdGFydCcgaW4gd2luZG93IHx8XHJcblx0XHQod2luZG93LkRvY3VtZW50VG91Y2ggJiYgZG9jdW1lbnQgaW5zdGFuY2VvZiB3aW5kb3cuRG9jdW1lbnRUb3VjaCkpO1xyXG5cclxuXHRMLkJyb3dzZXIgPSB7XHJcblx0XHRpZTogaWUsXHJcblx0XHRpZWx0OTogaWVsdDksXHJcblx0XHR3ZWJraXQ6IHdlYmtpdCxcclxuXHRcdGdlY2tvOiBnZWNrbyAmJiAhd2Via2l0ICYmICF3aW5kb3cub3BlcmEgJiYgIWllLFxyXG5cclxuXHRcdGFuZHJvaWQ6IGFuZHJvaWQsXHJcblx0XHRhbmRyb2lkMjM6IGFuZHJvaWQyMyxcclxuXHJcblx0XHRjaHJvbWU6IGNocm9tZSxcclxuXHJcblx0XHRpZTNkOiBpZTNkLFxyXG5cdFx0d2Via2l0M2Q6IHdlYmtpdDNkLFxyXG5cdFx0Z2Vja28zZDogZ2Vja28zZCxcclxuXHRcdG9wZXJhM2Q6IG9wZXJhM2QsXHJcblx0XHRhbnkzZDogYW55M2QsXHJcblxyXG5cdFx0bW9iaWxlOiBtb2JpbGUsXHJcblx0XHRtb2JpbGVXZWJraXQ6IG1vYmlsZSAmJiB3ZWJraXQsXHJcblx0XHRtb2JpbGVXZWJraXQzZDogbW9iaWxlICYmIHdlYmtpdDNkLFxyXG5cdFx0bW9iaWxlT3BlcmE6IG1vYmlsZSAmJiB3aW5kb3cub3BlcmEsXHJcblxyXG5cdFx0dG91Y2g6IHRvdWNoLFxyXG5cdFx0bXNQb2ludGVyOiBtc1BvaW50ZXIsXHJcblx0XHRwb2ludGVyOiBwb2ludGVyLFxyXG5cclxuXHRcdHJldGluYTogcmV0aW5hXHJcblx0fTtcclxuXHJcbn0oKSk7XHJcblxuXG4vKlxyXG4gKiBMLlBvaW50IHJlcHJlc2VudHMgYSBwb2ludCB3aXRoIHggYW5kIHkgY29vcmRpbmF0ZXMuXHJcbiAqL1xyXG5cclxuTC5Qb2ludCA9IGZ1bmN0aW9uICgvKk51bWJlciovIHgsIC8qTnVtYmVyKi8geSwgLypCb29sZWFuKi8gcm91bmQpIHtcclxuXHR0aGlzLnggPSAocm91bmQgPyBNYXRoLnJvdW5kKHgpIDogeCk7XHJcblx0dGhpcy55ID0gKHJvdW5kID8gTWF0aC5yb3VuZCh5KSA6IHkpO1xyXG59O1xyXG5cclxuTC5Qb2ludC5wcm90b3R5cGUgPSB7XHJcblxyXG5cdGNsb25lOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gbmV3IEwuUG9pbnQodGhpcy54LCB0aGlzLnkpO1xyXG5cdH0sXHJcblxyXG5cdC8vIG5vbi1kZXN0cnVjdGl2ZSwgcmV0dXJucyBhIG5ldyBwb2ludFxyXG5cdGFkZDogZnVuY3Rpb24gKHBvaW50KSB7XHJcblx0XHRyZXR1cm4gdGhpcy5jbG9uZSgpLl9hZGQoTC5wb2ludChwb2ludCkpO1xyXG5cdH0sXHJcblxyXG5cdC8vIGRlc3RydWN0aXZlLCB1c2VkIGRpcmVjdGx5IGZvciBwZXJmb3JtYW5jZSBpbiBzaXR1YXRpb25zIHdoZXJlIGl0J3Mgc2FmZSB0byBtb2RpZnkgZXhpc3RpbmcgcG9pbnRcclxuXHRfYWRkOiBmdW5jdGlvbiAocG9pbnQpIHtcclxuXHRcdHRoaXMueCArPSBwb2ludC54O1xyXG5cdFx0dGhpcy55ICs9IHBvaW50Lnk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRzdWJ0cmFjdDogZnVuY3Rpb24gKHBvaW50KSB7XHJcblx0XHRyZXR1cm4gdGhpcy5jbG9uZSgpLl9zdWJ0cmFjdChMLnBvaW50KHBvaW50KSk7XHJcblx0fSxcclxuXHJcblx0X3N1YnRyYWN0OiBmdW5jdGlvbiAocG9pbnQpIHtcclxuXHRcdHRoaXMueCAtPSBwb2ludC54O1xyXG5cdFx0dGhpcy55IC09IHBvaW50Lnk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRkaXZpZGVCeTogZnVuY3Rpb24gKG51bSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuY2xvbmUoKS5fZGl2aWRlQnkobnVtKTtcclxuXHR9LFxyXG5cclxuXHRfZGl2aWRlQnk6IGZ1bmN0aW9uIChudW0pIHtcclxuXHRcdHRoaXMueCAvPSBudW07XHJcblx0XHR0aGlzLnkgLz0gbnVtO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0bXVsdGlwbHlCeTogZnVuY3Rpb24gKG51bSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuY2xvbmUoKS5fbXVsdGlwbHlCeShudW0pO1xyXG5cdH0sXHJcblxyXG5cdF9tdWx0aXBseUJ5OiBmdW5jdGlvbiAobnVtKSB7XHJcblx0XHR0aGlzLnggKj0gbnVtO1xyXG5cdFx0dGhpcy55ICo9IG51bTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHJvdW5kOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5jbG9uZSgpLl9yb3VuZCgpO1xyXG5cdH0sXHJcblxyXG5cdF9yb3VuZDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy54ID0gTWF0aC5yb3VuZCh0aGlzLngpO1xyXG5cdFx0dGhpcy55ID0gTWF0aC5yb3VuZCh0aGlzLnkpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0Zmxvb3I6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmNsb25lKCkuX2Zsb29yKCk7XHJcblx0fSxcclxuXHJcblx0X2Zsb29yOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR0aGlzLnggPSBNYXRoLmZsb29yKHRoaXMueCk7XHJcblx0XHR0aGlzLnkgPSBNYXRoLmZsb29yKHRoaXMueSk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRkaXN0YW5jZVRvOiBmdW5jdGlvbiAocG9pbnQpIHtcclxuXHRcdHBvaW50ID0gTC5wb2ludChwb2ludCk7XHJcblxyXG5cdFx0dmFyIHggPSBwb2ludC54IC0gdGhpcy54LFxyXG5cdFx0ICAgIHkgPSBwb2ludC55IC0gdGhpcy55O1xyXG5cclxuXHRcdHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSk7XHJcblx0fSxcclxuXHJcblx0ZXF1YWxzOiBmdW5jdGlvbiAocG9pbnQpIHtcclxuXHRcdHBvaW50ID0gTC5wb2ludChwb2ludCk7XHJcblxyXG5cdFx0cmV0dXJuIHBvaW50LnggPT09IHRoaXMueCAmJlxyXG5cdFx0ICAgICAgIHBvaW50LnkgPT09IHRoaXMueTtcclxuXHR9LFxyXG5cclxuXHRjb250YWluczogZnVuY3Rpb24gKHBvaW50KSB7XHJcblx0XHRwb2ludCA9IEwucG9pbnQocG9pbnQpO1xyXG5cclxuXHRcdHJldHVybiBNYXRoLmFicyhwb2ludC54KSA8PSBNYXRoLmFicyh0aGlzLngpICYmXHJcblx0XHQgICAgICAgTWF0aC5hYnMocG9pbnQueSkgPD0gTWF0aC5hYnModGhpcy55KTtcclxuXHR9LFxyXG5cclxuXHR0b1N0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuICdQb2ludCgnICtcclxuXHRcdCAgICAgICAgTC5VdGlsLmZvcm1hdE51bSh0aGlzLngpICsgJywgJyArXHJcblx0XHQgICAgICAgIEwuVXRpbC5mb3JtYXROdW0odGhpcy55KSArICcpJztcclxuXHR9XHJcbn07XHJcblxyXG5MLnBvaW50ID0gZnVuY3Rpb24gKHgsIHksIHJvdW5kKSB7XHJcblx0aWYgKHggaW5zdGFuY2VvZiBMLlBvaW50KSB7XHJcblx0XHRyZXR1cm4geDtcclxuXHR9XHJcblx0aWYgKEwuVXRpbC5pc0FycmF5KHgpKSB7XHJcblx0XHRyZXR1cm4gbmV3IEwuUG9pbnQoeFswXSwgeFsxXSk7XHJcblx0fVxyXG5cdGlmICh4ID09PSB1bmRlZmluZWQgfHwgeCA9PT0gbnVsbCkge1xyXG5cdFx0cmV0dXJuIHg7XHJcblx0fVxyXG5cdHJldHVybiBuZXcgTC5Qb2ludCh4LCB5LCByb3VuZCk7XHJcbn07XHJcblxuXG4vKlxyXG4gKiBMLkJvdW5kcyByZXByZXNlbnRzIGEgcmVjdGFuZ3VsYXIgYXJlYSBvbiB0aGUgc2NyZWVuIGluIHBpeGVsIGNvb3JkaW5hdGVzLlxyXG4gKi9cclxuXHJcbkwuQm91bmRzID0gZnVuY3Rpb24gKGEsIGIpIHsgLy8oUG9pbnQsIFBvaW50KSBvciBQb2ludFtdXHJcblx0aWYgKCFhKSB7IHJldHVybjsgfVxyXG5cclxuXHR2YXIgcG9pbnRzID0gYiA/IFthLCBiXSA6IGE7XHJcblxyXG5cdGZvciAodmFyIGkgPSAwLCBsZW4gPSBwb2ludHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdHRoaXMuZXh0ZW5kKHBvaW50c1tpXSk7XHJcblx0fVxyXG59O1xyXG5cclxuTC5Cb3VuZHMucHJvdG90eXBlID0ge1xyXG5cdC8vIGV4dGVuZCB0aGUgYm91bmRzIHRvIGNvbnRhaW4gdGhlIGdpdmVuIHBvaW50XHJcblx0ZXh0ZW5kOiBmdW5jdGlvbiAocG9pbnQpIHsgLy8gKFBvaW50KVxyXG5cdFx0cG9pbnQgPSBMLnBvaW50KHBvaW50KTtcclxuXHJcblx0XHRpZiAoIXRoaXMubWluICYmICF0aGlzLm1heCkge1xyXG5cdFx0XHR0aGlzLm1pbiA9IHBvaW50LmNsb25lKCk7XHJcblx0XHRcdHRoaXMubWF4ID0gcG9pbnQuY2xvbmUoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMubWluLnggPSBNYXRoLm1pbihwb2ludC54LCB0aGlzLm1pbi54KTtcclxuXHRcdFx0dGhpcy5tYXgueCA9IE1hdGgubWF4KHBvaW50LngsIHRoaXMubWF4LngpO1xyXG5cdFx0XHR0aGlzLm1pbi55ID0gTWF0aC5taW4ocG9pbnQueSwgdGhpcy5taW4ueSk7XHJcblx0XHRcdHRoaXMubWF4LnkgPSBNYXRoLm1heChwb2ludC55LCB0aGlzLm1heC55KTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGdldENlbnRlcjogZnVuY3Rpb24gKHJvdW5kKSB7IC8vIChCb29sZWFuKSAtPiBQb2ludFxyXG5cdFx0cmV0dXJuIG5ldyBMLlBvaW50KFxyXG5cdFx0ICAgICAgICAodGhpcy5taW4ueCArIHRoaXMubWF4LngpIC8gMixcclxuXHRcdCAgICAgICAgKHRoaXMubWluLnkgKyB0aGlzLm1heC55KSAvIDIsIHJvdW5kKTtcclxuXHR9LFxyXG5cclxuXHRnZXRCb3R0b21MZWZ0OiBmdW5jdGlvbiAoKSB7IC8vIC0+IFBvaW50XHJcblx0XHRyZXR1cm4gbmV3IEwuUG9pbnQodGhpcy5taW4ueCwgdGhpcy5tYXgueSk7XHJcblx0fSxcclxuXHJcblx0Z2V0VG9wUmlnaHQ6IGZ1bmN0aW9uICgpIHsgLy8gLT4gUG9pbnRcclxuXHRcdHJldHVybiBuZXcgTC5Qb2ludCh0aGlzLm1heC54LCB0aGlzLm1pbi55KTtcclxuXHR9LFxyXG5cclxuXHRnZXRTaXplOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5tYXguc3VidHJhY3QodGhpcy5taW4pO1xyXG5cdH0sXHJcblxyXG5cdGNvbnRhaW5zOiBmdW5jdGlvbiAob2JqKSB7IC8vIChCb3VuZHMpIG9yIChQb2ludCkgLT4gQm9vbGVhblxyXG5cdFx0dmFyIG1pbiwgbWF4O1xyXG5cclxuXHRcdGlmICh0eXBlb2Ygb2JqWzBdID09PSAnbnVtYmVyJyB8fCBvYmogaW5zdGFuY2VvZiBMLlBvaW50KSB7XHJcblx0XHRcdG9iaiA9IEwucG9pbnQob2JqKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdG9iaiA9IEwuYm91bmRzKG9iaik7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKG9iaiBpbnN0YW5jZW9mIEwuQm91bmRzKSB7XHJcblx0XHRcdG1pbiA9IG9iai5taW47XHJcblx0XHRcdG1heCA9IG9iai5tYXg7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRtaW4gPSBtYXggPSBvYmo7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIChtaW4ueCA+PSB0aGlzLm1pbi54KSAmJlxyXG5cdFx0ICAgICAgIChtYXgueCA8PSB0aGlzLm1heC54KSAmJlxyXG5cdFx0ICAgICAgIChtaW4ueSA+PSB0aGlzLm1pbi55KSAmJlxyXG5cdFx0ICAgICAgIChtYXgueSA8PSB0aGlzLm1heC55KTtcclxuXHR9LFxyXG5cclxuXHRpbnRlcnNlY3RzOiBmdW5jdGlvbiAoYm91bmRzKSB7IC8vIChCb3VuZHMpIC0+IEJvb2xlYW5cclxuXHRcdGJvdW5kcyA9IEwuYm91bmRzKGJvdW5kcyk7XHJcblxyXG5cdFx0dmFyIG1pbiA9IHRoaXMubWluLFxyXG5cdFx0ICAgIG1heCA9IHRoaXMubWF4LFxyXG5cdFx0ICAgIG1pbjIgPSBib3VuZHMubWluLFxyXG5cdFx0ICAgIG1heDIgPSBib3VuZHMubWF4LFxyXG5cdFx0ICAgIHhJbnRlcnNlY3RzID0gKG1heDIueCA+PSBtaW4ueCkgJiYgKG1pbjIueCA8PSBtYXgueCksXHJcblx0XHQgICAgeUludGVyc2VjdHMgPSAobWF4Mi55ID49IG1pbi55KSAmJiAobWluMi55IDw9IG1heC55KTtcclxuXHJcblx0XHRyZXR1cm4geEludGVyc2VjdHMgJiYgeUludGVyc2VjdHM7XHJcblx0fSxcclxuXHJcblx0aXNWYWxpZDogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuICEhKHRoaXMubWluICYmIHRoaXMubWF4KTtcclxuXHR9XHJcbn07XHJcblxyXG5MLmJvdW5kcyA9IGZ1bmN0aW9uIChhLCBiKSB7IC8vIChCb3VuZHMpIG9yIChQb2ludCwgUG9pbnQpIG9yIChQb2ludFtdKVxyXG5cdGlmICghYSB8fCBhIGluc3RhbmNlb2YgTC5Cb3VuZHMpIHtcclxuXHRcdHJldHVybiBhO1xyXG5cdH1cclxuXHRyZXR1cm4gbmV3IEwuQm91bmRzKGEsIGIpO1xyXG59O1xyXG5cblxuLypcclxuICogTC5UcmFuc2Zvcm1hdGlvbiBpcyBhbiB1dGlsaXR5IGNsYXNzIHRvIHBlcmZvcm0gc2ltcGxlIHBvaW50IHRyYW5zZm9ybWF0aW9ucyB0aHJvdWdoIGEgMmQtbWF0cml4LlxyXG4gKi9cclxuXHJcbkwuVHJhbnNmb3JtYXRpb24gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkge1xyXG5cdHRoaXMuX2EgPSBhO1xyXG5cdHRoaXMuX2IgPSBiO1xyXG5cdHRoaXMuX2MgPSBjO1xyXG5cdHRoaXMuX2QgPSBkO1xyXG59O1xyXG5cclxuTC5UcmFuc2Zvcm1hdGlvbi5wcm90b3R5cGUgPSB7XHJcblx0dHJhbnNmb3JtOiBmdW5jdGlvbiAocG9pbnQsIHNjYWxlKSB7IC8vIChQb2ludCwgTnVtYmVyKSAtPiBQb2ludFxyXG5cdFx0cmV0dXJuIHRoaXMuX3RyYW5zZm9ybShwb2ludC5jbG9uZSgpLCBzY2FsZSk7XHJcblx0fSxcclxuXHJcblx0Ly8gZGVzdHJ1Y3RpdmUgdHJhbnNmb3JtIChmYXN0ZXIpXHJcblx0X3RyYW5zZm9ybTogZnVuY3Rpb24gKHBvaW50LCBzY2FsZSkge1xyXG5cdFx0c2NhbGUgPSBzY2FsZSB8fCAxO1xyXG5cdFx0cG9pbnQueCA9IHNjYWxlICogKHRoaXMuX2EgKiBwb2ludC54ICsgdGhpcy5fYik7XHJcblx0XHRwb2ludC55ID0gc2NhbGUgKiAodGhpcy5fYyAqIHBvaW50LnkgKyB0aGlzLl9kKTtcclxuXHRcdHJldHVybiBwb2ludDtcclxuXHR9LFxyXG5cclxuXHR1bnRyYW5zZm9ybTogZnVuY3Rpb24gKHBvaW50LCBzY2FsZSkge1xyXG5cdFx0c2NhbGUgPSBzY2FsZSB8fCAxO1xyXG5cdFx0cmV0dXJuIG5ldyBMLlBvaW50KFxyXG5cdFx0ICAgICAgICAocG9pbnQueCAvIHNjYWxlIC0gdGhpcy5fYikgLyB0aGlzLl9hLFxyXG5cdFx0ICAgICAgICAocG9pbnQueSAvIHNjYWxlIC0gdGhpcy5fZCkgLyB0aGlzLl9jKTtcclxuXHR9XHJcbn07XHJcblxuXG4vKlxyXG4gKiBMLkRvbVV0aWwgY29udGFpbnMgdmFyaW91cyB1dGlsaXR5IGZ1bmN0aW9ucyBmb3Igd29ya2luZyB3aXRoIERPTS5cclxuICovXHJcblxyXG5MLkRvbVV0aWwgPSB7XHJcblx0Z2V0OiBmdW5jdGlvbiAoaWQpIHtcclxuXHRcdHJldHVybiAodHlwZW9mIGlkID09PSAnc3RyaW5nJyA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSA6IGlkKTtcclxuXHR9LFxyXG5cclxuXHRnZXRTdHlsZTogZnVuY3Rpb24gKGVsLCBzdHlsZSkge1xyXG5cclxuXHRcdHZhciB2YWx1ZSA9IGVsLnN0eWxlW3N0eWxlXTtcclxuXHJcblx0XHRpZiAoIXZhbHVlICYmIGVsLmN1cnJlbnRTdHlsZSkge1xyXG5cdFx0XHR2YWx1ZSA9IGVsLmN1cnJlbnRTdHlsZVtzdHlsZV07XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCghdmFsdWUgfHwgdmFsdWUgPT09ICdhdXRvJykgJiYgZG9jdW1lbnQuZGVmYXVsdFZpZXcpIHtcclxuXHRcdFx0dmFyIGNzcyA9IGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWwsIG51bGwpO1xyXG5cdFx0XHR2YWx1ZSA9IGNzcyA/IGNzc1tzdHlsZV0gOiBudWxsO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB2YWx1ZSA9PT0gJ2F1dG8nID8gbnVsbCA6IHZhbHVlO1xyXG5cdH0sXHJcblxyXG5cdGdldFZpZXdwb3J0T2Zmc2V0OiBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG5cclxuXHRcdHZhciB0b3AgPSAwLFxyXG5cdFx0ICAgIGxlZnQgPSAwLFxyXG5cdFx0ICAgIGVsID0gZWxlbWVudCxcclxuXHRcdCAgICBkb2NCb2R5ID0gZG9jdW1lbnQuYm9keSxcclxuXHRcdCAgICBkb2NFbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxcclxuXHRcdCAgICBwb3M7XHJcblxyXG5cdFx0ZG8ge1xyXG5cdFx0XHR0b3AgICs9IGVsLm9mZnNldFRvcCAgfHwgMDtcclxuXHRcdFx0bGVmdCArPSBlbC5vZmZzZXRMZWZ0IHx8IDA7XHJcblxyXG5cdFx0XHQvL2FkZCBib3JkZXJzXHJcblx0XHRcdHRvcCArPSBwYXJzZUludChMLkRvbVV0aWwuZ2V0U3R5bGUoZWwsICdib3JkZXJUb3BXaWR0aCcpLCAxMCkgfHwgMDtcclxuXHRcdFx0bGVmdCArPSBwYXJzZUludChMLkRvbVV0aWwuZ2V0U3R5bGUoZWwsICdib3JkZXJMZWZ0V2lkdGgnKSwgMTApIHx8IDA7XHJcblxyXG5cdFx0XHRwb3MgPSBMLkRvbVV0aWwuZ2V0U3R5bGUoZWwsICdwb3NpdGlvbicpO1xyXG5cclxuXHRcdFx0aWYgKGVsLm9mZnNldFBhcmVudCA9PT0gZG9jQm9keSAmJiBwb3MgPT09ICdhYnNvbHV0ZScpIHsgYnJlYWs7IH1cclxuXHJcblx0XHRcdGlmIChwb3MgPT09ICdmaXhlZCcpIHtcclxuXHRcdFx0XHR0b3AgICs9IGRvY0JvZHkuc2Nyb2xsVG9wICB8fCBkb2NFbC5zY3JvbGxUb3AgIHx8IDA7XHJcblx0XHRcdFx0bGVmdCArPSBkb2NCb2R5LnNjcm9sbExlZnQgfHwgZG9jRWwuc2Nyb2xsTGVmdCB8fCAwO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAocG9zID09PSAncmVsYXRpdmUnICYmICFlbC5vZmZzZXRMZWZ0KSB7XHJcblx0XHRcdFx0dmFyIHdpZHRoID0gTC5Eb21VdGlsLmdldFN0eWxlKGVsLCAnd2lkdGgnKSxcclxuXHRcdFx0XHQgICAgbWF4V2lkdGggPSBMLkRvbVV0aWwuZ2V0U3R5bGUoZWwsICdtYXgtd2lkdGgnKSxcclxuXHRcdFx0XHQgICAgciA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuXHRcdFx0XHRpZiAod2lkdGggIT09ICdub25lJyB8fCBtYXhXaWR0aCAhPT0gJ25vbmUnKSB7XHJcblx0XHRcdFx0XHRsZWZ0ICs9IHIubGVmdCArIGVsLmNsaWVudExlZnQ7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvL2NhbGN1bGF0ZSBmdWxsIHkgb2Zmc2V0IHNpbmNlIHdlJ3JlIGJyZWFraW5nIG91dCBvZiB0aGUgbG9vcFxyXG5cdFx0XHRcdHRvcCArPSByLnRvcCArIChkb2NCb2R5LnNjcm9sbFRvcCAgfHwgZG9jRWwuc2Nyb2xsVG9wICB8fCAwKTtcclxuXHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGVsID0gZWwub2Zmc2V0UGFyZW50O1xyXG5cclxuXHRcdH0gd2hpbGUgKGVsKTtcclxuXHJcblx0XHRlbCA9IGVsZW1lbnQ7XHJcblxyXG5cdFx0ZG8ge1xyXG5cdFx0XHRpZiAoZWwgPT09IGRvY0JvZHkpIHsgYnJlYWs7IH1cclxuXHJcblx0XHRcdHRvcCAgLT0gZWwuc2Nyb2xsVG9wICB8fCAwO1xyXG5cdFx0XHRsZWZ0IC09IGVsLnNjcm9sbExlZnQgfHwgMDtcclxuXHJcblx0XHRcdGVsID0gZWwucGFyZW50Tm9kZTtcclxuXHRcdH0gd2hpbGUgKGVsKTtcclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuUG9pbnQobGVmdCwgdG9wKTtcclxuXHR9LFxyXG5cclxuXHRkb2N1bWVudElzTHRyOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIUwuRG9tVXRpbC5fZG9jSXNMdHJDYWNoZWQpIHtcclxuXHRcdFx0TC5Eb21VdGlsLl9kb2NJc0x0ckNhY2hlZCA9IHRydWU7XHJcblx0XHRcdEwuRG9tVXRpbC5fZG9jSXNMdHIgPSBMLkRvbVV0aWwuZ2V0U3R5bGUoZG9jdW1lbnQuYm9keSwgJ2RpcmVjdGlvbicpID09PSAnbHRyJztcclxuXHRcdH1cclxuXHRcdHJldHVybiBMLkRvbVV0aWwuX2RvY0lzTHRyO1xyXG5cdH0sXHJcblxyXG5cdGNyZWF0ZTogZnVuY3Rpb24gKHRhZ05hbWUsIGNsYXNzTmFtZSwgY29udGFpbmVyKSB7XHJcblxyXG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcclxuXHRcdGVsLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcclxuXHJcblx0XHRpZiAoY29udGFpbmVyKSB7XHJcblx0XHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZChlbCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGVsO1xyXG5cdH0sXHJcblxyXG5cdGhhc0NsYXNzOiBmdW5jdGlvbiAoZWwsIG5hbWUpIHtcclxuXHRcdGlmIChlbC5jbGFzc0xpc3QgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRyZXR1cm4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKG5hbWUpO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGNsYXNzTmFtZSA9IEwuRG9tVXRpbC5fZ2V0Q2xhc3MoZWwpO1xyXG5cdFx0cmV0dXJuIGNsYXNzTmFtZS5sZW5ndGggPiAwICYmIG5ldyBSZWdFeHAoJyhefFxcXFxzKScgKyBuYW1lICsgJyhcXFxcc3wkKScpLnRlc3QoY2xhc3NOYW1lKTtcclxuXHR9LFxyXG5cclxuXHRhZGRDbGFzczogZnVuY3Rpb24gKGVsLCBuYW1lKSB7XHJcblx0XHRpZiAoZWwuY2xhc3NMaXN0ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0dmFyIGNsYXNzZXMgPSBMLlV0aWwuc3BsaXRXb3JkcyhuYW1lKTtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGNsYXNzZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0XHRlbC5jbGFzc0xpc3QuYWRkKGNsYXNzZXNbaV0pO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKCFMLkRvbVV0aWwuaGFzQ2xhc3MoZWwsIG5hbWUpKSB7XHJcblx0XHRcdHZhciBjbGFzc05hbWUgPSBMLkRvbVV0aWwuX2dldENsYXNzKGVsKTtcclxuXHRcdFx0TC5Eb21VdGlsLl9zZXRDbGFzcyhlbCwgKGNsYXNzTmFtZSA/IGNsYXNzTmFtZSArICcgJyA6ICcnKSArIG5hbWUpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdHJlbW92ZUNsYXNzOiBmdW5jdGlvbiAoZWwsIG5hbWUpIHtcclxuXHRcdGlmIChlbC5jbGFzc0xpc3QgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRlbC5jbGFzc0xpc3QucmVtb3ZlKG5hbWUpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0TC5Eb21VdGlsLl9zZXRDbGFzcyhlbCwgTC5VdGlsLnRyaW0oKCcgJyArIEwuRG9tVXRpbC5fZ2V0Q2xhc3MoZWwpICsgJyAnKS5yZXBsYWNlKCcgJyArIG5hbWUgKyAnICcsICcgJykpKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfc2V0Q2xhc3M6IGZ1bmN0aW9uIChlbCwgbmFtZSkge1xyXG5cdFx0aWYgKGVsLmNsYXNzTmFtZS5iYXNlVmFsID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0ZWwuY2xhc3NOYW1lID0gbmFtZTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIGluIGNhc2Ugb2YgU1ZHIGVsZW1lbnRcclxuXHRcdFx0ZWwuY2xhc3NOYW1lLmJhc2VWYWwgPSBuYW1lO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9nZXRDbGFzczogZnVuY3Rpb24gKGVsKSB7XHJcblx0XHRyZXR1cm4gZWwuY2xhc3NOYW1lLmJhc2VWYWwgPT09IHVuZGVmaW5lZCA/IGVsLmNsYXNzTmFtZSA6IGVsLmNsYXNzTmFtZS5iYXNlVmFsO1xyXG5cdH0sXHJcblxyXG5cdHNldE9wYWNpdHk6IGZ1bmN0aW9uIChlbCwgdmFsdWUpIHtcclxuXHJcblx0XHRpZiAoJ29wYWNpdHknIGluIGVsLnN0eWxlKSB7XHJcblx0XHRcdGVsLnN0eWxlLm9wYWNpdHkgPSB2YWx1ZTtcclxuXHJcblx0XHR9IGVsc2UgaWYgKCdmaWx0ZXInIGluIGVsLnN0eWxlKSB7XHJcblxyXG5cdFx0XHR2YXIgZmlsdGVyID0gZmFsc2UsXHJcblx0XHRcdCAgICBmaWx0ZXJOYW1lID0gJ0RYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LkFscGhhJztcclxuXHJcblx0XHRcdC8vIGZpbHRlcnMgY29sbGVjdGlvbiB0aHJvd3MgYW4gZXJyb3IgaWYgd2UgdHJ5IHRvIHJldHJpZXZlIGEgZmlsdGVyIHRoYXQgZG9lc24ndCBleGlzdFxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGZpbHRlciA9IGVsLmZpbHRlcnMuaXRlbShmaWx0ZXJOYW1lKTtcclxuXHRcdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRcdC8vIGRvbid0IHNldCBvcGFjaXR5IHRvIDEgaWYgd2UgaGF2ZW4ndCBhbHJlYWR5IHNldCBhbiBvcGFjaXR5LFxyXG5cdFx0XHRcdC8vIGl0IGlzbid0IG5lZWRlZCBhbmQgYnJlYWtzIHRyYW5zcGFyZW50IHBuZ3MuXHJcblx0XHRcdFx0aWYgKHZhbHVlID09PSAxKSB7IHJldHVybjsgfVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YWx1ZSA9IE1hdGgucm91bmQodmFsdWUgKiAxMDApO1xyXG5cclxuXHRcdFx0aWYgKGZpbHRlcikge1xyXG5cdFx0XHRcdGZpbHRlci5FbmFibGVkID0gKHZhbHVlICE9PSAxMDApO1xyXG5cdFx0XHRcdGZpbHRlci5PcGFjaXR5ID0gdmFsdWU7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZWwuc3R5bGUuZmlsdGVyICs9ICcgcHJvZ2lkOicgKyBmaWx0ZXJOYW1lICsgJyhvcGFjaXR5PScgKyB2YWx1ZSArICcpJztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdHRlc3RQcm9wOiBmdW5jdGlvbiAocHJvcHMpIHtcclxuXHJcblx0XHR2YXIgc3R5bGUgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGU7XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRpZiAocHJvcHNbaV0gaW4gc3R5bGUpIHtcclxuXHRcdFx0XHRyZXR1cm4gcHJvcHNbaV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHRnZXRUcmFuc2xhdGVTdHJpbmc6IGZ1bmN0aW9uIChwb2ludCkge1xyXG5cdFx0Ly8gb24gV2ViS2l0IGJyb3dzZXJzIChDaHJvbWUvU2FmYXJpL2lPUyBTYWZhcmkvQW5kcm9pZCkgdXNpbmcgdHJhbnNsYXRlM2QgaW5zdGVhZCBvZiB0cmFuc2xhdGVcclxuXHRcdC8vIG1ha2VzIGFuaW1hdGlvbiBzbW9vdGhlciBhcyBpdCBlbnN1cmVzIEhXIGFjY2VsIGlzIHVzZWQuIEZpcmVmb3ggMTMgZG9lc24ndCBjYXJlXHJcblx0XHQvLyAoc2FtZSBzcGVlZCBlaXRoZXIgd2F5KSwgT3BlcmEgMTIgZG9lc24ndCBzdXBwb3J0IHRyYW5zbGF0ZTNkXHJcblxyXG5cdFx0dmFyIGlzM2QgPSBMLkJyb3dzZXIud2Via2l0M2QsXHJcblx0XHQgICAgb3BlbiA9ICd0cmFuc2xhdGUnICsgKGlzM2QgPyAnM2QnIDogJycpICsgJygnLFxyXG5cdFx0ICAgIGNsb3NlID0gKGlzM2QgPyAnLDAnIDogJycpICsgJyknO1xyXG5cclxuXHRcdHJldHVybiBvcGVuICsgcG9pbnQueCArICdweCwnICsgcG9pbnQueSArICdweCcgKyBjbG9zZTtcclxuXHR9LFxyXG5cclxuXHRnZXRTY2FsZVN0cmluZzogZnVuY3Rpb24gKHNjYWxlLCBvcmlnaW4pIHtcclxuXHJcblx0XHR2YXIgcHJlVHJhbnNsYXRlU3RyID0gTC5Eb21VdGlsLmdldFRyYW5zbGF0ZVN0cmluZyhvcmlnaW4uYWRkKG9yaWdpbi5tdWx0aXBseUJ5KC0xICogc2NhbGUpKSksXHJcblx0XHQgICAgc2NhbGVTdHIgPSAnIHNjYWxlKCcgKyBzY2FsZSArICcpICc7XHJcblxyXG5cdFx0cmV0dXJuIHByZVRyYW5zbGF0ZVN0ciArIHNjYWxlU3RyO1xyXG5cdH0sXHJcblxyXG5cdHNldFBvc2l0aW9uOiBmdW5jdGlvbiAoZWwsIHBvaW50LCBkaXNhYmxlM0QpIHsgLy8gKEhUTUxFbGVtZW50LCBQb2ludFssIEJvb2xlYW5dKVxyXG5cclxuXHRcdC8vIGpzaGludCBjYW1lbGNhc2U6IGZhbHNlXHJcblx0XHRlbC5fbGVhZmxldF9wb3MgPSBwb2ludDtcclxuXHJcblx0XHRpZiAoIWRpc2FibGUzRCAmJiBMLkJyb3dzZXIuYW55M2QpIHtcclxuXHRcdFx0ZWwuc3R5bGVbTC5Eb21VdGlsLlRSQU5TRk9STV0gPSAgTC5Eb21VdGlsLmdldFRyYW5zbGF0ZVN0cmluZyhwb2ludCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRlbC5zdHlsZS5sZWZ0ID0gcG9pbnQueCArICdweCc7XHJcblx0XHRcdGVsLnN0eWxlLnRvcCA9IHBvaW50LnkgKyAncHgnO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGdldFBvc2l0aW9uOiBmdW5jdGlvbiAoZWwpIHtcclxuXHRcdC8vIHRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBmb3IgZWxlbWVudHMgcHJldmlvdXNseSBwb3NpdGlvbmVkIHVzaW5nIHNldFBvc2l0aW9uLFxyXG5cdFx0Ly8gc28gaXQncyBzYWZlIHRvIGNhY2hlIHRoZSBwb3NpdGlvbiBmb3IgcGVyZm9ybWFuY2VcclxuXHJcblx0XHQvLyBqc2hpbnQgY2FtZWxjYXNlOiBmYWxzZVxyXG5cdFx0cmV0dXJuIGVsLl9sZWFmbGV0X3BvcztcclxuXHR9XHJcbn07XHJcblxyXG5cclxuLy8gcHJlZml4IHN0eWxlIHByb3BlcnR5IG5hbWVzXHJcblxyXG5MLkRvbVV0aWwuVFJBTlNGT1JNID0gTC5Eb21VdGlsLnRlc3RQcm9wKFxyXG4gICAgICAgIFsndHJhbnNmb3JtJywgJ1dlYmtpdFRyYW5zZm9ybScsICdPVHJhbnNmb3JtJywgJ01velRyYW5zZm9ybScsICdtc1RyYW5zZm9ybSddKTtcclxuXHJcbi8vIHdlYmtpdFRyYW5zaXRpb24gY29tZXMgZmlyc3QgYmVjYXVzZSBzb21lIGJyb3dzZXIgdmVyc2lvbnMgdGhhdCBkcm9wIHZlbmRvciBwcmVmaXggZG9uJ3QgZG9cclxuLy8gdGhlIHNhbWUgZm9yIHRoZSB0cmFuc2l0aW9uZW5kIGV2ZW50LCBpbiBwYXJ0aWN1bGFyIHRoZSBBbmRyb2lkIDQuMSBzdG9jayBicm93c2VyXHJcblxyXG5MLkRvbVV0aWwuVFJBTlNJVElPTiA9IEwuRG9tVXRpbC50ZXN0UHJvcChcclxuICAgICAgICBbJ3dlYmtpdFRyYW5zaXRpb24nLCAndHJhbnNpdGlvbicsICdPVHJhbnNpdGlvbicsICdNb3pUcmFuc2l0aW9uJywgJ21zVHJhbnNpdGlvbiddKTtcclxuXHJcbkwuRG9tVXRpbC5UUkFOU0lUSU9OX0VORCA9XHJcbiAgICAgICAgTC5Eb21VdGlsLlRSQU5TSVRJT04gPT09ICd3ZWJraXRUcmFuc2l0aW9uJyB8fCBMLkRvbVV0aWwuVFJBTlNJVElPTiA9PT0gJ09UcmFuc2l0aW9uJyA/XHJcbiAgICAgICAgTC5Eb21VdGlsLlRSQU5TSVRJT04gKyAnRW5kJyA6ICd0cmFuc2l0aW9uZW5kJztcclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoJ29uc2VsZWN0c3RhcnQnIGluIGRvY3VtZW50KSB7XHJcbiAgICAgICAgTC5leHRlbmQoTC5Eb21VdGlsLCB7XHJcbiAgICAgICAgICAgIGRpc2FibGVUZXh0U2VsZWN0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBMLkRvbUV2ZW50Lm9uKHdpbmRvdywgJ3NlbGVjdHN0YXJ0JywgTC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBlbmFibGVUZXh0U2VsZWN0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBMLkRvbUV2ZW50Lm9mZih3aW5kb3csICdzZWxlY3RzdGFydCcsIEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciB1c2VyU2VsZWN0UHJvcGVydHkgPSBMLkRvbVV0aWwudGVzdFByb3AoXHJcbiAgICAgICAgICAgIFsndXNlclNlbGVjdCcsICdXZWJraXRVc2VyU2VsZWN0JywgJ09Vc2VyU2VsZWN0JywgJ01velVzZXJTZWxlY3QnLCAnbXNVc2VyU2VsZWN0J10pO1xyXG5cclxuICAgICAgICBMLmV4dGVuZChMLkRvbVV0aWwsIHtcclxuICAgICAgICAgICAgZGlzYWJsZVRleHRTZWxlY3Rpb246IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyU2VsZWN0UHJvcGVydHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXNlclNlbGVjdCA9IHN0eWxlW3VzZXJTZWxlY3RQcm9wZXJ0eV07XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVbdXNlclNlbGVjdFByb3BlcnR5XSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGVuYWJsZVRleHRTZWxlY3Rpb246IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyU2VsZWN0UHJvcGVydHkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGVbdXNlclNlbGVjdFByb3BlcnR5XSA9IHRoaXMuX3VzZXJTZWxlY3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3VzZXJTZWxlY3Q7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblx0TC5leHRlbmQoTC5Eb21VdGlsLCB7XHJcblx0XHRkaXNhYmxlSW1hZ2VEcmFnOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdEwuRG9tRXZlbnQub24od2luZG93LCAnZHJhZ3N0YXJ0JywgTC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGVuYWJsZUltYWdlRHJhZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRMLkRvbUV2ZW50Lm9mZih3aW5kb3csICdkcmFnc3RhcnQnLCBMLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KTtcclxuXHRcdH1cclxuXHR9KTtcclxufSkoKTtcclxuXG5cbi8qXHJcbiAqIEwuTGF0TG5nIHJlcHJlc2VudHMgYSBnZW9ncmFwaGljYWwgcG9pbnQgd2l0aCBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGVzLlxyXG4gKi9cclxuXHJcbkwuTGF0TG5nID0gZnVuY3Rpb24gKGxhdCwgbG5nLCBhbHQpIHsgLy8gKE51bWJlciwgTnVtYmVyLCBOdW1iZXIpXHJcblx0bGF0ID0gcGFyc2VGbG9hdChsYXQpO1xyXG5cdGxuZyA9IHBhcnNlRmxvYXQobG5nKTtcclxuXHJcblx0aWYgKGlzTmFOKGxhdCkgfHwgaXNOYU4obG5nKSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIExhdExuZyBvYmplY3Q6ICgnICsgbGF0ICsgJywgJyArIGxuZyArICcpJyk7XHJcblx0fVxyXG5cclxuXHR0aGlzLmxhdCA9IGxhdDtcclxuXHR0aGlzLmxuZyA9IGxuZztcclxuXHJcblx0aWYgKGFsdCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHR0aGlzLmFsdCA9IHBhcnNlRmxvYXQoYWx0KTtcclxuXHR9XHJcbn07XHJcblxyXG5MLmV4dGVuZChMLkxhdExuZywge1xyXG5cdERFR19UT19SQUQ6IE1hdGguUEkgLyAxODAsXHJcblx0UkFEX1RPX0RFRzogMTgwIC8gTWF0aC5QSSxcclxuXHRNQVhfTUFSR0lOOiAxLjBFLTkgLy8gbWF4IG1hcmdpbiBvZiBlcnJvciBmb3IgdGhlIFwiZXF1YWxzXCIgY2hlY2tcclxufSk7XHJcblxyXG5MLkxhdExuZy5wcm90b3R5cGUgPSB7XHJcblx0ZXF1YWxzOiBmdW5jdGlvbiAob2JqKSB7IC8vIChMYXRMbmcpIC0+IEJvb2xlYW5cclxuXHRcdGlmICghb2JqKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cclxuXHRcdG9iaiA9IEwubGF0TG5nKG9iaik7XHJcblxyXG5cdFx0dmFyIG1hcmdpbiA9IE1hdGgubWF4KFxyXG5cdFx0ICAgICAgICBNYXRoLmFicyh0aGlzLmxhdCAtIG9iai5sYXQpLFxyXG5cdFx0ICAgICAgICBNYXRoLmFicyh0aGlzLmxuZyAtIG9iai5sbmcpKTtcclxuXHJcblx0XHRyZXR1cm4gbWFyZ2luIDw9IEwuTGF0TG5nLk1BWF9NQVJHSU47XHJcblx0fSxcclxuXHJcblx0dG9TdHJpbmc6IGZ1bmN0aW9uIChwcmVjaXNpb24pIHsgLy8gKE51bWJlcikgLT4gU3RyaW5nXHJcblx0XHRyZXR1cm4gJ0xhdExuZygnICtcclxuXHRcdCAgICAgICAgTC5VdGlsLmZvcm1hdE51bSh0aGlzLmxhdCwgcHJlY2lzaW9uKSArICcsICcgK1xyXG5cdFx0ICAgICAgICBMLlV0aWwuZm9ybWF0TnVtKHRoaXMubG5nLCBwcmVjaXNpb24pICsgJyknO1xyXG5cdH0sXHJcblxyXG5cdC8vIEhhdmVyc2luZSBkaXN0YW5jZSBmb3JtdWxhLCBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9IYXZlcnNpbmVfZm9ybXVsYVxyXG5cdC8vIFRPRE8gbW92ZSB0byBwcm9qZWN0aW9uIGNvZGUsIExhdExuZyBzaG91bGRuJ3Qga25vdyBhYm91dCBFYXJ0aFxyXG5cdGRpc3RhbmNlVG86IGZ1bmN0aW9uIChvdGhlcikgeyAvLyAoTGF0TG5nKSAtPiBOdW1iZXJcclxuXHRcdG90aGVyID0gTC5sYXRMbmcob3RoZXIpO1xyXG5cclxuXHRcdHZhciBSID0gNjM3ODEzNywgLy8gZWFydGggcmFkaXVzIGluIG1ldGVyc1xyXG5cdFx0ICAgIGQyciA9IEwuTGF0TG5nLkRFR19UT19SQUQsXHJcblx0XHQgICAgZExhdCA9IChvdGhlci5sYXQgLSB0aGlzLmxhdCkgKiBkMnIsXHJcblx0XHQgICAgZExvbiA9IChvdGhlci5sbmcgLSB0aGlzLmxuZykgKiBkMnIsXHJcblx0XHQgICAgbGF0MSA9IHRoaXMubGF0ICogZDJyLFxyXG5cdFx0ICAgIGxhdDIgPSBvdGhlci5sYXQgKiBkMnIsXHJcblx0XHQgICAgc2luMSA9IE1hdGguc2luKGRMYXQgLyAyKSxcclxuXHRcdCAgICBzaW4yID0gTWF0aC5zaW4oZExvbiAvIDIpO1xyXG5cclxuXHRcdHZhciBhID0gc2luMSAqIHNpbjEgKyBzaW4yICogc2luMiAqIE1hdGguY29zKGxhdDEpICogTWF0aC5jb3MobGF0Mik7XHJcblxyXG5cdFx0cmV0dXJuIFIgKiAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxIC0gYSkpO1xyXG5cdH0sXHJcblxyXG5cdHdyYXA6IGZ1bmN0aW9uIChhLCBiKSB7IC8vIChOdW1iZXIsIE51bWJlcikgLT4gTGF0TG5nXHJcblx0XHR2YXIgbG5nID0gdGhpcy5sbmc7XHJcblxyXG5cdFx0YSA9IGEgfHwgLTE4MDtcclxuXHRcdGIgPSBiIHx8ICAxODA7XHJcblxyXG5cdFx0bG5nID0gKGxuZyArIGIpICUgKGIgLSBhKSArIChsbmcgPCBhIHx8IGxuZyA9PT0gYiA/IGIgOiBhKTtcclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuTGF0TG5nKHRoaXMubGF0LCBsbmcpO1xyXG5cdH1cclxufTtcclxuXHJcbkwubGF0TG5nID0gZnVuY3Rpb24gKGEsIGIpIHsgLy8gKExhdExuZykgb3IgKFtOdW1iZXIsIE51bWJlcl0pIG9yIChOdW1iZXIsIE51bWJlcilcclxuXHRpZiAoYSBpbnN0YW5jZW9mIEwuTGF0TG5nKSB7XHJcblx0XHRyZXR1cm4gYTtcclxuXHR9XHJcblx0aWYgKEwuVXRpbC5pc0FycmF5KGEpKSB7XHJcblx0XHRpZiAodHlwZW9mIGFbMF0gPT09ICdudW1iZXInIHx8IHR5cGVvZiBhWzBdID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRyZXR1cm4gbmV3IEwuTGF0TG5nKGFbMF0sIGFbMV0sIGFbMl0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0fVxyXG5cdGlmIChhID09PSB1bmRlZmluZWQgfHwgYSA9PT0gbnVsbCkge1xyXG5cdFx0cmV0dXJuIGE7XHJcblx0fVxyXG5cdGlmICh0eXBlb2YgYSA9PT0gJ29iamVjdCcgJiYgJ2xhdCcgaW4gYSkge1xyXG5cdFx0cmV0dXJuIG5ldyBMLkxhdExuZyhhLmxhdCwgJ2xuZycgaW4gYSA/IGEubG5nIDogYS5sb24pO1xyXG5cdH1cclxuXHRpZiAoYiA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblx0cmV0dXJuIG5ldyBMLkxhdExuZyhhLCBiKTtcclxufTtcclxuXHJcblxuXG4vKlxyXG4gKiBMLkxhdExuZ0JvdW5kcyByZXByZXNlbnRzIGEgcmVjdGFuZ3VsYXIgYXJlYSBvbiB0aGUgbWFwIGluIGdlb2dyYXBoaWNhbCBjb29yZGluYXRlcy5cclxuICovXHJcblxyXG5MLkxhdExuZ0JvdW5kcyA9IGZ1bmN0aW9uIChzb3V0aFdlc3QsIG5vcnRoRWFzdCkgeyAvLyAoTGF0TG5nLCBMYXRMbmcpIG9yIChMYXRMbmdbXSlcclxuXHRpZiAoIXNvdXRoV2VzdCkgeyByZXR1cm47IH1cclxuXHJcblx0dmFyIGxhdGxuZ3MgPSBub3J0aEVhc3QgPyBbc291dGhXZXN0LCBub3J0aEVhc3RdIDogc291dGhXZXN0O1xyXG5cclxuXHRmb3IgKHZhciBpID0gMCwgbGVuID0gbGF0bG5ncy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0dGhpcy5leHRlbmQobGF0bG5nc1tpXSk7XHJcblx0fVxyXG59O1xyXG5cclxuTC5MYXRMbmdCb3VuZHMucHJvdG90eXBlID0ge1xyXG5cdC8vIGV4dGVuZCB0aGUgYm91bmRzIHRvIGNvbnRhaW4gdGhlIGdpdmVuIHBvaW50IG9yIGJvdW5kc1xyXG5cdGV4dGVuZDogZnVuY3Rpb24gKG9iaikgeyAvLyAoTGF0TG5nKSBvciAoTGF0TG5nQm91bmRzKVxyXG5cdFx0aWYgKCFvYmopIHsgcmV0dXJuIHRoaXM7IH1cclxuXHJcblx0XHR2YXIgbGF0TG5nID0gTC5sYXRMbmcob2JqKTtcclxuXHRcdGlmIChsYXRMbmcgIT09IG51bGwpIHtcclxuXHRcdFx0b2JqID0gbGF0TG5nO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0b2JqID0gTC5sYXRMbmdCb3VuZHMob2JqKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAob2JqIGluc3RhbmNlb2YgTC5MYXRMbmcpIHtcclxuXHRcdFx0aWYgKCF0aGlzLl9zb3V0aFdlc3QgJiYgIXRoaXMuX25vcnRoRWFzdCkge1xyXG5cdFx0XHRcdHRoaXMuX3NvdXRoV2VzdCA9IG5ldyBMLkxhdExuZyhvYmoubGF0LCBvYmoubG5nKTtcclxuXHRcdFx0XHR0aGlzLl9ub3J0aEVhc3QgPSBuZXcgTC5MYXRMbmcob2JqLmxhdCwgb2JqLmxuZyk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5fc291dGhXZXN0LmxhdCA9IE1hdGgubWluKG9iai5sYXQsIHRoaXMuX3NvdXRoV2VzdC5sYXQpO1xyXG5cdFx0XHRcdHRoaXMuX3NvdXRoV2VzdC5sbmcgPSBNYXRoLm1pbihvYmoubG5nLCB0aGlzLl9zb3V0aFdlc3QubG5nKTtcclxuXHJcblx0XHRcdFx0dGhpcy5fbm9ydGhFYXN0LmxhdCA9IE1hdGgubWF4KG9iai5sYXQsIHRoaXMuX25vcnRoRWFzdC5sYXQpO1xyXG5cdFx0XHRcdHRoaXMuX25vcnRoRWFzdC5sbmcgPSBNYXRoLm1heChvYmoubG5nLCB0aGlzLl9ub3J0aEVhc3QubG5nKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChvYmogaW5zdGFuY2VvZiBMLkxhdExuZ0JvdW5kcykge1xyXG5cdFx0XHR0aGlzLmV4dGVuZChvYmouX3NvdXRoV2VzdCk7XHJcblx0XHRcdHRoaXMuZXh0ZW5kKG9iai5fbm9ydGhFYXN0KTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdC8vIGV4dGVuZCB0aGUgYm91bmRzIGJ5IGEgcGVyY2VudGFnZVxyXG5cdHBhZDogZnVuY3Rpb24gKGJ1ZmZlclJhdGlvKSB7IC8vIChOdW1iZXIpIC0+IExhdExuZ0JvdW5kc1xyXG5cdFx0dmFyIHN3ID0gdGhpcy5fc291dGhXZXN0LFxyXG5cdFx0ICAgIG5lID0gdGhpcy5fbm9ydGhFYXN0LFxyXG5cdFx0ICAgIGhlaWdodEJ1ZmZlciA9IE1hdGguYWJzKHN3LmxhdCAtIG5lLmxhdCkgKiBidWZmZXJSYXRpbyxcclxuXHRcdCAgICB3aWR0aEJ1ZmZlciA9IE1hdGguYWJzKHN3LmxuZyAtIG5lLmxuZykgKiBidWZmZXJSYXRpbztcclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuTGF0TG5nQm91bmRzKFxyXG5cdFx0ICAgICAgICBuZXcgTC5MYXRMbmcoc3cubGF0IC0gaGVpZ2h0QnVmZmVyLCBzdy5sbmcgLSB3aWR0aEJ1ZmZlciksXHJcblx0XHQgICAgICAgIG5ldyBMLkxhdExuZyhuZS5sYXQgKyBoZWlnaHRCdWZmZXIsIG5lLmxuZyArIHdpZHRoQnVmZmVyKSk7XHJcblx0fSxcclxuXHJcblx0Z2V0Q2VudGVyOiBmdW5jdGlvbiAoKSB7IC8vIC0+IExhdExuZ1xyXG5cdFx0cmV0dXJuIG5ldyBMLkxhdExuZyhcclxuXHRcdCAgICAgICAgKHRoaXMuX3NvdXRoV2VzdC5sYXQgKyB0aGlzLl9ub3J0aEVhc3QubGF0KSAvIDIsXHJcblx0XHQgICAgICAgICh0aGlzLl9zb3V0aFdlc3QubG5nICsgdGhpcy5fbm9ydGhFYXN0LmxuZykgLyAyKTtcclxuXHR9LFxyXG5cclxuXHRnZXRTb3V0aFdlc3Q6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9zb3V0aFdlc3Q7XHJcblx0fSxcclxuXHJcblx0Z2V0Tm9ydGhFYXN0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fbm9ydGhFYXN0O1xyXG5cdH0sXHJcblxyXG5cdGdldE5vcnRoV2VzdDogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIG5ldyBMLkxhdExuZyh0aGlzLmdldE5vcnRoKCksIHRoaXMuZ2V0V2VzdCgpKTtcclxuXHR9LFxyXG5cclxuXHRnZXRTb3V0aEVhc3Q6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiBuZXcgTC5MYXRMbmcodGhpcy5nZXRTb3V0aCgpLCB0aGlzLmdldEVhc3QoKSk7XHJcblx0fSxcclxuXHJcblx0Z2V0V2VzdDogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3NvdXRoV2VzdC5sbmc7XHJcblx0fSxcclxuXHJcblx0Z2V0U291dGg6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9zb3V0aFdlc3QubGF0O1xyXG5cdH0sXHJcblxyXG5cdGdldEVhc3Q6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9ub3J0aEVhc3QubG5nO1xyXG5cdH0sXHJcblxyXG5cdGdldE5vcnRoOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fbm9ydGhFYXN0LmxhdDtcclxuXHR9LFxyXG5cclxuXHRjb250YWluczogZnVuY3Rpb24gKG9iaikgeyAvLyAoTGF0TG5nQm91bmRzKSBvciAoTGF0TG5nKSAtPiBCb29sZWFuXHJcblx0XHRpZiAodHlwZW9mIG9ialswXSA9PT0gJ251bWJlcicgfHwgb2JqIGluc3RhbmNlb2YgTC5MYXRMbmcpIHtcclxuXHRcdFx0b2JqID0gTC5sYXRMbmcob2JqKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdG9iaiA9IEwubGF0TG5nQm91bmRzKG9iaik7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIHN3ID0gdGhpcy5fc291dGhXZXN0LFxyXG5cdFx0ICAgIG5lID0gdGhpcy5fbm9ydGhFYXN0LFxyXG5cdFx0ICAgIHN3MiwgbmUyO1xyXG5cclxuXHRcdGlmIChvYmogaW5zdGFuY2VvZiBMLkxhdExuZ0JvdW5kcykge1xyXG5cdFx0XHRzdzIgPSBvYmouZ2V0U291dGhXZXN0KCk7XHJcblx0XHRcdG5lMiA9IG9iai5nZXROb3J0aEVhc3QoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHN3MiA9IG5lMiA9IG9iajtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gKHN3Mi5sYXQgPj0gc3cubGF0KSAmJiAobmUyLmxhdCA8PSBuZS5sYXQpICYmXHJcblx0XHQgICAgICAgKHN3Mi5sbmcgPj0gc3cubG5nKSAmJiAobmUyLmxuZyA8PSBuZS5sbmcpO1xyXG5cdH0sXHJcblxyXG5cdGludGVyc2VjdHM6IGZ1bmN0aW9uIChib3VuZHMpIHsgLy8gKExhdExuZ0JvdW5kcylcclxuXHRcdGJvdW5kcyA9IEwubGF0TG5nQm91bmRzKGJvdW5kcyk7XHJcblxyXG5cdFx0dmFyIHN3ID0gdGhpcy5fc291dGhXZXN0LFxyXG5cdFx0ICAgIG5lID0gdGhpcy5fbm9ydGhFYXN0LFxyXG5cdFx0ICAgIHN3MiA9IGJvdW5kcy5nZXRTb3V0aFdlc3QoKSxcclxuXHRcdCAgICBuZTIgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCksXHJcblxyXG5cdFx0ICAgIGxhdEludGVyc2VjdHMgPSAobmUyLmxhdCA+PSBzdy5sYXQpICYmIChzdzIubGF0IDw9IG5lLmxhdCksXHJcblx0XHQgICAgbG5nSW50ZXJzZWN0cyA9IChuZTIubG5nID49IHN3LmxuZykgJiYgKHN3Mi5sbmcgPD0gbmUubG5nKTtcclxuXHJcblx0XHRyZXR1cm4gbGF0SW50ZXJzZWN0cyAmJiBsbmdJbnRlcnNlY3RzO1xyXG5cdH0sXHJcblxyXG5cdHRvQkJveFN0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIFt0aGlzLmdldFdlc3QoKSwgdGhpcy5nZXRTb3V0aCgpLCB0aGlzLmdldEVhc3QoKSwgdGhpcy5nZXROb3J0aCgpXS5qb2luKCcsJyk7XHJcblx0fSxcclxuXHJcblx0ZXF1YWxzOiBmdW5jdGlvbiAoYm91bmRzKSB7IC8vIChMYXRMbmdCb3VuZHMpXHJcblx0XHRpZiAoIWJvdW5kcykgeyByZXR1cm4gZmFsc2U7IH1cclxuXHJcblx0XHRib3VuZHMgPSBMLmxhdExuZ0JvdW5kcyhib3VuZHMpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzLl9zb3V0aFdlc3QuZXF1YWxzKGJvdW5kcy5nZXRTb3V0aFdlc3QoKSkgJiZcclxuXHRcdCAgICAgICB0aGlzLl9ub3J0aEVhc3QuZXF1YWxzKGJvdW5kcy5nZXROb3J0aEVhc3QoKSk7XHJcblx0fSxcclxuXHJcblx0aXNWYWxpZDogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuICEhKHRoaXMuX3NvdXRoV2VzdCAmJiB0aGlzLl9ub3J0aEVhc3QpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vVE9ETyBJbnRlcm5hdGlvbmFsIGRhdGUgbGluZT9cclxuXHJcbkwubGF0TG5nQm91bmRzID0gZnVuY3Rpb24gKGEsIGIpIHsgLy8gKExhdExuZ0JvdW5kcykgb3IgKExhdExuZywgTGF0TG5nKVxyXG5cdGlmICghYSB8fCBhIGluc3RhbmNlb2YgTC5MYXRMbmdCb3VuZHMpIHtcclxuXHRcdHJldHVybiBhO1xyXG5cdH1cclxuXHRyZXR1cm4gbmV3IEwuTGF0TG5nQm91bmRzKGEsIGIpO1xyXG59O1xyXG5cblxuLypcclxuICogTC5Qcm9qZWN0aW9uIGNvbnRhaW5zIHZhcmlvdXMgZ2VvZ3JhcGhpY2FsIHByb2plY3Rpb25zIHVzZWQgYnkgQ1JTIGNsYXNzZXMuXHJcbiAqL1xyXG5cclxuTC5Qcm9qZWN0aW9uID0ge307XHJcblxuXG4vKlxyXG4gKiBTcGhlcmljYWwgTWVyY2F0b3IgaXMgdGhlIG1vc3QgcG9wdWxhciBtYXAgcHJvamVjdGlvbiwgdXNlZCBieSBFUFNHOjM4NTcgQ1JTIHVzZWQgYnkgZGVmYXVsdC5cclxuICovXHJcblxyXG5MLlByb2plY3Rpb24uU3BoZXJpY2FsTWVyY2F0b3IgPSB7XHJcblx0TUFYX0xBVElUVURFOiA4NS4wNTExMjg3Nzk4LFxyXG5cclxuXHRwcm9qZWN0OiBmdW5jdGlvbiAobGF0bG5nKSB7IC8vIChMYXRMbmcpIC0+IFBvaW50XHJcblx0XHR2YXIgZCA9IEwuTGF0TG5nLkRFR19UT19SQUQsXHJcblx0XHQgICAgbWF4ID0gdGhpcy5NQVhfTEFUSVRVREUsXHJcblx0XHQgICAgbGF0ID0gTWF0aC5tYXgoTWF0aC5taW4obWF4LCBsYXRsbmcubGF0KSwgLW1heCksXHJcblx0XHQgICAgeCA9IGxhdGxuZy5sbmcgKiBkLFxyXG5cdFx0ICAgIHkgPSBsYXQgKiBkO1xyXG5cclxuXHRcdHkgPSBNYXRoLmxvZyhNYXRoLnRhbigoTWF0aC5QSSAvIDQpICsgKHkgLyAyKSkpO1xyXG5cclxuXHRcdHJldHVybiBuZXcgTC5Qb2ludCh4LCB5KTtcclxuXHR9LFxyXG5cclxuXHR1bnByb2plY3Q6IGZ1bmN0aW9uIChwb2ludCkgeyAvLyAoUG9pbnQsIEJvb2xlYW4pIC0+IExhdExuZ1xyXG5cdFx0dmFyIGQgPSBMLkxhdExuZy5SQURfVE9fREVHLFxyXG5cdFx0ICAgIGxuZyA9IHBvaW50LnggKiBkLFxyXG5cdFx0ICAgIGxhdCA9ICgyICogTWF0aC5hdGFuKE1hdGguZXhwKHBvaW50LnkpKSAtIChNYXRoLlBJIC8gMikpICogZDtcclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuTGF0TG5nKGxhdCwgbG5nKTtcclxuXHR9XHJcbn07XHJcblxuXG4vKlxyXG4gKiBTaW1wbGUgZXF1aXJlY3Rhbmd1bGFyIChQbGF0ZSBDYXJyZWUpIHByb2plY3Rpb24sIHVzZWQgYnkgQ1JTIGxpa2UgRVBTRzo0MzI2IGFuZCBTaW1wbGUuXHJcbiAqL1xyXG5cclxuTC5Qcm9qZWN0aW9uLkxvbkxhdCA9IHtcclxuXHRwcm9qZWN0OiBmdW5jdGlvbiAobGF0bG5nKSB7XHJcblx0XHRyZXR1cm4gbmV3IEwuUG9pbnQobGF0bG5nLmxuZywgbGF0bG5nLmxhdCk7XHJcblx0fSxcclxuXHJcblx0dW5wcm9qZWN0OiBmdW5jdGlvbiAocG9pbnQpIHtcclxuXHRcdHJldHVybiBuZXcgTC5MYXRMbmcocG9pbnQueSwgcG9pbnQueCk7XHJcblx0fVxyXG59O1xyXG5cblxuLypcclxuICogTC5DUlMgaXMgYSBiYXNlIG9iamVjdCBmb3IgYWxsIGRlZmluZWQgQ1JTIChDb29yZGluYXRlIFJlZmVyZW5jZSBTeXN0ZW1zKSBpbiBMZWFmbGV0LlxyXG4gKi9cclxuXHJcbkwuQ1JTID0ge1xyXG5cdGxhdExuZ1RvUG9pbnQ6IGZ1bmN0aW9uIChsYXRsbmcsIHpvb20pIHsgLy8gKExhdExuZywgTnVtYmVyKSAtPiBQb2ludFxyXG5cdFx0dmFyIHByb2plY3RlZFBvaW50ID0gdGhpcy5wcm9qZWN0aW9uLnByb2plY3QobGF0bG5nKSxcclxuXHRcdCAgICBzY2FsZSA9IHRoaXMuc2NhbGUoem9vbSk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMudHJhbnNmb3JtYXRpb24uX3RyYW5zZm9ybShwcm9qZWN0ZWRQb2ludCwgc2NhbGUpO1xyXG5cdH0sXHJcblxyXG5cdHBvaW50VG9MYXRMbmc6IGZ1bmN0aW9uIChwb2ludCwgem9vbSkgeyAvLyAoUG9pbnQsIE51bWJlclssIEJvb2xlYW5dKSAtPiBMYXRMbmdcclxuXHRcdHZhciBzY2FsZSA9IHRoaXMuc2NhbGUoem9vbSksXHJcblx0XHQgICAgdW50cmFuc2Zvcm1lZFBvaW50ID0gdGhpcy50cmFuc2Zvcm1hdGlvbi51bnRyYW5zZm9ybShwb2ludCwgc2NhbGUpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzLnByb2plY3Rpb24udW5wcm9qZWN0KHVudHJhbnNmb3JtZWRQb2ludCk7XHJcblx0fSxcclxuXHJcblx0cHJvamVjdDogZnVuY3Rpb24gKGxhdGxuZykge1xyXG5cdFx0cmV0dXJuIHRoaXMucHJvamVjdGlvbi5wcm9qZWN0KGxhdGxuZyk7XHJcblx0fSxcclxuXHJcblx0c2NhbGU6IGZ1bmN0aW9uICh6b29tKSB7XHJcblx0XHRyZXR1cm4gMjU2ICogTWF0aC5wb3coMiwgem9vbSk7XHJcblx0fSxcclxuXHJcblx0Z2V0U2l6ZTogZnVuY3Rpb24gKHpvb20pIHtcclxuXHRcdHZhciBzID0gdGhpcy5zY2FsZSh6b29tKTtcclxuXHRcdHJldHVybiBMLnBvaW50KHMsIHMpO1xyXG5cdH1cclxufTtcclxuXG5cbi8qXG4gKiBBIHNpbXBsZSBDUlMgdGhhdCBjYW4gYmUgdXNlZCBmb3IgZmxhdCBub24tRWFydGggbWFwcyBsaWtlIHBhbm9yYW1hcyBvciBnYW1lIG1hcHMuXG4gKi9cblxuTC5DUlMuU2ltcGxlID0gTC5leHRlbmQoe30sIEwuQ1JTLCB7XG5cdHByb2plY3Rpb246IEwuUHJvamVjdGlvbi5Mb25MYXQsXG5cdHRyYW5zZm9ybWF0aW9uOiBuZXcgTC5UcmFuc2Zvcm1hdGlvbigxLCAwLCAtMSwgMCksXG5cblx0c2NhbGU6IGZ1bmN0aW9uICh6b29tKSB7XG5cdFx0cmV0dXJuIE1hdGgucG93KDIsIHpvb20pO1xuXHR9XG59KTtcblxuXG4vKlxyXG4gKiBMLkNSUy5FUFNHMzg1NyAoU3BoZXJpY2FsIE1lcmNhdG9yKSBpcyB0aGUgbW9zdCBjb21tb24gQ1JTIGZvciB3ZWIgbWFwcGluZ1xyXG4gKiBhbmQgaXMgdXNlZCBieSBMZWFmbGV0IGJ5IGRlZmF1bHQuXHJcbiAqL1xyXG5cclxuTC5DUlMuRVBTRzM4NTcgPSBMLmV4dGVuZCh7fSwgTC5DUlMsIHtcclxuXHRjb2RlOiAnRVBTRzozODU3JyxcclxuXHJcblx0cHJvamVjdGlvbjogTC5Qcm9qZWN0aW9uLlNwaGVyaWNhbE1lcmNhdG9yLFxyXG5cdHRyYW5zZm9ybWF0aW9uOiBuZXcgTC5UcmFuc2Zvcm1hdGlvbigwLjUgLyBNYXRoLlBJLCAwLjUsIC0wLjUgLyBNYXRoLlBJLCAwLjUpLFxyXG5cclxuXHRwcm9qZWN0OiBmdW5jdGlvbiAobGF0bG5nKSB7IC8vIChMYXRMbmcpIC0+IFBvaW50XHJcblx0XHR2YXIgcHJvamVjdGVkUG9pbnQgPSB0aGlzLnByb2plY3Rpb24ucHJvamVjdChsYXRsbmcpLFxyXG5cdFx0ICAgIGVhcnRoUmFkaXVzID0gNjM3ODEzNztcclxuXHRcdHJldHVybiBwcm9qZWN0ZWRQb2ludC5tdWx0aXBseUJ5KGVhcnRoUmFkaXVzKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5DUlMuRVBTRzkwMDkxMyA9IEwuZXh0ZW5kKHt9LCBMLkNSUy5FUFNHMzg1Nywge1xyXG5cdGNvZGU6ICdFUFNHOjkwMDkxMydcclxufSk7XHJcblxuXG4vKlxyXG4gKiBMLkNSUy5FUFNHNDMyNiBpcyBhIENSUyBwb3B1bGFyIGFtb25nIGFkdmFuY2VkIEdJUyBzcGVjaWFsaXN0cy5cclxuICovXHJcblxyXG5MLkNSUy5FUFNHNDMyNiA9IEwuZXh0ZW5kKHt9LCBMLkNSUywge1xyXG5cdGNvZGU6ICdFUFNHOjQzMjYnLFxyXG5cclxuXHRwcm9qZWN0aW9uOiBMLlByb2plY3Rpb24uTG9uTGF0LFxyXG5cdHRyYW5zZm9ybWF0aW9uOiBuZXcgTC5UcmFuc2Zvcm1hdGlvbigxIC8gMzYwLCAwLjUsIC0xIC8gMzYwLCAwLjUpXHJcbn0pO1xyXG5cblxuLypcclxuICogTC5NYXAgaXMgdGhlIGNlbnRyYWwgY2xhc3Mgb2YgdGhlIEFQSSAtIGl0IGlzIHVzZWQgdG8gY3JlYXRlIGEgbWFwLlxyXG4gKi9cclxuXHJcbkwuTWFwID0gTC5DbGFzcy5leHRlbmQoe1xyXG5cclxuXHRpbmNsdWRlczogTC5NaXhpbi5FdmVudHMsXHJcblxyXG5cdG9wdGlvbnM6IHtcclxuXHRcdGNyczogTC5DUlMuRVBTRzM4NTcsXHJcblxyXG5cdFx0LypcclxuXHRcdGNlbnRlcjogTGF0TG5nLFxyXG5cdFx0em9vbTogTnVtYmVyLFxyXG5cdFx0bGF5ZXJzOiBBcnJheSxcclxuXHRcdCovXHJcblxyXG5cdFx0ZmFkZUFuaW1hdGlvbjogTC5Eb21VdGlsLlRSQU5TSVRJT04gJiYgIUwuQnJvd3Nlci5hbmRyb2lkMjMsXHJcblx0XHR0cmFja1Jlc2l6ZTogdHJ1ZSxcclxuXHRcdG1hcmtlclpvb21BbmltYXRpb246IEwuRG9tVXRpbC5UUkFOU0lUSU9OICYmIEwuQnJvd3Nlci5hbnkzZFxyXG5cdH0sXHJcblxyXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uIChpZCwgb3B0aW9ucykgeyAvLyAoSFRNTEVsZW1lbnQgb3IgU3RyaW5nLCBPYmplY3QpXHJcblx0XHRvcHRpb25zID0gTC5zZXRPcHRpb25zKHRoaXMsIG9wdGlvbnMpO1xyXG5cclxuXHJcblx0XHR0aGlzLl9pbml0Q29udGFpbmVyKGlkKTtcclxuXHRcdHRoaXMuX2luaXRMYXlvdXQoKTtcclxuXHJcblx0XHQvLyBoYWNrIGZvciBodHRwczovL2dpdGh1Yi5jb20vTGVhZmxldC9MZWFmbGV0L2lzc3Vlcy8xOTgwXHJcblx0XHR0aGlzLl9vblJlc2l6ZSA9IEwuYmluZCh0aGlzLl9vblJlc2l6ZSwgdGhpcyk7XHJcblxyXG5cdFx0dGhpcy5faW5pdEV2ZW50cygpO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLm1heEJvdW5kcykge1xyXG5cdFx0XHR0aGlzLnNldE1heEJvdW5kcyhvcHRpb25zLm1heEJvdW5kcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuY2VudGVyICYmIG9wdGlvbnMuem9vbSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMuc2V0VmlldyhMLmxhdExuZyhvcHRpb25zLmNlbnRlciksIG9wdGlvbnMuem9vbSwge3Jlc2V0OiB0cnVlfSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5faGFuZGxlcnMgPSBbXTtcclxuXHJcblx0XHR0aGlzLl9sYXllcnMgPSB7fTtcclxuXHRcdHRoaXMuX3pvb21Cb3VuZExheWVycyA9IHt9O1xyXG5cdFx0dGhpcy5fdGlsZUxheWVyc051bSA9IDA7XHJcblxyXG5cdFx0dGhpcy5jYWxsSW5pdEhvb2tzKCk7XHJcblxyXG5cdFx0dGhpcy5fYWRkTGF5ZXJzKG9wdGlvbnMubGF5ZXJzKTtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gcHVibGljIG1ldGhvZHMgdGhhdCBtb2RpZnkgbWFwIHN0YXRlXHJcblxyXG5cdC8vIHJlcGxhY2VkIGJ5IGFuaW1hdGlvbi1wb3dlcmVkIGltcGxlbWVudGF0aW9uIGluIE1hcC5QYW5BbmltYXRpb24uanNcclxuXHRzZXRWaWV3OiBmdW5jdGlvbiAoY2VudGVyLCB6b29tKSB7XHJcblx0XHR6b29tID0gem9vbSA9PT0gdW5kZWZpbmVkID8gdGhpcy5nZXRab29tKCkgOiB6b29tO1xyXG5cdFx0dGhpcy5fcmVzZXRWaWV3KEwubGF0TG5nKGNlbnRlciksIHRoaXMuX2xpbWl0Wm9vbSh6b29tKSk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRzZXRab29tOiBmdW5jdGlvbiAoem9vbSwgb3B0aW9ucykge1xyXG5cdFx0aWYgKCF0aGlzLl9sb2FkZWQpIHtcclxuXHRcdFx0dGhpcy5fem9vbSA9IHRoaXMuX2xpbWl0Wm9vbSh6b29tKTtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRWaWV3KHRoaXMuZ2V0Q2VudGVyKCksIHpvb20sIHt6b29tOiBvcHRpb25zfSk7XHJcblx0fSxcclxuXHJcblx0em9vbUluOiBmdW5jdGlvbiAoZGVsdGEsIG9wdGlvbnMpIHtcclxuXHRcdHJldHVybiB0aGlzLnNldFpvb20odGhpcy5fem9vbSArIChkZWx0YSB8fCAxKSwgb3B0aW9ucyk7XHJcblx0fSxcclxuXHJcblx0em9vbU91dDogZnVuY3Rpb24gKGRlbHRhLCBvcHRpb25zKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRab29tKHRoaXMuX3pvb20gLSAoZGVsdGEgfHwgMSksIG9wdGlvbnMpO1xyXG5cdH0sXHJcblxyXG5cdHNldFpvb21Bcm91bmQ6IGZ1bmN0aW9uIChsYXRsbmcsIHpvb20sIG9wdGlvbnMpIHtcclxuXHRcdHZhciBzY2FsZSA9IHRoaXMuZ2V0Wm9vbVNjYWxlKHpvb20pLFxyXG5cdFx0ICAgIHZpZXdIYWxmID0gdGhpcy5nZXRTaXplKCkuZGl2aWRlQnkoMiksXHJcblx0XHQgICAgY29udGFpbmVyUG9pbnQgPSBsYXRsbmcgaW5zdGFuY2VvZiBMLlBvaW50ID8gbGF0bG5nIDogdGhpcy5sYXRMbmdUb0NvbnRhaW5lclBvaW50KGxhdGxuZyksXHJcblxyXG5cdFx0ICAgIGNlbnRlck9mZnNldCA9IGNvbnRhaW5lclBvaW50LnN1YnRyYWN0KHZpZXdIYWxmKS5tdWx0aXBseUJ5KDEgLSAxIC8gc2NhbGUpLFxyXG5cdFx0ICAgIG5ld0NlbnRlciA9IHRoaXMuY29udGFpbmVyUG9pbnRUb0xhdExuZyh2aWV3SGFsZi5hZGQoY2VudGVyT2Zmc2V0KSk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuc2V0VmlldyhuZXdDZW50ZXIsIHpvb20sIHt6b29tOiBvcHRpb25zfSk7XHJcblx0fSxcclxuXHJcblx0Zml0Qm91bmRzOiBmdW5jdGlvbiAoYm91bmRzLCBvcHRpb25zKSB7XHJcblxyXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblx0XHRib3VuZHMgPSBib3VuZHMuZ2V0Qm91bmRzID8gYm91bmRzLmdldEJvdW5kcygpIDogTC5sYXRMbmdCb3VuZHMoYm91bmRzKTtcclxuXHJcblx0XHR2YXIgcGFkZGluZ1RMID0gTC5wb2ludChvcHRpb25zLnBhZGRpbmdUb3BMZWZ0IHx8IG9wdGlvbnMucGFkZGluZyB8fCBbMCwgMF0pLFxyXG5cdFx0ICAgIHBhZGRpbmdCUiA9IEwucG9pbnQob3B0aW9ucy5wYWRkaW5nQm90dG9tUmlnaHQgfHwgb3B0aW9ucy5wYWRkaW5nIHx8IFswLCAwXSksXHJcblxyXG5cdFx0ICAgIHpvb20gPSB0aGlzLmdldEJvdW5kc1pvb20oYm91bmRzLCBmYWxzZSwgcGFkZGluZ1RMLmFkZChwYWRkaW5nQlIpKTtcclxuXHJcblx0XHR6b29tID0gKG9wdGlvbnMubWF4Wm9vbSkgPyBNYXRoLm1pbihvcHRpb25zLm1heFpvb20sIHpvb20pIDogem9vbTtcclxuXHJcblx0XHR2YXIgcGFkZGluZ09mZnNldCA9IHBhZGRpbmdCUi5zdWJ0cmFjdChwYWRkaW5nVEwpLmRpdmlkZUJ5KDIpLFxyXG5cclxuXHRcdCAgICBzd1BvaW50ID0gdGhpcy5wcm9qZWN0KGJvdW5kcy5nZXRTb3V0aFdlc3QoKSwgem9vbSksXHJcblx0XHQgICAgbmVQb2ludCA9IHRoaXMucHJvamVjdChib3VuZHMuZ2V0Tm9ydGhFYXN0KCksIHpvb20pLFxyXG5cdFx0ICAgIGNlbnRlciA9IHRoaXMudW5wcm9qZWN0KHN3UG9pbnQuYWRkKG5lUG9pbnQpLmRpdmlkZUJ5KDIpLmFkZChwYWRkaW5nT2Zmc2V0KSwgem9vbSk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuc2V0VmlldyhjZW50ZXIsIHpvb20sIG9wdGlvbnMpO1xyXG5cdH0sXHJcblxyXG5cdGZpdFdvcmxkOiBmdW5jdGlvbiAob3B0aW9ucykge1xyXG5cdFx0cmV0dXJuIHRoaXMuZml0Qm91bmRzKFtbLTkwLCAtMTgwXSwgWzkwLCAxODBdXSwgb3B0aW9ucyk7XHJcblx0fSxcclxuXHJcblx0cGFuVG86IGZ1bmN0aW9uIChjZW50ZXIsIG9wdGlvbnMpIHsgLy8gKExhdExuZylcclxuXHRcdHJldHVybiB0aGlzLnNldFZpZXcoY2VudGVyLCB0aGlzLl96b29tLCB7cGFuOiBvcHRpb25zfSk7XHJcblx0fSxcclxuXHJcblx0cGFuQnk6IGZ1bmN0aW9uIChvZmZzZXQpIHsgLy8gKFBvaW50KVxyXG5cdFx0Ly8gcmVwbGFjZWQgd2l0aCBhbmltYXRlZCBwYW5CeSBpbiBNYXAuUGFuQW5pbWF0aW9uLmpzXHJcblx0XHR0aGlzLmZpcmUoJ21vdmVzdGFydCcpO1xyXG5cclxuXHRcdHRoaXMuX3Jhd1BhbkJ5KEwucG9pbnQob2Zmc2V0KSk7XHJcblxyXG5cdFx0dGhpcy5maXJlKCdtb3ZlJyk7XHJcblx0XHRyZXR1cm4gdGhpcy5maXJlKCdtb3ZlZW5kJyk7XHJcblx0fSxcclxuXHJcblx0c2V0TWF4Qm91bmRzOiBmdW5jdGlvbiAoYm91bmRzKSB7XHJcblx0XHRib3VuZHMgPSBMLmxhdExuZ0JvdW5kcyhib3VuZHMpO1xyXG5cclxuXHRcdHRoaXMub3B0aW9ucy5tYXhCb3VuZHMgPSBib3VuZHM7XHJcblxyXG5cdFx0aWYgKCFib3VuZHMpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMub2ZmKCdtb3ZlZW5kJywgdGhpcy5fcGFuSW5zaWRlTWF4Qm91bmRzLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fbG9hZGVkKSB7XHJcblx0XHRcdHRoaXMuX3Bhbkluc2lkZU1heEJvdW5kcygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLm9uKCdtb3ZlZW5kJywgdGhpcy5fcGFuSW5zaWRlTWF4Qm91bmRzLCB0aGlzKTtcclxuXHR9LFxyXG5cclxuXHRwYW5JbnNpZGVCb3VuZHM6IGZ1bmN0aW9uIChib3VuZHMsIG9wdGlvbnMpIHtcclxuXHRcdHZhciBjZW50ZXIgPSB0aGlzLmdldENlbnRlcigpLFxyXG5cdFx0XHRuZXdDZW50ZXIgPSB0aGlzLl9saW1pdENlbnRlcihjZW50ZXIsIHRoaXMuX3pvb20sIGJvdW5kcyk7XHJcblxyXG5cdFx0aWYgKGNlbnRlci5lcXVhbHMobmV3Q2VudGVyKSkgeyByZXR1cm4gdGhpczsgfVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnBhblRvKG5ld0NlbnRlciwgb3B0aW9ucyk7XHJcblx0fSxcclxuXHJcblx0YWRkTGF5ZXI6IGZ1bmN0aW9uIChsYXllcikge1xyXG5cdFx0Ly8gVE9ETyBtZXRob2QgaXMgdG9vIGJpZywgcmVmYWN0b3JcclxuXHJcblx0XHR2YXIgaWQgPSBMLnN0YW1wKGxheWVyKTtcclxuXHJcblx0XHRpZiAodGhpcy5fbGF5ZXJzW2lkXSkgeyByZXR1cm4gdGhpczsgfVxyXG5cclxuXHRcdHRoaXMuX2xheWVyc1tpZF0gPSBsYXllcjtcclxuXHJcblx0XHQvLyBUT0RPIGdldE1heFpvb20sIGdldE1pblpvb20gaW4gSUxheWVyIChpbnN0ZWFkIG9mIG9wdGlvbnMpXHJcblx0XHRpZiAobGF5ZXIub3B0aW9ucyAmJiAoIWlzTmFOKGxheWVyLm9wdGlvbnMubWF4Wm9vbSkgfHwgIWlzTmFOKGxheWVyLm9wdGlvbnMubWluWm9vbSkpKSB7XHJcblx0XHRcdHRoaXMuX3pvb21Cb3VuZExheWVyc1tpZF0gPSBsYXllcjtcclxuXHRcdFx0dGhpcy5fdXBkYXRlWm9vbUxldmVscygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFRPRE8gbG9va3MgdWdseSwgcmVmYWN0b3IhISFcclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuem9vbUFuaW1hdGlvbiAmJiBMLlRpbGVMYXllciAmJiAobGF5ZXIgaW5zdGFuY2VvZiBMLlRpbGVMYXllcikpIHtcclxuXHRcdFx0dGhpcy5fdGlsZUxheWVyc051bSsrO1xyXG5cdFx0XHR0aGlzLl90aWxlTGF5ZXJzVG9Mb2FkKys7XHJcblx0XHRcdGxheWVyLm9uKCdsb2FkJywgdGhpcy5fb25UaWxlTGF5ZXJMb2FkLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fbG9hZGVkKSB7XHJcblx0XHRcdHRoaXMuX2xheWVyQWRkKGxheWVyKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyZW1vdmVMYXllcjogZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHR2YXIgaWQgPSBMLnN0YW1wKGxheWVyKTtcclxuXHJcblx0XHRpZiAoIXRoaXMuX2xheWVyc1tpZF0pIHsgcmV0dXJuIHRoaXM7IH1cclxuXHJcblx0XHRpZiAodGhpcy5fbG9hZGVkKSB7XHJcblx0XHRcdGxheWVyLm9uUmVtb3ZlKHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGRlbGV0ZSB0aGlzLl9sYXllcnNbaWRdO1xyXG5cclxuXHRcdGlmICh0aGlzLl9sb2FkZWQpIHtcclxuXHRcdFx0dGhpcy5maXJlKCdsYXllcnJlbW92ZScsIHtsYXllcjogbGF5ZXJ9KTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fem9vbUJvdW5kTGF5ZXJzW2lkXSkge1xyXG5cdFx0XHRkZWxldGUgdGhpcy5fem9vbUJvdW5kTGF5ZXJzW2lkXTtcclxuXHRcdFx0dGhpcy5fdXBkYXRlWm9vbUxldmVscygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFRPRE8gbG9va3MgdWdseSwgcmVmYWN0b3JcclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuem9vbUFuaW1hdGlvbiAmJiBMLlRpbGVMYXllciAmJiAobGF5ZXIgaW5zdGFuY2VvZiBMLlRpbGVMYXllcikpIHtcclxuXHRcdFx0dGhpcy5fdGlsZUxheWVyc051bS0tO1xyXG5cdFx0XHR0aGlzLl90aWxlTGF5ZXJzVG9Mb2FkLS07XHJcblx0XHRcdGxheWVyLm9mZignbG9hZCcsIHRoaXMuX29uVGlsZUxheWVyTG9hZCwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0aGFzTGF5ZXI6IGZ1bmN0aW9uIChsYXllcikge1xyXG5cdFx0aWYgKCFsYXllcikgeyByZXR1cm4gZmFsc2U7IH1cclxuXHJcblx0XHRyZXR1cm4gKEwuc3RhbXAobGF5ZXIpIGluIHRoaXMuX2xheWVycyk7XHJcblx0fSxcclxuXHJcblx0ZWFjaExheWVyOiBmdW5jdGlvbiAobWV0aG9kLCBjb250ZXh0KSB7XHJcblx0XHRmb3IgKHZhciBpIGluIHRoaXMuX2xheWVycykge1xyXG5cdFx0XHRtZXRob2QuY2FsbChjb250ZXh0LCB0aGlzLl9sYXllcnNbaV0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0aW52YWxpZGF0ZVNpemU6IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcblx0XHRpZiAoIXRoaXMuX2xvYWRlZCkgeyByZXR1cm4gdGhpczsgfVxyXG5cclxuXHRcdG9wdGlvbnMgPSBMLmV4dGVuZCh7XHJcblx0XHRcdGFuaW1hdGU6IGZhbHNlLFxyXG5cdFx0XHRwYW46IHRydWVcclxuXHRcdH0sIG9wdGlvbnMgPT09IHRydWUgPyB7YW5pbWF0ZTogdHJ1ZX0gOiBvcHRpb25zKTtcclxuXHJcblx0XHR2YXIgb2xkU2l6ZSA9IHRoaXMuZ2V0U2l6ZSgpO1xyXG5cdFx0dGhpcy5fc2l6ZUNoYW5nZWQgPSB0cnVlO1xyXG5cdFx0dGhpcy5faW5pdGlhbENlbnRlciA9IG51bGw7XHJcblxyXG5cdFx0dmFyIG5ld1NpemUgPSB0aGlzLmdldFNpemUoKSxcclxuXHRcdCAgICBvbGRDZW50ZXIgPSBvbGRTaXplLmRpdmlkZUJ5KDIpLnJvdW5kKCksXHJcblx0XHQgICAgbmV3Q2VudGVyID0gbmV3U2l6ZS5kaXZpZGVCeSgyKS5yb3VuZCgpLFxyXG5cdFx0ICAgIG9mZnNldCA9IG9sZENlbnRlci5zdWJ0cmFjdChuZXdDZW50ZXIpO1xyXG5cclxuXHRcdGlmICghb2Zmc2V0LnggJiYgIW9mZnNldC55KSB7IHJldHVybiB0aGlzOyB9XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuYW5pbWF0ZSAmJiBvcHRpb25zLnBhbikge1xyXG5cdFx0XHR0aGlzLnBhbkJ5KG9mZnNldCk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYgKG9wdGlvbnMucGFuKSB7XHJcblx0XHRcdFx0dGhpcy5fcmF3UGFuQnkob2Zmc2V0KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5maXJlKCdtb3ZlJyk7XHJcblxyXG5cdFx0XHRpZiAob3B0aW9ucy5kZWJvdW5jZU1vdmVlbmQpIHtcclxuXHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy5fc2l6ZVRpbWVyKTtcclxuXHRcdFx0XHR0aGlzLl9zaXplVGltZXIgPSBzZXRUaW1lb3V0KEwuYmluZCh0aGlzLmZpcmUsIHRoaXMsICdtb3ZlZW5kJyksIDIwMCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5maXJlKCdtb3ZlZW5kJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5maXJlKCdyZXNpemUnLCB7XHJcblx0XHRcdG9sZFNpemU6IG9sZFNpemUsXHJcblx0XHRcdG5ld1NpemU6IG5ld1NpemVcclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdC8vIFRPRE8gaGFuZGxlci5hZGRUb1xyXG5cdGFkZEhhbmRsZXI6IGZ1bmN0aW9uIChuYW1lLCBIYW5kbGVyQ2xhc3MpIHtcclxuXHRcdGlmICghSGFuZGxlckNsYXNzKSB7IHJldHVybiB0aGlzOyB9XHJcblxyXG5cdFx0dmFyIGhhbmRsZXIgPSB0aGlzW25hbWVdID0gbmV3IEhhbmRsZXJDbGFzcyh0aGlzKTtcclxuXHJcblx0XHR0aGlzLl9oYW5kbGVycy5wdXNoKGhhbmRsZXIpO1xyXG5cclxuXHRcdGlmICh0aGlzLm9wdGlvbnNbbmFtZV0pIHtcclxuXHRcdFx0aGFuZGxlci5lbmFibGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyZW1vdmU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLl9sb2FkZWQpIHtcclxuXHRcdFx0dGhpcy5maXJlKCd1bmxvYWQnKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9pbml0RXZlbnRzKCdvZmYnKTtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHQvLyB0aHJvd3MgZXJyb3IgaW4gSUU2LThcclxuXHRcdFx0ZGVsZXRlIHRoaXMuX2NvbnRhaW5lci5fbGVhZmxldDtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0dGhpcy5fY29udGFpbmVyLl9sZWFmbGV0ID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX2NsZWFyUGFuZXMoKTtcclxuXHRcdGlmICh0aGlzLl9jbGVhckNvbnRyb2xQb3MpIHtcclxuXHRcdFx0dGhpcy5fY2xlYXJDb250cm9sUG9zKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fY2xlYXJIYW5kbGVycygpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cclxuXHQvLyBwdWJsaWMgbWV0aG9kcyBmb3IgZ2V0dGluZyBtYXAgc3RhdGVcclxuXHJcblx0Z2V0Q2VudGVyOiBmdW5jdGlvbiAoKSB7IC8vIChCb29sZWFuKSAtPiBMYXRMbmdcclxuXHRcdHRoaXMuX2NoZWNrSWZMb2FkZWQoKTtcclxuXHJcblx0XHRpZiAodGhpcy5faW5pdGlhbENlbnRlciAmJiAhdGhpcy5fbW92ZWQoKSkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5faW5pdGlhbENlbnRlcjtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzLmxheWVyUG9pbnRUb0xhdExuZyh0aGlzLl9nZXRDZW50ZXJMYXllclBvaW50KCkpO1xyXG5cdH0sXHJcblxyXG5cdGdldFpvb206IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl96b29tO1xyXG5cdH0sXHJcblxyXG5cdGdldEJvdW5kczogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGJvdW5kcyA9IHRoaXMuZ2V0UGl4ZWxCb3VuZHMoKSxcclxuXHRcdCAgICBzdyA9IHRoaXMudW5wcm9qZWN0KGJvdW5kcy5nZXRCb3R0b21MZWZ0KCkpLFxyXG5cdFx0ICAgIG5lID0gdGhpcy51bnByb2plY3QoYm91bmRzLmdldFRvcFJpZ2h0KCkpO1xyXG5cclxuXHRcdHJldHVybiBuZXcgTC5MYXRMbmdCb3VuZHMoc3csIG5lKTtcclxuXHR9LFxyXG5cclxuXHRnZXRNaW5ab29tOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25zLm1pblpvb20gPT09IHVuZGVmaW5lZCA/XHJcblx0XHRcdCh0aGlzLl9sYXllcnNNaW5ab29tID09PSB1bmRlZmluZWQgPyAwIDogdGhpcy5fbGF5ZXJzTWluWm9vbSkgOlxyXG5cdFx0XHR0aGlzLm9wdGlvbnMubWluWm9vbTtcclxuXHR9LFxyXG5cclxuXHRnZXRNYXhab29tOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25zLm1heFpvb20gPT09IHVuZGVmaW5lZCA/XHJcblx0XHRcdCh0aGlzLl9sYXllcnNNYXhab29tID09PSB1bmRlZmluZWQgPyBJbmZpbml0eSA6IHRoaXMuX2xheWVyc01heFpvb20pIDpcclxuXHRcdFx0dGhpcy5vcHRpb25zLm1heFpvb207XHJcblx0fSxcclxuXHJcblx0Z2V0Qm91bmRzWm9vbTogZnVuY3Rpb24gKGJvdW5kcywgaW5zaWRlLCBwYWRkaW5nKSB7IC8vIChMYXRMbmdCb3VuZHNbLCBCb29sZWFuLCBQb2ludF0pIC0+IE51bWJlclxyXG5cdFx0Ym91bmRzID0gTC5sYXRMbmdCb3VuZHMoYm91bmRzKTtcclxuXHJcblx0XHR2YXIgem9vbSA9IHRoaXMuZ2V0TWluWm9vbSgpIC0gKGluc2lkZSA/IDEgOiAwKSxcclxuXHRcdCAgICBtYXhab29tID0gdGhpcy5nZXRNYXhab29tKCksXHJcblx0XHQgICAgc2l6ZSA9IHRoaXMuZ2V0U2l6ZSgpLFxyXG5cclxuXHRcdCAgICBudyA9IGJvdW5kcy5nZXROb3J0aFdlc3QoKSxcclxuXHRcdCAgICBzZSA9IGJvdW5kcy5nZXRTb3V0aEVhc3QoKSxcclxuXHJcblx0XHQgICAgem9vbU5vdEZvdW5kID0gdHJ1ZSxcclxuXHRcdCAgICBib3VuZHNTaXplO1xyXG5cclxuXHRcdHBhZGRpbmcgPSBMLnBvaW50KHBhZGRpbmcgfHwgWzAsIDBdKTtcclxuXHJcblx0XHRkbyB7XHJcblx0XHRcdHpvb20rKztcclxuXHRcdFx0Ym91bmRzU2l6ZSA9IHRoaXMucHJvamVjdChzZSwgem9vbSkuc3VidHJhY3QodGhpcy5wcm9qZWN0KG53LCB6b29tKSkuYWRkKHBhZGRpbmcpO1xyXG5cdFx0XHR6b29tTm90Rm91bmQgPSAhaW5zaWRlID8gc2l6ZS5jb250YWlucyhib3VuZHNTaXplKSA6IGJvdW5kc1NpemUueCA8IHNpemUueCB8fCBib3VuZHNTaXplLnkgPCBzaXplLnk7XHJcblxyXG5cdFx0fSB3aGlsZSAoem9vbU5vdEZvdW5kICYmIHpvb20gPD0gbWF4Wm9vbSk7XHJcblxyXG5cdFx0aWYgKHpvb21Ob3RGb3VuZCAmJiBpbnNpZGUpIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGluc2lkZSA/IHpvb20gOiB6b29tIC0gMTtcclxuXHR9LFxyXG5cclxuXHRnZXRTaXplOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX3NpemUgfHwgdGhpcy5fc2l6ZUNoYW5nZWQpIHtcclxuXHRcdFx0dGhpcy5fc2l6ZSA9IG5ldyBMLlBvaW50KFxyXG5cdFx0XHRcdHRoaXMuX2NvbnRhaW5lci5jbGllbnRXaWR0aCxcclxuXHRcdFx0XHR0aGlzLl9jb250YWluZXIuY2xpZW50SGVpZ2h0KTtcclxuXHJcblx0XHRcdHRoaXMuX3NpemVDaGFuZ2VkID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcy5fc2l6ZS5jbG9uZSgpO1xyXG5cdH0sXHJcblxyXG5cdGdldFBpeGVsQm91bmRzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgdG9wTGVmdFBvaW50ID0gdGhpcy5fZ2V0VG9wTGVmdFBvaW50KCk7XHJcblx0XHRyZXR1cm4gbmV3IEwuQm91bmRzKHRvcExlZnRQb2ludCwgdG9wTGVmdFBvaW50LmFkZCh0aGlzLmdldFNpemUoKSkpO1xyXG5cdH0sXHJcblxyXG5cdGdldFBpeGVsT3JpZ2luOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR0aGlzLl9jaGVja0lmTG9hZGVkKCk7XHJcblx0XHRyZXR1cm4gdGhpcy5faW5pdGlhbFRvcExlZnRQb2ludDtcclxuXHR9LFxyXG5cclxuXHRnZXRQYW5lczogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3BhbmVzO1xyXG5cdH0sXHJcblxyXG5cdGdldENvbnRhaW5lcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2NvbnRhaW5lcjtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gVE9ETyByZXBsYWNlIHdpdGggdW5pdmVyc2FsIGltcGxlbWVudGF0aW9uIGFmdGVyIHJlZmFjdG9yaW5nIHByb2plY3Rpb25zXHJcblxyXG5cdGdldFpvb21TY2FsZTogZnVuY3Rpb24gKHRvWm9vbSkge1xyXG5cdFx0dmFyIGNycyA9IHRoaXMub3B0aW9ucy5jcnM7XHJcblx0XHRyZXR1cm4gY3JzLnNjYWxlKHRvWm9vbSkgLyBjcnMuc2NhbGUodGhpcy5fem9vbSk7XHJcblx0fSxcclxuXHJcblx0Z2V0U2NhbGVab29tOiBmdW5jdGlvbiAoc2NhbGUpIHtcclxuXHRcdHJldHVybiB0aGlzLl96b29tICsgKE1hdGgubG9nKHNjYWxlKSAvIE1hdGguTE4yKTtcclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gY29udmVyc2lvbiBtZXRob2RzXHJcblxyXG5cdHByb2plY3Q6IGZ1bmN0aW9uIChsYXRsbmcsIHpvb20pIHsgLy8gKExhdExuZ1ssIE51bWJlcl0pIC0+IFBvaW50XHJcblx0XHR6b29tID0gem9vbSA9PT0gdW5kZWZpbmVkID8gdGhpcy5fem9vbSA6IHpvb207XHJcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25zLmNycy5sYXRMbmdUb1BvaW50KEwubGF0TG5nKGxhdGxuZyksIHpvb20pO1xyXG5cdH0sXHJcblxyXG5cdHVucHJvamVjdDogZnVuY3Rpb24gKHBvaW50LCB6b29tKSB7IC8vIChQb2ludFssIE51bWJlcl0pIC0+IExhdExuZ1xyXG5cdFx0em9vbSA9IHpvb20gPT09IHVuZGVmaW5lZCA/IHRoaXMuX3pvb20gOiB6b29tO1xyXG5cdFx0cmV0dXJuIHRoaXMub3B0aW9ucy5jcnMucG9pbnRUb0xhdExuZyhMLnBvaW50KHBvaW50KSwgem9vbSk7XHJcblx0fSxcclxuXHJcblx0bGF5ZXJQb2ludFRvTGF0TG5nOiBmdW5jdGlvbiAocG9pbnQpIHsgLy8gKFBvaW50KVxyXG5cdFx0dmFyIHByb2plY3RlZFBvaW50ID0gTC5wb2ludChwb2ludCkuYWRkKHRoaXMuZ2V0UGl4ZWxPcmlnaW4oKSk7XHJcblx0XHRyZXR1cm4gdGhpcy51bnByb2plY3QocHJvamVjdGVkUG9pbnQpO1xyXG5cdH0sXHJcblxyXG5cdGxhdExuZ1RvTGF5ZXJQb2ludDogZnVuY3Rpb24gKGxhdGxuZykgeyAvLyAoTGF0TG5nKVxyXG5cdFx0dmFyIHByb2plY3RlZFBvaW50ID0gdGhpcy5wcm9qZWN0KEwubGF0TG5nKGxhdGxuZykpLl9yb3VuZCgpO1xyXG5cdFx0cmV0dXJuIHByb2plY3RlZFBvaW50Ll9zdWJ0cmFjdCh0aGlzLmdldFBpeGVsT3JpZ2luKCkpO1xyXG5cdH0sXHJcblxyXG5cdGNvbnRhaW5lclBvaW50VG9MYXllclBvaW50OiBmdW5jdGlvbiAocG9pbnQpIHsgLy8gKFBvaW50KVxyXG5cdFx0cmV0dXJuIEwucG9pbnQocG9pbnQpLnN1YnRyYWN0KHRoaXMuX2dldE1hcFBhbmVQb3MoKSk7XHJcblx0fSxcclxuXHJcblx0bGF5ZXJQb2ludFRvQ29udGFpbmVyUG9pbnQ6IGZ1bmN0aW9uIChwb2ludCkgeyAvLyAoUG9pbnQpXHJcblx0XHRyZXR1cm4gTC5wb2ludChwb2ludCkuYWRkKHRoaXMuX2dldE1hcFBhbmVQb3MoKSk7XHJcblx0fSxcclxuXHJcblx0Y29udGFpbmVyUG9pbnRUb0xhdExuZzogZnVuY3Rpb24gKHBvaW50KSB7XHJcblx0XHR2YXIgbGF5ZXJQb2ludCA9IHRoaXMuY29udGFpbmVyUG9pbnRUb0xheWVyUG9pbnQoTC5wb2ludChwb2ludCkpO1xyXG5cdFx0cmV0dXJuIHRoaXMubGF5ZXJQb2ludFRvTGF0TG5nKGxheWVyUG9pbnQpO1xyXG5cdH0sXHJcblxyXG5cdGxhdExuZ1RvQ29udGFpbmVyUG9pbnQ6IGZ1bmN0aW9uIChsYXRsbmcpIHtcclxuXHRcdHJldHVybiB0aGlzLmxheWVyUG9pbnRUb0NvbnRhaW5lclBvaW50KHRoaXMubGF0TG5nVG9MYXllclBvaW50KEwubGF0TG5nKGxhdGxuZykpKTtcclxuXHR9LFxyXG5cclxuXHRtb3VzZUV2ZW50VG9Db250YWluZXJQb2ludDogZnVuY3Rpb24gKGUpIHsgLy8gKE1vdXNlRXZlbnQpXHJcblx0XHRyZXR1cm4gTC5Eb21FdmVudC5nZXRNb3VzZVBvc2l0aW9uKGUsIHRoaXMuX2NvbnRhaW5lcik7XHJcblx0fSxcclxuXHJcblx0bW91c2VFdmVudFRvTGF5ZXJQb2ludDogZnVuY3Rpb24gKGUpIHsgLy8gKE1vdXNlRXZlbnQpXHJcblx0XHRyZXR1cm4gdGhpcy5jb250YWluZXJQb2ludFRvTGF5ZXJQb2ludCh0aGlzLm1vdXNlRXZlbnRUb0NvbnRhaW5lclBvaW50KGUpKTtcclxuXHR9LFxyXG5cclxuXHRtb3VzZUV2ZW50VG9MYXRMbmc6IGZ1bmN0aW9uIChlKSB7IC8vIChNb3VzZUV2ZW50KVxyXG5cdFx0cmV0dXJuIHRoaXMubGF5ZXJQb2ludFRvTGF0TG5nKHRoaXMubW91c2VFdmVudFRvTGF5ZXJQb2ludChlKSk7XHJcblx0fSxcclxuXHJcblxyXG5cdC8vIG1hcCBpbml0aWFsaXphdGlvbiBtZXRob2RzXHJcblxyXG5cdF9pbml0Q29udGFpbmVyOiBmdW5jdGlvbiAoaWQpIHtcclxuXHRcdHZhciBjb250YWluZXIgPSB0aGlzLl9jb250YWluZXIgPSBMLkRvbVV0aWwuZ2V0KGlkKTtcclxuXHJcblx0XHRpZiAoIWNvbnRhaW5lcikge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ01hcCBjb250YWluZXIgbm90IGZvdW5kLicpO1xyXG5cdFx0fSBlbHNlIGlmIChjb250YWluZXIuX2xlYWZsZXQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCdNYXAgY29udGFpbmVyIGlzIGFscmVhZHkgaW5pdGlhbGl6ZWQuJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29udGFpbmVyLl9sZWFmbGV0ID0gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHRfaW5pdExheW91dDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGNvbnRhaW5lciA9IHRoaXMuX2NvbnRhaW5lcjtcclxuXHJcblx0XHRMLkRvbVV0aWwuYWRkQ2xhc3MoY29udGFpbmVyLCAnbGVhZmxldC1jb250YWluZXInICtcclxuXHRcdFx0KEwuQnJvd3Nlci50b3VjaCA/ICcgbGVhZmxldC10b3VjaCcgOiAnJykgK1xyXG5cdFx0XHQoTC5Ccm93c2VyLnJldGluYSA/ICcgbGVhZmxldC1yZXRpbmEnIDogJycpICtcclxuXHRcdFx0KEwuQnJvd3Nlci5pZWx0OSA/ICcgbGVhZmxldC1vbGRpZScgOiAnJykgK1xyXG5cdFx0XHQodGhpcy5vcHRpb25zLmZhZGVBbmltYXRpb24gPyAnIGxlYWZsZXQtZmFkZS1hbmltJyA6ICcnKSk7XHJcblxyXG5cdFx0dmFyIHBvc2l0aW9uID0gTC5Eb21VdGlsLmdldFN0eWxlKGNvbnRhaW5lciwgJ3Bvc2l0aW9uJyk7XHJcblxyXG5cdFx0aWYgKHBvc2l0aW9uICE9PSAnYWJzb2x1dGUnICYmIHBvc2l0aW9uICE9PSAncmVsYXRpdmUnICYmIHBvc2l0aW9uICE9PSAnZml4ZWQnKSB7XHJcblx0XHRcdGNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5faW5pdFBhbmVzKCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2luaXRDb250cm9sUG9zKSB7XHJcblx0XHRcdHRoaXMuX2luaXRDb250cm9sUG9zKCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2luaXRQYW5lczogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHBhbmVzID0gdGhpcy5fcGFuZXMgPSB7fTtcclxuXHJcblx0XHR0aGlzLl9tYXBQYW5lID0gcGFuZXMubWFwUGFuZSA9IHRoaXMuX2NyZWF0ZVBhbmUoJ2xlYWZsZXQtbWFwLXBhbmUnLCB0aGlzLl9jb250YWluZXIpO1xyXG5cclxuXHRcdHRoaXMuX3RpbGVQYW5lID0gcGFuZXMudGlsZVBhbmUgPSB0aGlzLl9jcmVhdGVQYW5lKCdsZWFmbGV0LXRpbGUtcGFuZScsIHRoaXMuX21hcFBhbmUpO1xyXG5cdFx0cGFuZXMub2JqZWN0c1BhbmUgPSB0aGlzLl9jcmVhdGVQYW5lKCdsZWFmbGV0LW9iamVjdHMtcGFuZScsIHRoaXMuX21hcFBhbmUpO1xyXG5cdFx0cGFuZXMuc2hhZG93UGFuZSA9IHRoaXMuX2NyZWF0ZVBhbmUoJ2xlYWZsZXQtc2hhZG93LXBhbmUnKTtcclxuXHRcdHBhbmVzLm92ZXJsYXlQYW5lID0gdGhpcy5fY3JlYXRlUGFuZSgnbGVhZmxldC1vdmVybGF5LXBhbmUnKTtcclxuXHRcdHBhbmVzLm1hcmtlclBhbmUgPSB0aGlzLl9jcmVhdGVQYW5lKCdsZWFmbGV0LW1hcmtlci1wYW5lJyk7XHJcblx0XHRwYW5lcy5wb3B1cFBhbmUgPSB0aGlzLl9jcmVhdGVQYW5lKCdsZWFmbGV0LXBvcHVwLXBhbmUnKTtcclxuXHJcblx0XHR2YXIgem9vbUhpZGUgPSAnIGxlYWZsZXQtem9vbS1oaWRlJztcclxuXHJcblx0XHRpZiAoIXRoaXMub3B0aW9ucy5tYXJrZXJab29tQW5pbWF0aW9uKSB7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyhwYW5lcy5tYXJrZXJQYW5lLCB6b29tSGlkZSk7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyhwYW5lcy5zaGFkb3dQYW5lLCB6b29tSGlkZSk7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyhwYW5lcy5wb3B1cFBhbmUsIHpvb21IaWRlKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlUGFuZTogZnVuY3Rpb24gKGNsYXNzTmFtZSwgY29udGFpbmVyKSB7XHJcblx0XHRyZXR1cm4gTC5Eb21VdGlsLmNyZWF0ZSgnZGl2JywgY2xhc3NOYW1lLCBjb250YWluZXIgfHwgdGhpcy5fcGFuZXMub2JqZWN0c1BhbmUpO1xyXG5cdH0sXHJcblxyXG5cdF9jbGVhclBhbmVzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR0aGlzLl9jb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5fbWFwUGFuZSk7XHJcblx0fSxcclxuXHJcblx0X2FkZExheWVyczogZnVuY3Rpb24gKGxheWVycykge1xyXG5cdFx0bGF5ZXJzID0gbGF5ZXJzID8gKEwuVXRpbC5pc0FycmF5KGxheWVycykgPyBsYXllcnMgOiBbbGF5ZXJzXSkgOiBbXTtcclxuXHJcblx0XHRmb3IgKHZhciBpID0gMCwgbGVuID0gbGF5ZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdHRoaXMuYWRkTGF5ZXIobGF5ZXJzW2ldKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHJcblx0Ly8gcHJpdmF0ZSBtZXRob2RzIHRoYXQgbW9kaWZ5IG1hcCBzdGF0ZVxyXG5cclxuXHRfcmVzZXRWaWV3OiBmdW5jdGlvbiAoY2VudGVyLCB6b29tLCBwcmVzZXJ2ZU1hcE9mZnNldCwgYWZ0ZXJab29tQW5pbSkge1xyXG5cclxuXHRcdHZhciB6b29tQ2hhbmdlZCA9ICh0aGlzLl96b29tICE9PSB6b29tKTtcclxuXHJcblx0XHRpZiAoIWFmdGVyWm9vbUFuaW0pIHtcclxuXHRcdFx0dGhpcy5maXJlKCdtb3Zlc3RhcnQnKTtcclxuXHJcblx0XHRcdGlmICh6b29tQ2hhbmdlZCkge1xyXG5cdFx0XHRcdHRoaXMuZmlyZSgnem9vbXN0YXJ0Jyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl96b29tID0gem9vbTtcclxuXHRcdHRoaXMuX2luaXRpYWxDZW50ZXIgPSBjZW50ZXI7XHJcblxyXG5cdFx0dGhpcy5faW5pdGlhbFRvcExlZnRQb2ludCA9IHRoaXMuX2dldE5ld1RvcExlZnRQb2ludChjZW50ZXIpO1xyXG5cclxuXHRcdGlmICghcHJlc2VydmVNYXBPZmZzZXQpIHtcclxuXHRcdFx0TC5Eb21VdGlsLnNldFBvc2l0aW9uKHRoaXMuX21hcFBhbmUsIG5ldyBMLlBvaW50KDAsIDApKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuX2luaXRpYWxUb3BMZWZ0UG9pbnQuX2FkZCh0aGlzLl9nZXRNYXBQYW5lUG9zKCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3RpbGVMYXllcnNUb0xvYWQgPSB0aGlzLl90aWxlTGF5ZXJzTnVtO1xyXG5cclxuXHRcdHZhciBsb2FkaW5nID0gIXRoaXMuX2xvYWRlZDtcclxuXHRcdHRoaXMuX2xvYWRlZCA9IHRydWU7XHJcblxyXG5cdFx0dGhpcy5maXJlKCd2aWV3cmVzZXQnLCB7aGFyZDogIXByZXNlcnZlTWFwT2Zmc2V0fSk7XHJcblxyXG5cdFx0aWYgKGxvYWRpbmcpIHtcclxuXHRcdFx0dGhpcy5maXJlKCdsb2FkJyk7XHJcblx0XHRcdHRoaXMuZWFjaExheWVyKHRoaXMuX2xheWVyQWRkLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmZpcmUoJ21vdmUnKTtcclxuXHJcblx0XHRpZiAoem9vbUNoYW5nZWQgfHwgYWZ0ZXJab29tQW5pbSkge1xyXG5cdFx0XHR0aGlzLmZpcmUoJ3pvb21lbmQnKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmZpcmUoJ21vdmVlbmQnLCB7aGFyZDogIXByZXNlcnZlTWFwT2Zmc2V0fSk7XHJcblx0fSxcclxuXHJcblx0X3Jhd1BhbkJ5OiBmdW5jdGlvbiAob2Zmc2V0KSB7XHJcblx0XHRMLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fbWFwUGFuZSwgdGhpcy5fZ2V0TWFwUGFuZVBvcygpLnN1YnRyYWN0KG9mZnNldCkpO1xyXG5cdH0sXHJcblxyXG5cdF9nZXRab29tU3BhbjogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0TWF4Wm9vbSgpIC0gdGhpcy5nZXRNaW5ab29tKCk7XHJcblx0fSxcclxuXHJcblx0X3VwZGF0ZVpvb21MZXZlbHM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBpLFxyXG5cdFx0XHRtaW5ab29tID0gSW5maW5pdHksXHJcblx0XHRcdG1heFpvb20gPSAtSW5maW5pdHksXHJcblx0XHRcdG9sZFpvb21TcGFuID0gdGhpcy5fZ2V0Wm9vbVNwYW4oKTtcclxuXHJcblx0XHRmb3IgKGkgaW4gdGhpcy5fem9vbUJvdW5kTGF5ZXJzKSB7XHJcblx0XHRcdHZhciBsYXllciA9IHRoaXMuX3pvb21Cb3VuZExheWVyc1tpXTtcclxuXHRcdFx0aWYgKCFpc05hTihsYXllci5vcHRpb25zLm1pblpvb20pKSB7XHJcblx0XHRcdFx0bWluWm9vbSA9IE1hdGgubWluKG1pblpvb20sIGxheWVyLm9wdGlvbnMubWluWm9vbSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFpc05hTihsYXllci5vcHRpb25zLm1heFpvb20pKSB7XHJcblx0XHRcdFx0bWF4Wm9vbSA9IE1hdGgubWF4KG1heFpvb20sIGxheWVyLm9wdGlvbnMubWF4Wm9vbSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaSA9PT0gdW5kZWZpbmVkKSB7IC8vIHdlIGhhdmUgbm8gdGlsZWxheWVyc1xyXG5cdFx0XHR0aGlzLl9sYXllcnNNYXhab29tID0gdGhpcy5fbGF5ZXJzTWluWm9vbSA9IHVuZGVmaW5lZDtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuX2xheWVyc01heFpvb20gPSBtYXhab29tO1xyXG5cdFx0XHR0aGlzLl9sYXllcnNNaW5ab29tID0gbWluWm9vbTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAob2xkWm9vbVNwYW4gIT09IHRoaXMuX2dldFpvb21TcGFuKCkpIHtcclxuXHRcdFx0dGhpcy5maXJlKCd6b29tbGV2ZWxzY2hhbmdlJyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X3Bhbkluc2lkZU1heEJvdW5kczogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy5wYW5JbnNpZGVCb3VuZHModGhpcy5vcHRpb25zLm1heEJvdW5kcyk7XHJcblx0fSxcclxuXHJcblx0X2NoZWNrSWZMb2FkZWQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICghdGhpcy5fbG9hZGVkKSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcignU2V0IG1hcCBjZW50ZXIgYW5kIHpvb20gZmlyc3QuJyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0Ly8gbWFwIGV2ZW50c1xyXG5cclxuXHRfaW5pdEV2ZW50czogZnVuY3Rpb24gKG9uT2ZmKSB7XHJcblx0XHRpZiAoIUwuRG9tRXZlbnQpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0b25PZmYgPSBvbk9mZiB8fCAnb24nO1xyXG5cclxuXHRcdEwuRG9tRXZlbnRbb25PZmZdKHRoaXMuX2NvbnRhaW5lciwgJ2NsaWNrJywgdGhpcy5fb25Nb3VzZUNsaWNrLCB0aGlzKTtcclxuXHJcblx0XHR2YXIgZXZlbnRzID0gWydkYmxjbGljaycsICdtb3VzZWRvd24nLCAnbW91c2V1cCcsICdtb3VzZWVudGVyJyxcclxuXHRcdCAgICAgICAgICAgICAgJ21vdXNlbGVhdmUnLCAnbW91c2Vtb3ZlJywgJ2NvbnRleHRtZW51J10sXHJcblx0XHQgICAgaSwgbGVuO1xyXG5cclxuXHRcdGZvciAoaSA9IDAsIGxlbiA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRMLkRvbUV2ZW50W29uT2ZmXSh0aGlzLl9jb250YWluZXIsIGV2ZW50c1tpXSwgdGhpcy5fZmlyZU1vdXNlRXZlbnQsIHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMudHJhY2tSZXNpemUpIHtcclxuXHRcdFx0TC5Eb21FdmVudFtvbk9mZl0od2luZG93LCAncmVzaXplJywgdGhpcy5fb25SZXNpemUsIHRoaXMpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9vblJlc2l6ZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0TC5VdGlsLmNhbmNlbEFuaW1GcmFtZSh0aGlzLl9yZXNpemVSZXF1ZXN0KTtcclxuXHRcdHRoaXMuX3Jlc2l6ZVJlcXVlc3QgPSBMLlV0aWwucmVxdWVzdEFuaW1GcmFtZShcclxuXHRcdCAgICAgICAgZnVuY3Rpb24gKCkgeyB0aGlzLmludmFsaWRhdGVTaXplKHtkZWJvdW5jZU1vdmVlbmQ6IHRydWV9KTsgfSwgdGhpcywgZmFsc2UsIHRoaXMuX2NvbnRhaW5lcik7XHJcblx0fSxcclxuXHJcblx0X29uTW91c2VDbGljazogZnVuY3Rpb24gKGUpIHtcclxuXHRcdGlmICghdGhpcy5fbG9hZGVkIHx8ICghZS5fc2ltdWxhdGVkICYmXHJcblx0XHQgICAgICAgICgodGhpcy5kcmFnZ2luZyAmJiB0aGlzLmRyYWdnaW5nLm1vdmVkKCkpIHx8XHJcblx0XHQgICAgICAgICAodGhpcy5ib3hab29tICAmJiB0aGlzLmJveFpvb20ubW92ZWQoKSkpKSB8fFxyXG5cdFx0ICAgICAgICAgICAgTC5Eb21FdmVudC5fc2tpcHBlZChlKSkgeyByZXR1cm47IH1cclxuXHJcblx0XHR0aGlzLmZpcmUoJ3ByZWNsaWNrJyk7XHJcblx0XHR0aGlzLl9maXJlTW91c2VFdmVudChlKTtcclxuXHR9LFxyXG5cclxuXHRfZmlyZU1vdXNlRXZlbnQ6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRpZiAoIXRoaXMuX2xvYWRlZCB8fCBMLkRvbUV2ZW50Ll9za2lwcGVkKGUpKSB7IHJldHVybjsgfVxyXG5cclxuXHRcdHZhciB0eXBlID0gZS50eXBlO1xyXG5cclxuXHRcdHR5cGUgPSAodHlwZSA9PT0gJ21vdXNlZW50ZXInID8gJ21vdXNlb3ZlcicgOiAodHlwZSA9PT0gJ21vdXNlbGVhdmUnID8gJ21vdXNlb3V0JyA6IHR5cGUpKTtcclxuXHJcblx0XHRpZiAoIXRoaXMuaGFzRXZlbnRMaXN0ZW5lcnModHlwZSkpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0aWYgKHR5cGUgPT09ICdjb250ZXh0bWVudScpIHtcclxuXHRcdFx0TC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdChlKTtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgY29udGFpbmVyUG9pbnQgPSB0aGlzLm1vdXNlRXZlbnRUb0NvbnRhaW5lclBvaW50KGUpLFxyXG5cdFx0ICAgIGxheWVyUG9pbnQgPSB0aGlzLmNvbnRhaW5lclBvaW50VG9MYXllclBvaW50KGNvbnRhaW5lclBvaW50KSxcclxuXHRcdCAgICBsYXRsbmcgPSB0aGlzLmxheWVyUG9pbnRUb0xhdExuZyhsYXllclBvaW50KTtcclxuXHJcblx0XHR0aGlzLmZpcmUodHlwZSwge1xyXG5cdFx0XHRsYXRsbmc6IGxhdGxuZyxcclxuXHRcdFx0bGF5ZXJQb2ludDogbGF5ZXJQb2ludCxcclxuXHRcdFx0Y29udGFpbmVyUG9pbnQ6IGNvbnRhaW5lclBvaW50LFxyXG5cdFx0XHRvcmlnaW5hbEV2ZW50OiBlXHJcblx0XHR9KTtcclxuXHR9LFxyXG5cclxuXHRfb25UaWxlTGF5ZXJMb2FkOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR0aGlzLl90aWxlTGF5ZXJzVG9Mb2FkLS07XHJcblx0XHRpZiAodGhpcy5fdGlsZUxheWVyc051bSAmJiAhdGhpcy5fdGlsZUxheWVyc1RvTG9hZCkge1xyXG5cdFx0XHR0aGlzLmZpcmUoJ3RpbGVsYXllcnNsb2FkJyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2NsZWFySGFuZGxlcnM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9oYW5kbGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHR0aGlzLl9oYW5kbGVyc1tpXS5kaXNhYmxlKCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0d2hlblJlYWR5OiBmdW5jdGlvbiAoY2FsbGJhY2ssIGNvbnRleHQpIHtcclxuXHRcdGlmICh0aGlzLl9sb2FkZWQpIHtcclxuXHRcdFx0Y2FsbGJhY2suY2FsbChjb250ZXh0IHx8IHRoaXMsIHRoaXMpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5vbignbG9hZCcsIGNhbGxiYWNrLCBjb250ZXh0KTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdF9sYXllckFkZDogZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHRsYXllci5vbkFkZCh0aGlzKTtcclxuXHRcdHRoaXMuZmlyZSgnbGF5ZXJhZGQnLCB7bGF5ZXI6IGxheWVyfSk7XHJcblx0fSxcclxuXHJcblxyXG5cdC8vIHByaXZhdGUgbWV0aG9kcyBmb3IgZ2V0dGluZyBtYXAgc3RhdGVcclxuXHJcblx0X2dldE1hcFBhbmVQb3M6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiBMLkRvbVV0aWwuZ2V0UG9zaXRpb24odGhpcy5fbWFwUGFuZSk7XHJcblx0fSxcclxuXHJcblx0X21vdmVkOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcG9zID0gdGhpcy5fZ2V0TWFwUGFuZVBvcygpO1xyXG5cdFx0cmV0dXJuIHBvcyAmJiAhcG9zLmVxdWFscyhbMCwgMF0pO1xyXG5cdH0sXHJcblxyXG5cdF9nZXRUb3BMZWZ0UG9pbnQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmdldFBpeGVsT3JpZ2luKCkuc3VidHJhY3QodGhpcy5fZ2V0TWFwUGFuZVBvcygpKTtcclxuXHR9LFxyXG5cclxuXHRfZ2V0TmV3VG9wTGVmdFBvaW50OiBmdW5jdGlvbiAoY2VudGVyLCB6b29tKSB7XHJcblx0XHR2YXIgdmlld0hhbGYgPSB0aGlzLmdldFNpemUoKS5fZGl2aWRlQnkoMik7XHJcblx0XHQvLyBUT0RPIHJvdW5kIG9uIGRpc3BsYXksIG5vdCBjYWxjdWxhdGlvbiB0byBpbmNyZWFzZSBwcmVjaXNpb24/XHJcblx0XHRyZXR1cm4gdGhpcy5wcm9qZWN0KGNlbnRlciwgem9vbSkuX3N1YnRyYWN0KHZpZXdIYWxmKS5fcm91bmQoKTtcclxuXHR9LFxyXG5cclxuXHRfbGF0TG5nVG9OZXdMYXllclBvaW50OiBmdW5jdGlvbiAobGF0bG5nLCBuZXdab29tLCBuZXdDZW50ZXIpIHtcclxuXHRcdHZhciB0b3BMZWZ0ID0gdGhpcy5fZ2V0TmV3VG9wTGVmdFBvaW50KG5ld0NlbnRlciwgbmV3Wm9vbSkuYWRkKHRoaXMuX2dldE1hcFBhbmVQb3MoKSk7XHJcblx0XHRyZXR1cm4gdGhpcy5wcm9qZWN0KGxhdGxuZywgbmV3Wm9vbSkuX3N1YnRyYWN0KHRvcExlZnQpO1xyXG5cdH0sXHJcblxyXG5cdC8vIGxheWVyIHBvaW50IG9mIHRoZSBjdXJyZW50IGNlbnRlclxyXG5cdF9nZXRDZW50ZXJMYXllclBvaW50OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5jb250YWluZXJQb2ludFRvTGF5ZXJQb2ludCh0aGlzLmdldFNpemUoKS5fZGl2aWRlQnkoMikpO1xyXG5cdH0sXHJcblxyXG5cdC8vIG9mZnNldCBvZiB0aGUgc3BlY2lmaWVkIHBsYWNlIHRvIHRoZSBjdXJyZW50IGNlbnRlciBpbiBwaXhlbHNcclxuXHRfZ2V0Q2VudGVyT2Zmc2V0OiBmdW5jdGlvbiAobGF0bG5nKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5sYXRMbmdUb0xheWVyUG9pbnQobGF0bG5nKS5zdWJ0cmFjdCh0aGlzLl9nZXRDZW50ZXJMYXllclBvaW50KCkpO1xyXG5cdH0sXHJcblxyXG5cdC8vIGFkanVzdCBjZW50ZXIgZm9yIHZpZXcgdG8gZ2V0IGluc2lkZSBib3VuZHNcclxuXHRfbGltaXRDZW50ZXI6IGZ1bmN0aW9uIChjZW50ZXIsIHpvb20sIGJvdW5kcykge1xyXG5cclxuXHRcdGlmICghYm91bmRzKSB7IHJldHVybiBjZW50ZXI7IH1cclxuXHJcblx0XHR2YXIgY2VudGVyUG9pbnQgPSB0aGlzLnByb2plY3QoY2VudGVyLCB6b29tKSxcclxuXHRcdCAgICB2aWV3SGFsZiA9IHRoaXMuZ2V0U2l6ZSgpLmRpdmlkZUJ5KDIpLFxyXG5cdFx0ICAgIHZpZXdCb3VuZHMgPSBuZXcgTC5Cb3VuZHMoY2VudGVyUG9pbnQuc3VidHJhY3Qodmlld0hhbGYpLCBjZW50ZXJQb2ludC5hZGQodmlld0hhbGYpKSxcclxuXHRcdCAgICBvZmZzZXQgPSB0aGlzLl9nZXRCb3VuZHNPZmZzZXQodmlld0JvdW5kcywgYm91bmRzLCB6b29tKTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcy51bnByb2plY3QoY2VudGVyUG9pbnQuYWRkKG9mZnNldCksIHpvb20pO1xyXG5cdH0sXHJcblxyXG5cdC8vIGFkanVzdCBvZmZzZXQgZm9yIHZpZXcgdG8gZ2V0IGluc2lkZSBib3VuZHNcclxuXHRfbGltaXRPZmZzZXQ6IGZ1bmN0aW9uIChvZmZzZXQsIGJvdW5kcykge1xyXG5cdFx0aWYgKCFib3VuZHMpIHsgcmV0dXJuIG9mZnNldDsgfVxyXG5cclxuXHRcdHZhciB2aWV3Qm91bmRzID0gdGhpcy5nZXRQaXhlbEJvdW5kcygpLFxyXG5cdFx0ICAgIG5ld0JvdW5kcyA9IG5ldyBMLkJvdW5kcyh2aWV3Qm91bmRzLm1pbi5hZGQob2Zmc2V0KSwgdmlld0JvdW5kcy5tYXguYWRkKG9mZnNldCkpO1xyXG5cclxuXHRcdHJldHVybiBvZmZzZXQuYWRkKHRoaXMuX2dldEJvdW5kc09mZnNldChuZXdCb3VuZHMsIGJvdW5kcykpO1xyXG5cdH0sXHJcblxyXG5cdC8vIHJldHVybnMgb2Zmc2V0IG5lZWRlZCBmb3IgcHhCb3VuZHMgdG8gZ2V0IGluc2lkZSBtYXhCb3VuZHMgYXQgYSBzcGVjaWZpZWQgem9vbVxyXG5cdF9nZXRCb3VuZHNPZmZzZXQ6IGZ1bmN0aW9uIChweEJvdW5kcywgbWF4Qm91bmRzLCB6b29tKSB7XHJcblx0XHR2YXIgbndPZmZzZXQgPSB0aGlzLnByb2plY3QobWF4Qm91bmRzLmdldE5vcnRoV2VzdCgpLCB6b29tKS5zdWJ0cmFjdChweEJvdW5kcy5taW4pLFxyXG5cdFx0ICAgIHNlT2Zmc2V0ID0gdGhpcy5wcm9qZWN0KG1heEJvdW5kcy5nZXRTb3V0aEVhc3QoKSwgem9vbSkuc3VidHJhY3QocHhCb3VuZHMubWF4KSxcclxuXHJcblx0XHQgICAgZHggPSB0aGlzLl9yZWJvdW5kKG53T2Zmc2V0LngsIC1zZU9mZnNldC54KSxcclxuXHRcdCAgICBkeSA9IHRoaXMuX3JlYm91bmQobndPZmZzZXQueSwgLXNlT2Zmc2V0LnkpO1xyXG5cclxuXHRcdHJldHVybiBuZXcgTC5Qb2ludChkeCwgZHkpO1xyXG5cdH0sXHJcblxyXG5cdF9yZWJvdW5kOiBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcclxuXHRcdHJldHVybiBsZWZ0ICsgcmlnaHQgPiAwID9cclxuXHRcdFx0TWF0aC5yb3VuZChsZWZ0IC0gcmlnaHQpIC8gMiA6XHJcblx0XHRcdE1hdGgubWF4KDAsIE1hdGguY2VpbChsZWZ0KSkgLSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKHJpZ2h0KSk7XHJcblx0fSxcclxuXHJcblx0X2xpbWl0Wm9vbTogZnVuY3Rpb24gKHpvb20pIHtcclxuXHRcdHZhciBtaW4gPSB0aGlzLmdldE1pblpvb20oKSxcclxuXHRcdCAgICBtYXggPSB0aGlzLmdldE1heFpvb20oKTtcclxuXHJcblx0XHRyZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHpvb20pKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5tYXAgPSBmdW5jdGlvbiAoaWQsIG9wdGlvbnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuTWFwKGlkLCBvcHRpb25zKTtcclxufTtcclxuXG5cbi8qXHJcbiAqIE1lcmNhdG9yIHByb2plY3Rpb24gdGhhdCB0YWtlcyBpbnRvIGFjY291bnQgdGhhdCB0aGUgRWFydGggaXMgbm90IGEgcGVyZmVjdCBzcGhlcmUuXHJcbiAqIExlc3MgcG9wdWxhciB0aGFuIHNwaGVyaWNhbCBtZXJjYXRvcjsgdXNlZCBieSBwcm9qZWN0aW9ucyBsaWtlIEVQU0c6MzM5NS5cclxuICovXHJcblxyXG5MLlByb2plY3Rpb24uTWVyY2F0b3IgPSB7XHJcblx0TUFYX0xBVElUVURFOiA4NS4wODQwNTkxNTU2LFxyXG5cclxuXHRSX01JTk9SOiA2MzU2NzUyLjMxNDI0NTE3OSxcclxuXHRSX01BSk9SOiA2Mzc4MTM3LFxyXG5cclxuXHRwcm9qZWN0OiBmdW5jdGlvbiAobGF0bG5nKSB7IC8vIChMYXRMbmcpIC0+IFBvaW50XHJcblx0XHR2YXIgZCA9IEwuTGF0TG5nLkRFR19UT19SQUQsXHJcblx0XHQgICAgbWF4ID0gdGhpcy5NQVhfTEFUSVRVREUsXHJcblx0XHQgICAgbGF0ID0gTWF0aC5tYXgoTWF0aC5taW4obWF4LCBsYXRsbmcubGF0KSwgLW1heCksXHJcblx0XHQgICAgciA9IHRoaXMuUl9NQUpPUixcclxuXHRcdCAgICByMiA9IHRoaXMuUl9NSU5PUixcclxuXHRcdCAgICB4ID0gbGF0bG5nLmxuZyAqIGQgKiByLFxyXG5cdFx0ICAgIHkgPSBsYXQgKiBkLFxyXG5cdFx0ICAgIHRtcCA9IHIyIC8gcixcclxuXHRcdCAgICBlY2NlbnQgPSBNYXRoLnNxcnQoMS4wIC0gdG1wICogdG1wKSxcclxuXHRcdCAgICBjb24gPSBlY2NlbnQgKiBNYXRoLnNpbih5KTtcclxuXHJcblx0XHRjb24gPSBNYXRoLnBvdygoMSAtIGNvbikgLyAoMSArIGNvbiksIGVjY2VudCAqIDAuNSk7XHJcblxyXG5cdFx0dmFyIHRzID0gTWF0aC50YW4oMC41ICogKChNYXRoLlBJICogMC41KSAtIHkpKSAvIGNvbjtcclxuXHRcdHkgPSAtciAqIE1hdGgubG9nKHRzKTtcclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuUG9pbnQoeCwgeSk7XHJcblx0fSxcclxuXHJcblx0dW5wcm9qZWN0OiBmdW5jdGlvbiAocG9pbnQpIHsgLy8gKFBvaW50LCBCb29sZWFuKSAtPiBMYXRMbmdcclxuXHRcdHZhciBkID0gTC5MYXRMbmcuUkFEX1RPX0RFRyxcclxuXHRcdCAgICByID0gdGhpcy5SX01BSk9SLFxyXG5cdFx0ICAgIHIyID0gdGhpcy5SX01JTk9SLFxyXG5cdFx0ICAgIGxuZyA9IHBvaW50LnggKiBkIC8gcixcclxuXHRcdCAgICB0bXAgPSByMiAvIHIsXHJcblx0XHQgICAgZWNjZW50ID0gTWF0aC5zcXJ0KDEgLSAodG1wICogdG1wKSksXHJcblx0XHQgICAgdHMgPSBNYXRoLmV4cCgtIHBvaW50LnkgLyByKSxcclxuXHRcdCAgICBwaGkgPSAoTWF0aC5QSSAvIDIpIC0gMiAqIE1hdGguYXRhbih0cyksXHJcblx0XHQgICAgbnVtSXRlciA9IDE1LFxyXG5cdFx0ICAgIHRvbCA9IDFlLTcsXHJcblx0XHQgICAgaSA9IG51bUl0ZXIsXHJcblx0XHQgICAgZHBoaSA9IDAuMSxcclxuXHRcdCAgICBjb247XHJcblxyXG5cdFx0d2hpbGUgKChNYXRoLmFicyhkcGhpKSA+IHRvbCkgJiYgKC0taSA+IDApKSB7XHJcblx0XHRcdGNvbiA9IGVjY2VudCAqIE1hdGguc2luKHBoaSk7XHJcblx0XHRcdGRwaGkgPSAoTWF0aC5QSSAvIDIpIC0gMiAqIE1hdGguYXRhbih0cyAqXHJcblx0XHRcdCAgICAgICAgICAgIE1hdGgucG93KCgxLjAgLSBjb24pIC8gKDEuMCArIGNvbiksIDAuNSAqIGVjY2VudCkpIC0gcGhpO1xyXG5cdFx0XHRwaGkgKz0gZHBoaTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuTGF0TG5nKHBoaSAqIGQsIGxuZyk7XHJcblx0fVxyXG59O1xyXG5cblxuXHJcbkwuQ1JTLkVQU0czMzk1ID0gTC5leHRlbmQoe30sIEwuQ1JTLCB7XHJcblx0Y29kZTogJ0VQU0c6MzM5NScsXHJcblxyXG5cdHByb2plY3Rpb246IEwuUHJvamVjdGlvbi5NZXJjYXRvcixcclxuXHJcblx0dHJhbnNmb3JtYXRpb246IChmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgbSA9IEwuUHJvamVjdGlvbi5NZXJjYXRvcixcclxuXHRcdCAgICByID0gbS5SX01BSk9SLFxyXG5cdFx0ICAgIHNjYWxlID0gMC41IC8gKE1hdGguUEkgKiByKTtcclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuVHJhbnNmb3JtYXRpb24oc2NhbGUsIDAuNSwgLXNjYWxlLCAwLjUpO1xyXG5cdH0oKSlcclxufSk7XHJcblxuXG4vKlxyXG4gKiBMLlRpbGVMYXllciBpcyB1c2VkIGZvciBzdGFuZGFyZCB4eXotbnVtYmVyZWQgdGlsZSBsYXllcnMuXHJcbiAqL1xyXG5cclxuTC5UaWxlTGF5ZXIgPSBMLkNsYXNzLmV4dGVuZCh7XHJcblx0aW5jbHVkZXM6IEwuTWl4aW4uRXZlbnRzLFxyXG5cclxuXHRvcHRpb25zOiB7XHJcblx0XHRtaW5ab29tOiAwLFxyXG5cdFx0bWF4Wm9vbTogMTgsXHJcblx0XHR0aWxlU2l6ZTogMjU2LFxyXG5cdFx0c3ViZG9tYWluczogJ2FiYycsXHJcblx0XHRlcnJvclRpbGVVcmw6ICcnLFxyXG5cdFx0YXR0cmlidXRpb246ICcnLFxyXG5cdFx0em9vbU9mZnNldDogMCxcclxuXHRcdG9wYWNpdHk6IDEsXHJcblx0XHQvKlxyXG5cdFx0bWF4TmF0aXZlWm9vbTogbnVsbCxcclxuXHRcdHpJbmRleDogbnVsbCxcclxuXHRcdHRtczogZmFsc2UsXHJcblx0XHRjb250aW51b3VzV29ybGQ6IGZhbHNlLFxyXG5cdFx0bm9XcmFwOiBmYWxzZSxcclxuXHRcdHpvb21SZXZlcnNlOiBmYWxzZSxcclxuXHRcdGRldGVjdFJldGluYTogZmFsc2UsXHJcblx0XHRyZXVzZVRpbGVzOiBmYWxzZSxcclxuXHRcdGJvdW5kczogZmFsc2UsXHJcblx0XHQqL1xyXG5cdFx0dW5sb2FkSW52aXNpYmxlVGlsZXM6IEwuQnJvd3Nlci5tb2JpbGUsXHJcblx0XHR1cGRhdGVXaGVuSWRsZTogTC5Ccm93c2VyLm1vYmlsZVxyXG5cdH0sXHJcblxyXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMpIHtcclxuXHRcdG9wdGlvbnMgPSBMLnNldE9wdGlvbnModGhpcywgb3B0aW9ucyk7XHJcblxyXG5cdFx0Ly8gZGV0ZWN0aW5nIHJldGluYSBkaXNwbGF5cywgYWRqdXN0aW5nIHRpbGVTaXplIGFuZCB6b29tIGxldmVsc1xyXG5cdFx0aWYgKG9wdGlvbnMuZGV0ZWN0UmV0aW5hICYmIEwuQnJvd3Nlci5yZXRpbmEgJiYgb3B0aW9ucy5tYXhab29tID4gMCkge1xyXG5cclxuXHRcdFx0b3B0aW9ucy50aWxlU2l6ZSA9IE1hdGguZmxvb3Iob3B0aW9ucy50aWxlU2l6ZSAvIDIpO1xyXG5cdFx0XHRvcHRpb25zLnpvb21PZmZzZXQrKztcclxuXHJcblx0XHRcdGlmIChvcHRpb25zLm1pblpvb20gPiAwKSB7XHJcblx0XHRcdFx0b3B0aW9ucy5taW5ab29tLS07XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5vcHRpb25zLm1heFpvb20tLTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAob3B0aW9ucy5ib3VuZHMpIHtcclxuXHRcdFx0b3B0aW9ucy5ib3VuZHMgPSBMLmxhdExuZ0JvdW5kcyhvcHRpb25zLmJvdW5kcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fdXJsID0gdXJsO1xyXG5cclxuXHRcdHZhciBzdWJkb21haW5zID0gdGhpcy5vcHRpb25zLnN1YmRvbWFpbnM7XHJcblxyXG5cdFx0aWYgKHR5cGVvZiBzdWJkb21haW5zID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHR0aGlzLm9wdGlvbnMuc3ViZG9tYWlucyA9IHN1YmRvbWFpbnMuc3BsaXQoJycpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdG9uQWRkOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHR0aGlzLl9tYXAgPSBtYXA7XHJcblx0XHR0aGlzLl9hbmltYXRlZCA9IG1hcC5fem9vbUFuaW1hdGVkO1xyXG5cclxuXHRcdC8vIGNyZWF0ZSBhIGNvbnRhaW5lciBkaXYgZm9yIHRpbGVzXHJcblx0XHR0aGlzLl9pbml0Q29udGFpbmVyKCk7XHJcblxyXG5cdFx0Ly8gc2V0IHVwIGV2ZW50c1xyXG5cdFx0bWFwLm9uKHtcclxuXHRcdFx0J3ZpZXdyZXNldCc6IHRoaXMuX3Jlc2V0LFxyXG5cdFx0XHQnbW92ZWVuZCc6IHRoaXMuX3VwZGF0ZVxyXG5cdFx0fSwgdGhpcyk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2FuaW1hdGVkKSB7XHJcblx0XHRcdG1hcC5vbih7XHJcblx0XHRcdFx0J3pvb21hbmltJzogdGhpcy5fYW5pbWF0ZVpvb20sXHJcblx0XHRcdFx0J3pvb21lbmQnOiB0aGlzLl9lbmRab29tQW5pbVxyXG5cdFx0XHR9LCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIXRoaXMub3B0aW9ucy51cGRhdGVXaGVuSWRsZSkge1xyXG5cdFx0XHR0aGlzLl9saW1pdGVkVXBkYXRlID0gTC5VdGlsLmxpbWl0RXhlY0J5SW50ZXJ2YWwodGhpcy5fdXBkYXRlLCAxNTAsIHRoaXMpO1xyXG5cdFx0XHRtYXAub24oJ21vdmUnLCB0aGlzLl9saW1pdGVkVXBkYXRlLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9yZXNldCgpO1xyXG5cdFx0dGhpcy5fdXBkYXRlKCk7XHJcblx0fSxcclxuXHJcblx0YWRkVG86IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcC5hZGRMYXllcih0aGlzKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdG9uUmVtb3ZlOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHR0aGlzLl9jb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLl9jb250YWluZXIpO1xyXG5cclxuXHRcdG1hcC5vZmYoe1xyXG5cdFx0XHQndmlld3Jlc2V0JzogdGhpcy5fcmVzZXQsXHJcblx0XHRcdCdtb3ZlZW5kJzogdGhpcy5fdXBkYXRlXHJcblx0XHR9LCB0aGlzKTtcclxuXHJcblx0XHRpZiAodGhpcy5fYW5pbWF0ZWQpIHtcclxuXHRcdFx0bWFwLm9mZih7XHJcblx0XHRcdFx0J3pvb21hbmltJzogdGhpcy5fYW5pbWF0ZVpvb20sXHJcblx0XHRcdFx0J3pvb21lbmQnOiB0aGlzLl9lbmRab29tQW5pbVxyXG5cdFx0XHR9LCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIXRoaXMub3B0aW9ucy51cGRhdGVXaGVuSWRsZSkge1xyXG5cdFx0XHRtYXAub2ZmKCdtb3ZlJywgdGhpcy5fbGltaXRlZFVwZGF0ZSwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fY29udGFpbmVyID0gbnVsbDtcclxuXHRcdHRoaXMuX21hcCA9IG51bGw7XHJcblx0fSxcclxuXHJcblx0YnJpbmdUb0Zyb250OiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcGFuZSA9IHRoaXMuX21hcC5fcGFuZXMudGlsZVBhbmU7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2NvbnRhaW5lcikge1xyXG5cdFx0XHRwYW5lLmFwcGVuZENoaWxkKHRoaXMuX2NvbnRhaW5lcik7XHJcblx0XHRcdHRoaXMuX3NldEF1dG9aSW5kZXgocGFuZSwgTWF0aC5tYXgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGJyaW5nVG9CYWNrOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcGFuZSA9IHRoaXMuX21hcC5fcGFuZXMudGlsZVBhbmU7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2NvbnRhaW5lcikge1xyXG5cdFx0XHRwYW5lLmluc2VydEJlZm9yZSh0aGlzLl9jb250YWluZXIsIHBhbmUuZmlyc3RDaGlsZCk7XHJcblx0XHRcdHRoaXMuX3NldEF1dG9aSW5kZXgocGFuZSwgTWF0aC5taW4pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGdldEF0dHJpYnV0aW9uOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25zLmF0dHJpYnV0aW9uO1xyXG5cdH0sXHJcblxyXG5cdGdldENvbnRhaW5lcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2NvbnRhaW5lcjtcclxuXHR9LFxyXG5cclxuXHRzZXRPcGFjaXR5OiBmdW5jdGlvbiAob3BhY2l0eSkge1xyXG5cdFx0dGhpcy5vcHRpb25zLm9wYWNpdHkgPSBvcGFjaXR5O1xyXG5cclxuXHRcdGlmICh0aGlzLl9tYXApIHtcclxuXHRcdFx0dGhpcy5fdXBkYXRlT3BhY2l0eSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHNldFpJbmRleDogZnVuY3Rpb24gKHpJbmRleCkge1xyXG5cdFx0dGhpcy5vcHRpb25zLnpJbmRleCA9IHpJbmRleDtcclxuXHRcdHRoaXMuX3VwZGF0ZVpJbmRleCgpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHNldFVybDogZnVuY3Rpb24gKHVybCwgbm9SZWRyYXcpIHtcclxuXHRcdHRoaXMuX3VybCA9IHVybDtcclxuXHJcblx0XHRpZiAoIW5vUmVkcmF3KSB7XHJcblx0XHRcdHRoaXMucmVkcmF3KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0cmVkcmF3OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAodGhpcy5fbWFwKSB7XHJcblx0XHRcdHRoaXMuX3Jlc2V0KHtoYXJkOiB0cnVlfSk7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZSgpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X3VwZGF0ZVpJbmRleDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX2NvbnRhaW5lciAmJiB0aGlzLm9wdGlvbnMuekluZGV4ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0dGhpcy5fY29udGFpbmVyLnN0eWxlLnpJbmRleCA9IHRoaXMub3B0aW9ucy56SW5kZXg7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X3NldEF1dG9aSW5kZXg6IGZ1bmN0aW9uIChwYW5lLCBjb21wYXJlKSB7XHJcblxyXG5cdFx0dmFyIGxheWVycyA9IHBhbmUuY2hpbGRyZW4sXHJcblx0XHQgICAgZWRnZVpJbmRleCA9IC1jb21wYXJlKEluZmluaXR5LCAtSW5maW5pdHkpLCAvLyAtSW5maW5pdHkgZm9yIG1heCwgSW5maW5pdHkgZm9yIG1pblxyXG5cdFx0ICAgIHpJbmRleCwgaSwgbGVuO1xyXG5cclxuXHRcdGZvciAoaSA9IDAsIGxlbiA9IGxheWVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cclxuXHRcdFx0aWYgKGxheWVyc1tpXSAhPT0gdGhpcy5fY29udGFpbmVyKSB7XHJcblx0XHRcdFx0ekluZGV4ID0gcGFyc2VJbnQobGF5ZXJzW2ldLnN0eWxlLnpJbmRleCwgMTApO1xyXG5cclxuXHRcdFx0XHRpZiAoIWlzTmFOKHpJbmRleCkpIHtcclxuXHRcdFx0XHRcdGVkZ2VaSW5kZXggPSBjb21wYXJlKGVkZ2VaSW5kZXgsIHpJbmRleCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5vcHRpb25zLnpJbmRleCA9IHRoaXMuX2NvbnRhaW5lci5zdHlsZS56SW5kZXggPVxyXG5cdFx0ICAgICAgICAoaXNGaW5pdGUoZWRnZVpJbmRleCkgPyBlZGdlWkluZGV4IDogMCkgKyBjb21wYXJlKDEsIC0xKTtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlT3BhY2l0eTogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGksXHJcblx0XHQgICAgdGlsZXMgPSB0aGlzLl90aWxlcztcclxuXHJcblx0XHRpZiAoTC5Ccm93c2VyLmllbHQ5KSB7XHJcblx0XHRcdGZvciAoaSBpbiB0aWxlcykge1xyXG5cdFx0XHRcdEwuRG9tVXRpbC5zZXRPcGFjaXR5KHRpbGVzW2ldLCB0aGlzLm9wdGlvbnMub3BhY2l0eSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdEwuRG9tVXRpbC5zZXRPcGFjaXR5KHRoaXMuX2NvbnRhaW5lciwgdGhpcy5vcHRpb25zLm9wYWNpdHkpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9pbml0Q29udGFpbmVyOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgdGlsZVBhbmUgPSB0aGlzLl9tYXAuX3BhbmVzLnRpbGVQYW5lO1xyXG5cclxuXHRcdGlmICghdGhpcy5fY29udGFpbmVyKSB7XHJcblx0XHRcdHRoaXMuX2NvbnRhaW5lciA9IEwuRG9tVXRpbC5jcmVhdGUoJ2RpdicsICdsZWFmbGV0LWxheWVyJyk7XHJcblxyXG5cdFx0XHR0aGlzLl91cGRhdGVaSW5kZXgoKTtcclxuXHJcblx0XHRcdGlmICh0aGlzLl9hbmltYXRlZCkge1xyXG5cdFx0XHRcdHZhciBjbGFzc05hbWUgPSAnbGVhZmxldC10aWxlLWNvbnRhaW5lcic7XHJcblxyXG5cdFx0XHRcdHRoaXMuX2JnQnVmZmVyID0gTC5Eb21VdGlsLmNyZWF0ZSgnZGl2JywgY2xhc3NOYW1lLCB0aGlzLl9jb250YWluZXIpO1xyXG5cdFx0XHRcdHRoaXMuX3RpbGVDb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBjbGFzc05hbWUsIHRoaXMuX2NvbnRhaW5lcik7XHJcblxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuX3RpbGVDb250YWluZXIgPSB0aGlzLl9jb250YWluZXI7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRpbGVQYW5lLmFwcGVuZENoaWxkKHRoaXMuX2NvbnRhaW5lcik7XHJcblxyXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLm9wYWNpdHkgPCAxKSB7XHJcblx0XHRcdFx0dGhpcy5fdXBkYXRlT3BhY2l0eSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X3Jlc2V0OiBmdW5jdGlvbiAoZSkge1xyXG5cdFx0Zm9yICh2YXIga2V5IGluIHRoaXMuX3RpbGVzKSB7XHJcblx0XHRcdHRoaXMuZmlyZSgndGlsZXVubG9hZCcsIHt0aWxlOiB0aGlzLl90aWxlc1trZXldfSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fdGlsZXMgPSB7fTtcclxuXHRcdHRoaXMuX3RpbGVzVG9Mb2FkID0gMDtcclxuXHJcblx0XHRpZiAodGhpcy5vcHRpb25zLnJldXNlVGlsZXMpIHtcclxuXHRcdFx0dGhpcy5fdW51c2VkVGlsZXMgPSBbXTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl90aWxlQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG5cclxuXHRcdGlmICh0aGlzLl9hbmltYXRlZCAmJiBlICYmIGUuaGFyZCkge1xyXG5cdFx0XHR0aGlzLl9jbGVhckJnQnVmZmVyKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5faW5pdENvbnRhaW5lcigpO1xyXG5cdH0sXHJcblxyXG5cdF9nZXRUaWxlU2l6ZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIG1hcCA9IHRoaXMuX21hcCxcclxuXHRcdCAgICB6b29tID0gbWFwLmdldFpvb20oKSArIHRoaXMub3B0aW9ucy56b29tT2Zmc2V0LFxyXG5cdFx0ICAgIHpvb21OID0gdGhpcy5vcHRpb25zLm1heE5hdGl2ZVpvb20sXHJcblx0XHQgICAgdGlsZVNpemUgPSB0aGlzLm9wdGlvbnMudGlsZVNpemU7XHJcblxyXG5cdFx0aWYgKHpvb21OICYmIHpvb20gPiB6b29tTikge1xyXG5cdFx0XHR0aWxlU2l6ZSA9IE1hdGgucm91bmQobWFwLmdldFpvb21TY2FsZSh6b29tKSAvIG1hcC5nZXRab29tU2NhbGUoem9vbU4pICogdGlsZVNpemUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aWxlU2l6ZTtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0aWYgKCF0aGlzLl9tYXApIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0dmFyIG1hcCA9IHRoaXMuX21hcCxcclxuXHRcdCAgICBib3VuZHMgPSBtYXAuZ2V0UGl4ZWxCb3VuZHMoKSxcclxuXHRcdCAgICB6b29tID0gbWFwLmdldFpvb20oKSxcclxuXHRcdCAgICB0aWxlU2l6ZSA9IHRoaXMuX2dldFRpbGVTaXplKCk7XHJcblxyXG5cdFx0aWYgKHpvb20gPiB0aGlzLm9wdGlvbnMubWF4Wm9vbSB8fCB6b29tIDwgdGhpcy5vcHRpb25zLm1pblpvb20pIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciB0aWxlQm91bmRzID0gTC5ib3VuZHMoXHJcblx0XHQgICAgICAgIGJvdW5kcy5taW4uZGl2aWRlQnkodGlsZVNpemUpLl9mbG9vcigpLFxyXG5cdFx0ICAgICAgICBib3VuZHMubWF4LmRpdmlkZUJ5KHRpbGVTaXplKS5fZmxvb3IoKSk7XHJcblxyXG5cdFx0dGhpcy5fYWRkVGlsZXNGcm9tQ2VudGVyT3V0KHRpbGVCb3VuZHMpO1xyXG5cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMudW5sb2FkSW52aXNpYmxlVGlsZXMgfHwgdGhpcy5vcHRpb25zLnJldXNlVGlsZXMpIHtcclxuXHRcdFx0dGhpcy5fcmVtb3ZlT3RoZXJUaWxlcyh0aWxlQm91bmRzKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfYWRkVGlsZXNGcm9tQ2VudGVyT3V0OiBmdW5jdGlvbiAoYm91bmRzKSB7XHJcblx0XHR2YXIgcXVldWUgPSBbXSxcclxuXHRcdCAgICBjZW50ZXIgPSBib3VuZHMuZ2V0Q2VudGVyKCk7XHJcblxyXG5cdFx0dmFyIGosIGksIHBvaW50O1xyXG5cclxuXHRcdGZvciAoaiA9IGJvdW5kcy5taW4ueTsgaiA8PSBib3VuZHMubWF4Lnk7IGorKykge1xyXG5cdFx0XHRmb3IgKGkgPSBib3VuZHMubWluLng7IGkgPD0gYm91bmRzLm1heC54OyBpKyspIHtcclxuXHRcdFx0XHRwb2ludCA9IG5ldyBMLlBvaW50KGksIGopO1xyXG5cclxuXHRcdFx0XHRpZiAodGhpcy5fdGlsZVNob3VsZEJlTG9hZGVkKHBvaW50KSkge1xyXG5cdFx0XHRcdFx0cXVldWUucHVzaChwb2ludCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIHRpbGVzVG9Mb2FkID0gcXVldWUubGVuZ3RoO1xyXG5cclxuXHRcdGlmICh0aWxlc1RvTG9hZCA9PT0gMCkgeyByZXR1cm47IH1cclxuXHJcblx0XHQvLyBsb2FkIHRpbGVzIGluIG9yZGVyIG9mIHRoZWlyIGRpc3RhbmNlIHRvIGNlbnRlclxyXG5cdFx0cXVldWUuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG5cdFx0XHRyZXR1cm4gYS5kaXN0YW5jZVRvKGNlbnRlcikgLSBiLmRpc3RhbmNlVG8oY2VudGVyKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuXHJcblx0XHQvLyBpZiBpdHMgdGhlIGZpcnN0IGJhdGNoIG9mIHRpbGVzIHRvIGxvYWRcclxuXHRcdGlmICghdGhpcy5fdGlsZXNUb0xvYWQpIHtcclxuXHRcdFx0dGhpcy5maXJlKCdsb2FkaW5nJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fdGlsZXNUb0xvYWQgKz0gdGlsZXNUb0xvYWQ7XHJcblxyXG5cdFx0Zm9yIChpID0gMDsgaSA8IHRpbGVzVG9Mb2FkOyBpKyspIHtcclxuXHRcdFx0dGhpcy5fYWRkVGlsZShxdWV1ZVtpXSwgZnJhZ21lbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3RpbGVDb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xyXG5cdH0sXHJcblxyXG5cdF90aWxlU2hvdWxkQmVMb2FkZWQ6IGZ1bmN0aW9uICh0aWxlUG9pbnQpIHtcclxuXHRcdGlmICgodGlsZVBvaW50LnggKyAnOicgKyB0aWxlUG9pbnQueSkgaW4gdGhpcy5fdGlsZXMpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlOyAvLyBhbHJlYWR5IGxvYWRlZFxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xyXG5cclxuXHRcdGlmICghb3B0aW9ucy5jb250aW51b3VzV29ybGQpIHtcclxuXHRcdFx0dmFyIGxpbWl0ID0gdGhpcy5fZ2V0V3JhcFRpbGVOdW0oKTtcclxuXHJcblx0XHRcdC8vIGRvbid0IGxvYWQgaWYgZXhjZWVkcyB3b3JsZCBib3VuZHNcclxuXHRcdFx0aWYgKChvcHRpb25zLm5vV3JhcCAmJiAodGlsZVBvaW50LnggPCAwIHx8IHRpbGVQb2ludC54ID49IGxpbWl0LngpKSB8fFxyXG5cdFx0XHRcdHRpbGVQb2ludC55IDwgMCB8fCB0aWxlUG9pbnQueSA+PSBsaW1pdC55KSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvcHRpb25zLmJvdW5kcykge1xyXG5cdFx0XHR2YXIgdGlsZVNpemUgPSB0aGlzLl9nZXRUaWxlU2l6ZSgpLFxyXG5cdFx0XHQgICAgbndQb2ludCA9IHRpbGVQb2ludC5tdWx0aXBseUJ5KHRpbGVTaXplKSxcclxuXHRcdFx0ICAgIHNlUG9pbnQgPSBud1BvaW50LmFkZChbdGlsZVNpemUsIHRpbGVTaXplXSksXHJcblx0XHRcdCAgICBudyA9IHRoaXMuX21hcC51bnByb2plY3QobndQb2ludCksXHJcblx0XHRcdCAgICBzZSA9IHRoaXMuX21hcC51bnByb2plY3Qoc2VQb2ludCk7XHJcblxyXG5cdFx0XHQvLyBUT0RPIHRlbXBvcmFyeSBoYWNrLCB3aWxsIGJlIHJlbW92ZWQgYWZ0ZXIgcmVmYWN0b3JpbmcgcHJvamVjdGlvbnNcclxuXHRcdFx0Ly8gaHR0cHM6Ly9naXRodWIuY29tL0xlYWZsZXQvTGVhZmxldC9pc3N1ZXMvMTYxOFxyXG5cdFx0XHRpZiAoIW9wdGlvbnMuY29udGludW91c1dvcmxkICYmICFvcHRpb25zLm5vV3JhcCkge1xyXG5cdFx0XHRcdG53ID0gbncud3JhcCgpO1xyXG5cdFx0XHRcdHNlID0gc2Uud3JhcCgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIW9wdGlvbnMuYm91bmRzLmludGVyc2VjdHMoW253LCBzZV0pKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH0sXHJcblxyXG5cdF9yZW1vdmVPdGhlclRpbGVzOiBmdW5jdGlvbiAoYm91bmRzKSB7XHJcblx0XHR2YXIga0FyciwgeCwgeSwga2V5O1xyXG5cclxuXHRcdGZvciAoa2V5IGluIHRoaXMuX3RpbGVzKSB7XHJcblx0XHRcdGtBcnIgPSBrZXkuc3BsaXQoJzonKTtcclxuXHRcdFx0eCA9IHBhcnNlSW50KGtBcnJbMF0sIDEwKTtcclxuXHRcdFx0eSA9IHBhcnNlSW50KGtBcnJbMV0sIDEwKTtcclxuXHJcblx0XHRcdC8vIHJlbW92ZSB0aWxlIGlmIGl0J3Mgb3V0IG9mIGJvdW5kc1xyXG5cdFx0XHRpZiAoeCA8IGJvdW5kcy5taW4ueCB8fCB4ID4gYm91bmRzLm1heC54IHx8IHkgPCBib3VuZHMubWluLnkgfHwgeSA+IGJvdW5kcy5tYXgueSkge1xyXG5cdFx0XHRcdHRoaXMuX3JlbW92ZVRpbGUoa2V5KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9yZW1vdmVUaWxlOiBmdW5jdGlvbiAoa2V5KSB7XHJcblx0XHR2YXIgdGlsZSA9IHRoaXMuX3RpbGVzW2tleV07XHJcblxyXG5cdFx0dGhpcy5maXJlKCd0aWxldW5sb2FkJywge3RpbGU6IHRpbGUsIHVybDogdGlsZS5zcmN9KTtcclxuXHJcblx0XHRpZiAodGhpcy5vcHRpb25zLnJldXNlVGlsZXMpIHtcclxuXHRcdFx0TC5Eb21VdGlsLnJlbW92ZUNsYXNzKHRpbGUsICdsZWFmbGV0LXRpbGUtbG9hZGVkJyk7XHJcblx0XHRcdHRoaXMuX3VudXNlZFRpbGVzLnB1c2godGlsZSk7XHJcblxyXG5cdFx0fSBlbHNlIGlmICh0aWxlLnBhcmVudE5vZGUgPT09IHRoaXMuX3RpbGVDb250YWluZXIpIHtcclxuXHRcdFx0dGhpcy5fdGlsZUNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aWxlKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBmb3IgaHR0cHM6Ly9naXRodWIuY29tL0Nsb3VkTWFkZS9MZWFmbGV0L2lzc3Vlcy8xMzdcclxuXHRcdGlmICghTC5Ccm93c2VyLmFuZHJvaWQpIHtcclxuXHRcdFx0dGlsZS5vbmxvYWQgPSBudWxsO1xyXG5cdFx0XHR0aWxlLnNyYyA9IEwuVXRpbC5lbXB0eUltYWdlVXJsO1xyXG5cdFx0fVxyXG5cclxuXHRcdGRlbGV0ZSB0aGlzLl90aWxlc1trZXldO1xyXG5cdH0sXHJcblxyXG5cdF9hZGRUaWxlOiBmdW5jdGlvbiAodGlsZVBvaW50LCBjb250YWluZXIpIHtcclxuXHRcdHZhciB0aWxlUG9zID0gdGhpcy5fZ2V0VGlsZVBvcyh0aWxlUG9pbnQpO1xyXG5cclxuXHRcdC8vIGdldCB1bnVzZWQgdGlsZSAtIG9yIGNyZWF0ZSBhIG5ldyB0aWxlXHJcblx0XHR2YXIgdGlsZSA9IHRoaXMuX2dldFRpbGUoKTtcclxuXHJcblx0XHQvKlxyXG5cdFx0Q2hyb21lIDIwIGxheW91dHMgbXVjaCBmYXN0ZXIgd2l0aCB0b3AvbGVmdCAodmVyaWZ5IHdpdGggdGltZWxpbmUsIGZyYW1lcylcclxuXHRcdEFuZHJvaWQgNCBicm93c2VyIGhhcyBkaXNwbGF5IGlzc3VlcyB3aXRoIHRvcC9sZWZ0IGFuZCByZXF1aXJlcyB0cmFuc2Zvcm0gaW5zdGVhZFxyXG5cdFx0KG90aGVyIGJyb3dzZXJzIGRvbid0IGN1cnJlbnRseSBjYXJlKSAtIHNlZSBkZWJ1Zy9oYWNrcy9qaXR0ZXIuaHRtbCBmb3IgYW4gZXhhbXBsZVxyXG5cdFx0Ki9cclxuXHRcdEwuRG9tVXRpbC5zZXRQb3NpdGlvbih0aWxlLCB0aWxlUG9zLCBMLkJyb3dzZXIuY2hyb21lKTtcclxuXHJcblx0XHR0aGlzLl90aWxlc1t0aWxlUG9pbnQueCArICc6JyArIHRpbGVQb2ludC55XSA9IHRpbGU7XHJcblxyXG5cdFx0dGhpcy5fbG9hZFRpbGUodGlsZSwgdGlsZVBvaW50KTtcclxuXHJcblx0XHRpZiAodGlsZS5wYXJlbnROb2RlICE9PSB0aGlzLl90aWxlQ29udGFpbmVyKSB7XHJcblx0XHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aWxlKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfZ2V0Wm9vbUZvclVybDogZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxyXG5cdFx0ICAgIHpvb20gPSB0aGlzLl9tYXAuZ2V0Wm9vbSgpO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLnpvb21SZXZlcnNlKSB7XHJcblx0XHRcdHpvb20gPSBvcHRpb25zLm1heFpvb20gLSB6b29tO1xyXG5cdFx0fVxyXG5cclxuXHRcdHpvb20gKz0gb3B0aW9ucy56b29tT2Zmc2V0O1xyXG5cclxuXHRcdHJldHVybiBvcHRpb25zLm1heE5hdGl2ZVpvb20gPyBNYXRoLm1pbih6b29tLCBvcHRpb25zLm1heE5hdGl2ZVpvb20pIDogem9vbTtcclxuXHR9LFxyXG5cclxuXHRfZ2V0VGlsZVBvczogZnVuY3Rpb24gKHRpbGVQb2ludCkge1xyXG5cdFx0dmFyIG9yaWdpbiA9IHRoaXMuX21hcC5nZXRQaXhlbE9yaWdpbigpLFxyXG5cdFx0ICAgIHRpbGVTaXplID0gdGhpcy5fZ2V0VGlsZVNpemUoKTtcclxuXHJcblx0XHRyZXR1cm4gdGlsZVBvaW50Lm11bHRpcGx5QnkodGlsZVNpemUpLnN1YnRyYWN0KG9yaWdpbik7XHJcblx0fSxcclxuXHJcblx0Ly8gaW1hZ2Utc3BlY2lmaWMgY29kZSAob3ZlcnJpZGUgdG8gaW1wbGVtZW50IGUuZy4gQ2FudmFzIG9yIFNWRyB0aWxlIGxheWVyKVxyXG5cclxuXHRnZXRUaWxlVXJsOiBmdW5jdGlvbiAodGlsZVBvaW50KSB7XHJcblx0XHRyZXR1cm4gTC5VdGlsLnRlbXBsYXRlKHRoaXMuX3VybCwgTC5leHRlbmQoe1xyXG5cdFx0XHRzOiB0aGlzLl9nZXRTdWJkb21haW4odGlsZVBvaW50KSxcclxuXHRcdFx0ejogdGlsZVBvaW50LnosXHJcblx0XHRcdHg6IHRpbGVQb2ludC54LFxyXG5cdFx0XHR5OiB0aWxlUG9pbnQueVxyXG5cdFx0fSwgdGhpcy5vcHRpb25zKSk7XHJcblx0fSxcclxuXHJcblx0X2dldFdyYXBUaWxlTnVtOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgY3JzID0gdGhpcy5fbWFwLm9wdGlvbnMuY3JzLFxyXG5cdFx0ICAgIHNpemUgPSBjcnMuZ2V0U2l6ZSh0aGlzLl9tYXAuZ2V0Wm9vbSgpKTtcclxuXHRcdHJldHVybiBzaXplLmRpdmlkZUJ5KHRoaXMuX2dldFRpbGVTaXplKCkpLl9mbG9vcigpO1xyXG5cdH0sXHJcblxyXG5cdF9hZGp1c3RUaWxlUG9pbnQ6IGZ1bmN0aW9uICh0aWxlUG9pbnQpIHtcclxuXHJcblx0XHR2YXIgbGltaXQgPSB0aGlzLl9nZXRXcmFwVGlsZU51bSgpO1xyXG5cclxuXHRcdC8vIHdyYXAgdGlsZSBjb29yZGluYXRlc1xyXG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMuY29udGludW91c1dvcmxkICYmICF0aGlzLm9wdGlvbnMubm9XcmFwKSB7XHJcblx0XHRcdHRpbGVQb2ludC54ID0gKCh0aWxlUG9pbnQueCAlIGxpbWl0LngpICsgbGltaXQueCkgJSBsaW1pdC54O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMudG1zKSB7XHJcblx0XHRcdHRpbGVQb2ludC55ID0gbGltaXQueSAtIHRpbGVQb2ludC55IC0gMTtcclxuXHRcdH1cclxuXHJcblx0XHR0aWxlUG9pbnQueiA9IHRoaXMuX2dldFpvb21Gb3JVcmwoKTtcclxuXHR9LFxyXG5cclxuXHRfZ2V0U3ViZG9tYWluOiBmdW5jdGlvbiAodGlsZVBvaW50KSB7XHJcblx0XHR2YXIgaW5kZXggPSBNYXRoLmFicyh0aWxlUG9pbnQueCArIHRpbGVQb2ludC55KSAlIHRoaXMub3B0aW9ucy5zdWJkb21haW5zLmxlbmd0aDtcclxuXHRcdHJldHVybiB0aGlzLm9wdGlvbnMuc3ViZG9tYWluc1tpbmRleF07XHJcblx0fSxcclxuXHJcblx0X2dldFRpbGU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLm9wdGlvbnMucmV1c2VUaWxlcyAmJiB0aGlzLl91bnVzZWRUaWxlcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdHZhciB0aWxlID0gdGhpcy5fdW51c2VkVGlsZXMucG9wKCk7XHJcblx0XHRcdHRoaXMuX3Jlc2V0VGlsZSh0aWxlKTtcclxuXHRcdFx0cmV0dXJuIHRpbGU7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcy5fY3JlYXRlVGlsZSgpO1xyXG5cdH0sXHJcblxyXG5cdC8vIE92ZXJyaWRlIGlmIGRhdGEgc3RvcmVkIG9uIGEgdGlsZSBuZWVkcyB0byBiZSBjbGVhbmVkIHVwIGJlZm9yZSByZXVzZVxyXG5cdF9yZXNldFRpbGU6IGZ1bmN0aW9uICgvKnRpbGUqLykge30sXHJcblxyXG5cdF9jcmVhdGVUaWxlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgdGlsZSA9IEwuRG9tVXRpbC5jcmVhdGUoJ2ltZycsICdsZWFmbGV0LXRpbGUnKTtcclxuXHRcdHRpbGUuc3R5bGUud2lkdGggPSB0aWxlLnN0eWxlLmhlaWdodCA9IHRoaXMuX2dldFRpbGVTaXplKCkgKyAncHgnO1xyXG5cdFx0dGlsZS5nYWxsZXJ5aW1nID0gJ25vJztcclxuXHJcblx0XHR0aWxlLm9uc2VsZWN0c3RhcnQgPSB0aWxlLm9ubW91c2Vtb3ZlID0gTC5VdGlsLmZhbHNlRm47XHJcblxyXG5cdFx0aWYgKEwuQnJvd3Nlci5pZWx0OSAmJiB0aGlzLm9wdGlvbnMub3BhY2l0eSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdEwuRG9tVXRpbC5zZXRPcGFjaXR5KHRpbGUsIHRoaXMub3B0aW9ucy5vcGFjaXR5KTtcclxuXHRcdH1cclxuXHRcdC8vIHdpdGhvdXQgdGhpcyBoYWNrLCB0aWxlcyBkaXNhcHBlYXIgYWZ0ZXIgem9vbSBvbiBDaHJvbWUgZm9yIEFuZHJvaWRcclxuXHRcdC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9MZWFmbGV0L0xlYWZsZXQvaXNzdWVzLzIwNzhcclxuXHRcdGlmIChMLkJyb3dzZXIubW9iaWxlV2Via2l0M2QpIHtcclxuXHRcdFx0dGlsZS5zdHlsZS5XZWJraXRCYWNrZmFjZVZpc2liaWxpdHkgPSAnaGlkZGVuJztcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aWxlO1xyXG5cdH0sXHJcblxyXG5cdF9sb2FkVGlsZTogZnVuY3Rpb24gKHRpbGUsIHRpbGVQb2ludCkge1xyXG5cdFx0dGlsZS5fbGF5ZXIgID0gdGhpcztcclxuXHRcdHRpbGUub25sb2FkICA9IHRoaXMuX3RpbGVPbkxvYWQ7XHJcblx0XHR0aWxlLm9uZXJyb3IgPSB0aGlzLl90aWxlT25FcnJvcjtcclxuXHJcblx0XHR0aGlzLl9hZGp1c3RUaWxlUG9pbnQodGlsZVBvaW50KTtcclxuXHRcdHRpbGUuc3JjICAgICA9IHRoaXMuZ2V0VGlsZVVybCh0aWxlUG9pbnQpO1xyXG5cclxuXHRcdHRoaXMuZmlyZSgndGlsZWxvYWRzdGFydCcsIHtcclxuXHRcdFx0dGlsZTogdGlsZSxcclxuXHRcdFx0dXJsOiB0aWxlLnNyY1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0X3RpbGVMb2FkZWQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuX3RpbGVzVG9Mb2FkLS07XHJcblxyXG5cdFx0aWYgKHRoaXMuX2FuaW1hdGVkKSB7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl90aWxlQ29udGFpbmVyLCAnbGVhZmxldC16b29tLWFuaW1hdGVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCF0aGlzLl90aWxlc1RvTG9hZCkge1xyXG5cdFx0XHR0aGlzLmZpcmUoJ2xvYWQnKTtcclxuXHJcblx0XHRcdGlmICh0aGlzLl9hbmltYXRlZCkge1xyXG5cdFx0XHRcdC8vIGNsZWFyIHNjYWxlZCB0aWxlcyBhZnRlciBhbGwgbmV3IHRpbGVzIGFyZSBsb2FkZWQgKGZvciBwZXJmb3JtYW5jZSlcclxuXHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy5fY2xlYXJCZ0J1ZmZlclRpbWVyKTtcclxuXHRcdFx0XHR0aGlzLl9jbGVhckJnQnVmZmVyVGltZXIgPSBzZXRUaW1lb3V0KEwuYmluZCh0aGlzLl9jbGVhckJnQnVmZmVyLCB0aGlzKSwgNTAwKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF90aWxlT25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgbGF5ZXIgPSB0aGlzLl9sYXllcjtcclxuXHJcblx0XHQvL09ubHkgaWYgd2UgYXJlIGxvYWRpbmcgYW4gYWN0dWFsIGltYWdlXHJcblx0XHRpZiAodGhpcy5zcmMgIT09IEwuVXRpbC5lbXB0eUltYWdlVXJsKSB7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyh0aGlzLCAnbGVhZmxldC10aWxlLWxvYWRlZCcpO1xyXG5cclxuXHRcdFx0bGF5ZXIuZmlyZSgndGlsZWxvYWQnLCB7XHJcblx0XHRcdFx0dGlsZTogdGhpcyxcclxuXHRcdFx0XHR1cmw6IHRoaXMuc3JjXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxheWVyLl90aWxlTG9hZGVkKCk7XHJcblx0fSxcclxuXHJcblx0X3RpbGVPbkVycm9yOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgbGF5ZXIgPSB0aGlzLl9sYXllcjtcclxuXHJcblx0XHRsYXllci5maXJlKCd0aWxlZXJyb3InLCB7XHJcblx0XHRcdHRpbGU6IHRoaXMsXHJcblx0XHRcdHVybDogdGhpcy5zcmNcclxuXHRcdH0pO1xyXG5cclxuXHRcdHZhciBuZXdVcmwgPSBsYXllci5vcHRpb25zLmVycm9yVGlsZVVybDtcclxuXHRcdGlmIChuZXdVcmwpIHtcclxuXHRcdFx0dGhpcy5zcmMgPSBuZXdVcmw7XHJcblx0XHR9XHJcblxyXG5cdFx0bGF5ZXIuX3RpbGVMb2FkZWQoKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC50aWxlTGF5ZXIgPSBmdW5jdGlvbiAodXJsLCBvcHRpb25zKSB7XHJcblx0cmV0dXJuIG5ldyBMLlRpbGVMYXllcih1cmwsIG9wdGlvbnMpO1xyXG59O1xyXG5cblxuLypcclxuICogTC5UaWxlTGF5ZXIuV01TIGlzIHVzZWQgZm9yIHB1dHRpbmcgV01TIHRpbGUgbGF5ZXJzIG9uIHRoZSBtYXAuXHJcbiAqL1xyXG5cclxuTC5UaWxlTGF5ZXIuV01TID0gTC5UaWxlTGF5ZXIuZXh0ZW5kKHtcclxuXHJcblx0ZGVmYXVsdFdtc1BhcmFtczoge1xyXG5cdFx0c2VydmljZTogJ1dNUycsXHJcblx0XHRyZXF1ZXN0OiAnR2V0TWFwJyxcclxuXHRcdHZlcnNpb246ICcxLjEuMScsXHJcblx0XHRsYXllcnM6ICcnLFxyXG5cdFx0c3R5bGVzOiAnJyxcclxuXHRcdGZvcm1hdDogJ2ltYWdlL2pwZWcnLFxyXG5cdFx0dHJhbnNwYXJlbnQ6IGZhbHNlXHJcblx0fSxcclxuXHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKHVybCwgb3B0aW9ucykgeyAvLyAoU3RyaW5nLCBPYmplY3QpXHJcblxyXG5cdFx0dGhpcy5fdXJsID0gdXJsO1xyXG5cclxuXHRcdHZhciB3bXNQYXJhbXMgPSBMLmV4dGVuZCh7fSwgdGhpcy5kZWZhdWx0V21zUGFyYW1zKSxcclxuXHRcdCAgICB0aWxlU2l6ZSA9IG9wdGlvbnMudGlsZVNpemUgfHwgdGhpcy5vcHRpb25zLnRpbGVTaXplO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLmRldGVjdFJldGluYSAmJiBMLkJyb3dzZXIucmV0aW5hKSB7XHJcblx0XHRcdHdtc1BhcmFtcy53aWR0aCA9IHdtc1BhcmFtcy5oZWlnaHQgPSB0aWxlU2l6ZSAqIDI7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR3bXNQYXJhbXMud2lkdGggPSB3bXNQYXJhbXMuaGVpZ2h0ID0gdGlsZVNpemU7XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9yICh2YXIgaSBpbiBvcHRpb25zKSB7XHJcblx0XHRcdC8vIGFsbCBrZXlzIHRoYXQgYXJlIG5vdCBUaWxlTGF5ZXIgb3B0aW9ucyBnbyB0byBXTVMgcGFyYW1zXHJcblx0XHRcdGlmICghdGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KGkpICYmIGkgIT09ICdjcnMnKSB7XHJcblx0XHRcdFx0d21zUGFyYW1zW2ldID0gb3B0aW9uc1tpXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMud21zUGFyYW1zID0gd21zUGFyYW1zO1xyXG5cclxuXHRcdEwuc2V0T3B0aW9ucyh0aGlzLCBvcHRpb25zKTtcclxuXHR9LFxyXG5cclxuXHRvbkFkZDogZnVuY3Rpb24gKG1hcCkge1xyXG5cclxuXHRcdHRoaXMuX2NycyA9IHRoaXMub3B0aW9ucy5jcnMgfHwgbWFwLm9wdGlvbnMuY3JzO1xyXG5cclxuXHRcdHRoaXMuX3dtc1ZlcnNpb24gPSBwYXJzZUZsb2F0KHRoaXMud21zUGFyYW1zLnZlcnNpb24pO1xyXG5cclxuXHRcdHZhciBwcm9qZWN0aW9uS2V5ID0gdGhpcy5fd21zVmVyc2lvbiA+PSAxLjMgPyAnY3JzJyA6ICdzcnMnO1xyXG5cdFx0dGhpcy53bXNQYXJhbXNbcHJvamVjdGlvbktleV0gPSB0aGlzLl9jcnMuY29kZTtcclxuXHJcblx0XHRMLlRpbGVMYXllci5wcm90b3R5cGUub25BZGQuY2FsbCh0aGlzLCBtYXApO1xyXG5cdH0sXHJcblxyXG5cdGdldFRpbGVVcmw6IGZ1bmN0aW9uICh0aWxlUG9pbnQpIHsgLy8gKFBvaW50LCBOdW1iZXIpIC0+IFN0cmluZ1xyXG5cclxuXHRcdHZhciBtYXAgPSB0aGlzLl9tYXAsXHJcblx0XHQgICAgdGlsZVNpemUgPSB0aGlzLm9wdGlvbnMudGlsZVNpemUsXHJcblxyXG5cdFx0ICAgIG53UG9pbnQgPSB0aWxlUG9pbnQubXVsdGlwbHlCeSh0aWxlU2l6ZSksXHJcblx0XHQgICAgc2VQb2ludCA9IG53UG9pbnQuYWRkKFt0aWxlU2l6ZSwgdGlsZVNpemVdKSxcclxuXHJcblx0XHQgICAgbncgPSB0aGlzLl9jcnMucHJvamVjdChtYXAudW5wcm9qZWN0KG53UG9pbnQsIHRpbGVQb2ludC56KSksXHJcblx0XHQgICAgc2UgPSB0aGlzLl9jcnMucHJvamVjdChtYXAudW5wcm9qZWN0KHNlUG9pbnQsIHRpbGVQb2ludC56KSksXHJcblx0XHQgICAgYmJveCA9IHRoaXMuX3dtc1ZlcnNpb24gPj0gMS4zICYmIHRoaXMuX2NycyA9PT0gTC5DUlMuRVBTRzQzMjYgP1xyXG5cdFx0ICAgICAgICBbc2UueSwgbncueCwgbncueSwgc2UueF0uam9pbignLCcpIDpcclxuXHRcdCAgICAgICAgW253LngsIHNlLnksIHNlLngsIG53LnldLmpvaW4oJywnKSxcclxuXHJcblx0XHQgICAgdXJsID0gTC5VdGlsLnRlbXBsYXRlKHRoaXMuX3VybCwge3M6IHRoaXMuX2dldFN1YmRvbWFpbih0aWxlUG9pbnQpfSk7XHJcblxyXG5cdFx0cmV0dXJuIHVybCArIEwuVXRpbC5nZXRQYXJhbVN0cmluZyh0aGlzLndtc1BhcmFtcywgdXJsLCB0cnVlKSArICcmQkJPWD0nICsgYmJveDtcclxuXHR9LFxyXG5cclxuXHRzZXRQYXJhbXM6IGZ1bmN0aW9uIChwYXJhbXMsIG5vUmVkcmF3KSB7XHJcblxyXG5cdFx0TC5leHRlbmQodGhpcy53bXNQYXJhbXMsIHBhcmFtcyk7XHJcblxyXG5cdFx0aWYgKCFub1JlZHJhdykge1xyXG5cdFx0XHR0aGlzLnJlZHJhdygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxufSk7XHJcblxyXG5MLnRpbGVMYXllci53bXMgPSBmdW5jdGlvbiAodXJsLCBvcHRpb25zKSB7XHJcblx0cmV0dXJuIG5ldyBMLlRpbGVMYXllci5XTVModXJsLCBvcHRpb25zKTtcclxufTtcclxuXG5cbi8qXHJcbiAqIEwuVGlsZUxheWVyLkNhbnZhcyBpcyBhIGNsYXNzIHRoYXQgeW91IGNhbiB1c2UgYXMgYSBiYXNlIGZvciBjcmVhdGluZ1xyXG4gKiBkeW5hbWljYWxseSBkcmF3biBDYW52YXMtYmFzZWQgdGlsZSBsYXllcnMuXHJcbiAqL1xyXG5cclxuTC5UaWxlTGF5ZXIuQ2FudmFzID0gTC5UaWxlTGF5ZXIuZXh0ZW5kKHtcclxuXHRvcHRpb25zOiB7XHJcblx0XHRhc3luYzogZmFsc2VcclxuXHR9LFxyXG5cclxuXHRpbml0aWFsaXplOiBmdW5jdGlvbiAob3B0aW9ucykge1xyXG5cdFx0TC5zZXRPcHRpb25zKHRoaXMsIG9wdGlvbnMpO1xyXG5cdH0sXHJcblxyXG5cdHJlZHJhdzogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX21hcCkge1xyXG5cdFx0XHR0aGlzLl9yZXNldCh7aGFyZDogdHJ1ZX0pO1xyXG5cdFx0XHR0aGlzLl91cGRhdGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKHZhciBpIGluIHRoaXMuX3RpbGVzKSB7XHJcblx0XHRcdHRoaXMuX3JlZHJhd1RpbGUodGhpcy5fdGlsZXNbaV0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X3JlZHJhd1RpbGU6IGZ1bmN0aW9uICh0aWxlKSB7XHJcblx0XHR0aGlzLmRyYXdUaWxlKHRpbGUsIHRpbGUuX3RpbGVQb2ludCwgdGhpcy5fbWFwLl96b29tKTtcclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlVGlsZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHRpbGUgPSBMLkRvbVV0aWwuY3JlYXRlKCdjYW52YXMnLCAnbGVhZmxldC10aWxlJyk7XHJcblx0XHR0aWxlLndpZHRoID0gdGlsZS5oZWlnaHQgPSB0aGlzLm9wdGlvbnMudGlsZVNpemU7XHJcblx0XHR0aWxlLm9uc2VsZWN0c3RhcnQgPSB0aWxlLm9ubW91c2Vtb3ZlID0gTC5VdGlsLmZhbHNlRm47XHJcblx0XHRyZXR1cm4gdGlsZTtcclxuXHR9LFxyXG5cclxuXHRfbG9hZFRpbGU6IGZ1bmN0aW9uICh0aWxlLCB0aWxlUG9pbnQpIHtcclxuXHRcdHRpbGUuX2xheWVyID0gdGhpcztcclxuXHRcdHRpbGUuX3RpbGVQb2ludCA9IHRpbGVQb2ludDtcclxuXHJcblx0XHR0aGlzLl9yZWRyYXdUaWxlKHRpbGUpO1xyXG5cclxuXHRcdGlmICghdGhpcy5vcHRpb25zLmFzeW5jKSB7XHJcblx0XHRcdHRoaXMudGlsZURyYXduKHRpbGUpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGRyYXdUaWxlOiBmdW5jdGlvbiAoLyp0aWxlLCB0aWxlUG9pbnQqLykge1xyXG5cdFx0Ly8gb3ZlcnJpZGUgd2l0aCByZW5kZXJpbmcgY29kZVxyXG5cdH0sXHJcblxyXG5cdHRpbGVEcmF3bjogZnVuY3Rpb24gKHRpbGUpIHtcclxuXHRcdHRoaXMuX3RpbGVPbkxvYWQuY2FsbCh0aWxlKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuXHJcbkwudGlsZUxheWVyLmNhbnZhcyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcblx0cmV0dXJuIG5ldyBMLlRpbGVMYXllci5DYW52YXMob3B0aW9ucyk7XHJcbn07XHJcblxuXG4vKlxyXG4gKiBMLkltYWdlT3ZlcmxheSBpcyB1c2VkIHRvIG92ZXJsYXkgaW1hZ2VzIG92ZXIgdGhlIG1hcCAodG8gc3BlY2lmaWMgZ2VvZ3JhcGhpY2FsIGJvdW5kcykuXHJcbiAqL1xyXG5cclxuTC5JbWFnZU92ZXJsYXkgPSBMLkNsYXNzLmV4dGVuZCh7XHJcblx0aW5jbHVkZXM6IEwuTWl4aW4uRXZlbnRzLFxyXG5cclxuXHRvcHRpb25zOiB7XHJcblx0XHRvcGFjaXR5OiAxXHJcblx0fSxcclxuXHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKHVybCwgYm91bmRzLCBvcHRpb25zKSB7IC8vIChTdHJpbmcsIExhdExuZ0JvdW5kcywgT2JqZWN0KVxyXG5cdFx0dGhpcy5fdXJsID0gdXJsO1xyXG5cdFx0dGhpcy5fYm91bmRzID0gTC5sYXRMbmdCb3VuZHMoYm91bmRzKTtcclxuXHJcblx0XHRMLnNldE9wdGlvbnModGhpcywgb3B0aW9ucyk7XHJcblx0fSxcclxuXHJcblx0b25BZGQ6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdHRoaXMuX21hcCA9IG1hcDtcclxuXHJcblx0XHRpZiAoIXRoaXMuX2ltYWdlKSB7XHJcblx0XHRcdHRoaXMuX2luaXRJbWFnZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdG1hcC5fcGFuZXMub3ZlcmxheVBhbmUuYXBwZW5kQ2hpbGQodGhpcy5faW1hZ2UpO1xyXG5cclxuXHRcdG1hcC5vbigndmlld3Jlc2V0JywgdGhpcy5fcmVzZXQsIHRoaXMpO1xyXG5cclxuXHRcdGlmIChtYXAub3B0aW9ucy56b29tQW5pbWF0aW9uICYmIEwuQnJvd3Nlci5hbnkzZCkge1xyXG5cdFx0XHRtYXAub24oJ3pvb21hbmltJywgdGhpcy5fYW5pbWF0ZVpvb20sIHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3Jlc2V0KCk7XHJcblx0fSxcclxuXHJcblx0b25SZW1vdmU6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcC5nZXRQYW5lcygpLm92ZXJsYXlQYW5lLnJlbW92ZUNoaWxkKHRoaXMuX2ltYWdlKTtcclxuXHJcblx0XHRtYXAub2ZmKCd2aWV3cmVzZXQnLCB0aGlzLl9yZXNldCwgdGhpcyk7XHJcblxyXG5cdFx0aWYgKG1hcC5vcHRpb25zLnpvb21BbmltYXRpb24pIHtcclxuXHRcdFx0bWFwLm9mZignem9vbWFuaW0nLCB0aGlzLl9hbmltYXRlWm9vbSwgdGhpcyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0YWRkVG86IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcC5hZGRMYXllcih0aGlzKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHNldE9wYWNpdHk6IGZ1bmN0aW9uIChvcGFjaXR5KSB7XHJcblx0XHR0aGlzLm9wdGlvbnMub3BhY2l0eSA9IG9wYWNpdHk7XHJcblx0XHR0aGlzLl91cGRhdGVPcGFjaXR5KCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHQvLyBUT0RPIHJlbW92ZSBicmluZ1RvRnJvbnQvYnJpbmdUb0JhY2sgZHVwbGljYXRpb24gZnJvbSBUaWxlTGF5ZXIvUGF0aFxyXG5cdGJyaW5nVG9Gcm9udDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX2ltYWdlKSB7XHJcblx0XHRcdHRoaXMuX21hcC5fcGFuZXMub3ZlcmxheVBhbmUuYXBwZW5kQ2hpbGQodGhpcy5faW1hZ2UpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0YnJpbmdUb0JhY2s6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBwYW5lID0gdGhpcy5fbWFwLl9wYW5lcy5vdmVybGF5UGFuZTtcclxuXHRcdGlmICh0aGlzLl9pbWFnZSkge1xyXG5cdFx0XHRwYW5lLmluc2VydEJlZm9yZSh0aGlzLl9pbWFnZSwgcGFuZS5maXJzdENoaWxkKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHNldFVybDogZnVuY3Rpb24gKHVybCkge1xyXG5cdFx0dGhpcy5fdXJsID0gdXJsO1xyXG5cdFx0dGhpcy5faW1hZ2Uuc3JjID0gdGhpcy5fdXJsO1xyXG5cdH0sXHJcblxyXG5cdGdldEF0dHJpYnV0aW9uOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5vcHRpb25zLmF0dHJpYnV0aW9uO1xyXG5cdH0sXHJcblxyXG5cdF9pbml0SW1hZ2U6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuX2ltYWdlID0gTC5Eb21VdGlsLmNyZWF0ZSgnaW1nJywgJ2xlYWZsZXQtaW1hZ2UtbGF5ZXInKTtcclxuXHJcblx0XHRpZiAodGhpcy5fbWFwLm9wdGlvbnMuem9vbUFuaW1hdGlvbiAmJiBMLkJyb3dzZXIuYW55M2QpIHtcclxuXHRcdFx0TC5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX2ltYWdlLCAnbGVhZmxldC16b29tLWFuaW1hdGVkJyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRMLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5faW1hZ2UsICdsZWFmbGV0LXpvb20taGlkZScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3VwZGF0ZU9wYWNpdHkoKTtcclxuXHJcblx0XHQvL1RPRE8gY3JlYXRlSW1hZ2UgdXRpbCBtZXRob2QgdG8gcmVtb3ZlIGR1cGxpY2F0aW9uXHJcblx0XHRMLmV4dGVuZCh0aGlzLl9pbWFnZSwge1xyXG5cdFx0XHRnYWxsZXJ5aW1nOiAnbm8nLFxyXG5cdFx0XHRvbnNlbGVjdHN0YXJ0OiBMLlV0aWwuZmFsc2VGbixcclxuXHRcdFx0b25tb3VzZW1vdmU6IEwuVXRpbC5mYWxzZUZuLFxyXG5cdFx0XHRvbmxvYWQ6IEwuYmluZCh0aGlzLl9vbkltYWdlTG9hZCwgdGhpcyksXHJcblx0XHRcdHNyYzogdGhpcy5fdXJsXHJcblx0XHR9KTtcclxuXHR9LFxyXG5cclxuXHRfYW5pbWF0ZVpvb206IGZ1bmN0aW9uIChlKSB7XHJcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwLFxyXG5cdFx0ICAgIGltYWdlID0gdGhpcy5faW1hZ2UsXHJcblx0XHQgICAgc2NhbGUgPSBtYXAuZ2V0Wm9vbVNjYWxlKGUuem9vbSksXHJcblx0XHQgICAgbncgPSB0aGlzLl9ib3VuZHMuZ2V0Tm9ydGhXZXN0KCksXHJcblx0XHQgICAgc2UgPSB0aGlzLl9ib3VuZHMuZ2V0U291dGhFYXN0KCksXHJcblxyXG5cdFx0ICAgIHRvcExlZnQgPSBtYXAuX2xhdExuZ1RvTmV3TGF5ZXJQb2ludChudywgZS56b29tLCBlLmNlbnRlciksXHJcblx0XHQgICAgc2l6ZSA9IG1hcC5fbGF0TG5nVG9OZXdMYXllclBvaW50KHNlLCBlLnpvb20sIGUuY2VudGVyKS5fc3VidHJhY3QodG9wTGVmdCksXHJcblx0XHQgICAgb3JpZ2luID0gdG9wTGVmdC5fYWRkKHNpemUuX211bHRpcGx5QnkoKDEgLyAyKSAqICgxIC0gMSAvIHNjYWxlKSkpO1xyXG5cclxuXHRcdGltYWdlLnN0eWxlW0wuRG9tVXRpbC5UUkFOU0ZPUk1dID1cclxuXHRcdCAgICAgICAgTC5Eb21VdGlsLmdldFRyYW5zbGF0ZVN0cmluZyhvcmlnaW4pICsgJyBzY2FsZSgnICsgc2NhbGUgKyAnKSAnO1xyXG5cdH0sXHJcblxyXG5cdF9yZXNldDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGltYWdlICAgPSB0aGlzLl9pbWFnZSxcclxuXHRcdCAgICB0b3BMZWZ0ID0gdGhpcy5fbWFwLmxhdExuZ1RvTGF5ZXJQb2ludCh0aGlzLl9ib3VuZHMuZ2V0Tm9ydGhXZXN0KCkpLFxyXG5cdFx0ICAgIHNpemUgPSB0aGlzLl9tYXAubGF0TG5nVG9MYXllclBvaW50KHRoaXMuX2JvdW5kcy5nZXRTb3V0aEVhc3QoKSkuX3N1YnRyYWN0KHRvcExlZnQpO1xyXG5cclxuXHRcdEwuRG9tVXRpbC5zZXRQb3NpdGlvbihpbWFnZSwgdG9wTGVmdCk7XHJcblxyXG5cdFx0aW1hZ2Uuc3R5bGUud2lkdGggID0gc2l6ZS54ICsgJ3B4JztcclxuXHRcdGltYWdlLnN0eWxlLmhlaWdodCA9IHNpemUueSArICdweCc7XHJcblx0fSxcclxuXHJcblx0X29uSW1hZ2VMb2FkOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR0aGlzLmZpcmUoJ2xvYWQnKTtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlT3BhY2l0eTogZnVuY3Rpb24gKCkge1xyXG5cdFx0TC5Eb21VdGlsLnNldE9wYWNpdHkodGhpcy5faW1hZ2UsIHRoaXMub3B0aW9ucy5vcGFjaXR5KTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5pbWFnZU92ZXJsYXkgPSBmdW5jdGlvbiAodXJsLCBib3VuZHMsIG9wdGlvbnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuSW1hZ2VPdmVybGF5KHVybCwgYm91bmRzLCBvcHRpb25zKTtcclxufTtcclxuXG5cbi8qXHJcbiAqIEwuSWNvbiBpcyBhbiBpbWFnZS1iYXNlZCBpY29uIGNsYXNzIHRoYXQgeW91IGNhbiB1c2Ugd2l0aCBMLk1hcmtlciBmb3IgY3VzdG9tIG1hcmtlcnMuXHJcbiAqL1xyXG5cclxuTC5JY29uID0gTC5DbGFzcy5leHRlbmQoe1xyXG5cdG9wdGlvbnM6IHtcclxuXHRcdC8qXHJcblx0XHRpY29uVXJsOiAoU3RyaW5nKSAocmVxdWlyZWQpXHJcblx0XHRpY29uUmV0aW5hVXJsOiAoU3RyaW5nKSAob3B0aW9uYWwsIHVzZWQgZm9yIHJldGluYSBkZXZpY2VzIGlmIGRldGVjdGVkKVxyXG5cdFx0aWNvblNpemU6IChQb2ludCkgKGNhbiBiZSBzZXQgdGhyb3VnaCBDU1MpXHJcblx0XHRpY29uQW5jaG9yOiAoUG9pbnQpIChjZW50ZXJlZCBieSBkZWZhdWx0LCBjYW4gYmUgc2V0IGluIENTUyB3aXRoIG5lZ2F0aXZlIG1hcmdpbnMpXHJcblx0XHRwb3B1cEFuY2hvcjogKFBvaW50KSAoaWYgbm90IHNwZWNpZmllZCwgcG9wdXAgb3BlbnMgaW4gdGhlIGFuY2hvciBwb2ludClcclxuXHRcdHNoYWRvd1VybDogKFN0cmluZykgKG5vIHNoYWRvdyBieSBkZWZhdWx0KVxyXG5cdFx0c2hhZG93UmV0aW5hVXJsOiAoU3RyaW5nKSAob3B0aW9uYWwsIHVzZWQgZm9yIHJldGluYSBkZXZpY2VzIGlmIGRldGVjdGVkKVxyXG5cdFx0c2hhZG93U2l6ZTogKFBvaW50KVxyXG5cdFx0c2hhZG93QW5jaG9yOiAoUG9pbnQpXHJcblx0XHQqL1xyXG5cdFx0Y2xhc3NOYW1lOiAnJ1xyXG5cdH0sXHJcblxyXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcblx0XHRMLnNldE9wdGlvbnModGhpcywgb3B0aW9ucyk7XHJcblx0fSxcclxuXHJcblx0Y3JlYXRlSWNvbjogZnVuY3Rpb24gKG9sZEljb24pIHtcclxuXHRcdHJldHVybiB0aGlzLl9jcmVhdGVJY29uKCdpY29uJywgb2xkSWNvbik7XHJcblx0fSxcclxuXHJcblx0Y3JlYXRlU2hhZG93OiBmdW5jdGlvbiAob2xkSWNvbikge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2NyZWF0ZUljb24oJ3NoYWRvdycsIG9sZEljb24pO1xyXG5cdH0sXHJcblxyXG5cdF9jcmVhdGVJY29uOiBmdW5jdGlvbiAobmFtZSwgb2xkSWNvbikge1xyXG5cdFx0dmFyIHNyYyA9IHRoaXMuX2dldEljb25VcmwobmFtZSk7XHJcblxyXG5cdFx0aWYgKCFzcmMpIHtcclxuXHRcdFx0aWYgKG5hbWUgPT09ICdpY29uJykge1xyXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignaWNvblVybCBub3Qgc2V0IGluIEljb24gb3B0aW9ucyAoc2VlIHRoZSBkb2NzKS4nKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgaW1nO1xyXG5cdFx0aWYgKCFvbGRJY29uIHx8IG9sZEljb24udGFnTmFtZSAhPT0gJ0lNRycpIHtcclxuXHRcdFx0aW1nID0gdGhpcy5fY3JlYXRlSW1nKHNyYyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpbWcgPSB0aGlzLl9jcmVhdGVJbWcoc3JjLCBvbGRJY29uKTtcclxuXHRcdH1cclxuXHRcdHRoaXMuX3NldEljb25TdHlsZXMoaW1nLCBuYW1lKTtcclxuXHJcblx0XHRyZXR1cm4gaW1nO1xyXG5cdH0sXHJcblxyXG5cdF9zZXRJY29uU3R5bGVzOiBmdW5jdGlvbiAoaW1nLCBuYW1lKSB7XHJcblx0XHR2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcclxuXHRcdCAgICBzaXplID0gTC5wb2ludChvcHRpb25zW25hbWUgKyAnU2l6ZSddKSxcclxuXHRcdCAgICBhbmNob3I7XHJcblxyXG5cdFx0aWYgKG5hbWUgPT09ICdzaGFkb3cnKSB7XHJcblx0XHRcdGFuY2hvciA9IEwucG9pbnQob3B0aW9ucy5zaGFkb3dBbmNob3IgfHwgb3B0aW9ucy5pY29uQW5jaG9yKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGFuY2hvciA9IEwucG9pbnQob3B0aW9ucy5pY29uQW5jaG9yKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIWFuY2hvciAmJiBzaXplKSB7XHJcblx0XHRcdGFuY2hvciA9IHNpemUuZGl2aWRlQnkoMiwgdHJ1ZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aW1nLmNsYXNzTmFtZSA9ICdsZWFmbGV0LW1hcmtlci0nICsgbmFtZSArICcgJyArIG9wdGlvbnMuY2xhc3NOYW1lO1xyXG5cclxuXHRcdGlmIChhbmNob3IpIHtcclxuXHRcdFx0aW1nLnN0eWxlLm1hcmdpbkxlZnQgPSAoLWFuY2hvci54KSArICdweCc7XHJcblx0XHRcdGltZy5zdHlsZS5tYXJnaW5Ub3AgID0gKC1hbmNob3IueSkgKyAncHgnO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChzaXplKSB7XHJcblx0XHRcdGltZy5zdHlsZS53aWR0aCAgPSBzaXplLnggKyAncHgnO1xyXG5cdFx0XHRpbWcuc3R5bGUuaGVpZ2h0ID0gc2l6ZS55ICsgJ3B4JztcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlSW1nOiBmdW5jdGlvbiAoc3JjLCBlbCkge1xyXG5cdFx0ZWwgPSBlbCB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHRcdGVsLnNyYyA9IHNyYztcclxuXHRcdHJldHVybiBlbDtcclxuXHR9LFxyXG5cclxuXHRfZ2V0SWNvblVybDogZnVuY3Rpb24gKG5hbWUpIHtcclxuXHRcdGlmIChMLkJyb3dzZXIucmV0aW5hICYmIHRoaXMub3B0aW9uc1tuYW1lICsgJ1JldGluYVVybCddKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnNbbmFtZSArICdSZXRpbmFVcmwnXTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzLm9wdGlvbnNbbmFtZSArICdVcmwnXTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5pY29uID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuSWNvbihvcHRpb25zKTtcclxufTtcclxuXG5cbi8qXG4gKiBMLkljb24uRGVmYXVsdCBpcyB0aGUgYmx1ZSBtYXJrZXIgaWNvbiB1c2VkIGJ5IGRlZmF1bHQgaW4gTGVhZmxldC5cbiAqL1xuXG5MLkljb24uRGVmYXVsdCA9IEwuSWNvbi5leHRlbmQoe1xuXG5cdG9wdGlvbnM6IHtcblx0XHRpY29uU2l6ZTogWzI1LCA0MV0sXG5cdFx0aWNvbkFuY2hvcjogWzEyLCA0MV0sXG5cdFx0cG9wdXBBbmNob3I6IFsxLCAtMzRdLFxuXG5cdFx0c2hhZG93U2l6ZTogWzQxLCA0MV1cblx0fSxcblxuXHRfZ2V0SWNvblVybDogZnVuY3Rpb24gKG5hbWUpIHtcblx0XHR2YXIga2V5ID0gbmFtZSArICdVcmwnO1xuXG5cdFx0aWYgKHRoaXMub3B0aW9uc1trZXldKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5vcHRpb25zW2tleV07XG5cdFx0fVxuXG5cdFx0aWYgKEwuQnJvd3Nlci5yZXRpbmEgJiYgbmFtZSA9PT0gJ2ljb24nKSB7XG5cdFx0XHRuYW1lICs9ICctMngnO1xuXHRcdH1cblxuXHRcdHZhciBwYXRoID0gTC5JY29uLkRlZmF1bHQuaW1hZ2VQYXRoO1xuXG5cdFx0aWYgKCFwYXRoKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkblxcJ3QgYXV0b2RldGVjdCBMLkljb24uRGVmYXVsdC5pbWFnZVBhdGgsIHNldCBpdCBtYW51YWxseS4nKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gcGF0aCArICcvbWFya2VyLScgKyBuYW1lICsgJy5wbmcnO1xuXHR9XG59KTtcblxuTC5JY29uLkRlZmF1bHQuaW1hZ2VQYXRoID0gKGZ1bmN0aW9uICgpIHtcblx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JyksXG5cdCAgICBsZWFmbGV0UmUgPSAvW1xcL15dbGVhZmxldFtcXC1cXC5fXT8oW1xcd1xcLVxcLl9dKilcXC5qc1xcPz8vO1xuXG5cdHZhciBpLCBsZW4sIHNyYywgbWF0Y2hlcywgcGF0aDtcblxuXHRmb3IgKGkgPSAwLCBsZW4gPSBzY3JpcHRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0c3JjID0gc2NyaXB0c1tpXS5zcmM7XG5cdFx0bWF0Y2hlcyA9IHNyYy5tYXRjaChsZWFmbGV0UmUpO1xuXG5cdFx0aWYgKG1hdGNoZXMpIHtcblx0XHRcdHBhdGggPSBzcmMuc3BsaXQobGVhZmxldFJlKVswXTtcblx0XHRcdHJldHVybiAocGF0aCA/IHBhdGggKyAnLycgOiAnJykgKyAnaW1hZ2VzJztcblx0XHR9XG5cdH1cbn0oKSk7XG5cblxuLypcclxuICogTC5NYXJrZXIgaXMgdXNlZCB0byBkaXNwbGF5IGNsaWNrYWJsZS9kcmFnZ2FibGUgaWNvbnMgb24gdGhlIG1hcC5cclxuICovXHJcblxyXG5MLk1hcmtlciA9IEwuQ2xhc3MuZXh0ZW5kKHtcclxuXHJcblx0aW5jbHVkZXM6IEwuTWl4aW4uRXZlbnRzLFxyXG5cclxuXHRvcHRpb25zOiB7XHJcblx0XHRpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKSxcclxuXHRcdHRpdGxlOiAnJyxcclxuXHRcdGFsdDogJycsXHJcblx0XHRjbGlja2FibGU6IHRydWUsXHJcblx0XHRkcmFnZ2FibGU6IGZhbHNlLFxyXG5cdFx0a2V5Ym9hcmQ6IHRydWUsXHJcblx0XHR6SW5kZXhPZmZzZXQ6IDAsXHJcblx0XHRvcGFjaXR5OiAxLFxyXG5cdFx0cmlzZU9uSG92ZXI6IGZhbHNlLFxyXG5cdFx0cmlzZU9mZnNldDogMjUwXHJcblx0fSxcclxuXHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKGxhdGxuZywgb3B0aW9ucykge1xyXG5cdFx0TC5zZXRPcHRpb25zKHRoaXMsIG9wdGlvbnMpO1xyXG5cdFx0dGhpcy5fbGF0bG5nID0gTC5sYXRMbmcobGF0bG5nKTtcclxuXHR9LFxyXG5cclxuXHRvbkFkZDogZnVuY3Rpb24gKG1hcCkge1xyXG5cdFx0dGhpcy5fbWFwID0gbWFwO1xyXG5cclxuXHRcdG1hcC5vbigndmlld3Jlc2V0JywgdGhpcy51cGRhdGUsIHRoaXMpO1xyXG5cclxuXHRcdHRoaXMuX2luaXRJY29uKCk7XHJcblx0XHR0aGlzLnVwZGF0ZSgpO1xyXG5cdFx0dGhpcy5maXJlKCdhZGQnKTtcclxuXHJcblx0XHRpZiAobWFwLm9wdGlvbnMuem9vbUFuaW1hdGlvbiAmJiBtYXAub3B0aW9ucy5tYXJrZXJab29tQW5pbWF0aW9uKSB7XHJcblx0XHRcdG1hcC5vbignem9vbWFuaW0nLCB0aGlzLl9hbmltYXRlWm9vbSwgdGhpcyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0YWRkVG86IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcC5hZGRMYXllcih0aGlzKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdG9uUmVtb3ZlOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHRpZiAodGhpcy5kcmFnZ2luZykge1xyXG5cdFx0XHR0aGlzLmRyYWdnaW5nLmRpc2FibGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9yZW1vdmVJY29uKCk7XHJcblx0XHR0aGlzLl9yZW1vdmVTaGFkb3coKTtcclxuXHJcblx0XHR0aGlzLmZpcmUoJ3JlbW92ZScpO1xyXG5cclxuXHRcdG1hcC5vZmYoe1xyXG5cdFx0XHQndmlld3Jlc2V0JzogdGhpcy51cGRhdGUsXHJcblx0XHRcdCd6b29tYW5pbSc6IHRoaXMuX2FuaW1hdGVab29tXHJcblx0XHR9LCB0aGlzKTtcclxuXHJcblx0XHR0aGlzLl9tYXAgPSBudWxsO1xyXG5cdH0sXHJcblxyXG5cdGdldExhdExuZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2xhdGxuZztcclxuXHR9LFxyXG5cclxuXHRzZXRMYXRMbmc6IGZ1bmN0aW9uIChsYXRsbmcpIHtcclxuXHRcdHRoaXMuX2xhdGxuZyA9IEwubGF0TG5nKGxhdGxuZyk7XHJcblxyXG5cdFx0dGhpcy51cGRhdGUoKTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcy5maXJlKCdtb3ZlJywgeyBsYXRsbmc6IHRoaXMuX2xhdGxuZyB9KTtcclxuXHR9LFxyXG5cclxuXHRzZXRaSW5kZXhPZmZzZXQ6IGZ1bmN0aW9uIChvZmZzZXQpIHtcclxuXHRcdHRoaXMub3B0aW9ucy56SW5kZXhPZmZzZXQgPSBvZmZzZXQ7XHJcblx0XHR0aGlzLnVwZGF0ZSgpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHNldEljb246IGZ1bmN0aW9uIChpY29uKSB7XHJcblxyXG5cdFx0dGhpcy5vcHRpb25zLmljb24gPSBpY29uO1xyXG5cclxuXHRcdGlmICh0aGlzLl9tYXApIHtcclxuXHRcdFx0dGhpcy5faW5pdEljb24oKTtcclxuXHRcdFx0dGhpcy51cGRhdGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fcG9wdXApIHtcclxuXHRcdFx0dGhpcy5iaW5kUG9wdXAodGhpcy5fcG9wdXApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX2ljb24pIHtcclxuXHRcdFx0dGhpcy5fc2V0UG9zKHRoaXMuX21hcC5sYXRMbmdUb0xheWVyUG9pbnQodGhpcy5fbGF0bG5nKS5yb3VuZCgpKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdF9pbml0SWNvbjogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXHJcblx0XHQgICAgbWFwID0gdGhpcy5fbWFwLFxyXG5cdFx0ICAgIGFuaW1hdGlvbiA9IChtYXAub3B0aW9ucy56b29tQW5pbWF0aW9uICYmIG1hcC5vcHRpb25zLm1hcmtlclpvb21BbmltYXRpb24pLFxyXG5cdFx0ICAgIGNsYXNzVG9BZGQgPSBhbmltYXRpb24gPyAnbGVhZmxldC16b29tLWFuaW1hdGVkJyA6ICdsZWFmbGV0LXpvb20taGlkZSc7XHJcblxyXG5cdFx0dmFyIGljb24gPSBvcHRpb25zLmljb24uY3JlYXRlSWNvbih0aGlzLl9pY29uKSxcclxuXHRcdFx0YWRkSWNvbiA9IGZhbHNlO1xyXG5cclxuXHRcdC8vIGlmIHdlJ3JlIG5vdCByZXVzaW5nIHRoZSBpY29uLCByZW1vdmUgdGhlIG9sZCBvbmUgYW5kIGluaXQgbmV3IG9uZVxyXG5cdFx0aWYgKGljb24gIT09IHRoaXMuX2ljb24pIHtcclxuXHRcdFx0aWYgKHRoaXMuX2ljb24pIHtcclxuXHRcdFx0XHR0aGlzLl9yZW1vdmVJY29uKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0YWRkSWNvbiA9IHRydWU7XHJcblxyXG5cdFx0XHRpZiAob3B0aW9ucy50aXRsZSkge1xyXG5cdFx0XHRcdGljb24udGl0bGUgPSBvcHRpb25zLnRpdGxlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAob3B0aW9ucy5hbHQpIHtcclxuXHRcdFx0XHRpY29uLmFsdCA9IG9wdGlvbnMuYWx0O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0TC5Eb21VdGlsLmFkZENsYXNzKGljb24sIGNsYXNzVG9BZGQpO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLmtleWJvYXJkKSB7XHJcblx0XHRcdGljb24udGFiSW5kZXggPSAnMCc7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5faWNvbiA9IGljb247XHJcblxyXG5cdFx0dGhpcy5faW5pdEludGVyYWN0aW9uKCk7XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMucmlzZU9uSG92ZXIpIHtcclxuXHRcdFx0TC5Eb21FdmVudFxyXG5cdFx0XHRcdC5vbihpY29uLCAnbW91c2VvdmVyJywgdGhpcy5fYnJpbmdUb0Zyb250LCB0aGlzKVxyXG5cdFx0XHRcdC5vbihpY29uLCAnbW91c2VvdXQnLCB0aGlzLl9yZXNldFpJbmRleCwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIG5ld1NoYWRvdyA9IG9wdGlvbnMuaWNvbi5jcmVhdGVTaGFkb3codGhpcy5fc2hhZG93KSxcclxuXHRcdFx0YWRkU2hhZG93ID0gZmFsc2U7XHJcblxyXG5cdFx0aWYgKG5ld1NoYWRvdyAhPT0gdGhpcy5fc2hhZG93KSB7XHJcblx0XHRcdHRoaXMuX3JlbW92ZVNoYWRvdygpO1xyXG5cdFx0XHRhZGRTaGFkb3cgPSB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChuZXdTaGFkb3cpIHtcclxuXHRcdFx0TC5Eb21VdGlsLmFkZENsYXNzKG5ld1NoYWRvdywgY2xhc3NUb0FkZCk7XHJcblx0XHR9XHJcblx0XHR0aGlzLl9zaGFkb3cgPSBuZXdTaGFkb3c7XHJcblxyXG5cclxuXHRcdGlmIChvcHRpb25zLm9wYWNpdHkgPCAxKSB7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZU9wYWNpdHkoKTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0dmFyIHBhbmVzID0gdGhpcy5fbWFwLl9wYW5lcztcclxuXHJcblx0XHRpZiAoYWRkSWNvbikge1xyXG5cdFx0XHRwYW5lcy5tYXJrZXJQYW5lLmFwcGVuZENoaWxkKHRoaXMuX2ljb24pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChuZXdTaGFkb3cgJiYgYWRkU2hhZG93KSB7XHJcblx0XHRcdHBhbmVzLnNoYWRvd1BhbmUuYXBwZW5kQ2hpbGQodGhpcy5fc2hhZG93KTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfcmVtb3ZlSWNvbjogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5yaXNlT25Ib3Zlcikge1xyXG5cdFx0XHRMLkRvbUV2ZW50XHJcblx0XHRcdCAgICAub2ZmKHRoaXMuX2ljb24sICdtb3VzZW92ZXInLCB0aGlzLl9icmluZ1RvRnJvbnQpXHJcblx0XHRcdCAgICAub2ZmKHRoaXMuX2ljb24sICdtb3VzZW91dCcsIHRoaXMuX3Jlc2V0WkluZGV4KTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9tYXAuX3BhbmVzLm1hcmtlclBhbmUucmVtb3ZlQ2hpbGQodGhpcy5faWNvbik7XHJcblxyXG5cdFx0dGhpcy5faWNvbiA9IG51bGw7XHJcblx0fSxcclxuXHJcblx0X3JlbW92ZVNoYWRvdzogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX3NoYWRvdykge1xyXG5cdFx0XHR0aGlzLl9tYXAuX3BhbmVzLnNoYWRvd1BhbmUucmVtb3ZlQ2hpbGQodGhpcy5fc2hhZG93KTtcclxuXHRcdH1cclxuXHRcdHRoaXMuX3NoYWRvdyA9IG51bGw7XHJcblx0fSxcclxuXHJcblx0X3NldFBvczogZnVuY3Rpb24gKHBvcykge1xyXG5cdFx0TC5Eb21VdGlsLnNldFBvc2l0aW9uKHRoaXMuX2ljb24sIHBvcyk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3NoYWRvdykge1xyXG5cdFx0XHRMLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fc2hhZG93LCBwb3MpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3pJbmRleCA9IHBvcy55ICsgdGhpcy5vcHRpb25zLnpJbmRleE9mZnNldDtcclxuXHJcblx0XHR0aGlzLl9yZXNldFpJbmRleCgpO1xyXG5cdH0sXHJcblxyXG5cdF91cGRhdGVaSW5kZXg6IGZ1bmN0aW9uIChvZmZzZXQpIHtcclxuXHRcdHRoaXMuX2ljb24uc3R5bGUuekluZGV4ID0gdGhpcy5fekluZGV4ICsgb2Zmc2V0O1xyXG5cdH0sXHJcblxyXG5cdF9hbmltYXRlWm9vbTogZnVuY3Rpb24gKG9wdCkge1xyXG5cdFx0dmFyIHBvcyA9IHRoaXMuX21hcC5fbGF0TG5nVG9OZXdMYXllclBvaW50KHRoaXMuX2xhdGxuZywgb3B0Lnpvb20sIG9wdC5jZW50ZXIpLnJvdW5kKCk7XHJcblxyXG5cdFx0dGhpcy5fc2V0UG9zKHBvcyk7XHJcblx0fSxcclxuXHJcblx0X2luaXRJbnRlcmFjdGlvbjogZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdGlmICghdGhpcy5vcHRpb25zLmNsaWNrYWJsZSkgeyByZXR1cm47IH1cclxuXHJcblx0XHQvLyBUT0RPIHJlZmFjdG9yIGludG8gc29tZXRoaW5nIHNoYXJlZCB3aXRoIE1hcC9QYXRoL2V0Yy4gdG8gRFJZIGl0IHVwXHJcblxyXG5cdFx0dmFyIGljb24gPSB0aGlzLl9pY29uLFxyXG5cdFx0ICAgIGV2ZW50cyA9IFsnZGJsY2xpY2snLCAnbW91c2Vkb3duJywgJ21vdXNlb3ZlcicsICdtb3VzZW91dCcsICdjb250ZXh0bWVudSddO1xyXG5cclxuXHRcdEwuRG9tVXRpbC5hZGRDbGFzcyhpY29uLCAnbGVhZmxldC1jbGlja2FibGUnKTtcclxuXHRcdEwuRG9tRXZlbnQub24oaWNvbiwgJ2NsaWNrJywgdGhpcy5fb25Nb3VzZUNsaWNrLCB0aGlzKTtcclxuXHRcdEwuRG9tRXZlbnQub24oaWNvbiwgJ2tleXByZXNzJywgdGhpcy5fb25LZXlQcmVzcywgdGhpcyk7XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0TC5Eb21FdmVudC5vbihpY29uLCBldmVudHNbaV0sIHRoaXMuX2ZpcmVNb3VzZUV2ZW50LCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoTC5IYW5kbGVyLk1hcmtlckRyYWcpIHtcclxuXHRcdFx0dGhpcy5kcmFnZ2luZyA9IG5ldyBMLkhhbmRsZXIuTWFya2VyRHJhZyh0aGlzKTtcclxuXHJcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMuZHJhZ2dhYmxlKSB7XHJcblx0XHRcdFx0dGhpcy5kcmFnZ2luZy5lbmFibGUoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9vbk1vdXNlQ2xpY2s6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHR2YXIgd2FzRHJhZ2dlZCA9IHRoaXMuZHJhZ2dpbmcgJiYgdGhpcy5kcmFnZ2luZy5tb3ZlZCgpO1xyXG5cclxuXHRcdGlmICh0aGlzLmhhc0V2ZW50TGlzdGVuZXJzKGUudHlwZSkgfHwgd2FzRHJhZ2dlZCkge1xyXG5cdFx0XHRMLkRvbUV2ZW50LnN0b3BQcm9wYWdhdGlvbihlKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAod2FzRHJhZ2dlZCkgeyByZXR1cm47IH1cclxuXHJcblx0XHRpZiAoKCF0aGlzLmRyYWdnaW5nIHx8ICF0aGlzLmRyYWdnaW5nLl9lbmFibGVkKSAmJiB0aGlzLl9tYXAuZHJhZ2dpbmcgJiYgdGhpcy5fbWFwLmRyYWdnaW5nLm1vdmVkKCkpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0dGhpcy5maXJlKGUudHlwZSwge1xyXG5cdFx0XHRvcmlnaW5hbEV2ZW50OiBlLFxyXG5cdFx0XHRsYXRsbmc6IHRoaXMuX2xhdGxuZ1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0X29uS2V5UHJlc3M6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRpZiAoZS5rZXlDb2RlID09PSAxMykge1xyXG5cdFx0XHR0aGlzLmZpcmUoJ2NsaWNrJywge1xyXG5cdFx0XHRcdG9yaWdpbmFsRXZlbnQ6IGUsXHJcblx0XHRcdFx0bGF0bG5nOiB0aGlzLl9sYXRsbmdcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2ZpcmVNb3VzZUV2ZW50OiBmdW5jdGlvbiAoZSkge1xyXG5cclxuXHRcdHRoaXMuZmlyZShlLnR5cGUsIHtcclxuXHRcdFx0b3JpZ2luYWxFdmVudDogZSxcclxuXHRcdFx0bGF0bG5nOiB0aGlzLl9sYXRsbmdcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFRPRE8gcHJvcGVyIGN1c3RvbSBldmVudCBwcm9wYWdhdGlvblxyXG5cdFx0Ly8gdGhpcyBsaW5lIHdpbGwgYWx3YXlzIGJlIGNhbGxlZCBpZiBtYXJrZXIgaXMgaW4gYSBGZWF0dXJlR3JvdXBcclxuXHRcdGlmIChlLnR5cGUgPT09ICdjb250ZXh0bWVudScgJiYgdGhpcy5oYXNFdmVudExpc3RlbmVycyhlLnR5cGUpKSB7XHJcblx0XHRcdEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQoZSk7XHJcblx0XHR9XHJcblx0XHRpZiAoZS50eXBlICE9PSAnbW91c2Vkb3duJykge1xyXG5cdFx0XHRMLkRvbUV2ZW50LnN0b3BQcm9wYWdhdGlvbihlKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQoZSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0c2V0T3BhY2l0eTogZnVuY3Rpb24gKG9wYWNpdHkpIHtcclxuXHRcdHRoaXMub3B0aW9ucy5vcGFjaXR5ID0gb3BhY2l0eTtcclxuXHRcdGlmICh0aGlzLl9tYXApIHtcclxuXHRcdFx0dGhpcy5fdXBkYXRlT3BhY2l0eSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdF91cGRhdGVPcGFjaXR5OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRMLkRvbVV0aWwuc2V0T3BhY2l0eSh0aGlzLl9pY29uLCB0aGlzLm9wdGlvbnMub3BhY2l0eSk7XHJcblx0XHRpZiAodGhpcy5fc2hhZG93KSB7XHJcblx0XHRcdEwuRG9tVXRpbC5zZXRPcGFjaXR5KHRoaXMuX3NoYWRvdywgdGhpcy5vcHRpb25zLm9wYWNpdHkpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9icmluZ1RvRnJvbnQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuX3VwZGF0ZVpJbmRleCh0aGlzLm9wdGlvbnMucmlzZU9mZnNldCk7XHJcblx0fSxcclxuXHJcblx0X3Jlc2V0WkluZGV4OiBmdW5jdGlvbiAoKSB7XHJcblx0XHR0aGlzLl91cGRhdGVaSW5kZXgoMCk7XHJcblx0fVxyXG59KTtcclxuXHJcbkwubWFya2VyID0gZnVuY3Rpb24gKGxhdGxuZywgb3B0aW9ucykge1xyXG5cdHJldHVybiBuZXcgTC5NYXJrZXIobGF0bG5nLCBvcHRpb25zKTtcclxufTtcclxuXG5cbi8qXG4gKiBMLkRpdkljb24gaXMgYSBsaWdodHdlaWdodCBIVE1MLWJhc2VkIGljb24gY2xhc3MgKGFzIG9wcG9zZWQgdG8gdGhlIGltYWdlLWJhc2VkIEwuSWNvbilcbiAqIHRvIHVzZSB3aXRoIEwuTWFya2VyLlxuICovXG5cbkwuRGl2SWNvbiA9IEwuSWNvbi5leHRlbmQoe1xuXHRvcHRpb25zOiB7XG5cdFx0aWNvblNpemU6IFsxMiwgMTJdLCAvLyBhbHNvIGNhbiBiZSBzZXQgdGhyb3VnaCBDU1Ncblx0XHQvKlxuXHRcdGljb25BbmNob3I6IChQb2ludClcblx0XHRwb3B1cEFuY2hvcjogKFBvaW50KVxuXHRcdGh0bWw6IChTdHJpbmcpXG5cdFx0YmdQb3M6IChQb2ludClcblx0XHQqL1xuXHRcdGNsYXNzTmFtZTogJ2xlYWZsZXQtZGl2LWljb24nLFxuXHRcdGh0bWw6IGZhbHNlXG5cdH0sXG5cblx0Y3JlYXRlSWNvbjogZnVuY3Rpb24gKG9sZEljb24pIHtcblx0XHR2YXIgZGl2ID0gKG9sZEljb24gJiYgb2xkSWNvbi50YWdOYW1lID09PSAnRElWJykgPyBvbGRJY29uIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXG5cdFx0ICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cblx0XHRpZiAob3B0aW9ucy5odG1sICE9PSBmYWxzZSkge1xuXHRcdFx0ZGl2LmlubmVySFRNTCA9IG9wdGlvbnMuaHRtbDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGl2LmlubmVySFRNTCA9ICcnO1xuXHRcdH1cblxuXHRcdGlmIChvcHRpb25zLmJnUG9zKSB7XG5cdFx0XHRkaXYuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID1cblx0XHRcdCAgICAgICAgKC1vcHRpb25zLmJnUG9zLngpICsgJ3B4ICcgKyAoLW9wdGlvbnMuYmdQb3MueSkgKyAncHgnO1xuXHRcdH1cblxuXHRcdHRoaXMuX3NldEljb25TdHlsZXMoZGl2LCAnaWNvbicpO1xuXHRcdHJldHVybiBkaXY7XG5cdH0sXG5cblx0Y3JlYXRlU2hhZG93OiBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cbn0pO1xuXG5MLmRpdkljb24gPSBmdW5jdGlvbiAob3B0aW9ucykge1xuXHRyZXR1cm4gbmV3IEwuRGl2SWNvbihvcHRpb25zKTtcbn07XG5cblxuLypcclxuICogTC5Qb3B1cCBpcyB1c2VkIGZvciBkaXNwbGF5aW5nIHBvcHVwcyBvbiB0aGUgbWFwLlxyXG4gKi9cclxuXHJcbkwuTWFwLm1lcmdlT3B0aW9ucyh7XHJcblx0Y2xvc2VQb3B1cE9uQ2xpY2s6IHRydWVcclxufSk7XHJcblxyXG5MLlBvcHVwID0gTC5DbGFzcy5leHRlbmQoe1xyXG5cdGluY2x1ZGVzOiBMLk1peGluLkV2ZW50cyxcclxuXHJcblx0b3B0aW9uczoge1xyXG5cdFx0bWluV2lkdGg6IDUwLFxyXG5cdFx0bWF4V2lkdGg6IDMwMCxcclxuXHRcdC8vIG1heEhlaWdodDogbnVsbCxcclxuXHRcdGF1dG9QYW46IHRydWUsXHJcblx0XHRjbG9zZUJ1dHRvbjogdHJ1ZSxcclxuXHRcdG9mZnNldDogWzAsIDddLFxyXG5cdFx0YXV0b1BhblBhZGRpbmc6IFs1LCA1XSxcclxuXHRcdC8vIGF1dG9QYW5QYWRkaW5nVG9wTGVmdDogbnVsbCxcclxuXHRcdC8vIGF1dG9QYW5QYWRkaW5nQm90dG9tUmlnaHQ6IG51bGwsXHJcblx0XHRrZWVwSW5WaWV3OiBmYWxzZSxcclxuXHRcdGNsYXNzTmFtZTogJycsXHJcblx0XHR6b29tQW5pbWF0aW9uOiB0cnVlXHJcblx0fSxcclxuXHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKG9wdGlvbnMsIHNvdXJjZSkge1xyXG5cdFx0TC5zZXRPcHRpb25zKHRoaXMsIG9wdGlvbnMpO1xyXG5cclxuXHRcdHRoaXMuX3NvdXJjZSA9IHNvdXJjZTtcclxuXHRcdHRoaXMuX2FuaW1hdGVkID0gTC5Ccm93c2VyLmFueTNkICYmIHRoaXMub3B0aW9ucy56b29tQW5pbWF0aW9uO1xyXG5cdFx0dGhpcy5faXNPcGVuID0gZmFsc2U7XHJcblx0fSxcclxuXHJcblx0b25BZGQ6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdHRoaXMuX21hcCA9IG1hcDtcclxuXHJcblx0XHRpZiAoIXRoaXMuX2NvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLl9pbml0TGF5b3V0KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGFuaW1GYWRlID0gbWFwLm9wdGlvbnMuZmFkZUFuaW1hdGlvbjtcclxuXHJcblx0XHRpZiAoYW5pbUZhZGUpIHtcclxuXHRcdFx0TC5Eb21VdGlsLnNldE9wYWNpdHkodGhpcy5fY29udGFpbmVyLCAwKTtcclxuXHRcdH1cclxuXHRcdG1hcC5fcGFuZXMucG9wdXBQYW5lLmFwcGVuZENoaWxkKHRoaXMuX2NvbnRhaW5lcik7XHJcblxyXG5cdFx0bWFwLm9uKHRoaXMuX2dldEV2ZW50cygpLCB0aGlzKTtcclxuXHJcblx0XHR0aGlzLnVwZGF0ZSgpO1xyXG5cclxuXHRcdGlmIChhbmltRmFkZSkge1xyXG5cdFx0XHRMLkRvbVV0aWwuc2V0T3BhY2l0eSh0aGlzLl9jb250YWluZXIsIDEpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZmlyZSgnb3BlbicpO1xyXG5cclxuXHRcdG1hcC5maXJlKCdwb3B1cG9wZW4nLCB7cG9wdXA6IHRoaXN9KTtcclxuXHJcblx0XHRpZiAodGhpcy5fc291cmNlKSB7XHJcblx0XHRcdHRoaXMuX3NvdXJjZS5maXJlKCdwb3B1cG9wZW4nLCB7cG9wdXA6IHRoaXN9KTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRhZGRUbzogZnVuY3Rpb24gKG1hcCkge1xyXG5cdFx0bWFwLmFkZExheWVyKHRoaXMpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0b3Blbk9uOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHRtYXAub3BlblBvcHVwKHRoaXMpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0b25SZW1vdmU6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcC5fcGFuZXMucG9wdXBQYW5lLnJlbW92ZUNoaWxkKHRoaXMuX2NvbnRhaW5lcik7XHJcblxyXG5cdFx0TC5VdGlsLmZhbHNlRm4odGhpcy5fY29udGFpbmVyLm9mZnNldFdpZHRoKTsgLy8gZm9yY2UgcmVmbG93XHJcblxyXG5cdFx0bWFwLm9mZih0aGlzLl9nZXRFdmVudHMoKSwgdGhpcyk7XHJcblxyXG5cdFx0aWYgKG1hcC5vcHRpb25zLmZhZGVBbmltYXRpb24pIHtcclxuXHRcdFx0TC5Eb21VdGlsLnNldE9wYWNpdHkodGhpcy5fY29udGFpbmVyLCAwKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9tYXAgPSBudWxsO1xyXG5cclxuXHRcdHRoaXMuZmlyZSgnY2xvc2UnKTtcclxuXHJcblx0XHRtYXAuZmlyZSgncG9wdXBjbG9zZScsIHtwb3B1cDogdGhpc30pO1xyXG5cclxuXHRcdGlmICh0aGlzLl9zb3VyY2UpIHtcclxuXHRcdFx0dGhpcy5fc291cmNlLmZpcmUoJ3BvcHVwY2xvc2UnLCB7cG9wdXA6IHRoaXN9KTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRnZXRMYXRMbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9sYXRsbmc7XHJcblx0fSxcclxuXHJcblx0c2V0TGF0TG5nOiBmdW5jdGlvbiAobGF0bG5nKSB7XHJcblx0XHR0aGlzLl9sYXRsbmcgPSBMLmxhdExuZyhsYXRsbmcpO1xyXG5cdFx0aWYgKHRoaXMuX21hcCkge1xyXG5cdFx0XHR0aGlzLl91cGRhdGVQb3NpdGlvbigpO1xyXG5cdFx0XHR0aGlzLl9hZGp1c3RQYW4oKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGdldENvbnRlbnQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9jb250ZW50O1xyXG5cdH0sXHJcblxyXG5cdHNldENvbnRlbnQ6IGZ1bmN0aW9uIChjb250ZW50KSB7XHJcblx0XHR0aGlzLl9jb250ZW50ID0gY29udGVudDtcclxuXHRcdHRoaXMudXBkYXRlKCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHR1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICghdGhpcy5fbWFwKSB7IHJldHVybjsgfVxyXG5cclxuXHRcdHRoaXMuX2NvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcblxyXG5cdFx0dGhpcy5fdXBkYXRlQ29udGVudCgpO1xyXG5cdFx0dGhpcy5fdXBkYXRlTGF5b3V0KCk7XHJcblx0XHR0aGlzLl91cGRhdGVQb3NpdGlvbigpO1xyXG5cclxuXHRcdHRoaXMuX2NvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gJyc7XHJcblxyXG5cdFx0dGhpcy5fYWRqdXN0UGFuKCk7XHJcblx0fSxcclxuXHJcblx0X2dldEV2ZW50czogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGV2ZW50cyA9IHtcclxuXHRcdFx0dmlld3Jlc2V0OiB0aGlzLl91cGRhdGVQb3NpdGlvblxyXG5cdFx0fTtcclxuXHJcblx0XHRpZiAodGhpcy5fYW5pbWF0ZWQpIHtcclxuXHRcdFx0ZXZlbnRzLnpvb21hbmltID0gdGhpcy5fem9vbUFuaW1hdGlvbjtcclxuXHRcdH1cclxuXHRcdGlmICgnY2xvc2VPbkNsaWNrJyBpbiB0aGlzLm9wdGlvbnMgPyB0aGlzLm9wdGlvbnMuY2xvc2VPbkNsaWNrIDogdGhpcy5fbWFwLm9wdGlvbnMuY2xvc2VQb3B1cE9uQ2xpY2spIHtcclxuXHRcdFx0ZXZlbnRzLnByZWNsaWNrID0gdGhpcy5fY2xvc2U7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5vcHRpb25zLmtlZXBJblZpZXcpIHtcclxuXHRcdFx0ZXZlbnRzLm1vdmVlbmQgPSB0aGlzLl9hZGp1c3RQYW47XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGV2ZW50cztcclxuXHR9LFxyXG5cclxuXHRfY2xvc2U6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLl9tYXApIHtcclxuXHRcdFx0dGhpcy5fbWFwLmNsb3NlUG9wdXAodGhpcyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2luaXRMYXlvdXQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBwcmVmaXggPSAnbGVhZmxldC1wb3B1cCcsXHJcblx0XHRcdGNvbnRhaW5lckNsYXNzID0gcHJlZml4ICsgJyAnICsgdGhpcy5vcHRpb25zLmNsYXNzTmFtZSArICcgbGVhZmxldC16b29tLScgK1xyXG5cdFx0XHQgICAgICAgICh0aGlzLl9hbmltYXRlZCA/ICdhbmltYXRlZCcgOiAnaGlkZScpLFxyXG5cdFx0XHRjb250YWluZXIgPSB0aGlzLl9jb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBjb250YWluZXJDbGFzcyksXHJcblx0XHRcdGNsb3NlQnV0dG9uO1xyXG5cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuY2xvc2VCdXR0b24pIHtcclxuXHRcdFx0Y2xvc2VCdXR0b24gPSB0aGlzLl9jbG9zZUJ1dHRvbiA9XHJcblx0XHRcdCAgICAgICAgTC5Eb21VdGlsLmNyZWF0ZSgnYScsIHByZWZpeCArICctY2xvc2UtYnV0dG9uJywgY29udGFpbmVyKTtcclxuXHRcdFx0Y2xvc2VCdXR0b24uaHJlZiA9ICcjY2xvc2UnO1xyXG5cdFx0XHRjbG9zZUJ1dHRvbi5pbm5lckhUTUwgPSAnJiMyMTU7JztcclxuXHRcdFx0TC5Eb21FdmVudC5kaXNhYmxlQ2xpY2tQcm9wYWdhdGlvbihjbG9zZUJ1dHRvbik7XHJcblxyXG5cdFx0XHRMLkRvbUV2ZW50Lm9uKGNsb3NlQnV0dG9uLCAnY2xpY2snLCB0aGlzLl9vbkNsb3NlQnV0dG9uQ2xpY2ssIHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciB3cmFwcGVyID0gdGhpcy5fd3JhcHBlciA9XHJcblx0XHQgICAgICAgIEwuRG9tVXRpbC5jcmVhdGUoJ2RpdicsIHByZWZpeCArICctY29udGVudC13cmFwcGVyJywgY29udGFpbmVyKTtcclxuXHRcdEwuRG9tRXZlbnQuZGlzYWJsZUNsaWNrUHJvcGFnYXRpb24od3JhcHBlcik7XHJcblxyXG5cdFx0dGhpcy5fY29udGVudE5vZGUgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBwcmVmaXggKyAnLWNvbnRlbnQnLCB3cmFwcGVyKTtcclxuXHJcblx0XHRMLkRvbUV2ZW50LmRpc2FibGVTY3JvbGxQcm9wYWdhdGlvbih0aGlzLl9jb250ZW50Tm9kZSk7XHJcblx0XHRMLkRvbUV2ZW50Lm9uKHdyYXBwZXIsICdjb250ZXh0bWVudScsIEwuRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKTtcclxuXHJcblx0XHR0aGlzLl90aXBDb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBwcmVmaXggKyAnLXRpcC1jb250YWluZXInLCBjb250YWluZXIpO1xyXG5cdFx0dGhpcy5fdGlwID0gTC5Eb21VdGlsLmNyZWF0ZSgnZGl2JywgcHJlZml4ICsgJy10aXAnLCB0aGlzLl90aXBDb250YWluZXIpO1xyXG5cdH0sXHJcblxyXG5cdF91cGRhdGVDb250ZW50OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX2NvbnRlbnQpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0aWYgKHR5cGVvZiB0aGlzLl9jb250ZW50ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHR0aGlzLl9jb250ZW50Tm9kZS5pbm5lckhUTUwgPSB0aGlzLl9jb250ZW50O1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2hpbGUgKHRoaXMuX2NvbnRlbnROb2RlLmhhc0NoaWxkTm9kZXMoKSkge1xyXG5cdFx0XHRcdHRoaXMuX2NvbnRlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuX2NvbnRlbnROb2RlLmZpcnN0Q2hpbGQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuX2NvbnRlbnROb2RlLmFwcGVuZENoaWxkKHRoaXMuX2NvbnRlbnQpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5maXJlKCdjb250ZW50dXBkYXRlJyk7XHJcblx0fSxcclxuXHJcblx0X3VwZGF0ZUxheW91dDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGNvbnRhaW5lciA9IHRoaXMuX2NvbnRlbnROb2RlLFxyXG5cdFx0ICAgIHN0eWxlID0gY29udGFpbmVyLnN0eWxlO1xyXG5cclxuXHRcdHN0eWxlLndpZHRoID0gJyc7XHJcblx0XHRzdHlsZS53aGl0ZVNwYWNlID0gJ25vd3JhcCc7XHJcblxyXG5cdFx0dmFyIHdpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoO1xyXG5cdFx0d2lkdGggPSBNYXRoLm1pbih3aWR0aCwgdGhpcy5vcHRpb25zLm1heFdpZHRoKTtcclxuXHRcdHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIHRoaXMub3B0aW9ucy5taW5XaWR0aCk7XHJcblxyXG5cdFx0c3R5bGUud2lkdGggPSAod2lkdGggKyAxKSArICdweCc7XHJcblx0XHRzdHlsZS53aGl0ZVNwYWNlID0gJyc7XHJcblxyXG5cdFx0c3R5bGUuaGVpZ2h0ID0gJyc7XHJcblxyXG5cdFx0dmFyIGhlaWdodCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQsXHJcblx0XHQgICAgbWF4SGVpZ2h0ID0gdGhpcy5vcHRpb25zLm1heEhlaWdodCxcclxuXHRcdCAgICBzY3JvbGxlZENsYXNzID0gJ2xlYWZsZXQtcG9wdXAtc2Nyb2xsZWQnO1xyXG5cclxuXHRcdGlmIChtYXhIZWlnaHQgJiYgaGVpZ2h0ID4gbWF4SGVpZ2h0KSB7XHJcblx0XHRcdHN0eWxlLmhlaWdodCA9IG1heEhlaWdodCArICdweCc7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyhjb250YWluZXIsIHNjcm9sbGVkQ2xhc3MpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0TC5Eb21VdGlsLnJlbW92ZUNsYXNzKGNvbnRhaW5lciwgc2Nyb2xsZWRDbGFzcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fY29udGFpbmVyV2lkdGggPSB0aGlzLl9jb250YWluZXIub2Zmc2V0V2lkdGg7XHJcblx0fSxcclxuXHJcblx0X3VwZGF0ZVBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX21hcCkgeyByZXR1cm47IH1cclxuXHJcblx0XHR2YXIgcG9zID0gdGhpcy5fbWFwLmxhdExuZ1RvTGF5ZXJQb2ludCh0aGlzLl9sYXRsbmcpLFxyXG5cdFx0ICAgIGFuaW1hdGVkID0gdGhpcy5fYW5pbWF0ZWQsXHJcblx0XHQgICAgb2Zmc2V0ID0gTC5wb2ludCh0aGlzLm9wdGlvbnMub2Zmc2V0KTtcclxuXHJcblx0XHRpZiAoYW5pbWF0ZWQpIHtcclxuXHRcdFx0TC5Eb21VdGlsLnNldFBvc2l0aW9uKHRoaXMuX2NvbnRhaW5lciwgcG9zKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9jb250YWluZXJCb3R0b20gPSAtb2Zmc2V0LnkgLSAoYW5pbWF0ZWQgPyAwIDogcG9zLnkpO1xyXG5cdFx0dGhpcy5fY29udGFpbmVyTGVmdCA9IC1NYXRoLnJvdW5kKHRoaXMuX2NvbnRhaW5lcldpZHRoIC8gMikgKyBvZmZzZXQueCArIChhbmltYXRlZCA/IDAgOiBwb3MueCk7XHJcblxyXG5cdFx0Ly8gYm90dG9tIHBvc2l0aW9uIHRoZSBwb3B1cCBpbiBjYXNlIHRoZSBoZWlnaHQgb2YgdGhlIHBvcHVwIGNoYW5nZXMgKGltYWdlcyBsb2FkaW5nIGV0YylcclxuXHRcdHRoaXMuX2NvbnRhaW5lci5zdHlsZS5ib3R0b20gPSB0aGlzLl9jb250YWluZXJCb3R0b20gKyAncHgnO1xyXG5cdFx0dGhpcy5fY29udGFpbmVyLnN0eWxlLmxlZnQgPSB0aGlzLl9jb250YWluZXJMZWZ0ICsgJ3B4JztcclxuXHR9LFxyXG5cclxuXHRfem9vbUFuaW1hdGlvbjogZnVuY3Rpb24gKG9wdCkge1xyXG5cdFx0dmFyIHBvcyA9IHRoaXMuX21hcC5fbGF0TG5nVG9OZXdMYXllclBvaW50KHRoaXMuX2xhdGxuZywgb3B0Lnpvb20sIG9wdC5jZW50ZXIpO1xyXG5cclxuXHRcdEwuRG9tVXRpbC5zZXRQb3NpdGlvbih0aGlzLl9jb250YWluZXIsIHBvcyk7XHJcblx0fSxcclxuXHJcblx0X2FkanVzdFBhbjogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMuYXV0b1BhbikgeyByZXR1cm47IH1cclxuXHJcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwLFxyXG5cdFx0ICAgIGNvbnRhaW5lckhlaWdodCA9IHRoaXMuX2NvbnRhaW5lci5vZmZzZXRIZWlnaHQsXHJcblx0XHQgICAgY29udGFpbmVyV2lkdGggPSB0aGlzLl9jb250YWluZXJXaWR0aCxcclxuXHJcblx0XHQgICAgbGF5ZXJQb3MgPSBuZXcgTC5Qb2ludCh0aGlzLl9jb250YWluZXJMZWZ0LCAtY29udGFpbmVySGVpZ2h0IC0gdGhpcy5fY29udGFpbmVyQm90dG9tKTtcclxuXHJcblx0XHRpZiAodGhpcy5fYW5pbWF0ZWQpIHtcclxuXHRcdFx0bGF5ZXJQb3MuX2FkZChMLkRvbVV0aWwuZ2V0UG9zaXRpb24odGhpcy5fY29udGFpbmVyKSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGNvbnRhaW5lclBvcyA9IG1hcC5sYXllclBvaW50VG9Db250YWluZXJQb2ludChsYXllclBvcyksXHJcblx0XHQgICAgcGFkZGluZyA9IEwucG9pbnQodGhpcy5vcHRpb25zLmF1dG9QYW5QYWRkaW5nKSxcclxuXHRcdCAgICBwYWRkaW5nVEwgPSBMLnBvaW50KHRoaXMub3B0aW9ucy5hdXRvUGFuUGFkZGluZ1RvcExlZnQgfHwgcGFkZGluZyksXHJcblx0XHQgICAgcGFkZGluZ0JSID0gTC5wb2ludCh0aGlzLm9wdGlvbnMuYXV0b1BhblBhZGRpbmdCb3R0b21SaWdodCB8fCBwYWRkaW5nKSxcclxuXHRcdCAgICBzaXplID0gbWFwLmdldFNpemUoKSxcclxuXHRcdCAgICBkeCA9IDAsXHJcblx0XHQgICAgZHkgPSAwO1xyXG5cclxuXHRcdGlmIChjb250YWluZXJQb3MueCArIGNvbnRhaW5lcldpZHRoICsgcGFkZGluZ0JSLnggPiBzaXplLngpIHsgLy8gcmlnaHRcclxuXHRcdFx0ZHggPSBjb250YWluZXJQb3MueCArIGNvbnRhaW5lcldpZHRoIC0gc2l6ZS54ICsgcGFkZGluZ0JSLng7XHJcblx0XHR9XHJcblx0XHRpZiAoY29udGFpbmVyUG9zLnggLSBkeCAtIHBhZGRpbmdUTC54IDwgMCkgeyAvLyBsZWZ0XHJcblx0XHRcdGR4ID0gY29udGFpbmVyUG9zLnggLSBwYWRkaW5nVEwueDtcclxuXHRcdH1cclxuXHRcdGlmIChjb250YWluZXJQb3MueSArIGNvbnRhaW5lckhlaWdodCArIHBhZGRpbmdCUi55ID4gc2l6ZS55KSB7IC8vIGJvdHRvbVxyXG5cdFx0XHRkeSA9IGNvbnRhaW5lclBvcy55ICsgY29udGFpbmVySGVpZ2h0IC0gc2l6ZS55ICsgcGFkZGluZ0JSLnk7XHJcblx0XHR9XHJcblx0XHRpZiAoY29udGFpbmVyUG9zLnkgLSBkeSAtIHBhZGRpbmdUTC55IDwgMCkgeyAvLyB0b3BcclxuXHRcdFx0ZHkgPSBjb250YWluZXJQb3MueSAtIHBhZGRpbmdUTC55O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChkeCB8fCBkeSkge1xyXG5cdFx0XHRtYXBcclxuXHRcdFx0ICAgIC5maXJlKCdhdXRvcGFuc3RhcnQnKVxyXG5cdFx0XHQgICAgLnBhbkJ5KFtkeCwgZHldKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfb25DbG9zZUJ1dHRvbkNsaWNrOiBmdW5jdGlvbiAoZSkge1xyXG5cdFx0dGhpcy5fY2xvc2UoKTtcclxuXHRcdEwuRG9tRXZlbnQuc3RvcChlKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5wb3B1cCA9IGZ1bmN0aW9uIChvcHRpb25zLCBzb3VyY2UpIHtcclxuXHRyZXR1cm4gbmV3IEwuUG9wdXAob3B0aW9ucywgc291cmNlKTtcclxufTtcclxuXHJcblxyXG5MLk1hcC5pbmNsdWRlKHtcclxuXHRvcGVuUG9wdXA6IGZ1bmN0aW9uIChwb3B1cCwgbGF0bG5nLCBvcHRpb25zKSB7IC8vIChQb3B1cCkgb3IgKFN0cmluZyB8fCBIVE1MRWxlbWVudCwgTGF0TG5nWywgT2JqZWN0XSlcclxuXHRcdHRoaXMuY2xvc2VQb3B1cCgpO1xyXG5cclxuXHRcdGlmICghKHBvcHVwIGluc3RhbmNlb2YgTC5Qb3B1cCkpIHtcclxuXHRcdFx0dmFyIGNvbnRlbnQgPSBwb3B1cDtcclxuXHJcblx0XHRcdHBvcHVwID0gbmV3IEwuUG9wdXAob3B0aW9ucylcclxuXHRcdFx0ICAgIC5zZXRMYXRMbmcobGF0bG5nKVxyXG5cdFx0XHQgICAgLnNldENvbnRlbnQoY29udGVudCk7XHJcblx0XHR9XHJcblx0XHRwb3B1cC5faXNPcGVuID0gdHJ1ZTtcclxuXHJcblx0XHR0aGlzLl9wb3B1cCA9IHBvcHVwO1xyXG5cdFx0cmV0dXJuIHRoaXMuYWRkTGF5ZXIocG9wdXApO1xyXG5cdH0sXHJcblxyXG5cdGNsb3NlUG9wdXA6IGZ1bmN0aW9uIChwb3B1cCkge1xyXG5cdFx0aWYgKCFwb3B1cCB8fCBwb3B1cCA9PT0gdGhpcy5fcG9wdXApIHtcclxuXHRcdFx0cG9wdXAgPSB0aGlzLl9wb3B1cDtcclxuXHRcdFx0dGhpcy5fcG9wdXAgPSBudWxsO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHBvcHVwKSB7XHJcblx0XHRcdHRoaXMucmVtb3ZlTGF5ZXIocG9wdXApO1xyXG5cdFx0XHRwb3B1cC5faXNPcGVuID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcbn0pO1xyXG5cblxuLypcclxuICogUG9wdXAgZXh0ZW5zaW9uIHRvIEwuTWFya2VyLCBhZGRpbmcgcG9wdXAtcmVsYXRlZCBtZXRob2RzLlxyXG4gKi9cclxuXHJcbkwuTWFya2VyLmluY2x1ZGUoe1xyXG5cdG9wZW5Qb3B1cDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX3BvcHVwICYmIHRoaXMuX21hcCAmJiAhdGhpcy5fbWFwLmhhc0xheWVyKHRoaXMuX3BvcHVwKSkge1xyXG5cdFx0XHR0aGlzLl9wb3B1cC5zZXRMYXRMbmcodGhpcy5fbGF0bG5nKTtcclxuXHRcdFx0dGhpcy5fbWFwLm9wZW5Qb3B1cCh0aGlzLl9wb3B1cCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0Y2xvc2VQb3B1cDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX3BvcHVwKSB7XHJcblx0XHRcdHRoaXMuX3BvcHVwLl9jbG9zZSgpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0dG9nZ2xlUG9wdXA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLl9wb3B1cCkge1xyXG5cdFx0XHRpZiAodGhpcy5fcG9wdXAuX2lzT3Blbikge1xyXG5cdFx0XHRcdHRoaXMuY2xvc2VQb3B1cCgpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMub3BlblBvcHVwKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGJpbmRQb3B1cDogZnVuY3Rpb24gKGNvbnRlbnQsIG9wdGlvbnMpIHtcclxuXHRcdHZhciBhbmNob3IgPSBMLnBvaW50KHRoaXMub3B0aW9ucy5pY29uLm9wdGlvbnMucG9wdXBBbmNob3IgfHwgWzAsIDBdKTtcclxuXHJcblx0XHRhbmNob3IgPSBhbmNob3IuYWRkKEwuUG9wdXAucHJvdG90eXBlLm9wdGlvbnMub2Zmc2V0KTtcclxuXHJcblx0XHRpZiAob3B0aW9ucyAmJiBvcHRpb25zLm9mZnNldCkge1xyXG5cdFx0XHRhbmNob3IgPSBhbmNob3IuYWRkKG9wdGlvbnMub2Zmc2V0KTtcclxuXHRcdH1cclxuXHJcblx0XHRvcHRpb25zID0gTC5leHRlbmQoe29mZnNldDogYW5jaG9yfSwgb3B0aW9ucyk7XHJcblxyXG5cdFx0aWYgKCF0aGlzLl9wb3B1cEhhbmRsZXJzQWRkZWQpIHtcclxuXHRcdFx0dGhpc1xyXG5cdFx0XHQgICAgLm9uKCdjbGljaycsIHRoaXMudG9nZ2xlUG9wdXAsIHRoaXMpXHJcblx0XHRcdCAgICAub24oJ3JlbW92ZScsIHRoaXMuY2xvc2VQb3B1cCwgdGhpcylcclxuXHRcdFx0ICAgIC5vbignbW92ZScsIHRoaXMuX21vdmVQb3B1cCwgdGhpcyk7XHJcblx0XHRcdHRoaXMuX3BvcHVwSGFuZGxlcnNBZGRlZCA9IHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGNvbnRlbnQgaW5zdGFuY2VvZiBMLlBvcHVwKSB7XHJcblx0XHRcdEwuc2V0T3B0aW9ucyhjb250ZW50LCBvcHRpb25zKTtcclxuXHRcdFx0dGhpcy5fcG9wdXAgPSBjb250ZW50O1xyXG5cdFx0XHRjb250ZW50Ll9zb3VyY2UgPSB0aGlzO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5fcG9wdXAgPSBuZXcgTC5Qb3B1cChvcHRpb25zLCB0aGlzKVxyXG5cdFx0XHRcdC5zZXRDb250ZW50KGNvbnRlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHNldFBvcHVwQ29udGVudDogZnVuY3Rpb24gKGNvbnRlbnQpIHtcclxuXHRcdGlmICh0aGlzLl9wb3B1cCkge1xyXG5cdFx0XHR0aGlzLl9wb3B1cC5zZXRDb250ZW50KGNvbnRlbnQpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0dW5iaW5kUG9wdXA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLl9wb3B1cCkge1xyXG5cdFx0XHR0aGlzLl9wb3B1cCA9IG51bGw7XHJcblx0XHRcdHRoaXNcclxuXHRcdFx0ICAgIC5vZmYoJ2NsaWNrJywgdGhpcy50b2dnbGVQb3B1cCwgdGhpcylcclxuXHRcdFx0ICAgIC5vZmYoJ3JlbW92ZScsIHRoaXMuY2xvc2VQb3B1cCwgdGhpcylcclxuXHRcdFx0ICAgIC5vZmYoJ21vdmUnLCB0aGlzLl9tb3ZlUG9wdXAsIHRoaXMpO1xyXG5cdFx0XHR0aGlzLl9wb3B1cEhhbmRsZXJzQWRkZWQgPSBmYWxzZTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGdldFBvcHVwOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fcG9wdXA7XHJcblx0fSxcclxuXHJcblx0X21vdmVQb3B1cDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHRoaXMuX3BvcHVwLnNldExhdExuZyhlLmxhdGxuZyk7XHJcblx0fVxyXG59KTtcclxuXG5cbi8qXHJcbiAqIEwuTGF5ZXJHcm91cCBpcyBhIGNsYXNzIHRvIGNvbWJpbmUgc2V2ZXJhbCBsYXllcnMgaW50byBvbmUgc28gdGhhdFxyXG4gKiB5b3UgY2FuIG1hbmlwdWxhdGUgdGhlIGdyb3VwIChlLmcuIGFkZC9yZW1vdmUgaXQpIGFzIG9uZSBsYXllci5cclxuICovXHJcblxyXG5MLkxheWVyR3JvdXAgPSBMLkNsYXNzLmV4dGVuZCh7XHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKGxheWVycykge1xyXG5cdFx0dGhpcy5fbGF5ZXJzID0ge307XHJcblxyXG5cdFx0dmFyIGksIGxlbjtcclxuXHJcblx0XHRpZiAobGF5ZXJzKSB7XHJcblx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IGxheWVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRcdHRoaXMuYWRkTGF5ZXIobGF5ZXJzW2ldKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGFkZExheWVyOiBmdW5jdGlvbiAobGF5ZXIpIHtcclxuXHRcdHZhciBpZCA9IHRoaXMuZ2V0TGF5ZXJJZChsYXllcik7XHJcblxyXG5cdFx0dGhpcy5fbGF5ZXJzW2lkXSA9IGxheWVyO1xyXG5cclxuXHRcdGlmICh0aGlzLl9tYXApIHtcclxuXHRcdFx0dGhpcy5fbWFwLmFkZExheWVyKGxheWVyKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyZW1vdmVMYXllcjogZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHR2YXIgaWQgPSBsYXllciBpbiB0aGlzLl9sYXllcnMgPyBsYXllciA6IHRoaXMuZ2V0TGF5ZXJJZChsYXllcik7XHJcblxyXG5cdFx0aWYgKHRoaXMuX21hcCAmJiB0aGlzLl9sYXllcnNbaWRdKSB7XHJcblx0XHRcdHRoaXMuX21hcC5yZW1vdmVMYXllcih0aGlzLl9sYXllcnNbaWRdKTtcclxuXHRcdH1cclxuXHJcblx0XHRkZWxldGUgdGhpcy5fbGF5ZXJzW2lkXTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRoYXNMYXllcjogZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHRpZiAoIWxheWVyKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cclxuXHRcdHJldHVybiAobGF5ZXIgaW4gdGhpcy5fbGF5ZXJzIHx8IHRoaXMuZ2V0TGF5ZXJJZChsYXllcikgaW4gdGhpcy5fbGF5ZXJzKTtcclxuXHR9LFxyXG5cclxuXHRjbGVhckxheWVyczogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy5lYWNoTGF5ZXIodGhpcy5yZW1vdmVMYXllciwgdGhpcyk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRpbnZva2U6IGZ1bmN0aW9uIChtZXRob2ROYW1lKSB7XHJcblx0XHR2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSksXHJcblx0XHQgICAgaSwgbGF5ZXI7XHJcblxyXG5cdFx0Zm9yIChpIGluIHRoaXMuX2xheWVycykge1xyXG5cdFx0XHRsYXllciA9IHRoaXMuX2xheWVyc1tpXTtcclxuXHJcblx0XHRcdGlmIChsYXllclttZXRob2ROYW1lXSkge1xyXG5cdFx0XHRcdGxheWVyW21ldGhvZE5hbWVdLmFwcGx5KGxheWVyLCBhcmdzKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdG9uQWRkOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHR0aGlzLl9tYXAgPSBtYXA7XHJcblx0XHR0aGlzLmVhY2hMYXllcihtYXAuYWRkTGF5ZXIsIG1hcCk7XHJcblx0fSxcclxuXHJcblx0b25SZW1vdmU6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdHRoaXMuZWFjaExheWVyKG1hcC5yZW1vdmVMYXllciwgbWFwKTtcclxuXHRcdHRoaXMuX21hcCA9IG51bGw7XHJcblx0fSxcclxuXHJcblx0YWRkVG86IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcC5hZGRMYXllcih0aGlzKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGVhY2hMYXllcjogZnVuY3Rpb24gKG1ldGhvZCwgY29udGV4dCkge1xyXG5cdFx0Zm9yICh2YXIgaSBpbiB0aGlzLl9sYXllcnMpIHtcclxuXHRcdFx0bWV0aG9kLmNhbGwoY29udGV4dCwgdGhpcy5fbGF5ZXJzW2ldKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGdldExheWVyOiBmdW5jdGlvbiAoaWQpIHtcclxuXHRcdHJldHVybiB0aGlzLl9sYXllcnNbaWRdO1xyXG5cdH0sXHJcblxyXG5cdGdldExheWVyczogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGxheWVycyA9IFtdO1xyXG5cclxuXHRcdGZvciAodmFyIGkgaW4gdGhpcy5fbGF5ZXJzKSB7XHJcblx0XHRcdGxheWVycy5wdXNoKHRoaXMuX2xheWVyc1tpXSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbGF5ZXJzO1xyXG5cdH0sXHJcblxyXG5cdHNldFpJbmRleDogZnVuY3Rpb24gKHpJbmRleCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuaW52b2tlKCdzZXRaSW5kZXgnLCB6SW5kZXgpO1xyXG5cdH0sXHJcblxyXG5cdGdldExheWVySWQ6IGZ1bmN0aW9uIChsYXllcikge1xyXG5cdFx0cmV0dXJuIEwuc3RhbXAobGF5ZXIpO1xyXG5cdH1cclxufSk7XHJcblxyXG5MLmxheWVyR3JvdXAgPSBmdW5jdGlvbiAobGF5ZXJzKSB7XHJcblx0cmV0dXJuIG5ldyBMLkxheWVyR3JvdXAobGF5ZXJzKTtcclxufTtcclxuXG5cbi8qXHJcbiAqIEwuRmVhdHVyZUdyb3VwIGV4dGVuZHMgTC5MYXllckdyb3VwIGJ5IGludHJvZHVjaW5nIG1vdXNlIGV2ZW50cyBhbmQgYWRkaXRpb25hbCBtZXRob2RzXHJcbiAqIHNoYXJlZCBiZXR3ZWVuIGEgZ3JvdXAgb2YgaW50ZXJhY3RpdmUgbGF5ZXJzIChsaWtlIHZlY3RvcnMgb3IgbWFya2VycykuXHJcbiAqL1xyXG5cclxuTC5GZWF0dXJlR3JvdXAgPSBMLkxheWVyR3JvdXAuZXh0ZW5kKHtcclxuXHRpbmNsdWRlczogTC5NaXhpbi5FdmVudHMsXHJcblxyXG5cdHN0YXRpY3M6IHtcclxuXHRcdEVWRU5UUzogJ2NsaWNrIGRibGNsaWNrIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgY29udGV4dG1lbnUgcG9wdXBvcGVuIHBvcHVwY2xvc2UnXHJcblx0fSxcclxuXHJcblx0YWRkTGF5ZXI6IGZ1bmN0aW9uIChsYXllcikge1xyXG5cdFx0aWYgKHRoaXMuaGFzTGF5ZXIobGF5ZXIpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICgnb24nIGluIGxheWVyKSB7XHJcblx0XHRcdGxheWVyLm9uKEwuRmVhdHVyZUdyb3VwLkVWRU5UUywgdGhpcy5fcHJvcGFnYXRlRXZlbnQsIHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdEwuTGF5ZXJHcm91cC5wcm90b3R5cGUuYWRkTGF5ZXIuY2FsbCh0aGlzLCBsYXllcik7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3BvcHVwQ29udGVudCAmJiBsYXllci5iaW5kUG9wdXApIHtcclxuXHRcdFx0bGF5ZXIuYmluZFBvcHVwKHRoaXMuX3BvcHVwQ29udGVudCwgdGhpcy5fcG9wdXBPcHRpb25zKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5maXJlKCdsYXllcmFkZCcsIHtsYXllcjogbGF5ZXJ9KTtcclxuXHR9LFxyXG5cclxuXHRyZW1vdmVMYXllcjogZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHRpZiAoIXRoaXMuaGFzTGF5ZXIobGF5ZXIpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGxheWVyIGluIHRoaXMuX2xheWVycykge1xyXG5cdFx0XHRsYXllciA9IHRoaXMuX2xheWVyc1tsYXllcl07XHJcblx0XHR9XHJcblxyXG5cdFx0bGF5ZXIub2ZmKEwuRmVhdHVyZUdyb3VwLkVWRU5UUywgdGhpcy5fcHJvcGFnYXRlRXZlbnQsIHRoaXMpO1xyXG5cclxuXHRcdEwuTGF5ZXJHcm91cC5wcm90b3R5cGUucmVtb3ZlTGF5ZXIuY2FsbCh0aGlzLCBsYXllcik7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3BvcHVwQ29udGVudCkge1xyXG5cdFx0XHR0aGlzLmludm9rZSgndW5iaW5kUG9wdXAnKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5maXJlKCdsYXllcnJlbW92ZScsIHtsYXllcjogbGF5ZXJ9KTtcclxuXHR9LFxyXG5cclxuXHRiaW5kUG9wdXA6IGZ1bmN0aW9uIChjb250ZW50LCBvcHRpb25zKSB7XHJcblx0XHR0aGlzLl9wb3B1cENvbnRlbnQgPSBjb250ZW50O1xyXG5cdFx0dGhpcy5fcG9wdXBPcHRpb25zID0gb3B0aW9ucztcclxuXHRcdHJldHVybiB0aGlzLmludm9rZSgnYmluZFBvcHVwJywgY29udGVudCwgb3B0aW9ucyk7XHJcblx0fSxcclxuXHJcblx0b3BlblBvcHVwOiBmdW5jdGlvbiAobGF0bG5nKSB7XHJcblx0XHQvLyBvcGVuIHBvcHVwIG9uIHRoZSBmaXJzdCBsYXllclxyXG5cdFx0Zm9yICh2YXIgaWQgaW4gdGhpcy5fbGF5ZXJzKSB7XHJcblx0XHRcdHRoaXMuX2xheWVyc1tpZF0ub3BlblBvcHVwKGxhdGxuZyk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0c2V0U3R5bGU6IGZ1bmN0aW9uIChzdHlsZSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuaW52b2tlKCdzZXRTdHlsZScsIHN0eWxlKTtcclxuXHR9LFxyXG5cclxuXHRicmluZ1RvRnJvbnQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmludm9rZSgnYnJpbmdUb0Zyb250Jyk7XHJcblx0fSxcclxuXHJcblx0YnJpbmdUb0JhY2s6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLmludm9rZSgnYnJpbmdUb0JhY2snKTtcclxuXHR9LFxyXG5cclxuXHRnZXRCb3VuZHM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBib3VuZHMgPSBuZXcgTC5MYXRMbmdCb3VuZHMoKTtcclxuXHJcblx0XHR0aGlzLmVhY2hMYXllcihmdW5jdGlvbiAobGF5ZXIpIHtcclxuXHRcdFx0Ym91bmRzLmV4dGVuZChsYXllciBpbnN0YW5jZW9mIEwuTWFya2VyID8gbGF5ZXIuZ2V0TGF0TG5nKCkgOiBsYXllci5nZXRCb3VuZHMoKSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gYm91bmRzO1xyXG5cdH0sXHJcblxyXG5cdF9wcm9wYWdhdGVFdmVudDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdGUgPSBMLmV4dGVuZCh7XHJcblx0XHRcdGxheWVyOiBlLnRhcmdldCxcclxuXHRcdFx0dGFyZ2V0OiB0aGlzXHJcblx0XHR9LCBlKTtcclxuXHRcdHRoaXMuZmlyZShlLnR5cGUsIGUpO1xyXG5cdH1cclxufSk7XHJcblxyXG5MLmZlYXR1cmVHcm91cCA9IGZ1bmN0aW9uIChsYXllcnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuRmVhdHVyZUdyb3VwKGxheWVycyk7XHJcbn07XHJcblxuXG4vKlxyXG4gKiBMLlBhdGggaXMgYSBiYXNlIGNsYXNzIGZvciByZW5kZXJpbmcgdmVjdG9yIHBhdGhzIG9uIGEgbWFwLiBJbmhlcml0ZWQgYnkgUG9seWxpbmUsIENpcmNsZSwgZXRjLlxyXG4gKi9cclxuXHJcbkwuUGF0aCA9IEwuQ2xhc3MuZXh0ZW5kKHtcclxuXHRpbmNsdWRlczogW0wuTWl4aW4uRXZlbnRzXSxcclxuXHJcblx0c3RhdGljczoge1xyXG5cdFx0Ly8gaG93IG11Y2ggdG8gZXh0ZW5kIHRoZSBjbGlwIGFyZWEgYXJvdW5kIHRoZSBtYXAgdmlld1xyXG5cdFx0Ly8gKHJlbGF0aXZlIHRvIGl0cyBzaXplLCBlLmcuIDAuNSBpcyBoYWxmIHRoZSBzY3JlZW4gaW4gZWFjaCBkaXJlY3Rpb24pXHJcblx0XHQvLyBzZXQgaXQgc28gdGhhdCBTVkcgZWxlbWVudCBkb2Vzbid0IGV4Y2VlZCAxMjgwcHggKHZlY3RvcnMgZmxpY2tlciBvbiBkcmFnZW5kIGlmIGl0IGlzKVxyXG5cdFx0Q0xJUF9QQURESU5HOiAoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR2YXIgbWF4ID0gTC5Ccm93c2VyLm1vYmlsZSA/IDEyODAgOiAyMDAwLFxyXG5cdFx0XHQgICAgdGFyZ2V0ID0gKG1heCAvIE1hdGgubWF4KHdpbmRvdy5vdXRlcldpZHRoLCB3aW5kb3cub3V0ZXJIZWlnaHQpIC0gMSkgLyAyO1xyXG5cdFx0XHRyZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMC41LCB0YXJnZXQpKTtcclxuXHRcdH0pKClcclxuXHR9LFxyXG5cclxuXHRvcHRpb25zOiB7XHJcblx0XHRzdHJva2U6IHRydWUsXHJcblx0XHRjb2xvcjogJyMwMDMzZmYnLFxyXG5cdFx0ZGFzaEFycmF5OiBudWxsLFxyXG5cdFx0bGluZUNhcDogbnVsbCxcclxuXHRcdGxpbmVKb2luOiBudWxsLFxyXG5cdFx0d2VpZ2h0OiA1LFxyXG5cdFx0b3BhY2l0eTogMC41LFxyXG5cclxuXHRcdGZpbGw6IGZhbHNlLFxyXG5cdFx0ZmlsbENvbG9yOiBudWxsLCAvL3NhbWUgYXMgY29sb3IgYnkgZGVmYXVsdFxyXG5cdFx0ZmlsbE9wYWNpdHk6IDAuMixcclxuXHJcblx0XHRjbGlja2FibGU6IHRydWVcclxuXHR9LFxyXG5cclxuXHRpbml0aWFsaXplOiBmdW5jdGlvbiAob3B0aW9ucykge1xyXG5cdFx0TC5zZXRPcHRpb25zKHRoaXMsIG9wdGlvbnMpO1xyXG5cdH0sXHJcblxyXG5cdG9uQWRkOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHR0aGlzLl9tYXAgPSBtYXA7XHJcblxyXG5cdFx0aWYgKCF0aGlzLl9jb250YWluZXIpIHtcclxuXHRcdFx0dGhpcy5faW5pdEVsZW1lbnRzKCk7XHJcblx0XHRcdHRoaXMuX2luaXRFdmVudHMoKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnByb2plY3RMYXRsbmdzKCk7XHJcblx0XHR0aGlzLl91cGRhdGVQYXRoKCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2NvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLl9tYXAuX3BhdGhSb290LmFwcGVuZENoaWxkKHRoaXMuX2NvbnRhaW5lcik7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5maXJlKCdhZGQnKTtcclxuXHJcblx0XHRtYXAub24oe1xyXG5cdFx0XHQndmlld3Jlc2V0JzogdGhpcy5wcm9qZWN0TGF0bG5ncyxcclxuXHRcdFx0J21vdmVlbmQnOiB0aGlzLl91cGRhdGVQYXRoXHJcblx0XHR9LCB0aGlzKTtcclxuXHR9LFxyXG5cclxuXHRhZGRUbzogZnVuY3Rpb24gKG1hcCkge1xyXG5cdFx0bWFwLmFkZExheWVyKHRoaXMpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0b25SZW1vdmU6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcC5fcGF0aFJvb3QucmVtb3ZlQ2hpbGQodGhpcy5fY29udGFpbmVyKTtcclxuXHJcblx0XHQvLyBOZWVkIHRvIGZpcmUgcmVtb3ZlIGV2ZW50IGJlZm9yZSB3ZSBzZXQgX21hcCB0byBudWxsIGFzIHRoZSBldmVudCBob29rcyBtaWdodCBuZWVkIHRoZSBvYmplY3RcclxuXHRcdHRoaXMuZmlyZSgncmVtb3ZlJyk7XHJcblx0XHR0aGlzLl9tYXAgPSBudWxsO1xyXG5cclxuXHRcdGlmIChMLkJyb3dzZXIudm1sKSB7XHJcblx0XHRcdHRoaXMuX2NvbnRhaW5lciA9IG51bGw7XHJcblx0XHRcdHRoaXMuX3N0cm9rZSA9IG51bGw7XHJcblx0XHRcdHRoaXMuX2ZpbGwgPSBudWxsO1xyXG5cdFx0fVxyXG5cclxuXHRcdG1hcC5vZmYoe1xyXG5cdFx0XHQndmlld3Jlc2V0JzogdGhpcy5wcm9qZWN0TGF0bG5ncyxcclxuXHRcdFx0J21vdmVlbmQnOiB0aGlzLl91cGRhdGVQYXRoXHJcblx0XHR9LCB0aGlzKTtcclxuXHR9LFxyXG5cclxuXHRwcm9qZWN0TGF0bG5nczogZnVuY3Rpb24gKCkge1xyXG5cdFx0Ly8gZG8gYWxsIHByb2plY3Rpb24gc3R1ZmYgaGVyZVxyXG5cdH0sXHJcblxyXG5cdHNldFN0eWxlOiBmdW5jdGlvbiAoc3R5bGUpIHtcclxuXHRcdEwuc2V0T3B0aW9ucyh0aGlzLCBzdHlsZSk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2NvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLl91cGRhdGVTdHlsZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHJlZHJhdzogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX21hcCkge1xyXG5cdFx0XHR0aGlzLnByb2plY3RMYXRsbmdzKCk7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZVBhdGgoKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxufSk7XHJcblxyXG5MLk1hcC5pbmNsdWRlKHtcclxuXHRfdXBkYXRlUGF0aFZpZXdwb3J0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcCA9IEwuUGF0aC5DTElQX1BBRERJTkcsXHJcblx0XHQgICAgc2l6ZSA9IHRoaXMuZ2V0U2l6ZSgpLFxyXG5cdFx0ICAgIHBhbmVQb3MgPSBMLkRvbVV0aWwuZ2V0UG9zaXRpb24odGhpcy5fbWFwUGFuZSksXHJcblx0XHQgICAgbWluID0gcGFuZVBvcy5tdWx0aXBseUJ5KC0xKS5fc3VidHJhY3Qoc2l6ZS5tdWx0aXBseUJ5KHApLl9yb3VuZCgpKSxcclxuXHRcdCAgICBtYXggPSBtaW4uYWRkKHNpemUubXVsdGlwbHlCeSgxICsgcCAqIDIpLl9yb3VuZCgpKTtcclxuXHJcblx0XHR0aGlzLl9wYXRoVmlld3BvcnQgPSBuZXcgTC5Cb3VuZHMobWluLCBtYXgpO1xyXG5cdH1cclxufSk7XHJcblxuXG4vKlxyXG4gKiBFeHRlbmRzIEwuUGF0aCB3aXRoIFNWRy1zcGVjaWZpYyByZW5kZXJpbmcgY29kZS5cclxuICovXHJcblxyXG5MLlBhdGguU1ZHX05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJztcclxuXHJcbkwuQnJvd3Nlci5zdmcgPSAhIShkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMgJiYgZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKEwuUGF0aC5TVkdfTlMsICdzdmcnKS5jcmVhdGVTVkdSZWN0KTtcclxuXHJcbkwuUGF0aCA9IEwuUGF0aC5leHRlbmQoe1xyXG5cdHN0YXRpY3M6IHtcclxuXHRcdFNWRzogTC5Ccm93c2VyLnN2Z1xyXG5cdH0sXHJcblxyXG5cdGJyaW5nVG9Gcm9udDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzLl9tYXAuX3BhdGhSb290LFxyXG5cdFx0ICAgIHBhdGggPSB0aGlzLl9jb250YWluZXI7XHJcblxyXG5cdFx0aWYgKHBhdGggJiYgcm9vdC5sYXN0Q2hpbGQgIT09IHBhdGgpIHtcclxuXHRcdFx0cm9vdC5hcHBlbmRDaGlsZChwYXRoKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGJyaW5nVG9CYWNrOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXMuX21hcC5fcGF0aFJvb3QsXHJcblx0XHQgICAgcGF0aCA9IHRoaXMuX2NvbnRhaW5lcixcclxuXHRcdCAgICBmaXJzdCA9IHJvb3QuZmlyc3RDaGlsZDtcclxuXHJcblx0XHRpZiAocGF0aCAmJiBmaXJzdCAhPT0gcGF0aCkge1xyXG5cdFx0XHRyb290Lmluc2VydEJlZm9yZShwYXRoLCBmaXJzdCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRnZXRQYXRoU3RyaW5nOiBmdW5jdGlvbiAoKSB7XHJcblx0XHQvLyBmb3JtIHBhdGggc3RyaW5nIGhlcmVcclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlRWxlbWVudDogZnVuY3Rpb24gKG5hbWUpIHtcclxuXHRcdHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoTC5QYXRoLlNWR19OUywgbmFtZSk7XHJcblx0fSxcclxuXHJcblx0X2luaXRFbGVtZW50czogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy5fbWFwLl9pbml0UGF0aFJvb3QoKTtcclxuXHRcdHRoaXMuX2luaXRQYXRoKCk7XHJcblx0XHR0aGlzLl9pbml0U3R5bGUoKTtcclxuXHR9LFxyXG5cclxuXHRfaW5pdFBhdGg6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuX2NvbnRhaW5lciA9IHRoaXMuX2NyZWF0ZUVsZW1lbnQoJ2cnKTtcclxuXHJcblx0XHR0aGlzLl9wYXRoID0gdGhpcy5fY3JlYXRlRWxlbWVudCgncGF0aCcpO1xyXG5cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuY2xhc3NOYW1lKSB7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9wYXRoLCB0aGlzLm9wdGlvbnMuY2xhc3NOYW1lKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5fcGF0aCk7XHJcblx0fSxcclxuXHJcblx0X2luaXRTdHlsZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5zdHJva2UpIHtcclxuXHRcdFx0dGhpcy5fcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpO1xyXG5cdFx0XHR0aGlzLl9wYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCAncm91bmQnKTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuZmlsbCkge1xyXG5cdFx0XHR0aGlzLl9wYXRoLnNldEF0dHJpYnV0ZSgnZmlsbC1ydWxlJywgJ2V2ZW5vZGQnKTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMucG9pbnRlckV2ZW50cykge1xyXG5cdFx0XHR0aGlzLl9wYXRoLnNldEF0dHJpYnV0ZSgncG9pbnRlci1ldmVudHMnLCB0aGlzLm9wdGlvbnMucG9pbnRlckV2ZW50cyk7XHJcblx0XHR9XHJcblx0XHRpZiAoIXRoaXMub3B0aW9ucy5jbGlja2FibGUgJiYgIXRoaXMub3B0aW9ucy5wb2ludGVyRXZlbnRzKSB7XHJcblx0XHRcdHRoaXMuX3BhdGguc2V0QXR0cmlidXRlKCdwb2ludGVyLWV2ZW50cycsICdub25lJyk7XHJcblx0XHR9XHJcblx0XHR0aGlzLl91cGRhdGVTdHlsZSgpO1xyXG5cdH0sXHJcblxyXG5cdF91cGRhdGVTdHlsZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5zdHJva2UpIHtcclxuXHRcdFx0dGhpcy5fcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsIHRoaXMub3B0aW9ucy5jb2xvcik7XHJcblx0XHRcdHRoaXMuX3BhdGguc2V0QXR0cmlidXRlKCdzdHJva2Utb3BhY2l0eScsIHRoaXMub3B0aW9ucy5vcGFjaXR5KTtcclxuXHRcdFx0dGhpcy5fcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsIHRoaXMub3B0aW9ucy53ZWlnaHQpO1xyXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLmRhc2hBcnJheSkge1xyXG5cdFx0XHRcdHRoaXMuX3BhdGguc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaGFycmF5JywgdGhpcy5vcHRpb25zLmRhc2hBcnJheSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5fcGF0aC5yZW1vdmVBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNoYXJyYXknKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLmxpbmVDYXApIHtcclxuXHRcdFx0XHR0aGlzLl9wYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCB0aGlzLm9wdGlvbnMubGluZUNhcCk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5saW5lSm9pbikge1xyXG5cdFx0XHRcdHRoaXMuX3BhdGguc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCB0aGlzLm9wdGlvbnMubGluZUpvaW4pO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLl9wYXRoLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ25vbmUnKTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuZmlsbCkge1xyXG5cdFx0XHR0aGlzLl9wYXRoLnNldEF0dHJpYnV0ZSgnZmlsbCcsIHRoaXMub3B0aW9ucy5maWxsQ29sb3IgfHwgdGhpcy5vcHRpb25zLmNvbG9yKTtcclxuXHRcdFx0dGhpcy5fcGF0aC5zZXRBdHRyaWJ1dGUoJ2ZpbGwtb3BhY2l0eScsIHRoaXMub3B0aW9ucy5maWxsT3BhY2l0eSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLl9wYXRoLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X3VwZGF0ZVBhdGg6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBzdHIgPSB0aGlzLmdldFBhdGhTdHJpbmcoKTtcclxuXHRcdGlmICghc3RyKSB7XHJcblx0XHRcdC8vIGZpeCB3ZWJraXQgZW1wdHkgc3RyaW5nIHBhcnNpbmcgYnVnXHJcblx0XHRcdHN0ciA9ICdNMCAwJztcclxuXHRcdH1cclxuXHRcdHRoaXMuX3BhdGguc2V0QXR0cmlidXRlKCdkJywgc3RyKTtcclxuXHR9LFxyXG5cclxuXHQvLyBUT0RPIHJlbW92ZSBkdXBsaWNhdGlvbiB3aXRoIEwuTWFwXHJcblx0X2luaXRFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuY2xpY2thYmxlKSB7XHJcblx0XHRcdGlmIChMLkJyb3dzZXIuc3ZnIHx8ICFMLkJyb3dzZXIudm1sKSB7XHJcblx0XHRcdFx0TC5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX3BhdGgsICdsZWFmbGV0LWNsaWNrYWJsZScpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRMLkRvbUV2ZW50Lm9uKHRoaXMuX2NvbnRhaW5lciwgJ2NsaWNrJywgdGhpcy5fb25Nb3VzZUNsaWNrLCB0aGlzKTtcclxuXHJcblx0XHRcdHZhciBldmVudHMgPSBbJ2RibGNsaWNrJywgJ21vdXNlZG93bicsICdtb3VzZW92ZXInLFxyXG5cdFx0XHQgICAgICAgICAgICAgICdtb3VzZW91dCcsICdtb3VzZW1vdmUnLCAnY29udGV4dG1lbnUnXTtcclxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRMLkRvbUV2ZW50Lm9uKHRoaXMuX2NvbnRhaW5lciwgZXZlbnRzW2ldLCB0aGlzLl9maXJlTW91c2VFdmVudCwgdGhpcyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfb25Nb3VzZUNsaWNrOiBmdW5jdGlvbiAoZSkge1xyXG5cdFx0aWYgKHRoaXMuX21hcC5kcmFnZ2luZyAmJiB0aGlzLl9tYXAuZHJhZ2dpbmcubW92ZWQoKSkgeyByZXR1cm47IH1cclxuXHJcblx0XHR0aGlzLl9maXJlTW91c2VFdmVudChlKTtcclxuXHR9LFxyXG5cclxuXHRfZmlyZU1vdXNlRXZlbnQ6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRpZiAoIXRoaXMuaGFzRXZlbnRMaXN0ZW5lcnMoZS50eXBlKSkgeyByZXR1cm47IH1cclxuXHJcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwLFxyXG5cdFx0ICAgIGNvbnRhaW5lclBvaW50ID0gbWFwLm1vdXNlRXZlbnRUb0NvbnRhaW5lclBvaW50KGUpLFxyXG5cdFx0ICAgIGxheWVyUG9pbnQgPSBtYXAuY29udGFpbmVyUG9pbnRUb0xheWVyUG9pbnQoY29udGFpbmVyUG9pbnQpLFxyXG5cdFx0ICAgIGxhdGxuZyA9IG1hcC5sYXllclBvaW50VG9MYXRMbmcobGF5ZXJQb2ludCk7XHJcblxyXG5cdFx0dGhpcy5maXJlKGUudHlwZSwge1xyXG5cdFx0XHRsYXRsbmc6IGxhdGxuZyxcclxuXHRcdFx0bGF5ZXJQb2ludDogbGF5ZXJQb2ludCxcclxuXHRcdFx0Y29udGFpbmVyUG9pbnQ6IGNvbnRhaW5lclBvaW50LFxyXG5cdFx0XHRvcmlnaW5hbEV2ZW50OiBlXHJcblx0XHR9KTtcclxuXHJcblx0XHRpZiAoZS50eXBlID09PSAnY29udGV4dG1lbnUnKSB7XHJcblx0XHRcdEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQoZSk7XHJcblx0XHR9XHJcblx0XHRpZiAoZS50eXBlICE9PSAnbW91c2Vtb3ZlJykge1xyXG5cdFx0XHRMLkRvbUV2ZW50LnN0b3BQcm9wYWdhdGlvbihlKTtcclxuXHRcdH1cclxuXHR9XHJcbn0pO1xyXG5cclxuTC5NYXAuaW5jbHVkZSh7XHJcblx0X2luaXRQYXRoUm9vdDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKCF0aGlzLl9wYXRoUm9vdCkge1xyXG5cdFx0XHR0aGlzLl9wYXRoUm9vdCA9IEwuUGF0aC5wcm90b3R5cGUuX2NyZWF0ZUVsZW1lbnQoJ3N2ZycpO1xyXG5cdFx0XHR0aGlzLl9wYW5lcy5vdmVybGF5UGFuZS5hcHBlbmRDaGlsZCh0aGlzLl9wYXRoUm9vdCk7XHJcblxyXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnpvb21BbmltYXRpb24gJiYgTC5Ccm93c2VyLmFueTNkKSB7XHJcblx0XHRcdFx0TC5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX3BhdGhSb290LCAnbGVhZmxldC16b29tLWFuaW1hdGVkJyk7XHJcblxyXG5cdFx0XHRcdHRoaXMub24oe1xyXG5cdFx0XHRcdFx0J3pvb21hbmltJzogdGhpcy5fYW5pbWF0ZVBhdGhab29tLFxyXG5cdFx0XHRcdFx0J3pvb21lbmQnOiB0aGlzLl9lbmRQYXRoWm9vbVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9wYXRoUm9vdCwgJ2xlYWZsZXQtem9vbS1oaWRlJyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMub24oJ21vdmVlbmQnLCB0aGlzLl91cGRhdGVTdmdWaWV3cG9ydCk7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZVN2Z1ZpZXdwb3J0KCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2FuaW1hdGVQYXRoWm9vbTogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciBzY2FsZSA9IHRoaXMuZ2V0Wm9vbVNjYWxlKGUuem9vbSksXHJcblx0XHQgICAgb2Zmc2V0ID0gdGhpcy5fZ2V0Q2VudGVyT2Zmc2V0KGUuY2VudGVyKS5fbXVsdGlwbHlCeSgtc2NhbGUpLl9hZGQodGhpcy5fcGF0aFZpZXdwb3J0Lm1pbik7XHJcblxyXG5cdFx0dGhpcy5fcGF0aFJvb3Quc3R5bGVbTC5Eb21VdGlsLlRSQU5TRk9STV0gPVxyXG5cdFx0ICAgICAgICBMLkRvbVV0aWwuZ2V0VHJhbnNsYXRlU3RyaW5nKG9mZnNldCkgKyAnIHNjYWxlKCcgKyBzY2FsZSArICcpICc7XHJcblxyXG5cdFx0dGhpcy5fcGF0aFpvb21pbmcgPSB0cnVlO1xyXG5cdH0sXHJcblxyXG5cdF9lbmRQYXRoWm9vbTogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy5fcGF0aFpvb21pbmcgPSBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlU3ZnVmlld3BvcnQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRpZiAodGhpcy5fcGF0aFpvb21pbmcpIHtcclxuXHRcdFx0Ly8gRG8gbm90IHVwZGF0ZSBTVkdzIHdoaWxlIGEgem9vbSBhbmltYXRpb24gaXMgZ29pbmcgb24gb3RoZXJ3aXNlIHRoZSBhbmltYXRpb24gd2lsbCBicmVhay5cclxuXHRcdFx0Ly8gV2hlbiB0aGUgem9vbSBhbmltYXRpb24gZW5kcyB3ZSB3aWxsIGJlIHVwZGF0ZWQgYWdhaW4gYW55d2F5XHJcblx0XHRcdC8vIFRoaXMgZml4ZXMgdGhlIGNhc2Ugd2hlcmUgeW91IGRvIGEgbW9tZW50dW0gbW92ZSBhbmQgem9vbSB3aGlsZSB0aGUgbW92ZSBpcyBzdGlsbCBvbmdvaW5nLlxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fdXBkYXRlUGF0aFZpZXdwb3J0KCk7XHJcblxyXG5cdFx0dmFyIHZwID0gdGhpcy5fcGF0aFZpZXdwb3J0LFxyXG5cdFx0ICAgIG1pbiA9IHZwLm1pbixcclxuXHRcdCAgICBtYXggPSB2cC5tYXgsXHJcblx0XHQgICAgd2lkdGggPSBtYXgueCAtIG1pbi54LFxyXG5cdFx0ICAgIGhlaWdodCA9IG1heC55IC0gbWluLnksXHJcblx0XHQgICAgcm9vdCA9IHRoaXMuX3BhdGhSb290LFxyXG5cdFx0ICAgIHBhbmUgPSB0aGlzLl9wYW5lcy5vdmVybGF5UGFuZTtcclxuXHJcblx0XHQvLyBIYWNrIHRvIG1ha2UgZmxpY2tlciBvbiBkcmFnIGVuZCBvbiBtb2JpbGUgd2Via2l0IGxlc3MgaXJyaXRhdGluZ1xyXG5cdFx0aWYgKEwuQnJvd3Nlci5tb2JpbGVXZWJraXQpIHtcclxuXHRcdFx0cGFuZS5yZW1vdmVDaGlsZChyb290KTtcclxuXHRcdH1cclxuXHJcblx0XHRMLkRvbVV0aWwuc2V0UG9zaXRpb24ocm9vdCwgbWluKTtcclxuXHRcdHJvb3Quc2V0QXR0cmlidXRlKCd3aWR0aCcsIHdpZHRoKTtcclxuXHRcdHJvb3Quc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBoZWlnaHQpO1xyXG5cdFx0cm9vdC5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCBbbWluLngsIG1pbi55LCB3aWR0aCwgaGVpZ2h0XS5qb2luKCcgJykpO1xyXG5cclxuXHRcdGlmIChMLkJyb3dzZXIubW9iaWxlV2Via2l0KSB7XHJcblx0XHRcdHBhbmUuYXBwZW5kQ2hpbGQocm9vdCk7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXG5cbi8qXHJcbiAqIFBvcHVwIGV4dGVuc2lvbiB0byBMLlBhdGggKHBvbHlsaW5lcywgcG9seWdvbnMsIGNpcmNsZXMpLCBhZGRpbmcgcG9wdXAtcmVsYXRlZCBtZXRob2RzLlxyXG4gKi9cclxuXHJcbkwuUGF0aC5pbmNsdWRlKHtcclxuXHJcblx0YmluZFBvcHVwOiBmdW5jdGlvbiAoY29udGVudCwgb3B0aW9ucykge1xyXG5cclxuXHRcdGlmIChjb250ZW50IGluc3RhbmNlb2YgTC5Qb3B1cCkge1xyXG5cdFx0XHR0aGlzLl9wb3B1cCA9IGNvbnRlbnQ7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpZiAoIXRoaXMuX3BvcHVwIHx8IG9wdGlvbnMpIHtcclxuXHRcdFx0XHR0aGlzLl9wb3B1cCA9IG5ldyBMLlBvcHVwKG9wdGlvbnMsIHRoaXMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuX3BvcHVwLnNldENvbnRlbnQoY29udGVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCF0aGlzLl9wb3B1cEhhbmRsZXJzQWRkZWQpIHtcclxuXHRcdFx0dGhpc1xyXG5cdFx0XHQgICAgLm9uKCdjbGljaycsIHRoaXMuX29wZW5Qb3B1cCwgdGhpcylcclxuXHRcdFx0ICAgIC5vbigncmVtb3ZlJywgdGhpcy5jbG9zZVBvcHVwLCB0aGlzKTtcclxuXHJcblx0XHRcdHRoaXMuX3BvcHVwSGFuZGxlcnNBZGRlZCA9IHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0dW5iaW5kUG9wdXA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLl9wb3B1cCkge1xyXG5cdFx0XHR0aGlzLl9wb3B1cCA9IG51bGw7XHJcblx0XHRcdHRoaXNcclxuXHRcdFx0ICAgIC5vZmYoJ2NsaWNrJywgdGhpcy5fb3BlblBvcHVwKVxyXG5cdFx0XHQgICAgLm9mZigncmVtb3ZlJywgdGhpcy5jbG9zZVBvcHVwKTtcclxuXHJcblx0XHRcdHRoaXMuX3BvcHVwSGFuZGxlcnNBZGRlZCA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0b3BlblBvcHVwOiBmdW5jdGlvbiAobGF0bG5nKSB7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3BvcHVwKSB7XHJcblx0XHRcdC8vIG9wZW4gdGhlIHBvcHVwIGZyb20gb25lIG9mIHRoZSBwYXRoJ3MgcG9pbnRzIGlmIG5vdCBzcGVjaWZpZWRcclxuXHRcdFx0bGF0bG5nID0gbGF0bG5nIHx8IHRoaXMuX2xhdGxuZyB8fFxyXG5cdFx0XHQgICAgICAgICB0aGlzLl9sYXRsbmdzW01hdGguZmxvb3IodGhpcy5fbGF0bG5ncy5sZW5ndGggLyAyKV07XHJcblxyXG5cdFx0XHR0aGlzLl9vcGVuUG9wdXAoe2xhdGxuZzogbGF0bG5nfSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0Y2xvc2VQb3B1cDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX3BvcHVwKSB7XHJcblx0XHRcdHRoaXMuX3BvcHVwLl9jbG9zZSgpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X29wZW5Qb3B1cDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHRoaXMuX3BvcHVwLnNldExhdExuZyhlLmxhdGxuZyk7XHJcblx0XHR0aGlzLl9tYXAub3BlblBvcHVwKHRoaXMuX3BvcHVwKTtcclxuXHR9XHJcbn0pO1xyXG5cblxuLypcclxuICogVmVjdG9yIHJlbmRlcmluZyBmb3IgSUU2LTggdGhyb3VnaCBWTUwuXHJcbiAqIFRoYW5rcyB0byBEbWl0cnkgQmFyYW5vdnNreSBhbmQgaGlzIFJhcGhhZWwgbGlicmFyeSBmb3IgaW5zcGlyYXRpb24hXHJcbiAqL1xyXG5cclxuTC5Ccm93c2VyLnZtbCA9ICFMLkJyb3dzZXIuc3ZnICYmIChmdW5jdGlvbiAoKSB7XHJcblx0dHJ5IHtcclxuXHRcdHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdGRpdi5pbm5lckhUTUwgPSAnPHY6c2hhcGUgYWRqPVwiMVwiLz4nO1xyXG5cclxuXHRcdHZhciBzaGFwZSA9IGRpdi5maXJzdENoaWxkO1xyXG5cdFx0c2hhcGUuc3R5bGUuYmVoYXZpb3IgPSAndXJsKCNkZWZhdWx0I1ZNTCknO1xyXG5cclxuXHRcdHJldHVybiBzaGFwZSAmJiAodHlwZW9mIHNoYXBlLmFkaiA9PT0gJ29iamVjdCcpO1xyXG5cclxuXHR9IGNhdGNoIChlKSB7XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fVxyXG59KCkpO1xyXG5cclxuTC5QYXRoID0gTC5Ccm93c2VyLnN2ZyB8fCAhTC5Ccm93c2VyLnZtbCA/IEwuUGF0aCA6IEwuUGF0aC5leHRlbmQoe1xyXG5cdHN0YXRpY3M6IHtcclxuXHRcdFZNTDogdHJ1ZSxcclxuXHRcdENMSVBfUEFERElORzogMC4wMlxyXG5cdH0sXHJcblxyXG5cdF9jcmVhdGVFbGVtZW50OiAoZnVuY3Rpb24gKCkge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0ZG9jdW1lbnQubmFtZXNwYWNlcy5hZGQoJ2x2bWwnLCAndXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWwnKTtcclxuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uIChuYW1lKSB7XHJcblx0XHRcdFx0cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJzxsdm1sOicgKyBuYW1lICsgJyBjbGFzcz1cImx2bWxcIj4nKTtcclxuXHRcdFx0fTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uIChuYW1lKSB7XHJcblx0XHRcdFx0cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXHJcblx0XHRcdFx0ICAgICAgICAnPCcgKyBuYW1lICsgJyB4bWxucz1cInVybjpzY2hlbWFzLW1pY3Jvc29mdC5jb206dm1sXCIgY2xhc3M9XCJsdm1sXCI+Jyk7XHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0fSgpKSxcclxuXHJcblx0X2luaXRQYXRoOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgY29udGFpbmVyID0gdGhpcy5fY29udGFpbmVyID0gdGhpcy5fY3JlYXRlRWxlbWVudCgnc2hhcGUnKTtcclxuXHJcblx0XHRMLkRvbVV0aWwuYWRkQ2xhc3MoY29udGFpbmVyLCAnbGVhZmxldC12bWwtc2hhcGUnICtcclxuXHRcdFx0KHRoaXMub3B0aW9ucy5jbGFzc05hbWUgPyAnICcgKyB0aGlzLm9wdGlvbnMuY2xhc3NOYW1lIDogJycpKTtcclxuXHJcblx0XHRpZiAodGhpcy5vcHRpb25zLmNsaWNrYWJsZSkge1xyXG5cdFx0XHRMLkRvbVV0aWwuYWRkQ2xhc3MoY29udGFpbmVyLCAnbGVhZmxldC1jbGlja2FibGUnKTtcclxuXHRcdH1cclxuXHJcblx0XHRjb250YWluZXIuY29vcmRzaXplID0gJzEgMSc7XHJcblxyXG5cdFx0dGhpcy5fcGF0aCA9IHRoaXMuX2NyZWF0ZUVsZW1lbnQoJ3BhdGgnKTtcclxuXHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLl9wYXRoKTtcclxuXHJcblx0XHR0aGlzLl9tYXAuX3BhdGhSb290LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XHJcblx0fSxcclxuXHJcblx0X2luaXRTdHlsZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy5fdXBkYXRlU3R5bGUoKTtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlU3R5bGU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBzdHJva2UgPSB0aGlzLl9zdHJva2UsXHJcblx0XHQgICAgZmlsbCA9IHRoaXMuX2ZpbGwsXHJcblx0XHQgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcclxuXHRcdCAgICBjb250YWluZXIgPSB0aGlzLl9jb250YWluZXI7XHJcblxyXG5cdFx0Y29udGFpbmVyLnN0cm9rZWQgPSBvcHRpb25zLnN0cm9rZTtcclxuXHRcdGNvbnRhaW5lci5maWxsZWQgPSBvcHRpb25zLmZpbGw7XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuc3Ryb2tlKSB7XHJcblx0XHRcdGlmICghc3Ryb2tlKSB7XHJcblx0XHRcdFx0c3Ryb2tlID0gdGhpcy5fc3Ryb2tlID0gdGhpcy5fY3JlYXRlRWxlbWVudCgnc3Ryb2tlJyk7XHJcblx0XHRcdFx0c3Ryb2tlLmVuZGNhcCA9ICdyb3VuZCc7XHJcblx0XHRcdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHN0cm9rZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0c3Ryb2tlLndlaWdodCA9IG9wdGlvbnMud2VpZ2h0ICsgJ3B4JztcclxuXHRcdFx0c3Ryb2tlLmNvbG9yID0gb3B0aW9ucy5jb2xvcjtcclxuXHRcdFx0c3Ryb2tlLm9wYWNpdHkgPSBvcHRpb25zLm9wYWNpdHk7XHJcblxyXG5cdFx0XHRpZiAob3B0aW9ucy5kYXNoQXJyYXkpIHtcclxuXHRcdFx0XHRzdHJva2UuZGFzaFN0eWxlID0gTC5VdGlsLmlzQXJyYXkob3B0aW9ucy5kYXNoQXJyYXkpID9cclxuXHRcdFx0XHQgICAgb3B0aW9ucy5kYXNoQXJyYXkuam9pbignICcpIDpcclxuXHRcdFx0XHQgICAgb3B0aW9ucy5kYXNoQXJyYXkucmVwbGFjZSgvKCAqLCAqKS9nLCAnICcpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHN0cm9rZS5kYXNoU3R5bGUgPSAnJztcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAob3B0aW9ucy5saW5lQ2FwKSB7XHJcblx0XHRcdFx0c3Ryb2tlLmVuZGNhcCA9IG9wdGlvbnMubGluZUNhcC5yZXBsYWNlKCdidXR0JywgJ2ZsYXQnKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAob3B0aW9ucy5saW5lSm9pbikge1xyXG5cdFx0XHRcdHN0cm9rZS5qb2luc3R5bGUgPSBvcHRpb25zLmxpbmVKb2luO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0fSBlbHNlIGlmIChzdHJva2UpIHtcclxuXHRcdFx0Y29udGFpbmVyLnJlbW92ZUNoaWxkKHN0cm9rZSk7XHJcblx0XHRcdHRoaXMuX3N0cm9rZSA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuZmlsbCkge1xyXG5cdFx0XHRpZiAoIWZpbGwpIHtcclxuXHRcdFx0XHRmaWxsID0gdGhpcy5fZmlsbCA9IHRoaXMuX2NyZWF0ZUVsZW1lbnQoJ2ZpbGwnKTtcclxuXHRcdFx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQoZmlsbCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZmlsbC5jb2xvciA9IG9wdGlvbnMuZmlsbENvbG9yIHx8IG9wdGlvbnMuY29sb3I7XHJcblx0XHRcdGZpbGwub3BhY2l0eSA9IG9wdGlvbnMuZmlsbE9wYWNpdHk7XHJcblxyXG5cdFx0fSBlbHNlIGlmIChmaWxsKSB7XHJcblx0XHRcdGNvbnRhaW5lci5yZW1vdmVDaGlsZChmaWxsKTtcclxuXHRcdFx0dGhpcy5fZmlsbCA9IG51bGw7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X3VwZGF0ZVBhdGg6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBzdHlsZSA9IHRoaXMuX2NvbnRhaW5lci5zdHlsZTtcclxuXHJcblx0XHRzdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG5cdFx0dGhpcy5fcGF0aC52ID0gdGhpcy5nZXRQYXRoU3RyaW5nKCkgKyAnICc7IC8vIHRoZSBzcGFjZSBmaXhlcyBJRSBlbXB0eSBwYXRoIHN0cmluZyBidWdcclxuXHRcdHN0eWxlLmRpc3BsYXkgPSAnJztcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5NYXAuaW5jbHVkZShMLkJyb3dzZXIuc3ZnIHx8ICFMLkJyb3dzZXIudm1sID8ge30gOiB7XHJcblx0X2luaXRQYXRoUm9vdDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX3BhdGhSb290KSB7IHJldHVybjsgfVxyXG5cclxuXHRcdHZhciByb290ID0gdGhpcy5fcGF0aFJvb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdHJvb3QuY2xhc3NOYW1lID0gJ2xlYWZsZXQtdm1sLWNvbnRhaW5lcic7XHJcblx0XHR0aGlzLl9wYW5lcy5vdmVybGF5UGFuZS5hcHBlbmRDaGlsZChyb290KTtcclxuXHJcblx0XHR0aGlzLm9uKCdtb3ZlZW5kJywgdGhpcy5fdXBkYXRlUGF0aFZpZXdwb3J0KTtcclxuXHRcdHRoaXMuX3VwZGF0ZVBhdGhWaWV3cG9ydCgpO1xyXG5cdH1cclxufSk7XHJcblxuXG4vKlxyXG4gKiBWZWN0b3IgcmVuZGVyaW5nIGZvciBhbGwgYnJvd3NlcnMgdGhhdCBzdXBwb3J0IGNhbnZhcy5cclxuICovXHJcblxyXG5MLkJyb3dzZXIuY2FudmFzID0gKGZ1bmN0aW9uICgpIHtcclxuXHRyZXR1cm4gISFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKS5nZXRDb250ZXh0O1xyXG59KCkpO1xyXG5cclxuTC5QYXRoID0gKEwuUGF0aC5TVkcgJiYgIXdpbmRvdy5MX1BSRUZFUl9DQU5WQVMpIHx8ICFMLkJyb3dzZXIuY2FudmFzID8gTC5QYXRoIDogTC5QYXRoLmV4dGVuZCh7XHJcblx0c3RhdGljczoge1xyXG5cdFx0Ly9DTElQX1BBRERJTkc6IDAuMDIsIC8vIG5vdCBzdXJlIGlmIHRoZXJlJ3MgYSBuZWVkIHRvIHNldCBpdCB0byBhIHNtYWxsIHZhbHVlXHJcblx0XHRDQU5WQVM6IHRydWUsXHJcblx0XHRTVkc6IGZhbHNlXHJcblx0fSxcclxuXHJcblx0cmVkcmF3OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAodGhpcy5fbWFwKSB7XHJcblx0XHRcdHRoaXMucHJvamVjdExhdGxuZ3MoKTtcclxuXHRcdFx0dGhpcy5fcmVxdWVzdFVwZGF0ZSgpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0c2V0U3R5bGU6IGZ1bmN0aW9uIChzdHlsZSkge1xyXG5cdFx0TC5zZXRPcHRpb25zKHRoaXMsIHN0eWxlKTtcclxuXHJcblx0XHRpZiAodGhpcy5fbWFwKSB7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZVN0eWxlKCk7XHJcblx0XHRcdHRoaXMuX3JlcXVlc3RVcGRhdGUoKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdG9uUmVtb3ZlOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHRtYXBcclxuXHRcdCAgICAub2ZmKCd2aWV3cmVzZXQnLCB0aGlzLnByb2plY3RMYXRsbmdzLCB0aGlzKVxyXG5cdFx0ICAgIC5vZmYoJ21vdmVlbmQnLCB0aGlzLl91cGRhdGVQYXRoLCB0aGlzKTtcclxuXHJcblx0XHRpZiAodGhpcy5vcHRpb25zLmNsaWNrYWJsZSkge1xyXG5cdFx0XHR0aGlzLl9tYXAub2ZmKCdjbGljaycsIHRoaXMuX29uQ2xpY2ssIHRoaXMpO1xyXG5cdFx0XHR0aGlzLl9tYXAub2ZmKCdtb3VzZW1vdmUnLCB0aGlzLl9vbk1vdXNlTW92ZSwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fcmVxdWVzdFVwZGF0ZSgpO1xyXG5cdFx0XHJcblx0XHR0aGlzLmZpcmUoJ3JlbW92ZScpO1xyXG5cdFx0dGhpcy5fbWFwID0gbnVsbDtcclxuXHR9LFxyXG5cclxuXHRfcmVxdWVzdFVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX21hcCAmJiAhTC5QYXRoLl91cGRhdGVSZXF1ZXN0KSB7XHJcblx0XHRcdEwuUGF0aC5fdXBkYXRlUmVxdWVzdCA9IEwuVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKHRoaXMuX2ZpcmVNYXBNb3ZlRW5kLCB0aGlzLl9tYXApO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9maXJlTWFwTW92ZUVuZDogZnVuY3Rpb24gKCkge1xyXG5cdFx0TC5QYXRoLl91cGRhdGVSZXF1ZXN0ID0gbnVsbDtcclxuXHRcdHRoaXMuZmlyZSgnbW92ZWVuZCcpO1xyXG5cdH0sXHJcblxyXG5cdF9pbml0RWxlbWVudHM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuX21hcC5faW5pdFBhdGhSb290KCk7XHJcblx0XHR0aGlzLl9jdHggPSB0aGlzLl9tYXAuX2NhbnZhc0N0eDtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlU3R5bGU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLnN0cm9rZSkge1xyXG5cdFx0XHR0aGlzLl9jdHgubGluZVdpZHRoID0gb3B0aW9ucy53ZWlnaHQ7XHJcblx0XHRcdHRoaXMuX2N0eC5zdHJva2VTdHlsZSA9IG9wdGlvbnMuY29sb3I7XHJcblx0XHR9XHJcblx0XHRpZiAob3B0aW9ucy5maWxsKSB7XHJcblx0XHRcdHRoaXMuX2N0eC5maWxsU3R5bGUgPSBvcHRpb25zLmZpbGxDb2xvciB8fCBvcHRpb25zLmNvbG9yO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvcHRpb25zLmxpbmVDYXApIHtcclxuXHRcdFx0dGhpcy5fY3R4LmxpbmVDYXAgPSBvcHRpb25zLmxpbmVDYXA7XHJcblx0XHR9XHJcblx0XHRpZiAob3B0aW9ucy5saW5lSm9pbikge1xyXG5cdFx0XHR0aGlzLl9jdHgubGluZUpvaW4gPSBvcHRpb25zLmxpbmVKb2luO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9kcmF3UGF0aDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGksIGosIGxlbiwgbGVuMiwgcG9pbnQsIGRyYXdNZXRob2Q7XHJcblxyXG5cdFx0dGhpcy5fY3R4LmJlZ2luUGF0aCgpO1xyXG5cclxuXHRcdGZvciAoaSA9IDAsIGxlbiA9IHRoaXMuX3BhcnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGZvciAoaiA9IDAsIGxlbjIgPSB0aGlzLl9wYXJ0c1tpXS5sZW5ndGg7IGogPCBsZW4yOyBqKyspIHtcclxuXHRcdFx0XHRwb2ludCA9IHRoaXMuX3BhcnRzW2ldW2pdO1xyXG5cdFx0XHRcdGRyYXdNZXRob2QgPSAoaiA9PT0gMCA/ICdtb3ZlJyA6ICdsaW5lJykgKyAnVG8nO1xyXG5cclxuXHRcdFx0XHR0aGlzLl9jdHhbZHJhd01ldGhvZF0ocG9pbnQueCwgcG9pbnQueSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gVE9ETyByZWZhY3RvciB1Z2x5IGhhY2tcclxuXHRcdFx0aWYgKHRoaXMgaW5zdGFuY2VvZiBMLlBvbHlnb24pIHtcclxuXHRcdFx0XHR0aGlzLl9jdHguY2xvc2VQYXRoKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfY2hlY2tJZkVtcHR5OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gIXRoaXMuX3BhcnRzLmxlbmd0aDtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlUGF0aDogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX2NoZWNrSWZFbXB0eSgpKSB7IHJldHVybjsgfVxyXG5cclxuXHRcdHZhciBjdHggPSB0aGlzLl9jdHgsXHJcblx0XHQgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcclxuXHJcblx0XHR0aGlzLl9kcmF3UGF0aCgpO1xyXG5cdFx0Y3R4LnNhdmUoKTtcclxuXHRcdHRoaXMuX3VwZGF0ZVN0eWxlKCk7XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuZmlsbCkge1xyXG5cdFx0XHRjdHguZ2xvYmFsQWxwaGEgPSBvcHRpb25zLmZpbGxPcGFjaXR5O1xyXG5cdFx0XHRjdHguZmlsbChvcHRpb25zLmZpbGxSdWxlIHx8ICdldmVub2RkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuc3Ryb2tlKSB7XHJcblx0XHRcdGN0eC5nbG9iYWxBbHBoYSA9IG9wdGlvbnMub3BhY2l0eTtcclxuXHRcdFx0Y3R4LnN0cm9rZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGN0eC5yZXN0b3JlKCk7XHJcblxyXG5cdFx0Ly8gVE9ETyBvcHRpbWl6YXRpb246IDEgZmlsbC9zdHJva2UgZm9yIGFsbCBmZWF0dXJlcyB3aXRoIGVxdWFsIHN0eWxlIGluc3RlYWQgb2YgMSBmb3IgZWFjaCBmZWF0dXJlXHJcblx0fSxcclxuXHJcblx0X2luaXRFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLm9wdGlvbnMuY2xpY2thYmxlKSB7XHJcblx0XHRcdHRoaXMuX21hcC5vbignbW91c2Vtb3ZlJywgdGhpcy5fb25Nb3VzZU1vdmUsIHRoaXMpO1xyXG5cdFx0XHR0aGlzLl9tYXAub24oJ2NsaWNrIGRibGNsaWNrIGNvbnRleHRtZW51JywgdGhpcy5fZmlyZU1vdXNlRXZlbnQsIHRoaXMpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9maXJlTW91c2VFdmVudDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdGlmICh0aGlzLl9jb250YWluc1BvaW50KGUubGF5ZXJQb2ludCkpIHtcclxuXHRcdFx0dGhpcy5maXJlKGUudHlwZSwgZSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X29uTW91c2VNb3ZlOiBmdW5jdGlvbiAoZSkge1xyXG5cdFx0aWYgKCF0aGlzLl9tYXAgfHwgdGhpcy5fbWFwLl9hbmltYXRpbmdab29tKSB7IHJldHVybjsgfVxyXG5cclxuXHRcdC8vIFRPRE8gZG9uJ3QgZG8gb24gZWFjaCBtb3ZlXHJcblx0XHRpZiAodGhpcy5fY29udGFpbnNQb2ludChlLmxheWVyUG9pbnQpKSB7XHJcblx0XHRcdHRoaXMuX2N0eC5jYW52YXMuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG5cdFx0XHR0aGlzLl9tb3VzZUluc2lkZSA9IHRydWU7XHJcblx0XHRcdHRoaXMuZmlyZSgnbW91c2VvdmVyJywgZSk7XHJcblxyXG5cdFx0fSBlbHNlIGlmICh0aGlzLl9tb3VzZUluc2lkZSkge1xyXG5cdFx0XHR0aGlzLl9jdHguY2FudmFzLnN0eWxlLmN1cnNvciA9ICcnO1xyXG5cdFx0XHR0aGlzLl9tb3VzZUluc2lkZSA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmZpcmUoJ21vdXNlb3V0JywgZSk7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbkwuTWFwLmluY2x1ZGUoKEwuUGF0aC5TVkcgJiYgIXdpbmRvdy5MX1BSRUZFUl9DQU5WQVMpIHx8ICFMLkJyb3dzZXIuY2FudmFzID8ge30gOiB7XHJcblx0X2luaXRQYXRoUm9vdDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzLl9wYXRoUm9vdCxcclxuXHRcdCAgICBjdHg7XHJcblxyXG5cdFx0aWYgKCFyb290KSB7XHJcblx0XHRcdHJvb3QgPSB0aGlzLl9wYXRoUm9vdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG5cdFx0XHRyb290LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuXHRcdFx0Y3R4ID0gdGhpcy5fY2FudmFzQ3R4ID0gcm9vdC5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuXHRcdFx0Y3R4LmxpbmVDYXAgPSAncm91bmQnO1xyXG5cdFx0XHRjdHgubGluZUpvaW4gPSAncm91bmQnO1xyXG5cclxuXHRcdFx0dGhpcy5fcGFuZXMub3ZlcmxheVBhbmUuYXBwZW5kQ2hpbGQocm9vdCk7XHJcblxyXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnpvb21BbmltYXRpb24pIHtcclxuXHRcdFx0XHR0aGlzLl9wYXRoUm9vdC5jbGFzc05hbWUgPSAnbGVhZmxldC16b29tLWFuaW1hdGVkJztcclxuXHRcdFx0XHR0aGlzLm9uKCd6b29tYW5pbScsIHRoaXMuX2FuaW1hdGVQYXRoWm9vbSk7XHJcblx0XHRcdFx0dGhpcy5vbignem9vbWVuZCcsIHRoaXMuX2VuZFBhdGhab29tKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLm9uKCdtb3ZlZW5kJywgdGhpcy5fdXBkYXRlQ2FudmFzVmlld3BvcnQpO1xyXG5cdFx0XHR0aGlzLl91cGRhdGVDYW52YXNWaWV3cG9ydCgpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF91cGRhdGVDYW52YXNWaWV3cG9ydDogZnVuY3Rpb24gKCkge1xyXG5cdFx0Ly8gZG9uJ3QgcmVkcmF3IHdoaWxlIHpvb21pbmcuIFNlZSBfdXBkYXRlU3ZnVmlld3BvcnQgZm9yIG1vcmUgZGV0YWlsc1xyXG5cdFx0aWYgKHRoaXMuX3BhdGhab29taW5nKSB7IHJldHVybjsgfVxyXG5cdFx0dGhpcy5fdXBkYXRlUGF0aFZpZXdwb3J0KCk7XHJcblxyXG5cdFx0dmFyIHZwID0gdGhpcy5fcGF0aFZpZXdwb3J0LFxyXG5cdFx0ICAgIG1pbiA9IHZwLm1pbixcclxuXHRcdCAgICBzaXplID0gdnAubWF4LnN1YnRyYWN0KG1pbiksXHJcblx0XHQgICAgcm9vdCA9IHRoaXMuX3BhdGhSb290O1xyXG5cclxuXHRcdC8vVE9ETyBjaGVjayBpZiB0aGlzIHdvcmtzIHByb3Blcmx5IG9uIG1vYmlsZSB3ZWJraXRcclxuXHRcdEwuRG9tVXRpbC5zZXRQb3NpdGlvbihyb290LCBtaW4pO1xyXG5cdFx0cm9vdC53aWR0aCA9IHNpemUueDtcclxuXHRcdHJvb3QuaGVpZ2h0ID0gc2l6ZS55O1xyXG5cdFx0cm9vdC5nZXRDb250ZXh0KCcyZCcpLnRyYW5zbGF0ZSgtbWluLngsIC1taW4ueSk7XHJcblx0fVxyXG59KTtcclxuXG5cbi8qXHJcbiAqIEwuTGluZVV0aWwgY29udGFpbnMgZGlmZmVyZW50IHV0aWxpdHkgZnVuY3Rpb25zIGZvciBsaW5lIHNlZ21lbnRzXHJcbiAqIGFuZCBwb2x5bGluZXMgKGNsaXBwaW5nLCBzaW1wbGlmaWNhdGlvbiwgZGlzdGFuY2VzLCBldGMuKVxyXG4gKi9cclxuXHJcbi8qanNoaW50IGJpdHdpc2U6ZmFsc2UgKi8gLy8gYWxsb3cgYml0d2lzZSBvcGVyYXRpb25zIGZvciB0aGlzIGZpbGVcclxuXHJcbkwuTGluZVV0aWwgPSB7XHJcblxyXG5cdC8vIFNpbXBsaWZ5IHBvbHlsaW5lIHdpdGggdmVydGV4IHJlZHVjdGlvbiBhbmQgRG91Z2xhcy1QZXVja2VyIHNpbXBsaWZpY2F0aW9uLlxyXG5cdC8vIEltcHJvdmVzIHJlbmRlcmluZyBwZXJmb3JtYW5jZSBkcmFtYXRpY2FsbHkgYnkgbGVzc2VuaW5nIHRoZSBudW1iZXIgb2YgcG9pbnRzIHRvIGRyYXcuXHJcblxyXG5cdHNpbXBsaWZ5OiBmdW5jdGlvbiAoLypQb2ludFtdKi8gcG9pbnRzLCAvKk51bWJlciovIHRvbGVyYW5jZSkge1xyXG5cdFx0aWYgKCF0b2xlcmFuY2UgfHwgIXBvaW50cy5sZW5ndGgpIHtcclxuXHRcdFx0cmV0dXJuIHBvaW50cy5zbGljZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBzcVRvbGVyYW5jZSA9IHRvbGVyYW5jZSAqIHRvbGVyYW5jZTtcclxuXHJcblx0XHQvLyBzdGFnZSAxOiB2ZXJ0ZXggcmVkdWN0aW9uXHJcblx0XHRwb2ludHMgPSB0aGlzLl9yZWR1Y2VQb2ludHMocG9pbnRzLCBzcVRvbGVyYW5jZSk7XHJcblxyXG5cdFx0Ly8gc3RhZ2UgMjogRG91Z2xhcy1QZXVja2VyIHNpbXBsaWZpY2F0aW9uXHJcblx0XHRwb2ludHMgPSB0aGlzLl9zaW1wbGlmeURQKHBvaW50cywgc3FUb2xlcmFuY2UpO1xyXG5cclxuXHRcdHJldHVybiBwb2ludHM7XHJcblx0fSxcclxuXHJcblx0Ly8gZGlzdGFuY2UgZnJvbSBhIHBvaW50IHRvIGEgc2VnbWVudCBiZXR3ZWVuIHR3byBwb2ludHNcclxuXHRwb2ludFRvU2VnbWVudERpc3RhbmNlOiAgZnVuY3Rpb24gKC8qUG9pbnQqLyBwLCAvKlBvaW50Ki8gcDEsIC8qUG9pbnQqLyBwMikge1xyXG5cdFx0cmV0dXJuIE1hdGguc3FydCh0aGlzLl9zcUNsb3Nlc3RQb2ludE9uU2VnbWVudChwLCBwMSwgcDIsIHRydWUpKTtcclxuXHR9LFxyXG5cclxuXHRjbG9zZXN0UG9pbnRPblNlZ21lbnQ6IGZ1bmN0aW9uICgvKlBvaW50Ki8gcCwgLypQb2ludCovIHAxLCAvKlBvaW50Ki8gcDIpIHtcclxuXHRcdHJldHVybiB0aGlzLl9zcUNsb3Nlc3RQb2ludE9uU2VnbWVudChwLCBwMSwgcDIpO1xyXG5cdH0sXHJcblxyXG5cdC8vIERvdWdsYXMtUGV1Y2tlciBzaW1wbGlmaWNhdGlvbiwgc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRG91Z2xhcy1QZXVja2VyX2FsZ29yaXRobVxyXG5cdF9zaW1wbGlmeURQOiBmdW5jdGlvbiAocG9pbnRzLCBzcVRvbGVyYW5jZSkge1xyXG5cclxuXHRcdHZhciBsZW4gPSBwb2ludHMubGVuZ3RoLFxyXG5cdFx0ICAgIEFycmF5Q29uc3RydWN0b3IgPSB0eXBlb2YgVWludDhBcnJheSAhPT0gdW5kZWZpbmVkICsgJycgPyBVaW50OEFycmF5IDogQXJyYXksXHJcblx0XHQgICAgbWFya2VycyA9IG5ldyBBcnJheUNvbnN0cnVjdG9yKGxlbik7XHJcblxyXG5cdFx0bWFya2Vyc1swXSA9IG1hcmtlcnNbbGVuIC0gMV0gPSAxO1xyXG5cclxuXHRcdHRoaXMuX3NpbXBsaWZ5RFBTdGVwKHBvaW50cywgbWFya2Vycywgc3FUb2xlcmFuY2UsIDAsIGxlbiAtIDEpO1xyXG5cclxuXHRcdHZhciBpLFxyXG5cdFx0ICAgIG5ld1BvaW50cyA9IFtdO1xyXG5cclxuXHRcdGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRpZiAobWFya2Vyc1tpXSkge1xyXG5cdFx0XHRcdG5ld1BvaW50cy5wdXNoKHBvaW50c1tpXSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gbmV3UG9pbnRzO1xyXG5cdH0sXHJcblxyXG5cdF9zaW1wbGlmeURQU3RlcDogZnVuY3Rpb24gKHBvaW50cywgbWFya2Vycywgc3FUb2xlcmFuY2UsIGZpcnN0LCBsYXN0KSB7XHJcblxyXG5cdFx0dmFyIG1heFNxRGlzdCA9IDAsXHJcblx0XHQgICAgaW5kZXgsIGksIHNxRGlzdDtcclxuXHJcblx0XHRmb3IgKGkgPSBmaXJzdCArIDE7IGkgPD0gbGFzdCAtIDE7IGkrKykge1xyXG5cdFx0XHRzcURpc3QgPSB0aGlzLl9zcUNsb3Nlc3RQb2ludE9uU2VnbWVudChwb2ludHNbaV0sIHBvaW50c1tmaXJzdF0sIHBvaW50c1tsYXN0XSwgdHJ1ZSk7XHJcblxyXG5cdFx0XHRpZiAoc3FEaXN0ID4gbWF4U3FEaXN0KSB7XHJcblx0XHRcdFx0aW5kZXggPSBpO1xyXG5cdFx0XHRcdG1heFNxRGlzdCA9IHNxRGlzdDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChtYXhTcURpc3QgPiBzcVRvbGVyYW5jZSkge1xyXG5cdFx0XHRtYXJrZXJzW2luZGV4XSA9IDE7XHJcblxyXG5cdFx0XHR0aGlzLl9zaW1wbGlmeURQU3RlcChwb2ludHMsIG1hcmtlcnMsIHNxVG9sZXJhbmNlLCBmaXJzdCwgaW5kZXgpO1xyXG5cdFx0XHR0aGlzLl9zaW1wbGlmeURQU3RlcChwb2ludHMsIG1hcmtlcnMsIHNxVG9sZXJhbmNlLCBpbmRleCwgbGFzdCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0Ly8gcmVkdWNlIHBvaW50cyB0aGF0IGFyZSB0b28gY2xvc2UgdG8gZWFjaCBvdGhlciB0byBhIHNpbmdsZSBwb2ludFxyXG5cdF9yZWR1Y2VQb2ludHM6IGZ1bmN0aW9uIChwb2ludHMsIHNxVG9sZXJhbmNlKSB7XHJcblx0XHR2YXIgcmVkdWNlZFBvaW50cyA9IFtwb2ludHNbMF1dO1xyXG5cclxuXHRcdGZvciAodmFyIGkgPSAxLCBwcmV2ID0gMCwgbGVuID0gcG9pbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGlmICh0aGlzLl9zcURpc3QocG9pbnRzW2ldLCBwb2ludHNbcHJldl0pID4gc3FUb2xlcmFuY2UpIHtcclxuXHRcdFx0XHRyZWR1Y2VkUG9pbnRzLnB1c2gocG9pbnRzW2ldKTtcclxuXHRcdFx0XHRwcmV2ID0gaTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0aWYgKHByZXYgPCBsZW4gLSAxKSB7XHJcblx0XHRcdHJlZHVjZWRQb2ludHMucHVzaChwb2ludHNbbGVuIC0gMV0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHJlZHVjZWRQb2ludHM7XHJcblx0fSxcclxuXHJcblx0Ly8gQ29oZW4tU3V0aGVybGFuZCBsaW5lIGNsaXBwaW5nIGFsZ29yaXRobS5cclxuXHQvLyBVc2VkIHRvIGF2b2lkIHJlbmRlcmluZyBwYXJ0cyBvZiBhIHBvbHlsaW5lIHRoYXQgYXJlIG5vdCBjdXJyZW50bHkgdmlzaWJsZS5cclxuXHJcblx0Y2xpcFNlZ21lbnQ6IGZ1bmN0aW9uIChhLCBiLCBib3VuZHMsIHVzZUxhc3RDb2RlKSB7XHJcblx0XHR2YXIgY29kZUEgPSB1c2VMYXN0Q29kZSA/IHRoaXMuX2xhc3RDb2RlIDogdGhpcy5fZ2V0Qml0Q29kZShhLCBib3VuZHMpLFxyXG5cdFx0ICAgIGNvZGVCID0gdGhpcy5fZ2V0Qml0Q29kZShiLCBib3VuZHMpLFxyXG5cclxuXHRcdCAgICBjb2RlT3V0LCBwLCBuZXdDb2RlO1xyXG5cclxuXHRcdC8vIHNhdmUgMm5kIGNvZGUgdG8gYXZvaWQgY2FsY3VsYXRpbmcgaXQgb24gdGhlIG5leHQgc2VnbWVudFxyXG5cdFx0dGhpcy5fbGFzdENvZGUgPSBjb2RlQjtcclxuXHJcblx0XHR3aGlsZSAodHJ1ZSkge1xyXG5cdFx0XHQvLyBpZiBhLGIgaXMgaW5zaWRlIHRoZSBjbGlwIHdpbmRvdyAodHJpdmlhbCBhY2NlcHQpXHJcblx0XHRcdGlmICghKGNvZGVBIHwgY29kZUIpKSB7XHJcblx0XHRcdFx0cmV0dXJuIFthLCBiXTtcclxuXHRcdFx0Ly8gaWYgYSxiIGlzIG91dHNpZGUgdGhlIGNsaXAgd2luZG93ICh0cml2aWFsIHJlamVjdClcclxuXHRcdFx0fSBlbHNlIGlmIChjb2RlQSAmIGNvZGVCKSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHQvLyBvdGhlciBjYXNlc1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvZGVPdXQgPSBjb2RlQSB8fCBjb2RlQjtcclxuXHRcdFx0XHRwID0gdGhpcy5fZ2V0RWRnZUludGVyc2VjdGlvbihhLCBiLCBjb2RlT3V0LCBib3VuZHMpO1xyXG5cdFx0XHRcdG5ld0NvZGUgPSB0aGlzLl9nZXRCaXRDb2RlKHAsIGJvdW5kcyk7XHJcblxyXG5cdFx0XHRcdGlmIChjb2RlT3V0ID09PSBjb2RlQSkge1xyXG5cdFx0XHRcdFx0YSA9IHA7XHJcblx0XHRcdFx0XHRjb2RlQSA9IG5ld0NvZGU7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGIgPSBwO1xyXG5cdFx0XHRcdFx0Y29kZUIgPSBuZXdDb2RlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9nZXRFZGdlSW50ZXJzZWN0aW9uOiBmdW5jdGlvbiAoYSwgYiwgY29kZSwgYm91bmRzKSB7XHJcblx0XHR2YXIgZHggPSBiLnggLSBhLngsXHJcblx0XHQgICAgZHkgPSBiLnkgLSBhLnksXHJcblx0XHQgICAgbWluID0gYm91bmRzLm1pbixcclxuXHRcdCAgICBtYXggPSBib3VuZHMubWF4O1xyXG5cclxuXHRcdGlmIChjb2RlICYgOCkgeyAvLyB0b3BcclxuXHRcdFx0cmV0dXJuIG5ldyBMLlBvaW50KGEueCArIGR4ICogKG1heC55IC0gYS55KSAvIGR5LCBtYXgueSk7XHJcblx0XHR9IGVsc2UgaWYgKGNvZGUgJiA0KSB7IC8vIGJvdHRvbVxyXG5cdFx0XHRyZXR1cm4gbmV3IEwuUG9pbnQoYS54ICsgZHggKiAobWluLnkgLSBhLnkpIC8gZHksIG1pbi55KTtcclxuXHRcdH0gZWxzZSBpZiAoY29kZSAmIDIpIHsgLy8gcmlnaHRcclxuXHRcdFx0cmV0dXJuIG5ldyBMLlBvaW50KG1heC54LCBhLnkgKyBkeSAqIChtYXgueCAtIGEueCkgLyBkeCk7XHJcblx0XHR9IGVsc2UgaWYgKGNvZGUgJiAxKSB7IC8vIGxlZnRcclxuXHRcdFx0cmV0dXJuIG5ldyBMLlBvaW50KG1pbi54LCBhLnkgKyBkeSAqIChtaW4ueCAtIGEueCkgLyBkeCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2dldEJpdENvZGU6IGZ1bmN0aW9uICgvKlBvaW50Ki8gcCwgYm91bmRzKSB7XHJcblx0XHR2YXIgY29kZSA9IDA7XHJcblxyXG5cdFx0aWYgKHAueCA8IGJvdW5kcy5taW4ueCkgeyAvLyBsZWZ0XHJcblx0XHRcdGNvZGUgfD0gMTtcclxuXHRcdH0gZWxzZSBpZiAocC54ID4gYm91bmRzLm1heC54KSB7IC8vIHJpZ2h0XHJcblx0XHRcdGNvZGUgfD0gMjtcclxuXHRcdH1cclxuXHRcdGlmIChwLnkgPCBib3VuZHMubWluLnkpIHsgLy8gYm90dG9tXHJcblx0XHRcdGNvZGUgfD0gNDtcclxuXHRcdH0gZWxzZSBpZiAocC55ID4gYm91bmRzLm1heC55KSB7IC8vIHRvcFxyXG5cdFx0XHRjb2RlIHw9IDg7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGNvZGU7XHJcblx0fSxcclxuXHJcblx0Ly8gc3F1YXJlIGRpc3RhbmNlICh0byBhdm9pZCB1bm5lY2Vzc2FyeSBNYXRoLnNxcnQgY2FsbHMpXHJcblx0X3NxRGlzdDogZnVuY3Rpb24gKHAxLCBwMikge1xyXG5cdFx0dmFyIGR4ID0gcDIueCAtIHAxLngsXHJcblx0XHQgICAgZHkgPSBwMi55IC0gcDEueTtcclxuXHRcdHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTtcclxuXHR9LFxyXG5cclxuXHQvLyByZXR1cm4gY2xvc2VzdCBwb2ludCBvbiBzZWdtZW50IG9yIGRpc3RhbmNlIHRvIHRoYXQgcG9pbnRcclxuXHRfc3FDbG9zZXN0UG9pbnRPblNlZ21lbnQ6IGZ1bmN0aW9uIChwLCBwMSwgcDIsIHNxRGlzdCkge1xyXG5cdFx0dmFyIHggPSBwMS54LFxyXG5cdFx0ICAgIHkgPSBwMS55LFxyXG5cdFx0ICAgIGR4ID0gcDIueCAtIHgsXHJcblx0XHQgICAgZHkgPSBwMi55IC0geSxcclxuXHRcdCAgICBkb3QgPSBkeCAqIGR4ICsgZHkgKiBkeSxcclxuXHRcdCAgICB0O1xyXG5cclxuXHRcdGlmIChkb3QgPiAwKSB7XHJcblx0XHRcdHQgPSAoKHAueCAtIHgpICogZHggKyAocC55IC0geSkgKiBkeSkgLyBkb3Q7XHJcblxyXG5cdFx0XHRpZiAodCA+IDEpIHtcclxuXHRcdFx0XHR4ID0gcDIueDtcclxuXHRcdFx0XHR5ID0gcDIueTtcclxuXHRcdFx0fSBlbHNlIGlmICh0ID4gMCkge1xyXG5cdFx0XHRcdHggKz0gZHggKiB0O1xyXG5cdFx0XHRcdHkgKz0gZHkgKiB0O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0ZHggPSBwLnggLSB4O1xyXG5cdFx0ZHkgPSBwLnkgLSB5O1xyXG5cclxuXHRcdHJldHVybiBzcURpc3QgPyBkeCAqIGR4ICsgZHkgKiBkeSA6IG5ldyBMLlBvaW50KHgsIHkpO1xyXG5cdH1cclxufTtcclxuXG5cbi8qXHJcbiAqIEwuUG9seWxpbmUgaXMgdXNlZCB0byBkaXNwbGF5IHBvbHlsaW5lcyBvbiBhIG1hcC5cclxuICovXHJcblxyXG5MLlBvbHlsaW5lID0gTC5QYXRoLmV4dGVuZCh7XHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKGxhdGxuZ3MsIG9wdGlvbnMpIHtcclxuXHRcdEwuUGF0aC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIG9wdGlvbnMpO1xyXG5cclxuXHRcdHRoaXMuX2xhdGxuZ3MgPSB0aGlzLl9jb252ZXJ0TGF0TG5ncyhsYXRsbmdzKTtcclxuXHR9LFxyXG5cclxuXHRvcHRpb25zOiB7XHJcblx0XHQvLyBob3cgbXVjaCB0byBzaW1wbGlmeSB0aGUgcG9seWxpbmUgb24gZWFjaCB6b29tIGxldmVsXHJcblx0XHQvLyBtb3JlID0gYmV0dGVyIHBlcmZvcm1hbmNlIGFuZCBzbW9vdGhlciBsb29rLCBsZXNzID0gbW9yZSBhY2N1cmF0ZVxyXG5cdFx0c21vb3RoRmFjdG9yOiAxLjAsXHJcblx0XHRub0NsaXA6IGZhbHNlXHJcblx0fSxcclxuXHJcblx0cHJvamVjdExhdGxuZ3M6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuX29yaWdpbmFsUG9pbnRzID0gW107XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2xhdGxuZ3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0dGhpcy5fb3JpZ2luYWxQb2ludHNbaV0gPSB0aGlzLl9tYXAubGF0TG5nVG9MYXllclBvaW50KHRoaXMuX2xhdGxuZ3NbaV0pO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGdldFBhdGhTdHJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9wYXJ0cy5sZW5ndGgsIHN0ciA9ICcnOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0c3RyICs9IHRoaXMuX2dldFBhdGhQYXJ0U3RyKHRoaXMuX3BhcnRzW2ldKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBzdHI7XHJcblx0fSxcclxuXHJcblx0Z2V0TGF0TG5nczogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2xhdGxuZ3M7XHJcblx0fSxcclxuXHJcblx0c2V0TGF0TG5nczogZnVuY3Rpb24gKGxhdGxuZ3MpIHtcclxuXHRcdHRoaXMuX2xhdGxuZ3MgPSB0aGlzLl9jb252ZXJ0TGF0TG5ncyhsYXRsbmdzKTtcclxuXHRcdHJldHVybiB0aGlzLnJlZHJhdygpO1xyXG5cdH0sXHJcblxyXG5cdGFkZExhdExuZzogZnVuY3Rpb24gKGxhdGxuZykge1xyXG5cdFx0dGhpcy5fbGF0bG5ncy5wdXNoKEwubGF0TG5nKGxhdGxuZykpO1xyXG5cdFx0cmV0dXJuIHRoaXMucmVkcmF3KCk7XHJcblx0fSxcclxuXHJcblx0c3BsaWNlTGF0TG5nczogZnVuY3Rpb24gKCkgeyAvLyAoTnVtYmVyIGluZGV4LCBOdW1iZXIgaG93TWFueSlcclxuXHRcdHZhciByZW1vdmVkID0gW10uc3BsaWNlLmFwcGx5KHRoaXMuX2xhdGxuZ3MsIGFyZ3VtZW50cyk7XHJcblx0XHR0aGlzLl9jb252ZXJ0TGF0TG5ncyh0aGlzLl9sYXRsbmdzLCB0cnVlKTtcclxuXHRcdHRoaXMucmVkcmF3KCk7XHJcblx0XHRyZXR1cm4gcmVtb3ZlZDtcclxuXHR9LFxyXG5cclxuXHRjbG9zZXN0TGF5ZXJQb2ludDogZnVuY3Rpb24gKHApIHtcclxuXHRcdHZhciBtaW5EaXN0YW5jZSA9IEluZmluaXR5LCBwYXJ0cyA9IHRoaXMuX3BhcnRzLCBwMSwgcDIsIG1pblBvaW50ID0gbnVsbDtcclxuXHJcblx0XHRmb3IgKHZhciBqID0gMCwgakxlbiA9IHBhcnRzLmxlbmd0aDsgaiA8IGpMZW47IGorKykge1xyXG5cdFx0XHR2YXIgcG9pbnRzID0gcGFydHNbal07XHJcblx0XHRcdGZvciAodmFyIGkgPSAxLCBsZW4gPSBwb2ludHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0XHRwMSA9IHBvaW50c1tpIC0gMV07XHJcblx0XHRcdFx0cDIgPSBwb2ludHNbaV07XHJcblx0XHRcdFx0dmFyIHNxRGlzdCA9IEwuTGluZVV0aWwuX3NxQ2xvc2VzdFBvaW50T25TZWdtZW50KHAsIHAxLCBwMiwgdHJ1ZSk7XHJcblx0XHRcdFx0aWYgKHNxRGlzdCA8IG1pbkRpc3RhbmNlKSB7XHJcblx0XHRcdFx0XHRtaW5EaXN0YW5jZSA9IHNxRGlzdDtcclxuXHRcdFx0XHRcdG1pblBvaW50ID0gTC5MaW5lVXRpbC5fc3FDbG9zZXN0UG9pbnRPblNlZ21lbnQocCwgcDEsIHAyKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmIChtaW5Qb2ludCkge1xyXG5cdFx0XHRtaW5Qb2ludC5kaXN0YW5jZSA9IE1hdGguc3FydChtaW5EaXN0YW5jZSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbWluUG9pbnQ7XHJcblx0fSxcclxuXHJcblx0Z2V0Qm91bmRzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gbmV3IEwuTGF0TG5nQm91bmRzKHRoaXMuZ2V0TGF0TG5ncygpKTtcclxuXHR9LFxyXG5cclxuXHRfY29udmVydExhdExuZ3M6IGZ1bmN0aW9uIChsYXRsbmdzLCBvdmVyd3JpdGUpIHtcclxuXHRcdHZhciBpLCBsZW4sIHRhcmdldCA9IG92ZXJ3cml0ZSA/IGxhdGxuZ3MgOiBbXTtcclxuXHJcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBsYXRsbmdzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdGlmIChMLlV0aWwuaXNBcnJheShsYXRsbmdzW2ldKSAmJiB0eXBlb2YgbGF0bG5nc1tpXVswXSAhPT0gJ251bWJlcicpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0dGFyZ2V0W2ldID0gTC5sYXRMbmcobGF0bG5nc1tpXSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGFyZ2V0O1xyXG5cdH0sXHJcblxyXG5cdF9pbml0RXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRMLlBhdGgucHJvdG90eXBlLl9pbml0RXZlbnRzLmNhbGwodGhpcyk7XHJcblx0fSxcclxuXHJcblx0X2dldFBhdGhQYXJ0U3RyOiBmdW5jdGlvbiAocG9pbnRzKSB7XHJcblx0XHR2YXIgcm91bmQgPSBMLlBhdGguVk1MO1xyXG5cclxuXHRcdGZvciAodmFyIGogPSAwLCBsZW4yID0gcG9pbnRzLmxlbmd0aCwgc3RyID0gJycsIHA7IGogPCBsZW4yOyBqKyspIHtcclxuXHRcdFx0cCA9IHBvaW50c1tqXTtcclxuXHRcdFx0aWYgKHJvdW5kKSB7XHJcblx0XHRcdFx0cC5fcm91bmQoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzdHIgKz0gKGogPyAnTCcgOiAnTScpICsgcC54ICsgJyAnICsgcC55O1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHN0cjtcclxuXHR9LFxyXG5cclxuXHRfY2xpcFBvaW50czogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHBvaW50cyA9IHRoaXMuX29yaWdpbmFsUG9pbnRzLFxyXG5cdFx0ICAgIGxlbiA9IHBvaW50cy5sZW5ndGgsXHJcblx0XHQgICAgaSwgaywgc2VnbWVudDtcclxuXHJcblx0XHRpZiAodGhpcy5vcHRpb25zLm5vQ2xpcCkge1xyXG5cdFx0XHR0aGlzLl9wYXJ0cyA9IFtwb2ludHNdO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fcGFydHMgPSBbXTtcclxuXHJcblx0XHR2YXIgcGFydHMgPSB0aGlzLl9wYXJ0cyxcclxuXHRcdCAgICB2cCA9IHRoaXMuX21hcC5fcGF0aFZpZXdwb3J0LFxyXG5cdFx0ICAgIGx1ID0gTC5MaW5lVXRpbDtcclxuXHJcblx0XHRmb3IgKGkgPSAwLCBrID0gMDsgaSA8IGxlbiAtIDE7IGkrKykge1xyXG5cdFx0XHRzZWdtZW50ID0gbHUuY2xpcFNlZ21lbnQocG9pbnRzW2ldLCBwb2ludHNbaSArIDFdLCB2cCwgaSk7XHJcblx0XHRcdGlmICghc2VnbWVudCkge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRwYXJ0c1trXSA9IHBhcnRzW2tdIHx8IFtdO1xyXG5cdFx0XHRwYXJ0c1trXS5wdXNoKHNlZ21lbnRbMF0pO1xyXG5cclxuXHRcdFx0Ly8gaWYgc2VnbWVudCBnb2VzIG91dCBvZiBzY3JlZW4sIG9yIGl0J3MgdGhlIGxhc3Qgb25lLCBpdCdzIHRoZSBlbmQgb2YgdGhlIGxpbmUgcGFydFxyXG5cdFx0XHRpZiAoKHNlZ21lbnRbMV0gIT09IHBvaW50c1tpICsgMV0pIHx8IChpID09PSBsZW4gLSAyKSkge1xyXG5cdFx0XHRcdHBhcnRzW2tdLnB1c2goc2VnbWVudFsxXSk7XHJcblx0XHRcdFx0aysrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0Ly8gc2ltcGxpZnkgZWFjaCBjbGlwcGVkIHBhcnQgb2YgdGhlIHBvbHlsaW5lXHJcblx0X3NpbXBsaWZ5UG9pbnRzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcGFydHMgPSB0aGlzLl9wYXJ0cyxcclxuXHRcdCAgICBsdSA9IEwuTGluZVV0aWw7XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IHBhcnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdHBhcnRzW2ldID0gbHUuc2ltcGxpZnkocGFydHNbaV0sIHRoaXMub3B0aW9ucy5zbW9vdGhGYWN0b3IpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF91cGRhdGVQYXRoOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX21hcCkgeyByZXR1cm47IH1cclxuXHJcblx0XHR0aGlzLl9jbGlwUG9pbnRzKCk7XHJcblx0XHR0aGlzLl9zaW1wbGlmeVBvaW50cygpO1xyXG5cclxuXHRcdEwuUGF0aC5wcm90b3R5cGUuX3VwZGF0ZVBhdGguY2FsbCh0aGlzKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5wb2x5bGluZSA9IGZ1bmN0aW9uIChsYXRsbmdzLCBvcHRpb25zKSB7XHJcblx0cmV0dXJuIG5ldyBMLlBvbHlsaW5lKGxhdGxuZ3MsIG9wdGlvbnMpO1xyXG59O1xyXG5cblxuLypcclxuICogTC5Qb2x5VXRpbCBjb250YWlucyB1dGlsaXR5IGZ1bmN0aW9ucyBmb3IgcG9seWdvbnMgKGNsaXBwaW5nLCBldGMuKS5cclxuICovXHJcblxyXG4vKmpzaGludCBiaXR3aXNlOmZhbHNlICovIC8vIGFsbG93IGJpdHdpc2Ugb3BlcmF0aW9ucyBoZXJlXHJcblxyXG5MLlBvbHlVdGlsID0ge307XHJcblxyXG4vKlxyXG4gKiBTdXRoZXJsYW5kLUhvZGdlbWFuIHBvbHlnb24gY2xpcHBpbmcgYWxnb3JpdGhtLlxyXG4gKiBVc2VkIHRvIGF2b2lkIHJlbmRlcmluZyBwYXJ0cyBvZiBhIHBvbHlnb24gdGhhdCBhcmUgbm90IGN1cnJlbnRseSB2aXNpYmxlLlxyXG4gKi9cclxuTC5Qb2x5VXRpbC5jbGlwUG9seWdvbiA9IGZ1bmN0aW9uIChwb2ludHMsIGJvdW5kcykge1xyXG5cdHZhciBjbGlwcGVkUG9pbnRzLFxyXG5cdCAgICBlZGdlcyA9IFsxLCA0LCAyLCA4XSxcclxuXHQgICAgaSwgaiwgayxcclxuXHQgICAgYSwgYixcclxuXHQgICAgbGVuLCBlZGdlLCBwLFxyXG5cdCAgICBsdSA9IEwuTGluZVV0aWw7XHJcblxyXG5cdGZvciAoaSA9IDAsIGxlbiA9IHBvaW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0cG9pbnRzW2ldLl9jb2RlID0gbHUuX2dldEJpdENvZGUocG9pbnRzW2ldLCBib3VuZHMpO1xyXG5cdH1cclxuXHJcblx0Ly8gZm9yIGVhY2ggZWRnZSAobGVmdCwgYm90dG9tLCByaWdodCwgdG9wKVxyXG5cdGZvciAoayA9IDA7IGsgPCA0OyBrKyspIHtcclxuXHRcdGVkZ2UgPSBlZGdlc1trXTtcclxuXHRcdGNsaXBwZWRQb2ludHMgPSBbXTtcclxuXHJcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBwb2ludHMubGVuZ3RoLCBqID0gbGVuIC0gMTsgaSA8IGxlbjsgaiA9IGkrKykge1xyXG5cdFx0XHRhID0gcG9pbnRzW2ldO1xyXG5cdFx0XHRiID0gcG9pbnRzW2pdO1xyXG5cclxuXHRcdFx0Ly8gaWYgYSBpcyBpbnNpZGUgdGhlIGNsaXAgd2luZG93XHJcblx0XHRcdGlmICghKGEuX2NvZGUgJiBlZGdlKSkge1xyXG5cdFx0XHRcdC8vIGlmIGIgaXMgb3V0c2lkZSB0aGUgY2xpcCB3aW5kb3cgKGEtPmIgZ29lcyBvdXQgb2Ygc2NyZWVuKVxyXG5cdFx0XHRcdGlmIChiLl9jb2RlICYgZWRnZSkge1xyXG5cdFx0XHRcdFx0cCA9IGx1Ll9nZXRFZGdlSW50ZXJzZWN0aW9uKGIsIGEsIGVkZ2UsIGJvdW5kcyk7XHJcblx0XHRcdFx0XHRwLl9jb2RlID0gbHUuX2dldEJpdENvZGUocCwgYm91bmRzKTtcclxuXHRcdFx0XHRcdGNsaXBwZWRQb2ludHMucHVzaChwKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y2xpcHBlZFBvaW50cy5wdXNoKGEpO1xyXG5cclxuXHRcdFx0Ly8gZWxzZSBpZiBiIGlzIGluc2lkZSB0aGUgY2xpcCB3aW5kb3cgKGEtPmIgZW50ZXJzIHRoZSBzY3JlZW4pXHJcblx0XHRcdH0gZWxzZSBpZiAoIShiLl9jb2RlICYgZWRnZSkpIHtcclxuXHRcdFx0XHRwID0gbHUuX2dldEVkZ2VJbnRlcnNlY3Rpb24oYiwgYSwgZWRnZSwgYm91bmRzKTtcclxuXHRcdFx0XHRwLl9jb2RlID0gbHUuX2dldEJpdENvZGUocCwgYm91bmRzKTtcclxuXHRcdFx0XHRjbGlwcGVkUG9pbnRzLnB1c2gocCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHBvaW50cyA9IGNsaXBwZWRQb2ludHM7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gcG9pbnRzO1xyXG59O1xyXG5cblxuLypcclxuICogTC5Qb2x5Z29uIGlzIHVzZWQgdG8gZGlzcGxheSBwb2x5Z29ucyBvbiBhIG1hcC5cclxuICovXHJcblxyXG5MLlBvbHlnb24gPSBMLlBvbHlsaW5lLmV4dGVuZCh7XHJcblx0b3B0aW9uczoge1xyXG5cdFx0ZmlsbDogdHJ1ZVxyXG5cdH0sXHJcblxyXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uIChsYXRsbmdzLCBvcHRpb25zKSB7XHJcblx0XHRMLlBvbHlsaW5lLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgbGF0bG5ncywgb3B0aW9ucyk7XHJcblx0XHR0aGlzLl9pbml0V2l0aEhvbGVzKGxhdGxuZ3MpO1xyXG5cdH0sXHJcblxyXG5cdF9pbml0V2l0aEhvbGVzOiBmdW5jdGlvbiAobGF0bG5ncykge1xyXG5cdFx0dmFyIGksIGxlbiwgaG9sZTtcclxuXHRcdGlmIChsYXRsbmdzICYmIEwuVXRpbC5pc0FycmF5KGxhdGxuZ3NbMF0pICYmICh0eXBlb2YgbGF0bG5nc1swXVswXSAhPT0gJ251bWJlcicpKSB7XHJcblx0XHRcdHRoaXMuX2xhdGxuZ3MgPSB0aGlzLl9jb252ZXJ0TGF0TG5ncyhsYXRsbmdzWzBdKTtcclxuXHRcdFx0dGhpcy5faG9sZXMgPSBsYXRsbmdzLnNsaWNlKDEpO1xyXG5cclxuXHRcdFx0Zm9yIChpID0gMCwgbGVuID0gdGhpcy5faG9sZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0XHRob2xlID0gdGhpcy5faG9sZXNbaV0gPSB0aGlzLl9jb252ZXJ0TGF0TG5ncyh0aGlzLl9ob2xlc1tpXSk7XHJcblx0XHRcdFx0aWYgKGhvbGVbMF0uZXF1YWxzKGhvbGVbaG9sZS5sZW5ndGggLSAxXSkpIHtcclxuXHRcdFx0XHRcdGhvbGUucG9wKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gZmlsdGVyIG91dCBsYXN0IHBvaW50IGlmIGl0cyBlcXVhbCB0byB0aGUgZmlyc3Qgb25lXHJcblx0XHRsYXRsbmdzID0gdGhpcy5fbGF0bG5ncztcclxuXHJcblx0XHRpZiAobGF0bG5ncy5sZW5ndGggPj0gMiAmJiBsYXRsbmdzWzBdLmVxdWFscyhsYXRsbmdzW2xhdGxuZ3MubGVuZ3RoIC0gMV0pKSB7XHJcblx0XHRcdGxhdGxuZ3MucG9wKCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0cHJvamVjdExhdGxuZ3M6IGZ1bmN0aW9uICgpIHtcclxuXHRcdEwuUG9seWxpbmUucHJvdG90eXBlLnByb2plY3RMYXRsbmdzLmNhbGwodGhpcyk7XHJcblxyXG5cdFx0Ly8gcHJvamVjdCBwb2x5Z29uIGhvbGVzIHBvaW50c1xyXG5cdFx0Ly8gVE9ETyBtb3ZlIHRoaXMgbG9naWMgdG8gUG9seWxpbmUgdG8gZ2V0IHJpZCBvZiBkdXBsaWNhdGlvblxyXG5cdFx0dGhpcy5faG9sZVBvaW50cyA9IFtdO1xyXG5cclxuXHRcdGlmICghdGhpcy5faG9sZXMpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0dmFyIGksIGosIGxlbiwgbGVuMjtcclxuXHJcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSB0aGlzLl9ob2xlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHR0aGlzLl9ob2xlUG9pbnRzW2ldID0gW107XHJcblxyXG5cdFx0XHRmb3IgKGogPSAwLCBsZW4yID0gdGhpcy5faG9sZXNbaV0ubGVuZ3RoOyBqIDwgbGVuMjsgaisrKSB7XHJcblx0XHRcdFx0dGhpcy5faG9sZVBvaW50c1tpXVtqXSA9IHRoaXMuX21hcC5sYXRMbmdUb0xheWVyUG9pbnQodGhpcy5faG9sZXNbaV1bal0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0c2V0TGF0TG5nczogZnVuY3Rpb24gKGxhdGxuZ3MpIHtcclxuXHRcdGlmIChsYXRsbmdzICYmIEwuVXRpbC5pc0FycmF5KGxhdGxuZ3NbMF0pICYmICh0eXBlb2YgbGF0bG5nc1swXVswXSAhPT0gJ251bWJlcicpKSB7XHJcblx0XHRcdHRoaXMuX2luaXRXaXRoSG9sZXMobGF0bG5ncyk7XHJcblx0XHRcdHJldHVybiB0aGlzLnJlZHJhdygpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmV0dXJuIEwuUG9seWxpbmUucHJvdG90eXBlLnNldExhdExuZ3MuY2FsbCh0aGlzLCBsYXRsbmdzKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfY2xpcFBvaW50czogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHBvaW50cyA9IHRoaXMuX29yaWdpbmFsUG9pbnRzLFxyXG5cdFx0ICAgIG5ld1BhcnRzID0gW107XHJcblxyXG5cdFx0dGhpcy5fcGFydHMgPSBbcG9pbnRzXS5jb25jYXQodGhpcy5faG9sZVBvaW50cyk7XHJcblxyXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5ub0NsaXApIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX3BhcnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdHZhciBjbGlwcGVkID0gTC5Qb2x5VXRpbC5jbGlwUG9seWdvbih0aGlzLl9wYXJ0c1tpXSwgdGhpcy5fbWFwLl9wYXRoVmlld3BvcnQpO1xyXG5cdFx0XHRpZiAoY2xpcHBlZC5sZW5ndGgpIHtcclxuXHRcdFx0XHRuZXdQYXJ0cy5wdXNoKGNsaXBwZWQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fcGFydHMgPSBuZXdQYXJ0cztcclxuXHR9LFxyXG5cclxuXHRfZ2V0UGF0aFBhcnRTdHI6IGZ1bmN0aW9uIChwb2ludHMpIHtcclxuXHRcdHZhciBzdHIgPSBMLlBvbHlsaW5lLnByb3RvdHlwZS5fZ2V0UGF0aFBhcnRTdHIuY2FsbCh0aGlzLCBwb2ludHMpO1xyXG5cdFx0cmV0dXJuIHN0ciArIChMLkJyb3dzZXIuc3ZnID8gJ3onIDogJ3gnKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5wb2x5Z29uID0gZnVuY3Rpb24gKGxhdGxuZ3MsIG9wdGlvbnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuUG9seWdvbihsYXRsbmdzLCBvcHRpb25zKTtcclxufTtcclxuXG5cbi8qXHJcbiAqIENvbnRhaW5zIEwuTXVsdGlQb2x5bGluZSBhbmQgTC5NdWx0aVBvbHlnb24gbGF5ZXJzLlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcblx0ZnVuY3Rpb24gY3JlYXRlTXVsdGkoS2xhc3MpIHtcclxuXHJcblx0XHRyZXR1cm4gTC5GZWF0dXJlR3JvdXAuZXh0ZW5kKHtcclxuXHJcblx0XHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uIChsYXRsbmdzLCBvcHRpb25zKSB7XHJcblx0XHRcdFx0dGhpcy5fbGF5ZXJzID0ge307XHJcblx0XHRcdFx0dGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XHJcblx0XHRcdFx0dGhpcy5zZXRMYXRMbmdzKGxhdGxuZ3MpO1xyXG5cdFx0XHR9LFxyXG5cclxuXHRcdFx0c2V0TGF0TG5nczogZnVuY3Rpb24gKGxhdGxuZ3MpIHtcclxuXHRcdFx0XHR2YXIgaSA9IDAsXHJcblx0XHRcdFx0ICAgIGxlbiA9IGxhdGxuZ3MubGVuZ3RoO1xyXG5cclxuXHRcdFx0XHR0aGlzLmVhY2hMYXllcihmdW5jdGlvbiAobGF5ZXIpIHtcclxuXHRcdFx0XHRcdGlmIChpIDwgbGVuKSB7XHJcblx0XHRcdFx0XHRcdGxheWVyLnNldExhdExuZ3MobGF0bG5nc1tpKytdKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRoaXMucmVtb3ZlTGF5ZXIobGF5ZXIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0sIHRoaXMpO1xyXG5cclxuXHRcdFx0XHR3aGlsZSAoaSA8IGxlbikge1xyXG5cdFx0XHRcdFx0dGhpcy5hZGRMYXllcihuZXcgS2xhc3MobGF0bG5nc1tpKytdLCB0aGlzLl9vcHRpb25zKSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGdldExhdExuZ3M6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHR2YXIgbGF0bG5ncyA9IFtdO1xyXG5cclxuXHRcdFx0XHR0aGlzLmVhY2hMYXllcihmdW5jdGlvbiAobGF5ZXIpIHtcclxuXHRcdFx0XHRcdGxhdGxuZ3MucHVzaChsYXllci5nZXRMYXRMbmdzKCkpO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gbGF0bG5ncztcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRMLk11bHRpUG9seWxpbmUgPSBjcmVhdGVNdWx0aShMLlBvbHlsaW5lKTtcclxuXHRMLk11bHRpUG9seWdvbiA9IGNyZWF0ZU11bHRpKEwuUG9seWdvbik7XHJcblxyXG5cdEwubXVsdGlQb2x5bGluZSA9IGZ1bmN0aW9uIChsYXRsbmdzLCBvcHRpb25zKSB7XHJcblx0XHRyZXR1cm4gbmV3IEwuTXVsdGlQb2x5bGluZShsYXRsbmdzLCBvcHRpb25zKTtcclxuXHR9O1xyXG5cclxuXHRMLm11bHRpUG9seWdvbiA9IGZ1bmN0aW9uIChsYXRsbmdzLCBvcHRpb25zKSB7XHJcblx0XHRyZXR1cm4gbmV3IEwuTXVsdGlQb2x5Z29uKGxhdGxuZ3MsIG9wdGlvbnMpO1xyXG5cdH07XHJcbn0oKSk7XHJcblxuXG4vKlxyXG4gKiBMLlJlY3RhbmdsZSBleHRlbmRzIFBvbHlnb24gYW5kIGNyZWF0ZXMgYSByZWN0YW5nbGUgd2hlbiBwYXNzZWQgYSBMYXRMbmdCb3VuZHMgb2JqZWN0LlxyXG4gKi9cclxuXHJcbkwuUmVjdGFuZ2xlID0gTC5Qb2x5Z29uLmV4dGVuZCh7XHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKGxhdExuZ0JvdW5kcywgb3B0aW9ucykge1xyXG5cdFx0TC5Qb2x5Z29uLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgdGhpcy5fYm91bmRzVG9MYXRMbmdzKGxhdExuZ0JvdW5kcyksIG9wdGlvbnMpO1xyXG5cdH0sXHJcblxyXG5cdHNldEJvdW5kczogZnVuY3Rpb24gKGxhdExuZ0JvdW5kcykge1xyXG5cdFx0dGhpcy5zZXRMYXRMbmdzKHRoaXMuX2JvdW5kc1RvTGF0TG5ncyhsYXRMbmdCb3VuZHMpKTtcclxuXHR9LFxyXG5cclxuXHRfYm91bmRzVG9MYXRMbmdzOiBmdW5jdGlvbiAobGF0TG5nQm91bmRzKSB7XHJcblx0XHRsYXRMbmdCb3VuZHMgPSBMLmxhdExuZ0JvdW5kcyhsYXRMbmdCb3VuZHMpO1xyXG5cdFx0cmV0dXJuIFtcclxuXHRcdFx0bGF0TG5nQm91bmRzLmdldFNvdXRoV2VzdCgpLFxyXG5cdFx0XHRsYXRMbmdCb3VuZHMuZ2V0Tm9ydGhXZXN0KCksXHJcblx0XHRcdGxhdExuZ0JvdW5kcy5nZXROb3J0aEVhc3QoKSxcclxuXHRcdFx0bGF0TG5nQm91bmRzLmdldFNvdXRoRWFzdCgpXHJcblx0XHRdO1xyXG5cdH1cclxufSk7XHJcblxyXG5MLnJlY3RhbmdsZSA9IGZ1bmN0aW9uIChsYXRMbmdCb3VuZHMsIG9wdGlvbnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuUmVjdGFuZ2xlKGxhdExuZ0JvdW5kcywgb3B0aW9ucyk7XHJcbn07XHJcblxuXG4vKlxyXG4gKiBMLkNpcmNsZSBpcyBhIGNpcmNsZSBvdmVybGF5ICh3aXRoIGEgY2VydGFpbiByYWRpdXMgaW4gbWV0ZXJzKS5cclxuICovXHJcblxyXG5MLkNpcmNsZSA9IEwuUGF0aC5leHRlbmQoe1xyXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uIChsYXRsbmcsIHJhZGl1cywgb3B0aW9ucykge1xyXG5cdFx0TC5QYXRoLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgb3B0aW9ucyk7XHJcblxyXG5cdFx0dGhpcy5fbGF0bG5nID0gTC5sYXRMbmcobGF0bG5nKTtcclxuXHRcdHRoaXMuX21SYWRpdXMgPSByYWRpdXM7XHJcblx0fSxcclxuXHJcblx0b3B0aW9uczoge1xyXG5cdFx0ZmlsbDogdHJ1ZVxyXG5cdH0sXHJcblxyXG5cdHNldExhdExuZzogZnVuY3Rpb24gKGxhdGxuZykge1xyXG5cdFx0dGhpcy5fbGF0bG5nID0gTC5sYXRMbmcobGF0bG5nKTtcclxuXHRcdHJldHVybiB0aGlzLnJlZHJhdygpO1xyXG5cdH0sXHJcblxyXG5cdHNldFJhZGl1czogZnVuY3Rpb24gKHJhZGl1cykge1xyXG5cdFx0dGhpcy5fbVJhZGl1cyA9IHJhZGl1cztcclxuXHRcdHJldHVybiB0aGlzLnJlZHJhdygpO1xyXG5cdH0sXHJcblxyXG5cdHByb2plY3RMYXRsbmdzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgbG5nUmFkaXVzID0gdGhpcy5fZ2V0TG5nUmFkaXVzKCksXHJcblx0XHQgICAgbGF0bG5nID0gdGhpcy5fbGF0bG5nLFxyXG5cdFx0ICAgIHBvaW50TGVmdCA9IHRoaXMuX21hcC5sYXRMbmdUb0xheWVyUG9pbnQoW2xhdGxuZy5sYXQsIGxhdGxuZy5sbmcgLSBsbmdSYWRpdXNdKTtcclxuXHJcblx0XHR0aGlzLl9wb2ludCA9IHRoaXMuX21hcC5sYXRMbmdUb0xheWVyUG9pbnQobGF0bG5nKTtcclxuXHRcdHRoaXMuX3JhZGl1cyA9IE1hdGgubWF4KHRoaXMuX3BvaW50LnggLSBwb2ludExlZnQueCwgMSk7XHJcblx0fSxcclxuXHJcblx0Z2V0Qm91bmRzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgbG5nUmFkaXVzID0gdGhpcy5fZ2V0TG5nUmFkaXVzKCksXHJcblx0XHQgICAgbGF0UmFkaXVzID0gKHRoaXMuX21SYWRpdXMgLyA0MDA3NTAxNykgKiAzNjAsXHJcblx0XHQgICAgbGF0bG5nID0gdGhpcy5fbGF0bG5nO1xyXG5cclxuXHRcdHJldHVybiBuZXcgTC5MYXRMbmdCb3VuZHMoXHJcblx0XHQgICAgICAgIFtsYXRsbmcubGF0IC0gbGF0UmFkaXVzLCBsYXRsbmcubG5nIC0gbG5nUmFkaXVzXSxcclxuXHRcdCAgICAgICAgW2xhdGxuZy5sYXQgKyBsYXRSYWRpdXMsIGxhdGxuZy5sbmcgKyBsbmdSYWRpdXNdKTtcclxuXHR9LFxyXG5cclxuXHRnZXRMYXRMbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9sYXRsbmc7XHJcblx0fSxcclxuXHJcblx0Z2V0UGF0aFN0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHAgPSB0aGlzLl9wb2ludCxcclxuXHRcdCAgICByID0gdGhpcy5fcmFkaXVzO1xyXG5cclxuXHRcdGlmICh0aGlzLl9jaGVja0lmRW1wdHkoKSkge1xyXG5cdFx0XHRyZXR1cm4gJyc7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKEwuQnJvd3Nlci5zdmcpIHtcclxuXHRcdFx0cmV0dXJuICdNJyArIHAueCArICcsJyArIChwLnkgLSByKSArXHJcblx0XHRcdCAgICAgICAnQScgKyByICsgJywnICsgciArICcsMCwxLDEsJyArXHJcblx0XHRcdCAgICAgICAocC54IC0gMC4xKSArICcsJyArIChwLnkgLSByKSArICcgeic7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRwLl9yb3VuZCgpO1xyXG5cdFx0XHRyID0gTWF0aC5yb3VuZChyKTtcclxuXHRcdFx0cmV0dXJuICdBTCAnICsgcC54ICsgJywnICsgcC55ICsgJyAnICsgciArICcsJyArIHIgKyAnIDAsJyArICg2NTUzNSAqIDM2MCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0Z2V0UmFkaXVzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fbVJhZGl1cztcclxuXHR9LFxyXG5cclxuXHQvLyBUT0RPIEVhcnRoIGhhcmRjb2RlZCwgbW92ZSBpbnRvIHByb2plY3Rpb24gY29kZSFcclxuXHJcblx0X2dldExhdFJhZGl1czogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuICh0aGlzLl9tUmFkaXVzIC8gNDAwNzUwMTcpICogMzYwO1xyXG5cdH0sXHJcblxyXG5cdF9nZXRMbmdSYWRpdXM6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9nZXRMYXRSYWRpdXMoKSAvIE1hdGguY29zKEwuTGF0TG5nLkRFR19UT19SQUQgKiB0aGlzLl9sYXRsbmcubGF0KTtcclxuXHR9LFxyXG5cclxuXHRfY2hlY2tJZkVtcHR5OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX21hcCkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHR2YXIgdnAgPSB0aGlzLl9tYXAuX3BhdGhWaWV3cG9ydCxcclxuXHRcdCAgICByID0gdGhpcy5fcmFkaXVzLFxyXG5cdFx0ICAgIHAgPSB0aGlzLl9wb2ludDtcclxuXHJcblx0XHRyZXR1cm4gcC54IC0gciA+IHZwLm1heC54IHx8IHAueSAtIHIgPiB2cC5tYXgueSB8fFxyXG5cdFx0ICAgICAgIHAueCArIHIgPCB2cC5taW4ueCB8fCBwLnkgKyByIDwgdnAubWluLnk7XHJcblx0fVxyXG59KTtcclxuXHJcbkwuY2lyY2xlID0gZnVuY3Rpb24gKGxhdGxuZywgcmFkaXVzLCBvcHRpb25zKSB7XHJcblx0cmV0dXJuIG5ldyBMLkNpcmNsZShsYXRsbmcsIHJhZGl1cywgb3B0aW9ucyk7XHJcbn07XHJcblxuXG4vKlxyXG4gKiBMLkNpcmNsZU1hcmtlciBpcyBhIGNpcmNsZSBvdmVybGF5IHdpdGggYSBwZXJtYW5lbnQgcGl4ZWwgcmFkaXVzLlxyXG4gKi9cclxuXHJcbkwuQ2lyY2xlTWFya2VyID0gTC5DaXJjbGUuZXh0ZW5kKHtcclxuXHRvcHRpb25zOiB7XHJcblx0XHRyYWRpdXM6IDEwLFxyXG5cdFx0d2VpZ2h0OiAyXHJcblx0fSxcclxuXHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKGxhdGxuZywgb3B0aW9ucykge1xyXG5cdFx0TC5DaXJjbGUucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBsYXRsbmcsIG51bGwsIG9wdGlvbnMpO1xyXG5cdFx0dGhpcy5fcmFkaXVzID0gdGhpcy5vcHRpb25zLnJhZGl1cztcclxuXHR9LFxyXG5cclxuXHRwcm9qZWN0TGF0bG5nczogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy5fcG9pbnQgPSB0aGlzLl9tYXAubGF0TG5nVG9MYXllclBvaW50KHRoaXMuX2xhdGxuZyk7XHJcblx0fSxcclxuXHJcblx0X3VwZGF0ZVN0eWxlIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0TC5DaXJjbGUucHJvdG90eXBlLl91cGRhdGVTdHlsZS5jYWxsKHRoaXMpO1xyXG5cdFx0dGhpcy5zZXRSYWRpdXModGhpcy5vcHRpb25zLnJhZGl1cyk7XHJcblx0fSxcclxuXHJcblx0c2V0TGF0TG5nOiBmdW5jdGlvbiAobGF0bG5nKSB7XHJcblx0XHRMLkNpcmNsZS5wcm90b3R5cGUuc2V0TGF0TG5nLmNhbGwodGhpcywgbGF0bG5nKTtcclxuXHRcdGlmICh0aGlzLl9wb3B1cCAmJiB0aGlzLl9wb3B1cC5faXNPcGVuKSB7XHJcblx0XHRcdHRoaXMuX3BvcHVwLnNldExhdExuZyhsYXRsbmcpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0c2V0UmFkaXVzOiBmdW5jdGlvbiAocmFkaXVzKSB7XHJcblx0XHR0aGlzLm9wdGlvbnMucmFkaXVzID0gdGhpcy5fcmFkaXVzID0gcmFkaXVzO1xyXG5cdFx0cmV0dXJuIHRoaXMucmVkcmF3KCk7XHJcblx0fSxcclxuXHJcblx0Z2V0UmFkaXVzOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fcmFkaXVzO1xyXG5cdH1cclxufSk7XHJcblxyXG5MLmNpcmNsZU1hcmtlciA9IGZ1bmN0aW9uIChsYXRsbmcsIG9wdGlvbnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuQ2lyY2xlTWFya2VyKGxhdGxuZywgb3B0aW9ucyk7XHJcbn07XHJcblxuXG4vKlxyXG4gKiBFeHRlbmRzIEwuUG9seWxpbmUgdG8gYmUgYWJsZSB0byBtYW51YWxseSBkZXRlY3QgY2xpY2tzIG9uIENhbnZhcy1yZW5kZXJlZCBwb2x5bGluZXMuXHJcbiAqL1xyXG5cclxuTC5Qb2x5bGluZS5pbmNsdWRlKCFMLlBhdGguQ0FOVkFTID8ge30gOiB7XHJcblx0X2NvbnRhaW5zUG9pbnQ6IGZ1bmN0aW9uIChwLCBjbG9zZWQpIHtcclxuXHRcdHZhciBpLCBqLCBrLCBsZW4sIGxlbjIsIGRpc3QsIHBhcnQsXHJcblx0XHQgICAgdyA9IHRoaXMub3B0aW9ucy53ZWlnaHQgLyAyO1xyXG5cclxuXHRcdGlmIChMLkJyb3dzZXIudG91Y2gpIHtcclxuXHRcdFx0dyArPSAxMDsgLy8gcG9seWxpbmUgY2xpY2sgdG9sZXJhbmNlIG9uIHRvdWNoIGRldmljZXNcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSB0aGlzLl9wYXJ0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRwYXJ0ID0gdGhpcy5fcGFydHNbaV07XHJcblx0XHRcdGZvciAoaiA9IDAsIGxlbjIgPSBwYXJ0Lmxlbmd0aCwgayA9IGxlbjIgLSAxOyBqIDwgbGVuMjsgayA9IGorKykge1xyXG5cdFx0XHRcdGlmICghY2xvc2VkICYmIChqID09PSAwKSkge1xyXG5cdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRkaXN0ID0gTC5MaW5lVXRpbC5wb2ludFRvU2VnbWVudERpc3RhbmNlKHAsIHBhcnRba10sIHBhcnRbal0pO1xyXG5cclxuXHRcdFx0XHRpZiAoZGlzdCA8PSB3KSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcbn0pO1xyXG5cblxuLypcclxuICogRXh0ZW5kcyBMLlBvbHlnb24gdG8gYmUgYWJsZSB0byBtYW51YWxseSBkZXRlY3QgY2xpY2tzIG9uIENhbnZhcy1yZW5kZXJlZCBwb2x5Z29ucy5cclxuICovXHJcblxyXG5MLlBvbHlnb24uaW5jbHVkZSghTC5QYXRoLkNBTlZBUyA/IHt9IDoge1xyXG5cdF9jb250YWluc1BvaW50OiBmdW5jdGlvbiAocCkge1xyXG5cdFx0dmFyIGluc2lkZSA9IGZhbHNlLFxyXG5cdFx0ICAgIHBhcnQsIHAxLCBwMixcclxuXHRcdCAgICBpLCBqLCBrLFxyXG5cdFx0ICAgIGxlbiwgbGVuMjtcclxuXHJcblx0XHQvLyBUT0RPIG9wdGltaXphdGlvbjogY2hlY2sgaWYgd2l0aGluIGJvdW5kcyBmaXJzdFxyXG5cclxuXHRcdGlmIChMLlBvbHlsaW5lLnByb3RvdHlwZS5fY29udGFpbnNQb2ludC5jYWxsKHRoaXMsIHAsIHRydWUpKSB7XHJcblx0XHRcdC8vIGNsaWNrIG9uIHBvbHlnb24gYm9yZGVyXHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHJheSBjYXN0aW5nIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGlmIHBvaW50IGlzIGluIHBvbHlnb25cclxuXHJcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSB0aGlzLl9wYXJ0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRwYXJ0ID0gdGhpcy5fcGFydHNbaV07XHJcblxyXG5cdFx0XHRmb3IgKGogPSAwLCBsZW4yID0gcGFydC5sZW5ndGgsIGsgPSBsZW4yIC0gMTsgaiA8IGxlbjI7IGsgPSBqKyspIHtcclxuXHRcdFx0XHRwMSA9IHBhcnRbal07XHJcblx0XHRcdFx0cDIgPSBwYXJ0W2tdO1xyXG5cclxuXHRcdFx0XHRpZiAoKChwMS55ID4gcC55KSAhPT0gKHAyLnkgPiBwLnkpKSAmJlxyXG5cdFx0XHRcdFx0XHQocC54IDwgKHAyLnggLSBwMS54KSAqIChwLnkgLSBwMS55KSAvIChwMi55IC0gcDEueSkgKyBwMS54KSkge1xyXG5cdFx0XHRcdFx0aW5zaWRlID0gIWluc2lkZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gaW5zaWRlO1xyXG5cdH1cclxufSk7XHJcblxuXG4vKlxyXG4gKiBFeHRlbmRzIEwuQ2lyY2xlIHdpdGggQ2FudmFzLXNwZWNpZmljIGNvZGUuXHJcbiAqL1xyXG5cclxuTC5DaXJjbGUuaW5jbHVkZSghTC5QYXRoLkNBTlZBUyA/IHt9IDoge1xyXG5cdF9kcmF3UGF0aDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHAgPSB0aGlzLl9wb2ludDtcclxuXHRcdHRoaXMuX2N0eC5iZWdpblBhdGgoKTtcclxuXHRcdHRoaXMuX2N0eC5hcmMocC54LCBwLnksIHRoaXMuX3JhZGl1cywgMCwgTWF0aC5QSSAqIDIsIGZhbHNlKTtcclxuXHR9LFxyXG5cclxuXHRfY29udGFpbnNQb2ludDogZnVuY3Rpb24gKHApIHtcclxuXHRcdHZhciBjZW50ZXIgPSB0aGlzLl9wb2ludCxcclxuXHRcdCAgICB3MiA9IHRoaXMub3B0aW9ucy5zdHJva2UgPyB0aGlzLm9wdGlvbnMud2VpZ2h0IC8gMiA6IDA7XHJcblxyXG5cdFx0cmV0dXJuIChwLmRpc3RhbmNlVG8oY2VudGVyKSA8PSB0aGlzLl9yYWRpdXMgKyB3Mik7XHJcblx0fVxyXG59KTtcclxuXG5cbi8qXG4gKiBDaXJjbGVNYXJrZXIgY2FudmFzIHNwZWNpZmljIGRyYXdpbmcgcGFydHMuXG4gKi9cblxuTC5DaXJjbGVNYXJrZXIuaW5jbHVkZSghTC5QYXRoLkNBTlZBUyA/IHt9IDoge1xuXHRfdXBkYXRlU3R5bGU6IGZ1bmN0aW9uICgpIHtcblx0XHRMLlBhdGgucHJvdG90eXBlLl91cGRhdGVTdHlsZS5jYWxsKHRoaXMpO1xuXHR9XG59KTtcblxuXG4vKlxyXG4gKiBMLkdlb0pTT04gdHVybnMgYW55IEdlb0pTT04gZGF0YSBpbnRvIGEgTGVhZmxldCBsYXllci5cclxuICovXHJcblxyXG5MLkdlb0pTT04gPSBMLkZlYXR1cmVHcm91cC5leHRlbmQoe1xyXG5cclxuXHRpbml0aWFsaXplOiBmdW5jdGlvbiAoZ2VvanNvbiwgb3B0aW9ucykge1xyXG5cdFx0TC5zZXRPcHRpb25zKHRoaXMsIG9wdGlvbnMpO1xyXG5cclxuXHRcdHRoaXMuX2xheWVycyA9IHt9O1xyXG5cclxuXHRcdGlmIChnZW9qc29uKSB7XHJcblx0XHRcdHRoaXMuYWRkRGF0YShnZW9qc29uKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRhZGREYXRhOiBmdW5jdGlvbiAoZ2VvanNvbikge1xyXG5cdFx0dmFyIGZlYXR1cmVzID0gTC5VdGlsLmlzQXJyYXkoZ2VvanNvbikgPyBnZW9qc29uIDogZ2VvanNvbi5mZWF0dXJlcyxcclxuXHRcdCAgICBpLCBsZW4sIGZlYXR1cmU7XHJcblxyXG5cdFx0aWYgKGZlYXR1cmVzKSB7XHJcblx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IGZlYXR1cmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdFx0Ly8gT25seSBhZGQgdGhpcyBpZiBnZW9tZXRyeSBvciBnZW9tZXRyaWVzIGFyZSBzZXQgYW5kIG5vdCBudWxsXHJcblx0XHRcdFx0ZmVhdHVyZSA9IGZlYXR1cmVzW2ldO1xyXG5cdFx0XHRcdGlmIChmZWF0dXJlLmdlb21ldHJpZXMgfHwgZmVhdHVyZS5nZW9tZXRyeSB8fCBmZWF0dXJlLmZlYXR1cmVzIHx8IGZlYXR1cmUuY29vcmRpbmF0ZXMpIHtcclxuXHRcdFx0XHRcdHRoaXMuYWRkRGF0YShmZWF0dXJlc1tpXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLmZpbHRlciAmJiAhb3B0aW9ucy5maWx0ZXIoZ2VvanNvbikpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0dmFyIGxheWVyID0gTC5HZW9KU09OLmdlb21ldHJ5VG9MYXllcihnZW9qc29uLCBvcHRpb25zLnBvaW50VG9MYXllciwgb3B0aW9ucy5jb29yZHNUb0xhdExuZywgb3B0aW9ucyk7XHJcblx0XHRsYXllci5mZWF0dXJlID0gTC5HZW9KU09OLmFzRmVhdHVyZShnZW9qc29uKTtcclxuXHJcblx0XHRsYXllci5kZWZhdWx0T3B0aW9ucyA9IGxheWVyLm9wdGlvbnM7XHJcblx0XHR0aGlzLnJlc2V0U3R5bGUobGF5ZXIpO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLm9uRWFjaEZlYXR1cmUpIHtcclxuXHRcdFx0b3B0aW9ucy5vbkVhY2hGZWF0dXJlKGdlb2pzb24sIGxheWVyKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5hZGRMYXllcihsYXllcik7XHJcblx0fSxcclxuXHJcblx0cmVzZXRTdHlsZTogZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHR2YXIgc3R5bGUgPSB0aGlzLm9wdGlvbnMuc3R5bGU7XHJcblx0XHRpZiAoc3R5bGUpIHtcclxuXHRcdFx0Ly8gcmVzZXQgYW55IGN1c3RvbSBzdHlsZXNcclxuXHRcdFx0TC5VdGlsLmV4dGVuZChsYXllci5vcHRpb25zLCBsYXllci5kZWZhdWx0T3B0aW9ucyk7XHJcblxyXG5cdFx0XHR0aGlzLl9zZXRMYXllclN0eWxlKGxheWVyLCBzdHlsZSk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0c2V0U3R5bGU6IGZ1bmN0aW9uIChzdHlsZSkge1xyXG5cdFx0dGhpcy5lYWNoTGF5ZXIoZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHRcdHRoaXMuX3NldExheWVyU3R5bGUobGF5ZXIsIHN0eWxlKTtcclxuXHRcdH0sIHRoaXMpO1xyXG5cdH0sXHJcblxyXG5cdF9zZXRMYXllclN0eWxlOiBmdW5jdGlvbiAobGF5ZXIsIHN0eWxlKSB7XHJcblx0XHRpZiAodHlwZW9mIHN0eWxlID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdHN0eWxlID0gc3R5bGUobGF5ZXIuZmVhdHVyZSk7XHJcblx0XHR9XHJcblx0XHRpZiAobGF5ZXIuc2V0U3R5bGUpIHtcclxuXHRcdFx0bGF5ZXIuc2V0U3R5bGUoc3R5bGUpO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcblxyXG5MLmV4dGVuZChMLkdlb0pTT04sIHtcclxuXHRnZW9tZXRyeVRvTGF5ZXI6IGZ1bmN0aW9uIChnZW9qc29uLCBwb2ludFRvTGF5ZXIsIGNvb3Jkc1RvTGF0TG5nLCB2ZWN0b3JPcHRpb25zKSB7XHJcblx0XHR2YXIgZ2VvbWV0cnkgPSBnZW9qc29uLnR5cGUgPT09ICdGZWF0dXJlJyA/IGdlb2pzb24uZ2VvbWV0cnkgOiBnZW9qc29uLFxyXG5cdFx0ICAgIGNvb3JkcyA9IGdlb21ldHJ5LmNvb3JkaW5hdGVzLFxyXG5cdFx0ICAgIGxheWVycyA9IFtdLFxyXG5cdFx0ICAgIGxhdGxuZywgbGF0bG5ncywgaSwgbGVuO1xyXG5cclxuXHRcdGNvb3Jkc1RvTGF0TG5nID0gY29vcmRzVG9MYXRMbmcgfHwgdGhpcy5jb29yZHNUb0xhdExuZztcclxuXHJcblx0XHRzd2l0Y2ggKGdlb21ldHJ5LnR5cGUpIHtcclxuXHRcdGNhc2UgJ1BvaW50JzpcclxuXHRcdFx0bGF0bG5nID0gY29vcmRzVG9MYXRMbmcoY29vcmRzKTtcclxuXHRcdFx0cmV0dXJuIHBvaW50VG9MYXllciA/IHBvaW50VG9MYXllcihnZW9qc29uLCBsYXRsbmcpIDogbmV3IEwuTWFya2VyKGxhdGxuZyk7XHJcblxyXG5cdFx0Y2FzZSAnTXVsdGlQb2ludCc6XHJcblx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IGNvb3Jkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRcdGxhdGxuZyA9IGNvb3Jkc1RvTGF0TG5nKGNvb3Jkc1tpXSk7XHJcblx0XHRcdFx0bGF5ZXJzLnB1c2gocG9pbnRUb0xheWVyID8gcG9pbnRUb0xheWVyKGdlb2pzb24sIGxhdGxuZykgOiBuZXcgTC5NYXJrZXIobGF0bG5nKSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIG5ldyBMLkZlYXR1cmVHcm91cChsYXllcnMpO1xyXG5cclxuXHRcdGNhc2UgJ0xpbmVTdHJpbmcnOlxyXG5cdFx0XHRsYXRsbmdzID0gdGhpcy5jb29yZHNUb0xhdExuZ3MoY29vcmRzLCAwLCBjb29yZHNUb0xhdExuZyk7XHJcblx0XHRcdHJldHVybiBuZXcgTC5Qb2x5bGluZShsYXRsbmdzLCB2ZWN0b3JPcHRpb25zKTtcclxuXHJcblx0XHRjYXNlICdQb2x5Z29uJzpcclxuXHRcdFx0aWYgKGNvb3Jkcy5sZW5ndGggPT09IDIgJiYgIWNvb3Jkc1sxXS5sZW5ndGgpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgR2VvSlNPTiBvYmplY3QuJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0bGF0bG5ncyA9IHRoaXMuY29vcmRzVG9MYXRMbmdzKGNvb3JkcywgMSwgY29vcmRzVG9MYXRMbmcpO1xyXG5cdFx0XHRyZXR1cm4gbmV3IEwuUG9seWdvbihsYXRsbmdzLCB2ZWN0b3JPcHRpb25zKTtcclxuXHJcblx0XHRjYXNlICdNdWx0aUxpbmVTdHJpbmcnOlxyXG5cdFx0XHRsYXRsbmdzID0gdGhpcy5jb29yZHNUb0xhdExuZ3MoY29vcmRzLCAxLCBjb29yZHNUb0xhdExuZyk7XHJcblx0XHRcdHJldHVybiBuZXcgTC5NdWx0aVBvbHlsaW5lKGxhdGxuZ3MsIHZlY3Rvck9wdGlvbnMpO1xyXG5cclxuXHRcdGNhc2UgJ011bHRpUG9seWdvbic6XHJcblx0XHRcdGxhdGxuZ3MgPSB0aGlzLmNvb3Jkc1RvTGF0TG5ncyhjb29yZHMsIDIsIGNvb3Jkc1RvTGF0TG5nKTtcclxuXHRcdFx0cmV0dXJuIG5ldyBMLk11bHRpUG9seWdvbihsYXRsbmdzLCB2ZWN0b3JPcHRpb25zKTtcclxuXHJcblx0XHRjYXNlICdHZW9tZXRyeUNvbGxlY3Rpb24nOlxyXG5cdFx0XHRmb3IgKGkgPSAwLCBsZW4gPSBnZW9tZXRyeS5nZW9tZXRyaWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblxyXG5cdFx0XHRcdGxheWVycy5wdXNoKHRoaXMuZ2VvbWV0cnlUb0xheWVyKHtcclxuXHRcdFx0XHRcdGdlb21ldHJ5OiBnZW9tZXRyeS5nZW9tZXRyaWVzW2ldLFxyXG5cdFx0XHRcdFx0dHlwZTogJ0ZlYXR1cmUnLFxyXG5cdFx0XHRcdFx0cHJvcGVydGllczogZ2VvanNvbi5wcm9wZXJ0aWVzXHJcblx0XHRcdFx0fSwgcG9pbnRUb0xheWVyLCBjb29yZHNUb0xhdExuZywgdmVjdG9yT3B0aW9ucykpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBuZXcgTC5GZWF0dXJlR3JvdXAobGF5ZXJzKTtcclxuXHJcblx0XHRkZWZhdWx0OlxyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgR2VvSlNPTiBvYmplY3QuJyk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0Y29vcmRzVG9MYXRMbmc6IGZ1bmN0aW9uIChjb29yZHMpIHsgLy8gKEFycmF5WywgQm9vbGVhbl0pIC0+IExhdExuZ1xyXG5cdFx0cmV0dXJuIG5ldyBMLkxhdExuZyhjb29yZHNbMV0sIGNvb3Jkc1swXSwgY29vcmRzWzJdKTtcclxuXHR9LFxyXG5cclxuXHRjb29yZHNUb0xhdExuZ3M6IGZ1bmN0aW9uIChjb29yZHMsIGxldmVsc0RlZXAsIGNvb3Jkc1RvTGF0TG5nKSB7IC8vIChBcnJheVssIE51bWJlciwgRnVuY3Rpb25dKSAtPiBBcnJheVxyXG5cdFx0dmFyIGxhdGxuZywgaSwgbGVuLFxyXG5cdFx0ICAgIGxhdGxuZ3MgPSBbXTtcclxuXHJcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBjb29yZHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0bGF0bG5nID0gbGV2ZWxzRGVlcCA/XHJcblx0XHRcdCAgICAgICAgdGhpcy5jb29yZHNUb0xhdExuZ3MoY29vcmRzW2ldLCBsZXZlbHNEZWVwIC0gMSwgY29vcmRzVG9MYXRMbmcpIDpcclxuXHRcdFx0ICAgICAgICAoY29vcmRzVG9MYXRMbmcgfHwgdGhpcy5jb29yZHNUb0xhdExuZykoY29vcmRzW2ldKTtcclxuXHJcblx0XHRcdGxhdGxuZ3MucHVzaChsYXRsbmcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBsYXRsbmdzO1xyXG5cdH0sXHJcblxyXG5cdGxhdExuZ1RvQ29vcmRzOiBmdW5jdGlvbiAobGF0bG5nKSB7XHJcblx0XHR2YXIgY29vcmRzID0gW2xhdGxuZy5sbmcsIGxhdGxuZy5sYXRdO1xyXG5cclxuXHRcdGlmIChsYXRsbmcuYWx0ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0Y29vcmRzLnB1c2gobGF0bG5nLmFsdCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gY29vcmRzO1xyXG5cdH0sXHJcblxyXG5cdGxhdExuZ3NUb0Nvb3JkczogZnVuY3Rpb24gKGxhdExuZ3MpIHtcclxuXHRcdHZhciBjb29yZHMgPSBbXTtcclxuXHJcblx0XHRmb3IgKHZhciBpID0gMCwgbGVuID0gbGF0TG5ncy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG5cdFx0XHRjb29yZHMucHVzaChMLkdlb0pTT04ubGF0TG5nVG9Db29yZHMobGF0TG5nc1tpXSkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBjb29yZHM7XHJcblx0fSxcclxuXHJcblx0Z2V0RmVhdHVyZTogZnVuY3Rpb24gKGxheWVyLCBuZXdHZW9tZXRyeSkge1xyXG5cdFx0cmV0dXJuIGxheWVyLmZlYXR1cmUgPyBMLmV4dGVuZCh7fSwgbGF5ZXIuZmVhdHVyZSwge2dlb21ldHJ5OiBuZXdHZW9tZXRyeX0pIDogTC5HZW9KU09OLmFzRmVhdHVyZShuZXdHZW9tZXRyeSk7XHJcblx0fSxcclxuXHJcblx0YXNGZWF0dXJlOiBmdW5jdGlvbiAoZ2VvSlNPTikge1xyXG5cdFx0aWYgKGdlb0pTT04udHlwZSA9PT0gJ0ZlYXR1cmUnKSB7XHJcblx0XHRcdHJldHVybiBnZW9KU09OO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHR5cGU6ICdGZWF0dXJlJyxcclxuXHRcdFx0cHJvcGVydGllczoge30sXHJcblx0XHRcdGdlb21ldHJ5OiBnZW9KU09OXHJcblx0XHR9O1xyXG5cdH1cclxufSk7XHJcblxyXG52YXIgUG9pbnRUb0dlb0pTT04gPSB7XHJcblx0dG9HZW9KU09OOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gTC5HZW9KU09OLmdldEZlYXR1cmUodGhpcywge1xyXG5cdFx0XHR0eXBlOiAnUG9pbnQnLFxyXG5cdFx0XHRjb29yZGluYXRlczogTC5HZW9KU09OLmxhdExuZ1RvQ29vcmRzKHRoaXMuZ2V0TGF0TG5nKCkpXHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG5MLk1hcmtlci5pbmNsdWRlKFBvaW50VG9HZW9KU09OKTtcclxuTC5DaXJjbGUuaW5jbHVkZShQb2ludFRvR2VvSlNPTik7XHJcbkwuQ2lyY2xlTWFya2VyLmluY2x1ZGUoUG9pbnRUb0dlb0pTT04pO1xyXG5cclxuTC5Qb2x5bGluZS5pbmNsdWRlKHtcclxuXHR0b0dlb0pTT046IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiBMLkdlb0pTT04uZ2V0RmVhdHVyZSh0aGlzLCB7XHJcblx0XHRcdHR5cGU6ICdMaW5lU3RyaW5nJyxcclxuXHRcdFx0Y29vcmRpbmF0ZXM6IEwuR2VvSlNPTi5sYXRMbmdzVG9Db29yZHModGhpcy5nZXRMYXRMbmdzKCkpXHJcblx0XHR9KTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5Qb2x5Z29uLmluY2x1ZGUoe1xyXG5cdHRvR2VvSlNPTjogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGNvb3JkcyA9IFtMLkdlb0pTT04ubGF0TG5nc1RvQ29vcmRzKHRoaXMuZ2V0TGF0TG5ncygpKV0sXHJcblx0XHQgICAgaSwgbGVuLCBob2xlO1xyXG5cclxuXHRcdGNvb3Jkc1swXS5wdXNoKGNvb3Jkc1swXVswXSk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2hvbGVzKSB7XHJcblx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IHRoaXMuX2hvbGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcblx0XHRcdFx0aG9sZSA9IEwuR2VvSlNPTi5sYXRMbmdzVG9Db29yZHModGhpcy5faG9sZXNbaV0pO1xyXG5cdFx0XHRcdGhvbGUucHVzaChob2xlWzBdKTtcclxuXHRcdFx0XHRjb29yZHMucHVzaChob2xlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBMLkdlb0pTT04uZ2V0RmVhdHVyZSh0aGlzLCB7XHJcblx0XHRcdHR5cGU6ICdQb2x5Z29uJyxcclxuXHRcdFx0Y29vcmRpbmF0ZXM6IGNvb3Jkc1xyXG5cdFx0fSk7XHJcblx0fVxyXG59KTtcclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcblx0ZnVuY3Rpb24gbXVsdGlUb0dlb0pTT04odHlwZSkge1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dmFyIGNvb3JkcyA9IFtdO1xyXG5cclxuXHRcdFx0dGhpcy5lYWNoTGF5ZXIoZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHRcdFx0Y29vcmRzLnB1c2gobGF5ZXIudG9HZW9KU09OKCkuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHJldHVybiBMLkdlb0pTT04uZ2V0RmVhdHVyZSh0aGlzLCB7XHJcblx0XHRcdFx0dHlwZTogdHlwZSxcclxuXHRcdFx0XHRjb29yZGluYXRlczogY29vcmRzXHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdEwuTXVsdGlQb2x5bGluZS5pbmNsdWRlKHt0b0dlb0pTT046IG11bHRpVG9HZW9KU09OKCdNdWx0aUxpbmVTdHJpbmcnKX0pO1xyXG5cdEwuTXVsdGlQb2x5Z29uLmluY2x1ZGUoe3RvR2VvSlNPTjogbXVsdGlUb0dlb0pTT04oJ011bHRpUG9seWdvbicpfSk7XHJcblxyXG5cdEwuTGF5ZXJHcm91cC5pbmNsdWRlKHtcclxuXHRcdHRvR2VvSlNPTjogZnVuY3Rpb24gKCkge1xyXG5cclxuXHRcdFx0dmFyIGdlb21ldHJ5ID0gdGhpcy5mZWF0dXJlICYmIHRoaXMuZmVhdHVyZS5nZW9tZXRyeSxcclxuXHRcdFx0XHRqc29ucyA9IFtdLFxyXG5cdFx0XHRcdGpzb247XHJcblxyXG5cdFx0XHRpZiAoZ2VvbWV0cnkgJiYgZ2VvbWV0cnkudHlwZSA9PT0gJ011bHRpUG9pbnQnKSB7XHJcblx0XHRcdFx0cmV0dXJuIG11bHRpVG9HZW9KU09OKCdNdWx0aVBvaW50JykuY2FsbCh0aGlzKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dmFyIGlzR2VvbWV0cnlDb2xsZWN0aW9uID0gZ2VvbWV0cnkgJiYgZ2VvbWV0cnkudHlwZSA9PT0gJ0dlb21ldHJ5Q29sbGVjdGlvbic7XHJcblxyXG5cdFx0XHR0aGlzLmVhY2hMYXllcihmdW5jdGlvbiAobGF5ZXIpIHtcclxuXHRcdFx0XHRpZiAobGF5ZXIudG9HZW9KU09OKSB7XHJcblx0XHRcdFx0XHRqc29uID0gbGF5ZXIudG9HZW9KU09OKCk7XHJcblx0XHRcdFx0XHRqc29ucy5wdXNoKGlzR2VvbWV0cnlDb2xsZWN0aW9uID8ganNvbi5nZW9tZXRyeSA6IEwuR2VvSlNPTi5hc0ZlYXR1cmUoanNvbikpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRpZiAoaXNHZW9tZXRyeUNvbGxlY3Rpb24pIHtcclxuXHRcdFx0XHRyZXR1cm4gTC5HZW9KU09OLmdldEZlYXR1cmUodGhpcywge1xyXG5cdFx0XHRcdFx0Z2VvbWV0cmllczoganNvbnMsXHJcblx0XHRcdFx0XHR0eXBlOiAnR2VvbWV0cnlDb2xsZWN0aW9uJ1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsXHJcblx0XHRcdFx0ZmVhdHVyZXM6IGpzb25zXHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0fSk7XHJcbn0oKSk7XHJcblxyXG5MLmdlb0pzb24gPSBmdW5jdGlvbiAoZ2VvanNvbiwgb3B0aW9ucykge1xyXG5cdHJldHVybiBuZXcgTC5HZW9KU09OKGdlb2pzb24sIG9wdGlvbnMpO1xyXG59O1xyXG5cblxuLypcclxuICogTC5Eb21FdmVudCBjb250YWlucyBmdW5jdGlvbnMgZm9yIHdvcmtpbmcgd2l0aCBET00gZXZlbnRzLlxyXG4gKi9cclxuXHJcbkwuRG9tRXZlbnQgPSB7XHJcblx0LyogaW5zcGlyZWQgYnkgSm9obiBSZXNpZywgRGVhbiBFZHdhcmRzIGFuZCBZVUkgYWRkRXZlbnQgaW1wbGVtZW50YXRpb25zICovXHJcblx0YWRkTGlzdGVuZXI6IGZ1bmN0aW9uIChvYmosIHR5cGUsIGZuLCBjb250ZXh0KSB7IC8vIChIVE1MRWxlbWVudCwgU3RyaW5nLCBGdW5jdGlvblssIE9iamVjdF0pXHJcblxyXG5cdFx0dmFyIGlkID0gTC5zdGFtcChmbiksXHJcblx0XHQgICAga2V5ID0gJ19sZWFmbGV0XycgKyB0eXBlICsgaWQsXHJcblx0XHQgICAgaGFuZGxlciwgb3JpZ2luYWxIYW5kbGVyLCBuZXdUeXBlO1xyXG5cclxuXHRcdGlmIChvYmpba2V5XSkgeyByZXR1cm4gdGhpczsgfVxyXG5cclxuXHRcdGhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHRyZXR1cm4gZm4uY2FsbChjb250ZXh0IHx8IG9iaiwgZSB8fCBMLkRvbUV2ZW50Ll9nZXRFdmVudCgpKTtcclxuXHRcdH07XHJcblxyXG5cdFx0aWYgKEwuQnJvd3Nlci5wb2ludGVyICYmIHR5cGUuaW5kZXhPZigndG91Y2gnKSA9PT0gMCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5hZGRQb2ludGVyTGlzdGVuZXIob2JqLCB0eXBlLCBoYW5kbGVyLCBpZCk7XHJcblx0XHR9XHJcblx0XHRpZiAoTC5Ccm93c2VyLnRvdWNoICYmICh0eXBlID09PSAnZGJsY2xpY2snKSAmJiB0aGlzLmFkZERvdWJsZVRhcExpc3RlbmVyKSB7XHJcblx0XHRcdHRoaXMuYWRkRG91YmxlVGFwTGlzdGVuZXIob2JqLCBoYW5kbGVyLCBpZCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCdhZGRFdmVudExpc3RlbmVyJyBpbiBvYmopIHtcclxuXHJcblx0XHRcdGlmICh0eXBlID09PSAnbW91c2V3aGVlbCcpIHtcclxuXHRcdFx0XHRvYmouYWRkRXZlbnRMaXN0ZW5lcignRE9NTW91c2VTY3JvbGwnLCBoYW5kbGVyLCBmYWxzZSk7XHJcblx0XHRcdFx0b2JqLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgZmFsc2UpO1xyXG5cclxuXHRcdFx0fSBlbHNlIGlmICgodHlwZSA9PT0gJ21vdXNlZW50ZXInKSB8fCAodHlwZSA9PT0gJ21vdXNlbGVhdmUnKSkge1xyXG5cclxuXHRcdFx0XHRvcmlnaW5hbEhhbmRsZXIgPSBoYW5kbGVyO1xyXG5cdFx0XHRcdG5ld1R5cGUgPSAodHlwZSA9PT0gJ21vdXNlZW50ZXInID8gJ21vdXNlb3ZlcicgOiAnbW91c2VvdXQnKTtcclxuXHJcblx0XHRcdFx0aGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdFx0XHRpZiAoIUwuRG9tRXZlbnQuX2NoZWNrTW91c2Uob2JqLCBlKSkgeyByZXR1cm47IH1cclxuXHRcdFx0XHRcdHJldHVybiBvcmlnaW5hbEhhbmRsZXIoZSk7XHJcblx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0b2JqLmFkZEV2ZW50TGlzdGVuZXIobmV3VHlwZSwgaGFuZGxlciwgZmFsc2UpO1xyXG5cclxuXHRcdFx0fSBlbHNlIGlmICh0eXBlID09PSAnY2xpY2snICYmIEwuQnJvd3Nlci5hbmRyb2lkKSB7XHJcblx0XHRcdFx0b3JpZ2luYWxIYW5kbGVyID0gaGFuZGxlcjtcclxuXHRcdFx0XHRoYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0XHRcdHJldHVybiBMLkRvbUV2ZW50Ll9maWx0ZXJDbGljayhlLCBvcmlnaW5hbEhhbmRsZXIpO1xyXG5cdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdG9iai5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIsIGZhbHNlKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRvYmouYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCBmYWxzZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9IGVsc2UgaWYgKCdhdHRhY2hFdmVudCcgaW4gb2JqKSB7XHJcblx0XHRcdG9iai5hdHRhY2hFdmVudCgnb24nICsgdHlwZSwgaGFuZGxlcik7XHJcblx0XHR9XHJcblxyXG5cdFx0b2JqW2tleV0gPSBoYW5kbGVyO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHJlbW92ZUxpc3RlbmVyOiBmdW5jdGlvbiAob2JqLCB0eXBlLCBmbikgeyAgLy8gKEhUTUxFbGVtZW50LCBTdHJpbmcsIEZ1bmN0aW9uKVxyXG5cclxuXHRcdHZhciBpZCA9IEwuc3RhbXAoZm4pLFxyXG5cdFx0ICAgIGtleSA9ICdfbGVhZmxldF8nICsgdHlwZSArIGlkLFxyXG5cdFx0ICAgIGhhbmRsZXIgPSBvYmpba2V5XTtcclxuXHJcblx0XHRpZiAoIWhhbmRsZXIpIHsgcmV0dXJuIHRoaXM7IH1cclxuXHJcblx0XHRpZiAoTC5Ccm93c2VyLnBvaW50ZXIgJiYgdHlwZS5pbmRleE9mKCd0b3VjaCcpID09PSAwKSB7XHJcblx0XHRcdHRoaXMucmVtb3ZlUG9pbnRlckxpc3RlbmVyKG9iaiwgdHlwZSwgaWQpO1xyXG5cdFx0fSBlbHNlIGlmIChMLkJyb3dzZXIudG91Y2ggJiYgKHR5cGUgPT09ICdkYmxjbGljaycpICYmIHRoaXMucmVtb3ZlRG91YmxlVGFwTGlzdGVuZXIpIHtcclxuXHRcdFx0dGhpcy5yZW1vdmVEb3VibGVUYXBMaXN0ZW5lcihvYmosIGlkKTtcclxuXHJcblx0XHR9IGVsc2UgaWYgKCdyZW1vdmVFdmVudExpc3RlbmVyJyBpbiBvYmopIHtcclxuXHJcblx0XHRcdGlmICh0eXBlID09PSAnbW91c2V3aGVlbCcpIHtcclxuXHRcdFx0XHRvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcignRE9NTW91c2VTY3JvbGwnLCBoYW5kbGVyLCBmYWxzZSk7XHJcblx0XHRcdFx0b2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgZmFsc2UpO1xyXG5cclxuXHRcdFx0fSBlbHNlIGlmICgodHlwZSA9PT0gJ21vdXNlZW50ZXInKSB8fCAodHlwZSA9PT0gJ21vdXNlbGVhdmUnKSkge1xyXG5cdFx0XHRcdG9iai5yZW1vdmVFdmVudExpc3RlbmVyKCh0eXBlID09PSAnbW91c2VlbnRlcicgPyAnbW91c2VvdmVyJyA6ICdtb3VzZW91dCcpLCBoYW5kbGVyLCBmYWxzZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0b2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKCdkZXRhY2hFdmVudCcgaW4gb2JqKSB7XHJcblx0XHRcdG9iai5kZXRhY2hFdmVudCgnb24nICsgdHlwZSwgaGFuZGxlcik7XHJcblx0XHR9XHJcblxyXG5cdFx0b2JqW2tleV0gPSBudWxsO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHN0b3BQcm9wYWdhdGlvbjogZnVuY3Rpb24gKGUpIHtcclxuXHJcblx0XHRpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGUuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdEwuRG9tRXZlbnQuX3NraXBwZWQoZSk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0ZGlzYWJsZVNjcm9sbFByb3BhZ2F0aW9uOiBmdW5jdGlvbiAoZWwpIHtcclxuXHRcdHZhciBzdG9wID0gTC5Eb21FdmVudC5zdG9wUHJvcGFnYXRpb247XHJcblxyXG5cdFx0cmV0dXJuIEwuRG9tRXZlbnRcclxuXHRcdFx0Lm9uKGVsLCAnbW91c2V3aGVlbCcsIHN0b3ApXHJcblx0XHRcdC5vbihlbCwgJ01vek1vdXNlUGl4ZWxTY3JvbGwnLCBzdG9wKTtcclxuXHR9LFxyXG5cclxuXHRkaXNhYmxlQ2xpY2tQcm9wYWdhdGlvbjogZnVuY3Rpb24gKGVsKSB7XHJcblx0XHR2YXIgc3RvcCA9IEwuRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uO1xyXG5cclxuXHRcdGZvciAodmFyIGkgPSBMLkRyYWdnYWJsZS5TVEFSVC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG5cdFx0XHRMLkRvbUV2ZW50Lm9uKGVsLCBMLkRyYWdnYWJsZS5TVEFSVFtpXSwgc3RvcCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIEwuRG9tRXZlbnRcclxuXHRcdFx0Lm9uKGVsLCAnY2xpY2snLCBMLkRvbUV2ZW50Ll9mYWtlU3RvcClcclxuXHRcdFx0Lm9uKGVsLCAnZGJsY2xpY2snLCBzdG9wKTtcclxuXHR9LFxyXG5cclxuXHRwcmV2ZW50RGVmYXVsdDogZnVuY3Rpb24gKGUpIHtcclxuXHJcblx0XHRpZiAoZS5wcmV2ZW50RGVmYXVsdCkge1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRlLnJldHVyblZhbHVlID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRzdG9wOiBmdW5jdGlvbiAoZSkge1xyXG5cdFx0cmV0dXJuIEwuRG9tRXZlbnRcclxuXHRcdFx0LnByZXZlbnREZWZhdWx0KGUpXHJcblx0XHRcdC5zdG9wUHJvcGFnYXRpb24oZSk7XHJcblx0fSxcclxuXHJcblx0Z2V0TW91c2VQb3NpdGlvbjogZnVuY3Rpb24gKGUsIGNvbnRhaW5lcikge1xyXG5cdFx0aWYgKCFjb250YWluZXIpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBMLlBvaW50KGUuY2xpZW50WCwgZS5jbGllbnRZKTtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgcmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcblx0XHRyZXR1cm4gbmV3IEwuUG9pbnQoXHJcblx0XHRcdGUuY2xpZW50WCAtIHJlY3QubGVmdCAtIGNvbnRhaW5lci5jbGllbnRMZWZ0LFxyXG5cdFx0XHRlLmNsaWVudFkgLSByZWN0LnRvcCAtIGNvbnRhaW5lci5jbGllbnRUb3ApO1xyXG5cdH0sXHJcblxyXG5cdGdldFdoZWVsRGVsdGE6IGZ1bmN0aW9uIChlKSB7XHJcblxyXG5cdFx0dmFyIGRlbHRhID0gMDtcclxuXHJcblx0XHRpZiAoZS53aGVlbERlbHRhKSB7XHJcblx0XHRcdGRlbHRhID0gZS53aGVlbERlbHRhIC8gMTIwO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGUuZGV0YWlsKSB7XHJcblx0XHRcdGRlbHRhID0gLWUuZGV0YWlsIC8gMztcclxuXHRcdH1cclxuXHRcdHJldHVybiBkZWx0YTtcclxuXHR9LFxyXG5cclxuXHRfc2tpcEV2ZW50czoge30sXHJcblxyXG5cdF9mYWtlU3RvcDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdC8vIGZha2VzIHN0b3BQcm9wYWdhdGlvbiBieSBzZXR0aW5nIGEgc3BlY2lhbCBldmVudCBmbGFnLCBjaGVja2VkL3Jlc2V0IHdpdGggTC5Eb21FdmVudC5fc2tpcHBlZChlKVxyXG5cdFx0TC5Eb21FdmVudC5fc2tpcEV2ZW50c1tlLnR5cGVdID0gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHRfc2tpcHBlZDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciBza2lwcGVkID0gdGhpcy5fc2tpcEV2ZW50c1tlLnR5cGVdO1xyXG5cdFx0Ly8gcmVzZXQgd2hlbiBjaGVja2luZywgYXMgaXQncyBvbmx5IHVzZWQgaW4gbWFwIGNvbnRhaW5lciBhbmQgcHJvcGFnYXRlcyBvdXRzaWRlIG9mIHRoZSBtYXBcclxuXHRcdHRoaXMuX3NraXBFdmVudHNbZS50eXBlXSA9IGZhbHNlO1xyXG5cdFx0cmV0dXJuIHNraXBwZWQ7XHJcblx0fSxcclxuXHJcblx0Ly8gY2hlY2sgaWYgZWxlbWVudCByZWFsbHkgbGVmdC9lbnRlcmVkIHRoZSBldmVudCB0YXJnZXQgKGZvciBtb3VzZWVudGVyL21vdXNlbGVhdmUpXHJcblx0X2NoZWNrTW91c2U6IGZ1bmN0aW9uIChlbCwgZSkge1xyXG5cclxuXHRcdHZhciByZWxhdGVkID0gZS5yZWxhdGVkVGFyZ2V0O1xyXG5cclxuXHRcdGlmICghcmVsYXRlZCkgeyByZXR1cm4gdHJ1ZTsgfVxyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdHdoaWxlIChyZWxhdGVkICYmIChyZWxhdGVkICE9PSBlbCkpIHtcclxuXHRcdFx0XHRyZWxhdGVkID0gcmVsYXRlZC5wYXJlbnROb2RlO1xyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIChlcnIpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIChyZWxhdGVkICE9PSBlbCk7XHJcblx0fSxcclxuXHJcblx0X2dldEV2ZW50OiBmdW5jdGlvbiAoKSB7IC8vIGV2aWwgbWFnaWMgZm9yIElFXHJcblx0XHQvKmpzaGludCBub2FyZzpmYWxzZSAqL1xyXG5cdFx0dmFyIGUgPSB3aW5kb3cuZXZlbnQ7XHJcblx0XHRpZiAoIWUpIHtcclxuXHRcdFx0dmFyIGNhbGxlciA9IGFyZ3VtZW50cy5jYWxsZWUuY2FsbGVyO1xyXG5cdFx0XHR3aGlsZSAoY2FsbGVyKSB7XHJcblx0XHRcdFx0ZSA9IGNhbGxlclsnYXJndW1lbnRzJ11bMF07XHJcblx0XHRcdFx0aWYgKGUgJiYgd2luZG93LkV2ZW50ID09PSBlLmNvbnN0cnVjdG9yKSB7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y2FsbGVyID0gY2FsbGVyLmNhbGxlcjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGU7XHJcblx0fSxcclxuXHJcblx0Ly8gdGhpcyBpcyBhIGhvcnJpYmxlIHdvcmthcm91bmQgZm9yIGEgYnVnIGluIEFuZHJvaWQgd2hlcmUgYSBzaW5nbGUgdG91Y2ggdHJpZ2dlcnMgdHdvIGNsaWNrIGV2ZW50c1xyXG5cdF9maWx0ZXJDbGljazogZnVuY3Rpb24gKGUsIGhhbmRsZXIpIHtcclxuXHRcdHZhciB0aW1lU3RhbXAgPSAoZS50aW1lU3RhbXAgfHwgZS5vcmlnaW5hbEV2ZW50LnRpbWVTdGFtcCksXHJcblx0XHRcdGVsYXBzZWQgPSBMLkRvbUV2ZW50Ll9sYXN0Q2xpY2sgJiYgKHRpbWVTdGFtcCAtIEwuRG9tRXZlbnQuX2xhc3RDbGljayk7XHJcblxyXG5cdFx0Ly8gYXJlIHRoZXkgY2xvc2VyIHRvZ2V0aGVyIHRoYW4gNTAwbXMgeWV0IG1vcmUgdGhhbiAxMDBtcz9cclxuXHRcdC8vIEFuZHJvaWQgdHlwaWNhbGx5IHRyaWdnZXJzIHRoZW0gfjMwMG1zIGFwYXJ0IHdoaWxlIG11bHRpcGxlIGxpc3RlbmVyc1xyXG5cdFx0Ly8gb24gdGhlIHNhbWUgZXZlbnQgc2hvdWxkIGJlIHRyaWdnZXJlZCBmYXIgZmFzdGVyO1xyXG5cdFx0Ly8gb3IgY2hlY2sgaWYgY2xpY2sgaXMgc2ltdWxhdGVkIG9uIHRoZSBlbGVtZW50LCBhbmQgaWYgaXQgaXMsIHJlamVjdCBhbnkgbm9uLXNpbXVsYXRlZCBldmVudHNcclxuXHJcblx0XHRpZiAoKGVsYXBzZWQgJiYgZWxhcHNlZCA+IDEwMCAmJiBlbGFwc2VkIDwgNTAwKSB8fCAoZS50YXJnZXQuX3NpbXVsYXRlZENsaWNrICYmICFlLl9zaW11bGF0ZWQpKSB7XHJcblx0XHRcdEwuRG9tRXZlbnQuc3RvcChlKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0TC5Eb21FdmVudC5fbGFzdENsaWNrID0gdGltZVN0YW1wO1xyXG5cclxuXHRcdHJldHVybiBoYW5kbGVyKGUpO1xyXG5cdH1cclxufTtcclxuXHJcbkwuRG9tRXZlbnQub24gPSBMLkRvbUV2ZW50LmFkZExpc3RlbmVyO1xyXG5MLkRvbUV2ZW50Lm9mZiA9IEwuRG9tRXZlbnQucmVtb3ZlTGlzdGVuZXI7XHJcblxuXG4vKlxyXG4gKiBMLkRyYWdnYWJsZSBhbGxvd3MgeW91IHRvIGFkZCBkcmFnZ2luZyBjYXBhYmlsaXRpZXMgdG8gYW55IGVsZW1lbnQuIFN1cHBvcnRzIG1vYmlsZSBkZXZpY2VzIHRvby5cclxuICovXHJcblxyXG5MLkRyYWdnYWJsZSA9IEwuQ2xhc3MuZXh0ZW5kKHtcclxuXHRpbmNsdWRlczogTC5NaXhpbi5FdmVudHMsXHJcblxyXG5cdHN0YXRpY3M6IHtcclxuXHRcdFNUQVJUOiBMLkJyb3dzZXIudG91Y2ggPyBbJ3RvdWNoc3RhcnQnLCAnbW91c2Vkb3duJ10gOiBbJ21vdXNlZG93biddLFxyXG5cdFx0RU5EOiB7XHJcblx0XHRcdG1vdXNlZG93bjogJ21vdXNldXAnLFxyXG5cdFx0XHR0b3VjaHN0YXJ0OiAndG91Y2hlbmQnLFxyXG5cdFx0XHRwb2ludGVyZG93bjogJ3RvdWNoZW5kJyxcclxuXHRcdFx0TVNQb2ludGVyRG93bjogJ3RvdWNoZW5kJ1xyXG5cdFx0fSxcclxuXHRcdE1PVkU6IHtcclxuXHRcdFx0bW91c2Vkb3duOiAnbW91c2Vtb3ZlJyxcclxuXHRcdFx0dG91Y2hzdGFydDogJ3RvdWNobW92ZScsXHJcblx0XHRcdHBvaW50ZXJkb3duOiAndG91Y2htb3ZlJyxcclxuXHRcdFx0TVNQb2ludGVyRG93bjogJ3RvdWNobW92ZSdcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRpbml0aWFsaXplOiBmdW5jdGlvbiAoZWxlbWVudCwgZHJhZ1N0YXJ0VGFyZ2V0KSB7XHJcblx0XHR0aGlzLl9lbGVtZW50ID0gZWxlbWVudDtcclxuXHRcdHRoaXMuX2RyYWdTdGFydFRhcmdldCA9IGRyYWdTdGFydFRhcmdldCB8fCBlbGVtZW50O1xyXG5cdH0sXHJcblxyXG5cdGVuYWJsZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0aWYgKHRoaXMuX2VuYWJsZWQpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IEwuRHJhZ2dhYmxlLlNUQVJULmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcblx0XHRcdEwuRG9tRXZlbnQub24odGhpcy5fZHJhZ1N0YXJ0VGFyZ2V0LCBMLkRyYWdnYWJsZS5TVEFSVFtpXSwgdGhpcy5fb25Eb3duLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9lbmFibGVkID0gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHRkaXNhYmxlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX2VuYWJsZWQpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0Zm9yICh2YXIgaSA9IEwuRHJhZ2dhYmxlLlNUQVJULmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcblx0XHRcdEwuRG9tRXZlbnQub2ZmKHRoaXMuX2RyYWdTdGFydFRhcmdldCwgTC5EcmFnZ2FibGUuU1RBUlRbaV0sIHRoaXMuX29uRG93biwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fZW5hYmxlZCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5fbW92ZWQgPSBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHRfb25Eb3duOiBmdW5jdGlvbiAoZSkge1xyXG5cdFx0dGhpcy5fbW92ZWQgPSBmYWxzZTtcclxuXHJcblx0XHRpZiAoZS5zaGlmdEtleSB8fCAoKGUud2hpY2ggIT09IDEpICYmIChlLmJ1dHRvbiAhPT0gMSkgJiYgIWUudG91Y2hlcykpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0TC5Eb21FdmVudC5zdG9wUHJvcGFnYXRpb24oZSk7XHJcblxyXG5cdFx0aWYgKEwuRHJhZ2dhYmxlLl9kaXNhYmxlZCkgeyByZXR1cm47IH1cclxuXHJcblx0XHRMLkRvbVV0aWwuZGlzYWJsZUltYWdlRHJhZygpO1xyXG5cdFx0TC5Eb21VdGlsLmRpc2FibGVUZXh0U2VsZWN0aW9uKCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX21vdmluZykgeyByZXR1cm47IH1cclxuXHJcblx0XHR2YXIgZmlyc3QgPSBlLnRvdWNoZXMgPyBlLnRvdWNoZXNbMF0gOiBlO1xyXG5cclxuXHRcdHRoaXMuX3N0YXJ0UG9pbnQgPSBuZXcgTC5Qb2ludChmaXJzdC5jbGllbnRYLCBmaXJzdC5jbGllbnRZKTtcclxuXHRcdHRoaXMuX3N0YXJ0UG9zID0gdGhpcy5fbmV3UG9zID0gTC5Eb21VdGlsLmdldFBvc2l0aW9uKHRoaXMuX2VsZW1lbnQpO1xyXG5cclxuXHRcdEwuRG9tRXZlbnRcclxuXHRcdCAgICAub24oZG9jdW1lbnQsIEwuRHJhZ2dhYmxlLk1PVkVbZS50eXBlXSwgdGhpcy5fb25Nb3ZlLCB0aGlzKVxyXG5cdFx0ICAgIC5vbihkb2N1bWVudCwgTC5EcmFnZ2FibGUuRU5EW2UudHlwZV0sIHRoaXMuX29uVXAsIHRoaXMpO1xyXG5cdH0sXHJcblxyXG5cdF9vbk1vdmU6IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRpZiAoZS50b3VjaGVzICYmIGUudG91Y2hlcy5sZW5ndGggPiAxKSB7XHJcblx0XHRcdHRoaXMuX21vdmVkID0gdHJ1ZTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBmaXJzdCA9IChlLnRvdWNoZXMgJiYgZS50b3VjaGVzLmxlbmd0aCA9PT0gMSA/IGUudG91Y2hlc1swXSA6IGUpLFxyXG5cdFx0ICAgIG5ld1BvaW50ID0gbmV3IEwuUG9pbnQoZmlyc3QuY2xpZW50WCwgZmlyc3QuY2xpZW50WSksXHJcblx0XHQgICAgb2Zmc2V0ID0gbmV3UG9pbnQuc3VidHJhY3QodGhpcy5fc3RhcnRQb2ludCk7XHJcblxyXG5cdFx0aWYgKCFvZmZzZXQueCAmJiAhb2Zmc2V0LnkpIHsgcmV0dXJuOyB9XHJcblx0XHRpZiAoTC5Ccm93c2VyLnRvdWNoICYmIE1hdGguYWJzKG9mZnNldC54KSArIE1hdGguYWJzKG9mZnNldC55KSA8IDMpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0TC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdChlKTtcclxuXHJcblx0XHRpZiAoIXRoaXMuX21vdmVkKSB7XHJcblx0XHRcdHRoaXMuZmlyZSgnZHJhZ3N0YXJ0Jyk7XHJcblxyXG5cdFx0XHR0aGlzLl9tb3ZlZCA9IHRydWU7XHJcblx0XHRcdHRoaXMuX3N0YXJ0UG9zID0gTC5Eb21VdGlsLmdldFBvc2l0aW9uKHRoaXMuX2VsZW1lbnQpLnN1YnRyYWN0KG9mZnNldCk7XHJcblxyXG5cdFx0XHRMLkRvbVV0aWwuYWRkQ2xhc3MoZG9jdW1lbnQuYm9keSwgJ2xlYWZsZXQtZHJhZ2dpbmcnKTtcclxuXHRcdFx0dGhpcy5fbGFzdFRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcclxuXHRcdFx0TC5Eb21VdGlsLmFkZENsYXNzKHRoaXMuX2xhc3RUYXJnZXQsICdsZWFmbGV0LWRyYWctdGFyZ2V0Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fbmV3UG9zID0gdGhpcy5fc3RhcnRQb3MuYWRkKG9mZnNldCk7XHJcblx0XHR0aGlzLl9tb3ZpbmcgPSB0cnVlO1xyXG5cclxuXHRcdEwuVXRpbC5jYW5jZWxBbmltRnJhbWUodGhpcy5fYW5pbVJlcXVlc3QpO1xyXG5cdFx0dGhpcy5fYW5pbVJlcXVlc3QgPSBMLlV0aWwucmVxdWVzdEFuaW1GcmFtZSh0aGlzLl91cGRhdGVQb3NpdGlvbiwgdGhpcywgdHJ1ZSwgdGhpcy5fZHJhZ1N0YXJ0VGFyZ2V0KTtcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlUG9zaXRpb246IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuZmlyZSgncHJlZHJhZycpO1xyXG5cdFx0TC5Eb21VdGlsLnNldFBvc2l0aW9uKHRoaXMuX2VsZW1lbnQsIHRoaXMuX25ld1Bvcyk7XHJcblx0XHR0aGlzLmZpcmUoJ2RyYWcnKTtcclxuXHR9LFxyXG5cclxuXHRfb25VcDogZnVuY3Rpb24gKCkge1xyXG5cdFx0TC5Eb21VdGlsLnJlbW92ZUNsYXNzKGRvY3VtZW50LmJvZHksICdsZWFmbGV0LWRyYWdnaW5nJyk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2xhc3RUYXJnZXQpIHtcclxuXHRcdFx0TC5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX2xhc3RUYXJnZXQsICdsZWFmbGV0LWRyYWctdGFyZ2V0Jyk7XHJcblx0XHRcdHRoaXMuX2xhc3RUYXJnZXQgPSBudWxsO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAodmFyIGkgaW4gTC5EcmFnZ2FibGUuTU9WRSkge1xyXG5cdFx0XHRMLkRvbUV2ZW50XHJcblx0XHRcdCAgICAub2ZmKGRvY3VtZW50LCBMLkRyYWdnYWJsZS5NT1ZFW2ldLCB0aGlzLl9vbk1vdmUpXHJcblx0XHRcdCAgICAub2ZmKGRvY3VtZW50LCBMLkRyYWdnYWJsZS5FTkRbaV0sIHRoaXMuX29uVXApO1xyXG5cdFx0fVxyXG5cclxuXHRcdEwuRG9tVXRpbC5lbmFibGVJbWFnZURyYWcoKTtcclxuXHRcdEwuRG9tVXRpbC5lbmFibGVUZXh0U2VsZWN0aW9uKCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX21vdmVkICYmIHRoaXMuX21vdmluZykge1xyXG5cdFx0XHQvLyBlbnN1cmUgZHJhZyBpcyBub3QgZmlyZWQgYWZ0ZXIgZHJhZ2VuZFxyXG5cdFx0XHRMLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2FuaW1SZXF1ZXN0KTtcclxuXHJcblx0XHRcdHRoaXMuZmlyZSgnZHJhZ2VuZCcsIHtcclxuXHRcdFx0XHRkaXN0YW5jZTogdGhpcy5fbmV3UG9zLmRpc3RhbmNlVG8odGhpcy5fc3RhcnRQb3MpXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX21vdmluZyA9IGZhbHNlO1xyXG5cdH1cclxufSk7XHJcblxuXG4vKlxuXHRMLkhhbmRsZXIgaXMgYSBiYXNlIGNsYXNzIGZvciBoYW5kbGVyIGNsYXNzZXMgdGhhdCBhcmUgdXNlZCBpbnRlcm5hbGx5IHRvIGluamVjdFxuXHRpbnRlcmFjdGlvbiBmZWF0dXJlcyBsaWtlIGRyYWdnaW5nIHRvIGNsYXNzZXMgbGlrZSBNYXAgYW5kIE1hcmtlci5cbiovXG5cbkwuSGFuZGxlciA9IEwuQ2xhc3MuZXh0ZW5kKHtcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKG1hcCkge1xuXHRcdHRoaXMuX21hcCA9IG1hcDtcblx0fSxcblxuXHRlbmFibGU6IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAodGhpcy5fZW5hYmxlZCkgeyByZXR1cm47IH1cblxuXHRcdHRoaXMuX2VuYWJsZWQgPSB0cnVlO1xuXHRcdHRoaXMuYWRkSG9va3MoKTtcblx0fSxcblxuXHRkaXNhYmxlOiBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKCF0aGlzLl9lbmFibGVkKSB7IHJldHVybjsgfVxuXG5cdFx0dGhpcy5fZW5hYmxlZCA9IGZhbHNlO1xuXHRcdHRoaXMucmVtb3ZlSG9va3MoKTtcblx0fSxcblxuXHRlbmFibGVkOiBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuICEhdGhpcy5fZW5hYmxlZDtcblx0fVxufSk7XG5cblxuLypcbiAqIEwuSGFuZGxlci5NYXBEcmFnIGlzIHVzZWQgdG8gbWFrZSB0aGUgbWFwIGRyYWdnYWJsZSAod2l0aCBwYW5uaW5nIGluZXJ0aWEpLCBlbmFibGVkIGJ5IGRlZmF1bHQuXG4gKi9cblxuTC5NYXAubWVyZ2VPcHRpb25zKHtcblx0ZHJhZ2dpbmc6IHRydWUsXG5cblx0aW5lcnRpYTogIUwuQnJvd3Nlci5hbmRyb2lkMjMsXG5cdGluZXJ0aWFEZWNlbGVyYXRpb246IDM0MDAsIC8vIHB4L3NeMlxuXHRpbmVydGlhTWF4U3BlZWQ6IEluZmluaXR5LCAvLyBweC9zXG5cdGluZXJ0aWFUaHJlc2hvbGQ6IEwuQnJvd3Nlci50b3VjaCA/IDMyIDogMTgsIC8vIG1zXG5cdGVhc2VMaW5lYXJpdHk6IDAuMjUsXG5cblx0Ly8gVE9ETyByZWZhY3RvciwgbW92ZSB0byBDUlNcblx0d29ybGRDb3B5SnVtcDogZmFsc2Vcbn0pO1xuXG5MLk1hcC5EcmFnID0gTC5IYW5kbGVyLmV4dGVuZCh7XG5cdGFkZEhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKCF0aGlzLl9kcmFnZ2FibGUpIHtcblx0XHRcdHZhciBtYXAgPSB0aGlzLl9tYXA7XG5cblx0XHRcdHRoaXMuX2RyYWdnYWJsZSA9IG5ldyBMLkRyYWdnYWJsZShtYXAuX21hcFBhbmUsIG1hcC5fY29udGFpbmVyKTtcblxuXHRcdFx0dGhpcy5fZHJhZ2dhYmxlLm9uKHtcblx0XHRcdFx0J2RyYWdzdGFydCc6IHRoaXMuX29uRHJhZ1N0YXJ0LFxuXHRcdFx0XHQnZHJhZyc6IHRoaXMuX29uRHJhZyxcblx0XHRcdFx0J2RyYWdlbmQnOiB0aGlzLl9vbkRyYWdFbmRcblx0XHRcdH0sIHRoaXMpO1xuXG5cdFx0XHRpZiAobWFwLm9wdGlvbnMud29ybGRDb3B5SnVtcCkge1xuXHRcdFx0XHR0aGlzLl9kcmFnZ2FibGUub24oJ3ByZWRyYWcnLCB0aGlzLl9vblByZURyYWcsIHRoaXMpO1xuXHRcdFx0XHRtYXAub24oJ3ZpZXdyZXNldCcsIHRoaXMuX29uVmlld1Jlc2V0LCB0aGlzKTtcblxuXHRcdFx0XHRtYXAud2hlblJlYWR5KHRoaXMuX29uVmlld1Jlc2V0LCB0aGlzKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5fZHJhZ2dhYmxlLmVuYWJsZSgpO1xuXHR9LFxuXG5cdHJlbW92ZUhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0dGhpcy5fZHJhZ2dhYmxlLmRpc2FibGUoKTtcblx0fSxcblxuXHRtb3ZlZDogZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiB0aGlzLl9kcmFnZ2FibGUgJiYgdGhpcy5fZHJhZ2dhYmxlLl9tb3ZlZDtcblx0fSxcblxuXHRfb25EcmFnU3RhcnQ6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwO1xuXG5cdFx0aWYgKG1hcC5fcGFuQW5pbSkge1xuXHRcdFx0bWFwLl9wYW5BbmltLnN0b3AoKTtcblx0XHR9XG5cblx0XHRtYXBcblx0XHQgICAgLmZpcmUoJ21vdmVzdGFydCcpXG5cdFx0ICAgIC5maXJlKCdkcmFnc3RhcnQnKTtcblxuXHRcdGlmIChtYXAub3B0aW9ucy5pbmVydGlhKSB7XG5cdFx0XHR0aGlzLl9wb3NpdGlvbnMgPSBbXTtcblx0XHRcdHRoaXMuX3RpbWVzID0gW107XG5cdFx0fVxuXHR9LFxuXG5cdF9vbkRyYWc6IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAodGhpcy5fbWFwLm9wdGlvbnMuaW5lcnRpYSkge1xuXHRcdFx0dmFyIHRpbWUgPSB0aGlzLl9sYXN0VGltZSA9ICtuZXcgRGF0ZSgpLFxuXHRcdFx0ICAgIHBvcyA9IHRoaXMuX2xhc3RQb3MgPSB0aGlzLl9kcmFnZ2FibGUuX25ld1BvcztcblxuXHRcdFx0dGhpcy5fcG9zaXRpb25zLnB1c2gocG9zKTtcblx0XHRcdHRoaXMuX3RpbWVzLnB1c2godGltZSk7XG5cblx0XHRcdGlmICh0aW1lIC0gdGhpcy5fdGltZXNbMF0gPiAyMDApIHtcblx0XHRcdFx0dGhpcy5fcG9zaXRpb25zLnNoaWZ0KCk7XG5cdFx0XHRcdHRoaXMuX3RpbWVzLnNoaWZ0KCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5fbWFwXG5cdFx0ICAgIC5maXJlKCdtb3ZlJylcblx0XHQgICAgLmZpcmUoJ2RyYWcnKTtcblx0fSxcblxuXHRfb25WaWV3UmVzZXQ6IGZ1bmN0aW9uICgpIHtcblx0XHQvLyBUT0RPIGZpeCBoYXJkY29kZWQgRWFydGggdmFsdWVzXG5cdFx0dmFyIHB4Q2VudGVyID0gdGhpcy5fbWFwLmdldFNpemUoKS5fZGl2aWRlQnkoMiksXG5cdFx0ICAgIHB4V29ybGRDZW50ZXIgPSB0aGlzLl9tYXAubGF0TG5nVG9MYXllclBvaW50KFswLCAwXSk7XG5cblx0XHR0aGlzLl9pbml0aWFsV29ybGRPZmZzZXQgPSBweFdvcmxkQ2VudGVyLnN1YnRyYWN0KHB4Q2VudGVyKS54O1xuXHRcdHRoaXMuX3dvcmxkV2lkdGggPSB0aGlzLl9tYXAucHJvamVjdChbMCwgMTgwXSkueDtcblx0fSxcblxuXHRfb25QcmVEcmFnOiBmdW5jdGlvbiAoKSB7XG5cdFx0Ly8gVE9ETyByZWZhY3RvciB0byBiZSBhYmxlIHRvIGFkanVzdCBtYXAgcGFuZSBwb3NpdGlvbiBhZnRlciB6b29tXG5cdFx0dmFyIHdvcmxkV2lkdGggPSB0aGlzLl93b3JsZFdpZHRoLFxuXHRcdCAgICBoYWxmV2lkdGggPSBNYXRoLnJvdW5kKHdvcmxkV2lkdGggLyAyKSxcblx0XHQgICAgZHggPSB0aGlzLl9pbml0aWFsV29ybGRPZmZzZXQsXG5cdFx0ICAgIHggPSB0aGlzLl9kcmFnZ2FibGUuX25ld1Bvcy54LFxuXHRcdCAgICBuZXdYMSA9ICh4IC0gaGFsZldpZHRoICsgZHgpICUgd29ybGRXaWR0aCArIGhhbGZXaWR0aCAtIGR4LFxuXHRcdCAgICBuZXdYMiA9ICh4ICsgaGFsZldpZHRoICsgZHgpICUgd29ybGRXaWR0aCAtIGhhbGZXaWR0aCAtIGR4LFxuXHRcdCAgICBuZXdYID0gTWF0aC5hYnMobmV3WDEgKyBkeCkgPCBNYXRoLmFicyhuZXdYMiArIGR4KSA/IG5ld1gxIDogbmV3WDI7XG5cblx0XHR0aGlzLl9kcmFnZ2FibGUuX25ld1Bvcy54ID0gbmV3WDtcblx0fSxcblxuXHRfb25EcmFnRW5kOiBmdW5jdGlvbiAoZSkge1xuXHRcdHZhciBtYXAgPSB0aGlzLl9tYXAsXG5cdFx0ICAgIG9wdGlvbnMgPSBtYXAub3B0aW9ucyxcblx0XHQgICAgZGVsYXkgPSArbmV3IERhdGUoKSAtIHRoaXMuX2xhc3RUaW1lLFxuXG5cdFx0ICAgIG5vSW5lcnRpYSA9ICFvcHRpb25zLmluZXJ0aWEgfHwgZGVsYXkgPiBvcHRpb25zLmluZXJ0aWFUaHJlc2hvbGQgfHwgIXRoaXMuX3Bvc2l0aW9uc1swXTtcblxuXHRcdG1hcC5maXJlKCdkcmFnZW5kJywgZSk7XG5cblx0XHRpZiAobm9JbmVydGlhKSB7XG5cdFx0XHRtYXAuZmlyZSgnbW92ZWVuZCcpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0dmFyIGRpcmVjdGlvbiA9IHRoaXMuX2xhc3RQb3Muc3VidHJhY3QodGhpcy5fcG9zaXRpb25zWzBdKSxcblx0XHRcdCAgICBkdXJhdGlvbiA9ICh0aGlzLl9sYXN0VGltZSArIGRlbGF5IC0gdGhpcy5fdGltZXNbMF0pIC8gMTAwMCxcblx0XHRcdCAgICBlYXNlID0gb3B0aW9ucy5lYXNlTGluZWFyaXR5LFxuXG5cdFx0XHQgICAgc3BlZWRWZWN0b3IgPSBkaXJlY3Rpb24ubXVsdGlwbHlCeShlYXNlIC8gZHVyYXRpb24pLFxuXHRcdFx0ICAgIHNwZWVkID0gc3BlZWRWZWN0b3IuZGlzdGFuY2VUbyhbMCwgMF0pLFxuXG5cdFx0XHQgICAgbGltaXRlZFNwZWVkID0gTWF0aC5taW4ob3B0aW9ucy5pbmVydGlhTWF4U3BlZWQsIHNwZWVkKSxcblx0XHRcdCAgICBsaW1pdGVkU3BlZWRWZWN0b3IgPSBzcGVlZFZlY3Rvci5tdWx0aXBseUJ5KGxpbWl0ZWRTcGVlZCAvIHNwZWVkKSxcblxuXHRcdFx0ICAgIGRlY2VsZXJhdGlvbkR1cmF0aW9uID0gbGltaXRlZFNwZWVkIC8gKG9wdGlvbnMuaW5lcnRpYURlY2VsZXJhdGlvbiAqIGVhc2UpLFxuXHRcdFx0ICAgIG9mZnNldCA9IGxpbWl0ZWRTcGVlZFZlY3Rvci5tdWx0aXBseUJ5KC1kZWNlbGVyYXRpb25EdXJhdGlvbiAvIDIpLnJvdW5kKCk7XG5cblx0XHRcdGlmICghb2Zmc2V0LnggfHwgIW9mZnNldC55KSB7XG5cdFx0XHRcdG1hcC5maXJlKCdtb3ZlZW5kJyk7XG5cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9mZnNldCA9IG1hcC5fbGltaXRPZmZzZXQob2Zmc2V0LCBtYXAub3B0aW9ucy5tYXhCb3VuZHMpO1xuXG5cdFx0XHRcdEwuVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRtYXAucGFuQnkob2Zmc2V0LCB7XG5cdFx0XHRcdFx0XHRkdXJhdGlvbjogZGVjZWxlcmF0aW9uRHVyYXRpb24sXG5cdFx0XHRcdFx0XHRlYXNlTGluZWFyaXR5OiBlYXNlLFxuXHRcdFx0XHRcdFx0bm9Nb3ZlU3RhcnQ6IHRydWVcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59KTtcblxuTC5NYXAuYWRkSW5pdEhvb2soJ2FkZEhhbmRsZXInLCAnZHJhZ2dpbmcnLCBMLk1hcC5EcmFnKTtcblxuXG4vKlxuICogTC5IYW5kbGVyLkRvdWJsZUNsaWNrWm9vbSBpcyB1c2VkIHRvIGhhbmRsZSBkb3VibGUtY2xpY2sgem9vbSBvbiB0aGUgbWFwLCBlbmFibGVkIGJ5IGRlZmF1bHQuXG4gKi9cblxuTC5NYXAubWVyZ2VPcHRpb25zKHtcblx0ZG91YmxlQ2xpY2tab29tOiB0cnVlXG59KTtcblxuTC5NYXAuRG91YmxlQ2xpY2tab29tID0gTC5IYW5kbGVyLmV4dGVuZCh7XG5cdGFkZEhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0dGhpcy5fbWFwLm9uKCdkYmxjbGljaycsIHRoaXMuX29uRG91YmxlQ2xpY2ssIHRoaXMpO1xuXHR9LFxuXG5cdHJlbW92ZUhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0dGhpcy5fbWFwLm9mZignZGJsY2xpY2snLCB0aGlzLl9vbkRvdWJsZUNsaWNrLCB0aGlzKTtcblx0fSxcblxuXHRfb25Eb3VibGVDbGljazogZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwLFxuXHRcdCAgICB6b29tID0gbWFwLmdldFpvb20oKSArIChlLm9yaWdpbmFsRXZlbnQuc2hpZnRLZXkgPyAtMSA6IDEpO1xuXG5cdFx0aWYgKG1hcC5vcHRpb25zLmRvdWJsZUNsaWNrWm9vbSA9PT0gJ2NlbnRlcicpIHtcblx0XHRcdG1hcC5zZXRab29tKHpvb20pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRtYXAuc2V0Wm9vbUFyb3VuZChlLmNvbnRhaW5lclBvaW50LCB6b29tKTtcblx0XHR9XG5cdH1cbn0pO1xuXG5MLk1hcC5hZGRJbml0SG9vaygnYWRkSGFuZGxlcicsICdkb3VibGVDbGlja1pvb20nLCBMLk1hcC5Eb3VibGVDbGlja1pvb20pO1xuXG5cbi8qXG4gKiBMLkhhbmRsZXIuU2Nyb2xsV2hlZWxab29tIGlzIHVzZWQgYnkgTC5NYXAgdG8gZW5hYmxlIG1vdXNlIHNjcm9sbCB3aGVlbCB6b29tIG9uIHRoZSBtYXAuXG4gKi9cblxuTC5NYXAubWVyZ2VPcHRpb25zKHtcblx0c2Nyb2xsV2hlZWxab29tOiB0cnVlXG59KTtcblxuTC5NYXAuU2Nyb2xsV2hlZWxab29tID0gTC5IYW5kbGVyLmV4dGVuZCh7XG5cdGFkZEhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0TC5Eb21FdmVudC5vbih0aGlzLl9tYXAuX2NvbnRhaW5lciwgJ21vdXNld2hlZWwnLCB0aGlzLl9vbldoZWVsU2Nyb2xsLCB0aGlzKTtcblx0XHRMLkRvbUV2ZW50Lm9uKHRoaXMuX21hcC5fY29udGFpbmVyLCAnTW96TW91c2VQaXhlbFNjcm9sbCcsIEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQpO1xuXHRcdHRoaXMuX2RlbHRhID0gMDtcblx0fSxcblxuXHRyZW1vdmVIb29rczogZnVuY3Rpb24gKCkge1xuXHRcdEwuRG9tRXZlbnQub2ZmKHRoaXMuX21hcC5fY29udGFpbmVyLCAnbW91c2V3aGVlbCcsIHRoaXMuX29uV2hlZWxTY3JvbGwpO1xuXHRcdEwuRG9tRXZlbnQub2ZmKHRoaXMuX21hcC5fY29udGFpbmVyLCAnTW96TW91c2VQaXhlbFNjcm9sbCcsIEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQpO1xuXHR9LFxuXG5cdF9vbldoZWVsU2Nyb2xsOiBmdW5jdGlvbiAoZSkge1xuXHRcdHZhciBkZWx0YSA9IEwuRG9tRXZlbnQuZ2V0V2hlZWxEZWx0YShlKTtcblxuXHRcdHRoaXMuX2RlbHRhICs9IGRlbHRhO1xuXHRcdHRoaXMuX2xhc3RNb3VzZVBvcyA9IHRoaXMuX21hcC5tb3VzZUV2ZW50VG9Db250YWluZXJQb2ludChlKTtcblxuXHRcdGlmICghdGhpcy5fc3RhcnRUaW1lKSB7XG5cdFx0XHR0aGlzLl9zdGFydFRpbWUgPSArbmV3IERhdGUoKTtcblx0XHR9XG5cblx0XHR2YXIgbGVmdCA9IE1hdGgubWF4KDQwIC0gKCtuZXcgRGF0ZSgpIC0gdGhpcy5fc3RhcnRUaW1lKSwgMCk7XG5cblx0XHRjbGVhclRpbWVvdXQodGhpcy5fdGltZXIpO1xuXHRcdHRoaXMuX3RpbWVyID0gc2V0VGltZW91dChMLmJpbmQodGhpcy5fcGVyZm9ybVpvb20sIHRoaXMpLCBsZWZ0KTtcblxuXHRcdEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQoZSk7XG5cdFx0TC5Eb21FdmVudC5zdG9wUHJvcGFnYXRpb24oZSk7XG5cdH0sXG5cblx0X3BlcmZvcm1ab29tOiBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIG1hcCA9IHRoaXMuX21hcCxcblx0XHQgICAgZGVsdGEgPSB0aGlzLl9kZWx0YSxcblx0XHQgICAgem9vbSA9IG1hcC5nZXRab29tKCk7XG5cblx0XHRkZWx0YSA9IGRlbHRhID4gMCA/IE1hdGguY2VpbChkZWx0YSkgOiBNYXRoLmZsb29yKGRlbHRhKTtcblx0XHRkZWx0YSA9IE1hdGgubWF4KE1hdGgubWluKGRlbHRhLCA0KSwgLTQpO1xuXHRcdGRlbHRhID0gbWFwLl9saW1pdFpvb20oem9vbSArIGRlbHRhKSAtIHpvb207XG5cblx0XHR0aGlzLl9kZWx0YSA9IDA7XG5cdFx0dGhpcy5fc3RhcnRUaW1lID0gbnVsbDtcblxuXHRcdGlmICghZGVsdGEpIHsgcmV0dXJuOyB9XG5cblx0XHRpZiAobWFwLm9wdGlvbnMuc2Nyb2xsV2hlZWxab29tID09PSAnY2VudGVyJykge1xuXHRcdFx0bWFwLnNldFpvb20oem9vbSArIGRlbHRhKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bWFwLnNldFpvb21Bcm91bmQodGhpcy5fbGFzdE1vdXNlUG9zLCB6b29tICsgZGVsdGEpO1xuXHRcdH1cblx0fVxufSk7XG5cbkwuTWFwLmFkZEluaXRIb29rKCdhZGRIYW5kbGVyJywgJ3Njcm9sbFdoZWVsWm9vbScsIEwuTWFwLlNjcm9sbFdoZWVsWm9vbSk7XG5cblxuLypcclxuICogRXh0ZW5kcyB0aGUgZXZlbnQgaGFuZGxpbmcgY29kZSB3aXRoIGRvdWJsZSB0YXAgc3VwcG9ydCBmb3IgbW9iaWxlIGJyb3dzZXJzLlxyXG4gKi9cclxuXHJcbkwuZXh0ZW5kKEwuRG9tRXZlbnQsIHtcclxuXHJcblx0X3RvdWNoc3RhcnQ6IEwuQnJvd3Nlci5tc1BvaW50ZXIgPyAnTVNQb2ludGVyRG93bicgOiBMLkJyb3dzZXIucG9pbnRlciA/ICdwb2ludGVyZG93bicgOiAndG91Y2hzdGFydCcsXHJcblx0X3RvdWNoZW5kOiBMLkJyb3dzZXIubXNQb2ludGVyID8gJ01TUG9pbnRlclVwJyA6IEwuQnJvd3Nlci5wb2ludGVyID8gJ3BvaW50ZXJ1cCcgOiAndG91Y2hlbmQnLFxyXG5cclxuXHQvLyBpbnNwaXJlZCBieSBaZXB0byB0b3VjaCBjb2RlIGJ5IFRob21hcyBGdWNoc1xyXG5cdGFkZERvdWJsZVRhcExpc3RlbmVyOiBmdW5jdGlvbiAob2JqLCBoYW5kbGVyLCBpZCkge1xyXG5cdFx0dmFyIGxhc3QsXHJcblx0XHQgICAgZG91YmxlVGFwID0gZmFsc2UsXHJcblx0XHQgICAgZGVsYXkgPSAyNTAsXHJcblx0XHQgICAgdG91Y2gsXHJcblx0XHQgICAgcHJlID0gJ19sZWFmbGV0XycsXHJcblx0XHQgICAgdG91Y2hzdGFydCA9IHRoaXMuX3RvdWNoc3RhcnQsXHJcblx0XHQgICAgdG91Y2hlbmQgPSB0aGlzLl90b3VjaGVuZCxcclxuXHRcdCAgICB0cmFja2VkVG91Y2hlcyA9IFtdO1xyXG5cclxuXHRcdGZ1bmN0aW9uIG9uVG91Y2hTdGFydChlKSB7XHJcblx0XHRcdHZhciBjb3VudDtcclxuXHJcblx0XHRcdGlmIChMLkJyb3dzZXIucG9pbnRlcikge1xyXG5cdFx0XHRcdHRyYWNrZWRUb3VjaGVzLnB1c2goZS5wb2ludGVySWQpO1xyXG5cdFx0XHRcdGNvdW50ID0gdHJhY2tlZFRvdWNoZXMubGVuZ3RoO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvdW50ID0gZS50b3VjaGVzLmxlbmd0aDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoY291bnQgPiAxKSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgbm93ID0gRGF0ZS5ub3coKSxcclxuXHRcdFx0XHRkZWx0YSA9IG5vdyAtIChsYXN0IHx8IG5vdyk7XHJcblxyXG5cdFx0XHR0b3VjaCA9IGUudG91Y2hlcyA/IGUudG91Y2hlc1swXSA6IGU7XHJcblx0XHRcdGRvdWJsZVRhcCA9IChkZWx0YSA+IDAgJiYgZGVsdGEgPD0gZGVsYXkpO1xyXG5cdFx0XHRsYXN0ID0gbm93O1xyXG5cdFx0fVxyXG5cclxuXHRcdGZ1bmN0aW9uIG9uVG91Y2hFbmQoZSkge1xyXG5cdFx0XHRpZiAoTC5Ccm93c2VyLnBvaW50ZXIpIHtcclxuXHRcdFx0XHR2YXIgaWR4ID0gdHJhY2tlZFRvdWNoZXMuaW5kZXhPZihlLnBvaW50ZXJJZCk7XHJcblx0XHRcdFx0aWYgKGlkeCA9PT0gLTEpIHtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dHJhY2tlZFRvdWNoZXMuc3BsaWNlKGlkeCwgMSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChkb3VibGVUYXApIHtcclxuXHRcdFx0XHRpZiAoTC5Ccm93c2VyLnBvaW50ZXIpIHtcclxuXHRcdFx0XHRcdC8vIHdvcmsgYXJvdW5kIC50eXBlIGJlaW5nIHJlYWRvbmx5IHdpdGggTVNQb2ludGVyKiBldmVudHNcclxuXHRcdFx0XHRcdHZhciBuZXdUb3VjaCA9IHsgfSxcclxuXHRcdFx0XHRcdFx0cHJvcDtcclxuXHJcblx0XHRcdFx0XHQvLyBqc2hpbnQgZm9yaW46ZmFsc2VcclxuXHRcdFx0XHRcdGZvciAodmFyIGkgaW4gdG91Y2gpIHtcclxuXHRcdFx0XHRcdFx0cHJvcCA9IHRvdWNoW2ldO1xyXG5cdFx0XHRcdFx0XHRpZiAodHlwZW9mIHByb3AgPT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHRcdFx0XHRuZXdUb3VjaFtpXSA9IHByb3AuYmluZCh0b3VjaCk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0bmV3VG91Y2hbaV0gPSBwcm9wO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0b3VjaCA9IG5ld1RvdWNoO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0b3VjaC50eXBlID0gJ2RibGNsaWNrJztcclxuXHRcdFx0XHRoYW5kbGVyKHRvdWNoKTtcclxuXHRcdFx0XHRsYXN0ID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0b2JqW3ByZSArIHRvdWNoc3RhcnQgKyBpZF0gPSBvblRvdWNoU3RhcnQ7XHJcblx0XHRvYmpbcHJlICsgdG91Y2hlbmQgKyBpZF0gPSBvblRvdWNoRW5kO1xyXG5cclxuXHRcdC8vIG9uIHBvaW50ZXIgd2UgbmVlZCB0byBsaXN0ZW4gb24gdGhlIGRvY3VtZW50LCBvdGhlcndpc2UgYSBkcmFnIHN0YXJ0aW5nIG9uIHRoZSBtYXAgYW5kIG1vdmluZyBvZmYgc2NyZWVuXHJcblx0XHQvLyB3aWxsIG5vdCBjb21lIHRocm91Z2ggdG8gdXMsIHNvIHdlIHdpbGwgbG9zZSB0cmFjayBvZiBob3cgbWFueSB0b3VjaGVzIGFyZSBvbmdvaW5nXHJcblx0XHR2YXIgZW5kRWxlbWVudCA9IEwuQnJvd3Nlci5wb2ludGVyID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IDogb2JqO1xyXG5cclxuXHRcdG9iai5hZGRFdmVudExpc3RlbmVyKHRvdWNoc3RhcnQsIG9uVG91Y2hTdGFydCwgZmFsc2UpO1xyXG5cdFx0ZW5kRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHRvdWNoZW5kLCBvblRvdWNoRW5kLCBmYWxzZSk7XHJcblxyXG5cdFx0aWYgKEwuQnJvd3Nlci5wb2ludGVyKSB7XHJcblx0XHRcdGVuZEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihMLkRvbUV2ZW50LlBPSU5URVJfQ0FOQ0VMLCBvblRvdWNoRW5kLCBmYWxzZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0cmVtb3ZlRG91YmxlVGFwTGlzdGVuZXI6IGZ1bmN0aW9uIChvYmosIGlkKSB7XHJcblx0XHR2YXIgcHJlID0gJ19sZWFmbGV0Xyc7XHJcblxyXG5cdFx0b2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fdG91Y2hzdGFydCwgb2JqW3ByZSArIHRoaXMuX3RvdWNoc3RhcnQgKyBpZF0sIGZhbHNlKTtcclxuXHRcdChMLkJyb3dzZXIucG9pbnRlciA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCA6IG9iaikucmVtb3ZlRXZlbnRMaXN0ZW5lcihcclxuXHRcdCAgICAgICAgdGhpcy5fdG91Y2hlbmQsIG9ialtwcmUgKyB0aGlzLl90b3VjaGVuZCArIGlkXSwgZmFsc2UpO1xyXG5cclxuXHRcdGlmIChMLkJyb3dzZXIucG9pbnRlcikge1xyXG5cdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihMLkRvbUV2ZW50LlBPSU5URVJfQ0FOQ0VMLCBvYmpbcHJlICsgdGhpcy5fdG91Y2hlbmQgKyBpZF0sXHJcblx0XHRcdFx0ZmFsc2UpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxufSk7XHJcblxuXG4vKlxuICogRXh0ZW5kcyBMLkRvbUV2ZW50IHRvIHByb3ZpZGUgdG91Y2ggc3VwcG9ydCBmb3IgSW50ZXJuZXQgRXhwbG9yZXIgYW5kIFdpbmRvd3MtYmFzZWQgZGV2aWNlcy5cbiAqL1xuXG5MLmV4dGVuZChMLkRvbUV2ZW50LCB7XG5cblx0Ly9zdGF0aWNcblx0UE9JTlRFUl9ET1dOOiBMLkJyb3dzZXIubXNQb2ludGVyID8gJ01TUG9pbnRlckRvd24nIDogJ3BvaW50ZXJkb3duJyxcblx0UE9JTlRFUl9NT1ZFOiBMLkJyb3dzZXIubXNQb2ludGVyID8gJ01TUG9pbnRlck1vdmUnIDogJ3BvaW50ZXJtb3ZlJyxcblx0UE9JTlRFUl9VUDogTC5Ccm93c2VyLm1zUG9pbnRlciA/ICdNU1BvaW50ZXJVcCcgOiAncG9pbnRlcnVwJyxcblx0UE9JTlRFUl9DQU5DRUw6IEwuQnJvd3Nlci5tc1BvaW50ZXIgPyAnTVNQb2ludGVyQ2FuY2VsJyA6ICdwb2ludGVyY2FuY2VsJyxcblxuXHRfcG9pbnRlcnM6IFtdLFxuXHRfcG9pbnRlckRvY3VtZW50TGlzdGVuZXI6IGZhbHNlLFxuXG5cdC8vIFByb3ZpZGVzIGEgdG91Y2ggZXZlbnRzIHdyYXBwZXIgZm9yIChtcylwb2ludGVyIGV2ZW50cy5cblx0Ly8gQmFzZWQgb24gY2hhbmdlcyBieSB2ZXByb3phIGh0dHBzOi8vZ2l0aHViLmNvbS9DbG91ZE1hZGUvTGVhZmxldC9wdWxsLzEwMTlcblx0Ly9yZWYgaHR0cDovL3d3dy53My5vcmcvVFIvcG9pbnRlcmV2ZW50cy8gaHR0cHM6Ly93d3cudzMub3JnL0J1Z3MvUHVibGljL3Nob3dfYnVnLmNnaT9pZD0yMjg5MFxuXG5cdGFkZFBvaW50ZXJMaXN0ZW5lcjogZnVuY3Rpb24gKG9iaiwgdHlwZSwgaGFuZGxlciwgaWQpIHtcblxuXHRcdHN3aXRjaCAodHlwZSkge1xuXHRcdGNhc2UgJ3RvdWNoc3RhcnQnOlxuXHRcdFx0cmV0dXJuIHRoaXMuYWRkUG9pbnRlckxpc3RlbmVyU3RhcnQob2JqLCB0eXBlLCBoYW5kbGVyLCBpZCk7XG5cdFx0Y2FzZSAndG91Y2hlbmQnOlxuXHRcdFx0cmV0dXJuIHRoaXMuYWRkUG9pbnRlckxpc3RlbmVyRW5kKG9iaiwgdHlwZSwgaGFuZGxlciwgaWQpO1xuXHRcdGNhc2UgJ3RvdWNobW92ZSc6XG5cdFx0XHRyZXR1cm4gdGhpcy5hZGRQb2ludGVyTGlzdGVuZXJNb3ZlKG9iaiwgdHlwZSwgaGFuZGxlciwgaWQpO1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHR0aHJvdyAnVW5rbm93biB0b3VjaCBldmVudCB0eXBlJztcblx0XHR9XG5cdH0sXG5cblx0YWRkUG9pbnRlckxpc3RlbmVyU3RhcnQ6IGZ1bmN0aW9uIChvYmosIHR5cGUsIGhhbmRsZXIsIGlkKSB7XG5cdFx0dmFyIHByZSA9ICdfbGVhZmxldF8nLFxuXHRcdCAgICBwb2ludGVycyA9IHRoaXMuX3BvaW50ZXJzO1xuXG5cdFx0dmFyIGNiID0gZnVuY3Rpb24gKGUpIHtcblxuXHRcdFx0TC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdChlKTtcblxuXHRcdFx0dmFyIGFscmVhZHlJbkFycmF5ID0gZmFsc2U7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50ZXJzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmIChwb2ludGVyc1tpXS5wb2ludGVySWQgPT09IGUucG9pbnRlcklkKSB7XG5cdFx0XHRcdFx0YWxyZWFkeUluQXJyYXkgPSB0cnVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoIWFscmVhZHlJbkFycmF5KSB7XG5cdFx0XHRcdHBvaW50ZXJzLnB1c2goZSk7XG5cdFx0XHR9XG5cblx0XHRcdGUudG91Y2hlcyA9IHBvaW50ZXJzLnNsaWNlKCk7XG5cdFx0XHRlLmNoYW5nZWRUb3VjaGVzID0gW2VdO1xuXG5cdFx0XHRoYW5kbGVyKGUpO1xuXHRcdH07XG5cblx0XHRvYmpbcHJlICsgJ3RvdWNoc3RhcnQnICsgaWRdID0gY2I7XG5cdFx0b2JqLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX0RPV04sIGNiLCBmYWxzZSk7XG5cblx0XHQvLyBuZWVkIHRvIGFsc28gbGlzdGVuIGZvciBlbmQgZXZlbnRzIHRvIGtlZXAgdGhlIF9wb2ludGVycyBsaXN0IGFjY3VyYXRlXG5cdFx0Ly8gdGhpcyBuZWVkcyB0byBiZSBvbiB0aGUgYm9keSBhbmQgbmV2ZXIgZ28gYXdheVxuXHRcdGlmICghdGhpcy5fcG9pbnRlckRvY3VtZW50TGlzdGVuZXIpIHtcblx0XHRcdHZhciBpbnRlcm5hbENiID0gZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludGVycy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChwb2ludGVyc1tpXS5wb2ludGVySWQgPT09IGUucG9pbnRlcklkKSB7XG5cdFx0XHRcdFx0XHRwb2ludGVycy5zcGxpY2UoaSwgMSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHQvL1dlIGxpc3RlbiBvbiB0aGUgZG9jdW1lbnRFbGVtZW50IGFzIGFueSBkcmFncyB0aGF0IGVuZCBieSBtb3ZpbmcgdGhlIHRvdWNoIG9mZiB0aGUgc2NyZWVuIGdldCBmaXJlZCB0aGVyZVxuXHRcdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX1VQLCBpbnRlcm5hbENiLCBmYWxzZSk7XG5cdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlBPSU5URVJfQ0FOQ0VMLCBpbnRlcm5hbENiLCBmYWxzZSk7XG5cblx0XHRcdHRoaXMuX3BvaW50ZXJEb2N1bWVudExpc3RlbmVyID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRhZGRQb2ludGVyTGlzdGVuZXJNb3ZlOiBmdW5jdGlvbiAob2JqLCB0eXBlLCBoYW5kbGVyLCBpZCkge1xuXHRcdHZhciBwcmUgPSAnX2xlYWZsZXRfJyxcblx0XHQgICAgdG91Y2hlcyA9IHRoaXMuX3BvaW50ZXJzO1xuXG5cdFx0ZnVuY3Rpb24gY2IoZSkge1xuXG5cdFx0XHQvLyBkb24ndCBmaXJlIHRvdWNoIG1vdmVzIHdoZW4gbW91c2UgaXNuJ3QgZG93blxuXHRcdFx0aWYgKChlLnBvaW50ZXJUeXBlID09PSBlLk1TUE9JTlRFUl9UWVBFX01PVVNFIHx8IGUucG9pbnRlclR5cGUgPT09ICdtb3VzZScpICYmIGUuYnV0dG9ucyA9PT0gMCkgeyByZXR1cm47IH1cblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0b3VjaGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmICh0b3VjaGVzW2ldLnBvaW50ZXJJZCA9PT0gZS5wb2ludGVySWQpIHtcblx0XHRcdFx0XHR0b3VjaGVzW2ldID0gZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRlLnRvdWNoZXMgPSB0b3VjaGVzLnNsaWNlKCk7XG5cdFx0XHRlLmNoYW5nZWRUb3VjaGVzID0gW2VdO1xuXG5cdFx0XHRoYW5kbGVyKGUpO1xuXHRcdH1cblxuXHRcdG9ialtwcmUgKyAndG91Y2htb3ZlJyArIGlkXSA9IGNiO1xuXHRcdG9iai5hZGRFdmVudExpc3RlbmVyKHRoaXMuUE9JTlRFUl9NT1ZFLCBjYiwgZmFsc2UpO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0YWRkUG9pbnRlckxpc3RlbmVyRW5kOiBmdW5jdGlvbiAob2JqLCB0eXBlLCBoYW5kbGVyLCBpZCkge1xuXHRcdHZhciBwcmUgPSAnX2xlYWZsZXRfJyxcblx0XHQgICAgdG91Y2hlcyA9IHRoaXMuX3BvaW50ZXJzO1xuXG5cdFx0dmFyIGNiID0gZnVuY3Rpb24gKGUpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdG91Y2hlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAodG91Y2hlc1tpXS5wb2ludGVySWQgPT09IGUucG9pbnRlcklkKSB7XG5cdFx0XHRcdFx0dG91Y2hlcy5zcGxpY2UoaSwgMSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0ZS50b3VjaGVzID0gdG91Y2hlcy5zbGljZSgpO1xuXHRcdFx0ZS5jaGFuZ2VkVG91Y2hlcyA9IFtlXTtcblxuXHRcdFx0aGFuZGxlcihlKTtcblx0XHR9O1xuXG5cdFx0b2JqW3ByZSArICd0b3VjaGVuZCcgKyBpZF0gPSBjYjtcblx0XHRvYmouYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlBPSU5URVJfVVAsIGNiLCBmYWxzZSk7XG5cdFx0b2JqLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX0NBTkNFTCwgY2IsIGZhbHNlKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHJlbW92ZVBvaW50ZXJMaXN0ZW5lcjogZnVuY3Rpb24gKG9iaiwgdHlwZSwgaWQpIHtcblx0XHR2YXIgcHJlID0gJ19sZWFmbGV0XycsXG5cdFx0ICAgIGNiID0gb2JqW3ByZSArIHR5cGUgKyBpZF07XG5cblx0XHRzd2l0Y2ggKHR5cGUpIHtcblx0XHRjYXNlICd0b3VjaHN0YXJ0Jzpcblx0XHRcdG9iai5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuUE9JTlRFUl9ET1dOLCBjYiwgZmFsc2UpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAndG91Y2htb3ZlJzpcblx0XHRcdG9iai5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuUE9JTlRFUl9NT1ZFLCBjYiwgZmFsc2UpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAndG91Y2hlbmQnOlxuXHRcdFx0b2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX1VQLCBjYiwgZmFsc2UpO1xuXHRcdFx0b2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5QT0lOVEVSX0NBTkNFTCwgY2IsIGZhbHNlKTtcblx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59KTtcblxuXG4vKlxuICogTC5IYW5kbGVyLlRvdWNoWm9vbSBpcyB1c2VkIGJ5IEwuTWFwIHRvIGFkZCBwaW5jaCB6b29tIG9uIHN1cHBvcnRlZCBtb2JpbGUgYnJvd3NlcnMuXG4gKi9cblxuTC5NYXAubWVyZ2VPcHRpb25zKHtcblx0dG91Y2hab29tOiBMLkJyb3dzZXIudG91Y2ggJiYgIUwuQnJvd3Nlci5hbmRyb2lkMjMsXG5cdGJvdW5jZUF0Wm9vbUxpbWl0czogdHJ1ZVxufSk7XG5cbkwuTWFwLlRvdWNoWm9vbSA9IEwuSGFuZGxlci5leHRlbmQoe1xuXHRhZGRIb29rczogZnVuY3Rpb24gKCkge1xuXHRcdEwuRG9tRXZlbnQub24odGhpcy5fbWFwLl9jb250YWluZXIsICd0b3VjaHN0YXJ0JywgdGhpcy5fb25Ub3VjaFN0YXJ0LCB0aGlzKTtcblx0fSxcblxuXHRyZW1vdmVIb29rczogZnVuY3Rpb24gKCkge1xuXHRcdEwuRG9tRXZlbnQub2ZmKHRoaXMuX21hcC5fY29udGFpbmVyLCAndG91Y2hzdGFydCcsIHRoaXMuX29uVG91Y2hTdGFydCwgdGhpcyk7XG5cdH0sXG5cblx0X29uVG91Y2hTdGFydDogZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwO1xuXG5cdFx0aWYgKCFlLnRvdWNoZXMgfHwgZS50b3VjaGVzLmxlbmd0aCAhPT0gMiB8fCBtYXAuX2FuaW1hdGluZ1pvb20gfHwgdGhpcy5fem9vbWluZykgeyByZXR1cm47IH1cblxuXHRcdHZhciBwMSA9IG1hcC5tb3VzZUV2ZW50VG9MYXllclBvaW50KGUudG91Y2hlc1swXSksXG5cdFx0ICAgIHAyID0gbWFwLm1vdXNlRXZlbnRUb0xheWVyUG9pbnQoZS50b3VjaGVzWzFdKSxcblx0XHQgICAgdmlld0NlbnRlciA9IG1hcC5fZ2V0Q2VudGVyTGF5ZXJQb2ludCgpO1xuXG5cdFx0dGhpcy5fc3RhcnRDZW50ZXIgPSBwMS5hZGQocDIpLl9kaXZpZGVCeSgyKTtcblx0XHR0aGlzLl9zdGFydERpc3QgPSBwMS5kaXN0YW5jZVRvKHAyKTtcblxuXHRcdHRoaXMuX21vdmVkID0gZmFsc2U7XG5cdFx0dGhpcy5fem9vbWluZyA9IHRydWU7XG5cblx0XHR0aGlzLl9jZW50ZXJPZmZzZXQgPSB2aWV3Q2VudGVyLnN1YnRyYWN0KHRoaXMuX3N0YXJ0Q2VudGVyKTtcblxuXHRcdGlmIChtYXAuX3BhbkFuaW0pIHtcblx0XHRcdG1hcC5fcGFuQW5pbS5zdG9wKCk7XG5cdFx0fVxuXG5cdFx0TC5Eb21FdmVudFxuXHRcdCAgICAub24oZG9jdW1lbnQsICd0b3VjaG1vdmUnLCB0aGlzLl9vblRvdWNoTW92ZSwgdGhpcylcblx0XHQgICAgLm9uKGRvY3VtZW50LCAndG91Y2hlbmQnLCB0aGlzLl9vblRvdWNoRW5kLCB0aGlzKTtcblxuXHRcdEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQoZSk7XG5cdH0sXG5cblx0X29uVG91Y2hNb3ZlOiBmdW5jdGlvbiAoZSkge1xuXHRcdHZhciBtYXAgPSB0aGlzLl9tYXA7XG5cblx0XHRpZiAoIWUudG91Y2hlcyB8fCBlLnRvdWNoZXMubGVuZ3RoICE9PSAyIHx8ICF0aGlzLl96b29taW5nKSB7IHJldHVybjsgfVxuXG5cdFx0dmFyIHAxID0gbWFwLm1vdXNlRXZlbnRUb0xheWVyUG9pbnQoZS50b3VjaGVzWzBdKSxcblx0XHQgICAgcDIgPSBtYXAubW91c2VFdmVudFRvTGF5ZXJQb2ludChlLnRvdWNoZXNbMV0pO1xuXG5cdFx0dGhpcy5fc2NhbGUgPSBwMS5kaXN0YW5jZVRvKHAyKSAvIHRoaXMuX3N0YXJ0RGlzdDtcblx0XHR0aGlzLl9kZWx0YSA9IHAxLl9hZGQocDIpLl9kaXZpZGVCeSgyKS5fc3VidHJhY3QodGhpcy5fc3RhcnRDZW50ZXIpO1xuXG5cdFx0aWYgKHRoaXMuX3NjYWxlID09PSAxKSB7IHJldHVybjsgfVxuXG5cdFx0aWYgKCFtYXAub3B0aW9ucy5ib3VuY2VBdFpvb21MaW1pdHMpIHtcblx0XHRcdGlmICgobWFwLmdldFpvb20oKSA9PT0gbWFwLmdldE1pblpvb20oKSAmJiB0aGlzLl9zY2FsZSA8IDEpIHx8XG5cdFx0XHQgICAgKG1hcC5nZXRab29tKCkgPT09IG1hcC5nZXRNYXhab29tKCkgJiYgdGhpcy5fc2NhbGUgPiAxKSkgeyByZXR1cm47IH1cblx0XHR9XG5cblx0XHRpZiAoIXRoaXMuX21vdmVkKSB7XG5cdFx0XHRMLkRvbVV0aWwuYWRkQ2xhc3MobWFwLl9tYXBQYW5lLCAnbGVhZmxldC10b3VjaGluZycpO1xuXG5cdFx0XHRtYXBcblx0XHRcdCAgICAuZmlyZSgnbW92ZXN0YXJ0Jylcblx0XHRcdCAgICAuZmlyZSgnem9vbXN0YXJ0Jyk7XG5cblx0XHRcdHRoaXMuX21vdmVkID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRMLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2FuaW1SZXF1ZXN0KTtcblx0XHR0aGlzLl9hbmltUmVxdWVzdCA9IEwuVXRpbC5yZXF1ZXN0QW5pbUZyYW1lKFxuXHRcdCAgICAgICAgdGhpcy5fdXBkYXRlT25Nb3ZlLCB0aGlzLCB0cnVlLCB0aGlzLl9tYXAuX2NvbnRhaW5lcik7XG5cblx0XHRMLkRvbUV2ZW50LnByZXZlbnREZWZhdWx0KGUpO1xuXHR9LFxuXG5cdF91cGRhdGVPbk1vdmU6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwLFxuXHRcdCAgICBvcmlnaW4gPSB0aGlzLl9nZXRTY2FsZU9yaWdpbigpLFxuXHRcdCAgICBjZW50ZXIgPSBtYXAubGF5ZXJQb2ludFRvTGF0TG5nKG9yaWdpbiksXG5cdFx0ICAgIHpvb20gPSBtYXAuZ2V0U2NhbGVab29tKHRoaXMuX3NjYWxlKTtcblxuXHRcdG1hcC5fYW5pbWF0ZVpvb20oY2VudGVyLCB6b29tLCB0aGlzLl9zdGFydENlbnRlciwgdGhpcy5fc2NhbGUsIHRoaXMuX2RlbHRhLCBmYWxzZSwgdHJ1ZSk7XG5cdH0sXG5cblx0X29uVG91Y2hFbmQ6IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoIXRoaXMuX21vdmVkIHx8ICF0aGlzLl96b29taW5nKSB7XG5cdFx0XHR0aGlzLl96b29taW5nID0gZmFsc2U7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFyIG1hcCA9IHRoaXMuX21hcDtcblxuXHRcdHRoaXMuX3pvb21pbmcgPSBmYWxzZTtcblx0XHRMLkRvbVV0aWwucmVtb3ZlQ2xhc3MobWFwLl9tYXBQYW5lLCAnbGVhZmxldC10b3VjaGluZycpO1xuXHRcdEwuVXRpbC5jYW5jZWxBbmltRnJhbWUodGhpcy5fYW5pbVJlcXVlc3QpO1xuXG5cdFx0TC5Eb21FdmVudFxuXHRcdCAgICAub2ZmKGRvY3VtZW50LCAndG91Y2htb3ZlJywgdGhpcy5fb25Ub3VjaE1vdmUpXG5cdFx0ICAgIC5vZmYoZG9jdW1lbnQsICd0b3VjaGVuZCcsIHRoaXMuX29uVG91Y2hFbmQpO1xuXG5cdFx0dmFyIG9yaWdpbiA9IHRoaXMuX2dldFNjYWxlT3JpZ2luKCksXG5cdFx0ICAgIGNlbnRlciA9IG1hcC5sYXllclBvaW50VG9MYXRMbmcob3JpZ2luKSxcblxuXHRcdCAgICBvbGRab29tID0gbWFwLmdldFpvb20oKSxcblx0XHQgICAgZmxvYXRab29tRGVsdGEgPSBtYXAuZ2V0U2NhbGVab29tKHRoaXMuX3NjYWxlKSAtIG9sZFpvb20sXG5cdFx0ICAgIHJvdW5kWm9vbURlbHRhID0gKGZsb2F0Wm9vbURlbHRhID4gMCA/XG5cdFx0ICAgICAgICAgICAgTWF0aC5jZWlsKGZsb2F0Wm9vbURlbHRhKSA6IE1hdGguZmxvb3IoZmxvYXRab29tRGVsdGEpKSxcblxuXHRcdCAgICB6b29tID0gbWFwLl9saW1pdFpvb20ob2xkWm9vbSArIHJvdW5kWm9vbURlbHRhKSxcblx0XHQgICAgc2NhbGUgPSBtYXAuZ2V0Wm9vbVNjYWxlKHpvb20pIC8gdGhpcy5fc2NhbGU7XG5cblx0XHRtYXAuX2FuaW1hdGVab29tKGNlbnRlciwgem9vbSwgb3JpZ2luLCBzY2FsZSk7XG5cdH0sXG5cblx0X2dldFNjYWxlT3JpZ2luOiBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIGNlbnRlck9mZnNldCA9IHRoaXMuX2NlbnRlck9mZnNldC5zdWJ0cmFjdCh0aGlzLl9kZWx0YSkuZGl2aWRlQnkodGhpcy5fc2NhbGUpO1xuXHRcdHJldHVybiB0aGlzLl9zdGFydENlbnRlci5hZGQoY2VudGVyT2Zmc2V0KTtcblx0fVxufSk7XG5cbkwuTWFwLmFkZEluaXRIb29rKCdhZGRIYW5kbGVyJywgJ3RvdWNoWm9vbScsIEwuTWFwLlRvdWNoWm9vbSk7XG5cblxuLypcbiAqIEwuTWFwLlRhcCBpcyB1c2VkIHRvIGVuYWJsZSBtb2JpbGUgaGFja3MgbGlrZSBxdWljayB0YXBzIGFuZCBsb25nIGhvbGQuXG4gKi9cblxuTC5NYXAubWVyZ2VPcHRpb25zKHtcblx0dGFwOiB0cnVlLFxuXHR0YXBUb2xlcmFuY2U6IDE1XG59KTtcblxuTC5NYXAuVGFwID0gTC5IYW5kbGVyLmV4dGVuZCh7XG5cdGFkZEhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0TC5Eb21FdmVudC5vbih0aGlzLl9tYXAuX2NvbnRhaW5lciwgJ3RvdWNoc3RhcnQnLCB0aGlzLl9vbkRvd24sIHRoaXMpO1xuXHR9LFxuXG5cdHJlbW92ZUhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0TC5Eb21FdmVudC5vZmYodGhpcy5fbWFwLl9jb250YWluZXIsICd0b3VjaHN0YXJ0JywgdGhpcy5fb25Eb3duLCB0aGlzKTtcblx0fSxcblxuXHRfb25Eb3duOiBmdW5jdGlvbiAoZSkge1xuXHRcdGlmICghZS50b3VjaGVzKSB7IHJldHVybjsgfVxuXG5cdFx0TC5Eb21FdmVudC5wcmV2ZW50RGVmYXVsdChlKTtcblxuXHRcdHRoaXMuX2ZpcmVDbGljayA9IHRydWU7XG5cblx0XHQvLyBkb24ndCBzaW11bGF0ZSBjbGljayBvciB0cmFjayBsb25ncHJlc3MgaWYgbW9yZSB0aGFuIDEgdG91Y2hcblx0XHRpZiAoZS50b3VjaGVzLmxlbmd0aCA+IDEpIHtcblx0XHRcdHRoaXMuX2ZpcmVDbGljayA9IGZhbHNlO1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMuX2hvbGRUaW1lb3V0KTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR2YXIgZmlyc3QgPSBlLnRvdWNoZXNbMF0sXG5cdFx0ICAgIGVsID0gZmlyc3QudGFyZ2V0O1xuXG5cdFx0dGhpcy5fc3RhcnRQb3MgPSB0aGlzLl9uZXdQb3MgPSBuZXcgTC5Qb2ludChmaXJzdC5jbGllbnRYLCBmaXJzdC5jbGllbnRZKTtcblxuXHRcdC8vIGlmIHRvdWNoaW5nIGEgbGluaywgaGlnaGxpZ2h0IGl0XG5cdFx0aWYgKGVsLnRhZ05hbWUgJiYgZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYScpIHtcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyhlbCwgJ2xlYWZsZXQtYWN0aXZlJyk7XG5cdFx0fVxuXG5cdFx0Ly8gc2ltdWxhdGUgbG9uZyBob2xkIGJ1dCBzZXR0aW5nIGEgdGltZW91dFxuXHRcdHRoaXMuX2hvbGRUaW1lb3V0ID0gc2V0VGltZW91dChMLmJpbmQoZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKHRoaXMuX2lzVGFwVmFsaWQoKSkge1xuXHRcdFx0XHR0aGlzLl9maXJlQ2xpY2sgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy5fb25VcCgpO1xuXHRcdFx0XHR0aGlzLl9zaW11bGF0ZUV2ZW50KCdjb250ZXh0bWVudScsIGZpcnN0KTtcblx0XHRcdH1cblx0XHR9LCB0aGlzKSwgMTAwMCk7XG5cblx0XHRMLkRvbUV2ZW50XG5cdFx0XHQub24oZG9jdW1lbnQsICd0b3VjaG1vdmUnLCB0aGlzLl9vbk1vdmUsIHRoaXMpXG5cdFx0XHQub24oZG9jdW1lbnQsICd0b3VjaGVuZCcsIHRoaXMuX29uVXAsIHRoaXMpO1xuXHR9LFxuXG5cdF9vblVwOiBmdW5jdGlvbiAoZSkge1xuXHRcdGNsZWFyVGltZW91dCh0aGlzLl9ob2xkVGltZW91dCk7XG5cblx0XHRMLkRvbUV2ZW50XG5cdFx0XHQub2ZmKGRvY3VtZW50LCAndG91Y2htb3ZlJywgdGhpcy5fb25Nb3ZlLCB0aGlzKVxuXHRcdFx0Lm9mZihkb2N1bWVudCwgJ3RvdWNoZW5kJywgdGhpcy5fb25VcCwgdGhpcyk7XG5cblx0XHRpZiAodGhpcy5fZmlyZUNsaWNrICYmIGUgJiYgZS5jaGFuZ2VkVG91Y2hlcykge1xuXG5cdFx0XHR2YXIgZmlyc3QgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLFxuXHRcdFx0ICAgIGVsID0gZmlyc3QudGFyZ2V0O1xuXG5cdFx0XHRpZiAoZWwgJiYgZWwudGFnTmFtZSAmJiBlbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJykge1xuXHRcdFx0XHRMLkRvbVV0aWwucmVtb3ZlQ2xhc3MoZWwsICdsZWFmbGV0LWFjdGl2ZScpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBzaW11bGF0ZSBjbGljayBpZiB0aGUgdG91Y2ggZGlkbid0IG1vdmUgdG9vIG11Y2hcblx0XHRcdGlmICh0aGlzLl9pc1RhcFZhbGlkKCkpIHtcblx0XHRcdFx0dGhpcy5fc2ltdWxhdGVFdmVudCgnY2xpY2snLCBmaXJzdCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9pc1RhcFZhbGlkOiBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX25ld1Bvcy5kaXN0YW5jZVRvKHRoaXMuX3N0YXJ0UG9zKSA8PSB0aGlzLl9tYXAub3B0aW9ucy50YXBUb2xlcmFuY2U7XG5cdH0sXG5cblx0X29uTW92ZTogZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgZmlyc3QgPSBlLnRvdWNoZXNbMF07XG5cdFx0dGhpcy5fbmV3UG9zID0gbmV3IEwuUG9pbnQoZmlyc3QuY2xpZW50WCwgZmlyc3QuY2xpZW50WSk7XG5cdH0sXG5cblx0X3NpbXVsYXRlRXZlbnQ6IGZ1bmN0aW9uICh0eXBlLCBlKSB7XG5cdFx0dmFyIHNpbXVsYXRlZEV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ01vdXNlRXZlbnRzJyk7XG5cblx0XHRzaW11bGF0ZWRFdmVudC5fc2ltdWxhdGVkID0gdHJ1ZTtcblx0XHRlLnRhcmdldC5fc2ltdWxhdGVkQ2xpY2sgPSB0cnVlO1xuXG5cdFx0c2ltdWxhdGVkRXZlbnQuaW5pdE1vdXNlRXZlbnQoXG5cdFx0ICAgICAgICB0eXBlLCB0cnVlLCB0cnVlLCB3aW5kb3csIDEsXG5cdFx0ICAgICAgICBlLnNjcmVlblgsIGUuc2NyZWVuWSxcblx0XHQgICAgICAgIGUuY2xpZW50WCwgZS5jbGllbnRZLFxuXHRcdCAgICAgICAgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDAsIG51bGwpO1xuXG5cdFx0ZS50YXJnZXQuZGlzcGF0Y2hFdmVudChzaW11bGF0ZWRFdmVudCk7XG5cdH1cbn0pO1xuXG5pZiAoTC5Ccm93c2VyLnRvdWNoICYmICFMLkJyb3dzZXIucG9pbnRlcikge1xuXHRMLk1hcC5hZGRJbml0SG9vaygnYWRkSGFuZGxlcicsICd0YXAnLCBMLk1hcC5UYXApO1xufVxuXG5cbi8qXG4gKiBMLkhhbmRsZXIuU2hpZnREcmFnWm9vbSBpcyB1c2VkIHRvIGFkZCBzaGlmdC1kcmFnIHpvb20gaW50ZXJhY3Rpb24gdG8gdGhlIG1hcFxuICAqICh6b29tIHRvIGEgc2VsZWN0ZWQgYm91bmRpbmcgYm94KSwgZW5hYmxlZCBieSBkZWZhdWx0LlxuICovXG5cbkwuTWFwLm1lcmdlT3B0aW9ucyh7XG5cdGJveFpvb206IHRydWVcbn0pO1xuXG5MLk1hcC5Cb3hab29tID0gTC5IYW5kbGVyLmV4dGVuZCh7XG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uIChtYXApIHtcblx0XHR0aGlzLl9tYXAgPSBtYXA7XG5cdFx0dGhpcy5fY29udGFpbmVyID0gbWFwLl9jb250YWluZXI7XG5cdFx0dGhpcy5fcGFuZSA9IG1hcC5fcGFuZXMub3ZlcmxheVBhbmU7XG5cdFx0dGhpcy5fbW92ZWQgPSBmYWxzZTtcblx0fSxcblxuXHRhZGRIb29rczogZnVuY3Rpb24gKCkge1xuXHRcdEwuRG9tRXZlbnQub24odGhpcy5fY29udGFpbmVyLCAnbW91c2Vkb3duJywgdGhpcy5fb25Nb3VzZURvd24sIHRoaXMpO1xuXHR9LFxuXG5cdHJlbW92ZUhvb2tzOiBmdW5jdGlvbiAoKSB7XG5cdFx0TC5Eb21FdmVudC5vZmYodGhpcy5fY29udGFpbmVyLCAnbW91c2Vkb3duJywgdGhpcy5fb25Nb3VzZURvd24pO1xuXHRcdHRoaXMuX21vdmVkID0gZmFsc2U7XG5cdH0sXG5cblx0bW92ZWQ6IGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gdGhpcy5fbW92ZWQ7XG5cdH0sXG5cblx0X29uTW91c2VEb3duOiBmdW5jdGlvbiAoZSkge1xuXHRcdHRoaXMuX21vdmVkID0gZmFsc2U7XG5cblx0XHRpZiAoIWUuc2hpZnRLZXkgfHwgKChlLndoaWNoICE9PSAxKSAmJiAoZS5idXR0b24gIT09IDEpKSkgeyByZXR1cm4gZmFsc2U7IH1cblxuXHRcdEwuRG9tVXRpbC5kaXNhYmxlVGV4dFNlbGVjdGlvbigpO1xuXHRcdEwuRG9tVXRpbC5kaXNhYmxlSW1hZ2VEcmFnKCk7XG5cblx0XHR0aGlzLl9zdGFydExheWVyUG9pbnQgPSB0aGlzLl9tYXAubW91c2VFdmVudFRvTGF5ZXJQb2ludChlKTtcblxuXHRcdEwuRG9tRXZlbnRcblx0XHQgICAgLm9uKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5fb25Nb3VzZU1vdmUsIHRoaXMpXG5cdFx0ICAgIC5vbihkb2N1bWVudCwgJ21vdXNldXAnLCB0aGlzLl9vbk1vdXNlVXAsIHRoaXMpXG5cdFx0ICAgIC5vbihkb2N1bWVudCwgJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24sIHRoaXMpO1xuXHR9LFxuXG5cdF9vbk1vdXNlTW92ZTogZnVuY3Rpb24gKGUpIHtcblx0XHRpZiAoIXRoaXMuX21vdmVkKSB7XG5cdFx0XHR0aGlzLl9ib3ggPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCAnbGVhZmxldC16b29tLWJveCcsIHRoaXMuX3BhbmUpO1xuXHRcdFx0TC5Eb21VdGlsLnNldFBvc2l0aW9uKHRoaXMuX2JveCwgdGhpcy5fc3RhcnRMYXllclBvaW50KTtcblxuXHRcdFx0Ly9UT0RPIHJlZmFjdG9yOiBtb3ZlIGN1cnNvciB0byBzdHlsZXNcblx0XHRcdHRoaXMuX2NvbnRhaW5lci5zdHlsZS5jdXJzb3IgPSAnY3Jvc3NoYWlyJztcblx0XHRcdHRoaXMuX21hcC5maXJlKCdib3h6b29tc3RhcnQnKTtcblx0XHR9XG5cblx0XHR2YXIgc3RhcnRQb2ludCA9IHRoaXMuX3N0YXJ0TGF5ZXJQb2ludCxcblx0XHQgICAgYm94ID0gdGhpcy5fYm94LFxuXG5cdFx0ICAgIGxheWVyUG9pbnQgPSB0aGlzLl9tYXAubW91c2VFdmVudFRvTGF5ZXJQb2ludChlKSxcblx0XHQgICAgb2Zmc2V0ID0gbGF5ZXJQb2ludC5zdWJ0cmFjdChzdGFydFBvaW50KSxcblxuXHRcdCAgICBuZXdQb3MgPSBuZXcgTC5Qb2ludChcblx0XHQgICAgICAgIE1hdGgubWluKGxheWVyUG9pbnQueCwgc3RhcnRQb2ludC54KSxcblx0XHQgICAgICAgIE1hdGgubWluKGxheWVyUG9pbnQueSwgc3RhcnRQb2ludC55KSk7XG5cblx0XHRMLkRvbVV0aWwuc2V0UG9zaXRpb24oYm94LCBuZXdQb3MpO1xuXG5cdFx0dGhpcy5fbW92ZWQgPSB0cnVlO1xuXG5cdFx0Ly8gVE9ETyByZWZhY3RvcjogcmVtb3ZlIGhhcmRjb2RlZCA0IHBpeGVsc1xuXHRcdGJveC5zdHlsZS53aWR0aCAgPSAoTWF0aC5tYXgoMCwgTWF0aC5hYnMob2Zmc2V0LngpIC0gNCkpICsgJ3B4Jztcblx0XHRib3guc3R5bGUuaGVpZ2h0ID0gKE1hdGgubWF4KDAsIE1hdGguYWJzKG9mZnNldC55KSAtIDQpKSArICdweCc7XG5cdH0sXG5cblx0X2ZpbmlzaDogZnVuY3Rpb24gKCkge1xuXHRcdGlmICh0aGlzLl9tb3ZlZCkge1xuXHRcdFx0dGhpcy5fcGFuZS5yZW1vdmVDaGlsZCh0aGlzLl9ib3gpO1xuXHRcdFx0dGhpcy5fY29udGFpbmVyLnN0eWxlLmN1cnNvciA9ICcnO1xuXHRcdH1cblxuXHRcdEwuRG9tVXRpbC5lbmFibGVUZXh0U2VsZWN0aW9uKCk7XG5cdFx0TC5Eb21VdGlsLmVuYWJsZUltYWdlRHJhZygpO1xuXG5cdFx0TC5Eb21FdmVudFxuXHRcdCAgICAub2ZmKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5fb25Nb3VzZU1vdmUpXG5cdFx0ICAgIC5vZmYoZG9jdW1lbnQsICdtb3VzZXVwJywgdGhpcy5fb25Nb3VzZVVwKVxuXHRcdCAgICAub2ZmKGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMuX29uS2V5RG93bik7XG5cdH0sXG5cblx0X29uTW91c2VVcDogZnVuY3Rpb24gKGUpIHtcblxuXHRcdHRoaXMuX2ZpbmlzaCgpO1xuXG5cdFx0dmFyIG1hcCA9IHRoaXMuX21hcCxcblx0XHQgICAgbGF5ZXJQb2ludCA9IG1hcC5tb3VzZUV2ZW50VG9MYXllclBvaW50KGUpO1xuXG5cdFx0aWYgKHRoaXMuX3N0YXJ0TGF5ZXJQb2ludC5lcXVhbHMobGF5ZXJQb2ludCkpIHsgcmV0dXJuOyB9XG5cblx0XHR2YXIgYm91bmRzID0gbmV3IEwuTGF0TG5nQm91bmRzKFxuXHRcdCAgICAgICAgbWFwLmxheWVyUG9pbnRUb0xhdExuZyh0aGlzLl9zdGFydExheWVyUG9pbnQpLFxuXHRcdCAgICAgICAgbWFwLmxheWVyUG9pbnRUb0xhdExuZyhsYXllclBvaW50KSk7XG5cblx0XHRtYXAuZml0Qm91bmRzKGJvdW5kcyk7XG5cblx0XHRtYXAuZmlyZSgnYm94em9vbWVuZCcsIHtcblx0XHRcdGJveFpvb21Cb3VuZHM6IGJvdW5kc1xuXHRcdH0pO1xuXHR9LFxuXG5cdF9vbktleURvd246IGZ1bmN0aW9uIChlKSB7XG5cdFx0aWYgKGUua2V5Q29kZSA9PT0gMjcpIHtcblx0XHRcdHRoaXMuX2ZpbmlzaCgpO1xuXHRcdH1cblx0fVxufSk7XG5cbkwuTWFwLmFkZEluaXRIb29rKCdhZGRIYW5kbGVyJywgJ2JveFpvb20nLCBMLk1hcC5Cb3hab29tKTtcblxuXG4vKlxuICogTC5NYXAuS2V5Ym9hcmQgaXMgaGFuZGxpbmcga2V5Ym9hcmQgaW50ZXJhY3Rpb24gd2l0aCB0aGUgbWFwLCBlbmFibGVkIGJ5IGRlZmF1bHQuXG4gKi9cblxuTC5NYXAubWVyZ2VPcHRpb25zKHtcblx0a2V5Ym9hcmQ6IHRydWUsXG5cdGtleWJvYXJkUGFuT2Zmc2V0OiA4MCxcblx0a2V5Ym9hcmRab29tT2Zmc2V0OiAxXG59KTtcblxuTC5NYXAuS2V5Ym9hcmQgPSBMLkhhbmRsZXIuZXh0ZW5kKHtcblxuXHRrZXlDb2Rlczoge1xuXHRcdGxlZnQ6ICAgIFszN10sXG5cdFx0cmlnaHQ6ICAgWzM5XSxcblx0XHRkb3duOiAgICBbNDBdLFxuXHRcdHVwOiAgICAgIFszOF0sXG5cdFx0em9vbUluOiAgWzE4NywgMTA3LCA2MSwgMTcxXSxcblx0XHR6b29tT3V0OiBbMTg5LCAxMDksIDE3M11cblx0fSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbiAobWFwKSB7XG5cdFx0dGhpcy5fbWFwID0gbWFwO1xuXG5cdFx0dGhpcy5fc2V0UGFuT2Zmc2V0KG1hcC5vcHRpb25zLmtleWJvYXJkUGFuT2Zmc2V0KTtcblx0XHR0aGlzLl9zZXRab29tT2Zmc2V0KG1hcC5vcHRpb25zLmtleWJvYXJkWm9vbU9mZnNldCk7XG5cdH0sXG5cblx0YWRkSG9va3M6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgY29udGFpbmVyID0gdGhpcy5fbWFwLl9jb250YWluZXI7XG5cblx0XHQvLyBtYWtlIHRoZSBjb250YWluZXIgZm9jdXNhYmxlIGJ5IHRhYmJpbmdcblx0XHRpZiAoY29udGFpbmVyLnRhYkluZGV4ID09PSAtMSkge1xuXHRcdFx0Y29udGFpbmVyLnRhYkluZGV4ID0gJzAnO1xuXHRcdH1cblxuXHRcdEwuRG9tRXZlbnRcblx0XHQgICAgLm9uKGNvbnRhaW5lciwgJ2ZvY3VzJywgdGhpcy5fb25Gb2N1cywgdGhpcylcblx0XHQgICAgLm9uKGNvbnRhaW5lciwgJ2JsdXInLCB0aGlzLl9vbkJsdXIsIHRoaXMpXG5cdFx0ICAgIC5vbihjb250YWluZXIsICdtb3VzZWRvd24nLCB0aGlzLl9vbk1vdXNlRG93biwgdGhpcyk7XG5cblx0XHR0aGlzLl9tYXBcblx0XHQgICAgLm9uKCdmb2N1cycsIHRoaXMuX2FkZEhvb2tzLCB0aGlzKVxuXHRcdCAgICAub24oJ2JsdXInLCB0aGlzLl9yZW1vdmVIb29rcywgdGhpcyk7XG5cdH0sXG5cblx0cmVtb3ZlSG9va3M6IGZ1bmN0aW9uICgpIHtcblx0XHR0aGlzLl9yZW1vdmVIb29rcygpO1xuXG5cdFx0dmFyIGNvbnRhaW5lciA9IHRoaXMuX21hcC5fY29udGFpbmVyO1xuXG5cdFx0TC5Eb21FdmVudFxuXHRcdCAgICAub2ZmKGNvbnRhaW5lciwgJ2ZvY3VzJywgdGhpcy5fb25Gb2N1cywgdGhpcylcblx0XHQgICAgLm9mZihjb250YWluZXIsICdibHVyJywgdGhpcy5fb25CbHVyLCB0aGlzKVxuXHRcdCAgICAub2ZmKGNvbnRhaW5lciwgJ21vdXNlZG93bicsIHRoaXMuX29uTW91c2VEb3duLCB0aGlzKTtcblxuXHRcdHRoaXMuX21hcFxuXHRcdCAgICAub2ZmKCdmb2N1cycsIHRoaXMuX2FkZEhvb2tzLCB0aGlzKVxuXHRcdCAgICAub2ZmKCdibHVyJywgdGhpcy5fcmVtb3ZlSG9va3MsIHRoaXMpO1xuXHR9LFxuXG5cdF9vbk1vdXNlRG93bjogZnVuY3Rpb24gKCkge1xuXHRcdGlmICh0aGlzLl9mb2N1c2VkKSB7IHJldHVybjsgfVxuXG5cdFx0dmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5LFxuXHRcdCAgICBkb2NFbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxcblx0XHQgICAgdG9wID0gYm9keS5zY3JvbGxUb3AgfHwgZG9jRWwuc2Nyb2xsVG9wLFxuXHRcdCAgICBsZWZ0ID0gYm9keS5zY3JvbGxMZWZ0IHx8IGRvY0VsLnNjcm9sbExlZnQ7XG5cblx0XHR0aGlzLl9tYXAuX2NvbnRhaW5lci5mb2N1cygpO1xuXG5cdFx0d2luZG93LnNjcm9sbFRvKGxlZnQsIHRvcCk7XG5cdH0sXG5cblx0X29uRm9jdXM6IGZ1bmN0aW9uICgpIHtcblx0XHR0aGlzLl9mb2N1c2VkID0gdHJ1ZTtcblx0XHR0aGlzLl9tYXAuZmlyZSgnZm9jdXMnKTtcblx0fSxcblxuXHRfb25CbHVyOiBmdW5jdGlvbiAoKSB7XG5cdFx0dGhpcy5fZm9jdXNlZCA9IGZhbHNlO1xuXHRcdHRoaXMuX21hcC5maXJlKCdibHVyJyk7XG5cdH0sXG5cblx0X3NldFBhbk9mZnNldDogZnVuY3Rpb24gKHBhbikge1xuXHRcdHZhciBrZXlzID0gdGhpcy5fcGFuS2V5cyA9IHt9LFxuXHRcdCAgICBjb2RlcyA9IHRoaXMua2V5Q29kZXMsXG5cdFx0ICAgIGksIGxlbjtcblxuXHRcdGZvciAoaSA9IDAsIGxlbiA9IGNvZGVzLmxlZnQubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdGtleXNbY29kZXMubGVmdFtpXV0gPSBbLTEgKiBwYW4sIDBdO1xuXHRcdH1cblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBjb2Rlcy5yaWdodC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0a2V5c1tjb2Rlcy5yaWdodFtpXV0gPSBbcGFuLCAwXTtcblx0XHR9XG5cdFx0Zm9yIChpID0gMCwgbGVuID0gY29kZXMuZG93bi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0a2V5c1tjb2Rlcy5kb3duW2ldXSA9IFswLCBwYW5dO1xuXHRcdH1cblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBjb2Rlcy51cC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0a2V5c1tjb2Rlcy51cFtpXV0gPSBbMCwgLTEgKiBwYW5dO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0Wm9vbU9mZnNldDogZnVuY3Rpb24gKHpvb20pIHtcblx0XHR2YXIga2V5cyA9IHRoaXMuX3pvb21LZXlzID0ge30sXG5cdFx0ICAgIGNvZGVzID0gdGhpcy5rZXlDb2Rlcyxcblx0XHQgICAgaSwgbGVuO1xuXG5cdFx0Zm9yIChpID0gMCwgbGVuID0gY29kZXMuem9vbUluLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRrZXlzW2NvZGVzLnpvb21JbltpXV0gPSB6b29tO1xuXHRcdH1cblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBjb2Rlcy56b29tT3V0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRrZXlzW2NvZGVzLnpvb21PdXRbaV1dID0gLXpvb207XG5cdFx0fVxuXHR9LFxuXG5cdF9hZGRIb29rczogZnVuY3Rpb24gKCkge1xuXHRcdEwuRG9tRXZlbnQub24oZG9jdW1lbnQsICdrZXlkb3duJywgdGhpcy5fb25LZXlEb3duLCB0aGlzKTtcblx0fSxcblxuXHRfcmVtb3ZlSG9va3M6IGZ1bmN0aW9uICgpIHtcblx0XHRMLkRvbUV2ZW50Lm9mZihkb2N1bWVudCwgJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24sIHRoaXMpO1xuXHR9LFxuXG5cdF9vbktleURvd246IGZ1bmN0aW9uIChlKSB7XG5cdFx0dmFyIGtleSA9IGUua2V5Q29kZSxcblx0XHQgICAgbWFwID0gdGhpcy5fbWFwO1xuXG5cdFx0aWYgKGtleSBpbiB0aGlzLl9wYW5LZXlzKSB7XG5cblx0XHRcdGlmIChtYXAuX3BhbkFuaW0gJiYgbWFwLl9wYW5BbmltLl9pblByb2dyZXNzKSB7IHJldHVybjsgfVxuXG5cdFx0XHRtYXAucGFuQnkodGhpcy5fcGFuS2V5c1trZXldKTtcblxuXHRcdFx0aWYgKG1hcC5vcHRpb25zLm1heEJvdW5kcykge1xuXHRcdFx0XHRtYXAucGFuSW5zaWRlQm91bmRzKG1hcC5vcHRpb25zLm1heEJvdW5kcyk7XG5cdFx0XHR9XG5cblx0XHR9IGVsc2UgaWYgKGtleSBpbiB0aGlzLl96b29tS2V5cykge1xuXHRcdFx0bWFwLnNldFpvb20obWFwLmdldFpvb20oKSArIHRoaXMuX3pvb21LZXlzW2tleV0pO1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRMLkRvbUV2ZW50LnN0b3AoZSk7XG5cdH1cbn0pO1xuXG5MLk1hcC5hZGRJbml0SG9vaygnYWRkSGFuZGxlcicsICdrZXlib2FyZCcsIEwuTWFwLktleWJvYXJkKTtcblxuXG4vKlxuICogTC5IYW5kbGVyLk1hcmtlckRyYWcgaXMgdXNlZCBpbnRlcm5hbGx5IGJ5IEwuTWFya2VyIHRvIG1ha2UgdGhlIG1hcmtlcnMgZHJhZ2dhYmxlLlxuICovXG5cbkwuSGFuZGxlci5NYXJrZXJEcmFnID0gTC5IYW5kbGVyLmV4dGVuZCh7XG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uIChtYXJrZXIpIHtcblx0XHR0aGlzLl9tYXJrZXIgPSBtYXJrZXI7XG5cdH0sXG5cblx0YWRkSG9va3M6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgaWNvbiA9IHRoaXMuX21hcmtlci5faWNvbjtcblx0XHRpZiAoIXRoaXMuX2RyYWdnYWJsZSkge1xuXHRcdFx0dGhpcy5fZHJhZ2dhYmxlID0gbmV3IEwuRHJhZ2dhYmxlKGljb24sIGljb24pO1xuXHRcdH1cblxuXHRcdHRoaXMuX2RyYWdnYWJsZVxuXHRcdFx0Lm9uKCdkcmFnc3RhcnQnLCB0aGlzLl9vbkRyYWdTdGFydCwgdGhpcylcblx0XHRcdC5vbignZHJhZycsIHRoaXMuX29uRHJhZywgdGhpcylcblx0XHRcdC5vbignZHJhZ2VuZCcsIHRoaXMuX29uRHJhZ0VuZCwgdGhpcyk7XG5cdFx0dGhpcy5fZHJhZ2dhYmxlLmVuYWJsZSgpO1xuXHRcdEwuRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9tYXJrZXIuX2ljb24sICdsZWFmbGV0LW1hcmtlci1kcmFnZ2FibGUnKTtcblx0fSxcblxuXHRyZW1vdmVIb29rczogZnVuY3Rpb24gKCkge1xuXHRcdHRoaXMuX2RyYWdnYWJsZVxuXHRcdFx0Lm9mZignZHJhZ3N0YXJ0JywgdGhpcy5fb25EcmFnU3RhcnQsIHRoaXMpXG5cdFx0XHQub2ZmKCdkcmFnJywgdGhpcy5fb25EcmFnLCB0aGlzKVxuXHRcdFx0Lm9mZignZHJhZ2VuZCcsIHRoaXMuX29uRHJhZ0VuZCwgdGhpcyk7XG5cblx0XHR0aGlzLl9kcmFnZ2FibGUuZGlzYWJsZSgpO1xuXHRcdEwuRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl9tYXJrZXIuX2ljb24sICdsZWFmbGV0LW1hcmtlci1kcmFnZ2FibGUnKTtcblx0fSxcblxuXHRtb3ZlZDogZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiB0aGlzLl9kcmFnZ2FibGUgJiYgdGhpcy5fZHJhZ2dhYmxlLl9tb3ZlZDtcblx0fSxcblxuXHRfb25EcmFnU3RhcnQ6IGZ1bmN0aW9uICgpIHtcblx0XHR0aGlzLl9tYXJrZXJcblx0XHQgICAgLmNsb3NlUG9wdXAoKVxuXHRcdCAgICAuZmlyZSgnbW92ZXN0YXJ0Jylcblx0XHQgICAgLmZpcmUoJ2RyYWdzdGFydCcpO1xuXHR9LFxuXG5cdF9vbkRyYWc6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgbWFya2VyID0gdGhpcy5fbWFya2VyLFxuXHRcdCAgICBzaGFkb3cgPSBtYXJrZXIuX3NoYWRvdyxcblx0XHQgICAgaWNvblBvcyA9IEwuRG9tVXRpbC5nZXRQb3NpdGlvbihtYXJrZXIuX2ljb24pLFxuXHRcdCAgICBsYXRsbmcgPSBtYXJrZXIuX21hcC5sYXllclBvaW50VG9MYXRMbmcoaWNvblBvcyk7XG5cblx0XHQvLyB1cGRhdGUgc2hhZG93IHBvc2l0aW9uXG5cdFx0aWYgKHNoYWRvdykge1xuXHRcdFx0TC5Eb21VdGlsLnNldFBvc2l0aW9uKHNoYWRvdywgaWNvblBvcyk7XG5cdFx0fVxuXG5cdFx0bWFya2VyLl9sYXRsbmcgPSBsYXRsbmc7XG5cblx0XHRtYXJrZXJcblx0XHQgICAgLmZpcmUoJ21vdmUnLCB7bGF0bG5nOiBsYXRsbmd9KVxuXHRcdCAgICAuZmlyZSgnZHJhZycpO1xuXHR9LFxuXG5cdF9vbkRyYWdFbmQ6IGZ1bmN0aW9uIChlKSB7XG5cdFx0dGhpcy5fbWFya2VyXG5cdFx0ICAgIC5maXJlKCdtb3ZlZW5kJylcblx0XHQgICAgLmZpcmUoJ2RyYWdlbmQnLCBlKTtcblx0fVxufSk7XG5cblxuLypcclxuICogTC5Db250cm9sIGlzIGEgYmFzZSBjbGFzcyBmb3IgaW1wbGVtZW50aW5nIG1hcCBjb250cm9scy4gSGFuZGxlcyBwb3NpdGlvbmluZy5cclxuICogQWxsIG90aGVyIGNvbnRyb2xzIGV4dGVuZCBmcm9tIHRoaXMgY2xhc3MuXHJcbiAqL1xyXG5cclxuTC5Db250cm9sID0gTC5DbGFzcy5leHRlbmQoe1xyXG5cdG9wdGlvbnM6IHtcclxuXHRcdHBvc2l0aW9uOiAndG9wcmlnaHQnXHJcblx0fSxcclxuXHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuXHRcdEwuc2V0T3B0aW9ucyh0aGlzLCBvcHRpb25zKTtcclxuXHR9LFxyXG5cclxuXHRnZXRQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMub3B0aW9ucy5wb3NpdGlvbjtcclxuXHR9LFxyXG5cclxuXHRzZXRQb3NpdGlvbjogZnVuY3Rpb24gKHBvc2l0aW9uKSB7XHJcblx0XHR2YXIgbWFwID0gdGhpcy5fbWFwO1xyXG5cclxuXHRcdGlmIChtYXApIHtcclxuXHRcdFx0bWFwLnJlbW92ZUNvbnRyb2wodGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5vcHRpb25zLnBvc2l0aW9uID0gcG9zaXRpb247XHJcblxyXG5cdFx0aWYgKG1hcCkge1xyXG5cdFx0XHRtYXAuYWRkQ29udHJvbCh0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRnZXRDb250YWluZXI6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9jb250YWluZXI7XHJcblx0fSxcclxuXHJcblx0YWRkVG86IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdHRoaXMuX21hcCA9IG1hcDtcclxuXHJcblx0XHR2YXIgY29udGFpbmVyID0gdGhpcy5fY29udGFpbmVyID0gdGhpcy5vbkFkZChtYXApLFxyXG5cdFx0ICAgIHBvcyA9IHRoaXMuZ2V0UG9zaXRpb24oKSxcclxuXHRcdCAgICBjb3JuZXIgPSBtYXAuX2NvbnRyb2xDb3JuZXJzW3Bvc107XHJcblxyXG5cdFx0TC5Eb21VdGlsLmFkZENsYXNzKGNvbnRhaW5lciwgJ2xlYWZsZXQtY29udHJvbCcpO1xyXG5cclxuXHRcdGlmIChwb3MuaW5kZXhPZignYm90dG9tJykgIT09IC0xKSB7XHJcblx0XHRcdGNvcm5lci5pbnNlcnRCZWZvcmUoY29udGFpbmVyLCBjb3JuZXIuZmlyc3RDaGlsZCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRjb3JuZXIuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyZW1vdmVGcm9tOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHR2YXIgcG9zID0gdGhpcy5nZXRQb3NpdGlvbigpLFxyXG5cdFx0ICAgIGNvcm5lciA9IG1hcC5fY29udHJvbENvcm5lcnNbcG9zXTtcclxuXHJcblx0XHRjb3JuZXIucmVtb3ZlQ2hpbGQodGhpcy5fY29udGFpbmVyKTtcclxuXHRcdHRoaXMuX21hcCA9IG51bGw7XHJcblxyXG5cdFx0aWYgKHRoaXMub25SZW1vdmUpIHtcclxuXHRcdFx0dGhpcy5vblJlbW92ZShtYXApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdF9yZWZvY3VzT25NYXA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmICh0aGlzLl9tYXApIHtcclxuXHRcdFx0dGhpcy5fbWFwLmdldENvbnRhaW5lcigpLmZvY3VzKCk7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbkwuY29udHJvbCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcblx0cmV0dXJuIG5ldyBMLkNvbnRyb2wob3B0aW9ucyk7XHJcbn07XHJcblxyXG5cclxuLy8gYWRkcyBjb250cm9sLXJlbGF0ZWQgbWV0aG9kcyB0byBMLk1hcFxyXG5cclxuTC5NYXAuaW5jbHVkZSh7XHJcblx0YWRkQ29udHJvbDogZnVuY3Rpb24gKGNvbnRyb2wpIHtcclxuXHRcdGNvbnRyb2wuYWRkVG8odGhpcyk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyZW1vdmVDb250cm9sOiBmdW5jdGlvbiAoY29udHJvbCkge1xyXG5cdFx0Y29udHJvbC5yZW1vdmVGcm9tKHRoaXMpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X2luaXRDb250cm9sUG9zOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgY29ybmVycyA9IHRoaXMuX2NvbnRyb2xDb3JuZXJzID0ge30sXHJcblx0XHQgICAgbCA9ICdsZWFmbGV0LScsXHJcblx0XHQgICAgY29udGFpbmVyID0gdGhpcy5fY29udHJvbENvbnRhaW5lciA9XHJcblx0XHQgICAgICAgICAgICBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBsICsgJ2NvbnRyb2wtY29udGFpbmVyJywgdGhpcy5fY29udGFpbmVyKTtcclxuXHJcblx0XHRmdW5jdGlvbiBjcmVhdGVDb3JuZXIodlNpZGUsIGhTaWRlKSB7XHJcblx0XHRcdHZhciBjbGFzc05hbWUgPSBsICsgdlNpZGUgKyAnICcgKyBsICsgaFNpZGU7XHJcblxyXG5cdFx0XHRjb3JuZXJzW3ZTaWRlICsgaFNpZGVdID0gTC5Eb21VdGlsLmNyZWF0ZSgnZGl2JywgY2xhc3NOYW1lLCBjb250YWluZXIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNyZWF0ZUNvcm5lcigndG9wJywgJ2xlZnQnKTtcclxuXHRcdGNyZWF0ZUNvcm5lcigndG9wJywgJ3JpZ2h0Jyk7XHJcblx0XHRjcmVhdGVDb3JuZXIoJ2JvdHRvbScsICdsZWZ0Jyk7XHJcblx0XHRjcmVhdGVDb3JuZXIoJ2JvdHRvbScsICdyaWdodCcpO1xyXG5cdH0sXHJcblxyXG5cdF9jbGVhckNvbnRyb2xQb3M6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHRoaXMuX2NvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLl9jb250cm9sQ29udGFpbmVyKTtcclxuXHR9XHJcbn0pO1xyXG5cblxuLypcclxuICogTC5Db250cm9sLlpvb20gaXMgdXNlZCBmb3IgdGhlIGRlZmF1bHQgem9vbSBidXR0b25zIG9uIHRoZSBtYXAuXHJcbiAqL1xyXG5cclxuTC5Db250cm9sLlpvb20gPSBMLkNvbnRyb2wuZXh0ZW5kKHtcclxuXHRvcHRpb25zOiB7XHJcblx0XHRwb3NpdGlvbjogJ3RvcGxlZnQnLFxyXG5cdFx0em9vbUluVGV4dDogJysnLFxyXG5cdFx0em9vbUluVGl0bGU6ICdab29tIGluJyxcclxuXHRcdHpvb21PdXRUZXh0OiAnLScsXHJcblx0XHR6b29tT3V0VGl0bGU6ICdab29tIG91dCdcclxuXHR9LFxyXG5cclxuXHRvbkFkZDogZnVuY3Rpb24gKG1hcCkge1xyXG5cdFx0dmFyIHpvb21OYW1lID0gJ2xlYWZsZXQtY29udHJvbC16b29tJyxcclxuXHRcdCAgICBjb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCB6b29tTmFtZSArICcgbGVhZmxldC1iYXInKTtcclxuXHJcblx0XHR0aGlzLl9tYXAgPSBtYXA7XHJcblxyXG5cdFx0dGhpcy5fem9vbUluQnV0dG9uICA9IHRoaXMuX2NyZWF0ZUJ1dHRvbihcclxuXHRcdCAgICAgICAgdGhpcy5vcHRpb25zLnpvb21JblRleHQsIHRoaXMub3B0aW9ucy56b29tSW5UaXRsZSxcclxuXHRcdCAgICAgICAgem9vbU5hbWUgKyAnLWluJywgIGNvbnRhaW5lciwgdGhpcy5fem9vbUluLCAgdGhpcyk7XHJcblx0XHR0aGlzLl96b29tT3V0QnV0dG9uID0gdGhpcy5fY3JlYXRlQnV0dG9uKFxyXG5cdFx0ICAgICAgICB0aGlzLm9wdGlvbnMuem9vbU91dFRleHQsIHRoaXMub3B0aW9ucy56b29tT3V0VGl0bGUsXHJcblx0XHQgICAgICAgIHpvb21OYW1lICsgJy1vdXQnLCBjb250YWluZXIsIHRoaXMuX3pvb21PdXQsIHRoaXMpO1xyXG5cclxuXHRcdHRoaXMuX3VwZGF0ZURpc2FibGVkKCk7XHJcblx0XHRtYXAub24oJ3pvb21lbmQgem9vbWxldmVsc2NoYW5nZScsIHRoaXMuX3VwZGF0ZURpc2FibGVkLCB0aGlzKTtcclxuXHJcblx0XHRyZXR1cm4gY29udGFpbmVyO1xyXG5cdH0sXHJcblxyXG5cdG9uUmVtb3ZlOiBmdW5jdGlvbiAobWFwKSB7XHJcblx0XHRtYXAub2ZmKCd6b29tZW5kIHpvb21sZXZlbHNjaGFuZ2UnLCB0aGlzLl91cGRhdGVEaXNhYmxlZCwgdGhpcyk7XHJcblx0fSxcclxuXHJcblx0X3pvb21JbjogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHRoaXMuX21hcC56b29tSW4oZS5zaGlmdEtleSA/IDMgOiAxKTtcclxuXHR9LFxyXG5cclxuXHRfem9vbU91dDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHRoaXMuX21hcC56b29tT3V0KGUuc2hpZnRLZXkgPyAzIDogMSk7XHJcblx0fSxcclxuXHJcblx0X2NyZWF0ZUJ1dHRvbjogZnVuY3Rpb24gKGh0bWwsIHRpdGxlLCBjbGFzc05hbWUsIGNvbnRhaW5lciwgZm4sIGNvbnRleHQpIHtcclxuXHRcdHZhciBsaW5rID0gTC5Eb21VdGlsLmNyZWF0ZSgnYScsIGNsYXNzTmFtZSwgY29udGFpbmVyKTtcclxuXHRcdGxpbmsuaW5uZXJIVE1MID0gaHRtbDtcclxuXHRcdGxpbmsuaHJlZiA9ICcjJztcclxuXHRcdGxpbmsudGl0bGUgPSB0aXRsZTtcclxuXHJcblx0XHR2YXIgc3RvcCA9IEwuRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uO1xyXG5cclxuXHRcdEwuRG9tRXZlbnRcclxuXHRcdCAgICAub24obGluaywgJ2NsaWNrJywgc3RvcClcclxuXHRcdCAgICAub24obGluaywgJ21vdXNlZG93bicsIHN0b3ApXHJcblx0XHQgICAgLm9uKGxpbmssICdkYmxjbGljaycsIHN0b3ApXHJcblx0XHQgICAgLm9uKGxpbmssICdjbGljaycsIEwuRG9tRXZlbnQucHJldmVudERlZmF1bHQpXHJcblx0XHQgICAgLm9uKGxpbmssICdjbGljaycsIGZuLCBjb250ZXh0KVxyXG5cdFx0ICAgIC5vbihsaW5rLCAnY2xpY2snLCB0aGlzLl9yZWZvY3VzT25NYXAsIGNvbnRleHQpO1xyXG5cclxuXHRcdHJldHVybiBsaW5rO1xyXG5cdH0sXHJcblxyXG5cdF91cGRhdGVEaXNhYmxlZDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIG1hcCA9IHRoaXMuX21hcCxcclxuXHRcdFx0Y2xhc3NOYW1lID0gJ2xlYWZsZXQtZGlzYWJsZWQnO1xyXG5cclxuXHRcdEwuRG9tVXRpbC5yZW1vdmVDbGFzcyh0aGlzLl96b29tSW5CdXR0b24sIGNsYXNzTmFtZSk7XHJcblx0XHRMLkRvbVV0aWwucmVtb3ZlQ2xhc3ModGhpcy5fem9vbU91dEJ1dHRvbiwgY2xhc3NOYW1lKTtcclxuXHJcblx0XHRpZiAobWFwLl96b29tID09PSBtYXAuZ2V0TWluWm9vbSgpKSB7XHJcblx0XHRcdEwuRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl96b29tT3V0QnV0dG9uLCBjbGFzc05hbWUpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKG1hcC5fem9vbSA9PT0gbWFwLmdldE1heFpvb20oKSkge1xyXG5cdFx0XHRMLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5fem9vbUluQnV0dG9uLCBjbGFzc05hbWUpO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcblxyXG5MLk1hcC5tZXJnZU9wdGlvbnMoe1xyXG5cdHpvb21Db250cm9sOiB0cnVlXHJcbn0pO1xyXG5cclxuTC5NYXAuYWRkSW5pdEhvb2soZnVuY3Rpb24gKCkge1xyXG5cdGlmICh0aGlzLm9wdGlvbnMuem9vbUNvbnRyb2wpIHtcclxuXHRcdHRoaXMuem9vbUNvbnRyb2wgPSBuZXcgTC5Db250cm9sLlpvb20oKTtcclxuXHRcdHRoaXMuYWRkQ29udHJvbCh0aGlzLnpvb21Db250cm9sKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuTC5jb250cm9sLnpvb20gPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG5cdHJldHVybiBuZXcgTC5Db250cm9sLlpvb20ob3B0aW9ucyk7XHJcbn07XHJcblxyXG5cblxuLypcclxuICogTC5Db250cm9sLkF0dHJpYnV0aW9uIGlzIHVzZWQgZm9yIGRpc3BsYXlpbmcgYXR0cmlidXRpb24gb24gdGhlIG1hcCAoYWRkZWQgYnkgZGVmYXVsdCkuXHJcbiAqL1xyXG5cclxuTC5Db250cm9sLkF0dHJpYnV0aW9uID0gTC5Db250cm9sLmV4dGVuZCh7XHJcblx0b3B0aW9uczoge1xyXG5cdFx0cG9zaXRpb246ICdib3R0b21yaWdodCcsXHJcblx0XHRwcmVmaXg6ICc8YSBocmVmPVwiaHR0cDovL2xlYWZsZXRqcy5jb21cIiB0aXRsZT1cIkEgSlMgbGlicmFyeSBmb3IgaW50ZXJhY3RpdmUgbWFwc1wiPkxlYWZsZXQ8L2E+J1xyXG5cdH0sXHJcblxyXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcblx0XHRMLnNldE9wdGlvbnModGhpcywgb3B0aW9ucyk7XHJcblxyXG5cdFx0dGhpcy5fYXR0cmlidXRpb25zID0ge307XHJcblx0fSxcclxuXHJcblx0b25BZGQ6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdHRoaXMuX2NvbnRhaW5lciA9IEwuRG9tVXRpbC5jcmVhdGUoJ2RpdicsICdsZWFmbGV0LWNvbnRyb2wtYXR0cmlidXRpb24nKTtcclxuXHRcdEwuRG9tRXZlbnQuZGlzYWJsZUNsaWNrUHJvcGFnYXRpb24odGhpcy5fY29udGFpbmVyKTtcclxuXHJcblx0XHRmb3IgKHZhciBpIGluIG1hcC5fbGF5ZXJzKSB7XHJcblx0XHRcdGlmIChtYXAuX2xheWVyc1tpXS5nZXRBdHRyaWJ1dGlvbikge1xyXG5cdFx0XHRcdHRoaXMuYWRkQXR0cmlidXRpb24obWFwLl9sYXllcnNbaV0uZ2V0QXR0cmlidXRpb24oKSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0bWFwXHJcblx0XHQgICAgLm9uKCdsYXllcmFkZCcsIHRoaXMuX29uTGF5ZXJBZGQsIHRoaXMpXHJcblx0XHQgICAgLm9uKCdsYXllcnJlbW92ZScsIHRoaXMuX29uTGF5ZXJSZW1vdmUsIHRoaXMpO1xyXG5cclxuXHRcdHRoaXMuX3VwZGF0ZSgpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzLl9jb250YWluZXI7XHJcblx0fSxcclxuXHJcblx0b25SZW1vdmU6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcFxyXG5cdFx0ICAgIC5vZmYoJ2xheWVyYWRkJywgdGhpcy5fb25MYXllckFkZClcclxuXHRcdCAgICAub2ZmKCdsYXllcnJlbW92ZScsIHRoaXMuX29uTGF5ZXJSZW1vdmUpO1xyXG5cclxuXHR9LFxyXG5cclxuXHRzZXRQcmVmaXg6IGZ1bmN0aW9uIChwcmVmaXgpIHtcclxuXHRcdHRoaXMub3B0aW9ucy5wcmVmaXggPSBwcmVmaXg7XHJcblx0XHR0aGlzLl91cGRhdGUoKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGFkZEF0dHJpYnV0aW9uOiBmdW5jdGlvbiAodGV4dCkge1xyXG5cdFx0aWYgKCF0ZXh0KSB7IHJldHVybjsgfVxyXG5cclxuXHRcdGlmICghdGhpcy5fYXR0cmlidXRpb25zW3RleHRdKSB7XHJcblx0XHRcdHRoaXMuX2F0dHJpYnV0aW9uc1t0ZXh0XSA9IDA7XHJcblx0XHR9XHJcblx0XHR0aGlzLl9hdHRyaWJ1dGlvbnNbdGV4dF0rKztcclxuXHJcblx0XHR0aGlzLl91cGRhdGUoKTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyZW1vdmVBdHRyaWJ1dGlvbjogZnVuY3Rpb24gKHRleHQpIHtcclxuXHRcdGlmICghdGV4dCkgeyByZXR1cm47IH1cclxuXHJcblx0XHRpZiAodGhpcy5fYXR0cmlidXRpb25zW3RleHRdKSB7XHJcblx0XHRcdHRoaXMuX2F0dHJpYnV0aW9uc1t0ZXh0XS0tO1xyXG5cdFx0XHR0aGlzLl91cGRhdGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX21hcCkgeyByZXR1cm47IH1cclxuXHJcblx0XHR2YXIgYXR0cmlicyA9IFtdO1xyXG5cclxuXHRcdGZvciAodmFyIGkgaW4gdGhpcy5fYXR0cmlidXRpb25zKSB7XHJcblx0XHRcdGlmICh0aGlzLl9hdHRyaWJ1dGlvbnNbaV0pIHtcclxuXHRcdFx0XHRhdHRyaWJzLnB1c2goaSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR2YXIgcHJlZml4QW5kQXR0cmlicyA9IFtdO1xyXG5cclxuXHRcdGlmICh0aGlzLm9wdGlvbnMucHJlZml4KSB7XHJcblx0XHRcdHByZWZpeEFuZEF0dHJpYnMucHVzaCh0aGlzLm9wdGlvbnMucHJlZml4KTtcclxuXHRcdH1cclxuXHRcdGlmIChhdHRyaWJzLmxlbmd0aCkge1xyXG5cdFx0XHRwcmVmaXhBbmRBdHRyaWJzLnB1c2goYXR0cmlicy5qb2luKCcsICcpKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gcHJlZml4QW5kQXR0cmlicy5qb2luKCcgfCAnKTtcclxuXHR9LFxyXG5cclxuXHRfb25MYXllckFkZDogZnVuY3Rpb24gKGUpIHtcclxuXHRcdGlmIChlLmxheWVyLmdldEF0dHJpYnV0aW9uKSB7XHJcblx0XHRcdHRoaXMuYWRkQXR0cmlidXRpb24oZS5sYXllci5nZXRBdHRyaWJ1dGlvbigpKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfb25MYXllclJlbW92ZTogZnVuY3Rpb24gKGUpIHtcclxuXHRcdGlmIChlLmxheWVyLmdldEF0dHJpYnV0aW9uKSB7XHJcblx0XHRcdHRoaXMucmVtb3ZlQXR0cmlidXRpb24oZS5sYXllci5nZXRBdHRyaWJ1dGlvbigpKTtcclxuXHRcdH1cclxuXHR9XHJcbn0pO1xyXG5cclxuTC5NYXAubWVyZ2VPcHRpb25zKHtcclxuXHRhdHRyaWJ1dGlvbkNvbnRyb2w6IHRydWVcclxufSk7XHJcblxyXG5MLk1hcC5hZGRJbml0SG9vayhmdW5jdGlvbiAoKSB7XHJcblx0aWYgKHRoaXMub3B0aW9ucy5hdHRyaWJ1dGlvbkNvbnRyb2wpIHtcclxuXHRcdHRoaXMuYXR0cmlidXRpb25Db250cm9sID0gKG5ldyBMLkNvbnRyb2wuQXR0cmlidXRpb24oKSkuYWRkVG8odGhpcyk7XHJcblx0fVxyXG59KTtcclxuXHJcbkwuY29udHJvbC5hdHRyaWJ1dGlvbiA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcblx0cmV0dXJuIG5ldyBMLkNvbnRyb2wuQXR0cmlidXRpb24ob3B0aW9ucyk7XHJcbn07XHJcblxuXG4vKlxuICogTC5Db250cm9sLlNjYWxlIGlzIHVzZWQgZm9yIGRpc3BsYXlpbmcgbWV0cmljL2ltcGVyaWFsIHNjYWxlIG9uIHRoZSBtYXAuXG4gKi9cblxuTC5Db250cm9sLlNjYWxlID0gTC5Db250cm9sLmV4dGVuZCh7XG5cdG9wdGlvbnM6IHtcblx0XHRwb3NpdGlvbjogJ2JvdHRvbWxlZnQnLFxuXHRcdG1heFdpZHRoOiAxMDAsXG5cdFx0bWV0cmljOiB0cnVlLFxuXHRcdGltcGVyaWFsOiB0cnVlLFxuXHRcdHVwZGF0ZVdoZW5JZGxlOiBmYWxzZVxuXHR9LFxuXG5cdG9uQWRkOiBmdW5jdGlvbiAobWFwKSB7XG5cdFx0dGhpcy5fbWFwID0gbWFwO1xuXG5cdFx0dmFyIGNsYXNzTmFtZSA9ICdsZWFmbGV0LWNvbnRyb2wtc2NhbGUnLFxuXHRcdCAgICBjb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBjbGFzc05hbWUpLFxuXHRcdCAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG5cdFx0dGhpcy5fYWRkU2NhbGVzKG9wdGlvbnMsIGNsYXNzTmFtZSwgY29udGFpbmVyKTtcblxuXHRcdG1hcC5vbihvcHRpb25zLnVwZGF0ZVdoZW5JZGxlID8gJ21vdmVlbmQnIDogJ21vdmUnLCB0aGlzLl91cGRhdGUsIHRoaXMpO1xuXHRcdG1hcC53aGVuUmVhZHkodGhpcy5fdXBkYXRlLCB0aGlzKTtcblxuXHRcdHJldHVybiBjb250YWluZXI7XG5cdH0sXG5cblx0b25SZW1vdmU6IGZ1bmN0aW9uIChtYXApIHtcblx0XHRtYXAub2ZmKHRoaXMub3B0aW9ucy51cGRhdGVXaGVuSWRsZSA/ICdtb3ZlZW5kJyA6ICdtb3ZlJywgdGhpcy5fdXBkYXRlLCB0aGlzKTtcblx0fSxcblxuXHRfYWRkU2NhbGVzOiBmdW5jdGlvbiAob3B0aW9ucywgY2xhc3NOYW1lLCBjb250YWluZXIpIHtcblx0XHRpZiAob3B0aW9ucy5tZXRyaWMpIHtcblx0XHRcdHRoaXMuX21TY2FsZSA9IEwuRG9tVXRpbC5jcmVhdGUoJ2RpdicsIGNsYXNzTmFtZSArICctbGluZScsIGNvbnRhaW5lcik7XG5cdFx0fVxuXHRcdGlmIChvcHRpb25zLmltcGVyaWFsKSB7XG5cdFx0XHR0aGlzLl9pU2NhbGUgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBjbGFzc05hbWUgKyAnLWxpbmUnLCBjb250YWluZXIpO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIGJvdW5kcyA9IHRoaXMuX21hcC5nZXRCb3VuZHMoKSxcblx0XHQgICAgY2VudGVyTGF0ID0gYm91bmRzLmdldENlbnRlcigpLmxhdCxcblx0XHQgICAgaGFsZldvcmxkTWV0ZXJzID0gNjM3ODEzNyAqIE1hdGguUEkgKiBNYXRoLmNvcyhjZW50ZXJMYXQgKiBNYXRoLlBJIC8gMTgwKSxcblx0XHQgICAgZGlzdCA9IGhhbGZXb3JsZE1ldGVycyAqIChib3VuZHMuZ2V0Tm9ydGhFYXN0KCkubG5nIC0gYm91bmRzLmdldFNvdXRoV2VzdCgpLmxuZykgLyAxODAsXG5cblx0XHQgICAgc2l6ZSA9IHRoaXMuX21hcC5nZXRTaXplKCksXG5cdFx0ICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG5cdFx0ICAgIG1heE1ldGVycyA9IDA7XG5cblx0XHRpZiAoc2l6ZS54ID4gMCkge1xuXHRcdFx0bWF4TWV0ZXJzID0gZGlzdCAqIChvcHRpb25zLm1heFdpZHRoIC8gc2l6ZS54KTtcblx0XHR9XG5cblx0XHR0aGlzLl91cGRhdGVTY2FsZXMob3B0aW9ucywgbWF4TWV0ZXJzKTtcblx0fSxcblxuXHRfdXBkYXRlU2NhbGVzOiBmdW5jdGlvbiAob3B0aW9ucywgbWF4TWV0ZXJzKSB7XG5cdFx0aWYgKG9wdGlvbnMubWV0cmljICYmIG1heE1ldGVycykge1xuXHRcdFx0dGhpcy5fdXBkYXRlTWV0cmljKG1heE1ldGVycyk7XG5cdFx0fVxuXG5cdFx0aWYgKG9wdGlvbnMuaW1wZXJpYWwgJiYgbWF4TWV0ZXJzKSB7XG5cdFx0XHR0aGlzLl91cGRhdGVJbXBlcmlhbChtYXhNZXRlcnMpO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlTWV0cmljOiBmdW5jdGlvbiAobWF4TWV0ZXJzKSB7XG5cdFx0dmFyIG1ldGVycyA9IHRoaXMuX2dldFJvdW5kTnVtKG1heE1ldGVycyk7XG5cblx0XHR0aGlzLl9tU2NhbGUuc3R5bGUud2lkdGggPSB0aGlzLl9nZXRTY2FsZVdpZHRoKG1ldGVycyAvIG1heE1ldGVycykgKyAncHgnO1xuXHRcdHRoaXMuX21TY2FsZS5pbm5lckhUTUwgPSBtZXRlcnMgPCAxMDAwID8gbWV0ZXJzICsgJyBtJyA6IChtZXRlcnMgLyAxMDAwKSArICcga20nO1xuXHR9LFxuXG5cdF91cGRhdGVJbXBlcmlhbDogZnVuY3Rpb24gKG1heE1ldGVycykge1xuXHRcdHZhciBtYXhGZWV0ID0gbWF4TWV0ZXJzICogMy4yODA4Mzk5LFxuXHRcdCAgICBzY2FsZSA9IHRoaXMuX2lTY2FsZSxcblx0XHQgICAgbWF4TWlsZXMsIG1pbGVzLCBmZWV0O1xuXG5cdFx0aWYgKG1heEZlZXQgPiA1MjgwKSB7XG5cdFx0XHRtYXhNaWxlcyA9IG1heEZlZXQgLyA1MjgwO1xuXHRcdFx0bWlsZXMgPSB0aGlzLl9nZXRSb3VuZE51bShtYXhNaWxlcyk7XG5cblx0XHRcdHNjYWxlLnN0eWxlLndpZHRoID0gdGhpcy5fZ2V0U2NhbGVXaWR0aChtaWxlcyAvIG1heE1pbGVzKSArICdweCc7XG5cdFx0XHRzY2FsZS5pbm5lckhUTUwgPSBtaWxlcyArICcgbWknO1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdGZlZXQgPSB0aGlzLl9nZXRSb3VuZE51bShtYXhGZWV0KTtcblxuXHRcdFx0c2NhbGUuc3R5bGUud2lkdGggPSB0aGlzLl9nZXRTY2FsZVdpZHRoKGZlZXQgLyBtYXhGZWV0KSArICdweCc7XG5cdFx0XHRzY2FsZS5pbm5lckhUTUwgPSBmZWV0ICsgJyBmdCc7XG5cdFx0fVxuXHR9LFxuXG5cdF9nZXRTY2FsZVdpZHRoOiBmdW5jdGlvbiAocmF0aW8pIHtcblx0XHRyZXR1cm4gTWF0aC5yb3VuZCh0aGlzLm9wdGlvbnMubWF4V2lkdGggKiByYXRpbykgLSAxMDtcblx0fSxcblxuXHRfZ2V0Um91bmROdW06IGZ1bmN0aW9uIChudW0pIHtcblx0XHR2YXIgcG93MTAgPSBNYXRoLnBvdygxMCwgKE1hdGguZmxvb3IobnVtKSArICcnKS5sZW5ndGggLSAxKSxcblx0XHQgICAgZCA9IG51bSAvIHBvdzEwO1xuXG5cdFx0ZCA9IGQgPj0gMTAgPyAxMCA6IGQgPj0gNSA/IDUgOiBkID49IDMgPyAzIDogZCA+PSAyID8gMiA6IDE7XG5cblx0XHRyZXR1cm4gcG93MTAgKiBkO1xuXHR9XG59KTtcblxuTC5jb250cm9sLnNjYWxlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblx0cmV0dXJuIG5ldyBMLkNvbnRyb2wuU2NhbGUob3B0aW9ucyk7XG59O1xuXG5cbi8qXHJcbiAqIEwuQ29udHJvbC5MYXllcnMgaXMgYSBjb250cm9sIHRvIGFsbG93IHVzZXJzIHRvIHN3aXRjaCBiZXR3ZWVuIGRpZmZlcmVudCBsYXllcnMgb24gdGhlIG1hcC5cclxuICovXHJcblxyXG5MLkNvbnRyb2wuTGF5ZXJzID0gTC5Db250cm9sLmV4dGVuZCh7XHJcblx0b3B0aW9uczoge1xyXG5cdFx0Y29sbGFwc2VkOiB0cnVlLFxyXG5cdFx0cG9zaXRpb246ICd0b3ByaWdodCcsXHJcblx0XHRhdXRvWkluZGV4OiB0cnVlXHJcblx0fSxcclxuXHJcblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKGJhc2VMYXllcnMsIG92ZXJsYXlzLCBvcHRpb25zKSB7XHJcblx0XHRMLnNldE9wdGlvbnModGhpcywgb3B0aW9ucyk7XHJcblxyXG5cdFx0dGhpcy5fbGF5ZXJzID0ge307XHJcblx0XHR0aGlzLl9sYXN0WkluZGV4ID0gMDtcclxuXHRcdHRoaXMuX2hhbmRsaW5nQ2xpY2sgPSBmYWxzZTtcclxuXHJcblx0XHRmb3IgKHZhciBpIGluIGJhc2VMYXllcnMpIHtcclxuXHRcdFx0dGhpcy5fYWRkTGF5ZXIoYmFzZUxheWVyc1tpXSwgaSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9yIChpIGluIG92ZXJsYXlzKSB7XHJcblx0XHRcdHRoaXMuX2FkZExheWVyKG92ZXJsYXlzW2ldLCBpLCB0cnVlKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRvbkFkZDogZnVuY3Rpb24gKG1hcCkge1xyXG5cdFx0dGhpcy5faW5pdExheW91dCgpO1xyXG5cdFx0dGhpcy5fdXBkYXRlKCk7XHJcblxyXG5cdFx0bWFwXHJcblx0XHQgICAgLm9uKCdsYXllcmFkZCcsIHRoaXMuX29uTGF5ZXJDaGFuZ2UsIHRoaXMpXHJcblx0XHQgICAgLm9uKCdsYXllcnJlbW92ZScsIHRoaXMuX29uTGF5ZXJDaGFuZ2UsIHRoaXMpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzLl9jb250YWluZXI7XHJcblx0fSxcclxuXHJcblx0b25SZW1vdmU6IGZ1bmN0aW9uIChtYXApIHtcclxuXHRcdG1hcFxyXG5cdFx0ICAgIC5vZmYoJ2xheWVyYWRkJywgdGhpcy5fb25MYXllckNoYW5nZSwgdGhpcylcclxuXHRcdCAgICAub2ZmKCdsYXllcnJlbW92ZScsIHRoaXMuX29uTGF5ZXJDaGFuZ2UsIHRoaXMpO1xyXG5cdH0sXHJcblxyXG5cdGFkZEJhc2VMYXllcjogZnVuY3Rpb24gKGxheWVyLCBuYW1lKSB7XHJcblx0XHR0aGlzLl9hZGRMYXllcihsYXllciwgbmFtZSk7XHJcblx0XHR0aGlzLl91cGRhdGUoKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGFkZE92ZXJsYXk6IGZ1bmN0aW9uIChsYXllciwgbmFtZSkge1xyXG5cdFx0dGhpcy5fYWRkTGF5ZXIobGF5ZXIsIG5hbWUsIHRydWUpO1xyXG5cdFx0dGhpcy5fdXBkYXRlKCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyZW1vdmVMYXllcjogZnVuY3Rpb24gKGxheWVyKSB7XHJcblx0XHR2YXIgaWQgPSBMLnN0YW1wKGxheWVyKTtcclxuXHRcdGRlbGV0ZSB0aGlzLl9sYXllcnNbaWRdO1xyXG5cdFx0dGhpcy5fdXBkYXRlKCk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRfaW5pdExheW91dDogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIGNsYXNzTmFtZSA9ICdsZWFmbGV0LWNvbnRyb2wtbGF5ZXJzJyxcclxuXHRcdCAgICBjb250YWluZXIgPSB0aGlzLl9jb250YWluZXIgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBjbGFzc05hbWUpO1xyXG5cclxuXHRcdC8vTWFrZXMgdGhpcyB3b3JrIG9uIElFMTAgVG91Y2ggZGV2aWNlcyBieSBzdG9wcGluZyBpdCBmcm9tIGZpcmluZyBhIG1vdXNlb3V0IGV2ZW50IHdoZW4gdGhlIHRvdWNoIGlzIHJlbGVhc2VkXHJcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWhhc3BvcHVwJywgdHJ1ZSk7XHJcblxyXG5cdFx0aWYgKCFMLkJyb3dzZXIudG91Y2gpIHtcclxuXHRcdFx0TC5Eb21FdmVudFxyXG5cdFx0XHRcdC5kaXNhYmxlQ2xpY2tQcm9wYWdhdGlvbihjb250YWluZXIpXHJcblx0XHRcdFx0LmRpc2FibGVTY3JvbGxQcm9wYWdhdGlvbihjb250YWluZXIpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0TC5Eb21FdmVudC5vbihjb250YWluZXIsICdjbGljaycsIEwuRG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKTtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgZm9ybSA9IHRoaXMuX2Zvcm0gPSBMLkRvbVV0aWwuY3JlYXRlKCdmb3JtJywgY2xhc3NOYW1lICsgJy1saXN0Jyk7XHJcblxyXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5jb2xsYXBzZWQpIHtcclxuXHRcdFx0aWYgKCFMLkJyb3dzZXIuYW5kcm9pZCkge1xyXG5cdFx0XHRcdEwuRG9tRXZlbnRcclxuXHRcdFx0XHQgICAgLm9uKGNvbnRhaW5lciwgJ21vdXNlb3ZlcicsIHRoaXMuX2V4cGFuZCwgdGhpcylcclxuXHRcdFx0XHQgICAgLm9uKGNvbnRhaW5lciwgJ21vdXNlb3V0JywgdGhpcy5fY29sbGFwc2UsIHRoaXMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBsaW5rID0gdGhpcy5fbGF5ZXJzTGluayA9IEwuRG9tVXRpbC5jcmVhdGUoJ2EnLCBjbGFzc05hbWUgKyAnLXRvZ2dsZScsIGNvbnRhaW5lcik7XHJcblx0XHRcdGxpbmsuaHJlZiA9ICcjJztcclxuXHRcdFx0bGluay50aXRsZSA9ICdMYXllcnMnO1xyXG5cclxuXHRcdFx0aWYgKEwuQnJvd3Nlci50b3VjaCkge1xyXG5cdFx0XHRcdEwuRG9tRXZlbnRcclxuXHRcdFx0XHQgICAgLm9uKGxpbmssICdjbGljaycsIEwuRG9tRXZlbnQuc3RvcClcclxuXHRcdFx0XHQgICAgLm9uKGxpbmssICdjbGljaycsIHRoaXMuX2V4cGFuZCwgdGhpcyk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0TC5Eb21FdmVudC5vbihsaW5rLCAnZm9jdXMnLCB0aGlzLl9leHBhbmQsIHRoaXMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vV29yayBhcm91bmQgZm9yIEZpcmVmb3ggYW5kcm9pZCBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vTGVhZmxldC9MZWFmbGV0L2lzc3Vlcy8yMDMzXHJcblx0XHRcdEwuRG9tRXZlbnQub24oZm9ybSwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdHNldFRpbWVvdXQoTC5iaW5kKHRoaXMuX29uSW5wdXRDbGljaywgdGhpcyksIDApO1xyXG5cdFx0XHR9LCB0aGlzKTtcclxuXHJcblx0XHRcdHRoaXMuX21hcC5vbignY2xpY2snLCB0aGlzLl9jb2xsYXBzZSwgdGhpcyk7XHJcblx0XHRcdC8vIFRPRE8ga2V5Ym9hcmQgYWNjZXNzaWJpbGl0eVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5fZXhwYW5kKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fYmFzZUxheWVyc0xpc3QgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBjbGFzc05hbWUgKyAnLWJhc2UnLCBmb3JtKTtcclxuXHRcdHRoaXMuX3NlcGFyYXRvciA9IEwuRG9tVXRpbC5jcmVhdGUoJ2RpdicsIGNsYXNzTmFtZSArICctc2VwYXJhdG9yJywgZm9ybSk7XHJcblx0XHR0aGlzLl9vdmVybGF5c0xpc3QgPSBMLkRvbVV0aWwuY3JlYXRlKCdkaXYnLCBjbGFzc05hbWUgKyAnLW92ZXJsYXlzJywgZm9ybSk7XHJcblxyXG5cdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKGZvcm0pO1xyXG5cdH0sXHJcblxyXG5cdF9hZGRMYXllcjogZnVuY3Rpb24gKGxheWVyLCBuYW1lLCBvdmVybGF5KSB7XHJcblx0XHR2YXIgaWQgPSBMLnN0YW1wKGxheWVyKTtcclxuXHJcblx0XHR0aGlzLl9sYXllcnNbaWRdID0ge1xyXG5cdFx0XHRsYXllcjogbGF5ZXIsXHJcblx0XHRcdG5hbWU6IG5hbWUsXHJcblx0XHRcdG92ZXJsYXk6IG92ZXJsYXlcclxuXHRcdH07XHJcblxyXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5hdXRvWkluZGV4ICYmIGxheWVyLnNldFpJbmRleCkge1xyXG5cdFx0XHR0aGlzLl9sYXN0WkluZGV4Kys7XHJcblx0XHRcdGxheWVyLnNldFpJbmRleCh0aGlzLl9sYXN0WkluZGV4KTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZiAoIXRoaXMuX2NvbnRhaW5lcikge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fYmFzZUxheWVyc0xpc3QuaW5uZXJIVE1MID0gJyc7XHJcblx0XHR0aGlzLl9vdmVybGF5c0xpc3QuaW5uZXJIVE1MID0gJyc7XHJcblxyXG5cdFx0dmFyIGJhc2VMYXllcnNQcmVzZW50ID0gZmFsc2UsXHJcblx0XHQgICAgb3ZlcmxheXNQcmVzZW50ID0gZmFsc2UsXHJcblx0XHQgICAgaSwgb2JqO1xyXG5cclxuXHRcdGZvciAoaSBpbiB0aGlzLl9sYXllcnMpIHtcclxuXHRcdFx0b2JqID0gdGhpcy5fbGF5ZXJzW2ldO1xyXG5cdFx0XHR0aGlzLl9hZGRJdGVtKG9iaik7XHJcblx0XHRcdG92ZXJsYXlzUHJlc2VudCA9IG92ZXJsYXlzUHJlc2VudCB8fCBvYmoub3ZlcmxheTtcclxuXHRcdFx0YmFzZUxheWVyc1ByZXNlbnQgPSBiYXNlTGF5ZXJzUHJlc2VudCB8fCAhb2JqLm92ZXJsYXk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fc2VwYXJhdG9yLnN0eWxlLmRpc3BsYXkgPSBvdmVybGF5c1ByZXNlbnQgJiYgYmFzZUxheWVyc1ByZXNlbnQgPyAnJyA6ICdub25lJztcclxuXHR9LFxyXG5cclxuXHRfb25MYXllckNoYW5nZTogZnVuY3Rpb24gKGUpIHtcclxuXHRcdHZhciBvYmogPSB0aGlzLl9sYXllcnNbTC5zdGFtcChlLmxheWVyKV07XHJcblxyXG5cdFx0aWYgKCFvYmopIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0aWYgKCF0aGlzLl9oYW5kbGluZ0NsaWNrKSB7XHJcblx0XHRcdHRoaXMuX3VwZGF0ZSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciB0eXBlID0gb2JqLm92ZXJsYXkgP1xyXG5cdFx0XHQoZS50eXBlID09PSAnbGF5ZXJhZGQnID8gJ292ZXJsYXlhZGQnIDogJ292ZXJsYXlyZW1vdmUnKSA6XHJcblx0XHRcdChlLnR5cGUgPT09ICdsYXllcmFkZCcgPyAnYmFzZWxheWVyY2hhbmdlJyA6IG51bGwpO1xyXG5cclxuXHRcdGlmICh0eXBlKSB7XHJcblx0XHRcdHRoaXMuX21hcC5maXJlKHR5cGUsIG9iaik7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0Ly8gSUU3IGJ1Z3Mgb3V0IGlmIHlvdSBjcmVhdGUgYSByYWRpbyBkeW5hbWljYWxseSwgc28geW91IGhhdmUgdG8gZG8gaXQgdGhpcyBoYWNreSB3YXkgKHNlZSBodHRwOi8vYml0Lmx5L1BxWUxCZSlcclxuXHRfY3JlYXRlUmFkaW9FbGVtZW50OiBmdW5jdGlvbiAobmFtZSwgY2hlY2tlZCkge1xyXG5cclxuXHRcdHZhciByYWRpb0h0bWwgPSAnPGlucHV0IHR5cGU9XCJyYWRpb1wiIGNsYXNzPVwibGVhZmxldC1jb250cm9sLWxheWVycy1zZWxlY3RvclwiIG5hbWU9XCInICsgbmFtZSArICdcIic7XHJcblx0XHRpZiAoY2hlY2tlZCkge1xyXG5cdFx0XHRyYWRpb0h0bWwgKz0gJyBjaGVja2VkPVwiY2hlY2tlZFwiJztcclxuXHRcdH1cclxuXHRcdHJhZGlvSHRtbCArPSAnLz4nO1xyXG5cclxuXHRcdHZhciByYWRpb0ZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRyYWRpb0ZyYWdtZW50LmlubmVySFRNTCA9IHJhZGlvSHRtbDtcclxuXHJcblx0XHRyZXR1cm4gcmFkaW9GcmFnbWVudC5maXJzdENoaWxkO1xyXG5cdH0sXHJcblxyXG5cdF9hZGRJdGVtOiBmdW5jdGlvbiAob2JqKSB7XHJcblx0XHR2YXIgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpLFxyXG5cdFx0ICAgIGlucHV0LFxyXG5cdFx0ICAgIGNoZWNrZWQgPSB0aGlzLl9tYXAuaGFzTGF5ZXIob2JqLmxheWVyKTtcclxuXHJcblx0XHRpZiAob2JqLm92ZXJsYXkpIHtcclxuXHRcdFx0aW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG5cdFx0XHRpbnB1dC50eXBlID0gJ2NoZWNrYm94JztcclxuXHRcdFx0aW5wdXQuY2xhc3NOYW1lID0gJ2xlYWZsZXQtY29udHJvbC1sYXllcnMtc2VsZWN0b3InO1xyXG5cdFx0XHRpbnB1dC5kZWZhdWx0Q2hlY2tlZCA9IGNoZWNrZWQ7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpbnB1dCA9IHRoaXMuX2NyZWF0ZVJhZGlvRWxlbWVudCgnbGVhZmxldC1iYXNlLWxheWVycycsIGNoZWNrZWQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlucHV0LmxheWVySWQgPSBMLnN0YW1wKG9iai5sYXllcik7XHJcblxyXG5cdFx0TC5Eb21FdmVudC5vbihpbnB1dCwgJ2NsaWNrJywgdGhpcy5fb25JbnB1dENsaWNrLCB0aGlzKTtcclxuXHJcblx0XHR2YXIgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuXHRcdG5hbWUuaW5uZXJIVE1MID0gJyAnICsgb2JqLm5hbWU7XHJcblxyXG5cdFx0bGFiZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xyXG5cdFx0bGFiZWwuYXBwZW5kQ2hpbGQobmFtZSk7XHJcblxyXG5cdFx0dmFyIGNvbnRhaW5lciA9IG9iai5vdmVybGF5ID8gdGhpcy5fb3ZlcmxheXNMaXN0IDogdGhpcy5fYmFzZUxheWVyc0xpc3Q7XHJcblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQobGFiZWwpO1xyXG5cclxuXHRcdHJldHVybiBsYWJlbDtcclxuXHR9LFxyXG5cclxuXHRfb25JbnB1dENsaWNrOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgaSwgaW5wdXQsIG9iaixcclxuXHRcdCAgICBpbnB1dHMgPSB0aGlzLl9mb3JtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpLFxyXG5cdFx0ICAgIGlucHV0c0xlbiA9IGlucHV0cy5sZW5ndGg7XHJcblxyXG5cdFx0dGhpcy5faGFuZGxpbmdDbGljayA9IHRydWU7XHJcblxyXG5cdFx0Zm9yIChpID0gMDsgaSA8IGlucHV0c0xlbjsgaSsrKSB7XHJcblx0XHRcdGlucHV0ID0gaW5wdXRzW2ldO1xyXG5cdFx0XHRvYmogPSB0aGlzLl9sYXllcnNbaW5wdXQubGF5ZXJJZF07XHJcblxyXG5cdFx0XHRpZiAoaW5wdXQuY2hlY2tlZCAmJiAhdGhpcy5fbWFwLmhhc0xheWVyKG9iai5sYXllcikpIHtcclxuXHRcdFx0XHR0aGlzLl9tYXAuYWRkTGF5ZXIob2JqLmxheWVyKTtcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoIWlucHV0LmNoZWNrZWQgJiYgdGhpcy5fbWFwLmhhc0xheWVyKG9iai5sYXllcikpIHtcclxuXHRcdFx0XHR0aGlzLl9tYXAucmVtb3ZlTGF5ZXIob2JqLmxheWVyKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX2hhbmRsaW5nQ2xpY2sgPSBmYWxzZTtcclxuXHJcblx0XHR0aGlzLl9yZWZvY3VzT25NYXAoKTtcclxuXHR9LFxyXG5cclxuXHRfZXhwYW5kOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRMLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5fY29udGFpbmVyLCAnbGVhZmxldC1jb250cm9sLWxheWVycy1leHBhbmRlZCcpO1xyXG5cdH0sXHJcblxyXG5cdF9jb2xsYXBzZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0dGhpcy5fY29udGFpbmVyLmNsYXNzTmFtZSA9IHRoaXMuX2NvbnRhaW5lci5jbGFzc05hbWUucmVwbGFjZSgnIGxlYWZsZXQtY29udHJvbC1sYXllcnMtZXhwYW5kZWQnLCAnJyk7XHJcblx0fVxyXG59KTtcclxuXHJcbkwuY29udHJvbC5sYXllcnMgPSBmdW5jdGlvbiAoYmFzZUxheWVycywgb3ZlcmxheXMsIG9wdGlvbnMpIHtcclxuXHRyZXR1cm4gbmV3IEwuQ29udHJvbC5MYXllcnMoYmFzZUxheWVycywgb3ZlcmxheXMsIG9wdGlvbnMpO1xyXG59O1xyXG5cblxuLypcbiAqIEwuUG9zQW5pbWF0aW9uIGlzIHVzZWQgYnkgTGVhZmxldCBpbnRlcm5hbGx5IGZvciBwYW4gYW5pbWF0aW9ucy5cbiAqL1xuXG5MLlBvc0FuaW1hdGlvbiA9IEwuQ2xhc3MuZXh0ZW5kKHtcblx0aW5jbHVkZXM6IEwuTWl4aW4uRXZlbnRzLFxuXG5cdHJ1bjogZnVuY3Rpb24gKGVsLCBuZXdQb3MsIGR1cmF0aW9uLCBlYXNlTGluZWFyaXR5KSB7IC8vIChIVE1MRWxlbWVudCwgUG9pbnRbLCBOdW1iZXIsIE51bWJlcl0pXG5cdFx0dGhpcy5zdG9wKCk7XG5cblx0XHR0aGlzLl9lbCA9IGVsO1xuXHRcdHRoaXMuX2luUHJvZ3Jlc3MgPSB0cnVlO1xuXHRcdHRoaXMuX25ld1BvcyA9IG5ld1BvcztcblxuXHRcdHRoaXMuZmlyZSgnc3RhcnQnKTtcblxuXHRcdGVsLnN0eWxlW0wuRG9tVXRpbC5UUkFOU0lUSU9OXSA9ICdhbGwgJyArIChkdXJhdGlvbiB8fCAwLjI1KSArXG5cdFx0ICAgICAgICAncyBjdWJpYy1iZXppZXIoMCwwLCcgKyAoZWFzZUxpbmVhcml0eSB8fCAwLjUpICsgJywxKSc7XG5cblx0XHRMLkRvbUV2ZW50Lm9uKGVsLCBMLkRvbVV0aWwuVFJBTlNJVElPTl9FTkQsIHRoaXMuX29uVHJhbnNpdGlvbkVuZCwgdGhpcyk7XG5cdFx0TC5Eb21VdGlsLnNldFBvc2l0aW9uKGVsLCBuZXdQb3MpO1xuXG5cdFx0Ly8gdG9nZ2xlIHJlZmxvdywgQ2hyb21lIGZsaWNrZXJzIGZvciBzb21lIHJlYXNvbiBpZiB5b3UgZG9uJ3QgZG8gdGhpc1xuXHRcdEwuVXRpbC5mYWxzZUZuKGVsLm9mZnNldFdpZHRoKTtcblxuXHRcdC8vIHRoZXJlJ3Mgbm8gbmF0aXZlIHdheSB0byB0cmFjayB2YWx1ZSB1cGRhdGVzIG9mIHRyYW5zaXRpb25lZCBwcm9wZXJ0aWVzLCBzbyB3ZSBpbWl0YXRlIHRoaXNcblx0XHR0aGlzLl9zdGVwVGltZXIgPSBzZXRJbnRlcnZhbChMLmJpbmQodGhpcy5fb25TdGVwLCB0aGlzKSwgNTApO1xuXHR9LFxuXG5cdHN0b3A6IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoIXRoaXMuX2luUHJvZ3Jlc3MpIHsgcmV0dXJuOyB9XG5cblx0XHQvLyBpZiB3ZSBqdXN0IHJlbW92ZWQgdGhlIHRyYW5zaXRpb24gcHJvcGVydHksIHRoZSBlbGVtZW50IHdvdWxkIGp1bXAgdG8gaXRzIGZpbmFsIHBvc2l0aW9uLFxuXHRcdC8vIHNvIHdlIG5lZWQgdG8gbWFrZSBpdCBzdGF5IGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uXG5cblx0XHRMLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fZWwsIHRoaXMuX2dldFBvcygpKTtcblx0XHR0aGlzLl9vblRyYW5zaXRpb25FbmQoKTtcblx0XHRMLlV0aWwuZmFsc2VGbih0aGlzLl9lbC5vZmZzZXRXaWR0aCk7IC8vIGZvcmNlIHJlZmxvdyBpbiBjYXNlIHdlIGFyZSBhYm91dCB0byBzdGFydCBhIG5ldyBhbmltYXRpb25cblx0fSxcblxuXHRfb25TdGVwOiBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHN0ZXBQb3MgPSB0aGlzLl9nZXRQb3MoKTtcblx0XHRpZiAoIXN0ZXBQb3MpIHtcblx0XHRcdHRoaXMuX29uVHJhbnNpdGlvbkVuZCgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHQvLyBqc2hpbnQgY2FtZWxjYXNlOiBmYWxzZVxuXHRcdC8vIG1ha2UgTC5Eb21VdGlsLmdldFBvc2l0aW9uIHJldHVybiBpbnRlcm1lZGlhdGUgcG9zaXRpb24gdmFsdWUgZHVyaW5nIGFuaW1hdGlvblxuXHRcdHRoaXMuX2VsLl9sZWFmbGV0X3BvcyA9IHN0ZXBQb3M7XG5cblx0XHR0aGlzLmZpcmUoJ3N0ZXAnKTtcblx0fSxcblxuXHQvLyB5b3UgY2FuJ3QgZWFzaWx5IGdldCBpbnRlcm1lZGlhdGUgdmFsdWVzIG9mIHByb3BlcnRpZXMgYW5pbWF0ZWQgd2l0aCBDU1MzIFRyYW5zaXRpb25zLFxuXHQvLyB3ZSBuZWVkIHRvIHBhcnNlIGNvbXB1dGVkIHN0eWxlIChpbiBjYXNlIG9mIHRyYW5zZm9ybSBpdCByZXR1cm5zIG1hdHJpeCBzdHJpbmcpXG5cblx0X3RyYW5zZm9ybVJlOiAvKFstK10/KD86XFxkKlxcLik/XFxkKylcXEQqLCAoWy0rXT8oPzpcXGQqXFwuKT9cXGQrKVxcRCpcXCkvLFxuXG5cdF9nZXRQb3M6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgbGVmdCwgdG9wLCBtYXRjaGVzLFxuXHRcdCAgICBlbCA9IHRoaXMuX2VsLFxuXHRcdCAgICBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcblxuXHRcdGlmIChMLkJyb3dzZXIuYW55M2QpIHtcblx0XHRcdG1hdGNoZXMgPSBzdHlsZVtMLkRvbVV0aWwuVFJBTlNGT1JNXS5tYXRjaCh0aGlzLl90cmFuc2Zvcm1SZSk7XG5cdFx0XHRpZiAoIW1hdGNoZXMpIHsgcmV0dXJuOyB9XG5cdFx0XHRsZWZ0ID0gcGFyc2VGbG9hdChtYXRjaGVzWzFdKTtcblx0XHRcdHRvcCAgPSBwYXJzZUZsb2F0KG1hdGNoZXNbMl0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZWZ0ID0gcGFyc2VGbG9hdChzdHlsZS5sZWZ0KTtcblx0XHRcdHRvcCAgPSBwYXJzZUZsb2F0KHN0eWxlLnRvcCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5ldyBMLlBvaW50KGxlZnQsIHRvcCwgdHJ1ZSk7XG5cdH0sXG5cblx0X29uVHJhbnNpdGlvbkVuZDogZnVuY3Rpb24gKCkge1xuXHRcdEwuRG9tRXZlbnQub2ZmKHRoaXMuX2VsLCBMLkRvbVV0aWwuVFJBTlNJVElPTl9FTkQsIHRoaXMuX29uVHJhbnNpdGlvbkVuZCwgdGhpcyk7XG5cblx0XHRpZiAoIXRoaXMuX2luUHJvZ3Jlc3MpIHsgcmV0dXJuOyB9XG5cdFx0dGhpcy5faW5Qcm9ncmVzcyA9IGZhbHNlO1xuXG5cdFx0dGhpcy5fZWwuc3R5bGVbTC5Eb21VdGlsLlRSQU5TSVRJT05dID0gJyc7XG5cblx0XHQvLyBqc2hpbnQgY2FtZWxjYXNlOiBmYWxzZVxuXHRcdC8vIG1ha2Ugc3VyZSBMLkRvbVV0aWwuZ2V0UG9zaXRpb24gcmV0dXJucyB0aGUgZmluYWwgcG9zaXRpb24gdmFsdWUgYWZ0ZXIgYW5pbWF0aW9uXG5cdFx0dGhpcy5fZWwuX2xlYWZsZXRfcG9zID0gdGhpcy5fbmV3UG9zO1xuXG5cdFx0Y2xlYXJJbnRlcnZhbCh0aGlzLl9zdGVwVGltZXIpO1xuXG5cdFx0dGhpcy5maXJlKCdzdGVwJykuZmlyZSgnZW5kJyk7XG5cdH1cblxufSk7XG5cblxuLypcbiAqIEV4dGVuZHMgTC5NYXAgdG8gaGFuZGxlIHBhbm5pbmcgYW5pbWF0aW9ucy5cbiAqL1xuXG5MLk1hcC5pbmNsdWRlKHtcblxuXHRzZXRWaWV3OiBmdW5jdGlvbiAoY2VudGVyLCB6b29tLCBvcHRpb25zKSB7XG5cblx0XHR6b29tID0gem9vbSA9PT0gdW5kZWZpbmVkID8gdGhpcy5fem9vbSA6IHRoaXMuX2xpbWl0Wm9vbSh6b29tKTtcblx0XHRjZW50ZXIgPSB0aGlzLl9saW1pdENlbnRlcihMLmxhdExuZyhjZW50ZXIpLCB6b29tLCB0aGlzLm9wdGlvbnMubWF4Qm91bmRzKTtcblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuXHRcdGlmICh0aGlzLl9wYW5BbmltKSB7XG5cdFx0XHR0aGlzLl9wYW5BbmltLnN0b3AoKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5fbG9hZGVkICYmICFvcHRpb25zLnJlc2V0ICYmIG9wdGlvbnMgIT09IHRydWUpIHtcblxuXHRcdFx0aWYgKG9wdGlvbnMuYW5pbWF0ZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdG9wdGlvbnMuem9vbSA9IEwuZXh0ZW5kKHthbmltYXRlOiBvcHRpb25zLmFuaW1hdGV9LCBvcHRpb25zLnpvb20pO1xuXHRcdFx0XHRvcHRpb25zLnBhbiA9IEwuZXh0ZW5kKHthbmltYXRlOiBvcHRpb25zLmFuaW1hdGV9LCBvcHRpb25zLnBhbik7XG5cdFx0XHR9XG5cblx0XHRcdC8vIHRyeSBhbmltYXRpbmcgcGFuIG9yIHpvb21cblx0XHRcdHZhciBhbmltYXRlZCA9ICh0aGlzLl96b29tICE9PSB6b29tKSA/XG5cdFx0XHRcdHRoaXMuX3RyeUFuaW1hdGVkWm9vbSAmJiB0aGlzLl90cnlBbmltYXRlZFpvb20oY2VudGVyLCB6b29tLCBvcHRpb25zLnpvb20pIDpcblx0XHRcdFx0dGhpcy5fdHJ5QW5pbWF0ZWRQYW4oY2VudGVyLCBvcHRpb25zLnBhbik7XG5cblx0XHRcdGlmIChhbmltYXRlZCkge1xuXHRcdFx0XHQvLyBwcmV2ZW50IHJlc2l6ZSBoYW5kbGVyIGNhbGwsIHRoZSB2aWV3IHdpbGwgcmVmcmVzaCBhZnRlciBhbmltYXRpb24gYW55d2F5XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLl9zaXplVGltZXIpO1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBhbmltYXRpb24gZGlkbid0IHN0YXJ0LCBqdXN0IHJlc2V0IHRoZSBtYXAgdmlld1xuXHRcdHRoaXMuX3Jlc2V0VmlldyhjZW50ZXIsIHpvb20pO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cGFuQnk6IGZ1bmN0aW9uIChvZmZzZXQsIG9wdGlvbnMpIHtcblx0XHRvZmZzZXQgPSBMLnBvaW50KG9mZnNldCkucm91bmQoKTtcblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuXHRcdGlmICghb2Zmc2V0LnggJiYgIW9mZnNldC55KSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cblx0XHRpZiAoIXRoaXMuX3BhbkFuaW0pIHtcblx0XHRcdHRoaXMuX3BhbkFuaW0gPSBuZXcgTC5Qb3NBbmltYXRpb24oKTtcblxuXHRcdFx0dGhpcy5fcGFuQW5pbS5vbih7XG5cdFx0XHRcdCdzdGVwJzogdGhpcy5fb25QYW5UcmFuc2l0aW9uU3RlcCxcblx0XHRcdFx0J2VuZCc6IHRoaXMuX29uUGFuVHJhbnNpdGlvbkVuZFxuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fVxuXG5cdFx0Ly8gZG9uJ3QgZmlyZSBtb3Zlc3RhcnQgaWYgYW5pbWF0aW5nIGluZXJ0aWFcblx0XHRpZiAoIW9wdGlvbnMubm9Nb3ZlU3RhcnQpIHtcblx0XHRcdHRoaXMuZmlyZSgnbW92ZXN0YXJ0Jyk7XG5cdFx0fVxuXG5cdFx0Ly8gYW5pbWF0ZSBwYW4gdW5sZXNzIGFuaW1hdGU6IGZhbHNlIHNwZWNpZmllZFxuXHRcdGlmIChvcHRpb25zLmFuaW1hdGUgIT09IGZhbHNlKSB7XG5cdFx0XHRMLkRvbVV0aWwuYWRkQ2xhc3ModGhpcy5fbWFwUGFuZSwgJ2xlYWZsZXQtcGFuLWFuaW0nKTtcblxuXHRcdFx0dmFyIG5ld1BvcyA9IHRoaXMuX2dldE1hcFBhbmVQb3MoKS5zdWJ0cmFjdChvZmZzZXQpO1xuXHRcdFx0dGhpcy5fcGFuQW5pbS5ydW4odGhpcy5fbWFwUGFuZSwgbmV3UG9zLCBvcHRpb25zLmR1cmF0aW9uIHx8IDAuMjUsIG9wdGlvbnMuZWFzZUxpbmVhcml0eSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX3Jhd1BhbkJ5KG9mZnNldCk7XG5cdFx0XHR0aGlzLmZpcmUoJ21vdmUnKS5maXJlKCdtb3ZlZW5kJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X29uUGFuVHJhbnNpdGlvblN0ZXA6IGZ1bmN0aW9uICgpIHtcblx0XHR0aGlzLmZpcmUoJ21vdmUnKTtcblx0fSxcblxuXHRfb25QYW5UcmFuc2l0aW9uRW5kOiBmdW5jdGlvbiAoKSB7XG5cdFx0TC5Eb21VdGlsLnJlbW92ZUNsYXNzKHRoaXMuX21hcFBhbmUsICdsZWFmbGV0LXBhbi1hbmltJyk7XG5cdFx0dGhpcy5maXJlKCdtb3ZlZW5kJyk7XG5cdH0sXG5cblx0X3RyeUFuaW1hdGVkUGFuOiBmdW5jdGlvbiAoY2VudGVyLCBvcHRpb25zKSB7XG5cdFx0Ly8gZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBuZXcgYW5kIGN1cnJlbnQgY2VudGVycyBpbiBwaXhlbHNcblx0XHR2YXIgb2Zmc2V0ID0gdGhpcy5fZ2V0Q2VudGVyT2Zmc2V0KGNlbnRlcikuX2Zsb29yKCk7XG5cblx0XHQvLyBkb24ndCBhbmltYXRlIHRvbyBmYXIgdW5sZXNzIGFuaW1hdGU6IHRydWUgc3BlY2lmaWVkIGluIG9wdGlvbnNcblx0XHRpZiAoKG9wdGlvbnMgJiYgb3B0aW9ucy5hbmltYXRlKSAhPT0gdHJ1ZSAmJiAhdGhpcy5nZXRTaXplKCkuY29udGFpbnMob2Zmc2V0KSkgeyByZXR1cm4gZmFsc2U7IH1cblxuXHRcdHRoaXMucGFuQnkob2Zmc2V0LCBvcHRpb25zKTtcblxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG59KTtcblxuXG4vKlxuICogTC5Qb3NBbmltYXRpb24gZmFsbGJhY2sgaW1wbGVtZW50YXRpb24gdGhhdCBwb3dlcnMgTGVhZmxldCBwYW4gYW5pbWF0aW9uc1xuICogaW4gYnJvd3NlcnMgdGhhdCBkb24ndCBzdXBwb3J0IENTUzMgVHJhbnNpdGlvbnMuXG4gKi9cblxuTC5Qb3NBbmltYXRpb24gPSBMLkRvbVV0aWwuVFJBTlNJVElPTiA/IEwuUG9zQW5pbWF0aW9uIDogTC5Qb3NBbmltYXRpb24uZXh0ZW5kKHtcblxuXHRydW46IGZ1bmN0aW9uIChlbCwgbmV3UG9zLCBkdXJhdGlvbiwgZWFzZUxpbmVhcml0eSkgeyAvLyAoSFRNTEVsZW1lbnQsIFBvaW50WywgTnVtYmVyLCBOdW1iZXJdKVxuXHRcdHRoaXMuc3RvcCgpO1xuXG5cdFx0dGhpcy5fZWwgPSBlbDtcblx0XHR0aGlzLl9pblByb2dyZXNzID0gdHJ1ZTtcblx0XHR0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDAuMjU7XG5cdFx0dGhpcy5fZWFzZU91dFBvd2VyID0gMSAvIE1hdGgubWF4KGVhc2VMaW5lYXJpdHkgfHwgMC41LCAwLjIpO1xuXG5cdFx0dGhpcy5fc3RhcnRQb3MgPSBMLkRvbVV0aWwuZ2V0UG9zaXRpb24oZWwpO1xuXHRcdHRoaXMuX29mZnNldCA9IG5ld1Bvcy5zdWJ0cmFjdCh0aGlzLl9zdGFydFBvcyk7XG5cdFx0dGhpcy5fc3RhcnRUaW1lID0gK25ldyBEYXRlKCk7XG5cblx0XHR0aGlzLmZpcmUoJ3N0YXJ0Jyk7XG5cblx0XHR0aGlzLl9hbmltYXRlKCk7XG5cdH0sXG5cblx0c3RvcDogZnVuY3Rpb24gKCkge1xuXHRcdGlmICghdGhpcy5faW5Qcm9ncmVzcykgeyByZXR1cm47IH1cblxuXHRcdHRoaXMuX3N0ZXAoKTtcblx0XHR0aGlzLl9jb21wbGV0ZSgpO1xuXHR9LFxuXG5cdF9hbmltYXRlOiBmdW5jdGlvbiAoKSB7XG5cdFx0Ly8gYW5pbWF0aW9uIGxvb3Bcblx0XHR0aGlzLl9hbmltSWQgPSBMLlV0aWwucmVxdWVzdEFuaW1GcmFtZSh0aGlzLl9hbmltYXRlLCB0aGlzKTtcblx0XHR0aGlzLl9zdGVwKCk7XG5cdH0sXG5cblx0X3N0ZXA6IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgZWxhcHNlZCA9ICgrbmV3IERhdGUoKSkgLSB0aGlzLl9zdGFydFRpbWUsXG5cdFx0ICAgIGR1cmF0aW9uID0gdGhpcy5fZHVyYXRpb24gKiAxMDAwO1xuXG5cdFx0aWYgKGVsYXBzZWQgPCBkdXJhdGlvbikge1xuXHRcdFx0dGhpcy5fcnVuRnJhbWUodGhpcy5fZWFzZU91dChlbGFwc2VkIC8gZHVyYXRpb24pKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5fcnVuRnJhbWUoMSk7XG5cdFx0XHR0aGlzLl9jb21wbGV0ZSgpO1xuXHRcdH1cblx0fSxcblxuXHRfcnVuRnJhbWU6IGZ1bmN0aW9uIChwcm9ncmVzcykge1xuXHRcdHZhciBwb3MgPSB0aGlzLl9zdGFydFBvcy5hZGQodGhpcy5fb2Zmc2V0Lm11bHRpcGx5QnkocHJvZ3Jlc3MpKTtcblx0XHRMLkRvbVV0aWwuc2V0UG9zaXRpb24odGhpcy5fZWwsIHBvcyk7XG5cblx0XHR0aGlzLmZpcmUoJ3N0ZXAnKTtcblx0fSxcblxuXHRfY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcblx0XHRMLlV0aWwuY2FuY2VsQW5pbUZyYW1lKHRoaXMuX2FuaW1JZCk7XG5cblx0XHR0aGlzLl9pblByb2dyZXNzID0gZmFsc2U7XG5cdFx0dGhpcy5maXJlKCdlbmQnKTtcblx0fSxcblxuXHRfZWFzZU91dDogZnVuY3Rpb24gKHQpIHtcblx0XHRyZXR1cm4gMSAtIE1hdGgucG93KDEgLSB0LCB0aGlzLl9lYXNlT3V0UG93ZXIpO1xuXHR9XG59KTtcblxuXG4vKlxuICogRXh0ZW5kcyBMLk1hcCB0byBoYW5kbGUgem9vbSBhbmltYXRpb25zLlxuICovXG5cbkwuTWFwLm1lcmdlT3B0aW9ucyh7XG5cdHpvb21BbmltYXRpb246IHRydWUsXG5cdHpvb21BbmltYXRpb25UaHJlc2hvbGQ6IDRcbn0pO1xuXG5pZiAoTC5Eb21VdGlsLlRSQU5TSVRJT04pIHtcblxuXHRMLk1hcC5hZGRJbml0SG9vayhmdW5jdGlvbiAoKSB7XG5cdFx0Ly8gZG9uJ3QgYW5pbWF0ZSBvbiBicm93c2VycyB3aXRob3V0IGhhcmR3YXJlLWFjY2VsZXJhdGVkIHRyYW5zaXRpb25zIG9yIG9sZCBBbmRyb2lkL09wZXJhXG5cdFx0dGhpcy5fem9vbUFuaW1hdGVkID0gdGhpcy5vcHRpb25zLnpvb21BbmltYXRpb24gJiYgTC5Eb21VdGlsLlRSQU5TSVRJT04gJiZcblx0XHRcdFx0TC5Ccm93c2VyLmFueTNkICYmICFMLkJyb3dzZXIuYW5kcm9pZDIzICYmICFMLkJyb3dzZXIubW9iaWxlT3BlcmE7XG5cblx0XHQvLyB6b29tIHRyYW5zaXRpb25zIHJ1biB3aXRoIHRoZSBzYW1lIGR1cmF0aW9uIGZvciBhbGwgbGF5ZXJzLCBzbyBpZiBvbmUgb2YgdHJhbnNpdGlvbmVuZCBldmVudHNcblx0XHQvLyBoYXBwZW5zIGFmdGVyIHN0YXJ0aW5nIHpvb20gYW5pbWF0aW9uIChwcm9wYWdhdGluZyB0byB0aGUgbWFwIHBhbmUpLCB3ZSBrbm93IHRoYXQgaXQgZW5kZWQgZ2xvYmFsbHlcblx0XHRpZiAodGhpcy5fem9vbUFuaW1hdGVkKSB7XG5cdFx0XHRMLkRvbUV2ZW50Lm9uKHRoaXMuX21hcFBhbmUsIEwuRG9tVXRpbC5UUkFOU0lUSU9OX0VORCwgdGhpcy5fY2F0Y2hUcmFuc2l0aW9uRW5kLCB0aGlzKTtcblx0XHR9XG5cdH0pO1xufVxuXG5MLk1hcC5pbmNsdWRlKCFMLkRvbVV0aWwuVFJBTlNJVElPTiA/IHt9IDoge1xuXG5cdF9jYXRjaFRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uIChlKSB7XG5cdFx0aWYgKHRoaXMuX2FuaW1hdGluZ1pvb20gJiYgZS5wcm9wZXJ0eU5hbWUuaW5kZXhPZigndHJhbnNmb3JtJykgPj0gMCkge1xuXHRcdFx0dGhpcy5fb25ab29tVHJhbnNpdGlvbkVuZCgpO1xuXHRcdH1cblx0fSxcblxuXHRfbm90aGluZ1RvQW5pbWF0ZTogZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiAhdGhpcy5fY29udGFpbmVyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2xlYWZsZXQtem9vbS1hbmltYXRlZCcpLmxlbmd0aDtcblx0fSxcblxuXHRfdHJ5QW5pbWF0ZWRab29tOiBmdW5jdGlvbiAoY2VudGVyLCB6b29tLCBvcHRpb25zKSB7XG5cblx0XHRpZiAodGhpcy5fYW5pbWF0aW5nWm9vbSkgeyByZXR1cm4gdHJ1ZTsgfVxuXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cblx0XHQvLyBkb24ndCBhbmltYXRlIGlmIGRpc2FibGVkLCBub3Qgc3VwcG9ydGVkIG9yIHpvb20gZGlmZmVyZW5jZSBpcyB0b28gbGFyZ2Vcblx0XHRpZiAoIXRoaXMuX3pvb21BbmltYXRlZCB8fCBvcHRpb25zLmFuaW1hdGUgPT09IGZhbHNlIHx8IHRoaXMuX25vdGhpbmdUb0FuaW1hdGUoKSB8fFxuXHRcdCAgICAgICAgTWF0aC5hYnMoem9vbSAtIHRoaXMuX3pvb20pID4gdGhpcy5vcHRpb25zLnpvb21BbmltYXRpb25UaHJlc2hvbGQpIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0XHQvLyBvZmZzZXQgaXMgdGhlIHBpeGVsIGNvb3JkcyBvZiB0aGUgem9vbSBvcmlnaW4gcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgY2VudGVyXG5cdFx0dmFyIHNjYWxlID0gdGhpcy5nZXRab29tU2NhbGUoem9vbSksXG5cdFx0ICAgIG9mZnNldCA9IHRoaXMuX2dldENlbnRlck9mZnNldChjZW50ZXIpLl9kaXZpZGVCeSgxIC0gMSAvIHNjYWxlKSxcblx0XHRcdG9yaWdpbiA9IHRoaXMuX2dldENlbnRlckxheWVyUG9pbnQoKS5fYWRkKG9mZnNldCk7XG5cblx0XHQvLyBkb24ndCBhbmltYXRlIGlmIHRoZSB6b29tIG9yaWdpbiBpc24ndCB3aXRoaW4gb25lIHNjcmVlbiBmcm9tIHRoZSBjdXJyZW50IGNlbnRlciwgdW5sZXNzIGZvcmNlZFxuXHRcdGlmIChvcHRpb25zLmFuaW1hdGUgIT09IHRydWUgJiYgIXRoaXMuZ2V0U2l6ZSgpLmNvbnRhaW5zKG9mZnNldCkpIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0XHR0aGlzXG5cdFx0ICAgIC5maXJlKCdtb3Zlc3RhcnQnKVxuXHRcdCAgICAuZmlyZSgnem9vbXN0YXJ0Jyk7XG5cblx0XHR0aGlzLl9hbmltYXRlWm9vbShjZW50ZXIsIHpvb20sIG9yaWdpbiwgc2NhbGUsIG51bGwsIHRydWUpO1xuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0X2FuaW1hdGVab29tOiBmdW5jdGlvbiAoY2VudGVyLCB6b29tLCBvcmlnaW4sIHNjYWxlLCBkZWx0YSwgYmFja3dhcmRzLCBmb3JUb3VjaFpvb20pIHtcblxuXHRcdGlmICghZm9yVG91Y2hab29tKSB7XG5cdFx0XHR0aGlzLl9hbmltYXRpbmdab29tID0gdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyBwdXQgdHJhbnNmb3JtIHRyYW5zaXRpb24gb24gYWxsIGxheWVycyB3aXRoIGxlYWZsZXQtem9vbS1hbmltYXRlZCBjbGFzc1xuXHRcdEwuRG9tVXRpbC5hZGRDbGFzcyh0aGlzLl9tYXBQYW5lLCAnbGVhZmxldC16b29tLWFuaW0nKTtcblxuXHRcdC8vIHJlbWVtYmVyIHdoYXQgY2VudGVyL3pvb20gdG8gc2V0IGFmdGVyIGFuaW1hdGlvblxuXHRcdHRoaXMuX2FuaW1hdGVUb0NlbnRlciA9IGNlbnRlcjtcblx0XHR0aGlzLl9hbmltYXRlVG9ab29tID0gem9vbTtcblxuXHRcdC8vIGRpc2FibGUgYW55IGRyYWdnaW5nIGR1cmluZyBhbmltYXRpb25cblx0XHRpZiAoTC5EcmFnZ2FibGUpIHtcblx0XHRcdEwuRHJhZ2dhYmxlLl9kaXNhYmxlZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0TC5VdGlsLnJlcXVlc3RBbmltRnJhbWUoZnVuY3Rpb24gKCkge1xuXHRcdFx0dGhpcy5maXJlKCd6b29tYW5pbScsIHtcblx0XHRcdFx0Y2VudGVyOiBjZW50ZXIsXG5cdFx0XHRcdHpvb206IHpvb20sXG5cdFx0XHRcdG9yaWdpbjogb3JpZ2luLFxuXHRcdFx0XHRzY2FsZTogc2NhbGUsXG5cdFx0XHRcdGRlbHRhOiBkZWx0YSxcblx0XHRcdFx0YmFja3dhcmRzOiBiYWNrd2FyZHNcblx0XHRcdH0pO1xuXHRcdFx0Ly8gaG9ycmlibGUgaGFjayB0byB3b3JrIGFyb3VuZCBhIENocm9tZSBidWcgaHR0cHM6Ly9naXRodWIuY29tL0xlYWZsZXQvTGVhZmxldC9pc3N1ZXMvMzY4OVxuXHRcdFx0c2V0VGltZW91dChMLmJpbmQodGhpcy5fb25ab29tVHJhbnNpdGlvbkVuZCwgdGhpcyksIDI1MCk7XG5cdFx0fSwgdGhpcyk7XG5cdH0sXG5cblx0X29uWm9vbVRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoIXRoaXMuX2FuaW1hdGluZ1pvb20pIHsgcmV0dXJuOyB9XG5cblx0XHR0aGlzLl9hbmltYXRpbmdab29tID0gZmFsc2U7XG5cblx0XHRMLkRvbVV0aWwucmVtb3ZlQ2xhc3ModGhpcy5fbWFwUGFuZSwgJ2xlYWZsZXQtem9vbS1hbmltJyk7XG5cblx0XHR0aGlzLl9yZXNldFZpZXcodGhpcy5fYW5pbWF0ZVRvQ2VudGVyLCB0aGlzLl9hbmltYXRlVG9ab29tLCB0cnVlLCB0cnVlKTtcblxuXHRcdGlmIChMLkRyYWdnYWJsZSkge1xuXHRcdFx0TC5EcmFnZ2FibGUuX2Rpc2FibGVkID0gZmFsc2U7XG5cdFx0fVxuXHR9XG59KTtcblxuXG4vKlxuXHRab29tIGFuaW1hdGlvbiBsb2dpYyBmb3IgTC5UaWxlTGF5ZXIuXG4qL1xuXG5MLlRpbGVMYXllci5pbmNsdWRlKHtcblx0X2FuaW1hdGVab29tOiBmdW5jdGlvbiAoZSkge1xuXHRcdGlmICghdGhpcy5fYW5pbWF0aW5nKSB7XG5cdFx0XHR0aGlzLl9hbmltYXRpbmcgPSB0cnVlO1xuXHRcdFx0dGhpcy5fcHJlcGFyZUJnQnVmZmVyKCk7XG5cdFx0fVxuXG5cdFx0dmFyIGJnID0gdGhpcy5fYmdCdWZmZXIsXG5cdFx0ICAgIHRyYW5zZm9ybSA9IEwuRG9tVXRpbC5UUkFOU0ZPUk0sXG5cdFx0ICAgIGluaXRpYWxUcmFuc2Zvcm0gPSBlLmRlbHRhID8gTC5Eb21VdGlsLmdldFRyYW5zbGF0ZVN0cmluZyhlLmRlbHRhKSA6IGJnLnN0eWxlW3RyYW5zZm9ybV0sXG5cdFx0ICAgIHNjYWxlU3RyID0gTC5Eb21VdGlsLmdldFNjYWxlU3RyaW5nKGUuc2NhbGUsIGUub3JpZ2luKTtcblxuXHRcdGJnLnN0eWxlW3RyYW5zZm9ybV0gPSBlLmJhY2t3YXJkcyA/XG5cdFx0XHRcdHNjYWxlU3RyICsgJyAnICsgaW5pdGlhbFRyYW5zZm9ybSA6XG5cdFx0XHRcdGluaXRpYWxUcmFuc2Zvcm0gKyAnICcgKyBzY2FsZVN0cjtcblx0fSxcblxuXHRfZW5kWm9vbUFuaW06IGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgZnJvbnQgPSB0aGlzLl90aWxlQ29udGFpbmVyLFxuXHRcdCAgICBiZyA9IHRoaXMuX2JnQnVmZmVyO1xuXG5cdFx0ZnJvbnQuc3R5bGUudmlzaWJpbGl0eSA9ICcnO1xuXHRcdGZyb250LnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoZnJvbnQpOyAvLyBCcmluZyB0byBmb3JlXG5cblx0XHQvLyBmb3JjZSByZWZsb3dcblx0XHRMLlV0aWwuZmFsc2VGbihiZy5vZmZzZXRXaWR0aCk7XG5cblx0XHR2YXIgem9vbSA9IHRoaXMuX21hcC5nZXRab29tKCk7XG5cdFx0aWYgKHpvb20gPiB0aGlzLm9wdGlvbnMubWF4Wm9vbSB8fCB6b29tIDwgdGhpcy5vcHRpb25zLm1pblpvb20pIHtcblx0XHRcdHRoaXMuX2NsZWFyQmdCdWZmZXIoKTtcblx0XHR9XG5cblx0XHR0aGlzLl9hbmltYXRpbmcgPSBmYWxzZTtcblx0fSxcblxuXHRfY2xlYXJCZ0J1ZmZlcjogZnVuY3Rpb24gKCkge1xuXHRcdHZhciBtYXAgPSB0aGlzLl9tYXA7XG5cblx0XHRpZiAobWFwICYmICFtYXAuX2FuaW1hdGluZ1pvb20gJiYgIW1hcC50b3VjaFpvb20uX3pvb21pbmcpIHtcblx0XHRcdHRoaXMuX2JnQnVmZmVyLmlubmVySFRNTCA9ICcnO1xuXHRcdFx0dGhpcy5fYmdCdWZmZXIuc3R5bGVbTC5Eb21VdGlsLlRSQU5TRk9STV0gPSAnJztcblx0XHR9XG5cdH0sXG5cblx0X3ByZXBhcmVCZ0J1ZmZlcjogZnVuY3Rpb24gKCkge1xuXG5cdFx0dmFyIGZyb250ID0gdGhpcy5fdGlsZUNvbnRhaW5lcixcblx0XHQgICAgYmcgPSB0aGlzLl9iZ0J1ZmZlcjtcblxuXHRcdC8vIGlmIGZvcmVncm91bmQgbGF5ZXIgZG9lc24ndCBoYXZlIG1hbnkgdGlsZXMgYnV0IGJnIGxheWVyIGRvZXMsXG5cdFx0Ly8ga2VlcCB0aGUgZXhpc3RpbmcgYmcgbGF5ZXIgYW5kIGp1c3Qgem9vbSBpdCBzb21lIG1vcmVcblxuXHRcdHZhciBiZ0xvYWRlZCA9IHRoaXMuX2dldExvYWRlZFRpbGVzUGVyY2VudGFnZShiZyksXG5cdFx0ICAgIGZyb250TG9hZGVkID0gdGhpcy5fZ2V0TG9hZGVkVGlsZXNQZXJjZW50YWdlKGZyb250KTtcblxuXHRcdGlmIChiZyAmJiBiZ0xvYWRlZCA+IDAuNSAmJiBmcm9udExvYWRlZCA8IDAuNSkge1xuXG5cdFx0XHRmcm9udC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG5cdFx0XHR0aGlzLl9zdG9wTG9hZGluZ0ltYWdlcyhmcm9udCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gcHJlcGFyZSB0aGUgYnVmZmVyIHRvIGJlY29tZSB0aGUgZnJvbnQgdGlsZSBwYW5lXG5cdFx0Ymcuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuXHRcdGJnLnN0eWxlW0wuRG9tVXRpbC5UUkFOU0ZPUk1dID0gJyc7XG5cblx0XHQvLyBzd2l0Y2ggb3V0IHRoZSBjdXJyZW50IGxheWVyIHRvIGJlIHRoZSBuZXcgYmcgbGF5ZXIgKGFuZCB2aWNlLXZlcnNhKVxuXHRcdHRoaXMuX3RpbGVDb250YWluZXIgPSBiZztcblx0XHRiZyA9IHRoaXMuX2JnQnVmZmVyID0gZnJvbnQ7XG5cblx0XHR0aGlzLl9zdG9wTG9hZGluZ0ltYWdlcyhiZyk7XG5cblx0XHQvL3ByZXZlbnQgYmcgYnVmZmVyIGZyb20gY2xlYXJpbmcgcmlnaHQgYWZ0ZXIgem9vbVxuXHRcdGNsZWFyVGltZW91dCh0aGlzLl9jbGVhckJnQnVmZmVyVGltZXIpO1xuXHR9LFxuXG5cdF9nZXRMb2FkZWRUaWxlc1BlcmNlbnRhZ2U6IGZ1bmN0aW9uIChjb250YWluZXIpIHtcblx0XHR2YXIgdGlsZXMgPSBjb250YWluZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ltZycpLFxuXHRcdCAgICBpLCBsZW4sIGNvdW50ID0gMDtcblxuXHRcdGZvciAoaSA9IDAsIGxlbiA9IHRpbGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRpZiAodGlsZXNbaV0uY29tcGxldGUpIHtcblx0XHRcdFx0Y291bnQrKztcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIGNvdW50IC8gbGVuO1xuXHR9LFxuXG5cdC8vIHN0b3BzIGxvYWRpbmcgYWxsIHRpbGVzIGluIHRoZSBiYWNrZ3JvdW5kIGxheWVyXG5cdF9zdG9wTG9hZGluZ0ltYWdlczogZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuXHRcdHZhciB0aWxlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGNvbnRhaW5lci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1nJykpLFxuXHRcdCAgICBpLCBsZW4sIHRpbGU7XG5cblx0XHRmb3IgKGkgPSAwLCBsZW4gPSB0aWxlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0dGlsZSA9IHRpbGVzW2ldO1xuXG5cdFx0XHRpZiAoIXRpbGUuY29tcGxldGUpIHtcblx0XHRcdFx0dGlsZS5vbmxvYWQgPSBMLlV0aWwuZmFsc2VGbjtcblx0XHRcdFx0dGlsZS5vbmVycm9yID0gTC5VdGlsLmZhbHNlRm47XG5cdFx0XHRcdHRpbGUuc3JjID0gTC5VdGlsLmVtcHR5SW1hZ2VVcmw7XG5cblx0XHRcdFx0dGlsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRpbGUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cblxuLypcclxuICogUHJvdmlkZXMgTC5NYXAgd2l0aCBjb252ZW5pZW50IHNob3J0Y3V0cyBmb3IgdXNpbmcgYnJvd3NlciBnZW9sb2NhdGlvbiBmZWF0dXJlcy5cclxuICovXHJcblxyXG5MLk1hcC5pbmNsdWRlKHtcclxuXHRfZGVmYXVsdExvY2F0ZU9wdGlvbnM6IHtcclxuXHRcdHdhdGNoOiBmYWxzZSxcclxuXHRcdHNldFZpZXc6IGZhbHNlLFxyXG5cdFx0bWF4Wm9vbTogSW5maW5pdHksXHJcblx0XHR0aW1lb3V0OiAxMDAwMCxcclxuXHRcdG1heGltdW1BZ2U6IDAsXHJcblx0XHRlbmFibGVIaWdoQWNjdXJhY3k6IGZhbHNlXHJcblx0fSxcclxuXHJcblx0bG9jYXRlOiBmdW5jdGlvbiAoLypPYmplY3QqLyBvcHRpb25zKSB7XHJcblxyXG5cdFx0b3B0aW9ucyA9IHRoaXMuX2xvY2F0ZU9wdGlvbnMgPSBMLmV4dGVuZCh0aGlzLl9kZWZhdWx0TG9jYXRlT3B0aW9ucywgb3B0aW9ucyk7XHJcblxyXG5cdFx0aWYgKCFuYXZpZ2F0b3IuZ2VvbG9jYXRpb24pIHtcclxuXHRcdFx0dGhpcy5faGFuZGxlR2VvbG9jYXRpb25FcnJvcih7XHJcblx0XHRcdFx0Y29kZTogMCxcclxuXHRcdFx0XHRtZXNzYWdlOiAnR2VvbG9jYXRpb24gbm90IHN1cHBvcnRlZC4nXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgb25SZXNwb25zZSA9IEwuYmluZCh0aGlzLl9oYW5kbGVHZW9sb2NhdGlvblJlc3BvbnNlLCB0aGlzKSxcclxuXHRcdFx0b25FcnJvciA9IEwuYmluZCh0aGlzLl9oYW5kbGVHZW9sb2NhdGlvbkVycm9yLCB0aGlzKTtcclxuXHJcblx0XHRpZiAob3B0aW9ucy53YXRjaCkge1xyXG5cdFx0XHR0aGlzLl9sb2NhdGlvbldhdGNoSWQgPVxyXG5cdFx0XHQgICAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi53YXRjaFBvc2l0aW9uKG9uUmVzcG9uc2UsIG9uRXJyb3IsIG9wdGlvbnMpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0bmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihvblJlc3BvbnNlLCBvbkVycm9yLCBvcHRpb25zKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHN0b3BMb2NhdGU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdGlmIChuYXZpZ2F0b3IuZ2VvbG9jYXRpb24pIHtcclxuXHRcdFx0bmF2aWdhdG9yLmdlb2xvY2F0aW9uLmNsZWFyV2F0Y2godGhpcy5fbG9jYXRpb25XYXRjaElkKTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLl9sb2NhdGVPcHRpb25zKSB7XHJcblx0XHRcdHRoaXMuX2xvY2F0ZU9wdGlvbnMuc2V0VmlldyA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X2hhbmRsZUdlb2xvY2F0aW9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xyXG5cdFx0dmFyIGMgPSBlcnJvci5jb2RlLFxyXG5cdFx0ICAgIG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlIHx8XHJcblx0XHQgICAgICAgICAgICAoYyA9PT0gMSA/ICdwZXJtaXNzaW9uIGRlbmllZCcgOlxyXG5cdFx0ICAgICAgICAgICAgKGMgPT09IDIgPyAncG9zaXRpb24gdW5hdmFpbGFibGUnIDogJ3RpbWVvdXQnKSk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2xvY2F0ZU9wdGlvbnMuc2V0VmlldyAmJiAhdGhpcy5fbG9hZGVkKSB7XHJcblx0XHRcdHRoaXMuZml0V29ybGQoKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmZpcmUoJ2xvY2F0aW9uZXJyb3InLCB7XHJcblx0XHRcdGNvZGU6IGMsXHJcblx0XHRcdG1lc3NhZ2U6ICdHZW9sb2NhdGlvbiBlcnJvcjogJyArIG1lc3NhZ2UgKyAnLidcclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdF9oYW5kbGVHZW9sb2NhdGlvblJlc3BvbnNlOiBmdW5jdGlvbiAocG9zKSB7XHJcblx0XHR2YXIgbGF0ID0gcG9zLmNvb3Jkcy5sYXRpdHVkZSxcclxuXHRcdCAgICBsbmcgPSBwb3MuY29vcmRzLmxvbmdpdHVkZSxcclxuXHRcdCAgICBsYXRsbmcgPSBuZXcgTC5MYXRMbmcobGF0LCBsbmcpLFxyXG5cclxuXHRcdCAgICBsYXRBY2N1cmFjeSA9IDE4MCAqIHBvcy5jb29yZHMuYWNjdXJhY3kgLyA0MDA3NTAxNyxcclxuXHRcdCAgICBsbmdBY2N1cmFjeSA9IGxhdEFjY3VyYWN5IC8gTWF0aC5jb3MoTC5MYXRMbmcuREVHX1RPX1JBRCAqIGxhdCksXHJcblxyXG5cdFx0ICAgIGJvdW5kcyA9IEwubGF0TG5nQm91bmRzKFxyXG5cdFx0ICAgICAgICAgICAgW2xhdCAtIGxhdEFjY3VyYWN5LCBsbmcgLSBsbmdBY2N1cmFjeV0sXHJcblx0XHQgICAgICAgICAgICBbbGF0ICsgbGF0QWNjdXJhY3ksIGxuZyArIGxuZ0FjY3VyYWN5XSksXHJcblxyXG5cdFx0ICAgIG9wdGlvbnMgPSB0aGlzLl9sb2NhdGVPcHRpb25zO1xyXG5cclxuXHRcdGlmIChvcHRpb25zLnNldFZpZXcpIHtcclxuXHRcdFx0dmFyIHpvb20gPSBNYXRoLm1pbih0aGlzLmdldEJvdW5kc1pvb20oYm91bmRzKSwgb3B0aW9ucy5tYXhab29tKTtcclxuXHRcdFx0dGhpcy5zZXRWaWV3KGxhdGxuZywgem9vbSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGRhdGEgPSB7XHJcblx0XHRcdGxhdGxuZzogbGF0bG5nLFxyXG5cdFx0XHRib3VuZHM6IGJvdW5kcyxcclxuXHRcdFx0dGltZXN0YW1wOiBwb3MudGltZXN0YW1wXHJcblx0XHR9O1xyXG5cclxuXHRcdGZvciAodmFyIGkgaW4gcG9zLmNvb3Jkcykge1xyXG5cdFx0XHRpZiAodHlwZW9mIHBvcy5jb29yZHNbaV0gPT09ICdudW1iZXInKSB7XHJcblx0XHRcdFx0ZGF0YVtpXSA9IHBvcy5jb29yZHNbaV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmZpcmUoJ2xvY2F0aW9uZm91bmQnLCBkYXRhKTtcclxuXHR9XHJcbn0pO1xyXG5cblxufSh3aW5kb3csIGRvY3VtZW50KSk7IiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTEtMjAxNCBGZWxpeCBHbmFzc1xuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwOi8vc3Bpbi5qcy5vcmcvXG4gKlxuICogRXhhbXBsZTpcbiAgICB2YXIgb3B0cyA9IHtcbiAgICAgIGxpbmVzOiAxMiAgICAgICAgICAgICAvLyBUaGUgbnVtYmVyIG9mIGxpbmVzIHRvIGRyYXdcbiAgICAsIGxlbmd0aDogNyAgICAgICAgICAgICAvLyBUaGUgbGVuZ3RoIG9mIGVhY2ggbGluZVxuICAgICwgd2lkdGg6IDUgICAgICAgICAgICAgIC8vIFRoZSBsaW5lIHRoaWNrbmVzc1xuICAgICwgcmFkaXVzOiAxMCAgICAgICAgICAgIC8vIFRoZSByYWRpdXMgb2YgdGhlIGlubmVyIGNpcmNsZVxuICAgICwgc2NhbGU6IDEuMCAgICAgICAgICAgIC8vIFNjYWxlcyBvdmVyYWxsIHNpemUgb2YgdGhlIHNwaW5uZXJcbiAgICAsIGNvcm5lcnM6IDEgICAgICAgICAgICAvLyBSb3VuZG5lc3MgKDAuLjEpXG4gICAgLCBjb2xvcjogJyMwMDAnICAgICAgICAgLy8gI3JnYiBvciAjcnJnZ2JiXG4gICAgLCBvcGFjaXR5OiAxLzQgICAgICAgICAgLy8gT3BhY2l0eSBvZiB0aGUgbGluZXNcbiAgICAsIHJvdGF0ZTogMCAgICAgICAgICAgICAvLyBSb3RhdGlvbiBvZmZzZXRcbiAgICAsIGRpcmVjdGlvbjogMSAgICAgICAgICAvLyAxOiBjbG9ja3dpc2UsIC0xOiBjb3VudGVyY2xvY2t3aXNlXG4gICAgLCBzcGVlZDogMSAgICAgICAgICAgICAgLy8gUm91bmRzIHBlciBzZWNvbmRcbiAgICAsIHRyYWlsOiAxMDAgICAgICAgICAgICAvLyBBZnRlcmdsb3cgcGVyY2VudGFnZVxuICAgICwgZnBzOiAyMCAgICAgICAgICAgICAgIC8vIEZyYW1lcyBwZXIgc2Vjb25kIHdoZW4gdXNpbmcgc2V0VGltZW91dCgpXG4gICAgLCB6SW5kZXg6IDJlOSAgICAgICAgICAgLy8gVXNlIGEgaGlnaCB6LWluZGV4IGJ5IGRlZmF1bHRcbiAgICAsIGNsYXNzTmFtZTogJ3NwaW5uZXInICAvLyBDU1MgY2xhc3MgdG8gYXNzaWduIHRvIHRoZSBlbGVtZW50XG4gICAgLCB0b3A6ICc1MCUnICAgICAgICAgICAgLy8gY2VudGVyIHZlcnRpY2FsbHlcbiAgICAsIGxlZnQ6ICc1MCUnICAgICAgICAgICAvLyBjZW50ZXIgaG9yaXpvbnRhbGx5XG4gICAgLCBzaGFkb3c6IGZhbHNlICAgICAgICAgLy8gV2hldGhlciB0byByZW5kZXIgYSBzaGFkb3dcbiAgICAsIGh3YWNjZWw6IGZhbHNlICAgICAgICAvLyBXaGV0aGVyIHRvIHVzZSBoYXJkd2FyZSBhY2NlbGVyYXRpb24gKG1pZ2h0IGJlIGJ1Z2d5KVxuICAgICwgcG9zaXRpb246ICdhYnNvbHV0ZScgIC8vIEVsZW1lbnQgcG9zaXRpb25pbmdcbiAgICB9XG4gICAgdmFyIHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb28nKVxuICAgIHZhciBzcGlubmVyID0gbmV3IFNwaW5uZXIob3B0cykuc3Bpbih0YXJnZXQpXG4gKi9cbjsoZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcblxuICAvKiBDb21tb25KUyAqL1xuICBpZiAodHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KClcblxuICAvKiBBTUQgbW9kdWxlICovXG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoZmFjdG9yeSlcblxuICAvKiBCcm93c2VyIGdsb2JhbCAqL1xuICBlbHNlIHJvb3QuU3Bpbm5lciA9IGZhY3RvcnkoKVxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gIFwidXNlIHN0cmljdFwiXG5cbiAgdmFyIHByZWZpeGVzID0gWyd3ZWJraXQnLCAnTW96JywgJ21zJywgJ08nXSAvKiBWZW5kb3IgcHJlZml4ZXMgKi9cbiAgICAsIGFuaW1hdGlvbnMgPSB7fSAvKiBBbmltYXRpb24gcnVsZXMga2V5ZWQgYnkgdGhlaXIgbmFtZSAqL1xuICAgICwgdXNlQ3NzQW5pbWF0aW9ucyAvKiBXaGV0aGVyIHRvIHVzZSBDU1MgYW5pbWF0aW9ucyBvciBzZXRUaW1lb3V0ICovXG4gICAgLCBzaGVldCAvKiBBIHN0eWxlc2hlZXQgdG8gaG9sZCB0aGUgQGtleWZyYW1lIG9yIFZNTCBydWxlcy4gKi9cblxuICAvKipcbiAgICogVXRpbGl0eSBmdW5jdGlvbiB0byBjcmVhdGUgZWxlbWVudHMuIElmIG5vIHRhZyBuYW1lIGlzIGdpdmVuLFxuICAgKiBhIERJViBpcyBjcmVhdGVkLiBPcHRpb25hbGx5IHByb3BlcnRpZXMgY2FuIGJlIHBhc3NlZC5cbiAgICovXG4gIGZ1bmN0aW9uIGNyZWF0ZUVsICh0YWcsIHByb3ApIHtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyB8fCAnZGl2JylcbiAgICAgICwgblxuXG4gICAgZm9yIChuIGluIHByb3ApIGVsW25dID0gcHJvcFtuXVxuICAgIHJldHVybiBlbFxuICB9XG5cbiAgLyoqXG4gICAqIEFwcGVuZHMgY2hpbGRyZW4gYW5kIHJldHVybnMgdGhlIHBhcmVudC5cbiAgICovXG4gIGZ1bmN0aW9uIGlucyAocGFyZW50IC8qIGNoaWxkMSwgY2hpbGQyLCAuLi4qLykge1xuICAgIGZvciAodmFyIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgcGFyZW50LmFwcGVuZENoaWxkKGFyZ3VtZW50c1tpXSlcbiAgICB9XG5cbiAgICByZXR1cm4gcGFyZW50XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBvcGFjaXR5IGtleWZyYW1lIGFuaW1hdGlvbiBydWxlIGFuZCByZXR1cm5zIGl0cyBuYW1lLlxuICAgKiBTaW5jZSBtb3N0IG1vYmlsZSBXZWJraXRzIGhhdmUgdGltaW5nIGlzc3VlcyB3aXRoIGFuaW1hdGlvbi1kZWxheSxcbiAgICogd2UgY3JlYXRlIHNlcGFyYXRlIHJ1bGVzIGZvciBlYWNoIGxpbmUvc2VnbWVudC5cbiAgICovXG4gIGZ1bmN0aW9uIGFkZEFuaW1hdGlvbiAoYWxwaGEsIHRyYWlsLCBpLCBsaW5lcykge1xuICAgIHZhciBuYW1lID0gWydvcGFjaXR5JywgdHJhaWwsIH5+KGFscGhhICogMTAwKSwgaSwgbGluZXNdLmpvaW4oJy0nKVxuICAgICAgLCBzdGFydCA9IDAuMDEgKyBpL2xpbmVzICogMTAwXG4gICAgICAsIHogPSBNYXRoLm1heCgxIC0gKDEtYWxwaGEpIC8gdHJhaWwgKiAoMTAwLXN0YXJ0KSwgYWxwaGEpXG4gICAgICAsIHByZWZpeCA9IHVzZUNzc0FuaW1hdGlvbnMuc3Vic3RyaW5nKDAsIHVzZUNzc0FuaW1hdGlvbnMuaW5kZXhPZignQW5pbWF0aW9uJykpLnRvTG93ZXJDYXNlKClcbiAgICAgICwgcHJlID0gcHJlZml4ICYmICctJyArIHByZWZpeCArICctJyB8fCAnJ1xuXG4gICAgaWYgKCFhbmltYXRpb25zW25hbWVdKSB7XG4gICAgICBzaGVldC5pbnNlcnRSdWxlKFxuICAgICAgICAnQCcgKyBwcmUgKyAna2V5ZnJhbWVzICcgKyBuYW1lICsgJ3snICtcbiAgICAgICAgJzAle29wYWNpdHk6JyArIHogKyAnfScgK1xuICAgICAgICBzdGFydCArICcle29wYWNpdHk6JyArIGFscGhhICsgJ30nICtcbiAgICAgICAgKHN0YXJ0KzAuMDEpICsgJyV7b3BhY2l0eToxfScgK1xuICAgICAgICAoc3RhcnQrdHJhaWwpICUgMTAwICsgJyV7b3BhY2l0eTonICsgYWxwaGEgKyAnfScgK1xuICAgICAgICAnMTAwJXtvcGFjaXR5OicgKyB6ICsgJ30nICtcbiAgICAgICAgJ30nLCBzaGVldC5jc3NSdWxlcy5sZW5ndGgpXG5cbiAgICAgIGFuaW1hdGlvbnNbbmFtZV0gPSAxXG4gICAgfVxuXG4gICAgcmV0dXJuIG5hbWVcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmllcyB2YXJpb3VzIHZlbmRvciBwcmVmaXhlcyBhbmQgcmV0dXJucyB0aGUgZmlyc3Qgc3VwcG9ydGVkIHByb3BlcnR5LlxuICAgKi9cbiAgZnVuY3Rpb24gdmVuZG9yIChlbCwgcHJvcCkge1xuICAgIHZhciBzID0gZWwuc3R5bGVcbiAgICAgICwgcHBcbiAgICAgICwgaVxuXG4gICAgcHJvcCA9IHByb3AuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwcm9wLnNsaWNlKDEpXG4gICAgaWYgKHNbcHJvcF0gIT09IHVuZGVmaW5lZCkgcmV0dXJuIHByb3BcbiAgICBmb3IgKGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHBwID0gcHJlZml4ZXNbaV0rcHJvcFxuICAgICAgaWYgKHNbcHBdICE9PSB1bmRlZmluZWQpIHJldHVybiBwcFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIG11bHRpcGxlIHN0eWxlIHByb3BlcnRpZXMgYXQgb25jZS5cbiAgICovXG4gIGZ1bmN0aW9uIGNzcyAoZWwsIHByb3ApIHtcbiAgICBmb3IgKHZhciBuIGluIHByb3ApIHtcbiAgICAgIGVsLnN0eWxlW3ZlbmRvcihlbCwgbikgfHwgbl0gPSBwcm9wW25dXG4gICAgfVxuXG4gICAgcmV0dXJuIGVsXG4gIH1cblxuICAvKipcbiAgICogRmlsbHMgaW4gZGVmYXVsdCB2YWx1ZXMuXG4gICAqL1xuICBmdW5jdGlvbiBtZXJnZSAob2JqKSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBkZWYgPSBhcmd1bWVudHNbaV1cbiAgICAgIGZvciAodmFyIG4gaW4gZGVmKSB7XG4gICAgICAgIGlmIChvYmpbbl0gPT09IHVuZGVmaW5lZCkgb2JqW25dID0gZGVmW25dXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmpcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBsaW5lIGNvbG9yIGZyb20gdGhlIGdpdmVuIHN0cmluZyBvciBhcnJheS5cbiAgICovXG4gIGZ1bmN0aW9uIGdldENvbG9yIChjb2xvciwgaWR4KSB7XG4gICAgcmV0dXJuIHR5cGVvZiBjb2xvciA9PSAnc3RyaW5nJyA/IGNvbG9yIDogY29sb3JbaWR4ICUgY29sb3IubGVuZ3RoXVxuICB9XG5cbiAgLy8gQnVpbHQtaW4gZGVmYXVsdHNcblxuICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgbGluZXM6IDEyICAgICAgICAgICAgIC8vIFRoZSBudW1iZXIgb2YgbGluZXMgdG8gZHJhd1xuICAsIGxlbmd0aDogNyAgICAgICAgICAgICAvLyBUaGUgbGVuZ3RoIG9mIGVhY2ggbGluZVxuICAsIHdpZHRoOiA1ICAgICAgICAgICAgICAvLyBUaGUgbGluZSB0aGlja25lc3NcbiAgLCByYWRpdXM6IDEwICAgICAgICAgICAgLy8gVGhlIHJhZGl1cyBvZiB0aGUgaW5uZXIgY2lyY2xlXG4gICwgc2NhbGU6IDEuMCAgICAgICAgICAgIC8vIFNjYWxlcyBvdmVyYWxsIHNpemUgb2YgdGhlIHNwaW5uZXJcbiAgLCBjb3JuZXJzOiAxICAgICAgICAgICAgLy8gUm91bmRuZXNzICgwLi4xKVxuICAsIGNvbG9yOiAnIzAwMCcgICAgICAgICAvLyAjcmdiIG9yICNycmdnYmJcbiAgLCBvcGFjaXR5OiAxLzQgICAgICAgICAgLy8gT3BhY2l0eSBvZiB0aGUgbGluZXNcbiAgLCByb3RhdGU6IDAgICAgICAgICAgICAgLy8gUm90YXRpb24gb2Zmc2V0XG4gICwgZGlyZWN0aW9uOiAxICAgICAgICAgIC8vIDE6IGNsb2Nrd2lzZSwgLTE6IGNvdW50ZXJjbG9ja3dpc2VcbiAgLCBzcGVlZDogMSAgICAgICAgICAgICAgLy8gUm91bmRzIHBlciBzZWNvbmRcbiAgLCB0cmFpbDogMTAwICAgICAgICAgICAgLy8gQWZ0ZXJnbG93IHBlcmNlbnRhZ2VcbiAgLCBmcHM6IDIwICAgICAgICAgICAgICAgLy8gRnJhbWVzIHBlciBzZWNvbmQgd2hlbiB1c2luZyBzZXRUaW1lb3V0KClcbiAgLCB6SW5kZXg6IDJlOSAgICAgICAgICAgLy8gVXNlIGEgaGlnaCB6LWluZGV4IGJ5IGRlZmF1bHRcbiAgLCBjbGFzc05hbWU6ICdzcGlubmVyJyAgLy8gQ1NTIGNsYXNzIHRvIGFzc2lnbiB0byB0aGUgZWxlbWVudFxuICAsIHRvcDogJzUwJScgICAgICAgICAgICAvLyBjZW50ZXIgdmVydGljYWxseVxuICAsIGxlZnQ6ICc1MCUnICAgICAgICAgICAvLyBjZW50ZXIgaG9yaXpvbnRhbGx5XG4gICwgc2hhZG93OiBmYWxzZSAgICAgICAgIC8vIFdoZXRoZXIgdG8gcmVuZGVyIGEgc2hhZG93XG4gICwgaHdhY2NlbDogZmFsc2UgICAgICAgIC8vIFdoZXRoZXIgdG8gdXNlIGhhcmR3YXJlIGFjY2VsZXJhdGlvbiAobWlnaHQgYmUgYnVnZ3kpXG4gICwgcG9zaXRpb246ICdhYnNvbHV0ZScgIC8vIEVsZW1lbnQgcG9zaXRpb25pbmdcbiAgfVxuXG4gIC8qKiBUaGUgY29uc3RydWN0b3IgKi9cbiAgZnVuY3Rpb24gU3Bpbm5lciAobykge1xuICAgIHRoaXMub3B0cyA9IG1lcmdlKG8gfHwge30sIFNwaW5uZXIuZGVmYXVsdHMsIGRlZmF1bHRzKVxuICB9XG5cbiAgLy8gR2xvYmFsIGRlZmF1bHRzIHRoYXQgb3ZlcnJpZGUgdGhlIGJ1aWx0LWluczpcbiAgU3Bpbm5lci5kZWZhdWx0cyA9IHt9XG5cbiAgbWVyZ2UoU3Bpbm5lci5wcm90b3R5cGUsIHtcbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBzcGlubmVyIHRvIHRoZSBnaXZlbiB0YXJnZXQgZWxlbWVudC4gSWYgdGhpcyBpbnN0YW5jZSBpcyBhbHJlYWR5XG4gICAgICogc3Bpbm5pbmcsIGl0IGlzIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCBmcm9tIGl0cyBwcmV2aW91cyB0YXJnZXQgYiBjYWxsaW5nXG4gICAgICogc3RvcCgpIGludGVybmFsbHkuXG4gICAgICovXG4gICAgc3BpbjogZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgdGhpcy5zdG9wKClcblxuICAgICAgdmFyIHNlbGYgPSB0aGlzXG4gICAgICAgICwgbyA9IHNlbGYub3B0c1xuICAgICAgICAsIGVsID0gc2VsZi5lbCA9IGNyZWF0ZUVsKG51bGwsIHtjbGFzc05hbWU6IG8uY2xhc3NOYW1lfSlcblxuICAgICAgY3NzKGVsLCB7XG4gICAgICAgIHBvc2l0aW9uOiBvLnBvc2l0aW9uXG4gICAgICAsIHdpZHRoOiAwXG4gICAgICAsIHpJbmRleDogby56SW5kZXhcbiAgICAgICwgbGVmdDogby5sZWZ0XG4gICAgICAsIHRvcDogby50b3BcbiAgICAgIH0pXG5cbiAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZShlbCwgdGFyZ2V0LmZpcnN0Q2hpbGQgfHwgbnVsbClcbiAgICAgIH1cblxuICAgICAgZWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3Byb2dyZXNzYmFyJylcbiAgICAgIHNlbGYubGluZXMoZWwsIHNlbGYub3B0cylcblxuICAgICAgaWYgKCF1c2VDc3NBbmltYXRpb25zKSB7XG4gICAgICAgIC8vIE5vIENTUyBhbmltYXRpb24gc3VwcG9ydCwgdXNlIHNldFRpbWVvdXQoKSBpbnN0ZWFkXG4gICAgICAgIHZhciBpID0gMFxuICAgICAgICAgICwgc3RhcnQgPSAoby5saW5lcyAtIDEpICogKDEgLSBvLmRpcmVjdGlvbikgLyAyXG4gICAgICAgICAgLCBhbHBoYVxuICAgICAgICAgICwgZnBzID0gby5mcHNcbiAgICAgICAgICAsIGYgPSBmcHMgLyBvLnNwZWVkXG4gICAgICAgICAgLCBvc3RlcCA9ICgxIC0gby5vcGFjaXR5KSAvIChmICogby50cmFpbCAvIDEwMClcbiAgICAgICAgICAsIGFzdGVwID0gZiAvIG8ubGluZXNcblxuICAgICAgICA7KGZ1bmN0aW9uIGFuaW0gKCkge1xuICAgICAgICAgIGkrK1xuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgby5saW5lczsgaisrKSB7XG4gICAgICAgICAgICBhbHBoYSA9IE1hdGgubWF4KDEgLSAoaSArIChvLmxpbmVzIC0gaikgKiBhc3RlcCkgJSBmICogb3N0ZXAsIG8ub3BhY2l0eSlcblxuICAgICAgICAgICAgc2VsZi5vcGFjaXR5KGVsLCBqICogby5kaXJlY3Rpb24gKyBzdGFydCwgYWxwaGEsIG8pXG4gICAgICAgICAgfVxuICAgICAgICAgIHNlbGYudGltZW91dCA9IHNlbGYuZWwgJiYgc2V0VGltZW91dChhbmltLCB+figxMDAwIC8gZnBzKSlcbiAgICAgICAgfSkoKVxuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbGZcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wcyBhbmQgcmVtb3ZlcyB0aGUgU3Bpbm5lci5cbiAgICAgKi9cbiAgLCBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZWwgPSB0aGlzLmVsXG4gICAgICBpZiAoZWwpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dClcbiAgICAgICAgaWYgKGVsLnBhcmVudE5vZGUpIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpXG4gICAgICAgIHRoaXMuZWwgPSB1bmRlZmluZWRcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgbWV0aG9kIHRoYXQgZHJhd3MgdGhlIGluZGl2aWR1YWwgbGluZXMuIFdpbGwgYmUgb3ZlcndyaXR0ZW5cbiAgICAgKiBpbiBWTUwgZmFsbGJhY2sgbW9kZSBiZWxvdy5cbiAgICAgKi9cbiAgLCBsaW5lczogZnVuY3Rpb24gKGVsLCBvKSB7XG4gICAgICB2YXIgaSA9IDBcbiAgICAgICAgLCBzdGFydCA9IChvLmxpbmVzIC0gMSkgKiAoMSAtIG8uZGlyZWN0aW9uKSAvIDJcbiAgICAgICAgLCBzZWdcblxuICAgICAgZnVuY3Rpb24gZmlsbCAoY29sb3IsIHNoYWRvdykge1xuICAgICAgICByZXR1cm4gY3NzKGNyZWF0ZUVsKCksIHtcbiAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJ1xuICAgICAgICAsIHdpZHRoOiBvLnNjYWxlICogKG8ubGVuZ3RoICsgby53aWR0aCkgKyAncHgnXG4gICAgICAgICwgaGVpZ2h0OiBvLnNjYWxlICogby53aWR0aCArICdweCdcbiAgICAgICAgLCBiYWNrZ3JvdW5kOiBjb2xvclxuICAgICAgICAsIGJveFNoYWRvdzogc2hhZG93XG4gICAgICAgICwgdHJhbnNmb3JtT3JpZ2luOiAnbGVmdCdcbiAgICAgICAgLCB0cmFuc2Zvcm06ICdyb3RhdGUoJyArIH5+KDM2MC9vLmxpbmVzKmkgKyBvLnJvdGF0ZSkgKyAnZGVnKSB0cmFuc2xhdGUoJyArIG8uc2NhbGUqby5yYWRpdXMgKyAncHgnICsgJywwKSdcbiAgICAgICAgLCBib3JkZXJSYWRpdXM6IChvLmNvcm5lcnMgKiBvLnNjYWxlICogby53aWR0aCA+PiAxKSArICdweCdcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgZm9yICg7IGkgPCBvLmxpbmVzOyBpKyspIHtcbiAgICAgICAgc2VnID0gY3NzKGNyZWF0ZUVsKCksIHtcbiAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJ1xuICAgICAgICAsIHRvcDogMSArIH4oby5zY2FsZSAqIG8ud2lkdGggLyAyKSArICdweCdcbiAgICAgICAgLCB0cmFuc2Zvcm06IG8uaHdhY2NlbCA/ICd0cmFuc2xhdGUzZCgwLDAsMCknIDogJydcbiAgICAgICAgLCBvcGFjaXR5OiBvLm9wYWNpdHlcbiAgICAgICAgLCBhbmltYXRpb246IHVzZUNzc0FuaW1hdGlvbnMgJiYgYWRkQW5pbWF0aW9uKG8ub3BhY2l0eSwgby50cmFpbCwgc3RhcnQgKyBpICogby5kaXJlY3Rpb24sIG8ubGluZXMpICsgJyAnICsgMSAvIG8uc3BlZWQgKyAncyBsaW5lYXIgaW5maW5pdGUnXG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYgKG8uc2hhZG93KSBpbnMoc2VnLCBjc3MoZmlsbCgnIzAwMCcsICcwIDAgNHB4ICMwMDAnKSwge3RvcDogJzJweCd9KSlcbiAgICAgICAgaW5zKGVsLCBpbnMoc2VnLCBmaWxsKGdldENvbG9yKG8uY29sb3IsIGkpLCAnMCAwIDFweCByZ2JhKDAsMCwwLC4xKScpKSlcbiAgICAgIH1cbiAgICAgIHJldHVybiBlbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEludGVybmFsIG1ldGhvZCB0aGF0IGFkanVzdHMgdGhlIG9wYWNpdHkgb2YgYSBzaW5nbGUgbGluZS5cbiAgICAgKiBXaWxsIGJlIG92ZXJ3cml0dGVuIGluIFZNTCBmYWxsYmFjayBtb2RlIGJlbG93LlxuICAgICAqL1xuICAsIG9wYWNpdHk6IGZ1bmN0aW9uIChlbCwgaSwgdmFsKSB7XG4gICAgICBpZiAoaSA8IGVsLmNoaWxkTm9kZXMubGVuZ3RoKSBlbC5jaGlsZE5vZGVzW2ldLnN0eWxlLm9wYWNpdHkgPSB2YWxcbiAgICB9XG5cbiAgfSlcblxuXG4gIGZ1bmN0aW9uIGluaXRWTUwgKCkge1xuXG4gICAgLyogVXRpbGl0eSBmdW5jdGlvbiB0byBjcmVhdGUgYSBWTUwgdGFnICovXG4gICAgZnVuY3Rpb24gdm1sICh0YWcsIGF0dHIpIHtcbiAgICAgIHJldHVybiBjcmVhdGVFbCgnPCcgKyB0YWcgKyAnIHhtbG5zPVwidXJuOnNjaGVtYXMtbWljcm9zb2Z0LmNvbTp2bWxcIiBjbGFzcz1cInNwaW4tdm1sXCI+JywgYXR0cilcbiAgICB9XG5cbiAgICAvLyBObyBDU1MgdHJhbnNmb3JtcyBidXQgVk1MIHN1cHBvcnQsIGFkZCBhIENTUyBydWxlIGZvciBWTUwgZWxlbWVudHM6XG4gICAgc2hlZXQuYWRkUnVsZSgnLnNwaW4tdm1sJywgJ2JlaGF2aW9yOnVybCgjZGVmYXVsdCNWTUwpJylcblxuICAgIFNwaW5uZXIucHJvdG90eXBlLmxpbmVzID0gZnVuY3Rpb24gKGVsLCBvKSB7XG4gICAgICB2YXIgciA9IG8uc2NhbGUgKiAoby5sZW5ndGggKyBvLndpZHRoKVxuICAgICAgICAsIHMgPSBvLnNjYWxlICogMiAqIHJcblxuICAgICAgZnVuY3Rpb24gZ3JwICgpIHtcbiAgICAgICAgcmV0dXJuIGNzcyhcbiAgICAgICAgICB2bWwoJ2dyb3VwJywge1xuICAgICAgICAgICAgY29vcmRzaXplOiBzICsgJyAnICsgc1xuICAgICAgICAgICwgY29vcmRvcmlnaW46IC1yICsgJyAnICsgLXJcbiAgICAgICAgICB9KVxuICAgICAgICAsIHsgd2lkdGg6IHMsIGhlaWdodDogcyB9XG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgdmFyIG1hcmdpbiA9IC0oby53aWR0aCArIG8ubGVuZ3RoKSAqIG8uc2NhbGUgKiAyICsgJ3B4J1xuICAgICAgICAsIGcgPSBjc3MoZ3JwKCksIHtwb3NpdGlvbjogJ2Fic29sdXRlJywgdG9wOiBtYXJnaW4sIGxlZnQ6IG1hcmdpbn0pXG4gICAgICAgICwgaVxuXG4gICAgICBmdW5jdGlvbiBzZWcgKGksIGR4LCBmaWx0ZXIpIHtcbiAgICAgICAgaW5zKFxuICAgICAgICAgIGdcbiAgICAgICAgLCBpbnMoXG4gICAgICAgICAgICBjc3MoZ3JwKCksIHtyb3RhdGlvbjogMzYwIC8gby5saW5lcyAqIGkgKyAnZGVnJywgbGVmdDogfn5keH0pXG4gICAgICAgICAgLCBpbnMoXG4gICAgICAgICAgICAgIGNzcyhcbiAgICAgICAgICAgICAgICB2bWwoJ3JvdW5kcmVjdCcsIHthcmNzaXplOiBvLmNvcm5lcnN9KVxuICAgICAgICAgICAgICAsIHsgd2lkdGg6IHJcbiAgICAgICAgICAgICAgICAsIGhlaWdodDogby5zY2FsZSAqIG8ud2lkdGhcbiAgICAgICAgICAgICAgICAsIGxlZnQ6IG8uc2NhbGUgKiBvLnJhZGl1c1xuICAgICAgICAgICAgICAgICwgdG9wOiAtby5zY2FsZSAqIG8ud2lkdGggPj4gMVxuICAgICAgICAgICAgICAgICwgZmlsdGVyOiBmaWx0ZXJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICwgdm1sKCdmaWxsJywge2NvbG9yOiBnZXRDb2xvcihvLmNvbG9yLCBpKSwgb3BhY2l0eTogby5vcGFjaXR5fSlcbiAgICAgICAgICAgICwgdm1sKCdzdHJva2UnLCB7b3BhY2l0eTogMH0pIC8vIHRyYW5zcGFyZW50IHN0cm9rZSB0byBmaXggY29sb3IgYmxlZWRpbmcgdXBvbiBvcGFjaXR5IGNoYW5nZVxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICBpZiAoby5zaGFkb3cpXG4gICAgICAgIGZvciAoaSA9IDE7IGkgPD0gby5saW5lczsgaSsrKSB7XG4gICAgICAgICAgc2VnKGksIC0yLCAncHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LkJsdXIocGl4ZWxyYWRpdXM9MixtYWtlc2hhZG93PTEsc2hhZG93b3BhY2l0eT0uMyknKVxuICAgICAgICB9XG5cbiAgICAgIGZvciAoaSA9IDE7IGkgPD0gby5saW5lczsgaSsrKSBzZWcoaSlcbiAgICAgIHJldHVybiBpbnMoZWwsIGcpXG4gICAgfVxuXG4gICAgU3Bpbm5lci5wcm90b3R5cGUub3BhY2l0eSA9IGZ1bmN0aW9uIChlbCwgaSwgdmFsLCBvKSB7XG4gICAgICB2YXIgYyA9IGVsLmZpcnN0Q2hpbGRcbiAgICAgIG8gPSBvLnNoYWRvdyAmJiBvLmxpbmVzIHx8IDBcbiAgICAgIGlmIChjICYmIGkgKyBvIDwgYy5jaGlsZE5vZGVzLmxlbmd0aCkge1xuICAgICAgICBjID0gYy5jaGlsZE5vZGVzW2kgKyBvXTsgYyA9IGMgJiYgYy5maXJzdENoaWxkOyBjID0gYyAmJiBjLmZpcnN0Q2hpbGRcbiAgICAgICAgaWYgKGMpIGMub3BhY2l0eSA9IHZhbFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgc2hlZXQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGVsID0gY3JlYXRlRWwoJ3N0eWxlJywge3R5cGUgOiAndGV4dC9jc3MnfSlcbiAgICAgIGlucyhkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLCBlbClcbiAgICAgIHJldHVybiBlbC5zaGVldCB8fCBlbC5zdHlsZVNoZWV0XG4gICAgfSgpKVxuXG4gICAgdmFyIHByb2JlID0gY3NzKGNyZWF0ZUVsKCdncm91cCcpLCB7YmVoYXZpb3I6ICd1cmwoI2RlZmF1bHQjVk1MKSd9KVxuXG4gICAgaWYgKCF2ZW5kb3IocHJvYmUsICd0cmFuc2Zvcm0nKSAmJiBwcm9iZS5hZGopIGluaXRWTUwoKVxuICAgIGVsc2UgdXNlQ3NzQW5pbWF0aW9ucyA9IHZlbmRvcihwcm9iZSwgJ2FuaW1hdGlvbicpXG4gIH1cblxuICByZXR1cm4gU3Bpbm5lclxuXG59KSk7XG4iLCIvKipcbiAqIFR1cmYgaXMgYSBtb2R1bGFyIEdJUyBlbmdpbmUgd3JpdHRlbiBpbiBKYXZhU2NyaXB0LiBJdCBwZXJmb3JtcyBnZW9zcGF0aWFsXG4gKiBwcm9jZXNzaW5nIHRhc2tzIHdpdGggR2VvSlNPTiBkYXRhIGFuZCBjYW4gYmUgcnVuIG9uIGEgc2VydmVyIG9yIGluIGEgYnJvd3Nlci5cbiAqXG4gKiBAbW9kdWxlIHR1cmZcbiAqIEBzdW1tYXJ5IEdJUyBGb3IgV2ViIE1hcHNcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGlzb2xpbmVzOiByZXF1aXJlKCd0dXJmLWlzb2xpbmVzJyksXG4gIG1lcmdlOiByZXF1aXJlKCd0dXJmLW1lcmdlJyksXG4gIGNvbnZleDogcmVxdWlyZSgndHVyZi1jb252ZXgnKSxcbiAgd2l0aGluOiByZXF1aXJlKCd0dXJmLXdpdGhpbicpLFxuICBjb25jYXZlOiByZXF1aXJlKCd0dXJmLWNvbmNhdmUnKSxcbiAgY291bnQ6IHJlcXVpcmUoJ3R1cmYtY291bnQnKSxcbiAgZXJhc2U6IHJlcXVpcmUoJ3R1cmYtZXJhc2UnKSxcbiAgdmFyaWFuY2U6IHJlcXVpcmUoJ3R1cmYtdmFyaWFuY2UnKSxcbiAgZGV2aWF0aW9uOiByZXF1aXJlKCd0dXJmLWRldmlhdGlvbicpLFxuICBtZWRpYW46IHJlcXVpcmUoJ3R1cmYtbWVkaWFuJyksXG4gIG1pbjogcmVxdWlyZSgndHVyZi1taW4nKSxcbiAgbWF4OiByZXF1aXJlKCd0dXJmLW1heCcpLFxuICBhZ2dyZWdhdGU6IHJlcXVpcmUoJ3R1cmYtYWdncmVnYXRlJyksXG4gIGZsaXA6IHJlcXVpcmUoJ3R1cmYtZmxpcCcpLFxuICBzaW1wbGlmeTogcmVxdWlyZSgndHVyZi1zaW1wbGlmeScpLFxuICBzdW06IHJlcXVpcmUoJ3R1cmYtc3VtJyksXG4gIGF2ZXJhZ2U6IHJlcXVpcmUoJ3R1cmYtYXZlcmFnZScpLFxuICBiZXppZXI6IHJlcXVpcmUoJ3R1cmYtYmV6aWVyJyksXG4gIHRhZzogcmVxdWlyZSgndHVyZi10YWcnKSxcbiAgc2l6ZTogcmVxdWlyZSgndHVyZi1zaXplJyksXG4gIHNhbXBsZTogcmVxdWlyZSgndHVyZi1zYW1wbGUnKSxcbiAgamVua3M6IHJlcXVpcmUoJ3R1cmYtamVua3MnKSxcbiAgcXVhbnRpbGU6IHJlcXVpcmUoJ3R1cmYtcXVhbnRpbGUnKSxcbiAgZW52ZWxvcGU6IHJlcXVpcmUoJ3R1cmYtZW52ZWxvcGUnKSxcbiAgc3F1YXJlOiByZXF1aXJlKCd0dXJmLXNxdWFyZScpLFxuICBtaWRwb2ludDogcmVxdWlyZSgndHVyZi1taWRwb2ludCcpLFxuICBidWZmZXI6IHJlcXVpcmUoJ3R1cmYtYnVmZmVyJyksXG4gIGNlbnRlcjogcmVxdWlyZSgndHVyZi1jZW50ZXInKSxcbiAgY2VudHJvaWQ6IHJlcXVpcmUoJ3R1cmYtY2VudHJvaWQnKSxcbiAgY29tYmluZTogcmVxdWlyZSgndHVyZi1jb21iaW5lJyksXG4gIGRpc3RhbmNlOiByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyksXG4gIGV4cGxvZGU6IHJlcXVpcmUoJ3R1cmYtZXhwbG9kZScpLFxuICBleHRlbnQ6IHJlcXVpcmUoJ3R1cmYtZXh0ZW50JyksXG4gIGJib3hQb2x5Z29uOiByZXF1aXJlKCd0dXJmLWJib3gtcG9seWdvbicpLFxuICBmZWF0dXJlY29sbGVjdGlvbjogcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpLFxuICBmaWx0ZXI6IHJlcXVpcmUoJ3R1cmYtZmlsdGVyJyksXG4gIGluc2lkZTogcmVxdWlyZSgndHVyZi1pbnNpZGUnKSxcbiAgaW50ZXJzZWN0OiByZXF1aXJlKCd0dXJmLWludGVyc2VjdCcpLFxuICBsaW5lc3RyaW5nOiByZXF1aXJlKCd0dXJmLWxpbmVzdHJpbmcnKSxcbiAgbmVhcmVzdDogcmVxdWlyZSgndHVyZi1uZWFyZXN0JyksXG4gIHBsYW5lcG9pbnQ6IHJlcXVpcmUoJ3R1cmYtcGxhbmVwb2ludCcpLFxuICBwb2ludDogcmVxdWlyZSgndHVyZi1wb2ludCcpLFxuICBwb2x5Z29uOiByZXF1aXJlKCd0dXJmLXBvbHlnb24nKSxcbiAgcmFuZG9tOiByZXF1aXJlKCd0dXJmLXJhbmRvbScpLFxuICByZWNsYXNzOiByZXF1aXJlKCd0dXJmLXJlY2xhc3MnKSxcbiAgcmVtb3ZlOiByZXF1aXJlKCd0dXJmLXJlbW92ZScpLFxuICB0aW46IHJlcXVpcmUoJ3R1cmYtdGluJyksXG4gIHVuaW9uOiByZXF1aXJlKCd0dXJmLXVuaW9uJyksXG4gIGJlYXJpbmc6IHJlcXVpcmUoJ3R1cmYtYmVhcmluZycpLFxuICBkZXN0aW5hdGlvbjogcmVxdWlyZSgndHVyZi1kZXN0aW5hdGlvbicpLFxuICBraW5rczogcmVxdWlyZSgndHVyZi1raW5rcycpLFxuICBwb2ludE9uU3VyZmFjZTogcmVxdWlyZSgndHVyZi1wb2ludC1vbi1zdXJmYWNlJyksXG4gIGFyZWE6IHJlcXVpcmUoJ3R1cmYtYXJlYScpLFxuICBhbG9uZzogcmVxdWlyZSgndHVyZi1hbG9uZycpLFxuICBsaW5lRGlzdGFuY2U6IHJlcXVpcmUoJ3R1cmYtbGluZS1kaXN0YW5jZScpLFxuICBsaW5lU2xpY2U6IHJlcXVpcmUoJ3R1cmYtbGluZS1zbGljZScpLFxuICBwb2ludE9uTGluZTogcmVxdWlyZSgndHVyZi1wb2ludC1vbi1saW5lJyksXG4gIHBvaW50R3JpZDogcmVxdWlyZSgndHVyZi1wb2ludC1ncmlkJyksXG4gIHNxdWFyZUdyaWQ6IHJlcXVpcmUoJ3R1cmYtc3F1YXJlLWdyaWQnKSxcbiAgdHJpYW5nbGVHcmlkOiByZXF1aXJlKCd0dXJmLXRyaWFuZ2xlLWdyaWQnKSxcbiAgaGV4R3JpZDogcmVxdWlyZSgndHVyZi1oZXgtZ3JpZCcpXG59O1xuIiwidmFyIGF2ZXJhZ2UgPSByZXF1aXJlKCd0dXJmLWF2ZXJhZ2UnKTtcbnZhciBzdW0gPSByZXF1aXJlKCd0dXJmLXN1bScpO1xudmFyIG1lZGlhbiA9IHJlcXVpcmUoJ3R1cmYtbWVkaWFuJyk7XG52YXIgbWluID0gcmVxdWlyZSgndHVyZi1taW4nKTtcbnZhciBtYXggPSByZXF1aXJlKCd0dXJmLW1heCcpO1xudmFyIGRldmlhdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZGV2aWF0aW9uJyk7XG52YXIgdmFyaWFuY2UgPSByZXF1aXJlKCd0dXJmLXZhcmlhbmNlJyk7XG52YXIgY291bnQgPSByZXF1aXJlKCd0dXJmLWNvdW50Jyk7XG52YXIgb3BlcmF0aW9ucyA9IHt9O1xub3BlcmF0aW9ucy5hdmVyYWdlID0gYXZlcmFnZTtcbm9wZXJhdGlvbnMuc3VtID0gc3VtO1xub3BlcmF0aW9ucy5tZWRpYW4gPSBtZWRpYW47XG5vcGVyYXRpb25zLm1pbiA9IG1pbjtcbm9wZXJhdGlvbnMubWF4ID0gbWF4O1xub3BlcmF0aW9ucy5kZXZpYXRpb24gPSBkZXZpYXRpb247XG5vcGVyYXRpb25zLnZhcmlhbmNlID0gdmFyaWFuY2U7XG5vcGVyYXRpb25zLmNvdW50ID0gY291bnQ7XG5cbi8qKlxuKiBDYWxjdWxhdGVzIGEgc2VyaWVzIG9mIGFnZ3JlZ2F0aW9ucyBmb3IgYSBzZXQgb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyB3aXRoaW4gYSBzZXQgb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzLiBTdW0sIGF2ZXJhZ2UsIGNvdW50LCBtaW4sIG1heCwgYW5kIGRldmlhdGlvbiBhcmUgc3VwcG9ydGVkLlxuKlxuKiBAbW9kdWxlIHR1cmYvYWdncmVnYXRlXG4qIEBjYXRlZ29yeSBhZ2dyZWdhdGlvblxuKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4qIEBwYXJhbSB7QXJyYXl9IGFnZ3JlZ2F0aW9ucyBhbiBhcnJheSBvZiBhZ2dyZWdhdGlvbiBvYmplY3RzXG4qIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcyB3aXRoIHByb3BlcnRpZXMgbGlzdGVkIGFzIGBvdXRGaWVsZGAgdmFsdWVzIGluIGBhZ2dyZWdhdGlvbnNgXG4qIEBleGFtcGxlXG4qIHZhciBwb2x5Z29ucyA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuKiAgIFwiZmVhdHVyZXNcIjogW1xuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiogICAgICAgICAgIFsxLjY2OTkyMSwgNDguNjMyOTA4XSxcbiogICAgICAgICAgIFsxLjY2OTkyMSwgNDkuMzgyMzcyXSxcbiogICAgICAgICAgIFszLjYzNjQ3NCwgNDkuMzgyMzcyXSxcbiogICAgICAgICAgIFszLjYzNjQ3NCwgNDguNjMyOTA4XSxcbiogICAgICAgICAgIFsxLjY2OTkyMSwgNDguNjMyOTA4XVxuKiAgICAgICAgIF1dXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4qICAgICAgICAgICBbMi4yMzAyMjQsIDQ3Ljg1MDAzXSxcbiogICAgICAgICAgIFsyLjIzMDIyNCwgNDguNjExMTIxXSxcbiogICAgICAgICAgIFs0LjM2MTU3MiwgNDguNjExMTIxXSxcbiogICAgICAgICAgIFs0LjM2MTU3MiwgNDcuODUwMDNdLFxuKiAgICAgICAgICAgWzIuMjMwMjI0LCA0Ny44NTAwM11cbiogICAgICAgICBdXVxuKiAgICAgICB9XG4qICAgICB9XG4qICAgXVxuKiB9O1xuKiB2YXIgcG9pbnRzID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4qICAgXCJmZWF0dXJlc1wiOiBbXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMi4wNTQ0NDMsNDkuMTM4NTk2XVxuKiAgICAgICB9XG4qICAgICB9LFxuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDYwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzMuMDY1MTg1LDQ4Ljg1MDI1OF1cbiogICAgICAgfVxuKiAgICAgfSxcbiogICAgIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsyLjMyOTEwMSw0OC43OTIzOV1cbiogICAgICAgfVxuKiAgICAgfSxcbiogICAgIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsyLjYxNDc0Niw0OC4zMzQzNDNdXG4qICAgICAgIH1cbiogICAgIH0sXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMzAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMy40MTY3NDgsNDguMDU2MDUzXVxuKiAgICAgICB9XG4qICAgICB9XG4qICAgXVxuKiB9O1xuKiB2YXIgYWdncmVnYXRpb25zID0gW1xuKiAgIHtcbiogICAgIGFnZ3JlZ2F0aW9uOiAnc3VtJyxcbiogICAgIGluRmllbGQ6ICdwb3B1bGF0aW9uJyxcbiogICAgIG91dEZpZWxkOiAncG9wX3N1bSdcbiogICB9LFxuKiAgIHtcbiogICAgIGFnZ3JlZ2F0aW9uOiAnYXZlcmFnZScsXG4qICAgICBpbkZpZWxkOiAncG9wdWxhdGlvbicsXG4qICAgICBvdXRGaWVsZDogJ3BvcF9hdmcnXG4qICAgfSxcbiogICB7XG4qICAgICBhZ2dyZWdhdGlvbjogJ21lZGlhbicsXG4qICAgICBpbkZpZWxkOiAncG9wdWxhdGlvbicsXG4qICAgICBvdXRGaWVsZDogJ3BvcF9tZWRpYW4nXG4qICAgfSxcbiogICB7XG4qICAgICBhZ2dyZWdhdGlvbjogJ21pbicsXG4qICAgICBpbkZpZWxkOiAncG9wdWxhdGlvbicsXG4qICAgICBvdXRGaWVsZDogJ3BvcF9taW4nXG4qICAgfSxcbiogICB7XG4qICAgICBhZ2dyZWdhdGlvbjogJ21heCcsXG4qICAgICBpbkZpZWxkOiAncG9wdWxhdGlvbicsXG4qICAgICBvdXRGaWVsZDogJ3BvcF9tYXgnXG4qICAgfSxcbiogICB7XG4qICAgICBhZ2dyZWdhdGlvbjogJ2RldmlhdGlvbicsXG4qICAgICBpbkZpZWxkOiAncG9wdWxhdGlvbicsXG4qICAgICBvdXRGaWVsZDogJ3BvcF9kZXZpYXRpb24nXG4qICAgfSxcbiogICB7XG4qICAgICBhZ2dyZWdhdGlvbjogJ3ZhcmlhbmNlJyxcbiogICAgIGluRmllbGQ6ICdwb3B1bGF0aW9uJyxcbiogICAgIG91dEZpZWxkOiAncG9wX3ZhcmlhbmNlJ1xuKiAgIH0sXG4qICAge1xuKiAgICAgYWdncmVnYXRpb246ICdjb3VudCcsXG4qICAgICBpbkZpZWxkOiAnJyxcbiogICAgIG91dEZpZWxkOiAncG9pbnRfY291bnQnXG4qICAgfVxuKiBdO1xuKlxuKiB2YXIgYWdncmVnYXRlZCA9IHR1cmYuYWdncmVnYXRlKFxuKiAgIHBvbHlnb25zLCBwb2ludHMsIGFnZ3JlZ2F0aW9ucyk7XG4qXG4qIHZhciByZXN1bHQgPSB0dXJmLmZlYXR1cmVjb2xsZWN0aW9uKFxuKiAgIHBvaW50cy5mZWF0dXJlcy5jb25jYXQoYWdncmVnYXRlZC5mZWF0dXJlcykpO1xuKlxuKiAvLz1yZXN1bHRcbiovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9seWdvbnMsIHBvaW50cywgYWdncmVnYXRpb25zKXtcbiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFnZ3JlZ2F0aW9ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIHZhciBhZ2cgPSBhZ2dyZWdhdGlvbnNbaV0sXG4gICAgICBvcGVyYXRpb24gPSBhZ2cuYWdncmVnYXRpb24sXG4gICAgICB1bnJlY29nbml6ZWRFcnJvcjtcblxuICAgIGlmIChpc0FnZ3JlZ2F0aW9uT3BlcmF0aW9uKG9wZXJhdGlvbikpIHtcbiAgICAgIGlmIChvcGVyYXRpb24gPT09ICdjb3VudCcpIHtcbiAgICAgICAgcG9seWdvbnMgPSBvcGVyYXRpb25zW29wZXJhdGlvbl0ocG9seWdvbnMsIHBvaW50cywgYWdnLm91dEZpZWxkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBvbHlnb25zID0gb3BlcmF0aW9uc1tvcGVyYXRpb25dKHBvbHlnb25zLCBwb2ludHMsIGFnZy5pbkZpZWxkLCBhZ2cub3V0RmllbGQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1wiJysgb3BlcmF0aW9uICsnXCIgaXMgbm90IGEgcmVjb2duaXplZCBhZ2dyZWdhdGlvbiBvcGVyYXRpb24uJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHBvbHlnb25zO1xufTtcblxuZnVuY3Rpb24gaXNBZ2dyZWdhdGlvbk9wZXJhdGlvbihvcGVyYXRpb24pIHtcbiAgcmV0dXJuIG9wZXJhdGlvbiA9PT0gJ2F2ZXJhZ2UnIHx8XG4gICAgb3BlcmF0aW9uID09PSAnc3VtJyB8fFxuICAgIG9wZXJhdGlvbiA9PT0gJ21lZGlhbicgfHxcbiAgICBvcGVyYXRpb24gPT09ICdtaW4nIHx8XG4gICAgb3BlcmF0aW9uID09PSAnbWF4JyB8fFxuICAgIG9wZXJhdGlvbiA9PT0gJ2RldmlhdGlvbicgfHxcbiAgICBvcGVyYXRpb24gPT09ICd2YXJpYW5jZScgfHxcbiAgICBvcGVyYXRpb24gPT09ICdjb3VudCc7XG59XG4iLCJ2YXIgZGlzdGFuY2UgPSByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyk7XG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG52YXIgYmVhcmluZyA9IHJlcXVpcmUoJ3R1cmYtYmVhcmluZycpO1xudmFyIGRlc3RpbmF0aW9uID0gcmVxdWlyZSgndHVyZi1kZXN0aW5hdGlvbicpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIExpbmVTdHJpbmd9IGZlYXR1cmUgYW5kIHJldHVybnMgYSB7QGxpbmsgUG9pbnR9IGZlYXR1cmUgYXQgYSBzcGVjaWZpZWQgZGlzdGFuY2UgYWxvbmcgYSBsaW5lLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9hbG9uZ1xuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0xpbmVTdHJpbmd9IGxpbmUgYSBMaW5lU3RyaW5nIGZlYXR1cmVcbiAqIEBwYXJhbSB7TnVtYmVyfSBkaXN0YW5jZSBkaXN0YW5jZSBhbG9uZyB0aGUgbGluZVxuICogQHBhcmFtIHtTdHJpbmd9IFt1bml0cz1taWxlc10gY2FuIGJlIGRlZ3JlZXMsIHJhZGlhbnMsIG1pbGVzLCBvciBraWxvbWV0ZXJzXG4gKiBAcmV0dXJuIHtQb2ludH0gUG9pbnQgYWxvbmcgdGhlIGxpbmUgYXQgYGRpc3RhbmNlYCBkaXN0YW5jZVxuICogQGV4YW1wbGVcbiAqIHZhciBsaW5lID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiTGluZVN0cmluZ1wiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1xuICogICAgICAgWy03Ny4wMzE2NjksIDM4Ljg3ODYwNV0sXG4gKiAgICAgICBbLTc3LjAyOTYwOSwgMzguODgxOTQ2XSxcbiAqICAgICAgIFstNzcuMDIwMzM5LCAzOC44ODQwODRdLFxuICogICAgICAgWy03Ny4wMjU2NjEsIDM4Ljg4NTgyMV0sXG4gKiAgICAgICBbLTc3LjAyMTg4NCwgMzguODg5NTYzXSxcbiAqICAgICAgIFstNzcuMDE5ODI0LCAzOC44OTIzNjhdXG4gKiAgICAgXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBhbG9uZyA9IHR1cmYuYWxvbmcobGluZSwgMSwgJ21pbGVzJyk7XG4gKlxuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbbGluZSwgYWxvbmddXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChsaW5lLCBkaXN0LCB1bml0cykge1xuICB2YXIgY29vcmRzO1xuICBpZihsaW5lLnR5cGUgPT09ICdGZWF0dXJlJykgY29vcmRzID0gbGluZS5nZW9tZXRyeS5jb29yZGluYXRlcztcbiAgZWxzZSBpZihsaW5lLnR5cGUgPT09ICdMaW5lU3RyaW5nJykgY29vcmRzID0gbGluZS5nZW9tZXRyeS5jb29yZGluYXRlcztcbiAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ2lucHV0IG11c3QgYmUgYSBMaW5lU3RyaW5nIEZlYXR1cmUgb3IgR2VvbWV0cnknKTtcblxuICB2YXIgdHJhdmVsbGVkID0gMDtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChkaXN0ID49IHRyYXZlbGxlZCAmJiBpID09PSBjb29yZHMubGVuZ3RoIC0gMSkgYnJlYWs7XG4gICAgZWxzZSBpZih0cmF2ZWxsZWQgPj0gZGlzdCkge1xuICAgICAgdmFyIG92ZXJzaG90ID0gZGlzdCAtIHRyYXZlbGxlZDtcbiAgICAgIGlmKCFvdmVyc2hvdCkgcmV0dXJuIHBvaW50KGNvb3Jkc1tpXSk7XG4gICAgICBlbHNlIHtcbiAgICAgICAgdmFyIGRpcmVjdGlvbiA9IGJlYXJpbmcocG9pbnQoY29vcmRzW2ldKSwgcG9pbnQoY29vcmRzW2ktMV0pKSAtIDE4MDtcbiAgICAgICAgdmFyIGludGVycG9sYXRlZCA9IGRlc3RpbmF0aW9uKHBvaW50KGNvb3Jkc1tpXSksIG92ZXJzaG90LCBkaXJlY3Rpb24sIHVuaXRzKTtcbiAgICAgICAgcmV0dXJuIGludGVycG9sYXRlZDtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0cmF2ZWxsZWQgKz0gZGlzdGFuY2UocG9pbnQoY29vcmRzW2ldKSwgcG9pbnQoY29vcmRzW2krMV0pLCB1bml0cyk7XG4gICAgfVxuICB9XG4gIHJldHVybiBwb2ludChjb29yZHNbY29vcmRzLmxlbmd0aCAtIDFdKTtcbn1cbiIsInZhciBnZW9tZXRyeUFyZWEgPSByZXF1aXJlKCdnZW9qc29uLWFyZWEnKS5nZW9tZXRyeTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBHZW9KU09OfSBmZWF0dXJlIG9yIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2YgYW55IHR5cGUgYW5kIHJldHVybnMgdGhlIGFyZWEgb2YgdGhhdCBmZWF0dXJlXG4gKiBpbiBzcXVhcmUgbWV0ZXJzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9hcmVhXG4gKiBAY2F0ZWdvcnkgbWVhc3VyZW1lbnRcbiAqIEBwYXJhbSB7R2VvSlNPTn0gaW5wdXQgYSB7QGxpbmsgRmVhdHVyZX0gb3Ige0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiBhbnkgdHlwZVxuICogQHJldHVybiB7TnVtYmVyfSBhcmVhIGluIHNxdWFyZSBtZXRlcnNcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9seWdvbnMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbLTY3LjAzMTAyMSwgMTAuNDU4MTAyXSxcbiAqICAgICAgICAgICBbLTY3LjAzMTAyMSwgMTAuNTMzNzJdLFxuICogICAgICAgICAgIFstNjYuOTI5Mzk3LCAxMC41MzM3Ml0sXG4gKiAgICAgICAgICAgWy02Ni45MjkzOTcsIDEwLjQ1ODEwMl0sXG4gKiAgICAgICAgICAgWy02Ny4wMzEwMjEsIDEwLjQ1ODEwMl1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy02Ni45MTk3ODQsIDEwLjM5NzMyNV0sXG4gKiAgICAgICAgICAgWy02Ni45MTk3ODQsIDEwLjUxMzQ2N10sXG4gKiAgICAgICAgICAgWy02Ni44MDUxMTQsIDEwLjUxMzQ2N10sXG4gKiAgICAgICAgICAgWy02Ni44MDUxMTQsIDEwLjM5NzMyNV0sXG4gKiAgICAgICAgICAgWy02Ni45MTk3ODQsIDEwLjM5NzMyNV1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGFyZWEgPSB0dXJmLmFyZWEocG9seWdvbnMpO1xuICpcbiAqIC8vPWFyZWFcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihfKSB7XG4gICAgaWYgKF8udHlwZSA9PT0gJ0ZlYXR1cmVDb2xsZWN0aW9uJykge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgc3VtID0gMDsgaSA8IF8uZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChfLmZlYXR1cmVzW2ldLmdlb21ldHJ5KSB7XG4gICAgICAgICAgICAgICAgc3VtICs9IGdlb21ldHJ5QXJlYShfLmZlYXR1cmVzW2ldLmdlb21ldHJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VtO1xuICAgIH0gZWxzZSBpZiAoXy50eXBlID09PSAnRmVhdHVyZScpIHtcbiAgICAgICAgcmV0dXJuIGdlb21ldHJ5QXJlYShfLmdlb21ldHJ5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZ2VvbWV0cnlBcmVhKF8pO1xuICAgIH1cbn07XG4iLCJ2YXIgd2dzODQgPSByZXF1aXJlKCd3Z3M4NCcpO1xuXG5tb2R1bGUuZXhwb3J0cy5nZW9tZXRyeSA9IGdlb21ldHJ5O1xubW9kdWxlLmV4cG9ydHMucmluZyA9IHJpbmdBcmVhO1xuXG5mdW5jdGlvbiBnZW9tZXRyeShfKSB7XG4gICAgdmFyIGFyZWEgPSAwLCBpO1xuICAgIHN3aXRjaCAoXy50eXBlKSB7XG4gICAgICAgIGNhc2UgJ1BvbHlnb24nOlxuICAgICAgICAgICAgcmV0dXJuIHBvbHlnb25BcmVhKF8uY29vcmRpbmF0ZXMpO1xuICAgICAgICBjYXNlICdNdWx0aVBvbHlnb24nOlxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IF8uY29vcmRpbmF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBhcmVhICs9IHBvbHlnb25BcmVhKF8uY29vcmRpbmF0ZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFyZWE7XG4gICAgICAgIGNhc2UgJ1BvaW50JzpcbiAgICAgICAgY2FzZSAnTXVsdGlQb2ludCc6XG4gICAgICAgIGNhc2UgJ0xpbmVTdHJpbmcnOlxuICAgICAgICBjYXNlICdNdWx0aUxpbmVTdHJpbmcnOlxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIGNhc2UgJ0dlb21ldHJ5Q29sbGVjdGlvbic6XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgXy5nZW9tZXRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJlYSArPSBnZW9tZXRyeShfLmdlb21ldHJpZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFyZWE7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBwb2x5Z29uQXJlYShjb29yZHMpIHtcbiAgICB2YXIgYXJlYSA9IDA7XG4gICAgaWYgKGNvb3JkcyAmJiBjb29yZHMubGVuZ3RoID4gMCkge1xuICAgICAgICBhcmVhICs9IE1hdGguYWJzKHJpbmdBcmVhKGNvb3Jkc1swXSkpO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJlYSAtPSBNYXRoLmFicyhyaW5nQXJlYShjb29yZHNbaV0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJlYTtcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIGFwcHJveGltYXRlIGFyZWEgb2YgdGhlIHBvbHlnb24gd2VyZSBpdCBwcm9qZWN0ZWQgb250b1xuICogICAgIHRoZSBlYXJ0aC4gIE5vdGUgdGhhdCB0aGlzIGFyZWEgd2lsbCBiZSBwb3NpdGl2ZSBpZiByaW5nIGlzIG9yaWVudGVkXG4gKiAgICAgY2xvY2t3aXNlLCBvdGhlcndpc2UgaXQgd2lsbCBiZSBuZWdhdGl2ZS5cbiAqXG4gKiBSZWZlcmVuY2U6XG4gKiBSb2JlcnQuIEcuIENoYW1iZXJsYWluIGFuZCBXaWxsaWFtIEguIER1cXVldHRlLCBcIlNvbWUgQWxnb3JpdGhtcyBmb3JcbiAqICAgICBQb2x5Z29ucyBvbiBhIFNwaGVyZVwiLCBKUEwgUHVibGljYXRpb24gMDctMDMsIEpldCBQcm9wdWxzaW9uXG4gKiAgICAgTGFib3JhdG9yeSwgUGFzYWRlbmEsIENBLCBKdW5lIDIwMDcgaHR0cDovL3Rycy1uZXcuanBsLm5hc2EuZ292L2RzcGFjZS9oYW5kbGUvMjAxNC80MDQwOVxuICpcbiAqIFJldHVybnM6XG4gKiB7ZmxvYXR9IFRoZSBhcHByb3hpbWF0ZSBzaWduZWQgZ2VvZGVzaWMgYXJlYSBvZiB0aGUgcG9seWdvbiBpbiBzcXVhcmVcbiAqICAgICBtZXRlcnMuXG4gKi9cblxuZnVuY3Rpb24gcmluZ0FyZWEoY29vcmRzKSB7XG4gICAgdmFyIGFyZWEgPSAwO1xuXG4gICAgaWYgKGNvb3Jkcy5sZW5ndGggPiAyKSB7XG4gICAgICAgIHZhciBwMSwgcDI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgcDEgPSBjb29yZHNbaV07XG4gICAgICAgICAgICBwMiA9IGNvb3Jkc1tpICsgMV07XG4gICAgICAgICAgICBhcmVhICs9IHJhZChwMlswXSAtIHAxWzBdKSAqICgyICsgTWF0aC5zaW4ocmFkKHAxWzFdKSkgKyBNYXRoLnNpbihyYWQocDJbMV0pKSk7XG4gICAgICAgIH1cblxuICAgICAgICBhcmVhID0gYXJlYSAqIHdnczg0LlJBRElVUyAqIHdnczg0LlJBRElVUyAvIDI7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFyZWE7XG59XG5cbmZ1bmN0aW9uIHJhZChfKSB7XG4gICAgcmV0dXJuIF8gKiBNYXRoLlBJIC8gMTgwO1xufVxuIiwibW9kdWxlLmV4cG9ydHMuUkFESVVTID0gNjM3ODEzNztcbm1vZHVsZS5leHBvcnRzLkZMQVRURU5JTkcgPSAxLzI5OC4yNTcyMjM1NjM7XG5tb2R1bGUuZXhwb3J0cy5QT0xBUl9SQURJVVMgPSA2MzU2NzUyLjMxNDI7XG4iLCJ2YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcblxuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBhdmVyYWdlIHZhbHVlIG9mIGEgZmllbGQgZm9yIGEgc2V0IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgd2l0aGluIGEgc2V0IG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvYXZlcmFnZVxuICogQGNhdGVnb3J5IGFnZ3JlZ2F0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIHRoZSBmaWVsZCBpbiB0aGUgYHBvaW50c2AgZmVhdHVyZXMgZnJvbSB3aGljaCB0byBwdWxsIHZhbHVlcyB0byBhdmVyYWdlXG4gKiBAcGFyYW0ge3N0cmluZ30gb3V0cHV0RmllbGQgdGhlIGZpZWxkIGluIHRoZSBgcG9seWdvbnNgIEZlYXR1cmVDb2xsZWN0aW9uIHRvIHB1dCByZXN1bHRzIG9mIHRoZSBhdmVyYWdlc1xuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIHdpdGggdGhlIHZhbHVlIG9mIGBvdXRGaWVsZGAgc2V0IHRvIHRoZSBjYWxjdWxhdGVkIGF2ZXJhZ2VcbiAqIEBleGFtcGxlXG4qIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFsxMC42NjYzNTEsIDU5Ljg5MDY1OV0sXG4gKiAgICAgICAgICAgWzEwLjY2NjM1MSwgNTkuOTM2Nzg0XSxcbiAqICAgICAgICAgICBbMTAuNzYyNDgxLCA1OS45MzY3ODRdLFxuICogICAgICAgICAgIFsxMC43NjI0ODEsIDU5Ljg5MDY1OV0sXG4gKiAgICAgICAgICAgWzEwLjY2NjM1MSwgNTkuODkwNjU5XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbMTAuNzY0NTQxLCA1OS44ODkyODFdLFxuICogICAgICAgICAgIFsxMC43NjQ1NDEsIDU5LjkzNzEyOF0sXG4gKiAgICAgICAgICAgWzEwLjg2NjE2NSwgNTkuOTM3MTI4XSxcbiAqICAgICAgICAgICBbMTAuODY2MTY1LCA1OS44ODkyODFdLFxuICogICAgICAgICAgIFsxMC43NjQ1NDEsIDU5Ljg4OTI4MV1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjcyNDAyOSwgNTkuOTI2ODA3XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA2MDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAuNzE1Nzg5LCA1OS45MDQ3NzhdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDEwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMC43NDYwMDIsIDU5LjkwODU2Nl1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjgwNjQyNywgNTkuOTA4OTEwXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAzMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAuNzk1NDQsIDU5LjkzMTYyNF1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGF2ZXJhZ2VkID0gdHVyZi5hdmVyYWdlKFxuICogIHBvbHlnb25zLCBwb2ludHMsICdwb3B1bGF0aW9uJywgJ3BvcF9hdmcnKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KFxuICogICBhdmVyYWdlZC5mZWF0dXJlcyk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlGQywgcHRGQywgaW5GaWVsZCwgb3V0RmllbGQsIGRvbmUpe1xuICBwb2x5RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwb2x5KXtcbiAgICBpZighcG9seS5wcm9wZXJ0aWVzKSBwb2x5LnByb3BlcnRpZXMgPSB7fTtcbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgcHRGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHB0KXtcbiAgICAgIGlmIChpbnNpZGUocHQsIHBvbHkpKSB2YWx1ZXMucHVzaChwdC5wcm9wZXJ0aWVzW2luRmllbGRdKTtcbiAgICB9KTtcbiAgICBwb2x5LnByb3BlcnRpZXNbb3V0RmllbGRdID0gYXZlcmFnZSh2YWx1ZXMpO1xuICB9KTtcblxuICByZXR1cm4gcG9seUZDO1xufVxuXG5mdW5jdGlvbiBhdmVyYWdlKHZhbHVlcykge1xuICB2YXIgc3VtID0gMDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBzdW0gKz0gdmFsdWVzW2ldO1xuICB9XG4gIHJldHVybiBzdW0gLyB2YWx1ZXMubGVuZ3RoO1xufVxuIiwidmFyIHBvbHlnb24gPSByZXF1aXJlKCd0dXJmLXBvbHlnb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIGJib3ggYW5kIHJldHVybnMgdGhlIGVxdWl2YWxlbnQge0BsaW5rIFBvbHlnb259IGZlYXR1cmUuXG4gKlxuICogQG1vZHVsZSB0dXJmL2Jib3gtcG9seWdvblxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0FycmF5PG51bWJlcj59IGJib3ggYW4gQXJyYXkgb2YgYm91bmRpbmcgYm94IGNvb3JkaW5hdGVzIGluIHRoZSBmb3JtOiBgYGBbeExvdywgeUxvdywgeEhpZ2gsIHlIaWdoXWBgYFxuICogQHJldHVybiB7UG9seWdvbn0gYSBQb2x5Z29uIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBib3VuZGluZyBib3hcbiAqIEBleGFtcGxlXG4gKiB2YXIgYmJveCA9IFswLCAwLCAxMCwgMTBdO1xuICpcbiAqIHZhciBwb2x5ID0gdHVyZi5iYm94UG9seWdvbihiYm94KTtcbiAqXG4gKiAvLz1wb2x5XG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihiYm94KXtcbiAgdmFyIGxvd0xlZnQgPSBbYmJveFswXSwgYmJveFsxXV07XG4gIHZhciB0b3BMZWZ0ID0gW2Jib3hbMF0sIGJib3hbM11dO1xuICB2YXIgdG9wUmlnaHQgPSBbYmJveFsyXSwgYmJveFszXV07XG4gIHZhciBsb3dSaWdodCA9IFtiYm94WzJdLCBiYm94WzFdXTtcblxuICB2YXIgcG9seSA9IHBvbHlnb24oW1tcbiAgICBsb3dMZWZ0LFxuICAgIGxvd1JpZ2h0LFxuICAgIHRvcFJpZ2h0LFxuICAgIHRvcExlZnQsXG4gICAgbG93TGVmdFxuICBdXSk7XG4gIHJldHVybiBwb2x5O1xufVxuIiwiLy9odHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0hhdmVyc2luZV9mb3JtdWxhXG4vL2h0dHA6Ly93d3cubW92YWJsZS10eXBlLmNvLnVrL3NjcmlwdHMvbGF0bG9uZy5odG1sXG5cbi8qKlxuICogVGFrZXMgdHdvIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYW5kIGZpbmRzIHRoZSBiZWFyaW5nIGJldHdlZW4gdGhlbS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvYmVhcmluZ1xuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge1BvaW50fSBzdGFydCBzdGFydGluZyBQb2ludFxuICogQHBhcmFtIHtQb2ludH0gZW5kIGVuZGluZyBQb2ludFxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcmV0dXJucyB7TnVtYmVyfSBiZWFyaW5nIGluIGRlY2ltYWwgZGVncmVlc1xuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludDEgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcIm1hcmtlci1jb2xvclwiOiAnI2YwMCdcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzUuMzQzLCAzOS45ODRdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcG9pbnQyID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJtYXJrZXItY29sb3JcIjogJyMwZjAnXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjUzNCwgMzkuMTIzXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW3BvaW50MSwgcG9pbnQyXVxuICogfTtcbiAqXG4gKiAvLz1wb2ludHNcbiAqXG4gKiB2YXIgYmVhcmluZyA9IHR1cmYuYmVhcmluZyhwb2ludDEsIHBvaW50Mik7XG4gKlxuICogLy89YmVhcmluZ1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChwb2ludDEsIHBvaW50Mikge1xuICAgIHZhciBjb29yZGluYXRlczEgPSBwb2ludDEuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gICAgdmFyIGNvb3JkaW5hdGVzMiA9IHBvaW50Mi5nZW9tZXRyeS5jb29yZGluYXRlcztcblxuICAgIHZhciBsb24xID0gdG9SYWQoY29vcmRpbmF0ZXMxWzBdKTtcbiAgICB2YXIgbG9uMiA9IHRvUmFkKGNvb3JkaW5hdGVzMlswXSk7XG4gICAgdmFyIGxhdDEgPSB0b1JhZChjb29yZGluYXRlczFbMV0pO1xuICAgIHZhciBsYXQyID0gdG9SYWQoY29vcmRpbmF0ZXMyWzFdKTtcbiAgICB2YXIgYSA9IE1hdGguc2luKGxvbjIgLSBsb24xKSAqIE1hdGguY29zKGxhdDIpO1xuICAgIHZhciBiID0gTWF0aC5jb3MobGF0MSkgKiBNYXRoLnNpbihsYXQyKSAtXG4gICAgICAgIE1hdGguc2luKGxhdDEpICogTWF0aC5jb3MobGF0MikgKiBNYXRoLmNvcyhsb24yIC0gbG9uMSk7XG5cbiAgICB2YXIgYmVhcmluZyA9IHRvRGVnKE1hdGguYXRhbjIoYSwgYikpO1xuXG4gICAgcmV0dXJuIGJlYXJpbmc7XG59O1xuXG5mdW5jdGlvbiB0b1JhZChkZWdyZWUpIHtcbiAgICByZXR1cm4gZGVncmVlICogTWF0aC5QSSAvIDE4MDtcbn1cblxuZnVuY3Rpb24gdG9EZWcocmFkaWFuKSB7XG4gICAgcmV0dXJuIHJhZGlhbiAqIDE4MCAvIE1hdGguUEk7XG59XG4iLCJ2YXIgbGluZXN0cmluZyA9IHJlcXVpcmUoJ3R1cmYtbGluZXN0cmluZycpO1xudmFyIFNwbGluZSA9IHJlcXVpcmUoJy4vc3BsaW5lLmpzJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgTGluZVN0cmluZ30gZmVhdHVyZSBhbmQgcmV0dXJucyBhIGN1cnZlZCB2ZXJzaW9uIG9mIHRoZSBsaW5lXG4gKiBieSBhcHBseWluZyBhIFtCZXppZXIgc3BsaW5lXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0IlQzMlQTl6aWVyX3NwbGluZSlcbiAqIGFsZ29yaXRobS5cbiAqXG4gKiBUaGUgYmV6aWVyIHNwbGluZSBpbXBsZW1lbnRhdGlvbiBpcyBieSBbTGVzemVrIFJ5Ymlja2ldKGh0dHA6Ly9sZXN6ZWsucnliaWNraS5jYy8pLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9iZXppZXJcbiAqIEBjYXRlZ29yeSB0cmFuc2Zvcm1hdGlvblxuICogQHBhcmFtIHtMaW5lU3RyaW5nfSBsaW5lIHRoZSBpbnB1dCBMaW5lU3RyaW5nXG4gKiBAcGFyYW0ge251bWJlcn0gW3Jlc29sdXRpb249MTAwMDBdIHRpbWUgaW4gbWlsbGlzZWNvbmRzIGJldHdlZW4gcG9pbnRzXG4gKiBAcGFyYW0ge251bWJlcn0gW3NoYXJwbmVzcz0wLjg1XSBhIG1lYXN1cmUgb2YgaG93IGN1cnZ5IHRoZSBwYXRoIHNob3VsZCBiZSBiZXR3ZWVuIHNwbGluZXNcbiAqIEByZXR1cm5zIHtMaW5lU3RyaW5nfSBjdXJ2ZWQgbGluZVxuICogQGV4YW1wbGVcbiAqIHZhciBsaW5lID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJzdHJva2VcIjogXCIjZjAwXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiTGluZVN0cmluZ1wiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1xuICogICAgICAgWy03Ni4wOTEzMDgsIDE4LjQyNzUwMV0sXG4gKiAgICAgICBbLTc2LjY5NTU1NiwgMTguNzI5NTAxXSxcbiAqICAgICAgIFstNzYuNTUyNzM0LCAxOS40MDQ0M10sXG4gKiAgICAgICBbLTc0LjYxOTE0LCAxOS4xMzQ3ODldLFxuICogICAgICAgWy03My42NTIzNDMsIDIwLjA3NjU3XSxcbiAqICAgICAgIFstNzMuMTU3OTU4LCAyMC4yMTA2NTZdXG4gKiAgICAgXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBjdXJ2ZWQgPSB0dXJmLmJlemllcihsaW5lKTtcbiAqIGN1cnZlZC5wcm9wZXJ0aWVzID0geyBzdHJva2U6ICcjMGYwJyB9O1xuICpcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW2xpbmUsIGN1cnZlZF1cbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGluZSwgcmVzb2x1dGlvbiwgc2hhcnBuZXNzKXtcbiAgdmFyIGxpbmVPdXQgPSBsaW5lc3RyaW5nKFtdKTtcblxuICBsaW5lT3V0LnByb3BlcnRpZXMgPSBsaW5lLnByb3BlcnRpZXM7XG4gIHZhciBwdHMgPSBsaW5lLmdlb21ldHJ5LmNvb3JkaW5hdGVzLm1hcChmdW5jdGlvbihwdCl7XG4gICAgcmV0dXJuIHt4OiBwdFswXSwgeTogcHRbMV19O1xuICB9KTtcblxuICB2YXIgc3BsaW5lID0gbmV3IFNwbGluZSh7XG4gICAgcG9pbnRzOiBwdHMsXG4gICAgZHVyYXRpb246IHJlc29sdXRpb24sXG4gICAgc2hhcnBuZXNzOiBzaGFycG5lc3NcbiAgfSk7XG4gIGZvciAodmFyIGk9MDsgaTxzcGxpbmUuZHVyYXRpb247IGkrPTEwKSB7XG4gICAgdmFyIHBvcyA9IHNwbGluZS5wb3MoaSk7XG4gICAgaWYgKE1hdGguZmxvb3IoaS8xMDApJTI9PT0wKSB7XG4gICAgICAgIGxpbmVPdXQuZ2VvbWV0cnkuY29vcmRpbmF0ZXMucHVzaChbcG9zLngsIHBvcy55XSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGxpbmVPdXQ7XG59O1xuIiwiIC8qKlxuICAgKiBCZXppZXJTcGxpbmVcbiAgICogaHR0cDovL2xlc3pla3IuZ2l0aHViLmNvbS9cbiAgICpcbiAgICogQGNvcHlyaWdodFxuICAgKiBDb3B5cmlnaHQgKEMpIDIwMTIgTGVzemVrIFJ5Ymlja2kuXG4gICAqXG4gICAqIEBsaWNlbnNlXG4gICAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIEJlemllclNwbGluZVxuICAgKlxuICAgKiBCZXppZXJTcGxpbmUgaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeVxuICAgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnlcbiAgICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbiAgICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAgICpcbiAgICogQmV6aWVyU3BsaW5lIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gICAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gICAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGVcbiAgICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAgICpcbiAgICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAgICogYWxvbmcgd2l0aCBCZXppZXJTcGxpbmUuICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2NvcHlsZWZ0L2xlc3Nlci5odG1sPi5cbiAgICovXG5cbiAgLypcbiAgVXNhZ2U6XG5cbiAgICB2YXIgc3BsaW5lID0gbmV3IFNwbGluZSh7XG4gICAgICBwb2ludHM6IGFycmF5X29mX2NvbnRyb2xfcG9pbnRzLFxuICAgICAgZHVyYXRpb246IHRpbWVfaW5fbWlsaXNlY29uZHMsXG4gICAgICBzaGFycG5lc3M6IGhvd19jdXJ2eSxcbiAgICAgIHN0ZXBMZW5ndGg6IGRpc3RhbmNlX2JldHdlZW5fcG9pbnRzX3RvX2NhY2hlXG4gICAgfSk7XG5cbiAgKi9cbnZhciBTcGxpbmUgPSBmdW5jdGlvbihvcHRpb25zKXtcbiAgICB0aGlzLnBvaW50cyA9IG9wdGlvbnMucG9pbnRzIHx8IFtdO1xuICAgIHRoaXMuZHVyYXRpb24gPSBvcHRpb25zLmR1cmF0aW9uIHx8IDEwMDAwO1xuICAgIHRoaXMuc2hhcnBuZXNzID0gb3B0aW9ucy5zaGFycG5lc3MgfHwgMC44NTtcbiAgICB0aGlzLmNlbnRlcnMgPSBbXTtcbiAgICB0aGlzLmNvbnRyb2xzID0gW107XG4gICAgdGhpcy5zdGVwTGVuZ3RoID0gb3B0aW9ucy5zdGVwTGVuZ3RoIHx8IDYwO1xuICAgIHRoaXMubGVuZ3RoID0gdGhpcy5wb2ludHMubGVuZ3RoO1xuICAgIHRoaXMuZGVsYXkgPSAwO1xuICAgIC8vIHRoaXMgaXMgdG8gZW5zdXJlIGNvbXBhdGliaWxpdHkgd2l0aCB0aGUgMmQgdmVyc2lvblxuICAgIGZvcih2YXIgaT0wOyBpPHRoaXMubGVuZ3RoOyBpKyspIHRoaXMucG9pbnRzW2ldLnogPSB0aGlzLnBvaW50c1tpXS56IHx8IDA7XG4gICAgZm9yKHZhciBpPTA7IGk8dGhpcy5sZW5ndGgtMTsgaSsrKXtcbiAgICAgIHZhciBwMSA9IHRoaXMucG9pbnRzW2ldO1xuICAgICAgdmFyIHAyID0gdGhpcy5wb2ludHNbaSsxXTtcbiAgICAgIHRoaXMuY2VudGVycy5wdXNoKHt4OihwMS54K3AyLngpLzIsIHk6KHAxLnkrcDIueSkvMiwgejoocDEueitwMi56KS8yfSk7XG4gICAgfVxuICAgIHRoaXMuY29udHJvbHMucHVzaChbdGhpcy5wb2ludHNbMF0sdGhpcy5wb2ludHNbMF1dKTtcbiAgICBmb3IodmFyIGk9MDsgaTx0aGlzLmNlbnRlcnMubGVuZ3RoLTE7IGkrKyl7XG4gICAgICB2YXIgcDEgPSB0aGlzLmNlbnRlcnNbaV07XG4gICAgICB2YXIgcDIgPSB0aGlzLmNlbnRlcnNbaSsxXTtcbiAgICAgIHZhciBkeCA9IHRoaXMucG9pbnRzW2krMV0ueC0odGhpcy5jZW50ZXJzW2ldLngrdGhpcy5jZW50ZXJzW2krMV0ueCkvMjtcbiAgICAgIHZhciBkeSA9IHRoaXMucG9pbnRzW2krMV0ueS0odGhpcy5jZW50ZXJzW2ldLnkrdGhpcy5jZW50ZXJzW2krMV0ueSkvMjtcbiAgICAgIHZhciBkeiA9IHRoaXMucG9pbnRzW2krMV0uei0odGhpcy5jZW50ZXJzW2ldLnkrdGhpcy5jZW50ZXJzW2krMV0ueikvMjtcbiAgICAgIHRoaXMuY29udHJvbHMucHVzaChbe1xuICAgICAgICB4OigxLjAtdGhpcy5zaGFycG5lc3MpKnRoaXMucG9pbnRzW2krMV0ueCt0aGlzLnNoYXJwbmVzcyoodGhpcy5jZW50ZXJzW2ldLngrZHgpLFxuICAgICAgICB5OigxLjAtdGhpcy5zaGFycG5lc3MpKnRoaXMucG9pbnRzW2krMV0ueSt0aGlzLnNoYXJwbmVzcyoodGhpcy5jZW50ZXJzW2ldLnkrZHkpLFxuICAgICAgICB6OigxLjAtdGhpcy5zaGFycG5lc3MpKnRoaXMucG9pbnRzW2krMV0ueit0aGlzLnNoYXJwbmVzcyoodGhpcy5jZW50ZXJzW2ldLnorZHopfSxcbiAgICAgIHtcbiAgICAgICAgeDooMS4wLXRoaXMuc2hhcnBuZXNzKSp0aGlzLnBvaW50c1tpKzFdLngrdGhpcy5zaGFycG5lc3MqKHRoaXMuY2VudGVyc1tpKzFdLngrZHgpLFxuICAgICAgICB5OigxLjAtdGhpcy5zaGFycG5lc3MpKnRoaXMucG9pbnRzW2krMV0ueSt0aGlzLnNoYXJwbmVzcyoodGhpcy5jZW50ZXJzW2krMV0ueStkeSksXG4gICAgICAgIHo6KDEuMC10aGlzLnNoYXJwbmVzcykqdGhpcy5wb2ludHNbaSsxXS56K3RoaXMuc2hhcnBuZXNzKih0aGlzLmNlbnRlcnNbaSsxXS56K2R6KX1dKTtcbiAgICB9XG4gICAgdGhpcy5jb250cm9scy5wdXNoKFt0aGlzLnBvaW50c1t0aGlzLmxlbmd0aC0xXSx0aGlzLnBvaW50c1t0aGlzLmxlbmd0aC0xXV0pO1xuICAgIHRoaXMuc3RlcHMgPSB0aGlzLmNhY2hlU3RlcHModGhpcy5zdGVwTGVuZ3RoKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKlxuICAgIENhY2hlcyBhbiBhcnJheSBvZiBlcXVpZGlzdGFudCAobW9yZSBvciBsZXNzKSBwb2ludHMgb24gdGhlIGN1cnZlLlxuICAqL1xuICBTcGxpbmUucHJvdG90eXBlLmNhY2hlU3RlcHMgPSBmdW5jdGlvbihtaW5kaXN0KXtcbiAgICB2YXIgc3RlcHMgPSBbXTtcbiAgICB2YXIgbGFzdHN0ZXAgPSB0aGlzLnBvcygwKTtcbiAgICBzdGVwcy5wdXNoKDApO1xuICAgIGZvcih2YXIgdD0wOyB0PHRoaXMuZHVyYXRpb247IHQrPTEwKXtcbiAgICAgIHZhciBzdGVwID0gdGhpcy5wb3ModCk7XG4gICAgICB2YXIgZGlzdCA9IE1hdGguc3FydCgoc3RlcC54LWxhc3RzdGVwLngpKihzdGVwLngtbGFzdHN0ZXAueCkrKHN0ZXAueS1sYXN0c3RlcC55KSooc3RlcC55LWxhc3RzdGVwLnkpKyhzdGVwLnotbGFzdHN0ZXAueikqKHN0ZXAuei1sYXN0c3RlcC56KSk7XG4gICAgICBpZihkaXN0Pm1pbmRpc3Qpe1xuICAgICAgICBzdGVwcy5wdXNoKHQpO1xuICAgICAgICBsYXN0c3RlcCA9IHN0ZXA7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzdGVwcztcbiAgfTtcblxuICAvKlxuICAgIHJldHVybnMgYW5nbGUgYW5kIHNwZWVkIGluIHRoZSBnaXZlbiBwb2ludCBpbiB0aGUgY3VydmVcbiAgKi9cbiAgU3BsaW5lLnByb3RvdHlwZS52ZWN0b3IgPSBmdW5jdGlvbih0KXtcbiAgICB2YXIgcDEgPSB0aGlzLnBvcyh0KzEwKTtcbiAgICB2YXIgcDIgPSB0aGlzLnBvcyh0LTEwKTtcbiAgICByZXR1cm4ge1xuICAgICAgYW5nbGU6MTgwKk1hdGguYXRhbjIocDEueS1wMi55LCBwMS54LXAyLngpLzMuMTQsXG4gICAgICBzcGVlZDpNYXRoLnNxcnQoKHAyLngtcDEueCkqKHAyLngtcDEueCkrKHAyLnktcDEueSkqKHAyLnktcDEueSkrKHAyLnotcDEueikqKHAyLnotcDEueikpXG4gICAgfTtcbiAgfTtcblxuICAvKlxuICAgIEdldHMgdGhlIHBvc2l0aW9uIG9mIHRoZSBwb2ludCwgZ2l2ZW4gdGltZS5cblxuICAgIFdBUk5JTkc6IFRoZSBzcGVlZCBpcyBub3QgY29uc3RhbnQuIFRoZSB0aW1lIGl0IHRha2VzIGJldHdlZW4gY29udHJvbCBwb2ludHMgaXMgY29uc3RhbnQuXG5cbiAgICBGb3IgY29uc3RhbnQgc3BlZWQsIHVzZSBTcGxpbmUuc3RlcHNbaV07XG4gICovXG4gIFNwbGluZS5wcm90b3R5cGUucG9zID0gZnVuY3Rpb24odGltZSl7XG5cbiAgICBmdW5jdGlvbiBiZXppZXIodCwgcDEsIGMxLCBjMiwgcDIpe1xuICAgICAgdmFyIEIgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHZhciB0Mj10KnQsIHQzPXQyKnQ7XG4gICAgICAgIHJldHVybiBbKHQzKSwoMyp0MiooMS10KSksKDMqdCooMS10KSooMS10KSksKCgxLXQpKigxLXQpKigxLXQpKV1cbiAgICAgIH1cbiAgICAgIHZhciBiID0gQih0KVxuICAgICAgdmFyIHBvcyA9IHtcbiAgICAgICAgeCA6IHAyLnggKiBiWzBdICsgYzIueCAqIGJbMV0gK2MxLnggKiBiWzJdICsgcDEueCAqIGJbM10sXG4gICAgICAgIHkgOiBwMi55ICogYlswXSArIGMyLnkgKiBiWzFdICtjMS55ICogYlsyXSArIHAxLnkgKiBiWzNdLFxuICAgICAgICB6IDogcDIueiAqIGJbMF0gKyBjMi56ICogYlsxXSArYzEueiAqIGJbMl0gKyBwMS56ICogYlszXVxuICAgICAgfVxuICAgICAgcmV0dXJuIHBvcztcbiAgICB9XG4gICAgdmFyIHQgPSB0aW1lLXRoaXMuZGVsYXk7XG4gICAgaWYodDwwKSB0PTA7XG4gICAgaWYodD50aGlzLmR1cmF0aW9uKSB0PXRoaXMuZHVyYXRpb24tMTtcbiAgICAvL3QgPSB0LXRoaXMuZGVsYXk7XG4gICAgdmFyIHQyID0gKHQpL3RoaXMuZHVyYXRpb247XG4gICAgaWYodDI+PTEpIHJldHVybiB0aGlzLnBvaW50c1t0aGlzLmxlbmd0aC0xXTtcblxuICAgIHZhciBuID0gTWF0aC5mbG9vcigodGhpcy5wb2ludHMubGVuZ3RoLTEpKnQyKTtcbiAgICB2YXIgdDEgPSAodGhpcy5sZW5ndGgtMSkqdDItbjtcbiAgICByZXR1cm4gYmV6aWVyKHQxLHRoaXMucG9pbnRzW25dLHRoaXMuY29udHJvbHNbbl1bMV0sdGhpcy5jb250cm9sc1tuKzFdWzBdLHRoaXMucG9pbnRzW24rMV0pO1xuICB9XG5cbiAgbW9kdWxlLmV4cG9ydHMgPSBTcGxpbmU7XG4iLCIvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzgzOTg5OS9ob3ctZG8taS1jYWxjdWxhdGUtYS1wb2ludC1vbi1hLWNpcmNsZXMtY2lyY3VtZmVyZW5jZVxuLy8gcmFkaWFucyA9IGRlZ3JlZXMgKiAocGkvMTgwKVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2Jqb3JuaGFycnRlbGwvanN0cy9ibG9iL21hc3Rlci9leGFtcGxlcy9idWZmZXIuaHRtbFxuXG52YXIgZmVhdHVyZWNvbGxlY3Rpb24gPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG52YXIgcG9seWdvbiA9IHJlcXVpcmUoJ3R1cmYtcG9seWdvbicpO1xudmFyIGNvbWJpbmUgPSByZXF1aXJlKCd0dXJmLWNvbWJpbmUnKTtcbnZhciBqc3RzID0gcmVxdWlyZSgnanN0cycpO1xuXG4vKipcbiogQ2FsY3VsYXRlcyBhIGJ1ZmZlciBmb3IgYSB7QGxpbmsgUG9pbnR9LCB7QGxpbmsgTGluZVN0cmluZ30sIG9yIHtAbGluayBQb2x5Z29ufSB7QGxpbmsgRmVhdHVyZX0ve0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBmb3IgYSBnaXZlbiByYWRpdXMuIFVuaXRzIHN1cHBvcnRlZCBhcmUgbWlsZXMsIGtpbG9tZXRlcnMsIGFuZCBkZWdyZWVzLlxuKlxuKiBAbW9kdWxlIHR1cmYvYnVmZmVyXG4qIEBjYXRlZ29yeSB0cmFuc2Zvcm1hdGlvblxuKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBmZWF0dXJlIGEgRmVhdHVyZSBvciBGZWF0dXJlQ29sbGVjdGlvbiBvZiBhbnkgdHlwZVxuKiBAcGFyYW0ge051bWJlcn0gZGlzdGFuY2UgZGlzdGFuY2UgdG8gZHJhdyB0aGUgYnVmZmVyXG4qIEBwYXJhbSB7U3RyaW5nfSB1bml0ICdtaWxlcycgb3IgJ2tpbG9tZXRlcnMnXG4qIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIGNvbnRhaW5pbmcge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIHJlcHJlc2VudGluZyBidWZmZXJzXG4qXG4qIEBleGFtcGxlXG4qIHZhciBwdCA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuKiAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgIFwiY29vcmRpbmF0ZXNcIjogWy05MC41NDg2MzAsIDE0LjYxNjU5OV1cbiogICB9XG4qIH07XG4qIHZhciB1bml0ID0gJ21pbGVzJztcbipcbiogdmFyIGJ1ZmZlcmVkID0gdHVyZi5idWZmZXIocHQsIDUwMCwgdW5pdCk7XG4qXG4qIHZhciByZXN1bHRGZWF0dXJlcyA9IGJ1ZmZlcmVkLmZlYXR1cmVzLmNvbmNhdChwdCk7XG4qIHZhciByZXN1bHQgPSB7XG4qICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4qIH07XG4qXG4qIC8vPXJlc3VsdFxuKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmZWF0dXJlLCByYWRpdXMsIHVuaXRzKXtcbiAgdmFyIGJ1ZmZlcmVkO1xuXG4gIHN3aXRjaCh1bml0cyl7XG4gICAgY2FzZSAnbWlsZXMnOlxuICAgICAgcmFkaXVzID0gcmFkaXVzIC8gNjkuMDQ3O1xuICAgICAgYnJlYWtcbiAgICBjYXNlICdmZWV0JzpcbiAgICAgIHJhZGl1cyA9IHJhZGl1cyAvIDM2NDU2OC4wO1xuICAgICAgYnJlYWtcbiAgICBjYXNlICdraWxvbWV0ZXJzJzpcbiAgICAgIHJhZGl1cyA9IHJhZGl1cyAvIDExMS4xMjtcbiAgICAgIGJyZWFrXG4gICAgY2FzZSAnbWV0ZXJzJzpcbiAgICAgIHJhZGl1cyA9IHJhZGl1cyAvIDExMTEyMC4wO1xuICAgICAgYnJlYWtcbiAgICBjYXNlICdkZWdyZWVzJzpcbiAgICAgIGJyZWFrXG4gIH1cblxuICBpZihmZWF0dXJlLnR5cGUgPT09ICdGZWF0dXJlQ29sbGVjdGlvbicpe1xuICAgIHZhciBtdWx0aSA9IGNvbWJpbmUoZmVhdHVyZSk7XG4gICAgbXVsdGkucHJvcGVydGllcyA9IHt9O1xuICAgIGJ1ZmZlcmVkID0gYnVmZmVyT3AobXVsdGksIHJhZGl1cyk7XG4gICAgcmV0dXJuIGJ1ZmZlcmVkO1xuICB9XG4gIGVsc2V7XG4gICAgYnVmZmVyZWQgPSBidWZmZXJPcChmZWF0dXJlLCByYWRpdXMpO1xuICAgIHJldHVybiBidWZmZXJlZDtcbiAgfVxufVxuXG52YXIgYnVmZmVyT3AgPSBmdW5jdGlvbihmZWF0dXJlLCByYWRpdXMpe1xuICB2YXIgcmVhZGVyID0gbmV3IGpzdHMuaW8uR2VvSlNPTlJlYWRlcigpO1xuICB2YXIgZ2VvbSA9IHJlYWRlci5yZWFkKEpTT04uc3RyaW5naWZ5KGZlYXR1cmUuZ2VvbWV0cnkpKTtcbiAgdmFyIGJ1ZmZlcmVkID0gZ2VvbS5idWZmZXIocmFkaXVzKTtcbiAgdmFyIHBhcnNlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05QYXJzZXIoKTtcbiAgYnVmZmVyZWQgPSBwYXJzZXIud3JpdGUoYnVmZmVyZWQpO1xuXG4gIGlmKGJ1ZmZlcmVkLnR5cGUgPT09ICdNdWx0aVBvbHlnb24nKXtcbiAgICBidWZmZXJlZCA9IHtcbiAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgIGdlb21ldHJ5OiBidWZmZXJlZCxcbiAgICAgIHByb3BlcnRpZXM6IHt9XG4gICAgfTtcbiAgICBidWZmZXJlZCA9IGZlYXR1cmVjb2xsZWN0aW9uKFtidWZmZXJlZF0pO1xuICB9XG4gIGVsc2V7XG4gICAgYnVmZmVyZWQgPSBmZWF0dXJlY29sbGVjdGlvbihbcG9seWdvbihidWZmZXJlZC5jb29yZGluYXRlcyldKTtcbiAgfVxuXG4gIHJldHVybiBidWZmZXJlZDtcbn1cbiIsInJlcXVpcmUoJ2phdmFzY3JpcHQudXRpbCcpO1xudmFyIGpzdHMgPSByZXF1aXJlKCcuL2xpYi9qc3RzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IGpzdHNcbiIsIi8qIFRoZSBKU1RTIFRvcG9sb2d5IFN1aXRlIGlzIGEgY29sbGVjdGlvbiBvZiBKYXZhU2NyaXB0IGNsYXNzZXMgdGhhdFxuaW1wbGVtZW50IHRoZSBmdW5kYW1lbnRhbCBvcGVyYXRpb25zIHJlcXVpcmVkIHRvIHZhbGlkYXRlIGEgZ2l2ZW5cbmdlby1zcGF0aWFsIGRhdGEgc2V0IHRvIGEga25vd24gdG9wb2xvZ2ljYWwgc3BlY2lmaWNhdGlvbi5cblxuQ29weXJpZ2h0IChDKSAyMDExIFRoZSBBdXRob3JzXG5cblRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3Jcbm1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbkxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxudmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG5cblRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2Zcbk1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VXG5MZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuXG5Zb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG5MaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlXG5Gb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UsIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAgMDIxMTEtMTMwNyAgVVNBICovXG5qc3RzPXt2ZXJzaW9uOicwLjE1LjAnLGFsZ29yaXRobTp7ZGlzdGFuY2U6e30sbG9jYXRlOnt9fSxlcnJvcjp7fSxnZW9tOnt1dGlsOnt9fSxnZW9tZ3JhcGg6e2luZGV4Ont9fSxpbmRleDp7YmludHJlZTp7fSxjaGFpbjp7fSxrZHRyZWU6e30scXVhZHRyZWU6e30sc3RydHJlZTp7fX0saW86e30sbm9kaW5nOntzbmFwcm91bmQ6e319LG9wZXJhdGlvbjp7YnVmZmVyOnt9LGRpc3RhbmNlOnt9LG92ZXJsYXk6e3NuYXA6e319LHBvbHlnb25pemU6e30scHJlZGljYXRlOnt9LHJlbGF0ZTp7fSx1bmlvbjp7fSx2YWxpZDp7fX0scGxhbmFyZ3JhcGg6e30sc2ltcGxpZnk6e30sdHJpYW5ndWxhdGU6e3F1YWRlZGdlOnt9fSx1dGlsOnt9fTtpZih0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS50cmltIT09J2Z1bmN0aW9uJyl7U3RyaW5nLnByb3RvdHlwZS50cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxccyt8XFxzKyQvZywnJyk7fTt9XG5qc3RzLmFic3RyYWN0RnVuYz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmVycm9yPXt9O2pzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3I9ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5uYW1lPSdJbGxlZ2FsQXJndW1lbnRFcnJvcic7dGhpcy5tZXNzYWdlPW1lc3NhZ2U7fTtqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3I9ZnVuY3Rpb24obWVzc2FnZSxwdCl7dGhpcy5uYW1lPSdUb3BvbG9neUVycm9yJzt0aGlzLm1lc3NhZ2U9cHQ/bWVzc2FnZSsnIFsgJytwdCsnIF0nOm1lc3NhZ2U7fTtqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3I9ZnVuY3Rpb24oKXt0aGlzLm5hbWU9J0Fic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yJzt0aGlzLm1lc3NhZ2U9J0Fic3RyYWN0IG1ldGhvZCBjYWxsZWQsIHNob3VsZCBiZSBpbXBsZW1lbnRlZCBpbiBzdWJjbGFzcy4nO307anN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7anN0cy5lcnJvci5Ob3RJbXBsZW1lbnRlZEVycm9yPWZ1bmN0aW9uKCl7dGhpcy5uYW1lPSdOb3RJbXBsZW1lbnRlZEVycm9yJzt0aGlzLm1lc3NhZ2U9J1RoaXMgbWV0aG9kIGhhcyBub3QgeWV0IGJlZW4gaW1wbGVtZW50ZWQuJzt9O2pzdHMuZXJyb3IuTm90SW1wbGVtZW50ZWRFcnJvci5wcm90b3R5cGU9bmV3IEVycm9yKCk7anN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3I9ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5uYW1lPSdOb3RSZXByZXNlbnRhYmxlRXJyb3InO3RoaXMubWVzc2FnZT1tZXNzYWdlO307anN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3IucHJvdG90eXBlPW5ldyBFcnJvcigpO2pzdHMuZXJyb3IuTG9jYXRlRmFpbHVyZUVycm9yPWZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMubmFtZT0nTG9jYXRlRmFpbHVyZUVycm9yJzt0aGlzLm1lc3NhZ2U9bWVzc2FnZTt9O2pzdHMuZXJyb3IuTG9jYXRlRmFpbHVyZUVycm9yLnByb3RvdHlwZT1uZXcgRXJyb3IoKTtpZih0eXBlb2YgbW9kdWxlIT09XCJ1bmRlZmluZWRcIiltb2R1bGUuZXhwb3J0cz1qc3RzO2pzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcj1mdW5jdGlvbigpe307anN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS51dGlsLlBvbHlnb25FeHRyYWN0ZXI9ZnVuY3Rpb24oY29tcHMpe3RoaXMuY29tcHM9Y29tcHM7fTtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyKCk7anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5wcm90b3R5cGUuY29tcHM9bnVsbDtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyLmdldFBvbHlnb25zPWZ1bmN0aW9uKGdlb20sbGlzdCl7aWYobGlzdD09PXVuZGVmaW5lZCl7bGlzdD1bXTt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe2xpc3QucHVzaChnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3RlcihsaXN0KSk7fVxucmV0dXJuIGxpc3Q7fTtqc3RzLmdlb20udXRpbC5Qb2x5Z29uRXh0cmFjdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxudGhpcy5jb21wcy5wdXNoKGdlb20pO307anN0cy5pby5XS1RQYXJzZXI9ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnl8fG5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5yZWdFeGVzPXsndHlwZVN0cic6L15cXHMqKFxcdyspXFxzKlxcKFxccyooLiopXFxzKlxcKVxccyokLywnZW1wdHlUeXBlU3RyJzovXlxccyooXFx3KylcXHMqRU1QVFlcXHMqJC8sJ3NwYWNlcyc6L1xccysvLCdwYXJlbkNvbW1hJzovXFwpXFxzKixcXHMqXFwoLywnZG91YmxlUGFyZW5Db21tYSc6L1xcKVxccypcXClcXHMqLFxccypcXChcXHMqXFwoLywndHJpbVBhcmVucyc6L15cXHMqXFwoPyguKj8pXFwpP1xccyokL307fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUucmVhZD1mdW5jdGlvbih3a3Qpe3ZhciBnZW9tZXRyeSx0eXBlLHN0cjt3a3Q9d2t0LnJlcGxhY2UoL1tcXG5cXHJdL2csJyAnKTt2YXIgbWF0Y2hlcz10aGlzLnJlZ0V4ZXMudHlwZVN0ci5leGVjKHdrdCk7aWYod2t0LnNlYXJjaCgnRU1QVFknKSE9PS0xKXttYXRjaGVzPXRoaXMucmVnRXhlcy5lbXB0eVR5cGVTdHIuZXhlYyh3a3QpO21hdGNoZXNbMl09dW5kZWZpbmVkO31cbmlmKG1hdGNoZXMpe3R5cGU9bWF0Y2hlc1sxXS50b0xvd2VyQ2FzZSgpO3N0cj1tYXRjaGVzWzJdO2lmKHRoaXMucGFyc2VbdHlwZV0pe2dlb21ldHJ5PXRoaXMucGFyc2VbdHlwZV0uYXBwbHkodGhpcyxbc3RyXSk7fX1cbmlmKGdlb21ldHJ5PT09dW5kZWZpbmVkKVxudGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcGFyc2UgV0tUICcrd2t0KTtyZXR1cm4gZ2VvbWV0cnk7fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3JldHVybiB0aGlzLmV4dHJhY3RHZW9tZXRyeShnZW9tZXRyeSk7fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUuZXh0cmFjdEdlb21ldHJ5PWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgdHlwZT1nZW9tZXRyeS5DTEFTU19OQU1FLnNwbGl0KCcuJylbMl0udG9Mb3dlckNhc2UoKTtpZighdGhpcy5leHRyYWN0W3R5cGVdKXtyZXR1cm4gbnVsbDt9XG52YXIgd2t0VHlwZT10eXBlLnRvVXBwZXJDYXNlKCk7dmFyIGRhdGE7aWYoZ2VvbWV0cnkuaXNFbXB0eSgpKXtkYXRhPXdrdFR5cGUrJyBFTVBUWSc7fWVsc2V7ZGF0YT13a3RUeXBlKycoJyt0aGlzLmV4dHJhY3RbdHlwZV0uYXBwbHkodGhpcyxbZ2VvbWV0cnldKSsnKSc7fVxucmV0dXJuIGRhdGE7fTtqc3RzLmlvLldLVFBhcnNlci5wcm90b3R5cGUuZXh0cmFjdD17J2Nvb3JkaW5hdGUnOmZ1bmN0aW9uKGNvb3JkaW5hdGUpe3JldHVybiBjb29yZGluYXRlLngrJyAnK2Nvb3JkaW5hdGUueTt9LCdwb2ludCc6ZnVuY3Rpb24ocG9pbnQpe3JldHVybiBwb2ludC5jb29yZGluYXRlLngrJyAnK3BvaW50LmNvb3JkaW5hdGUueTt9LCdtdWx0aXBvaW50JzpmdW5jdGlvbihtdWx0aXBvaW50KXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTAsbGVuPW11bHRpcG9pbnQuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKCcoJytcbnRoaXMuZXh0cmFjdC5wb2ludC5hcHBseSh0aGlzLFttdWx0aXBvaW50Lmdlb21ldHJpZXNbaV1dKSsnKScpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnbGluZXN0cmluZyc6ZnVuY3Rpb24obGluZXN0cmluZyl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wLGxlbj1saW5lc3RyaW5nLnBvaW50cy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKHRoaXMuZXh0cmFjdC5jb29yZGluYXRlLmFwcGx5KHRoaXMsW2xpbmVzdHJpbmcucG9pbnRzW2ldXSkpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fSwnbXVsdGlsaW5lc3RyaW5nJzpmdW5jdGlvbihtdWx0aWxpbmVzdHJpbmcpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49bXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrXG50aGlzLmV4dHJhY3QubGluZXN0cmluZy5hcHBseSh0aGlzLFttdWx0aWxpbmVzdHJpbmcuZ2VvbWV0cmllc1tpXV0pKycpJyk7fVxucmV0dXJuIGFycmF5LmpvaW4oJywnKTt9LCdwb2x5Z29uJzpmdW5jdGlvbihwb2x5Z29uKXt2YXIgYXJyYXk9W107YXJyYXkucHVzaCgnKCcrdGhpcy5leHRyYWN0LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbcG9seWdvbi5zaGVsbF0pKycpJyk7Zm9yKHZhciBpPTAsbGVuPXBvbHlnb24uaG9sZXMubGVuZ3RoO2k8bGVuOysraSl7YXJyYXkucHVzaCgnKCcrdGhpcy5leHRyYWN0LmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbcG9seWdvbi5ob2xlc1tpXV0pKycpJyk7fVxucmV0dXJuIGFycmF5LmpvaW4oJywnKTt9LCdtdWx0aXBvbHlnb24nOmZ1bmN0aW9uKG11bHRpcG9seWdvbil7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wLGxlbj1tdWx0aXBvbHlnb24uZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47KytpKXthcnJheS5wdXNoKCcoJyt0aGlzLmV4dHJhY3QucG9seWdvbi5hcHBseSh0aGlzLFttdWx0aXBvbHlnb24uZ2VvbWV0cmllc1tpXV0pKycpJyk7fVxucmV0dXJuIGFycmF5LmpvaW4oJywnKTt9LCdnZW9tZXRyeWNvbGxlY3Rpb24nOmZ1bmN0aW9uKGNvbGxlY3Rpb24pe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MCxsZW49Y29sbGVjdGlvbi5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjsrK2kpe2FycmF5LnB1c2godGhpcy5leHRyYWN0R2VvbWV0cnkuYXBwbHkodGhpcyxbY29sbGVjdGlvbi5nZW9tZXRyaWVzW2ldXSkpO31cbnJldHVybiBhcnJheS5qb2luKCcsJyk7fX07anN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLnBhcnNlPXsncG9pbnQnOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9pbnQobnVsbCk7fVxudmFyIGNvb3Jkcz1zdHIudHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5zcGFjZXMpO3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmRzWzBdLGNvb3Jkc1sxXSkpO30sJ211bHRpcG9pbnQnOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2ludChudWxsKTt9XG52YXIgcG9pbnQ7dmFyIHBvaW50cz1zdHIudHJpbSgpLnNwbGl0KCcsJyk7dmFyIGNvbXBvbmVudHM9W107Zm9yKHZhciBpPTAsbGVuPXBvaW50cy5sZW5ndGg7aTxsZW47KytpKXtwb2ludD1wb2ludHNbaV0ucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVBhcmVucywnJDEnKTtjb21wb25lbnRzLnB1c2godGhpcy5wYXJzZS5wb2ludC5hcHBseSh0aGlzLFtwb2ludF0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2ludChjb21wb25lbnRzKTt9LCdsaW5lc3RyaW5nJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcobnVsbCk7fVxudmFyIHBvaW50cz1zdHIudHJpbSgpLnNwbGl0KCcsJyk7dmFyIGNvbXBvbmVudHM9W107dmFyIGNvb3Jkcztmb3IodmFyIGk9MCxsZW49cG9pbnRzLmxlbmd0aDtpPGxlbjsrK2kpe2Nvb3Jkcz1wb2ludHNbaV0udHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5zcGFjZXMpO2NvbXBvbmVudHMucHVzaChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmRzWzBdLGNvb3Jkc1sxXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKGNvbXBvbmVudHMpO30sJ2xpbmVhcnJpbmcnOmZ1bmN0aW9uKHN0cil7aWYoc3RyPT09dW5kZWZpbmVkKXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhudWxsKTt9XG52YXIgcG9pbnRzPXN0ci50cmltKCkuc3BsaXQoJywnKTt2YXIgY29tcG9uZW50cz1bXTt2YXIgY29vcmRzO2Zvcih2YXIgaT0wLGxlbj1wb2ludHMubGVuZ3RoO2k8bGVuOysraSl7Y29vcmRzPXBvaW50c1tpXS50cmltKCkuc3BsaXQodGhpcy5yZWdFeGVzLnNwYWNlcyk7Y29tcG9uZW50cy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShjb29yZHNbMF0sY29vcmRzWzFdKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29tcG9uZW50cyk7fSwnbXVsdGlsaW5lc3RyaW5nJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhudWxsKTt9XG52YXIgbGluZTt2YXIgbGluZXM9c3RyLnRyaW0oKS5zcGxpdCh0aGlzLnJlZ0V4ZXMucGFyZW5Db21tYSk7dmFyIGNvbXBvbmVudHM9W107Zm9yKHZhciBpPTAsbGVuPWxpbmVzLmxlbmd0aDtpPGxlbjsrK2kpe2xpbmU9bGluZXNbaV0ucmVwbGFjZSh0aGlzLnJlZ0V4ZXMudHJpbVBhcmVucywnJDEnKTtjb21wb25lbnRzLnB1c2godGhpcy5wYXJzZS5saW5lc3RyaW5nLmFwcGx5KHRoaXMsW2xpbmVdKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhjb21wb25lbnRzKTt9LCdwb2x5Z29uJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24obnVsbCk7fVxudmFyIHJpbmcsbGluZXN0cmluZyxsaW5lYXJyaW5nO3ZhciByaW5ncz1zdHIudHJpbSgpLnNwbGl0KHRoaXMucmVnRXhlcy5wYXJlbkNvbW1hKTt2YXIgc2hlbGw7dmFyIGhvbGVzPVtdO2Zvcih2YXIgaT0wLGxlbj1yaW5ncy5sZW5ndGg7aTxsZW47KytpKXtyaW5nPXJpbmdzW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7bGluZXN0cmluZz10aGlzLnBhcnNlLmxpbmVzdHJpbmcuYXBwbHkodGhpcyxbcmluZ10pO2xpbmVhcnJpbmc9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhsaW5lc3RyaW5nLnBvaW50cyk7aWYoaT09PTApe3NoZWxsPWxpbmVhcnJpbmc7fWVsc2V7aG9sZXMucHVzaChsaW5lYXJyaW5nKTt9fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvbHlnb24oc2hlbGwsaG9sZXMpO30sJ211bHRpcG9seWdvbic6ZnVuY3Rpb24oc3RyKXtpZihzdHI9PT11bmRlZmluZWQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvbHlnb24obnVsbCk7fVxudmFyIHBvbHlnb247dmFyIHBvbHlnb25zPXN0ci50cmltKCkuc3BsaXQodGhpcy5yZWdFeGVzLmRvdWJsZVBhcmVuQ29tbWEpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj1wb2x5Z29ucy5sZW5ndGg7aTxsZW47KytpKXtwb2x5Z29uPXBvbHlnb25zW2ldLnJlcGxhY2UodGhpcy5yZWdFeGVzLnRyaW1QYXJlbnMsJyQxJyk7Y29tcG9uZW50cy5wdXNoKHRoaXMucGFyc2UucG9seWdvbi5hcHBseSh0aGlzLFtwb2x5Z29uXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvbHlnb24oY29tcG9uZW50cyk7fSwnZ2VvbWV0cnljb2xsZWN0aW9uJzpmdW5jdGlvbihzdHIpe2lmKHN0cj09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5zdHI9c3RyLnJlcGxhY2UoLyxcXHMqKFtBLVphLXpdKS9nLCd8JDEnKTt2YXIgd2t0QXJyYXk9c3RyLnRyaW0oKS5zcGxpdCgnfCcpO3ZhciBjb21wb25lbnRzPVtdO2Zvcih2YXIgaT0wLGxlbj13a3RBcnJheS5sZW5ndGg7aTxsZW47KytpKXtjb21wb25lbnRzLnB1c2goanN0cy5pby5XS1RQYXJzZXIucHJvdG90eXBlLnJlYWQuYXBwbHkodGhpcyxbd2t0QXJyYXlbaV1dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihjb21wb25lbnRzKTt9fTtqc3RzLmluZGV4Lkl0ZW1WaXNpdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4Lkl0ZW1WaXNpdG9yLnByb3RvdHlwZS52aXNpdEl0ZW09ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zPWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFPS0xO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5SSUdIVD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFPTE7anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkxFRlQ9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0U7anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUj0wO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5TVFJBSUdIVD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09MTElORUFSO2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4PWZ1bmN0aW9uKHAxLHAyLHEpe3ZhciBkeDEsZHkxLGR4MixkeTI7ZHgxPXAyLngtcDEueDtkeTE9cDIueS1wMS55O2R4Mj1xLngtcDIueDtkeTI9cS55LXAyLnk7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50LnNpZ25PZkRldDJ4MihkeDEsZHkxLGR4MixkeTIpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxvY2F0ZVBvaW50SW5SaW5nKHAscmluZykhPT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMubG9jYXRlUG9pbnRJblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLmxvY2F0ZVBvaW50SW5SaW5nKHAscmluZyk7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNPbkxpbmU9ZnVuY3Rpb24ocCxwdCl7dmFyIGxpbmVJbnRlcnNlY3RvcixpLGlsLHAwLHAxO2xpbmVJbnRlcnNlY3Rvcj1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7Zm9yKGk9MSxpbD1wdC5sZW5ndGg7aTxpbDtpKyspe3AwPXB0W2ktMV07cDE9cHRbaV07bGluZUludGVyc2VjdG9yLmNvbXB1dGVJbnRlcnNlY3Rpb24ocCxwMCxwMSk7aWYobGluZUludGVyc2VjdG9yLmhhc0ludGVyc2VjdGlvbigpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXPWZ1bmN0aW9uKHJpbmcpe3ZhciBuUHRzLGhpUHQsaGlJbmRleCxwLGlQcmV2LGlOZXh0LHByZXYsbmV4dCxpLGRpc2MsaXNDQ1c7blB0cz1yaW5nLmxlbmd0aC0xO2lmKG5QdHM8Myl7dGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1JpbmcgaGFzIGZld2VyIHRoYW4gMyBwb2ludHMsIHNvIG9yaWVudGF0aW9uIGNhbm5vdCBiZSBkZXRlcm1pbmVkJyk7fVxuaGlQdD1yaW5nWzBdO2hpSW5kZXg9MDtpPTE7Zm9yKGk7aTw9blB0cztpKyspe3A9cmluZ1tpXTtpZihwLnk+aGlQdC55KXtoaVB0PXA7aGlJbmRleD1pO319XG5pUHJldj1oaUluZGV4O2Rve2lQcmV2PWlQcmV2LTE7aWYoaVByZXY8MCl7aVByZXY9blB0czt9fXdoaWxlKHJpbmdbaVByZXZdLmVxdWFsczJEKGhpUHQpJiZpUHJldiE9PWhpSW5kZXgpO2lOZXh0PWhpSW5kZXg7ZG97aU5leHQ9KGlOZXh0KzEpJW5QdHM7fXdoaWxlKHJpbmdbaU5leHRdLmVxdWFsczJEKGhpUHQpJiZpTmV4dCE9PWhpSW5kZXgpO3ByZXY9cmluZ1tpUHJldl07bmV4dD1yaW5nW2lOZXh0XTtpZihwcmV2LmVxdWFsczJEKGhpUHQpfHxuZXh0LmVxdWFsczJEKGhpUHQpfHxwcmV2LmVxdWFsczJEKG5leHQpKXtyZXR1cm4gZmFsc2U7fVxuZGlzYz1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHByZXYsaGlQdCxuZXh0KTtpc0NDVz1mYWxzZTtpZihkaXNjPT09MCl7aXNDQ1c9KHByZXYueD5uZXh0LngpO31lbHNle2lzQ0NXPShkaXNjPjApO31cbnJldHVybiBpc0NDVzt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb249ZnVuY3Rpb24ocDEscDIscSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHAxLHAyLHEpO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lPWZ1bmN0aW9uKHAsQSxCKXtpZighKEEgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSkpe2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKEEueD09PUIueCYmQS55PT09Qi55KXtyZXR1cm4gcC5kaXN0YW5jZShBKTt9XG52YXIgcixzO3I9KChwLngtQS54KSooQi54LUEueCkrKHAueS1BLnkpKihCLnktQS55KSkvKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSk7aWYocjw9MC4wKXtyZXR1cm4gcC5kaXN0YW5jZShBKTt9XG5pZihyPj0xLjApe3JldHVybiBwLmRpc3RhbmNlKEIpO31cbnM9KChBLnktcC55KSooQi54LUEueCktKEEueC1wLngpKihCLnktQS55KSkvKChCLngtQS54KSooQi54LUEueCkrKEIueS1BLnkpKihCLnktQS55KSk7cmV0dXJuIE1hdGguYWJzKHMpKk1hdGguc3FydCgoKEIueC1BLngpKihCLngtQS54KSsoQi55LUEueSkqKEIueS1BLnkpKSk7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmVQZXJwZW5kaWN1bGFyPWZ1bmN0aW9uKHAsQSxCKXt2YXIgcz0oKEEueS1wLnkpKihCLngtQS54KS0oQS54LXAueCkqKEIueS1BLnkpKS8oKEIueC1BLngpKihCLngtQS54KSsoQi55LUEueSkqKEIueS1BLnkpKTtyZXR1cm4gTWF0aC5hYnMocykqTWF0aC5zcXJ0KCgoQi54LUEueCkqKEIueC1BLngpKyhCLnktQS55KSooQi55LUEueSkpKTt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZTI9ZnVuY3Rpb24ocCxsaW5lKXt2YXIgbWluRGlzdGFuY2UsaSxpbCxkaXN0O2lmKGxpbmUubGVuZ3RoPT09MCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0xpbmUgYXJyYXkgbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSB2ZXJ0ZXgnKTt9XG5taW5EaXN0YW5jZT1wLmRpc3RhbmNlKGxpbmVbMF0pO2ZvcihpPTAsaWw9bGluZS5sZW5ndGgtMTtpPGlsO2krKyl7ZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUocCxsaW5lW2ldLGxpbmVbaSsxXSk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDt9fVxucmV0dXJuIG1pbkRpc3RhbmNlO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlTGluZUxpbmU9ZnVuY3Rpb24oQSxCLEMsRCl7aWYoQS5lcXVhbHMoQikpe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQSxDLEQpO31cbmlmKEMuZXF1YWxzKEQpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEQsQSxCKTt9XG52YXIgcl90b3Ascl9ib3Qsc190b3Asc19ib3QscyxyO3JfdG9wPShBLnktQy55KSooRC54LUMueCktKEEueC1DLngpKihELnktQy55KTtyX2JvdD0oQi54LUEueCkqKEQueS1DLnkpLShCLnktQS55KSooRC54LUMueCk7c190b3A9KEEueS1DLnkpKihCLngtQS54KS0oQS54LUMueCkqKEIueS1BLnkpO3NfYm90PShCLngtQS54KSooRC55LUMueSktKEIueS1BLnkpKihELngtQy54KTtpZigocl9ib3Q9PT0wKXx8KHNfYm90PT09MCkpe3JldHVybiBNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQSxDLEQpLE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShCLEMsRCksTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEMsQSxCKSxqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoRCxBLEIpKSkpO31cbnM9c190b3Avc19ib3Q7cj1yX3RvcC9yX2JvdDtpZigocjwwKXx8KHI+MSl8fChzPDApfHwocz4xKSl7cmV0dXJuIE1hdGgubWluKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShBLEMsRCksTWF0aC5taW4oanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKEIsQyxEKSxNYXRoLm1pbihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoQyxBLEIpLGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShELEEsQikpKSk7fVxucmV0dXJuIDAuMDt9O2pzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5zaWduZWRBcmVhPWZ1bmN0aW9uKHJpbmcpe2lmKHJpbmcubGVuZ3RoPDMpe3JldHVybiAwLjA7fVxudmFyIHN1bSxpLGlsLGJ4LGJ5LGN4LGN5O3N1bT0wLjA7Zm9yKGk9MCxpbD1yaW5nLmxlbmd0aC0xO2k8aWw7aSsrKXtieD1yaW5nW2ldLng7Ynk9cmluZ1tpXS55O2N4PXJpbmdbaSsxXS54O2N5PXJpbmdbaSsxXS55O3N1bSs9KGJ4K2N4KSooY3ktYnkpO31cbnJldHVybi1zdW0vMi4wO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLnNpZ25lZEFyZWE9ZnVuY3Rpb24ocmluZyl7dmFyIG4sc3VtLHAsYngsYnksaSxjeCxjeTtuPXJpbmcubGVuZ3RoO2lmKG48Myl7cmV0dXJuIDAuMDt9XG5zdW09MC4wO3A9cmluZ1swXTtieD1wLng7Ynk9cC55O2ZvcihpPTE7aTxuO2krKyl7cD1yaW5nW2ldO2N4PXAueDtjeT1wLnk7c3VtKz0oYngrY3gpKihjeS1ieSk7Yng9Y3g7Ynk9Y3k7fVxucmV0dXJuLXN1bS8yLjA7fTtqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZUxlbmd0aD1mdW5jdGlvbihwdHMpe3ZhciBuPXB0cy5sZW5ndGgsbGVuLHgwLHkwLHgxLHkxLGR4LGR5LHAsaSxpbDtpZihuPD0xKXtyZXR1cm4gMC4wO31cbmxlbj0wLjA7cD1wdHNbMF07eDA9cC54O3kwPXAueTtpPTEsaWw9bjtmb3IoaTtpPG47aSsrKXtwPXB0c1tpXTt4MT1wLng7eTE9cC55O2R4PXgxLXgwO2R5PXkxLXkwO2xlbis9TWF0aC5zcXJ0KGR4KmR4K2R5KmR5KTt4MD14MTt5MD15MTt9XG5yZXR1cm4gbGVuO307anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxlbmd0aD1mdW5jdGlvbigpe307anN0cy5hbGdvcml0aG0uQW5nbGU9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI9Mi4wKk1hdGguUEk7anN0cy5hbGdvcml0aG0uQW5nbGUuUElfT1ZFUl8yPU1hdGguUEkvMi4wO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX09WRVJfND1NYXRoLlBJLzQuMDtqc3RzLmFsZ29yaXRobS5BbmdsZS5DT1VOVEVSQ0xPQ0tXSVNFPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLkNMT0NLV0lTRT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFO2pzdHMuYWxnb3JpdGhtLkFuZ2xlLk5PTkU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPTExJTkVBUjtqc3RzLmFsZ29yaXRobS5BbmdsZS50b0RlZ3JlZXM9ZnVuY3Rpb24ocmFkaWFucyl7cmV0dXJuKHJhZGlhbnMqMTgwKS9NYXRoLlBJO307anN0cy5hbGdvcml0aG0uQW5nbGUudG9SYWRpYW5zPWZ1bmN0aW9uKGFuZ2xlRGVncmVlcyl7cmV0dXJuKGFuZ2xlRGVncmVlcypNYXRoLlBJKS8xODAuMDt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUZyb21Pcmlnbyhhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW5Db29yZHMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuQ29vcmRzPWZ1bmN0aW9uKHAwLHAxKXt2YXIgZHgsZHk7ZHg9cDEueC1wMC54O2R5PXAxLnktcDAueTtyZXR1cm4gTWF0aC5hdGFuMihkeSxkeCk7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUZyb21Pcmlnbz1mdW5jdGlvbihwKXtyZXR1cm4gTWF0aC5hdGFuMihwLnkscC54KTt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGU9ZnVuY3Rpb24ocDAscDEscDIpe3ZhciBkeDAsZHkwLGR4MSxkeTEsZG90cHJvZDtkeDA9cDAueC1wMS54O2R5MD1wMC55LXAxLnk7ZHgxPXAyLngtcDEueDtkeTE9cDIueS1wMS55O2RvdHByb2Q9ZHgwKmR4MStkeTAqZHkxO3JldHVybiBkb3Rwcm9kPjA7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZT1mdW5jdGlvbihwMCxwMSxwMil7dmFyIGR4MCxkeTAsZHgxLGR5MSxkb3Rwcm9kO2R4MD1wMC54LXAxLng7ZHkwPXAwLnktcDEueTtkeDE9cDIueC1wMS54O2R5MT1wMi55LXAxLnk7ZG90cHJvZD1keDAqZHgxK2R5MCpkeTE7cmV0dXJuIGRvdHByb2Q8MDt9O2pzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2Vlbj1mdW5jdGlvbih0aXAxLHRhaWwsdGlwMil7dmFyIGExLGEyO2ExPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHRhaWwsdGlwMSk7YTI9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUodGFpbCx0aXAyKTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQW5nbGUuZGlmZihhMSxhMik7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZUJldHdlZW5PcmllbnRlZD1mdW5jdGlvbih0aXAxLHRhaWwsdGlwMil7dmFyIGExLGEyLGFuZ0RlbDthMT1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZSh0YWlsLHRpcDEpO2EyPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKHRhaWwsdGlwMik7YW5nRGVsPWEyLWExO2lmKGFuZ0RlbDw9LU1hdGguUEkpe3JldHVybiBhbmdEZWwranN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5pZihhbmdEZWw+TWF0aC5QSSl7cmV0dXJuIGFuZ0RlbC1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yO31cbnJldHVybiBhbmdEZWw7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5pbnRlcmlvckFuZ2xlPWZ1bmN0aW9uKHAwLHAxLHAyKXt2YXIgYW5nbGVQcmV2LGFuZ2xlTmV4dDthbmdsZVByZXY9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGUocDEscDApO2FuZ2xlTmV4dD1qc3RzLmFsZ29yaXRobS5BbmdsZS5hbmdsZShwMSxwMik7cmV0dXJuIE1hdGguYWJzKGFuZ2xlTmV4dC1hbmdsZVByZXYpO307anN0cy5hbGdvcml0aG0uQW5nbGUuZ2V0VHVybj1mdW5jdGlvbihhbmcxLGFuZzIpe3ZhciBjcm9zc3Byb2R1Y3Q9TWF0aC5zaW4oYW5nMi1hbmcxKTtpZihjcm9zc3Byb2R1Y3Q+MCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkFuZ2xlLkNPVU5URVJDTE9DS1dJU0U7fVxuaWYoY3Jvc3Nwcm9kdWN0PDApe3JldHVybiBqc3RzLmFsZ29yaXRobS5BbmdsZS5DTE9DS1dJU0U7fVxucmV0dXJuIGpzdHMuYWxnb3JpdGhtLkFuZ2xlLk5PTkU7fTtqc3RzLmFsZ29yaXRobS5BbmdsZS5ub3JtYWxpemU9ZnVuY3Rpb24oYW5nbGUpe3doaWxlKGFuZ2xlPk1hdGguUEkpe2FuZ2xlLT1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yO31cbndoaWxlKGFuZ2xlPD0tTWF0aC5QSSl7YW5nbGUrPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLlBJX1RJTUVTXzI7fVxucmV0dXJuIGFuZ2xlO307anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplUG9zaXRpdmU9ZnVuY3Rpb24oYW5nbGUpe2lmKGFuZ2xlPDAuMCl7d2hpbGUoYW5nbGU8MC4wKXthbmdsZSs9anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5pZihhbmdsZT49anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMil7YW5nbGU9MC4wO319XG5lbHNle3doaWxlKGFuZ2xlPj1qc3RzLmFsZ29yaXRobS5BbmdsZS5QSV9USU1FU18yKXthbmdsZS09anN0cy5hbGdvcml0aG0uQW5nbGUuUElfVElNRVNfMjt9XG5pZihhbmdsZTwwLjApe2FuZ2xlPTAuMDt9fVxucmV0dXJuIGFuZ2xlO307anN0cy5hbGdvcml0aG0uQW5nbGUuZGlmZj1mdW5jdGlvbihhbmcxLGFuZzIpe3ZhciBkZWxBbmdsZTtpZihhbmcxPGFuZzIpe2RlbEFuZ2xlPWFuZzItYW5nMTt9ZWxzZXtkZWxBbmdsZT1hbmcxLWFuZzI7fVxuaWYoZGVsQW5nbGU+TWF0aC5QSSl7ZGVsQW5nbGU9KDIqTWF0aC5QSSktZGVsQW5nbGU7fVxucmV0dXJuIGRlbEFuZ2xlO307anN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyPWZ1bmN0aW9uKGxpbmVzLGlzRm9yY2VkVG9MaW5lU3RyaW5nKXt0aGlzLmxpbmVzPWxpbmVzO3RoaXMuaXNGb3JjZWRUb0xpbmVTdHJpbmc9aXNGb3JjZWRUb0xpbmVTdHJpbmc7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIoKTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIucHJvdG90eXBlLmxpbmVzPW51bGw7anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZS5pc0ZvcmNlZFRvTGluZVN0cmluZz1mYWxzZTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM9ZnVuY3Rpb24oZ2VvbXMsbGluZXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM1LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PTImJnR5cGVvZiBsaW5lcz09PSdib29sZWFuJyl7cmV0dXJuIGpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczYuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09MiYmZ2VvbXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnkpe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PTMmJmdlb21zIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT0zKXtyZXR1cm4ganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuZm9yKHZhciBpPTA7aTxnZW9tcy5sZW5ndGg7aSsrKXt2YXIgZz1nZW9tc1tpXTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMzKGcsbGluZXMpO31cbnJldHVybiBsaW5lczt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lczI9ZnVuY3Rpb24oZ2VvbXMsbGluZXMsZm9yY2VUb0xpbmVTdHJpbmcpe2Zvcih2YXIgaT0wO2k8Z2VvbXMubGVuZ3RoO2krKyl7dmFyIGc9Z2VvbXNbaV07anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNChnLGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKTt9XG5yZXR1cm4gbGluZXM7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXMzPWZ1bmN0aW9uKGdlb20sbGluZXMpe2lmKGdlb20gaW5zdGFuY2VvZiBMaW5lU3RyaW5nKXtsaW5lcy5hZGQoZ2VvbSk7fWVsc2V7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyKGxpbmVzKSk7fVxucmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzND1mdW5jdGlvbihnZW9tLGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKXtnZW9tLmFwcGx5KG5ldyBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIobGluZXMsZm9yY2VUb0xpbmVTdHJpbmcpKTtyZXR1cm4gbGluZXM7fTtqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM1PWZ1bmN0aW9uKGdlb20pe3JldHVybiBqc3RzLmdlb20udXRpbC5MaW5lYXJDb21wb25lbnRFeHRyYWN0ZXIuZ2V0TGluZXM2KGdlb20sZmFsc2UpO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzNj1mdW5jdGlvbihnZW9tLGZvcmNlVG9MaW5lU3RyaW5nKXt2YXIgbGluZXM9W107Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyKGxpbmVzLGZvcmNlVG9MaW5lU3RyaW5nKSk7cmV0dXJuIGxpbmVzO307anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLnByb3RvdHlwZS5zZXRGb3JjZVRvTGluZVN0cmluZz1mdW5jdGlvbihpc0ZvcmNlZFRvTGluZVN0cmluZyl7dGhpcy5pc0ZvcmNlZFRvTGluZVN0cmluZz1pc0ZvcmNlZFRvTGluZVN0cmluZzt9O2pzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKHRoaXMuaXNGb3JjZWRUb0xpbmVTdHJpbmcmJmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZyl7dmFyIGxpbmU9Z2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlTGluZVN0cmluZyhnZW9tLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpKTt0aGlzLmxpbmVzLnB1c2gobGluZSk7cmV0dXJuO31cbmlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKVxudGhpcy5saW5lcy5wdXNoKGdlb20pO307anN0cy5nZW9tLkxvY2F0aW9uPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I9MDtqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk9MTtqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I9Mjtqc3RzLmdlb20uTG9jYXRpb24uTk9ORT0tMTtqc3RzLmdlb20uTG9jYXRpb24udG9Mb2NhdGlvblN5bWJvbD1mdW5jdGlvbihsb2NhdGlvblZhbHVlKXtzd2l0Y2gobG9jYXRpb25WYWx1ZSl7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I6cmV0dXJuJ2UnO2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZOnJldHVybidiJztjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjpyZXR1cm4naSc7Y2FzZSBqc3RzLmdlb20uTG9jYXRpb24uTk9ORTpyZXR1cm4nLSc7fVxudGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1Vua25vd24gbG9jYXRpb24gdmFsdWU6ICcrXG5sb2NhdGlvblZhbHVlKTt9OyhmdW5jdGlvbigpe2pzdHMuaW8uR2VvSlNPTlJlYWRlcj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeXx8bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt0aGlzLnByZWNpc2lvbk1vZGVsPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmdldFByZWNpc2lvbk1vZGVsKCk7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uR2VvSlNPTlBhcnNlcih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLmlvLkdlb0pTT05SZWFkZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24oZ2VvSnNvbil7dmFyIGdlb21ldHJ5PXRoaXMucGFyc2VyLnJlYWQoZ2VvSnNvbik7aWYodGhpcy5wcmVjaXNpb25Nb2RlbC5nZXRUeXBlKCk9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRklYRUQpe3RoaXMucmVkdWNlUHJlY2lzaW9uKGdlb21ldHJ5KTt9XG5yZXR1cm4gZ2VvbWV0cnk7fTtqc3RzLmlvLkdlb0pTT05SZWFkZXIucHJvdG90eXBlLnJlZHVjZVByZWNpc2lvbj1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIGksbGVuO2lmKGdlb21ldHJ5LmNvb3JkaW5hdGUpe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkuY29vcmRpbmF0ZSk7fWVsc2UgaWYoZ2VvbWV0cnkucG9pbnRzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5wcmVjaXNpb25Nb2RlbC5tYWtlUHJlY2lzZShnZW9tZXRyeS5wb2ludHNbaV0pO319ZWxzZSBpZihnZW9tZXRyeS5nZW9tZXRyaWVzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucmVkdWNlUHJlY2lzaW9uKGdlb21ldHJ5Lmdlb21ldHJpZXNbaV0pO319fTt9KSgpO2pzdHMuZ2VvbS5HZW9tZXRyeT1mdW5jdGlvbihmYWN0b3J5KXt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZW52ZWxvcGU9bnVsbDtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmZhY3Rvcnk9bnVsbDtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidHZW9tZXRyeSc7fTtqc3RzLmdlb20uR2VvbWV0cnkuaGFzTm9uRW1wdHlFbGVtZW50cz1mdW5jdGlvbihnZW9tZXRyaWVzKXt2YXIgaTtmb3IoaT0wO2k8Z2VvbWV0cmllcy5sZW5ndGg7aSsrKXtpZighZ2VvbWV0cmllc1tpXS5pc0VtcHR5KCkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uR2VvbWV0cnkuaGFzTnVsbEVsZW1lbnRzPWZ1bmN0aW9uKGFycmF5KXt2YXIgaTtmb3IoaT0wO2k8YXJyYXkubGVuZ3RoO2krKyl7aWYoYXJyYXlbaV09PT1udWxsKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRGYWN0b3J5PWZ1bmN0aW9uKCl7aWYodGhpcy5mYWN0b3J5PT09bnVsbHx8dGhpcy5mYWN0b3J5PT09dW5kZWZpbmVkKXt0aGlzLmZhY3Rvcnk9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTt9XG5yZXR1cm4gdGhpcy5mYWN0b3J5O307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXROdW1HZW9tZXRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIDE7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEdlb21ldHJ5Tj1mdW5jdGlvbihuKXtyZXR1cm4gdGhpczt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuZ2V0UHJlY2lzaW9uTW9kZWwoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNTaW1wbGU9ZnVuY3Rpb24oKXt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpO3ZhciBvcD1uZXcganN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcCh0aGlzKTtyZXR1cm4gb3AuaXNTaW1wbGUoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3ZhciBpc1ZhbGlkT3A9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcCh0aGlzKTtyZXR1cm4gaXNWYWxpZE9wLmlzVmFsaWQoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKGcpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLmRpc3RhbmNlKHRoaXMsZyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzV2l0aGluRGlzdGFuY2U9ZnVuY3Rpb24oZ2VvbSxkaXN0YW5jZSl7dmFyIGVudkRpc3Q9dGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuZGlzdGFuY2UoZ2VvbS5nZXRFbnZlbG9wZUludGVybmFsKCkpO2lmKGVudkRpc3Q+ZGlzdGFuY2Upe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gRGlzdGFuY2VPcC5pc1dpdGhpbkRpc3RhbmNlKHRoaXMsZ2VvbSxkaXN0YW5jZSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzUmVjdGFuZ2xlPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRBcmVhPWZ1bmN0aW9uKCl7cmV0dXJuIDAuMDt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7cmV0dXJuIDAuMDt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG51bGw7fVxudmFyIGNlbnQ7dmFyIGNlbnRQdD1udWxsO3ZhciBkaW09dGhpcy5nZXREaW1lbnNpb24oKTtpZihkaW09PT0wKXtjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50KCk7Y2VudC5hZGQodGhpcyk7Y2VudFB0PWNlbnQuZ2V0Q2VudHJvaWQoKTt9ZWxzZSBpZihkaW09PT0xKXtjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZExpbmUoKTtjZW50LmFkZCh0aGlzKTtjZW50UHQ9Y2VudC5nZXRDZW50cm9pZCgpO31lbHNle2NlbnQ9bmV3IGpzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYSgpO2NlbnQuYWRkKHRoaXMpO2NlbnRQdD1jZW50LmdldENlbnRyb2lkKCk7fVxucmV0dXJuIHRoaXMuY3JlYXRlUG9pbnRGcm9tSW50ZXJuYWxDb29yZChjZW50UHQsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXt2YXIgaW50UHQ7dmFyIGludGVyaW9yUHQ9bnVsbDt2YXIgZGltPXRoaXMuZ2V0RGltZW5zaW9uKCk7aWYoZGltPT09MCl7aW50UHQ9bmV3IGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludCh0aGlzKTtpbnRlcmlvclB0PWludFB0LmdldEludGVyaW9yUG9pbnQoKTt9ZWxzZSBpZihkaW09PT0xKXtpbnRQdD1uZXcganN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludExpbmUodGhpcyk7aW50ZXJpb3JQdD1pbnRQdC5nZXRJbnRlcmlvclBvaW50KCk7fWVsc2V7aW50UHQ9bmV3IGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhKHRoaXMpO2ludGVyaW9yUHQ9aW50UHQuZ2V0SW50ZXJpb3JQb2ludCgpO31cbnJldHVybiB0aGlzLmNyZWF0ZVBvaW50RnJvbUludGVybmFsQ29vcmQoaW50ZXJpb3JQdCx0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0RGltZW5zaW9uPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLnRvR2VvbWV0cnkodGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5nZXRFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7aWYodGhpcy5lbnZlbG9wZT09PW51bGwpe3RoaXMuZW52ZWxvcGU9dGhpcy5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbCgpO31cbnJldHVybiB0aGlzLmVudmVsb3BlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5kaXNqb2ludD1mdW5jdGlvbihnKXtyZXR1cm4hdGhpcy5pbnRlcnNlY3RzKGcpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS50b3VjaGVzPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc1RvdWNoZXModGhpcy5nZXREaW1lbnNpb24oKSxnLmdldERpbWVuc2lvbigpKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzUmVjdGFuZ2xlKCkpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5pbnRlcnNlY3RzKHRoaXMsZyk7fVxuaWYoZy5pc1JlY3RhbmdsZSgpKXtyZXR1cm4ganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMuaW50ZXJzZWN0cyhnLHRoaXMpO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc0ludGVyc2VjdHMoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY3Jvc3Nlcz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNDcm9zc2VzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLndpdGhpbj1mdW5jdGlvbihnKXtyZXR1cm4gZy5jb250YWlucyh0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmNvbnRhaW5zKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNSZWN0YW5nbGUoKSl7cmV0dXJuIGpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5jb250YWlucyh0aGlzLGcpO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc0NvbnRhaW5zKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLm92ZXJsYXBzPWZ1bmN0aW9uKGcpe2lmKCF0aGlzLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0aGlzLnJlbGF0ZShnKS5pc092ZXJsYXBzKHRoaXMuZ2V0RGltZW5zaW9uKCksZy5nZXREaW1lbnNpb24oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvdmVycz1mdW5jdGlvbihnKXtpZighdGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCkuY292ZXJzKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNSZWN0YW5nbGUoKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIHRoaXMucmVsYXRlKGcpLmlzQ292ZXJzKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvdmVyZWRCeT1mdW5jdGlvbihnKXtyZXR1cm4gZy5jb3ZlcnModGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLnJlbGF0ZT1mdW5jdGlvbihnLGludGVyc2VjdGlvblBhdHRlcm4pe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5yZWxhdGUyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUyKGcpLm1hdGNoZXMoaW50ZXJzZWN0aW9uUGF0dGVybik7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLnJlbGF0ZTI9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKGcpO3JldHVybiBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucmVsYXRlKHRoaXMsZyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsc1RvcG89ZnVuY3Rpb24oZyl7aWYoIXRoaXMuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmVxdWFscyhnLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5yZWxhdGUoZykuaXNFcXVhbHModGhpcy5nZXREaW1lbnNpb24oKSxnLmdldERpbWVuc2lvbigpKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG8pe2lmKG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnl8fG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZ3x8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29ufHxvIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxvIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8byBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3JldHVybiB0aGlzLmVxdWFsc0V4YWN0KG8pO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuYnVmZmVyPWZ1bmN0aW9uKGRpc3RhbmNlLHF1YWRyYW50U2VnbWVudHMsZW5kQ2FwU3R5bGUpe3ZhciBwYXJhbXM9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzKHF1YWRyYW50U2VnbWVudHMsZW5kQ2FwU3R5bGUpXG5yZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMih0aGlzLGRpc3RhbmNlLHBhcmFtcyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbnZleEh1bGw9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwodGhpcykuZ2V0Q29udmV4SHVsbCgpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5pZih0aGlzLmlzR2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpKXt2YXIgZzI9b3RoZXI7fVxudGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKG90aGVyKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AodGhpcyxvdGhlcixqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT04pO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbihvdGhlcil7aWYoYXJndW1lbnRzLmxlbmd0aD09PTApe3JldHVybiBqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AudW5pb24odGhpcyk7fVxuaWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBvdGhlci5jbG9uZSgpO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuY2xvbmUoKTt9XG50aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKHRoaXMpO3RoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24ob3RoZXIpO3JldHVybiBqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcElmTmVlZGVkT3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLG90aGVyLGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZGlmZmVyZW5jZT1mdW5jdGlvbihvdGhlcil7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYob3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5jbG9uZSgpO31cbnRoaXMuY2hlY2tOb3RHZW9tZXRyeUNvbGxlY3Rpb24odGhpcyk7dGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbihvdGhlcik7cmV0dXJuIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMsb3RoZXIsanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLnN5bURpZmZlcmVuY2U9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gb3RoZXIuY2xvbmUoKTt9XG5pZihvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmNsb25lKCk7fVxudGhpcy5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbih0aGlzKTt0aGlzLmNoZWNrTm90R2VvbWV0cnlDb2xsZWN0aW9uKG90aGVyKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AodGhpcyxvdGhlcixqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5lcXVhbHNOb3JtPWZ1bmN0aW9uKGcpe2lmKGc9PT1udWxsfHxnPT09dW5kZWZpbmVkKVxucmV0dXJuIGZhbHNlO3JldHVybiB0aGlzLm5vcm0oKS5lcXVhbHNFeGFjdChnLm5vcm0oKSk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5ub3JtPWZ1bmN0aW9uKCl7dmFyIGNvcHk9dGhpcy5jbG9uZSgpO2NvcHkubm9ybWFsaXplKCk7cmV0dXJuIGNvcHk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvKXt2YXIgb3RoZXI9bztpZih0aGlzLmdldENsYXNzU29ydEluZGV4KCkhPT1vdGhlci5nZXRDbGFzc1NvcnRJbmRleCgpKXtyZXR1cm4gdGhpcy5nZXRDbGFzc1NvcnRJbmRleCgpLW90aGVyLmdldENsYXNzU29ydEluZGV4KCk7fVxuaWYodGhpcy5pc0VtcHR5KCkmJm90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIDA7fVxuaWYodGhpcy5pc0VtcHR5KCkpe3JldHVybi0xO31cbmlmKG90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIDE7fVxucmV0dXJuIHRoaXMuY29tcGFyZVRvU2FtZUNsYXNzKG8pO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5pc0VxdWl2YWxlbnRDbGFzcz1mdW5jdGlvbihvdGhlcil7aWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCYmb3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8b3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZykpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZyYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8b3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZykpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbiYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KSl7cmV0dXJuIHRydWU7fWVsc2UgaWYodGhpcyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcmJihvdGhlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpKXtyZXR1cm4gdHJ1ZTt9ZWxzZSBpZih0aGlzIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbiYmKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbikpe3JldHVybiB0cnVlO31lbHNlIGlmKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJiYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS5jaGVja05vdEdlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbihnKXtpZihnLmlzR2VvbWV0cnlDb2xsZWN0aW9uQmFzZSgpKXt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignVGhpcyBtZXRob2QgZG9lcyBub3Qgc3VwcG9ydCBHZW9tZXRyeUNvbGxlY3Rpb24nKTt9fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmlzR2VvbWV0cnlDb2xsZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuaXNHZW9tZXRyeUNvbGxlY3Rpb25CYXNlPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uJyk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmNvbXBhcmU9ZnVuY3Rpb24oYSxiKXt2YXIgaT1hLml0ZXJhdG9yKCk7dmFyIGo9Yi5pdGVyYXRvcigpO3doaWxlKGkuaGFzTmV4dCgpJiZqLmhhc05leHQoKSl7dmFyIGFFbGVtZW50PWkubmV4dCgpO3ZhciBiRWxlbWVudD1qLm5leHQoKTt2YXIgY29tcGFyaXNvbj1hRWxlbWVudC5jb21wYXJlVG8oYkVsZW1lbnQpO2lmKGNvbXBhcmlzb24hPT0wKXtyZXR1cm4gY29tcGFyaXNvbjt9fVxuaWYoaS5oYXNOZXh0KCkpe3JldHVybiAxO31cbmlmKGouaGFzTmV4dCgpKXtyZXR1cm4tMTt9XG5yZXR1cm4gMDt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZXF1YWw9ZnVuY3Rpb24oYSxiLHRvbGVyYW5jZSl7aWYodG9sZXJhbmNlPT09dW5kZWZpbmVkfHx0b2xlcmFuY2U9PT1udWxsfHx0b2xlcmFuY2U9PT0wKXtyZXR1cm4gYS5lcXVhbHMoYik7fVxucmV0dXJuIGEuZGlzdGFuY2UoYik8PXRvbGVyYW5jZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuZ2V0Q2xhc3NTb3J0SW5kZXg9ZnVuY3Rpb24oKXt2YXIgc29ydGVkQ2xhc3Nlcz1banN0cy5nZW9tLlBvaW50LGpzdHMuZ2VvbS5NdWx0aVBvaW50LGpzdHMuZ2VvbS5MaW5lU3RyaW5nLGpzdHMuZ2VvbS5MaW5lYXJSaW5nLGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcsanN0cy5nZW9tLlBvbHlnb24sanN0cy5nZW9tLk11bHRpUG9seWdvbixqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uXTtmb3IodmFyIGk9MDtpPHNvcnRlZENsYXNzZXMubGVuZ3RoO2krKyl7aWYodGhpcyBpbnN0YW5jZW9mIHNvcnRlZENsYXNzZXNbaV0pXG5yZXR1cm4gaTt9XG5qc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCdDbGFzcyBub3Qgc3VwcG9ydGVkOiAnK3RoaXMpO3JldHVybi0xO307anN0cy5nZW9tLkdlb21ldHJ5LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5pby5XS1RXcml0ZXIoKS53cml0ZSh0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeS5wcm90b3R5cGUuY3JlYXRlUG9pbnRGcm9tSW50ZXJuYWxDb29yZD1mdW5jdGlvbihjb29yZCxleGVtcGxhcil7ZXhlbXBsYXIuZ2V0UHJlY2lzaW9uTW9kZWwoKS5tYWtlUHJlY2lzZShjb29yZCk7cmV0dXJuIGV4ZW1wbGFyLmdldEZhY3RvcnkoKS5jcmVhdGVQb2ludChjb29yZCk7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb20uQ29vcmRpbmF0ZT1mdW5jdGlvbih4LHkpe2lmKHR5cGVvZiB4PT09J251bWJlcicpe3RoaXMueD14O3RoaXMueT15O31lbHNlIGlmKHggaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy54PXBhcnNlRmxvYXQoeC54KTt0aGlzLnk9cGFyc2VGbG9hdCh4LnkpO31lbHNlIGlmKHg9PT11bmRlZmluZWR8fHg9PT1udWxsKXt0aGlzLng9MDt0aGlzLnk9MDt9ZWxzZSBpZih0eXBlb2YgeD09PSdzdHJpbmcnKXt0aGlzLng9cGFyc2VGbG9hdCh4KTt0aGlzLnk9cGFyc2VGbG9hdCh5KTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZS5wcm90b3R5cGUuc2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihvdGhlcil7dGhpcy54PW90aGVyLng7dGhpcy55PW90aGVyLnk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMueCx0aGlzLnkpO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKHApe3ZhciBkeD10aGlzLngtcC54O3ZhciBkeT10aGlzLnktcC55O3JldHVybiBNYXRoLnNxcnQoZHgqZHgrZHkqZHkpO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmVxdWFsczJEPWZ1bmN0aW9uKG90aGVyKXtpZih0aGlzLnghPT1vdGhlci54KXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy55IT09b3RoZXIueSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvdGhlcil7aWYoIW90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGV8fG90aGVyPT09dW5kZWZpbmVkKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMuZXF1YWxzMkQob3RoZXIpO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvdGhlcil7aWYodGhpcy54PG90aGVyLngpe3JldHVybi0xO31cbmlmKHRoaXMueD5vdGhlci54KXtyZXR1cm4gMTt9XG5pZih0aGlzLnk8b3RoZXIueSl7cmV0dXJuLTE7fVxuaWYodGhpcy55Pm90aGVyLnkpe3JldHVybiAxO31cbnJldHVybiAwO307anN0cy5nZW9tLkNvb3JkaW5hdGUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJygnK3RoaXMueCsnLCAnK3RoaXMueSsnKSc7fTt9KSgpO2pzdHMuZ2VvbS5FbnZlbG9wZT1mdW5jdGlvbigpe2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1pbng9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1heHg9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1pbnk9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLm1heHk9bnVsbDtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24oKXtpZih0eXBlb2YgYXJndW1lbnRzWzBdPT09J251bWJlcicmJmFyZ3VtZW50cy5sZW5ndGg9PT00KXt0aGlzLmluaXRGcm9tVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdLGFyZ3VtZW50c1szXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSYmYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuaW5pdEZyb21Db29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSYmYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuaW5pdEZyb21Db29yZGluYXRlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSYmYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuaW5pdEZyb21FbnZlbG9wZShhcmd1bWVudHNbMF0pO31lbHNle3RoaXMuc2V0VG9OdWxsKCk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbml0RnJvbVZhbHVlcz1mdW5jdGlvbih4MSx4Mix5MSx5Mil7aWYoeDE8eDIpe3RoaXMubWlueD14MTt0aGlzLm1heHg9eDI7fWVsc2V7dGhpcy5taW54PXgyO3RoaXMubWF4eD14MTt9XG5pZih5MTx5Mil7dGhpcy5taW55PXkxO3RoaXMubWF4eT15Mjt9ZWxzZXt0aGlzLm1pbnk9eTI7dGhpcy5tYXh5PXkxO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21Db29yZGluYXRlcz1mdW5jdGlvbihwMSxwMil7dGhpcy5pbml0RnJvbVZhbHVlcyhwMS54LHAyLngscDEueSxwMi55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21Db29yZGluYXRlPWZ1bmN0aW9uKHApe3RoaXMuaW5pdEZyb21WYWx1ZXMocC54LHAueCxwLnkscC55KTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW5pdEZyb21FbnZlbG9wZT1mdW5jdGlvbihlbnYpe3RoaXMubWlueD1lbnYubWlueDt0aGlzLm1heHg9ZW52Lm1heHg7dGhpcy5taW55PWVudi5taW55O3RoaXMubWF4eT1lbnYubWF4eTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuc2V0VG9OdWxsPWZ1bmN0aW9uKCl7dGhpcy5taW54PTA7dGhpcy5tYXh4PS0xO3RoaXMubWlueT0wO3RoaXMubWF4eT0tMTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4eDx0aGlzLm1pbng7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldEhlaWdodD1mdW5jdGlvbigpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiAwO31cbnJldHVybiB0aGlzLm1heHktdGhpcy5taW55O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRXaWR0aD1mdW5jdGlvbigpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiAwO31cbnJldHVybiB0aGlzLm1heHgtdGhpcy5taW54O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRNaW5YPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWlueDt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0TWF4WD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heHg7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmdldE1pblk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW55O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5nZXRNYXhZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4eTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZ2V0QXJlYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFdpZHRoKCkqdGhpcy5nZXRIZWlnaHQoKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5leHBhbmRUb0luY2x1ZGVDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uRW52ZWxvcGUpe3RoaXMuZXhwYW5kVG9JbmNsdWRlRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZXt0aGlzLmV4cGFuZFRvSW5jbHVkZVZhbHVlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7dGhpcy5leHBhbmRUb0luY2x1ZGVWYWx1ZXMocC54LHAueSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZFRvSW5jbHVkZVZhbHVlcz1mdW5jdGlvbih4LHkpe2lmKHRoaXMuaXNOdWxsKCkpe3RoaXMubWlueD14O3RoaXMubWF4eD14O3RoaXMubWlueT15O3RoaXMubWF4eT15O31lbHNle2lmKHg8dGhpcy5taW54KXt0aGlzLm1pbng9eDt9XG5pZih4PnRoaXMubWF4eCl7dGhpcy5tYXh4PXg7fVxuaWYoeTx0aGlzLm1pbnkpe3RoaXMubWlueT15O31cbmlmKHk+dGhpcy5tYXh5KXt0aGlzLm1heHk9eTt9fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGVFbnZlbG9wZT1mdW5jdGlvbihvdGhlcil7aWYob3RoZXIuaXNOdWxsKCkpe3JldHVybjt9XG5pZih0aGlzLmlzTnVsbCgpKXt0aGlzLm1pbng9b3RoZXIuZ2V0TWluWCgpO3RoaXMubWF4eD1vdGhlci5nZXRNYXhYKCk7dGhpcy5taW55PW90aGVyLmdldE1pblkoKTt0aGlzLm1heHk9b3RoZXIuZ2V0TWF4WSgpO31lbHNle2lmKG90aGVyLm1pbng8dGhpcy5taW54KXt0aGlzLm1pbng9b3RoZXIubWlueDt9XG5pZihvdGhlci5tYXh4PnRoaXMubWF4eCl7dGhpcy5tYXh4PW90aGVyLm1heHg7fVxuaWYob3RoZXIubWlueTx0aGlzLm1pbnkpe3RoaXMubWlueT1vdGhlci5taW55O31cbmlmKG90aGVyLm1heHk+dGhpcy5tYXh5KXt0aGlzLm1heHk9b3RoZXIubWF4eTt9fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5leHBhbmRCeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmV4cGFuZEJ5RGlzdGFuY2UoYXJndW1lbnRzWzBdKTt9ZWxzZXt0aGlzLmV4cGFuZEJ5RGlzdGFuY2VzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuZXhwYW5kQnlEaXN0YW5jZT1mdW5jdGlvbihkaXN0YW5jZSl7dGhpcy5leHBhbmRCeURpc3RhbmNlcyhkaXN0YW5jZSxkaXN0YW5jZSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmV4cGFuZEJ5RGlzdGFuY2VzPWZ1bmN0aW9uKGRlbHRhWCxkZWx0YVkpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybjt9XG50aGlzLm1pbngtPWRlbHRhWDt0aGlzLm1heHgrPWRlbHRhWDt0aGlzLm1pbnktPWRlbHRhWTt0aGlzLm1heHkrPWRlbHRhWTtpZih0aGlzLm1pbng+dGhpcy5tYXh4fHx0aGlzLm1pbnk+dGhpcy5tYXh5KXt0aGlzLnNldFRvTnVsbCgpO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUudHJhbnNsYXRlPWZ1bmN0aW9uKHRyYW5zWCx0cmFuc1kpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybjt9XG50aGlzLmluaXQodGhpcy5taW54K3RyYW5zWCx0aGlzLm1heHgrdHJhbnNYLHRoaXMubWlueSt0cmFuc1ksdGhpcy5tYXh5K3RyYW5zWSk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNlbnRyZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBudWxsO31cbnJldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKHRoaXMubWlueCt0aGlzLm1heHgpLzIuMCwodGhpcy5taW55K3RoaXMubWF4eSkvMi4wKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGVudil7aWYodGhpcy5pc051bGwoKXx8ZW52LmlzTnVsbCgpfHwhdGhpcy5pbnRlcnNlY3RzKGVudikpe3JldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKCk7fVxudmFyIGludE1pblg9dGhpcy5taW54PmVudi5taW54P3RoaXMubWlueDplbnYubWlueDt2YXIgaW50TWluWT10aGlzLm1pbnk+ZW52Lm1pbnk/dGhpcy5taW55OmVudi5taW55O3ZhciBpbnRNYXhYPXRoaXMubWF4eDxlbnYubWF4eD90aGlzLm1heHg6ZW52Lm1heHg7dmFyIGludE1heFk9dGhpcy5tYXh5PGVudi5tYXh5P3RoaXMubWF4eTplbnYubWF4eTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShpbnRNaW5YLGludE1heFgsaW50TWluWSxpbnRNYXhZKTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkVudmVsb3BlKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmludGVyc2VjdHNWYWx1ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbnRlcnNlY3RzRW52ZWxvcGU9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNOdWxsKCl8fG90aGVyLmlzTnVsbCgpKXtyZXR1cm4gZmFsc2U7fVxudmFyIHJlc3VsdD0hKG90aGVyLm1pbng+dGhpcy5tYXh4fHxvdGhlci5tYXh4PHRoaXMubWlueHx8b3RoZXIubWlueT50aGlzLm1heHl8fG90aGVyLm1heHk8dGhpcy5taW55KTtyZXR1cm4gcmVzdWx0O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbnRlcnNlY3RzQ29vcmRpbmF0ZT1mdW5jdGlvbihwKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzVmFsdWVzKHAueCxwLnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5pbnRlcnNlY3RzVmFsdWVzPWZ1bmN0aW9uKHgseSl7aWYodGhpcy5pc051bGwoKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiEoeD50aGlzLm1heHh8fHg8dGhpcy5taW54fHx5PnRoaXMubWF4eXx8eTx0aGlzLm1pbnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tLkVudmVsb3BlKXtyZXR1cm4gdGhpcy5jb250YWluc0VudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2UgaWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuY29udGFpbnNDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuY29udGFpbnNWYWx1ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWluc0VudmVsb3BlPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gdGhpcy5jb3ZlcnNFbnZlbG9wZShvdGhlcik7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNvbnRhaW5zQ29vcmRpbmF0ZT1mdW5jdGlvbihwKXtyZXR1cm4gdGhpcy5jb3ZlcnNDb29yZGluYXRlKHApO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb250YWluc1ZhbHVlcz1mdW5jdGlvbih4LHkpe3JldHVybiB0aGlzLmNvdmVyc1ZhbHVlcyh4LHkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb3ZlcnM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7cmV0dXJuIHRoaXMuY292ZXJzRW52ZWxvcGUoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtyZXR1cm4gdGhpcy5jb3ZlcnNDb29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuY292ZXJzVmFsdWVzKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUuY292ZXJzVmFsdWVzPWZ1bmN0aW9uKHgseSl7aWYodGhpcy5pc051bGwoKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB4Pj10aGlzLm1pbngmJng8PXRoaXMubWF4eCYmeT49dGhpcy5taW55JiZ5PD10aGlzLm1heHk7fTtqc3RzLmdlb20uRW52ZWxvcGUucHJvdG90eXBlLmNvdmVyc0Nvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMuY292ZXJzVmFsdWVzKHAueCxwLnkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jb3ZlcnNFbnZlbG9wZT1mdW5jdGlvbihvdGhlcil7aWYodGhpcy5pc051bGwoKXx8b3RoZXIuaXNOdWxsKCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gb3RoZXIubWlueD49dGhpcy5taW54JiZvdGhlci5tYXh4PD10aGlzLm1heHgmJm90aGVyLm1pbnk+PXRoaXMubWlueSYmb3RoZXIubWF4eTw9dGhpcy5tYXh5O307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihlbnYpe2lmKHRoaXMuaW50ZXJzZWN0cyhlbnYpKXtyZXR1cm4gMDt9XG52YXIgZHg9MC4wO2lmKHRoaXMubWF4eDxlbnYubWlueCl7ZHg9ZW52Lm1pbngtdGhpcy5tYXh4O31cbmlmKHRoaXMubWlueD5lbnYubWF4eCl7ZHg9dGhpcy5taW54LWVudi5tYXh4O31cbnZhciBkeT0wLjA7aWYodGhpcy5tYXh5PGVudi5taW55KXtkeT1lbnYubWlueS10aGlzLm1heHk7fVxuaWYodGhpcy5taW55PmVudi5tYXh5KXtkeT10aGlzLm1pbnktZW52Lm1heHk7fVxuaWYoZHg9PT0wLjApe3JldHVybiBkeTt9XG5pZihkeT09PTAuMCl7cmV0dXJuIGR4O31cbnJldHVybiBNYXRoLnNxcnQoZHgqZHgrZHkqZHkpO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24ob3RoZXIpe2lmKHRoaXMuaXNOdWxsKCkpe3JldHVybiBvdGhlci5pc051bGwoKTt9XG5yZXR1cm4gdGhpcy5tYXh4PT09b3RoZXIubWF4eCYmdGhpcy5tYXh5PT09b3RoZXIubWF4eSYmdGhpcy5taW54PT09b3RoZXIubWlueCYmdGhpcy5taW55PT09b3RoZXIubWlueTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4nRW52WycrdGhpcy5taW54KycgOiAnK3RoaXMubWF4eCsnLCAnK3RoaXMubWlueSsnIDogJytcbnRoaXMubWF4eSsnXSc7fTtqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cz1mdW5jdGlvbihwMSxwMixxKXtpZihhcmd1bWVudHMubGVuZ3RoPT09NCl7cmV0dXJuIGpzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzRW52ZWxvcGUoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdKTt9XG52YXIgeGMxPXAxLng8cDIueD9wMS54OnAyLng7dmFyIHhjMj1wMS54PnAyLng/cDEueDpwMi54O3ZhciB5YzE9cDEueTxwMi55P3AxLnk6cDIueTt2YXIgeWMyPXAxLnk+cDIueT9wMS55OnAyLnk7aWYoKChxLng+PXhjMSkmJihxLng8PXhjMikpJiYoKHEueT49eWMxKSYmKHEueTw9eWMyKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzRW52ZWxvcGU9ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBtaW5xPU1hdGgubWluKHExLngscTIueCk7dmFyIG1heHE9TWF0aC5tYXgocTEueCxxMi54KTt2YXIgbWlucD1NYXRoLm1pbihwMS54LHAyLngpO3ZhciBtYXhwPU1hdGgubWF4KHAxLngscDIueCk7aWYobWlucD5tYXhxKXtyZXR1cm4gZmFsc2U7fVxuaWYobWF4cDxtaW5xKXtyZXR1cm4gZmFsc2U7fVxubWlucT1NYXRoLm1pbihxMS55LHEyLnkpO21heHE9TWF0aC5tYXgocTEueSxxMi55KTttaW5wPU1hdGgubWluKHAxLnkscDIueSk7bWF4cD1NYXRoLm1heChwMS55LHAyLnkpO2lmKG1pbnA+bWF4cSl7cmV0dXJuIGZhbHNlO31cbmlmKG1heHA8bWlucSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkVudmVsb3BlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMubWlueCx0aGlzLm1heHgsdGhpcy5taW55LHRoaXMubWF4eSk7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyPWZ1bmN0aW9uKGdlb21zKXt0aGlzLmdlb21GYWN0b3J5PWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuZXh0cmFjdEZhY3RvcnkoZ2VvbXMpO3RoaXMuaW5wdXRHZW9tcz1nZW9tczt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZT1mdW5jdGlvbihnZW9tcyl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXJldHVybiB0aGlzLmNvbWJpbmUyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgY29tYmluZXI9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIoZ2VvbXMpO3JldHVybiBjb21iaW5lci5jb21iaW5lKCk7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmUyPWZ1bmN0aW9uKCl7dmFyIGFycmF5TGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO0FycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykuZm9yRWFjaChmdW5jdGlvbihhKXthcnJheUxpc3QuYWRkKGEpO30pO3ZhciBjb21iaW5lcj1uZXcganN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lcihhcnJheUxpc3QpO3JldHVybiBjb21iaW5lci5jb21iaW5lKCk7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLnByb3RvdHlwZS5nZW9tRmFjdG9yeT1udWxsO2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIucHJvdG90eXBlLnNraXBFbXB0eT1mYWxzZTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLnByb3RvdHlwZS5pbnB1dEdlb21zO2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuZXh0cmFjdEZhY3Rvcnk9ZnVuY3Rpb24oZ2VvbXMpe2lmKGdlb21zLmlzRW1wdHkoKSlyZXR1cm4gbnVsbDtyZXR1cm4gZ2VvbXMuaXRlcmF0b3IoKS5uZXh0KCkuZ2V0RmFjdG9yeSgpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuY29tYmluZT1mdW5jdGlvbigpe3ZhciBlbGVtcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpLGk7Zm9yKGk9dGhpcy5pbnB1dEdlb21zLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZz1pLm5leHQoKTt0aGlzLmV4dHJhY3RFbGVtZW50cyhnLGVsZW1zKTt9XG5pZihlbGVtcy5zaXplKCk9PT0wKXtpZih0aGlzLmdlb21GYWN0b3J5IT09bnVsbCl7cmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO31cbnJldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdlb21GYWN0b3J5LmJ1aWxkR2VvbWV0cnkoZWxlbXMpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5wcm90b3R5cGUuZXh0cmFjdEVsZW1lbnRzPWZ1bmN0aW9uKGdlb20sZWxlbXMpe2lmKGdlb209PT1udWxsKXtyZXR1cm47fVxuZm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBlbGVtR2VvbT1nZW9tLmdldEdlb21ldHJ5TihpKTtpZih0aGlzLnNraXBFbXB0eSYmZWxlbUdlb20uaXNFbXB0eSgpKXtjb250aW51ZTt9XG5lbGVtcy5hZGQoZWxlbUdlb20pO319O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihtb2RlbFR5cGUpe2lmKHR5cGVvZiBtb2RlbFR5cGU9PT0nbnVtYmVyJyl7dGhpcy5tb2RlbFR5cGU9anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEO3RoaXMuc2NhbGU9bW9kZWxUeXBlO3JldHVybjt9XG50aGlzLm1vZGVsVHlwZT1tb2RlbFR5cGV8fGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GTE9BVElORztpZih0aGlzLm1vZGVsVHlwZT09PWpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5GSVhFRCl7dGhpcy5zY2FsZT0xLjA7fX07anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HPSdGTE9BVElORyc7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEPSdGSVhFRCc7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HX1NJTkdMRT0nRkxPQVRJTkdfU0lOR0xFJztqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLnNjYWxlPW51bGw7anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLnByb3RvdHlwZS5tb2RlbFR5cGU9bnVsbDtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLmlzRmxvYXRpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRkxPQVRJTkd8fHRoaXMubW9kZWxUeXBlPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZMT0FUSU5HX1NJTkxHRTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuZ2V0U2NhbGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY2FsZTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuZ2V0VHlwZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZGVsVHlwZTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gdHJ1ZTtpZighKG90aGVyIGluc3RhbmNlb2YganN0cy5nZW9tLlByZWNpc2lvbk1vZGVsKSl7cmV0dXJuIGZhbHNlO31cbnZhciBvdGhlclByZWNpc2lvbk1vZGVsPW90aGVyO3JldHVybiB0aGlzLm1vZGVsVHlwZT09PW90aGVyUHJlY2lzaW9uTW9kZWwubW9kZWxUeXBlJiZ0aGlzLnNjYWxlPT09b3RoZXJQcmVjaXNpb25Nb2RlbC5zY2FsZTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUubWFrZVByZWNpc2U9ZnVuY3Rpb24odmFsKXtpZih2YWwgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5tYWtlUHJlY2lzZTIodmFsKTtyZXR1cm47fVxuaWYoaXNOYU4odmFsKSlcbnJldHVybiB2YWw7aWYodGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRklYRUQpe3JldHVybiBNYXRoLnJvdW5kKHZhbCp0aGlzLnNjYWxlKS90aGlzLnNjYWxlO31cbnJldHVybiB2YWw7fTtqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwucHJvdG90eXBlLm1ha2VQcmVjaXNlMj1mdW5jdGlvbihjb29yZCl7aWYodGhpcy5tb2RlbFR5cGU9PT1qc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwuRkxPQVRJTkcpXG5yZXR1cm47Y29vcmQueD10aGlzLm1ha2VQcmVjaXNlKGNvb3JkLngpO2Nvb3JkLnk9dGhpcy5tYWtlUHJlY2lzZShjb29yZC55KTt9O2pzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG8pe3ZhciBvdGhlcj1vO3JldHVybiAwO307anN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXI9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oY29vcmQpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXI9ZnVuY3Rpb24ocHRzKXt0aGlzLnB0cz1wdHM7dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnVzZVB0PW51bGw7anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5kaXN0YW5jZVRvbGVyYW5jZT1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5zaW1wbGlmeT1mdW5jdGlvbihwdHMsZGlzdGFuY2VUb2xlcmFuY2Upe3ZhciBzaW1wPW5ldyBqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIocHRzKTtzaW1wLnNldERpc3RhbmNlVG9sZXJhbmNlKGRpc3RhbmNlVG9sZXJhbmNlKTtyZXR1cm4gc2ltcC5zaW1wbGlmeSgpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5zZXREaXN0YW5jZVRvbGVyYW5jZT1mdW5jdGlvbihkaXN0YW5jZVRvbGVyYW5jZSl7dGhpcy5kaXN0YW5jZVRvbGVyYW5jZT1kaXN0YW5jZVRvbGVyYW5jZTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXt0aGlzLnVzZVB0PVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5wdHMubGVuZ3RoO2krKyl7dGhpcy51c2VQdFtpXT10cnVlO31cbnRoaXMuc2ltcGxpZnlTZWN0aW9uKDAsdGhpcy5wdHMubGVuZ3RoLTEpO3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdCgpO2Zvcih2YXIgaj0wO2o8dGhpcy5wdHMubGVuZ3RoO2orKyl7aWYodGhpcy51c2VQdFtqXSl7Y29vcmRMaXN0LmFkZChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5wdHNbal0pKTt9fVxucmV0dXJuIGNvb3JkTGlzdC50b0Nvb3JkaW5hdGVBcnJheSgpO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlckxpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5zZWc9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyTGluZVNpbXBsaWZpZXIucHJvdG90eXBlLnNpbXBsaWZ5U2VjdGlvbj1mdW5jdGlvbihpLGope2lmKGkrMT09ail7cmV0dXJuO31cbnRoaXMuc2VnLnAwPXRoaXMucHRzW2ldO3RoaXMuc2VnLnAxPXRoaXMucHRzW2pdO3ZhciBtYXhEaXN0YW5jZT0tMS4wO3ZhciBtYXhJbmRleD1pO2Zvcih2YXIgaz1pKzE7azxqO2srKyl7dmFyIGRpc3RhbmNlPXRoaXMuc2VnLmRpc3RhbmNlKHRoaXMucHRzW2tdKTtpZihkaXN0YW5jZT5tYXhEaXN0YW5jZSl7bWF4RGlzdGFuY2U9ZGlzdGFuY2U7bWF4SW5kZXg9azt9fVxuaWYobWF4RGlzdGFuY2U8PXRoaXMuZGlzdGFuY2VUb2xlcmFuY2Upe2Zvcih2YXIgbD1pKzE7bDxqO2wrKyl7dGhpcy51c2VQdFtsXT1mYWxzZTt9fWVsc2V7dGhpcy5zaW1wbGlmeVNlY3Rpb24oaSxtYXhJbmRleCk7dGhpcy5zaW1wbGlmeVNlY3Rpb24obWF4SW5kZXgsaik7fX07anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbj1mdW5jdGlvbihjb29yZCxzZWdtZW50SW5kZXgsZGlzdCl7dGhpcy5jb29yZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmQpO3RoaXMuc2VnbWVudEluZGV4PXNlZ21lbnRJbmRleDt0aGlzLmRpc3Q9ZGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmNvb3JkPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuc2VnbWVudEluZGV4PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbi5wcm90b3R5cGUuZGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmdldFNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNlZ21lbnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmdldERpc3RhbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMuY29tcGFyZShvdGhlci5zZWdtZW50SW5kZXgsb3RoZXIuZGlzdCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5jb21wYXJlPWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxkaXN0KXtpZih0aGlzLnNlZ21lbnRJbmRleDxzZWdtZW50SW5kZXgpXG5yZXR1cm4tMTtpZih0aGlzLnNlZ21lbnRJbmRleD5zZWdtZW50SW5kZXgpXG5yZXR1cm4gMTtpZih0aGlzLmRpc3Q8ZGlzdClcbnJldHVybi0xO2lmKHRoaXMuZGlzdD5kaXN0KVxucmV0dXJuIDE7cmV0dXJuIDA7fTtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uLnByb3RvdHlwZS5pc0VuZFBvaW50PWZ1bmN0aW9uKG1heFNlZ21lbnRJbmRleCl7aWYodGhpcy5zZWdtZW50SW5kZXg9PT0wJiZ0aGlzLmRpc3Q9PT0wLjApXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLnNlZ21lbnRJbmRleD09PW1heFNlZ21lbnRJbmRleClcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJycrdGhpcy5zZWdtZW50SW5kZXgrdGhpcy5kaXN0O307KGZ1bmN0aW9uKCl7dmFyIEVkZ2VJbnRlcnNlY3Rpb249anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbjt2YXIgVHJlZU1hcD1qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcDtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdD1mdW5jdGlvbihlZGdlKXt0aGlzLm5vZGVNYXA9bmV3IFRyZWVNYXAoKTt0aGlzLmVkZ2U9ZWRnZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5ub2RlTWFwPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmVkZ2U9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlSW50ZXJzZWN0aW9uTGlzdC5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocHQpe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlaT1pdC5uZXh0KCk7aWYoZWkuY29vcmQuZXF1YWxzKHB0KSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaW50UHQsc2VnbWVudEluZGV4LGRpc3Qpe3ZhciBlaU5ldz1uZXcgRWRnZUludGVyc2VjdGlvbihpbnRQdCxzZWdtZW50SW5kZXgsZGlzdCk7dmFyIGVpPXRoaXMubm9kZU1hcC5nZXQoZWlOZXcpO2lmKGVpIT09bnVsbCl7cmV0dXJuIGVpO31cbnRoaXMubm9kZU1hcC5wdXQoZWlOZXcsZWlOZXcpO3JldHVybiBlaU5ldzt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0LnByb3RvdHlwZS5hZGRFbmRwb2ludHM9ZnVuY3Rpb24oKXt2YXIgbWF4U2VnSW5kZXg9dGhpcy5lZGdlLnB0cy5sZW5ndGgtMTt0aGlzLmFkZCh0aGlzLmVkZ2UucHRzWzBdLDAsMC4wKTt0aGlzLmFkZCh0aGlzLmVkZ2UucHRzW21heFNlZ0luZGV4XSxtYXhTZWdJbmRleCwwLjApO307anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmFkZFNwbGl0RWRnZXM9ZnVuY3Rpb24oZWRnZUxpc3QpXG57dGhpcy5hZGRFbmRwb2ludHMoKTt2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO3ZhciBlaVByZXY9aXQubmV4dCgpO3doaWxlKGl0Lmhhc05leHQoKSl7dmFyIGVpPWl0Lm5leHQoKTt2YXIgbmV3RWRnZT10aGlzLmNyZWF0ZVNwbGl0RWRnZShlaVByZXYsZWkpO2VkZ2VMaXN0LmFkZChuZXdFZGdlKTtlaVByZXY9ZWk7fX07anN0cy5nZW9tZ3JhcGguRWRnZUludGVyc2VjdGlvbkxpc3QucHJvdG90eXBlLmNyZWF0ZVNwbGl0RWRnZT1mdW5jdGlvbihlaTAsZWkxKXt2YXIgbnB0cz1laTEuc2VnbWVudEluZGV4LWVpMC5zZWdtZW50SW5kZXgrMjt2YXIgbGFzdFNlZ1N0YXJ0UHQ9dGhpcy5lZGdlLnB0c1tlaTEuc2VnbWVudEluZGV4XTt2YXIgdXNlSW50UHQxPWVpMS5kaXN0PjAuMHx8IWVpMS5jb29yZC5lcXVhbHMyRChsYXN0U2VnU3RhcnRQdCk7aWYoIXVzZUludFB0MSl7bnB0cy0tO31cbnZhciBwdHM9W107dmFyIGlwdD0wO3B0c1tpcHQrK109bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVpMC5jb29yZCk7Zm9yKHZhciBpPWVpMC5zZWdtZW50SW5kZXgrMTtpPD1laTEuc2VnbWVudEluZGV4O2krKyl7cHRzW2lwdCsrXT10aGlzLmVkZ2UucHRzW2ldO31cbmlmKHVzZUludFB0MSlwdHNbaXB0XT1laTEuY29vcmQ7cmV0dXJuIG5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKHB0cyxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5lZGdlLmxhYmVsKSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb249ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5tZXNzYWdlPW1lc3NhZ2U7fTtBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24ucHJvdG90eXBlPW5ldyBFcnJvcigpO0Fzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbi5wcm90b3R5cGUubmFtZT0nQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uJztqc3RzLnV0aWwuQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uPUFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb249anN0cy51dGlsLkFzc2VydGlvbkZhaWxlZEV4Y2VwdGlvbjtqc3RzLnV0aWwuQXNzZXJ0PWZ1bmN0aW9uKCl7fTtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZT1mdW5jdGlvbihhc3NlcnRpb24sbWVzc2FnZSl7aWYoIWFzc2VydGlvbil7aWYobWVzc2FnZT09PW51bGwpe3Rocm93IG5ldyBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24oKTt9ZWxzZXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKG1lc3NhZ2UpO319fTtqc3RzLnV0aWwuQXNzZXJ0LmVxdWFscz1mdW5jdGlvbihleHBlY3RlZFZhbHVlLGFjdHVhbFZhbHVlLG1lc3NhZ2Upe2lmKCFhY3R1YWxWYWx1ZS5lcXVhbHMoZXhwZWN0ZWRWYWx1ZSkpe3Rocm93IG5ldyBBc3NlcnRpb25GYWlsZWRFeGNlcHRpb24oJ0V4cGVjdGVkICcrZXhwZWN0ZWRWYWx1ZSsnIGJ1dCBlbmNvdW50ZXJlZCAnK2FjdHVhbFZhbHVlK1xuKG1lc3NhZ2UhPW51bGw/JzogJyttZXNzYWdlOicnKSk7fX07anN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZT1mdW5jdGlvbihtZXNzYWdlKXt0aHJvdyBuZXcgQXNzZXJ0aW9uRmFpbGVkRXhjZXB0aW9uKCdTaG91bGQgbmV2ZXIgcmVhY2ggaGVyZScrXG4obWVzc2FnZSE9bnVsbD8nOiAnK21lc3NhZ2U6JycpKTt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIExvY2F0aW9uPWpzdHMuZ2VvbS5Mb2NhdGlvbjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlcj1mdW5jdGlvbihhcmcpe3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMucHRMb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt0aGlzLm5vZGVzPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlTWFwKG5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3RvcnkoKSk7dGhpcy5pc29sYXRlZEVkZ2VzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmFyZz1hcmc7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmFyZz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubm9kZXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmltPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5pc29sYXRlZEVkZ2VzPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5pbnZhbGlkUG9pbnQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbigpe3ZhciBpbT1uZXcganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeCgpO2ltLnNldChMb2NhdGlvbi5FWFRFUklPUixMb2NhdGlvbi5FWFRFUklPUiwyKTtpZighdGhpcy5hcmdbMF0uZ2V0R2VvbWV0cnkoKS5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyh0aGlzLmFyZ1sxXS5nZXRHZW9tZXRyeSgpLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpe3RoaXMuY29tcHV0ZURpc2pvaW50SU0oaW0pO3JldHVybiBpbTt9XG50aGlzLmFyZ1swXS5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksZmFsc2UpO3RoaXMuYXJnWzFdLmNvbXB1dGVTZWxmTm9kZXModGhpcy5saSxmYWxzZSk7dmFyIGludGVyc2VjdG9yPXRoaXMuYXJnWzBdLmNvbXB1dGVFZGdlSW50ZXJzZWN0aW9ucyh0aGlzLmFyZ1sxXSx0aGlzLmxpLGZhbHNlKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2RlcygwKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2RlcygxKTt0aGlzLmNvcHlOb2Rlc0FuZExhYmVscygwKTt0aGlzLmNvcHlOb2Rlc0FuZExhYmVscygxKTt0aGlzLmxhYmVsSXNvbGF0ZWROb2RlcygpO3RoaXMuY29tcHV0ZVByb3BlckludGVyc2VjdGlvbklNKGludGVyc2VjdG9yLGltKTt2YXIgZWVCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIoKTt2YXIgZWUwPWVlQnVpbGRlci5jb21wdXRlRWRnZUVuZHModGhpcy5hcmdbMF0uZ2V0RWRnZUl0ZXJhdG9yKCkpO3RoaXMuaW5zZXJ0RWRnZUVuZHMoZWUwKTt2YXIgZWUxPWVlQnVpbGRlci5jb21wdXRlRWRnZUVuZHModGhpcy5hcmdbMV0uZ2V0RWRnZUl0ZXJhdG9yKCkpO3RoaXMuaW5zZXJ0RWRnZUVuZHMoZWUxKTt0aGlzLmxhYmVsTm9kZUVkZ2VzKCk7dGhpcy5sYWJlbElzb2xhdGVkRWRnZXMoMCwxKTt0aGlzLmxhYmVsSXNvbGF0ZWRFZGdlcygxLDApO3RoaXMudXBkYXRlSU0oaW0pO3JldHVybiBpbTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuaW5zZXJ0RWRnZUVuZHM9ZnVuY3Rpb24oZWUpe2Zvcih2YXIgaT1lZS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5ub2Rlcy5hZGQoZSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5jb21wdXRlUHJvcGVySW50ZXJzZWN0aW9uSU09ZnVuY3Rpb24oaW50ZXJzZWN0b3IsaW0pe3ZhciBkaW1BPXRoaXMuYXJnWzBdLmdldEdlb21ldHJ5KCkuZ2V0RGltZW5zaW9uKCk7dmFyIGRpbUI9dGhpcy5hcmdbMV0uZ2V0R2VvbWV0cnkoKS5nZXREaW1lbnNpb24oKTt2YXIgaGFzUHJvcGVyPWludGVyc2VjdG9yLmhhc1Byb3BlckludGVyc2VjdGlvbigpO3ZhciBoYXNQcm9wZXJJbnRlcmlvcj1pbnRlcnNlY3Rvci5oYXNQcm9wZXJJbnRlcmlvckludGVyc2VjdGlvbigpO2lmKGRpbUE9PT0yJiZkaW1CPT09Mil7aWYoaGFzUHJvcGVyKVxuaW0uc2V0QXRMZWFzdCgnMjEyMTAxMjEyJyk7fVxuZWxzZSBpZihkaW1BPT09MiYmZGltQj09PTEpe2lmKGhhc1Byb3BlcilcbmltLnNldEF0TGVhc3QoJ0ZGRjBGRkZGMicpO2lmKGhhc1Byb3BlckludGVyaW9yKVxuaW0uc2V0QXRMZWFzdCgnMUZGRkZGMUZGJyk7fWVsc2UgaWYoZGltQT09PTEmJmRpbUI9PT0yKXtpZihoYXNQcm9wZXIpXG5pbS5zZXRBdExlYXN0KCdGMEZGRkZGRjInKTtpZihoYXNQcm9wZXJJbnRlcmlvcilcbmltLnNldEF0TGVhc3QoJzFGMUZGRkZGRicpO31cbmVsc2UgaWYoZGltQT09PTEmJmRpbUI9PT0xKXtpZihoYXNQcm9wZXJJbnRlcmlvcilcbmltLnNldEF0TGVhc3QoJzBGRkZGRkZGRicpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuY29weU5vZGVzQW5kTGFiZWxzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5hcmdbYXJnSW5kZXhdLmdldE5vZGVJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdyYXBoTm9kZT1pLm5leHQoKTt2YXIgbmV3Tm9kZT10aGlzLm5vZGVzLmFkZE5vZGUoZ3JhcGhOb2RlLmdldENvb3JkaW5hdGUoKSk7bmV3Tm9kZS5zZXRMYWJlbChhcmdJbmRleCxncmFwaE5vZGUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCkpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbk5vZGVzPWZ1bmN0aW9uKGFyZ0luZGV4KXtmb3IodmFyIGk9dGhpcy5hcmdbYXJnSW5kZXhdLmdldEVkZ2VJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dmFyIGVMb2M9ZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KTtmb3IodmFyIGVpSXQ9ZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpLml0ZXJhdG9yKCk7ZWlJdC5oYXNOZXh0KCk7KXt2YXIgZWk9ZWlJdC5uZXh0KCk7dmFyIG49dGhpcy5ub2Rlcy5hZGROb2RlKGVpLmNvb3JkKTtpZihlTG9jPT09TG9jYXRpb24uQk9VTkRBUlkpXG5uLnNldExhYmVsQm91bmRhcnkoYXJnSW5kZXgpO2Vsc2V7aWYobi5nZXRMYWJlbCgpLmlzTnVsbChhcmdJbmRleCkpXG5uLnNldExhYmVsKGFyZ0luZGV4LExvY2F0aW9uLklOVEVSSU9SKTt9fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubGFiZWxJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihhcmdJbmRleCl7Zm9yKHZhciBpPXRoaXMuYXJnW2FyZ0luZGV4XS5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3ZhciBlTG9jPWUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihhcmdJbmRleCk7Zm9yKHZhciBlaUl0PWUuZ2V0RWRnZUludGVyc2VjdGlvbkxpc3QoKS5pdGVyYXRvcigpO2VpSXQuaGFzTmV4dCgpOyl7dmFyIGVpPWVpSXQubmV4dCgpO3ZhciBuPXRoaXMubm9kZXMuZmluZChlaS5jb29yZCk7aWYobi5nZXRMYWJlbCgpLmlzTnVsbChhcmdJbmRleCkpe2lmKGVMb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbm4uc2V0TGFiZWxCb3VuZGFyeShhcmdJbmRleCk7ZWxzZVxubi5zZXRMYWJlbChhcmdJbmRleCxMb2NhdGlvbi5JTlRFUklPUik7fX19fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmNvbXB1dGVEaXNqb2ludElNPWZ1bmN0aW9uKGltKXt2YXIgZ2E9dGhpcy5hcmdbMF0uZ2V0R2VvbWV0cnkoKTtpZighZ2EuaXNFbXB0eSgpKXtpbS5zZXQoTG9jYXRpb24uSU5URVJJT1IsTG9jYXRpb24uRVhURVJJT1IsZ2EuZ2V0RGltZW5zaW9uKCkpO2ltLnNldChMb2NhdGlvbi5CT1VOREFSWSxMb2NhdGlvbi5FWFRFUklPUixnYS5nZXRCb3VuZGFyeURpbWVuc2lvbigpKTt9XG52YXIgZ2I9dGhpcy5hcmdbMV0uZ2V0R2VvbWV0cnkoKTtpZighZ2IuaXNFbXB0eSgpKXtpbS5zZXQoTG9jYXRpb24uRVhURVJJT1IsTG9jYXRpb24uSU5URVJJT1IsZ2IuZ2V0RGltZW5zaW9uKCkpO2ltLnNldChMb2NhdGlvbi5FWFRFUklPUixMb2NhdGlvbi5CT1VOREFSWSxnYi5nZXRCb3VuZGFyeURpbWVuc2lvbigpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsTm9kZUVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBuaT10aGlzLm5vZGVzLml0ZXJhdG9yKCk7bmkuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bmkubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5jb21wdXRlTGFiZWxsaW5nKHRoaXMuYXJnKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLnVwZGF0ZUlNPWZ1bmN0aW9uKGltKXtmb3IodmFyIGVpPXRoaXMuaXNvbGF0ZWRFZGdlcy5pdGVyYXRvcigpO2VpLmhhc05leHQoKTspe3ZhciBlPWVpLm5leHQoKTtlLnVwZGF0ZUlNKGltKTt9XG5mb3IodmFyIG5pPXRoaXMubm9kZXMuaXRlcmF0b3IoKTtuaS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1uaS5uZXh0KCk7bm9kZS51cGRhdGVJTShpbSk7bm9kZS51cGRhdGVJTUZyb21FZGdlcyhpbSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZUNvbXB1dGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkRWRnZXM9ZnVuY3Rpb24odGhpc0luZGV4LHRhcmdldEluZGV4KXtmb3IodmFyIGVpPXRoaXMuYXJnW3RoaXNJbmRleF0uZ2V0RWRnZUl0ZXJhdG9yKCk7ZWkuaGFzTmV4dCgpOyl7dmFyIGU9ZWkubmV4dCgpO2lmKGUuaXNJc29sYXRlZCgpKXt0aGlzLmxhYmVsSXNvbGF0ZWRFZGdlKGUsdGFyZ2V0SW5kZXgsdGhpcy5hcmdbdGFyZ2V0SW5kZXhdLmdldEdlb21ldHJ5KCkpO3RoaXMuaXNvbGF0ZWRFZGdlcy5hZGQoZSk7fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZEVkZ2U9ZnVuY3Rpb24oZSx0YXJnZXRJbmRleCx0YXJnZXQpe2lmKHRhcmdldC5nZXREaW1lbnNpb24oKT4wKXt2YXIgbG9jPXRoaXMucHRMb2NhdG9yLmxvY2F0ZShlLmdldENvb3JkaW5hdGUoKSx0YXJnZXQpO2UuZ2V0TGFiZWwoKS5zZXRBbGxMb2NhdGlvbnModGFyZ2V0SW5kZXgsbG9jKTt9ZWxzZXtlLmdldExhYmVsKCkuc2V0QWxsTG9jYXRpb25zKHRhcmdldEluZGV4LExvY2F0aW9uLkVYVEVSSU9SKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWROb2Rlcz1mdW5jdGlvbigpe2Zvcih2YXIgbmk9dGhpcy5ub2Rlcy5pdGVyYXRvcigpO25pLmhhc05leHQoKTspe3ZhciBuPW5pLm5leHQoKTt2YXIgbGFiZWw9bi5nZXRMYWJlbCgpO0Fzc2VydC5pc1RydWUobGFiZWwuZ2V0R2VvbWV0cnlDb3VudCgpPjAsJ25vZGUgd2l0aCBlbXB0eSBsYWJlbCBmb3VuZCcpO2lmKG4uaXNJc29sYXRlZCgpKXtpZihsYWJlbC5pc051bGwoMCkpXG50aGlzLmxhYmVsSXNvbGF0ZWROb2RlKG4sMCk7ZWxzZVxudGhpcy5sYWJlbElzb2xhdGVkTm9kZShuLDEpO319fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlQ29tcHV0ZXIucHJvdG90eXBlLmxhYmVsSXNvbGF0ZWROb2RlPWZ1bmN0aW9uKG4sdGFyZ2V0SW5kZXgpe3ZhciBsb2M9dGhpcy5wdExvY2F0b3IubG9jYXRlKG4uZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuYXJnW3RhcmdldEluZGV4XS5nZXRHZW9tZXRyeSgpKTtuLmdldExhYmVsKCkuc2V0QWxsTG9jYXRpb25zKHRhcmdldEluZGV4LGxvYyk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudD1mdW5jdGlvbihsYWJlbCl7dGhpcy5sYWJlbD1sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5sYWJlbD1udWxsO2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5faXNJblJlc3VsdD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzQ292ZXJlZD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzQ292ZXJlZFNldD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzVmlzaXRlZD1mYWxzZTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRMYWJlbD1mdW5jdGlvbihsYWJlbCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuc2V0TGFiZWwyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5sYWJlbD1sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5zZXRJblJlc3VsdD1mdW5jdGlvbihpc0luUmVzdWx0KXt0aGlzLl9pc0luUmVzdWx0PWlzSW5SZXN1bHQ7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNJblJlc3VsdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0luUmVzdWx0O307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldENvdmVyZWQ9ZnVuY3Rpb24oaXNDb3ZlcmVkKXt0aGlzLl9pc0NvdmVyZWQ9aXNDb3ZlcmVkO3RoaXMuX2lzQ292ZXJlZFNldD10cnVlO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzQ292ZXJlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0NvdmVyZWQ7fTtqc3RzLmdlb21ncmFwaC5HcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNDb3ZlcmVkU2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzQ292ZXJlZFNldDt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc1Zpc2l0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWaXNpdGVkO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldFZpc2l0ZWQ9ZnVuY3Rpb24oaXNWaXNpdGVkKXt0aGlzLl9pc1Zpc2l0ZWQ9aXNWaXNpdGVkO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbihpbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc0lzb2xhdGVkPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50LnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7QXNzZXJ0LmlzVHJ1ZSh0aGlzLmxhYmVsLmdldEdlb21ldHJ5Q291bnQoKT49MiwnZm91bmQgcGFydGlhbCBsYWJlbCcpO3RoaXMuY29tcHV0ZUlNKGltKTt9O30pKCk7anN0cy5nZW9tZ3JhcGguTm9kZT1mdW5jdGlvbihjb29yZCxlZGdlcyl7dGhpcy5jb29yZD1jb29yZDt0aGlzLmVkZ2VzPWVkZ2VzO3RoaXMubGFiZWw9bmV3IGpzdHMuZ2VvbWdyYXBoLkxhYmVsKDAsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkdyYXBoQ29tcG9uZW50KCk7anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuY29vcmQ9bnVsbDtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5lZGdlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmlzSXNvbGF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5sYWJlbC5nZXRHZW9tZXRyeUNvdW50KCk9PTEpO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuc2V0TGFiZWwyPWZ1bmN0aW9uKGFyZ0luZGV4LG9uTG9jYXRpb24pe2lmKHRoaXMubGFiZWw9PT1udWxsKXt0aGlzLmxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChhcmdJbmRleCxvbkxvY2F0aW9uKTt9ZWxzZVxudGhpcy5sYWJlbC5zZXRMb2NhdGlvbihhcmdJbmRleCxvbkxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLnNldExhYmVsQm91bmRhcnk9ZnVuY3Rpb24oYXJnSW5kZXgpe3ZhciBsb2M9anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7aWYodGhpcy5sYWJlbCE9PW51bGwpXG5sb2M9dGhpcy5sYWJlbC5nZXRMb2NhdGlvbihhcmdJbmRleCk7dmFyIG5ld0xvYztzd2l0Y2gobG9jKXtjYXNlIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTpuZXdMb2M9anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO2JyZWFrO2Nhc2UganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SOm5ld0xvYz1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7YnJlYWs7ZGVmYXVsdDpuZXdMb2M9anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2JyZWFrO31cbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oYXJnSW5kZXgsbmV3TG9jKTt9O2pzdHMuZ2VvbWdyYXBoLk5vZGUucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt0aGlzLmVkZ2VzLmluc2VydChlKTtlLnNldE5vZGUodGhpcyk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmQ7fTtqc3RzLmdlb21ncmFwaC5Ob2RlLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzO307anN0cy5nZW9tZ3JhcGguTm9kZS5wcm90b3R5cGUuaXNJbmNpZGVudEVkZ2VJblJlc3VsdD1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5nZXRFZGdlcygpLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmdldEVkZ2UoKS5pc0luUmVzdWx0KCkpXG5yZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uUG9pbnQ9ZnVuY3Rpb24oY29vcmRpbmF0ZSxmYWN0b3J5KXt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTtpZihjb29yZGluYXRlPT09dW5kZWZpbmVkKVxucmV0dXJuO3RoaXMuY29vcmRpbmF0ZT1jb29yZGluYXRlO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5KCk7anN0cy5nZW9tLlBvaW50LmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5Qb2ludDtqc3RzLmdlb20uUG9pbnQuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLlBvaW50Jztqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmNvb3JkaW5hdGU9bnVsbDtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldFg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZGluYXRlLng7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldFk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZGluYXRlLnk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb29yZGluYXRlO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW1wdHkoKT9bXTpbdGhpcy5jb29yZGluYXRlXTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNFbXB0eSgpP1tdOlt0aGlzLmNvb3JkaW5hdGVdO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29vcmRpbmF0ZT09PW51bGw7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5pc0VtcHR5KCkmJm90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIHRoaXMuZXF1YWwob3RoZXIuZ2V0Q29vcmRpbmF0ZSgpLHRoaXMuZ2V0Q29vcmRpbmF0ZSgpLHRvbGVyYW5jZSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW1wdHkoKT8wOjE7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmlzU2ltcGxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKG51bGwpO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jb21wdXRlRW52ZWxvcGVJbnRlcm5hbD1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO31cbnJldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMuY29vcmRpbmF0ZSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7aWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyfHxmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIpe2ZpbHRlci5maWx0ZXIodGhpcyk7fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm47fVxuZmlsdGVyLmZpbHRlcih0aGlzLmdldENvb3JkaW5hdGUoKSk7fX07anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tLlBvaW50KHRoaXMuY29vcmRpbmF0ZS5jbG9uZSgpLHRoaXMuZmFjdG9yeSk7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAwO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5nZXRCb3VuZGFyeURpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLlBvaW50LnByb3RvdHlwZS5yZXZlcnNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2xvbmUoKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe2lmKCFqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuaXNWYWxpZCh0aGlzLmdldENvb3JkaW5hdGUoKSkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uUG9pbnQucHJvdG90eXBlLmNvbXBhcmVUb1NhbWVDbGFzcz1mdW5jdGlvbihvdGhlcil7dmFyIHBvaW50PW90aGVyO3JldHVybiB0aGlzLmdldENvb3JkaW5hdGUoKS5jb21wYXJlVG8ocG9pbnQuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuZ2V0R2VvbWV0cnlUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuJ1BvaW50Jzt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuaGFzaENvZGU9ZnVuY3Rpb24oKXtyZXR1cm4nUG9pbnRfJyt0aGlzLmNvb3JkaW5hdGUuaGFzaENvZGUoKTt9O2pzdHMuZ2VvbS5Qb2ludC5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLlBvaW50Jztqc3RzLmdlb20uRGltZW5zaW9uPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uRGltZW5zaW9uLlA9MDtqc3RzLmdlb20uRGltZW5zaW9uLkw9MTtqc3RzLmdlb20uRGltZW5zaW9uLkE9Mjtqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFPS0xO2pzdHMuZ2VvbS5EaW1lbnNpb24uVFJVRT0tMjtqc3RzLmdlb20uRGltZW5zaW9uLkRPTlRDQVJFPS0zO2pzdHMuZ2VvbS5EaW1lbnNpb24udG9EaW1lbnNpb25TeW1ib2w9ZnVuY3Rpb24oZGltZW5zaW9uVmFsdWUpe3N3aXRjaChkaW1lbnNpb25WYWx1ZSl7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLkZBTFNFOnJldHVybidGJztjYXNlIGpzdHMuZ2VvbS5EaW1lbnNpb24uVFJVRTpyZXR1cm4nVCc7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLkRPTlRDQVJFOnJldHVybicqJztjYXNlIGpzdHMuZ2VvbS5EaW1lbnNpb24uUDpyZXR1cm4nMCc7Y2FzZSBqc3RzLmdlb20uRGltZW5zaW9uLkw6cmV0dXJuJzEnO2Nhc2UganN0cy5nZW9tLkRpbWVuc2lvbi5BOnJldHVybicyJzt9XG50aHJvdyBuZXcganN0cy5JbGxlZ2FsQXJndW1lbnRFcnJvcignVW5rbm93biBkaW1lbnNpb24gdmFsdWU6ICcrXG5kaW1lbnNpb25WYWx1ZSk7fTtqc3RzLmdlb20uRGltZW5zaW9uLnRvRGltZW5zaW9uVmFsdWU9ZnVuY3Rpb24oZGltZW5zaW9uU3ltYm9sKXtzd2l0Y2goZGltZW5zaW9uU3ltYm9sLnRvVXBwZXJDYXNlKCkpe2Nhc2UnRic6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uRkFMU0U7Y2FzZSdUJzpyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5UUlVFO2Nhc2UnKic6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uRE9OVENBUkU7Y2FzZScwJzpyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5QO2Nhc2UnMSc6cmV0dXJuIGpzdHMuZ2VvbS5EaW1lbnNpb24uTDtjYXNlJzInOnJldHVybiBqc3RzLmdlb20uRGltZW5zaW9uLkE7fVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ1Vua25vd24gZGltZW5zaW9uIHN5bWJvbDogJytcbmRpbWVuc2lvblN5bWJvbCk7fTsoZnVuY3Rpb24oKXt2YXIgRGltZW5zaW9uPWpzdHMuZ2VvbS5EaW1lbnNpb247anN0cy5nZW9tLkxpbmVTdHJpbmc9ZnVuY3Rpb24ocG9pbnRzLGZhY3Rvcnkpe3RoaXMuZmFjdG9yeT1mYWN0b3J5O3RoaXMucG9pbnRzPXBvaW50c3x8W107fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeSgpO2pzdHMuZ2VvbS5MaW5lU3RyaW5nLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5MaW5lU3RyaW5nO2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5wb2ludHM9bnVsbDtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHM7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVOPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLnBvaW50c1tuXTt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdldENvb3JkaW5hdGVOKDApO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAxO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0Nsb3NlZCgpKXtyZXR1cm4gRGltZW5zaW9uLkZBTFNFO31cbnJldHVybiAwO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHMubGVuZ3RoPT09MDt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wb2ludHMubGVuZ3RoO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldFBvaW50Tj1mdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQodGhpcy5wb2ludHNbbl0pO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldFN0YXJ0UG9pbnQ9ZnVuY3Rpb24oKXtpZih0aGlzLmlzRW1wdHkoKSl7cmV0dXJuIG51bGw7fVxucmV0dXJuIHRoaXMuZ2V0UG9pbnROKDApO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEVuZFBvaW50PWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBudWxsO31cbnJldHVybiB0aGlzLmdldFBvaW50Tih0aGlzLmdldE51bVBvaW50cygpLTEpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5nZXRDb29yZGluYXRlTigwKS5lcXVhbHMyRCh0aGlzLmdldENvb3JkaW5hdGVOKHRoaXMucG9pbnRzLmxlbmd0aC0xKSk7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUuaXNSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNDbG9zZWQoKSYmdGhpcy5pc1NpbXBsZSgpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidMaW5lU3RyaW5nJzt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVMZW5ndGgodGhpcy5wb2ludHMpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuKG5ldyBqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wKHRoaXMpKS5nZXRCb3VuZGFyeSgpO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKCk7fVxudmFyIGVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7dGhpcy5wb2ludHMuZm9yRWFjaChmdW5jdGlvbihjb21wb25lbnQpe2Vudi5leHBhbmRUb0luY2x1ZGUoY29tcG9uZW50KTt9KTtyZXR1cm4gZW52O307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxuaWYodGhpcy5wb2ludHMubGVuZ3RoIT09b3RoZXIucG9pbnRzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaXNFbXB0eSgpJiZvdGhlci5pc0VtcHR5KCkpe3JldHVybiB0cnVlO31cbnJldHVybiB0aGlzLnBvaW50cy5yZWR1Y2UoZnVuY3Rpb24oZXF1YWwscG9pbnQsaSl7cmV0dXJuIGVxdWFsJiZqc3RzLmdlb20uR2VvbWV0cnkucHJvdG90eXBlLmVxdWFsKHBvaW50LG90aGVyLnBvaW50c1tpXSx0b2xlcmFuY2UpO30pO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmlzRXF1aXZhbGVudENsYXNzPWZ1bmN0aW9uKG90aGVyKXtyZXR1cm4gb3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZzt9O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5jb21wYXJlVG9TYW1lQ2xhc3M9ZnVuY3Rpb24obyl7dmFyIGxpbmU9bzt2YXIgaT0wLGlsPXRoaXMucG9pbnRzLmxlbmd0aDt2YXIgaj0wLGpsPWxpbmUucG9pbnRzLmxlbmd0aDt3aGlsZShpPGlsJiZqPGpsKXt2YXIgY29tcGFyaXNvbj10aGlzLnBvaW50c1tpXS5jb21wYXJlVG8obGluZS5wb2ludHNbal0pO2lmKGNvbXBhcmlzb24hPT0wKXtyZXR1cm4gY29tcGFyaXNvbjt9XG5pKys7aisrO31cbmlmKGk8aWwpe3JldHVybiAxO31cbmlmKGo8amwpe3JldHVybi0xO31cbnJldHVybiAwO307anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7aWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyfHxmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXIpe2ZpbHRlci5maWx0ZXIodGhpcyk7fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe2Zvcih2YXIgaT0wLGxlbj10aGlzLnBvaW50cy5sZW5ndGg7aTxsZW47aSsrKXtmaWx0ZXIuZmlsdGVyKHRoaXMucG9pbnRzW2ldKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcil7dGhpcy5hcHBseTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5hcHBseTI9ZnVuY3Rpb24oZmlsdGVyKXtpZih0aGlzLnBvaW50cy5sZW5ndGg9PT0wKVxucmV0dXJuO2Zvcih2YXIgaT0wO2k8dGhpcy5wb2ludHMubGVuZ3RoO2krKyl7ZmlsdGVyLmZpbHRlcih0aGlzLnBvaW50cyxpKTtpZihmaWx0ZXIuaXNEb25lKCkpXG5icmVhazt9XG5pZihmaWx0ZXIuaXNHZW9tZXRyeUNoYW5nZWQoKSl7fX07anN0cy5nZW9tLkxpbmVTdHJpbmcucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIHBvaW50cz1bXTtmb3IodmFyIGk9MCxsZW49dGhpcy5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7cG9pbnRzLnB1c2godGhpcy5wb2ludHNbaV0uY2xvbmUoKSk7fVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHBvaW50cyk7fTtqc3RzLmdlb20uTGluZVN0cmluZy5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dmFyIGksaWwsaixjaSxjaixsZW47bGVuPXRoaXMucG9pbnRzLmxlbmd0aDtpbD1wYXJzZUludChsZW4vMik7Zm9yKGk9MDtpPGlsO2krKyl7aj1sZW4tMS1pO2NpPXRoaXMucG9pbnRzW2ldO2NqPXRoaXMucG9pbnRzW2pdO2lmKCFjaS5lcXVhbHMoY2opKXtpZihjaS5jb21wYXJlVG8oY2opPjApe3RoaXMucG9pbnRzLnJldmVyc2UoKTt9XG5yZXR1cm47fX19O2pzdHMuZ2VvbS5MaW5lU3RyaW5nLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTGluZVN0cmluZyc7fSkoKTsoZnVuY3Rpb24oKXtqc3RzLmdlb20uUG9seWdvbj1mdW5jdGlvbihzaGVsbCxob2xlcyxmYWN0b3J5KXt0aGlzLnNoZWxsPXNoZWxsfHxmYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcobnVsbCk7dGhpcy5ob2xlcz1ob2xlc3x8W107dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeSgpO2pzdHMuZ2VvbS5Qb2x5Z29uLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5Qb2x5Z29uO2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGwuZ2V0Q29vcmRpbmF0ZSgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybltdO31cbnZhciBjb29yZGluYXRlcz1bXTt2YXIgaz0tMTt2YXIgc2hlbGxDb29yZGluYXRlcz10aGlzLnNoZWxsLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciB4PTA7eDxzaGVsbENvb3JkaW5hdGVzLmxlbmd0aDt4Kyspe2srKztjb29yZGluYXRlc1trXT1zaGVsbENvb3JkaW5hdGVzW3hdO31cbmZvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRDb29yZGluYXRlcz10aGlzLmhvbGVzW2ldLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBqPTA7ajxjaGlsZENvb3JkaW5hdGVzLmxlbmd0aDtqKyspe2srKztjb29yZGluYXRlc1trXT1jaGlsZENvb3JkaW5hdGVzW2pdO319XG5yZXR1cm4gY29vcmRpbmF0ZXM7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0TnVtUG9pbnRzPWZ1bmN0aW9uKCl7dmFyIG51bVBvaW50cz10aGlzLnNoZWxsLmdldE51bVBvaW50cygpO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtudW1Qb2ludHMrPXRoaXMuaG9sZXNbaV0uZ2V0TnVtUG9pbnRzKCk7fVxucmV0dXJuIG51bVBvaW50czt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5pc0VtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGwuaXNFbXB0eSgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmlzUmVjdGFuZ2xlPWZ1bmN0aW9uKCl7aWYodGhpcy5nZXROdW1JbnRlcmlvclJpbmcoKSE9MClyZXR1cm4gZmFsc2U7aWYodGhpcy5zaGVsbD09bnVsbClyZXR1cm4gZmFsc2U7aWYodGhpcy5zaGVsbC5nZXROdW1Qb2ludHMoKSE9NSlyZXR1cm4gZmFsc2U7dmFyIHNlcT10aGlzLnNoZWxsLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpO3ZhciBlbnY9dGhpcy5nZXRFbnZlbG9wZUludGVybmFsKCk7Zm9yKHZhciBpPTA7aTw1O2krKyl7dmFyIHg9c2VxW2ldLng7aWYoISh4PT1lbnYuZ2V0TWluWCgpfHx4PT1lbnYuZ2V0TWF4WCgpKSlyZXR1cm4gZmFsc2U7dmFyIHk9c2VxW2ldLnk7aWYoISh5PT1lbnYuZ2V0TWluWSgpfHx5PT1lbnYuZ2V0TWF4WSgpKSlyZXR1cm4gZmFsc2U7fVxudmFyIHByZXZYPXNlcVswXS54O3ZhciBwcmV2WT1zZXFbMF0ueTtmb3IodmFyIGk9MTtpPD00O2krKyl7dmFyIHg9c2VxW2ldLng7dmFyIHk9c2VxW2ldLnk7dmFyIHhDaGFuZ2VkPXghPXByZXZYO3ZhciB5Q2hhbmdlZD15IT1wcmV2WTtpZih4Q2hhbmdlZD09eUNoYW5nZWQpXG5yZXR1cm4gZmFsc2U7cHJldlg9eDtwcmV2WT15O31cbnJldHVybiB0cnVlO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEV4dGVyaW9yUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNoZWxsO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEludGVyaW9yUmluZ049ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuaG9sZXNbbl07fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0TnVtSW50ZXJpb3JSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaG9sZXMubGVuZ3RoO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEFyZWE9ZnVuY3Rpb24oKXt2YXIgYXJlYT0wLjA7YXJlYSs9TWF0aC5hYnMoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLnNpZ25lZEFyZWEodGhpcy5zaGVsbC5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSkpO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXthcmVhLT1NYXRoLmFicyhqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuc2lnbmVkQXJlYSh0aGlzLmhvbGVzW2ldLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpKSk7fVxucmV0dXJuIGFyZWE7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIGxlbj0wLjA7bGVuKz10aGlzLnNoZWxsLmdldExlbmd0aCgpO2Zvcih2YXIgaT0wO2k8dGhpcy5ob2xlcy5sZW5ndGg7aSsrKXtsZW4rPXRoaXMuaG9sZXNbaV0uZ2V0TGVuZ3RoKCk7fVxucmV0dXJuIGxlbjt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5nZXRCb3VuZGFyeT1mdW5jdGlvbigpe2lmKHRoaXMuaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKG51bGwpO31cbnZhciByaW5ncz1bXTtyaW5nc1swXT10aGlzLnNoZWxsLmNsb25lKCk7Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7cmluZ3NbaSsxXT10aGlzLmhvbGVzW2ldLmNsb25lKCk7fVxuaWYocmluZ3MubGVuZ3RoPD0xKVxucmV0dXJuIHJpbmdzWzBdO3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcocmluZ3MpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmNvbXB1dGVFbnZlbG9wZUludGVybmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hlbGwuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiAyO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmdldEJvdW5kYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKCl7cmV0dXJuIDE7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtpZighdGhpcy5pc0VxdWl2YWxlbnRDbGFzcyhvdGhlcikpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmlzRW1wdHkoKSYmb3RoZXIuaXNFbXB0eSgpKXtyZXR1cm4gdHJ1ZTt9XG5pZih0aGlzLmlzRW1wdHkoKSE9PW90aGVyLmlzRW1wdHkoKSl7cmV0dXJuIGZhbHNlO31cbmlmKCF0aGlzLnNoZWxsLmVxdWFsc0V4YWN0KG90aGVyLnNoZWxsLHRvbGVyYW5jZSkpe3JldHVybiBmYWxzZTt9XG5pZih0aGlzLmhvbGVzLmxlbmd0aCE9PW90aGVyLmhvbGVzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaG9sZXMubGVuZ3RoIT09b3RoZXIuaG9sZXMubGVuZ3RoKXtyZXR1cm4gZmFsc2U7fVxuZm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe2lmKCEodGhpcy5ob2xlc1tpXSkuZXF1YWxzRXhhY3Qob3RoZXIuaG9sZXNbaV0sdG9sZXJhbmNlKSl7cmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5jb21wYXJlVG9TYW1lQ2xhc3M9ZnVuY3Rpb24obyl7cmV0dXJuIHRoaXMuc2hlbGwuY29tcGFyZVRvU2FtZUNsYXNzKG8uc2hlbGwpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKGZpbHRlcil7aWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO3RoaXMuc2hlbGwuYXBwbHkoZmlsdGVyKTtmb3IodmFyIGk9MCxsZW49dGhpcy5ob2xlcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmhvbGVzW2ldLmFwcGx5KGZpbHRlcik7fX1lbHNlIGlmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcil7ZmlsdGVyLmZpbHRlcih0aGlzKTt9ZWxzZSBpZihmaWx0ZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlcil7dGhpcy5zaGVsbC5hcHBseShmaWx0ZXIpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmhvbGVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuaG9sZXNbaV0uYXBwbHkoZmlsdGVyKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcil7dGhpcy5hcHBseTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5hcHBseTI9ZnVuY3Rpb24oZmlsdGVyKXt0aGlzLnNoZWxsLmFwcGx5KGZpbHRlcik7aWYoIWZpbHRlci5pc0RvbmUoKSl7Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe3RoaXMuaG9sZXNbaV0uYXBwbHkoZmlsdGVyKTtpZihmaWx0ZXIuaXNEb25lKCkpXG5icmVhazt9fVxuaWYoZmlsdGVyLmlzR2VvbWV0cnlDaGFuZ2VkKCkpe319O2pzdHMuZ2VvbS5Qb2x5Z29uLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBob2xlcz1bXTtmb3IodmFyIGk9MCxsZW49dGhpcy5ob2xlcy5sZW5ndGg7aTxsZW47aSsrKXtob2xlcy5wdXNoKHRoaXMuaG9sZXNbaV0uY2xvbmUoKSk7fVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVQb2x5Z29uKHRoaXMuc2hlbGwuY2xvbmUoKSxob2xlcyk7fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7dGhpcy5ub3JtYWxpemUyKHRoaXMuc2hlbGwsdHJ1ZSk7Zm9yKHZhciBpPTAsbGVuPXRoaXMuaG9sZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5ub3JtYWxpemUyKHRoaXMuaG9sZXNbaV0sZmFsc2UpO31cbnRoaXMuaG9sZXMuc29ydCgpO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLm5vcm1hbGl6ZTI9ZnVuY3Rpb24ocmluZyxjbG9ja3dpc2Upe2lmKHJpbmcuaXNFbXB0eSgpKXtyZXR1cm47fVxudmFyIHVuaXF1ZUNvb3JkaW5hdGVzPXJpbmcucG9pbnRzLnNsaWNlKDAscmluZy5wb2ludHMubGVuZ3RoLTEpO3ZhciBtaW5Db29yZGluYXRlPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLm1pbkNvb3JkaW5hdGUocmluZy5wb2ludHMpO2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnNjcm9sbCh1bmlxdWVDb29yZGluYXRlcyxtaW5Db29yZGluYXRlKTtyaW5nLnBvaW50cz11bmlxdWVDb29yZGluYXRlcy5jb25jYXQoKTtyaW5nLnBvaW50c1t1bmlxdWVDb29yZGluYXRlcy5sZW5ndGhdPXVuaXF1ZUNvb3JkaW5hdGVzWzBdO2lmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhyaW5nLnBvaW50cyk9PT1jbG9ja3dpc2Upe3JpbmcucG9pbnRzLnJldmVyc2UoKTt9fTtqc3RzLmdlb20uUG9seWdvbi5wcm90b3R5cGUuZ2V0R2VvbWV0cnlUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuJ1BvbHlnb24nO307anN0cy5nZW9tLlBvbHlnb24ucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5Qb2x5Z29uJzt9KSgpOyhmdW5jdGlvbigpe3ZhciBHZW9tZXRyeT1qc3RzLmdlb20uR2VvbWV0cnk7dmFyIFRyZWVTZXQ9amF2YXNjcmlwdC51dGlsLlRyZWVTZXQ7dmFyIEFycmF5cz1qYXZhc2NyaXB0LnV0aWwuQXJyYXlzO2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbWV0cmllcyxmYWN0b3J5KXt0aGlzLmdlb21ldHJpZXM9Z2VvbWV0cmllc3x8W107dGhpcy5mYWN0b3J5PWZhY3Rvcnk7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZT1uZXcgR2VvbWV0cnkoKTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb247anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuaXNFbXB0eT1mdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO2lmKCFnZW9tZXRyeS5pc0VtcHR5KCkpe3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRBcmVhPWZ1bmN0aW9uKCl7dmFyIGFyZWE9MC4wO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7YXJlYSs9dGhpcy5nZXRHZW9tZXRyeU4oaSkuZ2V0QXJlYSgpO31cbnJldHVybiBhcmVhO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0TGVuZ3RoPWZ1bmN0aW9uKCl7dmFyIGxlbmd0aD0wLjA7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXtsZW5ndGgrPXRoaXMuZ2V0R2VvbWV0cnlOKGkpLmdldExlbmd0aCgpO31cbnJldHVybiBsZW5ndGg7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpXG5yZXR1cm4gbnVsbDtyZXR1cm4gdGhpcy5nZXRHZW9tZXRyeU4oMCkuZ2V0Q29vcmRpbmF0ZSgpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXt2YXIgY29vcmRpbmF0ZXM9W107dmFyIGs9LTE7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt2YXIgZ2VvbWV0cnk9dGhpcy5nZXRHZW9tZXRyeU4oaSk7dmFyIGNoaWxkQ29vcmRpbmF0ZXM9Z2VvbWV0cnkuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGo9MDtqPGNoaWxkQ29vcmRpbmF0ZXMubGVuZ3RoO2orKyl7aysrO2Nvb3JkaW5hdGVzW2tdPWNoaWxkQ29vcmRpbmF0ZXNbal07fX1cbnJldHVybiBjb29yZGluYXRlczt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldE51bUdlb21ldHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZW9tZXRyaWVzLmxlbmd0aDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldEdlb21ldHJ5Tj1mdW5jdGlvbihuKXt2YXIgZ2VvbWV0cnk9dGhpcy5nZW9tZXRyaWVzW25dO2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe2dlb21ldHJ5PW5ldyBqc3RzLmdlb20uUG9pbnQoZ2VvbWV0cnkpO31cbnJldHVybiBnZW9tZXRyeTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldE51bVBvaW50cz1mdW5jdGlvbihuKXt2YXIgbnVtUG9pbnRzPTA7Zm9yKHZhciBpPTA7aTx0aGlzLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7bnVtUG9pbnRzKz10aGlzLmdlb21ldHJpZXNbaV0uZ2V0TnVtUG9pbnRzKCk7fVxucmV0dXJuIG51bVBvaW50czt9XG5qc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuZ2VvbWV0cmllcy5sZW5ndGghPT1vdGhlci5nZW9tZXRyaWVzLmxlbmd0aCl7cmV0dXJuIGZhbHNlO31cbmZvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO2lmKCFnZW9tZXRyeS5lcXVhbHNFeGFjdChvdGhlci5nZXRHZW9tZXRyeU4oaSksdG9sZXJhbmNlKSl7cmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGdlb21ldHJpZXM9W107Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXtnZW9tZXRyaWVzLnB1c2godGhpcy5nZW9tZXRyaWVzW2ldLmNsb25lKCkpO31cbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlR2VvbWV0cnlDb2xsZWN0aW9uKGdlb21ldHJpZXMpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZ2VvbWV0cmllcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmdldEdlb21ldHJ5TihpKS5ub3JtYWxpemUoKTt9XG50aGlzLmdlb21ldHJpZXMuc29ydCgpO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuY29tcGFyZVRvU2FtZUNsYXNzPWZ1bmN0aW9uKG8pe3ZhciB0aGVzZUVsZW1lbnRzPW5ldyBUcmVlU2V0KEFycmF5cy5hc0xpc3QodGhpcy5nZW9tZXRyaWVzKSk7dmFyIG90aGVyRWxlbWVudHM9bmV3IFRyZWVTZXQoQXJyYXlzLmFzTGlzdChvLmdlb21ldHJpZXMpKTtyZXR1cm4gdGhpcy5jb21wYXJlKHRoZXNlRWxlbWVudHMsb3RoZXJFbGVtZW50cyk7fTtqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5hcHBseT1mdW5jdGlvbihmaWx0ZXIpe2lmKGZpbHRlciBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcnx8ZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKXtmaWx0ZXIuZmlsdGVyKHRoaXMpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5nZXRHZW9tZXRyeU4oaSkuYXBwbHkoZmlsdGVyKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVGaWx0ZXIpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5nZXRHZW9tZXRyeU4oaSkuYXBwbHkoZmlsdGVyKTt9fWVsc2UgaWYoZmlsdGVyIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcil7dGhpcy5hcHBseTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO319O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmFwcGx5Mj1mdW5jdGlvbihmaWx0ZXIpe2lmKHRoaXMuZ2VvbWV0cmllcy5sZW5ndGg9PTApXG5yZXR1cm47Zm9yKHZhciBpPTA7aTx0aGlzLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7dGhpcy5nZW9tZXRyaWVzW2ldLmFwcGx5KGZpbHRlcik7aWYoZmlsdGVyLmlzRG9uZSgpKXticmVhazt9fVxuaWYoZmlsdGVyLmlzR2VvbWV0cnlDaGFuZ2VkKCkpe319O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmdldERpbWVuc2lvbj1mdW5jdGlvbigpe3ZhciBkaW1lbnNpb249anN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTtmb3IodmFyIGk9MCxsZW49dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBnZW9tZXRyeT10aGlzLmdldEdlb21ldHJ5TihpKTtkaW1lbnNpb249TWF0aC5tYXgoZGltZW5zaW9uLGdlb21ldHJ5LmdldERpbWVuc2lvbigpKTt9XG5yZXR1cm4gZGltZW5zaW9uO307anN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbi5wcm90b3R5cGUuY29tcHV0ZUVudmVsb3BlSW50ZXJuYWw9ZnVuY3Rpb24oKXt2YXIgZW52ZWxvcGU9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2Zvcih2YXIgaT0wLGxlbj10aGlzLmdlb21ldHJpZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGdlb21ldHJ5PXRoaXMuZ2V0R2VvbWV0cnlOKGkpO2VudmVsb3BlLmV4cGFuZFRvSW5jbHVkZShnZW9tZXRyeS5nZXRFbnZlbG9wZUludGVybmFsKCkpO31cbnJldHVybiBlbnZlbG9wZTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24nO30pKCk7anN0cy5hbGdvcml0aG0uQ2VudHJvaWQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMuYXJlYUJhc2VQdD1udWxsO3RoaXMudHJpYW5nbGVDZW50Mz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLmFyZWFzdW0yPTA7dGhpcy5jZzM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5saW5lQ2VudFN1bT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLnRvdGFsTGVuZ3RoPTA7dGhpcy5wdENvdW50PTA7dGhpcy5wdENlbnRTdW09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5hZGQoZ2VvbWV0cnkpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBjZW50PW5ldyBqc3RzLmFsZ29yaXRobS5DZW50cm9pZChnZW9tZXRyeSk7cmV0dXJuIGNlbnQuZ2V0Q2VudHJvaWQoKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmNlbnRyb2lkMz1mdW5jdGlvbihwMSxwMixwMyxjKXtjLng9cDEueCtwMi54K3AzLng7Yy55PXAxLnkrcDIueStwMy55O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQuYXJlYTI9ZnVuY3Rpb24ocDEscDIscDMpe3JldHVybihwMi54LXAxLngpKihwMy55LXAxLnkpLShwMy54LXAxLngpKihwMi55LXAxLnkpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tKXtpZihnZW9tLmlzRW1wdHkoKSl7cmV0dXJuO31cbmlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuYWRkUG9pbnQoZ2VvbS5nZXRDb29yZGluYXRlKCkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7dGhpcy5hZGRMaW5lU2VnbWVudHMoZ2VvbS5nZXRDb29yZGluYXRlcygpKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3RoaXMuYWRkUG9seWdvbihnZW9tKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdlb20uZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmdldENlbnRyb2lkPWZ1bmN0aW9uKCl7dmFyIGNlbnQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7aWYoTWF0aC5hYnModGhpcy5hcmVhc3VtMik+MCl7Y2VudC54PXRoaXMuY2czLngvMy90aGlzLmFyZWFzdW0yO2NlbnQueT10aGlzLmNnMy55LzMvdGhpcy5hcmVhc3VtMjt9ZWxzZSBpZih0aGlzLnRvdGFsTGVuZ3RoPjApe2NlbnQueD10aGlzLmxpbmVDZW50U3VtLngvdGhpcy50b3RhbExlbmd0aDtjZW50Lnk9dGhpcy5saW5lQ2VudFN1bS55L3RoaXMudG90YWxMZW5ndGg7fWVsc2UgaWYodGhpcy5wdENvdW50PjApe2NlbnQueD10aGlzLnB0Q2VudFN1bS54L3RoaXMucHRDb3VudDtjZW50Lnk9dGhpcy5wdENlbnRTdW0ueS90aGlzLnB0Q291bnQ7fWVsc2V7cmV0dXJuIG51bGw7fVxucmV0dXJuIGNlbnQ7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuc2V0QmFzZVBvaW50PWZ1bmN0aW9uKGJhc2VQdCl7aWYodGhpcy5hcmVhQmFzZVB0PT09bnVsbCl7dGhpcy5hcmVhQmFzZVB0PWJhc2VQdDt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkUG9seWdvbj1mdW5jdGlvbihwb2x5KXt0aGlzLmFkZFNoZWxsKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5hZGRIb2xlKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKS5nZXRDb29yZGluYXRlcygpKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkU2hlbGw9ZnVuY3Rpb24ocHRzKXtpZihwdHMubGVuZ3RoPjApe3RoaXMuc2V0QmFzZVBvaW50KHB0c1swXSk7fVxudmFyIGlzUG9zaXRpdmVBcmVhPSFqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5hcmVhQmFzZVB0LHB0c1tpXSxwdHNbaSsxXSxpc1Bvc2l0aXZlQXJlYSk7fVxudGhpcy5hZGRMaW5lU2VnbWVudHMocHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGRIb2xlPWZ1bmN0aW9uKHB0cyl7dmFyIGlzUG9zaXRpdmVBcmVhPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhwdHMpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5hZGRUcmlhbmdsZSh0aGlzLmFyZWFCYXNlUHQscHRzW2ldLHB0c1tpKzFdLGlzUG9zaXRpdmVBcmVhKTt9XG50aGlzLmFkZExpbmVTZWdtZW50cyhwdHMpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWQucHJvdG90eXBlLmFkZFRyaWFuZ2xlPWZ1bmN0aW9uKHAwLHAxLHAyLGlzUG9zaXRpdmVBcmVhKXt2YXIgc2lnbj0oaXNQb3NpdGl2ZUFyZWEpPzE6LTE7anN0cy5hbGdvcml0aG0uQ2VudHJvaWQuY2VudHJvaWQzKHAwLHAxLHAyLHRoaXMudHJpYW5nbGVDZW50Myk7dmFyIGFyZWEyPWpzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLmFyZWEyKHAwLHAxLHAyKTt0aGlzLmNnMy54Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My54O3RoaXMuY2czLnkrPXNpZ24qYXJlYTIqdGhpcy50cmlhbmdsZUNlbnQzLnk7dGhpcy5hcmVhc3VtMis9c2lnbiphcmVhMjt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkLnByb3RvdHlwZS5hZGRMaW5lU2VnbWVudHM9ZnVuY3Rpb24ocHRzKXt2YXIgbGluZUxlbj0wO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ21lbnRMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTtpZihzZWdtZW50TGVuPT09MCl7Y29udGludWU7fVxubGluZUxlbis9c2VnbWVudExlbjt2YXIgbWlkeD0ocHRzW2ldLngrcHRzW2krMV0ueCkvMjt0aGlzLmxpbmVDZW50U3VtLngrPXNlZ21lbnRMZW4qbWlkeDt2YXIgbWlkeT0ocHRzW2ldLnkrcHRzW2krMV0ueSkvMjt0aGlzLmxpbmVDZW50U3VtLnkrPXNlZ21lbnRMZW4qbWlkeTt9XG50aGlzLnRvdGFsTGVuZ3RoKz1saW5lTGVuO2lmKGxpbmVMZW49PT0wJiZwdHMubGVuZ3RoPjApe3RoaXMuYWRkUG9pbnQocHRzWzBdKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZC5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24ocHQpe3RoaXMucHRDb3VudCs9MTt0aGlzLnB0Q2VudFN1bS54Kz1wdC54O3RoaXMucHRDZW50U3VtLnkrPXB0Lnk7fTsoZnVuY3Rpb24oKXt2YXIgRWRnZVJpbmc9ZnVuY3Rpb24oZmFjdG9yeSl7dGhpcy5kZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O0VkZ2VSaW5nLmZpbmRFZGdlUmluZ0NvbnRhaW5pbmc9ZnVuY3Rpb24odGVzdEVyLHNoZWxsTGlzdCl7dmFyIHRlc3RSaW5nPXRlc3RFci5nZXRSaW5nKCk7dmFyIHRlc3RFbnY9dGVzdFJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciB0ZXN0UHQ9dGVzdFJpbmcuZ2V0Q29vcmRpbmF0ZU4oMCk7dmFyIG1pblNoZWxsPW51bGw7dmFyIG1pbkVudj1udWxsO2Zvcih2YXIgaXQ9c2hlbGxMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIHRyeVNoZWxsPWl0Lm5leHQoKTt2YXIgdHJ5UmluZz10cnlTaGVsbC5nZXRSaW5nKCk7dmFyIHRyeUVudj10cnlSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZihtaW5TaGVsbCE9bnVsbClcbm1pbkVudj1taW5TaGVsbC5nZXRSaW5nKCkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBpc0NvbnRhaW5lZD1mYWxzZTtpZih0cnlFbnYuZXF1YWxzKHRlc3RFbnYpKVxuY29udGludWU7dGVzdFB0PWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnB0Tm90SW5MaXN0KHRlc3RSaW5nLmdldENvb3JkaW5hdGVzKCksdHJ5UmluZy5nZXRDb29yZGluYXRlcygpKTtpZih0cnlFbnYuY29udGFpbnModGVzdEVudikmJmpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHRlc3RQdCx0cnlSaW5nLmdldENvb3JkaW5hdGVzKCkpKVxuaXNDb250YWluZWQ9dHJ1ZTtpZihpc0NvbnRhaW5lZCl7aWYobWluU2hlbGw9PW51bGx8fG1pbkVudi5jb250YWlucyh0cnlFbnYpKXttaW5TaGVsbD10cnlTaGVsbDt9fX1cbnJldHVybiBtaW5TaGVsbDt9O0VkZ2VSaW5nLnB0Tm90SW5MaXN0PWZ1bmN0aW9uKHRlc3RQdHMscHRzKXtmb3IodmFyIGk9MDtpPHRlc3RQdHMubGVuZ3RoO2krKyl7dmFyIHRlc3RQdD10ZXN0UHRzW2ldO2lmKCFpc0luTGlzdCh0ZXN0UHQscHRzKSlcbnJldHVybiB0ZXN0UHQ7fVxucmV0dXJuIG51bGw7fTtFZGdlUmluZy5pc0luTGlzdD1mdW5jdGlvbihwdCxwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe2lmKHB0LmVxdWFscyhwdHNbaV0pKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO31cbkVkZ2VSaW5nLnByb3RvdHlwZS5mYWN0b3J5PW51bGw7RWRnZVJpbmcucHJvdG90eXBlLmRlTGlzdD1udWxsO0VkZ2VSaW5nLnByb3RvdHlwZS5yaW5nPW51bGw7RWRnZVJpbmcucHJvdG90eXBlLnJpbmdQdHM9bnVsbDtFZGdlUmluZy5wcm90b3R5cGUuaG9sZXM9bnVsbDtFZGdlUmluZy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGRlKXt0aGlzLmRlTGlzdC5hZGQoZGUpO307RWRnZVJpbmcucHJvdG90eXBlLmlzSG9sZT1mdW5jdGlvbigpe3ZhciByaW5nPXRoaXMuZ2V0UmluZygpO3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocmluZy5nZXRDb29yZGluYXRlcygpKTt9O0VkZ2VSaW5nLnByb3RvdHlwZS5hZGRIb2xlPWZ1bmN0aW9uKGhvbGUpe2lmKHRoaXMuaG9sZXM9PW51bGwpXG50aGlzLmhvbGVzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5ob2xlcy5hZGQoaG9sZSk7fTtFZGdlUmluZy5wcm90b3R5cGUuZ2V0UG9seWdvbj1mdW5jdGlvbigpe3ZhciBob2xlTFI9bnVsbDtpZih0aGlzLmhvbGVzIT1udWxsKXtob2xlTFI9W107Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLnNpemUoKTtpKyspe2hvbGVMUltpXT10aGlzLmhvbGVzLmdldChpKTt9fVxudmFyIHBvbHk9dGhpcy5mYWN0b3J5LmNyZWF0ZVBvbHlnb24odGhpcy5yaW5nLGhvbGVMUik7cmV0dXJuIHBvbHk7fTtFZGdlUmluZy5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3RoaXMuZ2V0Q29vcmRpbmF0ZXMoKTtpZih0aGlzLnJpbmdQdHMubGVuZ3RoPD0zKVxucmV0dXJuIGZhbHNlO3RoaXMuZ2V0UmluZygpO3JldHVybiB0aGlzLnJpbmcuaXNWYWxpZCgpO307RWRnZVJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7aWYodGhpcy5yaW5nUHRzPT1udWxsKXt2YXIgY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoKTtmb3IodmFyIGk9dGhpcy5kZUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTt2YXIgZWRnZT1kZS5nZXRFZGdlKCk7RWRnZVJpbmcuYWRkRWRnZShlZGdlLmdldExpbmUoKS5nZXRDb29yZGluYXRlcygpLGRlLmdldEVkZ2VEaXJlY3Rpb24oKSxjb29yZExpc3QpO31cbnRoaXMucmluZ1B0cz1jb29yZExpc3QudG9Db29yZGluYXRlQXJyYXkoKTt9XG5yZXR1cm4gdGhpcy5yaW5nUHRzO307RWRnZVJpbmcucHJvdG90eXBlLmdldExpbmVTdHJpbmc9ZnVuY3Rpb24oKXt0aGlzLmdldENvb3JkaW5hdGVzKCk7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMucmluZ1B0cyk7fTtFZGdlUmluZy5wcm90b3R5cGUuZ2V0UmluZz1mdW5jdGlvbigpe2lmKHRoaXMucmluZyE9bnVsbClcbnJldHVybiB0aGlzLnJpbmc7dGhpcy5nZXRDb29yZGluYXRlcygpO2lmKHRoaXMucmluZ1B0cy5sZW5ndGg8MylcbmNvbnNvbGUubG9nKHRoaXMucmluZ1B0cyk7dHJ5e3RoaXMucmluZz10aGlzLmZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyh0aGlzLnJpbmdQdHMpO31jYXRjaChleCl7Y29uc29sZS5sb2codGhpcy5yaW5nUHRzKTt9XG5yZXR1cm4gdGhpcy5yaW5nO307RWRnZVJpbmcuYWRkRWRnZT1mdW5jdGlvbihjb29yZHMsaXNGb3J3YXJkLGNvb3JkTGlzdCl7aWYoaXNGb3J3YXJkKXtmb3IodmFyIGk9MDtpPGNvb3Jkcy5sZW5ndGg7aSsrKXtjb29yZExpc3QuYWRkKGNvb3Jkc1tpXSxmYWxzZSk7fX1lbHNle2Zvcih2YXIgaT1jb29yZHMubGVuZ3RoLTE7aT49MDtpLS0pe2Nvb3JkTGlzdC5hZGQoY29vcmRzW2ldLGZhbHNlKTt9fX07anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5FZGdlUmluZz1FZGdlUmluZzt9KSgpOyhmdW5jdGlvbigpe3ZhciBHcmFwaENvbXBvbmVudD1mdW5jdGlvbigpe307R3JhcGhDb21wb25lbnQuc2V0VmlzaXRlZD1mdW5jdGlvbihpLHZpc2l0ZWQpe3doaWxlKGkuaGFzTmV4dCgpKXt2YXIgY29tcD1pLm5leHQoKTtjb21wLnNldFZpc2l0ZWQodmlzaXRlZCk7fX07R3JhcGhDb21wb25lbnQuc2V0TWFya2VkPWZ1bmN0aW9uKGksbWFya2VkKXt3aGlsZShpLmhhc05leHQoKSl7dmFyIGNvbXA9aS5uZXh0KCk7Y29tcC5zZXRNYXJrZWQobWFya2VkKTt9fTtHcmFwaENvbXBvbmVudC5nZXRDb21wb25lbnRXaXRoVmlzaXRlZFN0YXRlPWZ1bmN0aW9uKGksdmlzaXRlZFN0YXRlKXt3aGlsZShpLmhhc05leHQoKSl7dmFyIGNvbXA9aS5uZXh0KCk7aWYoY29tcC5pc1Zpc2l0ZWQoKT09dmlzaXRlZFN0YXRlKVxucmV0dXJuIGNvbXA7fVxucmV0dXJuIG51bGw7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuX2lzTWFya2VkPWZhbHNlO0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5faXNWaXNpdGVkPWZhbHNlO0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5kYXRhO0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5pc1Zpc2l0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWaXNpdGVkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldFZpc2l0ZWQ9ZnVuY3Rpb24oaXNWaXNpdGVkKXt0aGlzLl9pc1Zpc2l0ZWQ9aXNWaXNpdGVkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLmlzTWFya2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzTWFya2VkO307R3JhcGhDb21wb25lbnQucHJvdG90eXBlLnNldE1hcmtlZD1mdW5jdGlvbihpc01hcmtlZCl7dGhpcy5faXNNYXJrZWQ9aXNNYXJrZWQ7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0Q29udGV4dD1mdW5jdGlvbihkYXRhKXt0aGlzLmRhdGE9ZGF0YTt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5nZXRDb250ZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIGRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuc2V0RGF0YT1mdW5jdGlvbihkYXRhKXt0aGlzLmRhdGE9ZGF0YTt9O0dyYXBoQ29tcG9uZW50LnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIGRhdGE7fTtHcmFwaENvbXBvbmVudC5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMucGxhbmFyZ3JhcGguR3JhcGhDb21wb25lbnQ9R3JhcGhDb21wb25lbnQ7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR3JhcGhDb21wb25lbnQ9anN0cy5wbGFuYXJncmFwaC5HcmFwaENvbXBvbmVudDt2YXIgRWRnZT1mdW5jdGlvbihkZTAsZGUxKXtpZihkZTA9PT11bmRlZmluZWQpe3JldHVybjt9XG50aGlzLnNldERpcmVjdGVkRWRnZXMoZGUwLGRlMSk7fTtFZGdlLnByb3RvdHlwZT1uZXcgR3JhcGhDb21wb25lbnQoKTtFZGdlLnByb3RvdHlwZS5kaXJFZGdlPW51bGw7RWRnZS5wcm90b3R5cGUuc2V0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbihkZTAsZGUxKXt0aGlzLmRpckVkZ2U9W2RlMCxkZTFdO2RlMC5zZXRFZGdlKHRoaXMpO2RlMS5zZXRFZGdlKHRoaXMpO2RlMC5zZXRTeW0oZGUxKTtkZTEuc2V0U3ltKGRlMCk7ZGUwLmdldEZyb21Ob2RlKCkuYWRkT3V0RWRnZShkZTApO2RlMS5nZXRGcm9tTm9kZSgpLmFkZE91dEVkZ2UoZGUxKTt9O0VkZ2UucHJvdG90eXBlLmdldERpckVkZ2U9ZnVuY3Rpb24oaSl7aWYoaSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguTm9kZSl7dGhpcy5nZXREaXJFZGdlMihpKTt9XG5yZXR1cm4gdGhpcy5kaXJFZGdlW2ldO307RWRnZS5wcm90b3R5cGUuZ2V0RGlyRWRnZTI9ZnVuY3Rpb24oZnJvbU5vZGUpe2lmKHRoaXMuZGlyRWRnZVswXS5nZXRGcm9tTm9kZSgpPT1mcm9tTm9kZSlcbnJldHVybiB0aGlzLmRpckVkZ2VbMF07aWYodGhpcy5kaXJFZGdlWzFdLmdldEZyb21Ob2RlKCk9PWZyb21Ob2RlKVxucmV0dXJuIHRoaXMuZGlyRWRnZVsxXTtyZXR1cm4gbnVsbDt9O0VkZ2UucHJvdG90eXBlLmdldE9wcG9zaXRlTm9kZT1mdW5jdGlvbihub2RlKXtpZih0aGlzLmRpckVkZ2VbMF0uZ2V0RnJvbU5vZGUoKT09bm9kZSlcbnJldHVybiB0aGlzLmRpckVkZ2VbMF0uZ2V0VG9Ob2RlKCk7aWYodGhpcy5kaXJFZGdlWzFdLmdldEZyb21Ob2RlKCk9PW5vZGUpXG5yZXR1cm4gdGhpcy5kaXJFZGdlWzFdLmdldFRvTm9kZSgpO3JldHVybiBudWxsO307RWRnZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhpcy5kaXJFZGdlPW51bGw7fTtFZGdlLnByb3RvdHlwZS5pc1JlbW92ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gZGlyRWRnZT09bnVsbDt9O2pzdHMucGxhbmFyZ3JhcGguRWRnZT1FZGdlO30pKCk7anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZT1mdW5jdGlvbihsaW5lKXt0aGlzLmxpbmU9bGluZTt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZUVkZ2UucHJvdG90eXBlPW5ldyBqc3RzLnBsYW5hcmdyYXBoLkVkZ2UoKTtqc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVFZGdlLnByb3RvdHlwZS5saW5lPW51bGw7anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplRWRnZS5wcm90b3R5cGUuZ2V0TGluZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxpbmU7fTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIEdyYXBoQ29tcG9uZW50PWpzdHMucGxhbmFyZ3JhcGguR3JhcGhDb21wb25lbnQ7dmFyIERpcmVjdGVkRWRnZT1mdW5jdGlvbihmcm9tLHRvLGRpcmVjdGlvblB0LGVkZ2VEaXJlY3Rpb24pe2lmKGZyb209PT11bmRlZmluZWQpe3JldHVybjt9XG50aGlzLmZyb209ZnJvbTt0aGlzLnRvPXRvO3RoaXMuZWRnZURpcmVjdGlvbj1lZGdlRGlyZWN0aW9uO3RoaXMucDA9ZnJvbS5nZXRDb29yZGluYXRlKCk7dGhpcy5wMT1kaXJlY3Rpb25QdDt2YXIgZHg9dGhpcy5wMS54LXRoaXMucDAueDt2YXIgZHk9dGhpcy5wMS55LXRoaXMucDAueTt0aGlzLnF1YWRyYW50PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KGR4LGR5KTt0aGlzLmFuZ2xlPU1hdGguYXRhbjIoZHksZHgpO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZT1uZXcgR3JhcGhDb21wb25lbnQoKTtEaXJlY3RlZEVkZ2UudG9FZGdlcz1mdW5jdGlvbihkaXJFZGdlcyl7dmFyIGVkZ2VzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe2VkZ2VzLmFkZCgoaS5uZXh0KCkpLnBhcmVudEVkZ2UpO31cbnJldHVybiBlZGdlczt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucGFyZW50RWRnZT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZnJvbT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUudG89bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnAwPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5wMT1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuc3ltPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5lZGdlRGlyZWN0aW9uPW51bGw7RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5xdWFkcmFudD1udWxsO0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuYW5nbGU9bnVsbDtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEVkZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnRFZGdlO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRFZGdlPWZ1bmN0aW9uKHBhcmVudEVkZ2Upe3RoaXMucGFyZW50RWRnZT1wYXJlbnRFZGdlO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRRdWFkcmFudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnF1YWRyYW50O307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXREaXJlY3Rpb25QdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAxO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRFZGdlRGlyZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZURpcmVjdGlvbjt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RnJvbU5vZGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mcm9tO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRUb05vZGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50bzt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZyb20uZ2V0Q29vcmRpbmF0ZSgpO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRBbmdsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFuZ2xlO307RGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRTeW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW07fTtEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldFN5bT1mdW5jdGlvbihzeW0pe3RoaXMuc3ltPXN5bTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhpcy5zeW09bnVsbDt0aGlzLnBhcmVudEVkZ2U9bnVsbDt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGFyZW50RWRnZT09bnVsbDt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG9iail7dmFyIGRlPW9iajtyZXR1cm4gdGhpcy5jb21wYXJlRGlyZWN0aW9uKGRlKTt9O0RpcmVjdGVkRWRnZS5wcm90b3R5cGUuY29tcGFyZURpcmVjdGlvbj1mdW5jdGlvbihlKXtpZih0aGlzLnF1YWRyYW50PmUucXVhZHJhbnQpXG5yZXR1cm4gMTtpZih0aGlzLnF1YWRyYW50PGUucXVhZHJhbnQpXG5yZXR1cm4tMTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihlLnAwLGUucDEsdGhpcy5wMSk7fTtqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZT1EaXJlY3RlZEVkZ2U7fSkoKTsoZnVuY3Rpb24oKXt2YXIgRGlyZWN0ZWRFZGdlPWpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlO3ZhciBQb2x5Z29uaXplRGlyZWN0ZWRFZGdlPWZ1bmN0aW9uKGZyb20sdG8sZGlyZWN0aW9uUHQsZWRnZURpcmVjdGlvbil7RGlyZWN0ZWRFZGdlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlPW5ldyBEaXJlY3RlZEVkZ2UoKTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5lZGdlUmluZz1udWxsO1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLm5leHQ9bnVsbDtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5sYWJlbD0tMTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0TGFiZWw9ZnVuY3Rpb24obGFiZWwpe3RoaXMubGFiZWw9bGFiZWw7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmV4dDt9O1BvbHlnb25pemVEaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldE5leHQ9ZnVuY3Rpb24obmV4dCl7dGhpcy5uZXh0PW5leHQ7fTtQb2x5Z29uaXplRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5pc0luUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VSaW5nIT1udWxsO307UG9seWdvbml6ZURpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0UmluZz1mdW5jdGlvbihlZGdlUmluZyl7dGhpcy5lZGdlUmluZz1lZGdlUmluZzt9O2pzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZURpcmVjdGVkRWRnZT1Qb2x5Z29uaXplRGlyZWN0ZWRFZGdlO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBEaXJlY3RlZEVkZ2VTdGFyPWZ1bmN0aW9uKCl7dGhpcy5vdXRFZGdlcz1uZXcgQXJyYXlMaXN0KCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5vdXRFZGdlcz1udWxsO0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnNvcnRlZD1mYWxzZTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZGUpe3RoaXMub3V0RWRnZXMuYWRkKGRlKTt0aGlzLnNvcnRlZD1mYWxzZTt9O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihkZSl7dGhpcy5vdXRFZGdlcy5yZW1vdmUoZGUpO307RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXt0aGlzLnNvcnRFZGdlcygpO3JldHVybiB0aGlzLm91dEVkZ2VzLml0ZXJhdG9yKCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXREZWdyZWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vdXRFZGdlcy5zaXplKCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dmFyIGl0PWl0ZXJhdG9yKCk7aWYoIWl0Lmhhc05leHQoKSlcbnJldHVybiBudWxsO3ZhciBlPWl0Lm5leHQoKTtyZXR1cm4gZS5nZXRDb29yZGluYXRlKCk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3RoaXMuc29ydEVkZ2VzKCk7cmV0dXJuIHRoaXMub3V0RWRnZXM7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5zb3J0RWRnZXM9ZnVuY3Rpb24oKXtpZighdGhpcy5zb3J0ZWQpe3ZhciBhcnJheT10aGlzLm91dEVkZ2VzLnRvQXJyYXkoKTthcnJheS5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO3RoaXMub3V0RWRnZXM9amF2YXNjcmlwdC51dGlsLkFycmF5cy5hc0xpc3QoYXJyYXkpO3RoaXMuc29ydGVkPXRydWU7fX07RGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0SW5kZXg9ZnVuY3Rpb24oZWRnZSl7aWYoZWRnZSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlKXtyZXR1cm4gdGhpcy5nZXRJbmRleDIoZWRnZSk7fWVsc2UgaWYodHlwZW9mKGVkZ2UpPT09J251bWJlcicpe3JldHVybiB0aGlzLmdldEluZGV4MyhlZGdlKTt9XG50aGlzLnNvcnRFZGdlcygpO2Zvcih2YXIgaT0wO2k8dGhpcy5vdXRFZGdlcy5zaXplKCk7aSsrKXt2YXIgZGU9dGhpcy5vdXRFZGdlcy5nZXQoaSk7aWYoZGUuZ2V0RWRnZSgpPT1lZGdlKVxucmV0dXJuIGk7fVxucmV0dXJuLTE7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRJbmRleDI9ZnVuY3Rpb24oZGlyRWRnZSl7dGhpcy5zb3J0RWRnZXMoKTtmb3IodmFyIGk9MDtpPHRoaXMub3V0RWRnZXMuc2l6ZSgpO2krKyl7dmFyIGRlPXRoaXMub3V0RWRnZXMuZ2V0KGkpO2lmKGRlPT1kaXJFZGdlKVxucmV0dXJuIGk7fVxucmV0dXJuLTE7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXRJbmRleDM9ZnVuY3Rpb24oaSl7dmFyIG1vZGk9dG9JbnQoaSV0aGlzLm91dEVkZ2VzLnNpemUoKSk7aWYobW9kaTwwKVxubW9kaSs9dGhpcy5vdXRFZGdlcy5zaXplKCk7cmV0dXJuIG1vZGk7fTtEaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5nZXROZXh0RWRnZT1mdW5jdGlvbihkaXJFZGdlKXt2YXIgaT10aGlzLmdldEluZGV4KGRpckVkZ2UpO3JldHVybiB0aGlzLm91dEVkZ2VzLmdldChnZXRJbmRleChpKzEpKTt9O0RpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldE5leHRDV0VkZ2U9ZnVuY3Rpb24oZGlyRWRnZSl7dmFyIGk9dGhpcy5nZXRJbmRleChkaXJFZGdlKTtyZXR1cm4gdGhpcy5vdXRFZGdlcy5nZXQoZ2V0SW5kZXgoaS0xKSk7fTtqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZVN0YXI9RGlyZWN0ZWRFZGdlU3Rhcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBHcmFwaENvbXBvbmVudD1qc3RzLnBsYW5hcmdyYXBoLkdyYXBoQ29tcG9uZW50O3ZhciBEaXJlY3RlZEVkZ2VTdGFyPWpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhcjt2YXIgTm9kZT1mdW5jdGlvbihwdCxkZVN0YXIpe3RoaXMucHQ9cHQ7dGhpcy5kZVN0YXI9ZGVTdGFyfHxuZXcgRGlyZWN0ZWRFZGdlU3RhcigpO307Tm9kZS5wcm90b3R5cGU9bmV3IEdyYXBoQ29tcG9uZW50KCk7Tm9kZS5nZXRFZGdlc0JldHdlZW49ZnVuY3Rpb24obm9kZTAsbm9kZTEpe3ZhciBlZGdlczA9RGlyZWN0ZWRFZGdlLnRvRWRnZXMobm9kZTAuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpKTt2YXIgY29tbW9uRWRnZXM9bmV3IGphdmFzY3JpcHQudXRpbC5IYXNoU2V0KGVkZ2VzMCk7dmFyIGVkZ2VzMT1EaXJlY3RlZEVkZ2UudG9FZGdlcyhub2RlMS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCkpO2NvbW1vbkVkZ2VzLnJldGFpbkFsbChlZGdlczEpO3JldHVybiBjb21tb25FZGdlczt9O05vZGUucHJvdG90eXBlLnB0PW51bGw7Tm9kZS5wcm90b3R5cGUuZGVTdGFyPW51bGw7Tm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307Tm9kZS5wcm90b3R5cGUuYWRkT3V0RWRnZT1mdW5jdGlvbihkZSl7dGhpcy5kZVN0YXIuYWRkKGRlKTt9O05vZGUucHJvdG90eXBlLmdldE91dEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVTdGFyO307Tm9kZS5wcm90b3R5cGUuZ2V0RGVncmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGVTdGFyLmdldERlZ3JlZSgpO307Tm9kZS5wcm90b3R5cGUuZ2V0SW5kZXg9ZnVuY3Rpb24oZWRnZSl7cmV0dXJuIHRoaXMuZGVTdGFyLmdldEluZGV4KGVkZ2UpO307Tm9kZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGRlKXtpZihkZT09PXVuZGVmaW5lZCl7cmV0dXJuIHRoaXMucmVtb3ZlMigpO31cbnRoaXMuZGVTdGFyLnJlbW92ZShkZSk7fTtOb2RlLnByb3RvdHlwZS5yZW1vdmUyPWZ1bmN0aW9uKCl7dGhpcy5wdD1udWxsO307Tm9kZS5wcm90b3R5cGUuaXNSZW1vdmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ9PW51bGw7fTtqc3RzLnBsYW5hcmdyYXBoLk5vZGU9Tm9kZTt9KSgpOyhmdW5jdGlvbigpe3ZhciBOb2RlTWFwPWZ1bmN0aW9uKCl7dGhpcy5ub2RlTWFwPW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcCgpO307Tm9kZU1hcC5wcm90b3R5cGUubm9kZU1hcD1udWxsO05vZGVNYXAucHJvdG90eXBlLmFkZD1mdW5jdGlvbihuKXt0aGlzLm5vZGVNYXAucHV0KG4uZ2V0Q29vcmRpbmF0ZSgpLG4pO3JldHVybiBuO307Tm9kZU1hcC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHB0KXtyZXR1cm4gdGhpcy5ub2RlTWFwLnJlbW92ZShwdCk7fTtOb2RlTWFwLnByb3RvdHlwZS5maW5kPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gdGhpcy5ub2RlTWFwLmdldChjb29yZCk7fTtOb2RlTWFwLnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTt9O05vZGVNYXAucHJvdG90eXBlLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCk7fTtqc3RzLnBsYW5hcmdyYXBoLk5vZGVNYXA9Tm9kZU1hcDt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgUGxhbmFyR3JhcGg9ZnVuY3Rpb24oKXt0aGlzLmVkZ2VzPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaFNldCgpO3RoaXMuZGlyRWRnZXM9bmV3IGphdmFzY3JpcHQudXRpbC5IYXNoU2V0KCk7dGhpcy5ub2RlTWFwPW5ldyBqc3RzLnBsYW5hcmdyYXBoLk5vZGVNYXAoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlcz1udWxsO1BsYW5hckdyYXBoLnByb3RvdHlwZS5kaXJFZGdlcz1udWxsO1BsYW5hckdyYXBoLnByb3RvdHlwZS5ub2RlTWFwPW51bGw7UGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmROb2RlPWZ1bmN0aW9uKHB0KXtyZXR1cm4gdGhpcy5ub2RlTWFwLmZpbmQocHQpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZD1mdW5jdGlvbihub2RlKXtpZihub2RlIGluc3RhbmNlb2YganN0cy5wbGFuYXJncmFwaC5FZGdlKXtyZXR1cm4gdGhpcy5hZGQyKG5vZGUpO31lbHNlIGlmKG5vZGUgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMuYWRkMyhub2RlKTt9XG50aGlzLm5vZGVNYXAuYWRkKG5vZGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24oZWRnZSl7dGhpcy5lZGdlcy5hZGQoZWRnZSk7dGhpcy5hZGQoZWRnZS5nZXREaXJFZGdlKDApKTt0aGlzLmFkZChlZGdlLmdldERpckVkZ2UoMSkpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmFkZDM9ZnVuY3Rpb24oZGlyRWRnZSl7dGhpcy5kaXJFZGdlcy5hZGQoZGlyRWRnZSk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUubm9kZUl0ZXJhdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZU1hcC5pdGVyYXRvcigpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLkRpcmVjdGVkRWRnZSl7cmV0dXJuIHRoaXMuY29udGFpbnMyKGUpO31cbnJldHVybiB0aGlzLmVkZ2VzLmNvbnRhaW5zKGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmNvbnRhaW5zMj1mdW5jdGlvbihkZSl7cmV0dXJuIHRoaXMuZGlyRWRnZXMuY29udGFpbnMoZGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmdldE5vZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZU1hcC52YWx1ZXMoKTt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5kaXJFZGdlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXJFZGdlcy5pdGVyYXRvcigpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmVkZ2VJdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzLml0ZXJhdG9yKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O1BsYW5hckdyYXBoLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oZWRnZSl7aWYoZWRnZSBpbnN0YW5jZW9mIGpzdHMucGxhbmFyZ3JhcGguRGlyZWN0ZWRFZGdlKXtyZXR1cm4gdGhpcy5yZW1vdmUyKGVkZ2UpO31cbnRoaXMucmVtb3ZlKGVkZ2UuZ2V0RGlyRWRnZSgwKSk7dGhpcy5yZW1vdmUoZWRnZS5nZXREaXJFZGdlKDEpKTt0aGlzLmVkZ2VzLnJlbW92ZShlZGdlKTt0aGlzLmVkZ2UucmVtb3ZlKCk7fTtQbGFuYXJHcmFwaC5wcm90b3R5cGUucmVtb3ZlMj1mdW5jdGlvbihkZSl7aWYoZGUgaW5zdGFuY2VvZiBqc3RzLnBsYW5hcmdyYXBoLk5vZGUpe3JldHVybiB0aGlzLnJlbW92ZTMoZGUpO31cbnZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltIT1udWxsKVxuc3ltLnNldFN5bShudWxsKTtkZS5nZXRGcm9tTm9kZSgpLnJlbW92ZShkZSk7ZGUucmVtb3ZlKCk7dGhpcy5kaXJFZGdlcy5yZW1vdmUoZGUpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLnJlbW92ZTM9ZnVuY3Rpb24obm9kZSl7dmFyIG91dEVkZ2VzPW5vZGUuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpO2Zvcih2YXIgaT1vdXRFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoc3ltIT1udWxsKVxudGhpcy5yZW1vdmUoc3ltKTt0aGlzLmRpckVkZ2VzLnJlbW92ZShkZSk7dmFyIGVkZ2U9ZGUuZ2V0RWRnZSgpO2lmKGVkZ2UhPW51bGwpe3RoaXMuZWRnZXMucmVtb3ZlKGVkZ2UpO319XG50aGlzLm5vZGVNYXAucmVtb3ZlKG5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTtub2RlLnJlbW92ZSgpO307UGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmROb2Rlc09mRGVncmVlPWZ1bmN0aW9uKGRlZ3JlZSl7dmFyIG5vZGVzRm91bmQ9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLm5vZGVJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIG5vZGU9aS5uZXh0KCk7aWYobm9kZS5nZXREZWdyZWUoKT09ZGVncmVlKVxubm9kZXNGb3VuZC5hZGQobm9kZSk7fVxucmV0dXJuIG5vZGVzRm91bmQ7fTtqc3RzLnBsYW5hcmdyYXBoLlBsYW5hckdyYXBoPVBsYW5hckdyYXBoO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBTdGFjaz1qYXZhc2NyaXB0LnV0aWwuU3RhY2s7dmFyIEhhc2hTZXQ9amF2YXNjcmlwdC51dGlsLkhhc2hTZXQ7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBFZGdlUmluZz1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLkVkZ2VSaW5nO3ZhciBQb2x5Z29uaXplRWRnZT1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVFZGdlO3ZhciBQb2x5Z29uaXplRGlyZWN0ZWRFZGdlPWpzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuUG9seWdvbml6ZURpcmVjdGVkRWRnZTt2YXIgUGxhbmFyR3JhcGg9anN0cy5wbGFuYXJncmFwaC5QbGFuYXJHcmFwaDt2YXIgTm9kZT1qc3RzLnBsYW5hcmdyYXBoLk5vZGU7dmFyIFBvbHlnb25pemVHcmFwaD1mdW5jdGlvbihmYWN0b3J5KXtQbGFuYXJHcmFwaC5hcHBseSh0aGlzKTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGU9bmV3IFBsYW5hckdyYXBoKCk7UG9seWdvbml6ZUdyYXBoLmdldERlZ3JlZU5vbkRlbGV0ZWQ9ZnVuY3Rpb24obm9kZSl7dmFyIGVkZ2VzPW5vZGUuZ2V0T3V0RWRnZXMoKS5nZXRFZGdlcygpO3ZhciBkZWdyZWU9MDtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZighZGUuaXNNYXJrZWQoKSlcbmRlZ3JlZSsrO31cbnJldHVybiBkZWdyZWU7fTtQb2x5Z29uaXplR3JhcGguZ2V0RGVncmVlPWZ1bmN0aW9uKG5vZGUsbGFiZWwpe3ZhciBlZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTt2YXIgZGVncmVlPTA7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuZ2V0TGFiZWwoKT09bGFiZWwpXG5kZWdyZWUrKzt9XG5yZXR1cm4gZGVncmVlO307UG9seWdvbml6ZUdyYXBoLmRlbGV0ZUFsbEVkZ2VzPWZ1bmN0aW9uKG5vZGUpe3ZhciBlZGdlcz1ub2RlLmdldE91dEVkZ2VzKCkuZ2V0RWRnZXMoKTtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtkZS5zZXRNYXJrZWQodHJ1ZSk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihzeW0hPW51bGwpXG5zeW0uc2V0TWFya2VkKHRydWUpO319O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZmFjdG9yeT1udWxsO1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuYWRkRWRnZT1mdW5jdGlvbihsaW5lKXtpZihsaW5lLmlzRW1wdHkoKSl7cmV0dXJuO31cbnZhciBsaW5lUHRzPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxpbmUuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYobGluZVB0cy5sZW5ndGg8Mil7cmV0dXJuO31cbnZhciBzdGFydFB0PWxpbmVQdHNbMF07dmFyIGVuZFB0PWxpbmVQdHNbbGluZVB0cy5sZW5ndGgtMV07dmFyIG5TdGFydD10aGlzLmdldE5vZGUoc3RhcnRQdCk7dmFyIG5FbmQ9dGhpcy5nZXROb2RlKGVuZFB0KTt2YXIgZGUwPW5ldyBQb2x5Z29uaXplRGlyZWN0ZWRFZGdlKG5TdGFydCxuRW5kLGxpbmVQdHNbMV0sdHJ1ZSk7dmFyIGRlMT1uZXcgUG9seWdvbml6ZURpcmVjdGVkRWRnZShuRW5kLG5TdGFydCxsaW5lUHRzW2xpbmVQdHMubGVuZ3RoLTJdLGZhbHNlKTt2YXIgZWRnZT1uZXcgUG9seWdvbml6ZUVkZ2UobGluZSk7ZWRnZS5zZXREaXJlY3RlZEVkZ2VzKGRlMCxkZTEpO3RoaXMuYWRkKGVkZ2UpO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKHB0KXt2YXIgbm9kZT10aGlzLmZpbmROb2RlKHB0KTtpZihub2RlPT1udWxsKXtub2RlPW5ldyBOb2RlKHB0KTt0aGlzLmFkZChub2RlKTt9XG5yZXR1cm4gbm9kZTt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29tcHV0ZU5leHRDV0VkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpTm9kZT10aGlzLm5vZGVJdGVyYXRvcigpO2lOb2RlLmhhc05leHQoKTspe3ZhciBub2RlPWlOb2RlLm5leHQoKTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDV0VkZ2VzKG5vZGUpO319O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuY29udmVydE1heGltYWxUb01pbmltYWxFZGdlUmluZ3M9ZnVuY3Rpb24ocmluZ0VkZ2VzKXtmb3IodmFyIGk9cmluZ0VkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7dmFyIGludE5vZGVzPVBvbHlnb25pemVHcmFwaC5maW5kSW50ZXJzZWN0aW9uTm9kZXMoZGUsbGFiZWwpO2lmKGludE5vZGVzPT1udWxsKVxuY29udGludWU7Zm9yKHZhciBpTm9kZT1pbnROb2Rlcy5pdGVyYXRvcigpO2lOb2RlLmhhc05leHQoKTspe3ZhciBub2RlPWlOb2RlLm5leHQoKTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDQ1dFZGdlcyhub2RlLGxhYmVsKTt9fX07UG9seWdvbml6ZUdyYXBoLmZpbmRJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihzdGFydERFLGxhYmVsKXt2YXIgZGU9c3RhcnRERTt2YXIgaW50Tm9kZXM9bnVsbDtkb3t2YXIgbm9kZT1kZS5nZXRGcm9tTm9kZSgpO2lmKFBvbHlnb25pemVHcmFwaC5nZXREZWdyZWUobm9kZSxsYWJlbCk+MSl7aWYoaW50Tm9kZXM9PW51bGwpXG5pbnROb2Rlcz1uZXcgQXJyYXlMaXN0KCk7aW50Tm9kZXMuYWRkKG5vZGUpO31cbmRlPWRlLmdldE5leHQoKTtBc3NlcnQuaXNUcnVlKGRlIT1udWxsLCdmb3VuZCBudWxsIERFIGluIHJpbmcnKTtBc3NlcnQuaXNUcnVlKGRlPT1zdGFydERFfHwhZGUuaXNJblJpbmcoKSwnZm91bmQgREUgYWxyZWFkeSBpbiByaW5nJyk7fXdoaWxlKGRlIT1zdGFydERFKTtyZXR1cm4gaW50Tm9kZXM7fTtQb2x5Z29uaXplR3JhcGgucHJvdG90eXBlLmdldEVkZ2VSaW5ncz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU5leHRDV0VkZ2VzKCk7UG9seWdvbml6ZUdyYXBoLmxhYmVsKHRoaXMuZGlyRWRnZXMsLTEpO3ZhciBtYXhpbWFsUmluZ3M9UG9seWdvbml6ZUdyYXBoLmZpbmRMYWJlbGVkRWRnZVJpbmdzKHRoaXMuZGlyRWRnZXMpO3RoaXMuY29udmVydE1heGltYWxUb01pbmltYWxFZGdlUmluZ3MobWF4aW1hbFJpbmdzKTt2YXIgZWRnZVJpbmdMaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9dGhpcy5kaXJFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2lmKGRlLmlzTWFya2VkKCkpXG5jb250aW51ZTtpZihkZS5pc0luUmluZygpKVxuY29udGludWU7dmFyIGVyPXRoaXMuZmluZEVkZ2VSaW5nKGRlKTtlZGdlUmluZ0xpc3QuYWRkKGVyKTt9XG5yZXR1cm4gZWRnZVJpbmdMaXN0O307UG9seWdvbml6ZUdyYXBoLmZpbmRMYWJlbGVkRWRnZVJpbmdzPWZ1bmN0aW9uKGRpckVkZ2VzKXt2YXIgZWRnZVJpbmdTdGFydHM9bmV3IEFycmF5TGlzdCgpO3ZhciBjdXJyTGFiZWw9MTtmb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZihkZS5pc01hcmtlZCgpKVxuY29udGludWU7aWYoZGUuZ2V0TGFiZWwoKT49MClcbmNvbnRpbnVlO2VkZ2VSaW5nU3RhcnRzLmFkZChkZSk7dmFyIGVkZ2VzPVBvbHlnb25pemVHcmFwaC5maW5kRGlyRWRnZXNJblJpbmcoZGUpO1BvbHlnb25pemVHcmFwaC5sYWJlbChlZGdlcyxjdXJyTGFiZWwpO2N1cnJMYWJlbCsrO31cbnJldHVybiBlZGdlUmluZ1N0YXJ0czt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZGVsZXRlQ3V0RWRnZXM9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVOZXh0Q1dFZGdlcygpO1BvbHlnb25pemVHcmFwaC5maW5kTGFiZWxlZEVkZ2VSaW5ncyh0aGlzLmRpckVkZ2VzKTt2YXIgY3V0TGluZXM9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLmRpckVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuaXNNYXJrZWQoKSlcbmNvbnRpbnVlO3ZhciBzeW09ZGUuZ2V0U3ltKCk7aWYoZGUuZ2V0TGFiZWwoKT09c3ltLmdldExhYmVsKCkpe2RlLnNldE1hcmtlZCh0cnVlKTtzeW0uc2V0TWFya2VkKHRydWUpO3ZhciBlPWRlLmdldEVkZ2UoKTtjdXRMaW5lcy5hZGQoZS5nZXRMaW5lKCkpO319XG5yZXR1cm4gY3V0TGluZXM7fTtQb2x5Z29uaXplR3JhcGgubGFiZWw9ZnVuY3Rpb24oZGlyRWRnZXMsbGFiZWwpe2Zvcih2YXIgaT1kaXJFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2RlLnNldExhYmVsKGxhYmVsKTt9fTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDV0VkZ2VzPWZ1bmN0aW9uKG5vZGUpe3ZhciBkZVN0YXI9bm9kZS5nZXRPdXRFZGdlcygpO3ZhciBzdGFydERFPW51bGw7dmFyIHByZXZERT1udWxsO2Zvcih2YXIgaT1kZVN0YXIuZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIG91dERFPWkubmV4dCgpO2lmKG91dERFLmlzTWFya2VkKCkpXG5jb250aW51ZTtpZihzdGFydERFPT1udWxsKVxuc3RhcnRERT1vdXRERTtpZihwcmV2REUhPW51bGwpe3ZhciBzeW09cHJldkRFLmdldFN5bSgpO3N5bS5zZXROZXh0KG91dERFKTt9XG5wcmV2REU9b3V0REU7fVxuaWYocHJldkRFIT1udWxsKXt2YXIgc3ltPXByZXZERS5nZXRTeW0oKTtzeW0uc2V0TmV4dChzdGFydERFKTt9fTtQb2x5Z29uaXplR3JhcGguY29tcHV0ZU5leHRDQ1dFZGdlcz1mdW5jdGlvbihub2RlLGxhYmVsKXt2YXIgZGVTdGFyPW5vZGUuZ2V0T3V0RWRnZXMoKTt2YXIgZmlyc3RPdXRERT1udWxsO3ZhciBwcmV2SW5ERT1udWxsO3ZhciBlZGdlcz1kZVN0YXIuZ2V0RWRnZXMoKTtmb3IodmFyIGk9ZWRnZXMuc2l6ZSgpLTE7aT49MDtpLS0pe3ZhciBkZT1lZGdlcy5nZXQoaSk7dmFyIHN5bT1kZS5nZXRTeW0oKTt2YXIgb3V0REU9bnVsbDtpZihkZS5nZXRMYWJlbCgpPT1sYWJlbClcbm91dERFPWRlO3ZhciBpbkRFPW51bGw7aWYoc3ltLmdldExhYmVsKCk9PWxhYmVsKVxuaW5ERT1zeW07aWYob3V0REU9PW51bGwmJmluREU9PW51bGwpXG5jb250aW51ZTtpZihpbkRFIT1udWxsKXtwcmV2SW5ERT1pbkRFO31cbmlmKG91dERFIT1udWxsKXtpZihwcmV2SW5ERSE9bnVsbCl7cHJldkluREUuc2V0TmV4dChvdXRERSk7cHJldkluREU9bnVsbDt9XG5pZihmaXJzdE91dERFPT1udWxsKVxuZmlyc3RPdXRERT1vdXRERTt9fVxuaWYocHJldkluREUhPW51bGwpe0Fzc2VydC5pc1RydWUoZmlyc3RPdXRERSE9bnVsbCk7cHJldkluREUuc2V0TmV4dChmaXJzdE91dERFKTt9fTtQb2x5Z29uaXplR3JhcGguZmluZERpckVkZ2VzSW5SaW5nPWZ1bmN0aW9uKHN0YXJ0REUpe3ZhciBkZT1zdGFydERFO3ZhciBlZGdlcz1uZXcgQXJyYXlMaXN0KCk7ZG97ZWRnZXMuYWRkKGRlKTtkZT1kZS5nZXROZXh0KCk7QXNzZXJ0LmlzVHJ1ZShkZSE9bnVsbCwnZm91bmQgbnVsbCBERSBpbiByaW5nJyk7QXNzZXJ0LmlzVHJ1ZShkZT09c3RhcnRERXx8IWRlLmlzSW5SaW5nKCksJ2ZvdW5kIERFIGFscmVhZHkgaW4gcmluZycpO313aGlsZShkZSE9c3RhcnRERSk7cmV0dXJuIGVkZ2VzO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5maW5kRWRnZVJpbmc9ZnVuY3Rpb24oc3RhcnRERSl7dmFyIGRlPXN0YXJ0REU7dmFyIGVyPW5ldyBFZGdlUmluZyh0aGlzLmZhY3RvcnkpO2Rve2VyLmFkZChkZSk7ZGUuc2V0UmluZyhlcik7ZGU9ZGUuZ2V0TmV4dCgpO0Fzc2VydC5pc1RydWUoZGUhPW51bGwsJ2ZvdW5kIG51bGwgREUgaW4gcmluZycpO0Fzc2VydC5pc1RydWUoZGU9PXN0YXJ0REV8fCFkZS5pc0luUmluZygpLCdmb3VuZCBERSBhbHJlYWR5IGluIHJpbmcnKTt9d2hpbGUoZGUhPXN0YXJ0REUpO3JldHVybiBlcjt9O1BvbHlnb25pemVHcmFwaC5wcm90b3R5cGUuZGVsZXRlRGFuZ2xlcz1mdW5jdGlvbigpe3ZhciBub2Rlc1RvUmVtb3ZlPXRoaXMuZmluZE5vZGVzT2ZEZWdyZWUoMSk7dmFyIGRhbmdsZUxpbmVzPW5ldyBIYXNoU2V0KCk7dmFyIG5vZGVTdGFjaz1uZXcgU3RhY2soKTtmb3IodmFyIGk9bm9kZXNUb1JlbW92ZS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7bm9kZVN0YWNrLnB1c2goaS5uZXh0KCkpO31cbndoaWxlKCFub2RlU3RhY2suaXNFbXB0eSgpKXt2YXIgbm9kZT1ub2RlU3RhY2sucG9wKCk7UG9seWdvbml6ZUdyYXBoLmRlbGV0ZUFsbEVkZ2VzKG5vZGUpO3ZhciBub2RlT3V0RWRnZXM9bm9kZS5nZXRPdXRFZGdlcygpLmdldEVkZ2VzKCk7Zm9yKHZhciBpPW5vZGVPdXRFZGdlcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO2RlLnNldE1hcmtlZCh0cnVlKTt2YXIgc3ltPWRlLmdldFN5bSgpO2lmKHN5bSE9bnVsbClcbnN5bS5zZXRNYXJrZWQodHJ1ZSk7dmFyIGU9ZGUuZ2V0RWRnZSgpO2RhbmdsZUxpbmVzLmFkZChlLmdldExpbmUoKSk7dmFyIHRvTm9kZT1kZS5nZXRUb05vZGUoKTtpZihQb2x5Z29uaXplR3JhcGguZ2V0RGVncmVlTm9uRGVsZXRlZCh0b05vZGUpPT0xKVxubm9kZVN0YWNrLnB1c2godG9Ob2RlKTt9fVxucmV0dXJuIGRhbmdsZUxpbmVzO307UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGhQYXJpdHk9ZnVuY3Rpb24oKXt3aGlsZSh0cnVlKXt2YXIgZGU9bnVsbDtpZihkZT09bnVsbClcbnJldHVybjt0aGlzLmNvbXB1dGVEZXB0aFBhcml0eShkZSk7fX07UG9seWdvbml6ZUdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGhQYXJpdHk9ZnVuY3Rpb24oZGUpe307anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplR3JhcGg9UG9seWdvbml6ZUdyYXBoO30pKCk7anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsPWZ1bmN0aW9uKCl7dmFyIG90aGVyO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtvdGhlcj1hcmd1bWVudHNbMF07cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChvdGhlci5taW4sb3RoZXIubWF4KTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5taW48PXRoaXMubWF4KTt0aGlzLm1pbj1hcmd1bWVudHNbMF07dGhpcy5tYXg9YXJndW1lbnRzWzFdO319O2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUubWluPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5tYXg9bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLmdldENlbnRyZT1mdW5jdGlvbigpe3JldHVybih0aGlzLm1pbit0aGlzLm1heCkvMjt9O2pzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbC5wcm90b3R5cGUuZXhwYW5kVG9JbmNsdWRlPWZ1bmN0aW9uKG90aGVyKXt0aGlzLm1heD1NYXRoLm1heCh0aGlzLm1heCxvdGhlci5tYXgpO3RoaXMubWluPU1hdGgubWluKHRoaXMubWluLG90aGVyLm1pbik7cmV0dXJuIHRoaXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuSW50ZXJ2YWwucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24ob3RoZXIpe3JldHVybiEob3RoZXIubWluPnRoaXMubWF4fHxvdGhlci5tYXg8dGhpcy5taW4pO307anN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24obyl7aWYoIShvIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsKSl7cmV0dXJuIGZhbHNlO31cbm90aGVyPW87cmV0dXJuIHRoaXMubWluPT09b3RoZXIubWluJiZ0aGlzLm1heD09PW90aGVyLm1heDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3Rvcnk9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwpe3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWx8fG5ldyBqc3RzLmdlb20uUHJlY2lzaW9uTW9kZWwoKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLnByZWNpc2lvbk1vZGVsPW51bGw7anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuZ2V0UHJlY2lzaW9uTW9kZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmVjaXNpb25Nb2RlbDt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZVBvaW50PWZ1bmN0aW9uKGNvb3JkaW5hdGUpe3ZhciBwb2ludD1uZXcganN0cy5nZW9tLlBvaW50KGNvb3JkaW5hdGUsdGhpcyk7cmV0dXJuIHBvaW50O307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTGluZVN0cmluZz1mdW5jdGlvbihjb29yZGluYXRlcyl7dmFyIGxpbmVTdHJpbmc9bmV3IGpzdHMuZ2VvbS5MaW5lU3RyaW5nKGNvb3JkaW5hdGVzLHRoaXMpO3JldHVybiBsaW5lU3RyaW5nO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTGluZWFyUmluZz1mdW5jdGlvbihjb29yZGluYXRlcyl7dmFyIGxpbmVhclJpbmc9bmV3IGpzdHMuZ2VvbS5MaW5lYXJSaW5nKGNvb3JkaW5hdGVzLHRoaXMpO3JldHVybiBsaW5lYXJSaW5nO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlUG9seWdvbj1mdW5jdGlvbihzaGVsbCxob2xlcyl7dmFyIHBvbHlnb249bmV3IGpzdHMuZ2VvbS5Qb2x5Z29uKHNoZWxsLGhvbGVzLHRoaXMpO3JldHVybiBwb2x5Z29uO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTXVsdGlQb2ludD1mdW5jdGlvbihwb2ludHMpe2lmKHBvaW50cyYmcG9pbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dmFyIGNvbnZlcnRlZD1bXTt2YXIgaTtmb3IoaT0wO2k8cG9pbnRzLmxlbmd0aDtpKyspe2NvbnZlcnRlZC5wdXNoKHRoaXMuY3JlYXRlUG9pbnQocG9pbnRzW2ldKSk7fVxucG9pbnRzPWNvbnZlcnRlZDt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5NdWx0aVBvaW50KHBvaW50cyx0aGlzKTt9O2pzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU11bHRpTGluZVN0cmluZz1mdW5jdGlvbihsaW5lU3RyaW5ncyl7cmV0dXJuIG5ldyBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKGxpbmVTdHJpbmdzLHRoaXMpO307anN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKHBvbHlnb25zKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24ocG9seWdvbnMsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5idWlsZEdlb21ldHJ5PWZ1bmN0aW9uKGdlb21MaXN0KXt2YXIgZ2VvbUNsYXNzPW51bGw7dmFyIGlzSGV0ZXJvZ2VuZW91cz1mYWxzZTt2YXIgaGFzR2VvbWV0cnlDb2xsZWN0aW9uPWZhbHNlO2Zvcih2YXIgaT1nZW9tTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdlb209aS5uZXh0KCk7dmFyIHBhcnRDbGFzcz1nZW9tLkNMQVNTX05BTUU7aWYoZ2VvbUNsYXNzPT09bnVsbCl7Z2VvbUNsYXNzPXBhcnRDbGFzczt9XG5pZighKHBhcnRDbGFzcz09PWdlb21DbGFzcykpe2lzSGV0ZXJvZ2VuZW91cz10cnVlO31cbmlmKGdlb20uaXNHZW9tZXRyeUNvbGxlY3Rpb25CYXNlKCkpXG5oYXNHZW9tZXRyeUNvbGxlY3Rpb249dHJ1ZTt9XG5pZihnZW9tQ2xhc3M9PT1udWxsKXtyZXR1cm4gdGhpcy5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxuaWYoaXNIZXRlcm9nZW5lb3VzfHxoYXNHZW9tZXRyeUNvbGxlY3Rpb24pe3JldHVybiB0aGlzLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tTGlzdC50b0FycmF5KCkpO31cbnZhciBnZW9tMD1nZW9tTGlzdC5nZXQoMCk7dmFyIGlzQ29sbGVjdGlvbj1nZW9tTGlzdC5zaXplKCk+MTtpZihpc0NvbGxlY3Rpb24pe2lmKGdlb20wIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3JldHVybiB0aGlzLmNyZWF0ZU11bHRpUG9seWdvbihnZW9tTGlzdC50b0FycmF5KCkpO31lbHNlIGlmKGdlb20wIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmNyZWF0ZU11bHRpTGluZVN0cmluZyhnZW9tTGlzdC50b0FycmF5KCkpO31lbHNlIGlmKGdlb20wIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXtyZXR1cm4gdGhpcy5jcmVhdGVNdWx0aVBvaW50KGdlb21MaXN0LnRvQXJyYXkoKSk7fVxuanN0cy51dGlsLkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgnVW5oYW5kbGVkIGNsYXNzOiAnK2dlb20wKTt9XG5yZXR1cm4gZ2VvbTA7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2VvbWV0cmllcyl7cmV0dXJuIG5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKGdlb21ldHJpZXMsdGhpcyk7fTtqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5LnByb3RvdHlwZS50b0dlb21ldHJ5PWZ1bmN0aW9uKGVudmVsb3BlKXtpZihlbnZlbG9wZS5pc051bGwoKSl7cmV0dXJuIHRoaXMuY3JlYXRlUG9pbnQobnVsbCk7fVxuaWYoZW52ZWxvcGUuZ2V0TWluWCgpPT09ZW52ZWxvcGUuZ2V0TWF4WCgpJiZlbnZlbG9wZS5nZXRNaW5ZKCk9PT1lbnZlbG9wZS5nZXRNYXhZKCkpe3JldHVybiB0aGlzLmNyZWF0ZVBvaW50KG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKSk7fVxuaWYoZW52ZWxvcGUuZ2V0TWluWCgpPT09ZW52ZWxvcGUuZ2V0TWF4WCgpfHxlbnZlbG9wZS5nZXRNaW5ZKCk9PT1lbnZlbG9wZS5nZXRNYXhZKCkpe3JldHVybiB0aGlzLmNyZWF0ZUxpbmVTdHJpbmcoW25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWF4WCgpLGVudmVsb3BlLmdldE1heFkoKSldKTt9XG5yZXR1cm4gdGhpcy5jcmVhdGVQb2x5Z29uKHRoaXMuY3JlYXRlTGluZWFyUmluZyhbbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1pblgoKSxlbnZlbG9wZS5nZXRNaW5ZKCkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWF4WSgpKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWF4WCgpLGVudmVsb3BlLmdldE1heFkoKSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGVudmVsb3BlLmdldE1heFgoKSxlbnZlbG9wZS5nZXRNaW5ZKCkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNaW5YKCksZW52ZWxvcGUuZ2V0TWluWSgpKV0pLG51bGwpO307anN0cy5nZW9tZ3JhcGguTm9kZUZhY3Rvcnk9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLk5vZGVGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGUoY29vcmQsbnVsbCk7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbj1mdW5jdGlvbigpe307anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT049MDtqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUPTE7anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQ9Mjtqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5vcHBvc2l0ZT1mdW5jdGlvbihwb3NpdGlvbil7aWYocG9zaXRpb249PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKXtyZXR1cm4ganN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQ7fVxuaWYocG9zaXRpb249PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCl7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQ7fVxucmV0dXJuIHBvc2l0aW9uO307fSkoKTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uPWZ1bmN0aW9uKCl7dGhpcy5sb2NhdGlvbj1bXTtpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dmFyIG9uPWFyZ3VtZW50c1swXTt2YXIgbGVmdD1hcmd1bWVudHNbMV07dmFyIHJpZ2h0PWFyZ3VtZW50c1syXTt0aGlzLmluaXQoMyk7dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTl09b247dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXT1sZWZ0O3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPXJpZ2h0O31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbil7dmFyIGdsPWFyZ3VtZW50c1swXTt0aGlzLmluaXQoZ2wubG9jYXRpb24ubGVuZ3RoKTtpZihnbCE9bnVsbCl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe3RoaXMubG9jYXRpb25baV09Z2wubG9jYXRpb25baV07fX19ZWxzZSBpZih0eXBlb2YgYXJndW1lbnRzWzBdPT09J251bWJlcicpe3ZhciBvbj1hcmd1bWVudHNbMF07dGhpcy5pbml0KDEpO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dPW9uO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YgQXJyYXkpe3ZhciBsb2NhdGlvbj1hcmd1bWVudHNbMF07dGhpcy5pbml0KGxvY2F0aW9uLmxlbmd0aCk7fX07anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUubG9jYXRpb249bnVsbDtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKHNpemUpe3RoaXMubG9jYXRpb25bc2l6ZS0xXT1udWxsO3RoaXMuc2V0QWxsTG9jYXRpb25zKGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmdldD1mdW5jdGlvbihwb3NJbmRleCl7aWYocG9zSW5kZXg8dGhpcy5sb2NhdGlvbi5sZW5ndGgpXG5yZXR1cm4gdGhpcy5sb2NhdGlvbltwb3NJbmRleF07cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKCl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe2lmKHRoaXMubG9jYXRpb25baV0hPT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzQW55TnVsbD1mdW5jdGlvbigpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpXG5yZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5pc0VxdWFsT25TaWRlPWZ1bmN0aW9uKGxlLGxvY0luZGV4KXtyZXR1cm4gdGhpcy5sb2NhdGlvbltsb2NJbmRleF09PWxlLmxvY2F0aW9uW2xvY0luZGV4XTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmlzQXJlYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvY2F0aW9uLmxlbmd0aD4xO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuaXNMaW5lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYXRpb24ubGVuZ3RoPT09MTt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24oKXtpZih0aGlzLmxvY2F0aW9uLmxlbmd0aDw9MSlcbnJldHVybjt2YXIgdGVtcD10aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlRdO3RoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVF09dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVF07dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVF09dGVtcDt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLnNldEFsbExvY2F0aW9ucz1mdW5jdGlvbihsb2NWYWx1ZSl7Zm9yKHZhciBpPTA7aTx0aGlzLmxvY2F0aW9uLmxlbmd0aDtpKyspe3RoaXMubG9jYXRpb25baV09bG9jVmFsdWU7fX07anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUuc2V0QWxsTG9jYXRpb25zSWZOdWxsPWZ1bmN0aW9uKGxvY1ZhbHVlKXtmb3IodmFyIGk9MDtpPHRoaXMubG9jYXRpb24ubGVuZ3RoO2krKyl7aWYodGhpcy5sb2NhdGlvbltpXT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKVxudGhpcy5sb2NhdGlvbltpXT1sb2NWYWx1ZTt9fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5zZXRMb2NhdGlvbj1mdW5jdGlvbihsb2NJbmRleCxsb2NWYWx1ZSl7aWYobG9jVmFsdWUhPT11bmRlZmluZWQpe3RoaXMubG9jYXRpb25bbG9jSW5kZXhdPWxvY1ZhbHVlO31lbHNle3RoaXMuc2V0TG9jYXRpb24oanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT04sbG9jSW5kZXgpO319O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLmdldExvY2F0aW9ucz1mdW5jdGlvbigpe3JldHVybiBsb2NhdGlvbjt9O2pzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ucHJvdG90eXBlLnNldExvY2F0aW9ucz1mdW5jdGlvbihvbixsZWZ0LHJpZ2h0KXt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OXT1vbjt0aGlzLmxvY2F0aW9uW2pzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlRdPWxlZnQ7dGhpcy5sb2NhdGlvbltqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVF09cmlnaHQ7fTtqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uLnByb3RvdHlwZS5hbGxQb3NpdGlvbnNFcXVhbD1mdW5jdGlvbihsb2Mpe2Zvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldIT09bG9jKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbi5wcm90b3R5cGUubWVyZ2U9ZnVuY3Rpb24oZ2wpe2lmKGdsLmxvY2F0aW9uLmxlbmd0aD50aGlzLmxvY2F0aW9uLmxlbmd0aCl7dmFyIG5ld0xvYz1bXTtuZXdMb2NbanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dPXRoaXMubG9jYXRpb25banN0cy5nZW9tZ3JhcGguUG9zaXRpb24uT05dO25ld0xvY1tqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUXT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTtuZXdMb2NbanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFRdPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO3RoaXMubG9jYXRpb249bmV3TG9jO31cbmZvcih2YXIgaT0wO2k8dGhpcy5sb2NhdGlvbi5sZW5ndGg7aSsrKXtpZih0aGlzLmxvY2F0aW9uW2ldPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUmJmk8Z2wubG9jYXRpb24ubGVuZ3RoKVxudGhpcy5sb2NhdGlvbltpXT1nbC5sb2NhdGlvbltpXTt9fTtqc3RzLmdlb21ncmFwaC5MYWJlbD1mdW5jdGlvbigpe3RoaXMuZWx0PVtdO3ZhciBnZW9tSW5kZXgsb25Mb2MsbGVmdExvYyxsYmwscmlnaHRMb2M7aWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe2dlb21JbmRleD1hcmd1bWVudHNbMF07b25Mb2M9YXJndW1lbnRzWzFdO2xlZnRMb2M9YXJndW1lbnRzWzJdO3JpZ2h0TG9jPWFyZ3VtZW50c1szXTt0aGlzLmVsdFswXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7dGhpcy5lbHRbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUsanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb25zKG9uTG9jLGxlZnRMb2MscmlnaHRMb2MpO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0zKXtvbkxvYz1hcmd1bWVudHNbMF07bGVmdExvYz1hcmd1bWVudHNbMV07cmlnaHRMb2M9YXJndW1lbnRzWzJdO3RoaXMuZWx0WzBdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jLGxlZnRMb2MscmlnaHRMb2MpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jLGxlZnRMb2MscmlnaHRMb2MpO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXtnZW9tSW5kZXg9YXJndW1lbnRzWzBdO29uTG9jPWFyZ3VtZW50c1sxXTt0aGlzLmVsdFswXT1uZXcganN0cy5nZW9tZ3JhcGguVG9wb2xvZ3lMb2NhdGlvbihqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7dGhpcy5lbHRbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24oanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZWx0W2dlb21JbmRleF0uc2V0TG9jYXRpb24ob25Mb2MpO31lbHNlIGlmKGFyZ3VtZW50c1swXWluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguTGFiZWwpe2xibD1hcmd1bWVudHNbMF07dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24obGJsLmVsdFswXSk7dGhpcy5lbHRbMV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24obGJsLmVsdFsxXSk7fWVsc2UgaWYodHlwZW9mIGFyZ3VtZW50c1swXT09PSdudW1iZXInKXtvbkxvYz1hcmd1bWVudHNbMF07dGhpcy5lbHRbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24ob25Mb2MpO3RoaXMuZWx0WzFdPW5ldyBqc3RzLmdlb21ncmFwaC5Ub3BvbG9neUxvY2F0aW9uKG9uTG9jKTt9fTtqc3RzLmdlb21ncmFwaC5MYWJlbC50b0xpbmVMYWJlbD1mdW5jdGlvbihsYWJlbCl7dmFyIGksbGluZUxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7Zm9yKGk9MDtpPDI7aSsrKXtsaW5lTGFiZWwuc2V0TG9jYXRpb24oaSxsYWJlbC5nZXRMb2NhdGlvbihpKSk7fVxucmV0dXJuIGxpbmVMYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5lbHQ9bnVsbDtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZmxpcD1mdW5jdGlvbigpe3RoaXMuZWx0WzBdLmZsaXAoKTt0aGlzLmVsdFsxXS5mbGlwKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZ2V0TG9jYXRpb249ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4KXtpZihhcmd1bWVudHMubGVuZ3RoPT0xKXtyZXR1cm4gdGhpcy5nZXRMb2NhdGlvbjIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnJldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmdldChwb3NJbmRleCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuZ2V0TG9jYXRpb24yPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uZ2V0KGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLk9OKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5zZXRMb2NhdGlvbj1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgsbG9jYXRpb24pe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTIpe3RoaXMuc2V0TG9jYXRpb24yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5lbHRbZ2VvbUluZGV4XS5zZXRMb2NhdGlvbihwb3NJbmRleCxsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0TG9jYXRpb24yPWZ1bmN0aW9uKGdlb21JbmRleCxsb2NhdGlvbil7dGhpcy5lbHRbZ2VvbUluZGV4XS5zZXRMb2NhdGlvbihqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTixsb2NhdGlvbik7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuc2V0QWxsTG9jYXRpb25zPWZ1bmN0aW9uKGdlb21JbmRleCxsb2NhdGlvbil7dGhpcy5lbHRbZ2VvbUluZGV4XS5zZXRBbGxMb2NhdGlvbnMobG9jYXRpb24pO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnNldEFsbExvY2F0aW9uc0lmTnVsbD1mdW5jdGlvbihnZW9tSW5kZXgsbG9jYXRpb24pe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe3RoaXMuc2V0QWxsTG9jYXRpb25zSWZOdWxsMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuZWx0W2dlb21JbmRleF0uc2V0QWxsTG9jYXRpb25zSWZOdWxsKGxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5zZXRBbGxMb2NhdGlvbnNJZk51bGwyPWZ1bmN0aW9uKGxvY2F0aW9uKXt0aGlzLnNldEFsbExvY2F0aW9uc0lmTnVsbCgwLGxvY2F0aW9uKTt0aGlzLnNldEFsbExvY2F0aW9uc0lmTnVsbCgxLGxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5tZXJnZT1mdW5jdGlvbihsYmwpe3ZhciBpO2ZvcihpPTA7aTwyO2krKyl7aWYodGhpcy5lbHRbaV09PT1udWxsJiZsYmwuZWx0W2ldIT09bnVsbCl7dGhpcy5lbHRbaV09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24obGJsLmVsdFtpXSk7fWVsc2V7dGhpcy5lbHRbaV0ubWVyZ2UobGJsLmVsdFtpXSk7fX19O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5nZXRHZW9tZXRyeUNvdW50PWZ1bmN0aW9uKCl7dmFyIGNvdW50PTA7aWYoIXRoaXMuZWx0WzBdLmlzTnVsbCgpKXtjb3VudCsrO31cbmlmKCF0aGlzLmVsdFsxXS5pc051bGwoKSl7Y291bnQrKzt9XG5yZXR1cm4gY291bnQ7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNOdWxsPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uaXNOdWxsKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNBbnlOdWxsPWZ1bmN0aW9uKGdlb21JbmRleCl7cmV0dXJuIHRoaXMuZWx0W2dlb21JbmRleF0uaXNBbnlOdWxsKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNBcmVhPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7cmV0dXJuIHRoaXMuaXNBcmVhMihhcmd1bWVudHNbMF0pO31cbnJldHVybiB0aGlzLmVsdFswXS5pc0FyZWEoKXx8dGhpcy5lbHRbMV0uaXNBcmVhKCk7fTtqc3RzLmdlb21ncmFwaC5MYWJlbC5wcm90b3R5cGUuaXNBcmVhMj1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzQXJlYSgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzTGluZT1mdW5jdGlvbihnZW9tSW5kZXgpe3JldHVybiB0aGlzLmVsdFtnZW9tSW5kZXhdLmlzTGluZSgpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLmlzRXF1YWxPblNpZGU9ZnVuY3Rpb24obGJsLHNpZGUpe3JldHVybiB0aGlzLmVsdFswXS5pc0VxdWFsT25TaWRlKGxibC5lbHRbMF0sc2lkZSkmJnRoaXMuZWx0WzFdLmlzRXF1YWxPblNpZGUobGJsLmVsdFsxXSxzaWRlKTt9O2pzdHMuZ2VvbWdyYXBoLkxhYmVsLnByb3RvdHlwZS5hbGxQb3NpdGlvbnNFcXVhbD1mdW5jdGlvbihnZW9tSW5kZXgsbG9jKXtyZXR1cm4gdGhpcy5lbHRbZ2VvbUluZGV4XS5hbGxQb3NpdGlvbnNFcXVhbChsb2MpO307anN0cy5nZW9tZ3JhcGguTGFiZWwucHJvdG90eXBlLnRvTGluZT1mdW5jdGlvbihnZW9tSW5kZXgpe2lmKHRoaXMuZWx0W2dlb21JbmRleF0uaXNBcmVhKCkpe3RoaXMuZWx0W2dlb21JbmRleF09bmV3IGpzdHMuZ2VvbWdyYXBoLlRvcG9sb2d5TG9jYXRpb24odGhpcy5lbHRbZ2VvbUluZGV4XS5sb2NhdGlvblswXSk7fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmc9ZnVuY3Rpb24oc3RhcnQsZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmVkZ2VzPVtdO3RoaXMucHRzPVtdO3RoaXMuaG9sZXM9W107dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PWdlb21ldHJ5RmFjdG9yeTtpZihzdGFydCl7dGhpcy5jb21wdXRlUG9pbnRzKHN0YXJ0KTt0aGlzLmNvbXB1dGVSaW5nKCk7fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnN0YXJ0RGU9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUubWF4Tm9kZURlZ3JlZT0tMTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZWRnZXM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUucHRzPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnJpbmc9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuX2lzSG9sZT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zaGVsbD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5ob2xlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZW9tZXRyeUZhY3Rvcnk9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuaXNJc29sYXRlZD1mdW5jdGlvbigpe3JldHVybih0aGlzLmxhYmVsLmdldEdlb21ldHJ5Q291bnQoKT09MSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuaXNIb2xlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzSG9sZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLnB0c1tpXTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRMaW5lYXJSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmluZzt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmlzU2hlbGw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaGVsbD09PW51bGw7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuZ2V0U2hlbGw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaGVsbDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5zZXRTaGVsbD1mdW5jdGlvbihzaGVsbCl7dGhpcy5zaGVsbD1zaGVsbDtpZihzaGVsbCE9PW51bGwpXG5zaGVsbC5hZGRIb2xlKHRoaXMpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmFkZEhvbGU9ZnVuY3Rpb24ocmluZyl7dGhpcy5ob2xlcy5wdXNoKHJpbmcpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnRvUG9seWdvbj1mdW5jdGlvbihnZW9tZXRyeUZhY3Rvcnkpe3ZhciBob2xlTFI9W107Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe2hvbGVMUltpXT10aGlzLmhvbGVzW2ldLmdldExpbmVhclJpbmcoKTt9XG52YXIgcG9seT10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2x5Z29uKHRoaXMuZ2V0TGluZWFyUmluZygpLGhvbGVMUik7cmV0dXJuIHBvbHk7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuY29tcHV0ZVJpbmc9ZnVuY3Rpb24oKXtpZih0aGlzLnJpbmchPT1udWxsKVxucmV0dXJuO3ZhciBjb29yZD1bXTtmb3IodmFyIGk9MDtpPHRoaXMucHRzLmxlbmd0aDtpKyspe2Nvb3JkW2ldPXRoaXMucHRzW2ldO31cbnRoaXMucmluZz10aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lYXJSaW5nKGNvb3JkKTt0aGlzLl9pc0hvbGU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKHRoaXMucmluZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKGRlKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLnNldEVkZ2VSaW5nPWZ1bmN0aW9uKGRlLGVyKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmdldEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZXM7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuY29tcHV0ZVBvaW50cz1mdW5jdGlvbihzdGFydCl7dGhpcy5zdGFydERlPXN0YXJ0O3ZhciBkZT1zdGFydDt2YXIgaXNGaXJzdEVkZ2U9dHJ1ZTtkb3tpZihkZT09PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCdGb3VuZCBudWxsIERpcmVjdGVkRWRnZScpO2lmKGRlLmdldEVkZ2VSaW5nKCk9PT10aGlzKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignRGlyZWN0ZWQgRWRnZSB2aXNpdGVkIHR3aWNlIGR1cmluZyByaW5nLWJ1aWxkaW5nIGF0ICcrXG5kZS5nZXRDb29yZGluYXRlKCkpO3RoaXMuZWRnZXMucHVzaChkZSk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7anN0cy51dGlsLkFzc2VydC5pc1RydWUobGFiZWwuaXNBcmVhKCkpO3RoaXMubWVyZ2VMYWJlbChsYWJlbCk7dGhpcy5hZGRQb2ludHMoZGUuZ2V0RWRnZSgpLGRlLmlzRm9yd2FyZCgpLGlzRmlyc3RFZGdlKTtpc0ZpcnN0RWRnZT1mYWxzZTt0aGlzLnNldEVkZ2VSaW5nKGRlLHRoaXMpO2RlPXRoaXMuZ2V0TmV4dChkZSk7fXdoaWxlKGRlIT09dGhpcy5zdGFydERlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5nZXRNYXhOb2RlRGVncmVlPWZ1bmN0aW9uKCl7aWYodGhpcy5tYXhOb2RlRGVncmVlPDApXG50aGlzLmNvbXB1dGVNYXhOb2RlRGVncmVlKCk7cmV0dXJuIHRoaXMubWF4Tm9kZURlZ3JlZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5jb21wdXRlTWF4Tm9kZURlZ3JlZT1mdW5jdGlvbigpe3RoaXMubWF4Tm9kZURlZ3JlZT0wO3ZhciBkZT10aGlzLnN0YXJ0RGU7ZG97dmFyIG5vZGU9ZGUuZ2V0Tm9kZSgpO3ZhciBkZWdyZWU9bm9kZS5nZXRFZGdlcygpLmdldE91dGdvaW5nRGVncmVlKHRoaXMpO2lmKGRlZ3JlZT50aGlzLm1heE5vZGVEZWdyZWUpXG50aGlzLm1heE5vZGVEZWdyZWU9ZGVncmVlO2RlPXRoaXMuZ2V0TmV4dChkZSk7fXdoaWxlKGRlIT09dGhpcy5zdGFydERlKTt0aGlzLm1heE5vZGVEZWdyZWUqPTI7fTtqc3RzLmdlb21ncmFwaC5FZGdlUmluZy5wcm90b3R5cGUuc2V0SW5SZXN1bHQ9ZnVuY3Rpb24oKXt2YXIgZGU9dGhpcy5zdGFydERlO2Rve2RlLmdldEVkZ2UoKS5zZXRJblJlc3VsdCh0cnVlKTtkZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT10aGlzLnN0YXJ0RGUpO307anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLm1lcmdlTGFiZWw9ZnVuY3Rpb24oZGVMYWJlbCl7dGhpcy5tZXJnZUxhYmVsMihkZUxhYmVsLDApO3RoaXMubWVyZ2VMYWJlbDIoZGVMYWJlbCwxKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLnByb3RvdHlwZS5tZXJnZUxhYmVsMj1mdW5jdGlvbihkZUxhYmVsLGdlb21JbmRleCl7dmFyIGxvYz1kZUxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk7aWYobG9jPT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnJldHVybjtpZih0aGlzLmxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCk9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSl7dGhpcy5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsbG9jKTtyZXR1cm47fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmFkZFBvaW50cz1mdW5jdGlvbihlZGdlLGlzRm9yd2FyZCxpc0ZpcnN0RWRnZSl7dmFyIGVkZ2VQdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO2lmKGlzRm9yd2FyZCl7dmFyIHN0YXJ0SW5kZXg9MTtpZihpc0ZpcnN0RWRnZSlcbnN0YXJ0SW5kZXg9MDtmb3IodmFyIGk9c3RhcnRJbmRleDtpPGVkZ2VQdHMubGVuZ3RoO2krKyl7dGhpcy5wdHMucHVzaChlZGdlUHRzW2ldKTt9fWVsc2V7dmFyIHN0YXJ0SW5kZXg9ZWRnZVB0cy5sZW5ndGgtMjtpZihpc0ZpcnN0RWRnZSlcbnN0YXJ0SW5kZXg9ZWRnZVB0cy5sZW5ndGgtMTtmb3IodmFyIGk9c3RhcnRJbmRleDtpPj0wO2ktLSl7dGhpcy5wdHMucHVzaChlZGdlUHRzW2ldKTt9fX07anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCl7dmFyIHNoZWxsPXRoaXMuZ2V0TGluZWFyUmluZygpO3ZhciBlbnY9c2hlbGwuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2lmKCFlbnYuY29udGFpbnMocCkpXG5yZXR1cm4gZmFsc2U7aWYoIWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHAsc2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKSkpXG5yZXR1cm4gZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLmhvbGVzLmxlbmd0aDtpKyspe3ZhciBob2xlPXRoaXMuaG9sZXNbaV07aWYoaG9sZS5jb250YWluc1BvaW50KHApKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLkxpbmVhclJpbmc9ZnVuY3Rpb24ocG9pbnRzLGZhY3Rvcnkpe2pzdHMuZ2VvbS5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkxpbmVTdHJpbmcoKTtqc3RzLmdlb20uTGluZWFyUmluZy5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTGluZWFyUmluZztqc3RzLmdlb20uTGluZWFyUmluZy5wcm90b3R5cGUuZ2V0Qm91bmRhcnlEaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLkRpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZS5pc1NpbXBsZT1mdW5jdGlvbigpe3JldHVybiB0cnVlO307anN0cy5nZW9tLkxpbmVhclJpbmcucHJvdG90eXBlLmdldEdlb21ldHJ5VHlwZT1mdW5jdGlvbigpe3JldHVybidMaW5lYXJSaW5nJzt9O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLk1JTklNVU1fVkFMSURfU0laRT00O2pzdHMuZ2VvbS5MaW5lYXJSaW5nLnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTGluZWFyUmluZyc7fSkoKTtqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlLnByb3RvdHlwZS5nZXRCb3VuZHM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZT1mdW5jdGlvbihsZXZlbCl7dGhpcy5sZXZlbD1sZXZlbDt0aGlzLmNoaWxkQm91bmRhYmxlcz1bXTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlKCk7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmNoaWxkQm91bmRhYmxlcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmJvdW5kcz1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmxldmVsPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuZ2V0Q2hpbGRCb3VuZGFibGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2hpbGRCb3VuZGFibGVzO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5wcm90b3R5cGUuY29tcHV0ZUJvdW5kcz1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5nZXRCb3VuZHM9ZnVuY3Rpb24oKXtpZih0aGlzLmJvdW5kcz09PW51bGwpe3RoaXMuYm91bmRzPXRoaXMuY29tcHV0ZUJvdW5kcygpO31cbnJldHVybiB0aGlzLmJvdW5kczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUucHJvdG90eXBlLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGV2ZWw7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlLnByb3RvdHlwZS5hZGRDaGlsZEJvdW5kYWJsZT1mdW5jdGlvbihjaGlsZEJvdW5kYWJsZSl7dGhpcy5jaGlsZEJvdW5kYWJsZXMucHVzaChjaGlsZEJvdW5kYWJsZSk7fTsoZnVuY3Rpb24oKXtqc3RzLm5vZGluZy5Ob2Rlcj1mdW5jdGlvbigpe307anN0cy5ub2RpbmcuTm9kZXIucHJvdG90eXBlLmNvbXB1dGVOb2Rlcz1qc3RzLmFic3RyYWN0RnVuYztqc3RzLm5vZGluZy5Ob2Rlci5wcm90b3R5cGUuZ2V0Tm9kZWRTdWJzdHJpbmdzPWpzdHMuYWJzdHJhY3RGdW5jO30pKCk7KGZ1bmN0aW9uKCl7dmFyIE5vZGVyPWpzdHMubm9kaW5nLk5vZGVyO2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlcj1mdW5jdGlvbigpe307anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyLnByb3RvdHlwZT1uZXcgTm9kZXIoKTtqc3RzLm5vZGluZy5TaW5nbGVQYXNzTm9kZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyO2pzdHMubm9kaW5nLlNpbmdsZVBhc3NOb2Rlci5wcm90b3R5cGUuc2VnSW50PW51bGw7anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyLnByb3RvdHlwZS5zZXRTZWdtZW50SW50ZXJzZWN0b3I9ZnVuY3Rpb24oc2VnSW50KXt0aGlzLnNlZ0ludD1zZWdJbnQ7fTt9KSgpO2pzdHMuaW5kZXguU3BhdGlhbEluZGV4PWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LlNwYXRpYWxJbmRleC5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguU3BhdGlhbEluZGV4LnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihzZWFyY2hFbnYsdmlzaXRvcil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguU3BhdGlhbEluZGV4LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oaXRlbUVudixpdGVtKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZT1mdW5jdGlvbihub2RlQ2FwYWNpdHkpe2lmKG5vZGVDYXBhY2l0eT09PXVuZGVmaW5lZClcbnJldHVybjt0aGlzLml0ZW1Cb3VuZGFibGVzPVtdO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKG5vZGVDYXBhY2l0eT4xLCdOb2RlIGNhcGFjaXR5IG11c3QgYmUgZ3JlYXRlciB0aGFuIDEnKTt0aGlzLm5vZGVDYXBhY2l0eT1ub2RlQ2FwYWNpdHk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLkludGVyc2VjdHNPcD1mdW5jdGlvbigpe307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5JbnRlcnNlY3RzT3AucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oYUJvdW5kcyxiQm91bmRzKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucm9vdD1udWxsO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmJ1aWx0PWZhbHNlO2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLml0ZW1Cb3VuZGFibGVzPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUubm9kZUNhcGFjaXR5PW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuYnVpbGQ9ZnVuY3Rpb24oKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghdGhpcy5idWlsdCk7dGhpcy5yb290PXRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MD90aGlzLmNyZWF0ZU5vZGUoMCk6dGhpcy5jcmVhdGVIaWdoZXJMZXZlbHModGhpcy5pdGVtQm91bmRhYmxlcywtMSk7dGhpcy5idWlsdD10cnVlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihsZXZlbCl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXM9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGNoaWxkQm91bmRhYmxlcy5sZW5ndGg9PT0wKSk7dmFyIHBhcmVudEJvdW5kYWJsZXM9W107cGFyZW50Qm91bmRhYmxlcy5wdXNoKHRoaXMuY3JlYXRlTm9kZShuZXdMZXZlbCkpO3ZhciBzb3J0ZWRDaGlsZEJvdW5kYWJsZXM9W107Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7c29ydGVkQ2hpbGRCb3VuZGFibGVzLnB1c2goY2hpbGRCb3VuZGFibGVzW2ldKTt9XG5zb3J0ZWRDaGlsZEJvdW5kYWJsZXMuc29ydCh0aGlzLmdldENvbXBhcmF0b3IoKSk7Zm9yKHZhciBpPTA7aTxzb3J0ZWRDaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPXNvcnRlZENoaWxkQm91bmRhYmxlc1tpXTtpZih0aGlzLmxhc3ROb2RlKHBhcmVudEJvdW5kYWJsZXMpLmdldENoaWxkQm91bmRhYmxlcygpLmxlbmd0aD09PXRoaXMuZ2V0Tm9kZUNhcGFjaXR5KCkpe3BhcmVudEJvdW5kYWJsZXMucHVzaCh0aGlzLmNyZWF0ZU5vZGUobmV3TGV2ZWwpKTt9XG50aGlzLmxhc3ROb2RlKHBhcmVudEJvdW5kYWJsZXMpLmFkZENoaWxkQm91bmRhYmxlKGNoaWxkQm91bmRhYmxlKTt9XG5yZXR1cm4gcGFyZW50Qm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmxhc3ROb2RlPWZ1bmN0aW9uKG5vZGVzKXtyZXR1cm4gbm9kZXNbbm9kZXMubGVuZ3RoLTFdO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY29tcGFyZURvdWJsZXM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT5iPzE6YTxiPy0xOjA7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVIaWdoZXJMZXZlbHM9ZnVuY3Rpb24oYm91bmRhYmxlc09mQUxldmVsLGxldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGJvdW5kYWJsZXNPZkFMZXZlbC5sZW5ndGg9PT0wKSk7dmFyIHBhcmVudEJvdW5kYWJsZXM9dGhpcy5jcmVhdGVQYXJlbnRCb3VuZGFibGVzKGJvdW5kYWJsZXNPZkFMZXZlbCxsZXZlbCsxKTtpZihwYXJlbnRCb3VuZGFibGVzLmxlbmd0aD09PTEpe3JldHVybiBwYXJlbnRCb3VuZGFibGVzWzBdO31cbnJldHVybiB0aGlzLmNyZWF0ZUhpZ2hlckxldmVscyhwYXJlbnRCb3VuZGFibGVzLGxldmVsKzEpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZ2V0Um9vdD1mdW5jdGlvbigpe2lmKCF0aGlzLmJ1aWx0KVxudGhpcy5idWlsZCgpO3JldHVybiB0aGlzLnJvb3Q7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5nZXROb2RlQ2FwYWNpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlQ2FwYWNpdHk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLnNpemUyKGFyZ3VtZW50c1swXSk7fVxuaWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG5pZih0aGlzLml0ZW1Cb3VuZGFibGVzLmxlbmd0aD09PTApe3JldHVybiAwO31cbnJldHVybiB0aGlzLnNpemUyKHJvb3QpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuc2l6ZTI9ZnVuY3Rpb24obm9kZSl7dmFyIHNpemU9MDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe3NpemUrPXRoaXMuc2l6ZShjaGlsZEJvdW5kYWJsZSk7fWVsc2UgaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSl7c2l6ZSs9MTt9fVxucmV0dXJuIHNpemU7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5kZXB0aD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5kZXB0aDIoYXJndW1lbnRzWzBdKTt9XG5pZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbmlmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7cmV0dXJuIDA7fVxucmV0dXJuIHRoaXMuZGVwdGgyKHJvb3QpO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuZGVwdGgyPWZ1bmN0aW9uKCl7dmFyIG1heENoaWxkRGVwdGg9MDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihjaGlsZEJvdW5kYWJsZSBpbnN0YW5jZW9mIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdE5vZGUpe3ZhciBjaGlsZERlcHRoPXRoaXMuZGVwdGgoY2hpbGRCb3VuZGFibGUpO2lmKGNoaWxkRGVwdGg+bWF4Q2hpbGREZXB0aClcbm1heENoaWxkRGVwdGg9Y2hpbGREZXB0aDt9fVxucmV0dXJuIG1heENoaWxkRGVwdGgrMTt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihib3VuZHMsaXRlbSl7anN0cy51dGlsLkFzc2VydC5pc1RydWUoIXRoaXMuYnVpbHQsJ0Nhbm5vdCBpbnNlcnQgaXRlbXMgaW50byBhbiBTVFIgcGFja2VkIFItdHJlZSBhZnRlciBpdCBoYXMgYmVlbiBidWlsdC4nKTt0aGlzLml0ZW1Cb3VuZGFibGVzLnB1c2gobmV3IGpzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlKGJvdW5kcyxpdGVtKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihzZWFyY2hCb3VuZHMpe2lmKGFyZ3VtZW50cy5sZW5ndGg+MSl7dGhpcy5xdWVyeTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxudmFyIG1hdGNoZXM9W107aWYodGhpcy5pdGVtQm91bmRhYmxlcy5sZW5ndGg9PT0wKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSh0aGlzLnJvb3QuZ2V0Qm91bmRzKCk9PT1udWxsKTtyZXR1cm4gbWF0Y2hlczt9XG5pZih0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHModGhpcy5yb290LmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe3RoaXMucXVlcnkzKHNlYXJjaEJvdW5kcyx0aGlzLnJvb3QsbWF0Y2hlcyk7fVxucmV0dXJuIG1hdGNoZXM7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5xdWVyeTI9ZnVuY3Rpb24oc2VhcmNoQm91bmRzLHZpc2l0b3Ipe2lmKGFyZ3VtZW50cy5sZW5ndGg+Mil7dGhpcy5xdWVyeTMuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKCF0aGlzLmJ1aWx0KXt0aGlzLmJ1aWxkKCk7fVxuaWYodGhpcy5pdGVtQm91bmRhYmxlcy5sZW5ndGg9PT0wKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSh0aGlzLnJvb3QuZ2V0Qm91bmRzKCk9PT1udWxsKTt9XG5pZih0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHModGhpcy5yb290LmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe3RoaXMucXVlcnk0KHNlYXJjaEJvdW5kcyx0aGlzLnJvb3QsdmlzaXRvcik7fX07anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnkzPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxub2RlLG1hdGNoZXMpe2lmKCEoYXJndW1lbnRzWzJdaW5zdGFuY2VvZiBBcnJheSkpe3RoaXMucXVlcnk0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZighdGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe2NvbnRpbnVlO31cbmlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7dGhpcy5xdWVyeTMoc2VhcmNoQm91bmRzLGNoaWxkQm91bmRhYmxlLG1hdGNoZXMpO31lbHNlIGlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe21hdGNoZXMucHVzaChjaGlsZEJvdW5kYWJsZS5nZXRJdGVtKCkpO31lbHNle2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoKTt9fX07anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnk0PWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxub2RlLHZpc2l0b3Ipe3ZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKCF0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHMoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCksc2VhcmNoQm91bmRzKSl7Y29udGludWU7fVxuaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt0aGlzLnF1ZXJ5NChzZWFyY2hCb3VuZHMsY2hpbGRCb3VuZGFibGUsdmlzaXRvcik7fWVsc2UgaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSl7dmlzaXRvci52aXNpdEl0ZW0oY2hpbGRCb3VuZGFibGUuZ2V0SXRlbSgpKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCk7fX19O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmdldEludGVyc2VjdHNPcD1mdW5jdGlvbigpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5pdGVtc1RyZWU9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuaXRlbXNUcmVlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuaWYoIXRoaXMuYnVpbHQpe3RoaXMuYnVpbGQoKTt9XG52YXIgdmFsdWVzVHJlZT10aGlzLml0ZW1zVHJlZTIodGhpcy5yb290KTtpZih2YWx1ZXNUcmVlPT09bnVsbClcbnJldHVybltdO3JldHVybiB2YWx1ZXNUcmVlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuaXRlbXNUcmVlMj1mdW5jdGlvbihub2RlKXt2YXIgdmFsdWVzVHJlZUZvck5vZGU9W107dmFyIGNoaWxkQm91bmRhYmxlcz1ub2RlLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt2YXIgdmFsdWVzVHJlZUZvckNoaWxkPXRoaXMuaXRlbXNUcmVlKGNoaWxkQm91bmRhYmxlKTtpZih2YWx1ZXNUcmVlRm9yQ2hpbGQhPW51bGwpXG52YWx1ZXNUcmVlRm9yTm9kZS5wdXNoKHZhbHVlc1RyZWVGb3JDaGlsZCk7fWVsc2UgaWYoY2hpbGRCb3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSl7dmFsdWVzVHJlZUZvck5vZGUucHVzaChjaGlsZEJvdW5kYWJsZS5nZXRJdGVtKCkpO31lbHNle2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoKTt9fVxuaWYodmFsdWVzVHJlZUZvck5vZGUubGVuZ3RoPD0wKVxucmV0dXJuIG51bGw7cmV0dXJuIHZhbHVlc1RyZWVGb3JOb2RlO307anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxpdGVtKXtpZighdGhpcy5idWlsdCl7dGhpcy5idWlsZCgpO31cbmlmKHRoaXMuaXRlbUJvdW5kYWJsZXMubGVuZ3RoPT09MCl7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5yb290LmdldEJvdW5kcygpPT1udWxsKTt9XG5pZih0aGlzLmdldEludGVyc2VjdHNPcCgpLmludGVyc2VjdHModGhpcy5yb290LmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe3JldHVybiB0aGlzLnJlbW92ZTIoc2VhcmNoQm91bmRzLHRoaXMucm9vdCxpdGVtKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5yZW1vdmUyPWZ1bmN0aW9uKHNlYXJjaEJvdW5kcyxub2RlLGl0ZW0pe3ZhciBmb3VuZD10aGlzLnJlbW92ZUl0ZW0obm9kZSxpdGVtKTtpZihmb3VuZClcbnJldHVybiB0cnVlO3ZhciBjaGlsZFRvUHJ1bmU9bnVsbDt2YXIgY2hpbGRCb3VuZGFibGVzPW5vZGUuZ2V0Q2hpbGRCb3VuZGFibGVzKCk7Zm9yKHZhciBpPTA7aTxjaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2krKyl7dmFyIGNoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZighdGhpcy5nZXRJbnRlcnNlY3RzT3AoKS5pbnRlcnNlY3RzKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpLHNlYXJjaEJvdW5kcykpe2NvbnRpbnVlO31cbmlmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZSl7Zm91bmQ9dGhpcy5yZW1vdmUoc2VhcmNoQm91bmRzLGNoaWxkQm91bmRhYmxlLGl0ZW0pO2lmKGZvdW5kKXtjaGlsZFRvUHJ1bmU9Y2hpbGRCb3VuZGFibGU7YnJlYWs7fX19XG5pZihjaGlsZFRvUHJ1bmUhPW51bGwpe2lmKGNoaWxkVG9QcnVuZS5nZXRDaGlsZEJvdW5kYWJsZXMoKS5sZW5ndGg9PT0wKXtjaGlsZEJvdW5kYWJsZXMuc3BsaWNlKGNoaWxkQm91bmRhYmxlcy5pbmRleE9mKGNoaWxkVG9QcnVuZSksMSk7fX1cbnJldHVybiBmb3VuZDt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnJlbW92ZUl0ZW09ZnVuY3Rpb24obm9kZSxpdGVtKXt2YXIgY2hpbGRUb1JlbW92ZT1udWxsO3ZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgY2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2ldO2lmKGNoaWxkQm91bmRhYmxlIGluc3RhbmNlb2YganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUpe2lmKGNoaWxkQm91bmRhYmxlLmdldEl0ZW0oKT09PWl0ZW0pXG5jaGlsZFRvUmVtb3ZlPWNoaWxkQm91bmRhYmxlO319XG5pZihjaGlsZFRvUmVtb3ZlIT09bnVsbCl7Y2hpbGRCb3VuZGFibGVzLnNwbGljZShjaGlsZEJvdW5kYWJsZXMuaW5kZXhPZihjaGlsZFRvUmVtb3ZlKSwxKTtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3RTVFJ0cmVlLnByb3RvdHlwZS5ib3VuZGFibGVzQXRMZXZlbD1mdW5jdGlvbihsZXZlbCl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXt0aGlzLmJvdW5kYWJsZXNBdExldmVsMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBib3VuZGFibGVzPVtdO3RoaXMuYm91bmRhYmxlc0F0TGV2ZWwyKGxldmVsLHRoaXMucm9vdCxib3VuZGFibGVzKTtyZXR1cm4gYm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmJvdW5kYWJsZXNBdExldmVsMj1mdW5jdGlvbihsZXZlbCx0b3AsYm91bmRhYmxlcyl7anN0cy51dGlsLkFzc2VydC5pc1RydWUobGV2ZWw+LTIpO2lmKHRvcC5nZXRMZXZlbCgpPT09bGV2ZWwpe2JvdW5kYWJsZXMuYWRkKHRvcCk7cmV0dXJuO31cbnZhciBjaGlsZEJvdW5kYWJsZXM9bm9kZS5nZXRDaGlsZEJvdW5kYWJsZXMoKTtmb3IodmFyIGk9MDtpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGg7aSsrKXt2YXIgYm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihib3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKXt0aGlzLmJvdW5kYWJsZXNBdExldmVsKGxldmVsLGJvdW5kYWJsZSxib3VuZGFibGVzKTt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShib3VuZGFibGUgaW5zdGFuY2VvZiBqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZSk7aWYobGV2ZWw9PT0tMSl7Ym91bmRhYmxlcy5hZGQoYm91bmRhYmxlKTt9fX1cbnJldHVybjt9O2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmdldENvbXBhcmF0b3I9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWU9ZnVuY3Rpb24obm9kZUNhcGFjaXR5KXtub2RlQ2FwYWNpdHk9bm9kZUNhcGFjaXR5fHxqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5ERUZBVUxUX05PREVfQ0FQQUNJVFk7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5jYWxsKHRoaXMsbm9kZUNhcGFjaXR5KTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZSgpO2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLmNvbnN0cnVjdG9yPWpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlO2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS54Q29tcGFyYXRvcj1mdW5jdGlvbihvMSxvMil7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmNvbXBhcmVEb3VibGVzKGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jZW50cmVYKG8xLmdldEJvdW5kcygpKSxqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWChvMi5nZXRCb3VuZHMoKSkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLnlDb21wYXJhdG9yPWZ1bmN0aW9uKG8xLG8yKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY29tcGFyZURvdWJsZXMoanN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNlbnRyZVkobzEuZ2V0Qm91bmRzKCkpLGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jZW50cmVZKG8yLmdldEJvdW5kcygpKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWD1mdW5jdGlvbihlKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmF2ZyhlLmdldE1pblgoKSxlLmdldE1heFgoKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY2VudHJlWT1mdW5jdGlvbihlKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmF2ZyhlLmdldE1pblkoKSxlLmdldE1heFkoKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuYXZnPWZ1bmN0aW9uKGEsYil7cmV0dXJuKGErYikvMi4wO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmludGVyc2VjdHNPcD17aW50ZXJzZWN0czpmdW5jdGlvbihhQm91bmRzLGJCb3VuZHMpe3JldHVybiBhQm91bmRzLmludGVyc2VjdHMoYkJvdW5kcyk7fX07anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXM9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZSghKGNoaWxkQm91bmRhYmxlcy5sZW5ndGg9PT0wKSk7dmFyIG1pbkxlYWZDb3VudD1NYXRoLmNlaWwoY2hpbGRCb3VuZGFibGVzLmxlbmd0aC90aGlzLmdldE5vZGVDYXBhY2l0eSgpKTt2YXIgc29ydGVkQ2hpbGRCb3VuZGFibGVzPVtdO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3NvcnRlZENoaWxkQm91bmRhYmxlcy5wdXNoKGNoaWxkQm91bmRhYmxlc1tpXSk7fVxuc29ydGVkQ2hpbGRCb3VuZGFibGVzLnNvcnQodGhpcy54Q29tcGFyYXRvcik7dmFyIHZlcnRpY2FsU2xpY2VzPXRoaXMudmVydGljYWxTbGljZXMoc29ydGVkQ2hpbGRCb3VuZGFibGVzLE1hdGguY2VpbChNYXRoLnNxcnQobWluTGVhZkNvdW50KSkpO3JldHVybiB0aGlzLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXNGcm9tVmVydGljYWxTbGljZXModmVydGljYWxTbGljZXMsbmV3TGV2ZWwpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmNyZWF0ZVBhcmVudEJvdW5kYWJsZXNGcm9tVmVydGljYWxTbGljZXM9ZnVuY3Rpb24odmVydGljYWxTbGljZXMsbmV3TGV2ZWwpe2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHZlcnRpY2FsU2xpY2VzLmxlbmd0aD4wKTt2YXIgcGFyZW50Qm91bmRhYmxlcz1bXTtmb3IodmFyIGk9MDtpPHZlcnRpY2FsU2xpY2VzLmxlbmd0aDtpKyspe3BhcmVudEJvdW5kYWJsZXM9cGFyZW50Qm91bmRhYmxlcy5jb25jYXQodGhpcy5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2UodmVydGljYWxTbGljZXNbaV0sbmV3TGV2ZWwpKTt9XG5yZXR1cm4gcGFyZW50Qm91bmRhYmxlczt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5jcmVhdGVQYXJlbnRCb3VuZGFibGVzRnJvbVZlcnRpY2FsU2xpY2U9ZnVuY3Rpb24oY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlUGFyZW50Qm91bmRhYmxlcy5jYWxsKHRoaXMsY2hpbGRCb3VuZGFibGVzLG5ld0xldmVsKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS52ZXJ0aWNhbFNsaWNlcz1mdW5jdGlvbihjaGlsZEJvdW5kYWJsZXMsc2xpY2VDb3VudCl7dmFyIHNsaWNlQ2FwYWNpdHk9TWF0aC5jZWlsKGNoaWxkQm91bmRhYmxlcy5sZW5ndGgvc2xpY2VDb3VudCk7dmFyIHNsaWNlcz1bXTt2YXIgaT0wLGJvdW5kYWJsZXNBZGRlZFRvU2xpY2UsY2hpbGRCb3VuZGFibGU7Zm9yKHZhciBqPTA7ajxzbGljZUNvdW50O2orKyl7c2xpY2VzW2pdPVtdO2JvdW5kYWJsZXNBZGRlZFRvU2xpY2U9MDt3aGlsZShpPGNoaWxkQm91bmRhYmxlcy5sZW5ndGgmJmJvdW5kYWJsZXNBZGRlZFRvU2xpY2U8c2xpY2VDYXBhY2l0eSl7Y2hpbGRCb3VuZGFibGU9Y2hpbGRCb3VuZGFibGVzW2krK107c2xpY2VzW2pdLnB1c2goY2hpbGRCb3VuZGFibGUpO2JvdW5kYWJsZXNBZGRlZFRvU2xpY2UrKzt9fVxucmV0dXJuIHNsaWNlczt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLkRFRkFVTFRfTk9ERV9DQVBBQ0lUWT0xMDtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihsZXZlbCl7dmFyIGFic3RyYWN0Tm9kZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZShsZXZlbCk7YWJzdHJhY3ROb2RlLmNvbXB1dGVCb3VuZHM9ZnVuY3Rpb24oKXt2YXIgYm91bmRzPW51bGw7dmFyIGNoaWxkQm91bmRhYmxlcz10aGlzLmdldENoaWxkQm91bmRhYmxlcygpO2Zvcih2YXIgaT0wO2k8Y2hpbGRCb3VuZGFibGVzLmxlbmd0aDtpKyspe3ZhciBjaGlsZEJvdW5kYWJsZT1jaGlsZEJvdW5kYWJsZXNbaV07aWYoYm91bmRzPT09bnVsbCl7Ym91bmRzPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCkpO31lbHNle2JvdW5kcy5leHBhbmRUb0luY2x1ZGUoY2hpbGRCb3VuZGFibGUuZ2V0Qm91bmRzKCkpO319XG5yZXR1cm4gYm91bmRzO307cmV0dXJuIGFic3RyYWN0Tm9kZTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5nZXRJbnRlcnNlY3RzT3A9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzT3A7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7aWYoaXRlbUVudi5pc051bGwoKSl7cmV0dXJuO31cbmpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmluc2VydC5jYWxsKHRoaXMsaXRlbUVudixpdGVtKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbihzZWFyY2hFbnYsdmlzaXRvcil7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLnF1ZXJ5LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oaXRlbUVudixpdGVtKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcyxpdGVtRW52LGl0ZW0pO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUuc2l6ZS5jYWxsKHRoaXMpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLmRlcHRoPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmRlcHRoLmNhbGwodGhpcyk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUuZ2V0Q29tcGFyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnlDb21wYXJhdG9yO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXI9ZnVuY3Rpb24oaXRlbURpc3Qpe3ZhciBicD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZVBhaXIodGhpcy5nZXRSb290KCksdGhpcy5nZXRSb290KCksaXRlbURpc3QpO3JldHVybiB0aGlzLm5lYXJlc3ROZWlnaGJvdXI0KGJwKTt9O2pzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlLnByb3RvdHlwZS5uZWFyZXN0TmVpZ2hib3VyMj1mdW5jdGlvbihlbnYsaXRlbSxpdGVtRGlzdCl7dmFyIGJuZD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUoZW52LGl0ZW0pO3ZhciBicD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkJvdW5kYWJsZVBhaXIodGhpcy5nZXRSb290KCksYm5kLGl0ZW1EaXN0KTtyZXR1cm4gdGhpcy5uZWFyZXN0TmVpZ2hib3VyNChicClbMF07fTtqc3RzLmluZGV4LnN0cnRyZWUuU1RSdHJlZS5wcm90b3R5cGUubmVhcmVzdE5laWdoYm91cjM9ZnVuY3Rpb24odHJlZSxpdGVtRGlzdCl7dmFyIGJwPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQm91bmRhYmxlUGFpcih0aGlzLmdldFJvb3QoKSx0cmVlLmdldFJvb3QoKSxpdGVtRGlzdCk7cmV0dXJuIHRoaXMubmVhcmVzdE5laWdoYm91cjQoYnApO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXI0PWZ1bmN0aW9uKGluaXRCbmRQYWlyKXtyZXR1cm4gdGhpcy5uZWFyZXN0TmVpZ2hib3VyNShpbml0Qm5kUGFpcixEb3VibGUuUE9TSVRJVkVfSU5GSU5JVFkpO307anN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUucHJvdG90eXBlLm5lYXJlc3ROZWlnaGJvdXI1PWZ1bmN0aW9uKGluaXRCbmRQYWlyLG1heERpc3RhbmNlKXt2YXIgZGlzdGFuY2VMb3dlckJvdW5kPW1heERpc3RhbmNlO3ZhciBtaW5QYWlyPW51bGw7dmFyIHByaVE9W107cHJpUS5wdXNoKGluaXRCbmRQYWlyKTt3aGlsZSghcHJpUS5pc0VtcHR5KCkmJmRpc3RhbmNlTG93ZXJCb3VuZD4wLjApe3ZhciBibmRQYWlyPXByaVEucG9wKCk7dmFyIGN1cnJlbnREaXN0YW5jZT1ibmRQYWlyLmdldERpc3RhbmNlKCk7aWYoY3VycmVudERpc3RhbmNlPj1kaXN0YW5jZUxvd2VyQm91bmQpXG5icmVhaztpZihibmRQYWlyLmlzTGVhdmVzKCkpe2Rpc3RhbmNlTG93ZXJCb3VuZD1jdXJyZW50RGlzdGFuY2U7bWluUGFpcj1ibmRQYWlyO31lbHNle2JuZFBhaXIuZXhwYW5kVG9RdWV1ZShwcmlRLGRpc3RhbmNlTG93ZXJCb3VuZCk7fX1cbnJldHVyblttaW5QYWlyLmdldEJvdW5kYWJsZSgwKS5nZXRJdGVtKCksbWluUGFpci5nZXRCb3VuZGFibGUoMSkuZ2V0SXRlbSgpXTt9O2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmc9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldERhdGE9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuc2V0RGF0YT1qc3RzLmFic3RyYWN0RnVuYztqc3RzLm5vZGluZy5TZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zaXplPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMubm9kaW5nLlNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGU9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudFN0cmluZy5wcm90b3R5cGUuaXNDbG9zZWQ9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuTm9kYWJsZVNlZ21lbnRTdHJpbmc9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuU2VnbWVudFN0cmluZygpO2pzdHMubm9kaW5nLk5vZGFibGVTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb249anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nPWZ1bmN0aW9uKHB0cyxkYXRhKXt0aGlzLm5vZGVMaXN0PW5ldyBqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QodGhpcyk7dGhpcy5wdHM9cHRzO3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuTm9kYWJsZVNlZ21lbnRTdHJpbmcoKTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5nZXROb2RlZFN1YnN0cmluZ3MyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIHJlc3VsdEVkZ2VsaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5nczIoc2VnU3RyaW5ncyxyZXN1bHRFZGdlbGlzdCk7cmV0dXJuIHJlc3VsdEVkZ2VsaXN0O307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5nczI9ZnVuY3Rpb24oc2VnU3RyaW5ncyxyZXN1bHRFZGdlbGlzdCl7Zm9yKHZhciBpPXNlZ1N0cmluZ3MuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBzcz1pLm5leHQoKTtzcy5nZXROb2RlTGlzdCgpLmFkZFNwbGl0RWRnZXMocmVzdWx0RWRnZWxpc3QpO319O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUubm9kZUxpc3Q9bnVsbDtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnB0cz1udWxsO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZGF0YT1udWxsO2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0RGF0YT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRhdGE7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldE5vZGVMaXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZUxpc3Q7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLnB0c1tpXTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHM7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1t0aGlzLnB0cy5sZW5ndGgtMV0pO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRTZWdtZW50T2N0YW50PWZ1bmN0aW9uKGluZGV4KXtpZihpbmRleD09PXRoaXMucHRzLmxlbmd0aC0xKVxucmV0dXJuLTE7cmV0dXJuIHRoaXMuc2FmZU9jdGFudCh0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgpLHRoaXMuZ2V0Q29vcmRpbmF0ZShpbmRleCsxKSk7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNhZmVPY3RhbnQ9ZnVuY3Rpb24ocDAscDEpe2lmKHAwLmVxdWFsczJEKHAxKSlcbnJldHVybiAwO3JldHVybiBqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50KHAwLHAxKTt9O2pzdHMubm9kaW5nLk5vZGVkU2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4KXtmb3IodmFyIGk9MDtpPGxpLmdldEludGVyc2VjdGlvbk51bSgpO2krKyl7dGhpcy5hZGRJbnRlcnNlY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCxpKTt9fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbj1mdW5jdGlvbihsaSxzZWdtZW50SW5kZXgsZ2VvbUluZGV4LGludEluZGV4KXtpZihsaSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXt0aGlzLmFkZEludGVyc2VjdGlvbjIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgaW50UHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGxpLmdldEludGVyc2VjdGlvbihpbnRJbmRleCkpO3RoaXMuYWRkSW50ZXJzZWN0aW9uMihpbnRQdCxzZWdtZW50SW5kZXgpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb24yPWZ1bmN0aW9uKGludFB0LHNlZ21lbnRJbmRleCl7dGhpcy5hZGRJbnRlcnNlY3Rpb25Ob2RlKGludFB0LHNlZ21lbnRJbmRleCk7fTtqc3RzLm5vZGluZy5Ob2RlZFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbk5vZGU9ZnVuY3Rpb24oaW50UHQsc2VnbWVudEluZGV4KXt2YXIgbm9ybWFsaXplZFNlZ21lbnRJbmRleD1zZWdtZW50SW5kZXg7dmFyIG5leHRTZWdJbmRleD1ub3JtYWxpemVkU2VnbWVudEluZGV4KzE7aWYobmV4dFNlZ0luZGV4PHRoaXMucHRzLmxlbmd0aCl7dmFyIG5leHRQdD10aGlzLnB0c1tuZXh0U2VnSW5kZXhdO2lmKGludFB0LmVxdWFsczJEKG5leHRQdCkpe25vcm1hbGl6ZWRTZWdtZW50SW5kZXg9bmV4dFNlZ0luZGV4O319XG52YXIgZWk9dGhpcy5ub2RlTGlzdC5hZGQoaW50UHQsbm9ybWFsaXplZFNlZ21lbnRJbmRleCk7cmV0dXJuIGVpO307anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBnZW9tZXRyeUZhY3Rvcnk9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZhY3RvcnkoKTtyZXR1cm4gbmV3IGpzdHMuaW8uV0tUV3JpdGVyKCkud3JpdGUoZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcodGhpcy5wdHMpKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXI9ZnVuY3Rpb24oKXt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIudG9JbnRBcnJheT1mdW5jdGlvbihsaXN0KXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxsaXN0Lmxlbmd0aDtpKyspe2FycmF5W2ldPWxpc3RbaV07fVxucmV0dXJuIGFycmF5O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpbnM9ZnVuY3Rpb24ocHRzKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7cmV0dXJuIGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxucmV0dXJuIGpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zMihwdHMsbnVsbCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWluczI9ZnVuY3Rpb24ocHRzLGNvbnRleHQpe3ZhciBtY0xpc3Q9W107dmFyIHN0YXJ0SW5kZXg9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5nZXRDaGFpblN0YXJ0SW5kaWNlcyhwdHMpO2Zvcih2YXIgaT0wO2k8c3RhcnRJbmRleC5sZW5ndGgtMTtpKyspe3ZhciBtYz1uZXcganN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluKHB0cyxzdGFydEluZGV4W2ldLHN0YXJ0SW5kZXhbaSsxXSxjb250ZXh0KTttY0xpc3QucHVzaChtYyk7fVxucmV0dXJuIG1jTGlzdDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5TdGFydEluZGljZXM9ZnVuY3Rpb24ocHRzKXt2YXIgc3RhcnQ9MDt2YXIgc3RhcnRJbmRleExpc3Q9W107c3RhcnRJbmRleExpc3QucHVzaChzdGFydCk7ZG97dmFyIGxhc3Q9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci5maW5kQ2hhaW5FbmQocHRzLHN0YXJ0KTtzdGFydEluZGV4TGlzdC5wdXNoKGxhc3QpO3N0YXJ0PWxhc3Q7fXdoaWxlKHN0YXJ0PHB0cy5sZW5ndGgtMSk7dmFyIHN0YXJ0SW5kZXg9anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluQnVpbGRlci50b0ludEFycmF5KHN0YXJ0SW5kZXhMaXN0KTtyZXR1cm4gc3RhcnRJbmRleDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZmluZENoYWluRW5kPWZ1bmN0aW9uKHB0cyxzdGFydCl7dmFyIHNhZmVTdGFydD1zdGFydDt3aGlsZShzYWZlU3RhcnQ8cHRzLmxlbmd0aC0xJiZwdHNbc2FmZVN0YXJ0XS5lcXVhbHMyRChwdHNbc2FmZVN0YXJ0KzFdKSl7c2FmZVN0YXJ0Kys7fVxuaWYoc2FmZVN0YXJ0Pj1wdHMubGVuZ3RoLTEpe3JldHVybiBwdHMubGVuZ3RoLTE7fVxudmFyIGNoYWluUXVhZD1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwdHNbc2FmZVN0YXJ0XSxwdHNbc2FmZVN0YXJ0KzFdKTt2YXIgbGFzdD1zdGFydCsxO3doaWxlKGxhc3Q8cHRzLmxlbmd0aCl7aWYoIXB0c1tsYXN0LTFdLmVxdWFsczJEKHB0c1tsYXN0XSkpe3ZhciBxdWFkPWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHB0c1tsYXN0LTFdLHB0c1tsYXN0XSk7aWYocXVhZCE9PWNoYWluUXVhZClcbmJyZWFrO31cbmxhc3QrKzt9XG5yZXR1cm4gbGFzdC0xO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yPWZ1bmN0aW9uKCl7dGhpcy5pbnB1dExpbmVzPVtbXSxbXV07dGhpcy5pbnRQdD1bbnVsbCxudWxsXTt0aGlzLnBhPXRoaXMuaW50UHRbMF07dGhpcy5wYj10aGlzLmludFB0WzFdO3RoaXMucmVzdWx0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OPTA7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTj0xO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OPTI7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5zZXRQcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCl7dGhpcy5wcmVjaXNpb25Nb2RlbD1wcmVjaXNpb25Nb2RlbDt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0RW5kcG9pbnQ9ZnVuY3Rpb24oc2VnbWVudEluZGV4LHB0SW5kZXgpe3JldHVybiB0aGlzLmlucHV0TGluZXNbc2VnbWVudEluZGV4XVtwdEluZGV4XTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5jb21wdXRlRWRnZURpc3RhbmNlPWZ1bmN0aW9uKHAscDAscDEpe3ZhciBkeD1NYXRoLmFicyhwMS54LXAwLngpO3ZhciBkeT1NYXRoLmFicyhwMS55LXAwLnkpO3ZhciBkaXN0PS0xLjA7aWYocC5lcXVhbHMocDApKXtkaXN0PTAuMDt9ZWxzZSBpZihwLmVxdWFscyhwMSkpe2lmKGR4PmR5KXtkaXN0PWR4O31lbHNle2Rpc3Q9ZHk7fX1lbHNle3ZhciBwZHg9TWF0aC5hYnMocC54LXAwLngpO3ZhciBwZHk9TWF0aC5hYnMocC55LXAwLnkpO2lmKGR4PmR5KXtkaXN0PXBkeDt9ZWxzZXtkaXN0PXBkeTt9XG5pZihkaXN0PT09MC4wJiYhcC5lcXVhbHMocDApKXtkaXN0PU1hdGgubWF4KHBkeCxwZHkpO319XG5pZihkaXN0PT09MC4wJiYhcC5lcXVhbHMocDApKXt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignQmFkIGRpc3RhbmNlIGNhbGN1bGF0aW9uJyk7fVxucmV0dXJuIGRpc3Q7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3Iubm9uUm9idXN0Q29tcHV0ZUVkZ2VEaXN0YW5jZT1mdW5jdGlvbihwLHAxLHAyKXt2YXIgZHg9cC54LXAxLng7dmFyIGR5PXAueS1wMS55O3ZhciBkaXN0PU1hdGguc3FydChkeCpkeCtkeSpkeSk7aWYoIShkaXN0PT09MC4wJiYhcC5lcXVhbHMocDEpKSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0ludmFsaWQgZGlzdGFuY2UgY2FsY3VsYXRpb24nKTt9XG5yZXR1cm4gZGlzdDt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucmVzdWx0PW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pbnB1dExpbmVzPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pbnRQdD1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50TGluZUluZGV4PW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5faXNQcm9wZXI9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnBhPW51bGw7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wYj1udWxsO2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocCxwMSxwMil7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNDb2xsaW5lYXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHQ9PT1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbj1mdW5jdGlvbihwMSxwMixwMyxwNCl7dGhpcy5pbnB1dExpbmVzWzBdWzBdPXAxO3RoaXMuaW5wdXRMaW5lc1swXVsxXT1wMjt0aGlzLmlucHV0TGluZXNbMV1bMF09cDM7dGhpcy5pbnB1dExpbmVzWzFdWzFdPXA0O3RoaXMucmVzdWx0PXRoaXMuY29tcHV0ZUludGVyc2VjdChwMSxwMixwMyxwNCk7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Q9ZnVuY3Rpb24ocDEscDIscTEscTIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkFic3RyYWN0TWV0aG9kSW52b2NhdGlvbkVycm9yKCk7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzRW5kUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb24oKSYmIXRoaXMuX2lzUHJvcGVyO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHQhPT1qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb25OdW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZXN1bHQ7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEludGVyc2VjdGlvbj1mdW5jdGlvbihpbnRJbmRleCl7cmV0dXJuIHRoaXMuaW50UHRbaW50SW5kZXhdO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50TGluZUluZGV4PWZ1bmN0aW9uKCl7aWYodGhpcy5pbnRMaW5lSW5kZXg9PT1udWxsKXt0aGlzLmludExpbmVJbmRleD1bW10sW11dO3RoaXMuY29tcHV0ZUludExpbmVJbmRleCgwKTt0aGlzLmNvbXB1dGVJbnRMaW5lSW5kZXgoMSk7fX07anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0ludGVyc2VjdGlvbj1mdW5jdGlvbihwdCl7dmFyIGk7Zm9yKGk9MDtpPHRoaXMucmVzdWx0O2krKyl7aWYodGhpcy5pbnRQdFtpXS5lcXVhbHMyRChwdCkpe3JldHVybiB0cnVlO319XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuaXNJbnRlcmlvckludGVyc2VjdGlvbjIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmlmKHRoaXMuaXNJbnRlcmlvckludGVyc2VjdGlvbigwKSl7cmV0dXJuIHRydWU7fVxuaWYodGhpcy5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKDEpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24yPWZ1bmN0aW9uKGlucHV0TGluZUluZGV4KXt2YXIgaTtmb3IoaT0wO2k8dGhpcy5yZXN1bHQ7aSsrKXtpZighKHRoaXMuaW50UHRbaV0uZXF1YWxzMkQodGhpcy5pbnB1dExpbmVzW2lucHV0TGluZUluZGV4XVswXSl8fHRoaXMuaW50UHRbaV0uZXF1YWxzMkQodGhpcy5pbnB1dExpbmVzW2lucHV0TGluZUluZGV4XVsxXSkpKXtyZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc1Byb3Blcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc0ludGVyc2VjdGlvbigpJiZ0aGlzLl9pc1Byb3Blcjt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9uQWxvbmdTZWdtZW50PWZ1bmN0aW9uKHNlZ21lbnRJbmRleCxpbnRJbmRleCl7dGhpcy5jb21wdXRlSW50TGluZUluZGV4KCk7cmV0dXJuIHRoaXMuaW50UHRbaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1baW50SW5kZXhdXTt9O2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZ2V0SW5kZXhBbG9uZ1NlZ21lbnQ9ZnVuY3Rpb24oc2VnbWVudEluZGV4LGludEluZGV4KXt0aGlzLmNvbXB1dGVJbnRMaW5lSW5kZXgoKTtyZXR1cm4gdGhpcy5pbnRMaW5lSW5kZXhbc2VnbWVudEluZGV4XVtpbnRJbmRleF07fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRMaW5lSW5kZXg9ZnVuY3Rpb24oc2VnbWVudEluZGV4KXt2YXIgZGlzdDA9dGhpcy5nZXRFZGdlRGlzdGFuY2Uoc2VnbWVudEluZGV4LDApO3ZhciBkaXN0MT10aGlzLmdldEVkZ2VEaXN0YW5jZShzZWdtZW50SW5kZXgsMSk7aWYoZGlzdDA+ZGlzdDEpe3RoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1bMF09MDt0aGlzLmludExpbmVJbmRleFtzZWdtZW50SW5kZXhdWzFdPTE7fWVsc2V7dGhpcy5pbnRMaW5lSW5kZXhbc2VnbWVudEluZGV4XVswXT0xO3RoaXMuaW50TGluZUluZGV4W3NlZ21lbnRJbmRleF1bMV09MDt9fTtqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmdldEVkZ2VEaXN0YW5jZT1mdW5jdGlvbihzZWdtZW50SW5kZXgsaW50SW5kZXgpe3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5jb21wdXRlRWRnZURpc3RhbmNlKHRoaXMuaW50UHRbaW50SW5kZXhdLHRoaXMuaW5wdXRMaW5lc1tzZWdtZW50SW5kZXhdWzBdLHRoaXMuaW5wdXRMaW5lc1tzZWdtZW50SW5kZXhdWzFdKTtyZXR1cm4gZGlzdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29uc3RydWN0b3IuY2FsbCh0aGlzKTt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGU9bmV3IGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3RvcigpO2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbj1mdW5jdGlvbihwLHAxLHAyKXtpZihhcmd1bWVudHMubGVuZ3RoPT09NCl7anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5faXNQcm9wZXI9ZmFsc2U7aWYoanN0cy5nZW9tLkVudmVsb3BlLmludGVyc2VjdHMocDEscDIscCkpe2lmKChqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChwMSxwMixwKT09PTApJiYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDIscDEscCk9PT0wKSl7dGhpcy5faXNQcm9wZXI9dHJ1ZTtpZihwLmVxdWFscyhwMSl8fHAuZXF1YWxzKHAyKSl7dGhpcy5faXNQcm9wZXI9ZmFsc2U7fVxudGhpcy5yZXN1bHQ9anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjtyZXR1cm47fX1cbnRoaXMucmVzdWx0PWpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fTtqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Q9ZnVuY3Rpb24ocDEscDIscTEscTIpe3RoaXMuX2lzUHJvcGVyPWZhbHNlO2lmKCFqc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhwMSxwMixxMSxxMikpe3JldHVybiBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO31cbnZhciBQcTE9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDEscDIscTEpO3ZhciBQcTI9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgocDEscDIscTIpO2lmKChQcTE+MCYmUHEyPjApfHwoUHExPDAmJlBxMjwwKSl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5OT19JTlRFUlNFQ1RJT047fVxudmFyIFFwMT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChxMSxxMixwMSk7dmFyIFFwMj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMub3JpZW50YXRpb25JbmRleChxMSxxMixwMik7aWYoKFFwMT4wJiZRcDI+MCl8fChRcDE8MCYmUXAyPDApKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLk5PX0lOVEVSU0VDVElPTjt9XG52YXIgY29sbGluZWFyPVBxMT09PTAmJlBxMj09PTAmJlFwMT09PTAmJlFwMj09PTA7aWYoY29sbGluZWFyKXtyZXR1cm4gdGhpcy5jb21wdXRlQ29sbGluZWFySW50ZXJzZWN0aW9uKHAxLHAyLHExLHEyKTt9XG5pZihQcTE9PT0wfHxQcTI9PT0wfHxRcDE9PT0wfHxRcDI9PT0wKXt0aGlzLl9pc1Byb3Blcj1mYWxzZTtpZihwMS5lcXVhbHMyRChxMSl8fHAxLmVxdWFsczJEKHEyKSl7dGhpcy5pbnRQdFswXT1wMTt9ZWxzZSBpZihwMi5lcXVhbHMyRChxMSl8fHAyLmVxdWFsczJEKHEyKSl7dGhpcy5pbnRQdFswXT1wMjt9XG5lbHNlIGlmKFBxMT09PTApe3RoaXMuaW50UHRbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHExKTt9ZWxzZSBpZihQcTI9PT0wKXt0aGlzLmludFB0WzBdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShxMik7fWVsc2UgaWYoUXAxPT09MCl7dGhpcy5pbnRQdFswXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocDEpO31lbHNlIGlmKFFwMj09PTApe3RoaXMuaW50UHRbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAyKTt9fWVsc2V7dGhpcy5faXNQcm9wZXI9dHJ1ZTt0aGlzLmludFB0WzBdPXRoaXMuaW50ZXJzZWN0aW9uKHAxLHAyLHExLHEyKTt9XG5yZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUNvbGxpbmVhckludGVyc2VjdGlvbj1mdW5jdGlvbihwMSxwMixxMSxxMil7dmFyIHAxcTFwMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhwMSxwMixxMSk7dmFyIHAxcTJwMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhwMSxwMixxMik7dmFyIHExcDFxMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhxMSxxMixwMSk7dmFyIHExcDJxMj1qc3RzLmdlb20uRW52ZWxvcGUuaW50ZXJzZWN0cyhxMSxxMixwMik7aWYocDFxMXAyJiZwMXEycDIpe3RoaXMuaW50UHRbMF09cTE7dGhpcy5pbnRQdFsxXT1xMjtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocTFwMXEyJiZxMXAycTIpe3RoaXMuaW50UHRbMF09cDE7dGhpcy5pbnRQdFsxXT1wMjtyZXR1cm4ganN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocDFxMXAyJiZxMXAxcTIpe3RoaXMuaW50UHRbMF09cTE7dGhpcy5pbnRQdFsxXT1wMTtyZXR1cm4gcTEuZXF1YWxzKHAxKSYmIXAxcTJwMiYmIXExcDJxMj9qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuUE9JTlRfSU5URVJTRUNUSU9OOmpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbmlmKHAxcTFwMiYmcTFwMnEyKXt0aGlzLmludFB0WzBdPXExO3RoaXMuaW50UHRbMV09cDI7cmV0dXJuIHExLmVxdWFscyhwMikmJiFwMXEycDImJiFxMXAxcTI/anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLlBPSU5UX0lOVEVSU0VDVElPTjpqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuQ09MTElORUFSX0lOVEVSU0VDVElPTjt9XG5pZihwMXEycDImJnExcDFxMil7dGhpcy5pbnRQdFswXT1xMjt0aGlzLmludFB0WzFdPXAxO3JldHVybiBxMi5lcXVhbHMocDEpJiYhcDFxMXAyJiYhcTFwMnEyP2pzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5QT0lOVF9JTlRFUlNFQ1RJT046anN0cy5hbGdvcml0aG0uTGluZUludGVyc2VjdG9yLkNPTExJTkVBUl9JTlRFUlNFQ1RJT047fVxuaWYocDFxMnAyJiZxMXAycTIpe3RoaXMuaW50UHRbMF09cTI7dGhpcy5pbnRQdFsxXT1wMjtyZXR1cm4gcTIuZXF1YWxzKHAyKSYmIXAxcTFwMiYmIXExcDFxMj9qc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuUE9JTlRfSU5URVJTRUNUSU9OOmpzdHMuYWxnb3JpdGhtLkxpbmVJbnRlcnNlY3Rvci5DT0xMSU5FQVJfSU5URVJTRUNUSU9OO31cbnJldHVybiBqc3RzLmFsZ29yaXRobS5MaW5lSW50ZXJzZWN0b3IuTk9fSU5URVJTRUNUSU9OO307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBpbnRQdD10aGlzLmludGVyc2VjdGlvbldpdGhOb3JtYWxpemF0aW9uKHAxLHAyLHExLHEyKTtpZighdGhpcy5pc0luU2VnbWVudEVudmVsb3BlcyhpbnRQdCkpe2ludFB0PWpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmdldEludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fVxuaWYodGhpcy5wcmVjaXNpb25Nb2RlbCE9PW51bGwpe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoaW50UHQpO31cbnJldHVybiBpbnRQdDt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW50ZXJzZWN0aW9uV2l0aE5vcm1hbGl6YXRpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBuMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocDEpO3ZhciBuMj1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocDIpO3ZhciBuMz1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocTEpO3ZhciBuND1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocTIpO3ZhciBub3JtUHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5ub3JtYWxpemVUb0VudkNlbnRyZShuMSxuMixuMyxuNCxub3JtUHQpO3ZhciBpbnRQdD10aGlzLnNhZmVIQ29vcmRpbmF0ZUludGVyc2VjdGlvbihuMSxuMixuMyxuNCk7aW50UHQueCs9bm9ybVB0Lng7aW50UHQueSs9bm9ybVB0Lnk7cmV0dXJuIGludFB0O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5zYWZlSENvb3JkaW5hdGVJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBpbnRQdD1udWxsO3RyeXtpbnRQdD1qc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5pbnRlcnNlY3Rpb24ocDEscDIscTEscTIpO31jYXRjaChlKXtpZihlIGluc3RhbmNlb2YganN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3Ipe2ludFB0PWpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmdldEludGVyc2VjdGlvbihwMSxwMixxMSxxMik7fWVsc2V7dGhyb3cgZTt9fVxucmV0dXJuIGludFB0O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5ub3JtYWxpemVUb01pbmltdW09ZnVuY3Rpb24objEsbjIsbjMsbjQsbm9ybVB0KXtub3JtUHQueD10aGlzLnNtYWxsZXN0SW5BYnNWYWx1ZShuMS54LG4yLngsbjMueCxuNC54KTtub3JtUHQueT10aGlzLnNtYWxsZXN0SW5BYnNWYWx1ZShuMS55LG4yLnksbjMueSxuNC55KTtuMS54LT1ub3JtUHQueDtuMS55LT1ub3JtUHQueTtuMi54LT1ub3JtUHQueDtuMi55LT1ub3JtUHQueTtuMy54LT1ub3JtUHQueDtuMy55LT1ub3JtUHQueTtuNC54LT1ub3JtUHQueDtuNC55LT1ub3JtUHQueTt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUubm9ybWFsaXplVG9FbnZDZW50cmU9ZnVuY3Rpb24objAwLG4wMSxuMTAsbjExLG5vcm1QdCl7dmFyIG1pblgwPW4wMC54PG4wMS54P24wMC54Om4wMS54O3ZhciBtaW5ZMD1uMDAueTxuMDEueT9uMDAueTpuMDEueTt2YXIgbWF4WDA9bjAwLng+bjAxLng/bjAwLng6bjAxLng7dmFyIG1heFkwPW4wMC55Pm4wMS55P24wMC55Om4wMS55O3ZhciBtaW5YMT1uMTAueDxuMTEueD9uMTAueDpuMTEueDt2YXIgbWluWTE9bjEwLnk8bjExLnk/bjEwLnk6bjExLnk7dmFyIG1heFgxPW4xMC54Pm4xMS54P24xMC54Om4xMS54O3ZhciBtYXhZMT1uMTAueT5uMTEueT9uMTAueTpuMTEueTt2YXIgaW50TWluWD1taW5YMD5taW5YMT9taW5YMDptaW5YMTt2YXIgaW50TWF4WD1tYXhYMDxtYXhYMT9tYXhYMDptYXhYMTt2YXIgaW50TWluWT1taW5ZMD5taW5ZMT9taW5ZMDptaW5ZMTt2YXIgaW50TWF4WT1tYXhZMDxtYXhZMT9tYXhZMDptYXhZMTt2YXIgaW50TWlkWD0oaW50TWluWCtpbnRNYXhYKS8yLjA7dmFyIGludE1pZFk9KGludE1pblkraW50TWF4WSkvMi4wO25vcm1QdC54PWludE1pZFg7bm9ybVB0Lnk9aW50TWlkWTtuMDAueC09bm9ybVB0Lng7bjAwLnktPW5vcm1QdC55O24wMS54LT1ub3JtUHQueDtuMDEueS09bm9ybVB0Lnk7bjEwLngtPW5vcm1QdC54O24xMC55LT1ub3JtUHQueTtuMTEueC09bm9ybVB0Lng7bjExLnktPW5vcm1QdC55O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5zbWFsbGVzdEluQWJzVmFsdWU9ZnVuY3Rpb24oeDEseDIseDMseDQpe3ZhciB4PXgxO3ZhciB4YWJzPU1hdGguYWJzKHgpO2lmKE1hdGguYWJzKHgyKTx4YWJzKXt4PXgyO3hhYnM9TWF0aC5hYnMoeDIpO31cbmlmKE1hdGguYWJzKHgzKTx4YWJzKXt4PXgzO3hhYnM9TWF0aC5hYnMoeDMpO31cbmlmKE1hdGguYWJzKHg0KTx4YWJzKXt4PXg0O31cbnJldHVybiB4O307anN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5pc0luU2VnbWVudEVudmVsb3Blcz1mdW5jdGlvbihpbnRQdCl7dmFyIGVudjA9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmlucHV0TGluZXNbMF1bMF0sdGhpcy5pbnB1dExpbmVzWzBdWzFdKTt2YXIgZW52MT1uZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMuaW5wdXRMaW5lc1sxXVswXSx0aGlzLmlucHV0TGluZXNbMV1bMV0pO3JldHVybiBlbnYwLmNvbnRhaW5zKGludFB0KSYmZW52MS5jb250YWlucyhpbnRQdCk7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZT1mdW5jdGlvbigpe3RoaXMueD0wLjA7dGhpcy55PTAuMDt0aGlzLnc9MS4wO2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXt0aGlzLmluaXRGcm9tMUNvb3JkaW5hdGUoYXJndW1lbnRzWzBdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MiYmYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7dGhpcy5pbml0RnJvbTJDb29yZGluYXRlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MiYmYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZSl7dGhpcy5pbml0RnJvbTJIQ29vcmRpbmF0ZXMoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuaW5pdEZyb21YWShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dGhpcy5pbml0RnJvbVhZVyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSk7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTQpe3RoaXMuaW5pdEZyb21YWVcoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdKTt9fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDEscDIscTEscTIpe3ZhciBweCxweSxwdyxxeCxxeSxxdyx4LHksdyx4SW50LHlJbnQ7cHg9cDEueS1wMi55O3B5PXAyLngtcDEueDtwdz1wMS54KnAyLnktcDIueCpwMS55O3F4PXExLnktcTIueTtxeT1xMi54LXExLng7cXc9cTEueCpxMi55LXEyLngqcTEueTt4PXB5KnF3LXF5KnB3O3k9cXgqcHctcHgqcXc7dz1weCpxeS1xeCpweTt4SW50PXgvdzt5SW50PXkvdztpZighaXNGaW5pdGUoeEludCl8fCFpc0Zpbml0ZSh5SW50KSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKCk7fVxucmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4SW50LHlJbnQpO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmluaXRGcm9tMUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7dGhpcy54PXAueDt0aGlzLnk9cC55O3RoaXMudz0xLjA7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuaW5pdEZyb20yQ29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIpe3RoaXMueD1wMS55LXAyLnk7dGhpcy55PXAyLngtcDEueDt0aGlzLnc9cDEueCpwMi55LXAyLngqcDEueTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbTJIQ29vcmRpbmF0ZXM9ZnVuY3Rpb24ocDEscDIpe3RoaXMueD1wMS55KnAyLnctcDIueSpwMS53O3RoaXMueT1wMi54KnAxLnctcDEueCpwMi53O3RoaXMudz1wMS54KnAyLnktcDIueCpwMS55O307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmluaXRGcm9tWFlXPWZ1bmN0aW9uKHgseSx3KXt0aGlzLng9eDt0aGlzLnk9eTt0aGlzLnc9dzt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbVhZPWZ1bmN0aW9uKHgseSl7dGhpcy54PXg7dGhpcy55PXk7dGhpcy53PTEuMDt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5pbml0RnJvbTRDb29yZGluYXRlcz1mdW5jdGlvbihwMSxwMixxMSxxMil7dmFyIHB4LHB5LHB3LHF4LHF5LHF3O3B4PXAxLnktcDIueTtweT1wMi54LXAxLng7cHc9cDEueCpwMi55LXAyLngqcDEueTtxeD1xMS55LXEyLnk7cXk9cTIueC1xMS54O3F3PXExLngqcTIueS1xMi54KnExLnk7dGhpcy54PXB5KnF3LXF5KnB3O3RoaXMueT1xeCpwdy1weCpxdzt0aGlzLnc9cHgqcXktcXgqcHk7fTtqc3RzLmFsZ29yaXRobS5IQ29vcmRpbmF0ZS5wcm90b3R5cGUuZ2V0WD1mdW5jdGlvbigpe3ZhciBhPXRoaXMueC90aGlzLnc7aWYoIWlzRmluaXRlKGEpKXt0aHJvdyBuZXcganN0cy5lcnJvci5Ob3RSZXByZXNlbnRhYmxlRXJyb3IoKTt9XG5yZXR1cm4gYTt9O2pzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLnByb3RvdHlwZS5nZXRZPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy55L3RoaXMudztpZighaXNGaW5pdGUoYSkpe3Rocm93IG5ldyBqc3RzLmVycm9yLk5vdFJlcHJlc2VudGFibGVFcnJvcigpO31cbnJldHVybiBhO307anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt2YXIgcD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtwLng9dGhpcy5nZXRYKCk7cC55PXRoaXMuZ2V0WSgpO3JldHVybiBwO307anN0cy5nZW9tLkxpbmVTZWdtZW50PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTApe3RoaXMucDA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5wMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5wMD1hcmd1bWVudHNbMF0ucDA7dGhpcy5wMT1hcmd1bWVudHNbMF0ucDE7fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMucDA9YXJndW1lbnRzWzBdO3RoaXMucDE9YXJndW1lbnRzWzFdO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT00KXt0aGlzLnAwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt0aGlzLnAxPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdKTt9fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnAwPW51bGw7anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wMT1udWxsO2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5taWRQb2ludD1mdW5jdGlvbihwMCxwMSl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgocDAueCtwMS54KS8yLChwMC55K3AxLnkpLzIpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe2lmKGk9PT0wKXJldHVybiB0aGlzLnAwO3JldHVybiB0aGlzLnAxO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMC5kaXN0YW5jZSh0aGlzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuaXNIb3Jpem9udGFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDAueT09PXRoaXMucDEueTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuaXNWZXJ0aWNhbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAwLng9PT10aGlzLnAxLng7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLm9yaWVudGF0aW9uSW5kZXg9ZnVuY3Rpb24oYXJnKXtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpe3JldHVybiB0aGlzLm9yaWVudGF0aW9uSW5kZXgxKGFyZyk7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLm9yaWVudGF0aW9uSW5kZXgyKGFyZyk7fX07anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5vcmllbnRhdGlvbkluZGV4MT1mdW5jdGlvbihzZWcpe3ZhciBvcmllbnQwPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHRoaXMucDAsdGhpcy5wMSxzZWcucDApO3ZhciBvcmllbnQxPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5vcmllbnRhdGlvbkluZGV4KHRoaXMucDAsdGhpcy5wMSxzZWcucDEpO2lmKG9yaWVudDA+PTAmJm9yaWVudDE+PTApe3JldHVybiBNYXRoLm1heChvcmllbnQwLG9yaWVudDEpO31cbmlmKG9yaWVudDA8PTAmJm9yaWVudDE8PTApe3JldHVybiBNYXRoLm1heChvcmllbnQwLG9yaWVudDEpO31cbnJldHVybiAwO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5vcmllbnRhdGlvbkluZGV4Mj1mdW5jdGlvbihwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLm9yaWVudGF0aW9uSW5kZXgodGhpcy5wMCx0aGlzLnAxLHApO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5yZXZlcnNlPWZ1bmN0aW9uKCl7dmFyIHRlbXA9dGhpcy5wMDt0aGlzLnAwPXRoaXMucDE7dGhpcy5wMT10ZW1wO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXtpZih0aGlzLnAxLmNvbXBhcmVUbyh0aGlzLnAwKTwwKXRoaXMucmV2ZXJzZSgpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5hbmdsZT1mdW5jdGlvbigpe3JldHVybiBNYXRoLmF0YW4yKHRoaXMucDEueS10aGlzLnAwLnksdGhpcy5wMS54LXRoaXMucDAueCk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLm1pZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5MaW5lU2VnbWVudC5taWRQb2ludCh0aGlzLnAwLHRoaXMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5kaXN0YW5jZT1mdW5jdGlvbihhcmcpe2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU2VnbWVudCl7cmV0dXJuIHRoaXMuZGlzdGFuY2UxKGFyZyk7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLmRpc3RhbmNlMihhcmcpO319O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2UxPWZ1bmN0aW9uKGxzKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlTGluZUxpbmUodGhpcy5wMCx0aGlzLnAxLGxzLnAwLGxzLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZGlzdGFuY2UyPWZ1bmN0aW9uKHApe3JldHVybiBqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUocCx0aGlzLnAwLHRoaXMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wb2ludEFsb25nPWZ1bmN0aW9uKHNlZ21lbnRMZW5ndGhGcmFjdGlvbil7dmFyIGNvb3JkPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2Nvb3JkLng9dGhpcy5wMC54K3NlZ21lbnRMZW5ndGhGcmFjdGlvbioodGhpcy5wMS54LXRoaXMucDAueCk7Y29vcmQueT10aGlzLnAwLnkrc2VnbWVudExlbmd0aEZyYWN0aW9uKih0aGlzLnAxLnktdGhpcy5wMC55KTtyZXR1cm4gY29vcmQ7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnBvaW50QWxvbmdPZmZzZXQ9ZnVuY3Rpb24oc2VnbWVudExlbmd0aEZyYWN0aW9uLG9mZnNldERpc3RhbmNlKXt2YXIgc2VneD10aGlzLnAwLngrc2VnbWVudExlbmd0aEZyYWN0aW9uKih0aGlzLnAxLngtdGhpcy5wMC54KTt2YXIgc2VneT10aGlzLnAwLnkrc2VnbWVudExlbmd0aEZyYWN0aW9uKih0aGlzLnAxLnktdGhpcy5wMC55KTt2YXIgZHg9dGhpcy5wMS54LXRoaXMucDAueDt2YXIgZHk9dGhpcy5wMS55LXRoaXMucDAueTt2YXIgbGVuPU1hdGguc3FydChkeCpkeCtkeSpkeSk7dmFyIHV4PTA7dmFyIHV5PTA7aWYob2Zmc2V0RGlzdGFuY2UhPT0wKXtpZihsZW48PTApe3Rocm93XCJDYW5ub3QgY29tcHV0ZSBvZmZzZXQgZnJvbSB6ZXJvLWxlbmd0aCBsaW5lIHNlZ21lbnRcIjt9XG51eD1vZmZzZXREaXN0YW5jZSpkeC9sZW47dXk9b2Zmc2V0RGlzdGFuY2UqZHkvbGVuO31cbnZhciBvZmZzZXR4PXNlZ3gtdXk7dmFyIG9mZnNldHk9c2VneSt1eDt2YXIgY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKG9mZnNldHgsb2Zmc2V0eSk7cmV0dXJuIGNvb3JkO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wcm9qZWN0aW9uRmFjdG9yPWZ1bmN0aW9uKHApe2lmKHAuZXF1YWxzKHRoaXMucDApKVxucmV0dXJuIDAuMDtpZihwLmVxdWFscyh0aGlzLnAxKSlcbnJldHVybiAxLjA7dmFyIGR4PXRoaXMucDEueC10aGlzLnAwLng7dmFyIGR5PXRoaXMucDEueS10aGlzLnAwLnk7dmFyIGxlbjI9ZHgqZHgrZHkqZHk7dmFyIHI9KChwLngtdGhpcy5wMC54KSpkeCsocC55LXRoaXMucDAueSkqZHkpL2xlbjI7cmV0dXJuIHI7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLnNlZ21lbnRGcmFjdGlvbj1mdW5jdGlvbihpbnB1dFB0KXt2YXIgc2VnRnJhYz10aGlzLnByb2plY3Rpb25GYWN0b3IoaW5wdXRQdCk7aWYoc2VnRnJhYzwwKXtzZWdGcmFjPTA7fWVsc2UgaWYoc2VnRnJhYz4xfHxpc05hTihzZWdGcmFjKSl7c2VnRnJhYz0xO31cbnJldHVybiBzZWdGcmFjO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wcm9qZWN0PWZ1bmN0aW9uKGFyZyl7aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3JldHVybiB0aGlzLnByb2plY3QxKGFyZyk7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTZWdtZW50KXtyZXR1cm4gdGhpcy5wcm9qZWN0MihhcmcpO319O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUucHJvamVjdDE9ZnVuY3Rpb24ocCl7aWYocC5lcXVhbHModGhpcy5wMCl8fHAuZXF1YWxzKHRoaXMucDEpKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHApO31cbnZhciByPXRoaXMucHJvamVjdGlvbkZhY3RvcihwKTt2YXIgY29vcmQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7Y29vcmQueD10aGlzLnAwLngrcioodGhpcy5wMS54LXRoaXMucDAueCk7Y29vcmQueT10aGlzLnAwLnkrcioodGhpcy5wMS55LXRoaXMucDAueSk7cmV0dXJuIGNvb3JkO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5wcm9qZWN0Mj1mdW5jdGlvbihzZWcpe3ZhciBwZjA9dGhpcy5wcm9qZWN0aW9uRmFjdG9yKHNlZy5wMCk7dmFyIHBmMT10aGlzLnByb2plY3Rpb25GYWN0b3Ioc2VnLnAxKTtpZihwZjA+PTEmJnBmMT49MSlyZXR1cm4gbnVsbDtpZihwZjA8PTAmJnBmMTw9MClyZXR1cm4gbnVsbDt2YXIgbmV3cDA9dGhpcy5wcm9qZWN0KHNlZy5wMCk7aWYocGYwPDApbmV3cDA9cDA7aWYocGYwPjEpbmV3cDA9cDE7dmFyIG5ld3AxPXRoaXMucHJvamVjdChzZWcucDEpO2lmKHBmMTwwLjApbmV3cDE9cDA7aWYocGYxPjEuMCluZXdwMT1wMTtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChuZXdwMCxuZXdwMSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmNsb3Nlc3RQb2ludD1mdW5jdGlvbihwKXt2YXIgZmFjdG9yPXRoaXMucHJvamVjdGlvbkZhY3RvcihwKTtpZihmYWN0b3I+MCYmZmFjdG9yPDEpe3JldHVybiB0aGlzLnByb2plY3QocCk7fVxudmFyIGRpc3QwPXRoaXMucDAuZGlzdGFuY2UocCk7dmFyIGRpc3QxPXRoaXMucDEuZGlzdGFuY2UocCk7aWYoZGlzdDA8ZGlzdDEpXG5yZXR1cm4gdGhpcy5wMDtyZXR1cm4gdGhpcy5wMTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuY2xvc2VzdFBvaW50cz1mdW5jdGlvbihsaW5lKXt2YXIgaW50UHQ9dGhpcy5pbnRlcnNlY3Rpb24obGluZSk7aWYoaW50UHQhPT1udWxsKXtyZXR1cm5baW50UHQsaW50UHRdO31cbnZhciBjbG9zZXN0UHQ9W107dmFyIG1pbkRpc3RhbmNlPU51bWJlci5NQVhfVkFMVUU7dmFyIGRpc3Q7dmFyIGNsb3NlMDA9dGhpcy5jbG9zZXN0UG9pbnQobGluZS5wMCk7bWluRGlzdGFuY2U9Y2xvc2UwMC5kaXN0YW5jZShsaW5lLnAwKTtjbG9zZXN0UHRbMF09Y2xvc2UwMDtjbG9zZXN0UHRbMV09bGluZS5wMDt2YXIgY2xvc2UwMT10aGlzLmNsb3Nlc3RQb2ludChsaW5lLnAxKTtkaXN0PWNsb3NlMDEuZGlzdGFuY2UobGluZS5wMSk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDtjbG9zZXN0UHRbMF09Y2xvc2UwMTtjbG9zZXN0UHRbMV09bGluZS5wMTt9XG52YXIgY2xvc2UxMD1saW5lLmNsb3Nlc3RQb2ludCh0aGlzLnAwKTtkaXN0PWNsb3NlMTAuZGlzdGFuY2UodGhpcy5wMCk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDtjbG9zZXN0UHRbMF09dGhpcy5wMDtjbG9zZXN0UHRbMV09Y2xvc2UxMDt9XG52YXIgY2xvc2UxMT1saW5lLmNsb3Nlc3RQb2ludCh0aGlzLnAxKTtkaXN0PWNsb3NlMTEuZGlzdGFuY2UodGhpcy5wMSk7aWYoZGlzdDxtaW5EaXN0YW5jZSl7bWluRGlzdGFuY2U9ZGlzdDtjbG9zZXN0UHRbMF09dGhpcy5wMTtjbG9zZXN0UHRbMV09Y2xvc2UxMTt9XG5yZXR1cm4gY2xvc2VzdFB0O307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5pbnRlcnNlY3Rpb249ZnVuY3Rpb24obGluZSl7dmFyIGxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTtsaS5jb21wdXRlSW50ZXJzZWN0aW9uKHRoaXMucDAsdGhpcy5wMSxsaW5lLnAwLGxpbmUucDEpO2lmKGxpLmhhc0ludGVyc2VjdGlvbigpKVxucmV0dXJuIGxpLmdldEludGVyc2VjdGlvbigwKTtyZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuc2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24obHMpe2lmKGxzIGluc3RhbmNlb2YganN0cy5nZW9tLkNvb3JkaW5hdGUpe3RoaXMuc2V0Q29vcmRpbmF0ZXMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5zZXRDb29yZGluYXRlczIobHMucDAsbHMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5zZXRDb29yZGluYXRlczI9ZnVuY3Rpb24ocDAscDEpe3RoaXMucDAueD1wMC54O3RoaXMucDAueT1wMC55O3RoaXMucDEueD1wMS54O3RoaXMucDEueT1wMS55O307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5kaXN0YW5jZVBlcnBlbmRpY3VsYXI9ZnVuY3Rpb24ocCl7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZVBlcnBlbmRpY3VsYXIocCx0aGlzLnAwLHRoaXMucDEpO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS5saW5lSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGxpbmUpe3RyeXt2YXIgaW50UHQ9anN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUuaW50ZXJzZWN0aW9uKHRoaXMucDAsdGhpcy5wMSxsaW5lLnAwLGxpbmUucDEpO3JldHVybiBpbnRQdDt9Y2F0Y2goZXgpe31cbnJldHVybiBudWxsO307anN0cy5nZW9tLkxpbmVTZWdtZW50LnByb3RvdHlwZS50b0dlb21ldHJ5PWZ1bmN0aW9uKGdlb21GYWN0b3J5KXtyZXR1cm4gZ2VvbUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhbdGhpcy5wMCx0aGlzLnAxXSk7fTtqc3RzLmdlb20uTGluZVNlZ21lbnQucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvKXtpZighKG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRoaXMucDAuZXF1YWxzKG8ucDApJiZ0aGlzLnAxLmVxdWFscyhvLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKG8pe3ZhciBjb21wMD10aGlzLnAwLmNvbXBhcmVUbyhvLnAwKTtpZihjb21wMCE9PTApcmV0dXJuIGNvbXAwO3JldHVybiB0aGlzLnAxLmNvbXBhcmVUbyhvLnAxKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUuZXF1YWxzVG9wbz1mdW5jdGlvbihvdGhlcil7cmV0dXJuIHRoaXMucDAuZXF1YWxzKG90aGVyLnAwKSYmdGhpcy5wMS5lcXVhbHMob3RoZXIucDEpfHx0aGlzLnAwLmVxdWFscyhvdGhlci5wMSkmJnRoaXMucDEuZXF1YWxzKG90aGVyLnAwKTt9O2pzdHMuZ2VvbS5MaW5lU2VnbWVudC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkxJTkVTVFJJTkcoXCIrXG50aGlzLnAwLngrXCIgXCIrdGhpcy5wMC55XG4rXCIsIFwiK1xudGhpcy5wMS54K1wiIFwiK3RoaXMucDEueStcIilcIjt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb249ZnVuY3Rpb24oKXt0aGlzLnRlbXBFbnYxPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLnRlbXBFbnYyPW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLm92ZXJsYXBTZWcxPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLm92ZXJsYXBTZWcyPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLnRlbXBFbnYxPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUudGVtcEVudjI9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uLnByb3RvdHlwZS5vdmVybGFwU2VnMT1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24ucHJvdG90eXBlLm92ZXJsYXBTZWcyPW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcD1mdW5jdGlvbihtYzEsc3RhcnQxLG1jMixzdGFydDIpe3RoaXMubWMxLmdldExpbmVTZWdtZW50KHN0YXJ0MSx0aGlzLm92ZXJsYXBTZWcxKTt0aGlzLm1jMi5nZXRMaW5lU2VnbWVudChzdGFydDIsdGhpcy5vdmVybGFwU2VnMik7dGhpcy5vdmVybGFwMih0aGlzLm92ZXJsYXBTZWcxLHRoaXMub3ZlcmxhcFNlZzIpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcDI9ZnVuY3Rpb24oc2VnMSxzZWcyKXt9OyhmdW5jdGlvbigpe3ZhciBNb25vdG9uZUNoYWluT3ZlcmxhcEFjdGlvbj1qc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5PdmVybGFwQWN0aW9uO3ZhciBTaW5nbGVQYXNzTm9kZXI9anN0cy5ub2RpbmcuU2luZ2xlUGFzc05vZGVyO3ZhciBTVFJ0cmVlPWpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlO3ZhciBOb2RlZFNlZ21lbnRTdHJpbmc9anN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nO3ZhciBNb25vdG9uZUNoYWluQnVpbGRlcj1qc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5CdWlsZGVyO3ZhciBTZWdtZW50T3ZlcmxhcEFjdGlvbj1mdW5jdGlvbihzaSl7dGhpcy5zaT1zaTt9O1NlZ21lbnRPdmVybGFwQWN0aW9uLnByb3RvdHlwZT1uZXcgTW9ub3RvbmVDaGFpbk92ZXJsYXBBY3Rpb24oKTtTZWdtZW50T3ZlcmxhcEFjdGlvbi5jb25zdHJ1Y3Rvcj1TZWdtZW50T3ZlcmxhcEFjdGlvbjtTZWdtZW50T3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUuc2k9bnVsbDtTZWdtZW50T3ZlcmxhcEFjdGlvbi5wcm90b3R5cGUub3ZlcmxhcD1mdW5jdGlvbihtYzEsc3RhcnQxLG1jMixzdGFydDIpe3ZhciBzczE9bWMxLmdldENvbnRleHQoKTt2YXIgc3MyPW1jMi5nZXRDb250ZXh0KCk7dGhpcy5zaS5wcm9jZXNzSW50ZXJzZWN0aW9ucyhzczEsc3RhcnQxLHNzMixzdGFydDIpO307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyPWZ1bmN0aW9uKCl7dGhpcy5tb25vQ2hhaW5zPVtdO3RoaXMuaW5kZXg9bmV3IFNUUnRyZWUoKTt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGU9bmV3IFNpbmdsZVBhc3NOb2RlcigpO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXI7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5tb25vQ2hhaW5zPW51bGw7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5pbmRleD1udWxsO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuaWRDb3VudGVyPTA7anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5ub2RlZFNlZ1N0cmluZ3M9bnVsbDtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLm5PdmVybGFwcz0wO2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuZ2V0TW9ub3RvbmVDaGFpbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb25vQ2hhaW5zO307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5nZXRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmluZGV4O307anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oKXtyZXR1cm4gTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5ncyh0aGlzLm5vZGVkU2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIucHJvdG90eXBlLmNvbXB1dGVOb2Rlcz1mdW5jdGlvbihpbnB1dFNlZ1N0cmluZ3Mpe3RoaXMubm9kZWRTZWdTdHJpbmdzPWlucHV0U2VnU3RyaW5ncztmb3IodmFyIGk9aW5wdXRTZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt0aGlzLmFkZChpLm5leHQoKSk7fVxudGhpcy5pbnRlcnNlY3RDaGFpbnMoKTt9O2pzdHMubm9kaW5nLk1DSW5kZXhOb2Rlci5wcm90b3R5cGUuaW50ZXJzZWN0Q2hhaW5zPWZ1bmN0aW9uKCl7dmFyIG92ZXJsYXBBY3Rpb249bmV3IFNlZ21lbnRPdmVybGFwQWN0aW9uKHRoaXMuc2VnSW50KTtmb3IodmFyIGk9MDtpPHRoaXMubW9ub0NoYWlucy5sZW5ndGg7aSsrKXt2YXIgcXVlcnlDaGFpbj10aGlzLm1vbm9DaGFpbnNbaV07dmFyIG92ZXJsYXBDaGFpbnM9dGhpcy5pbmRleC5xdWVyeShxdWVyeUNoYWluLmdldEVudmVsb3BlKCkpO2Zvcih2YXIgaj0wO2o8b3ZlcmxhcENoYWlucy5sZW5ndGg7aisrKXt2YXIgdGVzdENoYWluPW92ZXJsYXBDaGFpbnNbal07aWYodGVzdENoYWluLmdldElkKCk+cXVlcnlDaGFpbi5nZXRJZCgpKXtxdWVyeUNoYWluLmNvbXB1dGVPdmVybGFwcyh0ZXN0Q2hhaW4sb3ZlcmxhcEFjdGlvbik7dGhpcy5uT3ZlcmxhcHMrKzt9XG5pZih0aGlzLnNlZ0ludC5pc0RvbmUoKSlcbnJldHVybjt9fX07anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oc2VnU3RyKXt2YXIgc2VnQ2hhaW5zPU1vbm90b25lQ2hhaW5CdWlsZGVyLmdldENoYWlucyhzZWdTdHIuZ2V0Q29vcmRpbmF0ZXMoKSxzZWdTdHIpO2Zvcih2YXIgaT0wO2k8c2VnQ2hhaW5zLmxlbmd0aDtpKyspe3ZhciBtYz1zZWdDaGFpbnNbaV07bWMuc2V0SWQodGhpcy5pZENvdW50ZXIrKyk7dGhpcy5pbmRleC5pbnNlcnQobWMuZ2V0RW52ZWxvcGUoKSxtYyk7dGhpcy5tb25vQ2hhaW5zLnB1c2gobWMpO319O30pKCk7anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4PWZ1bmN0aW9uKCl7dGhpcy5pbmRleD1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZSgpO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5pbmRleD1udWxsO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGxpbmUpe2lmKGxpbmUgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVNlZ21lbnQpe3RoaXMuYWRkMihsaW5lKTtyZXR1cm47fVxudmFyIHNlZ3M9bGluZS5nZXRTZWdtZW50cygpO2Zvcih2YXIgaT0wO2k8c2Vncy5sZW5ndGg7aSsrKXt2YXIgc2VnPXNlZ3NbaV07dGhpcy5hZGQyKHNlZyk7fX07anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKHNlZyl7dGhpcy5pbmRleC5pbnNlcnQobmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShzZWcucDAsc2VnLnAxKSxzZWcpO307anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oc2VnKXt0aGlzLmluZGV4LnJlbW92ZShuZXcganN0cy5nZW9tLkVudmVsb3BlKHNlZy5wMCxzZWcucDEpLHNlZyk7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXgucHJvdG90eXBlLnF1ZXJ5PWZ1bmN0aW9uKHF1ZXJ5U2VnKXt2YXIgZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUocXVlcnlTZWcucDAscXVlcnlTZWcucDEpO3ZhciB2aXNpdG9yPW5ldyBqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yKHF1ZXJ5U2VnKTt0aGlzLmluZGV4LnF1ZXJ5KGVudix2aXNpdG9yKTt2YXIgaXRlbXNGb3VuZD12aXNpdG9yLmdldEl0ZW1zKCk7cmV0dXJuIGl0ZW1zRm91bmQ7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yPWZ1bmN0aW9uKHF1ZXJ5U2VnKXt0aGlzLml0ZW1zPVtdO3RoaXMucXVlcnlTZWc9cXVlcnlTZWc7fTtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5JdGVtVmlzaXRvcigpO2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5MaW5lU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLnF1ZXJ5U2VnPW51bGw7anN0cy5zaW1wbGlmeS5MaW5lU2VnbWVudEluZGV4LkxpbmVTZWdtZW50VmlzaXRvci5wcm90b3R5cGUuaXRlbXM9bnVsbDtqc3RzLnNpbXBsaWZ5LkxpbmVTZWdtZW50SW5kZXguTGluZVNlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS52aXNpdEl0ZW09ZnVuY3Rpb24oaXRlbSl7dmFyIHNlZz1pdGVtO2lmKGpzdHMuZ2VvbS5FbnZlbG9wZS5pbnRlcnNlY3RzKHNlZy5wMCxzZWcucDEsdGhpcy5xdWVyeVNlZy5wMCx0aGlzLnF1ZXJ5U2VnLnAxKSlcbnRoaXMuaXRlbXMucHVzaChpdGVtKTt9O2pzdHMuc2ltcGxpZnkuTGluZVNlZ21lbnRJbmRleC5MaW5lU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLmdldEl0ZW1zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlbXM7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhcj1mdW5jdGlvbigpe3RoaXMuZWRnZU1hcD1uZXcgamF2YXNjcmlwdC51dGlsLlRyZWVNYXAoKTt0aGlzLmVkZ2VMaXN0PW51bGw7dGhpcy5wdEluQXJlYUxvY2F0aW9uPVtqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORV07fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZWRnZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5lZGdlTGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5wdEluQXJlYUxvY2F0aW9uPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihlKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmluc2VydEVkZ2VFbmQ9ZnVuY3Rpb24oZSxvYmope3RoaXMuZWRnZU1hcC5wdXQoZSxvYmopO3RoaXMuZWRnZUxpc3Q9bnVsbDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpZighaXQuaGFzTmV4dCgpKVxucmV0dXJuIG51bGw7dmFyIGU9aXQubmV4dCgpO3JldHVybiBlLmdldENvb3JkaW5hdGUoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXREZWdyZWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlTWFwLnNpemUoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEVkZ2VzKCkuaXRlcmF0b3IoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe2lmKHRoaXMuZWRnZUxpc3Q9PT1udWxsKXt0aGlzLmVkZ2VMaXN0PW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KHRoaXMuZWRnZU1hcC52YWx1ZXMoKSk7fVxucmV0dXJuIHRoaXMuZWRnZUxpc3Q7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuZ2V0TmV4dENXPWZ1bmN0aW9uKGVlKXt0aGlzLmdldEVkZ2VzKCk7dmFyIGk9dGhpcy5lZGdlTGlzdC5pbmRleE9mKGVlKTt2YXIgaU5leHRDVz1pLTE7aWYoaT09PTApXG5pTmV4dENXPXRoaXMuZWRnZUxpc3QubGVuZ3RoLTE7cmV0dXJuIHRoaXMuZWRnZUxpc3RbaU5leHRDV107fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZz1mdW5jdGlvbihnZW9tR3JhcGgpe3RoaXMuY29tcHV0ZUVkZ2VFbmRMYWJlbHMoZ2VvbUdyYXBoWzBdLmdldEJvdW5kYXJ5Tm9kZVJ1bGUoKSk7dGhpcy5wcm9wYWdhdGVTaWRlTGFiZWxzKDApO3RoaXMucHJvcGFnYXRlU2lkZUxhYmVscygxKTt2YXIgaGFzRGltZW5zaW9uYWxDb2xsYXBzZUVkZ2U9W2ZhbHNlLGZhbHNlXTtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWUuZ2V0TGFiZWwoKTtmb3IodmFyIGdlb21pPTA7Z2VvbWk8MjtnZW9taSsrKXtpZihsYWJlbC5pc0xpbmUoZ2VvbWkpJiZsYWJlbC5nZXRMb2NhdGlvbihnZW9taSk9PT1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlkpXG5oYXNEaW1lbnNpb25hbENvbGxhcHNlRWRnZVtnZW9taV09dHJ1ZTt9fVxuZm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO3ZhciBsYWJlbD1lLmdldExhYmVsKCk7Zm9yKHZhciBnZW9taT0wO2dlb21pPDI7Z2VvbWkrKyl7aWYobGFiZWwuaXNBbnlOdWxsKGdlb21pKSl7dmFyIGxvYz1qc3RzLmdlb20uTG9jYXRpb24uTk9ORTtpZihoYXNEaW1lbnNpb25hbENvbGxhcHNlRWRnZVtnZW9taV0pe2xvYz1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fWVsc2V7dmFyIHA9ZS5nZXRDb29yZGluYXRlKCk7bG9jPXRoaXMuZ2V0TG9jYXRpb24oZ2VvbWkscCxnZW9tR3JhcGgpO31cbmxhYmVsLnNldEFsbExvY2F0aW9uc0lmTnVsbChnZW9taSxsb2MpO319fX07anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIucHJvdG90eXBlLmNvbXB1dGVFZGdlRW5kTGFiZWxzPWZ1bmN0aW9uKGJvdW5kYXJ5Tm9kZVJ1bGUpe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlZT1pdC5uZXh0KCk7ZWUuY29tcHV0ZUxhYmVsKGJvdW5kYXJ5Tm9kZVJ1bGUpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5nZXRMb2NhdGlvbj1mdW5jdGlvbihnZW9tSW5kZXgscCxnZW9tKXtpZih0aGlzLnB0SW5BcmVhTG9jYXRpb25bZ2VvbUluZGV4XT09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKXt0aGlzLnB0SW5BcmVhTG9jYXRpb25bZ2VvbUluZGV4XT1qc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmxvY2F0ZShwLGdlb21bZ2VvbUluZGV4XS5nZXRHZW9tZXRyeSgpKTt9XG5yZXR1cm4gdGhpcy5wdEluQXJlYUxvY2F0aW9uW2dlb21JbmRleF07fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhci5wcm90b3R5cGUuaXNBcmVhTGFiZWxzQ29uc2lzdGVudD1mdW5jdGlvbihnZW9tR3JhcGgpe3RoaXMuY29tcHV0ZUVkZ2VFbmRMYWJlbHMoZ2VvbUdyYXBoLmdldEJvdW5kYXJ5Tm9kZVJ1bGUoKSk7cmV0dXJuIHRoaXMuY2hlY2tBcmVhTGFiZWxzQ29uc2lzdGVudCgwKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5jaGVja0FyZWFMYWJlbHNDb25zaXN0ZW50PWZ1bmN0aW9uKGdlb21JbmRleCl7dmFyIGVkZ2VzPXRoaXMuZ2V0RWRnZXMoKTtpZihlZGdlcy5zaXplKCk8PTApXG5yZXR1cm4gdHJ1ZTt2YXIgbGFzdEVkZ2VJbmRleD1lZGdlcy5zaXplKCktMTt2YXIgc3RhcnRMYWJlbD1lZGdlcy5nZXQobGFzdEVkZ2VJbmRleCkuZ2V0TGFiZWwoKTt2YXIgc3RhcnRMb2M9c3RhcnRMYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7anN0cy51dGlsLkFzc2VydC5pc1RydWUoc3RhcnRMb2MhPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FLCdGb3VuZCB1bmxhYmVsbGVkIGFyZWEgZWRnZScpO3ZhciBjdXJyTG9jPXN0YXJ0TG9jO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKGxhYmVsLmlzQXJlYShnZW9tSW5kZXgpLCdGb3VuZCBub24tYXJlYSBlZGdlJyk7dmFyIGxlZnRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3ZhciByaWdodExvYz1sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKGxlZnRMb2M9PT1yaWdodExvYyl7cmV0dXJuIGZhbHNlO31cbmlmKHJpZ2h0TG9jIT09Y3VyckxvYyl7cmV0dXJuIGZhbHNlO31cbmN1cnJMb2M9bGVmdExvYzt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5wcm9wYWdhdGVTaWRlTGFiZWxzPWZ1bmN0aW9uKGdlb21JbmRleCl7dmFyIHN0YXJ0TG9jPWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2lmKGxhYmVsLmlzQXJlYShnZW9tSW5kZXgpJiZsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCkhPT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbnN0YXJ0TG9jPWxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTt9XG5pZihzdGFydExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5OT05FKVxucmV0dXJuO3ZhciBjdXJyTG9jPXN0YXJ0TG9jO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2lmKGxhYmVsLmdldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTik9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSlcbmxhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTixjdXJyTG9jKTtpZihsYWJlbC5pc0FyZWEoZ2VvbUluZGV4KSl7dmFyIGxlZnRMb2M9bGFiZWwuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3ZhciByaWdodExvYz1sYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO2lmKHJpZ2h0TG9jIT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpe2lmKHJpZ2h0TG9jIT09Y3VyckxvYylcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ3NpZGUgbG9jYXRpb24gY29uZmxpY3QnLGUuZ2V0Q29vcmRpbmF0ZSgpKTtpZihsZWZ0TG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpe2pzdHMudXRpbC5Bc3NlcnQuc2hvdWxkTmV2ZXJSZWFjaEhlcmUoJ2ZvdW5kIHNpbmdsZSBudWxsIHNpZGUgKGF0ICcrXG5lLmdldENvb3JkaW5hdGUoKSsnKScpO31cbmN1cnJMb2M9bGVmdExvYzt9ZWxzZXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk9PT1qc3RzLmdlb20uTG9jYXRpb24uTk9ORSwnZm91bmQgc2luZ2xlIG51bGwgc2lkZScpO2xhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCxjdXJyTG9jKTtsYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCxjdXJyTG9jKTt9fX19O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLnByb3RvdHlwZS5maW5kSW5kZXg9ZnVuY3Rpb24oZVNlYXJjaCl7dGhpcy5pdGVyYXRvcigpO2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlTGlzdC5zaXplKCk7aSsrKXt2YXIgZT10aGlzLmVkZ2VMaXN0LmdldChpKTtpZihlPT09ZVNlYXJjaClcbnJldHVybiBpO31cbnJldHVybi0xO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyPWZ1bmN0aW9uKCl7anN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIuYXBwbHkodGhpcyxhcmd1bWVudHMpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZFN0YXIoKTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZVN0YXIucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihlKXt2YXIgZWI9dGhpcy5lZGdlTWFwLmdldChlKTtpZihlYj09PW51bGwpe2ViPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZShlKTt0aGlzLmluc2VydEVkZ2VFbmQoZSxlYik7fVxuZWxzZXtlYi5pbnNlcnQoZSk7fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGVTdGFyLnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGVzYj1pdC5uZXh0KCk7ZXNiLnVwZGF0ZUlNKGltKTt9fTtqc3RzLmluZGV4LkFycmF5TGlzdFZpc2l0b3I9ZnVuY3Rpb24oKXt0aGlzLml0ZW1zPVtdO307anN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yLnByb3RvdHlwZS52aXNpdEl0ZW09ZnVuY3Rpb24oaXRlbSl7dGhpcy5pdGVtcy5wdXNoKGl0ZW0pO307anN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50PWZ1bmN0aW9uKCl7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlPWZ1bmN0aW9uKGdlb20scHQscHREaXN0KXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UyKGdlb20scHQscHREaXN0KTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2U0KGdlb20scHQscHREaXN0KTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7dmFyIGdjPWdlb207Zm9yKHZhciBpPTA7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgZz1nYy5nZXRHZW9tZXRyeU4oaSk7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZShnLHB0LHB0RGlzdCk7fX1lbHNle3B0RGlzdC5zZXRNaW5pbXVtKGdlb20uZ2V0Q29vcmRpbmF0ZSgpLHB0KTt9fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlMj1mdW5jdGlvbihsaW5lLHB0LHB0RGlzdCl7dmFyIHRlbXBTZWdtZW50PW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt2YXIgY29vcmRzPWxpbmUuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGk9MDtpPGNvb3Jkcy5sZW5ndGgtMTtpKyspe3RlbXBTZWdtZW50LnNldENvb3JkaW5hdGVzKGNvb3Jkc1tpXSxjb29yZHNbaSsxXSk7dmFyIGNsb3Nlc3RQdD10ZW1wU2VnbWVudC5jbG9zZXN0UG9pbnQocHQpO3B0RGlzdC5zZXRNaW5pbXVtKGNsb3Nlc3RQdCxwdCk7fX07anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTM9ZnVuY3Rpb24oc2VnbWVudCxwdCxwdERpc3Qpe3ZhciBjbG9zZXN0UHQ9c2VnbWVudC5jbG9zZXN0UG9pbnQocHQpO3B0RGlzdC5zZXRNaW5pbXVtKGNsb3Nlc3RQdCxwdCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlND1mdW5jdGlvbihwb2x5LHB0LHB0RGlzdCl7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZTIocG9seS5nZXRFeHRlcmlvclJpbmcoKSxwdCxwdERpc3QpO2Zvcih2YXIgaT0wO2k8cG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc3RhbmNlVG9Qb2ludC5jb21wdXRlRGlzdGFuY2UyKHBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKSxwdCxwdERpc3QpO319O2pzdHMuaW5kZXguc3RydHJlZS5JdGVtQm91bmRhYmxlPWZ1bmN0aW9uKGJvdW5kcyxpdGVtKXt0aGlzLmJvdW5kcz1ib3VuZHM7dGhpcy5pdGVtPWl0ZW07fTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5wcm90b3R5cGU9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5Cb3VuZGFibGUoKTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5jb25zdHJ1Y3Rvcj1qc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZTtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5wcm90b3R5cGUuYm91bmRzPW51bGw7anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLml0ZW09bnVsbDtqc3RzLmluZGV4LnN0cnRyZWUuSXRlbUJvdW5kYWJsZS5wcm90b3R5cGUuZ2V0Qm91bmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYm91bmRzO307anN0cy5pbmRleC5zdHJ0cmVlLkl0ZW1Cb3VuZGFibGUucHJvdG90eXBlLmdldEl0ZW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pdGVtO307KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBUcmVlTWFwPWphdmFzY3JpcHQudXRpbC5UcmVlTWFwO2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0PWZ1bmN0aW9uKCl7dGhpcy5lZGdlcz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5vY2FNYXA9bmV3IFRyZWVNYXAoKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5lZGdlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5vY2FNYXA9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGUpe3RoaXMuZWRnZXMuYWRkKGUpO3ZhciBvY2E9bmV3IGpzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5KGUuZ2V0Q29vcmRpbmF0ZXMoKSk7dGhpcy5vY2FNYXAucHV0KG9jYSxlKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5hZGRBbGw9ZnVuY3Rpb24oZWRnZUNvbGwpe2Zvcih2YXIgaT1lZGdlQ29sbC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dGhpcy5hZGQoaS5uZXh0KCkpO319O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5nZXRFZGdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzO307anN0cy5nZW9tZ3JhcGguRWRnZUxpc3QucHJvdG90eXBlLmZpbmRFcXVhbEVkZ2U9ZnVuY3Rpb24oZSl7dmFyIG9jYT1uZXcganN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkoZS5nZXRDb29yZGluYXRlcygpKTt2YXIgbWF0Y2hFZGdlPXRoaXMub2NhTWFwLmdldChvY2EpO3JldHVybiBtYXRjaEVkZ2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlczt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2VzLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTGlzdC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLmVkZ2VzLmdldChpKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0LnByb3RvdHlwZS5maW5kRWRnZUluZGV4PWZ1bmN0aW9uKGUpe2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlcy5zaXplKCk7aSsrKXtpZih0aGlzLmVkZ2VzLmdldChpKS5lcXVhbHMoZSkpXG5yZXR1cm4gaTt9XG5yZXR1cm4tMTt9O30pKCk7anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcD1mdW5jdGlvbihnZW9tKXt0aGlzLmdlb209Z2VvbTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc0Nsb3NlZEVuZHBvaW50c0luSW50ZXJpb3I9dHJ1ZTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5ub25TaW1wbGVMb2NhdGlvbj1udWxsO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLklzU2ltcGxlT3A9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5nZW9tPWdlb207fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc1NpbXBsZT1mdW5jdGlvbigpe3RoaXMubm9uU2ltcGxlTG9jYXRpb249bnVsbDtpZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7cmV0dXJuIHRoaXMuaXNTaW1wbGVMaW5lYXJHZW9tZXRyeSh0aGlzLmdlb20pO31cbmlmKHRoaXMuZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpe3JldHVybiB0aGlzLmlzU2ltcGxlTGluZWFyR2VvbWV0cnkodGhpcy5nZW9tKTt9XG5pZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludCl7cmV0dXJuIHRoaXMuaXNTaW1wbGVNdWx0aVBvaW50KHRoaXMuZ2VvbSk7fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5pc1NpbXBsZU11bHRpUG9pbnQ9ZnVuY3Rpb24obXApe2lmKG1wLmlzRW1wdHkoKSlcbnJldHVybiB0cnVlO3ZhciBwb2ludHM9W107Zm9yKHZhciBpPTA7aTxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcHQ9bXAuZ2V0R2VvbWV0cnlOKGkpO3ZhciBwPXB0LmdldENvb3JkaW5hdGUoKTtmb3IodmFyIGo9MDtqPHBvaW50cy5sZW5ndGg7aisrKXt2YXIgcG9pbnQ9cG9pbnRzW2pdO2lmKHAuZXF1YWxzMkQocG9pbnQpKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPXA7cmV0dXJuIGZhbHNlO319XG5wb2ludHMucHVzaChwKTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmlzU2ltcGxlTGluZWFyR2VvbWV0cnk9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbS5pc0VtcHR5KCkpXG5yZXR1cm4gdHJ1ZTt2YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnZW9tKTt2YXIgbGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3ZhciBzaT1ncmFwaC5jb21wdXRlU2VsZk5vZGVzKGxpLHRydWUpO2lmKCFzaS5oYXNJbnRlcnNlY3Rpb24oKSlcbnJldHVybiB0cnVlO2lmKHNpLmhhc1Byb3BlckludGVyc2VjdGlvbigpKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPXNpLmdldFByb3BlckludGVyc2VjdGlvblBvaW50KCk7cmV0dXJuIGZhbHNlO31cbmlmKHRoaXMuaGFzTm9uRW5kcG9pbnRJbnRlcnNlY3Rpb24oZ3JhcGgpKVxucmV0dXJuIGZhbHNlO2lmKHRoaXMuaXNDbG9zZWRFbmRwb2ludHNJbkludGVyaW9yKXtpZih0aGlzLmhhc0Nsb3NlZEVuZHBvaW50SW50ZXJzZWN0aW9uKGdyYXBoKSlcbnJldHVybiBmYWxzZTt9XG5yZXR1cm4gdHJ1ZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmhhc05vbkVuZHBvaW50SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGdyYXBoKXtmb3IodmFyIGk9Z3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgbWF4U2VnbWVudEluZGV4PWUuZ2V0TWF4aW11bVNlZ21lbnRJbmRleCgpO2Zvcih2YXIgZWlJdD1lLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCkuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTtpZighZWkuaXNFbmRQb2ludChtYXhTZWdtZW50SW5kZXgpKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPWVpLmdldENvb3JkaW5hdGUoKTtyZXR1cm4gdHJ1ZTt9fX1cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AucHJvdG90eXBlLmhhc0Nsb3NlZEVuZHBvaW50SW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGdyYXBoKXt2YXIgZW5kUG9pbnRzPW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcCgpO2Zvcih2YXIgaT1ncmFwaC5nZXRFZGdlSXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3ZhciBtYXhTZWdtZW50SW5kZXg9ZS5nZXRNYXhpbXVtU2VnbWVudEluZGV4KCk7dmFyIGlzQ2xvc2VkPWUuaXNDbG9zZWQoKTt2YXIgcDA9ZS5nZXRDb29yZGluYXRlKDApO3RoaXMuYWRkRW5kcG9pbnQoZW5kUG9pbnRzLHAwLGlzQ2xvc2VkKTt2YXIgcDE9ZS5nZXRDb29yZGluYXRlKGUuZ2V0TnVtUG9pbnRzKCktMSk7dGhpcy5hZGRFbmRwb2ludChlbmRQb2ludHMscDEsaXNDbG9zZWQpO31cbmZvcih2YXIgaT1lbmRQb2ludHMudmFsdWVzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlaUluZm89aS5uZXh0KCk7aWYoZWlJbmZvLmlzQ2xvc2VkJiZlaUluZm8uZGVncmVlIT0yKXt0aGlzLm5vblNpbXBsZUxvY2F0aW9uPWVpSW5mby5nZXRDb29yZGluYXRlKCk7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvPWZ1bmN0aW9uKHB0KXt0aGlzLnB0PXB0O3RoaXMuaXNDbG9zZWQ9ZmFsc2U7dGhpcy5kZWdyZWU9MDt9O2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5wdD1udWxsO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5pc0Nsb3NlZD1udWxsO2pzdHMub3BlcmF0aW9uLklzU2ltcGxlT3AuRW5kcG9pbnRJbmZvLnByb3RvdHlwZS5kZWdyZWU9bnVsbDtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLkVuZHBvaW50SW5mby5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5FbmRwb2ludEluZm8ucHJvdG90eXBlLmFkZEVuZHBvaW50PWZ1bmN0aW9uKGlzQ2xvc2VkKXt0aGlzLmRlZ3JlZSsrO3RoaXMuaXNDbG9zZWQ9dGhpcy5pc0Nsb3NlZHx8aXNDbG9zZWQ7fTtqc3RzLm9wZXJhdGlvbi5Jc1NpbXBsZU9wLnByb3RvdHlwZS5hZGRFbmRwb2ludD1mdW5jdGlvbihlbmRQb2ludHMscCxpc0Nsb3NlZCl7dmFyIGVpSW5mbz1lbmRQb2ludHMuZ2V0KHApO2lmKGVpSW5mbz09PW51bGwpe2VpSW5mbz1uZXcganN0cy5vcGVyYXRpb24uSXNTaW1wbGVPcC5FbmRwb2ludEluZm8ocCk7ZW5kUG9pbnRzLnB1dChwLGVpSW5mbyk7fVxuZWlJbmZvLmFkZEVuZHBvaW50KGlzQ2xvc2VkKTt9OyhmdW5jdGlvbigpe3ZhciBMaW5lU3RyaW5nU25hcHBlcj1mdW5jdGlvbigpe3RoaXMuc25hcFRvbGVyYW5jZT0wLjA7dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuYWxsb3dTbmFwcGluZ1RvU291cmNlVmVydGljZXM9ZmFsc2U7dGhpcy5pc0Nsb3NlZD1mYWxzZTt0aGlzLnNyY1B0cz1bXTtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmluaXRGcm9tTGluZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2V7dGhpcy5pbml0RnJvbVBvaW50cy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX07TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmluaXRGcm9tTGluZT1mdW5jdGlvbihzcmNMaW5lLHNuYXBUb2xlcmFuY2Upe3RoaXMuaW5pdEZyb21Qb2ludHMoc3JjTGluZS5nZXRDb29yZGluYXRlcygpLHNuYXBUb2xlcmFuY2UpO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmluaXRGcm9tUG9pbnRzPWZ1bmN0aW9uKHNyY1B0cyxzbmFwVG9sZXJhbmNlKXt0aGlzLnNyY1B0cz1zcmNQdHM7dGhpcy5pc0Nsb3NlZD10aGlzLmNhbGNJc0Nsb3NlZChzcmNQdHMpO3RoaXMuc25hcFRvbGVyYW5jZT1zbmFwVG9sZXJhbmNlO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLnNldEFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzPWZ1bmN0aW9uKGFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzKXt0aGlzLmFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzPWFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzO307TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmNhbGNJc0Nsb3NlZD1mdW5jdGlvbihwdHMpe2lmKHB0cy5sZW5ndGg8PTEpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gcHRzWzBdLmVxdWFscyhwdHNbcHRzLmxlbmd0aC0xXSk7fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuc25hcFRvPWZ1bmN0aW9uKHNuYXBQdHMpe3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdCh0aGlzLnNyY1B0cyk7dGhpcy5zbmFwVmVydGljZXMoY29vcmRMaXN0LHNuYXBQdHMpO3RoaXMuc25hcFNlZ21lbnRzKGNvb3JkTGlzdCxzbmFwUHRzKTtyZXR1cm4gY29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuc25hcFZlcnRpY2VzPWZ1bmN0aW9uKHNyY0Nvb3JkcyxzbmFwUHRzKXt2YXIgZW5kPXRoaXMuaXNDbG9zZWQ/c3JjQ29vcmRzLnNpemUoKS0xOnNyY0Nvb3Jkcy5zaXplKCksaT0wLHNyY1B0LHNuYXBWZXJ0O2ZvcihpO2k8ZW5kO2krKyl7c3JjUHQ9c3JjQ29vcmRzLmdldChpKTtzbmFwVmVydD10aGlzLmZpbmRTbmFwRm9yVmVydGV4KHNyY1B0LHNuYXBQdHMpO2lmKHNuYXBWZXJ0IT09bnVsbCl7c3JjQ29vcmRzLnNldChpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzbmFwVmVydCkpO2lmKGk9PT0wJiZ0aGlzLmlzQ2xvc2VkKVxuc3JjQ29vcmRzLnNldChzcmNDb29yZHMuc2l6ZSgpLTEsbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHNuYXBWZXJ0KSk7fX19O0xpbmVTdHJpbmdTbmFwcGVyLnByb3RvdHlwZS5maW5kU25hcEZvclZlcnRleD1mdW5jdGlvbihwdCxzbmFwUHRzKXt2YXIgaT0wLGlsPXNuYXBQdHMubGVuZ3RoO2ZvcihpPTA7aTxpbDtpKyspe2lmKHB0LmVxdWFscyhzbmFwUHRzW2ldKSl7cmV0dXJuIG51bGw7fVxuaWYocHQuZGlzdGFuY2Uoc25hcFB0c1tpXSk8dGhpcy5zbmFwVG9sZXJhbmNlKXtyZXR1cm4gc25hcFB0c1tpXTt9fVxucmV0dXJuIG51bGw7fTtMaW5lU3RyaW5nU25hcHBlci5wcm90b3R5cGUuc25hcFNlZ21lbnRzPWZ1bmN0aW9uKHNyY0Nvb3JkcyxzbmFwUHRzKXtpZihzbmFwUHRzLmxlbmd0aD09PTApe3JldHVybjt9XG52YXIgZGlzdGluY3RQdENvdW50PXNuYXBQdHMubGVuZ3RoLGksc25hcFB0LGluZGV4O2lmKHNuYXBQdHMubGVuZ3RoPjEmJnNuYXBQdHNbMF0uZXF1YWxzMkQoc25hcFB0c1tzbmFwUHRzLmxlbmd0aC0xXSkpe2Rpc3RpbmN0UHRDb3VudD1zbmFwUHRzLmxlbmd0aC0xO31cbmk9MDtmb3IoaTtpPGRpc3RpbmN0UHRDb3VudDtpKyspe3NuYXBQdD1zbmFwUHRzW2ldO2luZGV4PXRoaXMuZmluZFNlZ21lbnRJbmRleFRvU25hcChzbmFwUHQsc3JjQ29vcmRzKTtpZihpbmRleD49MCl7c3JjQ29vcmRzLmFkZChpbmRleCsxLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzbmFwUHQpLGZhbHNlKTt9fX07TGluZVN0cmluZ1NuYXBwZXIucHJvdG90eXBlLmZpbmRTZWdtZW50SW5kZXhUb1NuYXA9ZnVuY3Rpb24oc25hcFB0LHNyY0Nvb3Jkcyl7dmFyIG1pbkRpc3Q9TnVtYmVyLk1BWF9WQUxVRSxzbmFwSW5kZXg9LTEsaT0wLGRpc3Q7Zm9yKGk7aTxzcmNDb29yZHMuc2l6ZSgpLTE7aSsrKXt0aGlzLnNlZy5wMD1zcmNDb29yZHMuZ2V0KGkpO3RoaXMuc2VnLnAxPXNyY0Nvb3Jkcy5nZXQoaSsxKTtpZih0aGlzLnNlZy5wMC5lcXVhbHMoc25hcFB0KXx8dGhpcy5zZWcucDEuZXF1YWxzKHNuYXBQdCkpe2lmKHRoaXMuYWxsb3dTbmFwcGluZ1RvU291cmNlVmVydGljZXMpe2NvbnRpbnVlO31lbHNle3JldHVybi0xO319XG5kaXN0PXRoaXMuc2VnLmRpc3RhbmNlKHNuYXBQdCk7aWYoZGlzdDx0aGlzLnNuYXBUb2xlcmFuY2UmJmRpc3Q8bWluRGlzdCl7bWluRGlzdD1kaXN0O3NuYXBJbmRleD1pO319XG5yZXR1cm4gc25hcEluZGV4O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLkxpbmVTdHJpbmdTbmFwcGVyPUxpbmVTdHJpbmdTbmFwcGVyO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBHZW9tZXRyeUNvbXBvbmVudEZpbHRlcj1qc3RzLmdlb20uR2VvbWV0cnlDb21wb25lbnRGaWx0ZXI7dmFyIExpbmVTdHJpbmc9anN0cy5nZW9tLkxpbmVTdHJpbmc7dmFyIEVkZ2VSaW5nPWpzdHMub3BlcmF0aW9uLnBvbHlnb25pemUuRWRnZVJpbmc7dmFyIFBvbHlnb25pemVHcmFwaD1qc3RzLm9wZXJhdGlvbi5wb2x5Z29uaXplLlBvbHlnb25pemVHcmFwaDt2YXIgUG9seWdvbml6ZXI9ZnVuY3Rpb24oKXt2YXIgdGhhdD10aGlzO3ZhciBMaW5lU3RyaW5nQWRkZXI9ZnVuY3Rpb24oKXt9O0xpbmVTdHJpbmdBZGRlci5wcm90b3R5cGU9bmV3IEdlb21ldHJ5Q29tcG9uZW50RmlsdGVyKCk7TGluZVN0cmluZ0FkZGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZyl7aWYoZyBpbnN0YW5jZW9mIExpbmVTdHJpbmcpXG50aGF0LmFkZChnKTt9O3RoaXMubGluZVN0cmluZ0FkZGVyPW5ldyBMaW5lU3RyaW5nQWRkZXIoKTt0aGlzLmRhbmdsZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuY3V0RWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuaW52YWxpZFJpbmdMaW5lcz1uZXcgQXJyYXlMaXN0KCk7fTtQb2x5Z29uaXplci5wcm90b3R5cGUubGluZVN0cmluZ0FkZGVyPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmdyYXBoPW51bGw7UG9seWdvbml6ZXIucHJvdG90eXBlLmRhbmdsZXM9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuY3V0RWRnZXM9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuaW52YWxpZFJpbmdMaW5lcz1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5ob2xlTGlzdD1udWxsO1BvbHlnb25pemVyLnByb3RvdHlwZS5zaGVsbExpc3Q9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUucG9seUxpc3Q9bnVsbDtQb2x5Z29uaXplci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb21MaXN0KXtpZihnZW9tTGlzdCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXtyZXR1cm4gdGhpcy5hZGQzKGdlb21MaXN0KTt9ZWxzZSBpZihnZW9tTGlzdCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeSl7cmV0dXJuIHRoaXMuYWRkMihnZW9tTGlzdCk7fVxuZm9yKHZhciBpPWdlb21MaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZ2VvbWV0cnk9aS5uZXh0KCk7dGhpcy5hZGQyKGdlb21ldHJ5KTt9fTtQb2x5Z29uaXplci5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihnKXtnLmFwcGx5KHRoaXMubGluZVN0cmluZ0FkZGVyKTt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5hZGQzPWZ1bmN0aW9uKGxpbmUpe2lmKHRoaXMuZ3JhcGg9PW51bGwpXG50aGlzLmdyYXBoPW5ldyBQb2x5Z29uaXplR3JhcGgobGluZS5nZXRGYWN0b3J5KCkpO3RoaXMuZ3JhcGguYWRkRWRnZShsaW5lKTt9O1BvbHlnb25pemVyLnByb3RvdHlwZS5nZXRQb2x5Z29ucz1mdW5jdGlvbigpe3RoaXMucG9seWdvbml6ZSgpO3JldHVybiB0aGlzLnBvbHlMaXN0O307UG9seWdvbml6ZXIucHJvdG90eXBlLmdldERhbmdsZXM9ZnVuY3Rpb24oKXt0aGlzLnBvbHlnb25pemUoKTtyZXR1cm4gdGhpcy5kYW5nbGVzO307UG9seWdvbml6ZXIucHJvdG90eXBlLmdldEN1dEVkZ2VzPWZ1bmN0aW9uKCl7dGhpcy5wb2x5Z29uaXplKCk7cmV0dXJuIHRoaXMuY3V0RWRnZXM7fTtQb2x5Z29uaXplci5wcm90b3R5cGUuZ2V0SW52YWxpZFJpbmdMaW5lcz1mdW5jdGlvbigpe3RoaXMucG9seWdvbml6ZSgpO3JldHVybiB0aGlzLmludmFsaWRSaW5nTGluZXM7fTtQb2x5Z29uaXplci5wcm90b3R5cGUucG9seWdvbml6ZT1mdW5jdGlvbigpe2lmKHRoaXMucG9seUxpc3QhPW51bGwpXG5yZXR1cm47dGhpcy5wb2x5TGlzdD1uZXcgQXJyYXlMaXN0KCk7aWYodGhpcy5ncmFwaD09bnVsbClcbnJldHVybjt0aGlzLmRhbmdsZXM9dGhpcy5ncmFwaC5kZWxldGVEYW5nbGVzKCk7dGhpcy5jdXRFZGdlcz10aGlzLmdyYXBoLmRlbGV0ZUN1dEVkZ2VzKCk7dmFyIGVkZ2VSaW5nTGlzdD10aGlzLmdyYXBoLmdldEVkZ2VSaW5ncygpO3ZhciB2YWxpZEVkZ2VSaW5nTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5pbnZhbGlkUmluZ0xpbmVzPW5ldyBBcnJheUxpc3QoKTt0aGlzLmZpbmRWYWxpZFJpbmdzKGVkZ2VSaW5nTGlzdCx2YWxpZEVkZ2VSaW5nTGlzdCx0aGlzLmludmFsaWRSaW5nTGluZXMpO3RoaXMuZmluZFNoZWxsc0FuZEhvbGVzKHZhbGlkRWRnZVJpbmdMaXN0KTtQb2x5Z29uaXplci5hc3NpZ25Ib2xlc1RvU2hlbGxzKHRoaXMuaG9sZUxpc3QsdGhpcy5zaGVsbExpc3QpO3RoaXMucG9seUxpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT10aGlzLnNoZWxsTGlzdC5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGVyPWkubmV4dCgpO3RoaXMucG9seUxpc3QuYWRkKGVyLmdldFBvbHlnb24oKSk7fX07UG9seWdvbml6ZXIucHJvdG90eXBlLmZpbmRWYWxpZFJpbmdzPWZ1bmN0aW9uKGVkZ2VSaW5nTGlzdCx2YWxpZEVkZ2VSaW5nTGlzdCxpbnZhbGlkUmluZ0xpc3Qpe2Zvcih2YXIgaT1lZGdlUmluZ0xpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlcj1pLm5leHQoKTtpZihlci5pc1ZhbGlkKCkpXG52YWxpZEVkZ2VSaW5nTGlzdC5hZGQoZXIpO2Vsc2VcbmludmFsaWRSaW5nTGlzdC5hZGQoZXIuZ2V0TGluZVN0cmluZygpKTt9fTtQb2x5Z29uaXplci5wcm90b3R5cGUuZmluZFNoZWxsc0FuZEhvbGVzPWZ1bmN0aW9uKGVkZ2VSaW5nTGlzdCl7dGhpcy5ob2xlTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5zaGVsbExpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT1lZGdlUmluZ0xpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlcj1pLm5leHQoKTtpZihlci5pc0hvbGUoKSlcbnRoaXMuaG9sZUxpc3QuYWRkKGVyKTtlbHNlXG50aGlzLnNoZWxsTGlzdC5hZGQoZXIpO319O1BvbHlnb25pemVyLmFzc2lnbkhvbGVzVG9TaGVsbHM9ZnVuY3Rpb24oaG9sZUxpc3Qsc2hlbGxMaXN0KXtmb3IodmFyIGk9aG9sZUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBob2xlRVI9aS5uZXh0KCk7UG9seWdvbml6ZXIuYXNzaWduSG9sZVRvU2hlbGwoaG9sZUVSLHNoZWxsTGlzdCk7fX07UG9seWdvbml6ZXIuYXNzaWduSG9sZVRvU2hlbGw9ZnVuY3Rpb24oaG9sZUVSLHNoZWxsTGlzdCl7dmFyIHNoZWxsPUVkZ2VSaW5nLmZpbmRFZGdlUmluZ0NvbnRhaW5pbmcoaG9sZUVSLHNoZWxsTGlzdCk7aWYoc2hlbGwhPW51bGwpXG5zaGVsbC5hZGRIb2xlKGhvbGVFUi5nZXRSaW5nKCkpO307anN0cy5vcGVyYXRpb24ucG9seWdvbml6ZS5Qb2x5Z29uaXplcj1Qb2x5Z29uaXplcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgR2VvbWV0cnlUcmFuc2Zvcm1lcj1mdW5jdGlvbigpe307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuaW5wdXRHZW9tPW51bGw7R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuZmFjdG9yeT1udWxsO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnBydW5lRW1wdHlHZW9tZXRyeT10cnVlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnByZXNlcnZlR2VvbWV0cnlDb2xsZWN0aW9uVHlwZT10cnVlO0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnByZXNlcnZlQ29sbGVjdGlvbnM9ZmFsc2U7R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUucmVzZXJ2ZVR5cGU9ZmFsc2U7R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUuZ2V0SW5wdXRHZW9tZXRyeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlucHV0R2VvbTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybT1mdW5jdGlvbihpbnB1dEdlb20pe3RoaXMuaW5wdXRHZW9tPWlucHV0R2VvbTt0aGlzLmZhY3Rvcnk9aW5wdXRHZW9tLmdldEZhY3RvcnkoKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1Qb2ludChpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1NdWx0aVBvaW50KGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZylcbnJldHVybiB0aGlzLnRyYW5zZm9ybUxpbmVhclJpbmcoaW5wdXRHZW9tLG51bGwpO2lmKGlucHV0R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtTGluZVN0cmluZyhpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZylcbnJldHVybiB0aGlzLnRyYW5zZm9ybU11bHRpTGluZVN0cmluZyhpbnB1dEdlb20sbnVsbCk7aWYoaW5wdXRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pXG5yZXR1cm4gdGhpcy50cmFuc2Zvcm1Qb2x5Z29uKGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtTXVsdGlQb2x5Z29uKGlucHV0R2VvbSxudWxsKTtpZihpbnB1dEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKVxucmV0dXJuIHRoaXMudHJhbnNmb3JtR2VvbWV0cnlDb2xsZWN0aW9uKGlucHV0R2VvbSxudWxsKTt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oJ1Vua25vd24gR2VvbWV0cnkgc3VidHlwZTogJytcbmlucHV0R2VvbS5nZXRDbGFzcygpLmdldE5hbWUoKSk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS5jcmVhdGVDb29yZGluYXRlU2VxdWVuY2U9ZnVuY3Rpb24oY29vcmRzKXtyZXR1cm4gdGhpcy5mYWN0b3J5LmdldENvb3JkaW5hdGVTZXF1ZW5jZUZhY3RvcnkoKS5jcmVhdGUoY29vcmRzKTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oc2VxKXtyZXR1cm4gc2VxLmNsb25lKCk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Db29yZGluYXRlcz1mdW5jdGlvbihjb29yZHMscGFyZW50KXtyZXR1cm4gdGhpcy5jb3B5KGNvb3Jkcyk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludD1mdW5jdGlvbihnZW9tLHBhcmVudCl7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVQb2ludCh0aGlzLnRyYW5zZm9ybUNvb3JkaW5hdGVzKGdlb20uZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCksZ2VvbSkpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2ludD1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHRyYW5zR2VvbUxpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgdHJhbnNmb3JtR2VvbT10aGlzLnRyYW5zZm9ybVBvaW50KGdlb20uZ2V0R2VvbWV0cnlOKGkpLGdlb20pO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbnJldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUxpbmVhclJpbmc9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciBzZXE9dGhpcy50cmFuc2Zvcm1Db29yZGluYXRlcyhnZW9tLmdldENvb3JkaW5hdGVTZXF1ZW5jZSgpLGdlb20pO3ZhciBzZXFTaXplPXNlcS5sZW5ndGg7aWYoc2VxU2l6ZT4wJiZzZXFTaXplPDQmJiF0aGlzLnByZXNlcnZlVHlwZSlcbnJldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhzZXEpO3JldHVybiB0aGlzLmZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhzZXEpO307R2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTGluZVN0cmluZz1mdW5jdGlvbihnZW9tLHBhcmVudCl7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKHRoaXMudHJhbnNmb3JtQ29vcmRpbmF0ZXMoZ2VvbS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKSxnZW9tKSk7fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1NdWx0aUxpbmVTdHJpbmc9ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm1MaW5lU3RyaW5nKGdlb20uZ2V0R2VvbWV0cnlOKGkpLGdlb20pO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbnJldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybVBvbHlnb249ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciBpc0FsbFZhbGlkTGluZWFyUmluZ3M9dHJ1ZTt2YXIgc2hlbGw9dGhpcy50cmFuc2Zvcm1MaW5lYXJSaW5nKGdlb20uZ2V0RXh0ZXJpb3JSaW5nKCksZ2VvbSk7aWYoc2hlbGw9PW51bGx8fCEoc2hlbGwgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZWFyUmluZyl8fHNoZWxsLmlzRW1wdHkoKSlcbmlzQWxsVmFsaWRMaW5lYXJSaW5ncz1mYWxzZTt2YXIgaG9sZXM9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXRoaXMudHJhbnNmb3JtTGluZWFyUmluZyhnZW9tLmdldEludGVyaW9yUmluZ04oaSksZ2VvbSk7aWYoaG9sZT09bnVsbHx8aG9sZS5pc0VtcHR5KCkpe2NvbnRpbnVlO31cbmlmKCEoaG9sZSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nKSlcbmlzQWxsVmFsaWRMaW5lYXJSaW5ncz1mYWxzZTtob2xlcy5hZGQoaG9sZSk7fVxuaWYoaXNBbGxWYWxpZExpbmVhclJpbmdzKVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVQb2x5Z29uKHNoZWxsLGhvbGVzLnRvQXJyYXkoKSk7ZWxzZXt2YXIgY29tcG9uZW50cz1uZXcgQXJyYXlMaXN0KCk7aWYoc2hlbGwhPW51bGwpXG5jb21wb25lbnRzLmFkZChzaGVsbCk7Y29tcG9uZW50cy5hZGRBbGwoaG9sZXMpO3JldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeShjb21wb25lbnRzKTt9fTtHZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1NdWx0aVBvbHlnb249ZnVuY3Rpb24oZ2VvbSxwYXJlbnQpe3ZhciB0cmFuc0dlb21MaXN0PW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHRyYW5zZm9ybUdlb209dGhpcy50cmFuc2Zvcm1Qb2x5Z29uKGdlb20uZ2V0R2VvbWV0cnlOKGkpLGdlb20pO2lmKHRyYW5zZm9ybUdlb209PW51bGwpXG5jb250aW51ZTtpZih0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbnJldHVybiB0aGlzLmZhY3RvcnkuYnVpbGRHZW9tZXRyeSh0cmFuc0dlb21MaXN0KTt9O0dlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUdlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbihnZW9tLHBhcmVudCl7dmFyIHRyYW5zR2VvbUxpc3Q9bmV3IEFycmF5TGlzdCgpO2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgdHJhbnNmb3JtR2VvbT10aGlzLnRyYW5zZm9ybShnZW9tLmdldEdlb21ldHJ5TihpKSk7aWYodHJhbnNmb3JtR2VvbT09bnVsbClcbmNvbnRpbnVlO2lmKHRoaXMucHJ1bmVFbXB0eUdlb21ldHJ5JiZ0cmFuc2Zvcm1HZW9tLmlzRW1wdHkoKSlcbmNvbnRpbnVlO3RyYW5zR2VvbUxpc3QuYWRkKHRyYW5zZm9ybUdlb20pO31cbmlmKHRoaXMucHJlc2VydmVHZW9tZXRyeUNvbGxlY3Rpb25UeXBlKVxucmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24oR2VvbWV0cnlGYWN0b3J5LnRvR2VvbWV0cnlBcnJheSh0cmFuc0dlb21MaXN0KSk7cmV0dXJuIHRoaXMuZmFjdG9yeS5idWlsZEdlb21ldHJ5KHRyYW5zR2VvbUxpc3QpO307anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lcj1HZW9tZXRyeVRyYW5zZm9ybWVyO30pKCk7KGZ1bmN0aW9uKCl7dmFyIExpbmVTdHJpbmdTbmFwcGVyPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5MaW5lU3RyaW5nU25hcHBlcjt2YXIgUHJlY2lzaW9uTW9kZWw9anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsO3ZhciBUcmVlU2V0PWphdmFzY3JpcHQudXRpbC5UcmVlU2V0O3ZhciBTbmFwVHJhbnNmb3JtZXI9ZnVuY3Rpb24oc25hcFRvbGVyYW5jZSxzbmFwUHRzLGlzU2VsZlNuYXApe3RoaXMuc25hcFRvbGVyYW5jZT1zbmFwVG9sZXJhbmNlO3RoaXMuc25hcFB0cz1zbmFwUHRzO3RoaXMuaXNTZWxmU25hcD1pc1NlbGZTbmFwfHxmYWxzZTt9O1NuYXBUcmFuc2Zvcm1lci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIoKTtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLnNuYXBUb2xlcmFuY2U9bnVsbDtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLnNuYXBQdHM9bnVsbDtTbmFwVHJhbnNmb3JtZXIucHJvdG90eXBlLmlzU2VsZlNuYXA9ZmFsc2U7U25hcFRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Db29yZGluYXRlcz1mdW5jdGlvbihjb29yZHMscGFyZW50KXt2YXIgc3JjUHRzPWNvb3Jkczt2YXIgbmV3UHRzPXRoaXMuc25hcExpbmUoc3JjUHRzLHRoaXMuc25hcFB0cyk7cmV0dXJuIG5ld1B0czt9O1NuYXBUcmFuc2Zvcm1lci5wcm90b3R5cGUuc25hcExpbmU9ZnVuY3Rpb24oc3JjUHRzLHNuYXBQdHMpe3ZhciBzbmFwcGVyPW5ldyBMaW5lU3RyaW5nU25hcHBlcihzcmNQdHMsdGhpcy5zbmFwVG9sZXJhbmNlKTtzbmFwcGVyLnNldEFsbG93U25hcHBpbmdUb1NvdXJjZVZlcnRpY2VzKHRoaXMuaXNTZWxmU25hcCk7cmV0dXJuIHNuYXBwZXIuc25hcFRvKHNuYXBQdHMpO307dmFyIEdlb21ldHJ5U25hcHBlcj1mdW5jdGlvbihzcmNHZW9tKXt0aGlzLnNyY0dlb209c3JjR2VvbTt9O0dlb21ldHJ5U25hcHBlci5TTkFQX1BSRUNJU0lPTl9GQUNUT1I9MWUtOTtHZW9tZXRyeVNuYXBwZXIuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlPWZ1bmN0aW9uKGcpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXtyZXR1cm4gR2VvbWV0cnlTbmFwcGVyLmNvbXB1dGVPdmVybGF5U25hcFRvbGVyYW5jZTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbnZhciBzbmFwVG9sZXJhbmNlPXRoaXMuY29tcHV0ZVNpemVCYXNlZFNuYXBUb2xlcmFuY2UoZyk7dmFyIHBtPWcuZ2V0UHJlY2lzaW9uTW9kZWwoKTtpZihwbS5nZXRUeXBlKCk9PVByZWNpc2lvbk1vZGVsLkZJWEVEKXt2YXIgZml4ZWRTbmFwVG9sPSgxL3BtLmdldFNjYWxlKCkpKjIvMS40MTU7aWYoZml4ZWRTbmFwVG9sPnNuYXBUb2xlcmFuY2UpXG5zbmFwVG9sZXJhbmNlPWZpeGVkU25hcFRvbDt9XG5yZXR1cm4gc25hcFRvbGVyYW5jZTt9O0dlb21ldHJ5U25hcHBlci5jb21wdXRlU2l6ZUJhc2VkU25hcFRvbGVyYW5jZT1mdW5jdGlvbihnKXt2YXIgZW52PWcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBtaW5EaW1lbnNpb249TWF0aC5taW4oZW52LmdldEhlaWdodCgpLGVudi5nZXRXaWR0aCgpKTt2YXIgc25hcFRvbD1taW5EaW1lbnNpb24qR2VvbWV0cnlTbmFwcGVyLlNOQVBfUFJFQ0lTSU9OX0ZBQ1RPUjtyZXR1cm4gc25hcFRvbDt9O0dlb21ldHJ5U25hcHBlci5jb21wdXRlT3ZlcmxheVNuYXBUb2xlcmFuY2UyPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gTWF0aC5taW4odGhpcy5jb21wdXRlT3ZlcmxheVNuYXBUb2xlcmFuY2UoZzApLHRoaXMuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlKGcxKSk7fTtHZW9tZXRyeVNuYXBwZXIuc25hcD1mdW5jdGlvbihnMCxnMSxzbmFwVG9sZXJhbmNlKXt2YXIgc25hcEdlb209W107dmFyIHNuYXBwZXIwPW5ldyBHZW9tZXRyeVNuYXBwZXIoZzApO3NuYXBHZW9tWzBdPXNuYXBwZXIwLnNuYXBUbyhnMSxzbmFwVG9sZXJhbmNlKTt2YXIgc25hcHBlcjE9bmV3IEdlb21ldHJ5U25hcHBlcihnMSk7c25hcEdlb21bMV09c25hcHBlcjEuc25hcFRvKHNuYXBHZW9tWzBdLHNuYXBUb2xlcmFuY2UpO3JldHVybiBzbmFwR2VvbTt9O0dlb21ldHJ5U25hcHBlci5zbmFwVG9TZWxmPWZ1bmN0aW9uKGcwLHNuYXBUb2xlcmFuY2UsY2xlYW5SZXN1bHQpe3ZhciBzbmFwcGVyMD1uZXcgR2VvbWV0cnlTbmFwcGVyKGcwKTtyZXR1cm4gc25hcHBlcjAuc25hcFRvU2VsZihzbmFwVG9sZXJhbmNlLGNsZWFuUmVzdWx0KTt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuc3JjR2VvbT1udWxsO0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuc25hcFRvPWZ1bmN0aW9uKHNuYXBHZW9tLHNuYXBUb2xlcmFuY2Upe3ZhciBzbmFwUHRzPXRoaXMuZXh0cmFjdFRhcmdldENvb3JkaW5hdGVzKHNuYXBHZW9tKTt2YXIgc25hcFRyYW5zPW5ldyBTbmFwVHJhbnNmb3JtZXIoc25hcFRvbGVyYW5jZSxzbmFwUHRzKTtyZXR1cm4gc25hcFRyYW5zLnRyYW5zZm9ybSh0aGlzLnNyY0dlb20pO307R2VvbWV0cnlTbmFwcGVyLnByb3RvdHlwZS5zbmFwVG9TZWxmPWZ1bmN0aW9uKHNuYXBUb2xlcmFuY2UsY2xlYW5SZXN1bHQpe3ZhciBzbmFwUHRzPXRoaXMuZXh0cmFjdFRhcmdldENvb3JkaW5hdGVzKHNyY0dlb20pO3ZhciBzbmFwVHJhbnM9bmV3IFNuYXBUcmFuc2Zvcm1lcihzbmFwVG9sZXJhbmNlLHNuYXBQdHMsdHJ1ZSk7dmFyIHNuYXBwZWRHZW9tPXNuYXBUcmFucy50cmFuc2Zvcm0oc3JjR2VvbSk7dmFyIHJlc3VsdD1zbmFwcGVkR2VvbTtpZihjbGVhblJlc3VsdCYmcmVzdWx0IGluc3RhbmNlb2YgUG9seWdvbmFsKXtyZXN1bHQ9c25hcHBlZEdlb20uYnVmZmVyKDApO31cbnJldHVybiByZXN1bHQ7fTtHZW9tZXRyeVNuYXBwZXIucHJvdG90eXBlLmV4dHJhY3RUYXJnZXRDb29yZGluYXRlcz1mdW5jdGlvbihnKXt2YXIgcHRTZXQ9bmV3IFRyZWVTZXQoKTt2YXIgcHRzPWcuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtwdFNldC5hZGQocHRzW2ldKTt9XG5yZXR1cm4gcHRTZXQudG9BcnJheSgpO307R2VvbWV0cnlTbmFwcGVyLnByb3RvdHlwZS5jb21wdXRlU25hcFRvbGVyYW5jZT1mdW5jdGlvbihyaW5nUHRzKXt2YXIgbWluU2VnTGVuPXRoaXMuY29tcHV0ZU1pbmltdW1TZWdtZW50TGVuZ3RoKHJpbmdQdHMpO3ZhciBzbmFwVG9sPW1pblNlZ0xlbi8xMDtyZXR1cm4gc25hcFRvbDt9O0dlb21ldHJ5U25hcHBlci5wcm90b3R5cGUuY29tcHV0ZU1pbmltdW1TZWdtZW50TGVuZ3RoPWZ1bmN0aW9uKHB0cyl7dmFyIG1pblNlZ0xlbj1OdW1iZXIuTUFYX1ZBTFVFO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ0xlbj1wdHNbaV0uZGlzdGFuY2UocHRzW2krMV0pO2lmKHNlZ0xlbjxtaW5TZWdMZW4pXG5taW5TZWdMZW49c2VnTGVuO31cbnJldHVybiBtaW5TZWdMZW47fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuR2VvbWV0cnlTbmFwcGVyPUdlb21ldHJ5U25hcHBlcjt9KSgpO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcj1mdW5jdGlvbihib3VuZGFyeVJ1bGUpe3RoaXMuYm91bmRhcnlSdWxlPWJvdW5kYXJ5UnVsZT9ib3VuZGFyeVJ1bGU6anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmJvdW5kYXJ5UnVsZT1udWxsO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUuaXNJbj1udWxsO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubnVtQm91bmRhcmllcz1udWxsO2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihwLGdlb20pe3JldHVybiB0aGlzLmxvY2F0ZShwLGdlb20pIT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tLmlzRW1wdHkoKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7cmV0dXJuIHRoaXMubG9jYXRlMihwLGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZyl7cmV0dXJuIHRoaXMubG9jYXRlMyhwLGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7cmV0dXJuIHRoaXMubG9jYXRlNChwLGdlb20pO31cbnRoaXMuaXNJbj1mYWxzZTt0aGlzLm51bUJvdW5kYXJpZXM9MDt0aGlzLmNvbXB1dGVMb2NhdGlvbihwLGdlb20pO2lmKHRoaXMuYm91bmRhcnlSdWxlLmlzSW5Cb3VuZGFyeSh0aGlzLm51bUJvdW5kYXJpZXMpKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWTtpZih0aGlzLm51bUJvdW5kYXJpZXM+MHx8dGhpcy5pc0luKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUjtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yLnByb3RvdHlwZS5jb21wdXRlTG9jYXRpb249ZnVuY3Rpb24ocCxnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy51cGRhdGVMb2NhdGlvbkluZm8odGhpcy5sb2NhdGUocCxnZW9tKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpe3ZhciBtbD1nZW9tO2Zvcih2YXIgaT0wO2k8bWwuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGw9bWwuZ2V0R2VvbWV0cnlOKGkpO3RoaXMudXBkYXRlTG9jYXRpb25JbmZvKHRoaXMubG9jYXRlKHAsbCkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dmFyIG1wb2x5PWdlb207Zm9yKHZhciBpPTA7aTxtcG9seS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcG9seT1tcG9seS5nZXRHZW9tZXRyeU4oaSk7dGhpcy51cGRhdGVMb2NhdGlvbkluZm8odGhpcy5sb2NhdGUocCxwb2x5KSk7fX1lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcGFydD1nZW9tLmdldEdlb21ldHJ5TihpKTtpZihwYXJ0IT09Z2VvbSl7dGhpcy5jb21wdXRlTG9jYXRpb24ocCxwYXJ0KTt9fX19O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUudXBkYXRlTG9jYXRpb25JbmZvPWZ1bmN0aW9uKGxvYyl7aWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKVxudGhpcy5pc0luPXRydWU7aWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxudGhpcy5udW1Cb3VuZGFyaWVzKys7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZTI9ZnVuY3Rpb24ocCxwdCl7dmFyIHB0Q29vcmQ9cHQuZ2V0Q29vcmRpbmF0ZSgpO2lmKHB0Q29vcmQuZXF1YWxzMkQocCkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IucHJvdG90eXBlLmxvY2F0ZTM9ZnVuY3Rpb24ocCxsKXtpZighbC5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhwKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7dmFyIHB0PWwuZ2V0Q29vcmRpbmF0ZXMoKTtpZighbC5pc0Nsb3NlZCgpKXtpZihwLmVxdWFscyhwdFswXSl8fHAuZXF1YWxzKHB0W3B0Lmxlbmd0aC0xXSkpe3JldHVybiBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7fX1cbmlmKGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc09uTGluZShwLHB0KSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubG9jYXRlSW5Qb2x5Z29uUmluZz1mdW5jdGlvbihwLHJpbmcpe2lmKCFyaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKHApKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmxvY2F0ZVBvaW50SW5SaW5nKHAscmluZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvci5wcm90b3R5cGUubG9jYXRlND1mdW5jdGlvbihwLHBvbHkpe2lmKHBvbHkuaXNFbXB0eSgpKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt2YXIgc2hlbGw9cG9seS5nZXRFeHRlcmlvclJpbmcoKTt2YXIgc2hlbGxMb2M9dGhpcy5sb2NhdGVJblBvbHlnb25SaW5nKHAsc2hlbGwpO2lmKHNoZWxsTG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtpZihzaGVsbExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cG9seS5nZXRJbnRlcmlvclJpbmdOKGkpO3ZhciBob2xlTG9jPXRoaXMubG9jYXRlSW5Qb2x5Z29uUmluZyhwLGhvbGUpO2lmKGhvbGVMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO2lmKGhvbGVMb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uQk9VTkRBUlkpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO31cbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDt2YXIgVHJlZU1hcD1qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcDtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwPWZ1bmN0aW9uKG5vZGVGYWN0b3J5KXt0aGlzLm5vZGVNYXA9bmV3IFRyZWVNYXAoKTt0aGlzLm5vZGVGYWN0PW5vZGVGYWN0b3J5O307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUubm9kZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLm5vZGVGYWN0PW51bGw7anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuYWRkTm9kZT1mdW5jdGlvbihhcmcpe3ZhciBub2RlLGNvb3JkO2lmKGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtjb29yZD1hcmc7bm9kZT10aGlzLm5vZGVNYXAuZ2V0KGNvb3JkKTtpZihub2RlPT09bnVsbCl7bm9kZT10aGlzLm5vZGVGYWN0LmNyZWF0ZU5vZGUoY29vcmQpO3RoaXMubm9kZU1hcC5wdXQoY29vcmQsbm9kZSk7fVxucmV0dXJuIG5vZGU7fWVsc2UgaWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tZ3JhcGguTm9kZSl7dmFyIG49YXJnO2Nvb3JkPW4uZ2V0Q29vcmRpbmF0ZSgpO25vZGU9dGhpcy5ub2RlTWFwLmdldChjb29yZCk7aWYobm9kZT09PW51bGwpe3RoaXMubm9kZU1hcC5wdXQoY29vcmQsbik7cmV0dXJuIG47fVxubm9kZS5tZXJnZUxhYmVsKG4pO3JldHVybiBub2RlO319O2pzdHMuZ2VvbWdyYXBoLk5vZGVNYXAucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlKXt2YXIgcD1lLmdldENvb3JkaW5hdGUoKTt2YXIgbj10aGlzLmFkZE5vZGUocCk7bi5hZGQoZSk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS5maW5kPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gdGhpcy5ub2RlTWFwLmdldChjb29yZCk7fTtqc3RzLmdlb21ncmFwaC5Ob2RlTWFwLnByb3RvdHlwZS52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlTWFwLnZhbHVlcygpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuaXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZXMoKS5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguTm9kZU1hcC5wcm90b3R5cGUuZ2V0Qm91bmRhcnlOb2Rlcz1mdW5jdGlvbihnZW9tSW5kZXgpe3ZhciBiZHlOb2Rlcz1uZXcgQXJyYXlMaXN0KCk7Zm9yKHZhciBpPXRoaXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBub2RlPWkubmV4dCgpO2lmKG5vZGUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihnZW9tSW5kZXgpPT09TG9jYXRpb24uQk9VTkRBUlkpe2JkeU5vZGVzLmFkZChub2RlKTt9fVxucmV0dXJuIGJkeU5vZGVzO307fSkoKTsoZnVuY3Rpb24oKXt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGg9ZnVuY3Rpb24obm9kZUZhY3Rvcnkpe3RoaXMuZWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuZWRnZUVuZExpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMubm9kZXM9bmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGVNYXAobm9kZUZhY3Rvcnl8fG5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlRmFjdG9yeSgpKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5ub2Rlcz1udWxsO2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5lZGdlRW5kTGlzdD1udWxsO2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLmxpbmtSZXN1bHREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKG5vZGVzKXtmb3IodmFyIG5vZGVpdD1ub2Rlcy5pdGVyYXRvcigpO25vZGVpdC5oYXNOZXh0KCk7KXt2YXIgbm9kZT1ub2RlaXQubmV4dCgpO25vZGUuZ2V0RWRnZXMoKS5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcygpO319O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5nZXRFZGdlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlcy5pdGVyYXRvcigpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmdldEVkZ2VFbmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZUVuZExpc3Q7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuaXNCb3VuZGFyeU5vZGU9ZnVuY3Rpb24oZ2VvbUluZGV4LGNvb3JkKXt2YXIgbm9kZT10aGlzLm5vZGVzLmZpbmQoY29vcmQpO2lmKG5vZGU9PT1udWxsKVxucmV0dXJuIGZhbHNlO3ZhciBsYWJlbD1ub2RlLmdldExhYmVsKCk7aWYobGFiZWwhPT1udWxsJiZsYWJlbC5nZXRMb2NhdGlvbihnZW9tSW5kZXgpPT09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmluc2VydEVkZ2U9ZnVuY3Rpb24oZSl7dGhpcy5lZGdlcy5hZGQoZSk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGUpe3RoaXMubm9kZXMuYWRkKGUpO3RoaXMuZWRnZUVuZExpc3QuYWRkKGUpO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmdldE5vZGVJdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVzLml0ZXJhdG9yKCk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuZ2V0Tm9kZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlcy52YWx1ZXMoKTt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5hZGROb2RlPWZ1bmN0aW9uKG5vZGUpe3JldHVybiB0aGlzLm5vZGVzLmFkZE5vZGUobm9kZSk7fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUuYWRkRWRnZXM9ZnVuY3Rpb24oZWRnZXNUb0FkZCl7Zm9yKHZhciBpdD1lZGdlc1RvQWRkLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGU9aXQubmV4dCgpO3RoaXMuZWRnZXMuYWRkKGUpO3ZhciBkZTE9bmV3IGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZShlLHRydWUpO3ZhciBkZTI9bmV3IGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZShlLGZhbHNlKTtkZTEuc2V0U3ltKGRlMik7ZGUyLnNldFN5bShkZTEpO3RoaXMuYWRkKGRlMSk7dGhpcy5hZGQoZGUyKTt9fTtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5wcm90b3R5cGUubGlua1Jlc3VsdERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVpdD10aGlzLm5vZGVzLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLmxpbmtSZXN1bHREaXJlY3RlZEVkZ2VzKCk7fX07anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmRFZGdlSW5TYW1lRGlyZWN0aW9uPWZ1bmN0aW9uKHAwLHAxKXt2YXIgaT0wLGlsPXRoaXMuZWRnZXMuc2l6ZSgpLGUsZUNvb3JkO2ZvcihpO2k8aWw7aSsrKXtlPXRoaXMuZWRnZXMuZ2V0KGkpO2VDb29yZD1lLmdldENvb3JkaW5hdGVzKCk7aWYodGhpcy5tYXRjaEluU2FtZURpcmVjdGlvbihwMCxwMSxlQ29vcmRbMF0sZUNvb3JkWzFdKSl7cmV0dXJuIGU7fVxuaWYodGhpcy5tYXRjaEluU2FtZURpcmVjdGlvbihwMCxwMSxlQ29vcmRbZUNvb3JkLmxlbmd0aC0xXSxlQ29vcmRbZUNvb3JkLmxlbmd0aC0yXSkpe3JldHVybiBlO319XG5yZXR1cm4gbnVsbDt9O2pzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoLnByb3RvdHlwZS5tYXRjaEluU2FtZURpcmVjdGlvbj1mdW5jdGlvbihwMCxwMSxlcDAsZXAxKXtpZighcDAuZXF1YWxzKGVwMCkpe3JldHVybiBmYWxzZTt9XG5pZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHAwLHAxLGVwMSk9PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09MTElORUFSJiZqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChwMCxwMSk9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudChlcDAsZXAxKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgucHJvdG90eXBlLmZpbmRFZGdlRW5kPWZ1bmN0aW9uKGUpe2Zvcih2YXIgaT10aGlzLmdldEVkZ2VFbmRzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlZT1pLm5leHQoKTtpZihlZS5nZXRFZGdlKCk9PT1lKXtyZXR1cm4gZWU7fX1cbnJldHVybiBudWxsO307fSkoKTtqc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5pc0RvbmU9anN0cy5hYnN0cmFjdEZ1bmM7KGZ1bmN0aW9uKCl7dmFyIFNlZ21lbnRJbnRlcnNlY3Rvcj1qc3RzLm5vZGluZy5TZWdtZW50SW50ZXJzZWN0b3I7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyPWZ1bmN0aW9uKGxpKXt0aGlzLmxpPWxpO3RoaXMuaW50ZXJzZWN0aW9ucz1uZXcgQXJyYXlMaXN0KCk7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbj1udWxsO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlPW5ldyBTZWdtZW50SW50ZXJzZWN0b3IoKTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlcjtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuZmluZEFsbEludGVyc2VjdGlvbnM9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmlzQ2hlY2tFbmRTZWdtZW50c09ubHk9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmludGVyaW9ySW50ZXJzZWN0aW9uPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmludFNlZ21lbnRzPW51bGw7anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmludGVyc2VjdGlvbnM9bnVsbDtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuc2V0RmluZEFsbEludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZmluZEFsbEludGVyc2VjdGlvbnMpe3RoaXMuZmluZEFsbEludGVyc2VjdGlvbnM9ZmluZEFsbEludGVyc2VjdGlvbnM7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9ucz1mdW5jdGlvbigpe3JldHVybiBpbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLnNldENoZWNrRW5kU2VnbWVudHNPbmx5PWZ1bmN0aW9uKGlzQ2hlY2tFbmRTZWdtZW50c09ubHkpe3RoaXMuaXNDaGVja0VuZFNlZ21lbnRzT25seT1pc0NoZWNrRW5kU2VnbWVudHNPbmx5O31cbmpzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbiE9bnVsbDt9O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5nZXRJbnRlcmlvckludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyaW9ySW50ZXJzZWN0aW9uO307anN0cy5ub2RpbmcuSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIucHJvdG90eXBlLmdldEludGVyc2VjdGlvblNlZ21lbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50U2VnbWVudHM7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYodGhpcy5oYXNJbnRlcnNlY3Rpb24oKSlcbnJldHVybjtpZihlMD09ZTEmJnNlZ0luZGV4MD09c2VnSW5kZXgxKVxucmV0dXJuO2lmKHRoaXMuaXNDaGVja0VuZFNlZ21lbnRzT25seSl7dmFyIGlzRW5kU2VnUHJlc2VudD10aGlzLmlzRW5kU2VnbWVudChlMCxzZWdJbmRleDApfHxpc0VuZFNlZ21lbnQoZTEsc2VnSW5kZXgxKTtpZighaXNFbmRTZWdQcmVzZW50KVxucmV0dXJuO31cbnZhciBwMDA9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDBdO3ZhciBwMDE9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDArMV07dmFyIHAxMD1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MV07dmFyIHAxMT1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MSsxXTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAwLHAwMSxwMTAscDExKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXtpZih0aGlzLmxpLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24oKSl7dGhpcy5pbnRTZWdtZW50cz1bXTt0aGlzLmludFNlZ21lbnRzWzBdPXAwMDt0aGlzLmludFNlZ21lbnRzWzFdPXAwMTt0aGlzLmludFNlZ21lbnRzWzJdPXAxMDt0aGlzLmludFNlZ21lbnRzWzNdPXAxMTt0aGlzLmludGVyaW9ySW50ZXJzZWN0aW9uPXRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uKDApO3RoaXMuaW50ZXJzZWN0aW9ucy5hZGQodGhpcy5pbnRlcmlvckludGVyc2VjdGlvbik7fX19O2pzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyLnByb3RvdHlwZS5pc0VuZFNlZ21lbnQ9ZnVuY3Rpb24oc2VnU3RyLGluZGV4KXtpZihpbmRleD09MClcbnJldHVybiB0cnVlO2lmKGluZGV4Pj1zZWdTdHIuc2l6ZSgpLTIpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5JbnRlcmlvckludGVyc2VjdGlvbkZpbmRlci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7aWYodGhpcy5maW5kQWxsSW50ZXJzZWN0aW9ucylcbnJldHVybiBmYWxzZTtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbiE9bnVsbDt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIFJvYnVzdExpbmVJbnRlcnNlY3Rvcj1qc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3I7dmFyIEludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyPWpzdHMubm9kaW5nLkludGVyaW9ySW50ZXJzZWN0aW9uRmluZGVyO3ZhciBNQ0luZGV4Tm9kZXI9anN0cy5ub2RpbmcuTUNJbmRleE5vZGVyO2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3I9ZnVuY3Rpb24oc2VnU3RyaW5ncyl7dGhpcy5saT1uZXcgUm9idXN0TGluZUludGVyc2VjdG9yKCk7dGhpcy5zZWdTdHJpbmdzPXNlZ1N0cmluZ3M7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLnNlZ1N0cmluZ3M9bnVsbDtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5maW5kQWxsSW50ZXJzZWN0aW9ucz1mYWxzZTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5zZWdJbnQ9bnVsbDtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5faXNWYWxpZD10cnVlO2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLnNldEZpbmRBbGxJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGZpbmRBbGxJbnRlcnNlY3Rpb25zKXt0aGlzLmZpbmRBbGxJbnRlcnNlY3Rpb25zPWZpbmRBbGxJbnRlcnNlY3Rpb25zO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0aW9ucz1mdW5jdGlvbigpe3JldHVybiBzZWdJbnQuZ2V0SW50ZXJzZWN0aW9ucygpO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3RoaXMuZXhlY3V0ZSgpO3JldHVybiB0aGlzLl9pc1ZhbGlkO307anN0cy5ub2RpbmcuRmFzdE5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuZ2V0RXJyb3JNZXNzYWdlPWZ1bmN0aW9uKCl7aWYodGhpcy5faXNWYWxpZClcbnJldHVybidubyBpbnRlcnNlY3Rpb25zIGZvdW5kJzt2YXIgaW50U2Vncz10aGlzLnNlZ0ludC5nZXRJbnRlcnNlY3Rpb25TZWdtZW50cygpO3JldHVybidmb3VuZCBub24tbm9kZWQgaW50ZXJzZWN0aW9uIGJldHdlZW4gJytcbmpzdHMuaW8uV0tUV3JpdGVyLnRvTGluZVN0cmluZyhpbnRTZWdzWzBdLGludFNlZ3NbMV0pKycgYW5kICcrXG5qc3RzLmlvLldLVFdyaXRlci50b0xpbmVTdHJpbmcoaW50U2Vnc1syXSxpbnRTZWdzWzNdKTt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmNoZWNrVmFsaWQ9ZnVuY3Rpb24oKXt0aGlzLmV4ZWN1dGUoKTtpZighdGhpcy5faXNWYWxpZClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IodGhpcy5nZXRFcnJvck1lc3NhZ2UoKSx0aGlzLnNlZ0ludC5nZXRJbnRlcmlvckludGVyc2VjdGlvbigpKTt9O2pzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLmV4ZWN1dGU9ZnVuY3Rpb24oKXtpZih0aGlzLnNlZ0ludCE9bnVsbClcbnJldHVybjt0aGlzLmNoZWNrSW50ZXJpb3JJbnRlcnNlY3Rpb25zKCk7fTtqc3RzLm5vZGluZy5GYXN0Tm9kaW5nVmFsaWRhdG9yLnByb3RvdHlwZS5jaGVja0ludGVyaW9ySW50ZXJzZWN0aW9ucz1mdW5jdGlvbigpe3RoaXMuX2lzVmFsaWQ9dHJ1ZTt0aGlzLnNlZ0ludD1uZXcgSW50ZXJpb3JJbnRlcnNlY3Rpb25GaW5kZXIodGhpcy5saSk7dGhpcy5zZWdJbnQuc2V0RmluZEFsbEludGVyc2VjdGlvbnModGhpcy5maW5kQWxsSW50ZXJzZWN0aW9ucyk7dmFyIG5vZGVyPW5ldyBNQ0luZGV4Tm9kZXIoKTtub2Rlci5zZXRTZWdtZW50SW50ZXJzZWN0b3IodGhpcy5zZWdJbnQpO25vZGVyLmNvbXB1dGVOb2Rlcyh0aGlzLnNlZ1N0cmluZ3MpO2lmKHRoaXMuc2VnSW50Lmhhc0ludGVyc2VjdGlvbigpKXt0aGlzLl9pc1ZhbGlkPWZhbHNlO3JldHVybjt9fTt9KSgpOyhmdW5jdGlvbigpe2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZz1mdW5jdGlvbihwdHMsZGF0YSl7dGhpcy5wdHM9cHRzO3RoaXMuZGF0YT1kYXRhO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuU2VnbWVudFN0cmluZygpO2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUucHRzPW51bGw7anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5kYXRhPW51bGw7anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF0YTt9XG5qc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oZGF0YSl7dGhpcy5kYXRhPWRhdGE7fTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKGkpe3JldHVybiB0aGlzLnB0c1tpXTt9O2pzdHMubm9kaW5nLkJhc2ljU2VnbWVudFN0cmluZy5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHM7fTtqc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzWzBdLmVxdWFscyh0aGlzLnB0c1t0aGlzLnB0cy5sZW5ndGgtMV0pO307anN0cy5ub2RpbmcuQmFzaWNTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5nZXRTZWdtZW50T2N0YW50PWZ1bmN0aW9uKGluZGV4KXtpZihpbmRleD09dGhpcy5wdHMubGVuZ3RoLTEpXG5yZXR1cm4tMTtyZXR1cm4ganN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudCh0aGlzLmdldENvb3JkaW5hdGUoaW5kZXgpLHRoaXMuZ2V0Q29vcmRpbmF0ZShpbmRleCsxKSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBGYXN0Tm9kaW5nVmFsaWRhdG9yPWpzdHMubm9kaW5nLkZhc3ROb2RpbmdWYWxpZGF0b3I7dmFyIEJhc2ljU2VnbWVudFN0cmluZz1qc3RzLm5vZGluZy5CYXNpY1NlZ21lbnRTdHJpbmc7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3I9ZnVuY3Rpb24oZWRnZXMpe3RoaXMubnY9bmV3IEZhc3ROb2RpbmdWYWxpZGF0b3IoanN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci50b1NlZ21lbnRTdHJpbmdzKGVkZ2VzKSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yLmNoZWNrVmFsaWQ9ZnVuY3Rpb24oZWRnZXMpe3ZhciB2YWxpZGF0b3I9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IoZWRnZXMpO3ZhbGlkYXRvci5jaGVja1ZhbGlkKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlTm9kaW5nVmFsaWRhdG9yLnRvU2VnbWVudFN0cmluZ3M9ZnVuY3Rpb24oZWRnZXMpe3ZhciBzZWdTdHJpbmdzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlPWkubmV4dCgpO3NlZ1N0cmluZ3MuYWRkKG5ldyBCYXNpY1NlZ21lbnRTdHJpbmcoZS5nZXRDb29yZGluYXRlcygpLGUpKTt9XG5yZXR1cm4gc2VnU3RyaW5nczt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3IucHJvdG90eXBlLm52PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZU5vZGluZ1ZhbGlkYXRvci5wcm90b3R5cGUuY2hlY2tWYWxpZD1mdW5jdGlvbigpe3RoaXMubnYuY2hlY2tWYWxpZCgpO307fSkoKTtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uPWZ1bmN0aW9uKGcwLGcxLGJvdW5kYXJ5Tm9kZVJ1bGUpe3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMuYXJnPVtdO2lmKGcwPT09dW5kZWZpbmVkKXtyZXR1cm47fVxuaWYoZzE9PT11bmRlZmluZWQpe3RoaXMuc2V0Q29tcHV0YXRpb25QcmVjaXNpb24oZzAuZ2V0UHJlY2lzaW9uTW9kZWwoKSk7dGhpcy5hcmdbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnMCk7cmV0dXJuO31cbmJvdW5kYXJ5Tm9kZVJ1bGU9Ym91bmRhcnlOb2RlUnVsZXx8anN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZS5PR0NfU0ZTX0JPVU5EQVJZX1JVTEU7aWYoZzAuZ2V0UHJlY2lzaW9uTW9kZWwoKS5jb21wYXJlVG8oZzEuZ2V0UHJlY2lzaW9uTW9kZWwoKSk+PTApXG50aGlzLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uKGcwLmdldFByZWNpc2lvbk1vZGVsKCkpO2Vsc2VcbnRoaXMuc2V0Q29tcHV0YXRpb25QcmVjaXNpb24oZzEuZ2V0UHJlY2lzaW9uTW9kZWwoKSk7dGhpcy5hcmdbMF09bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnMCxib3VuZGFyeU5vZGVSdWxlKTt0aGlzLmFyZ1sxXT1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgxLGcxLGJvdW5kYXJ5Tm9kZVJ1bGUpO307anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbi5wcm90b3R5cGUubGk9bnVsbDtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLnByb3RvdHlwZS5yZXN1bHRQcmVjaXNpb25Nb2RlbD1udWxsO2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLmFyZz1udWxsO2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLmdldEFyZ0dlb21ldHJ5PWZ1bmN0aW9uKGkpe3JldHVybiBhcmdbaV0uZ2V0R2VvbWV0cnkoKTt9O2pzdHMub3BlcmF0aW9uLkdlb21ldHJ5R3JhcGhPcGVyYXRpb24ucHJvdG90eXBlLnNldENvbXB1dGF0aW9uUHJlY2lzaW9uPWZ1bmN0aW9uKHBtKXt0aGlzLnJlc3VsdFByZWNpc2lvbk1vZGVsPXBtO3RoaXMubGkuc2V0UHJlY2lzaW9uTW9kZWwodGhpcy5yZXN1bHRQcmVjaXNpb25Nb2RlbCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlOb2RlRmFjdG9yeT1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5Tm9kZUZhY3RvcnkucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlRmFjdG9yeSgpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5LmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGNvb3JkKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGUoY29vcmQsbmV3IGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIoKSk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5zaGVsbExpc3Q9W107dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuZ2VvbWV0cnlGYWN0b3J5PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuc2hlbGxMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdyYXBoKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5hZGQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5hZGQyKGdyYXBoLmdldEVkZ2VFbmRzKCksZ3JhcGguZ2V0Tm9kZXMoKSk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKGRpckVkZ2VzLG5vZGVzKXtqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaC5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcyhub2Rlcyk7dmFyIG1heEVkZ2VSaW5ncz10aGlzLmJ1aWxkTWF4aW1hbEVkZ2VSaW5ncyhkaXJFZGdlcyk7dmFyIGZyZWVIb2xlTGlzdD1bXTt2YXIgZWRnZVJpbmdzPXRoaXMuYnVpbGRNaW5pbWFsRWRnZVJpbmdzKG1heEVkZ2VSaW5ncyx0aGlzLnNoZWxsTGlzdCxmcmVlSG9sZUxpc3QpO3RoaXMuc29ydFNoZWxsc0FuZEhvbGVzKGVkZ2VSaW5ncyx0aGlzLnNoZWxsTGlzdCxmcmVlSG9sZUxpc3QpO3RoaXMucGxhY2VGcmVlSG9sZXModGhpcy5zaGVsbExpc3QsZnJlZUhvbGVMaXN0KTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmdldFBvbHlnb25zPWZ1bmN0aW9uKCl7dmFyIHJlc3VsdFBvbHlMaXN0PXRoaXMuY29tcHV0ZVBvbHlnb25zKHRoaXMuc2hlbGxMaXN0KTtyZXR1cm4gcmVzdWx0UG9seUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5idWlsZE1heGltYWxFZGdlUmluZ3M9ZnVuY3Rpb24oZGlyRWRnZXMpe3ZhciBtYXhFZGdlUmluZ3M9W107Zm9yKHZhciBpdD1kaXJFZGdlcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuaXNJblJlc3VsdCgpJiZkZS5nZXRMYWJlbCgpLmlzQXJlYSgpKXtpZihkZS5nZXRFZGdlUmluZygpPT1udWxsKXt2YXIgZXI9bmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nKGRlLHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTttYXhFZGdlUmluZ3MucHVzaChlcik7ZXIuc2V0SW5SZXN1bHQoKTt9fX1cbnJldHVybiBtYXhFZGdlUmluZ3M7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5idWlsZE1pbmltYWxFZGdlUmluZ3M9ZnVuY3Rpb24obWF4RWRnZVJpbmdzLHNoZWxsTGlzdCxmcmVlSG9sZUxpc3Qpe3ZhciBlZGdlUmluZ3M9W107Zm9yKHZhciBpPTA7aTxtYXhFZGdlUmluZ3MubGVuZ3RoO2krKyl7dmFyIGVyPW1heEVkZ2VSaW5nc1tpXTtpZihlci5nZXRNYXhOb2RlRGVncmVlKCk+Mil7ZXIubGlua0RpcmVjdGVkRWRnZXNGb3JNaW5pbWFsRWRnZVJpbmdzKCk7dmFyIG1pbkVkZ2VSaW5ncz1lci5idWlsZE1pbmltYWxSaW5ncygpO3ZhciBzaGVsbD10aGlzLmZpbmRTaGVsbChtaW5FZGdlUmluZ3MpO2lmKHNoZWxsIT09bnVsbCl7dGhpcy5wbGFjZVBvbHlnb25Ib2xlcyhzaGVsbCxtaW5FZGdlUmluZ3MpO3NoZWxsTGlzdC5wdXNoKHNoZWxsKTt9ZWxzZXtmcmVlSG9sZUxpc3Q9ZnJlZUhvbGVMaXN0LmNvbmNhdChtaW5FZGdlUmluZ3MpO319ZWxzZXtlZGdlUmluZ3MucHVzaChlcik7fX1cbnJldHVybiBlZGdlUmluZ3M7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5maW5kU2hlbGw9ZnVuY3Rpb24obWluRWRnZVJpbmdzKXt2YXIgc2hlbGxDb3VudD0wO3ZhciBzaGVsbD1udWxsO2Zvcih2YXIgaT0wO2k8bWluRWRnZVJpbmdzLmxlbmd0aDtpKyspe3ZhciBlcj1taW5FZGdlUmluZ3NbaV07aWYoIWVyLmlzSG9sZSgpKXtzaGVsbD1lcjtzaGVsbENvdW50Kys7fX1cbmpzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKHNoZWxsQ291bnQ8PTEsJ2ZvdW5kIHR3byBzaGVsbHMgaW4gTWluaW1hbEVkZ2VSaW5nIGxpc3QnKTtyZXR1cm4gc2hlbGw7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5wbGFjZVBvbHlnb25Ib2xlcz1mdW5jdGlvbihzaGVsbCxtaW5FZGdlUmluZ3Mpe2Zvcih2YXIgaT0wO2k8bWluRWRnZVJpbmdzLmxlbmd0aDtpKyspe3ZhciBlcj1taW5FZGdlUmluZ3NbaV07aWYoZXIuaXNIb2xlKCkpe2VyLnNldFNoZWxsKHNoZWxsKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuc29ydFNoZWxsc0FuZEhvbGVzPWZ1bmN0aW9uKGVkZ2VSaW5ncyxzaGVsbExpc3QsZnJlZUhvbGVMaXN0KXtmb3IodmFyIGk9MDtpPGVkZ2VSaW5ncy5sZW5ndGg7aSsrKXt2YXIgZXI9ZWRnZVJpbmdzW2ldO2lmKGVyLmlzSG9sZSgpKXtmcmVlSG9sZUxpc3QucHVzaChlcik7fWVsc2V7c2hlbGxMaXN0LnB1c2goZXIpO319fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5wbGFjZUZyZWVIb2xlcz1mdW5jdGlvbihzaGVsbExpc3QsZnJlZUhvbGVMaXN0KXtmb3IodmFyIGk9MDtpPGZyZWVIb2xlTGlzdC5sZW5ndGg7aSsrKXt2YXIgaG9sZT1mcmVlSG9sZUxpc3RbaV07aWYoaG9sZS5nZXRTaGVsbCgpPT1udWxsKXt2YXIgc2hlbGw9dGhpcy5maW5kRWRnZVJpbmdDb250YWluaW5nKGhvbGUsc2hlbGxMaXN0KTtpZihzaGVsbD09PW51bGwpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCd1bmFibGUgdG8gYXNzaWduIGhvbGUgdG8gYSBzaGVsbCcsaG9sZS5nZXRDb29yZGluYXRlKDApKTtob2xlLnNldFNoZWxsKHNoZWxsKTt9fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2x5Z29uQnVpbGRlci5wcm90b3R5cGUuZmluZEVkZ2VSaW5nQ29udGFpbmluZz1mdW5jdGlvbih0ZXN0RXIsc2hlbGxMaXN0KXt2YXIgdGVzdFJpbmc9dGVzdEVyLmdldExpbmVhclJpbmcoKTt2YXIgdGVzdEVudj10ZXN0UmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIHRlc3RQdD10ZXN0UmluZy5nZXRDb29yZGluYXRlTigwKTt2YXIgbWluU2hlbGw9bnVsbDt2YXIgbWluRW52PW51bGw7Zm9yKHZhciBpPTA7aTxzaGVsbExpc3QubGVuZ3RoO2krKyl7dmFyIHRyeVNoZWxsPXNoZWxsTGlzdFtpXTt2YXIgdHJ5UmluZz10cnlTaGVsbC5nZXRMaW5lYXJSaW5nKCk7dmFyIHRyeUVudj10cnlSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZihtaW5TaGVsbCE9PW51bGwpXG5taW5FbnY9bWluU2hlbGwuZ2V0TGluZWFyUmluZygpLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgaXNDb250YWluZWQ9ZmFsc2U7aWYodHJ5RW52LmNvbnRhaW5zKHRlc3RFbnYpJiZqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNQb2ludEluUmluZyh0ZXN0UHQsdHJ5UmluZy5nZXRDb29yZGluYXRlcygpKSlcbmlzQ29udGFpbmVkPXRydWU7aWYoaXNDb250YWluZWQpe2lmKG1pblNoZWxsPT1udWxsfHxtaW5FbnYuY29udGFpbnModHJ5RW52KSl7bWluU2hlbGw9dHJ5U2hlbGw7fX19XG5yZXR1cm4gbWluU2hlbGw7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlUG9seWdvbnM9ZnVuY3Rpb24oc2hlbGxMaXN0KXt2YXIgcmVzdWx0UG9seUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGk9MDtpPHNoZWxsTGlzdC5sZW5ndGg7aSsrKXt2YXIgZXI9c2hlbGxMaXN0W2ldO3ZhciBwb2x5PWVyLnRvUG9seWdvbih0aGlzLmdlb21ldHJ5RmFjdG9yeSk7cmVzdWx0UG9seUxpc3QuYWRkKHBvbHkpO31cbnJldHVybiByZXN1bHRQb2x5TGlzdDt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9seWdvbkJ1aWxkZXIucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZnVuY3Rpb24ocCl7Zm9yKHZhciBpPTA7aTx0aGlzLnNoZWxsTGlzdC5sZW5ndGg7aSsrKXt2YXIgZXI9dGhpcy5zaGVsbExpc3RbaV07aWYoZXIuY29udGFpbnNQb2ludChwKSlcbnJldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9OyhmdW5jdGlvbigpe3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIExpbmVCdWlsZGVyPWZ1bmN0aW9uKG9wLGdlb21ldHJ5RmFjdG9yeSxwdExvY2F0b3Ipe3RoaXMubGluZUVkZ2VzTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5yZXN1bHRMaW5lTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5vcD1vcDt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnk7dGhpcy5wdExvY2F0b3I9cHRMb2NhdG9yO307TGluZUJ1aWxkZXIucHJvdG90eXBlLm9wPW51bGw7TGluZUJ1aWxkZXIucHJvdG90eXBlLmdlb21ldHJ5RmFjdG9yeT1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtMaW5lQnVpbGRlci5wcm90b3R5cGUubGluZUVkZ2VzTGlzdD1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5yZXN1bHRMaW5lTGlzdD1udWxsO0xpbmVCdWlsZGVyLnByb3RvdHlwZS5idWlsZD1mdW5jdGlvbihvcENvZGUpe3RoaXMuZmluZENvdmVyZWRMaW5lRWRnZXMoKTt0aGlzLmNvbGxlY3RMaW5lcyhvcENvZGUpO3RoaXMuYnVpbGRMaW5lcyhvcENvZGUpO3JldHVybiB0aGlzLnJlc3VsdExpbmVMaXN0O307TGluZUJ1aWxkZXIucHJvdG90eXBlLmZpbmRDb3ZlcmVkTGluZUVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5vcC5nZXRHcmFwaCgpLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTtub2RlLmdldEVkZ2VzKCkuZmluZENvdmVyZWRMaW5lRWRnZXMoKTt9XG5mb3IodmFyIGl0PXRoaXMub3AuZ2V0R3JhcGgoKS5nZXRFZGdlRW5kcygpLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTt2YXIgZT1kZS5nZXRFZGdlKCk7aWYoZGUuaXNMaW5lRWRnZSgpJiYhZS5pc0NvdmVyZWRTZXQoKSl7dmFyIGlzQ292ZXJlZD10aGlzLm9wLmlzQ292ZXJlZEJ5QShkZS5nZXRDb29yZGluYXRlKCkpO2Uuc2V0Q292ZXJlZChpc0NvdmVyZWQpO319fTtMaW5lQnVpbGRlci5wcm90b3R5cGUuY29sbGVjdExpbmVzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBpdD10aGlzLm9wLmdldEdyYXBoKCkuZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dGhpcy5jb2xsZWN0TGluZUVkZ2UoZGUsb3BDb2RlLHRoaXMubGluZUVkZ2VzTGlzdCk7dGhpcy5jb2xsZWN0Qm91bmRhcnlUb3VjaEVkZ2UoZGUsb3BDb2RlLHRoaXMubGluZUVkZ2VzTGlzdCk7fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmNvbGxlY3RMaW5lRWRnZT1mdW5jdGlvbihkZSxvcENvZGUsZWRnZXMpe3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO3ZhciBlPWRlLmdldEVkZ2UoKTtpZihkZS5pc0xpbmVFZGdlKCkpe2lmKCFkZS5pc1Zpc2l0ZWQoKSYmanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wKGxhYmVsLG9wQ29kZSkmJiFlLmlzQ292ZXJlZCgpKXtlZGdlcy5hZGQoZSk7ZGUuc2V0VmlzaXRlZEVkZ2UodHJ1ZSk7fX19O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5jb2xsZWN0Qm91bmRhcnlUb3VjaEVkZ2U9ZnVuY3Rpb24oZGUsb3BDb2RlLGVkZ2VzKXt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTtpZihkZS5pc0xpbmVFZGdlKCkpXG5yZXR1cm47aWYoZGUuaXNWaXNpdGVkKCkpXG5yZXR1cm47aWYoZGUuaXNJbnRlcmlvckFyZWFFZGdlKCkpXG5yZXR1cm47aWYoZGUuZ2V0RWRnZSgpLmlzSW5SZXN1bHQoKSlcbnJldHVybjtBc3NlcnQuaXNUcnVlKCEoZGUuaXNJblJlc3VsdCgpfHxkZS5nZXRTeW0oKS5pc0luUmVzdWx0KCkpfHwhZGUuZ2V0RWRnZSgpLmlzSW5SZXN1bHQoKSk7aWYoanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wKGxhYmVsLG9wQ29kZSkmJm9wQ29kZT09PWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTil7ZWRnZXMuYWRkKGRlLmdldEVkZ2UoKSk7ZGUuc2V0VmlzaXRlZEVkZ2UodHJ1ZSk7fX07TGluZUJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkTGluZXM9ZnVuY3Rpb24ob3BDb2RlKXtmb3IodmFyIGl0PXRoaXMubGluZUVkZ2VzTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO3ZhciBsaW5lPXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcoZS5nZXRDb29yZGluYXRlcygpKTt0aGlzLnJlc3VsdExpbmVMaXN0LmFkZChsaW5lKTtlLnNldEluUmVzdWx0KHRydWUpO319O0xpbmVCdWlsZGVyLnByb3RvdHlwZS5sYWJlbElzb2xhdGVkTGluZXM9ZnVuY3Rpb24oZWRnZXNMaXN0KXtmb3IodmFyIGl0PWVkZ2VzTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGFiZWw9ZS5nZXRMYWJlbCgpO2lmKGUuaXNJc29sYXRlZCgpKXtpZihsYWJlbC5pc051bGwoMCkpXG50aGlzLmxhYmVsSXNvbGF0ZWRMaW5lKGUsMCk7ZWxzZVxudGhpcy5sYWJlbElzb2xhdGVkTGluZShlLDEpO319fTtMaW5lQnVpbGRlci5wcm90b3R5cGUubGFiZWxJc29sYXRlZExpbmU9ZnVuY3Rpb24oZSx0YXJnZXRJbmRleCl7dmFyIGxvYz1wdExvY2F0b3IubG9jYXRlKGUuZ2V0Q29vcmRpbmF0ZSgpLG9wLmdldEFyZ0dlb21ldHJ5KHRhcmdldEluZGV4KSk7ZS5nZXRMYWJlbCgpLnNldExvY2F0aW9uKHRhcmdldEluZGV4LGxvYyk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5LkxpbmVCdWlsZGVyPUxpbmVCdWlsZGVyO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBQb2ludEJ1aWxkZXI9ZnVuY3Rpb24ob3AsZ2VvbWV0cnlGYWN0b3J5LHB0TG9jYXRvcil7dGhpcy5yZXN1bHRQb2ludExpc3Q9bmV3IEFycmF5TGlzdCgpO3RoaXMub3A9b3A7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5O307UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5vcD1udWxsO1BvaW50QnVpbGRlci5wcm90b3R5cGUuZ2VvbWV0cnlGYWN0b3J5PW51bGw7UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5yZXN1bHRQb2ludExpc3Q9bnVsbDtQb2ludEJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkPWZ1bmN0aW9uKG9wQ29kZSl7dGhpcy5leHRyYWN0Tm9uQ292ZXJlZFJlc3VsdE5vZGVzKG9wQ29kZSk7cmV0dXJuIHRoaXMucmVzdWx0UG9pbnRMaXN0O307UG9pbnRCdWlsZGVyLnByb3RvdHlwZS5leHRyYWN0Tm9uQ292ZXJlZFJlc3VsdE5vZGVzPWZ1bmN0aW9uKG9wQ29kZSl7Zm9yKHZhciBub2RlaXQ9dGhpcy5vcC5nZXRHcmFwaCgpLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG49bm9kZWl0Lm5leHQoKTtpZihuLmlzSW5SZXN1bHQoKSlcbmNvbnRpbnVlO2lmKG4uaXNJbmNpZGVudEVkZ2VJblJlc3VsdCgpKVxuY29udGludWU7aWYobi5nZXRFZGdlcygpLmdldERlZ3JlZSgpPT09MHx8b3BDb2RlPT09anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OKXt2YXIgbGFiZWw9bi5nZXRMYWJlbCgpO2lmKGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLmlzUmVzdWx0T2ZPcChsYWJlbCxvcENvZGUpKXt0aGlzLmZpbHRlckNvdmVyZWROb2RlVG9Qb2ludChuKTt9fX19O1BvaW50QnVpbGRlci5wcm90b3R5cGUuZmlsdGVyQ292ZXJlZE5vZGVUb1BvaW50PWZ1bmN0aW9uKG4pe3ZhciBjb29yZD1uLmdldENvb3JkaW5hdGUoKTtpZighdGhpcy5vcC5pc0NvdmVyZWRCeUxBKGNvb3JkKSl7dmFyIHB0PXRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZVBvaW50KGNvb3JkKTt0aGlzLnJlc3VsdFBvaW50TGlzdC5hZGQocHQpO319O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuUG9pbnRCdWlsZGVyPVBvaW50QnVpbGRlcjt9KSgpOyhmdW5jdGlvbigpe3ZhciBQb2ludExvY2F0b3I9anN0cy5hbGdvcml0aG0uUG9pbnRMb2NhdG9yO3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIEVkZ2VMaXN0PWpzdHMuZ2VvbWdyYXBoLkVkZ2VMaXN0O3ZhciBMYWJlbD1qc3RzLmdlb21ncmFwaC5MYWJlbDt2YXIgUGxhbmFyR3JhcGg9anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGg7dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBFZGdlTm9kaW5nVmFsaWRhdG9yPWpzdHMuZ2VvbWdyYXBoLkVkZ2VOb2RpbmdWYWxpZGF0b3I7dmFyIEdlb21ldHJ5R3JhcGhPcGVyYXRpb249anN0cy5vcGVyYXRpb24uR2VvbWV0cnlHcmFwaE9wZXJhdGlvbjt2YXIgT3ZlcmxheU5vZGVGYWN0b3J5PWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5O3ZhciBQb2x5Z29uQnVpbGRlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyO3ZhciBMaW5lQnVpbGRlcj1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LkxpbmVCdWlsZGVyO3ZhciBQb2ludEJ1aWxkZXI9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5Qb2ludEJ1aWxkZXI7dmFyIEFzc2VydD1qc3RzLnV0aWwuQXNzZXJ0O3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcD1mdW5jdGlvbihnMCxnMSl7dGhpcy5wdExvY2F0b3I9bmV3IFBvaW50TG9jYXRvcigpO3RoaXMuZWRnZUxpc3Q9bmV3IEVkZ2VMaXN0KCk7dGhpcy5yZXN1bHRQb2x5TGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5yZXN1bHRMaW5lTGlzdD1uZXcgQXJyYXlMaXN0KCk7dGhpcy5yZXN1bHRQb2ludExpc3Q9bmV3IEFycmF5TGlzdCgpO0dlb21ldHJ5R3JhcGhPcGVyYXRpb24uY2FsbCh0aGlzLGcwLGcxKTt0aGlzLmdyYXBoPW5ldyBQbGFuYXJHcmFwaChuZXcgT3ZlcmxheU5vZGVGYWN0b3J5KCkpO3RoaXMuZ2VvbUZhY3Q9ZzAuZ2V0RmFjdG9yeSgpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlPW5ldyBHZW9tZXRyeUdyYXBoT3BlcmF0aW9uKCk7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuY29uc3RydWN0b3I9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuSU5URVJTRUNUSU9OPTE7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuVU5JT049Mjtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5ESUZGRVJFTkNFPTM7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuU1lNRElGRkVSRU5DRT00O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLm92ZXJsYXlPcD1mdW5jdGlvbihnZW9tMCxnZW9tMSxvcENvZGUpe3ZhciBnb3Y9bmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wKGdlb20wLGdlb20xKTt2YXIgZ2VvbU92PWdvdi5nZXRSZXN1bHRHZW9tZXRyeShvcENvZGUpO3JldHVybiBnZW9tT3Y7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wPWZ1bmN0aW9uKGxhYmVsLG9wQ29kZSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5pc1Jlc3VsdE9mT3AyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgbG9jMD1sYWJlbC5nZXRMb2NhdGlvbigwKTt2YXIgbG9jMT1sYWJlbC5nZXRMb2NhdGlvbigxKTtyZXR1cm4ganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wMihsb2MwLGxvYzEsb3BDb2RlKTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5pc1Jlc3VsdE9mT3AyPWZ1bmN0aW9uKGxvYzAsbG9jMSxvcENvZGUpe2lmKGxvYzA9PUxvY2F0aW9uLkJPVU5EQVJZKVxubG9jMD1Mb2NhdGlvbi5JTlRFUklPUjtpZihsb2MxPT1Mb2NhdGlvbi5CT1VOREFSWSlcbmxvYzE9TG9jYXRpb24uSU5URVJJT1I7c3dpdGNoKG9wQ29kZSl7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5JTlRFUlNFQ1RJT046cmV0dXJuIGxvYzA9PUxvY2F0aW9uLklOVEVSSU9SJiZsb2MxPT1Mb2NhdGlvbi5JTlRFUklPUjtjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OOnJldHVybiBsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUnx8bG9jMT09TG9jYXRpb24uSU5URVJJT1I7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5ESUZGRVJFTkNFOnJldHVybiBsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUiYmbG9jMSE9TG9jYXRpb24uSU5URVJJT1I7Y2FzZSBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5TWU1ESUZGRVJFTkNFOnJldHVybihsb2MwPT1Mb2NhdGlvbi5JTlRFUklPUiYmbG9jMSE9TG9jYXRpb24uSU5URVJJT1IpfHwobG9jMCE9TG9jYXRpb24uSU5URVJJT1ImJmxvYzE9PUxvY2F0aW9uLklOVEVSSU9SKTt9XG5yZXR1cm4gZmFsc2U7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnB0TG9jYXRvcj1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5yZXN1bHRHZW9tPW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmdyYXBoPW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmVkZ2VMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdFBvbHlMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdExpbmVMaXN0PW51bGw7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnJlc3VsdFBvaW50TGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbihmdW5jQ29kZSl7dGhpcy5jb21wdXRlT3ZlcmxheShmdW5jQ29kZSk7cmV0dXJuIHRoaXMucmVzdWx0R2VvbTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0R3JhcGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncmFwaDt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY29tcHV0ZU92ZXJsYXk9ZnVuY3Rpb24ob3BDb2RlKXt0aGlzLmNvcHlQb2ludHMoMCk7dGhpcy5jb3B5UG9pbnRzKDEpO3RoaXMuYXJnWzBdLmNvbXB1dGVTZWxmTm9kZXModGhpcy5saSxmYWxzZSk7dGhpcy5hcmdbMV0uY29tcHV0ZVNlbGZOb2Rlcyh0aGlzLmxpLGZhbHNlKTt0aGlzLmFyZ1swXS5jb21wdXRlRWRnZUludGVyc2VjdGlvbnModGhpcy5hcmdbMV0sdGhpcy5saSx0cnVlKTt2YXIgYmFzZVNwbGl0RWRnZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMuYXJnWzBdLmNvbXB1dGVTcGxpdEVkZ2VzKGJhc2VTcGxpdEVkZ2VzKTt0aGlzLmFyZ1sxXS5jb21wdXRlU3BsaXRFZGdlcyhiYXNlU3BsaXRFZGdlcyk7dmFyIHNwbGl0RWRnZXM9YmFzZVNwbGl0RWRnZXM7dGhpcy5pbnNlcnRVbmlxdWVFZGdlcyhiYXNlU3BsaXRFZGdlcyk7dGhpcy5jb21wdXRlTGFiZWxzRnJvbURlcHRocygpO3RoaXMucmVwbGFjZUNvbGxhcHNlZEVkZ2VzKCk7RWRnZU5vZGluZ1ZhbGlkYXRvci5jaGVja1ZhbGlkKHRoaXMuZWRnZUxpc3QuZ2V0RWRnZXMoKSk7dGhpcy5ncmFwaC5hZGRFZGdlcyh0aGlzLmVkZ2VMaXN0LmdldEVkZ2VzKCkpO3RoaXMuY29tcHV0ZUxhYmVsbGluZygpO3RoaXMubGFiZWxJbmNvbXBsZXRlTm9kZXMoKTt0aGlzLmZpbmRSZXN1bHRBcmVhRWRnZXMob3BDb2RlKTt0aGlzLmNhbmNlbER1cGxpY2F0ZVJlc3VsdEVkZ2VzKCk7dmFyIHBvbHlCdWlsZGVyPW5ldyBQb2x5Z29uQnVpbGRlcih0aGlzLmdlb21GYWN0KTtwb2x5QnVpbGRlci5hZGQodGhpcy5ncmFwaCk7dGhpcy5yZXN1bHRQb2x5TGlzdD1wb2x5QnVpbGRlci5nZXRQb2x5Z29ucygpO3ZhciBsaW5lQnVpbGRlcj1uZXcgTGluZUJ1aWxkZXIodGhpcyx0aGlzLmdlb21GYWN0LHRoaXMucHRMb2NhdG9yKTt0aGlzLnJlc3VsdExpbmVMaXN0PWxpbmVCdWlsZGVyLmJ1aWxkKG9wQ29kZSk7dmFyIHBvaW50QnVpbGRlcj1uZXcgUG9pbnRCdWlsZGVyKHRoaXMsdGhpcy5nZW9tRmFjdCx0aGlzLnB0TG9jYXRvcik7dGhpcy5yZXN1bHRQb2ludExpc3Q9cG9pbnRCdWlsZGVyLmJ1aWxkKG9wQ29kZSk7dGhpcy5yZXN1bHRHZW9tPXRoaXMuY29tcHV0ZUdlb21ldHJ5KHRoaXMucmVzdWx0UG9pbnRMaXN0LHRoaXMucmVzdWx0TGluZUxpc3QsdGhpcy5yZXN1bHRQb2x5TGlzdCxvcENvZGUpO31cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pbnNlcnRVbmlxdWVFZGdlcz1mdW5jdGlvbihlZGdlcyl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt0aGlzLmluc2VydFVuaXF1ZUVkZ2UoZSk7fX1cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pbnNlcnRVbmlxdWVFZGdlPWZ1bmN0aW9uKGUpe3ZhciBleGlzdGluZ0VkZ2U9dGhpcy5lZGdlTGlzdC5maW5kRXF1YWxFZGdlKGUpO2lmKGV4aXN0aW5nRWRnZSE9PW51bGwpe3ZhciBleGlzdGluZ0xhYmVsPWV4aXN0aW5nRWRnZS5nZXRMYWJlbCgpO3ZhciBsYWJlbFRvTWVyZ2U9ZS5nZXRMYWJlbCgpO2lmKCFleGlzdGluZ0VkZ2UuaXNQb2ludHdpc2VFcXVhbChlKSl7bGFiZWxUb01lcmdlPW5ldyBMYWJlbChlLmdldExhYmVsKCkpO2xhYmVsVG9NZXJnZS5mbGlwKCk7fVxudmFyIGRlcHRoPWV4aXN0aW5nRWRnZS5nZXREZXB0aCgpO2lmKGRlcHRoLmlzTnVsbCgpKXtkZXB0aC5hZGQoZXhpc3RpbmdMYWJlbCk7fVxuZGVwdGguYWRkKGxhYmVsVG9NZXJnZSk7ZXhpc3RpbmdMYWJlbC5tZXJnZShsYWJlbFRvTWVyZ2UpO31lbHNle3RoaXMuZWRnZUxpc3QuYWRkKGUpO319O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlTGFiZWxzRnJvbURlcHRocz1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5lZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBlPWl0Lm5leHQoKTt2YXIgbGJsPWUuZ2V0TGFiZWwoKTt2YXIgZGVwdGg9ZS5nZXREZXB0aCgpO2lmKCFkZXB0aC5pc051bGwoKSl7ZGVwdGgubm9ybWFsaXplKCk7Zm9yKHZhciBpPTA7aTwyO2krKyl7aWYoIWxibC5pc051bGwoaSkmJmxibC5pc0FyZWEoKSYmIWRlcHRoLmlzTnVsbChpKSl7aWYoZGVwdGguZ2V0RGVsdGEoaSk9PTApe2xibC50b0xpbmUoaSk7fWVsc2V7QXNzZXJ0LmlzVHJ1ZSghZGVwdGguaXNOdWxsKGksUG9zaXRpb24uTEVGVCksJ2RlcHRoIG9mIExFRlQgc2lkZSBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQnKTtsYmwuc2V0TG9jYXRpb24oaSxQb3NpdGlvbi5MRUZULGRlcHRoLmdldExvY2F0aW9uKGksUG9zaXRpb24uTEVGVCkpO0Fzc2VydC5pc1RydWUoIWRlcHRoLmlzTnVsbChpLFBvc2l0aW9uLlJJR0hUKSwnZGVwdGggb2YgUklHSFQgc2lkZSBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQnKTtsYmwuc2V0TG9jYXRpb24oaSxQb3NpdGlvbi5SSUdIVCxkZXB0aC5nZXRMb2NhdGlvbihpLFBvc2l0aW9uLlJJR0hUKSk7fX19fX19XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUucmVwbGFjZUNvbGxhcHNlZEVkZ2VzPWZ1bmN0aW9uKCl7dmFyIG5ld0VkZ2VzPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGl0PXRoaXMuZWRnZUxpc3QuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZT1pdC5uZXh0KCk7aWYoZS5pc0NvbGxhcHNlZCgpKXtpdC5yZW1vdmUoKTtuZXdFZGdlcy5hZGQoZS5nZXRDb2xsYXBzZWRFZGdlKCkpO319XG50aGlzLmVkZ2VMaXN0LmFkZEFsbChuZXdFZGdlcyk7fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNvcHlQb2ludHM9ZnVuY3Rpb24oYXJnSW5kZXgpe2Zvcih2YXIgaT10aGlzLmFyZ1thcmdJbmRleF0uZ2V0Tm9kZUl0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZ3JhcGhOb2RlPWkubmV4dCgpO3ZhciBuZXdOb2RlPXRoaXMuZ3JhcGguYWRkTm9kZShncmFwaE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTtuZXdOb2RlLnNldExhYmVsKGFyZ0luZGV4LGdyYXBoTm9kZS5nZXRMYWJlbCgpLmdldExvY2F0aW9uKGFyZ0luZGV4KSk7fX1cbmpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlTGFiZWxsaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBub2RlaXQ9dGhpcy5ncmFwaC5nZXROb2RlcygpLml0ZXJhdG9yKCk7bm9kZWl0Lmhhc05leHQoKTspe3ZhciBub2RlPW5vZGVpdC5uZXh0KCk7bm9kZS5nZXRFZGdlcygpLmNvbXB1dGVMYWJlbGxpbmcodGhpcy5hcmcpO31cbnRoaXMubWVyZ2VTeW1MYWJlbHMoKTt0aGlzLnVwZGF0ZU5vZGVMYWJlbGxpbmcoKTt9XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUubWVyZ2VTeW1MYWJlbHM9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVpdD10aGlzLmdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTtub2RlLmdldEVkZ2VzKCkubWVyZ2VTeW1MYWJlbHMoKTt9fVxuanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLnVwZGF0ZU5vZGVMYWJlbGxpbmc9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVpdD10aGlzLmdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtub2RlaXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZWl0Lm5leHQoKTt2YXIgbGJsPW5vZGUuZ2V0RWRnZXMoKS5nZXRMYWJlbCgpO25vZGUuZ2V0TGFiZWwoKS5tZXJnZShsYmwpO319XG5qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUubGFiZWxJbmNvbXBsZXRlTm9kZXM9ZnVuY3Rpb24oKXt2YXIgbm9kZUNvdW50PTA7Zm9yKHZhciBuaT10aGlzLmdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtuaS5oYXNOZXh0KCk7KXt2YXIgbj1uaS5uZXh0KCk7dmFyIGxhYmVsPW4uZ2V0TGFiZWwoKTtpZihuLmlzSXNvbGF0ZWQoKSl7bm9kZUNvdW50Kys7aWYobGFiZWwuaXNOdWxsKDApKVxudGhpcy5sYWJlbEluY29tcGxldGVOb2RlKG4sMCk7ZWxzZVxudGhpcy5sYWJlbEluY29tcGxldGVOb2RlKG4sMSk7fVxubi5nZXRFZGdlcygpLnVwZGF0ZUxhYmVsbGluZyhsYWJlbCk7fX07anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmxhYmVsSW5jb21wbGV0ZU5vZGU9ZnVuY3Rpb24obix0YXJnZXRJbmRleCl7dmFyIGxvYz10aGlzLnB0TG9jYXRvci5sb2NhdGUobi5nZXRDb29yZGluYXRlKCksdGhpcy5hcmdbdGFyZ2V0SW5kZXhdLmdldEdlb21ldHJ5KCkpO24uZ2V0TGFiZWwoKS5zZXRMb2NhdGlvbih0YXJnZXRJbmRleCxsb2MpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmZpbmRSZXN1bHRBcmVhRWRnZXM9ZnVuY3Rpb24ob3BDb2RlKXtmb3IodmFyIGl0PXRoaXMuZ3JhcGguZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7aWYobGFiZWwuaXNBcmVhKCkmJiFkZS5pc0ludGVyaW9yQXJlYUVkZ2UoKSYmanN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuaXNSZXN1bHRPZk9wKGxhYmVsLmdldExvY2F0aW9uKDAsUG9zaXRpb24uUklHSFQpLGxhYmVsLmdldExvY2F0aW9uKDEsUG9zaXRpb24uUklHSFQpLG9wQ29kZSkpe2RlLnNldEluUmVzdWx0KHRydWUpO319fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuY2FuY2VsRHVwbGljYXRlUmVzdWx0RWRnZXM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuZ3JhcGguZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihkZS5pc0luUmVzdWx0KCkmJnN5bS5pc0luUmVzdWx0KCkpe2RlLnNldEluUmVzdWx0KGZhbHNlKTtzeW0uc2V0SW5SZXN1bHQoZmFsc2UpO319fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUuaXNDb3ZlcmVkQnlMQT1mdW5jdGlvbihjb29yZCl7aWYodGhpcy5pc0NvdmVyZWQoY29vcmQsdGhpcy5yZXN1bHRMaW5lTGlzdCkpXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLmlzQ292ZXJlZChjb29yZCx0aGlzLnJlc3VsdFBvbHlMaXN0KSlcbnJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5pc0NvdmVyZWRCeUE9ZnVuY3Rpb24oY29vcmQpe2lmKHRoaXMuaXNDb3ZlcmVkKGNvb3JkLHRoaXMucmVzdWx0UG9seUxpc3QpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmlzQ292ZXJlZD1mdW5jdGlvbihjb29yZCxnZW9tTGlzdCl7Zm9yKHZhciBpdD1nZW9tTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBnZW9tPWl0Lm5leHQoKTt2YXIgbG9jPXRoaXMucHRMb2NhdG9yLmxvY2F0ZShjb29yZCxnZW9tKTtpZihsb2MhPUxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AucHJvdG90eXBlLmNvbXB1dGVHZW9tZXRyeT1mdW5jdGlvbihyZXN1bHRQb2ludExpc3QscmVzdWx0TGluZUxpc3QscmVzdWx0UG9seUxpc3Qsb3Bjb2RlKXt2YXIgZ2VvbUxpc3Q9bmV3IEFycmF5TGlzdCgpO2dlb21MaXN0LmFkZEFsbChyZXN1bHRQb2ludExpc3QpO2dlb21MaXN0LmFkZEFsbChyZXN1bHRMaW5lTGlzdCk7Z2VvbUxpc3QuYWRkQWxsKHJlc3VsdFBvbHlMaXN0KTtyZXR1cm4gdGhpcy5nZW9tRmFjdC5idWlsZEdlb21ldHJ5KGdlb21MaXN0KTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLnByb3RvdHlwZS5jcmVhdGVFbXB0eVJlc3VsdD1mdW5jdGlvbihvcENvZGUpe3ZhciByZXN1bHQ9bnVsbDtzd2l0Y2gocmVzdWx0RGltZW5zaW9uKG9wQ29kZSx0aGlzLmFyZ1swXS5nZXRHZW9tZXRyeSgpLHRoaXMuYXJnWzFdLmdldEdlb21ldHJ5KCkpKXtjYXNlLTE6cmVzdWx0PWdlb21GYWN0LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbigpO2JyZWFrO2Nhc2UgMDpyZXN1bHQ9Z2VvbUZhY3QuY3JlYXRlUG9pbnQobnVsbCk7YnJlYWs7Y2FzZSAxOnJlc3VsdD1nZW9tRmFjdC5jcmVhdGVMaW5lU3RyaW5nKG51bGwpO2JyZWFrO2Nhc2UgMjpyZXN1bHQ9Z2VvbUZhY3QuY3JlYXRlUG9seWdvbihudWxsLG51bGwpO2JyZWFrO31cbnJldHVybiByZXN1bHQ7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcC5wcm90b3R5cGUucmVzdWx0RGltZW5zaW9uPWZ1bmN0aW9uKG9wQ29kZSxnMCxnMSl7dmFyIGRpbTA9ZzAuZ2V0RGltZW5zaW9uKCk7dmFyIGRpbTE9ZzEuZ2V0RGltZW5zaW9uKCk7dmFyIHJlc3VsdERpbWVuc2lvbj0tMTtzd2l0Y2gob3BDb2RlKXtjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLklOVEVSU0VDVElPTjpyZXN1bHREaW1lbnNpb249TWF0aC5taW4oZGltMCxkaW0xKTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlVOSU9OOnJlc3VsdERpbWVuc2lvbj1NYXRoLm1heChkaW0wLGRpbTEpO2JyZWFrO2Nhc2UganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3AuRElGRkVSRU5DRTpyZXN1bHREaW1lbnNpb249ZGltMDticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0U6cmVzdWx0RGltZW5zaW9uPU1hdGgubWF4KGRpbTAsZGltMSk7YnJlYWs7fVxucmV0dXJuIHJlc3VsdERpbWVuc2lvbjt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIE92ZXJsYXlPcD1qc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk92ZXJsYXlPcDt2YXIgR2VvbWV0cnlTbmFwcGVyPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5HZW9tZXRyeVNuYXBwZXI7dmFyIFNuYXBPdmVybGF5T3A9ZnVuY3Rpb24oZzEsZzIpe3RoaXMuZ2VvbT1bXTt0aGlzLmdlb21bMF09ZzE7dGhpcy5nZW9tWzFdPWcyO3RoaXMuY29tcHV0ZVNuYXBUb2xlcmFuY2UoKTt9O1NuYXBPdmVybGF5T3Aub3ZlcmxheU9wPWZ1bmN0aW9uKGcwLGcxLG9wQ29kZSl7dmFyIG9wPW5ldyBTbmFwT3ZlcmxheU9wKGcwLGcxKTtyZXR1cm4gb3AuZ2V0UmVzdWx0R2VvbWV0cnkob3BDb2RlKTt9O1NuYXBPdmVybGF5T3AuaW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gdGhpcy5vdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLklOVEVSU0VDVElPTik7fTtTbmFwT3ZlcmxheU9wLnVuaW9uPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gdGhpcy5vdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlVOSU9OKTt9O1NuYXBPdmVybGF5T3AuZGlmZmVyZW5jZT1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIG92ZXJsYXlPcChnMCxnMSxPdmVybGF5T3AuRElGRkVSRU5DRSk7fTtTbmFwT3ZlcmxheU9wLnN5bURpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0UpO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuZ2VvbT1udWxsO1NuYXBPdmVybGF5T3AucHJvdG90eXBlLnNuYXBUb2xlcmFuY2U9bnVsbDtTbmFwT3ZlcmxheU9wLnByb3RvdHlwZS5jb21wdXRlU25hcFRvbGVyYW5jZT1mdW5jdGlvbigpe3RoaXMuc25hcFRvbGVyYW5jZT1HZW9tZXRyeVNuYXBwZXIuY29tcHV0ZU92ZXJsYXlTbmFwVG9sZXJhbmNlKHRoaXMuZ2VvbVswXSx0aGlzLmdlb21bMV0pO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuZ2V0UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24ob3BDb2RlKXt2YXIgcHJlcEdlb209dGhpcy5zbmFwKHRoaXMuZ2VvbSk7dmFyIHJlc3VsdD1PdmVybGF5T3Aub3ZlcmxheU9wKHByZXBHZW9tWzBdLHByZXBHZW9tWzFdLG9wQ29kZSk7cmV0dXJuIHRoaXMucHJlcGFyZVJlc3VsdChyZXN1bHQpO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuc2VsZlNuYXA9ZnVuY3Rpb24oZ2VvbSl7dmFyIHNuYXBwZXIwPW5ldyBHZW9tZXRyeVNuYXBwZXIoZ2VvbSk7dmFyIHNuYXBHZW9tPXNuYXBwZXIwLnNuYXBUbyhnZW9tLHRoaXMuc25hcFRvbGVyYW5jZSk7cmV0dXJuIHNuYXBHZW9tO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuc25hcD1mdW5jdGlvbihnZW9tKXt2YXIgcmVtR2VvbT1nZW9tO3ZhciBzbmFwR2VvbT1HZW9tZXRyeVNuYXBwZXIuc25hcChyZW1HZW9tWzBdLHJlbUdlb21bMV0sdGhpcy5zbmFwVG9sZXJhbmNlKTtyZXR1cm4gc25hcEdlb207fTtTbmFwT3ZlcmxheU9wLnByb3RvdHlwZS5wcmVwYXJlUmVzdWx0PWZ1bmN0aW9uKGdlb20pe3JldHVybiBnZW9tO307U25hcE92ZXJsYXlPcC5wcm90b3R5cGUuY2JyPW51bGw7U25hcE92ZXJsYXlPcC5wcm90b3R5cGUucmVtb3ZlQ29tbW9uQml0cz1mdW5jdGlvbihnZW9tKXt0aGlzLmNicj1uZXcganN0cy5wcmVjaXNpb24uQ29tbW9uQml0c1JlbW92ZXIoKTt0aGlzLmNici5hZGQodGhpcy5nZW9tWzBdKTt0aGlzLmNici5hZGQodGhpcy5nZW9tWzFdKTt2YXIgcmVtR2VvbT1bXTtyZW1HZW9tWzBdPWNici5yZW1vdmVDb21tb25CaXRzKHRoaXMuZ2VvbVswXS5jbG9uZSgpKTtyZW1HZW9tWzFdPWNici5yZW1vdmVDb21tb25CaXRzKHRoaXMuZ2VvbVsxXS5jbG9uZSgpKTtyZXR1cm4gcmVtR2VvbTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuc25hcC5TbmFwT3ZlcmxheU9wPVNuYXBPdmVybGF5T3A7fSkoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LkVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tZ3JhcGguaW5kZXguRWRnZVNldEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczI9ZnVuY3Rpb24oZWRnZXMwLGVkZ2VzMSxzaSl7dGhyb3cgbmV3IGpzdHMuZXJyb3IuQWJzdHJhY3RNZXRob2RJbnZvY2F0aW9uRXJyb3IoKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cz1bXTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5ldmVudHM9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5uT3ZlcmxhcHM9MDtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihlZGdlcyxzaSx0ZXN0QWxsU2VnbWVudHMpe2lmKHNpIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxuaWYodGVzdEFsbFNlZ21lbnRzKXt0aGlzLmFkZExpc3QyKGVkZ2VzLG51bGwpO31lbHNle3RoaXMuYWRkTGlzdChlZGdlcyk7fVxudGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczMoc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMyPWZ1bmN0aW9uKGVkZ2VzMCxlZGdlczEsc2kpe3RoaXMuYWRkTGlzdDIoZWRnZXMwLGVkZ2VzMCk7dGhpcy5hZGRMaXN0MihlZGdlczEsZWRnZXMxKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMyhzaSk7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZWRnZSxlZGdlU2V0KXtpZihlZGdlIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuYWRkTGlzdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBtY2U9ZWRnZS5nZXRNb25vdG9uZUNoYWluRWRnZSgpO3ZhciBzdGFydEluZGV4PW1jZS5nZXRTdGFydEluZGV4ZXMoKTtmb3IodmFyIGk9MDtpPHN0YXJ0SW5kZXgubGVuZ3RoLTE7aSsrKXt2YXIgbWM9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW4obWNlLGkpO3ZhciBpbnNlcnRFdmVudD1uZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQobWNlLmdldE1pblgoaSksbWMsZWRnZVNldCk7dGhpcy5ldmVudHMucHVzaChpbnNlcnRFdmVudCk7dGhpcy5ldmVudHMucHVzaChuZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQobWNlLmdldE1heFgoaSksaW5zZXJ0RXZlbnQpKTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVNQ1N3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5hZGRMaXN0PWZ1bmN0aW9uKGVkZ2VzKXtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlZGdlPWkubmV4dCgpO3RoaXMuYWRkKGVkZ2UsZWRnZSk7fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkTGlzdDI9ZnVuY3Rpb24oZWRnZXMsZWRnZVNldCl7Zm9yKHZhciBpPWVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWRnZT1pLm5leHQoKTt0aGlzLmFkZChlZGdlLGVkZ2VTZXQpO319O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZU1DU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByZXBhcmVFdmVudHM9ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO2Zvcih2YXIgaT0wO2k8dGhpcy5ldmVudHMubGVuZ3RoO2krKyl7dmFyIGV2PXRoaXMuZXZlbnRzW2ldO2lmKGV2LmlzRGVsZXRlKCkpe2V2LmdldEluc2VydEV2ZW50KCkuc2V0RGVsZXRlRXZlbnRJbmRleChpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnMzPWZ1bmN0aW9uKHNpKXt0aGlzLm5PdmVybGFwcz0wO3RoaXMucHJlcGFyZUV2ZW50cygpO2Zvcih2YXIgaT0wO2k8dGhpcy5ldmVudHMubGVuZ3RoO2krKyl7dmFyIGV2PXRoaXMuZXZlbnRzW2ldO2lmKGV2LmlzSW5zZXJ0KCkpe3RoaXMucHJvY2Vzc092ZXJsYXBzKGksZXYuZ2V0RGVsZXRlRXZlbnRJbmRleCgpLGV2LHNpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUucHJvY2Vzc092ZXJsYXBzPWZ1bmN0aW9uKHN0YXJ0LGVuZCxldjAsc2kpe3ZhciBtYzA9ZXYwLmdldE9iamVjdCgpO2Zvcih2YXIgaT1zdGFydDtpPGVuZDtpKyspe3ZhciBldjE9dGhpcy5ldmVudHNbaV07aWYoZXYxLmlzSW5zZXJ0KCkpe3ZhciBtYzE9ZXYxLmdldE9iamVjdCgpO2lmKCFldjAuaXNTYW1lTGFiZWwoZXYxKSl7bWMwLmNvbXB1dGVJbnRlcnNlY3Rpb25zKG1jMSxzaSk7dGhpcy5uT3ZlcmxhcHMrKzt9fX19O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3I9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5nZW9tPWdlb207fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmxvY2F0ZT1mdW5jdGlvbihwLGdlb20pe2lmKGdlb20uaXNFbXB0eSgpKVxucmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjtpZihqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnQocCxnZW9tKSlcbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7cmV0dXJuIGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUjt9O2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuY29udGFpbnNQb2ludD1mdW5jdGlvbihwLGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuY29udGFpbnNQb2ludEluUG9seWdvbihwLGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7Zm9yKHZhciBpPTA7aTxnZW9tLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7dmFyIGcyPWdlb20uZ2VvbWV0cmllc1tpXTtpZihnMiE9PWdlb20pXG5pZihqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnQocCxnMikpXG5yZXR1cm4gdHJ1ZTt9fVxucmV0dXJuIGZhbHNlO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5jb250YWluc1BvaW50SW5Qb2x5Z29uPWZ1bmN0aW9uKHAscG9seSl7aWYocG9seS5pc0VtcHR5KCkpXG5yZXR1cm4gZmFsc2U7dmFyIHNoZWxsPXBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCk7aWYoIWpzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IuaXNQb2ludEluUmluZyhwLHNoZWxsKSlcbnJldHVybiBmYWxzZTtmb3IodmFyIGk9MDtpPHBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT1wb2x5LmdldEludGVyaW9yUmluZ04oaSk7aWYoanN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5pc1BvaW50SW5SaW5nKHAsaG9sZSkpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmFsZ29yaXRobS5sb2NhdGUuU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmlzUG9pbnRJblJpbmc9ZnVuY3Rpb24ocCxyaW5nKXtpZighcmluZy5nZXRFbnZlbG9wZUludGVybmFsKCkuaW50ZXJzZWN0cyhwKSlcbnJldHVybiBmYWxzZTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcocCxyaW5nLmdldENvb3JkaW5hdGVzKCkpO307anN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5wcm90b3R5cGUuZ2VvbT1udWxsO2pzdHMuYWxnb3JpdGhtLmxvY2F0ZS5TaW1wbGVQb2ludEluQXJlYUxvY2F0b3IucHJvdG90eXBlLmxvY2F0ZT1mdW5jdGlvbihwKXtyZXR1cm4ganN0cy5hbGdvcml0aG0ubG9jYXRlLlNpbXBsZVBvaW50SW5BcmVhTG9jYXRvci5sb2NhdGUocCxnZW9tKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBFZGdlRW5kU3Rhcj1qc3RzLmdlb21ncmFwaC5FZGdlRW5kU3Rhcjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhcj1mdW5jdGlvbigpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmRTdGFyLmNhbGwodGhpcyk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZT1uZXcgRWRnZUVuZFN0YXIoKTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXI7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUucmVzdWx0QXJlYUVkZ2VMaXN0PW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGFiZWw9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oZWUpe3ZhciBkZT1lZTt0aGlzLmluc2VydEVkZ2VFbmQoZGUsZGUpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0TGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldE91dGdvaW5nRGVncmVlPWZ1bmN0aW9uKCl7dmFyIGRlZ3JlZT0wO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuaXNJblJlc3VsdCgpKVxuZGVncmVlKys7fVxucmV0dXJuIGRlZ3JlZTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldE91dGdvaW5nRGVncmVlPWZ1bmN0aW9uKGVyKXt2YXIgZGVncmVlPTA7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtpZihkZS5nZXRFZGdlUmluZygpPT09ZXIpXG5kZWdyZWUrKzt9XG5yZXR1cm4gZGVncmVlO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuZ2V0UmlnaHRtb3N0RWRnZT1mdW5jdGlvbigpe3ZhciBlZGdlcz10aGlzLmdldEVkZ2VzKCk7dmFyIHNpemU9ZWRnZXMuc2l6ZSgpO2lmKHNpemU8MSlcbnJldHVybiBudWxsO3ZhciBkZTA9ZWRnZXMuZ2V0KDApO2lmKHNpemU9PTEpXG5yZXR1cm4gZGUwO3ZhciBkZUxhc3Q9ZWRnZXMuZ2V0KHNpemUtMSk7dmFyIHF1YWQwPWRlMC5nZXRRdWFkcmFudCgpO3ZhciBxdWFkMT1kZUxhc3QuZ2V0UXVhZHJhbnQoKTtpZihqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc05vcnRoZXJuKHF1YWQwKSYmanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNOb3J0aGVybihxdWFkMSkpXG5yZXR1cm4gZGUwO2Vsc2UgaWYoIWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm4ocXVhZDApJiYhanN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuaXNOb3J0aGVybihxdWFkMSkpXG5yZXR1cm4gZGVMYXN0O2Vsc2V7dmFyIG5vbkhvcml6b250YWxFZGdlPW51bGw7aWYoZGUwLmdldER5KCkhPTApXG5yZXR1cm4gZGUwO2Vsc2UgaWYoZGVMYXN0LmdldER5KCkhPTApXG5yZXR1cm4gZGVMYXN0O31cbkFzc2VydC5zaG91bGROZXZlclJlYWNoSGVyZSgnZm91bmQgdHdvIGhvcml6b250YWwgZWRnZXMgaW5jaWRlbnQgb24gbm9kZScpO3JldHVybiBudWxsO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZz1mdW5jdGlvbihnZW9tKXtFZGdlRW5kU3Rhci5wcm90b3R5cGUuY29tcHV0ZUxhYmVsbGluZy5jYWxsKHRoaXMsZ2VvbSk7dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoTG9jYXRpb24uTk9ORSk7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGVlPWl0Lm5leHQoKTt2YXIgZT1lZS5nZXRFZGdlKCk7dmFyIGVMYWJlbD1lLmdldExhYmVsKCk7Zm9yKHZhciBpPTA7aTwyO2krKyl7dmFyIGVMb2M9ZUxhYmVsLmdldExvY2F0aW9uKGkpO2lmKGVMb2M9PT1Mb2NhdGlvbi5JTlRFUklPUnx8ZUxvYz09PUxvY2F0aW9uLkJPVU5EQVJZKVxudGhpcy5sYWJlbC5zZXRMb2NhdGlvbihpLExvY2F0aW9uLklOVEVSSU9SKTt9fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubWVyZ2VTeW1MYWJlbHM9ZnVuY3Rpb24oKXtmb3IodmFyIGl0PXRoaXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO3ZhciBsYWJlbD1kZS5nZXRMYWJlbCgpO2xhYmVsLm1lcmdlKGRlLmdldFN5bSgpLmdldExhYmVsKCkpO319O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLnVwZGF0ZUxhYmVsbGluZz1mdW5jdGlvbihub2RlTGFiZWwpe2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7dmFyIGxhYmVsPWRlLmdldExhYmVsKCk7bGFiZWwuc2V0QWxsTG9jYXRpb25zSWZOdWxsKDAsbm9kZUxhYmVsLmdldExvY2F0aW9uKDApKTtsYWJlbC5zZXRBbGxMb2NhdGlvbnNJZk51bGwoMSxub2RlTGFiZWwuZ2V0TG9jYXRpb24oMSkpO319O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmdldFJlc3VsdEFyZWFFZGdlcz1mdW5jdGlvbigpe2lmKHRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0IT09bnVsbClcbnJldHVybiB0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdDt0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuaXNJblJlc3VsdCgpfHxkZS5nZXRTeW0oKS5pc0luUmVzdWx0KCkpXG50aGlzLnJlc3VsdEFyZWFFZGdlTGlzdC5hZGQoZGUpO31cbnJldHVybiB0aGlzLnJlc3VsdEFyZWFFZGdlTGlzdDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLlNDQU5OSU5HX0ZPUl9JTkNPTUlORz0xO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLkxJTktJTkdfVE9fT1VUR09JTkc9Mjtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcz1mdW5jdGlvbigpe3RoaXMuZ2V0UmVzdWx0QXJlYUVkZ2VzKCk7dmFyIGZpcnN0T3V0PW51bGw7dmFyIGluY29taW5nPW51bGw7dmFyIHN0YXRlPXRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HO2Zvcih2YXIgaT0wO2k8dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Quc2l6ZSgpO2krKyl7dmFyIG5leHRPdXQ9dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3QuZ2V0KGkpO3ZhciBuZXh0SW49bmV4dE91dC5nZXRTeW0oKTtpZighbmV4dE91dC5nZXRMYWJlbCgpLmlzQXJlYSgpKVxuY29udGludWU7aWYoZmlyc3RPdXQ9PT1udWxsJiZuZXh0T3V0LmlzSW5SZXN1bHQoKSlcbmZpcnN0T3V0PW5leHRPdXQ7c3dpdGNoKHN0YXRlKXtjYXNlIHRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HOmlmKCFuZXh0SW4uaXNJblJlc3VsdCgpKVxuY29udGludWU7aW5jb21pbmc9bmV4dEluO3N0YXRlPXRoaXMuTElOS0lOR19UT19PVVRHT0lORzticmVhaztjYXNlIHRoaXMuTElOS0lOR19UT19PVVRHT0lORzppZighbmV4dE91dC5pc0luUmVzdWx0KCkpXG5jb250aW51ZTtpbmNvbWluZy5zZXROZXh0KG5leHRPdXQpO3N0YXRlPXRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HO2JyZWFrO319XG5pZihzdGF0ZT09PXRoaXMuTElOS0lOR19UT19PVVRHT0lORyl7aWYoZmlyc3RPdXQ9PT1udWxsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignbm8gb3V0Z29pbmcgZGlyRWRnZSBmb3VuZCcsdGhpcy5nZXRDb29yZGluYXRlKCkpO0Fzc2VydC5pc1RydWUoZmlyc3RPdXQuaXNJblJlc3VsdCgpLCd1bmFibGUgdG8gbGluayBsYXN0IGluY29taW5nIGRpckVkZ2UnKTtpbmNvbWluZy5zZXROZXh0KGZpcnN0T3V0KTt9fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5saW5rTWluaW1hbERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oZXIpe3ZhciBmaXJzdE91dD1udWxsO3ZhciBpbmNvbWluZz1udWxsO3ZhciBzdGF0ZT10aGlzLlNDQU5OSU5HX0ZPUl9JTkNPTUlORztmb3IodmFyIGk9dGhpcy5yZXN1bHRBcmVhRWRnZUxpc3Quc2l6ZSgpLTE7aT49MDtpLS0pe3ZhciBuZXh0T3V0PXRoaXMucmVzdWx0QXJlYUVkZ2VMaXN0LmdldChpKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoZmlyc3RPdXQ9PT1udWxsJiZuZXh0T3V0LmdldEVkZ2VSaW5nKCk9PT1lcilcbmZpcnN0T3V0PW5leHRPdXQ7c3dpdGNoKHN0YXRlKXtjYXNlIHRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HOmlmKG5leHRJbi5nZXRFZGdlUmluZygpIT1lcilcbmNvbnRpbnVlO2luY29taW5nPW5leHRJbjtzdGF0ZT10aGlzLkxJTktJTkdfVE9fT1VUR09JTkc7YnJlYWs7Y2FzZSB0aGlzLkxJTktJTkdfVE9fT1VUR09JTkc6aWYobmV4dE91dC5nZXRFZGdlUmluZygpIT09ZXIpXG5jb250aW51ZTtpbmNvbWluZy5zZXROZXh0TWluKG5leHRPdXQpO3N0YXRlPXRoaXMuU0NBTk5JTkdfRk9SX0lOQ09NSU5HO2JyZWFrO319XG5pZihzdGF0ZT09PXRoaXMuTElOS0lOR19UT19PVVRHT0lORyl7QXNzZXJ0LmlzVHJ1ZShmaXJzdE91dCE9PW51bGwsJ2ZvdW5kIG51bGwgZm9yIGZpcnN0IG91dGdvaW5nIGRpckVkZ2UnKTtBc3NlcnQuaXNUcnVlKGZpcnN0T3V0LmdldEVkZ2VSaW5nKCk9PT1lciwndW5hYmxlIHRvIGxpbmsgbGFzdCBpbmNvbWluZyBkaXJFZGdlJyk7aW5jb21pbmcuc2V0TmV4dE1pbihmaXJzdE91dCk7fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUubGlua0FsbERpcmVjdGVkRWRnZXM9ZnVuY3Rpb24oKXt0aGlzLmdldEVkZ2VzKCk7dmFyIHByZXZPdXQ9bnVsbDt2YXIgZmlyc3RJbj1udWxsO2Zvcih2YXIgaT10aGlzLmVkZ2VMaXN0LnNpemUoKS0xO2k+PTA7aS0tKXt2YXIgbmV4dE91dD10aGlzLmVkZ2VMaXN0LmdldChpKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoZmlyc3RJbj09PW51bGwpXG5maXJzdEluPW5leHRJbjtpZihwcmV2T3V0IT09bnVsbClcbm5leHRJbi5zZXROZXh0KHByZXZPdXQpO3ByZXZPdXQ9bmV4dE91dDt9XG5maXJzdEluLnNldE5leHQocHJldk91dCk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2VTdGFyLnByb3RvdHlwZS5maW5kQ292ZXJlZExpbmVFZGdlcz1mdW5jdGlvbigpe3ZhciBzdGFydExvYz1Mb2NhdGlvbi5OT05FO2Zvcih2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBuZXh0T3V0PWl0Lm5leHQoKTt2YXIgbmV4dEluPW5leHRPdXQuZ2V0U3ltKCk7aWYoIW5leHRPdXQuaXNMaW5lRWRnZSgpKXtpZihuZXh0T3V0LmlzSW5SZXN1bHQoKSl7c3RhcnRMb2M9TG9jYXRpb24uSU5URVJJT1I7YnJlYWs7fVxuaWYobmV4dEluLmlzSW5SZXN1bHQoKSl7c3RhcnRMb2M9TG9jYXRpb24uRVhURVJJT1I7YnJlYWs7fX19XG5pZihzdGFydExvYz09PUxvY2F0aW9uLk5PTkUpXG5yZXR1cm47dmFyIGN1cnJMb2M9c3RhcnRMb2M7Zm9yKHZhciBpdD10aGlzLml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIG5leHRPdXQ9aXQubmV4dCgpO3ZhciBuZXh0SW49bmV4dE91dC5nZXRTeW0oKTtpZihuZXh0T3V0LmlzTGluZUVkZ2UoKSl7bmV4dE91dC5nZXRFZGdlKCkuc2V0Q292ZXJlZChjdXJyTG9jPT09TG9jYXRpb24uSU5URVJJT1IpO31lbHNle2lmKG5leHRPdXQuaXNJblJlc3VsdCgpKVxuY3VyckxvYz1Mb2NhdGlvbi5FWFRFUklPUjtpZihuZXh0SW4uaXNJblJlc3VsdCgpKVxuY3VyckxvYz1Mb2NhdGlvbi5JTlRFUklPUjt9fX07anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlU3Rhci5wcm90b3R5cGUuY29tcHV0ZURlcHRocz1mdW5jdGlvbihkZSl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuY29tcHV0ZURlcHRoczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgZWRnZUluZGV4PXRoaXMuZmluZEluZGV4KGRlKTt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTt2YXIgc3RhcnREZXB0aD1kZS5nZXREZXB0aChQb3NpdGlvbi5MRUZUKTt2YXIgdGFyZ2V0TGFzdERlcHRoPWRlLmdldERlcHRoKFBvc2l0aW9uLlJJR0hUKTt2YXIgbmV4dERlcHRoPXRoaXMuY29tcHV0ZURlcHRoczIoZWRnZUluZGV4KzEsdGhpcy5lZGdlTGlzdC5zaXplKCksc3RhcnREZXB0aCk7dmFyIGxhc3REZXB0aD10aGlzLmNvbXB1dGVEZXB0aHMyKDAsZWRnZUluZGV4LG5leHREZXB0aCk7aWYobGFzdERlcHRoIT10YXJnZXRMYXN0RGVwdGgpXG50aHJvdyBuZXcganN0cy5lcnJvci5Ub3BvbG9neUVycm9yKCdkZXB0aCBtaXNtYXRjaCBhdCAnK1xuZGUuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZVN0YXIucHJvdG90eXBlLmNvbXB1dGVEZXB0aHMyPWZ1bmN0aW9uKHN0YXJ0SW5kZXgsZW5kSW5kZXgsc3RhcnREZXB0aCl7dmFyIGN1cnJEZXB0aD1zdGFydERlcHRoO2Zvcih2YXIgaT1zdGFydEluZGV4O2k8ZW5kSW5kZXg7aSsrKXt2YXIgbmV4dERlPXRoaXMuZWRnZUxpc3QuZ2V0KGkpO3ZhciBsYWJlbD1uZXh0RGUuZ2V0TGFiZWwoKTtuZXh0RGUuc2V0RWRnZURlcHRocyhQb3NpdGlvbi5SSUdIVCxjdXJyRGVwdGgpO2N1cnJEZXB0aD1uZXh0RGUuZ2V0RGVwdGgoUG9zaXRpb24uTEVGVCk7fVxucmV0dXJuIGN1cnJEZXB0aDt9O30pKCk7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lPWZ1bmN0aW9uKCl7dGhpcy5jZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5jZW50U3VtPW51bGw7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS50b3RhbExlbmd0aD0wLjA7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIEFycmF5KXt0aGlzLmFkZDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5pZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3RoaXMuYWRkKGdlb20uZ2V0Q29vcmRpbmF0ZXMoKSk7fWVsc2UgaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXt2YXIgcG9seT1nZW9tO3RoaXMuYWRkKHBvbHkuZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKSk7Zm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5hZGQocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpLmdldENvb3JkaW5hdGVzKCkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2MuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5nZXRDZW50cm9pZD1mdW5jdGlvbigpe3ZhciBjZW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2NlbnQueD10aGlzLmNlbnRTdW0ueC90aGlzLnRvdGFsTGVuZ3RoO2NlbnQueT10aGlzLmNlbnRTdW0ueS90aGlzLnRvdGFsTGVuZ3RoO3JldHVybiBjZW50O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRMaW5lLnByb3RvdHlwZS5hZGQyPWZ1bmN0aW9uKHB0cyl7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt2YXIgc2VnbWVudExlbj1wdHNbaV0uZGlzdGFuY2UocHRzW2krMV0pO3RoaXMudG90YWxMZW5ndGgrPXNlZ21lbnRMZW47dmFyIG1pZHg9KHB0c1tpXS54K3B0c1tpKzFdLngpLzI7dGhpcy5jZW50U3VtLngrPXNlZ21lbnRMZW4qbWlkeDt2YXIgbWlkeT0ocHRzW2ldLnkrcHRzW2krMV0ueSkvMjt0aGlzLmNlbnRTdW0ueSs9c2VnbWVudExlbiptaWR5O319O2pzdHMuaW5kZXguSW50ZXJ2YWxTaXplPWZ1bmN0aW9uKCl7fTtqc3RzLmluZGV4LkludGVydmFsU2l6ZS5NSU5fQklOQVJZX0VYUE9ORU5UPS01MDtqc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aD1mdW5jdGlvbihtaW4sbWF4KXt2YXIgd2lkdGg9bWF4LW1pbjtpZih3aWR0aD09PTAuMCl7cmV0dXJuIHRydWU7fVxudmFyIG1heEFicyxzY2FsZWRJbnRlcnZhbCxsZXZlbDttYXhBYnM9TWF0aC5tYXgoTWF0aC5hYnMobWluKSxNYXRoLmFicyhtYXgpKTtzY2FsZWRJbnRlcnZhbD13aWR0aC9tYXhBYnM7bGV2ZWw9anN0cy5pbmRleC5Eb3VibGVCaXRzLmV4cG9uZW50KHNjYWxlZEludGVydmFsKTtyZXR1cm4gbGV2ZWw8PWpzdHMuaW5kZXguSW50ZXJ2YWxTaXplLk1JTl9CSU5BUllfRVhQT05FTlQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3I9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LkVkZ2VTZXRJbnRlcnNlY3RvcigpO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUubk92ZXJsYXBzPTA7anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlRWRnZVNldEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihlZGdlcyxzaSx0ZXN0QWxsU2VnbWVudHMpe2lmKHNpIGluc3RhbmNlb2YgamF2YXNjcmlwdC51dGlsLkxpc3Qpe3RoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudGhpcy5uT3ZlcmxhcHM9MDtmb3IodmFyIGkwPWVkZ2VzLml0ZXJhdG9yKCk7aTAuaGFzTmV4dCgpOyl7dmFyIGVkZ2UwPWkwLm5leHQoKTtmb3IodmFyIGkxPWVkZ2VzLml0ZXJhdG9yKCk7aTEuaGFzTmV4dCgpOyl7dmFyIGVkZ2UxPWkxLm5leHQoKTtpZih0ZXN0QWxsU2VnbWVudHN8fGVkZ2UwIT1lZGdlMSlcbnRoaXMuY29tcHV0ZUludGVyc2VjdHMoZWRnZTAsZWRnZTEsc2kpO319fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVFZGdlU2V0SW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMj1mdW5jdGlvbihlZGdlczAsZWRnZXMxLHNpKXt0aGlzLm5PdmVybGFwcz0wO2Zvcih2YXIgaTA9ZWRnZXMwLml0ZXJhdG9yKCk7aTAuaGFzTmV4dCgpOyl7dmFyIGVkZ2UwPWkwLm5leHQoKTtmb3IodmFyIGkxPWVkZ2VzMS5pdGVyYXRvcigpO2kxLmhhc05leHQoKTspe3ZhciBlZGdlMT1pMS5uZXh0KCk7dGhpcy5jb21wdXRlSW50ZXJzZWN0cyhlZGdlMCxlZGdlMSxzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZUVkZ2VTZXRJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdHM9ZnVuY3Rpb24oZTAsZTEsc2kpe3ZhciBwdHMwPWUwLmdldENvb3JkaW5hdGVzKCk7dmFyIHB0czE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgaTAsaTE7Zm9yKGkwPTA7aTA8cHRzMC5sZW5ndGgtMTtpMCsrKXtmb3IoaTE9MDtpMTxwdHMxLmxlbmd0aC0xO2kxKyspe3NpLmFkZEludGVyc2VjdGlvbnMoZTAsaTAsZTEsaTEpO319fTtqc3RzLmdlb21ncmFwaC5FZGdlPWZ1bmN0aW9uKHB0cyxsYWJlbCl7dGhpcy5wdHM9cHRzO3RoaXMubGFiZWw9bGFiZWw7dGhpcy5laUxpc3Q9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VJbnRlcnNlY3Rpb25MaXN0KHRoaXMpO3RoaXMuZGVwdGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkRlcHRoKCk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguR3JhcGhDb21wb25lbnQoKTtqc3RzLmdlb21ncmFwaC5FZGdlLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbWdyYXBoLkVkZ2U7anN0cy5nZW9tZ3JhcGguRWRnZS51cGRhdGVJTT1mdW5jdGlvbihsYWJlbCxpbSl7aW0uc2V0QXRMZWFzdElmVmFsaWQobGFiZWwuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTiksbGFiZWwuZ2V0TG9jYXRpb24oMSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5PTiksMSk7aWYobGFiZWwuaXNBcmVhKCkpe2ltLnNldEF0TGVhc3RJZlZhbGlkKGxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCksbGFiZWwuZ2V0TG9jYXRpb24oMSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKSwyKTtpbS5zZXRBdExlYXN0SWZWYWxpZChsYWJlbC5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKSxsYWJlbC5nZXRMb2NhdGlvbigxLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKSwyKTt9fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5lbnY9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5uYW1lPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUubWNlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuX2lzSXNvbGF0ZWQ9dHJ1ZTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5kZXB0aD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmRlcHRoRGVsdGE9MDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5laUxpc3Q9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXROdW1Qb2ludHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdHMubGVuZ3RoO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtpZih0aGlzLmVudj09PW51bGwpe3RoaXMuZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTtmb3IodmFyIGk9MDtpPHRoaXMucHRzLmxlbmd0aDtpKyspe3RoaXMuZW52LmV4cGFuZFRvSW5jbHVkZShwdHNbaV0pO319XG5yZXR1cm4gZW52O307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZXB0aDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldERlcHRoRGVsdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kZXB0aERlbHRhO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuc2V0RGVwdGhEZWx0YT1mdW5jdGlvbihkZXB0aERlbHRhKXt0aGlzLmRlcHRoRGVsdGE9ZGVwdGhEZWx0YTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRzO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtpZihpPT09dW5kZWZpbmVkKXtpZih0aGlzLnB0cy5sZW5ndGg+MCl7cmV0dXJuIHRoaXMucHRzWzBdO31lbHNle3JldHVybiBudWxsO319XG5yZXR1cm4gdGhpcy5wdHNbaV07fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0Nsb3NlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0c1swXS5lcXVhbHModGhpcy5wdHNbdGhpcy5wdHMubGVuZ3RoLTFdKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLnNldElzb2xhdGVkPWZ1bmN0aW9uKGlzSXNvbGF0ZWQpe3RoaXMuX2lzSXNvbGF0ZWQ9aXNJc29sYXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmlzSXNvbGF0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJc29sYXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmFkZEludGVyc2VjdGlvbnM9ZnVuY3Rpb24obGksc2VnbWVudEluZGV4LGdlb21JbmRleCl7Zm9yKHZhciBpPTA7aTxsaS5nZXRJbnRlcnNlY3Rpb25OdW0oKTtpKyspe3RoaXMuYWRkSW50ZXJzZWN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgsaSk7fX07anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuYWRkSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGxpLHNlZ21lbnRJbmRleCxnZW9tSW5kZXgsaW50SW5kZXgpe3ZhciBpbnRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUobGkuZ2V0SW50ZXJzZWN0aW9uKGludEluZGV4KSk7dmFyIG5vcm1hbGl6ZWRTZWdtZW50SW5kZXg9c2VnbWVudEluZGV4O3ZhciBkaXN0PWxpLmdldEVkZ2VEaXN0YW5jZShnZW9tSW5kZXgsaW50SW5kZXgpO3ZhciBuZXh0U2VnSW5kZXg9bm9ybWFsaXplZFNlZ21lbnRJbmRleCsxO2lmKG5leHRTZWdJbmRleDx0aGlzLnB0cy5sZW5ndGgpe3ZhciBuZXh0UHQ9dGhpcy5wdHNbbmV4dFNlZ0luZGV4XTtpZihpbnRQdC5lcXVhbHMyRChuZXh0UHQpKXtub3JtYWxpemVkU2VnbWVudEluZGV4PW5leHRTZWdJbmRleDtkaXN0PTAuMDt9fVxudmFyIGVpPXRoaXMuZWlMaXN0LmFkZChpbnRQdCxub3JtYWxpemVkU2VnbWVudEluZGV4LGRpc3QpO307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0TWF4aW11bVNlZ21lbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0cy5sZW5ndGgtMTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWlMaXN0O307anN0cy5nZW9tZ3JhcGguRWRnZS5wcm90b3R5cGUuZ2V0TW9ub3RvbmVDaGFpbkVkZ2U9ZnVuY3Rpb24oKXtpZih0aGlzLm1jZT09bnVsbCl7dGhpcy5tY2U9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlKHRoaXMpO31cbnJldHVybiB0aGlzLm1jZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmlzQ2xvc2VkPWZ1bmN0aW9uKClcbntyZXR1cm4gdGhpcy5wdHNbMF0uZXF1YWxzKHRoaXMucHRzW3RoaXMucHRzLmxlbmd0aC0xXSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5pc0NvbGxhcHNlZD1mdW5jdGlvbigpXG57aWYoIXRoaXMubGFiZWwuaXNBcmVhKCkpcmV0dXJuIGZhbHNlO2lmKHRoaXMucHRzLmxlbmd0aCE9MylyZXR1cm4gZmFsc2U7aWYodGhpcy5wdHNbMF0uZXF1YWxzKHRoaXMucHRzWzJdKSlyZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLmdlb21ncmFwaC5FZGdlLnByb3RvdHlwZS5nZXRDb2xsYXBzZWRFZGdlPWZ1bmN0aW9uKClcbnt2YXIgbmV3UHRzPVtdO25ld1B0c1swXT10aGlzLnB0c1swXTtuZXdQdHNbMV09dGhpcy5wdHNbMV07dmFyIG5ld2U9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2UobmV3UHRzLGpzdHMuZ2VvbWdyYXBoLkxhYmVsLnRvTGluZUxhYmVsKHRoaXMubGFiZWwpKTtyZXR1cm4gbmV3ZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbihpbSl7anN0cy5nZW9tZ3JhcGguRWRnZS51cGRhdGVJTSh0aGlzLmxhYmVsLGltKTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2UucHJvdG90eXBlLmlzUG9pbnR3aXNlRXF1YWw9ZnVuY3Rpb24oZSlcbntpZih0aGlzLnB0cy5sZW5ndGghPWUucHRzLmxlbmd0aClyZXR1cm4gZmFsc2U7Zm9yKHZhciBpPTA7aTx0aGlzLnB0cy5sZW5ndGg7aSsrKXtpZighdGhpcy5wdHNbaV0uZXF1YWxzMkQoZS5wdHNbaV0pKXtyZXR1cm4gZmFsc2U7fX1cbnJldHVybiB0cnVlO307anN0cy5ub2RpbmcuT2N0YW50PWZ1bmN0aW9uKCl7dGhyb3cganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5ub2RpbmcuT2N0YW50Lm9jdGFudD1mdW5jdGlvbihkeCxkeSl7aWYoZHggaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIGpzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5pZihkeD09PTAuMCYmZHk9PT0wLjApXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignQ2Fubm90IGNvbXB1dGUgdGhlIG9jdGFudCBmb3IgcG9pbnQgKCAnK2R4KycsICcrZHkrJyApJyk7dmFyIGFkeD1NYXRoLmFicyhkeCk7dmFyIGFkeT1NYXRoLmFicyhkeSk7aWYoZHg+PTApe2lmKGR5Pj0wKXtpZihhZHg+PWFkeSlcbnJldHVybiAwO2Vsc2VcbnJldHVybiAxO31cbmVsc2V7aWYoYWR4Pj1hZHkpXG5yZXR1cm4gNztlbHNlXG5yZXR1cm4gNjt9fVxuZWxzZXtpZihkeT49MCl7aWYoYWR4Pj1hZHkpXG5yZXR1cm4gMztlbHNlXG5yZXR1cm4gMjt9XG5lbHNle2lmKGFkeD49YWR5KVxucmV0dXJuIDQ7ZWxzZVxucmV0dXJuIDU7fX19O2pzdHMubm9kaW5nLk9jdGFudC5vY3RhbnQyPWZ1bmN0aW9uKHAwLHAxKXt2YXIgZHg9cDEueC1wMC54O3ZhciBkeT1wMS55LXAwLnk7aWYoZHg9PT0wLjAmJmR5PT09MC4wKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBvY3RhbnQgZm9yIHR3byBpZGVudGljYWwgcG9pbnRzICcrcDApO3JldHVybiBqc3RzLm5vZGluZy5PY3RhbnQub2N0YW50KGR4LGR5KTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3Rpbmc9ZnVuY3Rpb24oZzAsZzEpe3RoaXMuZzA9ZzA7dGhpcy5nMT1nMTt0aGlzLmdlb21GYWN0b3J5PWcwLmdldEZhY3RvcnkoKTt0aGlzLmludGVyYWN0czA9W107dGhpcy5pbnRlcmFjdHMxPVtdO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy51bmlvbj1mdW5jdGlvbihnMCxnMSl7dmFyIHV1ZT1uZXcganN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZyhnMCxnMSk7cmV0dXJuIHV1ZS51bmlvbigpO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5nMD1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmcxPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuaW50ZXJhY3RzMD1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmludGVyYWN0czE9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS51bmlvbj1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZUludGVyYWN0aW5nKCk7dmFyIGludDA9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMCx0aGlzLmludGVyYWN0czAsdHJ1ZSk7dmFyIGludDE9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMSx0aGlzLmludGVyYWN0czEsdHJ1ZSk7aWYoaW50MC5pc0VtcHR5KCl8fGludDEuaXNFbXB0eSgpKXt9XG52YXIgdW5pb249aW4wLnVuaW9uKGludDEpO3ZhciBkaXNqb2ludDA9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMCx0aGlzLmludGVyYWN0czAsZmFsc2UpO3ZhciBkaXNqb2ludDE9dGhpcy5leHRyYWN0RWxlbWVudHModGhpcy5nMSx0aGlzLmludGVyYWN0czEsZmFsc2UpO3ZhciBvdmVyYWxsVW5pb249anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lKHVuaW9uLGRpc2pvaW50MCxkaXNqb2ludDEpO3JldHVybiBvdmVyYWxsVW5pb247fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmlvbkludGVyYWN0aW5nLnByb3RvdHlwZS5idWZmZXJVbmlvbj1mdW5jdGlvbihnMCxnMSl7dmFyIGZhY3Rvcnk9ZzAuZ2V0RmFjdG9yeSgpO3ZhciBnQ29sbD1mYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihbZzAsZzFdKTt2YXIgdW5pb25BbGw9Z0NvbGwuYnVmZmVyKDAuMCk7cmV0dXJuIHVuaW9uQWxsO307anN0cy5vcGVyYXRpb24udW5pb24uVW5pb25JbnRlcmFjdGluZy5wcm90b3R5cGUuY29tcHV0ZUludGVyYWN0aW5nPWZ1bmN0aW9uKGVsZW0wKXtpZighZWxlbTApe2Zvcih2YXIgaT0wLGw9dGhpcy5nMC5nZXROdW1HZW9tZXRyaWVzKCk7aTxsO2krKyl7dmFyIGVsZW09dGhpcy5nMC5nZXRHZW9tZXRyeU4oaSk7dGhpcy5pbnRlcmFjdHMwW2ldPXRoaXMuY29tcHV0ZUludGVyYWN0aW5nKGVsZW0pO319XG5lbHNle3ZhciBpbnRlcmFjdHNXaXRoQW55PWZhbHNlO2Zvcih2YXIgaT0wLGw9ZzEuZ2V0TnVtR2VvbWV0cmllcygpO2k8bDtpKyspe3ZhciBlbGVtMT10aGlzLmcxLmdldEdlb21ldHJ5TihpKTt2YXIgaW50ZXJhY3RzPWVsZW0xLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKGVsZW0wLmdldEVudmVsb3BlSW50ZXJuYWwoKSk7aWYoaW50ZXJhY3RzKXt0aGlzLmludGVyYWN0czFbaV09dHJ1ZTtpbnRlcmFjdHNXaXRoQW55PXRydWU7fX1cbnJldHVybiBpbnRlcmFjdHNXaXRoQW55O319O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuaW9uSW50ZXJhY3RpbmcucHJvdG90eXBlLmV4dHJhY3RFbGVtZW50cz1mdW5jdGlvbihnZW9tLGludGVyYWN0cyxpc0ludGVyYWN0aW5nKXt2YXIgZXh0cmFjdGVkR2VvbXM9W107Zm9yKHZhciBpPTAsbD1nZW9tLmdldE51bUdlb21ldHJpZXMoKTtpPGw7aSsrKXt2YXIgZWxlbT1nZW9tLmdldEdlb21ldHJ5TihpKTtpZihpbnRlcmFjdHNbaV09PT1pc0ludGVyYWN0aW5nKXtleHRyYWN0ZWRHZW9tcy5wdXNoKGVsZW0pO319XG5yZXR1cm4gdGhpcy5nZW9tRmFjdG9yeS5idWlsZEdlb21ldHJ5KGV4dHJhY3RlZEdlb21zKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGU9ZnVuY3Rpb24oKXt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZU5vblJvYnVzdD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgaXNJbkNpcmNsZT0oYS54KmEueCthLnkqYS55KSpqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWEoYixjLHApLVxuKGIueCpiLngrYi55KmIueSkqanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhKGEsYyxwKStcbihjLngqYy54K2MueSpjLnkpKmpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYShhLGIscCktXG4ocC54KnAueCtwLnkqcC55KSpqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWEoYSxiLGMpPjA7cmV0dXJuIGlzSW5DaXJjbGU7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVOb3JtYWxpemVkPWZ1bmN0aW9uKGEsYixjLHApe3ZhciBhZHgsYWR5LGJkeCxiZHksY2R4LGNkeSxhYmRldCxiY2RldCxjYWRldCxhbGlmdCxibGlmdCxjbGlmdCxkaXNjO2FkeD1hLngtcC54O2FkeT1hLnktcC55O2JkeD1iLngtcC54O2JkeT1iLnktcC55O2NkeD1jLngtcC54O2NkeT1jLnktcC55O2FiZGV0PWFkeCpiZHktYmR4KmFkeTtiY2RldD1iZHgqY2R5LWNkeCpiZHk7Y2FkZXQ9Y2R4KmFkeS1hZHgqY2R5O2FsaWZ0PWFkeCphZHgrYWR5KmFkeTtibGlmdD1iZHgqYmR4K2JkeSpiZHk7Y2xpZnQ9Y2R4KmNkeCtjZHkqY2R5O2Rpc2M9YWxpZnQqYmNkZXQrYmxpZnQqY2FkZXQrY2xpZnQqYWJkZXQ7cmV0dXJuIGRpc2M+MDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuKGIueC1hLngpKihjLnktYS55KS0oYi55LWEueSkqKGMueC1hLngpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlUm9idXN0PWZ1bmN0aW9uKGEsYixjLHApe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVOb3JtYWxpemVkKGEsYixjLHApO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlRERTbG93PWZ1bmN0aW9uKGEsYixjLHApe3ZhciBweCxweSxheCxheSxieCxieSxjeCxjeSxhVGVybSxiVGVybSxjVGVybSxwVGVybSxzdW0saXNJbkNpcmNsZTtweD1qc3RzLm1hdGguREQudmFsdWVPZihwLngpO3B5PWpzdHMubWF0aC5ERC52YWx1ZU9mKHAueSk7YXg9anN0cy5tYXRoLkRELnZhbHVlT2YoYS54KTtheT1qc3RzLm1hdGguREQudmFsdWVPZihhLnkpO2J4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueCk7Ynk9anN0cy5tYXRoLkRELnZhbHVlT2YoYi55KTtjeD1qc3RzLm1hdGguREQudmFsdWVPZihjLngpO2N5PWpzdHMubWF0aC5ERC52YWx1ZU9mKGMueSk7YVRlcm09KGF4Lm11bHRpcGx5KGF4KS5hZGQoYXkubXVsdGlwbHkoYXkpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGJ4LGJ5LGN4LGN5LHB4LHB5KSk7YlRlcm09KGJ4Lm11bHRpcGx5KGJ4KS5hZGQoYnkubXVsdGlwbHkoYnkpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGF4LGF5LGN4LGN5LHB4LHB5KSk7Y1Rlcm09KGN4Lm11bHRpcGx5KGN4KS5hZGQoY3kubXVsdGlwbHkoY3kpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGF4LGF5LGJ4LGJ5LHB4LHB5KSk7cFRlcm09KHB4Lm11bHRpcGx5KHB4KS5hZGQocHkubXVsdGlwbHkocHkpKSkubXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERTbG93KGF4LGF5LGJ4LGJ5LGN4LGN5KSk7c3VtPWFUZXJtLnN1YnRyYWN0KGJUZXJtKS5hZGQoY1Rlcm0pLnN1YnRyYWN0KHBUZXJtKTtpc0luQ2lyY2xlPXN1bS5kb3VibGVWYWx1ZSgpPjA7cmV0dXJuIGlzSW5DaXJjbGU7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFERFNsb3c9ZnVuY3Rpb24oYXgsYXksYngsYnksY3gsY3kpe3JldHVybihieC5zdWJ0cmFjdChheCkubXVsdGlwbHkoY3kuc3VidHJhY3QoYXkpKS5zdWJ0cmFjdChieS5zdWJ0cmFjdChheSkubXVsdGlwbHkoY3guc3VidHJhY3QoYXgpKSkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS5pc0luQ2lyY2xlRERGYXN0PWZ1bmN0aW9uKGEsYixjLHApe3ZhciBhVGVybSxiVGVybSxjVGVybSxwVGVybSxzdW0saXNJbkNpcmNsZTthVGVybT0oanN0cy5tYXRoLkRELnNxcihhLngpLnNlbGZBZGQoanN0cy5tYXRoLkRELnNxcihhLnkpKSkuc2VsZk11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdChiLGMscCkpO2JUZXJtPShqc3RzLm1hdGguREQuc3FyKGIueCkuc2VsZkFkZChqc3RzLm1hdGguREQuc3FyKGIueSkpKS5zZWxmTXVsdGlwbHkoanN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERGYXN0KGEsYyxwKSk7Y1Rlcm09KGpzdHMubWF0aC5ERC5zcXIoYy54KS5zZWxmQWRkKGpzdHMubWF0aC5ERC5zcXIoYy55KSkpLnNlbGZNdWx0aXBseShqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLnRyaUFyZWFEREZhc3QoYSxiLHApKTtwVGVybT0oanN0cy5tYXRoLkRELnNxcihwLngpLnNlbGZBZGQoanN0cy5tYXRoLkRELnNxcihwLnkpKSkuc2VsZk11bHRpcGx5KGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUudHJpQXJlYURERmFzdChhLGIsYykpO3N1bT1hVGVybS5zZWxmU3VidHJhY3QoYlRlcm0pLnNlbGZBZGQoY1Rlcm0pLnNlbGZTdWJ0cmFjdChwVGVybSk7aXNJbkNpcmNsZT1zdW0uZG91YmxlVmFsdWUoKT4wO3JldHVybiBpc0luQ2lyY2xlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZVByZWRpY2F0ZS50cmlBcmVhRERGYXN0PWZ1bmN0aW9uKGEsYixjKXt2YXIgdDEsdDI7dDE9anN0cy5tYXRoLkRELnZhbHVlT2YoYi54KS5zZWxmU3VidHJhY3QoYS54KS5zZWxmTXVsdGlwbHkoanN0cy5tYXRoLkRELnZhbHVlT2YoYy55KS5zZWxmU3VidHJhY3QoYS55KSk7dDI9anN0cy5tYXRoLkRELnZhbHVlT2YoYi55KS5zZWxTdWJ0cmFjdChhLnkpLnNlbGZNdWx0aXBseShqc3RzLm1hdGguREQudmFsdWVPZihjLngpLnNlbGZTdWJ0cmFjdChhLngpKTtyZXR1cm4gdDEuc2VsZlN1YnRyYWN0KHQyKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZURETm9ybWFsaXplZD1mdW5jdGlvbihhLGIsYyxwKXt2YXIgYWR4LGFkeSxiZHgsYmR5LGNkeCxjZHksYWJkZXQsYmNkZXQsY2FkZXQsYWxpZnQsYmxpZnQsY2xpZnQsc3VtLGlzSW5DaXJjbGU7YWR4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGEueCkuc2VsZlN1YnRyYWN0KHAueCk7YWR5PWpzdHMubWF0aC5ERC52YWx1ZU9mKGEueSkuc2VsZlN1YnRyYWN0KHAueSk7YmR4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueCkuc2VsZlN1YnRyYWN0KHAueCk7YmR4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGIueSkuc2VsZlN1YnRyYWN0KHAueSk7Y2R4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGMueCkuc2VsZlN1YnRyYWN0KHAueCk7Y2R4PWpzdHMubWF0aC5ERC52YWx1ZU9mKGMueSkuc2VsZlN1YnRyYWN0KHAueSk7YWJkZXQ9YWR4Lm11bHRpcGx5KGJkeSkuc2VsZlN1YnRyYWN0KGJkeC5tdWx0aXBseShhZHkpKTtiY2RldD1iZHgubXVsdGlwbHkoY2R5KS5zZWxmU3VidHJhY3QoY2R4Lm11bHRpcGx5KGJkeSkpO2NhZGV0PWNkeC5tdWx0aXBseShhZHkpLnNlbGZTdWJ0cmFjdChhZHgubXVsdGlwbHkoY2R5KSk7YWxpZnQ9YWR4Lm11bHRpcGx5KGFkeCkuc2VsZkFkZChhZHkubXVsdGlwbHkoYWR5KSk7YmxpZnQ9YmR4Lm11bHRpcGx5KGJkeCkuc2VsZkFkZChiZHkubXVsdGlwbHkoYmR5KSk7Y2xpZnQ9Y2R4Lm11bHRpcGx5KGNkeCkuc2VsZkFkZChjZHkubXVsdGlwbHkoY2R5KSk7c3VtPWFsaWZ0LnNlbGZNdWx0aXBseShiY2RldCkuc2VsZkFkZChibGlmdC5zZWxmTXVsdGlwbHkoY2FkZXQpKS5zZWxmQWRkKGNsaWZ0LnNlbGZNdWx0aXBseShhYmRldCkpO2lzSW5DaXJjbGU9c3VtLmRvdWJsZVZhbHVlKCk+MDtyZXR1cm4gaXNJbkNpcmNsZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVQcmVkaWNhdGUuaXNJbkNpcmNsZUNDPWZ1bmN0aW9uKGEsYixjLHApe3ZhciBjYyxjY1JhZGl1cyxwUmFkaXVzRGlmZjtjYz1qc3RzLmdlb20uVHJpYW5nbGUuY2lyY3VtY2VudHJlKGEsYixjKTtjY1JhZGl1cz1hLmRpc3RhbmNlKGNjKTtwUmFkaXVzRGlmZj1wLmRpc3RhbmNlKGNjKS1jY1JhZGl1cztyZXR1cm4gcFJhZGl1c0RpZmY8PTA7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb249ZnVuY3Rpb24ocG9pbnRHZW9tLG90aGVyR2VvbSl7dGhpcy5wb2ludEdlb209cG9pbnRHZW9tO3RoaXMub3RoZXJHZW9tPW90aGVyR2VvbTt0aGlzLmdlb21GYWN0PW90aGVyR2VvbS5nZXRGYWN0b3J5KCk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24udW5pb249ZnVuY3Rpb24ocG9pbnRHZW9tLG90aGVyR2VvbSl7dmFyIHVuaW9uZXI9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbihwb2ludEdlb20sb3RoZXJHZW9tKTtyZXR1cm4gdW5pb25lci51bmlvbigpO307anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uLnByb3RvdHlwZS5wb2ludEdlb209bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ucHJvdG90eXBlLm90aGVyR2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlBvaW50R2VvbWV0cnlVbmlvbi5wcm90b3R5cGUuZ2VvbUZhY3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi51bmlvbi5Qb2ludEdlb21ldHJ5VW5pb24ucHJvdG90eXBlLnVuaW9uPWZ1bmN0aW9uKCl7dmFyIGxvY2F0b3I9bmV3IGpzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcigpO3ZhciBleHRlcmlvckNvb3Jkcz1bXTtmb3IodmFyIGk9MCxsPXRoaXMucG9pbnRHZW9tLmdldE51bUdlb21ldHJpZXMoKTtpPGw7aSsrKXt2YXIgcG9pbnQ9dGhpcy5wb2ludEdlb20uZ2V0R2VvbWV0cnlOKGkpO3ZhciBjb29yZD1wb2ludC5nZXRDb29yZGluYXRlKCk7dmFyIGxvYz1sb2NhdG9yLmxvY2F0ZShjb29yZCx0aGlzLm90aGVyR2VvbSk7aWYobG9jPT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKXt2YXIgaW5jbHVkZT10cnVlO2Zvcih2YXIgaj1leHRlcmlvckNvb3Jkcy5sZW5ndGg7aS0tOyl7aWYoZXh0ZXJpb3JDb29yZHNbal0uZXF1YWxzKGNvb3JkKSl7aW5jbHVkZT1mYWxzZTticmVhazt9fVxuaWYoaW5jbHVkZSl7ZXh0ZXJpb3JDb29yZHMucHVzaChjb29yZCk7fX19XG5leHRlcmlvckNvb3Jkcy5zb3J0KGZ1bmN0aW9uKHgseSl7cmV0dXJuIHguY29tcGFyZVRvKHkpO30pO2lmKGV4dGVyaW9yQ29vcmRzLmxlbmd0aD09PTApe3JldHVybiB0aGlzLm90aGVyR2VvbTt9XG52YXIgcHRDb21wPW51bGw7dmFyIGNvb3Jkcz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy50b0Nvb3JkaW5hdGVBcnJheShleHRlcmlvckNvb3Jkcyk7aWYoY29vcmRzLmxlbmd0aD09PTEpe3B0Q29tcD10aGlzLmdlb21GYWN0LmNyZWF0ZVBvaW50KGNvb3Jkc1swXSk7fVxuZWxzZXtwdENvbXA9dGhpcy5nZW9tRmFjdC5jcmVhdGVNdWx0aVBvaW50KGNvb3Jkcyk7fVxucmV0dXJuIGpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5Q29tYmluZXIuY29tYmluZShwdENvbXAsdGhpcy5vdGhlckdlb20pO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXI9ZnVuY3Rpb24obGkpe3RoaXMubGk9bGk7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbnM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuU2VnbWVudEludGVyc2VjdG9yKCk7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIuY29uc3RydWN0b3I9anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXI7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uRmluZGVyQWRkZXIucHJvdG90eXBlLmludGVyaW9ySW50ZXJzZWN0aW9ucz1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkZpbmRlckFkZGVyLnByb3RvdHlwZS5nZXRJbnRlcmlvckludGVyc2VjdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvckludGVyc2VjdGlvbnM7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYoZTA9PT1lMSYmc2VnSW5kZXgwPT09c2VnSW5kZXgxKVxucmV0dXJuO3ZhciBwMDA9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDBdO3ZhciBwMDE9ZTAuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDArMV07dmFyIHAxMD1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MV07dmFyIHAxMT1lMS5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MSsxXTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAwLHAwMSxwMTAscDExKTtpZih0aGlzLmxpLmhhc0ludGVyc2VjdGlvbigpKXtpZih0aGlzLmxpLmlzSW50ZXJpb3JJbnRlcnNlY3Rpb24oKSl7Zm9yKHZhciBpbnRJbmRleD0wO2ludEluZGV4PHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk7aW50SW5kZXgrKyl7dGhpcy5pbnRlcmlvckludGVyc2VjdGlvbnMuYWRkKHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uKGludEluZGV4KSk7fVxuZTAuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MCwwKTtlMS5hZGRJbnRlcnNlY3Rpb25zKHRoaXMubGksc2VnSW5kZXgxLDEpO319fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlcj1mdW5jdGlvbihwbSl7dGhpcy5wbT1wbTt0aGlzLmxpPW5ldyBqc3RzLmFsZ29yaXRobS5Sb2J1c3RMaW5lSW50ZXJzZWN0b3IoKTt0aGlzLmxpLnNldFByZWNpc2lvbk1vZGVsKHBtKTt0aGlzLnNjYWxlRmFjdG9yPXBtLmdldFNjYWxlKCk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuTm9kZXIoKTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXI7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUucG09bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLnNjYWxlRmFjdG9yPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUubm9kZXI9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5wb2ludFNuYXBwZXI9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5ub2RlZFNlZ1N0cmluZ3M9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nLmdldE5vZGVkU3Vic3RyaW5ncyh0aGlzLm5vZGVkU2VnU3RyaW5ncyk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5jb21wdXRlTm9kZXM9ZnVuY3Rpb24oaW5wdXRTZWdtZW50U3RyaW5ncyl7dGhpcy5ub2RlZFNlZ1N0cmluZ3M9aW5wdXRTZWdtZW50U3RyaW5nczt0aGlzLm5vZGVyPW5ldyBqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIoKTt0aGlzLnBvaW50U25hcHBlcj1uZXcganN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXIodGhpcy5ub2Rlci5nZXRJbmRleCgpKTt0aGlzLnNuYXBSb3VuZChpbnB1dFNlZ21lbnRTdHJpbmdzLHRoaXMubGkpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuc25hcFJvdW5kPWZ1bmN0aW9uKHNlZ1N0cmluZ3MsbGkpe3ZhciBpbnRlcnNlY3Rpb25zPXRoaXMuZmluZEludGVyaW9ySW50ZXJzZWN0aW9ucyhzZWdTdHJpbmdzLGxpKTt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25TbmFwcyhpbnRlcnNlY3Rpb25zKTt0aGlzLmNvbXB1dGVWZXJ0ZXhTbmFwcyhzZWdTdHJpbmdzKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLmZpbmRJbnRlcmlvckludGVyc2VjdGlvbnM9ZnVuY3Rpb24oc2VnU3RyaW5ncyxsaSl7dmFyIGludEZpbmRlckFkZGVyPW5ldyBqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25GaW5kZXJBZGRlcihsaSk7dGhpcy5ub2Rlci5zZXRTZWdtZW50SW50ZXJzZWN0b3IoaW50RmluZGVyQWRkZXIpO3RoaXMubm9kZXIuY29tcHV0ZU5vZGVzKHNlZ1N0cmluZ3MpO3JldHVybiBpbnRGaW5kZXJBZGRlci5nZXRJbnRlcmlvckludGVyc2VjdGlvbnMoKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5NQ0luZGV4U25hcFJvdW5kZXIucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25TbmFwcz1mdW5jdGlvbihzbmFwUHRzKXtmb3IodmFyIGl0PXNuYXBQdHMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgc25hcFB0PWl0Lm5leHQoKTt2YXIgaG90UGl4ZWw9bmV3IGpzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbChzbmFwUHQsdGhpcy5zY2FsZUZhY3Rvcix0aGlzLmxpKTt0aGlzLnBvaW50U25hcHBlci5zbmFwKGhvdFBpeGVsKTt9fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFNuYXBSb3VuZGVyLnByb3RvdHlwZS5jb21wdXRlVmVydGV4U25hcHM9ZnVuY3Rpb24oZWRnZXMpe2lmKGVkZ2VzIGluc3RhbmNlb2YganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKXt0aGlzLmNvbXB1dGVWZXJ0ZXhTbmFwczIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG5mb3IodmFyIGkwPWVkZ2VzLml0ZXJhdG9yKCk7aTAuaGFzTmV4dCgpOyl7dmFyIGVkZ2UwPWkwLm5leHQoKTt0aGlzLmNvbXB1dGVWZXJ0ZXhTbmFwcyhlZGdlMCk7fX07anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlci5wcm90b3R5cGUuY29tcHV0ZVZlcnRleFNuYXBzMj1mdW5jdGlvbihlKXt2YXIgcHRzMD1lLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxwdHMwLmxlbmd0aC0xO2krKyl7dmFyIGhvdFBpeGVsPW5ldyBqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwocHRzMFtpXSx0aGlzLnNjYWxlRmFjdG9yLHRoaXMubGkpO3ZhciBpc05vZGVBZGRlZD10aGlzLnBvaW50U25hcHBlci5zbmFwKGhvdFBpeGVsLGUsaSk7aWYoaXNOb2RlQWRkZWQpe2UuYWRkSW50ZXJzZWN0aW9uKHB0czBbaV0saSk7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyPWZ1bmN0aW9uKGdlb21HcmFwaCl7dGhpcy5nZW9tR3JhcGg9Z2VvbUdyYXBoO3RoaXMuZ2VvbWV0cnlGYWN0b3J5PW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5kaXNjb25uZWN0ZWRSaW5nY29vcmQ9bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLmZpbmREaWZmZXJlbnRQb2ludD1mdW5jdGlvbihjb29yZCxwdCl7dmFyIGk9MCxpbD1jb29yZC5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe2lmKCFjb29yZFtpXS5lcXVhbHMocHQpKVxucmV0dXJuIGNvb3JkW2ldO31cbnJldHVybiBudWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29ubmVjdGVkSW50ZXJpb3JUZXN0ZXIucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNjb25uZWN0ZWRSaW5nY29vcmQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuaXNJbnRlcmlvcnNDb25uZWN0ZWQ9ZnVuY3Rpb24oKXt2YXIgc3BsaXRFZGdlcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMuZ2VvbUdyYXBoLmNvbXB1dGVTcGxpdEVkZ2VzKHNwbGl0RWRnZXMpO3ZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGgobmV3IGpzdHMub3BlcmF0aW9uLm92ZXJsYXkuT3ZlcmxheU5vZGVGYWN0b3J5KCkpO2dyYXBoLmFkZEVkZ2VzKHNwbGl0RWRnZXMpO3RoaXMuc2V0SW50ZXJpb3JFZGdlc0luUmVzdWx0KGdyYXBoKTtncmFwaC5saW5rUmVzdWx0RGlyZWN0ZWRFZGdlcygpO3ZhciBlZGdlUmluZ3M9dGhpcy5idWlsZEVkZ2VSaW5ncyhncmFwaC5nZXRFZGdlRW5kcygpKTt0aGlzLnZpc2l0U2hlbGxJbnRlcmlvcnModGhpcy5nZW9tR3JhcGguZ2V0R2VvbWV0cnkoKSxncmFwaCk7cmV0dXJuIXRoaXMuaGFzVW52aXNpdGVkU2hlbGxFZGdlKGVkZ2VSaW5ncyk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUuc2V0SW50ZXJpb3JFZGdlc0luUmVzdWx0PWZ1bmN0aW9uKGdyYXBoKXt2YXIgaXQ9Z3JhcGguZ2V0RWRnZUVuZHMoKS5pdGVyYXRvcigpLGRlO3doaWxlKGl0Lmhhc05leHQoKSl7ZGU9aXQubmV4dCgpO2lmKGRlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7ZGUuc2V0SW5SZXN1bHQodHJ1ZSk7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS5idWlsZEVkZ2VSaW5ncz1mdW5jdGlvbihkaXJFZGdlcyl7dmFyIGVkZ2VSaW5ncz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO2Zvcih2YXIgaXQ9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpdC5oYXNOZXh0KCk7KXt2YXIgZGU9aXQubmV4dCgpO2lmKGRlLmlzSW5SZXN1bHQoKSYmZGUuZ2V0RWRnZVJpbmcoKT09bnVsbCl7dmFyIGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZyhkZSx0aGlzLmdlb21ldHJ5RmFjdG9yeSk7ZXIubGlua0RpcmVjdGVkRWRnZXNGb3JNaW5pbWFsRWRnZVJpbmdzKCk7dmFyIG1pbkVkZ2VSaW5ncz1lci5idWlsZE1pbmltYWxSaW5ncygpO3ZhciBpPTAsaWw9bWluRWRnZVJpbmdzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7ZWRnZVJpbmdzLmFkZChtaW5FZGdlUmluZ3NbaV0pO319fVxucmV0dXJuIGVkZ2VSaW5nczt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS52aXNpdFNoZWxsSW50ZXJpb3JzPWZ1bmN0aW9uKGcsZ3JhcGgpe2lmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dmFyIHA9Zzt0aGlzLnZpc2l0SW50ZXJpb3JSaW5nKHAuZ2V0RXh0ZXJpb3JSaW5nKCksZ3JhcGgpO31cbmlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt2YXIgbXA9Zztmb3IodmFyIGk9MDtpPG1wLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBwPW1wLmdldEdlb21ldHJ5TihpKTt0aGlzLnZpc2l0SW50ZXJpb3JSaW5nKHAuZ2V0RXh0ZXJpb3JSaW5nKCksZ3JhcGgpO319fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUudmlzaXRJbnRlcmlvclJpbmc9ZnVuY3Rpb24ocmluZyxncmFwaCl7dmFyIHB0cz1yaW5nLmdldENvb3JkaW5hdGVzKCk7dmFyIHB0MD1wdHNbMF07dmFyIHB0MT1qc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5maW5kRGlmZmVyZW50UG9pbnQocHRzLHB0MCk7dmFyIGU9Z3JhcGguZmluZEVkZ2VJblNhbWVEaXJlY3Rpb24ocHQwLHB0MSk7dmFyIGRlPWdyYXBoLmZpbmRFZGdlRW5kKGUpO3ZhciBpbnREZT1udWxsO2lmKGRlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk9PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7aW50RGU9ZGU7fWVsc2UgaWYoZGUuZ2V0U3ltKCkuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbigwLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKT09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKXtpbnREZT1kZS5nZXRTeW0oKTt9XG50aGlzLnZpc2l0TGlua2VkRGlyZWN0ZWRFZGdlcyhpbnREZSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3Rlci5wcm90b3R5cGUudmlzaXRMaW5rZWREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKHN0YXJ0KXt2YXIgc3RhcnREZT1zdGFydDt2YXIgZGU9c3RhcnQ7ZG97ZGUuc2V0VmlzaXRlZCh0cnVlKTtkZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT1zdGFydERlKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbm5lY3RlZEludGVyaW9yVGVzdGVyLnByb3RvdHlwZS5oYXNVbnZpc2l0ZWRTaGVsbEVkZ2U9ZnVuY3Rpb24oZWRnZVJpbmdzKXtmb3IodmFyIGk9MDtpPGVkZ2VSaW5ncy5zaXplKCk7aSsrKXt2YXIgZXI9ZWRnZVJpbmdzLmdldChpKTtpZihlci5pc0hvbGUoKSl7Y29udGludWU7fVxudmFyIGVkZ2VzPWVyLmdldEVkZ2VzKCk7dmFyIGRlPWVkZ2VzWzBdO2lmKGRlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCkhPWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7Y29udGludWU7fVxuZm9yKHZhciBqPTA7ajxlZGdlcy5sZW5ndGg7aisrKXtkZT1lZGdlc1tqXTtpZighZGUuaXNWaXNpdGVkKCkpe2Rpc2Nvbm5lY3RlZFJpbmdjb29yZD1kZS5nZXRDb29yZGluYXRlKCk7cmV0dXJuIHRydWU7fX19XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZT1mdW5jdGlvbihnZW9tZXRyeSl7dGhpcy5jZW50cm9pZDt0aGlzLm1pbkRpc3RhbmNlPU51bWJlci5NQVhfVkFMVUU7dGhpcy5pbnRlcmlvclBvaW50PW51bGw7dGhpcy5jZW50cm9pZD1nZW9tZXRyeS5nZXRDZW50cm9pZCgpLmdldENvb3JkaW5hdGUoKTt0aGlzLmFkZEludGVyaW9yKGdlb21ldHJ5KTtpZih0aGlzLmludGVyaW9yUG9pbnQ9PW51bGwpe3RoaXMuYWRkRW5kcG9pbnRzKGdlb21ldHJ5KTt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuZ2V0SW50ZXJpb3JQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyaW9yUG9pbnQ7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkSW50ZXJpb3I9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpe3RoaXMuYWRkSW50ZXJpb3JDb29yZChnZW9tZXRyeS5nZXRDb29yZGluYXRlcygpKTt9ZWxzZSBpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbWV0cnkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGRJbnRlcmlvcihnZW9tZXRyeS5nZXRHZW9tZXRyeU4oaSkpO319fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkSW50ZXJpb3JDb29yZD1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0xO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5hZGQocHRzW2ldKTt9fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkRW5kcG9pbnRzPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmFkZEVuZHBvaW50c0Nvb3JkKGdlb21ldHJ5LmdldENvb3JkaW5hdGVzKCkpO31lbHNlIGlmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbil7Zm9yKHZhciBpPTA7aTxnZW9tZXRyeS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZEVuZHBvaW50cyhnZW9tZXRyeS5nZXRHZW9tZXRyeU4oaSkpO319fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50TGluZS5wcm90b3R5cGUuYWRkRW5kcG9pbnRzQ29vcmQ9ZnVuY3Rpb24ocHRzKXt0aGlzLmFkZChwdHNbMF0pO3RoaXMuYWRkKHB0c1twdHMubGVuZ3RoLTFdKTt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRMaW5lLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24ocG9pbnQpe3ZhciBkaXN0PXBvaW50LmRpc3RhbmNlKHRoaXMuY2VudHJvaWQpO2lmKGRpc3Q8dGhpcy5taW5EaXN0YW5jZSl7dGhpcy5pbnRlcmlvclBvaW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwb2ludCk7dGhpcy5taW5EaXN0YW5jZT1kaXN0O319O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbj1mdW5jdGlvbigpe3RoaXMudGVtcEVudjE9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO3RoaXMuc2VsZWN0ZWRTZWdtZW50PW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbi5wcm90b3R5cGUudGVtcEVudjE9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb24ucHJvdG90eXBlLnNlbGVjdGVkU2VnbWVudD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbi5wcm90b3R5cGUuc2VsZWN0PWZ1bmN0aW9uKG1jLHN0YXJ0KXttYy5nZXRMaW5lU2VnbWVudChzdGFydCx0aGlzLnNlbGVjdGVkU2VnbWVudCk7dGhpcy5zZWxlY3QyKHRoaXMuc2VsZWN0ZWRTZWdtZW50KTt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpblNlbGVjdEFjdGlvbi5wcm90b3R5cGUuc2VsZWN0Mj1mdW5jdGlvbihzZWcpe307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZz1mdW5jdGlvbihyaW5nKXt0aGlzLnJpbmc9cmluZzt0aGlzLnRyZWU9bnVsbDt0aGlzLmNyb3NzaW5ncz0wO3RoaXMuaW50ZXJ2YWw9bmV3IGpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbCgpO3RoaXMuYnVpbGRJbmRleCgpO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyPWZ1bmN0aW9uKHAscGFyZW50KXt0aGlzLnBhcmVudD1wYXJlbnQ7dGhpcy5wPXA7fTtqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLk1DU2VsZWN0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW5TZWxlY3RBY3Rpb247anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1qc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLk1DU2VsZWN0ZXI7anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5NQ1NlbGVjdGVyLnByb3RvdHlwZS5zZWxlY3QyPWZ1bmN0aW9uKGxzKXt0aGlzLnBhcmVudC50ZXN0TGluZVNlZ21lbnQuYXBwbHkodGhpcy5wYXJlbnQsW3RoaXMucCxsc10pO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5wcm90b3R5cGUuYnVpbGRJbmRleD1mdW5jdGlvbigpe3RoaXMudHJlZT1uZXcganN0cy5pbmRleC5iaW50cmVlLkJpbnRyZWUoKTt2YXIgcHRzPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKHRoaXMucmluZy5nZXRDb29yZGluYXRlcygpKTt2YXIgbWNMaXN0PWpzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbkJ1aWxkZXIuZ2V0Q2hhaW5zKHB0cyk7Zm9yKHZhciBpPTA7aTxtY0xpc3QubGVuZ3RoO2krKyl7dmFyIG1jPW1jTGlzdFtpXTt2YXIgbWNFbnY9bWMuZ2V0RW52ZWxvcGUoKTt0aGlzLmludGVydmFsLm1pbj1tY0Vudi5nZXRNaW5ZKCk7dGhpcy5pbnRlcnZhbC5tYXg9bWNFbnYuZ2V0TWF4WSgpO3RoaXMudHJlZS5pbnNlcnQodGhpcy5pbnRlcnZhbCxtYyk7fX07anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5wcm90b3R5cGUuaXNJbnNpZGU9ZnVuY3Rpb24ocHQpe3RoaXMuY3Jvc3NpbmdzPTA7dmFyIHJheUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKC1OdW1iZXIuTUFYX1ZBTFVFLE51bWJlci5NQVhfVkFMVUUscHQueSxwdC55KTt0aGlzLmludGVydmFsLm1pbj1wdC55O3RoaXMuaW50ZXJ2YWwubWF4PXB0Lnk7dmFyIHNlZ3M9dGhpcy50cmVlLnF1ZXJ5KHRoaXMuaW50ZXJ2YWwpO3ZhciBtY1NlbGVjdGVyPW5ldyBqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nLk1DU2VsZWN0ZXIocHQsdGhpcyk7Zm9yKHZhciBpPXNlZ3MuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBtYz1pLm5leHQoKTt0aGlzLnRlc3RNb25vdG9uZUNoYWluKHJheUVudixtY1NlbGVjdGVyLG1jKTt9XG5pZigodGhpcy5jcm9zc2luZ3MlMik9PTEpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLk1DUG9pbnRJblJpbmcucHJvdG90eXBlLnRlc3RNb25vdG9uZUNoYWluPWZ1bmN0aW9uKHJheUVudixtY1NlbGVjdGVyLG1jKXttYy5zZWxlY3QocmF5RW52LG1jU2VsZWN0ZXIpO307anN0cy5hbGdvcml0aG0uTUNQb2ludEluUmluZy5wcm90b3R5cGUudGVzdExpbmVTZWdtZW50PWZ1bmN0aW9uKHAsc2VnKXt2YXIgeEludCx4MSx5MSx4Mix5MixwMSxwMjtwMT1zZWcucDA7cDI9c2VnLnAxO3gxPXAxLngtcC54O3kxPXAxLnktcC55O3gyPXAyLngtcC54O3kyPXAyLnktcC55O2lmKCgoeTE+MCkmJih5Mjw9MCkpfHwoKHkyPjApJiYoeTE8PTApKSl7eEludD1qc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoeDEseTEseDIseTIpLyh5Mi15MSk7aWYoMC4wPHhJbnQpe3RoaXMuY3Jvc3NpbmdzKys7fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yPWZ1bmN0aW9uKGVycm9yVHlwZSxwdCl7dGhpcy5lcnJvclR5cGU9ZXJyb3JUeXBlO3RoaXMucHQ9bnVsbDtpZihwdCE9bnVsbCl7dGhpcy5wdD1wdC5jbG9uZSgpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLkhPTEVfT1VUU0lERV9TSEVMTD0yO2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9IT0xFUz0zO2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLkRJU0NPTk5FQ1RFRF9JTlRFUklPUj00O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlNFTEZfSU5URVJTRUNUSU9OPTU7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19TRUxGX0lOVEVSU0VDVElPTj02O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9TSEVMTFM9Nztqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5EVVBMSUNBVEVfUklOR1M9ODtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5UT09fRkVXX1BPSU5UUz05O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLklOVkFMSURfQ09PUkRJTkFURT0xMDtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5SSU5HX05PVF9DTE9TRUQ9MTE7anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlLmVyck1zZz1bJ1RvcG9sb2d5IFZhbGlkYXRpb24gRXJyb3InLCdSZXBlYXRlZCBQb2ludCcsJ0hvbGUgbGllcyBvdXRzaWRlIHNoZWxsJywnSG9sZXMgYXJlIG5lc3RlZCcsJ0ludGVyaW9yIGlzIGRpc2Nvbm5lY3RlZCcsJ1NlbGYtaW50ZXJzZWN0aW9uJywnUmluZyBTZWxmLWludGVyc2VjdGlvbicsJ05lc3RlZCBzaGVsbHMnLCdEdXBsaWNhdGUgUmluZ3MnLCdUb28gZmV3IGRpc3RpbmN0IHBvaW50cyBpbiBnZW9tZXRyeSBjb21wb25lbnQnLCdJbnZhbGlkIENvb3JkaW5hdGUnLCdSaW5nIGlzIG5vdCBjbG9zZWQnXTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlLmdldEVycm9yVHlwZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVycm9yVHlwZTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS5nZXRNZXNzYWdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXJyTXNnW3RoaXMuZXJyb3JUeXBlXTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBsb2NTdHI9Jyc7aWYodGhpcy5wdCE9bnVsbCl7bG9jU3RyPScgYXQgb3IgbmVhciBwb2ludCAnK3RoaXMucHQ7cmV0dXJuIHRoaXMuZ2V0TWVzc2FnZSgpK2xvY1N0cjt9XG5yZXR1cm4gbG9jU3RyO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLk11bHRpUG9seWdvbj1mdW5jdGlvbihnZW9tZXRyaWVzLGZhY3Rvcnkpe3RoaXMuZ2VvbWV0cmllcz1nZW9tZXRyaWVzfHxbXTt0aGlzLmZhY3Rvcnk9ZmFjdG9yeTt9O2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKCk7anN0cy5nZW9tLk11bHRpUG9seWdvbi5jb25zdHJ1Y3Rvcj1qc3RzLmdlb20uTXVsdGlQb2x5Z29uO2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VtcHR5KCkpe3JldHVybiB0aGlzLmdldEZhY3RvcnkoKS5jcmVhdGVNdWx0aUxpbmVTdHJpbmcobnVsbCk7fVxudmFyIGFsbFJpbmdzPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3ZhciBwb2x5Z29uPXRoaXMuZ2VvbWV0cmllc1tpXTt2YXIgcmluZ3M9cG9seWdvbi5nZXRCb3VuZGFyeSgpO2Zvcih2YXIgaj0wO2o8cmluZ3MuZ2V0TnVtR2VvbWV0cmllcygpO2orKyl7YWxsUmluZ3MucHVzaChyaW5ncy5nZXRHZW9tZXRyeU4oaikpO319XG5yZXR1cm4gdGhpcy5nZXRGYWN0b3J5KCkuY3JlYXRlTXVsdGlMaW5lU3RyaW5nKGFsbFJpbmdzKTt9O2pzdHMuZ2VvbS5NdWx0aVBvbHlnb24ucHJvdG90eXBlLmVxdWFsc0V4YWN0PWZ1bmN0aW9uKG90aGVyLHRvbGVyYW5jZSl7aWYoIXRoaXMuaXNFcXVpdmFsZW50Q2xhc3Mob3RoZXIpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24ucHJvdG90eXBlLmVxdWFsc0V4YWN0LmNhbGwodGhpcyxvdGhlcix0b2xlcmFuY2UpO307anN0cy5nZW9tLk11bHRpUG9seWdvbi5wcm90b3R5cGUuQ0xBU1NfTkFNRT0nanN0cy5nZW9tLk11bHRpUG9seWdvbic7fSkoKTtqc3RzLmdlb20uQ29vcmRpbmF0ZVNlcXVlbmNlRmlsdGVyPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZVNlcXVlbmNlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9anN0cy5hYnN0cmFjdEZ1bmM7anN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlci5wcm90b3R5cGUuaXNEb25lPWpzdHMuYWJzdHJhY3RGdW5jO2pzdHMuZ2VvbS5Db29yZGluYXRlU2VxdWVuY2VGaWx0ZXIucHJvdG90eXBlLmlzR2VvbWV0cnlDaGFuZ2VkPWpzdHMuYWJzdHJhY3RGdW5jOyhmdW5jdGlvbigpe3ZhciBJbnRlcnZhbD1mdW5jdGlvbigpe3RoaXMubWluPTAuMDt0aGlzLm1heD0wLjA7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3ZhciBpbnRlcnZhbD1hcmd1bWVudHNbMF07dGhpcy5pbml0KGludGVydmFsLm1pbixpbnRlcnZhbC5tYXgpO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT0yKXt0aGlzLmluaXQoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07SW50ZXJ2YWwucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24obWluLG1heCl7dGhpcy5taW49bWluO3RoaXMubWF4PW1heDtpZihtaW4+bWF4KXt0aGlzLm1pbj1tYXg7dGhpcy5tYXg9bWluO319O0ludGVydmFsLnByb3RvdHlwZS5nZXRNaW49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taW47fTtJbnRlcnZhbC5wcm90b3R5cGUuZ2V0TWF4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4O307SW50ZXJ2YWwucHJvdG90eXBlLmdldFdpZHRoPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMubWF4LXRoaXMubWluKTt9O0ludGVydmFsLnByb3RvdHlwZS5leHBhbmRUb0luY2x1ZGU9ZnVuY3Rpb24oaW50ZXJ2YWwpe2lmKGludGVydmFsLm1heD50aGlzLm1heCl7dGhpcy5tYXg9aW50ZXJ2YWwubWF4O31cbmlmKGludGVydmFsLm1pbjx0aGlzLm1pbil7dGhpcy5taW49aW50ZXJ2YWwubWluO319O0ludGVydmFsLnByb3RvdHlwZS5vdmVybGFwcz1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5vdmVybGFwc0ludGVydmFsLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9ZWxzZXtyZXR1cm4gdGhpcy5vdmVybGFwc01pbk1heC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fX07SW50ZXJ2YWwucHJvdG90eXBlLm92ZXJsYXBzSW50ZXJ2YWw9ZnVuY3Rpb24oaW50ZXJ2YWwpe3JldHVybiB0aGlzLm92ZXJsYXBzKGludGVydmFsLm1pbixpbnRlcnZhbC5tYXgpO307SW50ZXJ2YWwucHJvdG90eXBlLm92ZXJsYXBzTWluTWF4PWZ1bmN0aW9uKG1pbixtYXgpe2lmKHRoaXMubWluPm1heHx8dGhpcy5tYXg8bWluKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtJbnRlcnZhbC5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oKXt2YXIgaW50ZXJ2YWw7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmluZGV4LmJpbnRyZWUuSW50ZXJ2YWwpe2ludGVydmFsPWFyZ3VtZW50c1swXTtyZXR1cm4gdGhpcy5jb250YWluc01pbk1heChpbnRlcnZhbC5taW4saW50ZXJ2YWwubWF4KTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIHRoaXMuY29udGFpbnNQb2ludChhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLmNvbnRhaW5zTWluTWF4KGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O0ludGVydmFsLnByb3RvdHlwZS5jb250YWluc01pbk1heD1mdW5jdGlvbihtaW4sbWF4KXtyZXR1cm4obWluPj10aGlzLm1pbiYmbWF4PD10aGlzLm1heCk7fTtJbnRlcnZhbC5wcm90b3R5cGUuY29udGFpbnNQb2ludD1mdW5jdGlvbihwKXtyZXR1cm4ocD49dGhpcy5taW4mJnA8PXRoaXMubWF4KTt9O2pzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbD1JbnRlcnZhbDt9KSgpO2pzdHMuaW5kZXguRG91YmxlQml0cz1mdW5jdGlvbigpe307anN0cy5pbmRleC5Eb3VibGVCaXRzLnBvd2VyT2YyPWZ1bmN0aW9uKGV4cCl7cmV0dXJuIE1hdGgucG93KDIsZXhwKTt9O2pzdHMuaW5kZXguRG91YmxlQml0cy5leHBvbmVudD1mdW5jdGlvbihkKXtyZXR1cm4ganN0cy5pbmRleC5Eb3VibGVCaXRzLkNWVEZXRCg2NCxkKS0xMDIzO307anN0cy5pbmRleC5Eb3VibGVCaXRzLkNWVEZXRD1mdW5jdGlvbihOdW1XLFF0eSl7dmFyIFNpZ24sRXhwbyxNYW50LEJpbixuYjAxPScnO3ZhciBJbmY9ezMyOntkOjB4N0YsYzoweDgwLGI6MCxhOjB9LDY0OntkOjB4N0ZGMCxjOjAsYjowLGE6MH19O3ZhciBFeFc9ezMyOjgsNjQ6MTF9W051bVddLE10Vz1OdW1XLUV4Vy0xO2lmKCFCaW4pe1NpZ249UXR5PDB8fDEvUXR5PDA7aWYoIWlzRmluaXRlKFF0eSkpe0Jpbj1JbmZbTnVtV107aWYoU2lnbil7QmluLmQrPTE8PChOdW1XLzQtMSk7fVxuRXhwbz1NYXRoLnBvdygyLEV4VyktMTtNYW50PTA7fX1cbmlmKCFCaW4pe0V4cG89ezMyOjEyNyw2NDoxMDIzfVtOdW1XXTtNYW50PU1hdGguYWJzKFF0eSk7d2hpbGUoTWFudD49Mil7RXhwbysrO01hbnQvPTI7fVxud2hpbGUoTWFudDwxJiZFeHBvPjApe0V4cG8tLTtNYW50Kj0yO31cbmlmKEV4cG88PTApe01hbnQvPTI7bmIwMT0nWmVybyBvciBEZW5vcm1hbCc7fVxuaWYoTnVtVz09PTMyJiZFeHBvPjI1NCl7bmIwMT0nVG9vIGJpZyBmb3IgU2luZ2xlJztCaW49e2Q6U2lnbj8weEZGOjB4N0YsYzoweDgwLGI6MCxhOjB9O0V4cG89TWF0aC5wb3coMixFeFcpLTE7TWFudD0wO319XG5yZXR1cm4gRXhwbzt9OyhmdW5jdGlvbigpe3ZhciBEb3VibGVCaXRzPWpzdHMuaW5kZXguRG91YmxlQml0czt2YXIgSW50ZXJ2YWw9anN0cy5pbmRleC5iaW50cmVlLkludGVydmFsO3ZhciBLZXk9ZnVuY3Rpb24oaW50ZXJ2YWwpe3RoaXMucHQ9MC4wO3RoaXMubGV2ZWw9MDt0aGlzLmNvbXB1dGVLZXkoaW50ZXJ2YWwpO307S2V5LmNvbXB1dGVMZXZlbD1mdW5jdGlvbihpbnRlcnZhbCl7dmFyIGR4PWludGVydmFsLmdldFdpZHRoKCksbGV2ZWw7bGV2ZWw9RG91YmxlQml0cy5leHBvbmVudChkeCkrMTtyZXR1cm4gbGV2ZWw7fTtLZXkucHJvdG90eXBlLmdldFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ7fTtLZXkucHJvdG90eXBlLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGV2ZWw7fTtLZXkucHJvdG90eXBlLmdldEludGVydmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJ2YWw7fTtLZXkucHJvdG90eXBlLmNvbXB1dGVLZXk9ZnVuY3Rpb24oaXRlbUludGVydmFsKXt0aGlzLmxldmVsPUtleS5jb21wdXRlTGV2ZWwoaXRlbUludGVydmFsKTt0aGlzLmludGVydmFsPW5ldyBJbnRlcnZhbCgpO3RoaXMuY29tcHV0ZUludGVydmFsKHRoaXMubGV2ZWwsaXRlbUludGVydmFsKTt3aGlsZSghdGhpcy5pbnRlcnZhbC5jb250YWlucyhpdGVtSW50ZXJ2YWwpKXt0aGlzLmxldmVsKz0xO3RoaXMuY29tcHV0ZUludGVydmFsKHRoaXMubGV2ZWwsaXRlbUludGVydmFsKTt9fTtLZXkucHJvdG90eXBlLmNvbXB1dGVJbnRlcnZhbD1mdW5jdGlvbihsZXZlbCxpdGVtSW50ZXJ2YWwpe3ZhciBzaXplPURvdWJsZUJpdHMucG93ZXJPZjIobGV2ZWwpO3RoaXMucHQ9TWF0aC5mbG9vcihpdGVtSW50ZXJ2YWwuZ2V0TWluKCkvc2l6ZSkqc2l6ZTt0aGlzLmludGVydmFsLmluaXQodGhpcy5wdCx0aGlzLnB0K3NpemUpO307anN0cy5pbmRleC5iaW50cmVlLktleT1LZXk7fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXI9ZnVuY3Rpb24oc3ViZ3JhcGhzKXt0aGlzLnN1YmdyYXBocz1bXTt0aGlzLnNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5zdWJncmFwaHM9c3ViZ3JhcGhzO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLnByb3RvdHlwZS5zdWJncmFwaHM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIucHJvdG90eXBlLnNlZz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24ocCl7dmFyIHN0YWJiZWRTZWdtZW50cz10aGlzLmZpbmRTdGFiYmVkU2VnbWVudHMocCk7aWYoc3RhYmJlZFNlZ21lbnRzLmxlbmd0aD09PTApXG5yZXR1cm4gMDtzdGFiYmVkU2VnbWVudHMuc29ydCgpO3ZhciBkcz1zdGFiYmVkU2VnbWVudHNbMF07cmV0dXJuIGRzLmxlZnREZXB0aDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZmluZFN0YWJiZWRTZWdtZW50cz1mdW5jdGlvbihzdGFiYmluZ1JheUxlZnRQdCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTMpe3RoaXMuZmluZFN0YWJiZWRTZWdtZW50czIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgc3RhYmJlZFNlZ21lbnRzPVtdO2Zvcih2YXIgaT0wO2k8dGhpcy5zdWJncmFwaHMubGVuZ3RoO2krKyl7dmFyIGJzZz10aGlzLnN1YmdyYXBoc1tpXTt2YXIgZW52PWJzZy5nZXRFbnZlbG9wZSgpO2lmKHN0YWJiaW5nUmF5TGVmdFB0Lnk8ZW52LmdldE1pblkoKXx8c3RhYmJpbmdSYXlMZWZ0UHQueT5lbnYuZ2V0TWF4WSgpKVxuY29udGludWU7dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzMihzdGFiYmluZ1JheUxlZnRQdCxic2cuZ2V0RGlyZWN0ZWRFZGdlcygpLHN0YWJiZWRTZWdtZW50cyk7fVxucmV0dXJuIHN0YWJiZWRTZWdtZW50czt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5wcm90b3R5cGUuZmluZFN0YWJiZWRTZWdtZW50czI9ZnVuY3Rpb24oc3RhYmJpbmdSYXlMZWZ0UHQsZGlyRWRnZXMsc3RhYmJlZFNlZ21lbnRzKXtpZihhcmd1bWVudHNbMV1pbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZSl7dGhpcy5maW5kU3RhYmJlZFNlZ21lbnRzMyhzdGFiYmluZ1JheUxlZnRQdCxkaXJFZGdlcyxzdGFiYmVkU2VnbWVudHMpO3JldHVybjt9XG5mb3IodmFyIGk9ZGlyRWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZighZGUuaXNGb3J3YXJkKCkpXG5jb250aW51ZTt0aGlzLmZpbmRTdGFiYmVkU2VnbWVudHMzKHN0YWJiaW5nUmF5TGVmdFB0LGRlLHN0YWJiZWRTZWdtZW50cyk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLnByb3RvdHlwZS5maW5kU3RhYmJlZFNlZ21lbnRzMz1mdW5jdGlvbihzdGFiYmluZ1JheUxlZnRQdCxkaXJFZGdlLHN0YWJiZWRTZWdtZW50cyl7dmFyIHB0cz1kaXJFZGdlLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlcygpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5zZWcucDA9cHRzW2ldO3RoaXMuc2VnLnAxPXB0c1tpKzFdO2lmKHRoaXMuc2VnLnAwLnk+dGhpcy5zZWcucDEueSlcbnRoaXMuc2VnLnJldmVyc2UoKTt2YXIgbWF4eD1NYXRoLm1heCh0aGlzLnNlZy5wMC54LHRoaXMuc2VnLnAxLngpO2lmKG1heHg8c3RhYmJpbmdSYXlMZWZ0UHQueClcbmNvbnRpbnVlO2lmKHRoaXMuc2VnLmlzSG9yaXpvbnRhbCgpKVxuY29udGludWU7aWYoc3RhYmJpbmdSYXlMZWZ0UHQueTx0aGlzLnNlZy5wMC55fHxzdGFiYmluZ1JheUxlZnRQdC55PnRoaXMuc2VnLnAxLnkpXG5jb250aW51ZTtpZihqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHRoaXMuc2VnLnAwLHRoaXMuc2VnLnAxLHN0YWJiaW5nUmF5TGVmdFB0KT09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5SSUdIVClcbmNvbnRpbnVlO3ZhciBkZXB0aD1kaXJFZGdlLmdldERlcHRoKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO2lmKCF0aGlzLnNlZy5wMC5lcXVhbHMocHRzW2ldKSlcbmRlcHRoPWRpckVkZ2UuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO3ZhciBkcz1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyLkRlcHRoU2VnbWVudCh0aGlzLnNlZyxkZXB0aCk7c3RhYmJlZFNlZ21lbnRzLnB1c2goZHMpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5EZXB0aFNlZ21lbnQ9ZnVuY3Rpb24oc2VnLGRlcHRoKXt0aGlzLnVwd2FyZFNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KHNlZyk7dGhpcy5sZWZ0RGVwdGg9ZGVwdGg7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS51cHdhcmRTZWc9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS5sZWZ0RGVwdGg9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuU3ViZ3JhcGhEZXB0aExvY2F0ZXIuRGVwdGhTZWdtZW50LnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob2JqKXt2YXIgb3RoZXI9b2JqO3ZhciBvcmllbnRJbmRleD10aGlzLnVwd2FyZFNlZy5vcmllbnRhdGlvbkluZGV4KG90aGVyLnVwd2FyZFNlZyk7aWYob3JpZW50SW5kZXg9PT0wKVxub3JpZW50SW5kZXg9LTEqb3RoZXIudXB3YXJkU2VnLm9yaWVudGF0aW9uSW5kZXgodXB3YXJkU2VnKTtpZihvcmllbnRJbmRleCE9PTApXG5yZXR1cm4gb3JpZW50SW5kZXg7cmV0dXJuIHRoaXMuY29tcGFyZVgodGhpcy51cHdhcmRTZWcsb3RoZXIudXB3YXJkU2VnKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5TdWJncmFwaERlcHRoTG9jYXRlci5EZXB0aFNlZ21lbnQucHJvdG90eXBlLmNvbXBhcmVYPWZ1bmN0aW9uKHNlZzAsc2VnMSl7dmFyIGNvbXBhcmUwPXNlZzAucDAuY29tcGFyZVRvKHNlZzEucDApO2lmKGNvbXBhcmUwIT09MClcbnJldHVybiBjb21wYXJlMDtyZXR1cm4gc2VnMC5wMS5jb21wYXJlVG8oc2VnMS5wMSk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWw9ZnVuY3Rpb24ocHQsc2NhbGVGYWN0b3IsbGkpe3RoaXMuY29ybmVyPVtdO3RoaXMub3JpZ2luYWxQdD1wdDt0aGlzLnB0PXB0O3RoaXMuc2NhbGVGYWN0b3I9c2NhbGVGYWN0b3I7dGhpcy5saT1saTtpZih0aGlzLnNjYWxlRmFjdG9yIT09MS4wKXt0aGlzLnB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLnNjYWxlKHB0LngpLHRoaXMuc2NhbGUocHQueSkpO3RoaXMucDBTY2FsZWQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5wMVNjYWxlZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt9XG50aGlzLmluaXRDb3JuZXJzKHRoaXMucHQpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5saT1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm9yaWdpbmFsUHQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnB0U2NhbGVkPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5wMFNjYWxlZD1udWxsO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUucDFTY2FsZWQ9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLnNjYWxlRmFjdG9yPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm1pbng9dW5kZWZpbmVkO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUubWF4eD11bmRlZmluZWQ7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5taW55PXVuZGVmaW5lZDtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLm1heHk9dW5kZWZpbmVkO2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuY29ybmVyPW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5zYWZlRW52PW51bGw7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3JpZ2luYWxQdDt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5TQUZFX0VOVl9FWFBBTlNJT05fRkFDVE9SPTAuNzU7anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5nZXRTYWZlRW52ZWxvcGU9ZnVuY3Rpb24oKXtpZih0aGlzLnNhZmVFbnY9PT1udWxsKXt2YXIgc2FmZVRvbGVyYW5jZT1qc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwuU0FGRV9FTlZfRVhQQU5TSU9OX0ZBQ1RPUi90aGlzLnNjYWxlRmFjdG9yO3RoaXMuc2FmZUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHRoaXMub3JpZ2luYWxQdC54LXNhZmVUb2xlcmFuY2UsdGhpcy5vcmlnaW5hbFB0Lngrc2FmZVRvbGVyYW5jZSx0aGlzLm9yaWdpbmFsUHQueS1zYWZlVG9sZXJhbmNlLHRoaXMub3JpZ2luYWxQdC55K3NhZmVUb2xlcmFuY2UpO31cbnJldHVybiB0aGlzLnNhZmVFbnY7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmluaXRDb3JuZXJzPWZ1bmN0aW9uKHB0KXt2YXIgdG9sZXJhbmNlPTAuNTt0aGlzLm1pbng9cHQueC10b2xlcmFuY2U7dGhpcy5tYXh4PXB0LngrdG9sZXJhbmNlO3RoaXMubWlueT1wdC55LXRvbGVyYW5jZTt0aGlzLm1heHk9cHQueSt0b2xlcmFuY2U7dGhpcy5jb3JuZXJbMF09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMubWF4eCx0aGlzLm1heHkpO3RoaXMuY29ybmVyWzFdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLm1pbngsdGhpcy5tYXh5KTt0aGlzLmNvcm5lclsyXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUodGhpcy5taW54LHRoaXMubWlueSk7dGhpcy5jb3JuZXJbM109bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHRoaXMubWF4eCx0aGlzLm1pbnkpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbih2YWwpe3JldHVybiBNYXRoLnJvdW5kKHZhbCp0aGlzLnNjYWxlRmFjdG9yKTt9O2pzdHMubm9kaW5nLnNuYXByb3VuZC5Ib3RQaXhlbC5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbihwMCxwMSl7aWYodGhpcy5zY2FsZUZhY3Rvcj09PTEuMClcbnJldHVybiB0aGlzLmludGVyc2VjdHNTY2FsZWQocDAscDEpO3RoaXMuY29weVNjYWxlZChwMCx0aGlzLnAwU2NhbGVkKTt0aGlzLmNvcHlTY2FsZWQocDEsdGhpcy5wMVNjYWxlZCk7cmV0dXJuIHRoaXMuaW50ZXJzZWN0c1NjYWxlZCh0aGlzLnAwU2NhbGVkLHRoaXMucDFTY2FsZWQpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5jb3B5U2NhbGVkPWZ1bmN0aW9uKHAscFNjYWxlZCl7cFNjYWxlZC54PXRoaXMuc2NhbGUocC54KTtwU2NhbGVkLnk9dGhpcy5zY2FsZShwLnkpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbnRlcnNlY3RzU2NhbGVkPWZ1bmN0aW9uKHAwLHAxKXt2YXIgc2VnTWlueD1NYXRoLm1pbihwMC54LHAxLngpO3ZhciBzZWdNYXh4PU1hdGgubWF4KHAwLngscDEueCk7dmFyIHNlZ01pbnk9TWF0aC5taW4ocDAueSxwMS55KTt2YXIgc2VnTWF4eT1NYXRoLm1heChwMC55LHAxLnkpO3ZhciBpc091dHNpZGVQaXhlbEVudj10aGlzLm1heHg8c2VnTWlueHx8dGhpcy5taW54PnNlZ01heHh8fHRoaXMubWF4eTxzZWdNaW55fHx0aGlzLm1pbnk+c2VnTWF4eTtpZihpc091dHNpZGVQaXhlbEVudilcbnJldHVybiBmYWxzZTt2YXIgaW50ZXJzZWN0cz10aGlzLmludGVyc2VjdHNUb2xlcmFuY2VTcXVhcmUocDAscDEpO2pzdHMudXRpbC5Bc3NlcnQuaXNUcnVlKCEoaXNPdXRzaWRlUGl4ZWxFbnYmJmludGVyc2VjdHMpLCdGb3VuZCBiYWQgZW52ZWxvcGUgdGVzdCcpO3JldHVybiBpbnRlcnNlY3RzO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbnRlcnNlY3RzVG9sZXJhbmNlU3F1YXJlPWZ1bmN0aW9uKHAwLHAxKXt2YXIgaW50ZXJzZWN0c0xlZnQ9ZmFsc2U7dmFyIGludGVyc2VjdHNCb3R0b209ZmFsc2U7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwLHAxLHRoaXMuY29ybmVyWzBdLHRoaXMuY29ybmVyWzFdKTtpZih0aGlzLmxpLmlzUHJvcGVyKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMV0sdGhpcy5jb3JuZXJbMl0pO2lmKHRoaXMubGkuaXNQcm9wZXIoKSlcbnJldHVybiB0cnVlO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5pbnRlcnNlY3RzTGVmdD10cnVlO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMCxwMSx0aGlzLmNvcm5lclsyXSx0aGlzLmNvcm5lclszXSk7aWYodGhpcy5saS5pc1Byb3BlcigpKVxucmV0dXJuIHRydWU7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSlcbmludGVyc2VjdHNCb3R0b209dHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbM10sdGhpcy5jb3JuZXJbMF0pO2lmKHRoaXMubGkuaXNQcm9wZXIoKSlcbnJldHVybiB0cnVlO2lmKGludGVyc2VjdHNMZWZ0JiZpbnRlcnNlY3RzQm90dG9tKVxucmV0dXJuIHRydWU7aWYocDAuZXF1YWxzKHRoaXMucHQpKVxucmV0dXJuIHRydWU7aWYocDEuZXF1YWxzKHRoaXMucHQpKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLkhvdFBpeGVsLnByb3RvdHlwZS5pbnRlcnNlY3RzUGl4ZWxDbG9zdXJlPWZ1bmN0aW9uKHAwLHAxKXt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMF0sdGhpcy5jb3JuZXJbMV0pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMV0sdGhpcy5jb3JuZXJbMl0pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbMl0sdGhpcy5jb3JuZXJbM10pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTt0aGlzLmxpLmNvbXB1dGVJbnRlcnNlY3Rpb24ocDAscDEsdGhpcy5jb3JuZXJbM10sdGhpcy5jb3JuZXJbMF0pO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuSG90UGl4ZWwucHJvdG90eXBlLmFkZFNuYXBwZWROb2RlPWZ1bmN0aW9uKHNlZ1N0cixzZWdJbmRleCl7dmFyIHAwPXNlZ1N0ci5nZXRDb29yZGluYXRlKHNlZ0luZGV4KTt2YXIgcDE9c2VnU3RyLmdldENvb3JkaW5hdGUoc2VnSW5kZXgrMSk7aWYodGhpcy5pbnRlcnNlY3RzKHAwLHAxKSl7c2VnU3RyLmFkZEludGVyc2VjdGlvbih0aGlzLmdldENvb3JkaW5hdGUoKSxzZWdJbmRleCk7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXI9ZnVuY3Rpb24oaW5wdXRMaW5lKXt0aGlzLmlucHV0TGluZT1pbnB1dExpbmU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeT1mdW5jdGlvbihpbnB1dExpbmUsZGlzdGFuY2VUb2wpe3ZhciBzaW1wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllcihpbnB1dExpbmUpO3JldHVybiBzaW1wLnNpbXBsaWZ5KGRpc3RhbmNlVG9sKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLklOSVQ9MDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5ERUxFVEU9MTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5LRUVQPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlucHV0TGluZT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5kaXN0YW5jZVRvbD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0RlbGV0ZWQ9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuYW5nbGVPcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ09VTlRFUkNMT0NLV0lTRTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oZGlzdGFuY2VUb2wpe3RoaXMuZGlzdGFuY2VUb2w9TWF0aC5hYnMoZGlzdGFuY2VUb2wpO2lmKGRpc3RhbmNlVG9sPDApXG50aGlzLmFuZ2xlT3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRTt0aGlzLmlzRGVsZXRlZD1bXTt0aGlzLmlzRGVsZXRlZC5sZW5ndGg9dGhpcy5pbnB1dExpbmUubGVuZ3RoO3ZhciBpc0NoYW5nZWQ9ZmFsc2U7ZG97aXNDaGFuZ2VkPXRoaXMuZGVsZXRlU2hhbGxvd0NvbmNhdml0aWVzKCk7fXdoaWxlKGlzQ2hhbmdlZCk7cmV0dXJuIHRoaXMuY29sbGFwc2VMaW5lKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZGVsZXRlU2hhbGxvd0NvbmNhdml0aWVzPWZ1bmN0aW9uKCl7dmFyIGluZGV4PTE7dmFyIG1heEluZGV4PXRoaXMuaW5wdXRMaW5lLmxlbmd0aC0xO3ZhciBtaWRJbmRleD10aGlzLmZpbmROZXh0Tm9uRGVsZXRlZEluZGV4KGluZGV4KTt2YXIgbGFzdEluZGV4PXRoaXMuZmluZE5leHROb25EZWxldGVkSW5kZXgobWlkSW5kZXgpO3ZhciBpc0NoYW5nZWQ9ZmFsc2U7d2hpbGUobGFzdEluZGV4PHRoaXMuaW5wdXRMaW5lLmxlbmd0aCl7dmFyIGlzTWlkZGxlVmVydGV4RGVsZXRlZD1mYWxzZTtpZih0aGlzLmlzRGVsZXRhYmxlKGluZGV4LG1pZEluZGV4LGxhc3RJbmRleCx0aGlzLmRpc3RhbmNlVG9sKSl7dGhpcy5pc0RlbGV0ZWRbbWlkSW5kZXhdPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLkRFTEVURTtpc01pZGRsZVZlcnRleERlbGV0ZWQ9dHJ1ZTtpc0NoYW5nZWQ9dHJ1ZTt9XG5pZihpc01pZGRsZVZlcnRleERlbGV0ZWQpXG5pbmRleD1sYXN0SW5kZXg7ZWxzZVxuaW5kZXg9bWlkSW5kZXg7bWlkSW5kZXg9dGhpcy5maW5kTmV4dE5vbkRlbGV0ZWRJbmRleChpbmRleCk7bGFzdEluZGV4PXRoaXMuZmluZE5leHROb25EZWxldGVkSW5kZXgobWlkSW5kZXgpO31cbnJldHVybiBpc0NoYW5nZWQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuZmluZE5leHROb25EZWxldGVkSW5kZXg9ZnVuY3Rpb24oaW5kZXgpe3ZhciBuZXh0PWluZGV4KzE7d2hpbGUobmV4dDx0aGlzLmlucHV0TGluZS5sZW5ndGgmJnRoaXMuaXNEZWxldGVkW25leHRdPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuREVMRVRFKVxubmV4dCsrO3JldHVybiBuZXh0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmNvbGxhcHNlTGluZT1mdW5jdGlvbigpe3ZhciBjb29yZExpc3Q9W107Zm9yKHZhciBpPTA7aTx0aGlzLmlucHV0TGluZS5sZW5ndGg7aSsrKXtpZih0aGlzLmlzRGVsZXRlZFtpXSE9PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLkRFTEVURSlcbmNvb3JkTGlzdC5wdXNoKHRoaXMuaW5wdXRMaW5lW2ldKTt9XG5yZXR1cm4gY29vcmRMaXN0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlzRGVsZXRhYmxlPWZ1bmN0aW9uKGkwLGkxLGkyLGRpc3RhbmNlVG9sKXt2YXIgcDA9dGhpcy5pbnB1dExpbmVbaTBdO3ZhciBwMT10aGlzLmlucHV0TGluZVtpMV07dmFyIHAyPXRoaXMuaW5wdXRMaW5lW2kyXTtpZighdGhpcy5pc0NvbmNhdmUocDAscDEscDIpKVxucmV0dXJuIGZhbHNlO2lmKCF0aGlzLmlzU2hhbGxvdyhwMCxwMSxwMixkaXN0YW5jZVRvbCkpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIHRoaXMuaXNTaGFsbG93U2FtcGxlZChwMCxwMSxpMCxpMixkaXN0YW5jZVRvbCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5wcm90b3R5cGUuaXNTaGFsbG93Q29uY2F2aXR5PWZ1bmN0aW9uKHAwLHAxLHAyLGRpc3RhbmNlVG9sKXt2YXIgb3JpZW50YXRpb249anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihwMCxwMSxwMik7dmFyIGlzQW5nbGVUb1NpbXBsaWZ5PShvcmllbnRhdGlvbj09PXRoaXMuYW5nbGVPcmllbnRhdGlvbik7aWYoIWlzQW5nbGVUb1NpbXBsaWZ5KVxucmV0dXJuIGZhbHNlO3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShwMSxwMCxwMik7cmV0dXJuIGRpc3Q8ZGlzdGFuY2VUb2w7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5OVU1fUFRTX1RPX0NIRUNLPTEwO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc1NoYWxsb3dTYW1wbGVkPWZ1bmN0aW9uKHAwLHAyLGkwLGkyLGRpc3RhbmNlVG9sKXt2YXIgaW5jPXBhcnNlSW50KChpMi1pMCkvanN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuTlVNX1BUU19UT19DSEVDSyk7aWYoaW5jPD0wKVxuaW5jPTE7Zm9yKHZhciBpPWkwO2k8aTI7aSs9aW5jKXtpZighdGhpcy5pc1NoYWxsb3cocDAscDIsdGhpcy5pbnB1dExpbmVbaV0sZGlzdGFuY2VUb2wpKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIucHJvdG90eXBlLmlzU2hhbGxvdz1mdW5jdGlvbihwMCxwMSxwMixkaXN0YW5jZVRvbCl7dmFyIGRpc3Q9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmRpc3RhbmNlUG9pbnRMaW5lKHAxLHAwLHAyKTtyZXR1cm4gZGlzdDxkaXN0YW5jZVRvbDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0NvbmNhdmU9ZnVuY3Rpb24ocDAscDEscDIpe3ZhciBvcmllbnRhdGlvbj1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHAwLHAxLHAyKTt2YXIgaXNDb25jYXZlPShvcmllbnRhdGlvbj09PXRoaXMuYW5nbGVPcmllbnRhdGlvbik7cmV0dXJuIGlzQ29uY2F2ZTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50PWZ1bmN0aW9uKHgsb2JqLGxhYmVsKXtpZighKG9iaiBpbnN0YW5jZW9mIGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KSl7dGhpcy5ldmVudFR5cGU9anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuSU5TRVJUO3RoaXMubGFiZWw9bGFiZWw7dGhpcy54VmFsdWU9eDt0aGlzLm9iaj1vYmo7cmV0dXJuO31cbnRoaXMuZXZlbnRUeXBlPWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LkRFTEVURTt0aGlzLnhWYWx1ZT14O3RoaXMuaW5zZXJ0RXZlbnQ9b2JqO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuSU5TRVJUPTE7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuREVMRVRFPTI7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmxhYmVsPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLnhWYWx1ZT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5ldmVudFR5cGU9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaW5zZXJ0RXZlbnQ9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZGVsZXRlRXZlbnRJbmRleD1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5vYmo9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaXNJbnNlcnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ldmVudFR5cGU9PWpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LklOU0VSVDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5pc0RlbGV0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmV2ZW50VHlwZT09anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQuREVMRVRFO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lRXZlbnQucHJvdG90eXBlLmdldEluc2VydEV2ZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5zZXJ0RXZlbnQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuZ2V0RGVsZXRlRXZlbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRlbGV0ZUV2ZW50SW5kZXg7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuc2V0RGVsZXRlRXZlbnRJbmRleD1mdW5jdGlvbihkZWxldGVFdmVudEluZGV4KXt0aGlzLmRlbGV0ZUV2ZW50SW5kZXg9ZGVsZXRlRXZlbnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50LnByb3RvdHlwZS5nZXRPYmplY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vYmo7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuaXNTYW1lTGFiZWw9ZnVuY3Rpb24oZXYpe2lmKHRoaXMubGFiZWw9PW51bGwpe3JldHVybiBmYWxzZTt9XG5yZXR1cm4gdGhpcy5sYWJlbD09ZXYubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKHBlKXtpZih0aGlzLnhWYWx1ZTxwZS54VmFsdWUpe3JldHVybi0xO31cbmlmKHRoaXMueFZhbHVlPnBlLnhWYWx1ZSl7cmV0dXJuIDE7fVxuaWYodGhpcy5ldmVudFR5cGU8cGUuZXZlbnRUeXBlKXtyZXR1cm4tMTt9XG5pZih0aGlzLmV2ZW50VHlwZT5wZS5ldmVudFR5cGUpe3JldHVybiAxO31cbnJldHVybiAwO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0PWZ1bmN0aW9uKGNvb3JkLGFsbG93UmVwZWF0ZWQpe3RoaXMuYXJyYXk9W107YWxsb3dSZXBlYXRlZD0oYWxsb3dSZXBlYXRlZD09PXVuZGVmaW5lZCk/dHJ1ZTphbGxvd1JlcGVhdGVkO2lmKGNvb3JkIT09dW5kZWZpbmVkKXt0aGlzLmFkZChjb29yZCxhbGxvd1JlcGVhdGVkKTt9fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1udWxsO2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUucmVtb3ZlPW51bGw7anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oaSl7cmV0dXJuIHRoaXMuYXJyYXlbaV07fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLnNldD1mdW5jdGlvbihpLGUpe3ZhciBvPXRoaXMuYXJyYXlbaV07dGhpcy5hcnJheVtpXT1lO3JldHVybiBvO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXJyYXkubGVuZ3RoO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjEpe3JldHVybiB0aGlzLmFkZENvb3JkaW5hdGVzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9ZWxzZXtyZXR1cm4gdGhpcy5hcnJheS5wdXNoKGFyZ3VtZW50c1swXSk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5hZGRDb29yZGluYXRlcz1mdW5jdGlvbihjb29yZCxhbGxvd1JlcGVhdGVkLGRpcmVjdGlvbil7aWYoY29vcmQgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIHRoaXMuYWRkQ29vcmRpbmF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fWVsc2UgaWYodHlwZW9mIGNvb3JkPT09J251bWJlcicpe3JldHVybiB0aGlzLmluc2VydENvb3JkaW5hdGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmRpcmVjdGlvbj1kaXJlY3Rpb258fHRydWU7aWYoZGlyZWN0aW9uKXtmb3IodmFyIGk9MDtpPGNvb3JkLmxlbmd0aDtpKyspe3RoaXMuYWRkQ29vcmRpbmF0ZShjb29yZFtpXSxhbGxvd1JlcGVhdGVkKTt9fWVsc2V7Zm9yKHZhciBpPWNvb3JkLmxlbmd0aC0xO2k+PTA7aS0tKXt0aGlzLmFkZENvb3JkaW5hdGUoY29vcmRbaV0sYWxsb3dSZXBlYXRlZCk7fX1cbnJldHVybiB0cnVlO307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS5hZGRDb29yZGluYXRlPWZ1bmN0aW9uKGNvb3JkLGFsbG93UmVwZWF0ZWQpe2lmKCFhbGxvd1JlcGVhdGVkKXtpZih0aGlzLnNpemUoKT49MSl7dmFyIGxhc3Q9dGhpcy5nZXQodGhpcy5zaXplKCktMSk7aWYobGFzdC5lcXVhbHMyRChjb29yZCkpcmV0dXJuO319XG50aGlzLmFkZChjb29yZCk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QucHJvdG90eXBlLmluc2VydENvb3JkaW5hdGU9ZnVuY3Rpb24oaW5kZXgsY29vcmQsYWxsb3dSZXBlYXRlZCl7aWYoIWFsbG93UmVwZWF0ZWQpe3ZhciBiZWZvcmU9aW5kZXg+MD9pbmRleC0xOi0xO2lmKGJlZm9yZSE9PS0xJiZ0aGlzLmdldChiZWZvcmUpLmVxdWFsczJEKGNvb3JkKSl7cmV0dXJuO31cbnZhciBhZnRlcj1pbmRleDx0aGlzLnNpemUoKS0xP2luZGV4KzE6LTE7aWYoYWZ0ZXIhPT0tMSYmdGhpcy5nZXQoYWZ0ZXIpLmVxdWFsczJEKGNvb3JkKSl7cmV0dXJuO319XG50aGlzLmFycmF5LnNwbGljZShpbmRleCwwLGNvb3JkKTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUuY2xvc2VSaW5nPWZ1bmN0aW9uKCl7aWYodGhpcy5zaXplKCk+MCl7dGhpcy5hZGRDb29yZGluYXRlKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLmdldCgwKSksZmFsc2UpO319O2pzdHMuZ2VvbS5Db29yZGluYXRlTGlzdC5wcm90b3R5cGUudG9BcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFycmF5O307anN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0LnByb3RvdHlwZS50b0Nvb3JkaW5hdGVBcnJheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFycmF5O307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3I9ZnVuY3Rpb24ocHJlY2lzaW9uTW9kZWwsYnVmUGFyYW1zLGRpc3RhbmNlKXt0aGlzLnNlZzA9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuc2VnMT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5vZmZzZXQwPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLm9mZnNldDE9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMucHJlY2lzaW9uTW9kZWw9cHJlY2lzaW9uTW9kZWw7dGhpcy5idWZQYXJhbXM9YnVmUGFyYW1zO3RoaXMubGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO3RoaXMuZmlsbGV0QW5nbGVRdWFudHVtPU1hdGguUEkvMi4wL2J1ZlBhcmFtcy5nZXRRdWFkcmFudFNlZ21lbnRzKCk7aWYodGhpcy5idWZQYXJhbXMuZ2V0UXVhZHJhbnRTZWdtZW50cygpPj04JiZ0aGlzLmJ1ZlBhcmFtcy5nZXRKb2luU3R5bGUoKT09PWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fUk9VTkQpe3RoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcj1qc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5NQVhfQ0xPU0lOR19TRUdfTEVOX0ZBQ1RPUjt9XG50aGlzLmluaXQoZGlzdGFuY2UpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuT0ZGU0VUX1NFR01FTlRfU0VQQVJBVElPTl9GQUNUT1I9MS4wRS0zO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLklOU0lERV9UVVJOX1ZFUlRFWF9TTkFQX0RJU1RBTkNFX0ZBQ1RPUj0xLjBFLTM7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IuQ1VSVkVfVkVSVEVYX1NOQVBfRElTVEFOQ0VfRkFDVE9SPTEuMEUtNjtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5NQVhfQ0xPU0lOR19TRUdfTEVOX0ZBQ1RPUj04MDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUubWF4Q3VydmVTZWdtZW50RXJyb3I9MC4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5maWxsZXRBbmdsZVF1YW50dW09bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuY2xvc2luZ1NlZ0xlbmd0aEZhY3Rvcj0xO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5zZWdMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmRpc3RhbmNlPTAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYnVmUGFyYW1zPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmxpPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnMwPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnMxPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnMyPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLnNlZzA9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuc2VnMT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5vZmZzZXQwPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLm9mZnNldDE9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuc2lkZT0wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5oYXNOYXJyb3dDb25jYXZlQW5nbGU9ZmFsc2U7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmhhc05hcnJvd0NvbmNhdmVBbmdsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc05hcnJvd0NvbmNhdmVBbmdsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5pbml0PWZ1bmN0aW9uKGRpc3RhbmNlKXt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlO3RoaXMubWF4Q3VydmVTZWdtZW50RXJyb3I9dGhpcy5kaXN0YW5jZSooMS1NYXRoLmNvcyh0aGlzLmZpbGxldEFuZ2xlUXVhbnR1bS8yLjApKTt0aGlzLnNlZ0xpc3Q9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nKCk7dGhpcy5zZWdMaXN0LnNldFByZWNpc2lvbk1vZGVsKHRoaXMucHJlY2lzaW9uTW9kZWwpO3RoaXMuc2VnTGlzdC5zZXRNaW5pbXVtVmVydGV4RGlzdGFuY2UodGhpcy5kaXN0YW5jZSpqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5DVVJWRV9WRVJURVhfU05BUF9ESVNUQU5DRV9GQUNUT1IpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmluaXRTaWRlU2VnbWVudHM9ZnVuY3Rpb24oczEsczIsc2lkZSl7dGhpcy5zMT1zMTt0aGlzLnMyPXMyO3RoaXMuc2lkZT1zaWRlO3RoaXMuc2VnMS5zZXRDb29yZGluYXRlcyh0aGlzLnMxLHRoaXMuczIpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQodGhpcy5zZWcxLHRoaXMuc2lkZSx0aGlzLmRpc3RhbmNlLHRoaXMub2Zmc2V0MSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWdMaXN0LmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuY2xvc2VSaW5nPWZ1bmN0aW9uKCl7dGhpcy5zZWdMaXN0LmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZFNlZ21lbnRzPWZ1bmN0aW9uKHB0LGlzRm9yd2FyZCl7dGhpcy5zZWdMaXN0LmFkZFB0cyhwdCxpc0ZvcndhcmQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEZpcnN0U2VnbWVudD1mdW5jdGlvbigpe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDApO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZExhc3RTZWdtZW50PWZ1bmN0aW9uKCl7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MS5wMSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkTmV4dFNlZ21lbnQ9ZnVuY3Rpb24ocCxhZGRTdGFydFBvaW50KXt0aGlzLnMwPXRoaXMuczE7dGhpcy5zMT10aGlzLnMyO3RoaXMuczI9cDt0aGlzLnNlZzAuc2V0Q29vcmRpbmF0ZXModGhpcy5zMCx0aGlzLnMxKTt0aGlzLmNvbXB1dGVPZmZzZXRTZWdtZW50KHRoaXMuc2VnMCx0aGlzLnNpZGUsdGhpcy5kaXN0YW5jZSx0aGlzLm9mZnNldDApO3RoaXMuc2VnMS5zZXRDb29yZGluYXRlcyh0aGlzLnMxLHRoaXMuczIpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQodGhpcy5zZWcxLHRoaXMuc2lkZSx0aGlzLmRpc3RhbmNlLHRoaXMub2Zmc2V0MSk7aWYodGhpcy5zMS5lcXVhbHModGhpcy5zMikpXG5yZXR1cm47dmFyIG9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24odGhpcy5zMCx0aGlzLnMxLHRoaXMuczIpO3ZhciBvdXRzaWRlVHVybj0ob3JpZW50YXRpb249PT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFJiZ0aGlzLnNpZGU9PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKXx8KG9yaWVudGF0aW9uPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0UmJnRoaXMuc2lkZT09PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUKTtpZihvcmllbnRhdGlvbj09MCl7dGhpcy5hZGRDb2xsaW5lYXIoYWRkU3RhcnRQb2ludCk7fWVsc2UgaWYob3V0c2lkZVR1cm4pe3RoaXMuYWRkT3V0c2lkZVR1cm4ob3JpZW50YXRpb24sYWRkU3RhcnRQb2ludCk7fWVsc2V7dGhpcy5hZGRJbnNpZGVUdXJuKG9yaWVudGF0aW9uLGFkZFN0YXJ0UG9pbnQpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRDb2xsaW5lYXI9ZnVuY3Rpb24oYWRkU3RhcnRQb2ludCl7dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHRoaXMuczAsdGhpcy5zMSx0aGlzLnMxLHRoaXMuczIpO3ZhciBudW1JbnQ9dGhpcy5saS5nZXRJbnRlcnNlY3Rpb25OdW0oKTtpZihudW1JbnQ+PTIpe2lmKHRoaXMuYnVmUGFyYW1zLmdldEpvaW5TdHlsZSgpPT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9CRVZFTHx8dGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX01JVFJFKXtpZihhZGRTdGFydFBvaW50KVxudGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MS5wMCk7fWVsc2V7dGhpcy5hZGRGaWxsZXQodGhpcy5zMSx0aGlzLm9mZnNldDAucDEsdGhpcy5vZmZzZXQxLnAwLGpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0UsdGhpcy5kaXN0YW5jZSk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRPdXRzaWRlVHVybj1mdW5jdGlvbihvcmllbnRhdGlvbixhZGRTdGFydFBvaW50KXtpZih0aGlzLm9mZnNldDAucDEuZGlzdGFuY2UodGhpcy5vZmZzZXQxLnAwKTx0aGlzLmRpc3RhbmNlKmpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLk9GRlNFVF9TRUdNRU5UX1NFUEFSQVRJT05fRkFDVE9SKXt0aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQwLnAxKTtyZXR1cm47fVxuaWYodGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX01JVFJFKXt0aGlzLmFkZE1pdHJlSm9pbih0aGlzLnMxLHRoaXMub2Zmc2V0MCx0aGlzLm9mZnNldDEsdGhpcy5kaXN0YW5jZSk7fWVsc2UgaWYodGhpcy5idWZQYXJhbXMuZ2V0Sm9pblN0eWxlKCk9PT1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX0JFVkVMKXt0aGlzLmFkZEJldmVsSm9pbih0aGlzLm9mZnNldDAsdGhpcy5vZmZzZXQxKTt9ZWxzZXtpZihhZGRTdGFydFBvaW50KVxudGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7dGhpcy5hZGRGaWxsZXQodGhpcy5zMSx0aGlzLm9mZnNldDAucDEsdGhpcy5vZmZzZXQxLnAwLG9yaWVudGF0aW9uLHRoaXMuZGlzdGFuY2UpO3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLm9mZnNldDEucDApO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5hZGRJbnNpZGVUdXJuPWZ1bmN0aW9uKG9yaWVudGF0aW9uLGFkZFN0YXJ0UG9pbnQpe3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbih0aGlzLm9mZnNldDAucDAsdGhpcy5vZmZzZXQwLnAxLHRoaXMub2Zmc2V0MS5wMCx0aGlzLm9mZnNldDEucDEpO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpe3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLmxpLmdldEludGVyc2VjdGlvbigwKSk7fWVsc2V7dGhpcy5oYXNOYXJyb3dDb25jYXZlQW5nbGU9dHJ1ZTtpZih0aGlzLm9mZnNldDAucDEuZGlzdGFuY2UodGhpcy5vZmZzZXQxLnAwKTx0aGlzLmRpc3RhbmNlKmpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLklOU0lERV9UVVJOX1ZFUlRFWF9TTkFQX0RJU1RBTkNFX0ZBQ1RPUil7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7fWVsc2V7dGhpcy5zZWdMaXN0LmFkZFB0KHRoaXMub2Zmc2V0MC5wMSk7aWYodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yPjApe3ZhciBtaWQwPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MC5wMS54K3RoaXMuczEueCkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSwodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MC5wMS55K3RoaXMuczEueSkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG1pZDApO3ZhciBtaWQxPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MS5wMC54K3RoaXMuczEueCkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSwodGhpcy5jbG9zaW5nU2VnTGVuZ3RoRmFjdG9yKnRoaXMub2Zmc2V0MS5wMC55K3RoaXMuczEueSkvKHRoaXMuY2xvc2luZ1NlZ0xlbmd0aEZhY3RvcisxKSk7dGhpcy5zZWdMaXN0LmFkZFB0KG1pZDEpO31lbHNle3RoaXMuc2VnTGlzdC5hZGRQdCh0aGlzLnMxKTt9XG50aGlzLnNlZ0xpc3QuYWRkUHQodGhpcy5vZmZzZXQxLnAwKTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNvbXB1dGVPZmZzZXRTZWdtZW50PWZ1bmN0aW9uKHNlZyxzaWRlLGRpc3RhbmNlLG9mZnNldCl7dmFyIHNpZGVTaWduPXNpZGU9PT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUPzE6LTE7dmFyIGR4PXNlZy5wMS54LXNlZy5wMC54O3ZhciBkeT1zZWcucDEueS1zZWcucDAueTt2YXIgbGVuPU1hdGguc3FydChkeCpkeCtkeSpkeSk7dmFyIHV4PXNpZGVTaWduKmRpc3RhbmNlKmR4L2xlbjt2YXIgdXk9c2lkZVNpZ24qZGlzdGFuY2UqZHkvbGVuO29mZnNldC5wMC54PXNlZy5wMC54LXV5O29mZnNldC5wMC55PXNlZy5wMC55K3V4O29mZnNldC5wMS54PXNlZy5wMS54LXV5O29mZnNldC5wMS55PXNlZy5wMS55K3V4O307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZExpbmVFbmRDYXA9ZnVuY3Rpb24ocDAscDEpe3ZhciBzZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChwMCxwMSk7dmFyIG9mZnNldEw9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMuY29tcHV0ZU9mZnNldFNlZ21lbnQoc2VnLGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQsdGhpcy5kaXN0YW5jZSxvZmZzZXRMKTt2YXIgb2Zmc2V0Uj1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KCk7dGhpcy5jb21wdXRlT2Zmc2V0U2VnbWVudChzZWcsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQsdGhpcy5kaXN0YW5jZSxvZmZzZXRSKTt2YXIgZHg9cDEueC1wMC54O3ZhciBkeT1wMS55LXAwLnk7dmFyIGFuZ2xlPU1hdGguYXRhbjIoZHksZHgpO3N3aXRjaCh0aGlzLmJ1ZlBhcmFtcy5nZXRFbmRDYXBTdHlsZSgpKXtjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9ST1VORDp0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0TC5wMSk7dGhpcy5hZGRGaWxsZXQocDEsYW5nbGUrTWF0aC5QSS8yLGFuZ2xlLU1hdGguUEkvMixqc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuQ0xPQ0tXSVNFLHRoaXMuZGlzdGFuY2UpO3RoaXMuc2VnTGlzdC5hZGRQdChvZmZzZXRSLnAxKTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9GTEFUOnRoaXMuc2VnTGlzdC5hZGRQdChvZmZzZXRMLnAxKTt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0Ui5wMSk7YnJlYWs7Y2FzZSBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfU1FVQVJFOnZhciBzcXVhcmVDYXBTaWRlT2Zmc2V0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3NxdWFyZUNhcFNpZGVPZmZzZXQueD1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKSpNYXRoLmNvcyhhbmdsZSk7c3F1YXJlQ2FwU2lkZU9mZnNldC55PU1hdGguYWJzKHRoaXMuZGlzdGFuY2UpKk1hdGguc2luKGFuZ2xlKTt2YXIgc3F1YXJlQ2FwTE9mZnNldD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUob2Zmc2V0TC5wMS54K1xuc3F1YXJlQ2FwU2lkZU9mZnNldC54LG9mZnNldEwucDEueStzcXVhcmVDYXBTaWRlT2Zmc2V0LnkpO3ZhciBzcXVhcmVDYXBST2Zmc2V0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShvZmZzZXRSLnAxLngrXG5zcXVhcmVDYXBTaWRlT2Zmc2V0Lngsb2Zmc2V0Ui5wMS55K3NxdWFyZUNhcFNpZGVPZmZzZXQueSk7dGhpcy5zZWdMaXN0LmFkZFB0KHNxdWFyZUNhcExPZmZzZXQpO3RoaXMuc2VnTGlzdC5hZGRQdChzcXVhcmVDYXBST2Zmc2V0KTticmVhazt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkTWl0cmVKb2luPWZ1bmN0aW9uKHAsb2Zmc2V0MCxvZmZzZXQxLGRpc3RhbmNlKXt2YXIgaXNNaXRyZVdpdGhpbkxpbWl0PXRydWU7dmFyIGludFB0PW51bGw7dHJ5e2ludFB0PWpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlLmludGVyc2VjdGlvbihvZmZzZXQwLnAwLG9mZnNldDAucDEsb2Zmc2V0MS5wMCxvZmZzZXQxLnAxKTt2YXIgbWl0cmVSYXRpbz1kaXN0YW5jZTw9MC4wPzEuMDppbnRQdC5kaXN0YW5jZShwKS9NYXRoLmFicyhkaXN0YW5jZSk7aWYobWl0cmVSYXRpbz50aGlzLmJ1ZlBhcmFtcy5nZXRNaXRyZUxpbWl0KCkpXG50aGlzLmlzTWl0cmVXaXRoaW5MaW1pdD1mYWxzZTt9Y2F0Y2goZSl7aWYoZSBpbnN0YW5jZW9mIGpzdHMuZXJyb3IuTm90UmVwcmVzZW50YWJsZUVycm9yKXtpbnRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoMCwwKTt0aGlzLmlzTWl0cmVXaXRoaW5MaW1pdD1mYWxzZTt9fVxuaWYoaXNNaXRyZVdpdGhpbkxpbWl0KXt0aGlzLnNlZ0xpc3QuYWRkUHQoaW50UHQpO31lbHNle3RoaXMuYWRkTGltaXRlZE1pdHJlSm9pbihvZmZzZXQwLG9mZnNldDEsZGlzdGFuY2UsYnVmUGFyYW1zLmdldE1pdHJlTGltaXQoKSk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZExpbWl0ZWRNaXRyZUpvaW49ZnVuY3Rpb24ob2Zmc2V0MCxvZmZzZXQxLGRpc3RhbmNlLG1pdHJlTGltaXQpe3ZhciBiYXNlUHQ9dGhpcy5zZWcwLnAxO3ZhciBhbmcwPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKGJhc2VQdCx0aGlzLnNlZzAucDApO3ZhciBhbmcxPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlKGJhc2VQdCx0aGlzLnNlZzEucDEpO3ZhciBhbmdEaWZmPWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmFuZ2xlQmV0d2Vlbk9yaWVudGVkKHRoaXMuc2VnMC5wMCxiYXNlUHQsdGhpcy5zZWcxLnAxKTt2YXIgYW5nRGlmZkhhbGY9YW5nRGlmZi8yO3ZhciBtaWRBbmc9anN0cy5hbGdvcml0aG0uQW5nbGUubm9ybWFsaXplKGFuZzArYW5nRGlmZkhhbGYpO3ZhciBtaXRyZU1pZEFuZz1qc3RzLmFsZ29yaXRobS5BbmdsZS5ub3JtYWxpemUobWlkQW5nK01hdGguUEkpO3ZhciBtaXRyZURpc3Q9bWl0cmVMaW1pdCpkaXN0YW5jZTt2YXIgYmV2ZWxEZWx0YT1taXRyZURpc3QqTWF0aC5hYnMoTWF0aC5zaW4oYW5nRGlmZkhhbGYpKTt2YXIgYmV2ZWxIYWxmTGVuPWRpc3RhbmNlLWJldmVsRGVsdGE7dmFyIGJldmVsTWlkWD1iYXNlUHQueCttaXRyZURpc3QqTWF0aC5jb3MobWl0cmVNaWRBbmcpO3ZhciBiZXZlbE1pZFk9YmFzZVB0LnkrbWl0cmVEaXN0Kk1hdGguc2luKG1pdHJlTWlkQW5nKTt2YXIgYmV2ZWxNaWRQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYmV2ZWxNaWRYLGJldmVsTWlkWSk7dmFyIG1pdHJlTWlkTGluZT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGJhc2VQdCxiZXZlbE1pZFB0KTt2YXIgYmV2ZWxFbmRMZWZ0PW1pdHJlTWlkTGluZS5wb2ludEFsb25nT2Zmc2V0KDEuMCxiZXZlbEhhbGZMZW4pO3ZhciBiZXZlbEVuZFJpZ2h0PW1pdHJlTWlkTGluZS5wb2ludEFsb25nT2Zmc2V0KDEuMCwtYmV2ZWxIYWxmTGVuKTtpZih0aGlzLnNpZGU9PWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpe3RoaXMuc2VnTGlzdC5hZGRQdChiZXZlbEVuZExlZnQpO3RoaXMuc2VnTGlzdC5hZGRQdChiZXZlbEVuZFJpZ2h0KTt9ZWxzZXt0aGlzLnNlZ0xpc3QuYWRkUHQoYmV2ZWxFbmRSaWdodCk7dGhpcy5zZWdMaXN0LmFkZFB0KGJldmVsRW5kTGVmdCk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEJldmVsSm9pbj1mdW5jdGlvbihvZmZzZXQwLG9mZnNldDEpe3RoaXMuc2VnTGlzdC5hZGRQdChvZmZzZXQwLnAxKTt0aGlzLnNlZ0xpc3QuYWRkUHQob2Zmc2V0MS5wMCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudEdlbmVyYXRvci5wcm90b3R5cGUuYWRkRmlsbGV0PWZ1bmN0aW9uKHAscDAscDEsZGlyZWN0aW9uLHJhZGl1cyl7aWYoIShwMSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKSl7dGhpcy5hZGRGaWxsZXQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIGR4MD1wMC54LXAueDt2YXIgZHkwPXAwLnktcC55O3ZhciBzdGFydEFuZ2xlPU1hdGguYXRhbjIoZHkwLGR4MCk7dmFyIGR4MT1wMS54LXAueDt2YXIgZHkxPXAxLnktcC55O3ZhciBlbmRBbmdsZT1NYXRoLmF0YW4yKGR5MSxkeDEpO2lmKGRpcmVjdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0Upe2lmKHN0YXJ0QW5nbGU8PWVuZEFuZ2xlKVxuc3RhcnRBbmdsZSs9Mi4wKk1hdGguUEk7fWVsc2V7aWYoc3RhcnRBbmdsZT49ZW5kQW5nbGUpXG5zdGFydEFuZ2xlLT0yLjAqTWF0aC5QSTt9XG50aGlzLnNlZ0xpc3QuYWRkUHQocDApO3RoaXMuYWRkRmlsbGV0KHAsc3RhcnRBbmdsZSxlbmRBbmdsZSxkaXJlY3Rpb24scmFkaXVzKTt0aGlzLnNlZ0xpc3QuYWRkUHQocDEpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmFkZEZpbGxldDI9ZnVuY3Rpb24ocCxzdGFydEFuZ2xlLGVuZEFuZ2xlLGRpcmVjdGlvbixyYWRpdXMpe3ZhciBkaXJlY3Rpb25GYWN0b3I9ZGlyZWN0aW9uPT09anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLkNMT0NLV0lTRT8tMToxO3ZhciB0b3RhbEFuZ2xlPU1hdGguYWJzKHN0YXJ0QW5nbGUtZW5kQW5nbGUpO3ZhciBuU2Vncz1wYXJzZUludCgodG90YWxBbmdsZS90aGlzLmZpbGxldEFuZ2xlUXVhbnR1bSswLjUpKTtpZihuU2VnczwxKVxucmV0dXJuO3ZhciBpbml0QW5nbGUsY3VyckFuZ2xlSW5jO2luaXRBbmdsZT0wLjA7Y3VyckFuZ2xlSW5jPXRvdGFsQW5nbGUvblNlZ3M7dmFyIGN1cnJBbmdsZT1pbml0QW5nbGU7dmFyIHB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3doaWxlKGN1cnJBbmdsZTx0b3RhbEFuZ2xlKXt2YXIgYW5nbGU9c3RhcnRBbmdsZStkaXJlY3Rpb25GYWN0b3IqY3VyckFuZ2xlO3B0Lng9cC54K3JhZGl1cypNYXRoLmNvcyhhbmdsZSk7cHQueT1wLnkrcmFkaXVzKk1hdGguc2luKGFuZ2xlKTt0aGlzLnNlZ0xpc3QuYWRkUHQocHQpO2N1cnJBbmdsZSs9Y3VyckFuZ2xlSW5jO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50R2VuZXJhdG9yLnByb3RvdHlwZS5jcmVhdGVDaXJjbGU9ZnVuY3Rpb24ocCl7dmFyIHB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwLngrdGhpcy5kaXN0YW5jZSxwLnkpO3RoaXMuc2VnTGlzdC5hZGRQdChwdCk7dGhpcy5hZGRGaWxsZXQocCwwLjAsMi4wKk1hdGguUEksLTEsdGhpcy5kaXN0YW5jZSk7dGhpcy5zZWdMaXN0LmNsb3NlUmluZygpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IucHJvdG90eXBlLmNyZWF0ZVNxdWFyZT1mdW5jdGlvbihwKXt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueCtkaXN0YW5jZSxwLnkrZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueCtkaXN0YW5jZSxwLnktZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueC1kaXN0YW5jZSxwLnktZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuYWRkUHQobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKHAueC1kaXN0YW5jZSxwLnkrZGlzdGFuY2UpKTt0aGlzLnNlZ0xpc3QuY2xvc2VSaW5nKCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZz1mdW5jdGlvbihzdGFydCxnZW9tZXRyeUZhY3Rvcnkpe2pzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nLmNhbGwodGhpcyxzdGFydCxnZW9tZXRyeUZhY3RvcnkpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlUmluZygpO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLmNvbnN0cnVjdG9yPWpzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nO2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWF4aW1hbEVkZ2VSaW5nLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKGRlKVxue3JldHVybiBkZS5nZXROZXh0KCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1heGltYWxFZGdlUmluZy5wcm90b3R5cGUuc2V0RWRnZVJpbmc9ZnVuY3Rpb24oZGUsZXIpXG57ZGUuc2V0RWRnZVJpbmcoZXIpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlLmxpbmtEaXJlY3RlZEVkZ2VzRm9yTWluaW1hbEVkZ2VSaW5ncz1mdW5jdGlvbigpXG57dmFyIGRlPXRoaXMuc3RhcnREZTtkb3t2YXIgbm9kZT1kZS5nZXROb2RlKCk7bm9kZS5nZXRFZGdlcygpLmxpbmtNaW5pbWFsRGlyZWN0ZWRFZGdlcyh0aGlzKTtkZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT10aGlzLnN0YXJ0RGUpO307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NYXhpbWFsRWRnZVJpbmcucHJvdG90eXBlLmJ1aWxkTWluaW1hbFJpbmdzPWZ1bmN0aW9uKClcbnt2YXIgbWluRWRnZVJpbmdzPVtdO3ZhciBkZT10aGlzLnN0YXJ0RGU7ZG97aWYoZGUuZ2V0TWluRWRnZVJpbmcoKT09PW51bGwpe3ZhciBtaW5Fcj1uZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcoZGUsdGhpcy5nZW9tZXRyeUZhY3RvcnkpO21pbkVkZ2VSaW5ncy5wdXNoKG1pbkVyKTt9XG5kZT1kZS5nZXROZXh0KCk7fXdoaWxlKGRlIT10aGlzLnN0YXJ0RGUpO3JldHVybiBtaW5FZGdlUmluZ3M7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50PWZ1bmN0aW9uKCl7dGhpcy5jZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUucHRDb3VudD0wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkUG9pbnQucHJvdG90eXBlLmNlbnRTdW09bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZFBvaW50LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7dGhpcy5hZGQyKGdlb20uZ2V0Q29vcmRpbmF0ZSgpKTt9ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5Q29sbGVjdGlvbnx8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pe3ZhciBnYz1nZW9tO2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2MuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihwdCl7dGhpcy5wdENvdW50Kz0xO3RoaXMuY2VudFN1bS54Kz1wdC54O3RoaXMuY2VudFN1bS55Kz1wdC55O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRQb2ludC5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXt2YXIgY2VudD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtjZW50Lng9dGhpcy5jZW50U3VtLngvdGhpcy5wdENvdW50O2NlbnQueT10aGlzLmNlbnRTdW0ueS90aGlzLnB0Q291bnQ7cmV0dXJuIGNlbnQ7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXI9ZnVuY3Rpb24obG9jYXRpb25zKXt0aGlzLmxvY2F0aW9ucz1sb2NhdGlvbnM7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlGaWx0ZXIoKTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIucHJvdG90eXBlLmxvY2F0aW9ucz1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkNvbm5lY3RlZEVsZW1lbnRMb2NhdGlvbkZpbHRlci5nZXRMb2NhdGlvbnM9ZnVuY3Rpb24oZ2VvbSl7dmFyIGxvY2F0aW9ucz1bXTtnZW9tLmFwcGx5KG5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIobG9jYXRpb25zKSk7cmV0dXJuIGxvY2F0aW9uczt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkNvbm5lY3RlZEVsZW1lbnRMb2NhdGlvbkZpbHRlci5wcm90b3R5cGUuZmlsdGVyPWZ1bmN0aW9uKGdlb20pe2lmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZ3x8Z2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxudGhpcy5sb2NhdGlvbnMucHVzaChuZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihnZW9tLDAsZ2VvbS5nZXRDb29yZGluYXRlKCkpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlPWZ1bmN0aW9uKGUpe3RoaXMuZT1lO3RoaXMucHRzPWUuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgbWNiPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlcigpO3RoaXMuc3RhcnRJbmRleD1tY2IuZ2V0Q2hhaW5TdGFydEluZGljZXModGhpcy5wdHMpO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmU9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUucHRzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLnN0YXJ0SW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZW52MT1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmVudjI9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5nZXRDb29yZGluYXRlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0czt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5nZXRTdGFydEluZGV4ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGFydEluZGV4O307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmdldE1pblg9ZnVuY3Rpb24oY2hhaW5JbmRleCl7dmFyIHgxPXRoaXMucHRzW3RoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4XV0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXgrMV1dLng7aWYoeDE8eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluRWRnZS5wcm90b3R5cGUuZ2V0TWF4WD1mdW5jdGlvbihjaGFpbkluZGV4KXt2YXIgeDE9dGhpcy5wdHNbdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXhdXS54O3ZhciB4Mj10aGlzLnB0c1t0aGlzLnN0YXJ0SW5kZXhbY2hhaW5JbmRleCsxXV0ueDtpZih4MT54Mil7cmV0dXJuIHgxO31cbnJldHVybiB4Mjt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5FZGdlLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0cz1mdW5jdGlvbihtY2Usc2kpe2Zvcih2YXIgaT0wO2k8dGhpcy5zdGFydEluZGV4Lmxlbmd0aC0xO2krKyl7Zm9yKHZhciBqPTA7ajxtY2Uuc3RhcnRJbmRleC5sZW5ndGgtMTtqKyspe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbihpLG1jZSxqLHNpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW49ZnVuY3Rpb24oY2hhaW5JbmRleDAsbWNlLGNoYWluSW5kZXgxLHNpKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKHRoaXMuc3RhcnRJbmRleFtjaGFpbkluZGV4MF0sdGhpcy5zdGFydEluZGV4W2NoYWluSW5kZXgwKzFdLG1jZSxtY2Uuc3RhcnRJbmRleFtjaGFpbkluZGV4MV0sbWNlLnN0YXJ0SW5kZXhbY2hhaW5JbmRleDErMV0sc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkVkZ2UucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yPWZ1bmN0aW9uKHN0YXJ0MCxlbmQwLG1jZSxzdGFydDEsZW5kMSxlaSl7dmFyIHAwMD10aGlzLnB0c1tzdGFydDBdO3ZhciBwMDE9dGhpcy5wdHNbZW5kMF07dmFyIHAxMD1tY2UucHRzW3N0YXJ0MV07dmFyIHAxMT1tY2UucHRzW2VuZDFdO2lmKGVuZDAtc3RhcnQwPT0xJiZlbmQxLXN0YXJ0MT09MSl7ZWkuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmUsc3RhcnQwLG1jZS5lLHN0YXJ0MSk7cmV0dXJuO31cbnRoaXMuZW52MS5pbml0KHAwMCxwMDEpO3RoaXMuZW52Mi5pbml0KHAxMCxwMTEpO2lmKCF0aGlzLmVudjEuaW50ZXJzZWN0cyh0aGlzLmVudjIpKXtyZXR1cm47fVxudmFyIG1pZDA9TWF0aC5mbG9vcigoc3RhcnQwK2VuZDApLzIpO3ZhciBtaWQxPU1hdGguZmxvb3IoKHN0YXJ0MStlbmQxKS8yKTtpZihzdGFydDA8bWlkMCl7aWYoc3RhcnQxPG1pZDEpe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbjIoc3RhcnQwLG1pZDAsbWNlLHN0YXJ0MSxtaWQxLGVpKTt9XG5pZihtaWQxPGVuZDEpe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbjIoc3RhcnQwLG1pZDAsbWNlLG1pZDEsZW5kMSxlaSk7fX1cbmlmKG1pZDA8ZW5kMCl7aWYoc3RhcnQxPG1pZDEpe3RoaXMuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbjIobWlkMCxlbmQwLG1jZSxzdGFydDEsbWlkMSxlaSk7fVxuaWYobWlkMTxlbmQxKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3RzRm9yQ2hhaW4yKG1pZDAsZW5kMCxtY2UsbWlkMSxlbmQxLGVpKTt9fX07KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlcj1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlRWRnZUVuZHM9ZnVuY3Rpb24oZWRnZXMpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PTIpe3RoaXMuY29tcHV0ZUVkZ2VFbmRzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBsPW5ldyBBcnJheUxpc3QoKTtmb3IodmFyIGk9ZWRnZXM7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt0aGlzLmNvbXB1dGVFZGdlRW5kczIoZSxsKTt9XG5yZXR1cm4gbDt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZUVkZ2VFbmRzMj1mdW5jdGlvbihlZGdlLGwpe3ZhciBlaUxpc3Q9ZWRnZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpO2VpTGlzdC5hZGRFbmRwb2ludHMoKTt2YXIgaXQ9ZWlMaXN0Lml0ZXJhdG9yKCk7dmFyIGVpUHJldj1udWxsO3ZhciBlaUN1cnI9bnVsbDtpZighaXQuaGFzTmV4dCgpKVxucmV0dXJuO3ZhciBlaU5leHQ9aXQubmV4dCgpO2Rve2VpUHJldj1laUN1cnI7ZWlDdXJyPWVpTmV4dDtlaU5leHQ9bnVsbDtpZihpdC5oYXNOZXh0KCkpXG5laU5leHQ9aXQubmV4dCgpO2lmKGVpQ3VyciE9PW51bGwpe3RoaXMuY3JlYXRlRWRnZUVuZEZvclByZXYoZWRnZSxsLGVpQ3VycixlaVByZXYpO3RoaXMuY3JlYXRlRWRnZUVuZEZvck5leHQoZWRnZSxsLGVpQ3VycixlaU5leHQpO319d2hpbGUoZWlDdXJyIT09bnVsbCk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZUVkZ2VFbmRGb3JQcmV2PWZ1bmN0aW9uKGVkZ2UsbCxlaUN1cnIsZWlQcmV2KXt2YXIgaVByZXY9ZWlDdXJyLnNlZ21lbnRJbmRleDtpZihlaUN1cnIuZGlzdD09PTAuMCl7aWYoaVByZXY9PT0wKVxucmV0dXJuO2lQcmV2LS07fVxudmFyIHBQcmV2PWVkZ2UuZ2V0Q29vcmRpbmF0ZShpUHJldik7aWYoZWlQcmV2IT09bnVsbCYmZWlQcmV2LnNlZ21lbnRJbmRleD49aVByZXYpXG5wUHJldj1laVByZXYuY29vcmQ7dmFyIGxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChlZGdlLmdldExhYmVsKCkpO2xhYmVsLmZsaXAoKTt2YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZChlZGdlLGVpQ3Vyci5jb29yZCxwUHJldixsYWJlbCk7bC5hZGQoZSk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZUVkZ2VFbmRGb3JOZXh0PWZ1bmN0aW9uKGVkZ2UsbCxlaUN1cnIsZWlOZXh0KXt2YXIgaU5leHQ9ZWlDdXJyLnNlZ21lbnRJbmRleCsxO2lmKGlOZXh0Pj1lZGdlLmdldE51bVBvaW50cygpJiZlaU5leHQ9PT1udWxsKVxucmV0dXJuO3ZhciBwTmV4dD1lZGdlLmdldENvb3JkaW5hdGUoaU5leHQpO2lmKGVpTmV4dCE9PW51bGwmJmVpTmV4dC5zZWdtZW50SW5kZXg9PT1laUN1cnIuc2VnbWVudEluZGV4KVxucE5leHQ9ZWlOZXh0LmNvb3JkO3ZhciBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlRW5kKGVkZ2UsZWlDdXJyLmNvb3JkLHBOZXh0LG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChlZGdlLmdldExhYmVsKCkpKTtsLmFkZChlKTt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEFycmF5TGlzdD1qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0O3ZhciBUcmVlU2V0PWphdmFzY3JpcHQudXRpbC5UcmVlU2V0O3ZhciBDb29yZGluYXRlRmlsdGVyPWpzdHMuZ2VvbS5Db29yZGluYXRlRmlsdGVyO2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXI9ZnVuY3Rpb24oKXt0aGlzLnRyZWVTZXQ9bmV3IFRyZWVTZXQoKTt0aGlzLmxpc3Q9bmV3IEFycmF5TGlzdCgpO307anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGU9bmV3IENvb3JkaW5hdGVGaWx0ZXIoKTtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyLnByb3RvdHlwZS50cmVlU2V0PW51bGw7anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlci5wcm90b3R5cGUubGlzdD1udWxsO2pzdHMudXRpbC5VbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXIucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGlzdC50b0FycmF5KCk7fTtqc3RzLnV0aWwuVW5pcXVlQ29vcmRpbmF0ZUFycmF5RmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oY29vcmQpe2lmKCF0aGlzLnRyZWVTZXQuY29udGFpbnMoY29vcmQpKXt0aGlzLmxpc3QuYWRkKGNvb3JkKTt0aGlzLnRyZWVTZXQuYWRkKGNvb3JkKTt9fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBDR0FsZ29yaXRobXM9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zO3ZhciBVbmlxdWVDb29yZGluYXRlQXJyYXlGaWx0ZXI9anN0cy51dGlsLlVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlcjt2YXIgQXNzZXJ0PWpzdHMudXRpbC5Bc3NlcnQ7dmFyIFN0YWNrPWphdmFzY3JpcHQudXRpbC5TdGFjazt2YXIgQXJyYXlMaXN0PWphdmFzY3JpcHQudXRpbC5BcnJheUxpc3Q7dmFyIEFycmF5cz1qYXZhc2NyaXB0LnV0aWwuQXJyYXlzO3ZhciBSYWRpYWxDb21wYXJhdG9yPWZ1bmN0aW9uKG9yaWdpbil7dGhpcy5vcmlnaW49b3JpZ2luO307UmFkaWFsQ29tcGFyYXRvci5wcm90b3R5cGUub3JpZ2luPW51bGw7UmFkaWFsQ29tcGFyYXRvci5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbihvMSxvMil7dmFyIHAxPW8xO3ZhciBwMj1vMjtyZXR1cm4gUmFkaWFsQ29tcGFyYXRvci5wb2xhckNvbXBhcmUodGhpcy5vcmlnaW4scDEscDIpO307UmFkaWFsQ29tcGFyYXRvci5wb2xhckNvbXBhcmU9ZnVuY3Rpb24obyxwLHEpe3ZhciBkeHA9cC54LW8ueDt2YXIgZHlwPXAueS1vLnk7dmFyIGR4cT1xLngtby54O3ZhciBkeXE9cS55LW8ueTt2YXIgb3JpZW50PUNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24obyxwLHEpO2lmKG9yaWVudD09Q0dBbGdvcml0aG1zLkNPVU5URVJDTE9DS1dJU0UpXG5yZXR1cm4gMTtpZihvcmllbnQ9PUNHQWxnb3JpdGhtcy5DTE9DS1dJU0UpXG5yZXR1cm4tMTt2YXIgb3A9ZHhwKmR4cCtkeXAqZHlwO3ZhciBvcT1keHEqZHhxK2R5cSpkeXE7aWYob3A8b3Epe3JldHVybi0xO31cbmlmKG9wPm9xKXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGw9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dmFyIGdlb21ldHJ5PWFyZ3VtZW50c1swXTt0aGlzLmlucHV0UHRzPWpzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwuZXh0cmFjdENvb3JkaW5hdGVzKGdlb21ldHJ5KTt0aGlzLmdlb21GYWN0b3J5PWdlb21ldHJ5LmdldEZhY3RvcnkoKTt9ZWxzZXt0aGlzLnB0cz1hcmd1bWVudHNbMF07dGhpcy5nZW9tRmFjdG9yeT1hcmd1bWVudHNbMV07fX07anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuZ2VvbUZhY3Rvcnk9bnVsbDtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5pbnB1dFB0cz1udWxsO2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwuZXh0cmFjdENvb3JkaW5hdGVzPWZ1bmN0aW9uKGdlb20pe3ZhciBmaWx0ZXI9bmV3IFVuaXF1ZUNvb3JkaW5hdGVBcnJheUZpbHRlcigpO2dlb20uYXBwbHkoZmlsdGVyKTtyZXR1cm4gZmlsdGVyLmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5nZXRDb252ZXhIdWxsPWZ1bmN0aW9uKCl7aWYodGhpcy5pbnB1dFB0cy5sZW5ndGg9PTApe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9XG5pZih0aGlzLmlucHV0UHRzLmxlbmd0aD09MSl7cmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuY3JlYXRlUG9pbnQodGhpcy5pbnB1dFB0c1swXSk7fVxuaWYodGhpcy5pbnB1dFB0cy5sZW5ndGg9PTIpe3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUxpbmVTdHJpbmcodGhpcy5pbnB1dFB0cyk7fVxudmFyIHJlZHVjZWRQdHM9dGhpcy5pbnB1dFB0cztpZih0aGlzLmlucHV0UHRzLmxlbmd0aD41MCl7cmVkdWNlZFB0cz10aGlzLnJlZHVjZSh0aGlzLmlucHV0UHRzKTt9XG52YXIgc29ydGVkUHRzPXRoaXMucHJlU29ydChyZWR1Y2VkUHRzKTt2YXIgY0hTPXRoaXMuZ3JhaGFtU2Nhbihzb3J0ZWRQdHMpO3ZhciBjSD1jSFMudG9BcnJheSgpO3JldHVybiB0aGlzLmxpbmVPclBvbHlnb24oY0gpO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUucmVkdWNlPWZ1bmN0aW9uKGlucHV0UHRzKXt2YXIgcG9seVB0cz10aGlzLmNvbXB1dGVPY3RSaW5nKGlucHV0UHRzKTtpZihwb2x5UHRzPT1udWxsKVxucmV0dXJuIHRoaXMuaW5wdXRQdHM7dmFyIHJlZHVjZWRTZXQ9bmV3IGphdmFzY3JpcHQudXRpbC5UcmVlU2V0KCk7Zm9yKHZhciBpPTA7aTxwb2x5UHRzLmxlbmd0aDtpKyspe3JlZHVjZWRTZXQuYWRkKHBvbHlQdHNbaV0pO31cbmZvcih2YXIgaT0wO2k8aW5wdXRQdHMubGVuZ3RoO2krKyl7aWYoIUNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKGlucHV0UHRzW2ldLHBvbHlQdHMpKXtyZWR1Y2VkU2V0LmFkZChpbnB1dFB0c1tpXSk7fX1cbnZhciByZWR1Y2VkUHRzPXJlZHVjZWRTZXQudG9BcnJheSgpO2lmKHJlZHVjZWRQdHMubGVuZ3RoPDMpXG5yZXR1cm4gdGhpcy5wYWRBcnJheTMocmVkdWNlZFB0cyk7cmV0dXJuIHJlZHVjZWRQdHM7fTtqc3RzLmFsZ29yaXRobS5Db252ZXhIdWxsLnByb3RvdHlwZS5wYWRBcnJheTM9ZnVuY3Rpb24ocHRzKXt2YXIgcGFkPVtdO2Zvcih2YXIgaT0wO2k8cGFkLmxlbmd0aDtpKyspe2lmKGk8cHRzLmxlbmd0aCl7cGFkW2ldPXB0c1tpXTt9ZWxzZVxucGFkW2ldPXB0c1swXTt9XG5yZXR1cm4gcGFkO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUucHJlU29ydD1mdW5jdGlvbihwdHMpe3ZhciB0O2Zvcih2YXIgaT0xO2k8cHRzLmxlbmd0aDtpKyspe2lmKChwdHNbaV0ueTxwdHNbMF0ueSl8fCgocHRzW2ldLnk9PXB0c1swXS55KSYmKHB0c1tpXS54PHB0c1swXS54KSkpe3Q9cHRzWzBdO3B0c1swXT1wdHNbaV07cHRzW2ldPXQ7fX1cbkFycmF5cy5zb3J0KHB0cywxLHB0cy5sZW5ndGgsbmV3IFJhZGlhbENvbXBhcmF0b3IocHRzWzBdKSk7cmV0dXJuIHB0czt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmdyYWhhbVNjYW49ZnVuY3Rpb24oYyl7dmFyIHA7dmFyIHBzPW5ldyBTdGFjaygpO3A9cHMucHVzaChjWzBdKTtwPXBzLnB1c2goY1sxXSk7cD1wcy5wdXNoKGNbMl0pO2Zvcih2YXIgaT0zO2k8Yy5sZW5ndGg7aSsrKXtwPXBzLnBvcCgpO3doaWxlKCFwcy5lbXB0eSgpJiZDR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKHBzLnBlZWsoKSxwLGNbaV0pPjApe3A9cHMucG9wKCk7fVxucD1wcy5wdXNoKHApO3A9cHMucHVzaChjW2ldKTt9XG5wPXBzLnB1c2goY1swXSk7cmV0dXJuIHBzO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUuaXNCZXR3ZWVuPWZ1bmN0aW9uKGMxLGMyLGMzKXtpZihDR0FsZ29yaXRobXMuY29tcHV0ZU9yaWVudGF0aW9uKGMxLGMyLGMzKSE9PTApe3JldHVybiBmYWxzZTt9XG5pZihjMS54IT1jMy54KXtpZihjMS54PD1jMi54JiZjMi54PD1jMy54KXtyZXR1cm4gdHJ1ZTt9XG5pZihjMy54PD1jMi54JiZjMi54PD1jMS54KXtyZXR1cm4gdHJ1ZTt9fVxuaWYoYzEueSE9YzMueSl7aWYoYzEueTw9YzIueSYmYzIueTw9YzMueSl7cmV0dXJuIHRydWU7fVxuaWYoYzMueTw9YzIueSYmYzIueTw9YzEueSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmNvbXB1dGVPY3RSaW5nPWZ1bmN0aW9uKGlucHV0UHRzKXt2YXIgb2N0UHRzPXRoaXMuY29tcHV0ZU9jdFB0cyhpbnB1dFB0cyk7dmFyIGNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KCk7Y29vcmRMaXN0LmFkZChvY3RQdHMsZmFsc2UpO2lmKGNvb3JkTGlzdC5zaXplKCk8Myl7cmV0dXJuIG51bGw7fVxuY29vcmRMaXN0LmNsb3NlUmluZygpO3JldHVybiBjb29yZExpc3QudG9Db29yZGluYXRlQXJyYXkoKTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmNvbXB1dGVPY3RQdHM9ZnVuY3Rpb24oaW5wdXRQdHMpe3ZhciBwdHM9W107Zm9yKHZhciBqPTA7ajw4O2orKyl7cHRzW2pdPWlucHV0UHRzWzBdO31cbmZvcih2YXIgaT0xO2k8aW5wdXRQdHMubGVuZ3RoO2krKyl7aWYoaW5wdXRQdHNbaV0ueDxwdHNbMF0ueCl7cHRzWzBdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLngtaW5wdXRQdHNbaV0ueTxwdHNbMV0ueC1wdHNbMV0ueSl7cHRzWzFdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLnk+cHRzWzJdLnkpe3B0c1syXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54K2lucHV0UHRzW2ldLnk+cHRzWzNdLngrcHRzWzNdLnkpe3B0c1szXT1pbnB1dFB0c1tpXTt9XG5pZihpbnB1dFB0c1tpXS54PnB0c1s0XS54KXtwdHNbNF09aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueC1pbnB1dFB0c1tpXS55PnB0c1s1XS54LXB0c1s1XS55KXtwdHNbNV09aW5wdXRQdHNbaV07fVxuaWYoaW5wdXRQdHNbaV0ueTxwdHNbNl0ueSl7cHRzWzZdPWlucHV0UHRzW2ldO31cbmlmKGlucHV0UHRzW2ldLngraW5wdXRQdHNbaV0ueTxwdHNbN10ueCtwdHNbN10ueSl7cHRzWzddPWlucHV0UHRzW2ldO319XG5yZXR1cm4gcHRzO307anN0cy5hbGdvcml0aG0uQ29udmV4SHVsbC5wcm90b3R5cGUubGluZU9yUG9seWdvbj1mdW5jdGlvbihjb29yZGluYXRlcyl7Y29vcmRpbmF0ZXM9dGhpcy5jbGVhblJpbmcoY29vcmRpbmF0ZXMpO2lmKGNvb3JkaW5hdGVzLmxlbmd0aD09Myl7cmV0dXJuIHRoaXMuZ2VvbUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhbY29vcmRpbmF0ZXNbMF0sY29vcmRpbmF0ZXNbMV1dKTt9XG52YXIgbGluZWFyUmluZz10aGlzLmdlb21GYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRpbmF0ZXMpO3JldHVybiB0aGlzLmdlb21GYWN0b3J5LmNyZWF0ZVBvbHlnb24obGluZWFyUmluZyxudWxsKTt9O2pzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwucHJvdG90eXBlLmNsZWFuUmluZz1mdW5jdGlvbihvcmlnaW5hbCl7QXNzZXJ0LmVxdWFscyhvcmlnaW5hbFswXSxvcmlnaW5hbFtvcmlnaW5hbC5sZW5ndGgtMV0pO3ZhciBjbGVhbmVkUmluZz1uZXcgQXJyYXlMaXN0KCk7dmFyIHByZXZpb3VzRGlzdGluY3RDb29yZGluYXRlPW51bGw7Zm9yKHZhciBpPTA7aTw9b3JpZ2luYWwubGVuZ3RoLTI7aSsrKXt2YXIgY3VycmVudENvb3JkaW5hdGU9b3JpZ2luYWxbaV07dmFyIG5leHRDb29yZGluYXRlPW9yaWdpbmFsW2krMV07aWYoY3VycmVudENvb3JkaW5hdGUuZXF1YWxzKG5leHRDb29yZGluYXRlKSl7Y29udGludWU7fVxuaWYocHJldmlvdXNEaXN0aW5jdENvb3JkaW5hdGUhPW51bGwmJnRoaXMuaXNCZXR3ZWVuKHByZXZpb3VzRGlzdGluY3RDb29yZGluYXRlLGN1cnJlbnRDb29yZGluYXRlLG5leHRDb29yZGluYXRlKSl7Y29udGludWU7fVxuY2xlYW5lZFJpbmcuYWRkKGN1cnJlbnRDb29yZGluYXRlKTtwcmV2aW91c0Rpc3RpbmN0Q29vcmRpbmF0ZT1jdXJyZW50Q29vcmRpbmF0ZTt9XG5jbGVhbmVkUmluZy5hZGQob3JpZ2luYWxbb3JpZ2luYWwubGVuZ3RoLTFdKTt2YXIgY2xlYW5lZFJpbmdDb29yZGluYXRlcz1bXTtyZXR1cm4gY2xlYW5lZFJpbmcudG9BcnJheShjbGVhbmVkUmluZ0Nvb3JkaW5hdGVzKTt9O30pKCk7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyPWZ1bmN0aW9uKGlucHV0R2VvbSxpc0NvbnZleCl7dGhpcy5jb252ZXhIdWxsUHRzPW51bGw7dGhpcy5taW5CYXNlU2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoKTt0aGlzLm1pbldpZHRoUHQ9bnVsbDt0aGlzLm1pblB0SW5kZXg9MDt0aGlzLm1pbldpZHRoPTA7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbT1pbnB1dEdlb207anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlzQ29udmV4PWlzQ29udmV4fHxmYWxzZTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb209bnVsbDtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaXNDb252ZXg9ZmFsc2U7anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLm5leHRJbmRleD1mdW5jdGlvbihwdHMsaW5kZXgpe2luZGV4Kys7aWYoaW5kZXg+PXB0cy5sZW5ndGgpe2luZGV4PTA7fVxucmV0dXJuIGluZGV4O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVDPWZ1bmN0aW9uKGEsYixwKXtyZXR1cm4gYSpwLnktYipwLng7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lPWZ1bmN0aW9uKGEsYixjKXt2YXIgcDA7dmFyIHAxO2lmKE1hdGguYWJzKGIpPk1hdGguYWJzKGEpKXtwMD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoMCxjL2IpO3AxPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgxLGMvYi1hL2IpO31cbmVsc2V7cDA9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGMvYSwwKTtwMT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYy9hLWIvYSwxKTt9XG5yZXR1cm4gbmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudChwMCxwMSk7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIucHJvdG90eXBlLmdldExlbmd0aD1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO3JldHVybiB0aGlzLm1pbldpZHRoO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRXaWR0aENvb3JkaW5hdGU9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGVNaW5pbXVtRGlhbWV0ZXIoKTtyZXR1cm4gdGhpcy5taW5XaWR0aFB0O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRTdXBwb3J0aW5nU2VnbWVudD1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO3ZhciBjb29yZD1bdGhpcy5taW5CYXNlU2VnLnAwLHRoaXMubWluQmFzZVNlZy5wMV07cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVTdHJpbmcoY29vcmQpO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXREaWFtZXRlcj1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbmltdW1EaWFtZXRlcigpO2lmKHRoaXMubWluV2lkdGhQdD09PW51bGwpe3JldHVybiBqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuaW5wdXRHZW9tLmdldEZhY3RvcnkoKS5jcmVhdGVMaW5lU3RyaW5nKG51bGwpO31cbnZhciBiYXNlUHQ9dGhpcy5taW5CYXNlU2VnLnByb2plY3QodGhpcy5taW5XaWR0aFB0KTtyZXR1cm4ganN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlTGluZVN0cmluZyhbYmFzZVB0LHRoaXMubWluV2lkdGhQdF0pO307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5jb21wdXRlTWluaW11bURpYW1ldGVyPWZ1bmN0aW9uKCl7aWYodGhpcy5taW5XaWR0aFB0IT09bnVsbCl7cmV0dXJuO31cbmlmKGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pc0NvbnZleClcbnRoaXMuY29tcHV0ZVdpZHRoQ29udmV4KGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20pO2Vsc2V7dmFyIGNvbnZleEdlb209bmV3IGpzdHMuYWxnb3JpdGhtLkNvbnZleEh1bGwoanN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbSkuZ2V0Q29udmV4SHVsbCgpO3RoaXMuY29tcHV0ZVdpZHRoQ29udmV4KGNvbnZleEdlb20pO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5wcm90b3R5cGUuY29tcHV0ZVdpZHRoQ29udmV4PWZ1bmN0aW9uKGNvbnZleEdlb20pe2lmKGNvbnZleEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy5jb252ZXhIdWxsUHRzPWNvbnZleEdlb20uZ2V0RXh0ZXJpb3JSaW5nKCkuZ2V0Q29vcmRpbmF0ZXMoKTt9ZWxzZXt0aGlzLmNvbnZleEh1bGxQdHM9Y29udmV4R2VvbS5nZXRDb29yZGluYXRlcygpO31cbmlmKHRoaXMuY29udmV4SHVsbFB0cy5sZW5ndGg9PT0wKXt0aGlzLm1pbldpZHRoPTA7dGhpcy5taW5XaWR0aFB0PW51bGw7dGhpcy5taW5CYXNlU2VnPW51bGw7fWVsc2UgaWYodGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aD09PTEpe3RoaXMubWluV2lkdGg9MDt0aGlzLm1pbldpZHRoUHQ9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMD10aGlzLmNvbnZleEh1bGxQdHNbMF07dGhpcy5taW5CYXNlU2VnLnAxPXRoaXMuY29udmV4SHVsbFB0c1swXTt9ZWxzZSBpZih0aGlzLmNvbnZleEh1bGxQdHMubGVuZ3RoPT09Mnx8dGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aD09PTMpe3RoaXMubWluV2lkdGg9MDt0aGlzLm1pbldpZHRoUHQ9dGhpcy5jb252ZXhIdWxsUHRzWzBdO3RoaXMubWluQmFzZVNlZy5wMD10aGlzLmNvbnZleEh1bGxQdHNbMF07dGhpcy5taW5CYXNlU2VnLnAxPXRoaXMuY29udmV4SHVsbFB0c1sxXTt9ZWxzZXt0aGlzLmNvbXB1dGVDb252ZXhSaW5nTWluRGlhbWV0ZXIodGhpcy5jb252ZXhIdWxsUHRzKTt9fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIucHJvdG90eXBlLmNvbXB1dGVDb252ZXhSaW5nTWluRGlhbWV0ZXI9ZnVuY3Rpb24ocHRzKXt0aGlzLm1pbldpZHRoPU51bWJlci5NQVhfVkFMVUU7dmFyIGN1cnJNYXhJbmRleD0xO3ZhciBzZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7c2VnLnAwPXB0c1tpXTtzZWcucDE9cHRzW2krMV07Y3Vyck1heEluZGV4PXRoaXMuZmluZE1heFBlcnBEaXN0YW5jZShwdHMsc2VnLGN1cnJNYXhJbmRleCk7fX07anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5maW5kTWF4UGVycERpc3RhbmNlPWZ1bmN0aW9uKHB0cyxzZWcsc3RhcnRJbmRleCl7dmFyIG1heFBlcnBEaXN0YW5jZT1zZWcuZGlzdGFuY2VQZXJwZW5kaWN1bGFyKHB0c1tzdGFydEluZGV4XSk7dmFyIG5leHRQZXJwRGlzdGFuY2U9bWF4UGVycERpc3RhbmNlO3ZhciBtYXhJbmRleD1zdGFydEluZGV4O3ZhciBuZXh0SW5kZXg9bWF4SW5kZXg7d2hpbGUobmV4dFBlcnBEaXN0YW5jZT49bWF4UGVycERpc3RhbmNlKXttYXhQZXJwRGlzdGFuY2U9bmV4dFBlcnBEaXN0YW5jZTttYXhJbmRleD1uZXh0SW5kZXg7bmV4dEluZGV4PWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5uZXh0SW5kZXgocHRzLG1heEluZGV4KTtuZXh0UGVycERpc3RhbmNlPXNlZy5kaXN0YW5jZVBlcnBlbmRpY3VsYXIocHRzW25leHRJbmRleF0pO31cbmlmKG1heFBlcnBEaXN0YW5jZTx0aGlzLm1pbldpZHRoKXt0aGlzLm1pblB0SW5kZXg9bWF4SW5kZXg7dGhpcy5taW5XaWR0aD1tYXhQZXJwRGlzdGFuY2U7dGhpcy5taW5XaWR0aFB0PXB0c1t0aGlzLm1pblB0SW5kZXhdO3RoaXMubWluQmFzZVNlZz1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KHNlZyk7fVxucmV0dXJuIG1heEluZGV4O307anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLnByb3RvdHlwZS5nZXRNaW5pbXVtUmVjdGFuZ2xlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTWluaW11bURpYW1ldGVyKCk7aWYodGhpcy5taW5XaWR0aD09PTApe2lmKHRoaXMubWluQmFzZVNlZy5wMC5lcXVhbHMyRCh0aGlzLm1pbkJhc2VTZWcucDEpKXtyZXR1cm4ganN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkuY3JlYXRlUG9pbnQodGhpcy5taW5CYXNlU2VnLnAwKTt9XG5yZXR1cm4gdGhpcy5taW5CYXNlU2VnLnRvR2VvbWV0cnkoanN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmlucHV0R2VvbS5nZXRGYWN0b3J5KCkpO31cbnZhciBkeD10aGlzLm1pbkJhc2VTZWcucDEueC10aGlzLm1pbkJhc2VTZWcucDAueDt2YXIgZHk9dGhpcy5taW5CYXNlU2VnLnAxLnktdGhpcy5taW5CYXNlU2VnLnAwLnk7dmFyIG1pblBhcmE9TnVtYmVyLk1BWF9WQUxVRTt2YXIgbWF4UGFyYT0tTnVtYmVyLk1BWF9WQUxVRTt2YXIgbWluUGVycD1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBtYXhQZXJwPS1OdW1iZXIuTUFYX1ZBTFVFO2Zvcih2YXIgaT0wO2k8dGhpcy5jb252ZXhIdWxsUHRzLmxlbmd0aDtpKyspe3ZhciBwYXJhQz1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZUMoZHgsZHksdGhpcy5jb252ZXhIdWxsUHRzW2ldKTtpZihwYXJhQz5tYXhQYXJhKW1heFBhcmE9cGFyYUM7aWYocGFyYUM8bWluUGFyYSltaW5QYXJhPXBhcmFDO3ZhciBwZXJwQz1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZUMoLWR5LGR4LHRoaXMuY29udmV4SHVsbFB0c1tpXSk7aWYocGVycEM+bWF4UGVycCltYXhQZXJwPXBlcnBDO2lmKHBlcnBDPG1pblBlcnApbWluUGVycD1wZXJwQzt9XG52YXIgbWF4UGVycExpbmU9anN0cy5hbGdvcml0aG0uTWluaW11bURpYW1ldGVyLmNvbXB1dGVTZWdtZW50Rm9yTGluZSgtZHgsLWR5LG1heFBlcnApO3ZhciBtaW5QZXJwTGluZT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lKC1keCwtZHksbWluUGVycCk7dmFyIG1heFBhcmFMaW5lPWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5jb21wdXRlU2VnbWVudEZvckxpbmUoLWR5LGR4LG1heFBhcmEpO3ZhciBtaW5QYXJhTGluZT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtRGlhbWV0ZXIuY29tcHV0ZVNlZ21lbnRGb3JMaW5lKC1keSxkeCxtaW5QYXJhKTt2YXIgcDA9bWF4UGFyYUxpbmUubGluZUludGVyc2VjdGlvbihtYXhQZXJwTGluZSk7dmFyIHAxPW1pblBhcmFMaW5lLmxpbmVJbnRlcnNlY3Rpb24obWF4UGVycExpbmUpO3ZhciBwMj1taW5QYXJhTGluZS5saW5lSW50ZXJzZWN0aW9uKG1pblBlcnBMaW5lKTt2YXIgcDM9bWF4UGFyYUxpbmUubGluZUludGVyc2VjdGlvbihtaW5QZXJwTGluZSk7dmFyIHNoZWxsPWpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUxpbmVhclJpbmcoW3AwLHAxLHAyLHAzLHAwXSk7cmV0dXJuIGpzdHMuYWxnb3JpdGhtLk1pbmltdW1EaWFtZXRlci5pbnB1dEdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZVBvbHlnb24oc2hlbGwsbnVsbCk7fTsoZnVuY3Rpb24oKXtqc3RzLmlvLkdlb0pTT05QYXJzZXI9ZnVuY3Rpb24oZ2VvbWV0cnlGYWN0b3J5KXt0aGlzLmdlb21ldHJ5RmFjdG9yeT1nZW9tZXRyeUZhY3Rvcnl8fG5ldyBqc3RzLmdlb20uR2VvbWV0cnlGYWN0b3J5KCk7dGhpcy5nZW9tZXRyeVR5cGVzPVsnUG9pbnQnLCdNdWx0aVBvaW50JywnTGluZVN0cmluZycsJ011bHRpTGluZVN0cmluZycsJ1BvbHlnb24nLCdNdWx0aVBvbHlnb24nXTt9O2pzdHMuaW8uR2VvSlNPTlBhcnNlci5wcm90b3R5cGUucmVhZD1mdW5jdGlvbihqc29uKXt2YXIgb2JqO2lmKHR5cGVvZiBqc29uPT09J3N0cmluZycpe29iaj1KU09OLnBhcnNlKGpzb24pO31lbHNle29iaj1qc29uO31cbnZhciB0eXBlPW9iai50eXBlO2lmKCF0aGlzLnBhcnNlW3R5cGVdKXt0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gR2VvSlNPTiB0eXBlOiAnK29iai50eXBlKTt9XG5pZih0aGlzLmdlb21ldHJ5VHlwZXMuaW5kZXhPZih0eXBlKSE9LTEpe3JldHVybiB0aGlzLnBhcnNlW3R5cGVdLmFwcGx5KHRoaXMsW29iai5jb29yZGluYXRlc10pO31lbHNlIGlmKHR5cGU9PT0nR2VvbWV0cnlDb2xsZWN0aW9uJyl7cmV0dXJuIHRoaXMucGFyc2VbdHlwZV0uYXBwbHkodGhpcyxbb2JqLmdlb21ldHJpZXNdKTt9XG5yZXR1cm4gdGhpcy5wYXJzZVt0eXBlXS5hcHBseSh0aGlzLFtvYmpdKTt9O2pzdHMuaW8uR2VvSlNPTlBhcnNlci5wcm90b3R5cGUucGFyc2U9eydGZWF0dXJlJzpmdW5jdGlvbihvYmope3ZhciBmZWF0dXJlPXt9O2Zvcih2YXIga2V5IGluIG9iail7ZmVhdHVyZVtrZXldPW9ialtrZXldO31cbmlmKG9iai5nZW9tZXRyeSl7dmFyIHR5cGU9b2JqLmdlb21ldHJ5LnR5cGU7aWYoIXRoaXMucGFyc2VbdHlwZV0pe3Rocm93IG5ldyBFcnJvcignVW5rbm93biBHZW9KU09OIHR5cGU6ICcrb2JqLnR5cGUpO31cbmZlYXR1cmUuZ2VvbWV0cnk9dGhpcy5yZWFkKG9iai5nZW9tZXRyeSk7fVxuaWYob2JqLmJib3gpe2ZlYXR1cmUuYmJveD10aGlzLnBhcnNlLmJib3guYXBwbHkodGhpcyxbb2JqLmJib3hdKTt9XG5yZXR1cm4gZmVhdHVyZTt9LCdGZWF0dXJlQ29sbGVjdGlvbic6ZnVuY3Rpb24ob2JqKXt2YXIgZmVhdHVyZUNvbGxlY3Rpb249e307aWYob2JqLmZlYXR1cmVzKXtmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlcz1bXTtmb3IodmFyIGk9MDtpPG9iai5mZWF0dXJlcy5sZW5ndGg7KytpKXtmZWF0dXJlQ29sbGVjdGlvbi5mZWF0dXJlcy5wdXNoKHRoaXMucmVhZChvYmouZmVhdHVyZXNbaV0pKTt9fVxuaWYob2JqLmJib3gpe2ZlYXR1cmVDb2xsZWN0aW9uLmJib3g9dGhpcy5wYXJzZS5iYm94LmFwcGx5KHRoaXMsW29iai5iYm94XSk7fVxucmV0dXJuIGZlYXR1cmVDb2xsZWN0aW9uO30sJ2Nvb3JkaW5hdGVzJzpmdW5jdGlvbihhcnJheSl7dmFyIGNvb3JkaW5hdGVzPVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoOysraSl7dmFyIHN1Yj1hcnJheVtpXTtjb29yZGluYXRlcy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzdWJbMF0sc3ViWzFdKSk7fVxucmV0dXJuIGNvb3JkaW5hdGVzO30sJ2Jib3gnOmZ1bmN0aW9uKGFycmF5KXtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhbbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzFdKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMl0sYXJyYXlbMV0pLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhcnJheVsyXSxhcnJheVszXSksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGFycmF5WzBdLGFycmF5WzNdKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMF0sYXJyYXlbMV0pXSk7fSwnUG9pbnQnOmZ1bmN0aW9uKGFycmF5KXt2YXIgY29vcmRpbmF0ZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoYXJyYXlbMF0sYXJyYXlbMV0pO3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChjb29yZGluYXRlKTt9LCdNdWx0aVBvaW50JzpmdW5jdGlvbihhcnJheSl7dmFyIHBvaW50cz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3BvaW50cy5wdXNoKHRoaXMucGFyc2UuUG9pbnQuYXBwbHkodGhpcyxbYXJyYXlbaV1dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9pbnQocG9pbnRzKTt9LCdMaW5lU3RyaW5nJzpmdW5jdGlvbihhcnJheSl7dmFyIGNvb3JkaW5hdGVzPXRoaXMucGFyc2UuY29vcmRpbmF0ZXMuYXBwbHkodGhpcyxbYXJyYXldKTtyZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZVN0cmluZyhjb29yZGluYXRlcyk7fSwnTXVsdGlMaW5lU3RyaW5nJzpmdW5jdGlvbihhcnJheSl7dmFyIGxpbmVTdHJpbmdzPVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoOysraSl7bGluZVN0cmluZ3MucHVzaCh0aGlzLnBhcnNlLkxpbmVTdHJpbmcuYXBwbHkodGhpcyxbYXJyYXlbaV1dKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyk7fSwnUG9seWdvbic6ZnVuY3Rpb24oYXJyYXkpe3ZhciBzaGVsbENvb3JkaW5hdGVzPXRoaXMucGFyc2UuY29vcmRpbmF0ZXMuYXBwbHkodGhpcyxbYXJyYXlbMF1dKTt2YXIgc2hlbGw9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhzaGVsbENvb3JkaW5hdGVzKTt2YXIgaG9sZXM9W107Zm9yKHZhciBpPTE7aTxhcnJheS5sZW5ndGg7KytpKXt2YXIgaG9sZT1hcnJheVtpXTt2YXIgY29vcmRpbmF0ZXM9dGhpcy5wYXJzZS5jb29yZGluYXRlcy5hcHBseSh0aGlzLFtob2xlXSk7dmFyIGxpbmVhclJpbmc9dGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTGluZWFyUmluZyhjb29yZGluYXRlcyk7aG9sZXMucHVzaChsaW5lYXJSaW5nKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9seWdvbihzaGVsbCxob2xlcyk7fSwnTXVsdGlQb2x5Z29uJzpmdW5jdGlvbihhcnJheSl7dmFyIHBvbHlnb25zPVtdO2Zvcih2YXIgaT0wO2k8YXJyYXkubGVuZ3RoOysraSl7dmFyIHBvbHlnb249YXJyYXlbaV07cG9seWdvbnMucHVzaCh0aGlzLnBhcnNlLlBvbHlnb24uYXBwbHkodGhpcyxbcG9seWdvbl0pKTt9XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlTXVsdGlQb2x5Z29uKHBvbHlnb25zKTt9LCdHZW9tZXRyeUNvbGxlY3Rpb24nOmZ1bmN0aW9uKGFycmF5KXt2YXIgZ2VvbWV0cmllcz1bXTtmb3IodmFyIGk9MDtpPGFycmF5Lmxlbmd0aDsrK2kpe3ZhciBnZW9tZXRyeT1hcnJheVtpXTtnZW9tZXRyaWVzLnB1c2godGhpcy5yZWFkKGdlb21ldHJ5KSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzKTt9fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGdlb21ldHJ5KXt2YXIgdHlwZT1nZW9tZXRyeS5DTEFTU19OQU1FLnNsaWNlKDEwKTtpZighdGhpcy5leHRyYWN0W3R5cGVdKXt0aHJvdyBuZXcgRXJyb3IoJ0dlb21ldHJ5IGlzIG5vdCBzdXBwb3J0ZWQnKTt9XG5yZXR1cm4gdGhpcy5leHRyYWN0W3R5cGVdLmFwcGx5KHRoaXMsW2dlb21ldHJ5XSk7fTtqc3RzLmlvLkdlb0pTT05QYXJzZXIucHJvdG90eXBlLmV4dHJhY3Q9eydjb29yZGluYXRlJzpmdW5jdGlvbihjb29yZGluYXRlKXtyZXR1cm5bY29vcmRpbmF0ZS54LGNvb3JkaW5hdGUueV07fSwnUG9pbnQnOmZ1bmN0aW9uKHBvaW50KXt2YXIgYXJyYXk9dGhpcy5leHRyYWN0LmNvb3JkaW5hdGUuYXBwbHkodGhpcyxbcG9pbnQuY29vcmRpbmF0ZV0pO3JldHVybnt0eXBlOidQb2ludCcsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ011bHRpUG9pbnQnOmZ1bmN0aW9uKG11bHRpcG9pbnQpe3ZhciBhcnJheT1bXTtmb3IodmFyIGk9MDtpPG11bHRpcG9pbnQuZ2VvbWV0cmllcy5sZW5ndGg7KytpKXt2YXIgcG9pbnQ9bXVsdGlwb2ludC5nZW9tZXRyaWVzW2ldO3ZhciBnZW9Kc29uPXRoaXMuZXh0cmFjdC5Qb2ludC5hcHBseSh0aGlzLFtwb2ludF0pO2FycmF5LnB1c2goZ2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J011bHRpUG9pbnQnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdMaW5lU3RyaW5nJzpmdW5jdGlvbihsaW5lc3RyaW5nKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxsaW5lc3RyaW5nLnBvaW50cy5sZW5ndGg7KytpKXt2YXIgY29vcmRpbmF0ZT1saW5lc3RyaW5nLnBvaW50c1tpXTthcnJheS5wdXNoKHRoaXMuZXh0cmFjdC5jb29yZGluYXRlLmFwcGx5KHRoaXMsW2Nvb3JkaW5hdGVdKSk7fVxucmV0dXJue3R5cGU6J0xpbmVTdHJpbmcnLGNvb3JkaW5hdGVzOmFycmF5fTt9LCdNdWx0aUxpbmVTdHJpbmcnOmZ1bmN0aW9uKG11bHRpbGluZXN0cmluZyl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT0wO2k8bXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIGxpbmVzdHJpbmc9bXVsdGlsaW5lc3RyaW5nLmdlb21ldHJpZXNbaV07dmFyIGdlb0pzb249dGhpcy5leHRyYWN0LkxpbmVTdHJpbmcuYXBwbHkodGhpcyxbbGluZXN0cmluZ10pO2FycmF5LnB1c2goZ2VvSnNvbi5jb29yZGluYXRlcyk7fVxucmV0dXJue3R5cGU6J011bHRpTGluZVN0cmluZycsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ1BvbHlnb24nOmZ1bmN0aW9uKHBvbHlnb24pe3ZhciBhcnJheT1bXTt2YXIgc2hlbGxHZW9Kc29uPXRoaXMuZXh0cmFjdC5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW3BvbHlnb24uc2hlbGxdKTthcnJheS5wdXNoKHNoZWxsR2VvSnNvbi5jb29yZGluYXRlcyk7Zm9yKHZhciBpPTA7aTxwb2x5Z29uLmhvbGVzLmxlbmd0aDsrK2kpe3ZhciBob2xlPXBvbHlnb24uaG9sZXNbaV07dmFyIGhvbGVHZW9Kc29uPXRoaXMuZXh0cmFjdC5MaW5lU3RyaW5nLmFwcGx5KHRoaXMsW2hvbGVdKTthcnJheS5wdXNoKGhvbGVHZW9Kc29uLmNvb3JkaW5hdGVzKTt9XG5yZXR1cm57dHlwZTonUG9seWdvbicsY29vcmRpbmF0ZXM6YXJyYXl9O30sJ011bHRpUG9seWdvbic6ZnVuY3Rpb24obXVsdGlwb2x5Z29uKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxtdWx0aXBvbHlnb24uZ2VvbWV0cmllcy5sZW5ndGg7KytpKXt2YXIgcG9seWdvbj1tdWx0aXBvbHlnb24uZ2VvbWV0cmllc1tpXTt2YXIgZ2VvSnNvbj10aGlzLmV4dHJhY3QuUG9seWdvbi5hcHBseSh0aGlzLFtwb2x5Z29uXSk7YXJyYXkucHVzaChnZW9Kc29uLmNvb3JkaW5hdGVzKTt9XG5yZXR1cm57dHlwZTonTXVsdGlQb2x5Z29uJyxjb29yZGluYXRlczphcnJheX07fSwnR2VvbWV0cnlDb2xsZWN0aW9uJzpmdW5jdGlvbihjb2xsZWN0aW9uKXt2YXIgYXJyYXk9W107Zm9yKHZhciBpPTA7aTxjb2xsZWN0aW9uLmdlb21ldHJpZXMubGVuZ3RoOysraSl7dmFyIGdlb21ldHJ5PWNvbGxlY3Rpb24uZ2VvbWV0cmllc1tpXTt2YXIgdHlwZT1nZW9tZXRyeS5DTEFTU19OQU1FLnNsaWNlKDEwKTthcnJheS5wdXNoKHRoaXMuZXh0cmFjdFt0eXBlXS5hcHBseSh0aGlzLFtnZW9tZXRyeV0pKTt9XG5yZXR1cm57dHlwZTonR2VvbWV0cnlDb2xsZWN0aW9uJyxnZW9tZXRyaWVzOmFycmF5fTt9fTt9KSgpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3RoaXMuaW5pdEZyb21Db29yZGluYXRlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5pbml0RnJvbVhZKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkxFRlQ9MDtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5SSUdIVD0xO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFWU9ORD0yO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFSElORD0zO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFVFdFRU49NDtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5PUklHSU49NTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5ERVNUSU5BVElPTj02O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pbml0RnJvbVhZPWZ1bmN0aW9uKHgseSl7dGhpcy5wPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmluaXRGcm9tQ29vcmRpbmF0ZT1mdW5jdGlvbihfcCl7dGhpcy5wPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShfcCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZ2V0WD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5nZXRZPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucC55O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmdldFo9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wLno7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuc2V0Wj1mdW5jdGlvbih6KXt0aGlzLnAuej16O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmdldENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuJ1BPSU5UICgnK3RoaXMucC54KycgJyt0aGlzLnAueSsnKSc7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTEpe3JldHVybiB0aGlzLmVxdWFsc0V4YWN0KGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMuZXF1YWxzV2l0aFRvbGVyYW5jZShhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuZXF1YWxzRXhhY3Q9ZnVuY3Rpb24ob3RoZXIpe3JldHVybih0aGlzLnAueD09PW90aGVyLmdldFgoKSYmdGhpcy5wLnk9PT1vdGhlci5nZXRZKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmVxdWFsc1dpdGhUb2xlcmFuY2U9ZnVuY3Rpb24ob3RoZXIsdG9sZXJhbmNlKXtyZXR1cm4odGhpcy5wLmRpc3RhbmNlKG90aGVyLmdldENvb3JkaW5hdGUoKSk8dG9sZXJhbmNlKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5jbGFzc2lmeT1mdW5jdGlvbihwMCxwMSl7dmFyIHAyLGEsYixzYTtwMj10aGlzO2E9cDEuc3ViKHAwKTtiPXAyLnN1YihwMCk7c2E9YS5jcm9zc1Byb2R1Y3QoYik7aWYoc2E+MC4wKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguTEVGVDt9XG5pZihzYTwwLjApe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5SSUdIVDt9XG5pZigoYS5nZXRYKCkqYi5nZXRYKCk8MC4wKXx8KGEuZ2V0WSgpKmIuZ2V0WSgpPDAuMCkpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRUhJTkQ7fVxuaWYoYS5tYWduKCk8Yi5tYWduKCkpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5CRVlPTkQ7fVxuaWYocDAuZXF1YWxzKHAyKSl7cmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4Lk9SSUdJTjt9XG5pZihwMS5lcXVhbHMocDIpKXtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXguREVTVElOQVRJT047fVxucmV0dXJuIGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LkJFVFdFRU47fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY3Jvc3NQcm9kdWN0PWZ1bmN0aW9uKHYpe3JldHVybigodGhpcy5wLngqdi5nZXRZKCkpLSh0aGlzLnAueSp2LmdldFgoKSkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmRvdD1mdW5jdGlvbih2KXtyZXR1cm4oKHRoaXMucC54KnYuZ2V0WCgpKSsodGhpcy5wLnkqdi5nZXRZKCkpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS50aW1lcz1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGMqdGhpcy5wLngsYyp0aGlzLnAueSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuc3VtPWZ1bmN0aW9uKHYpe3JldHVybiBuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgodGhpcy5wLngrdi5nZXRYKCksdGhpcy5wLnkrXG52LmdldFkoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuc3ViPWZ1bmN0aW9uKHYpe3JldHVybiBuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgodGhpcy5wLngtdi5nZXRYKCksdGhpcy5wLnktXG52LmdldFkoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUubWFnbj1mdW5jdGlvbigpe3JldHVybihNYXRoLnNxcnQoKHRoaXMucC54KnRoaXMucC54KSsodGhpcy5wLnkqdGhpcy5wLnkpKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY3Jvc3M9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFZlcnRleCh0aGlzLnAueSwtdGhpcy5wLngpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmlzSW5DaXJjbGU9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlUHJlZGljYXRlLmlzSW5DaXJjbGVSb2J1c3QoYS5wLGIucCxjLnAsdGhpcy5wKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5pc0NDVz1mdW5jdGlvbihiLGMpe3JldHVybigoYi5wLngtdGhpcy5wLngpKihjLnAueS10aGlzLnAueSktKGIucC55LXRoaXMucC55KSooYy5wLngtdGhpcy5wLngpPjApO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLnJpZ2h0T2Y9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuaXNDQ1coZS5kZXN0KCksZS5vcmlnKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmxlZnRPZj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5pc0NDVyhlLm9yaWcoKSxlLmRlc3QoKSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuYmlzZWN0b3I9ZnVuY3Rpb24oYSxiKXt2YXIgZHgsZHksbDEsbDI7ZHg9Yi5nZXRYKCktYS5nZXRYKCk7ZHk9Yi5nZXRZKCktYS5nZXRZKCk7bDE9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEuZ2V0WCgpKyhkeC8yLjApLGEuZ2V0WSgpK1xuKGR5LzIuMCksMS4wKTtsMj1uZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUoYS5nZXRYKCktZHkrKGR4LzIuMCksYS5nZXRZKCkrXG5keCsoZHkvMi4wKSwxLjApO3JldHVybiBuZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUobDEsbDIpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKHYxLHYyKXtyZXR1cm4gdjEucC5kaXN0YW5jZSh2Mi5wKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5jaXJjdW1SYWRpdXNSYXRpbz1mdW5jdGlvbihiLGMpe3ZhciB4LHJhZGl1cyxlZGdlTGVuZ3RoLGVsO3g9dGhpcy5jaXJjbGVDZW50ZXIoYixjKTtyYWRpdXM9dGhpcy5kaXN0YW5jZSh4LGIpO2VkZ2VMZW5ndGg9dGhpcy5kaXN0YW5jZSh0aGlzLGIpO2VsPXRoaXMuZGlzdGFuY2UoYixjKTtpZihlbDxlZGdlTGVuZ3RoKXtlZGdlTGVuZ3RoPWVsO31cbmVsPXRoaXMuZGlzdGFuY2UoYyx0aGlzKTtpZihlbDxlZGdlTGVuZ3RoKXtlZGdlTGVuZ3RoPWVsO31cbnJldHVybiByYWRpdXMvZWRnZUxlbmd0aDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4LnByb3RvdHlwZS5taWRQb2ludD1mdW5jdGlvbihhKXt2YXIgeG0seW07eG09KHRoaXMucC54K2EuZ2V0WCgpKS8yLjA7eW09KHRoaXMucC55K2EuZ2V0WSgpKS8yLjA7cmV0dXJuIG5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleCh4bSx5bSk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleC5wcm90b3R5cGUuY2lyY2xlQ2VudGVyPWZ1bmN0aW9uKGIsYyl7dmFyIGEsY2FiLGNiYyxoY2MsY2M7YT1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgodGhpcy5nZXRYKCksdGhpcy5nZXRZKCkpO2NhYj10aGlzLmJpc2VjdG9yKGEsYik7Y2JjPXRoaXMuYmlzZWN0b3IoYixjKTtoY2M9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGNhYixjYmMpO2NjPW51bGw7dHJ5e2NjPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChoY2MuZ2V0WCgpLGhjYy5nZXRZKCkpO31jYXRjaChlcnIpe31cbnJldHVybiBjYzt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcD1mdW5jdGlvbihwYXJlbnRHZW9tZXRyeSl7dGhpcy5wYXJlbnRHZW9tZXRyeT1wYXJlbnRHZW9tZXRyeTt0aGlzLmlzU2VsZlRvdWNoaW5nUmluZ0Zvcm1pbmdIb2xlVmFsaWQ9ZmFsc2U7dGhpcy52YWxpZEVycj1udWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmlzVmFsaWQ9ZnVuY3Rpb24oYXJnKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlKXtpZihpc05hTihhcmcueCkpe3JldHVybiBmYWxzZTt9XG5pZighaXNGaW5pdGUoYXJnLngpJiYhaXNOYU4oYXJnLngpKXtyZXR1cm4gZmFsc2U7fVxuaWYoaXNOYU4oYXJnLnkpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWlzRmluaXRlKGFyZy55KSYmIWlzTmFOKGFyZy55KSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO31lbHNle3ZhciBpc1ZhbGlkT3A9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcChhcmcpO3JldHVybiBpc1ZhbGlkT3AuaXNWYWxpZCgpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlPWZ1bmN0aW9uKHRlc3RDb29yZHMsc2VhcmNoUmluZyxncmFwaCl7dmFyIHNlYXJjaEVkZ2U9Z3JhcGguZmluZEVkZ2Uoc2VhcmNoUmluZyk7dmFyIGVpTGlzdD1zZWFyY2hFZGdlLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCk7Zm9yKHZhciBpPTA7aTx0ZXN0Q29vcmRzLmxlbmd0aDtpKyspe3ZhciBwdD10ZXN0Q29vcmRzW2ldO2lmKCFlaUxpc3QuaXNJbnRlcnNlY3Rpb24ocHQpKXtyZXR1cm4gcHQ7fX1cbnJldHVybiBudWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5zZXRTZWxmVG91Y2hpbmdSaW5nRm9ybWluZ0hvbGVWYWxpZD1mdW5jdGlvbihpc1ZhbGlkKXt0aGlzLmlzU2VsZlRvdWNoaW5nUmluZ0Zvcm1pbmdIb2xlVmFsaWQ9aXNWYWxpZDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuaXNWYWxpZD1mdW5jdGlvbigpe3RoaXMuY2hlY2tWYWxpZCh0aGlzLnBhcmVudEdlb21ldHJ5KTtyZXR1cm4gdGhpcy52YWxpZEVycj09bnVsbDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuZ2V0VmFsaWRhdGlvbkVycm9yPWZ1bmN0aW9uKCl7dGhpcy5jaGVja1ZhbGlkKHRoaXMucGFyZW50R2VvbWV0cnkpO3JldHVybiB0aGlzLnZhbGlkRXJyO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkPWZ1bmN0aW9uKGcpe3RoaXMudmFsaWRFcnI9bnVsbDtpZihnLmlzRW1wdHkoKSl7cmV0dXJuO31cbmlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuY2hlY2tWYWxpZFBvaW50KGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludCl7dGhpcy5jaGVja1ZhbGlkTXVsdGlQb2ludChnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpe3RoaXMuY2hlY2tWYWxpZExpbmVhclJpbmcoZyk7fWVsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKXt0aGlzLmNoZWNrVmFsaWRMaW5lU3RyaW5nKGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy5jaGVja1ZhbGlkUG9seWdvbihnKTt9ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dGhpcy5jaGVja1ZhbGlkTXVsdGlQb2x5Z29uKGcpO31lbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXt0aGlzLmNoZWNrVmFsaWRHZW9tZXRyeUNvbGxlY3Rpb24oZyk7fWVsc2V7dGhyb3cgZy5jb25zdHJ1Y3Rvcjt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRQb2ludD1mdW5jdGlvbihnKXt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKGcuZ2V0Q29vcmRpbmF0ZXMoKSk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRNdWx0aVBvaW50PWZ1bmN0aW9uKGcpe3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMoZy5nZXRDb29yZGluYXRlcygpKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZExpbmVTdHJpbmc9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG52YXIgZ3JhcGg9bmV3IGpzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgoMCxnKTt0aGlzLmNoZWNrVG9vRmV3UG9pbnRzKGdyYXBoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZExpbmVhclJpbmc9ZnVuY3Rpb24oZyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhnLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ2xvc2VkUmluZyhnKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudmFyIGdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoKDAsZyk7dGhpcy5jaGVja1Rvb0Zld1BvaW50cyhncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnZhciBsaT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7Z3JhcGguY29tcHV0ZVNlbGZOb2RlcyhsaSx0cnVlKTt0aGlzLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3MoZ3JhcGgpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1ZhbGlkUG9seWdvbj1mdW5jdGlvbihnKXt0aGlzLmNoZWNrSW52YWxpZENvb3JkaW5hdGVzKGcpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ2xvc2VkUmluZ3MoZyk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgwLGcpO3RoaXMuY2hlY2tUb29GZXdQb2ludHMoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ29uc2lzdGVudEFyZWEoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG5pZighdGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkKXt0aGlzLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3MoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxudGhpcy5jaGVja0hvbGVzSW5TaGVsbChnLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0hvbGVzTm90TmVzdGVkKGcsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ29ubmVjdGVkSW50ZXJpb3JzKGdyYXBoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tWYWxpZE11bHRpUG9seWdvbj1mdW5jdGlvbihnKXt2YXIgaWw9Zy5nZXROdW1HZW9tZXRyaWVzKCk7Zm9yKHZhciBpPTA7aTxpbDtpKyspe3ZhciBwPWcuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMocCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO31cbnRoaXMuY2hlY2tDbG9zZWRSaW5ncyhwKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX1cbnZhciBncmFwaD1uZXcganN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaCgwLGcpO3RoaXMuY2hlY2tUb29GZXdQb2ludHMoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG50aGlzLmNoZWNrQ29uc2lzdGVudEFyZWEoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9XG5pZighdGhpcy5pc1NlbGZUb3VjaGluZ1JpbmdGb3JtaW5nSG9sZVZhbGlkKXt0aGlzLmNoZWNrTm9TZWxmSW50ZXJzZWN0aW5nUmluZ3MoZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxuZm9yKHZhciBpPTA7aTxnLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBwPWcuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tIb2xlc0luU2hlbGwocCxncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319XG5mb3IodmFyIGk9MDtpPGcuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIHA9Zy5nZXRHZW9tZXRyeU4oaSk7dGhpcy5jaGVja0hvbGVzTm90TmVzdGVkKHAsZ3JhcGgpO2lmKHRoaXMudmFsaWRFcnIhPW51bGwpe3JldHVybjt9fVxudGhpcy5jaGVja1NoZWxsc05vdE5lc3RlZChnLGdyYXBoKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxudGhpcy5jaGVja0Nvbm5lY3RlZEludGVyaW9ycyhncmFwaCk7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVmFsaWRHZW9tZXRyeUNvbGxlY3Rpb249ZnVuY3Rpb24oZ2Mpe2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGc9Z2MuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuY2hlY2tWYWxpZChnKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oYXJnKXtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dmFyIHBvbHk9YXJnO3RoaXMuY2hlY2tJbnZhbGlkQ29vcmRpbmF0ZXMocG9seS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuZm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5jaGVja0ludmFsaWRDb29yZGluYXRlcyhwb2x5LmdldEludGVyaW9yUmluZ04oaSkuZ2V0Q29vcmRpbmF0ZXMoKSk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fWVsc2V7dmFyIGNvb3Jkcz1hcmc7Zm9yKHZhciBpPTA7aTxjb29yZHMubGVuZ3RoO2krKyl7aWYoIWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5pc1ZhbGlkKGNvb3Jkc1tpXSkpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLklOVkFMSURfQ09PUkRJTkFURSxjb29yZHNbaV0pO3JldHVybjt9fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tDbG9zZWRSaW5ncz1mdW5jdGlvbihwb2x5KXt0aGlzLmNoZWNrQ2xvc2VkUmluZyhwb2x5LmdldEV4dGVyaW9yUmluZygpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fVxuZm9yKHZhciBpPTA7aTxwb2x5LmdldE51bUludGVyaW9yUmluZygpO2krKyl7dGhpcy5jaGVja0Nsb3NlZFJpbmcocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tDbG9zZWRSaW5nPWZ1bmN0aW9uKHJpbmcpe2lmKCFyaW5nLmlzQ2xvc2VkKCkpe3ZhciBwdD1udWxsO2lmKHJpbmcuZ2V0TnVtUG9pbnRzKCk+PTEpe3B0PXJpbmcuZ2V0Q29vcmRpbmF0ZU4oMCk7fVxudGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuUklOR19OT1RfQ0xPU0VELHB0KTt9fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrVG9vRmV3UG9pbnRzPWZ1bmN0aW9uKGdyYXBoKXtpZihncmFwaC5oYXNUb29GZXdQb2ludHMpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLlRPT19GRVdfUE9JTlRTLGdyYXBoLmdldEludmFsaWRQb2ludCgpKTtyZXR1cm47fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja0NvbnNpc3RlbnRBcmVhPWZ1bmN0aW9uKGdyYXBoKXt2YXIgY2F0PW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3RlcihncmFwaCk7dmFyIGlzVmFsaWRBcmVhPWNhdC5pc05vZGVDb25zaXN0ZW50QXJlYSgpO2lmKCFpc1ZhbGlkQXJlYSl7dGhpcy52YWxpZEVycj1uZXcganN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IoanN0cy5vcGVyYXRpb24udmFsaWQuVG9wb2xvZ3lWYWxpZGF0aW9uRXJyb3IuU0VMRl9JTlRFUlNFQ1RJT04sY2F0LmdldEludmFsaWRQb2ludCgpKTtyZXR1cm47fVxuaWYoY2F0Lmhhc0R1cGxpY2F0ZVJpbmdzKCkpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLkRVUExJQ0FURV9SSU5HUyxjYXQuZ2V0SW52YWxpZFBvaW50KCkpO319O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tOb1NlbGZJbnRlcnNlY3RpbmdSaW5ncz1mdW5jdGlvbihncmFwaCl7Zm9yKHZhciBpPWdyYXBoLmdldEVkZ2VJdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGU9aS5uZXh0KCk7dGhpcy5jaGVja05vU2VsZkludGVyc2VjdGluZ1JpbmcoZS5nZXRFZGdlSW50ZXJzZWN0aW9uTGlzdCgpKTtpZih0aGlzLnZhbGlkRXJyIT1udWxsKXtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tOb1NlbGZJbnRlcnNlY3RpbmdSaW5nPWZ1bmN0aW9uKGVpTGlzdCl7dmFyIG5vZGVTZXQ9W107dmFyIGlzRmlyc3Q9dHJ1ZTtmb3IodmFyIGk9ZWlMaXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWk9aS5uZXh0KCk7aWYoaXNGaXJzdCl7aXNGaXJzdD1mYWxzZTtjb250aW51ZTt9XG5pZihub2RlU2V0LmluZGV4T2YoZWkuY29vcmQpPj0wKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5SSU5HX1NFTEZfSU5URVJTRUNUSU9OLGVpLmNvb3JkKTtyZXR1cm47fWVsc2V7bm9kZVNldC5wdXNoKGVpLmNvb3JkKTt9fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja0hvbGVzSW5TaGVsbD1mdW5jdGlvbihwLGdyYXBoKXt2YXIgc2hlbGw9cC5nZXRFeHRlcmlvclJpbmcoKTt2YXIgcGlyPW5ldyBqc3RzLmFsZ29yaXRobS5NQ1BvaW50SW5SaW5nKHNoZWxsKTtmb3IodmFyIGk9MDtpPHAuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt2YXIgaG9sZT1wLmdldEludGVyaW9yUmluZ04oaSk7dmFyIGhvbGVQdD1qc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZShob2xlLmdldENvb3JkaW5hdGVzKCksc2hlbGwsZ3JhcGgpO2lmKGhvbGVQdD09bnVsbCl7cmV0dXJuO31cbnZhciBvdXRzaWRlPSFwaXIuaXNJbnNpZGUoaG9sZVB0KTtpZihvdXRzaWRlKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5IT0xFX09VVFNJREVfU0hFTEwsaG9sZVB0KTtyZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5wcm90b3R5cGUuY2hlY2tIb2xlc05vdE5lc3RlZD1mdW5jdGlvbihwLGdyYXBoKXt2YXIgbmVzdGVkVGVzdGVyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3RlcihncmFwaCk7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGlubmVySG9sZT1wLmdldEludGVyaW9yUmluZ04oaSk7bmVzdGVkVGVzdGVyLmFkZChpbm5lckhvbGUpO31cbnZhciBpc05vbk5lc3RlZD1uZXN0ZWRUZXN0ZXIuaXNOb25OZXN0ZWQoKTtpZighaXNOb25OZXN0ZWQpe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9IT0xFUyxuZXN0ZWRUZXN0ZXIuZ2V0TmVzdGVkUG9pbnQoKSk7fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1NoZWxsc05vdE5lc3RlZD1mdW5jdGlvbihtcCxncmFwaCl7Zm9yKHZhciBpPTA7aTxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt2YXIgcD1tcC5nZXRHZW9tZXRyeU4oaSk7dmFyIHNoZWxsPXAuZ2V0RXh0ZXJpb3JSaW5nKCk7Zm9yKHZhciBqPTA7ajxtcC5nZXROdW1HZW9tZXRyaWVzKCk7aisrKXtpZihpPT1qKXtjb250aW51ZTt9XG52YXIgcDI9bXAuZ2V0R2VvbWV0cnlOKGopO3RoaXMuY2hlY2tTaGVsbE5vdE5lc3RlZChzaGVsbCxwMixncmFwaCk7aWYodGhpcy52YWxpZEVyciE9bnVsbCl7cmV0dXJuO319fX07anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1NoZWxsTm90TmVzdGVkPWZ1bmN0aW9uKHNoZWxsLHAsZ3JhcGgpe3ZhciBzaGVsbFB0cz1zaGVsbC5nZXRDb29yZGluYXRlcygpO3ZhciBwb2x5U2hlbGw9cC5nZXRFeHRlcmlvclJpbmcoKTt2YXIgcG9seVB0cz1wb2x5U2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgc2hlbGxQdD1qc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AuZmluZFB0Tm90Tm9kZShzaGVsbFB0cyxwb2x5U2hlbGwsZ3JhcGgpO2lmKHNoZWxsUHQ9PW51bGwpe3JldHVybjt9XG52YXIgaW5zaWRlUG9seVNoZWxsPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc1BvaW50SW5SaW5nKHNoZWxsUHQscG9seVB0cyk7aWYoIWluc2lkZVBvbHlTaGVsbCl7cmV0dXJuO31cbmlmKHAuZ2V0TnVtSW50ZXJpb3JSaW5nKCk8PTApe3RoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9TSEVMTFMsc2hlbGxQdCk7cmV0dXJuO31cbnZhciBiYWROZXN0ZWRQdD1udWxsO2Zvcih2YXIgaT0wO2k8cC5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3ZhciBob2xlPXAuZ2V0SW50ZXJpb3JSaW5nTihpKTtiYWROZXN0ZWRQdD10aGlzLmNoZWNrU2hlbGxJbnNpZGVIb2xlKHNoZWxsLGhvbGUsZ3JhcGgpO2lmKGJhZE5lc3RlZFB0PT1udWxsKXtyZXR1cm47fX1cbnRoaXMudmFsaWRFcnI9bmV3IGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yKGpzdHMub3BlcmF0aW9uLnZhbGlkLlRvcG9sb2d5VmFsaWRhdGlvbkVycm9yLk5FU1RFRF9TSEVMTFMsYmFkTmVzdGVkUHQpO307anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLnByb3RvdHlwZS5jaGVja1NoZWxsSW5zaWRlSG9sZT1mdW5jdGlvbihzaGVsbCxob2xlLGdyYXBoKXt2YXIgc2hlbGxQdHM9c2hlbGwuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgaG9sZVB0cz1ob2xlLmdldENvb3JkaW5hdGVzKCk7dmFyIHNoZWxsUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoc2hlbGxQdHMsaG9sZSxncmFwaCk7aWYoc2hlbGxQdCE9bnVsbCl7dmFyIGluc2lkZUhvbGU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcoc2hlbGxQdCxob2xlUHRzKTtpZighaW5zaWRlSG9sZSl7cmV0dXJuIHNoZWxsUHQ7fX1cbnZhciBob2xlUHQ9anN0cy5vcGVyYXRpb24udmFsaWQuSXNWYWxpZE9wLmZpbmRQdE5vdE5vZGUoaG9sZVB0cyxzaGVsbCxncmFwaCk7aWYoaG9sZVB0IT1udWxsKXt2YXIgaW5zaWRlU2hlbGw9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcoaG9sZVB0LHNoZWxsUHRzKTtpZihpbnNpZGVTaGVsbCl7cmV0dXJuIGhvbGVQdDt9XG5yZXR1cm4gbnVsbDt9XG5qc3RzLnV0aWwuQXNzZXJ0LnNob3VsZE5ldmVyUmVhY2hIZXJlKCdwb2ludHMgaW4gc2hlbGwgYW5kIGhvbGUgYXBwZWFyIHRvIGJlIGVxdWFsJyk7cmV0dXJuIG51bGw7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Jc1ZhbGlkT3AucHJvdG90eXBlLmNoZWNrQ29ubmVjdGVkSW50ZXJpb3JzPWZ1bmN0aW9uKGdyYXBoKXt2YXIgY2l0PW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25uZWN0ZWRJbnRlcmlvclRlc3RlcihncmFwaCk7aWYoIWNpdC5pc0ludGVyaW9yc0Nvbm5lY3RlZCgpKXt0aGlzLnZhbGlkRXJyPW5ldyBqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvcihqc3RzLm9wZXJhdGlvbi52YWxpZC5Ub3BvbG9neVZhbGlkYXRpb25FcnJvci5ESVNDT05ORUNURURfSU5URVJJT1IsY2l0LmdldENvb3JkaW5hdGUoKSk7fX07anN0cy5hbGdvcml0aG0uUm9idXN0RGV0ZXJtaW5hbnQ9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50LnNpZ25PZkRldDJ4Mj1mdW5jdGlvbih4MSx5MSx4Mix5Mil7dmFyIHNpZ24sc3dhcCxrLGNvdW50O2NvdW50PTA7c2lnbj0xO2lmKCh4MT09PTAuMCl8fCh5Mj09PTAuMCkpe2lmKCh5MT09PTAuMCl8fCh4Mj09PTAuMCkpe3JldHVybiAwO31cbmVsc2UgaWYoeTE+MCl7aWYoeDI+MCl7cmV0dXJuLXNpZ247fVxuZWxzZXtyZXR1cm4gc2lnbjt9fVxuZWxzZXtpZih4Mj4wKXtyZXR1cm4gc2lnbjt9XG5lbHNle3JldHVybi1zaWduO319fVxuaWYoKHkxPT09MC4wKXx8KHgyPT09MC4wKSl7aWYoeTI+MCl7aWYoeDE+MCl7cmV0dXJuIHNpZ247fVxuZWxzZXtyZXR1cm4tc2lnbjt9fVxuZWxzZXtpZih4MT4wKXtyZXR1cm4tc2lnbjt9XG5lbHNle3JldHVybiBzaWduO319fVxuaWYoMC4wPHkxKXtpZigwLjA8eTIpe2lmKHkxPnkyKXtzaWduPS1zaWduO3N3YXA9eDE7eDE9eDI7eDI9c3dhcDtzd2FwPXkxO3kxPXkyO3kyPXN3YXA7fX1cbmVsc2V7aWYoeTE8PS15Mil7c2lnbj0tc2lnbjt4Mj0teDI7eTI9LXkyO31cbmVsc2V7c3dhcD14MTt4MT0teDI7eDI9c3dhcDtzd2FwPXkxO3kxPS15Mjt5Mj1zd2FwO319fVxuZWxzZXtpZigwLjA8eTIpe2lmKC15MTw9eTIpe3NpZ249LXNpZ247eDE9LXgxO3kxPS15MTt9XG5lbHNle3N3YXA9LXgxO3gxPXgyO3gyPXN3YXA7c3dhcD0teTE7eTE9eTI7eTI9c3dhcDt9fVxuZWxzZXtpZih5MT49eTIpe3gxPS14MTt5MT0teTE7eDI9LXgyO3kyPS15Mjt9XG5lbHNle3NpZ249LXNpZ247c3dhcD0teDE7eDE9LXgyO3gyPXN3YXA7c3dhcD0teTE7eTE9LXkyO3kyPXN3YXA7fX19XG5pZigwLjA8eDEpe2lmKDAuMDx4Mil7aWYoeDE+eDIpe3JldHVybiBzaWduO319XG5lbHNle3JldHVybiBzaWduO319XG5lbHNle2lmKDAuMDx4Mil7cmV0dXJuLXNpZ247fVxuZWxzZXtpZih4MT49eDIpe3NpZ249LXNpZ247eDE9LXgxO3gyPS14Mjt9XG5lbHNle3JldHVybi1zaWduO319fVxud2hpbGUodHJ1ZSl7Y291bnQ9Y291bnQrMTtrPU1hdGguZmxvb3IoeDIveDEpO3gyPXgyLWsqeDE7eTI9eTItayp5MTtpZih5MjwwLjApe3JldHVybi1zaWduO31cbmlmKHkyPnkxKXtyZXR1cm4gc2lnbjt9XG5pZih4MT54Mit4Mil7aWYoeTE8eTIreTIpe3JldHVybiBzaWduO319XG5lbHNle2lmKHkxPnkyK3kyKXtyZXR1cm4tc2lnbjt9XG5lbHNle3gyPXgxLXgyO3kyPXkxLXkyO3NpZ249LXNpZ247fX1cbmlmKHkyPT09MC4wKXtpZih4Mj09PTAuMCl7cmV0dXJuIDA7fVxuZWxzZXtyZXR1cm4tc2lnbjt9fVxuaWYoeDI9PT0wLjApe3JldHVybiBzaWduO31cbms9TWF0aC5mbG9vcih4MS94Mik7eDE9eDEtayp4Mjt5MT15MS1rKnkyO2lmKHkxPDAuMCl7cmV0dXJuIHNpZ247fVxuaWYoeTE+eTIpe3JldHVybi1zaWduO31cbmlmKHgyPngxK3gxKXtpZih5Mjx5MSt5MSl7cmV0dXJuLXNpZ247fX1cbmVsc2V7aWYoeTI+eTEreTEpe3JldHVybiBzaWduO31cbmVsc2V7eDE9eDIteDE7eTE9eTIteTE7c2lnbj0tc2lnbjt9fVxuaWYoeTE9PT0wLjApe2lmKHgxPT09MC4wKXtyZXR1cm4gMDt9XG5lbHNle3JldHVybiBzaWduO319XG5pZih4MT09PTAuMCl7cmV0dXJuLXNpZ247fX19O2pzdHMuYWxnb3JpdGhtLlJvYnVzdERldGVybWluYW50Lm9yaWVudGF0aW9uSW5kZXg9ZnVuY3Rpb24ocDEscDIscSl7dmFyIGR4MT1wMi54LXAxLng7dmFyIGR5MT1wMi55LXAxLnk7dmFyIGR4Mj1xLngtcDIueDt2YXIgZHkyPXEueS1wMi55O3JldHVybiBqc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoZHgxLGR5MSxkeDIsZHkyKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2U9ZnVuY3Rpb24oKXt0aGlzLnN1Ym5vZGU9bmV3IEFycmF5KDQpO3RoaXMuc3Vibm9kZVswXT1udWxsO3RoaXMuc3Vibm9kZVsxXT1udWxsO3RoaXMuc3Vibm9kZVsyXT1udWxsO3RoaXMuc3Vibm9kZVszXT1udWxsO3RoaXMuaXRlbXM9W107fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5nZXRTdWJub2RlSW5kZXg9ZnVuY3Rpb24oZW52LGNlbnRyZSl7dmFyIHN1Ym5vZGVJbmRleD0tMTtpZihlbnYuZ2V0TWluWCgpPj1jZW50cmUueCl7aWYoZW52LmdldE1pblkoKT49Y2VudHJlLnkpe3N1Ym5vZGVJbmRleD0zO31cbmlmKGVudi5nZXRNYXhZKCk8PWNlbnRyZS55KXtzdWJub2RlSW5kZXg9MTt9fVxuaWYoZW52LmdldE1heFgoKTw9Y2VudHJlLngpe2lmKGVudi5nZXRNaW5ZKCk+PWNlbnRyZS55KXtzdWJub2RlSW5kZXg9Mjt9XG5pZihlbnYuZ2V0TWF4WSgpPD1jZW50cmUueSl7c3Vibm9kZUluZGV4PTA7fX1cbnJldHVybiBzdWJub2RlSW5kZXg7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuaGFzSXRlbXM9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5pdGVtcy5sZW5ndGg+MCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaXRlbSl7dGhpcy5pdGVtcy5wdXNoKGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChpdGVtRW52KSl7cmV0dXJuIGZhbHNlO31cbnZhciBmb3VuZD1mYWxzZSxpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7Zm91bmQ9dGhpcy5zdWJub2RlW2ldLnJlbW92ZShpdGVtRW52LGl0ZW0pO2lmKGZvdW5kKXtpZih0aGlzLnN1Ym5vZGVbaV0uaXNQcnVuYWJsZSgpKXt0aGlzLnN1Ym5vZGVbaV09bnVsbDt9XG5icmVhazt9fX1cbmlmKGZvdW5kKXtyZXR1cm4gZm91bmQ7fVxuaWYodGhpcy5pdGVtcy5pbmRleE9mKGl0ZW0pIT09LTEpe2Zvcih2YXIgaT10aGlzLml0ZW1zLmxlbmd0aC0xO2k+PTA7aS0tKXtpZih0aGlzLml0ZW1zW2ldPT09aXRlbSl7dGhpcy5pdGVtcy5zcGxpY2UoaSwxKTt9fVxuZm91bmQ9dHJ1ZTt9XG5yZXR1cm4gZm91bmQ7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5pc1BydW5hYmxlPWZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLmhhc0NoaWxkcmVuKCl8fHRoaXMuaGFzSXRlbXMoKSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5oYXNDaGlsZHJlbj1mdW5jdGlvbigpe3ZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmlzRW1wdHk9ZnVuY3Rpb24oKXt2YXIgaXNFbXB0eT10cnVlO2lmKHRoaXMuaXRlbXMubGVuZ3RoPjApe2lzRW1wdHk9ZmFsc2U7fVxudmFyIGk9MDtmb3IoaTtpPDQ7aSsrKXtpZih0aGlzLnN1Ym5vZGVbaV0hPT1udWxsKXtpZighdGhpcy5zdWJub2RlW2ldLmlzRW1wdHkoKSl7aXNFbXB0eT1mYWxzZTt9fX1cbnJldHVybiBpc0VtcHR5O307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuYWRkQWxsSXRlbXM9ZnVuY3Rpb24ocmVzdWx0SXRlbXMpe3Jlc3VsdEl0ZW1zPXJlc3VsdEl0ZW1zLmNvbmNhdCh0aGlzLml0ZW1zKTt2YXIgaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3Jlc3VsdEl0ZW1zPXRoaXMuc3Vibm9kZVtpXS5hZGRBbGxJdGVtcyhyZXN1bHRJdGVtcyk7fX1cbnJldHVybiByZXN1bHRJdGVtczt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nPWZ1bmN0aW9uKHNlYXJjaEVudixyZXN1bHRJdGVtcyl7aWYoIXRoaXMuaXNTZWFyY2hNYXRjaChzZWFyY2hFbnYpKXtyZXR1cm47fVxucmVzdWx0SXRlbXM9cmVzdWx0SXRlbXMuY29uY2F0KHRoaXMuaXRlbXMpO3ZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7cmVzdWx0SXRlbXM9dGhpcy5zdWJub2RlW2ldLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nKHNlYXJjaEVudixyZXN1bHRJdGVtcyk7fX19O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLnZpc2l0PWZ1bmN0aW9uKHNlYXJjaEVudix2aXNpdG9yKXtpZighdGhpcy5pc1NlYXJjaE1hdGNoKHNlYXJjaEVudikpe3JldHVybjt9XG50aGlzLnZpc2l0SXRlbXMoc2VhcmNoRW52LHZpc2l0b3IpO3ZhciBpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7dGhpcy5zdWJub2RlW2ldLnZpc2l0KHNlYXJjaEVudix2aXNpdG9yKTt9fX07anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUudmlzaXRJdGVtcz1mdW5jdGlvbihlbnYsdmlzaXRvcil7dmFyIGk9MCxpbD10aGlzLml0ZW1zLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7dmlzaXRvci52aXNpdEl0ZW0odGhpcy5pdGVtc1tpXSk7fX07anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXt2YXIgbWF4U3ViRGVwdGg9MCxpPTAsc3FkO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3NxZD10aGlzLnN1Ym5vZGVbaV0uZGVwdGgoKTtpZihzcWQ+bWF4U3ViRGVwdGgpe21heFN1YkRlcHRoPXNxZDt9fX1cbnJldHVybiBtYXhTdWJEZXB0aCsxO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wO2ZvcihpO2k8NDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5zaXplKCk7fX1cbnJldHVybiBzdWJTaXplK3RoaXMuaXRlbXMubGVuZ3RoO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZS5wcm90b3R5cGUuZ2V0Tm9kZUNvdW50PWZ1bmN0aW9uKCl7dmFyIHN1YlNpemU9MCxpPTA7Zm9yKGk7aTw0O2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7c3ViU2l6ZSs9dGhpcy5zdWJub2RlW2ldLnNpemUoKTt9fVxucmV0dXJuIHN1YlNpemUrMTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZT1mdW5jdGlvbihlbnYsbGV2ZWwpe2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZUJhc2UucHJvdG90eXBlLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLmVudj1lbnY7dGhpcy5sZXZlbD1sZXZlbDt0aGlzLmNlbnRyZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTt0aGlzLmNlbnRyZS54PShlbnYuZ2V0TWluWCgpK2Vudi5nZXRNYXhYKCkpLzI7dGhpcy5jZW50cmUueT0oZW52LmdldE1pblkoKStlbnYuZ2V0TWF4WSgpKS8yO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZSgpO2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGVudil7dmFyIGtleSxub2RlO2tleT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5LZXkoZW52KTtub2RlPW5ldyBqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUoa2V5LmdldEVudmVsb3BlKCksa2V5LmdldExldmVsKCkpO3JldHVybiBub2RlO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLmNyZWF0ZUV4cGFuZGVkPWZ1bmN0aW9uKG5vZGUsYWRkRW52KXt2YXIgZXhwYW5kRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoYWRkRW52KSxsYXJnZXJOb2RlO2lmKG5vZGUhPT1udWxsKXtleHBhbmRFbnYuZXhwYW5kVG9JbmNsdWRlKG5vZGUuZW52KTt9XG5sYXJnZXJOb2RlPWpzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5jcmVhdGVOb2RlKGV4cGFuZEVudik7aWYobm9kZSE9PW51bGwpe2xhcmdlck5vZGUuaW5zZXJ0Tm9kZShub2RlKTt9XG5yZXR1cm4gbGFyZ2VyTm9kZTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbnY7fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmlzU2VhcmNoTWF0Y2g9ZnVuY3Rpb24oc2VhcmNoRW52KXtyZXR1cm4gdGhpcy5lbnYuaW50ZXJzZWN0cyhzZWFyY2hFbnYpO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKHNlYXJjaEVudil7dmFyIHN1Ym5vZGVJbmRleD10aGlzLmdldFN1Ym5vZGVJbmRleChzZWFyY2hFbnYsdGhpcy5jZW50cmUpLG5vZGU7aWYoc3Vibm9kZUluZGV4IT09LTEpe25vZGU9dGhpcy5nZXRTdWJub2RlKHN1Ym5vZGVJbmRleCk7cmV0dXJuIG5vZGUuZ2V0Tm9kZShzZWFyY2hFbnYpO31lbHNle3JldHVybiB0aGlzO319O2pzdHMuaW5kZXgucXVhZHRyZWUuTm9kZS5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihzZWFyY2hFbnYpe3ZhciBzdWJub2RlSW5kZXg9dGhpcy5nZXRTdWJub2RlSW5kZXgoc2VhcmNoRW52LHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleD09PS0xKXtyZXR1cm4gdGhpczt9XG5pZih0aGlzLnN1Ym5vZGVbc3Vibm9kZUluZGV4XSE9PW51bGwpe25vZGU9dGhpcy5zdWJub2RlW3N1Ym5vZGVJbmRleF07cmV0dXJuIG5vZGUuZmluZChzZWFyY2hFbnYpO31cbnJldHVybiB0aGlzO307anN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlLnByb3RvdHlwZS5pbnNlcnROb2RlPWZ1bmN0aW9uKG5vZGUpe3ZhciBpbmRleD10aGlzLmdldFN1Ym5vZGVJbmRleChub2RlLmVudix0aGlzLmNlbnRyZSksY2hpbGROb2RlO2lmKG5vZGUubGV2ZWw9PT10aGlzLmxldmVsLTEpe3RoaXMuc3Vibm9kZVtpbmRleF09bm9kZTt9ZWxzZXtjaGlsZE5vZGU9dGhpcy5jcmVhdGVTdWJub2RlKGluZGV4KTtjaGlsZE5vZGUuaW5zZXJ0Tm9kZShub2RlKTt0aGlzLnN1Ym5vZGVbaW5kZXhdPWNoaWxkTm9kZTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmdldFN1Ym5vZGU9ZnVuY3Rpb24oaW5kZXgpe2lmKHRoaXMuc3Vibm9kZVtpbmRleF09PT1udWxsKXt0aGlzLnN1Ym5vZGVbaW5kZXhdPXRoaXMuY3JlYXRlU3Vibm9kZShpbmRleCk7fVxucmV0dXJuIHRoaXMuc3Vibm9kZVtpbmRleF07fTtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUucHJvdG90eXBlLmNyZWF0ZVN1Ym5vZGU9ZnVuY3Rpb24oaW5kZXgpe3ZhciBtaW54PTAuMCxtYXh4PTAuMCxtaW55PTAuMCxtYXh5PTAuMCxzcUVudixub2RlO3N3aXRjaChpbmRleCl7Y2FzZSAwOm1pbng9dGhpcy5lbnYuZ2V0TWluWCgpO21heHg9dGhpcy5jZW50cmUueDttaW55PXRoaXMuZW52LmdldE1pblkoKTttYXh5PXRoaXMuY2VudHJlLnk7YnJlYWs7Y2FzZSAxOm1pbng9dGhpcy5jZW50cmUueDttYXh4PXRoaXMuZW52LmdldE1heFgoKTttaW55PXRoaXMuZW52LmdldE1pblkoKTttYXh5PXRoaXMuY2VudHJlLnk7YnJlYWs7Y2FzZSAyOm1pbng9dGhpcy5lbnYuZ2V0TWluWCgpO21heHg9dGhpcy5jZW50cmUueDttaW55PXRoaXMuY2VudHJlLnk7bWF4eT10aGlzLmVudi5nZXRNYXhZKCk7YnJlYWs7Y2FzZSAzOm1pbng9dGhpcy5jZW50cmUueDttYXh4PXRoaXMuZW52LmdldE1heFgoKTttaW55PXRoaXMuY2VudHJlLnk7bWF4eT10aGlzLmVudi5nZXRNYXhZKCk7YnJlYWs7fVxuc3FFbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZShtaW54LG1heHgsbWlueSxtYXh5KTtub2RlPW5ldyBqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUoc3FFbnYsdGhpcy5sZXZlbC0xKTtyZXR1cm4gbm9kZTt9OyhmdW5jdGlvbigpe2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2U9ZnVuY3Rpb24oKXt0aGlzLnJvdD1udWxsO3RoaXMudmVydGV4PW51bGw7dGhpcy5uZXh0PW51bGw7dGhpcy5kYXRhPW51bGw7fTt2YXIgUXVhZEVkZ2U9anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLm1ha2VFZGdlPWZ1bmN0aW9uKG8sZCl7dmFyIHEwLHExLHEyLHEzLGJhc2U7cTA9bmV3IFF1YWRFZGdlKCk7cTE9bmV3IFF1YWRFZGdlKCk7cTI9bmV3IFF1YWRFZGdlKCk7cTM9bmV3IFF1YWRFZGdlKCk7cTAucm90PXExO3ExLnJvdD1xMjtxMi5yb3Q9cTM7cTMucm90PXEwO3EwLnNldE5leHQocTApO3ExLnNldE5leHQocTMpO3EyLnNldE5leHQocTIpO3EzLnNldE5leHQocTEpO2Jhc2U9cTA7YmFzZS5zZXRPcmlnKG8pO2Jhc2Uuc2V0RGVzdChkKTtyZXR1cm4gYmFzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UuY29ubmVjdD1mdW5jdGlvbihhLGIpe3ZhciBlPVF1YWRFZGdlLm1ha2VFZGdlKGEuZGVzdCgpLGIub3JpZygpKTtRdWFkRWRnZS5zcGxpY2UoZSxhLmxOZXh0KCkpO1F1YWRFZGdlLnNwbGljZShlLnN5bSgpLGIpO3JldHVybiBlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zcGxpY2U9ZnVuY3Rpb24oYSxiKXt2YXIgYWxwaGEsYmV0YSx0MSx0Mix0Myx0NDthbHBoYT1hLm9OZXh0KCkucm90O2JldGE9Yi5vTmV4dCgpLnJvdDt0MT1iLm9OZXh0KCk7dDI9YS5vTmV4dCgpO3QzPWJldGEub05leHQoKTt0ND1hbHBoYS5vTmV4dCgpO2Euc2V0TmV4dCh0MSk7Yi5zZXROZXh0KHQyKTthbHBoYS5zZXROZXh0KHQzKTtiZXRhLnNldE5leHQodDQpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zd2FwPWZ1bmN0aW9uKGUpe3ZhciBhLGI7YT1lLm9QcmV2KCk7Yj1lLnN5bSgpLm9QcmV2KCk7UXVhZEVkZ2Uuc3BsaWNlKGUsYSk7UXVhZEVkZ2Uuc3BsaWNlKGUuc3ltKCksYik7UXVhZEVkZ2Uuc3BsaWNlKGUsYS5sTmV4dCgpKTtRdWFkRWRnZS5zcGxpY2UoZS5zeW0oKSxiLmxOZXh0KCkpO2Uuc2V0T3JpZyhhLmRlc3QoKSk7ZS5zZXREZXN0KGIuZGVzdCgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmdldFByaW1hcnk9ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWcoKS5nZXRDb29yZGluYXRlKCkuY29tcGFyZVRvKHRoaXMuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk8PTApe3JldHVybiB0aGlzO31cbmVsc2V7cmV0dXJuIHRoaXMuc3ltKCk7fX07anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuc2V0RGF0YT1mdW5jdGlvbihkYXRhKXt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZGVsZXRlX2pzdHM9ZnVuY3Rpb24oKXt0aGlzLnJvdD1udWxsO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuaXNMaXZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm90IT09bnVsbDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldE5leHQ9ZnVuY3Rpb24obmV4dCl7dGhpcy5uZXh0PW5leHQ7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5pbnZSb3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3Quc3ltKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5zeW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3Qucm90O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUub05leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUub1ByZXY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3QubmV4dC5yb3Q7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5kTmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN5bSgpLm9OZXh0KCkuc3ltKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5kUHJldj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludlJvdCgpLm9OZXh0KCkuaW52Um90KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5sTmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludlJvdCgpLm9OZXh0KCkucm90O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUubFByZXY9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0LnN5bSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuck5leHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb3QubmV4dC5pbnZSb3QoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnJQcmV2PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3ltKCkub05leHQoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldE9yaWc9ZnVuY3Rpb24obyl7dGhpcy52ZXJ0ZXg9bzt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnNldERlc3Q9ZnVuY3Rpb24oZCl7dGhpcy5zeW0oKS5zZXRPcmlnKGQpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUub3JpZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnZlcnRleDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLmRlc3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zeW0oKS5vcmlnKCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS5nZXRMZW5ndGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpLmRpc3RhbmNlKGRlc3QoKS5nZXRDb29yZGluYXRlKCkpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZXF1YWxzTm9uT3JpZW50ZWQ9ZnVuY3Rpb24ocWUpe2lmKHRoaXMuZXF1YWxzT3JpZW50ZWQocWUpKXtyZXR1cm4gdHJ1ZTt9XG5pZih0aGlzLmVxdWFsc09yaWVudGVkKHFlLnN5bSgpKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5wcm90b3R5cGUuZXF1YWxzT3JpZW50ZWQ9ZnVuY3Rpb24ocWUpe2lmKHRoaXMub3JpZygpLmdldENvb3JkaW5hdGUoKS5lcXVhbHMyRChxZS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpKSYmdGhpcy5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpLmVxdWFsczJEKHFlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkpKXtyZXR1cm4gdHJ1ZTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnByb3RvdHlwZS50b0xpbmVTZWdtZW50PWZ1bmN0aW9uKClcbntyZXR1cm4gbmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCh0aGlzLnZlcnRleC5nZXRDb29yZGluYXRlKCksdGhpcy5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dmFyIHAwLHAxO3AwPXRoaXMudmVydGV4LmdldENvb3JkaW5hdGUoKTtwMT10aGlzLmRlc3QoKS5nZXRDb29yZGluYXRlKCk7cmV0dXJuIGpzdHMuaW8uV0tUV3JpdGVyLnRvTGluZVN0cmluZyhwMCxwMSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kPWZ1bmN0aW9uKGVkZ2UscDAscDEsbGFiZWwpe3RoaXMuZWRnZT1lZGdlO2lmKHAwJiZwMSl7dGhpcy5pbml0KHAwLHAxKTt9XG5pZihsYWJlbCl7dGhpcy5sYWJlbD1sYWJlbHx8bnVsbDt9fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5lZGdlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUubGFiZWw9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5ub2RlPW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUucDA9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5wMT1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmR4PW51bGw7anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZHk9bnVsbDtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5xdWFkcmFudD1udWxsO2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmluaXQ9ZnVuY3Rpb24ocDAscDEpe3RoaXMucDA9cDA7dGhpcy5wMT1wMTt0aGlzLmR4PXAxLngtcDAueDt0aGlzLmR5PXAxLnktcDAueTt0aGlzLnF1YWRyYW50PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHRoaXMuZHgsdGhpcy5keSk7QXNzZXJ0LmlzVHJ1ZSghKHRoaXMuZHg9PT0wJiZ0aGlzLmR5PT09MCksJ0VkZ2VFbmQgd2l0aCBpZGVudGljYWwgZW5kcG9pbnRzIGZvdW5kJyk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRFZGdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmdldExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGFiZWw7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDA7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXREaXJlY3RlZENvb3JkaW5hdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wMTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmdldFF1YWRyYW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucXVhZHJhbnQ7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXREeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmR4O307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuZ2V0RHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5keTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLnNldE5vZGU9ZnVuY3Rpb24obm9kZSl7dGhpcy5ub2RlPW5vZGU7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5nZXROb2RlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZTt9O2pzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5jb21wYXJlRGlyZWN0aW9uKGUpO307anN0cy5nZW9tZ3JhcGguRWRnZUVuZC5wcm90b3R5cGUuY29tcGFyZURpcmVjdGlvbj1mdW5jdGlvbihlKXtpZih0aGlzLmR4PT09ZS5keCYmdGhpcy5keT09PWUuZHkpXG5yZXR1cm4gMDtpZih0aGlzLnF1YWRyYW50PmUucXVhZHJhbnQpXG5yZXR1cm4gMTtpZih0aGlzLnF1YWRyYW50PGUucXVhZHJhbnQpXG5yZXR1cm4tMTtyZXR1cm4ganN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmNvbXB1dGVPcmllbnRhdGlvbihlLnAwLGUucDEsdGhpcy5wMSk7fTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLnByb3RvdHlwZS5jb21wdXRlTGFiZWw9ZnVuY3Rpb24oYm91bmRhcnlOb2RlUnVsZSl7fTt9KSgpO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyPWZ1bmN0aW9uKCl7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUubWluSW5kZXg9LTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm1pbkNvb3JkPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm1pbkRlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLm9yaWVudGVkRGU9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9yaWVudGVkRGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1pbkNvb3JkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmZpbmRFZGdlPWZ1bmN0aW9uKGRpckVkZ2VMaXN0KXtmb3IodmFyIGk9ZGlyRWRnZUxpc3QuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBkZT1pLm5leHQoKTtpZighZGUuaXNGb3J3YXJkKCkpXG5jb250aW51ZTt0aGlzLmNoZWNrRm9yUmlnaHRtb3N0Q29vcmRpbmF0ZShkZSk7fVxuanN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5taW5JbmRleCE9PTB8fHRoaXMubWluQ29vcmQuZXF1YWxzKHRoaXMubWluRGUuZ2V0Q29vcmRpbmF0ZSgpKSwnaW5jb25zaXN0ZW5jeSBpbiByaWdodG1vc3QgcHJvY2Vzc2luZycpO2lmKHRoaXMubWluSW5kZXg9PT0wKXt0aGlzLmZpbmRSaWdodG1vc3RFZGdlQXROb2RlKCk7fWVsc2V7dGhpcy5maW5kUmlnaHRtb3N0RWRnZUF0VmVydGV4KCk7fVxudGhpcy5vcmllbnRlZERlPXRoaXMubWluRGU7dmFyIHJpZ2h0bW9zdFNpZGU9dGhpcy5nZXRSaWdodG1vc3RTaWRlKHRoaXMubWluRGUsdGhpcy5taW5JbmRleCk7aWYocmlnaHRtb3N0U2lkZT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCl7dGhpcy5vcmllbnRlZERlPXRoaXMubWluRGUuZ2V0U3ltKCk7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmZpbmRSaWdodG1vc3RFZGdlQXROb2RlPWZ1bmN0aW9uKCl7dmFyIG5vZGU9dGhpcy5taW5EZS5nZXROb2RlKCk7dmFyIHN0YXI9bm9kZS5nZXRFZGdlcygpO3RoaXMubWluRGU9c3Rhci5nZXRSaWdodG1vc3RFZGdlKCk7aWYoIXRoaXMubWluRGUuaXNGb3J3YXJkKCkpe3RoaXMubWluRGU9dGhpcy5taW5EZS5nZXRTeW0oKTt0aGlzLm1pbkluZGV4PXRoaXMubWluRGUuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCkubGVuZ3RoLTE7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmZpbmRSaWdodG1vc3RFZGdlQXRWZXJ0ZXg9ZnVuY3Rpb24oKXt2YXIgcHRzPXRoaXMubWluRGUuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCk7anN0cy51dGlsLkFzc2VydC5pc1RydWUodGhpcy5taW5JbmRleD4wJiZ0aGlzLm1pbkluZGV4PHB0cy5sZW5ndGgsJ3JpZ2h0bW9zdCBwb2ludCBleHBlY3RlZCB0byBiZSBpbnRlcmlvciB2ZXJ0ZXggb2YgZWRnZScpO3ZhciBwUHJldj1wdHNbdGhpcy5taW5JbmRleC0xXTt2YXIgcE5leHQ9cHRzW3RoaXMubWluSW5kZXgrMV07dmFyIG9yaWVudGF0aW9uPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5jb21wdXRlT3JpZW50YXRpb24odGhpcy5taW5Db29yZCxwTmV4dCxwUHJldik7dmFyIHVzZVByZXY9ZmFsc2U7aWYocFByZXYueTx0aGlzLm1pbkNvb3JkLnkmJnBOZXh0Lnk8dGhpcy5taW5Db29yZC55JiZvcmllbnRhdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DT1VOVEVSQ0xPQ0tXSVNFKXt1c2VQcmV2PXRydWU7fWVsc2UgaWYocFByZXYueT50aGlzLm1pbkNvb3JkLnkmJnBOZXh0Lnk+dGhpcy5taW5Db29yZC55JiZvcmllbnRhdGlvbj09PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5DTE9DS1dJU0Upe3VzZVByZXY9dHJ1ZTt9XG5pZih1c2VQcmV2KXt0aGlzLm1pbkluZGV4PXRoaXMubWluSW5kZXgtMTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuUmlnaHRtb3N0RWRnZUZpbmRlci5wcm90b3R5cGUuY2hlY2tGb3JSaWdodG1vc3RDb29yZGluYXRlPWZ1bmN0aW9uKGRlKXt2YXIgY29vcmQ9ZGUuZ2V0RWRnZSgpLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxjb29yZC5sZW5ndGgtMTtpKyspe2lmKHRoaXMubWluQ29vcmQ9PT1udWxsfHxjb29yZFtpXS54PnRoaXMubWluQ29vcmQueCl7dGhpcy5taW5EZT1kZTt0aGlzLm1pbkluZGV4PWk7dGhpcy5taW5Db29yZD1jb29yZFtpXTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldFJpZ2h0bW9zdFNpZGU9ZnVuY3Rpb24oZGUsaW5kZXgpe3ZhciBzaWRlPXRoaXMuZ2V0UmlnaHRtb3N0U2lkZU9mU2VnbWVudChkZSxpbmRleCk7aWYoc2lkZTwwKVxuc2lkZT10aGlzLmdldFJpZ2h0bW9zdFNpZGVPZlNlZ21lbnQoZGUsaW5kZXgtMSk7aWYoc2lkZTwwKXt0aGlzLm1pbkNvb3JkPW51bGw7dGhpcy5jaGVja0ZvclJpZ2h0bW9zdENvb3JkaW5hdGUoZGUpO31cbnJldHVybiBzaWRlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLlJpZ2h0bW9zdEVkZ2VGaW5kZXIucHJvdG90eXBlLmdldFJpZ2h0bW9zdFNpZGVPZlNlZ21lbnQ9ZnVuY3Rpb24oZGUsaSl7dmFyIGU9ZGUuZ2V0RWRnZSgpO3ZhciBjb29yZD1lLmdldENvb3JkaW5hdGVzKCk7aWYoaTwwfHxpKzE+PWNvb3JkLmxlbmd0aClcbnJldHVybi0xO2lmKGNvb3JkW2ldLnk9PWNvb3JkW2krMV0ueSlcbnJldHVybi0xO3ZhciBwb3M9anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVDtpZihjb29yZFtpXS55PGNvb3JkW2krMV0ueSlcbnBvcz1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVDtyZXR1cm4gcG9zO307KGZ1bmN0aW9uKCl7anN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yPWZ1bmN0aW9uKHN1YmRpdil7dGhpcy5zdWJkaXY9c3ViZGl2O3RoaXMuaXNVc2luZ1RvbGVyYW5jZT1zdWJkaXYuZ2V0VG9sZXJhbmNlKCk+MC4wO307anN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yLnByb3RvdHlwZS5pbnNlcnRTaXRlcz1mdW5jdGlvbih2ZXJ0aWNlcyl7dmFyIGk9MCxpbD12ZXJ0aWNlcy5sZW5ndGgsdjtmb3IoaTtpPGlsO2krKyl7dj12ZXJ0aWNlc1tpXTt0aGlzLmluc2VydFNpdGUodik7fX07anN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yLnByb3RvdHlwZS5pbnNlcnRTaXRlPWZ1bmN0aW9uKHYpe3ZhciBlLGJhc2Usc3RhcnRFZGdlLHQ7ZT10aGlzLnN1YmRpdi5sb2NhdGUodik7aWYodGhpcy5zdWJkaXYuaXNWZXJ0ZXhPZkVkZ2UoZSx2KSl7cmV0dXJuIGU7fVxuZWxzZSBpZih0aGlzLnN1YmRpdi5pc09uRWRnZShlLHYuZ2V0Q29vcmRpbmF0ZSgpKSl7ZT1lLm9QcmV2KCk7dGhpcy5zdWJkaXYuZGVsZXRlX2pzdHMoZS5vTmV4dCgpKTt9XG5iYXNlPXRoaXMuc3ViZGl2Lm1ha2VFZGdlKGUub3JpZygpLHYpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGJhc2UsZSk7c3RhcnRFZGdlPWJhc2U7ZG97YmFzZT10aGlzLnN1YmRpdi5jb25uZWN0KGUsYmFzZS5zeW0oKSk7ZT1iYXNlLm9QcmV2KCk7fXdoaWxlKGUubE5leHQoKSE9c3RhcnRFZGdlKTtkb3t0PWUub1ByZXYoKTtpZih0LmRlc3QoKS5yaWdodE9mKGUpJiZ2LmlzSW5DaXJjbGUoZS5vcmlnKCksdC5kZXN0KCksZS5kZXN0KCkpKXtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnN3YXAoZSk7ZT1lLm9QcmV2KCk7fWVsc2UgaWYoZS5vTmV4dCgpPT1zdGFydEVkZ2Upe3JldHVybiBiYXNlO31lbHNle2U9ZS5vTmV4dCgpLmxQcmV2KCk7fX13aGlsZSh0cnVlKTt9O30oKSk7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhPWZ1bmN0aW9uKCl7dGhpcy5iYXNlUHQ9bnVsbDt0aGlzLnRyaWFuZ2xlQ2VudDM9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5jZW50U3VtPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3RoaXMuY2czPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5iYXNlUHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLnRyaWFuZ2xlQ2VudDM9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFyZWFzdW0yPTA7anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5jZzM9bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmNlbnRTdW09bnVsbDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLnRvdGFsTGVuZ3RoPTAuMDtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pe3ZhciBwb2x5PWdlb207dGhpcy5zZXRCYXNlUG9pbnQocG9seS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlTigwKSk7dGhpcy5hZGQzKHBvbHkpO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dmFyIGdjPWdlb207Zm9yKHZhciBpPTA7aTxnYy5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXt0aGlzLmFkZChnYy5nZXRHZW9tZXRyeU4oaSkpO319ZWxzZSBpZihnZW9tIGluc3RhbmNlb2YgQXJyYXkpe3RoaXMuYWRkMihnZW9tKTt9fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZDI9ZnVuY3Rpb24ocmluZyl7dGhpcy5zZXRCYXNlUG9pbnQocmluZ1swXSk7dGhpcy5hZGRTaGVsbChyaW5nKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuZ2V0Q2VudHJvaWQ9ZnVuY3Rpb24oKXt2YXIgY2VudD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKTtpZihNYXRoLmFicyh0aGlzLmFyZWFzdW0yKT4wLjApe2NlbnQueD10aGlzLmNnMy54LzMvdGhpcy5hcmVhc3VtMjtjZW50Lnk9dGhpcy5jZzMueS8zL3RoaXMuYXJlYXN1bTI7fWVsc2V7Y2VudC54PXRoaXMuY2VudFN1bS54L3RoaXMudG90YWxMZW5ndGg7Y2VudC55PXRoaXMuY2VudFN1bS55L3RoaXMudG90YWxMZW5ndGg7fVxucmV0dXJuIGNlbnQ7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLnNldEJhc2VQb2ludD1mdW5jdGlvbihiYXNlUHQpe2lmKHRoaXMuYmFzZVB0PT1udWxsKVxudGhpcy5iYXNlUHQ9YmFzZVB0O307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGQzPWZ1bmN0aW9uKHBvbHkpe3RoaXMuYWRkU2hlbGwocG9seS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlcygpKTtmb3IodmFyIGk9MDtpPHBvbHkuZ2V0TnVtSW50ZXJpb3JSaW5nKCk7aSsrKXt0aGlzLmFkZEhvbGUocG9seS5nZXRJbnRlcmlvclJpbmdOKGkpLmdldENvb3JkaW5hdGVzKCkpO319O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkU2hlbGw9ZnVuY3Rpb24ocHRzKXt2YXIgaXNQb3NpdGl2ZUFyZWE9IWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5pc0NDVyhwdHMpO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dGhpcy5hZGRUcmlhbmdsZSh0aGlzLmJhc2VQdCxwdHNbaV0scHRzW2krMV0saXNQb3NpdGl2ZUFyZWEpO31cbnRoaXMuYWRkTGluZWFyU2VnbWVudHMocHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5wcm90b3R5cGUuYWRkSG9sZT1mdW5jdGlvbihwdHMpe3ZhciBpc1Bvc2l0aXZlQXJlYT1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuaXNDQ1cocHRzKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGgtMTtpKyspe3RoaXMuYWRkVHJpYW5nbGUodGhpcy5iYXNlUHQscHRzW2ldLHB0c1tpKzFdLGlzUG9zaXRpdmVBcmVhKTt9XG50aGlzLmFkZExpbmVhclNlZ21lbnRzKHB0cyk7fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEucHJvdG90eXBlLmFkZFRyaWFuZ2xlPWZ1bmN0aW9uKHAwLHAxLHAyLGlzUG9zaXRpdmVBcmVhKXt2YXIgc2lnbj0oaXNQb3NpdGl2ZUFyZWEpPzEuMDotMS4wO2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5jZW50cm9pZDMocDAscDEscDIsdGhpcy50cmlhbmdsZUNlbnQzKTt2YXIgYXJlYTI9anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLmFyZWEyKHAwLHAxLHAyKTt0aGlzLmNnMy54Kz1zaWduKmFyZWEyKnRoaXMudHJpYW5nbGVDZW50My54O3RoaXMuY2czLnkrPXNpZ24qYXJlYTIqdGhpcy50cmlhbmdsZUNlbnQzLnk7dGhpcy5hcmVhc3VtMis9c2lnbiphcmVhMjt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyb2lkQXJlYS5jZW50cm9pZDM9ZnVuY3Rpb24ocDEscDIscDMsYyl7Yy54PXAxLngrcDIueCtwMy54O2MueT1wMS55K3AyLnkrcDMueTtyZXR1cm47fTtqc3RzLmFsZ29yaXRobS5DZW50cm9pZEFyZWEuYXJlYTI9ZnVuY3Rpb24ocDEscDIscDMpe3JldHVybihwMi54LXAxLngpKihwMy55LXAxLnkpLShwMy54LXAxLngpKihwMi55LXAxLnkpO307anN0cy5hbGdvcml0aG0uQ2VudHJvaWRBcmVhLnByb3RvdHlwZS5hZGRMaW5lYXJTZWdtZW50cz1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aC0xO2krKyl7dmFyIHNlZ21lbnRMZW49cHRzW2ldLmRpc3RhbmNlKHB0c1tpKzFdKTt0aGlzLnRvdGFsTGVuZ3RoKz1zZWdtZW50TGVuO3ZhciBtaWR4PShwdHNbaV0ueCtwdHNbaSsxXS54KS8yO3RoaXMuY2VudFN1bS54Kz1zZWdtZW50TGVuKm1pZHg7dmFyIG1pZHk9KHB0c1tpXS55K3B0c1tpKzFdLnkpLzI7dGhpcy5jZW50U3VtLnkrPXNlZ21lbnRMZW4qbWlkeTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50PWZ1bmN0aW9uKGVkZ2UscHRJbmRleCl7dGhpcy5lZGdlPWVkZ2U7dGhpcy5wdEluZGV4PXB0SW5kZXg7dGhpcy5wdHM9ZWRnZS5nZXRDb29yZGluYXRlcygpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU3dlZXBMaW5lU2VnbWVudC5wcm90b3R5cGUuZWRnZT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQucHJvdG90eXBlLnB0SW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRNaW5YPWZ1bmN0aW9uKCl7dmFyIHgxPXRoaXMucHRzW3RoaXMucHRJbmRleF0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5wdEluZGV4KzFdLng7aWYoeDE8eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5nZXRNYXhYPWZ1bmN0aW9uKCl7dmFyIHgxPXRoaXMucHRzW3RoaXMucHRJbmRleF0ueDt2YXIgeDI9dGhpcy5wdHNbdGhpcy5wdEluZGV4KzFdLng7aWYoeDE+eDIpe3JldHVybiB4MTt9XG5yZXR1cm4geDI7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVTZWdtZW50LnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihzcyxzaSl7c2kuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmVkZ2UsdGhpcy5wdEluZGV4LHNzLmVkZ2Usc3MucHRJbmRleCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlJvb3Q9ZnVuY3Rpb24oKXtqc3RzLmluZGV4LnF1YWR0cmVlLk5vZGVCYXNlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy5vcmlnaW49bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKDAuMCwwLjApO307anN0cy5pbmRleC5xdWFkdHJlZS5Sb290LnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5xdWFkdHJlZS5Ob2RlQmFzZSgpO2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dmFyIGluZGV4PXRoaXMuZ2V0U3Vibm9kZUluZGV4KGl0ZW1FbnYsdGhpcy5vcmlnaW4pO2lmKGluZGV4PT09LTEpe3RoaXMuYWRkKGl0ZW0pO3JldHVybjt9XG52YXIgbm9kZT10aGlzLnN1Ym5vZGVbaW5kZXhdO2lmKG5vZGU9PT1udWxsfHwhbm9kZS5nZXRFbnZlbG9wZSgpLmNvbnRhaW5zKGl0ZW1FbnYpKXt2YXIgbGFyZ2VyTm9kZT1qc3RzLmluZGV4LnF1YWR0cmVlLk5vZGUuY3JlYXRlRXhwYW5kZWQobm9kZSxpdGVtRW52KTt0aGlzLnN1Ym5vZGVbaW5kZXhdPWxhcmdlck5vZGU7fVxudGhpcy5pbnNlcnRDb250YWluZWQodGhpcy5zdWJub2RlW2luZGV4XSxpdGVtRW52LGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5Sb290LnByb3RvdHlwZS5pbnNlcnRDb250YWluZWQ9ZnVuY3Rpb24odHJlZSxpdGVtRW52LGl0ZW0pe3ZhciBpc1plcm9YLGlzWmVyb1ksbm9kZTtpc1plcm9YPWpzdHMuaW5kZXguSW50ZXJ2YWxTaXplLmlzWmVyb1dpZHRoKGl0ZW1FbnYuZ2V0TWluWCgpLGl0ZW1FbnYuZ2V0TWF4WCgpKTtpc1plcm9ZPWpzdHMuaW5kZXguSW50ZXJ2YWxTaXplLmlzWmVyb1dpZHRoKGl0ZW1FbnYuZ2V0TWluWSgpLGl0ZW1FbnYuZ2V0TWF4WSgpKTtpZihpc1plcm9YfHxpc1plcm9ZKXtub2RlPXRyZWUuZmluZChpdGVtRW52KTt9ZWxzZXtub2RlPXRyZWUuZ2V0Tm9kZShpdGVtRW52KTt9XG5ub2RlLmFkZChpdGVtKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUm9vdC5wcm90b3R5cGUuaXNTZWFyY2hNYXRjaD1mdW5jdGlvbihzZWFyY2hFbnYpe3JldHVybiB0cnVlO307anN0cy5nZW9tZ3JhcGguaW5kZXguTW9ub3RvbmVDaGFpbkluZGV4ZXI9ZnVuY3Rpb24oKXt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyLnRvSW50QXJyYXk9ZnVuY3Rpb24obGlzdCl7dmFyIGFycmF5PVtdO2Zvcih2YXIgaT1saXN0Lml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWxlbWVudD1pLm5leHQoKTthcnJheS5wdXNoKGVsZW1lbnQpO31cbnJldHVybiBhcnJheTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyLnByb3RvdHlwZS5nZXRDaGFpblN0YXJ0SW5kaWNlcz1mdW5jdGlvbihwdHMpe3ZhciBzdGFydD0wO3ZhciBzdGFydEluZGV4TGlzdD1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3N0YXJ0SW5kZXhMaXN0LmFkZChzdGFydCk7ZG97dmFyIGxhc3Q9dGhpcy5maW5kQ2hhaW5FbmQocHRzLHN0YXJ0KTtzdGFydEluZGV4TGlzdC5hZGQobGFzdCk7c3RhcnQ9bGFzdDt9d2hpbGUoc3RhcnQ8cHRzLmxlbmd0aC0xKTt2YXIgc3RhcnRJbmRleD1qc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluSW5kZXhlci50b0ludEFycmF5KHN0YXJ0SW5kZXhMaXN0KTtyZXR1cm4gc3RhcnRJbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW5JbmRleGVyLnByb3RvdHlwZS5maW5kQ2hhaW5FbmQ9ZnVuY3Rpb24ocHRzLHN0YXJ0KXt2YXIgY2hhaW5RdWFkPWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50KHB0c1tzdGFydF0scHRzW3N0YXJ0KzFdKTt2YXIgbGFzdD1zdGFydCsxO3doaWxlKGxhc3Q8cHRzLmxlbmd0aCl7dmFyIHF1YWQ9anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQocHRzW2xhc3QtMV0scHRzW2xhc3RdKTtpZihxdWFkIT1jaGFpblF1YWQpe2JyZWFrO31cbmxhc3QrKzt9XG5yZXR1cm4gbGFzdC0xO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXI9ZnVuY3Rpb24obGkpe3RoaXMubGk9bGk7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGU9bmV3IGpzdHMubm9kaW5nLlNlZ21lbnRJbnRlcnNlY3RvcigpO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLmNvbnN0cnVjdG9yPWpzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLmlzQWRqYWNlbnRTZWdtZW50cz1mdW5jdGlvbihpMSxpMil7cmV0dXJuIE1hdGguYWJzKGkxLWkyKT09PTE7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuX2hhc0ludGVyc2VjdGlvbj1mYWxzZTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVyPWZhbHNlO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcmlvcj1mYWxzZTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzSW50ZXJpb3I9ZmFsc2U7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLnByb3BlckludGVyc2VjdGlvblBvaW50PW51bGw7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmxpPW51bGw7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmlzU2VsZkludGVyc2VjdGlvbj1udWxsO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1JbnRlcnNlY3Rpb25zPTA7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLm51bUludGVyaW9ySW50ZXJzZWN0aW9ucz0wO2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5udW1Qcm9wZXJJbnRlcnNlY3Rpb25zPTA7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLm51bVRlc3RzPTA7anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmdldExpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxpO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmdldFByb3BlckludGVyc2VjdGlvblBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvcGVySW50ZXJzZWN0aW9uUG9pbnQ7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2hhc0ludGVyc2VjdGlvbjt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXI7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXJJbnRlcmlvcjt9O2pzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLnByb3RvdHlwZS5oYXNJbnRlcmlvckludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc0ludGVyaW9yO307anN0cy5ub2RpbmcuSW50ZXJzZWN0aW9uQWRkZXIucHJvdG90eXBlLmlzVHJpdmlhbEludGVyc2VjdGlvbj1mdW5jdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKXtpZihlMD09ZTEpe2lmKHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk9PTEpe2lmKGpzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyLmlzQWRqYWNlbnRTZWdtZW50cyhzZWdJbmRleDAsc2VnSW5kZXgxKSlcbnJldHVybiB0cnVlO2lmKGUwLmlzQ2xvc2VkKCkpe3ZhciBtYXhTZWdJbmRleD1lMC5zaXplKCktMTtpZigoc2VnSW5kZXgwPT09MCYmc2VnSW5kZXgxPT09bWF4U2VnSW5kZXgpfHwoc2VnSW5kZXgxPT09MCYmc2VnSW5kZXgwPT09bWF4U2VnSW5kZXgpKXtyZXR1cm4gdHJ1ZTt9fX19XG5yZXR1cm4gZmFsc2U7fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUucHJvY2Vzc0ludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZTAsc2VnSW5kZXgwLGUxLHNlZ0luZGV4MSl7aWYoZTA9PT1lMSYmc2VnSW5kZXgwPT09c2VnSW5kZXgxKVxucmV0dXJuO3RoaXMubnVtVGVzdHMrKzt2YXIgcDAwPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwXTt2YXIgcDAxPWUwLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgwKzFdO3ZhciBwMTA9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDFdO3ZhciBwMTE9ZTEuZ2V0Q29vcmRpbmF0ZXMoKVtzZWdJbmRleDErMV07dGhpcy5saS5jb21wdXRlSW50ZXJzZWN0aW9uKHAwMCxwMDEscDEwLHAxMSk7aWYodGhpcy5saS5oYXNJbnRlcnNlY3Rpb24oKSl7dGhpcy5udW1JbnRlcnNlY3Rpb25zKys7aWYodGhpcy5saS5pc0ludGVyaW9ySW50ZXJzZWN0aW9uKCkpe3RoaXMubnVtSW50ZXJpb3JJbnRlcnNlY3Rpb25zKys7dGhpcy5oYXNJbnRlcmlvcj10cnVlO31cbmlmKCF0aGlzLmlzVHJpdmlhbEludGVyc2VjdGlvbihlMCxzZWdJbmRleDAsZTEsc2VnSW5kZXgxKSl7dGhpcy5faGFzSW50ZXJzZWN0aW9uPXRydWU7ZTAuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MCwwKTtlMS5hZGRJbnRlcnNlY3Rpb25zKHRoaXMubGksc2VnSW5kZXgxLDEpO2lmKHRoaXMubGkuaXNQcm9wZXIoKSl7dGhpcy5udW1Qcm9wZXJJbnRlcnNlY3Rpb25zKys7dGhpcy5oYXNQcm9wZXI9dHJ1ZTt0aGlzLmhhc1Byb3BlckludGVyaW9yPXRydWU7fX19fTtqc3RzLm5vZGluZy5JbnRlcnNlY3Rpb25BZGRlci5wcm90b3R5cGUuaXNEb25lPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb249ZnVuY3Rpb24ocG9seXMpe3RoaXMuaW5wdXRQb2x5cz1wb2x5czt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnVuaW9uPWZ1bmN0aW9uKHBvbHlzKXt2YXIgb3A9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uKHBvbHlzKTtyZXR1cm4gb3AudW5pb24oKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5pbnB1dFBvbHlzO2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5nZW9tRmFjdG9yeT1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5TVFJUUkVFX05PREVfQ0FQQUNJVFk9NDtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUudW5pb249ZnVuY3Rpb24oKXtpZih0aGlzLmlucHV0UG9seXMubGVuZ3RoPT09MCl7cmV0dXJuIG51bGw7fVxudGhpcy5nZW9tRmFjdG9yeT10aGlzLmlucHV0UG9seXNbMF0uZ2V0RmFjdG9yeSgpO3ZhciBpbmRleD1uZXcganN0cy5pbmRleC5zdHJ0cmVlLlNUUnRyZWUodGhpcy5TVFJUUkVFX05PREVfQ0FQQUNJVFkpO2Zvcih2YXIgaT0wLGw9dGhpcy5pbnB1dFBvbHlzLmxlbmd0aDtpPGw7aSsrKXt2YXIgaXRlbT10aGlzLmlucHV0UG9seXNbaV07aW5kZXguaW5zZXJ0KGl0ZW0uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLGl0ZW0pO31cbnZhciBpdGVtVHJlZT1pbmRleC5pdGVtc1RyZWUoKTt2YXIgdW5pb25BbGw9dGhpcy51bmlvblRyZWUoaXRlbVRyZWUpO3JldHVybiB1bmlvbkFsbDt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvblRyZWU9ZnVuY3Rpb24oZ2VvbVRyZWUpe3ZhciBnZW9tcz10aGlzLnJlZHVjZVRvR2VvbWV0cmllcyhnZW9tVHJlZSk7dmFyIHVuaW9uPXRoaXMuYmluYXJ5VW5pb24oZ2VvbXMpO3JldHVybiB1bmlvbjt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS5iaW5hcnlVbmlvbj1mdW5jdGlvbihnZW9tcyxzdGFydCxlbmQpe3N0YXJ0PXN0YXJ0fHwwO2VuZD1lbmR8fGdlb21zLmxlbmd0aDtpZihlbmQtc3RhcnQ8PTEpe3ZhciBnMD10aGlzLmdldEdlb21ldHJ5KGdlb21zLHN0YXJ0KTtyZXR1cm4gdGhpcy51bmlvblNhZmUoZzAsbnVsbCk7fVxuZWxzZSBpZihlbmQtc3RhcnQ9PT0yKXtyZXR1cm4gdGhpcy51bmlvblNhZmUodGhpcy5nZXRHZW9tZXRyeShnZW9tcyxzdGFydCksdGhpcy5nZXRHZW9tZXRyeShnZW9tcyxzdGFydCsxKSk7fVxuZWxzZXt2YXIgbWlkPXBhcnNlSW50KChlbmQrc3RhcnQpLzIpO3ZhciBnMD10aGlzLmJpbmFyeVVuaW9uKGdlb21zLHN0YXJ0LG1pZCk7dmFyIGcxPXRoaXMuYmluYXJ5VW5pb24oZ2VvbXMsbWlkLGVuZCk7cmV0dXJuIHRoaXMudW5pb25TYWZlKGcwLGcxKTt9fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuZ2V0R2VvbWV0cnk9ZnVuY3Rpb24obGlzdCxpbmRleCl7aWYoaW5kZXg+PWxpc3QubGVuZ3RoKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gbGlzdFtpbmRleF07fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUucmVkdWNlVG9HZW9tZXRyaWVzPWZ1bmN0aW9uKGdlb21UcmVlKXt2YXIgZ2VvbXM9W107Zm9yKHZhciBpPTAsbD1nZW9tVHJlZS5sZW5ndGg7aTxsO2krKyl7dmFyIG89Z2VvbVRyZWVbaV0sZ2VvbT1udWxsO2lmKG8gaW5zdGFuY2VvZiBBcnJheSl7Z2VvbT10aGlzLnVuaW9uVHJlZShvKTt9XG5lbHNlIGlmKG8gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnkpe2dlb209bzt9XG5nZW9tcy5wdXNoKGdlb20pO31cbnJldHVybiBnZW9tczt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uLnByb3RvdHlwZS51bmlvblNhZmU9ZnVuY3Rpb24oZzAsZzEpe2lmKGcwPT09bnVsbCYmZzE9PT1udWxsKXtyZXR1cm4gbnVsbDt9XG5pZihnMD09PW51bGwpe3JldHVybiBnMS5jbG9uZSgpO31cbmlmKGcxPT09bnVsbCl7cmV0dXJuIGcwLmNsb25lKCk7fVxucmV0dXJuIHRoaXMudW5pb25PcHRpbWl6ZWQoZzAsZzEpO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uT3B0aW1pemVkPWZ1bmN0aW9uKGcwLGcxKXt2YXIgZzBFbnY9ZzAuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLGcxRW52PWcxLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighZzBFbnYuaW50ZXJzZWN0cyhnMUVudikpe3ZhciBjb21ibz1qc3RzLmdlb20udXRpbC5HZW9tZXRyeUNvbWJpbmVyLmNvbWJpbmUoZzAsZzEpO3JldHVybiBjb21ibzt9XG5pZihnMC5nZXROdW1HZW9tZXRyaWVzPD0xJiZnMS5nZXROdW1HZW9tZXRyaWVzPD0xKXtyZXR1cm4gdGhpcy51bmlvbkFjdHVhbChnMCxnMSk7fVxudmFyIGNvbW1vbkVudj1nMEVudi5pbnRlcnNlY3Rpb24oZzFFbnYpO3JldHVybiB0aGlzLnVuaW9uVXNpbmdFbnZlbG9wZUludGVyc2VjdGlvbihnMCxnMSxjb21tb25FbnYpO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uVXNpbmdFbnZlbG9wZUludGVyc2VjdGlvbj1mdW5jdGlvbihnMCxnMSxjb21tb24pe3ZhciBkaXNqb2ludFBvbHlzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dmFyIGcwSW50PXRoaXMuZXh0cmFjdEJ5RW52ZWxvcGUoY29tbW9uLGcwLGRpc2pvaW50UG9seXMpO3ZhciBnMUludD10aGlzLmV4dHJhY3RCeUVudmVsb3BlKGNvbW1vbixnMSxkaXNqb2ludFBvbHlzKTt2YXIgdW5pb249dGhpcy51bmlvbkFjdHVhbChnMEludCxnMUludCk7ZGlzam9pbnRQb2x5cy5hZGQodW5pb24pO3ZhciBvdmVyYWxsVW5pb249anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlDb21iaW5lci5jb21iaW5lKGRpc2pvaW50UG9seXMpO3JldHVybiBvdmVyYWxsVW5pb247fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5DYXNjYWRlZFBvbHlnb25Vbmlvbi5wcm90b3R5cGUuZXh0cmFjdEJ5RW52ZWxvcGU9ZnVuY3Rpb24oZW52LGdlb20sZGlzam9pbnRHZW9tcyl7dmFyIGludGVyc2VjdGluZ0dlb21zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7Zm9yKHZhciBpPTA7aTxnZW9tLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBlbGVtPWdlb20uZ2V0R2VvbWV0cnlOKGkpO2lmKGVsZW0uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmludGVyc2VjdHMoZW52KSl7aW50ZXJzZWN0aW5nR2VvbXMuYWRkKGVsZW0pO31cbmVsc2V7ZGlzam9pbnRHZW9tcy5hZGQoZWxlbSk7fX1cbnJldHVybiB0aGlzLmdlb21GYWN0b3J5LmJ1aWxkR2VvbWV0cnkoaW50ZXJzZWN0aW5nR2VvbXMpO307anN0cy5vcGVyYXRpb24udW5pb24uQ2FzY2FkZWRQb2x5Z29uVW5pb24ucHJvdG90eXBlLnVuaW9uQWN0dWFsPWZ1bmN0aW9uKGcwLGcxKXtyZXR1cm4gZzAudW5pb24oZzEpO307KGZ1bmN0aW9uKCl7anN0cy5nZW9tLk11bHRpUG9pbnQ9ZnVuY3Rpb24ocG9pbnRzLGZhY3Rvcnkpe3RoaXMuZ2VvbWV0cmllcz1wb2ludHN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLk11bHRpUG9pbnQucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKCk7anN0cy5nZW9tLk11bHRpUG9pbnQuY29uc3RydWN0b3I9anN0cy5nZW9tLk11bHRpUG9pbnQ7anN0cy5nZW9tLk11bHRpUG9pbnQucHJvdG90eXBlLmdldEJvdW5kYXJ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihudWxsKTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5nZXRHZW9tZXRyeU49ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuZ2VvbWV0cmllc1tuXTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdC5jYWxsKHRoaXMsb3RoZXIsdG9sZXJhbmNlKTt9O2pzdHMuZ2VvbS5NdWx0aVBvaW50LnByb3RvdHlwZS5DTEFTU19OQU1FPSdqc3RzLmdlb20uTXVsdGlQb2ludCc7fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyPWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsLGJ1ZlBhcmFtcyl7dGhpcy5wcmVjaXNpb25Nb2RlbD1wcmVjaXNpb25Nb2RlbDt0aGlzLmJ1ZlBhcmFtcz1idWZQYXJhbXM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5kaXN0YW5jZT0wLjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUucHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5idWZQYXJhbXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRCdWZmZXJQYXJhbWV0ZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYnVmUGFyYW1zO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuZ2V0TGluZUN1cnZlPWZ1bmN0aW9uKGlucHV0UHRzLGRpc3RhbmNlKXt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlO2lmKHRoaXMuZGlzdGFuY2U8MC4wJiYhdGhpcy5idWZQYXJhbXMuaXNTaW5nbGVTaWRlZCgpKVxucmV0dXJuIG51bGw7aWYodGhpcy5kaXN0YW5jZT09MC4wKVxucmV0dXJuIG51bGw7dmFyIHBvc0Rpc3RhbmNlPU1hdGguYWJzKHRoaXMuZGlzdGFuY2UpO3ZhciBzZWdHZW49dGhpcy5nZXRTZWdHZW4ocG9zRGlzdGFuY2UpO2lmKGlucHV0UHRzLmxlbmd0aDw9MSl7dGhpcy5jb21wdXRlUG9pbnRDdXJ2ZShpbnB1dFB0c1swXSxzZWdHZW4pO31lbHNle2lmKHRoaXMuYnVmUGFyYW1zLmlzU2luZ2xlU2lkZWQoKSl7dmFyIGlzUmlnaHRTaWRlPWRpc3RhbmNlPDAuMDt0aGlzLmNvbXB1dGVTaW5nbGVTaWRlZEJ1ZmZlckN1cnZlKGlucHV0UHRzLGlzUmlnaHRTaWRlLHNlZ0dlbik7fWVsc2VcbnRoaXMuY29tcHV0ZUxpbmVCdWZmZXJDdXJ2ZShpbnB1dFB0cyxzZWdHZW4pO31cbnZhciBsaW5lQ29vcmQ9c2VnR2VuLmdldENvb3JkaW5hdGVzKCk7cmV0dXJuIGxpbmVDb29yZDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmdldFJpbmdDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxzaWRlLGRpc3RhbmNlKXt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlO2lmKGlucHV0UHRzLmxlbmd0aDw9MilcbnJldHVybiB0aGlzLmdldExpbmVDdXJ2ZShpbnB1dFB0cyxkaXN0YW5jZSk7aWYodGhpcy5kaXN0YW5jZT09MC4wKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5jb3B5Q29vcmRpbmF0ZXMoaW5wdXRQdHMpO31cbnZhciBzZWdHZW49dGhpcy5nZXRTZWdHZW4odGhpcy5kaXN0YW5jZSk7dGhpcy5jb21wdXRlUmluZ0J1ZmZlckN1cnZlKGlucHV0UHRzLHNpZGUsc2VnR2VuKTtyZXR1cm4gc2VnR2VuLmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRPZmZzZXRDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxkaXN0YW5jZSl7dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTtpZih0aGlzLmRpc3RhbmNlPT09MC4wKVxucmV0dXJuIG51bGw7dmFyIGlzUmlnaHRTaWRlPXRoaXMuZGlzdGFuY2U8MC4wO3ZhciBwb3NEaXN0YW5jZT1NYXRoLmFicyh0aGlzLmRpc3RhbmNlKTt2YXIgc2VnR2VuPXRoaXMuZ2V0U2VnR2VuKHBvc0Rpc3RhbmNlKTtpZihpbnB1dFB0cy5sZW5ndGg8PTEpe3RoaXMuY29tcHV0ZVBvaW50Q3VydmUoaW5wdXRQdHNbMF0sc2VnR2VuKTt9ZWxzZXt0aGlzLmNvbXB1dGVPZmZzZXRDdXJ2ZShpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pO31cbnZhciBjdXJ2ZVB0cz1zZWdHZW4uZ2V0Q29vcmRpbmF0ZXMoKTtpZihpc1JpZ2h0U2lkZSlcbmN1cnZlUHRzLnJldmVyc2UoKTtyZXR1cm4gY3VydmVQdHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLmNvcHlDb29yZGluYXRlcz1mdW5jdGlvbihwdHMpe3ZhciBjb3B5PVtdO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe2NvcHkucHVzaChwdHNbaV0uY2xvbmUoKSk7fVxucmV0dXJuIGNvcHk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5nZXRTZWdHZW49ZnVuY3Rpb24oZGlzdGFuY2Upe3JldHVybiBuZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRHZW5lcmF0b3IodGhpcy5wcmVjaXNpb25Nb2RlbCx0aGlzLmJ1ZlBhcmFtcyxkaXN0YW5jZSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLlNJTVBMSUZZX0ZBQ1RPUj0xMDAuMDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnNpbXBsaWZ5VG9sZXJhbmNlPWZ1bmN0aW9uKGJ1ZkRpc3RhbmNlKXtyZXR1cm4gYnVmRGlzdGFuY2UvanN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5TSU1QTElGWV9GQUNUT1I7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlUG9pbnRDdXJ2ZT1mdW5jdGlvbihwdCxzZWdHZW4pe3N3aXRjaCh0aGlzLmJ1ZlBhcmFtcy5nZXRFbmRDYXBTdHlsZSgpKXtjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9ST1VORDpzZWdHZW4uY3JlYXRlQ2lyY2xlKHB0KTticmVhaztjYXNlIGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9TUVVBUkU6c2VnR2VuLmNyZWF0ZVNxdWFyZShwdCk7YnJlYWs7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZUxpbmVCdWZmZXJDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7dmFyIHNpbXAxPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuMT1zaW1wMS5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMVswXSxzaW1wMVsxXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtmb3IodmFyIGk9MjtpPD1uMTtpKyspe3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wMVtpXSx0cnVlKTt9XG5zZWdHZW4uYWRkTGFzdFNlZ21lbnQoKTtzZWdHZW4uYWRkTGluZUVuZENhcChzaW1wMVtuMS0xXSxzaW1wMVtuMV0pO3ZhciBzaW1wMj1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cywtZGlzdFRvbCk7dmFyIG4yPXNpbXAyLmxlbmd0aC0xO3NlZ0dlbi5pbml0U2lkZVNlZ21lbnRzKHNpbXAyW24yXSxzaW1wMltuMi0xXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtmb3IodmFyIGk9bjItMjtpPj0wO2ktLSl7c2VnR2VuLmFkZE5leHRTZWdtZW50KHNpbXAyW2ldLHRydWUpO31cbnNlZ0dlbi5hZGRMYXN0U2VnbWVudCgpO3NlZ0dlbi5hZGRMaW5lRW5kQ2FwKHNpbXAyWzFdLHNpbXAyWzBdKTtzZWdHZW4uY2xvc2VSaW5nKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVCdWlsZGVyLnByb3RvdHlwZS5jb21wdXRlU2luZ2xlU2lkZWRCdWZmZXJDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7aWYoaXNSaWdodFNpZGUpe3NlZ0dlbi5hZGRTZWdtZW50cyhpbnB1dFB0cyx0cnVlKTt2YXIgc2ltcDI9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlcklucHV0TGluZVNpbXBsaWZpZXIuc2ltcGxpZnkoaW5wdXRQdHMsLWRpc3RUb2wpO3ZhciBuMj1zaW1wMi5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMltuMl0sc2ltcDJbbjItMV0sanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7c2VnR2VuLmFkZEZpcnN0U2VnbWVudCgpO2Zvcih2YXIgaT1uMi0yO2k+PTA7aS0tKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDJbaV0sdHJ1ZSk7fX1lbHNle3NlZ0dlbi5hZGRTZWdtZW50cyhpbnB1dFB0cyxmYWxzZSk7dmFyIHNpbXAxPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuMT1zaW1wMS5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMVswXSxzaW1wMVsxXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtzZWdHZW4uYWRkRmlyc3RTZWdtZW50KCk7Zm9yKHZhciBpPTI7aTw9bjE7aSsrKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDFbaV0sdHJ1ZSk7fX1cbnNlZ0dlbi5hZGRMYXN0U2VnbWVudCgpO3NlZ0dlbi5jbG9zZVJpbmcoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVPZmZzZXRDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxpc1JpZ2h0U2lkZSxzZWdHZW4pe3ZhciBkaXN0VG9sPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZUJ1aWxkZXIuc2ltcGxpZnlUb2xlcmFuY2UodGhpcy5kaXN0YW5jZSk7aWYoaXNSaWdodFNpZGUpe3ZhciBzaW1wMj1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVySW5wdXRMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cywtZGlzdFRvbCk7dmFyIG4yPXNpbXAyLmxlbmd0aC0xO3NlZ0dlbi5pbml0U2lkZVNlZ21lbnRzKHNpbXAyW24yXSxzaW1wMltuMi0xXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtzZWdHZW4uYWRkRmlyc3RTZWdtZW50KCk7Zm9yKHZhciBpPW4yLTI7aT49MDtpLS0pe3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wMltpXSx0cnVlKTt9fWVsc2V7dmFyIHNpbXAxPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuMT1zaW1wMS5sZW5ndGgtMTtzZWdHZW4uaW5pdFNpZGVTZWdtZW50cyhzaW1wMVswXSxzaW1wMVsxXSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTtzZWdHZW4uYWRkRmlyc3RTZWdtZW50KCk7Zm9yKHZhciBpPTI7aTw9bjE7aSsrKXtzZWdHZW4uYWRkTmV4dFNlZ21lbnQoc2ltcDFbaV0sdHJ1ZSk7fX1cbnNlZ0dlbi5hZGRMYXN0U2VnbWVudCgpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5wcm90b3R5cGUuY29tcHV0ZVJpbmdCdWZmZXJDdXJ2ZT1mdW5jdGlvbihpbnB1dFB0cyxzaWRlLHNlZ0dlbil7dmFyIGRpc3RUb2w9anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlci5zaW1wbGlmeVRvbGVyYW5jZSh0aGlzLmRpc3RhbmNlKTtpZihzaWRlPT09anN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpXG5kaXN0VG9sPS1kaXN0VG9sO3ZhciBzaW1wPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJJbnB1dExpbmVTaW1wbGlmaWVyLnNpbXBsaWZ5KGlucHV0UHRzLGRpc3RUb2wpO3ZhciBuPXNpbXAubGVuZ3RoLTE7c2VnR2VuLmluaXRTaWRlU2VnbWVudHMoc2ltcFtuLTFdLHNpbXBbMF0sc2lkZSk7Zm9yKHZhciBpPTE7aTw9bjtpKyspe3ZhciBhZGRTdGFydFBvaW50PWkhPT0xO3NlZ0dlbi5hZGROZXh0U2VnbWVudChzaW1wW2ldLGFkZFN0YXJ0UG9pbnQpO31cbnNlZ0dlbi5jbG9zZVJpbmcoKTt9OyhmdW5jdGlvbigpe3ZhciBIb3RQaXhlbFNuYXBBY3Rpb249ZnVuY3Rpb24oaG90UGl4ZWwscGFyZW50RWRnZSx2ZXJ0ZXhJbmRleCl7dGhpcy5ob3RQaXhlbD1ob3RQaXhlbDt0aGlzLnBhcmVudEVkZ2U9cGFyZW50RWRnZTt0aGlzLnZlcnRleEluZGV4PXZlcnRleEluZGV4O307SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluU2VsZWN0QWN0aW9uKCk7SG90UGl4ZWxTbmFwQWN0aW9uLmNvbnN0cnVjdG9yPUhvdFBpeGVsU25hcEFjdGlvbjtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLmhvdFBpeGVsPW51bGw7SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS5wYXJlbnRFZGdlPW51bGw7SG90UGl4ZWxTbmFwQWN0aW9uLnByb3RvdHlwZS52ZXJ0ZXhJbmRleD1udWxsO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUuX2lzTm9kZUFkZGVkPWZhbHNlO0hvdFBpeGVsU25hcEFjdGlvbi5wcm90b3R5cGUuaXNOb2RlQWRkZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNOb2RlQWRkZWQ7fTtIb3RQaXhlbFNuYXBBY3Rpb24ucHJvdG90eXBlLnNlbGVjdD1mdW5jdGlvbihtYyxzdGFydEluZGV4KXt2YXIgc3M9bWMuZ2V0Q29udGV4dCgpO2lmKHRoaXMucGFyZW50RWRnZSE9PW51bGwpe2lmKHNzPT09dGhpcy5wYXJlbnRFZGdlJiZzdGFydEluZGV4PT09dGhpcy52ZXJ0ZXhJbmRleClcbnJldHVybjt9XG50aGlzLl9pc05vZGVBZGRlZD10aGlzLmhvdFBpeGVsLmFkZFNuYXBwZWROb2RlKHNzLHN0YXJ0SW5kZXgpO307anN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhQb2ludFNuYXBwZXI9ZnVuY3Rpb24oaW5kZXgpe3RoaXMuaW5kZXg9aW5kZXg7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFBvaW50U25hcHBlci5wcm90b3R5cGUuaW5kZXg9bnVsbDtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFBvaW50U25hcHBlci5wcm90b3R5cGUuc25hcD1mdW5jdGlvbihob3RQaXhlbCxwYXJlbnRFZGdlLHZlcnRleEluZGV4KXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5zbmFwMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnZhciBwaXhlbEVudj1ob3RQaXhlbC5nZXRTYWZlRW52ZWxvcGUoKTt2YXIgaG90UGl4ZWxTbmFwQWN0aW9uPW5ldyBIb3RQaXhlbFNuYXBBY3Rpb24oaG90UGl4ZWwscGFyZW50RWRnZSx2ZXJ0ZXhJbmRleCk7dGhpcy5pbmRleC5xdWVyeShwaXhlbEVudix7dmlzaXRJdGVtOmZ1bmN0aW9uKHRlc3RDaGFpbil7dGVzdENoYWluLnNlbGVjdChwaXhlbEVudixob3RQaXhlbFNuYXBBY3Rpb24pO319KTtyZXR1cm4gaG90UGl4ZWxTbmFwQWN0aW9uLmlzTm9kZUFkZGVkKCk7fTtqc3RzLm5vZGluZy5zbmFwcm91bmQuTUNJbmRleFBvaW50U25hcHBlci5wcm90b3R5cGUuc25hcDI9ZnVuY3Rpb24oaG90UGl4ZWwpe3JldHVybiB0aGlzLnNuYXAoaG90UGl4ZWwsbnVsbCwtMSk7fTt9KSgpOyhmdW5jdGlvbigpe3ZhciBOb2RlQmFzZT1mdW5jdGlvbigpe3RoaXMuaXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnN1Ym5vZGU9W251bGwsbnVsbF07fTtOb2RlQmFzZS5nZXRTdWJub2RlSW5kZXg9ZnVuY3Rpb24oaW50ZXJ2YWwsY2VudHJlKXt2YXIgc3Vibm9kZUluZGV4PS0xO2lmKGludGVydmFsLm1pbj49Y2VudHJlKXtzdWJub2RlSW5kZXg9MTt9XG5pZihpbnRlcnZhbC5tYXg8PWNlbnRyZSl7c3Vibm9kZUluZGV4PTA7fVxucmV0dXJuIHN1Ym5vZGVJbmRleDt9O05vZGVCYXNlLnByb3RvdHlwZS5nZXRJdGVtcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLml0ZW1zO307Tm9kZUJhc2UucHJvdG90eXBlLmFkZD1mdW5jdGlvbihpdGVtKXt0aGlzLml0ZW1zLmFkZChpdGVtKTt9O05vZGVCYXNlLnByb3RvdHlwZS5hZGRBbGxJdGVtcz1mdW5jdGlvbihpdGVtcyl7aXRlbXMuYWRkQWxsKHRoaXMuaXRlbXMpO3ZhciBpPTAsaWw9Mjtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7dGhpcy5zdWJub2RlW2ldLmFkZEFsbEl0ZW1zKGl0ZW1zKTt9fVxucmV0dXJuIGl0ZW1zO307Tm9kZUJhc2UucHJvdG90eXBlLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nPWZ1bmN0aW9uKGludGVydmFsLHJlc3VsdEl0ZW1zKXtpZihpbnRlcnZhbCE9PW51bGwmJiF0aGlzLmlzU2VhcmNoTWF0Y2goaW50ZXJ2YWwpKXtyZXR1cm47fVxucmVzdWx0SXRlbXMuYWRkQWxsKHRoaXMuaXRlbXMpO2lmKHRoaXMuc3Vibm9kZVswXSE9PW51bGwpe3RoaXMuc3Vibm9kZVswXS5hZGRBbGxJdGVtc0Zyb21PdmVybGFwcGluZyhpbnRlcnZhbCxyZXN1bHRJdGVtcyk7fVxuaWYodGhpcy5zdWJub2RlWzFdIT09bnVsbCl7dGhpcy5zdWJub2RlWzFdLmFkZEFsbEl0ZW1zRnJvbU92ZXJsYXBwaW5nKGludGVydmFsLHJlc3VsdEl0ZW1zKTt9fTtOb2RlQmFzZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCxpdGVtKXtpZighdGhpcy5pc1NlYXJjaE1hdGNoKGl0ZW1JbnRlcnZhbCkpe3JldHVybiBmYWxzZTt9XG52YXIgZm91bmQ9ZmFsc2UsaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe2ZvdW5kPXRoaXMuc3Vibm9kZVtpXS5yZW1vdmUoaXRlbUludGVydmFsLGl0ZW0pO2lmKGZvdW5kKXtpZih0aGlzLnN1Ym5vZGVbaV0uaXNQcnVuYWJsZSgpKXt0aGlzLnN1Ym5vZGVbaV09bnVsbDt9XG5icmVhazt9fX1cbmlmKGZvdW5kKXtyZXR1cm4gZm91bmQ7fVxuZm91bmQ9dGhpcy5pdGVtcy5yZW1vdmUoaXRlbSk7cmV0dXJuIGZvdW5kO307Tm9kZUJhc2UucHJvdG90eXBlLmlzUHJ1bmFibGU9ZnVuY3Rpb24oKXtyZXR1cm4hKHRoaXMuaGFzQ2hpbGRyZW4oKXx8dGhpcy5oYXNJdGVtcygpKTt9O05vZGVCYXNlLnByb3RvdHlwZS5oYXNDaGlsZHJlbj1mdW5jdGlvbigpe3ZhciBpPTAsaWw9Mjtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O05vZGVCYXNlLnByb3RvdHlwZS5oYXNJdGVtcz1mdW5jdGlvbigpe3JldHVybiF0aGlzLml0ZW1zLmlzRW1wdHkoKTt9O05vZGVCYXNlLnByb3RvdHlwZS5kZXB0aD1mdW5jdGlvbigpe3ZhciBtYXhTdWJEZXB0aD0wLGk9MCxpbD0yLHNxZDtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7c3FkPXRoaXMuc3Vibm9kZVtpXS5kZXB0aCgpO2lmKHNxZD5tYXhTdWJEZXB0aCl7bWF4U3ViRGVwdGg9c3FkO319fVxucmV0dXJuIG1heFN1YkRlcHRoKzE7fTtOb2RlQmFzZS5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3ZhciBzdWJTaXplPTAsaT0wLGlsPTI7Zm9yKGk7aTxpbDtpKyspe2lmKHRoaXMuc3Vibm9kZVtpXSE9PW51bGwpe3N1YlNpemUrPXRoaXMuc3Vibm9kZVtpXS5zaXplKCk7fX1cbnJldHVybiBzdWJTaXplK3RoaXMuaXRlbXMuc2l6ZSgpO307Tm9kZUJhc2UucHJvdG90eXBlLm5vZGVTaXplPWZ1bmN0aW9uKCl7dmFyIHN1YlNpemU9MCxpPTAsaWw9Mjtmb3IoaTtpPGlsO2krKyl7aWYodGhpcy5zdWJub2RlW2ldIT09bnVsbCl7c3ViU2l6ZSs9dGhpcy5zdWJub2RlW2ldLm5vZGVTaXplKCk7fX1cbnJldHVybiBzdWJTaXplKzE7fTtqc3RzLmluZGV4LmJpbnRyZWUuTm9kZUJhc2U9Tm9kZUJhc2U7fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZUJhc2U9anN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlO3ZhciBLZXk9anN0cy5pbmRleC5iaW50cmVlLktleTt2YXIgSW50ZXJ2YWw9anN0cy5pbmRleC5iaW50cmVlLkludGVydmFsO3ZhciBOb2RlPWZ1bmN0aW9uKGludGVydmFsLGxldmVsKXt0aGlzLml0ZW1zPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5zdWJub2RlPVtudWxsLG51bGxdO3RoaXMuaW50ZXJ2YWw9aW50ZXJ2YWw7dGhpcy5sZXZlbD1sZXZlbDt0aGlzLmNlbnRyZT0oaW50ZXJ2YWwuZ2V0TWluKCkraW50ZXJ2YWwuZ2V0TWF4KCkpLzI7fTtOb2RlLnByb3RvdHlwZT1uZXcgTm9kZUJhc2UoKTtOb2RlLmNvbnN0cnVjdG9yPU5vZGU7Tm9kZS5jcmVhdGVOb2RlPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCl7dmFyIGtleSxub2RlO2tleT1uZXcgS2V5KGl0ZW1JbnRlcnZhbCk7bm9kZT1uZXcgTm9kZShrZXkuZ2V0SW50ZXJ2YWwoKSxrZXkuZ2V0TGV2ZWwoKSk7cmV0dXJuIG5vZGU7fTtOb2RlLmNyZWF0ZUV4cGFuZGVkPWZ1bmN0aW9uKG5vZGUsYWRkSW50ZXJ2YWwpe3ZhciBleHBhbmRJbnQsbGFyZ2VyTm9kZTtleHBhbmRJbnQ9bmV3IEludGVydmFsKGFkZEludGVydmFsKTtpZihub2RlIT09bnVsbCl7ZXhwYW5kSW50LmV4cGFuZFRvSW5jbHVkZShub2RlLmludGVydmFsKTt9XG5sYXJnZXJOb2RlPU5vZGUuY3JlYXRlTm9kZShleHBhbmRJbnQpO2lmKG5vZGUhPT1udWxsKXtsYXJnZXJOb2RlLmluc2VydChub2RlKTt9XG5yZXR1cm4gbGFyZ2VyTm9kZTt9O05vZGUucHJvdG90eXBlLmdldEludGVydmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJ2YWw7fTtOb2RlLnByb3RvdHlwZS5pc1NlYXJjaE1hdGNoPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCl7cmV0dXJuIGl0ZW1JbnRlcnZhbC5vdmVybGFwcyh0aGlzLmludGVydmFsKTt9O05vZGUucHJvdG90eXBlLmdldE5vZGU9ZnVuY3Rpb24oc2VhcmNoSW50ZXJ2YWwpe3ZhciBzdWJub2RlSW5kZXg9Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4KHNlYXJjaEludGVydmFsLHRoaXMuY2VudHJlKSxub2RlO2lmKHN1Ym5vZGVJbmRleCE9LTEpe25vZGU9dGhpcy5nZXRTdWJub2RlKHN1Ym5vZGVJbmRleCk7cmV0dXJuIG5vZGUuZ2V0Tm9kZShzZWFyY2hJbnRlcnZhbCk7fWVsc2V7cmV0dXJuIHRoaXM7fX07Tm9kZS5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihzZWFyY2hJbnRlcnZhbCl7dmFyIHN1Ym5vZGVJbmRleD1Ob2RlQmFzZS5nZXRTdWJub2RlSW5kZXgoc2VhcmNoSW50ZXJ2YWwsdGhpcy5jZW50cmUpLG5vZGU7aWYoc3Vibm9kZUluZGV4PT09LTEpe3JldHVybiB0aGlzO31cbmlmKHRoaXMuc3Vibm9kZVtzdWJub2RlSW5kZXhdIT09bnVsbCl7bm9kZT10aGlzLnN1Ym5vZGVbc3Vibm9kZUluZGV4XTtyZXR1cm4gbm9kZS5maW5kKHNlYXJjaEludGVydmFsKTt9XG5yZXR1cm4gdGhpczt9O05vZGUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihub2RlKXt2YXIgaW5kZXg9Tm9kZUJhc2UuZ2V0U3Vibm9kZUluZGV4KG5vZGUuaW50ZXJ2YWwsdGhpcy5jZW50cmUpLGNoaWxkTm9kZTtpZihub2RlLmxldmVsPT09dGhpcy5sZXZlbC0xKXt0aGlzLnN1Ym5vZGVbaW5kZXhdPW5vZGU7fWVsc2V7Y2hpbGROb2RlPXRoaXMuY3JlYXRlU3Vibm9kZShpbmRleCk7Y2hpbGROb2RlLmluc2VydChub2RlKTt0aGlzLnN1Ym5vZGVbaW5kZXhdPWNoaWxkTm9kZTt9fTtOb2RlLnByb3RvdHlwZS5nZXRTdWJub2RlPWZ1bmN0aW9uKGluZGV4KXtpZih0aGlzLnN1Ym5vZGVbaW5kZXhdPT09bnVsbCl7dGhpcy5zdWJub2RlW2luZGV4XT10aGlzLmNyZWF0ZVN1Ym5vZGUoaW5kZXgpO31cbnJldHVybiB0aGlzLnN1Ym5vZGVbaW5kZXhdO307Tm9kZS5wcm90b3R5cGUuY3JlYXRlU3Vibm9kZT1mdW5jdGlvbihpbmRleCl7dmFyIG1pbixtYXgsc3ViSW50LG5vZGU7bWluPTAuMDttYXg9MC4wO3N3aXRjaChpbmRleCl7Y2FzZSAwOm1pbj10aGlzLmludGVydmFsLmdldE1pbigpO21heD10aGlzLmNlbnRyZTticmVhaztjYXNlIDE6bWluPXRoaXMuY2VudHJlO21heD10aGlzLmludGVydmFsLmdldE1heCgpO2JyZWFrO31cbnN1YkludD1uZXcgSW50ZXJ2YWwobWluLG1heCk7bm9kZT1uZXcgTm9kZShzdWJJbnQsdGhpcy5sZXZlbC0xKTtyZXR1cm4gbm9kZTt9O2pzdHMuaW5kZXguYmludHJlZS5Ob2RlPU5vZGU7fSkoKTsoZnVuY3Rpb24oKXt2YXIgTm9kZT1qc3RzLmluZGV4LmJpbnRyZWUuTm9kZTt2YXIgTm9kZUJhc2U9anN0cy5pbmRleC5iaW50cmVlLk5vZGVCYXNlO3ZhciBSb290PWZ1bmN0aW9uKCl7dGhpcy5zdWJub2RlPVtudWxsLG51bGxdO3RoaXMuaXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt9O1Jvb3QucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LmJpbnRyZWUuTm9kZUJhc2UoKTtSb290LmNvbnN0cnVjdG9yPVJvb3Q7Um9vdC5vcmlnaW49MC4wO1Jvb3QucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7dmFyIGluZGV4PU5vZGVCYXNlLmdldFN1Ym5vZGVJbmRleChpdGVtSW50ZXJ2YWwsUm9vdC5vcmlnaW4pLG5vZGUsbGFyZ2VyTm9kZTtpZihpbmRleD09PS0xKXt0aGlzLmFkZChpdGVtKTtyZXR1cm47fVxubm9kZT10aGlzLnN1Ym5vZGVbaW5kZXhdO2lmKG5vZGU9PT1udWxsfHwhbm9kZS5nZXRJbnRlcnZhbCgpLmNvbnRhaW5zKGl0ZW1JbnRlcnZhbCkpe2xhcmdlck5vZGU9Tm9kZS5jcmVhdGVFeHBhbmRlZChub2RlLGl0ZW1JbnRlcnZhbCk7dGhpcy5zdWJub2RlW2luZGV4XT1sYXJnZXJOb2RlO31cbnRoaXMuaW5zZXJ0Q29udGFpbmVkKHRoaXMuc3Vibm9kZVtpbmRleF0saXRlbUludGVydmFsLGl0ZW0pO307Um9vdC5wcm90b3R5cGUuaW5zZXJ0Q29udGFpbmVkPWZ1bmN0aW9uKHRyZWUsaXRlbUludGVydmFsLGl0ZW0pe3ZhciBpc1plcm9BcmVhLG5vZGU7aXNaZXJvQXJlYT1qc3RzLmluZGV4LkludGVydmFsU2l6ZS5pc1plcm9XaWR0aChpdGVtSW50ZXJ2YWwuZ2V0TWluKCksaXRlbUludGVydmFsLmdldE1heCgpKTtub2RlPWlzWmVyb0FyZWE/dHJlZS5maW5kKGl0ZW1JbnRlcnZhbCk6dHJlZS5nZXROb2RlKGl0ZW1JbnRlcnZhbCk7bm9kZS5hZGQoaXRlbSk7fTtSb290LnByb3RvdHlwZS5pc1NlYXJjaE1hdGNoPWZ1bmN0aW9uKGludGVydmFsKXtyZXR1cm4gdHJ1ZTt9O2pzdHMuaW5kZXguYmludHJlZS5Sb290PVJvb3Q7fSkoKTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudD1mdW5jdGlvbigpe307anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuTkU9MDtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVz0xO2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNXPTI7anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU0U9Mztqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5xdWFkcmFudD1mdW5jdGlvbihkeCxkeSl7aWYoZHggaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZSl7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LnF1YWRyYW50Mi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxuaWYoZHg9PT0wLjAmJmR5PT09MC4wKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0Nhbm5vdCBjb21wdXRlIHRoZSBxdWFkcmFudCBmb3IgcG9pbnQgKCAnK2R4KycsICcrZHkrJyApJyk7aWYoZHg+PTAuMCl7aWYoZHk+PTAuMClcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5ORTtlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU0U7fWVsc2V7aWYoZHk+PTAuMClcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5OVztlbHNlXG5yZXR1cm4ganN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU1c7fX07anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQucXVhZHJhbnQyPWZ1bmN0aW9uKHAwLHAxKXtpZihwMS54PT09cDAueCYmcDEueT09PXAwLnkpXG50aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFcnJvcignQ2Fubm90IGNvbXB1dGUgdGhlIHF1YWRyYW50IGZvciB0d28gaWRlbnRpY2FsIHBvaW50cyAnK3AwKTtpZihwMS54Pj1wMC54KXtpZihwMS55Pj1wMC55KVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5FO2Vsc2VcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TRTt9ZWxzZXtpZihwMS55Pj1wMC55KVxucmV0dXJuIGpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5XO2Vsc2VcbnJldHVybiBqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5TVzt9fTtqc3RzLmdlb21ncmFwaC5RdWFkcmFudC5pc09wcG9zaXRlPWZ1bmN0aW9uKHF1YWQxLHF1YWQyKXtpZihxdWFkMT09PXF1YWQyKVxucmV0dXJuIGZhbHNlO3ZhciBkaWZmPShxdWFkMS1xdWFkMis0KSU0O2lmKGRpZmY9PT0yKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuY29tbW9uSGFsZlBsYW5lPWZ1bmN0aW9uKHF1YWQxLHF1YWQyKXtpZihxdWFkMT09PXF1YWQyKVxucmV0dXJuIHF1YWQxO3ZhciBkaWZmPShxdWFkMS1xdWFkMis0KSU0O2lmKGRpZmY9PT0yKVxucmV0dXJuLTE7dmFyIG1pbj0ocXVhZDE8cXVhZDIpP3F1YWQxOnF1YWQyO3ZhciBtYXg9KHF1YWQxPnF1YWQyKT9xdWFkMTpxdWFkMjtpZihtaW49PT0wJiZtYXg9PT0zKVxucmV0dXJuIDM7cmV0dXJuIG1pbjt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzSW5IYWxmUGxhbmU9ZnVuY3Rpb24ocXVhZCxoYWxmUGxhbmUpe2lmKGhhbGZQbGFuZT09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFKXtyZXR1cm4gcXVhZD09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LlNFfHxxdWFkPT09anN0cy5nZW9tZ3JhcGguUXVhZHJhbnQuU1c7fVxucmV0dXJuIHF1YWQ9PT1oYWxmUGxhbmV8fHF1YWQ9PT1oYWxmUGxhbmUrMTt9O2pzdHMuZ2VvbWdyYXBoLlF1YWRyYW50LmlzTm9ydGhlcm49ZnVuY3Rpb24ocXVhZCl7cmV0dXJuIHF1YWQ9PT1qc3RzLmdlb21ncmFwaC5RdWFkcmFudC5ORXx8cXVhZD09PWpzdHMuZ2VvbWdyYXBoLlF1YWRyYW50Lk5XO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXI9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmdlb21HcmFwaD1nZW9tR3JhcGg7dGhpcy5saT1uZXcganN0cy5hbGdvcml0aG0uUm9idXN0TGluZUludGVyc2VjdG9yKCk7dGhpcy5ub2RlR3JhcGg9bmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgoKTt0aGlzLmludmFsaWRQb2ludD1udWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuQ29uc2lzdGVudEFyZWFUZXN0ZXIucHJvdG90eXBlLmdldEludmFsaWRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludmFsaWRQb2ludDt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyLnByb3RvdHlwZS5pc05vZGVDb25zaXN0ZW50QXJlYT1mdW5jdGlvbigpe3ZhciBpbnRlcnNlY3Rvcj10aGlzLmdlb21HcmFwaC5jb21wdXRlU2VsZk5vZGVzKHRoaXMubGksdHJ1ZSk7aWYoaW50ZXJzZWN0b3IuaGFzUHJvcGVySW50ZXJzZWN0aW9uKCkpe3RoaXMuaW52YWxpZFBvaW50PWludGVyc2VjdG9yLmdldFByb3BlckludGVyc2VjdGlvblBvaW50KCk7cmV0dXJuIGZhbHNlO31cbnRoaXMubm9kZUdyYXBoLmJ1aWxkKHRoaXMuZ2VvbUdyYXBoKTtyZXR1cm4gdGhpcy5pc05vZGVFZGdlQXJlYUxhYmVsc0NvbnNpc3RlbnQoKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkNvbnNpc3RlbnRBcmVhVGVzdGVyLnByb3RvdHlwZS5pc05vZGVFZGdlQXJlYUxhYmVsc0NvbnNpc3RlbnQ9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVJdD10aGlzLm5vZGVHcmFwaC5nZXROb2RlSXRlcmF0b3IoKTtub2RlSXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZUl0Lm5leHQoKTtpZighbm9kZS5nZXRFZGdlcygpLmlzQXJlYUxhYmVsc0NvbnNpc3RlbnQodGhpcy5nZW9tR3JhcGgpKXt0aGlzLmludmFsaWRQb2ludD1ub2RlLmdldENvb3JkaW5hdGUoKS5jbG9uZSgpO3JldHVybiBmYWxzZTt9fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5Db25zaXN0ZW50QXJlYVRlc3Rlci5wcm90b3R5cGUuaGFzRHVwbGljYXRlUmluZ3M9ZnVuY3Rpb24oKXtmb3IodmFyIG5vZGVJdD10aGlzLm5vZGVHcmFwaC5nZXROb2RlSXRlcmF0b3IoKTtub2RlSXQuaGFzTmV4dCgpOyl7dmFyIG5vZGU9bm9kZUl0Lm5leHQoKTtmb3IodmFyIGk9bm9kZS5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZWViPWkubmV4dCgpO2lmKGVlYi5nZXRFZGdlRW5kcygpLmxlbmd0aD4xKXtpbnZhbGlkUG9pbnQ9ZWViLmdldEVkZ2UoKS5nZXRDb29yZGluYXRlKDApO3JldHVybiB0cnVlO319fVxucmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGU9ZnVuY3Rpb24oY29vcmQsZWRnZXMpe2pzdHMuZ2VvbWdyYXBoLk5vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5Ob2RlKCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUucHJvdG90eXBlLmNvbXB1dGVJTT1mdW5jdGlvbihpbSl7aW0uc2V0QXRMZWFzdElmVmFsaWQodGhpcy5sYWJlbC5nZXRMb2NhdGlvbigwKSx0aGlzLmxhYmVsLmdldExvY2F0aW9uKDEpLDApO307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUucHJvdG90eXBlLnVwZGF0ZUlNRnJvbUVkZ2VzPWZ1bmN0aW9uKGltKXt0aGlzLmVkZ2VzLnVwZGF0ZUlNKGltKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBFZGdlRW5kPWpzdHMuZ2VvbWdyYXBoLkVkZ2VFbmQ7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlPWZ1bmN0aW9uKGVkZ2UsaXNGb3J3YXJkKXtFZGdlRW5kLmNhbGwodGhpcyxlZGdlKTt0aGlzLmRlcHRoPVswLC05OTksLTk5OV07dGhpcy5faXNGb3J3YXJkPWlzRm9yd2FyZDtpZihpc0ZvcndhcmQpe3RoaXMuaW5pdChlZGdlLmdldENvb3JkaW5hdGUoMCksZWRnZS5nZXRDb29yZGluYXRlKDEpKTt9ZWxzZXt2YXIgbj1lZGdlLmdldE51bVBvaW50cygpLTE7dGhpcy5pbml0KGVkZ2UuZ2V0Q29vcmRpbmF0ZShuKSxlZGdlLmdldENvb3JkaW5hdGUobi0xKSk7fVxudGhpcy5jb21wdXRlRGlyZWN0ZWRMYWJlbCgpO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZT1uZXcgRWRnZUVuZCgpO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2U7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLmRlcHRoRmFjdG9yPWZ1bmN0aW9uKGN1cnJMb2NhdGlvbixuZXh0TG9jYXRpb24pe2lmKGN1cnJMb2NhdGlvbj09PUxvY2F0aW9uLkVYVEVSSU9SJiZuZXh0TG9jYXRpb249PT1Mb2NhdGlvbi5JTlRFUklPUilcbnJldHVybiAxO2Vsc2UgaWYoY3VyckxvY2F0aW9uPT09TG9jYXRpb24uSU5URVJJT1ImJm5leHRMb2NhdGlvbj09PUxvY2F0aW9uLkVYVEVSSU9SKVxucmV0dXJuLTE7cmV0dXJuIDA7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLl9pc0ZvcndhcmQ9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLl9pc0luUmVzdWx0PWZhbHNlO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuX2lzVmlzaXRlZD1mYWxzZTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnN5bT1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUubmV4dD1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUubmV4dE1pbj1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZWRnZVJpbmc9bnVsbDtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLm1pbkVkZ2VSaW5nPW51bGw7anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5kZXB0aD1udWxsO2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2U7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldEluUmVzdWx0PWZ1bmN0aW9uKGlzSW5SZXN1bHQpe3RoaXMuX2lzSW5SZXN1bHQ9aXNJblJlc3VsdDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNJblJlc3VsdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0luUmVzdWx0O307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5pc1Zpc2l0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWaXNpdGVkO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXRWaXNpdGVkPWZ1bmN0aW9uKGlzVmlzaXRlZCl7dGhpcy5faXNWaXNpdGVkPWlzVmlzaXRlZDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RWRnZVJpbmc9ZnVuY3Rpb24oZWRnZVJpbmcpe3RoaXMuZWRnZVJpbmc9ZWRnZVJpbmc7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldEVkZ2VSaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZVJpbmc7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldE1pbkVkZ2VSaW5nPWZ1bmN0aW9uKG1pbkVkZ2VSaW5nKXt0aGlzLm1pbkVkZ2VSaW5nPW1pbkVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXRNaW5FZGdlUmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1pbkVkZ2VSaW5nO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXREZXB0aD1mdW5jdGlvbihwb3NpdGlvbil7cmV0dXJuIHRoaXMuZGVwdGhbcG9zaXRpb25dO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXREZXB0aD1mdW5jdGlvbihwb3NpdGlvbixkZXB0aFZhbCl7aWYodGhpcy5kZXB0aFtwb3NpdGlvbl0hPT0tOTk5KXtpZih0aGlzLmRlcHRoW3Bvc2l0aW9uXSE9PWRlcHRoVmFsKVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuVG9wb2xvZ3lFcnJvcignYXNzaWduZWQgZGVwdGhzIGRvIG5vdCBtYXRjaCcsdGhpcy5nZXRDb29yZGluYXRlKCkpO31cbnRoaXMuZGVwdGhbcG9zaXRpb25dPWRlcHRoVmFsO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5nZXREZXB0aERlbHRhPWZ1bmN0aW9uKCl7dmFyIGRlcHRoRGVsdGE9dGhpcy5lZGdlLmdldERlcHRoRGVsdGEoKTtpZighdGhpcy5faXNGb3J3YXJkKVxuZGVwdGhEZWx0YT0tZGVwdGhEZWx0YTtyZXR1cm4gZGVwdGhEZWx0YTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0VmlzaXRlZEVkZ2U9ZnVuY3Rpb24oaXNWaXNpdGVkKXt0aGlzLnNldFZpc2l0ZWQoaXNWaXNpdGVkKTt0aGlzLnN5bS5zZXRWaXNpdGVkKGlzVmlzaXRlZCk7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldFN5bT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN5bTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNGb3J3YXJkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzRm9yd2FyZDt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0U3ltPWZ1bmN0aW9uKGRlKXt0aGlzLnN5bT1kZTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuZ2V0TmV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5leHQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLnNldE5leHQ9ZnVuY3Rpb24obmV4dCl7dGhpcy5uZXh0PW5leHQ7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmdldE5leHRNaW49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uZXh0TWluO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5zZXROZXh0TWluPWZ1bmN0aW9uKG5leHRNaW4pe3RoaXMubmV4dE1pbj1uZXh0TWluO307anN0cy5nZW9tZ3JhcGguRGlyZWN0ZWRFZGdlLnByb3RvdHlwZS5pc0xpbmVFZGdlPWZ1bmN0aW9uKCl7dmFyIGlzTGluZT10aGlzLmxhYmVsLmlzTGluZSgwKXx8dGhpcy5sYWJlbC5pc0xpbmUoMSk7dmFyIGlzRXh0ZXJpb3JJZkFyZWEwPSF0aGlzLmxhYmVsLmlzQXJlYSgwKXx8dGhpcy5sYWJlbC5hbGxQb3NpdGlvbnNFcXVhbCgwLExvY2F0aW9uLkVYVEVSSU9SKTt2YXIgaXNFeHRlcmlvcklmQXJlYTE9IXRoaXMubGFiZWwuaXNBcmVhKDEpfHx0aGlzLmxhYmVsLmFsbFBvc2l0aW9uc0VxdWFsKDEsTG9jYXRpb24uRVhURVJJT1IpO3JldHVybiBpc0xpbmUmJmlzRXh0ZXJpb3JJZkFyZWEwJiZpc0V4dGVyaW9ySWZBcmVhMTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuaXNJbnRlcmlvckFyZWFFZGdlPWZ1bmN0aW9uKCl7dmFyIGlzSW50ZXJpb3JBcmVhRWRnZT10cnVlO2Zvcih2YXIgaT0wO2k8MjtpKyspe2lmKCEodGhpcy5sYWJlbC5pc0FyZWEoaSkmJnRoaXMubGFiZWwuZ2V0TG9jYXRpb24oaSxQb3NpdGlvbi5MRUZUKT09PUxvY2F0aW9uLklOVEVSSU9SJiZ0aGlzLmxhYmVsLmdldExvY2F0aW9uKGksUG9zaXRpb24uUklHSFQpPT09TG9jYXRpb24uSU5URVJJT1IpKXtpc0ludGVyaW9yQXJlYUVkZ2U9ZmFsc2U7fX1cbnJldHVybiBpc0ludGVyaW9yQXJlYUVkZ2U7fTtqc3RzLmdlb21ncmFwaC5EaXJlY3RlZEVkZ2UucHJvdG90eXBlLmNvbXB1dGVEaXJlY3RlZExhYmVsPWZ1bmN0aW9uKCl7dGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5lZGdlLmdldExhYmVsKCkpO2lmKCF0aGlzLl9pc0ZvcndhcmQpXG50aGlzLmxhYmVsLmZsaXAoKTt9O2pzdHMuZ2VvbWdyYXBoLkRpcmVjdGVkRWRnZS5wcm90b3R5cGUuc2V0RWRnZURlcHRocz1mdW5jdGlvbihwb3NpdGlvbixkZXB0aCl7dmFyIGRlcHRoRGVsdGE9dGhpcy5nZXRFZGdlKCkuZ2V0RGVwdGhEZWx0YSgpO2lmKCF0aGlzLl9pc0ZvcndhcmQpXG5kZXB0aERlbHRhPS1kZXB0aERlbHRhO3ZhciBkaXJlY3Rpb25GYWN0b3I9MTtpZihwb3NpdGlvbj09PVBvc2l0aW9uLkxFRlQpXG5kaXJlY3Rpb25GYWN0b3I9LTE7dmFyIG9wcG9zaXRlUG9zPVBvc2l0aW9uLm9wcG9zaXRlKHBvc2l0aW9uKTt2YXIgZGVsdGE9ZGVwdGhEZWx0YSpkaXJlY3Rpb25GYWN0b3I7dmFyIG9wcG9zaXRlRGVwdGg9ZGVwdGgrZGVsdGE7dGhpcy5zZXREZXB0aChwb3NpdGlvbixkZXB0aCk7dGhpcy5zZXREZXB0aChvcHBvc2l0ZVBvcyxvcHBvc2l0ZURlcHRoKTt9O30pKCk7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcD1mdW5jdGlvbihnMCxnMSx0ZXJtaW5hdGVEaXN0YW5jZSl7dGhpcy5wdExvY2F0b3I9bmV3IGpzdHMuYWxnb3JpdGhtLlBvaW50TG9jYXRvcigpO3RoaXMuZ2VvbT1bXTt0aGlzLmdlb21bMF09ZzA7dGhpcy5nZW9tWzFdPWcxO3RoaXMudGVybWluYXRlRGlzdGFuY2U9dGVybWluYXRlRGlzdGFuY2U7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5nZW9tPW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUudGVybWluYXRlRGlzdGFuY2U9MC4wO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLnB0TG9jYXRvcj1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLm1pbkRpc3RhbmNlTG9jYXRpb249bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5taW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AuZGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEpe3ZhciBkaXN0T3A9bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AoZzAsZzEsMC4wKTtyZXR1cm4gZGlzdE9wLmRpc3RhbmNlKCk7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLmlzV2l0aGluRGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEsZGlzdGFuY2Upe3ZhciBkaXN0T3A9bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AoZzAsZzEsZGlzdGFuY2UpO3JldHVybiBkaXN0T3AuZGlzdGFuY2UoKTw9ZGlzdGFuY2U7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLm5lYXJlc3RQb2ludHM9ZnVuY3Rpb24oZzAsZzEpe3ZhciBkaXN0T3A9bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AoZzAsZzEsMC4wKTtyZXR1cm4gZGlzdE9wLm5lYXJlc3RQb2ludHMoKTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmRpc3RhbmNlPWZ1bmN0aW9uKCl7aWYodGhpcy5nZW9tWzBdPT09bnVsbHx8dGhpcy5nZW9tWzFdPT09bnVsbClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdudWxsIGdlb21ldHJpZXMgYXJlIG5vdCBzdXBwb3J0ZWQnKTtpZih0aGlzLmdlb21bMF0uaXNFbXB0eSgpfHx0aGlzLmdlb21bMV0uaXNFbXB0eSgpKVxucmV0dXJuIDAuMDt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZSgpO3JldHVybiB0aGlzLm1pbkRpc3RhbmNlO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUubmVhcmVzdFBvaW50cz1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlKCk7dmFyIG5lYXJlc3RQdHM9W3RoaXMubWluRGlzdGFuY2VMb2NhdGlvblswXS5nZXRDb29yZGluYXRlKCksdGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uWzFdLmdldENvb3JkaW5hdGUoKV07cmV0dXJuIG5lYXJlc3RQdHM7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5uZWFyZXN0TG9jYXRpb25zPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlTWluRGlzdGFuY2UoKTtyZXR1cm4gdGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUudXBkYXRlTWluRGlzdGFuY2U9ZnVuY3Rpb24obG9jR2VvbSxmbGlwKXtpZihsb2NHZW9tWzBdPT09bnVsbClcbnJldHVybjtpZihmbGlwKXt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMF09bG9jR2VvbVsxXTt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMV09bG9jR2VvbVswXTt9ZWxzZXt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMF09bG9jR2VvbVswXTt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bMV09bG9jR2VvbVsxXTt9fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5EaXN0YW5jZU9wLnByb3RvdHlwZS5jb21wdXRlTWluRGlzdGFuY2U9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjApe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbmlmKHRoaXMubWluRGlzdGFuY2VMb2NhdGlvbiE9PW51bGwpXG5yZXR1cm47dGhpcy5taW5EaXN0YW5jZUxvY2F0aW9uPVtdO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UoKTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO3RoaXMuY29tcHV0ZUZhY2V0RGlzdGFuY2UoKTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlPWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fWVsc2UgaWYoYXJndW1lbnRzLmxlbmd0aD09PTMmJighYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKSl7dGhpcy5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTMuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dGhpcy5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG52YXIgbG9jUHRQb2x5PVtdO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UyKDAsbG9jUHRQb2x5KTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UyKDEsbG9jUHRQb2x5KTt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVDb250YWlubWVudERpc3RhbmNlMj1mdW5jdGlvbihwb2x5R2VvbUluZGV4LGxvY1B0UG9seSl7dmFyIGxvY2F0aW9uc0luZGV4PTEtcG9seUdlb21JbmRleDt2YXIgcG9seXM9anN0cy5nZW9tLnV0aWwuUG9seWdvbkV4dHJhY3Rlci5nZXRQb2x5Z29ucyh0aGlzLmdlb21bcG9seUdlb21JbmRleF0pO2lmKHBvbHlzLmxlbmd0aD4wKXt2YXIgaW5zaWRlTG9jcz1qc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5Db25uZWN0ZWRFbGVtZW50TG9jYXRpb25GaWx0ZXIuZ2V0TG9jYXRpb25zKHRoaXMuZ2VvbVtsb2NhdGlvbnNJbmRleF0pO3RoaXMuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UzKGluc2lkZUxvY3MscG9seXMsbG9jUHRQb2x5KTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKXt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bbG9jYXRpb25zSW5kZXhdPWxvY1B0UG9seVswXTt0aGlzLm1pbkRpc3RhbmNlTG9jYXRpb25bcG9seUdlb21JbmRleF09bG9jUHRQb2x5WzFdO3JldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2UzPWZ1bmN0aW9uKGxvY3MscG9seXMsbG9jUHRQb2x5KXtmb3IodmFyIGk9MDtpPGxvY3MubGVuZ3RoO2krKyl7dmFyIGxvYz1sb2NzW2ldO2Zvcih2YXIgaj0wO2o8cG9seXMubGVuZ3RoO2orKyl7dGhpcy5jb21wdXRlQ29udGFpbm1lbnREaXN0YW5jZTQobG9jLHBvbHlzW2pdLGxvY1B0UG9seSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZUNvbnRhaW5tZW50RGlzdGFuY2U0PWZ1bmN0aW9uKHB0TG9jLHBvbHksbG9jUHRQb2x5KXt2YXIgcHQ9cHRMb2MuZ2V0Q29vcmRpbmF0ZSgpO2lmKGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUiE9PXRoaXMucHRMb2NhdG9yLmxvY2F0ZShwdCxwb2x5KSl7dGhpcy5taW5EaXN0YW5jZT0wLjA7bG9jUHRQb2x5WzBdPXB0TG9jO2xvY1B0UG9seVsxXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihwb2x5LHB0KTtyZXR1cm47fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZUZhY2V0RGlzdGFuY2U9ZnVuY3Rpb24oKXt2YXIgbG9jR2VvbT1bXTt2YXIgbGluZXMwPWpzdHMuZ2VvbS51dGlsLkxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lcyh0aGlzLmdlb21bMF0pO3ZhciBsaW5lczE9anN0cy5nZW9tLnV0aWwuTGluZWFyQ29tcG9uZW50RXh0cmFjdGVyLmdldExpbmVzKHRoaXMuZ2VvbVsxXSk7dmFyIHB0czA9anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIuZ2V0UG9pbnRzKHRoaXMuZ2VvbVswXSk7dmFyIHB0czE9anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIuZ2V0UG9pbnRzKHRoaXMuZ2VvbVsxXSk7dGhpcy5jb21wdXRlTWluRGlzdGFuY2VMaW5lcyhsaW5lczAsbGluZXMxLGxvY0dlb20pO3RoaXMudXBkYXRlTWluRGlzdGFuY2UobG9jR2VvbSxmYWxzZSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjtsb2NHZW9tWzBdPW51bGw7bG9jR2VvbVsxXT1udWxsO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXNQb2ludHMobGluZXMwLHB0czEsbG9jR2VvbSk7dGhpcy51cGRhdGVNaW5EaXN0YW5jZShsb2NHZW9tLGZhbHNlKTtpZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKVxucmV0dXJuO2xvY0dlb21bMF09bnVsbDtsb2NHZW9tWzFdPW51bGw7dGhpcy5jb21wdXRlTWluRGlzdGFuY2VMaW5lc1BvaW50cyhsaW5lczEscHRzMCxsb2NHZW9tKTt0aGlzLnVwZGF0ZU1pbkRpc3RhbmNlKGxvY0dlb20sdHJ1ZSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjtsb2NHZW9tWzBdPW51bGw7bG9jR2VvbVsxXT1udWxsO3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlUG9pbnRzKHB0czAscHRzMSxsb2NHZW9tKTt0aGlzLnVwZGF0ZU1pbkRpc3RhbmNlKGxvY0dlb20sZmFsc2UpO307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXM9ZnVuY3Rpb24obGluZXMwLGxpbmVzMSxsb2NHZW9tKXtmb3IodmFyIGk9MDtpPGxpbmVzMC5sZW5ndGg7aSsrKXt2YXIgbGluZTA9bGluZXMwW2ldO2Zvcih2YXIgaj0wO2o8bGluZXMxLmxlbmd0aDtqKyspe3ZhciBsaW5lMT1saW5lczFbal07dGhpcy5jb21wdXRlTWluRGlzdGFuY2UobGluZTAsbGluZTEsbG9jR2VvbSk7aWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlUG9pbnRzPWZ1bmN0aW9uKHBvaW50czAscG9pbnRzMSxsb2NHZW9tKXtmb3IodmFyIGk9MDtpPHBvaW50czAubGVuZ3RoO2krKyl7dmFyIHB0MD1wb2ludHMwW2ldO2Zvcih2YXIgaj0wO2o8cG9pbnRzMS5sZW5ndGg7aisrKXt2YXIgcHQxPXBvaW50czFbal07dmFyIGRpc3Q9cHQwLmdldENvb3JkaW5hdGUoKS5kaXN0YW5jZShwdDEuZ2V0Q29vcmRpbmF0ZSgpKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMubWluRGlzdGFuY2U9ZGlzdDtsb2NHZW9tWzBdPW5ldyBqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uKHB0MCwwLHB0MC5nZXRDb29yZGluYXRlKCkpO2xvY0dlb21bMV09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ocHQxLDAscHQxLmdldENvb3JkaW5hdGUoKSk7fVxuaWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSlcbnJldHVybjt9fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlTGluZXNQb2ludHM9ZnVuY3Rpb24obGluZXMscG9pbnRzLGxvY0dlb20pe2Zvcih2YXIgaT0wO2k8bGluZXMubGVuZ3RoO2krKyl7dmFyIGxpbmU9bGluZXNbaV07Zm9yKHZhciBqPTA7ajxwb2ludHMubGVuZ3RoO2orKyl7dmFyIHB0PXBvaW50c1tqXTt0aGlzLmNvbXB1dGVNaW5EaXN0YW5jZShsaW5lLHB0LGxvY0dlb20pO2lmKHRoaXMubWluRGlzdGFuY2U8PXRoaXMudGVybWluYXRlRGlzdGFuY2UpXG5yZXR1cm47fX19O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkRpc3RhbmNlT3AucHJvdG90eXBlLmNvbXB1dGVNaW5EaXN0YW5jZTI9ZnVuY3Rpb24obGluZTAsbGluZTEsbG9jR2VvbSl7aWYobGluZTEgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpe3RoaXMuY29tcHV0ZU1pbkRpc3RhbmNlMyhsaW5lMCxsaW5lMSxsb2NHZW9tKTtyZXR1cm47fVxuaWYobGluZTAuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmRpc3RhbmNlKGxpbmUxLmdldEVudmVsb3BlSW50ZXJuYWwoKSk+dGhpcy5taW5EaXN0YW5jZSl7cmV0dXJuO31cbnZhciBjb29yZDA9bGluZTAuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgY29vcmQxPWxpbmUxLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxjb29yZDAubGVuZ3RoLTE7aSsrKXtmb3IodmFyIGo9MDtqPGNvb3JkMS5sZW5ndGgtMTtqKyspe3ZhciBkaXN0PWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZUxpbmVMaW5lKGNvb3JkMFtpXSxjb29yZDBbaSsxXSxjb29yZDFbal0sY29vcmQxW2orMV0pO2lmKGRpc3Q8dGhpcy5taW5EaXN0YW5jZSl7dGhpcy5taW5EaXN0YW5jZT1kaXN0O3ZhciBzZWcwPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoY29vcmQwW2ldLGNvb3JkMFtpKzFdKTt2YXIgc2VnMT1uZXcganN0cy5nZW9tLkxpbmVTZWdtZW50KGNvb3JkMVtqXSxjb29yZDFbaisxXSk7dmFyIGNsb3Nlc3RQdD1zZWcwLmNsb3Nlc3RQb2ludHMoc2VnMSk7bG9jR2VvbVswXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihsaW5lMCxpLGNsb3Nlc3RQdFswXSk7bG9jR2VvbVsxXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihsaW5lMSxqLGNsb3Nlc3RQdFsxXSk7fVxuaWYodGhpcy5taW5EaXN0YW5jZTw9dGhpcy50ZXJtaW5hdGVEaXN0YW5jZSl7cmV0dXJuO319fX07anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuRGlzdGFuY2VPcC5wcm90b3R5cGUuY29tcHV0ZU1pbkRpc3RhbmNlMz1mdW5jdGlvbihsaW5lLHB0LGxvY0dlb20pe2lmKGxpbmUuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmRpc3RhbmNlKHB0LmdldEVudmVsb3BlSW50ZXJuYWwoKSk+dGhpcy5taW5EaXN0YW5jZSl7cmV0dXJuO31cbnZhciBjb29yZDA9bGluZS5nZXRDb29yZGluYXRlcygpO3ZhciBjb29yZD1wdC5nZXRDb29yZGluYXRlKCk7Zm9yKHZhciBpPTA7aTxjb29yZDAubGVuZ3RoLTE7aSsrKXt2YXIgZGlzdD1qc3RzLmFsZ29yaXRobS5DR0FsZ29yaXRobXMuZGlzdGFuY2VQb2ludExpbmUoY29vcmQsY29vcmQwW2ldLGNvb3JkMFtpKzFdKTtpZihkaXN0PHRoaXMubWluRGlzdGFuY2Upe3RoaXMubWluRGlzdGFuY2U9ZGlzdDt2YXIgc2VnPW5ldyBqc3RzLmdlb20uTGluZVNlZ21lbnQoY29vcmQwW2ldLGNvb3JkMFtpKzFdKTt2YXIgc2VnQ2xvc2VzdFBvaW50PXNlZy5jbG9zZXN0UG9pbnQoY29vcmQpO2xvY0dlb21bMF09bmV3IGpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24obGluZSxpLHNlZ0Nsb3Nlc3RQb2ludCk7bG9jR2VvbVsxXT1uZXcganN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbihwdCwwLGNvb3JkKTt9XG5pZih0aGlzLm1pbkRpc3RhbmNlPD10aGlzLnRlcm1pbmF0ZURpc3RhbmNlKXtyZXR1cm47fX19O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlPWZ1bmN0aW9uKG5vZGVDYXBhY2l0eSl7bm9kZUNhcGFjaXR5PW5vZGVDYXBhY2l0eXx8MTA7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5jYWxsKHRoaXMsbm9kZUNhcGFjaXR5KTt9O2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZT1uZXcganN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZSgpO2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLmNvbnN0cnVjdG9yPWpzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlO2pzdHMuaW5kZXguc3RydHJlZS5TSVJ0cmVlLnByb3RvdHlwZS5jb21wZXJhdG9yPXtjb21wYXJlOmZ1bmN0aW9uKG8xLG8yKXtyZXR1cm4gbzEuZ2V0Qm91bmRzKCkuZ2V0Q2VudHJlKCktbzIuZ2V0Qm91bmRzKCkuZ2V0Q2VudHJlKCk7fX07anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLmludGVyc2VjdGlvbk9wPXtpbnRlcnNlY3RzOmZ1bmN0aW9uKGFCb3VuZHMsYkJvdW5kcyl7cmV0dXJuIGFCb3VuZHMuaW50ZXJzZWN0cyhiQm91bmRzKTt9fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuY3JlYXRlTm9kZT1mdW5jdGlvbihsZXZlbCl7dmFyIEFic3RyYWN0Tm9kZT1mdW5jdGlvbihsZXZlbCl7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0Tm9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fTtBYnN0cmFjdE5vZGUucHJvdG90eXBlPW5ldyBqc3RzLmluZGV4LnN0cnRyZWUuQWJzdHJhY3ROb2RlKCk7QWJzdHJhY3ROb2RlLmNvbnN0cnVjdG9yPUFic3RyYWN0Tm9kZTtBYnN0cmFjdE5vZGUucHJvdG90eXBlLmNvbXB1dGVCb3VuZHM9ZnVuY3Rpb24oKXt2YXIgYm91bmRzPW51bGwsY2hpbGRCb3VuZGFibGVzPXRoaXMuZ2V0Q2hpbGRCb3VuZGFibGVzKCksY2hpbGRCb3VuZGFibGU7Zm9yKHZhciBpPTAsbD1jaGlsZEJvdW5kYWJsZXMubGVuZ3RoO2k8bDtpKyspe2NoaWxkQm91bmRhYmxlPWNoaWxkQm91bmRhYmxlc1tpXTtpZihib3VuZHM9PT1udWxsKXtib3VuZHM9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChjaGlsZEJvdW5kYWJsZS5nZXRCb3VuZHMoKSk7fVxuZWxzZXtib3VuZHMuZXhwYW5kVG9JbmNsdWRlKGNoaWxkQm91bmRhYmxlLmdldEJvdW5kcygpKTt9fVxucmV0dXJuIGJvdW5kczt9O3JldHVybiBBYnN0cmFjdE5vZGU7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKHgxLHgyLGl0ZW0pe2pzdHMuaW5kZXguc3RydHJlZS5BYnN0cmFjdFNUUnRyZWUucHJvdG90eXBlLmluc2VydChuZXcganN0cy5pbmRleC5zdHJ0cmVlLkludGVydmFsKE1hdGgubWluKHgxLHgyKSxNYXRoLm1heCh4MSx4MikpLGl0ZW0pO307anN0cy5pbmRleC5zdHJ0cmVlLlNJUnRyZWUucHJvdG90eXBlLnF1ZXJ5PWZ1bmN0aW9uKHgxLHgyKXt4Mj14Mnx8eDE7anN0cy5pbmRleC5zdHJ0cmVlLkFic3RyYWN0U1RSdHJlZS5wcm90b3R5cGUucXVlcnkobmV3IGpzdHMuaW5kZXguc3RydHJlZS5JbnRlcnZhbChNYXRoLm1pbih4MSx4MiksTWF0aC5tYXgoeDEseDIpKSk7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuZ2V0SW50ZXJzZWN0c09wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZXJzZWN0aW9uT3A7fTtqc3RzLmluZGV4LnN0cnRyZWUuU0lSdHJlZS5wcm90b3R5cGUuZ2V0Q29tcGFyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBlcmF0b3I7fTtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllcj1mdW5jdGlvbihpbnB1dEdlb20pe3RoaXMuaW5wdXRHZW9tPWlucHV0R2VvbTt0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neT10cnVlO307anN0cy5zaW1wbGlmeS5Eb3VnbGFzUGV1Y2tlclNpbXBsaWZpZXIucHJvdG90eXBlLmlucHV0R2VvbT1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5kaXN0YW5jZVRvbGVyYW5jZT1udWxsO2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9bnVsbDtqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllci5zaW1wbGlmeT1mdW5jdGlvbihnZW9tLGRpc3RhbmNlVG9sZXJhbmNlKXt2YXIgdHNzPW5ldyBqc3RzLnNpbXBsaWZ5LkRvdWdsYXNQZXVja2VyU2ltcGxpZmllcihnZW9tKTt0c3Muc2V0RGlzdGFuY2VUb2xlcmFuY2UoZGlzdGFuY2VUb2xlcmFuY2UpO3JldHVybiB0c3MuZ2V0UmVzdWx0R2VvbWV0cnkoKTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5zZXREaXN0YW5jZVRvbGVyYW5jZT1mdW5jdGlvbihkaXN0YW5jZVRvbGVyYW5jZSl7aWYoZGlzdGFuY2VUb2xlcmFuY2U8MC4wKXt0aHJvd1wiVG9sZXJhbmNlIG11c3QgYmUgbm9uLW5lZ2F0aXZlXCI7fVxudGhpcy5kaXN0YW5jZVRvbGVyYW5jZT1kaXN0YW5jZVRvbGVyYW5jZTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5zZXRFbnN1cmVWYWxpZD1mdW5jdGlvbihpc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpe3RoaXMuaXNFbnN1cmVWYWxpZFRvcG9sb2d5PWlzRW5zdXJlVmFsaWRUb3BvbG9neTt9O2pzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJTaW1wbGlmaWVyLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbigpe2lmKHRoaXMuaW5wdXRHZW9tLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuaW5wdXRHZW9tLmNsb25lKCk7fVxucmV0dXJuKG5ldyBqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIodGhpcy5kaXN0YW5jZVRvbGVyYW5jZSx0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neSkpLnRyYW5zZm9ybSh0aGlzLmlucHV0R2VvbSk7fTsoZnVuY3Rpb24oKXtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnM9ZnVuY3Rpb24ocmVjdGFuZ2xlKXt0aGlzLnJlY3RFbnY9cmVjdGFuZ2xlLmdldEVudmVsb3BlSW50ZXJuYWwoKTt9XG5qc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlQ29udGFpbnMuY29udGFpbnM9ZnVuY3Rpb24ocmVjdGFuZ2xlLGIpe3ZhciByYz1uZXcganN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zKHJlY3RhbmdsZSk7cmV0dXJuIHJjLmNvbnRhaW5zKGIpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUucmVjdEVudj1udWxsO2pzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oZ2VvbSl7aWYoIXRoaXMucmVjdEVudi5jb250YWlucyhnZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpXG5yZXR1cm4gZmFsc2U7aWYodGhpcy5pc0NvbnRhaW5lZEluQm91bmRhcnkoZ2VvbSkpXG5yZXR1cm4gZmFsc2U7cmV0dXJuIHRydWU7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zLnByb3RvdHlwZS5pc0NvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24oZ2VvbSl7aWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKXJldHVybiBmYWxzZTtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXJldHVybiB0aGlzLmlzUG9pbnRDb250YWluZWRJbkJvdW5kYXJ5KGdlb20uZ2V0Q29vcmRpbmF0ZSgpKTtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmcpcmV0dXJuIHRoaXMuaXNMaW5lU3RyaW5nQ29udGFpbmVkSW5Cb3VuZGFyeShnZW9tKTtmb3IodmFyIGk9MDtpPGdlb20uZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGNvbXA9Z2VvbS5nZXRHZW9tZXRyeU4oaSk7aWYoIXRoaXMuaXNDb250YWluZWRJbkJvdW5kYXJ5KGNvbXApKVxucmV0dXJuIGZhbHNlO31cbnJldHVybiB0cnVlO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNQb2ludENvbnRhaW5lZEluQm91bmRhcnk9ZnVuY3Rpb24ocHQpe3JldHVybiBwdC54PT10aGlzLnJlY3RFbnYuZ2V0TWluWCgpfHxwdC54PT10aGlzLnJlY3RFbnYuZ2V0TWF4WCgpfHxwdC55PT10aGlzLnJlY3RFbnYuZ2V0TWluWSgpfHxwdC55PT10aGlzLnJlY3RFbnYuZ2V0TWF4WSgpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVDb250YWlucy5wcm90b3R5cGUuaXNMaW5lU3RyaW5nQ29udGFpbmVkSW5Cb3VuZGFyeT1mdW5jdGlvbihsaW5lKXt2YXIgc2VxPWxpbmUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7Zm9yKHZhciBpPTA7aTxzZXEubGVuZ3RoLTE7aSsrKXt2YXIgcDA9c2VxW2ldO3ZhciBwMT1zZXFbaSsxXTtpZighdGhpcy5pc0xpbmVTZWdtZW50Q29udGFpbmVkSW5Cb3VuZGFyeShwMCxwMSkpXG5yZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUNvbnRhaW5zLnByb3RvdHlwZS5pc0xpbmVTZWdtZW50Q29udGFpbmVkSW5Cb3VuZGFyeT1mdW5jdGlvbihwMCxwMSl7aWYocDAuZXF1YWxzKHAxKSlcbnJldHVybiB0aGlzLmlzUG9pbnRDb250YWluZWRJbkJvdW5kYXJ5KHAwKTtpZihwMC54PT1wMS54KXtpZihwMC54PT10aGlzLnJlY3RFbnYuZ2V0TWluWCgpfHxwMC54PT10aGlzLnJlY3RFbnYuZ2V0TWF4WCgpKVxucmV0dXJuIHRydWU7fVxuZWxzZSBpZihwMC55PT1wMS55KXtpZihwMC55PT10aGlzLnJlY3RFbnYuZ2V0TWluWSgpfHxwMC55PT10aGlzLnJlY3RFbnYuZ2V0TWF4WSgpKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO319KSgpOyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO2pzdHMuZ2VvbWdyYXBoLkRlcHRoPWZ1bmN0aW9uKCl7dGhpcy5kZXB0aD1bW10sW11dO2Zvcih2YXIgaT0wO2k8MjtpKyspe2Zvcih2YXIgaj0wO2o8MztqKyspe3RoaXMuZGVwdGhbaV1bal09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRTt9fX07anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRT0tMTtqc3RzLmdlb21ncmFwaC5EZXB0aC5kZXB0aEF0TG9jYXRpb249ZnVuY3Rpb24obG9jYXRpb24pe2lmKGxvY2F0aW9uPT09TG9jYXRpb24uRVhURVJJT1IpXG5yZXR1cm4gMDtpZihsb2NhdGlvbj09PUxvY2F0aW9uLklOVEVSSU9SKVxucmV0dXJuIDE7cmV0dXJuIGpzdHMuZ2VvbWdyYXBoLkRlcHRoLk5VTExfVkFMVUU7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuZGVwdGg9bnVsbDtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuZ2V0RGVwdGg9ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4KXtyZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5zZXREZXB0aD1mdW5jdGlvbihnZW9tSW5kZXgscG9zSW5kZXgsZGVwdGhWYWx1ZSl7dGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XT1kZXB0aFZhbHVlO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmdldExvY2F0aW9uPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCl7aWYodGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XTw9MClcbnJldHVybiBMb2NhdGlvbi5FWFRFUklPUjtyZXR1cm4gTG9jYXRpb24uSU5URVJJT1I7fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGdlb21JbmRleCxwb3NJbmRleCxsb2NhdGlvbil7aWYobG9jYXRpb249PT1Mb2NhdGlvbi5JTlRFUklPUilcbnRoaXMuZGVwdGhbZ2VvbUluZGV4XVtwb3NJbmRleF0rKzt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5pc051bGw9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjApe3JldHVybiB0aGlzLmlzTnVsbDIuYXBwbHkodGhpcyxhcmd1bWVudHMpO31cbmZvcih2YXIgaT0wO2k8MjtpKyspe2Zvcih2YXIgaj0wO2o8MztqKyspe2lmKHRoaXMuZGVwdGhbaV1bal0hPT1qc3RzLmdlb21ncmFwaC5EZXB0aC5OVUxMX1ZBTFVFKVxucmV0dXJuIGZhbHNlO319XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5pc051bGwyPWZ1bmN0aW9uKGdlb21JbmRleCl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtyZXR1cm4gdGhpcy5pc051bGwzLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG5yZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdWzFdPT1qc3RzLmdlb21ncmFwaC5EZXB0aC5OVUxMX1ZBTFVFO307anN0cy5nZW9tZ3JhcGguRGVwdGgucHJvdG90eXBlLmlzTnVsbDM9ZnVuY3Rpb24oZ2VvbUluZGV4LHBvc0luZGV4KXtyZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdW3Bvc0luZGV4XT09anN0cy5nZW9tZ3JhcGguRGVwdGguTlVMTF9WQUxVRTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24obGJsKXtmb3IodmFyIGk9MDtpPDI7aSsrKXtmb3IodmFyIGo9MTtqPDM7aisrKXt2YXIgbG9jPWxibC5nZXRMb2NhdGlvbihpLGopO2lmKGxvYz09PUxvY2F0aW9uLkVYVEVSSU9SfHxsb2M9PT1Mb2NhdGlvbi5JTlRFUklPUil7aWYodGhpcy5pc051bGwoaSxqKSl7dGhpcy5kZXB0aFtpXVtqXT1qc3RzLmdlb21ncmFwaC5EZXB0aC5kZXB0aEF0TG9jYXRpb24obG9jKTt9ZWxzZVxudGhpcy5kZXB0aFtpXVtqXSs9anN0cy5nZW9tZ3JhcGguRGVwdGguZGVwdGhBdExvY2F0aW9uKGxvYyk7fX19fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUuZ2V0RGVsdGE9ZnVuY3Rpb24oZ2VvbUluZGV4KXtyZXR1cm4gdGhpcy5kZXB0aFtnZW9tSW5kZXhdW1Bvc2l0aW9uLlJJR0hUXS1cbnRoaXMuZGVwdGhbZ2VvbUluZGV4XVtQb3NpdGlvbi5MRUZUXTt9O2pzdHMuZ2VvbWdyYXBoLkRlcHRoLnByb3RvdHlwZS5ub3JtYWxpemU9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MDtpPDI7aSsrKXtpZighdGhpcy5pc051bGwoaSkpe3ZhciBtaW5EZXB0aD10aGlzLmRlcHRoW2ldWzFdO2lmKHRoaXMuZGVwdGhbaV1bMl08bWluRGVwdGgpXG5taW5EZXB0aD10aGlzLmRlcHRoW2ldWzJdO2lmKG1pbkRlcHRoPDApXG5taW5EZXB0aD0wO2Zvcih2YXIgaj0xO2o8MztqKyspe3ZhciBuZXdWYWx1ZT0wO2lmKHRoaXMuZGVwdGhbaV1bal0+bWluRGVwdGgpXG5uZXdWYWx1ZT0xO3RoaXMuZGVwdGhbaV1bal09bmV3VmFsdWU7fX19fTtqc3RzLmdlb21ncmFwaC5EZXB0aC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4nQTogJyt0aGlzLmRlcHRoWzBdWzFdKycsJyt0aGlzLmRlcHRoWzBdWzJdKycgQjogJytcbnRoaXMuZGVwdGhbMV1bMV0rJywnK3RoaXMuZGVwdGhbMV1bMl07fTt9KSgpO2pzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGU9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUucHJvdG90eXBlLmlzSW5Cb3VuZGFyeT1mdW5jdGlvbihib3VuZGFyeUNvdW50KXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5hbGdvcml0aG0uTW9kMkJvdW5kYXJ5Tm9kZVJ1bGU9ZnVuY3Rpb24oKXt9O2pzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlLnByb3RvdHlwZT1uZXcganN0cy5hbGdvcml0aG0uQm91bmRhcnlOb2RlUnVsZSgpO2pzdHMuYWxnb3JpdGhtLk1vZDJCb3VuZGFyeU5vZGVSdWxlLnByb3RvdHlwZS5pc0luQm91bmRhcnk9ZnVuY3Rpb24oYm91bmRhcnlDb3VudCl7cmV0dXJuIGJvdW5kYXJ5Q291bnQlMj09PTE7fTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk1PRDJfQk9VTkRBUllfUlVMRT1uZXcganN0cy5hbGdvcml0aG0uTW9kMkJvdW5kYXJ5Tm9kZVJ1bGUoKTtqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk9HQ19TRlNfQk9VTkRBUllfUlVMRT1qc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk1PRDJfQk9VTkRBUllfUlVMRTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uPWZ1bmN0aW9uKGNvbXBvbmVudCxzZWdJbmRleCxwdCl7dGhpcy5jb21wb25lbnQ9Y29tcG9uZW50O3RoaXMuc2VnSW5kZXg9c2VnSW5kZXg7dGhpcy5wdD1wdDt9O2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24uSU5TSURFX0FSRUE9LTE7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuY29tcG9uZW50PW51bGw7anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuc2VnSW5kZXg9bnVsbDtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5wdD1udWxsO2pzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24ucHJvdG90eXBlLmdldEdlb21ldHJ5Q29tcG9uZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tcG9uZW50O307anN0cy5vcGVyYXRpb24uZGlzdGFuY2UuR2VvbWV0cnlMb2NhdGlvbi5wcm90b3R5cGUuZ2V0U2VnbWVudEluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VnSW5kZXg7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5nZXRDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ7fTtqc3RzLm9wZXJhdGlvbi5kaXN0YW5jZS5HZW9tZXRyeUxvY2F0aW9uLnByb3RvdHlwZS5pc0luc2lkZUFyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWdJbmRleD09PWpzdHMub3BlcmF0aW9uLmRpc3RhbmNlLkdlb21ldHJ5TG9jYXRpb24uSU5TSURFX0FSRUE7fTtqc3RzLmdlb20udXRpbC5Qb2ludEV4dHJhY3Rlcj1mdW5jdGlvbihwdHMpe3RoaXMucHRzPXB0czt9O2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmlsdGVyKCk7anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuZ2VvbS51dGlsLlBvaW50RXh0cmFjdGVyLmdldFBvaW50cz1mdW5jdGlvbihnZW9tLGxpc3Qpe2lmKGxpc3Q9PT11bmRlZmluZWQpe2xpc3Q9W107fVxuaWYoZ2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludCl7bGlzdC5wdXNoKGdlb20pO31lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIobGlzdCkpO31cbnJldHVybiBsaXN0O307anN0cy5nZW9tLnV0aWwuUG9pbnRFeHRyYWN0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihnZW9tKXtpZihnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KVxudGhpcy5wdHMucHVzaChnZW9tKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaD1mdW5jdGlvbigpe3RoaXMubm9kZXM9bmV3IGpzdHMuZ2VvbWdyYXBoLk5vZGVNYXAobmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlRmFjdG9yeSgpKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLm5vZGVzPW51bGw7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuYnVpbGQ9ZnVuY3Rpb24oZ2VvbUdyYXBoKXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2RlcyhnZW9tR3JhcGgsMCk7dGhpcy5jb3B5Tm9kZXNBbmRMYWJlbHMoZ2VvbUdyYXBoLDApO3ZhciBlZUJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVpbGRlcigpO3ZhciBlZUxpc3Q9ZWVCdWlsZGVyLmNvbXB1dGVFZGdlRW5kcyhnZW9tR3JhcGguZ2V0RWRnZUl0ZXJhdG9yKCkpO3RoaXMuaW5zZXJ0RWRnZUVuZHMoZWVMaXN0KTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlR3JhcGgucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25Ob2Rlcz1mdW5jdGlvbihnZW9tR3JhcGgsYXJnSW5kZXgpe2Zvcih2YXIgZWRnZUl0PWdlb21HcmFwaC5nZXRFZGdlSXRlcmF0b3IoKTtlZGdlSXQuaGFzTmV4dCgpOyl7dmFyIGU9ZWRnZUl0Lm5leHQoKTt2YXIgZUxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO2Zvcih2YXIgZWlJdD1lLmdldEVkZ2VJbnRlcnNlY3Rpb25MaXN0KCkuaXRlcmF0b3IoKTtlaUl0Lmhhc05leHQoKTspe3ZhciBlaT1laUl0Lm5leHQoKTt2YXIgbj10aGlzLm5vZGVzLmFkZE5vZGUoZWkuY29vcmQpO2lmKGVMb2M9PT1Mb2NhdGlvbi5CT1VOREFSWSlcbm4uc2V0TGFiZWxCb3VuZGFyeShhcmdJbmRleCk7ZWxzZXtpZihuLmdldExhYmVsKCkuaXNOdWxsKGFyZ0luZGV4KSlcbm4uc2V0TGFiZWwoYXJnSW5kZXgsTG9jYXRpb24uSU5URVJJT1IpO319fX07anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVHcmFwaC5wcm90b3R5cGUuY29weU5vZGVzQW5kTGFiZWxzPWZ1bmN0aW9uKGdlb21HcmFwaCxhcmdJbmRleCl7Zm9yKHZhciBub2RlSXQ9Z2VvbUdyYXBoLmdldE5vZGVJdGVyYXRvcigpO25vZGVJdC5oYXNOZXh0KCk7KXt2YXIgZ3JhcGhOb2RlPW5vZGVJdC5uZXh0KCk7dmFyIG5ld05vZGU9dGhpcy5ub2Rlcy5hZGROb2RlKGdyYXBoTm9kZS5nZXRDb29yZGluYXRlKCkpO25ld05vZGUuc2V0TGFiZWwoYXJnSW5kZXgsZ3JhcGhOb2RlLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5pbnNlcnRFZGdlRW5kcz1mdW5jdGlvbihlZSl7Zm9yKHZhciBpPWVlLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt0aGlzLm5vZGVzLmFkZChlKTt9fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUdyYXBoLnByb3RvdHlwZS5nZXROb2RlSXRlcmF0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2Rlcy5pdGVyYXRvcigpO307fSkoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5FZGdlU2V0SW50ZXJzZWN0b3IoKTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuZXZlbnRzPVtdO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5uT3ZlcmxhcHM9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuY29tcHV0ZUludGVyc2VjdGlvbnM9ZnVuY3Rpb24oZWRnZXMsc2ksdGVzdEFsbFNlZ21lbnRzKXtpZihzaSBpbnN0YW5jZW9mIGphdmFzY3JpcHQudXRpbC5MaXN0KXt0aGlzLmNvbXB1dGVJbnRlcnNlY3Rpb25zMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbmlmKHRlc3RBbGxTZWdtZW50cyl7dGhpcy5hZGQoZWRnZXMsbnVsbCk7fWVsc2V7dGhpcy5hZGQoZWRnZXMpO31cbnRoaXMuY29tcHV0ZUludGVyc2VjdGlvbnMzKHNpKTt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9uczI9ZnVuY3Rpb24oZWRnZXMwLGVkZ2VzMSxzaSl7dGhpcy5hZGQoZWRnZXMwLGVkZ2VzMCk7dGhpcy5hZGQoZWRnZXMxLGVkZ2VzMSk7dGhpcy5jb21wdXRlSW50ZXJzZWN0aW9uczMoc2kpO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmFkZD1mdW5jdGlvbihlZGdlLGVkZ2VTZXQpe2lmKGVkZ2UgaW5zdGFuY2VvZiBqYXZhc2NyaXB0LnV0aWwuTGlzdCl7dGhpcy5hZGQyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm47fVxudmFyIHB0cz1lZGdlLmdldENvb3JkaW5hdGVzKCk7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoLTE7aSsrKXt2YXIgc3M9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZVNlZ21lbnQoZWRnZSxpKTt2YXIgaW5zZXJ0RXZlbnQ9bmV3IGpzdHMuZ2VvbWdyYXBoLmluZGV4LlN3ZWVwTGluZUV2ZW50KHNzLmdldE1pblgoKSxzcyxlZGdlU2V0KTt0aGlzLmV2ZW50cy5wdXNoKGluc2VydEV2ZW50KTt0aGlzLmV2ZW50cy5wdXNoKG5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5Td2VlcExpbmVFdmVudChzcy5nZXRNYXhYKCksaW5zZXJ0RXZlbnQpKTt9fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TaW1wbGVTd2VlcExpbmVJbnRlcnNlY3Rvci5wcm90b3R5cGUuYWRkMj1mdW5jdGlvbihlZGdlcyxlZGdlU2V0KXtmb3IodmFyIGk9ZWRnZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBlZGdlPWkubmV4dCgpO2lmKGVkZ2VTZXQpe3RoaXMuYWRkKGVkZ2UsZWRnZVNldCk7fWVsc2V7dGhpcy5hZGQoZWRnZSxlZGdlKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLnByZXBhcmVFdmVudHM9ZnVuY3Rpb24oKXt0aGlzLmV2ZW50cy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO2Zvcih2YXIgaT0wO2k8dGhpcy5ldmVudHMubGVuZ3RoO2krKyl7dmFyIGV2PXRoaXMuZXZlbnRzW2ldO2lmKGV2LmlzRGVsZXRlKCkpe2V2LmdldEluc2VydEV2ZW50KCkuc2V0RGVsZXRlRXZlbnRJbmRleChpKTt9fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlU3dlZXBMaW5lSW50ZXJzZWN0b3IucHJvdG90eXBlLmNvbXB1dGVJbnRlcnNlY3Rpb25zMz1mdW5jdGlvbihzaSl7dGhpcy5uT3ZlcmxhcHM9MDt0aGlzLnByZXBhcmVFdmVudHMoKTtmb3IodmFyIGk9MDtpPHRoaXMuZXZlbnRzLmxlbmd0aDtpKyspe3ZhciBldj10aGlzLmV2ZW50c1tpXTtpZihldi5pc0luc2VydCgpKXt0aGlzLnByb2Nlc3NPdmVybGFwcyhpLGV2LmdldERlbGV0ZUV2ZW50SW5kZXgoKSxldixzaSk7fX19O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNpbXBsZVN3ZWVwTGluZUludGVyc2VjdG9yLnByb3RvdHlwZS5wcm9jZXNzT3ZlcmxhcHM9ZnVuY3Rpb24oc3RhcnQsZW5kLGV2MCxzaSl7dmFyIHNzMD1ldjAuZ2V0T2JqZWN0KCk7Zm9yKHZhciBpPXN0YXJ0O2k8ZW5kO2krKyl7dmFyIGV2MT10aGlzLmV2ZW50c1tpXTtpZihldjEuaXNJbnNlcnQoKSl7dmFyIHNzMT1ldjEuZ2V0T2JqZWN0KCk7aWYoIWV2MC5pc1NhbWVMYWJlbChldjEpKXtzczAuY29tcHV0ZUludGVyc2VjdGlvbnMoc3MxLHNpKTt0aGlzLm5PdmVybGFwcysrO319fX1cbmpzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyPWZ1bmN0aW9uKCl7dGhpcy5zaXRlQ29vcmRzPW51bGw7dGhpcy50b2xlcmFuY2U9MC4wO3RoaXMuc3ViZGl2PW51bGw7dGhpcy5jbGlwRW52PW51bGw7dGhpcy5kaWFncmFtRW52PW51bGw7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuc2V0U2l0ZXM9ZnVuY3Rpb24oKXt2YXIgYXJnPWFyZ3VtZW50c1swXTtpZihhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnl8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Db29yZGluYXRlfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnR8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZ3x8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZ3x8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29ufHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKXt0aGlzLnNldFNpdGVzQnlHZW9tZXRyeShhcmcpO31lbHNle3RoaXMuc2V0U2l0ZXNCeUFycmF5KGFyZyk7fX07anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzQnlHZW9tZXRyeT1mdW5jdGlvbihnZW9tKXt0aGlzLnNpdGVDb29yZHM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmV4dHJhY3RVbmlxdWVDb29yZGluYXRlcyhnZW9tKTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRTaXRlc0J5QXJyYXk9ZnVuY3Rpb24oY29vcmRzKXt0aGlzLnNpdGVDb29yZHM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZShjb29yZHMpO307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLnNldENsaXBFbnZlbG9wZT1mdW5jdGlvbihjbGlwRW52KXt0aGlzLmNsaXBFbnY9Y2xpcEVudjt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRUb2xlcmFuY2U9ZnVuY3Rpb24odG9sZXJhbmNlKVxue3RoaXMudG9sZXJhbmNlPXRvbGVyYW5jZTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5jcmVhdGU9ZnVuY3Rpb24oKXtpZih0aGlzLnN1YmRpdiE9PW51bGwpe3JldHVybjt9XG52YXIgc2l0ZUVudixleHBhbmRCeSx2ZXJ0aWNlcyx0cmlhbmd1bGF0b3I7c2l0ZUVudj1qc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIuZW52ZWxvcGUodGhpcy5zaXRlQ29vcmRzKTt0aGlzLmRpYWdyYW1FbnY9c2l0ZUVudjtleHBhbmRCeT1NYXRoLm1heCh0aGlzLmRpYWdyYW1FbnYuZ2V0V2lkdGgoKSx0aGlzLmRpYWdyYW1FbnYuZ2V0SGVpZ2h0KCkpO3RoaXMuZGlhZ3JhbUVudi5leHBhbmRCeShleHBhbmRCeSk7aWYodGhpcy5jbGlwRW52IT09bnVsbCl7dGhpcy5kaWFncmFtRW52LmV4cGFuZFRvSW5jbHVkZSh0aGlzLmNsaXBFbnYpO31cbnZlcnRpY2VzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci50b1ZlcnRpY2VzKHRoaXMuc2l0ZUNvb3Jkcyk7dGhpcy5zdWJkaXY9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbihzaXRlRW52LHRoaXMudG9sZXJhbmNlKTt0cmlhbmd1bGF0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUuSW5jcmVtZW50YWxEZWxhdW5heVRyaWFuZ3VsYXRvcih0aGlzLnN1YmRpdik7dHJpYW5ndWxhdG9yLmluc2VydFNpdGVzKHZlcnRpY2VzKTt9O2pzdHMudHJpYW5ndWxhdGUuVm9yb25vaURpYWdyYW1CdWlsZGVyLnByb3RvdHlwZS5nZXRTdWJkaXZpc2lvbj1mdW5jdGlvbigpe3RoaXMuY3JlYXRlKCk7cmV0dXJuIHRoaXMuc3ViZGl2O307anN0cy50cmlhbmd1bGF0ZS5Wb3Jvbm9pRGlhZ3JhbUJ1aWxkZXIucHJvdG90eXBlLmdldERpYWdyYW09ZnVuY3Rpb24oZ2VvbUZhY3Qpe3RoaXMuY3JlYXRlKCk7dmFyIHBvbHlzPXRoaXMuc3ViZGl2LmdldFZvcm9ub2lEaWFncmFtKGdlb21GYWN0KTtyZXR1cm4gdGhpcy5jbGlwR2VvbWV0cnlDb2xsZWN0aW9uKHBvbHlzLHRoaXMuZGlhZ3JhbUVudik7fTtqc3RzLnRyaWFuZ3VsYXRlLlZvcm9ub2lEaWFncmFtQnVpbGRlci5wcm90b3R5cGUuY2xpcEdlb21ldHJ5Q29sbGVjdGlvbj1mdW5jdGlvbihnZW9tLGNsaXBFbnYpe3ZhciBjbGlwUG9seSxjbGlwcGVkLGksaWwsZyxyZXN1bHQ7Y2xpcFBvbHk9Z2VvbS5nZXRGYWN0b3J5KCkudG9HZW9tZXRyeShjbGlwRW52KTtjbGlwcGVkPVtdO2k9MCxpbD1nZW9tLmdldE51bUdlb21ldHJpZXMoKTtmb3IoaTtpPGlsO2krKyl7Zz1nZW9tLmdldEdlb21ldHJ5TihpKTtyZXN1bHQ9bnVsbDtpZihjbGlwRW52LmNvbnRhaW5zKGcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7cmVzdWx0PWc7fVxuZWxzZSBpZihjbGlwRW52LmludGVyc2VjdHMoZy5nZXRFbnZlbG9wZUludGVybmFsKCkpKXtyZXN1bHQ9Y2xpcFBvbHkuaW50ZXJzZWN0aW9uKGcpO31cbmlmKHJlc3VsdCE9PW51bGwmJiFyZXN1bHQuaXNFbXB0eSgpKXtjbGlwcGVkLnB1c2gocmVzdWx0KTt9fVxucmV0dXJuIGdlb20uZ2V0RmFjdG9yeSgpLmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihjbGlwcGVkKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkluZGV4ZWROZXN0ZWRSaW5nVGVzdGVyPWZ1bmN0aW9uKGdyYXBoKXt0aGlzLmdyYXBoPWdyYXBoO3RoaXMucmluZ3M9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnRvdGFsRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKTt0aGlzLmluZGV4PW51bGw7dGhpcy5uZXN0ZWRQdD1udWxsO307anN0cy5vcGVyYXRpb24udmFsaWQuSW5kZXhlZE5lc3RlZFJpbmdUZXN0ZXIucHJvdG90eXBlLmdldE5lc3RlZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmVzdGVkUHQ7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHJpbmcpe3RoaXMucmluZ3MuYWRkKHJpbmcpO3RoaXMudG90YWxFbnYuZXhwYW5kVG9JbmNsdWRlKHJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9O2pzdHMub3BlcmF0aW9uLnZhbGlkLkluZGV4ZWROZXN0ZWRSaW5nVGVzdGVyLnByb3RvdHlwZS5pc05vbk5lc3RlZD1mdW5jdGlvbigpe3RoaXMuYnVpbGRJbmRleCgpO2Zvcih2YXIgaT0wO2k8dGhpcy5yaW5ncy5zaXplKCk7aSsrKXt2YXIgaW5uZXJSaW5nPXRoaXMucmluZ3MuZ2V0KGkpO3ZhciBpbm5lclJpbmdQdHM9aW5uZXJSaW5nLmdldENvb3JkaW5hdGVzKCk7dmFyIHJlc3VsdHM9dGhpcy5pbmRleC5xdWVyeShpbm5lclJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTtmb3IodmFyIGo9MDtqPHJlc3VsdHMubGVuZ3RoO2orKyl7dmFyIHNlYXJjaFJpbmc9cmVzdWx0c1tqXTt2YXIgc2VhcmNoUmluZ1B0cz1zZWFyY2hSaW5nLmdldENvb3JkaW5hdGVzKCk7aWYoaW5uZXJSaW5nPT1zZWFyY2hSaW5nKXtjb250aW51ZTt9XG5pZighaW5uZXJSaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKS5pbnRlcnNlY3RzKHNlYXJjaFJpbmcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKSl7Y29udGludWU7fVxudmFyIGlubmVyUmluZ1B0PWpzdHMub3BlcmF0aW9uLnZhbGlkLklzVmFsaWRPcC5maW5kUHROb3ROb2RlKGlubmVyUmluZ1B0cyxzZWFyY2hSaW5nLHRoaXMuZ3JhcGgpO2lmKGlubmVyUmluZ1B0PT1udWxsKXtjb250aW51ZTt9XG52YXIgaXNJbnNpZGU9anN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzUG9pbnRJblJpbmcoaW5uZXJSaW5nUHQsc2VhcmNoUmluZ1B0cyk7aWYoaXNJbnNpZGUpe3RoaXMubmVzdGVkUHQ9aW5uZXJSaW5nUHQ7cmV0dXJuIGZhbHNlO319fVxucmV0dXJuIHRydWU7fTtqc3RzLm9wZXJhdGlvbi52YWxpZC5JbmRleGVkTmVzdGVkUmluZ1Rlc3Rlci5wcm90b3R5cGUuYnVpbGRJbmRleD1mdW5jdGlvbigpe3RoaXMuaW5kZXg9bmV3IGpzdHMuaW5kZXguc3RydHJlZS5TVFJ0cmVlKCk7Zm9yKHZhciBpPTA7aTx0aGlzLnJpbmdzLnNpemUoKTtpKyspe3ZhciByaW5nPXRoaXMucmluZ3MuZ2V0KGkpO3ZhciBlbnY9cmluZy5nZXRFbnZlbG9wZUludGVybmFsKCk7dGhpcy5pbmRleC5pbnNlcnQoZW52LHJpbmcpO319O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW49ZnVuY3Rpb24obWNlLGNoYWluSW5kZXgpe3RoaXMubWNlPW1jZTt0aGlzLmNoYWluSW5kZXg9Y2hhaW5JbmRleDt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLm1jZT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4Lk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmNoYWluSW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlSW50ZXJzZWN0aW9ucz1mdW5jdGlvbihtYyxzaSl7dGhpcy5tY2UuY29tcHV0ZUludGVyc2VjdHNGb3JDaGFpbih0aGlzLmNoYWluSW5kZXgsbWMubWNlLG1jLmNoYWluSW5kZXgsc2kpO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGU9ZnVuY3Rpb24oc2VnU3RyaW5nLGNvb3JkLHNlZ21lbnRJbmRleCxzZWdtZW50T2N0YW50KXt0aGlzLnNlZ1N0cmluZz1zZWdTdHJpbmc7dGhpcy5jb29yZD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY29vcmQpO3RoaXMuc2VnbWVudEluZGV4PXNlZ21lbnRJbmRleDt0aGlzLnNlZ21lbnRPY3RhbnQ9c2VnbWVudE9jdGFudDt0aGlzLl9pc0ludGVyaW9yPSFjb29yZC5lcXVhbHMyRChzZWdTdHJpbmcuZ2V0Q29vcmRpbmF0ZShzZWdtZW50SW5kZXgpKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5zZWdTdHJpbmc9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuY29vcmQ9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuc2VnbWVudEluZGV4PW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLnNlZ21lbnRPY3RhbnQ9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuX2lzSW50ZXJpb3I9bnVsbDtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvb3JkO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGUucHJvdG90eXBlLmlzSW50ZXJpb3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNJbnRlcmlvcjt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5pc0VuZFBvaW50PWZ1bmN0aW9uKG1heFNlZ21lbnRJbmRleCl7aWYodGhpcy5zZWdtZW50SW5kZXg9PT0wJiYhdGhpcy5faXNJbnRlcmlvcilyZXR1cm4gdHJ1ZTtpZih0aGlzLnNlZ21lbnRJbmRleD09PXRoaXMubWF4U2VnbWVudEluZGV4KXJldHVybiB0cnVlO3JldHVybiBmYWxzZTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24ob2JqKXt2YXIgb3RoZXI9b2JqO2lmKHRoaXMuc2VnbWVudEluZGV4PG90aGVyLnNlZ21lbnRJbmRleClyZXR1cm4tMTtpZih0aGlzLnNlZ21lbnRJbmRleD5vdGhlci5zZWdtZW50SW5kZXgpcmV0dXJuIDE7aWYodGhpcy5jb29yZC5lcXVhbHMyRChvdGhlci5jb29yZCkpcmV0dXJuIDA7cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZSh0aGlzLnNlZ21lbnRPY3RhbnQsdGhpcy5jb29yZCxvdGhlci5jb29yZCk7fTsoZnVuY3Rpb24oKXtqc3RzLmlvLkdlb0pTT05Xcml0ZXI9ZnVuY3Rpb24oKXt0aGlzLnBhcnNlcj1uZXcganN0cy5pby5HZW9KU09OUGFyc2VyKHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMuaW8uR2VvSlNPTldyaXRlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBnZW9Kc29uPXRoaXMucGFyc2VyLndyaXRlKGdlb21ldHJ5KTtyZXR1cm4gZ2VvSnNvbjt9O30pKCk7anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5yZWFkPWZ1bmN0aW9uKGdlb21ldHJ5KXtpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuUG9pbnQnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbVBvaW50KGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTGluZVN0cmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5LkxpbmVhclJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0RnJvbUxpbmVhclJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5Qb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21Qb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2ludCcpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTXVsdGlQb2ludChnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRGcm9tTXVsdGlMaW5lU3RyaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J09wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21NdWx0aVBvbHlnb24oZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nT3BlbkxheWVycy5HZW9tZXRyeS5Db2xsZWN0aW9uJyl7cmV0dXJuIHRoaXMuY29udmVydEZyb21Db2xsZWN0aW9uKGdlb21ldHJ5KTt9fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tUG9pbnQ9ZnVuY3Rpb24ocG9pbnQpe3JldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVQb2ludChuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocG9pbnQueCxwb2ludC55KSk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTGluZVN0cmluZz1mdW5jdGlvbihsaW5lU3RyaW5nKXt2YXIgaTt2YXIgY29vcmRpbmF0ZXM9W107Zm9yKGk9MDtpPGxpbmVTdHJpbmcuY29tcG9uZW50cy5sZW5ndGg7aSsrKXtjb29yZGluYXRlcy5wdXNoKG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShsaW5lU3RyaW5nLmNvbXBvbmVudHNbaV0ueCxsaW5lU3RyaW5nLmNvbXBvbmVudHNbaV0ueSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKGNvb3JkaW5hdGVzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydEZyb21MaW5lYXJSaW5nPWZ1bmN0aW9uKGxpbmVhclJpbmcpe3ZhciBpO3ZhciBjb29yZGluYXRlcz1bXTtmb3IoaT0wO2k8bGluZWFyUmluZy5jb21wb25lbnRzLmxlbmd0aDtpKyspe2Nvb3JkaW5hdGVzLnB1c2gobmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGxpbmVhclJpbmcuY29tcG9uZW50c1tpXS54LGxpbmVhclJpbmcuY29tcG9uZW50c1tpXS55KSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUxpbmVhclJpbmcoY29vcmRpbmF0ZXMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0RnJvbVBvbHlnb249ZnVuY3Rpb24ocG9seWdvbil7dmFyIGk7dmFyIHNoZWxsPW51bGw7dmFyIGhvbGVzPVtdO2ZvcihpPTA7aTxwb2x5Z29uLmNvbXBvbmVudHMubGVuZ3RoO2krKyl7dmFyIGxpbmVhclJpbmc9dGhpcy5jb252ZXJ0RnJvbUxpbmVhclJpbmcocG9seWdvbi5jb21wb25lbnRzW2ldKTtpZihpPT09MCl7c2hlbGw9bGluZWFyUmluZzt9ZWxzZXtob2xlcy5wdXNoKGxpbmVhclJpbmcpO319XG5yZXR1cm4gdGhpcy5nZW9tZXRyeUZhY3RvcnkuY3JlYXRlUG9seWdvbihzaGVsbCxob2xlcyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTXVsdGlQb2ludD1mdW5jdGlvbihtdWx0aVBvaW50KXt2YXIgaTt2YXIgcG9pbnRzPVtdO2ZvcihpPTA7aTxtdWx0aVBvaW50LmNvbXBvbmVudHMubGVuZ3RoO2krKyl7cG9pbnRzLnB1c2godGhpcy5jb252ZXJ0RnJvbVBvaW50KG11bHRpUG9pbnQuY29tcG9uZW50c1tpXSkpO31cbnJldHVybiB0aGlzLmdlb21ldHJ5RmFjdG9yeS5jcmVhdGVNdWx0aVBvaW50KHBvaW50cyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKG11bHRpTGluZVN0cmluZyl7dmFyIGk7dmFyIGxpbmVTdHJpbmdzPVtdO2ZvcihpPTA7aTxtdWx0aUxpbmVTdHJpbmcuY29tcG9uZW50cy5sZW5ndGg7aSsrKXtsaW5lU3RyaW5ncy5wdXNoKHRoaXMuY29udmVydEZyb21MaW5lU3RyaW5nKG11bHRpTGluZVN0cmluZy5jb21wb25lbnRzW2ldKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKG11bHRpUG9seWdvbil7dmFyIGk7dmFyIHBvbHlnb25zPVtdO2ZvcihpPTA7aTxtdWx0aVBvbHlnb24uY29tcG9uZW50cy5sZW5ndGg7aSsrKXtwb2x5Z29ucy5wdXNoKHRoaXMuY29udmVydEZyb21Qb2x5Z29uKG11bHRpUG9seWdvbi5jb21wb25lbnRzW2ldKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZU11bHRpUG9seWdvbihwb2x5Z29ucyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRGcm9tQ29sbGVjdGlvbj1mdW5jdGlvbihjb2xsZWN0aW9uKXt2YXIgaTt2YXIgZ2VvbWV0cmllcz1bXTtmb3IoaT0wO2k8Y29sbGVjdGlvbi5jb21wb25lbnRzLmxlbmd0aDtpKyspe2dlb21ldHJpZXMucHVzaCh0aGlzLnJlYWQoY29sbGVjdGlvbi5jb21wb25lbnRzW2ldKSk7fVxucmV0dXJuIHRoaXMuZ2VvbWV0cnlGYWN0b3J5LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbihnZW9tZXRyaWVzKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLlBvaW50Jyl7cmV0dXJuIHRoaXMuY29udmVydFRvUG9pbnQoZ2VvbWV0cnkuY29vcmRpbmF0ZSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRUb0xpbmVTdHJpbmcoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLkxpbmVhclJpbmcnKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9MaW5lYXJSaW5nKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5Qb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydFRvUG9seWdvbihnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uTXVsdGlQb2ludCcpe3JldHVybiB0aGlzLmNvbnZlcnRUb011bHRpUG9pbnQoZ2VvbWV0cnkpO31lbHNlIGlmKGdlb21ldHJ5LkNMQVNTX05BTUU9PT0nanN0cy5nZW9tLk11bHRpTGluZVN0cmluZycpe3JldHVybiB0aGlzLmNvbnZlcnRUb011bHRpTGluZVN0cmluZyhnZW9tZXRyeSk7fWVsc2UgaWYoZ2VvbWV0cnkuQ0xBU1NfTkFNRT09PSdqc3RzLmdlb20uTXVsdGlQb2x5Z29uJyl7cmV0dXJuIHRoaXMuY29udmVydFRvTXVsdGlQb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeS5DTEFTU19OQU1FPT09J2pzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24nKXtyZXR1cm4gdGhpcy5jb252ZXJ0VG9Db2xsZWN0aW9uKGdlb21ldHJ5KTt9fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb1BvaW50PWZ1bmN0aW9uKGNvb3JkaW5hdGUpe3JldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5Qb2ludChjb29yZGluYXRlLngsY29vcmRpbmF0ZS55KTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvTGluZVN0cmluZz1mdW5jdGlvbihsaW5lU3RyaW5nKXt2YXIgaTt2YXIgcG9pbnRzPVtdO2ZvcihpPTA7aTxsaW5lU3RyaW5nLnBvaW50cy5sZW5ndGg7aSsrKXt2YXIgY29vcmRpbmF0ZT1saW5lU3RyaW5nLnBvaW50c1tpXTtwb2ludHMucHVzaCh0aGlzLmNvbnZlcnRUb1BvaW50KGNvb3JkaW5hdGUpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTGluZVN0cmluZyhwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9MaW5lYXJSaW5nPWZ1bmN0aW9uKGxpbmVhclJpbmcpe3ZhciBpO3ZhciBwb2ludHM9W107Zm9yKGk9MDtpPGxpbmVhclJpbmcucG9pbnRzLmxlbmd0aDtpKyspe3ZhciBjb29yZGluYXRlPWxpbmVhclJpbmcucG9pbnRzW2ldO3BvaW50cy5wdXNoKHRoaXMuY29udmVydFRvUG9pbnQoY29vcmRpbmF0ZSkpO31cbnJldHVybiBuZXcgT3BlbkxheWVycy5HZW9tZXRyeS5MaW5lYXJSaW5nKHBvaW50cyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb1BvbHlnb249ZnVuY3Rpb24ocG9seWdvbil7dmFyIGk7dmFyIHJpbmdzPVtdO3JpbmdzLnB1c2godGhpcy5jb252ZXJ0VG9MaW5lYXJSaW5nKHBvbHlnb24uc2hlbGwpKTtmb3IoaT0wO2k8cG9seWdvbi5ob2xlcy5sZW5ndGg7aSsrKXt2YXIgcmluZz1wb2x5Z29uLmhvbGVzW2ldO3JpbmdzLnB1c2godGhpcy5jb252ZXJ0VG9MaW5lYXJSaW5nKHJpbmcpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuUG9seWdvbihyaW5ncyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb011bHRpUG9pbnQ9ZnVuY3Rpb24obXVsdGlQb2ludCl7dmFyIGk7dmFyIHBvaW50cz1bXTtmb3IoaT0wO2k8bXVsdGlQb2ludC5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe3ZhciBjb29yZGluYXRlPW11bHRpUG9pbnQuZ2VvbWV0cmllc1tpXS5jb29yZGluYXRlO3BvaW50cy5wdXNoKG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5LlBvaW50KGNvb3JkaW5hdGUueCxjb29yZGluYXRlLnkpKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2ludChwb2ludHMpO307anN0cy5pby5PcGVuTGF5ZXJzUGFyc2VyLnByb3RvdHlwZS5jb252ZXJ0VG9NdWx0aUxpbmVTdHJpbmc9ZnVuY3Rpb24obXVsdGlMaW5lU3RyaW5nKXt2YXIgaTt2YXIgbGluZVN0cmluZ3M9W107Zm9yKGk9MDtpPG11bHRpTGluZVN0cmluZy5nZW9tZXRyaWVzLmxlbmd0aDtpKyspe2xpbmVTdHJpbmdzLnB1c2godGhpcy5jb252ZXJ0VG9MaW5lU3RyaW5nKG11bHRpTGluZVN0cmluZy5nZW9tZXRyaWVzW2ldKSk7fVxucmV0dXJuIG5ldyBPcGVuTGF5ZXJzLkdlb21ldHJ5Lk11bHRpTGluZVN0cmluZyhsaW5lU3RyaW5ncyk7fTtqc3RzLmlvLk9wZW5MYXllcnNQYXJzZXIucHJvdG90eXBlLmNvbnZlcnRUb011bHRpUG9seWdvbj1mdW5jdGlvbihtdWx0aVBvbHlnb24pe3ZhciBpO3ZhciBwb2x5Z29ucz1bXTtmb3IoaT0wO2k8bXVsdGlQb2x5Z29uLmdlb21ldHJpZXMubGVuZ3RoO2krKyl7cG9seWdvbnMucHVzaCh0aGlzLmNvbnZlcnRUb1BvbHlnb24obXVsdGlQb2x5Z29uLmdlb21ldHJpZXNbaV0pKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuTXVsdGlQb2x5Z29uKHBvbHlnb25zKTt9O2pzdHMuaW8uT3BlbkxheWVyc1BhcnNlci5wcm90b3R5cGUuY29udmVydFRvQ29sbGVjdGlvbj1mdW5jdGlvbihnZW9tZXRyeUNvbGxlY3Rpb24pe3ZhciBpO3ZhciBnZW9tZXRyaWVzPVtdO2ZvcihpPTA7aTxnZW9tZXRyeUNvbGxlY3Rpb24uZ2VvbWV0cmllcy5sZW5ndGg7aSsrKXt2YXIgZ2VvbWV0cnk9Z2VvbWV0cnlDb2xsZWN0aW9uLmdlb21ldHJpZXNbaV07dmFyIGdlb21ldHJ5T3BlbkxheWVycz10aGlzLndyaXRlKGdlb21ldHJ5KTtnZW9tZXRyaWVzLnB1c2goZ2VvbWV0cnlPcGVuTGF5ZXJzKTt9XG5yZXR1cm4gbmV3IE9wZW5MYXllcnMuR2VvbWV0cnkuQ29sbGVjdGlvbihnZW9tZXRyaWVzKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWU9ZnVuY3Rpb24oKXt0aGlzLnJvb3Q9bmV3IGpzdHMuaW5kZXgucXVhZHRyZWUuUm9vdCgpO3RoaXMubWluRXh0ZW50PTEuMDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUuZW5zdXJlRXh0ZW50PWZ1bmN0aW9uKGl0ZW1FbnYsbWluRXh0ZW50KXt2YXIgbWlueCxtYXh4LG1pbnksbWF4eTttaW54PWl0ZW1FbnYuZ2V0TWluWCgpO21heHg9aXRlbUVudi5nZXRNYXhYKCk7bWlueT1pdGVtRW52LmdldE1pblkoKTttYXh5PWl0ZW1FbnYuZ2V0TWF4WSgpO2lmKG1pbnghPT1tYXh4JiZtaW55IT09bWF4eSl7cmV0dXJuIGl0ZW1FbnY7fVxuaWYobWlueD09PW1heHgpe21pbng9bWlueC0obWluRXh0ZW50LzIuMCk7bWF4eD1taW54KyhtaW5FeHRlbnQvMi4wKTt9XG5pZihtaW55PT09bWF4eSl7bWlueT1taW55LShtaW5FeHRlbnQvMi4wKTttYXh5PW1pbnkrKG1pbkV4dGVudC8yLjApO31cbnJldHVybiBuZXcganN0cy5nZW9tLkVudmVsb3BlKG1pbngsbWF4eCxtaW55LG1heHkpO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yb290LmRlcHRoKCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucm9vdC5zaXplKCk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24oaXRlbUVudixpdGVtKXt0aGlzLmNvbGxlY3RTdGF0cyhpdGVtRW52KTt2YXIgaW5zZXJ0RW52PWpzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUuZW5zdXJlRXh0ZW50KGl0ZW1FbnYsdGhpcy5taW5FeHRlbnQpO3RoaXMucm9vdC5pbnNlcnQoaW5zZXJ0RW52LGl0ZW0pO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1FbnYsaXRlbSl7dmFyIHBvc0Vudj1qc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLmVuc3VyZUV4dGVudChpdGVtRW52LHRoaXMubWluRXh0ZW50KTtyZXR1cm4gdGhpcy5yb290LnJlbW92ZShwb3NFbnYsaXRlbSk7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4ganN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUucXVlcnlCeUVudmVsb3BlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9ZWxzZXtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeVdpdGhWaXNpdG9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeUJ5RW52ZWxvcGU9ZnVuY3Rpb24oc2VhcmNoRW52KXt2YXIgdmlzaXRvcj1uZXcganN0cy5pbmRleC5BcnJheUxpc3RWaXNpdG9yKCk7dGhpcy5xdWVyeShzZWFyY2hFbnYsdmlzaXRvcik7cmV0dXJuIHZpc2l0b3IuZ2V0SXRlbXMoKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuUXVhZHRyZWUucHJvdG90eXBlLnF1ZXJ5V2l0aFZpc2l0b3I9ZnVuY3Rpb24oc2VhcmNoRW52LHZpc2l0b3Ipe3RoaXMucm9vdC52aXNpdChzZWFyY2hFbnYsdmlzaXRvcik7fTtqc3RzLmluZGV4LnF1YWR0cmVlLlF1YWR0cmVlLnByb3RvdHlwZS5xdWVyeUFsbD1mdW5jdGlvbigpe3ZhciBmb3VuZEl0ZW1zPVtdO2ZvdW5kSXRlbXM9dGhpcy5yb290LmFkZEFsbEl0ZW1zKGZvdW5kSXRlbXMpO3JldHVybiBmb3VuZEl0ZW1zO307anN0cy5pbmRleC5xdWFkdHJlZS5RdWFkdHJlZS5wcm90b3R5cGUuY29sbGVjdFN0YXRzPWZ1bmN0aW9uKGl0ZW1FbnYpe3ZhciBkZWxYPWl0ZW1FbnYuZ2V0V2lkdGgoKTtpZihkZWxYPHRoaXMubWluRXh0ZW50JiZkZWxYPjAuMCl7dGhpcy5taW5FeHRlbnQ9ZGVsWDt9XG52YXIgZGVsWT1pdGVtRW52LmdldEhlaWdodCgpO2lmKGRlbFk8dGhpcy5taW5FeHRlbnQmJmRlbFk+MC4wKXt0aGlzLm1pbkV4dGVudD1kZWxZO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVOb2RlRmFjdG9yeT1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGVGYWN0b3J5LnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguTm9kZUZhY3RvcnkoKTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlTm9kZUZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZU5vZGU9ZnVuY3Rpb24oY29vcmQpe3JldHVybiBuZXcganN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU5vZGUoY29vcmQsbmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlU3RhcigpKTt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5PWZ1bmN0aW9uKGl0ZW1FbnYpe3RoaXMucHQ9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCk7dGhpcy5sZXZlbD0wO3RoaXMuZW52PW51bGw7dGhpcy5jb21wdXRlS2V5KGl0ZW1FbnYpO307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkuY29tcHV0ZVF1YWRMZXZlbD1mdW5jdGlvbihlbnYpe3ZhciBkeCxkeSxkTWF4LGxldmVsO2R4PWVudi5nZXRXaWR0aCgpO2R5PWVudi5nZXRIZWlnaHQoKTtkTWF4PWR4PmR5P2R4OmR5O2xldmVsPWpzdHMuaW5kZXguRG91YmxlQml0cy5leHBvbmVudChkTWF4KSsxO3JldHVybiBsZXZlbDt9O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB0O307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGV2ZWw7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbnY7fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuZ2V0Q2VudHJlPWZ1bmN0aW9uKCl7dmFyIHgseTt4PSh0aGlzLmVudi5nZXRNaW5YKCkrdGhpcy5lbnYuZ2V0TWF4WCgpKS8yO3k9KHRoaXMuZW52LmdldE1pblkoKSt0aGlzLmVudi5nZXRNYXhZKCkpLzI7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO307anN0cy5pbmRleC5xdWFkdHJlZS5LZXkucHJvdG90eXBlLmNvbXB1dGVLZXk9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIGpzdHMuZ2VvbS5FbnZlbG9wZSl7dGhpcy5jb21wdXRlS2V5RnJvbUVudmVsb3BlKGFyZ3VtZW50c1swXSk7fWVsc2V7dGhpcy5jb21wdXRlS2V5RnJvbUxldmVsKGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuaW5kZXgucXVhZHRyZWUuS2V5LnByb3RvdHlwZS5jb21wdXRlS2V5RnJvbUVudmVsb3BlPWZ1bmN0aW9uKGVudil7dGhpcy5sZXZlbD1qc3RzLmluZGV4LnF1YWR0cmVlLktleS5jb21wdXRlUXVhZExldmVsKGVudik7dGhpcy5lbnY9bmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSgpO3RoaXMuY29tcHV0ZUtleSh0aGlzLmxldmVsLGVudik7d2hpbGUoIXRoaXMuZW52LmNvbnRhaW5zKGVudikpe3RoaXMubGV2ZWwrPTE7dGhpcy5jb21wdXRlS2V5KHRoaXMubGV2ZWwsZW52KTt9fTtqc3RzLmluZGV4LnF1YWR0cmVlLktleS5wcm90b3R5cGUuY29tcHV0ZUtleUZyb21MZXZlbD1mdW5jdGlvbihsZXZlbCxlbnYpe3ZhciBxdWFkU2l6ZT1qc3RzLmluZGV4LkRvdWJsZUJpdHMucG93ZXJPZjIobGV2ZWwpO3RoaXMucHQueD1NYXRoLmZsb29yKGVudi5nZXRNaW5YKCkvcXVhZFNpemUpKnF1YWRTaXplO3RoaXMucHQueT1NYXRoLmZsb29yKGVudi5nZXRNaW5ZKCkvcXVhZFNpemUpKnF1YWRTaXplO3RoaXMuZW52LmluaXQodGhpcy5wdC54LHRoaXMucHQueCtxdWFkU2l6ZSx0aGlzLnB0LnksdGhpcy5wdC55K1xucXVhZFNpemUpO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcganN0cy5lcnJvci5BYnN0cmFjdE1ldGhvZEludm9jYXRpb25FcnJvcigpO307anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXA9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7cmV0dXJuIGpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwMShhcmd1bWVudHNbMF0pO31lbHNlIGlmKGFyZ3VtZW50cy5sZW5ndGg9PT01KXtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcDIoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0sYXJndW1lbnRzWzNdLGFyZ3VtZW50c1s0XSk7fX07anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMuY29weURlZXAxPWZ1bmN0aW9uKGNvb3JkaW5hdGVzKXt2YXIgY29weT1bXTtmb3IodmFyIGk9MDtpPGNvb3JkaW5hdGVzLmxlbmd0aDtpKyspe2NvcHlbaV09bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKGNvb3JkaW5hdGVzW2ldKTt9XG5yZXR1cm4gY29weTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmNvcHlEZWVwMj1mdW5jdGlvbihzcmMsc3JjU3RhcnQsZGVzdCxkZXN0U3RhcnQsbGVuZ3RoKXtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe2Rlc3RbZGVzdFN0YXJ0K2ldPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShzcmNbc3JjU3RhcnQraV0pO319O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzPWZ1bmN0aW9uKGNvb3JkKXt2YXIgY29vcmRMaXN0O2lmKCF0aGlzLmhhc1JlcGVhdGVkUG9pbnRzKGNvb3JkKSl7cmV0dXJuIGNvb3JkO31cbmNvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KGNvb3JkLGZhbHNlKTtyZXR1cm4gY29vcmRMaXN0LnRvQ29vcmRpbmF0ZUFycmF5KCk7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5oYXNSZXBlYXRlZFBvaW50cz1mdW5jdGlvbihjb29yZCl7dmFyIGk7Zm9yKGk9MTtpPGNvb3JkLmxlbmd0aDtpKyspe2lmKGNvb3JkW2ktMV0uZXF1YWxzKGNvb3JkW2ldKSl7cmV0dXJuIHRydWU7fX1cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnB0Tm90SW5MaXN0PWZ1bmN0aW9uKHRlc3RQdHMscHRzKXtmb3IodmFyIGk9MDtpPHRlc3RQdHMubGVuZ3RoO2krKyl7dmFyIHRlc3RQdD10ZXN0UHRzW2ldO2lmKGpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmluZGV4T2YodGVzdFB0LHB0cyk8MClcbnJldHVybiB0ZXN0UHQ7fVxucmV0dXJuIG51bGw7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmNyZWFzaW5nRGlyZWN0aW9uPWZ1bmN0aW9uKHB0cyl7Zm9yKHZhciBpPTA7aTxwYXJzZUludChwdHMubGVuZ3RoLzIpO2krKyl7dmFyIGo9cHRzLmxlbmd0aC0xLWk7dmFyIGNvbXA9cHRzW2ldLmNvbXBhcmVUbyhwdHNbal0pO2lmKGNvbXAhPTApXG5yZXR1cm4gY29tcDt9XG5yZXR1cm4gMTt9O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLm1pbkNvb3JkaW5hdGU9ZnVuY3Rpb24oY29vcmRpbmF0ZXMpe3ZhciBtaW5Db29yZD1udWxsO2Zvcih2YXIgaT0wO2k8Y29vcmRpbmF0ZXMubGVuZ3RoO2krKyl7aWYobWluQ29vcmQ9PT1udWxsfHxtaW5Db29yZC5jb21wYXJlVG8oY29vcmRpbmF0ZXNbaV0pPjApe21pbkNvb3JkPWNvb3JkaW5hdGVzW2ldO319XG5yZXR1cm4gbWluQ29vcmQ7fTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5zY3JvbGw9ZnVuY3Rpb24oY29vcmRpbmF0ZXMsZmlyc3RDb29yZGluYXRlKXt2YXIgaT1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmRleE9mKGZpcnN0Q29vcmRpbmF0ZSxjb29yZGluYXRlcyk7aWYoaTwwKVxucmV0dXJuO3ZhciBuZXdDb29yZGluYXRlcz1jb29yZGluYXRlcy5zbGljZShpKS5jb25jYXQoY29vcmRpbmF0ZXMuc2xpY2UoMCxpKSk7Zm9yKGk9MDtpPG5ld0Nvb3JkaW5hdGVzLmxlbmd0aDtpKyspe2Nvb3JkaW5hdGVzW2ldPW5ld0Nvb3JkaW5hdGVzW2ldO319O2pzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLmluZGV4T2Y9ZnVuY3Rpb24oY29vcmRpbmF0ZSxjb29yZGluYXRlcyl7Zm9yKHZhciBpPTA7aTxjb29yZGluYXRlcy5sZW5ndGg7aSsrKXtpZihjb29yZGluYXRlLmVxdWFscyhjb29yZGluYXRlc1tpXSkpe3JldHVybiBpO319XG5yZXR1cm4tMTt9O2pzdHMub3BlcmF0aW9uLm92ZXJsYXkuTWluaW1hbEVkZ2VSaW5nPWZ1bmN0aW9uKHN0YXJ0LGdlb21ldHJ5RmFjdG9yeSl7anN0cy5nZW9tZ3JhcGguRWRnZVJpbmcuY2FsbCh0aGlzLHN0YXJ0LGdlb21ldHJ5RmFjdG9yeSk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1pbmltYWxFZGdlUmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLkVkZ2VSaW5nKCk7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcuY29uc3RydWN0b3I9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmc7anN0cy5vcGVyYXRpb24ub3ZlcmxheS5NaW5pbWFsRWRnZVJpbmcucHJvdG90eXBlLmdldE5leHQ9ZnVuY3Rpb24oZGUpe3JldHVybiBkZS5nZXROZXh0TWluKCk7fTtqc3RzLm9wZXJhdGlvbi5vdmVybGF5Lk1pbmltYWxFZGdlUmluZy5wcm90b3R5cGUuc2V0RWRnZVJpbmc9ZnVuY3Rpb24oZGUsZXIpe2RlLnNldE1pbkVkZ2VSaW5nKGVyKTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlcj1mdW5jdGlvbigpe3RoaXMuc2l0ZUNvb3Jkcz1udWxsO3RoaXMudG9sZXJhbmNlPTAuMDt0aGlzLnN1YmRpdj1udWxsO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmV4dHJhY3RVbmlxdWVDb29yZGluYXRlcz1mdW5jdGlvbihnZW9tKXtpZihnZW9tPT09dW5kZWZpbmVkfHxnZW9tPT09bnVsbCl7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoW10sZmFsc2UpLnRvQXJyYXkoKTt9XG52YXIgY29vcmRzPWdlb20uZ2V0Q29vcmRpbmF0ZXMoKTtyZXR1cm4ganN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZShjb29yZHMpO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZT1mdW5jdGlvbihjb29yZHMpe2Nvb3Jkcy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO30pO3ZhciBjb29yZExpc3Q9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlTGlzdChjb29yZHMsZmFsc2UpO3JldHVybiBjb29yZExpc3QudG9BcnJheSgpO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnRvVmVydGljZXM9ZnVuY3Rpb24oY29vcmRzKXt2YXIgdmVydHM9bmV3IEFycmF5KGNvb3Jkcy5sZW5ndGgpLGk9MCxpbD1jb29yZHMubGVuZ3RoLGNvb3JkO2ZvcihpO2k8aWw7aSsrKXtjb29yZD1jb29yZHNbaV07dmVydHNbaV09bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGNvb3JkKTt9XG5yZXR1cm4gdmVydHM7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIuZW52ZWxvcGU9ZnVuY3Rpb24oY29vcmRzKXt2YXIgZW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUoKSxpPTAsaWw9Y29vcmRzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7ZW52LmV4cGFuZFRvSW5jbHVkZShjb29yZHNbaV0pO31cbnJldHVybiBlbnY7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzPWZ1bmN0aW9uKCl7dmFyIGFyZz1hcmd1bWVudHNbMF07aWYoYXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uQ29vcmRpbmF0ZXx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50fHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2ludHx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmd8fGFyZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nfHxhcmcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8YXJnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7dGhpcy5zZXRTaXRlc0Zyb21HZW9tZXRyeShhcmcpO31lbHNle3RoaXMuc2V0U2l0ZXNGcm9tQ29sbGVjdGlvbihhcmcpO319O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuc2V0U2l0ZXNGcm9tR2VvbWV0cnk9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5zaXRlQ29vcmRzPWpzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5leHRyYWN0VW5pcXVlQ29vcmRpbmF0ZXMoZ2VvbSk7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLnNldFNpdGVzRnJvbUNvbGxlY3Rpb249ZnVuY3Rpb24oY29vcmRzKXt0aGlzLnNpdGVDb29yZHM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnVuaXF1ZShjb29yZHMpO307anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnByb3RvdHlwZS5zZXRUb2xlcmFuY2U9ZnVuY3Rpb24odG9sZXJhbmNlKXt0aGlzLnRvbGVyYW5jZT10b2xlcmFuY2U7fTtqc3RzLnRyaWFuZ3VsYXRlLkRlbGF1bmF5VHJpYW5ndWxhdGlvbkJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZT1mdW5jdGlvbigpe2lmKHRoaXMuc3ViZGl2PT09bnVsbCl7dmFyIHNpdGVFbnYsdmVydGljZXMsdHJpYW5ndWxhdG9yO3NpdGVFbnY9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLmVudmVsb3BlKHRoaXMuc2l0ZUNvb3Jkcyk7dmVydGljZXM9anN0cy50cmlhbmd1bGF0ZS5EZWxhdW5heVRyaWFuZ3VsYXRpb25CdWlsZGVyLnRvVmVydGljZXModGhpcy5zaXRlQ29vcmRzKTt0aGlzLnN1YmRpdj1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uKHNpdGVFbnYsdGhpcy50b2xlcmFuY2UpO3RyaWFuZ3VsYXRvcj1uZXcganN0cy50cmlhbmd1bGF0ZS5JbmNyZW1lbnRhbERlbGF1bmF5VHJpYW5ndWxhdG9yKHRoaXMuc3ViZGl2KTt0cmlhbmd1bGF0b3IuaW5zZXJ0U2l0ZXModmVydGljZXMpO319O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuZ2V0U3ViZGl2aXNpb249ZnVuY3Rpb24oKXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdjt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oZ2VvbUZhY3Qpe3RoaXMuY3JlYXRlKCk7cmV0dXJuIHRoaXMuc3ViZGl2LmdldEVkZ2VzKGdlb21GYWN0KTt9O2pzdHMudHJpYW5ndWxhdGUuRGVsYXVuYXlUcmlhbmd1bGF0aW9uQnVpbGRlci5wcm90b3R5cGUuZ2V0VHJpYW5nbGVzPWZ1bmN0aW9uKGdlb21GYWN0KXt0aGlzLmNyZWF0ZSgpO3JldHVybiB0aGlzLnN1YmRpdi5nZXRUcmlhbmdsZXMoZ2VvbUZhY3QpO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyPWZ1bmN0aW9uKHApe3RoaXMucD1wO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLmxvY2F0ZVBvaW50SW5SaW5nPWZ1bmN0aW9uKHAscmluZyl7dmFyIGNvdW50ZXI9bmV3IGpzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlcihwKTtmb3IodmFyIGk9MTtpPHJpbmcubGVuZ3RoO2krKyl7dmFyIHAxPXJpbmdbaV07dmFyIHAyPXJpbmdbaS0xXTtjb3VudGVyLmNvdW50U2VnbWVudChwMSxwMik7aWYoY291bnRlci5pc09uU2VnbWVudCgpKVxucmV0dXJuIGNvdW50ZXIuZ2V0TG9jYXRpb24oKTt9XG5yZXR1cm4gY291bnRlci5nZXRMb2NhdGlvbigpO307anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5wPW51bGw7anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5jcm9zc2luZ0NvdW50PTA7anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5pc1BvaW50T25TZWdtZW50PWZhbHNlO2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuY291bnRTZWdtZW50PWZ1bmN0aW9uKHAxLHAyKXtpZihwMS54PHRoaXMucC54JiZwMi54PHRoaXMucC54KVxucmV0dXJuO2lmKHRoaXMucC54PT1wMi54JiZ0aGlzLnAueT09PXAyLnkpe3RoaXMuaXNQb2ludE9uU2VnbWVudD10cnVlO3JldHVybjt9XG5pZihwMS55PT09dGhpcy5wLnkmJnAyLnk9PT10aGlzLnAueSl7dmFyIG1pbng9cDEueDt2YXIgbWF4eD1wMi54O2lmKG1pbng+bWF4eCl7bWlueD1wMi54O21heHg9cDEueDt9XG5pZih0aGlzLnAueD49bWlueCYmdGhpcy5wLng8PW1heHgpe3RoaXMuaXNQb2ludE9uU2VnbWVudD10cnVlO31cbnJldHVybjt9XG5pZigoKHAxLnk+dGhpcy5wLnkpJiYocDIueTw9dGhpcy5wLnkpKXx8KChwMi55PnRoaXMucC55KSYmKHAxLnk8PXRoaXMucC55KSkpe3ZhciB4MT1wMS54LXRoaXMucC54O3ZhciB5MT1wMS55LXRoaXMucC55O3ZhciB4Mj1wMi54LXRoaXMucC54O3ZhciB5Mj1wMi55LXRoaXMucC55O3ZhciB4SW50U2lnbj1qc3RzLmFsZ29yaXRobS5Sb2J1c3REZXRlcm1pbmFudC5zaWduT2ZEZXQyeDIoeDEseTEseDIseTIpO2lmKHhJbnRTaWduPT09MC4wKXt0aGlzLmlzUG9pbnRPblNlZ21lbnQ9dHJ1ZTtyZXR1cm47fVxuaWYoeTI8eTEpXG54SW50U2lnbj0teEludFNpZ247aWYoeEludFNpZ24+MC4wKXt0aGlzLmNyb3NzaW5nQ291bnQrKzt9fX07anN0cy5hbGdvcml0aG0uUmF5Q3Jvc3NpbmdDb3VudGVyLnByb3RvdHlwZS5pc09uU2VnbWVudD1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uaXNQb2ludE9uU2VnbWVudDt9O2pzdHMuYWxnb3JpdGhtLlJheUNyb3NzaW5nQ291bnRlci5wcm90b3R5cGUuZ2V0TG9jYXRpb249ZnVuY3Rpb24oKXtpZih0aGlzLmlzUG9pbnRPblNlZ21lbnQpXG5yZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZO2lmKCh0aGlzLmNyb3NzaW5nQ291bnQlMik9PT0xKXtyZXR1cm4ganN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SO31cbnJldHVybiBqc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1I7fTtqc3RzLmFsZ29yaXRobS5SYXlDcm9zc2luZ0NvdW50ZXIucHJvdG90eXBlLmlzUG9pbnRJblBvbHlnb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRMb2NhdGlvbigpIT09anN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcD1mdW5jdGlvbihnZW9tLGJuUnVsZSl7dGhpcy5nZW9tPWdlb207dGhpcy5nZW9tRmFjdD1nZW9tLmdldEZhY3RvcnkoKTt0aGlzLmJuUnVsZT1iblJ1bGV8fGpzdHMuYWxnb3JpdGhtLkJvdW5kYXJ5Tm9kZVJ1bGUuTU9EMl9CT1VOREFSWV9SVUxFO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZ2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmdlb21GYWN0PW51bGw7anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuYm5SdWxlPW51bGw7anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXtpZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylyZXR1cm4gdGhpcy5ib3VuZGFyeUxpbmVTdHJpbmcodGhpcy5nZW9tKTtpZih0aGlzLmdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nKXJldHVybiB0aGlzLmJvdW5kYXJ5TXVsdGlMaW5lU3RyaW5nKHRoaXMuZ2VvbSk7cmV0dXJuIHRoaXMuZ2VvbS5nZXRCb3VuZGFyeSgpO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZ2V0RW1wdHlNdWx0aVBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2VvbUZhY3QuY3JlYXRlTXVsdGlQb2ludChudWxsKTt9O2pzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AucHJvdG90eXBlLmJvdW5kYXJ5TXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKG1MaW5lKXtpZih0aGlzLmdlb20uaXNFbXB0eSgpKXtyZXR1cm4gdGhpcy5nZXRFbXB0eU11bHRpUG9pbnQoKTt9XG52YXIgYmR5UHRzPXRoaXMuY29tcHV0ZUJvdW5kYXJ5Q29vcmRpbmF0ZXMobUxpbmUpO2lmKGJkeVB0cy5sZW5ndGg9PTEpe3JldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZVBvaW50KGJkeVB0c1swXSk7fVxucmV0dXJuIHRoaXMuZ2VvbUZhY3QuY3JlYXRlTXVsdGlQb2ludChiZHlQdHMpO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuZW5kcG9pbnRzPW51bGw7anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuY29tcHV0ZUJvdW5kYXJ5Q29vcmRpbmF0ZXM9ZnVuY3Rpb24obUxpbmUpe3ZhciBpLGxpbmUsZW5kcG9pbnQsYmR5UHRzPVtdO3RoaXMuZW5kcG9pbnRzPVtdO2ZvcihpPTA7aTxtTGluZS5nZXROdW1HZW9tZXRyaWVzKCk7aSsrKXtsaW5lPW1MaW5lLmdldEdlb21ldHJ5TihpKTtpZihsaW5lLmdldE51bVBvaW50cygpPT0wKVxuY29udGludWU7dGhpcy5hZGRFbmRwb2ludChsaW5lLmdldENvb3JkaW5hdGVOKDApKTt0aGlzLmFkZEVuZHBvaW50KGxpbmUuZ2V0Q29vcmRpbmF0ZU4obGluZS5nZXROdW1Qb2ludHMoKS0xKSk7fVxuZm9yKGk9MDtpPHRoaXMuZW5kcG9pbnRzLmxlbmd0aDtpKyspe2VuZHBvaW50PXRoaXMuZW5kcG9pbnRzW2ldO2lmKHRoaXMuYm5SdWxlLmlzSW5Cb3VuZGFyeShlbmRwb2ludC5jb3VudCkpe2JkeVB0cy5wdXNoKGVuZHBvaW50LmNvb3JkaW5hdGUpO319XG5yZXR1cm4gYmR5UHRzO307anN0cy5vcGVyYXRpb24uQm91bmRhcnlPcC5wcm90b3R5cGUuYWRkRW5kcG9pbnQ9ZnVuY3Rpb24ocHQpe3ZhciBpLGVuZHBvaW50LGZvdW5kPWZhbHNlO2ZvcihpPTA7aTx0aGlzLmVuZHBvaW50cy5sZW5ndGg7aSsrKXtlbmRwb2ludD10aGlzLmVuZHBvaW50c1tpXTtpZihlbmRwb2ludC5jb29yZGluYXRlLmVxdWFscyhwdCkpe2ZvdW5kPXRydWU7YnJlYWs7fX1cbmlmKCFmb3VuZCl7ZW5kcG9pbnQ9e307ZW5kcG9pbnQuY29vcmRpbmF0ZT1wdDtlbmRwb2ludC5jb3VudD0wO3RoaXMuZW5kcG9pbnRzLnB1c2goZW5kcG9pbnQpO31cbmVuZHBvaW50LmNvdW50Kys7fTtqc3RzLm9wZXJhdGlvbi5Cb3VuZGFyeU9wLnByb3RvdHlwZS5ib3VuZGFyeUxpbmVTdHJpbmc9ZnVuY3Rpb24obGluZSl7aWYodGhpcy5nZW9tLmlzRW1wdHkoKSl7cmV0dXJuIHRoaXMuZ2V0RW1wdHlNdWx0aVBvaW50KCk7fVxuaWYobGluZS5pc0Nsb3NlZCgpKXt2YXIgY2xvc2VkRW5kcG9pbnRPbkJvdW5kYXJ5PXRoaXMuYm5SdWxlLmlzSW5Cb3VuZGFyeSgyKTtpZihjbG9zZWRFbmRwb2ludE9uQm91bmRhcnkpe3JldHVybiBsaW5lLmdldFN0YXJ0UG9pbnQoKTt9XG5lbHNle3JldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQobnVsbCk7fX1cbnJldHVybiB0aGlzLmdlb21GYWN0LmNyZWF0ZU11bHRpUG9pbnQoW2xpbmUuZ2V0U3RhcnRQb2ludCgpLGxpbmUuZ2V0RW5kUG9pbnQoKV0pO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlcj1mdW5jdGlvbihpbnB1dEdlb20sZGlzdGFuY2UsY3VydmVCdWlsZGVyKXt0aGlzLmlucHV0R2VvbT1pbnB1dEdlb207dGhpcy5kaXN0YW5jZT1kaXN0YW5jZTt0aGlzLmN1cnZlQnVpbGRlcj1jdXJ2ZUJ1aWxkZXI7dGhpcy5jdXJ2ZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmlucHV0R2VvbT1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmRpc3RhbmNlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuY3VydmVCdWlsZGVyPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuY3VydmVMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuZ2V0Q3VydmVzPWZ1bmN0aW9uKCl7dGhpcy5hZGQodGhpcy5pbnB1dEdlb20pO3JldHVybiB0aGlzLmN1cnZlTGlzdDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmFkZEN1cnZlPWZ1bmN0aW9uKGNvb3JkLGxlZnRMb2MscmlnaHRMb2Mpe2lmKGNvb3JkPT1udWxsfHxjb29yZC5sZW5ndGg8MilcbnJldHVybjt2YXIgZT1uZXcganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKGNvb3JkLG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbCgwLGpzdHMuZ2VvbS5Mb2NhdGlvbi5CT1VOREFSWSxsZWZ0TG9jLHJpZ2h0TG9jKSk7dGhpcy5jdXJ2ZUxpc3QuYWRkKGUpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGcpe2lmKGcuaXNFbXB0eSgpKVxucmV0dXJuO2lmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbilcbnRoaXMuYWRkUG9seWdvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTGluZVN0cmluZylcbnRoaXMuYWRkTGluZVN0cmluZyhnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9pbnQpXG50aGlzLmFkZFBvaW50KGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvaW50KVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcpXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbilcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2VcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRDb2xsZWN0aW9uPWZ1bmN0aW9uKGdjKXtmb3IodmFyIGk9MDtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe3ZhciBnPWdjLmdldEdlb21ldHJ5TihpKTt0aGlzLmFkZChnKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRQb2ludD1mdW5jdGlvbihwKXtpZih0aGlzLmRpc3RhbmNlPD0wLjApXG5yZXR1cm47dmFyIGNvb3JkPXAuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgY3VydmU9dGhpcy5jdXJ2ZUJ1aWxkZXIuZ2V0TGluZUN1cnZlKGNvb3JkLHRoaXMuZGlzdGFuY2UpO3RoaXMuYWRkQ3VydmUoY3VydmUsanN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SLGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUik7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRMaW5lU3RyaW5nPWZ1bmN0aW9uKGxpbmUpe2lmKHRoaXMuZGlzdGFuY2U8PTAuMCYmIXRoaXMuY3VydmVCdWlsZGVyLmdldEJ1ZmZlclBhcmFtZXRlcnMoKS5pc1NpbmdsZVNpZGVkKCkpXG5yZXR1cm47dmFyIGNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxpbmUuZ2V0Q29vcmRpbmF0ZXMoKSk7dmFyIGN1cnZlPXRoaXMuY3VydmVCdWlsZGVyLmdldExpbmVDdXJ2ZShjb29yZCx0aGlzLmRpc3RhbmNlKTt0aGlzLmFkZEN1cnZlKGN1cnZlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUixqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlci5wcm90b3R5cGUuYWRkUG9seWdvbj1mdW5jdGlvbihwKXt2YXIgb2Zmc2V0RGlzdGFuY2U9dGhpcy5kaXN0YW5jZTt2YXIgb2Zmc2V0U2lkZT1qc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUO2lmKHRoaXMuZGlzdGFuY2U8MC4wKXtvZmZzZXREaXN0YW5jZT0tdGhpcy5kaXN0YW5jZTtvZmZzZXRTaWRlPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hUO31cbnZhciBzaGVsbD1wLmdldEV4dGVyaW9yUmluZygpO3ZhciBzaGVsbENvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKHNoZWxsLmdldENvb3JkaW5hdGVzKCkpO2lmKHRoaXMuZGlzdGFuY2U8MC4wJiZ0aGlzLmlzRXJvZGVkQ29tcGxldGVseShzaGVsbCx0aGlzLmRpc3RhbmNlKSlcbnJldHVybjtpZih0aGlzLmRpc3RhbmNlPD0wLjAmJnNoZWxsQ29vcmQubGVuZ3RoPDMpXG5yZXR1cm47dGhpcy5hZGRQb2x5Z29uUmluZyhzaGVsbENvb3JkLG9mZnNldERpc3RhbmNlLG9mZnNldFNpZGUsanN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SLGpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUik7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO3ZhciBob2xlQ29vcmQ9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMucmVtb3ZlUmVwZWF0ZWRQb2ludHMoaG9sZS5nZXRDb29yZGluYXRlcygpKTtpZih0aGlzLmRpc3RhbmNlPjAuMCYmdGhpcy5pc0Vyb2RlZENvbXBsZXRlbHkoaG9sZSwtdGhpcy5kaXN0YW5jZSkpXG5jb250aW51ZTt0aGlzLmFkZFBvbHlnb25SaW5nKGhvbGVDb29yZCxvZmZzZXREaXN0YW5jZSxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5vcHBvc2l0ZShvZmZzZXRTaWRlKSxqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IsanN0cy5nZW9tLkxvY2F0aW9uLkVYVEVSSU9SKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5hZGRQb2x5Z29uUmluZz1mdW5jdGlvbihjb29yZCxvZmZzZXREaXN0YW5jZSxzaWRlLGN3TGVmdExvYyxjd1JpZ2h0TG9jKXtpZihvZmZzZXREaXN0YW5jZT09MC4wJiZjb29yZC5sZW5ndGg8anN0cy5nZW9tLkxpbmVhclJpbmcuTUlOSU1VTV9WQUxJRF9TSVpFKVxucmV0dXJuO3ZhciBsZWZ0TG9jPWN3TGVmdExvYzt2YXIgcmlnaHRMb2M9Y3dSaWdodExvYztpZihjb29yZC5sZW5ndGg+PWpzdHMuZ2VvbS5MaW5lYXJSaW5nLk1JTklNVU1fVkFMSURfU0laRSYmanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKGNvb3JkKSl7bGVmdExvYz1jd1JpZ2h0TG9jO3JpZ2h0TG9jPWN3TGVmdExvYztzaWRlPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLm9wcG9zaXRlKHNpZGUpO31cbnZhciBjdXJ2ZT10aGlzLmN1cnZlQnVpbGRlci5nZXRSaW5nQ3VydmUoY29vcmQsc2lkZSxvZmZzZXREaXN0YW5jZSk7dGhpcy5hZGRDdXJ2ZShjdXJ2ZSxsZWZ0TG9jLHJpZ2h0TG9jKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRDdXJ2ZVNldEJ1aWxkZXIucHJvdG90eXBlLmlzRXJvZGVkQ29tcGxldGVseT1mdW5jdGlvbihyaW5nLGJ1ZmZlckRpc3RhbmNlKXt2YXIgcmluZ0Nvb3JkPXJpbmcuZ2V0Q29vcmRpbmF0ZXMoKTt2YXIgbWluRGlhbT0wLjA7aWYocmluZ0Nvb3JkLmxlbmd0aDw0KVxucmV0dXJuIGJ1ZmZlckRpc3RhbmNlPDA7aWYocmluZ0Nvb3JkLmxlbmd0aD09NClcbnJldHVybiB0aGlzLmlzVHJpYW5nbGVFcm9kZWRDb21wbGV0ZWx5KHJpbmdDb29yZCxidWZmZXJEaXN0YW5jZSk7dmFyIGVudj1yaW5nLmdldEVudmVsb3BlSW50ZXJuYWwoKTt2YXIgZW52TWluRGltZW5zaW9uPU1hdGgubWluKGVudi5nZXRIZWlnaHQoKSxlbnYuZ2V0V2lkdGgoKSk7aWYoYnVmZmVyRGlzdGFuY2U8MC4wJiYyKk1hdGguYWJzKGJ1ZmZlckRpc3RhbmNlKT5lbnZNaW5EaW1lbnNpb24pXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0Q3VydmVTZXRCdWlsZGVyLnByb3RvdHlwZS5pc1RyaWFuZ2xlRXJvZGVkQ29tcGxldGVseT1mdW5jdGlvbih0cmlhbmdsZUNvb3JkLGJ1ZmZlckRpc3RhbmNlKXt2YXIgdHJpPW5ldyBqc3RzLmdlb20uVHJpYW5nbGUodHJpYW5nbGVDb29yZFswXSx0cmlhbmdsZUNvb3JkWzFdLHRyaWFuZ2xlQ29vcmRbMl0pO3ZhciBpbkNlbnRyZT10cmkuaW5DZW50cmUoKTt2YXIgZGlzdFRvQ2VudHJlPWpzdHMuYWxnb3JpdGhtLkNHQWxnb3JpdGhtcy5kaXN0YW5jZVBvaW50TGluZShpbkNlbnRyZSx0cmkucDAsdHJpLnAxKTtyZXR1cm4gZGlzdFRvQ2VudHJlPE1hdGguYWJzKGJ1ZmZlckRpc3RhbmNlKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaD1mdW5jdGlvbigpe3RoaXMuZGlyRWRnZUxpc3Q9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLm5vZGVzPW5ldyBqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0KCk7dGhpcy5maW5kZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5SaWdodG1vc3RFZGdlRmluZGVyKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmZpbmRlcj1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZGlyRWRnZUxpc3Q9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLm5vZGVzPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5yaWdodE1vc3RDb29yZD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuZW52PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXREaXJlY3RlZEVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlyRWRnZUxpc3Q7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmdldE5vZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZXM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmdldEVudmVsb3BlPWZ1bmN0aW9uKCl7aWYodGhpcy5lbnY9PT1udWxsKXt2YXIgZWRnZUVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKCk7Zm9yKHZhciBpdD10aGlzLmRpckVkZ2VMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRpckVkZ2U9aXQubmV4dCgpO3ZhciBwdHM9ZGlyRWRnZS5nZXRFZGdlKCkuZ2V0Q29vcmRpbmF0ZXMoKTtmb3IodmFyIGo9MDtqPHB0cy5sZW5ndGgtMTtqKyspe2VkZ2VFbnYuZXhwYW5kVG9JbmNsdWRlKHB0c1tqXSk7fX1cbnRoaXMuZW52PWVkZ2VFbnY7fVxucmV0dXJuIHRoaXMuZW52O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5nZXRSaWdodG1vc3RDb29yZGluYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmlnaHRNb3N0Q29vcmQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNyZWF0ZT1mdW5jdGlvbihub2RlKXt0aGlzLmFkZFJlYWNoYWJsZShub2RlKTt0aGlzLmZpbmRlci5maW5kRWRnZSh0aGlzLmRpckVkZ2VMaXN0KTt0aGlzLnJpZ2h0TW9zdENvb3JkPXRoaXMuZmluZGVyLmdldENvb3JkaW5hdGUoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuYWRkUmVhY2hhYmxlPWZ1bmN0aW9uKHN0YXJ0Tm9kZSl7dmFyIG5vZGVTdGFjaz1bXTtub2RlU3RhY2sucHVzaChzdGFydE5vZGUpO3doaWxlKG5vZGVTdGFjay5sZW5ndGghPT0wKXt2YXIgbm9kZT1ub2RlU3RhY2sucG9wKCk7dGhpcy5hZGQobm9kZSxub2RlU3RhY2spO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKG5vZGUsbm9kZVN0YWNrKXtub2RlLnNldFZpc2l0ZWQodHJ1ZSk7dGhpcy5ub2Rlcy5hZGQobm9kZSk7Zm9yKHZhciBpPW5vZGUuZ2V0RWRnZXMoKS5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGRlPWkubmV4dCgpO3RoaXMuZGlyRWRnZUxpc3QuYWRkKGRlKTt2YXIgc3ltPWRlLmdldFN5bSgpO3ZhciBzeW1Ob2RlPXN5bS5nZXROb2RlKCk7aWYoIXN5bU5vZGUuaXNWaXNpdGVkKCkpXG5ub2RlU3RhY2sucHVzaChzeW1Ob2RlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNsZWFyVmlzaXRlZEVkZ2VzPWZ1bmN0aW9uKCl7Zm9yKHZhciBpdD10aGlzLmRpckVkZ2VMaXN0Lml0ZXJhdG9yKCk7aXQuaGFzTmV4dCgpOyl7dmFyIGRlPWl0Lm5leHQoKTtkZS5zZXRWaXNpdGVkKGZhbHNlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmNvbXB1dGVEZXB0aD1mdW5jdGlvbihvdXRzaWRlRGVwdGgpe3RoaXMuY2xlYXJWaXNpdGVkRWRnZXMoKTt2YXIgZGU9dGhpcy5maW5kZXIuZ2V0RWRnZSgpO3ZhciBuPWRlLmdldE5vZGUoKTt2YXIgbGFiZWw9ZGUuZ2V0TGFiZWwoKTtkZS5zZXRFZGdlRGVwdGhzKGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLlJJR0hULG91dHNpZGVEZXB0aCk7dGhpcy5jb3B5U3ltRGVwdGhzKGRlKTt0aGlzLmNvbXB1dGVEZXB0aHMoZGUpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wdXRlRGVwdGhzPWZ1bmN0aW9uKHN0YXJ0RWRnZSl7dmFyIG5vZGVzVmlzaXRlZD1bXTt2YXIgbm9kZVF1ZXVlPVtdO3ZhciBzdGFydE5vZGU9c3RhcnRFZGdlLmdldE5vZGUoKTtub2RlUXVldWUucHVzaChzdGFydE5vZGUpO25vZGVzVmlzaXRlZC5wdXNoKHN0YXJ0Tm9kZSk7c3RhcnRFZGdlLnNldFZpc2l0ZWQodHJ1ZSk7d2hpbGUobm9kZVF1ZXVlLmxlbmd0aCE9PTApe3ZhciBuPW5vZGVRdWV1ZS5zaGlmdCgpO25vZGVzVmlzaXRlZC5wdXNoKG4pO3RoaXMuY29tcHV0ZU5vZGVEZXB0aChuKTtmb3IodmFyIGk9bi5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7dmFyIHN5bT1kZS5nZXRTeW0oKTtpZihzeW0uaXNWaXNpdGVkKCkpXG5jb250aW51ZTt2YXIgYWRqTm9kZT1zeW0uZ2V0Tm9kZSgpO2lmKG5vZGVzVmlzaXRlZC5pbmRleE9mKGFkak5vZGUpPT09LTEpe25vZGVRdWV1ZS5wdXNoKGFkak5vZGUpO25vZGVzVmlzaXRlZC5wdXNoKGFkak5vZGUpO319fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wdXRlTm9kZURlcHRoPWZ1bmN0aW9uKG4pe3ZhciBzdGFydEVkZ2U9bnVsbDtmb3IodmFyIGk9bi5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7aWYoZGUuaXNWaXNpdGVkKCl8fGRlLmdldFN5bSgpLmlzVmlzaXRlZCgpKXtzdGFydEVkZ2U9ZGU7YnJlYWs7fX1cbmlmKHN0YXJ0RWRnZT09bnVsbClcbnRocm93IG5ldyBqc3RzLmVycm9yLlRvcG9sb2d5RXJyb3IoJ3VuYWJsZSB0byBmaW5kIGVkZ2UgdG8gY29tcHV0ZSBkZXB0aHMgYXQgJytuLmdldENvb3JkaW5hdGUoKSk7bi5nZXRFZGdlcygpLmNvbXB1dGVEZXB0aHMoc3RhcnRFZGdlKTtmb3IodmFyIGk9bi5nZXRFZGdlcygpLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZGU9aS5uZXh0KCk7ZGUuc2V0VmlzaXRlZCh0cnVlKTt0aGlzLmNvcHlTeW1EZXB0aHMoZGUpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaC5wcm90b3R5cGUuY29weVN5bURlcHRocz1mdW5jdGlvbihkZSl7dmFyIHN5bT1kZS5nZXRTeW0oKTtzeW0uc2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCxkZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCkpO3N5bS5zZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCxkZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKSk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyU3ViZ3JhcGgucHJvdG90eXBlLmZpbmRSZXN1bHRFZGdlcz1mdW5jdGlvbigpe2Zvcih2YXIgaXQ9dGhpcy5kaXJFZGdlTGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspe3ZhciBkZT1pdC5uZXh0KCk7aWYoZGUuZ2V0RGVwdGgoanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpPj0xJiZkZS5nZXREZXB0aChqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5MRUZUKTw9MCYmIWRlLmlzSW50ZXJpb3JBcmVhRWRnZSgpKXtkZS5zZXRJblJlc3VsdCh0cnVlKTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclN1YmdyYXBoLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24obyl7dmFyIGdyYXBoPW87aWYodGhpcy5yaWdodE1vc3RDb29yZC54PGdyYXBoLnJpZ2h0TW9zdENvb3JkLngpe3JldHVybi0xO31cbmlmKHRoaXMucmlnaHRNb3N0Q29vcmQueD5ncmFwaC5yaWdodE1vc3RDb29yZC54KXtyZXR1cm4gMTt9XG5yZXR1cm4gMDt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lcj1mdW5jdGlvbihkaXN0YW5jZVRvbGVyYW5jZSxpc0Vuc3VyZVZhbGlkVG9wb2xvZ3kpe3RoaXMuZGlzdGFuY2VUb2xlcmFuY2U9ZGlzdGFuY2VUb2xlcmFuY2U7dGhpcy5pc0Vuc3VyZVZhbGlkVG9wb2xvZ3k9aXNFbnN1cmVWYWxpZFRvcG9sb2d5O307anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lcigpO2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUuZGlzdGFuY2VUb2xlcmFuY2U9bnVsbDtqc3RzLnNpbXBsaWZ5LkRQVHJhbnNmb3JtZXIucHJvdG90eXBlLmlzRW5zdXJlVmFsaWRUb3BvbG9neT1udWxsO2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtQ29vcmRpbmF0ZXM9ZnVuY3Rpb24oY29vcmRzLHBhcmVudCl7dmFyIGlucHV0UHRzPWNvb3Jkczt2YXIgbmV3UHRzPW51bGw7aWYoaW5wdXRQdHMubGVuZ3RoPT0wKXtuZXdQdHM9W107fWVsc2V7bmV3UHRzPWpzdHMuc2ltcGxpZnkuRG91Z2xhc1BldWNrZXJMaW5lU2ltcGxpZmllci5zaW1wbGlmeShpbnB1dFB0cyx0aGlzLmRpc3RhbmNlVG9sZXJhbmNlKTt9XG5yZXR1cm4gbmV3UHRzO307anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXtpZihnZW9tLmlzRW1wdHkoKSl7cmV0dXJuIG51bGw7fVxudmFyIHJhd0dlb209anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtUG9seWdvbi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYocGFyZW50IGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7cmV0dXJuIHJhd0dlb207fVxucmV0dXJuIHRoaXMuY3JlYXRlVmFsaWRBcmVhKHJhd0dlb20pO307anN0cy5zaW1wbGlmeS5EUFRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1MaW5lYXJSaW5nPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgcmVtb3ZlRGVnZW5lcmF0ZVJpbmdzPXBhcmVudCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uO3ZhciBzaW1wUmVzdWx0PWpzdHMuZ2VvbS51dGlsLkdlb21ldHJ5VHJhbnNmb3JtZXIucHJvdG90eXBlLnRyYW5zZm9ybUxpbmVhclJpbmcuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKHJlbW92ZURlZ2VuZXJhdGVSaW5ncyYmIShzaW1wUmVzdWx0IGluc3RhbmNlb2YganN0cy5nZW9tLkxpbmVhclJpbmcpKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gc2ltcFJlc3VsdDt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUudHJhbnNmb3JtTXVsdGlQb2x5Z29uPWZ1bmN0aW9uKGdlb20scGFyZW50KXt2YXIgcmF3R2VvbT1qc3RzLmdlb20udXRpbC5HZW9tZXRyeVRyYW5zZm9ybWVyLnByb3RvdHlwZS50cmFuc2Zvcm1NdWx0aVBvbHlnb24uYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0aGlzLmNyZWF0ZVZhbGlkQXJlYShyYXdHZW9tKTt9O2pzdHMuc2ltcGxpZnkuRFBUcmFuc2Zvcm1lci5wcm90b3R5cGUuY3JlYXRlVmFsaWRBcmVhPWZ1bmN0aW9uKHJhd0FyZWFHZW9tKXtpZih0aGlzLmlzRW5zdXJlVmFsaWRUb3BvbG9neSl7cmV0dXJuIHJhd0FyZWFHZW9tLmJ1ZmZlcigwLjApO31cbnJldHVybiByYXdBcmVhR2VvbTt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyPWZ1bmN0aW9uKGNseixjb21wcyl7dGhpcy5jbHo9Y2x6O3RoaXMuY29tcHM9Y29tcHM7fTtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUZpbHRlcigpO2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyLnByb3RvdHlwZS5jbHo9bnVsbDtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5wcm90b3R5cGUuY29tcHM9bnVsbDtqc3RzLmdlb20udXRpbC5HZW9tZXRyeUV4dHJhY3Rlci5leHRyYWN0PWZ1bmN0aW9uKGdlb20sY2x6LGxpc3Qpe2xpc3Q9bGlzdHx8bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtpZihnZW9tIGluc3RhbmNlb2YgY2x6KXtsaXN0LmFkZChnZW9tKTt9XG5lbHNlIGlmKGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9ufHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnR8fGdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nfHxnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbil7Z2VvbS5hcHBseShuZXcganN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXIoY2x6LGxpc3QpKTt9XG5yZXR1cm4gbGlzdDt9O2pzdHMuZ2VvbS51dGlsLkdlb21ldHJ5RXh0cmFjdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7aWYodGhpcy5jbHo9PT1udWxsfHxnZW9tIGluc3RhbmNlb2YgdGhpcy5jbHope3RoaXMuY29tcHMuYWRkKGdlb20pO319OyhmdW5jdGlvbigpe3ZhciBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7dmFyIFNuYXBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBPdmVybGF5T3A7dmFyIFNuYXBJZk5lZWRlZE92ZXJsYXlPcD1mdW5jdGlvbihnMSxnMil7dGhpcy5nZW9tPVtdO3RoaXMuZ2VvbVswXT1nMTt0aGlzLmdlb21bMV09ZzI7fTtTbmFwSWZOZWVkZWRPdmVybGF5T3Aub3ZlcmxheU9wPWZ1bmN0aW9uKGcwLGcxLG9wQ29kZSl7dmFyIG9wPW5ldyBTbmFwSWZOZWVkZWRPdmVybGF5T3AoZzAsZzEpO3JldHVybiBvcC5nZXRSZXN1bHRHZW9tZXRyeShvcENvZGUpO307U25hcElmTmVlZGVkT3ZlcmxheU9wLmludGVyc2VjdGlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIG92ZXJsYXlPcChnMCxnMSxPdmVybGF5T3AuSU5URVJTRUNUSU9OKTt9O1NuYXBJZk5lZWRlZE92ZXJsYXlPcC51bmlvbj1mdW5jdGlvbihnMCxnMSl7cmV0dXJuIG92ZXJsYXlPcChnMCxnMSxPdmVybGF5T3AuVU5JT04pO307U25hcElmTmVlZGVkT3ZlcmxheU9wLmRpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLkRJRkZFUkVOQ0UpO307U25hcElmTmVlZGVkT3ZlcmxheU9wLnN5bURpZmZlcmVuY2U9ZnVuY3Rpb24oZzAsZzEpe3JldHVybiBvdmVybGF5T3AoZzAsZzEsT3ZlcmxheU9wLlNZTURJRkZFUkVOQ0UpO307U25hcElmTmVlZGVkT3ZlcmxheU9wLnByb3RvdHlwZS5nZW9tPW51bGw7U25hcElmTmVlZGVkT3ZlcmxheU9wLnByb3RvdHlwZS5nZXRSZXN1bHRHZW9tZXRyeT1mdW5jdGlvbihvcENvZGUpe3ZhciByZXN1bHQ9bnVsbDt2YXIgaXNTdWNjZXNzPWZhbHNlO3ZhciBzYXZlZEV4Y2VwdGlvbj1udWxsO3RyeXtyZXN1bHQ9T3ZlcmxheU9wLm92ZXJsYXlPcCh0aGlzLmdlb21bMF0sdGhpcy5nZW9tWzFdLG9wQ29kZSk7dmFyIGlzVmFsaWQ9dHJ1ZTtpZihpc1ZhbGlkKVxuaXNTdWNjZXNzPXRydWU7fWNhdGNoKGV4KXtzYXZlZEV4Y2VwdGlvbj1leDt9XG5pZighaXNTdWNjZXNzKXt0cnl7cmVzdWx0PVNuYXBPdmVybGF5T3Aub3ZlcmxheU9wKHRoaXMuZ2VvbVswXSx0aGlzLmdlb21bMV0sb3BDb2RlKTt9Y2F0Y2goZXgpe3Rocm93IHNhdmVkRXhjZXB0aW9uO319XG5yZXR1cm4gcmVzdWx0O307anN0cy5vcGVyYXRpb24ub3ZlcmxheS5zbmFwLlNuYXBJZk5lZWRlZE92ZXJsYXlPcD1TbmFwSWZOZWVkZWRPdmVybGF5T3A7fSkoKTsoZnVuY3Rpb24oKXt2YXIgR2VvbWV0cnlFeHRyYWN0ZXI9anN0cy5nZW9tLnV0aWwuR2VvbWV0cnlFeHRyYWN0ZXI7dmFyIENhc2NhZGVkUG9seWdvblVuaW9uPWpzdHMub3BlcmF0aW9uLnVuaW9uLkNhc2NhZGVkUG9seWdvblVuaW9uO3ZhciBQb2ludEdlb21ldHJ5VW5pb249anN0cy5vcGVyYXRpb24udW5pb24uUG9pbnRHZW9tZXRyeVVuaW9uO3ZhciBPdmVybGF5T3A9anN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5T3A7dmFyIFNuYXBJZk5lZWRlZE92ZXJsYXlPcD1qc3RzLm9wZXJhdGlvbi5vdmVybGF5LnNuYXAuU25hcElmTmVlZGVkT3ZlcmxheU9wO3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3A9ZnVuY3Rpb24oZ2VvbXMsZ2VvbUZhY3Qpe3RoaXMucG9seWdvbnM9bmV3IEFycmF5TGlzdCgpO3RoaXMubGluZXM9bmV3IEFycmF5TGlzdCgpO3RoaXMucG9pbnRzPW5ldyBBcnJheUxpc3QoKTtpZihnZW9tRmFjdCl7dGhpcy5nZW9tRmFjdD1nZW9tRmFjdDt9XG50aGlzLmV4dHJhY3QoZ2VvbXMpO307anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnVuaW9uPWZ1bmN0aW9uKGdlb21zLGdlb21GYWN0KXt2YXIgb3A9bmV3IGpzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcChnZW9tcyxnZW9tRmFjdCk7cmV0dXJuIG9wLnVuaW9uKCk7fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnBvbHlnb25zPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS5saW5lcz1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUucG9pbnRzPW51bGw7anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS5nZW9tRmFjdD1udWxsO2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUuZXh0cmFjdD1mdW5jdGlvbihnZW9tcyl7aWYoZ2VvbXMgaW5zdGFuY2VvZiBBcnJheUxpc3Qpe2Zvcih2YXIgaT1nZW9tcy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIGdlb209aS5uZXh0KCk7dGhpcy5leHRyYWN0KGdlb20pO319ZWxzZXtpZih0aGlzLmdlb21GYWN0PT09bnVsbCl7dGhpcy5nZW9tRmFjdD1nZW9tcy5nZXRGYWN0b3J5KCk7fVxuR2VvbWV0cnlFeHRyYWN0ZXIuZXh0cmFjdChnZW9tcyxqc3RzLmdlb20uUG9seWdvbix0aGlzLnBvbHlnb25zKTtHZW9tZXRyeUV4dHJhY3Rlci5leHRyYWN0KGdlb21zLGpzdHMuZ2VvbS5MaW5lU3RyaW5nLHRoaXMubGluZXMpO0dlb21ldHJ5RXh0cmFjdGVyLmV4dHJhY3QoZ2VvbXMsanN0cy5nZW9tLlBvaW50LHRoaXMucG9pbnRzKTt9fTtqc3RzLm9wZXJhdGlvbi51bmlvbi5VbmFyeVVuaW9uT3AucHJvdG90eXBlLnVuaW9uPWZ1bmN0aW9uKCl7aWYodGhpcy5nZW9tRmFjdD09PW51bGwpe3JldHVybiBudWxsO31cbnZhciB1bmlvblBvaW50cz1udWxsO2lmKHRoaXMucG9pbnRzLnNpemUoKT4wKXt2YXIgcHRHZW9tPXRoaXMuZ2VvbUZhY3QuYnVpbGRHZW9tZXRyeSh0aGlzLnBvaW50cyk7dW5pb25Qb2ludHM9dGhpcy51bmlvbk5vT3B0KHB0R2VvbSk7fVxudmFyIHVuaW9uTGluZXM9bnVsbDtpZih0aGlzLmxpbmVzLnNpemUoKT4wKXt2YXIgbGluZUdlb209dGhpcy5nZW9tRmFjdC5idWlsZEdlb21ldHJ5KHRoaXMubGluZXMpO3VuaW9uTGluZXM9dGhpcy51bmlvbk5vT3B0KGxpbmVHZW9tKTt9XG52YXIgdW5pb25Qb2x5Z29ucz1udWxsO2lmKHRoaXMucG9seWdvbnMuc2l6ZSgpPjApe3VuaW9uUG9seWdvbnM9Q2FzY2FkZWRQb2x5Z29uVW5pb24udW5pb24odGhpcy5wb2x5Z29ucyk7fVxudmFyIHVuaW9uTEE9dGhpcy51bmlvbldpdGhOdWxsKHVuaW9uTGluZXMsdW5pb25Qb2x5Z29ucyk7dmFyIHVuaW9uPW51bGw7aWYodW5pb25Qb2ludHM9PT1udWxsKXt1bmlvbj11bmlvbkxBO31lbHNlIGlmKHVuaW9uTEE9PT1udWxsKXt1bmlvbj11bmlvblBvaW50czt9ZWxzZXt1bmlvbj1Qb2ludEdlb21ldHJ5VW5pb24odW5pb25Qb2ludHMsdW5pb25MQSk7fVxuaWYodW5pb249PT1udWxsKXtyZXR1cm4gdGhpcy5nZW9tRmFjdC5jcmVhdGVHZW9tZXRyeUNvbGxlY3Rpb24obnVsbCk7fVxucmV0dXJuIHVuaW9uO307anN0cy5vcGVyYXRpb24udW5pb24uVW5hcnlVbmlvbk9wLnByb3RvdHlwZS51bmlvbldpdGhOdWxsPWZ1bmN0aW9uKGcwLGcxKXtpZihnMD09PW51bGwmJmcxPT09bnVsbCl7cmV0dXJuIG51bGw7fVxuaWYoZzE9PT1udWxsKXtyZXR1cm4gZzA7fVxuaWYoZzA9PT1udWxsKXtyZXR1cm4gZzE7fVxucmV0dXJuIGcwLnVuaW9uKGcxKTt9O2pzdHMub3BlcmF0aW9uLnVuaW9uLlVuYXJ5VW5pb25PcC5wcm90b3R5cGUudW5pb25Ob09wdD1mdW5jdGlvbihnMCl7dmFyIGVtcHR5PXRoaXMuZ2VvbUZhY3QuY3JlYXRlUG9pbnQobnVsbCk7cmV0dXJuIFNuYXBJZk5lZWRlZE92ZXJsYXlPcC5vdmVybGF5T3AoZzAsZW1wdHksT3ZlcmxheU9wLlVOSU9OKTt9O30oKSk7anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlPWZ1bmN0aW9uKCl7dGhpcy5sZWZ0PW51bGw7dGhpcy5yaWdodD1udWxsO3RoaXMuY291bnQ9MTtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5pbml0aWFsaXplRnJvbUNvb3JkaW5hdGUuYXBwbHkodGhpcyxhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9ZWxzZSBpZihhcmd1bWVudHMubGVuZ3RoPT09Myl7dGhpcy5pbml0aWFsaXplRnJvbVhZLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pO319O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUZyb21YWT1mdW5jdGlvbih4LHksZGF0YSl7dGhpcy5wPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO3RoaXMuZGF0YT1kYXRhO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5pbml0aWFsaXplRnJvbUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCxkYXRhKXt0aGlzLnA9cDt0aGlzLmRhdGE9ZGF0YTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0WD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0WT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnAueTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnA7fTtqc3RzLmluZGV4LmtkdHJlZS5LZE5vZGUucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5nZXRMZWZ0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVmdDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0UmlnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yaWdodDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaW5jcmVtZW50PWZ1bmN0aW9uKCl7dGhpcy5jb3VudCs9MTt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuZ2V0Q291bnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb3VudDt9O2pzdHMuaW5kZXgua2R0cmVlLktkTm9kZS5wcm90b3R5cGUuaXNSZXBlYXRlZD1mdW5jdGlvbigpe3JldHVybiBjb3VudD4xO307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5zZXRMZWZ0PWZ1bmN0aW9uKGxlZnQpe3RoaXMubGVmdD1sZWZ0O307anN0cy5pbmRleC5rZHRyZWUuS2ROb2RlLnByb3RvdHlwZS5zZXRSaWdodD1mdW5jdGlvbihyaWdodCl7dGhpcy5yaWdodD1yaWdodDt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludD1mdW5jdGlvbihnZW9tZXRyeSl7dGhpcy5taW5EaXN0YW5jZT1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMuaW50ZXJpb3JQb2ludD1udWxsO3RoaXMuY2VudHJvaWQ9Z2VvbWV0cnkuZ2V0Q2VudHJvaWQoKS5nZXRDb29yZGluYXRlKCk7dGhpcy5hZGQoZ2VvbWV0cnkpO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludFBvaW50LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5IGluc3RhbmNlb2YganN0cy5nZW9tLlBvaW50KXt0aGlzLmFkZFBvaW50KGdlb21ldHJ5LmdldENvb3JkaW5hdGUoKSk7fWVsc2UgaWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uKXtmb3IodmFyIGk9MDtpPGdlb21ldHJ5LmdldE51bUdlb21ldHJpZXMoKTtpKyspe3RoaXMuYWRkKGdlb21ldHJ5LmdldEdlb21ldHJ5TihpKSk7fX19O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludC5wcm90b3R5cGUuYWRkUG9pbnQ9ZnVuY3Rpb24ocG9pbnQpe3ZhciBkaXN0PXBvaW50LmRpc3RhbmNlKHRoaXMuY2VudHJvaWQpO2lmKGRpc3Q8dGhpcy5taW5EaXN0YW5jZSl7dGhpcy5pbnRlcmlvclBvaW50PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwb2ludCk7dGhpcy5taW5EaXN0YW5jZT1kaXN0O319O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRQb2ludC5wcm90b3R5cGUuZ2V0SW50ZXJpb3JQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyaW9yUG9pbnQ7fTsoZnVuY3Rpb24oKXtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nPWZ1bmN0aW9uKGdlb21ldHJpZXMsZmFjdG9yeSl7dGhpcy5nZW9tZXRyaWVzPWdlb21ldHJpZXN8fFtdO3RoaXMuZmFjdG9yeT1mYWN0b3J5O307anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24oKTtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLmNvbnN0cnVjdG9yPWpzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmc7anN0cy5nZW9tLk11bHRpTGluZVN0cmluZy5wcm90b3R5cGUuZ2V0Qm91bmRhcnk9ZnVuY3Rpb24oKXtyZXR1cm4obmV3IGpzdHMub3BlcmF0aW9uLkJvdW5kYXJ5T3AodGhpcykpLmdldEJvdW5kYXJ5KCk7fTtqc3RzLmdlb20uTXVsdGlMaW5lU3RyaW5nLnByb3RvdHlwZS5lcXVhbHNFeGFjdD1mdW5jdGlvbihvdGhlcix0b2xlcmFuY2Upe2lmKCF0aGlzLmlzRXF1aXZhbGVudENsYXNzKG90aGVyKSl7cmV0dXJuIGZhbHNlO31cbnJldHVybiBqc3RzLmdlb20uR2VvbWV0cnlDb2xsZWN0aW9uLnByb3RvdHlwZS5lcXVhbHNFeGFjdC5jYWxsKHRoaXMsb3RoZXIsdG9sZXJhbmNlKTt9O2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcucHJvdG90eXBlLkNMQVNTX05BTUU9J2pzdHMuZ2VvbS5NdWx0aUxpbmVTdHJpbmcnO30pKCk7KGZ1bmN0aW9uKCl7dmFyIEludGVydmFsPWpzdHMuaW5kZXguYmludHJlZS5JbnRlcnZhbDt2YXIgUm9vdD1qc3RzLmluZGV4LmJpbnRyZWUuUm9vdDt2YXIgQmludHJlZT1mdW5jdGlvbigpe3RoaXMucm9vdD1uZXcgUm9vdCgpO3RoaXMubWluRXh0ZW50PTEuMDt9O0JpbnRyZWUuZW5zdXJlRXh0ZW50PWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCxtaW5FeHRlbnQpe3ZhciBtaW4sbWF4O21pbj1pdGVtSW50ZXJ2YWwuZ2V0TWluKCk7bWF4PWl0ZW1JbnRlcnZhbC5nZXRNYXgoKTtpZihtaW4hPT1tYXgpe3JldHVybiBpdGVtSW50ZXJ2YWw7fVxuaWYobWluPT09bWF4KXttaW49bWluLShtaW5FeHRlbnQvMi4wKTttYXg9bWluKyhtaW5FeHRlbnQvMi4wKTt9XG5yZXR1cm4gbmV3IEludGVydmFsKG1pbixtYXgpO307QmludHJlZS5wcm90b3R5cGUuZGVwdGg9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QhPT1udWxsKXtyZXR1cm4gdGhpcy5yb290LmRlcHRoKCk7fVxucmV0dXJuIDA7fTtCaW50cmVlLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290IT09bnVsbCl7cmV0dXJuIHRoaXMucm9vdC5zaXplKCk7fVxucmV0dXJuIDA7fTtCaW50cmVlLnByb3RvdHlwZS5ub2RlU2l6ZT1mdW5jdGlvbigpe2lmKHRoaXMucm9vdCE9PW51bGwpe3JldHVybiB0aGlzLnJvb3Qubm9kZVNpemUoKTt9XG5yZXR1cm4gMDt9O0JpbnRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbihpdGVtSW50ZXJ2YWwsaXRlbSl7dGhpcy5jb2xsZWN0U3RhdHMoaXRlbUludGVydmFsKTt2YXIgaW5zZXJ0SW50ZXJ2YWw9QmludHJlZS5lbnN1cmVFeHRlbnQoaXRlbUludGVydmFsLHRoaXMubWluRXh0ZW50KTt0aGlzLnJvb3QuaW5zZXJ0KGluc2VydEludGVydmFsLGl0ZW0pO307QmludHJlZS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGl0ZW1JbnRlcnZhbCxpdGVtKXt2YXIgaW5zZXJ0SW50ZXJ2YWw9QmludHJlZS5lbnN1cmVFeHRlbnQoaXRlbUludGVydmFsLHRoaXMubWluRXh0ZW50KTtyZXR1cm4gdGhpcy5yb290LnJlbW92ZShpbnNlcnRJbnRlcnZhbCxpdGVtKTt9O0JpbnRyZWUucHJvdG90eXBlLml0ZXJhdG9yPWZ1bmN0aW9uKCl7dmFyIGZvdW5kSXRlbXM9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTt0aGlzLnJvb3QuYWRkQWxsSXRlbXMoZm91bmRJdGVtcyk7cmV0dXJuIGZvdW5kSXRlbXMuaXRlcmF0b3IoKTt9O0JpbnRyZWUucHJvdG90eXBlLnF1ZXJ5PWZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMucXVlcnlBbmRBZGQoYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fWVsc2V7dmFyIHg9YXJndW1lbnRzWzBdO2lmKCF4IGluc3RhbmNlb2YgSW50ZXJ2YWwpe3g9bmV3IEludGVydmFsKHgseCk7fVxucmV0dXJuIHRoaXMucXVlcnlJbnRlcnZhbCh4KTt9fTtCaW50cmVlLnByb3RvdHlwZS5xdWVyeUludGVydmFsPWZ1bmN0aW9uKGludGVydmFsKXt2YXIgZm91bmRJdGVtcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3RoaXMucXVlcnkoaW50ZXJ2YWwsZm91bmRJdGVtcyk7cmV0dXJuIGZvdW5kSXRlbXM7fTtCaW50cmVlLnByb3RvdHlwZS5xdWVyeUFuZEFkZD1mdW5jdGlvbihpbnRlcnZhbCxmb3VuZEl0ZW1zKXt0aGlzLnJvb3QuYWRkQWxsSXRlbXNGcm9tT3ZlcmxhcHBpbmcoaW50ZXJ2YWwsZm91bmRJdGVtcyk7fTtCaW50cmVlLnByb3RvdHlwZS5jb2xsZWN0U3RhdHM9ZnVuY3Rpb24oaW50ZXJ2YWwpe3ZhciBkZWw9aW50ZXJ2YWwuZ2V0V2lkdGgoKTtpZihkZWw8dGhpcy5taW5FeHRlbnQmJmRlbD4wLjApe3RoaXMubWluRXh0ZW50PWRlbDt9fTtqc3RzLmluZGV4LmJpbnRyZWUuQmludHJlZT1CaW50cmVlO30pKCk7anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWE9ZnVuY3Rpb24oZ2VvbWV0cnkpe3RoaXMuZmFjdG9yeTt0aGlzLmludGVyaW9yUG9pbnQ9bnVsbDt0aGlzLm1heFdpZHRoPTA7dGhpcy5mYWN0b3J5PWdlb21ldHJ5LmdldEZhY3RvcnkoKTt0aGlzLmFkZChnZW9tZXRyeSk7fTtqc3RzLmFsZ29yaXRobS5JbnRlcmlvclBvaW50QXJlYS5hdmc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4oYStiKS8yO307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEucHJvdG90eXBlLmdldEludGVyaW9yUG9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcmlvclBvaW50O307anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEucHJvdG90eXBlLmFkZD1mdW5jdGlvbihnZW9tZXRyeSl7aWYoZ2VvbWV0cnkgaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbil7dGhpcy5hZGRQb2x5Z29uKGdlb21ldHJ5KTt9ZWxzZSBpZihnZW9tZXRyeSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe2Zvcih2YXIgaT0wO2k8Z2VvbWV0cnkuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dGhpcy5hZGQoZ2VvbWV0cnkuZ2V0R2VvbWV0cnlOKGkpKTt9fX07anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEucHJvdG90eXBlLmFkZFBvbHlnb249ZnVuY3Rpb24oZ2VvbWV0cnkpe2lmKGdlb21ldHJ5LmlzRW1wdHkoKSl7cmV0dXJuO31cbnZhciBpbnRQdDt2YXIgd2lkdGg9MDt2YXIgYmlzZWN0b3I9dGhpcy5ob3Jpem9udGFsQmlzZWN0b3IoZ2VvbWV0cnkpO2lmKGJpc2VjdG9yLmdldExlbmd0aCgpPT0wLjApe3dpZHRoPTA7aW50UHQ9YmlzZWN0b3IuZ2V0Q29vcmRpbmF0ZSgpO31lbHNle3ZhciBpbnRlcnNlY3Rpb25zPWJpc2VjdG9yLmludGVyc2VjdGlvbihnZW9tZXRyeSk7dmFyIHdpZGVzdEludGVyc2VjdGlvbj10aGlzLndpZGVzdEdlb21ldHJ5KGludGVyc2VjdGlvbnMpO3dpZHRoPXdpZGVzdEludGVyc2VjdGlvbi5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0V2lkdGgoKTtpbnRQdD10aGlzLmNlbnRyZSh3aWRlc3RJbnRlcnNlY3Rpb24uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpKTt9XG5pZih0aGlzLmludGVyaW9yUG9pbnQ9PW51bGx8fHdpZHRoPnRoaXMubWF4V2lkdGgpe3RoaXMuaW50ZXJpb3JQb2ludD1pbnRQdDt0aGlzLm1heFdpZHRoPXdpZHRoO319O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS53aWRlc3RHZW9tZXRyeT1mdW5jdGlvbihvYmope2lmKG9iaiBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pe3ZhciBnYz1vYmo7aWYoZ2MuaXNFbXB0eSgpKXtyZXR1cm4gZ2M7fVxudmFyIHdpZGVzdEdlb21ldHJ5PWdjLmdldEdlb21ldHJ5TigwKTtmb3IodmFyIGk9MTtpPGdjLmdldE51bUdlb21ldHJpZXMoKTtpKyspe2lmKGdjLmdldEdlb21ldHJ5TihpKS5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0V2lkdGgoKT53aWRlc3RHZW9tZXRyeS5nZXRFbnZlbG9wZUludGVybmFsKCkuZ2V0V2lkdGgoKSl7d2lkZXN0R2VvbWV0cnk9Z2MuZ2V0R2VvbWV0cnlOKGkpO319XG5yZXR1cm4gd2lkZXN0R2VvbWV0cnk7fWVsc2UgaWYob2JqIGluc3RhbmNlb2YganN0cy5nZW9tLkdlb21ldHJ5KXtyZXR1cm4gb2JqO319O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5ob3Jpem9udGFsQmlzZWN0b3I9ZnVuY3Rpb24oZ2VvbWV0cnkpe3ZhciBlbnZlbG9wZT1nZW9tZXRyeS5nZXRFbnZlbG9wZUludGVybmFsKCk7dmFyIGJpc2VjdFk9anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLmdldEJpc2VjdG9yWShnZW9tZXRyeSk7cmV0dXJuIHRoaXMuZmFjdG9yeS5jcmVhdGVMaW5lU3RyaW5nKFtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoZW52ZWxvcGUuZ2V0TWluWCgpLGJpc2VjdFkpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlbnZlbG9wZS5nZXRNYXhYKCksYmlzZWN0WSldKTt9O2pzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLnByb3RvdHlwZS5jZW50cmU9ZnVuY3Rpb24oZW52ZWxvcGUpe3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoanN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEuYXZnKGVudmVsb3BlLmdldE1pblgoKSxlbnZlbG9wZS5nZXRNYXhYKCkpLGpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2ZyhlbnZlbG9wZS5nZXRNaW5ZKCksZW52ZWxvcGUuZ2V0TWF4WSgpKSk7fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXI9ZnVuY3Rpb24ocG9seSl7dGhpcy5wb2x5O3RoaXMuY2VudHJlWTt0aGlzLmhpWT1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMubG9ZPS1OdW1iZXIuTUFYX1ZBTFVFO3RoaXMucG9seT1wb2x5O3RoaXMuaGlZPXBvbHkuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpLmdldE1heFkoKTt0aGlzLmxvWT1wb2x5LmdldEVudmVsb3BlSW50ZXJuYWwoKS5nZXRNaW5ZKCk7dGhpcy5jZW50cmVZPWpzdHMuYWxnb3JpdGhtLkludGVyaW9yUG9pbnRBcmVhLmF2Zyh0aGlzLmxvWSx0aGlzLmhpWSk7fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIuZ2V0QmlzZWN0b3JZPWZ1bmN0aW9uKHBvbHkpe3ZhciBmaW5kZXI9bmV3IGpzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlcihwb2x5KTtyZXR1cm4gZmluZGVyLmdldEJpc2VjdG9yWSgpO307anN0cy5hbGdvcml0aG0uU2FmZUJpc2VjdG9yRmluZGVyLnByb3RvdHlwZS5nZXRCaXNlY3Rvclk9ZnVuY3Rpb24oKXt0aGlzLnByb2Nlc3ModGhpcy5wb2x5LmdldEV4dGVyaW9yUmluZygpKTtmb3IodmFyIGk9MDtpPHRoaXMucG9seS5nZXROdW1JbnRlcmlvclJpbmcoKTtpKyspe3RoaXMucHJvY2Vzcyh0aGlzLnBvbHkuZ2V0SW50ZXJpb3JSaW5nTihpKSk7fVxudmFyIGJpc2VjdFk9anN0cy5hbGdvcml0aG0uSW50ZXJpb3JQb2ludEFyZWEuYXZnKHRoaXMuaGlZLHRoaXMubG9ZKTtyZXR1cm4gYmlzZWN0WTt9O2pzdHMuYWxnb3JpdGhtLlNhZmVCaXNlY3RvckZpbmRlci5wcm90b3R5cGUucHJvY2Vzcz1mdW5jdGlvbihsaW5lKXt2YXIgc2VxPWxpbmUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7Zm9yKHZhciBpPTA7aTxzZXEubGVuZ3RoO2krKyl7dmFyIHk9c2VxW2ldLnk7dGhpcy51cGRhdGVJbnRlcnZhbCh5KTt9fTtqc3RzLmFsZ29yaXRobS5TYWZlQmlzZWN0b3JGaW5kZXIucHJvdG90eXBlLnVwZGF0ZUludGVydmFsPWZ1bmN0aW9uKHkpe2lmKHk8PXRoaXMuY2VudHJlWSl7aWYoeT50aGlzLmxvWSl7dGhpcy5sb1k9eTt9fWVsc2UgaWYoeT50aGlzLmNlbnRyZVkpe2lmKHk8dGhpcy5oaVkpe3RoaXMuaGlZPXk7fX19O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzPWZ1bmN0aW9uKHF1YWRyYW50U2VnbWVudHMsZW5kQ2FwU3R5bGUsam9pblN0eWxlLG1pdHJlTGltaXQpe2lmKHF1YWRyYW50U2VnbWVudHMpXG50aGlzLnNldFF1YWRyYW50U2VnbWVudHMocXVhZHJhbnRTZWdtZW50cyk7aWYoZW5kQ2FwU3R5bGUpXG50aGlzLnNldEVuZENhcFN0eWxlKGVuZENhcFN0eWxlKTtpZihqb2luU3R5bGUpXG50aGlzLnNldEpvaW5TdHlsZShqb2luU3R5bGUpO2lmKG1pdHJlTGltaXQpXG50aGlzLnNldE1pdHJlTGltaXQobWl0cmVMaW1pdCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfUk9VTkQ9MTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5DQVBfRkxBVD0yO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkNBUF9TUVVBUkU9Mztqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5KT0lOX1JPVU5EPTE7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9NSVRSRT0yO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fQkVWRUw9Mztqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5ERUZBVUxUX1FVQURSQU5UX1NFR01FTlRTPTg7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9NSVRSRV9MSU1JVD01LjA7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnF1YWRyYW50U2VnbWVudHM9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuREVGQVVMVF9RVUFEUkFOVF9TRUdNRU5UUztqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZW5kQ2FwU3R5bGU9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuQ0FQX1JPVU5EO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5qb2luU3R5bGU9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9ST1VORDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUubWl0cmVMaW1pdD1qc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5ERUZBVUxUX01JVFJFX0xJTUlUO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5faXNTaW5nbGVTaWRlZD1mYWxzZTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZ2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnF1YWRyYW50U2VnbWVudHM7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0UXVhZHJhbnRTZWdtZW50cz1mdW5jdGlvbihxdWFkcmFudFNlZ21lbnRzKXt0aGlzLnF1YWRyYW50U2VnbWVudHM9cXVhZHJhbnRTZWdtZW50czt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5zZXRRdWFkcmFudFNlZ21lbnRzPWZ1bmN0aW9uKHF1YWRTZWdzKXt0aGlzLnF1YWRyYW50U2VnbWVudHM9cXVhZFNlZ3M7aWYodGhpcy5xdWFkcmFudFNlZ21lbnRzPT09MClcbnRoaXMuam9pblN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fQkVWRUw7aWYodGhpcy5xdWFkcmFudFNlZ21lbnRzPDApe3RoaXMuam9pblN0eWxlPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkpPSU5fTUlUUkU7dGhpcy5taXRyZUxpbWl0PU1hdGguYWJzKHRoaXMucXVhZHJhbnRTZWdtZW50cyk7fVxuaWYocXVhZFNlZ3M8PTApe3RoaXMucXVhZHJhbnRTZWdtZW50cz0xO31cbmlmKHRoaXMuam9pblN0eWxlIT09anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuSk9JTl9ST1VORCl7dGhpcy5xdWFkcmFudFNlZ21lbnRzPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLkRFRkFVTFRfUVVBRFJBTlRfU0VHTUVOVFM7fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMuYnVmZmVyRGlzdGFuY2VFcnJvcj1mdW5jdGlvbihxdWFkU2Vncyl7dmFyIGFscGhhPU1hdGguUEkvMi4wL3F1YWRTZWdzO3JldHVybiAxLU1hdGguY29zKGFscGhhLzIuMCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuZ2V0RW5kQ2FwU3R5bGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmRDYXBTdHlsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5zZXRFbmRDYXBTdHlsZT1mdW5jdGlvbihlbmRDYXBTdHlsZSl7dGhpcy5lbmRDYXBTdHlsZT1lbmRDYXBTdHlsZTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzLnByb3RvdHlwZS5nZXRKb2luU3R5bGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qb2luU3R5bGU7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0Sm9pblN0eWxlPWZ1bmN0aW9uKGpvaW5TdHlsZSl7dGhpcy5qb2luU3R5bGU9am9pblN0eWxlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmdldE1pdHJlTGltaXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5taXRyZUxpbWl0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLnNldE1pdHJlTGltaXQ9ZnVuY3Rpb24obWl0cmVMaW1pdCl7dGhpcy5taXRyZUxpbWl0PW1pdHJlTGltaXQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyUGFyYW1ldGVycy5wcm90b3R5cGUuc2V0U2luZ2xlU2lkZWQ9ZnVuY3Rpb24oaXNTaW5nbGVTaWRlZCl7dGhpcy5faXNTaW5nbGVTaWRlZD1pc1NpbmdsZVNpZGVkO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlclBhcmFtZXRlcnMucHJvdG90eXBlLmlzU2luZ2xlU2lkZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNTaW5nbGVTaWRlZDt9OyhmdW5jdGlvbigpe2pzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvci5wcm90b3R5cGUuaXNEb25lPWZhbHNlO2pzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yLnByb3RvdHlwZS5hcHBseVRvPWZ1bmN0aW9uKGdlb20pe2Zvcih2YXIgaT0wO2k8Z2VvbS5nZXROdW1HZW9tZXRyaWVzKCkmJiF0aGlzLmlzRG9uZTtpKyspe3ZhciBlbGVtZW50PWdlb20uZ2V0R2VvbWV0cnlOKGkpO2lmKCEoZWxlbWVudCBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pKXt0aGlzLnZpc2l0KGVsZW1lbnQpO2lmKHRoaXMuaXNEb25lKCkpe3RoaXMuaXNEb25lPXRydWU7cmV0dXJuO319XG5lbHNlXG50aGlzLmFwcGx5VG8oZWxlbWVudCk7fX1cbmpzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbihlbGVtZW50KXt9O2pzdHMuZ2VvbS51dGlsLlNob3J0Q2lyY3VpdGVkR2VvbWV0cnlWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXt9O30pKCk7KGZ1bmN0aW9uKCl7dmFyIEVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3I9ZnVuY3Rpb24ocmVjdEVudil7dGhpcy5yZWN0RW52PXJlY3RFbnY7fTtFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IoKTtFbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLmNvbnN0cnVjdG9yPUVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3I7RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUucmVjdEVudj1udWxsO0VudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZmFsc2U7RW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUuaW50ZXJzZWN0cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmludGVyc2VjdHM7fVxuRW52ZWxvcGVJbnRlcnNlY3RzVmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZWxlbWVudCl7dmFyIGVsZW1lbnRFbnY9ZWxlbWVudC5nZXRFbnZlbG9wZUludGVybmFsKCk7aWYoIXRoaXMucmVjdEVudi5pbnRlcnNlY3RzKGVsZW1lbnRFbnYpKXtyZXR1cm47fVxuaWYodGhpcy5yZWN0RW52LmNvbnRhaW5zKGVsZW1lbnRFbnYpKXt0aGlzLmludGVyc2VjdHM9dHJ1ZTtyZXR1cm47fVxuaWYoZWxlbWVudEVudi5nZXRNaW5YKCk+PXJlY3RFbnYuZ2V0TWluWCgpJiZlbGVtZW50RW52LmdldE1heFgoKTw9cmVjdEVudi5nZXRNYXhYKCkpe3RoaXMuaW50ZXJzZWN0cz10cnVlO3JldHVybjt9XG5pZihlbGVtZW50RW52LmdldE1pblkoKT49cmVjdEVudi5nZXRNaW5ZKCkmJmVsZW1lbnRFbnYuZ2V0TWF4WSgpPD1yZWN0RW52LmdldE1heFkoKSl7dGhpcy5pbnRlcnNlY3RzPXRydWU7cmV0dXJuO319XG5FbnZlbG9wZUludGVyc2VjdHNWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRlcnNlY3RzPT10cnVlO31cbnZhciBHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yPWZ1bmN0aW9uKHJlY3RhbmdsZSl7dGhpcy5yZWN0U2VxPXJlY3RhbmdsZS5nZXRFeHRlcmlvclJpbmcoKS5nZXRDb29yZGluYXRlU2VxdWVuY2UoKTt0aGlzLnJlY3RFbnY9cmVjdGFuZ2xlLmdldEVudmVsb3BlSW50ZXJuYWwoKTt9O0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlPW5ldyBqc3RzLmdlb20udXRpbC5TaG9ydENpcmN1aXRlZEdlb21ldHJ5VmlzaXRvcigpO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IuY29uc3RydWN0b3I9R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvcjtHZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZS5yZWN0U2VxPW51bGw7R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUucmVjdEVudj1udWxsO0dlb21ldHJ5Q29udGFpbnNQb2ludFZpc2l0b3IucHJvdG90eXBlLmNvbnRhaW5zUG9pbnQ9ZmFsc2U7R2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUuY29udGFpbnNQb2ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRhaW5zUG9pbnQ7fVxuR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24oZ2VvbSl7aWYoIShnZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLlBvbHlnb24pKVxucmV0dXJuO3ZhciBlbGVtZW50RW52PWdlb20uZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO2lmKCF0aGlzLnJlY3RFbnYuaW50ZXJzZWN0cyhlbGVtZW50RW52KSlcbnJldHVybjt2YXIgcmVjdFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO2Zvcih2YXIgaT0wO2k8NDtpKyspe3RoaXMucmVjdFNlcS5nZXRDb29yZGluYXRlKGkscmVjdFB0KTtpZighZWxlbWVudEVudi5jb250YWlucyhyZWN0UHQpKVxuY29udGludWU7aWYoU2ltcGxlUG9pbnRJbkFyZWFMb2NhdG9yLmNvbnRhaW5zUG9pbnRJblBvbHlnb24ocmVjdFB0LGdlb20pKXt0aGlzLmNvbnRhaW5zUG9pbnQ9dHJ1ZTtyZXR1cm47fX19XG5HZW9tZXRyeUNvbnRhaW5zUG9pbnRWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250YWluc1BvaW50PT10cnVlO31cbnZhciBSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3I9ZnVuY3Rpb24ocmVjdGFuZ2xlKXt0aGlzLnJlY3RFbnY9cmVjdGFuZ2xlLmdldEVudmVsb3BlSW50ZXJuYWwoKTt0aGlzLnJlY3RJbnRlcnNlY3Rvcj1uZXcgUmVjdGFuZ2xlTGluZUludGVyc2VjdG9yKHJlY3RFbnYpO307UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLnV0aWwuU2hvcnRDaXJjdWl0ZWRHZW9tZXRyeVZpc2l0b3IoKTtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IuY29uc3RydWN0b3I9UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucmVjdEVudj1udWxsO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucmVjdEludGVyc2VjdG9yPW51bGw7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5oYXNJbnRlcnNlY3Rpb249ZmFsc2U7UmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5wMD1udWxsO1JlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvci5wcm90b3R5cGUucDE9bnVsbDtSZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLmludGVyc2VjdHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb247fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbihnZW9tKXt2YXIgZWxlbWVudEVudj1nZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKTtpZighdGhpcy5yZWN0RW52LmludGVyc2VjdHMoZWxlbWVudEVudikpXG5yZXR1cm47dmFyIGxpbmVzPUxpbmVhckNvbXBvbmVudEV4dHJhY3Rlci5nZXRMaW5lcyhnZW9tKTt0aGlzLmNoZWNrSW50ZXJzZWN0aW9uV2l0aExpbmVTdHJpbmdzKGxpbmVzKTt9XG5SZWN0YW5nbGVJbnRlcnNlY3RzU2VnbWVudFZpc2l0b3IucHJvdG90eXBlLmNoZWNrSW50ZXJzZWN0aW9uV2l0aExpbmVTdHJpbmdzPWZ1bmN0aW9uKGxpbmVzKXtmb3IodmFyIGk9bGluZXMuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciB0ZXN0TGluZT1pLm5leHQoKTt0aGlzLmNoZWNrSW50ZXJzZWN0aW9uV2l0aFNlZ21lbnRzKHRlc3RMaW5lKTtpZih0aGlzLmhhc0ludGVyc2VjdGlvbilcbnJldHVybjt9fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5jaGVja0ludGVyc2VjdGlvbldpdGhTZWdtZW50cz1mdW5jdGlvbih0ZXN0TGluZSl7dmFyIHNlcTE9dGVzdExpbmUuZ2V0Q29vcmRpbmF0ZVNlcXVlbmNlKCk7Zm9yKHZhciBqPTE7ajxzZXExLmxlbmd0aDtqKyspe3RoaXMucDA9c2VxMVtqLTFdO3RoaXMucDE9c2VxMVtqXTtpZihyZWN0SW50ZXJzZWN0b3IuaW50ZXJzZWN0cyhwMCxwMSkpe3RoaXMuaGFzSW50ZXJzZWN0aW9uPXRydWU7cmV0dXJuO319fVxuUmVjdGFuZ2xlSW50ZXJzZWN0c1NlZ21lbnRWaXNpdG9yLnByb3RvdHlwZS5pc0RvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNJbnRlcnNlY3Rpb249PXRydWU7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHM9ZnVuY3Rpb24ocmVjdGFuZ2xlKXt0aGlzLnJlY3RhbmdsZT1yZWN0YW5nbGU7dGhpcy5yZWN0RW52PXJlY3RhbmdsZS5nZXRFbnZlbG9wZUludGVybmFsKCk7fVxuanN0cy5vcGVyYXRpb24ucHJlZGljYXRlLlJlY3RhbmdsZUludGVyc2VjdHMuaW50ZXJzZWN0cz1mdW5jdGlvbihyZWN0YW5nbGUsYil7dmFyIHJwPW5ldyBqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cyhyZWN0YW5nbGUpO3JldHVybiBycC5pbnRlcnNlY3RzKGIpO31cbmpzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLnByb3RvdHlwZS5yZWN0YW5nbGU9bnVsbDtqc3RzLm9wZXJhdGlvbi5wcmVkaWNhdGUuUmVjdGFuZ2xlSW50ZXJzZWN0cy5wcm90b3R5cGUucmVjdEVudj1udWxsO2pzdHMub3BlcmF0aW9uLnByZWRpY2F0ZS5SZWN0YW5nbGVJbnRlcnNlY3RzLnByb3RvdHlwZS5pbnRlcnNlY3RzPWZ1bmN0aW9uKGdlb20pe2lmKCF0aGlzLnJlY3RFbnYuaW50ZXJzZWN0cyhnZW9tLmdldEVudmVsb3BlSW50ZXJuYWwoKSkpXG5yZXR1cm4gZmFsc2U7dmFyIHZpc2l0b3I9bmV3IEVudmVsb3BlSW50ZXJzZWN0c1Zpc2l0b3IodGhpcy5yZWN0RW52KTt2aXNpdG9yLmFwcGx5VG8oZ2VvbSk7aWYodmlzaXRvci5pbnRlcnNlY3RzKCkpXG5yZXR1cm4gdHJ1ZTt2YXIgZWNwVmlzaXRvcj1uZXcgR2VvbWV0cnlDb250YWluc1BvaW50VmlzaXRvcihyZWN0YW5nbGUpO2VjcFZpc2l0b3IuYXBwbHlUbyhnZW9tKTtpZihlY3BWaXNpdG9yLmNvbnRhaW5zUG9pbnQoKSlcbnJldHVybiB0cnVlO3ZhciByaVZpc2l0b3I9bmV3IFJlY3RhbmdsZUludGVyc2VjdHNTZWdtZW50VmlzaXRvcihyZWN0YW5nbGUpO3JpVmlzaXRvci5hcHBseVRvKGdlb20pO2lmKHJpVmlzaXRvci5pbnRlcnNlY3RzKCkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fX0pKCk7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXI9ZnVuY3Rpb24oYnVmUGFyYW1zKXt0aGlzLmJ1ZlBhcmFtcz1idWZQYXJhbXM7dGhpcy5lZGdlTGlzdD1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUxpc3QoKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLmRlcHRoRGVsdGE9ZnVuY3Rpb24obGFiZWwpe3ZhciBsTG9jPWxhYmVsLmdldExvY2F0aW9uKDAsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uTEVGVCk7dmFyIHJMb2M9bGFiZWwuZ2V0TG9jYXRpb24oMCxqc3RzLmdlb21ncmFwaC5Qb3NpdGlvbi5SSUdIVCk7aWYobExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUiYmckxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUilcbnJldHVybiAxO2Vsc2UgaWYobExvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUiYmckxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUilcbnJldHVybi0xO3JldHVybiAwO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmJ1ZlBhcmFtcz1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS53b3JraW5nUHJlY2lzaW9uTW9kZWw9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUud29ya2luZ05vZGVyPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmdlb21GYWN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmdyYXBoPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmVkZ2VMaXN0PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLnNldFdvcmtpbmdQcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihwbSl7dGhpcy53b3JraW5nUHJlY2lzaW9uTW9kZWw9cG07fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUuc2V0Tm9kZXI9ZnVuY3Rpb24obm9kZXIpe3RoaXMud29ya2luZ05vZGVyPW5vZGVyO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmJ1ZmZlcj1mdW5jdGlvbihnLGRpc3RhbmNlKXt2YXIgcHJlY2lzaW9uTW9kZWw9dGhpcy53b3JraW5nUHJlY2lzaW9uTW9kZWw7aWYocHJlY2lzaW9uTW9kZWw9PT1udWxsKVxucHJlY2lzaW9uTW9kZWw9Zy5nZXRQcmVjaXNpb25Nb2RlbCgpO3RoaXMuZ2VvbUZhY3Q9Zy5nZXRGYWN0b3J5KCk7dmFyIGN1cnZlQnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlQnVpbGRlcihwcmVjaXNpb25Nb2RlbCx0aGlzLmJ1ZlBhcmFtcyk7dmFyIGN1cnZlU2V0QnVpbGRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldEN1cnZlU2V0QnVpbGRlcihnLGRpc3RhbmNlLGN1cnZlQnVpbGRlcik7dmFyIGJ1ZmZlclNlZ1N0ckxpc3Q9Y3VydmVTZXRCdWlsZGVyLmdldEN1cnZlcygpO2lmKGJ1ZmZlclNlZ1N0ckxpc3Quc2l6ZSgpPD0wKXtyZXR1cm4gdGhpcy5jcmVhdGVFbXB0eVJlc3VsdEdlb21ldHJ5KCk7fVxudGhpcy5jb21wdXRlTm9kZWRFZGdlcyhidWZmZXJTZWdTdHJMaXN0LHByZWNpc2lvbk1vZGVsKTt0aGlzLmdyYXBoPW5ldyBqc3RzLmdlb21ncmFwaC5QbGFuYXJHcmFwaChuZXcganN0cy5vcGVyYXRpb24ub3ZlcmxheS5PdmVybGF5Tm9kZUZhY3RvcnkoKSk7dGhpcy5ncmFwaC5hZGRFZGdlcyh0aGlzLmVkZ2VMaXN0LmdldEVkZ2VzKCkpO3ZhciBzdWJncmFwaExpc3Q9dGhpcy5jcmVhdGVTdWJncmFwaHModGhpcy5ncmFwaCk7dmFyIHBvbHlCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5vdmVybGF5LlBvbHlnb25CdWlsZGVyKHRoaXMuZ2VvbUZhY3QpO3RoaXMuYnVpbGRTdWJncmFwaHMoc3ViZ3JhcGhMaXN0LHBvbHlCdWlsZGVyKTt2YXIgcmVzdWx0UG9seUxpc3Q9cG9seUJ1aWxkZXIuZ2V0UG9seWdvbnMoKTtpZihyZXN1bHRQb2x5TGlzdC5zaXplKCk8PTApe3JldHVybiB0aGlzLmNyZWF0ZUVtcHR5UmVzdWx0R2VvbWV0cnkoKTt9XG52YXIgcmVzdWx0R2VvbT10aGlzLmdlb21GYWN0LmJ1aWxkR2VvbWV0cnkocmVzdWx0UG9seUxpc3QpO3JldHVybiByZXN1bHRHZW9tO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmdldE5vZGVyPWZ1bmN0aW9uKHByZWNpc2lvbk1vZGVsKXtpZih0aGlzLndvcmtpbmdOb2RlciE9PW51bGwpXG5yZXR1cm4gdGhpcy53b3JraW5nTm9kZXI7dmFyIG5vZGVyPW5ldyBqc3RzLm5vZGluZy5NQ0luZGV4Tm9kZXIoKTt2YXIgbGk9bmV3IGpzdHMuYWxnb3JpdGhtLlJvYnVzdExpbmVJbnRlcnNlY3RvcigpO2xpLnNldFByZWNpc2lvbk1vZGVsKHByZWNpc2lvbk1vZGVsKTtub2Rlci5zZXRTZWdtZW50SW50ZXJzZWN0b3IobmV3IGpzdHMubm9kaW5nLkludGVyc2VjdGlvbkFkZGVyKGxpKSk7cmV0dXJuIG5vZGVyO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmNvbXB1dGVOb2RlZEVkZ2VzPWZ1bmN0aW9uKGJ1ZmZlclNlZ1N0ckxpc3QscHJlY2lzaW9uTW9kZWwpe3ZhciBub2Rlcj10aGlzLmdldE5vZGVyKHByZWNpc2lvbk1vZGVsKTtub2Rlci5jb21wdXRlTm9kZXMoYnVmZmVyU2VnU3RyTGlzdCk7dmFyIG5vZGVkU2VnU3RyaW5ncz1ub2Rlci5nZXROb2RlZFN1YnN0cmluZ3MoKTtmb3IodmFyIGk9bm9kZWRTZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgc2VnU3RyPWkubmV4dCgpO3ZhciBvbGRMYWJlbD1zZWdTdHIuZ2V0RGF0YSgpO3ZhciBlZGdlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKHNlZ1N0ci5nZXRDb29yZGluYXRlcygpLG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChvbGRMYWJlbCkpO3RoaXMuaW5zZXJ0VW5pcXVlRWRnZShlZGdlKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5wcm90b3R5cGUuaW5zZXJ0VW5pcXVlRWRnZT1mdW5jdGlvbihlKXt2YXIgZXhpc3RpbmdFZGdlPXRoaXMuZWRnZUxpc3QuZmluZEVxdWFsRWRnZShlKTtpZihleGlzdGluZ0VkZ2UhPW51bGwpe3ZhciBleGlzdGluZ0xhYmVsPWV4aXN0aW5nRWRnZS5nZXRMYWJlbCgpO3ZhciBsYWJlbFRvTWVyZ2U9ZS5nZXRMYWJlbCgpO2lmKCFleGlzdGluZ0VkZ2UuaXNQb2ludHdpc2VFcXVhbChlKSl7bGFiZWxUb01lcmdlPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChlLmdldExhYmVsKCkpO2xhYmVsVG9NZXJnZS5mbGlwKCk7fVxuZXhpc3RpbmdMYWJlbC5tZXJnZShsYWJlbFRvTWVyZ2UpO3ZhciBtZXJnZURlbHRhPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLmRlcHRoRGVsdGEobGFiZWxUb01lcmdlKTt2YXIgZXhpc3RpbmdEZWx0YT1leGlzdGluZ0VkZ2UuZ2V0RGVwdGhEZWx0YSgpO3ZhciBuZXdEZWx0YT1leGlzdGluZ0RlbHRhK21lcmdlRGVsdGE7ZXhpc3RpbmdFZGdlLnNldERlcHRoRGVsdGEobmV3RGVsdGEpO31lbHNle3RoaXMuZWRnZUxpc3QuYWRkKGUpO2Uuc2V0RGVwdGhEZWx0YShqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlci5kZXB0aERlbHRhKGUuZ2V0TGFiZWwoKSkpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLnByb3RvdHlwZS5jcmVhdGVTdWJncmFwaHM9ZnVuY3Rpb24oZ3JhcGgpe3ZhciBzdWJncmFwaExpc3Q9W107Zm9yKHZhciBpPWdyYXBoLmdldE5vZGVzKCkuaXRlcmF0b3IoKTtpLmhhc05leHQoKTspe3ZhciBub2RlPWkubmV4dCgpO2lmKCFub2RlLmlzVmlzaXRlZCgpKXt2YXIgc3ViZ3JhcGg9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJTdWJncmFwaCgpO3N1YmdyYXBoLmNyZWF0ZShub2RlKTtzdWJncmFwaExpc3QucHVzaChzdWJncmFwaCk7fX1cbnZhciBjb21wYXJlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuY29tcGFyZVRvKGIpO307c3ViZ3JhcGhMaXN0LnNvcnQoY29tcGFyZSk7c3ViZ3JhcGhMaXN0LnJldmVyc2UoKTtyZXR1cm4gc3ViZ3JhcGhMaXN0O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkU3ViZ3JhcGhzPWZ1bmN0aW9uKHN1YmdyYXBoTGlzdCxwb2x5QnVpbGRlcil7dmFyIHByb2Nlc3NlZEdyYXBocz1bXTtmb3IodmFyIGk9MDtpPHN1YmdyYXBoTGlzdC5sZW5ndGg7aSsrKXt2YXIgc3ViZ3JhcGg9c3ViZ3JhcGhMaXN0W2ldO3ZhciBwPXN1YmdyYXBoLmdldFJpZ2h0bW9zdENvb3JkaW5hdGUoKTt2YXIgbG9jYXRlcj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLlN1YmdyYXBoRGVwdGhMb2NhdGVyKHByb2Nlc3NlZEdyYXBocyk7dmFyIG91dHNpZGVEZXB0aD1sb2NhdGVyLmdldERlcHRoKHApO3N1YmdyYXBoLmNvbXB1dGVEZXB0aChvdXRzaWRlRGVwdGgpO3N1YmdyYXBoLmZpbmRSZXN1bHRFZGdlcygpO3Byb2Nlc3NlZEdyYXBocy5wdXNoKHN1YmdyYXBoKTtwb2x5QnVpbGRlci5hZGQoc3ViZ3JhcGguZ2V0RGlyZWN0ZWRFZGdlcygpLHN1YmdyYXBoLmdldE5vZGVzKCkpO319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyLmNvbnZlcnRTZWdTdHJpbmdzPWZ1bmN0aW9uKGl0KXt2YXIgZmFjdD1uZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3ZhciBsaW5lcz1uZXcgamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdCgpO3doaWxlKGl0Lmhhc05leHQoKSl7dmFyIHNzPWl0Lm5leHQoKTt2YXIgbGluZT1mYWN0LmNyZWF0ZUxpbmVTdHJpbmcoc3MuZ2V0Q29vcmRpbmF0ZXMoKSk7bGluZXMuYWRkKGxpbmUpO31cbnJldHVybiBmYWN0LmJ1aWxkR2VvbWV0cnkobGluZXMpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlckJ1aWxkZXIucHJvdG90eXBlLmNyZWF0ZUVtcHR5UmVzdWx0R2VvbWV0cnk9ZnVuY3Rpb24oKXt2YXIgZW1wdHlHZW9tPXRoaXMuZ2VvbUZhY3QuY3JlYXRlUG9seWdvbihudWxsLG51bGwpO3JldHVybiBlbXB0eUdlb207fTtqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmU9ZnVuY3Rpb24ob2N0YW50LHAwLHAxKXtpZihwMC5lcXVhbHMyRChwMSkpXG5yZXR1cm4gMDt2YXIgeFNpZ249anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5yZWxhdGl2ZVNpZ24ocDAueCxwMS54KTt2YXIgeVNpZ249anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5yZWxhdGl2ZVNpZ24ocDAueSxwMS55KTtzd2l0Y2gob2N0YW50KXtjYXNlIDA6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKHhTaWduLHlTaWduKTtjYXNlIDE6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKHlTaWduLHhTaWduKTtjYXNlIDI6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKHlTaWduLC14U2lnbik7Y2FzZSAzOnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSgteFNpZ24seVNpZ24pO2Nhc2UgNDpyZXR1cm4ganN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5jb21wYXJlVmFsdWUoLXhTaWduLC15U2lnbik7Y2FzZSA1OnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSgteVNpZ24sLXhTaWduKTtjYXNlIDY6cmV0dXJuIGpzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlKC15U2lnbix4U2lnbik7Y2FzZSA3OnJldHVybiBqc3RzLm5vZGluZy5TZWdtZW50UG9pbnRDb21wYXJhdG9yLmNvbXBhcmVWYWx1ZSh4U2lnbiwteVNpZ24pO31cbnJldHVybiAwO307anN0cy5ub2RpbmcuU2VnbWVudFBvaW50Q29tcGFyYXRvci5yZWxhdGl2ZVNpZ249ZnVuY3Rpb24oeDAseDEpe2lmKHgwPHgxKVxucmV0dXJuLTE7aWYoeDA+eDEpXG5yZXR1cm4gMTtyZXR1cm4gMDt9O2pzdHMubm9kaW5nLlNlZ21lbnRQb2ludENvbXBhcmF0b3IuY29tcGFyZVZhbHVlPWZ1bmN0aW9uKGNvbXBhcmVTaWduMCxjb21wYXJlU2lnbjEpe2lmKGNvbXBhcmVTaWduMDwwKVxucmV0dXJuLTE7aWYoY29tcGFyZVNpZ24wPjApXG5yZXR1cm4gMTtpZihjb21wYXJlU2lnbjE8MClcbnJldHVybi0xO2lmKGNvbXBhcmVTaWduMT4wKVxucmV0dXJuIDE7cmV0dXJuIDA7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3A9ZnVuY3Rpb24oKXtqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt0aGlzLl9yZWxhdGU9bmV3IGpzdHMub3BlcmF0aW9uLnJlbGF0ZS5SZWxhdGVDb21wdXRlcih0aGlzLmFyZyk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucHJvdG90eXBlPW5ldyBqc3RzLm9wZXJhdGlvbi5HZW9tZXRyeUdyYXBoT3BlcmF0aW9uKCk7anN0cy5vcGVyYXRpb24ucmVsYXRlLlJlbGF0ZU9wLnJlbGF0ZT1mdW5jdGlvbihhLGIsYm91bmRhcnlOb2RlUnVsZSl7dmFyIHJlbE9wPW5ldyBqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AoYSxiLGJvdW5kYXJ5Tm9kZVJ1bGUpO3ZhciBpbT1yZWxPcC5nZXRJbnRlcnNlY3Rpb25NYXRyaXgoKTtyZXR1cm4gaW07fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucHJvdG90eXBlLl9yZWxhdGU9bnVsbDtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuUmVsYXRlT3AucHJvdG90eXBlLmdldEludGVyc2VjdGlvbk1hdHJpeD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWxhdGUuY29tcHV0ZUlNKCk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW49ZnVuY3Rpb24ocHRzLHN0YXJ0LGVuZCxjb250ZXh0KXt0aGlzLnB0cz1wdHM7dGhpcy5zdGFydD1zdGFydDt0aGlzLmVuZD1lbmQ7dGhpcy5jb250ZXh0PWNvbnRleHQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuc3RhcnQ9bnVsbDtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmVuZD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuZW52PW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb250ZXh0PW51bGw7anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5pZD1udWxsO2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuc2V0SWQ9ZnVuY3Rpb24oaWQpe3RoaXMuaWQ9aWQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldElkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaWQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldENvbnRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250ZXh0O307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5nZXRFbnZlbG9wZT1mdW5jdGlvbigpe2lmKHRoaXMuZW52PT1udWxsKXt2YXIgcDA9dGhpcy5wdHNbdGhpcy5zdGFydF07dmFyIHAxPXRoaXMucHRzW3RoaXMuZW5kXTt0aGlzLmVudj1uZXcganN0cy5nZW9tLkVudmVsb3BlKHAwLHAxKTt9XG5yZXR1cm4gdGhpcy5lbnY7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldFN0YXJ0SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGFydDt9O2pzdHMuaW5kZXguY2hhaW4uTW9ub3RvbmVDaGFpbi5wcm90b3R5cGUuZ2V0RW5kSW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQ7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldExpbmVTZWdtZW50PWZ1bmN0aW9uKGluZGV4LGxzKXtscy5wMD10aGlzLnB0c1tpbmRleF07bHMucDE9dGhpcy5wdHNbaW5kZXgrMV07fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7dmFyIGNvb3JkPVtdO3ZhciBpbmRleD0wO2Zvcih2YXIgaT10aGlzLnN0YXJ0O2k8PXRoaXMuZW5kO2krKyl7Y29vcmRbaW5kZXgrK109dGhpcy5wdHNbaV07fVxucmV0dXJuIGNvb3JkO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5zZWxlY3Q9ZnVuY3Rpb24oc2VhcmNoRW52LG1jcyl7dGhpcy5jb21wdXRlU2VsZWN0MihzZWFyY2hFbnYsdGhpcy5zdGFydCx0aGlzLmVuZCxtY3MpO307anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlU2VsZWN0Mj1mdW5jdGlvbihzZWFyY2hFbnYsc3RhcnQwLGVuZDAsbWNzKXt2YXIgcDA9dGhpcy5wdHNbc3RhcnQwXTt2YXIgcDE9dGhpcy5wdHNbZW5kMF07bWNzLnRlbXBFbnYxLmluaXQocDAscDEpO2lmKGVuZDAtc3RhcnQwPT09MSl7bWNzLnNlbGVjdCh0aGlzLHN0YXJ0MCk7cmV0dXJuO31cbmlmKCFzZWFyY2hFbnYuaW50ZXJzZWN0cyhtY3MudGVtcEVudjEpKVxucmV0dXJuO3ZhciBtaWQ9cGFyc2VJbnQoKHN0YXJ0MCtlbmQwKS8yKTtpZihzdGFydDA8bWlkKXt0aGlzLmNvbXB1dGVTZWxlY3QyKHNlYXJjaEVudixzdGFydDAsbWlkLG1jcyk7fVxuaWYobWlkPGVuZDApe3RoaXMuY29tcHV0ZVNlbGVjdDIoc2VhcmNoRW52LG1pZCxlbmQwLG1jcyk7fX07anN0cy5pbmRleC5jaGFpbi5Nb25vdG9uZUNoYWluLnByb3RvdHlwZS5jb21wdXRlT3ZlcmxhcHM9ZnVuY3Rpb24obWMsbWNvKXtpZihhcmd1bWVudHMubGVuZ3RoPT09Nil7cmV0dXJuIHRoaXMuY29tcHV0ZU92ZXJsYXBzMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKHRoaXMuc3RhcnQsdGhpcy5lbmQsbWMsbWMuc3RhcnQsbWMuZW5kLG1jbyk7fTtqc3RzLmluZGV4LmNoYWluLk1vbm90b25lQ2hhaW4ucHJvdG90eXBlLmNvbXB1dGVPdmVybGFwczI9ZnVuY3Rpb24oc3RhcnQwLGVuZDAsbWMsc3RhcnQxLGVuZDEsbWNvKXt2YXIgcDAwPXRoaXMucHRzW3N0YXJ0MF07dmFyIHAwMT10aGlzLnB0c1tlbmQwXTt2YXIgcDEwPW1jLnB0c1tzdGFydDFdO3ZhciBwMTE9bWMucHRzW2VuZDFdO2lmKGVuZDAtc3RhcnQwPT09MSYmZW5kMS1zdGFydDE9PT0xKXttY28ub3ZlcmxhcCh0aGlzLHN0YXJ0MCxtYyxzdGFydDEpO3JldHVybjt9XG5tY28udGVtcEVudjEuaW5pdChwMDAscDAxKTttY28udGVtcEVudjIuaW5pdChwMTAscDExKTtpZighbWNvLnRlbXBFbnYxLmludGVyc2VjdHMobWNvLnRlbXBFbnYyKSlcbnJldHVybjt2YXIgbWlkMD1wYXJzZUludCgoc3RhcnQwK2VuZDApLzIpO3ZhciBtaWQxPXBhcnNlSW50KChzdGFydDErZW5kMSkvMik7aWYoc3RhcnQwPG1pZDApe2lmKHN0YXJ0MTxtaWQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKHN0YXJ0MCxtaWQwLG1jLHN0YXJ0MSxtaWQxLG1jbyk7aWYobWlkMTxlbmQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKHN0YXJ0MCxtaWQwLG1jLG1pZDEsZW5kMSxtY28pO31cbmlmKG1pZDA8ZW5kMCl7aWYoc3RhcnQxPG1pZDEpXG50aGlzLmNvbXB1dGVPdmVybGFwczIobWlkMCxlbmQwLG1jLHN0YXJ0MSxtaWQxLG1jbyk7aWYobWlkMTxlbmQxKVxudGhpcy5jb21wdXRlT3ZlcmxhcHMyKG1pZDAsZW5kMCxtYyxtaWQxLGVuZDEsbWNvKTt9fTsoZnVuY3Rpb24oKXt2YXIgTG9jYXRpb249anN0cy5nZW9tLkxvY2F0aW9uO3ZhciBEaW1lbnNpb249anN0cy5nZW9tLkRpbWVuc2lvbjtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4PWZ1bmN0aW9uKGVsZW1lbnRzKXt2YXIgb3RoZXI9ZWxlbWVudHM7aWYoZWxlbWVudHM9PT11bmRlZmluZWR8fGVsZW1lbnRzPT09bnVsbCl7dGhpcy5tYXRyaXg9W1tdLFtdLFtdXTt0aGlzLnNldEFsbChEaW1lbnNpb24uRkFMU0UpO31lbHNlIGlmKHR5cGVvZiBlbGVtZW50cz09PSdzdHJpbmcnKXt0aGlzLnNldChlbGVtZW50cyk7fWVsc2UgaWYob3RoZXIgaW5zdGFuY2VvZiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4KXt0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdO3RoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09b3RoZXIubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV07dGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uSU5URVJJT1JdPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uSU5URVJJT1JdO3RoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV09b3RoZXIubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV07dGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXTt0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPW90aGVyLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdO3RoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09b3RoZXIubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV07dGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT1vdGhlci5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5tYXRyaXg9bnVsbDtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oaW0pe3ZhciBpLGo7Zm9yKGk9MDtpPDM7aSsrKXtmb3Ioaj0wO2o8MztqKyspe3RoaXMuc2V0QXRMZWFzdChpLGosaW0uZ2V0KGksaikpO319fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXM9ZnVuY3Rpb24oYWN0dWFsRGltZW5zaW9uVmFsdWUscmVxdWlyZWREaW1lbnNpb25TeW1ib2wpe2lmKHR5cGVvZiBhY3R1YWxEaW1lbnNpb25WYWx1ZT09PSdzdHJpbmcnKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzMi5jYWxsKHRoaXMsYXJndW1lbnRzKTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PScqJyl7cmV0dXJuIHRydWU7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nVCcmJihhY3R1YWxEaW1lbnNpb25WYWx1ZT49MHx8YWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uVFJVRSkpe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09J0YnJiZhY3R1YWxEaW1lbnNpb25WYWx1ZT09PURpbWVuc2lvbi5GQUxTRSl7cmV0dXJuIHRydWU7fVxuaWYocmVxdWlyZWREaW1lbnNpb25TeW1ib2w9PT0nMCcmJmFjdHVhbERpbWVuc2lvblZhbHVlPT09RGltZW5zaW9uLlApe3JldHVybiB0cnVlO31cbmlmKHJlcXVpcmVkRGltZW5zaW9uU3ltYm9sPT09JzEnJiZhY3R1YWxEaW1lbnNpb25WYWx1ZT09PURpbWVuc2lvbi5MKXtyZXR1cm4gdHJ1ZTt9XG5pZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbD09PScyJyYmYWN0dWFsRGltZW5zaW9uVmFsdWU9PT1EaW1lbnNpb24uQSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzMj1mdW5jdGlvbihhY3R1YWxEaW1lbnNpb25TeW1ib2xzLHJlcXVpcmVkRGltZW5zaW9uU3ltYm9scyl7dmFyIG09bmV3IGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgoYWN0dWFsRGltZW5zaW9uU3ltYm9scyk7cmV0dXJuIG0ubWF0Y2hlcyhyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMpO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHJvdyxjb2x1bW4sZGltZW5zaW9uVmFsdWUpe2lmKHR5cGVvZiByb3c9PT0nc3RyaW5nJyl7dGhpcy5zZXQyKHJvdyk7cmV0dXJuO31cbnRoaXMubWF0cml4W3Jvd11bY29sdW1uXT1kaW1lbnNpb25WYWx1ZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldDI9ZnVuY3Rpb24oZGltZW5zaW9uU3ltYm9scyl7Zm9yKHZhciBpPTA7aTxkaW1lbnNpb25TeW1ib2xzLmxlbmd0aCgpO2krKyl7dmFyIHJvdz1pLzM7dmFyIGNvbD1pJTM7dGhpcy5tYXRyaXhbcm93XVtjb2xdPURpbWVuc2lvbi50b0RpbWVuc2lvblZhbHVlKGRpbWVuc2lvblN5bWJvbHMuY2hhckF0KGkpKTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBdExlYXN0PWZ1bmN0aW9uKHJvdyxjb2x1bW4sbWluaW11bURpbWVuc2lvblZhbHVlKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7dGhpcy5zZXRBdExlYXN0Mihhcmd1bWVudHNbMF0pO3JldHVybjt9XG5pZih0aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl08bWluaW11bURpbWVuc2lvblZhbHVlKXt0aGlzLm1hdHJpeFtyb3ddW2NvbHVtbl09bWluaW11bURpbWVuc2lvblZhbHVlO319O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldEF0TGVhc3RJZlZhbGlkPWZ1bmN0aW9uKHJvdyxjb2x1bW4sbWluaW11bURpbWVuc2lvblZhbHVlKXtpZihyb3c+PTAmJmNvbHVtbj49MCl7dGhpcy5zZXRBdExlYXN0KHJvdyxjb2x1bW4sbWluaW11bURpbWVuc2lvblZhbHVlKTt9fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5zZXRBdExlYXN0Mj1mdW5jdGlvbihtaW5pbXVtRGltZW5zaW9uU3ltYm9scyl7dmFyIGk7Zm9yKGk9MDtpPG1pbmltdW1EaW1lbnNpb25TeW1ib2xzLmxlbmd0aDtpKyspe3ZhciByb3c9cGFyc2VJbnQoaS8zKTt2YXIgY29sPXBhcnNlSW50KGklMyk7dGhpcy5zZXRBdExlYXN0KHJvdyxjb2wsanN0cy5nZW9tLkRpbWVuc2lvbi50b0RpbWVuc2lvblZhbHVlKG1pbmltdW1EaW1lbnNpb25TeW1ib2xzLmNoYXJBdChpKSkpO319O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnNldEFsbD1mdW5jdGlvbihkaW1lbnNpb25WYWx1ZSl7dmFyIGFpLGJpO2ZvcihhaT0wO2FpPDM7YWkrKyl7Zm9yKGJpPTA7Ymk8MztiaSsrKXt0aGlzLm1hdHJpeFthaV1bYmldPWRpbWVuc2lvblZhbHVlO319fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24ocm93LGNvbHVtbil7cmV0dXJuIHRoaXMubWF0cml4W3Jvd11bY29sdW1uXTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzRGlzam9pbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkJPVU5EQVJZXT09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzSW50ZXJzZWN0cz1mdW5jdGlvbigpe3JldHVybiF0aGlzLmlzRGlzam9pbnQoKTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzVG91Y2hlcz1mdW5jdGlvbihkaW1lbnNpb25PZkdlb21ldHJ5QSxkaW1lbnNpb25PZkdlb21ldHJ5Qil7aWYoZGltZW5zaW9uT2ZHZW9tZXRyeUE+ZGltZW5zaW9uT2ZHZW9tZXRyeUIpe3JldHVybiB0aGlzLmlzVG91Y2hlcyhkaW1lbnNpb25PZkdlb21ldHJ5QixkaW1lbnNpb25PZkdlb21ldHJ5QSk7fVxuaWYoKGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uQSYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5BKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uTCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5MKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uTCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5BKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uUCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5BKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uUCYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PURpbWVuc2lvbi5MKSl7cmV0dXJuIHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJihqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpKTt9XG5yZXR1cm4gZmFsc2U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0Nyb3NzZXM9ZnVuY3Rpb24oZGltZW5zaW9uT2ZHZW9tZXRyeUEsZGltZW5zaW9uT2ZHZW9tZXRyeUIpe2lmKChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLlAmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uQSkpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXSwnVCcpO31cbmlmKChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uUCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uUCl8fChkaW1lbnNpb25PZkdlb21ldHJ5QT09RGltZW5zaW9uLkEmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT1EaW1lbnNpb24uTCkpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXMobWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmanN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKTt9XG5pZihkaW1lbnNpb25PZkdlb21ldHJ5QT09PURpbWVuc2lvbi5MJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09PURpbWVuc2lvbi5MKXtyZXR1cm4gdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXT09PTA7fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNXaXRoaW49ZnVuY3Rpb24oKXtyZXR1cm4ganN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT09RGltZW5zaW9uLkZBTFNFJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5CT1VOREFSWV1bTG9jYXRpb24uRVhURVJJT1JdPT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc0NvbnRhaW5zPWZ1bmN0aW9uKCl7cmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXT09RGltZW5zaW9uLkZBTFNFO307anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5wcm90b3R5cGUuaXNDb3ZlcnM9ZnVuY3Rpb24oKXt2YXIgaGFzUG9pbnRJbkNvbW1vbj1qc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpfHxqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkJPVU5EQVJZXSwnVCcpO3JldHVybiBoYXNQb2ludEluQ29tbW9uJiZ0aGlzLm1hdHJpeFtMb2NhdGlvbi5FWFRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzQ292ZXJlZEJ5PWZ1bmN0aW9uKCl7dmFyIGhhc1BvaW50SW5Db21tb249anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5JTlRFUklPUl0sJ1QnKXx8anN0cy5nZW9tLkludGVyc2VjdGlvbk1hdHJpeC5tYXRjaGVzKHRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5CT1VOREFSWV0sJ1QnKTtyZXR1cm4gaGFzUG9pbnRJbkNvbW1vbiYmdGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRSYmdGhpcy5tYXRyaXhbTG9jYXRpb24uQk9VTkRBUlldW0xvY2F0aW9uLkVYVEVSSU9SXT09PURpbWVuc2lvbi5GQUxTRTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLmlzRXF1YWxzPWZ1bmN0aW9uKGRpbWVuc2lvbk9mR2VvbWV0cnlBLGRpbWVuc2lvbk9mR2VvbWV0cnlCKXtpZihkaW1lbnNpb25PZkdlb21ldHJ5QSE9PWRpbWVuc2lvbk9mR2VvbWV0cnlCKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIGpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdLCdUJykmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5JTlRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLklOVEVSSU9SXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkVYVEVSSU9SXVtMb2NhdGlvbi5CT1VOREFSWV09PT1EaW1lbnNpb24uRkFMU0UmJnRoaXMubWF0cml4W0xvY2F0aW9uLkJPVU5EQVJZXVtMb2NhdGlvbi5FWFRFUklPUl09PT1EaW1lbnNpb24uRkFMU0U7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS5pc092ZXJsYXBzPWZ1bmN0aW9uKGRpbWVuc2lvbk9mR2VvbWV0cnlBLGRpbWVuc2lvbk9mR2VvbWV0cnlCKXtpZigoZGltZW5zaW9uT2ZHZW9tZXRyeUE9PURpbWVuc2lvbi5QJiZkaW1lbnNpb25PZkdlb21ldHJ5Qj09PURpbWVuc2lvbi5QKXx8KGRpbWVuc2lvbk9mR2VvbWV0cnlBPT1EaW1lbnNpb24uQSYmZGltZW5zaW9uT2ZHZW9tZXRyeUI9PT1EaW1lbnNpb24uQSkpe3JldHVybiBqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpO31cbmlmKGRpbWVuc2lvbk9mR2VvbWV0cnlBPT09RGltZW5zaW9uLkwmJmRpbWVuc2lvbk9mR2VvbWV0cnlCPT09RGltZW5zaW9uLkwpe3JldHVybiB0aGlzLm1hdHJpeFtMb2NhdGlvbi5JTlRFUklPUl1bTG9jYXRpb24uSU5URVJJT1JdPT0xJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uSU5URVJJT1JdW0xvY2F0aW9uLkVYVEVSSU9SXSwnVCcpJiZqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4Lm1hdGNoZXModGhpcy5tYXRyaXhbTG9jYXRpb24uRVhURVJJT1JdW0xvY2F0aW9uLklOVEVSSU9SXSwnVCcpO31cbnJldHVybiBmYWxzZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLm1hdGNoZXM9ZnVuY3Rpb24ocmVxdWlyZWREaW1lbnNpb25TeW1ib2xzKXtpZihyZXF1aXJlZERpbWVuc2lvblN5bWJvbHMubGVuZ3RoIT05KXt0aHJvdyBuZXcganN0cy5lcnJvci5JbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oJ1Nob3VsZCBiZSBsZW5ndGggOTogJytcbnJlcXVpcmVkRGltZW5zaW9uU3ltYm9scyk7fVxuZm9yKHZhciBhaT0wO2FpPDM7YWkrKyl7Zm9yKHZhciBiaT0wO2JpPDM7YmkrKyl7aWYoIWpzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgubWF0Y2hlcyh0aGlzLm1hdHJpeFthaV1bYmldLHJlcXVpcmVkRGltZW5zaW9uU3ltYm9scy5jaGFyQXQoMyphaStiaSkpKXtyZXR1cm4gZmFsc2U7fX19XG5yZXR1cm4gdHJ1ZTt9O2pzdHMuZ2VvbS5JbnRlcnNlY3Rpb25NYXRyaXgucHJvdG90eXBlLnRyYW5zcG9zZT1mdW5jdGlvbigpe3ZhciB0ZW1wPW1hdHJpeFsxXVswXTt0aGlzLm1hdHJpeFsxXVswXT10aGlzLm1hdHJpeFswXVsxXTt0aGlzLm1hdHJpeFswXVsxXT10ZW1wO3RlbXA9dGhpcy5tYXRyaXhbMl1bMF07dGhpcy5tYXRyaXhbMl1bMF09dGhpcy5tYXRyaXhbMF1bMl07dGhpcy5tYXRyaXhbMF1bMl09dGVtcDt0ZW1wPXRoaXMubWF0cml4WzJdWzFdO3RoaXMubWF0cml4WzJdWzFdPXRoaXMubWF0cml4WzFdWzJdO3RoaXMubWF0cml4WzFdWzJdPXRlbXA7cmV0dXJuIHRoaXM7fTtqc3RzLmdlb20uSW50ZXJzZWN0aW9uTWF0cml4LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBhaSxiaSxidWY9Jyc7Zm9yKGFpPTA7YWk8MzthaSsrKXtmb3IoYmk9MDtiaTwzO2JpKyspe2J1Zis9RGltZW5zaW9uLnRvRGltZW5zaW9uU3ltYm9sKHRoaXMubWF0cml4W2FpXVtiaV0pO319XG5yZXR1cm4gYnVmO307fSkoKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLkxhc3RGb3VuZFF1YWRFZGdlTG9jYXRvcj1mdW5jdGlvbihzdWJkaXYpe3RoaXMuc3ViZGl2PXN1YmRpdjt0aGlzLmxhc3RFZGdlPW51bGw7dGhpcy5pbml0KCk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLkxhc3RGb3VuZFF1YWRFZGdlTG9jYXRvci5wcm90b3R5cGUuaW5pdD1mdW5jdGlvbigpe3RoaXMubGFzdEVkZ2U9dGhpcy5maW5kRWRnZSgpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3IucHJvdG90eXBlLmZpbmRFZGdlPWZ1bmN0aW9uKCl7dmFyIGVkZ2VzPXRoaXMuc3ViZGl2LmdldEVkZ2VzKCk7cmV0dXJuIGVkZ2VzWzBdO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5MYXN0Rm91bmRRdWFkRWRnZUxvY2F0b3IucHJvdG90eXBlLmxvY2F0ZT1mdW5jdGlvbih2KXtpZighdGhpcy5sYXN0RWRnZS5pc0xpdmUoKSl7dGhpcy5pbml0KCk7fVxudmFyIGU9dGhpcy5zdWJkaXYubG9jYXRlRnJvbUVkZ2Uodix0aGlzLmxhc3RFZGdlKTt0aGlzLmxhc3RFZGdlPWU7cmV0dXJuIGU7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3Q9ZnVuY3Rpb24oZWRnZSl7dGhpcy5ub2RlTWFwPW5ldyBqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcCgpO3RoaXMuZWRnZT1lZGdlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5ub2RlTWFwPW51bGw7anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5pdGVyYXRvcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZWRnZT1udWxsO2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZ2V0RWRnZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2U7fTtqc3RzLm5vZGluZy5TZWdtZW50Tm9kZUxpc3QucHJvdG90eXBlLmFkZD1mdW5jdGlvbihpbnRQdCxzZWdtZW50SW5kZXgpe3ZhciBlaU5ldz1uZXcganN0cy5ub2RpbmcuU2VnbWVudE5vZGUodGhpcy5lZGdlLGludFB0LHNlZ21lbnRJbmRleCx0aGlzLmVkZ2UuZ2V0U2VnbWVudE9jdGFudChzZWdtZW50SW5kZXgpKTt2YXIgZWk9dGhpcy5ub2RlTWFwLmdldChlaU5ldyk7aWYoZWkhPT1udWxsKXtqc3RzLnV0aWwuQXNzZXJ0LmlzVHJ1ZShlaS5jb29yZC5lcXVhbHMyRChpbnRQdCksJ0ZvdW5kIGVxdWFsIG5vZGVzIHdpdGggZGlmZmVyZW50IGNvb3JkaW5hdGVzJyk7cmV0dXJuIGVpO31cbnRoaXMubm9kZU1hcC5wdXQoZWlOZXcsZWlOZXcpO3JldHVybiBlaU5ldzt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuYWRkRW5kcG9pbnRzPWZ1bmN0aW9uKCl7dmFyIG1heFNlZ0luZGV4PXRoaXMuZWRnZS5zaXplKCktMTt0aGlzLmFkZCh0aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZSgwKSwwKTt0aGlzLmFkZCh0aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShtYXhTZWdJbmRleCksbWF4U2VnSW5kZXgpO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5hZGRDb2xsYXBzZWROb2Rlcz1mdW5jdGlvbigpe3ZhciBjb2xsYXBzZWRWZXJ0ZXhJbmRleGVzPVtdO3RoaXMuZmluZENvbGxhcHNlc0Zyb21JbnNlcnRlZE5vZGVzKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpO3RoaXMuZmluZENvbGxhcHNlc0Zyb21FeGlzdGluZ1ZlcnRpY2VzKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpO2Zvcih2YXIgaT0wO2k8Y29sbGFwc2VkVmVydGV4SW5kZXhlcy5sZW5ndGg7aSsrKXt2YXIgdmVydGV4SW5kZXg9Y29sbGFwc2VkVmVydGV4SW5kZXhlc1tpXTt0aGlzLmFkZCh0aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZSh2ZXJ0ZXhJbmRleCksdmVydGV4SW5kZXgpO319O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZmluZENvbGxhcHNlc0Zyb21FeGlzdGluZ1ZlcnRpY2VzPWZ1bmN0aW9uKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpe2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlLnNpemUoKS0yO2krKyl7dmFyIHAwPXRoaXMuZWRnZS5nZXRDb29yZGluYXRlKGkpO3ZhciBwMT10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShpKzEpO3ZhciBwMj10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShpKzIpO2lmKHAwLmVxdWFsczJEKHAyKSl7Y29sbGFwc2VkVmVydGV4SW5kZXhlcy5wdXNoKGkrMSk7fX19O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZmluZENvbGxhcHNlc0Zyb21JbnNlcnRlZE5vZGVzPWZ1bmN0aW9uKGNvbGxhcHNlZFZlcnRleEluZGV4ZXMpe3ZhciBjb2xsYXBzZWRWZXJ0ZXhJbmRleD1bbnVsbF07dmFyIGl0PXRoaXMuaXRlcmF0b3IoKTt2YXIgZWlQcmV2PWl0Lm5leHQoKTt3aGlsZShpdC5oYXNOZXh0KCkpe3ZhciBlaT1pdC5uZXh0KCk7dmFyIGlzQ29sbGFwc2VkPXRoaXMuZmluZENvbGxhcHNlSW5kZXgoZWlQcmV2LGVpLGNvbGxhcHNlZFZlcnRleEluZGV4KTtpZihpc0NvbGxhcHNlZClcbmNvbGxhcHNlZFZlcnRleEluZGV4ZXMucHVzaChjb2xsYXBzZWRWZXJ0ZXhJbmRleFswXSk7ZWlQcmV2PWVpO319O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuZmluZENvbGxhcHNlSW5kZXg9ZnVuY3Rpb24oZWkwLGVpMSxjb2xsYXBzZWRWZXJ0ZXhJbmRleCl7aWYoIWVpMC5jb29yZC5lcXVhbHMyRChlaTEuY29vcmQpKVxucmV0dXJuIGZhbHNlO3ZhciBudW1WZXJ0aWNlc0JldHdlZW49ZWkxLnNlZ21lbnRJbmRleC1laTAuc2VnbWVudEluZGV4O2lmKCFlaTEuaXNJbnRlcmlvcigpKXtudW1WZXJ0aWNlc0JldHdlZW4tLTt9XG5pZihudW1WZXJ0aWNlc0JldHdlZW49PT0xKXtjb2xsYXBzZWRWZXJ0ZXhJbmRleFswXT1laTAuc2VnbWVudEluZGV4KzE7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5hZGRTcGxpdEVkZ2VzPWZ1bmN0aW9uKGVkZ2VMaXN0KXt0aGlzLmFkZEVuZHBvaW50cygpO3RoaXMuYWRkQ29sbGFwc2VkTm9kZXMoKTt2YXIgaXQ9dGhpcy5pdGVyYXRvcigpO3ZhciBlaVByZXY9aXQubmV4dCgpO3doaWxlKGl0Lmhhc05leHQoKSl7dmFyIGVpPWl0Lm5leHQoKTt2YXIgbmV3RWRnZT10aGlzLmNyZWF0ZVNwbGl0RWRnZShlaVByZXYsZWkpO2VkZ2VMaXN0LmFkZChuZXdFZGdlKTtlaVByZXY9ZWk7fX07anN0cy5ub2RpbmcuU2VnbWVudE5vZGVMaXN0LnByb3RvdHlwZS5jaGVja1NwbGl0RWRnZXNDb3JyZWN0bmVzcz1mdW5jdGlvbihzcGxpdEVkZ2VzKXt2YXIgZWRnZVB0cz1lZGdlLmdldENvb3JkaW5hdGVzKCk7dmFyIHNwbGl0MD1zcGxpdEVkZ2VzWzBdO3ZhciBwdDA9c3BsaXQwLmdldENvb3JkaW5hdGUoMCk7aWYoIXB0MC5lcXVhbHMyRChlZGdlUHRzWzBdKSlcbnRocm93IG5ldyBFcnJvcignYmFkIHNwbGl0IGVkZ2Ugc3RhcnQgcG9pbnQgYXQgJytwdDApO3ZhciBzcGxpdG49c3BsaXRFZGdlc1tzcGxpdEVkZ2VzLmxlbmd0aC0xXTt2YXIgc3BsaXRuUHRzPXNwbGl0bi5nZXRDb29yZGluYXRlcygpO3ZhciBwdG49c3BsaXRuUHRzW3NwbGl0blB0cy5sZW5ndGgtMV07aWYoIXB0bi5lcXVhbHMyRChlZGdlUHRzW2VkZ2VQdHMubGVuZ3RoLTFdKSlcbnRocm93IG5ldyBFcnJvcignYmFkIHNwbGl0IGVkZ2UgZW5kIHBvaW50IGF0ICcrcHRuKTt9O2pzdHMubm9kaW5nLlNlZ21lbnROb2RlTGlzdC5wcm90b3R5cGUuY3JlYXRlU3BsaXRFZGdlPWZ1bmN0aW9uKGVpMCxlaTEpe3ZhciBucHRzPWVpMS5zZWdtZW50SW5kZXgtZWkwLnNlZ21lbnRJbmRleCsyO3ZhciBsYXN0U2VnU3RhcnRQdD10aGlzLmVkZ2UuZ2V0Q29vcmRpbmF0ZShlaTEuc2VnbWVudEluZGV4KTt2YXIgdXNlSW50UHQxPWVpMS5pc0ludGVyaW9yKCl8fCFlaTEuY29vcmQuZXF1YWxzMkQobGFzdFNlZ1N0YXJ0UHQpO2lmKCF1c2VJbnRQdDEpe25wdHMtLTt9XG52YXIgcHRzPVtdO3ZhciBpcHQ9MDtwdHNbaXB0KytdPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShlaTAuY29vcmQpO2Zvcih2YXIgaT1laTAuc2VnbWVudEluZGV4KzE7aTw9ZWkxLnNlZ21lbnRJbmRleDtpKyspe3B0c1tpcHQrK109dGhpcy5lZGdlLmdldENvb3JkaW5hdGUoaSk7fVxuaWYodXNlSW50UHQxKVxucHRzW2lwdF09ZWkxLmNvb3JkO3JldHVybiBuZXcganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKHB0cyx0aGlzLmVkZ2UuZ2V0RGF0YSgpKTt9O2pzdHMuaW8uV0tUV3JpdGVyPWZ1bmN0aW9uKCl7dGhpcy5wYXJzZXI9bmV3IGpzdHMuaW8uV0tUUGFyc2VyKHRoaXMuZ2VvbWV0cnlGYWN0b3J5KTt9O2pzdHMuaW8uV0tUV3JpdGVyLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIHdrdD10aGlzLnBhcnNlci53cml0ZShnZW9tZXRyeSk7cmV0dXJuIHdrdDt9O2pzdHMuaW8uV0tUV3JpdGVyLnRvTGluZVN0cmluZz1mdW5jdGlvbihwMCxwMSl7aWYoYXJndW1lbnRzLmxlbmd0aCE9PTIpe3Rocm93IG5ldyBqc3RzLmVycm9yLk5vdEltcGxlbWVudGVkRXJyb3IoKTt9XG5yZXR1cm4nTElORVNUUklORyAoICcrcDAueCsnICcrcDAueSsnLCAnK3AxLngrJyAnK3AxLnkrJyApJzt9O2pzdHMuaW8uV0tUUmVhZGVyPWZ1bmN0aW9uKGdlb21ldHJ5RmFjdG9yeSl7dGhpcy5nZW9tZXRyeUZhY3Rvcnk9Z2VvbWV0cnlGYWN0b3J5fHxuZXcganN0cy5nZW9tLkdlb21ldHJ5RmFjdG9yeSgpO3RoaXMucHJlY2lzaW9uTW9kZWw9dGhpcy5nZW9tZXRyeUZhY3RvcnkuZ2V0UHJlY2lzaW9uTW9kZWwoKTt0aGlzLnBhcnNlcj1uZXcganN0cy5pby5XS1RQYXJzZXIodGhpcy5nZW9tZXRyeUZhY3RvcnkpO307anN0cy5pby5XS1RSZWFkZXIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24od2t0KXt2YXIgZ2VvbWV0cnk9dGhpcy5wYXJzZXIucmVhZCh3a3QpO2lmKHRoaXMucHJlY2lzaW9uTW9kZWwuZ2V0VHlwZSgpPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXt0aGlzLnJlZHVjZVByZWNpc2lvbihnZW9tZXRyeSk7fVxucmV0dXJuIGdlb21ldHJ5O307anN0cy5pby5XS1RSZWFkZXIucHJvdG90eXBlLnJlZHVjZVByZWNpc2lvbj1mdW5jdGlvbihnZW9tZXRyeSl7dmFyIGksbGVuO2lmKGdlb21ldHJ5LmNvb3JkaW5hdGUpe3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoZ2VvbWV0cnkuY29vcmRpbmF0ZSk7fWVsc2UgaWYoZ2VvbWV0cnkucG9pbnRzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5wb2ludHMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5wcmVjaXNpb25Nb2RlbC5tYWtlUHJlY2lzZShnZW9tZXRyeS5wb2ludHNbaV0pO319ZWxzZSBpZihnZW9tZXRyeS5nZW9tZXRyaWVzKXtmb3IoaT0wLGxlbj1nZW9tZXRyeS5nZW9tZXRyaWVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucmVkdWNlUHJlY2lzaW9uKGdlb21ldHJ5Lmdlb21ldHJpZXNbaV0pO319fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb249ZnVuY3Rpb24oZW52LHRvbGVyYW5jZSl7dGhpcy50b2xlcmFuY2U9dG9sZXJhbmNlO3RoaXMuZWRnZUNvaW5jaWRlbmNlVG9sZXJhbmNlPXRvbGVyYW5jZS9qc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24uRURHRV9DT0lOQ0lERU5DRV9UT0xfRkFDVE9SO3RoaXMudmlzaXRlZEtleT0wO3RoaXMucXVhZEVkZ2VzPVtdO3RoaXMuc3RhcnRpbmdFZGdlO3RoaXMudG9sZXJhbmNlO3RoaXMuZWRnZUNvaW5jaWRlbmNlVG9sZXJhbmNlO3RoaXMuZnJhbWVFbnY7dGhpcy5sb2NhdG9yPW51bGw7dGhpcy5zZWc9bmV3IGpzdHMuZ2VvbS5MaW5lU2VnbWVudCgpO3RoaXMudHJpRWRnZXM9bmV3IEFycmF5KDMpO3RoaXMuZnJhbWVWZXJ0ZXg9bmV3IEFycmF5KDMpO3RoaXMuY3JlYXRlRnJhbWUoZW52KTt0aGlzLnN0YXJ0aW5nRWRnZT10aGlzLmluaXRTdWJkaXYoKTt0aGlzLmxvY2F0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuTGFzdEZvdW5kUXVhZEVkZ2VMb2NhdG9yKHRoaXMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLkVER0VfQ09JTkNJREVOQ0VfVE9MX0ZBQ1RPUj0xMDAwO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5nZXRUcmlhbmdsZUVkZ2VzPWZ1bmN0aW9uKHN0YXJ0UUUsdHJpRWRnZSl7dHJpRWRnZVswXT1zdGFydFFFO3RyaUVkZ2VbMV09dHJpRWRnZVswXS5sTmV4dCgpO3RyaUVkZ2VbMl09dHJpRWRnZVsxXS5sTmV4dCgpO2lmKHRyaUVkZ2VbMl0ubE5leHQoKSE9dHJpRWRnZVswXSl7dGhyb3cgbmV3IGpzdHMuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0VkZ2VzIGRvIG5vdCBmb3JtIGEgdHJpYW5nbGUnKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmNyZWF0ZUZyYW1lPWZ1bmN0aW9uKGVudil7dmFyIGRlbHRhWCxkZWx0YVksb2Zmc2V0O2RlbHRhWD1lbnYuZ2V0V2lkdGgoKTtkZWx0YVk9ZW52LmdldEhlaWdodCgpO29mZnNldD0wLjA7aWYoZGVsdGFYPmRlbHRhWSl7b2Zmc2V0PWRlbHRhWCoxMC4wO31lbHNle29mZnNldD1kZWx0YVkqMTAuMDt9XG50aGlzLmZyYW1lVmVydGV4WzBdPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleCgoZW52LmdldE1heFgoKStlbnYuZ2V0TWluWCgpKS8yLjAsZW52LmdldE1heFkoKVxuK29mZnNldCk7dGhpcy5mcmFtZVZlcnRleFsxXT1uZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5WZXJ0ZXgoZW52LmdldE1pblgoKS1vZmZzZXQsZW52LmdldE1pblkoKS1vZmZzZXQpO3RoaXMuZnJhbWVWZXJ0ZXhbMl09bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KGVudi5nZXRNYXhYKCkrb2Zmc2V0LGVudi5nZXRNaW5ZKCktb2Zmc2V0KTt0aGlzLmZyYW1lRW52PW5ldyBqc3RzLmdlb20uRW52ZWxvcGUodGhpcy5mcmFtZVZlcnRleFswXS5nZXRDb29yZGluYXRlKCksdGhpcy5mcmFtZVZlcnRleFsxXS5nZXRDb29yZGluYXRlKCkpO3RoaXMuZnJhbWVFbnYuZXhwYW5kVG9JbmNsdWRlKHRoaXMuZnJhbWVWZXJ0ZXhbMl0uZ2V0Q29vcmRpbmF0ZSgpKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaW5pdFN1YmRpdj1mdW5jdGlvbigpe3ZhciBlYSxlYixlYztlYT10aGlzLm1ha2VFZGdlKHRoaXMuZnJhbWVWZXJ0ZXhbMF0sdGhpcy5mcmFtZVZlcnRleFsxXSk7ZWI9dGhpcy5tYWtlRWRnZSh0aGlzLmZyYW1lVmVydGV4WzFdLHRoaXMuZnJhbWVWZXJ0ZXhbMl0pO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGVhLnN5bSgpLGViKTtlYz10aGlzLm1ha2VFZGdlKHRoaXMuZnJhbWVWZXJ0ZXhbMl0sdGhpcy5mcmFtZVZlcnRleFswXSk7anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZS5zcGxpY2UoZWIuc3ltKCksZWMpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGVjLnN5bSgpLGVhKTtyZXR1cm4gZWE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFRvbGVyYW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvbGVyYW5jZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0RW52ZWxvcGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpzdHMuZ2VvbS5FbnZlbG9wZSh0aGlzLmZyYW1lRW52KTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0RWRnZXM9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPjApe3JldHVybiB0aGlzLmdldEVkZ2VzQnlGYWN0b3J5KGFyZ3VtZW50c1swXSk7fWVsc2V7cmV0dXJuIHRoaXMucXVhZEVkZ2VzO319O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuc2V0TG9jYXRvcj1mdW5jdGlvbihsb2NhdG9yKXt0aGlzLmxvY2F0b3I9bG9jYXRvcjt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubWFrZUVkZ2U9ZnVuY3Rpb24obyxkKXt2YXIgcT1qc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLm1ha2VFZGdlKG8sZCk7dGhpcy5xdWFkRWRnZXMucHVzaChxKTtyZXR1cm4gcTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuY29ubmVjdD1mdW5jdGlvbihhLGIpe3ZhciBxPWpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2UuY29ubmVjdChhLGIpO3RoaXMucXVhZEVkZ2VzLnB1c2gocSk7cmV0dXJuIHE7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmRlbGV0ZV9qc3RzPWZ1bmN0aW9uKGUpe2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGUsZS5vUHJldigpKTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlLnNwbGljZShlLnN5bSgpLGUuc3ltKCkub1ByZXYoKSk7dmFyIGVTeW0sZVJvdCxlUm90U3ltO2UuZVN5bT1lLnN5bSgpO2VSb3Q9ZS5yb3Q7ZVJvdFN5bT1lLnJvdC5zeW0oKTt2YXIgaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZSk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZVN5bSk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZVJvdCk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuaWR4PXRoaXMucXVhZEVkZ2VzLmluZGV4T2YoZVJvdFN5bSk7aWYoaWR4IT09LTEpe3RoaXMucXVhZEVkZ2VzLnNwbGljZShpZHgsMSk7fVxuZS5kZWxldGVfanN0cygpO2VTeW0uZGVsZXRlX2pzdHMoKTtlUm90LmRlbGV0ZV9qc3RzKCk7ZVJvdFN5bS5kZWxldGVfanN0cygpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGVGcm9tRWRnZT1mdW5jdGlvbih2LHN0YXJ0RWRnZSl7dmFyIGl0ZXI9MCxtYXhJdGVyPXRoaXMucXVhZEVkZ2VzLmxlbmd0aCxlO2U9c3RhcnRFZGdlO3doaWxlKHRydWUpe2l0ZXIrKztpZihpdGVyPm1heEl0ZXIpe3Rocm93IG5ldyBqc3RzLmVycm9yLkxvY2F0ZUZhaWx1cmVFcnJvcihlLnRvTGluZVNlZ21lbnQoKSk7fVxuaWYoKHYuZXF1YWxzKGUub3JpZygpKSl8fCh2LmVxdWFscyhlLmRlc3QoKSkpKXticmVhazt9ZWxzZSBpZih2LnJpZ2h0T2YoZSkpe2U9ZS5zeW0oKTt9ZWxzZSBpZighdi5yaWdodE9mKGUub05leHQoKSkpe2U9ZS5vTmV4dCgpO31lbHNlIGlmKCF2LnJpZ2h0T2YoZS5kUHJldigpKSl7ZT1lLmRQcmV2KCk7fWVsc2V7YnJlYWs7fX1cbnJldHVybiBlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGU9ZnVuY3Rpb24oKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MSl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleCl7cmV0dXJuIHRoaXMubG9jYXRlQnlWZXJ0ZXgoYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5sb2NhdGVCeUNvb3JkaW5hdGUoYXJndW1lbnRzWzBdKTt9fWVsc2V7cmV0dXJuIHRoaXMubG9jYXRlQnlDb29yZGluYXRlcyhhcmd1bWVudHNbMF0sYXJndW1lbnRzWzFdKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmxvY2F0ZUJ5VmVydGV4PWZ1bmN0aW9uKHYpe3JldHVybiB0aGlzLmxvY2F0b3IubG9jYXRlKHYpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5sb2NhdGVCeUNvb3JkaW5hdGU9ZnVuY3Rpb24ocCl7cmV0dXJuIHRoaXMubG9jYXRvci5sb2NhdGUobmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHApKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUubG9jYXRlQnlDb29yZGluYXRlcz1mdW5jdGlvbihwMCxwMSl7dmFyIGUsYmFzZSxsb2NFZGdlO3ZhciBlPXRoaXMubG9jYXRvci5sb2NhdGUobmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVmVydGV4KHAwKSk7aWYoZT09PW51bGwpe3JldHVybiBudWxsO31cbmJhc2U9ZTtpZihlLmRlc3QoKS5nZXRDb29yZGluYXRlKCkuZXF1YWxzMkQocDApKXtiYXNlPWUuc3ltKCk7fVxubG9jRWRnZT1iYXNlO2Rve2lmKGxvY0VkZ2UuZGVzdCgpLmdldENvb3JkaW5hdGUoKS5lcXVhbHMyRChwMSkpe3JldHVybiBsb2NFZGdlO31cbmxvY0VkZ2U9bG9jRWRnZS5vTmV4dCgpO313aGlsZShsb2NFZGdlIT1iYXNlKTtyZXR1cm4gbnVsbDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaW5zZXJ0U2l0ZT1mdW5jdGlvbih2KXt2YXIgZSxiYXNlLHN0YXJ0RWRnZTtlPXRoaXMubG9jYXRlKHYpO2lmKCh2LmVxdWFscyhlLm9yaWcoKSx0aGlzLnRvbGVyYW5jZSkpfHwodi5lcXVhbHMoZS5kZXN0KCksdGhpcy50b2xlcmFuY2UpKSl7cmV0dXJuIGU7fVxuYmFzZT10aGlzLm1ha2VFZGdlKGUub3JpZygpLHYpO2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2Uuc3BsaWNlKGJhc2UsZSk7c3RhcnRFZGdlPWJhc2U7ZG97YmFzZT10aGlzLmNvbm5lY3QoZSxiYXNlLnN5bSgpKTtlPWJhc2Uub1ByZXYoKTt9d2hpbGUoZS5sTmV4dCgpIT1zdGFydEVkZ2UpO3JldHVybiBzdGFydEVkZ2U7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmlzRnJhbWVFZGdlPWZ1bmN0aW9uKGUpe2lmKHRoaXMuaXNGcmFtZVZlcnRleChlLm9yaWcoKSl8fHRoaXMuaXNGcmFtZVZlcnRleChlLmRlc3QoKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNGcmFtZUJvcmRlckVkZ2U9ZnVuY3Rpb24oZSl7dmFyIGxlZnRUcmkscmlnaHRUcmksdkxlZnRUcmlPdGhlcix2UmlnaHRUcmlPdGhlcjtsZWZ0VHJpPW5ldyBBcnJheSgzKTt0aGlzLmdldFRyaWFuZ2xlRWRnZXMoZSxsZWZ0VHJpKTtyaWdodFRyaT1uZXcgQXJyYXkoMyk7dGhpcy5nZXRUcmlhbmdsZUVkZ2VzKGUuc3ltKCkscmlnaHRUcmkpO3ZMZWZ0VHJpT3RoZXI9ZS5sTmV4dCgpLmRlc3QoKTtpZih0aGlzLmlzRnJhbWVWZXJ0ZXgodkxlZnRUcmlPdGhlcikpe3JldHVybiB0cnVlO31cbnZSaWdodFRyaU90aGVyPWUuc3ltKCkubE5leHQoKS5kZXN0KCk7aWYodGhpcy5pc0ZyYW1lVmVydGV4KHZSaWdodFRyaU90aGVyKSl7cmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5pc0ZyYW1lVmVydGV4PWZ1bmN0aW9uKHYpe2lmKHYuZXF1YWxzKHRoaXMuZnJhbWVWZXJ0ZXhbMF0pKXtyZXR1cm4gdHJ1ZTt9XG5pZih2LmVxdWFscyh0aGlzLmZyYW1lVmVydGV4WzFdKSl7cmV0dXJuIHRydWU7fVxuaWYodi5lcXVhbHModGhpcy5mcmFtZVZlcnRleFsyXSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNPbkVkZ2U9ZnVuY3Rpb24oZSxwKXt0aGlzLnNlZy5zZXRDb29yZGluYXRlcyhlLm9yaWcoKS5nZXRDb29yZGluYXRlKCksZS5kZXN0KCkuZ2V0Q29vcmRpbmF0ZSgpKTt2YXIgZGlzdD10aGlzLnNlZy5kaXN0YW5jZShwKTtyZXR1cm4gZGlzdDx0aGlzLmVkZ2VDb2luY2lkZW5jZVRvbGVyYW5jZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuaXNWZXJ0ZXhPZkVkZ2U9ZnVuY3Rpb24oZSx2KXtpZigodi5lcXVhbHMoZS5vcmlnKCksdGhpcy50b2xlcmFuY2UpKXx8KHYuZXF1YWxzKGUuZGVzdCgpLHRoaXMudG9sZXJhbmNlKSkpe3JldHVybiB0cnVlO31cbnJldHVybiBmYWxzZTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VmVydGljZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKVxue3ZhciB2ZXJ0aWNlcz1bXSxpLGlsLHFlLHYsdmQ7aT0wLGlsPXRoaXMucXVhZEVkZ2VzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7cWU9dGhpcy5xdWFkRWRnZXNbaV07dj1xZS5vcmlnKCk7aWYoaW5jbHVkZUZyYW1lfHwhdGhpcy5pc0ZyYW1lVmVydGV4KHYpKXt2ZXJ0aWNlcy5wdXNoKHYpO31cbnZkPXFlLmRlc3QoKTtpZihpbmNsdWRlRnJhbWV8fCF0aGlzLmlzRnJhbWVWZXJ0ZXgodmQpKXt2ZXJ0aWNlcy5wdXNoKHZkKTt9fVxucmV0dXJuIHZlcnRpY2VzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRWZXJ0ZXhVbmlxdWVFZGdlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpXG57dmFyIGVkZ2VzLHZpc2l0ZWRWZXJ0aWNlcyxpLGlsLHFlLHYscWQsdmQ7ZWRnZXM9W107dmlzaXRlZFZlcnRpY2VzPVtdO2k9MCxpbD10aGlzLnF1YWRFZGdlcy5sZW5ndGg7Zm9yKGk7aTxpbDtpKyspe3FlPXRoaXMucXVhZEVkZ2VzW2ldO3Y9cWUub3JpZygpO2lmKHZpc2l0ZWRWZXJ0aWNlcy5pbmRleE9mKHYpPT09LTEpe3Zpc2l0ZWRWZXJ0aWNlcy5wdXNoKHYpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZVZlcnRleCh2KSl7ZWRnZXMucHVzaChxZSk7fX1cbnFkPXFlLnN5bSgpO3ZkPXFkLm9yaWcoKTtpZih2aXNpdGVkVmVydGljZXMuaW5kZXhPZih2ZCk9PT0tMSl7dmlzaXRlZFZlcnRpY2VzLnB1c2godmQpO2lmKGluY2x1ZGVGcmFtZXx8IXRoaXMuaXNGcmFtZVZlcnRleCh2ZCkpe2VkZ2VzLnB1c2gocWQpO319fVxucmV0dXJuIGVkZ2VzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRQcmltYXJ5RWRnZXM9ZnVuY3Rpb24oaW5jbHVkZUZyYW1lKXt0aGlzLnZpc2l0ZWRLZXkrKzt2YXIgZWRnZXMsZWRnZVN0YWNrLHZpc2l0ZWRFZGdlcyxlZGdlLHByaVFFO2VkZ2VzPVtdO2VkZ2VTdGFjaz1bXTtlZGdlU3RhY2sucHVzaCh0aGlzLnN0YXJ0aW5nRWRnZSk7dmlzaXRlZEVkZ2VzPVtdO3doaWxlKGVkZ2VTdGFjay5sZW5ndGg+MCl7ZWRnZT1lZGdlU3RhY2sucG9wKCk7aWYodmlzaXRlZEVkZ2VzLmluZGV4T2YoZWRnZSk9PT0tMSl7cHJpUUU9ZWRnZS5nZXRQcmltYXJ5KCk7aWYoaW5jbHVkZUZyYW1lfHwhdGhpcy5pc0ZyYW1lRWRnZShwcmlRRSkpe2VkZ2VzLnB1c2gocHJpUUUpO31cbmVkZ2VTdGFjay5wdXNoKGVkZ2Uub05leHQoKSk7ZWRnZVN0YWNrLnB1c2goZWRnZS5zeW0oKS5vTmV4dCgpKTt2aXNpdGVkRWRnZXMucHVzaChlZGdlKTt2aXNpdGVkRWRnZXMucHVzaChlZGdlLnN5bSgpKTt9fVxucmV0dXJuIGVkZ2VzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS52aXNpdFRyaWFuZ2xlcz1mdW5jdGlvbih0cmlWaXNpdG9yLGluY2x1ZGVGcmFtZSl7dGhpcy52aXNpdGVkS2V5Kys7dmFyIGVkZ2VTdGFjayx2aXNpdGVkRWRnZXMsZWRnZSx0cmlFZGdlcztlZGdlU3RhY2s9W107ZWRnZVN0YWNrLnB1c2godGhpcy5zdGFydGluZ0VkZ2UpO3Zpc2l0ZWRFZGdlcz1bXTt3aGlsZShlZGdlU3RhY2subGVuZ3RoPjApe2VkZ2U9ZWRnZVN0YWNrLnBvcCgpO2lmKHZpc2l0ZWRFZGdlcy5pbmRleE9mKGVkZ2UpPT09LTEpe3RyaUVkZ2VzPXRoaXMuZmV0Y2hUcmlhbmdsZVRvVmlzaXQoZWRnZSxlZGdlU3RhY2ssaW5jbHVkZUZyYW1lLHZpc2l0ZWRFZGdlcyk7aWYodHJpRWRnZXMhPT1udWxsKVxudHJpVmlzaXRvci52aXNpdCh0cmlFZGdlcyk7fX19O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZmV0Y2hUcmlhbmdsZVRvVmlzaXQ9ZnVuY3Rpb24oZWRnZSxlZGdlU3RhY2ssaW5jbHVkZUZyYW1lLHZpc2l0ZWRFZGdlcyl7dmFyIGN1cnIsZWRnZUNvdW50LGlzRnJhbWUsc3ltO2N1cnI9ZWRnZTtlZGdlQ291bnQ9MDtpc0ZyYW1lPWZhbHNlO2Rve3RoaXMudHJpRWRnZXNbZWRnZUNvdW50XT1jdXJyO2lmKHRoaXMuaXNGcmFtZUVkZ2UoY3Vycikpe2lzRnJhbWU9dHJ1ZTt9XG5zeW09Y3Vyci5zeW0oKTtpZih2aXNpdGVkRWRnZXMuaW5kZXhPZihzeW0pPT09LTEpe2VkZ2VTdGFjay5wdXNoKHN5bSk7fVxudmlzaXRlZEVkZ2VzLnB1c2goY3Vycik7ZWRnZUNvdW50Kys7Y3Vycj1jdXJyLmxOZXh0KCk7fXdoaWxlKGN1cnIhPT1lZGdlKTtpZihpc0ZyYW1lJiYhaW5jbHVkZUZyYW1lKXtyZXR1cm4gbnVsbDt9XG5yZXR1cm4gdGhpcy50cmlFZGdlczt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVFZGdlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpe3ZhciB2aXNpdG9yPW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvcigpO3RoaXMudmlzaXRUcmlhbmdsZXModmlzaXRvcixpbmNsdWRlRnJhbWUpO3JldHVybiB2aXNpdG9yLmdldFRyaWFuZ2xlRWRnZXMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0VHJpYW5nbGVWZXJ0aWNlcz1mdW5jdGlvbihpbmNsdWRlRnJhbWUpe3ZhciB2aXNpdG9yPW5ldyBUcmlhbmdsZVZlcnRleExpc3RWaXNpdG9yKCk7dGhpcy52aXNpdFRyaWFuZ2xlcyh2aXNpdG9yLGluY2x1ZGVGcmFtZSk7cmV0dXJuIHZpc2l0b3IuZ2V0VHJpYW5nbGVWZXJ0aWNlcygpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRUcmlhbmdsZUNvb3JkaW5hdGVzPWZ1bmN0aW9uKGluY2x1ZGVGcmFtZSl7dmFyIHZpc2l0b3I9bmV3IGpzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDb29yZGluYXRlc1Zpc2l0b3IoKTt0aGlzLnZpc2l0VHJpYW5nbGVzKHZpc2l0b3IsaW5jbHVkZUZyYW1lKTtyZXR1cm4gdmlzaXRvci5nZXRUcmlhbmdsZXMoKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0RWRnZXNCeUZhY3Rvcnk9ZnVuY3Rpb24oZ2VvbUZhY3Qpe3ZhciBxdWFkRWRnZXMsZWRnZXMsaSxpbCxxZSxjb29yZHM7cXVhZEVkZ2VzPXRoaXMuZ2V0UHJpbWFyeUVkZ2VzKGZhbHNlKTtlZGdlcz1bXTtpPTA7aWw9cXVhZEVkZ2VzLmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7cWU9cXVhZEVkZ2VzW2ldO2Nvb3Jkcz1bXTtjb29yZHNbMF09KHFlLm9yaWcoKS5nZXRDb29yZGluYXRlKCkpO2Nvb3Jkc1sxXT0ocWUuZGVzdCgpLmdldENvb3JkaW5hdGUoKSk7ZWRnZXNbaV09Z2VvbUZhY3QuY3JlYXRlTGluZVN0cmluZyhjb29yZHMpO31cbnJldHVybiBnZW9tRmFjdC5jcmVhdGVNdWx0aUxpbmVTdHJpbmcoZWRnZXMpO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRUcmlhbmdsZXM9ZnVuY3Rpb24oZ2VvbUZhY3Qpe3ZhciB0cmlQdHNMaXN0LHRyaXMsdHJpUHQsaSxpbDt0cmlQdHNMaXN0PXRoaXMuZ2V0VHJpYW5nbGVDb29yZGluYXRlcyhmYWxzZSk7dHJpcz1uZXcgQXJyYXkodHJpUHRzTGlzdC5sZW5ndGgpO2k9MCxpbD10cmlQdHNMaXN0Lmxlbmd0aDtmb3IoaTtpPGlsO2krKyl7dHJpUHQ9dHJpUHRzTGlzdFtpXTt0cmlzW2ldPWdlb21GYWN0LmNyZWF0ZVBvbHlnb24oZ2VvbUZhY3QuY3JlYXRlTGluZWFyUmluZyh0cmlQdCxudWxsKSk7fVxucmV0dXJuIGdlb21GYWN0LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbih0cmlzKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuUXVhZEVkZ2VTdWJkaXZpc2lvbi5wcm90b3R5cGUuZ2V0Vm9yb25vaURpYWdyYW09ZnVuY3Rpb24oZ2VvbUZhY3QpXG57dmFyIHZvckNlbGxzPXRoaXMuZ2V0Vm9yb25vaUNlbGxQb2x5Z29ucyhnZW9tRmFjdCk7cmV0dXJuIGdlb21GYWN0LmNyZWF0ZUdlb21ldHJ5Q29sbGVjdGlvbih2b3JDZWxscyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlF1YWRFZGdlU3ViZGl2aXNpb24ucHJvdG90eXBlLmdldFZvcm9ub2lDZWxsUG9seWdvbnM9ZnVuY3Rpb24oZ2VvbUZhY3QpXG57dGhpcy52aXNpdFRyaWFuZ2xlcyhuZXcganN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNpcmN1bWNlbnRyZVZpc2l0b3IoKSx0cnVlKTt2YXIgY2VsbHMsZWRnZXMsaSxpbCxxZTtjZWxscz1bXTtlZGdlcz10aGlzLmdldFZlcnRleFVuaXF1ZUVkZ2VzKGZhbHNlKTtpPTAsaWw9ZWRnZXMubGVuZ3RoO2ZvcihpO2k8aWw7aSsrKXtxZT1lZGdlc1tpXTtjZWxscy5wdXNoKHRoaXMuZ2V0Vm9yb25vaUNlbGxQb2x5Z29uKHFlLGdlb21GYWN0KSk7fVxucmV0dXJuIGNlbGxzO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5RdWFkRWRnZVN1YmRpdmlzaW9uLnByb3RvdHlwZS5nZXRWb3Jvbm9pQ2VsbFBvbHlnb249ZnVuY3Rpb24ocWUsZ2VvbUZhY3QpXG57dmFyIGNlbGxQdHMsc3RhcnRRZSxjYyxjb29yZExpc3QsY2VsbFBvbHksdjtjZWxsUHRzPVtdO3N0YXJ0UUU9cWU7ZG97Y2M9cWUucm90Lm9yaWcoKS5nZXRDb29yZGluYXRlKCk7Y2VsbFB0cy5wdXNoKGNjKTtxZT1xZS5vUHJldigpO313aGlsZShxZSE9PXN0YXJ0UUUpO2Nvb3JkTGlzdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVMaXN0KFtdLGZhbHNlKTtjb29yZExpc3QuYWRkKGNlbGxQdHMsZmFsc2UpO2Nvb3JkTGlzdC5jbG9zZVJpbmcoKTtpZihjb29yZExpc3Quc2l6ZSgpPDQpe2Nvb3JkTGlzdC5hZGQoY29vcmRMaXN0LmdldChjb29yZExpc3Quc2l6ZSgpLTEpLHRydWUpO31cbmNlbGxQb2x5PWdlb21GYWN0LmNyZWF0ZVBvbHlnb24oZ2VvbUZhY3QuY3JlYXRlTGluZWFyUmluZyhjb29yZExpc3QudG9BcnJheSgpKSxudWxsKTt2PXN0YXJ0UUUub3JpZygpO3JldHVybiBjZWxsUG9seTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVDaXJjdW1jZW50cmVWaXNpdG9yPWZ1bmN0aW9uKCl7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ2lyY3VtY2VudHJlVmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3ZhciBhLGIsYyxjYyxjY1ZlcnRleCxpO2E9dHJpRWRnZXNbMF0ub3JpZygpLmdldENvb3JkaW5hdGUoKTtiPXRyaUVkZ2VzWzFdLm9yaWcoKS5nZXRDb29yZGluYXRlKCk7Yz10cmlFZGdlc1syXS5vcmlnKCkuZ2V0Q29vcmRpbmF0ZSgpO2NjPWpzdHMuZ2VvbS5UcmlhbmdsZS5jaXJjdW1jZW50cmUoYSxiLGMpO2NjVmVydGV4PW5ldyBqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlZlcnRleChjYyk7aT0wO2ZvcihpO2k8MztpKyspe3RyaUVkZ2VzW2ldLnJvdC5zZXRPcmlnKGNjVmVydGV4KTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlRWRnZXNMaXN0VmlzaXRvcj1mdW5jdGlvbigpe3RoaXMudHJpTGlzdD1bXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVFZGdlc0xpc3RWaXNpdG9yLnByb3RvdHlwZS52aXNpdD1mdW5jdGlvbih0cmlFZGdlcyl7dmFyIGNsb25lPXRyaUVkZ2VzLmNvbmNhdCgpO3RoaXMudHJpTGlzdC5wdXNoKGNsb25lKTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVFZGdlc0xpc3RWaXNpdG9yLnByb3RvdHlwZS5nZXRUcmlhbmdsZUVkZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJpTGlzdDt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVWZXJ0ZXhMaXN0VmlzaXRvcj1mdW5jdGlvbigpe3RoaXMudHJpTGlzdD1bXTt9O2pzdHMudHJpYW5ndWxhdGUucXVhZGVkZ2UuVHJpYW5nbGVWZXJ0ZXhMaXN0VmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3ZhciB2ZXJ0aWNlcz1bXTt2ZXJ0aWNlcy5wdXNoKHRyaWVFZGdlc1swXS5vcmlnKCkpO3ZlcnRpY2VzLnB1c2godHJpZUVkZ2VzWzFdLm9yaWcoKSk7dmVydGljZXMucHVzaCh0cmllRWRnZXNbMl0ub3JpZygpKTt0aGlzLnRyaUxpc3QucHVzaCh2ZXJ0aWNlcyk7fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlVmVydGV4TGlzdFZpc2l0b3IucHJvdG90eXBlLmdldFRyaWFuZ2xlVmVydGljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmlMaXN0O307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNvb3JkaW5hdGVzVmlzaXRvcj1mdW5jdGlvbigpe3RoaXMuY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoW10sZmFsc2UpO3RoaXMudHJpQ29vcmRzPVtdO307anN0cy50cmlhbmd1bGF0ZS5xdWFkZWRnZS5UcmlhbmdsZUNvb3JkaW5hdGVzVmlzaXRvci5wcm90b3R5cGUudmlzaXQ9ZnVuY3Rpb24odHJpRWRnZXMpe3RoaXMuY29vcmRMaXN0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUxpc3QoW10sZmFsc2UpO3ZhciBpPTAsdixwdHM7Zm9yKGk7aTwzO2krKyl7dj10cmlFZGdlc1tpXS5vcmlnKCk7dGhpcy5jb29yZExpc3QuYWRkKHYuZ2V0Q29vcmRpbmF0ZSgpKTt9XG5pZih0aGlzLmNvb3JkTGlzdC5zaXplKCk+MCl7dGhpcy5jb29yZExpc3QuY2xvc2VSaW5nKCk7cHRzPXRoaXMuY29vcmRMaXN0LnRvQXJyYXkoKTtpZihwdHMubGVuZ3RoIT09NCl7cmV0dXJuO31cbnRoaXMudHJpQ29vcmRzLnB1c2gocHRzKTt9fTtqc3RzLnRyaWFuZ3VsYXRlLnF1YWRlZGdlLlRyaWFuZ2xlQ29vcmRpbmF0ZXNWaXNpdG9yLnByb3RvdHlwZS5nZXRUcmlhbmdsZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmlDb29yZHM7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZT1mdW5jdGlvbigpe3RoaXMuZWRnZUVuZHM9W107dmFyIGU9YXJndW1lbnRzWzBdaW5zdGFuY2VvZiBqc3RzLmdlb21ncmFwaC5FZGdlRW5kP2FyZ3VtZW50c1swXTphcmd1bWVudHNbMV07dmFyIGVkZ2U9ZS5nZXRFZGdlKCk7dmFyIGNvb3JkPWUuZ2V0Q29vcmRpbmF0ZSgpO3ZhciBkaXJDb29yZD1lLmdldERpcmVjdGVkQ29vcmRpbmF0ZSgpO3ZhciBsYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoZS5nZXRMYWJlbCgpKTtqc3RzLmdlb21ncmFwaC5FZGdlRW5kLmNhbGwodGhpcyxlZGdlLGNvb3JkLGRpckNvb3JkLGxhYmVsKTt0aGlzLmluc2VydChlKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZUVuZCgpO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5lZGdlRW5kcz1udWxsO2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5nZXRMYWJlbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxhYmVsO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmdldEVkZ2VFbmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWRnZUVuZHM7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuaW5zZXJ0PWZ1bmN0aW9uKGUpe3RoaXMuZWRnZUVuZHMucHVzaChlKTt9O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5jb21wdXRlTGFiZWw9ZnVuY3Rpb24oYm91bmRhcnlOb2RlUnVsZSl7dmFyIGlzQXJlYT1mYWxzZTtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUVuZHMubGVuZ3RoO2krKyl7dmFyIGU9dGhpcy5lZGdlRW5kc1tpXTtpZihlLmdldExhYmVsKCkuaXNBcmVhKCkpXG5pc0FyZWE9dHJ1ZTt9XG5pZihpc0FyZWEpXG50aGlzLmxhYmVsPW5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbChqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSxqc3RzLmdlb20uTG9jYXRpb24uTk9ORSk7ZWxzZVxudGhpcy5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoanN0cy5nZW9tLkxvY2F0aW9uLk5PTkUpO2Zvcih2YXIgaT0wO2k8MjtpKyspe3RoaXMuY29tcHV0ZUxhYmVsT24oaSxib3VuZGFyeU5vZGVSdWxlKTtpZihpc0FyZWEpXG50aGlzLmNvbXB1dGVMYWJlbFNpZGVzKGkpO319O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS5jb21wdXRlTGFiZWxPbj1mdW5jdGlvbihnZW9tSW5kZXgsYm91bmRhcnlOb2RlUnVsZSl7dmFyIGJvdW5kYXJ5Q291bnQ9MDt2YXIgZm91bmRJbnRlcmlvcj1mYWxzZTtmb3IodmFyIGk9MDtpPHRoaXMuZWRnZUVuZHMubGVuZ3RoO2krKyl7dmFyIGU9dGhpcy5lZGdlRW5kc1tpXTt2YXIgbG9jPWUuZ2V0TGFiZWwoKS5nZXRMb2NhdGlvbihnZW9tSW5kZXgpO2lmKGxvYz09anN0cy5nZW9tLkxvY2F0aW9uLkJPVU5EQVJZKVxuYm91bmRhcnlDb3VudCsrO2lmKGxvYz09anN0cy5nZW9tLkxvY2F0aW9uLklOVEVSSU9SKVxuZm91bmRJbnRlcmlvcj10cnVlO31cbnZhciBsb2M9anN0cy5nZW9tLkxvY2F0aW9uLk5PTkU7aWYoZm91bmRJbnRlcmlvcilcbmxvYz1qc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1I7aWYoYm91bmRhcnlDb3VudD4wKXtsb2M9anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5kZXRlcm1pbmVCb3VuZGFyeShib3VuZGFyeU5vZGVSdWxlLGJvdW5kYXJ5Q291bnQpO31cbnRoaXMubGFiZWwuc2V0TG9jYXRpb24oZ2VvbUluZGV4LGxvYyk7fTtqc3RzLm9wZXJhdGlvbi5yZWxhdGUuRWRnZUVuZEJ1bmRsZS5wcm90b3R5cGUuY29tcHV0ZUxhYmVsU2lkZXM9ZnVuY3Rpb24oZ2VvbUluZGV4KXt0aGlzLmNvbXB1dGVMYWJlbFNpZGUoZ2VvbUluZGV4LGpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uLkxFRlQpO3RoaXMuY29tcHV0ZUxhYmVsU2lkZShnZW9tSW5kZXgsanN0cy5nZW9tZ3JhcGguUG9zaXRpb24uUklHSFQpO307anN0cy5vcGVyYXRpb24ucmVsYXRlLkVkZ2VFbmRCdW5kbGUucHJvdG90eXBlLmNvbXB1dGVMYWJlbFNpZGU9ZnVuY3Rpb24oZ2VvbUluZGV4LHNpZGUpe2Zvcih2YXIgaT0wO2k8dGhpcy5lZGdlRW5kcy5sZW5ndGg7aSsrKXt2YXIgZT10aGlzLmVkZ2VFbmRzW2ldO2lmKGUuZ2V0TGFiZWwoKS5pc0FyZWEoKSl7dmFyIGxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oZ2VvbUluZGV4LHNpZGUpO2lmKGxvYz09PWpzdHMuZ2VvbS5Mb2NhdGlvbi5JTlRFUklPUil7dGhpcy5sYWJlbC5zZXRMb2NhdGlvbihnZW9tSW5kZXgsc2lkZSxqc3RzLmdlb20uTG9jYXRpb24uSU5URVJJT1IpO3JldHVybjt9ZWxzZSBpZihsb2M9PT1qc3RzLmdlb20uTG9jYXRpb24uRVhURVJJT1IpXG50aGlzLmxhYmVsLnNldExvY2F0aW9uKGdlb21JbmRleCxzaWRlLGpzdHMuZ2VvbS5Mb2NhdGlvbi5FWFRFUklPUik7fX19O2pzdHMub3BlcmF0aW9uLnJlbGF0ZS5FZGdlRW5kQnVuZGxlLnByb3RvdHlwZS51cGRhdGVJTT1mdW5jdGlvbihpbSl7anN0cy5nZW9tZ3JhcGguRWRnZS51cGRhdGVJTSh0aGlzLmxhYmVsLGltKTt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZT1mdW5jdGlvbih0b2xlcmFuY2Upe3ZhciB0b2w9MC4wO2lmKHRvbGVyYW5jZSE9PXVuZGVmaW5lZCl7dG9sPXRvbGVyYW5jZTt9XG50aGlzLnJvb3Q9bnVsbDt0aGlzLmxhc3Q9bnVsbDt0aGlzLm51bWJlck9mTm9kZXM9MDt0aGlzLnRvbGVyYW5jZT10b2w7fTtqc3RzLmluZGV4LmtkdHJlZS5LZFRyZWUucHJvdG90eXBlLmluc2VydD1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5pbnNlcnRDb29yZGluYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gdGhpcy5pbnNlcnRXaXRoRGF0YS5hcHBseSh0aGlzLGFyZ3VtZW50c1swXSxhcmd1bWVudHNbMV0pO319O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUuaW5zZXJ0Q29vcmRpbmF0ZT1mdW5jdGlvbihwKXtyZXR1cm4gdGhpcy5pbnNlcnRXaXRoRGF0YShwLG51bGwpO307anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5pbnNlcnRXaXRoRGF0YT1mdW5jdGlvbihwLGRhdGEpe2lmKHRoaXMucm9vdD09PW51bGwpe3RoaXMucm9vdD1uZXcganN0cy5pbmRleC5rZHRyZWUuS2ROb2RlKHAsZGF0YSk7cmV0dXJuIHRoaXMucm9vdDt9XG52YXIgY3VycmVudE5vZGU9dGhpcy5yb290LGxlYWZOb2RlPXRoaXMucm9vdCxpc09kZExldmVsPXRydWUsaXNMZXNzVGhhbj10cnVlO3doaWxlKGN1cnJlbnROb2RlIT09bGFzdCl7aWYoaXNPZGRMZXZlbCl7aXNMZXNzVGhhbj1wLng8Y3VycmVudE5vZGUuZ2V0WCgpO31lbHNle2lzTGVzc1RoYW49cC55PGN1cnJlbnROb2RlLmdldFkoKTt9XG5sZWFmTm9kZT1jdXJyZW50Tm9kZTtpZihpc0xlc3NUaGFuKXtjdXJyZW50Tm9kZT1jdXJyZW50Tm9kZS5nZXRMZWZ0KCk7fWVsc2V7Y3VycmVudE5vZGU9Y3VycmVudE5vZGUuZ2V0UmlnaHQoKTt9XG5pZihjdXJyZW50Tm9kZSE9PW51bGwpe3ZhciBpc0luVG9sZXJhbmNlPXAuZGlzdGFuY2UoY3VycmVudE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKTw9dGhpcy50b2xlcmFuY2U7aWYoaXNJblRvbGVyYW5jZSl7Y3VycmVudE5vZGUuaW5jcmVtZW50KCk7cmV0dXJuIGN1cnJlbnROb2RlO319XG5pc09kZExldmVsPSFpc09kZExldmVsO31cbnRoaXMubnVtYmVyT2ZOb2Rlcz1udW1iZXJPZk5vZGVzKzE7dmFyIG5vZGU9bmV3IGpzdHMuaW5kZXgua2R0cmVlLktkTm9kZShwLGRhdGEpO25vZGUuc2V0TGVmdCh0aGlzLmxhc3QpO25vZGUuc2V0UmlnaHQodGhpcy5sYXN0KTtpZihpc0xlc3NUaGFuKXtsZWFmTm9kZS5zZXRMZWZ0KG5vZGUpO31lbHNle2xlYWZOb2RlLnNldFJpZ2h0KG5vZGUpO31cbnJldHVybiBub2RlO307anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5xdWVyeU5vZGU9ZnVuY3Rpb24oY3VycmVudE5vZGUsYm90dG9tTm9kZSxxdWVyeUVudixvZGQscmVzdWx0KXtpZihjdXJyZW50Tm9kZT09PWJvdHRvbU5vZGUpe3JldHVybjt9XG52YXIgbWluLG1heCxkaXNjcmltaW5hbnQ7aWYob2RkKXttaW49cXVlcnlFbnYuZ2V0TWluWCgpO21heD1xdWVyeUVudi5nZXRNYXhYKCk7ZGlzY3JpbWluYW50PWN1cnJlbnROb2RlLmdldFgoKTt9ZWxzZXttaW49cXVlcnlFbnYuZ2V0TWluWSgpO21heD1xdWVyeUVudi5nZXRNYXhZKCk7ZGlzY3JpbWluYW50PWN1cnJlbnROb2RlLmdldFkoKTt9XG52YXIgc2VhcmNoTGVmdD1taW48ZGlzY3JpbWluYW50O3ZhciBzZWFyY2hSaWdodD1kaXNjcmltaW5hbnQ8PW1heDtpZihzZWFyY2hMZWZ0KXt0aGlzLnF1ZXJ5Tm9kZShjdXJyZW50Tm9kZS5nZXRMZWZ0KCksYm90dG9tTm9kZSxxdWVyeUVudiwhb2RkLHJlc3VsdCk7fVxuaWYocXVlcnlFbnYuY29udGFpbnMoY3VycmVudE5vZGUuZ2V0Q29vcmRpbmF0ZSgpKSl7cmVzdWx0LmFkZChjdXJyZW50Tm9kZSk7fVxuaWYoc2VhcmNoUmlnaHQpe3RoaXMucXVlcnlOb2RlKGN1cnJlbnROb2RlLmdldFJpZ2h0KCksYm90dG9tTm9kZSxxdWVyeUVudiwhb2RkLHJlc3VsdCk7fX07anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5xdWVyeT1mdW5jdGlvbigpe2lmKGFyZ3VtZW50cy5sZW5ndGg9PT0xKXtyZXR1cm4gdGhpcy5xdWVyeUJ5RW52ZWxvcGUuYXBwbHkodGhpcyxhcmd1bWVudHNbMF0pO31lbHNle3JldHVybiB0aGlzLnF1ZXJ5V2l0aEFycmF5LmFwcGx5KHRoaXMsYXJndW1lbnRzWzBdLGFyZ3VtZW50c1sxXSk7fX07anN0cy5pbmRleC5rZHRyZWUuS2RUcmVlLnByb3RvdHlwZS5xdWVyeUJ5RW52ZWxvcGU9ZnVuY3Rpb24ocXVlcnlFbnYpe3ZhciByZXN1bHQ9W107dGhpcy5xdWVyeU5vZGUodGhpcy5yb290LHRoaXMubGFzdCxxdWVyeUVudix0cnVlLHJlc3VsdCk7cmV0dXJuIHJlc3VsdDt9O2pzdHMuaW5kZXgua2R0cmVlLktkVHJlZS5wcm90b3R5cGUucXVlcnlXaXRoQXJyYXk9ZnVuY3Rpb24ocXVlcnlFbnYscmVzdWx0KXt0aGlzLnF1ZXJ5Tm9kZSh0aGlzLnJvb3QsdGhpcy5sYXN0LHF1ZXJ5RW52LHRydWUscmVzdWx0KTt9O2pzdHMuZ2VvbS5UcmlhbmdsZT1mdW5jdGlvbihwMCxwMSxwMil7dGhpcy5wMD1wMDt0aGlzLnAxPXAxO3RoaXMucDI9cDI7fTtqc3RzLmdlb20uVHJpYW5nbGUuaXNBY3V0ZT1mdW5jdGlvbihhLGIsYyl7aWYoIWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGUoYSxiLGMpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGUoYixjLGEpKXtyZXR1cm4gZmFsc2U7fVxuaWYoIWpzdHMuYWxnb3JpdGhtLkFuZ2xlLmlzQWN1dGUoYyxhLGIpKXtyZXR1cm4gZmFsc2U7fVxucmV0dXJuIHRydWU7fTtqc3RzLmdlb20uVHJpYW5nbGUucGVycGVuZGljdWxhckJpc2VjdG9yPWZ1bmN0aW9uKGEsYil7dmFyIGR4LGR5LGwxLGwyO2R4PWIueC1hLng7ZHk9Yi55LWEueTtsMT1uZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUoYS54K2R4LzIuMCxhLnkrZHkvMi4wLDEuMCk7bDI9bmV3IGpzdHMuYWxnb3JpdGhtLkhDb29yZGluYXRlKGEueC1keStkeC8yLjAsYS55K2R4K2R5LzIuMCwxLjApO3JldHVybiBuZXcganN0cy5hbGdvcml0aG0uSENvb3JkaW5hdGUobDEsbDIpO307anN0cy5nZW9tLlRyaWFuZ2xlLmNpcmN1bWNlbnRyZT1mdW5jdGlvbihhLGIsYyl7dmFyIGN4LGN5LGF4LGF5LGJ4LGJ5LGRlbm9tLG51bXgsbnVteSxjY3gsY2N5O2N4PWMueDtjeT1jLnk7YXg9YS54LWN4O2F5PWEueS1jeTtieD1iLngtY3g7Ynk9Yi55LWN5O2Rlbm9tPTIqanN0cy5nZW9tLlRyaWFuZ2xlLmRldChheCxheSxieCxieSk7bnVteD1qc3RzLmdlb20uVHJpYW5nbGUuZGV0KGF5LGF4KmF4K2F5KmF5LGJ5LGJ4KmJ4K2J5KmJ5KTtudW15PWpzdHMuZ2VvbS5UcmlhbmdsZS5kZXQoYXgsYXgqYXgrYXkqYXksYngsYngqYngrYnkqYnkpO2NjeD1jeC1udW14L2Rlbm9tO2NjeT1jeStudW15L2Rlbm9tO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoY2N4LGNjeSk7fTtqc3RzLmdlb20uVHJpYW5nbGUuZGV0PWZ1bmN0aW9uKG0wMCxtMDEsbTEwLG0xMSl7cmV0dXJuIG0wMCptMTEtbTAxKm0xMDt9O2pzdHMuZ2VvbS5UcmlhbmdsZS5pbkNlbnRyZT1mdW5jdGlvbihhLGIsYyl7dmFyIGxlbjAsbGVuMSxsZW4yLGNpcmN1bSxpbkNlbnRyZVgsaW5DZW50cmVZO2xlbjA9Yi5kaXN0YW5jZShjKTtsZW4xPWEuZGlzdGFuY2UoYyk7bGVuMj1hLmRpc3RhbmNlKGIpO2NpcmN1bT1sZW4wK2xlbjErbGVuMjtpbkNlbnRyZVg9KGxlbjAqYS54K2xlbjEqYi54K2xlbjIqYy54KS9jaXJjdW07aW5DZW50cmVZPShsZW4wKmEueStsZW4xKmIueStsZW4yKmMueSkvY2lyY3VtO3JldHVybiBuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoaW5DZW50cmVYLGluQ2VudHJlWSk7fTtqc3RzLmdlb20uVHJpYW5nbGUuY2VudHJvaWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciB4LHk7eD0oYS54K2IueCtjLngpLzM7eT0oYS55K2IueStjLnkpLzM7cmV0dXJuIG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh4LHkpO307anN0cy5nZW9tLlRyaWFuZ2xlLmxvbmdlc3RTaWRlTGVuZ3RoPWZ1bmN0aW9uKGEsYixjKXt2YXIgbGVuQUIsbGVuQkMsbGVuQ0EsbWF4TGVuO2xlbkFCPWEuZGlzdGFuY2UoYik7bGVuQkM9Yi5kaXN0YW5jZShjKTtsZW5DQT1jLmRpc3RhbmNlKGEpO21heExlbj1sZW5BQjtpZihsZW5CQz5tYXhMZW4pe21heExlbj1sZW5CQzt9XG5pZihsZW5DQT5tYXhMZW4pe21heExlbj1sZW5DQTt9XG5yZXR1cm4gbWF4TGVuO307anN0cy5nZW9tLlRyaWFuZ2xlLmFuZ2xlQmlzZWN0b3I9ZnVuY3Rpb24oYSxiLGMpe3ZhciBsZW4wLGxlbjIsZnJhYyxkeCxkeSxzcGxpdFB0O2xlbjA9Yi5kaXN0YW5jZShhKTtsZW4yPWIuZGlzdGFuY2UoYyk7ZnJhYz1sZW4wLyhsZW4wK2xlbjIpO2R4PWMueC1hLng7ZHk9Yy55LWEueTtzcGxpdFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShhLngrZnJhYypkeCxhLnkrZnJhYypkeSk7cmV0dXJuIHNwbGl0UHQ7fTtqc3RzLmdlb20uVHJpYW5nbGUuYXJlYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIE1hdGguYWJzKCgoYy54LWEueCkqKGIueS1hLnkpLShiLngtYS54KSooYy55LWEueSkpLzIuMCk7fTtqc3RzLmdlb20uVHJpYW5nbGUuc2lnbmVkQXJlYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuKChjLngtYS54KSooYi55LWEueSktKGIueC1hLngpKihjLnktYS55KSkvMi4wO307anN0cy5nZW9tLlRyaWFuZ2xlLnByb3RvdHlwZS5pbkNlbnRyZT1mdW5jdGlvbigpe3JldHVybiBqc3RzLmdlb20uVHJpYW5nbGUuaW5DZW50cmUodGhpcy5wMCx0aGlzLnAxLHRoaXMucDIpO307anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXk9ZnVuY3Rpb24ocHRzKXt0aGlzLnB0cz1wdHM7dGhpcy5fb3JpZW50YXRpb249anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkub3JpZW50YXRpb24ocHRzKTt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5LnByb3RvdHlwZS5wdHM9bnVsbDtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5wcm90b3R5cGUuX29yaWVudGF0aW9uPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5vcmllbnRhdGlvbj1mdW5jdGlvbihwdHMpe3JldHVybiBqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5pbmNyZWFzaW5nRGlyZWN0aW9uKHB0cyk9PT0xO307anN0cy5ub2RpbmcuT3JpZW50ZWRDb29yZGluYXRlQXJyYXkucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihvMSl7dmFyIG9jYT1vMTt2YXIgY29tcD1qc3RzLm5vZGluZy5PcmllbnRlZENvb3JkaW5hdGVBcnJheS5jb21wYXJlT3JpZW50ZWQodGhpcy5wdHMsdGhpcy5fb3JpZW50YXRpb24sb2NhLnB0cyxvY2EuX29yaWVudGF0aW9uKTtyZXR1cm4gY29tcDt9O2pzdHMubm9kaW5nLk9yaWVudGVkQ29vcmRpbmF0ZUFycmF5LmNvbXBhcmVPcmllbnRlZD1mdW5jdGlvbihwdHMxLG9yaWVudGF0aW9uMSxwdHMyLG9yaWVudGF0aW9uMil7dmFyIGRpcjE9b3JpZW50YXRpb24xPzE6LTE7dmFyIGRpcjI9b3JpZW50YXRpb24yPzE6LTE7dmFyIGxpbWl0MT1vcmllbnRhdGlvbjE/cHRzMS5sZW5ndGg6LTE7dmFyIGxpbWl0Mj1vcmllbnRhdGlvbjI/cHRzMi5sZW5ndGg6LTE7dmFyIGkxPW9yaWVudGF0aW9uMT8wOnB0czEubGVuZ3RoLTE7dmFyIGkyPW9yaWVudGF0aW9uMj8wOnB0czIubGVuZ3RoLTE7dmFyIGNvbXA9MDt3aGlsZSh0cnVlKXt2YXIgY29tcFB0PXB0czFbaTFdLmNvbXBhcmVUbyhwdHMyW2kyXSk7aWYoY29tcFB0IT09MClcbnJldHVybiBjb21wUHQ7aTErPWRpcjE7aTIrPWRpcjI7dmFyIGRvbmUxPWkxPT09bGltaXQxO3ZhciBkb25lMj1pMj09PWxpbWl0MjtpZihkb25lMSYmIWRvbmUyKVxucmV0dXJuLTE7aWYoIWRvbmUxJiZkb25lMilcbnJldHVybiAxO2lmKGRvbmUxJiZkb25lMilcbnJldHVybiAwO319O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yPWZ1bmN0aW9uKHAwMCxwMDEscDEwLHAxMSl7dGhpcy5wdHM9W3AwMCxwMDEscDEwLHAxMV07dGhpcy5jb21wdXRlKCk7fTtqc3RzLmFsZ29yaXRobS5DZW50cmFsRW5kcG9pbnRJbnRlcnNlY3Rvci5nZXRJbnRlcnNlY3Rpb249ZnVuY3Rpb24ocDAwLHAwMSxwMTAscDExKXt2YXIgaW50b3I9bmV3IGpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yKHAwMCxwMDEscDEwLHAxMSk7cmV0dXJuIGludG9yLmdldEludGVyc2VjdGlvbigpO307anN0cy5hbGdvcml0aG0uQ2VudHJhbEVuZHBvaW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnB0cz1udWxsO2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5pbnRQdD1udWxsO2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKCl7dmFyIGNlbnRyb2lkPWpzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmF2ZXJhZ2UodGhpcy5wdHMpO3RoaXMuaW50UHQ9dGhpcy5maW5kTmVhcmVzdFBvaW50KGNlbnRyb2lkLHRoaXMucHRzKTt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLnByb3RvdHlwZS5nZXRJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnRQdDt9O2pzdHMuYWxnb3JpdGhtLkNlbnRyYWxFbmRwb2ludEludGVyc2VjdG9yLmF2ZXJhZ2U9ZnVuY3Rpb24ocHRzKXt2YXIgYXZnPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSgpO3ZhciBpLG49cHRzLmxlbmd0aDtmb3IoaT0wO2k8bjtpKyspe2F2Zy54Kz1wdHNbaV0ueDthdmcueSs9cHRzW2ldLnk7fVxuaWYobj4wKXthdmcueC89bjthdmcueS89bjt9XG5yZXR1cm4gYXZnO307anN0cy5hbGdvcml0aG0uQ2VudHJhbEVuZHBvaW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmZpbmROZWFyZXN0UG9pbnQ9ZnVuY3Rpb24ocCxwdHMpe3ZhciBtaW5EaXN0PU51bWJlci5NQVhfVkFMVUU7dmFyIGkscmVzdWx0PW51bGwsZGlzdDtmb3IoaT0wO2k8cHRzLmxlbmd0aDtpKyspe2Rpc3Q9cC5kaXN0YW5jZShwdHNbaV0pO2lmKGRpc3Q8bWluRGlzdCl7bWluRGlzdD1kaXN0O3Jlc3VsdD1wdHNbaV07fX1cbnJldHVybiByZXN1bHQ7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3A9ZnVuY3Rpb24oZyxidWZQYXJhbXMpe3RoaXMuYXJnR2VvbT1nO3RoaXMuYnVmUGFyYW1zPWJ1ZlBhcmFtcz9idWZQYXJhbXM6bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJQYXJhbWV0ZXJzKCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuTUFYX1BSRUNJU0lPTl9ESUdJVFM9MTI7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByZWNpc2lvblNjYWxlRmFjdG9yPWZ1bmN0aW9uKGcsZGlzdGFuY2UsbWF4UHJlY2lzaW9uRGlnaXRzKXt2YXIgZW52PWcuZ2V0RW52ZWxvcGVJbnRlcm5hbCgpO3ZhciBlbnZTaXplPU1hdGgubWF4KGVudi5nZXRIZWlnaHQoKSxlbnYuZ2V0V2lkdGgoKSk7dmFyIGV4cGFuZEJ5RGlzdGFuY2U9ZGlzdGFuY2U+MC4wP2Rpc3RhbmNlOjAuMDt2YXIgYnVmRW52U2l6ZT1lbnZTaXplKzIqZXhwYW5kQnlEaXN0YW5jZTt2YXIgYnVmRW52TG9nMTA9KE1hdGgubG9nKGJ1ZkVudlNpemUpL01hdGgubG9nKDEwKSsxLjApO3ZhciBtaW5Vbml0TG9nMTA9YnVmRW52TG9nMTAtbWF4UHJlY2lzaW9uRGlnaXRzO3ZhciBzY2FsZUZhY3Rvcj1NYXRoLnBvdygxMC4wLC1taW5Vbml0TG9nMTApO3JldHVybiBzY2FsZUZhY3Rvcjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcD1mdW5jdGlvbihnLGRpc3RhbmNlKXtpZihhcmd1bWVudHMubGVuZ3RoPjIpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3AyLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgZ0J1Zj1uZXcganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wKGcpO3ZhciBnZW9tQnVmPWdCdWYuZ2V0UmVzdWx0R2VvbWV0cnkoZGlzdGFuY2UpO3JldHVybiBnZW9tQnVmO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMj1mdW5jdGlvbihnLGRpc3RhbmNlLHBhcmFtcyl7aWYoYXJndW1lbnRzLmxlbmd0aD4zKXtyZXR1cm4ganN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLmJ1ZmZlck9wMy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7fVxudmFyIGJ1Zk9wPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AoZyxwYXJhbXMpO3ZhciBnZW9tQnVmPWJ1Zk9wLmdldFJlc3VsdEdlb21ldHJ5KGRpc3RhbmNlKTtyZXR1cm4gZ2VvbUJ1Zjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDM9ZnVuY3Rpb24oZyxkaXN0YW5jZSxxdWFkcmFudFNlZ21lbnRzKXtpZihhcmd1bWVudHMubGVuZ3RoPjQpe3JldHVybiBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AuYnVmZmVyT3A0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt9XG52YXIgYnVmT3A9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcChnKTtidWZPcC5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO3ZhciBnZW9tQnVmPWJ1Zk9wLmdldFJlc3VsdEdlb21ldHJ5KGRpc3RhbmNlKTtyZXR1cm4gZ2VvbUJ1Zjt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5idWZmZXJPcDQ9ZnVuY3Rpb24oZyxkaXN0YW5jZSxxdWFkcmFudFNlZ21lbnRzLGVuZENhcFN0eWxlKXt2YXIgYnVmT3A9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcChnKTtidWZPcC5zZXRRdWFkcmFudFNlZ21lbnRzKHF1YWRyYW50U2VnbWVudHMpO2J1Zk9wLnNldEVuZENhcFN0eWxlKGVuZENhcFN0eWxlKTt2YXIgZ2VvbUJ1Zj1idWZPcC5nZXRSZXN1bHRHZW9tZXRyeShkaXN0YW5jZSk7cmV0dXJuIGdlb21CdWY7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmFyZ0dlb209bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmRpc3RhbmNlPW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5idWZQYXJhbXM9bnVsbDtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLnJlc3VsdEdlb21ldHJ5PW51bGw7anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5zZXRFbmRDYXBTdHlsZT1mdW5jdGlvbihlbmRDYXBTdHlsZSl7dGhpcy5idWZQYXJhbXMuc2V0RW5kQ2FwU3R5bGUoZW5kQ2FwU3R5bGUpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5zZXRRdWFkcmFudFNlZ21lbnRzPWZ1bmN0aW9uKHF1YWRyYW50U2VnbWVudHMpe3RoaXMuYnVmUGFyYW1zLnNldFF1YWRyYW50U2VnbWVudHMocXVhZHJhbnRTZWdtZW50cyk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmdldFJlc3VsdEdlb21ldHJ5PWZ1bmN0aW9uKGRpc3Qpe3RoaXMuZGlzdGFuY2U9ZGlzdDt0aGlzLmNvbXB1dGVHZW9tZXRyeSgpO3JldHVybiB0aGlzLnJlc3VsdEdlb21ldHJ5O307anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByb3RvdHlwZS5jb21wdXRlR2VvbWV0cnk9ZnVuY3Rpb24oKXt0aGlzLmJ1ZmZlck9yaWdpbmFsUHJlY2lzaW9uKCk7aWYodGhpcy5yZXN1bHRHZW9tZXRyeSE9PW51bGwpe3JldHVybjt9XG52YXIgYXJnUE09dGhpcy5hcmdHZW9tLmdldFByZWNpc2lvbk1vZGVsKCk7aWYoYXJnUE0uZ2V0VHlwZSgpPT09anN0cy5nZW9tLlByZWNpc2lvbk1vZGVsLkZJWEVEKXt0aGlzLmJ1ZmZlckZpeGVkUHJlY2lzaW9uKGFyZ1BNKTt9ZWxzZXt0aGlzLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb24oKTt9fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlclJlZHVjZWRQcmVjaXNpb249ZnVuY3Rpb24oKXt2YXIgcHJlY0RpZ2l0czt2YXIgc2F2ZUV4Y2VwdGlvbj1udWxsO2ZvcihwcmVjRGlnaXRzPWpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5NQVhfUFJFQ0lTSU9OX0RJR0lUUztwcmVjRGlnaXRzPj0wO3ByZWNEaWdpdHMtLSl7dHJ5e3RoaXMuYnVmZmVyUmVkdWNlZFByZWNpc2lvbjIocHJlY0RpZ2l0cyk7fWNhdGNoKGV4KXtzYXZlRXhjZXB0aW9uPWV4O31cbmlmKHRoaXMucmVzdWx0R2VvbWV0cnkhPT1udWxsKXtyZXR1cm47fX1cbnRocm93IHNhdmVFeGNlcHRpb247fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyT3AucHJvdG90eXBlLmJ1ZmZlck9yaWdpbmFsUHJlY2lzaW9uPWZ1bmN0aW9uKCl7dHJ5e3ZhciBidWZCdWlsZGVyPW5ldyBqc3RzLm9wZXJhdGlvbi5idWZmZXIuQnVmZmVyQnVpbGRlcih0aGlzLmJ1ZlBhcmFtcyk7dGhpcy5yZXN1bHRHZW9tZXRyeT1idWZCdWlsZGVyLmJ1ZmZlcih0aGlzLmFyZ0dlb20sdGhpcy5kaXN0YW5jZSk7fWNhdGNoKGUpe319O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuYnVmZmVyUmVkdWNlZFByZWNpc2lvbjI9ZnVuY3Rpb24ocHJlY2lzaW9uRGlnaXRzKXt2YXIgc2l6ZUJhc2VkU2NhbGVGYWN0b3I9anN0cy5vcGVyYXRpb24uYnVmZmVyLkJ1ZmZlck9wLnByZWNpc2lvblNjYWxlRmFjdG9yKHRoaXMuYXJnR2VvbSx0aGlzLmRpc3RhbmNlLHByZWNpc2lvbkRpZ2l0cyk7dmFyIGZpeGVkUE09bmV3IGpzdHMuZ2VvbS5QcmVjaXNpb25Nb2RlbChzaXplQmFzZWRTY2FsZUZhY3Rvcik7dGhpcy5idWZmZXJGaXhlZFByZWNpc2lvbihmaXhlZFBNKTt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJPcC5wcm90b3R5cGUuYnVmZmVyRml4ZWRQcmVjaXNpb249ZnVuY3Rpb24oZml4ZWRQTSl7dmFyIG5vZGVyPW5ldyBqc3RzLm5vZGluZy5TY2FsZWROb2RlcihuZXcganN0cy5ub2Rpbmcuc25hcHJvdW5kLk1DSW5kZXhTbmFwUm91bmRlcihuZXcganN0cy5nZW9tLlByZWNpc2lvbk1vZGVsKDEuMCkpLGZpeGVkUE0uZ2V0U2NhbGUoKSk7dmFyIGJ1ZkJ1aWxkZXI9bmV3IGpzdHMub3BlcmF0aW9uLmJ1ZmZlci5CdWZmZXJCdWlsZGVyKHRoaXMuYnVmUGFyYW1zKTtidWZCdWlsZGVyLnNldFdvcmtpbmdQcmVjaXNpb25Nb2RlbChmaXhlZFBNKTtidWZCdWlsZGVyLnNldE5vZGVyKG5vZGVyKTt0aGlzLnJlc3VsdEdlb21ldHJ5PWJ1ZkJ1aWxkZXIuYnVmZmVyKHRoaXMuYXJnR2VvbSx0aGlzLmRpc3RhbmNlKTt9OyhmdW5jdGlvbigpe3ZhciBMb2NhdGlvbj1qc3RzLmdlb20uTG9jYXRpb247dmFyIFBvc2l0aW9uPWpzdHMuZ2VvbWdyYXBoLlBvc2l0aW9uO3ZhciBBc3NlcnQ9anN0cy51dGlsLkFzc2VydDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoPWZ1bmN0aW9uKGFyZ0luZGV4LHBhcmVudEdlb20sYm91bmRhcnlOb2RlUnVsZSl7anN0cy5nZW9tZ3JhcGguUGxhbmFyR3JhcGguY2FsbCh0aGlzKTt0aGlzLmxpbmVFZGdlTWFwPW5ldyBqYXZhc2NyaXB0LnV0aWwuSGFzaE1hcCgpO3RoaXMucHRMb2NhdG9yPW5ldyBqc3RzLmFsZ29yaXRobS5Qb2ludExvY2F0b3IoKTt0aGlzLmFyZ0luZGV4PWFyZ0luZGV4O3RoaXMucGFyZW50R2VvbT1wYXJlbnRHZW9tO3RoaXMuYm91bmRhcnlOb2RlUnVsZT1ib3VuZGFyeU5vZGVSdWxlfHxqc3RzLmFsZ29yaXRobS5Cb3VuZGFyeU5vZGVSdWxlLk9HQ19TRlNfQk9VTkRBUllfUlVMRTtpZihwYXJlbnRHZW9tIT09bnVsbCl7dGhpcy5hZGQocGFyZW50R2VvbSk7fX07anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGU9bmV3IGpzdHMuZ2VvbWdyYXBoLlBsYW5hckdyYXBoKCk7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5jb25zdHJ1Y3Rvcj1qc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmNyZWF0ZUVkZ2VTZXRJbnRlcnNlY3Rvcj1mdW5jdGlvbigpe3JldHVybiBuZXcganN0cy5nZW9tZ3JhcGguaW5kZXguU2ltcGxlTUNTd2VlcExpbmVJbnRlcnNlY3RvcigpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5kZXRlcm1pbmVCb3VuZGFyeT1mdW5jdGlvbihib3VuZGFyeU5vZGVSdWxlLGJvdW5kYXJ5Q291bnQpe3JldHVybiBib3VuZGFyeU5vZGVSdWxlLmlzSW5Cb3VuZGFyeShib3VuZGFyeUNvdW50KT9Mb2NhdGlvbi5CT1VOREFSWTpMb2NhdGlvbi5JTlRFUklPUjt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLnBhcmVudEdlb209bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5saW5lRWRnZU1hcD1udWxsO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmJvdW5kYXJ5Tm9kZVJ1bGU9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS51c2VCb3VuZGFyeURldGVybWluYXRpb25SdWxlPXRydWU7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYXJnSW5kZXg9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5ib3VuZGFyeU5vZGVzPW51bGw7anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuaGFzVG9vRmV3UG9pbnRzPWZhbHNlO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmludmFsaWRQb2ludD1udWxsO2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFyZWFQdExvY2F0b3I9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5wdExvY2F0b3I9bnVsbDtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5nZXRHZW9tZXRyeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmVudEdlb207fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5nZXRCb3VuZGFyeU5vZGVzPWZ1bmN0aW9uKCl7aWYodGhpcy5ib3VuZGFyeU5vZGVzPT09bnVsbClcbnRoaXMuYm91bmRhcnlOb2Rlcz10aGlzLm5vZGVzLmdldEJvdW5kYXJ5Tm9kZXModGhpcy5hcmdJbmRleCk7cmV0dXJuIHRoaXMuYm91bmRhcnlOb2Rlczt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmdldEJvdW5kYXJ5Tm9kZVJ1bGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ib3VuZGFyeU5vZGVSdWxlO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZmluZEVkZ2U9ZnVuY3Rpb24obGluZSl7cmV0dXJuIHRoaXMubGluZUVkZ2VNYXAuZ2V0KGxpbmUpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuY29tcHV0ZVNwbGl0RWRnZXM9ZnVuY3Rpb24oZWRnZWxpc3Qpe2Zvcih2YXIgaT10aGlzLmVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTtlLmVpTGlzdC5hZGRTcGxpdEVkZ2VzKGVkZ2VsaXN0KTt9fVxuanN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGcpe2lmKGcuaXNFbXB0eSgpKXtyZXR1cm47fVxuaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5NdWx0aVBvbHlnb24pXG50aGlzLnVzZUJvdW5kYXJ5RGV0ZXJtaW5hdGlvblJ1bGU9ZmFsc2U7aWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2x5Z29uKVxudGhpcy5hZGRQb2x5Z29uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lU3RyaW5nKVxudGhpcy5hZGRMaW5lU3RyaW5nKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5Qb2ludClcbnRoaXMuYWRkUG9pbnQoZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9pbnQpXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZSBpZihnIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpTGluZVN0cmluZylcbnRoaXMuYWRkQ29sbGVjdGlvbihnKTtlbHNlIGlmKGcgaW5zdGFuY2VvZiBqc3RzLmdlb20uTXVsdGlQb2x5Z29uKVxudGhpcy5hZGRDb2xsZWN0aW9uKGcpO2Vsc2UgaWYoZyBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5HZW9tZXRyeUNvbGxlY3Rpb24pXG50aGlzLmFkZENvbGxlY3Rpb24oZyk7ZWxzZVxudGhyb3cgbmV3IGpzdHMuZXJyb3IuSWxsZWdhbEFyZ3VtZW50RXJyb3IoJ0dlb21ldHJ5IHR5cGUgbm90IHN1cHBvcnRlZC4nKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZENvbGxlY3Rpb249ZnVuY3Rpb24oZ2Mpe2Zvcih2YXIgaT0wO2k8Z2MuZ2V0TnVtR2VvbWV0cmllcygpO2krKyl7dmFyIGc9Z2MuZ2V0R2VvbWV0cnlOKGkpO3RoaXMuYWRkKGcpO319O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZEVkZ2U9ZnVuY3Rpb24oZSl7dGhpcy5pbnNlcnRFZGdlKGUpO3ZhciBjb29yZD1lLmdldENvb3JkaW5hdGVzKCk7dGhpcy5pbnNlcnRQb2ludCh0aGlzLmFyZ0luZGV4LGNvb3JkWzBdLExvY2F0aW9uLkJPVU5EQVJZKTt0aGlzLmluc2VydFBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbY29vcmQubGVuZ3RoLTFdLExvY2F0aW9uLkJPVU5EQVJZKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZFBvaW50PWZ1bmN0aW9uKHApe3ZhciBjb29yZD1wLmdldENvb3JkaW5hdGUoKTt0aGlzLmluc2VydFBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmQsTG9jYXRpb24uSU5URVJJT1IpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuYWRkTGluZVN0cmluZz1mdW5jdGlvbihsaW5lKXt2YXIgY29vcmQ9anN0cy5nZW9tLkNvb3JkaW5hdGVBcnJheXMucmVtb3ZlUmVwZWF0ZWRQb2ludHMobGluZS5nZXRDb29yZGluYXRlcygpKTtpZihjb29yZC5sZW5ndGg8Mil7dGhpcy5oYXNUb29GZXdQb2ludHM9dHJ1ZTt0aGlzLmludmFsaWRQb2ludD1jb29yZHNbMF07cmV0dXJuO31cbnZhciBlPW5ldyBqc3RzLmdlb21ncmFwaC5FZGdlKGNvb3JkLG5ldyBqc3RzLmdlb21ncmFwaC5MYWJlbCh0aGlzLmFyZ0luZGV4LExvY2F0aW9uLklOVEVSSU9SKSk7dGhpcy5saW5lRWRnZU1hcC5wdXQobGluZSxlKTt0aGlzLmluc2VydEVkZ2UoZSk7QXNzZXJ0LmlzVHJ1ZShjb29yZC5sZW5ndGg+PTIsJ2ZvdW5kIExpbmVTdHJpbmcgd2l0aCBzaW5nbGUgcG9pbnQnKTt0aGlzLmluc2VydEJvdW5kYXJ5UG9pbnQodGhpcy5hcmdJbmRleCxjb29yZFswXSk7dGhpcy5pbnNlcnRCb3VuZGFyeVBvaW50KHRoaXMuYXJnSW5kZXgsY29vcmRbY29vcmQubGVuZ3RoLTFdKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZFBvbHlnb25SaW5nPWZ1bmN0aW9uKGxyLGN3TGVmdCxjd1JpZ2h0KXtpZihsci5pc0VtcHR5KCkpXG5yZXR1cm47dmFyIGNvb3JkPWpzdHMuZ2VvbS5Db29yZGluYXRlQXJyYXlzLnJlbW92ZVJlcGVhdGVkUG9pbnRzKGxyLmdldENvb3JkaW5hdGVzKCkpO2lmKGNvb3JkLmxlbmd0aDw0KXt0aGlzLmhhc1Rvb0Zld1BvaW50cz10cnVlO3RoaXMuaW52YWxpZFBvaW50PWNvb3JkWzBdO3JldHVybjt9XG52YXIgbGVmdD1jd0xlZnQ7dmFyIHJpZ2h0PWN3UmlnaHQ7aWYoanN0cy5hbGdvcml0aG0uQ0dBbGdvcml0aG1zLmlzQ0NXKGNvb3JkKSl7bGVmdD1jd1JpZ2h0O3JpZ2h0PWN3TGVmdDt9XG52YXIgZT1uZXcganN0cy5nZW9tZ3JhcGguRWRnZShjb29yZCxuZXcganN0cy5nZW9tZ3JhcGguTGFiZWwodGhpcy5hcmdJbmRleCxMb2NhdGlvbi5CT1VOREFSWSxsZWZ0LHJpZ2h0KSk7dGhpcy5saW5lRWRnZU1hcC5wdXQobHIsZSk7dGhpcy5pbnNlcnRFZGdlKGUpO3RoaXMuaW5zZXJ0UG9pbnQodGhpcy5hcmdJbmRleCxjb29yZFswXSxMb2NhdGlvbi5CT1VOREFSWSk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRQb2x5Z29uPWZ1bmN0aW9uKHApe3RoaXMuYWRkUG9seWdvblJpbmcocC5nZXRFeHRlcmlvclJpbmcoKSxMb2NhdGlvbi5FWFRFUklPUixMb2NhdGlvbi5JTlRFUklPUik7Zm9yKHZhciBpPTA7aTxwLmdldE51bUludGVyaW9yUmluZygpO2krKyl7dmFyIGhvbGU9cC5nZXRJbnRlcmlvclJpbmdOKGkpO3RoaXMuYWRkUG9seWdvblJpbmcoaG9sZSxMb2NhdGlvbi5JTlRFUklPUixMb2NhdGlvbi5FWFRFUklPUik7fX07anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuY29tcHV0ZUVkZ2VJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGcsbGksaW5jbHVkZVByb3Blcil7dmFyIHNpPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IobGksaW5jbHVkZVByb3Blcix0cnVlKTtzaS5zZXRCb3VuZGFyeU5vZGVzKHRoaXMuZ2V0Qm91bmRhcnlOb2RlcygpLGcuZ2V0Qm91bmRhcnlOb2RlcygpKTt2YXIgZXNpPXRoaXMuY3JlYXRlRWRnZVNldEludGVyc2VjdG9yKCk7ZXNpLmNvbXB1dGVJbnRlcnNlY3Rpb25zKHRoaXMuZWRnZXMsZy5lZGdlcyxzaSk7cmV0dXJuIHNpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuY29tcHV0ZVNlbGZOb2Rlcz1mdW5jdGlvbihsaSxjb21wdXRlUmluZ1NlbGZOb2Rlcyl7dmFyIHNpPW5ldyBqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IobGksdHJ1ZSxmYWxzZSk7dmFyIGVzaT10aGlzLmNyZWF0ZUVkZ2VTZXRJbnRlcnNlY3RvcigpO2lmKCFjb21wdXRlUmluZ1NlbGZOb2RlcyYmKHRoaXMucGFyZW50R2VvbSBpbnN0YW5jZW9mIGpzdHMuZ2VvbS5MaW5lYXJSaW5nfHx0aGlzLnBhcmVudEdlb20gaW5zdGFuY2VvZiBqc3RzLmdlb20uUG9seWdvbnx8dGhpcy5wYXJlbnRHZW9tIGluc3RhbmNlb2YganN0cy5nZW9tLk11bHRpUG9seWdvbikpe2VzaS5jb21wdXRlSW50ZXJzZWN0aW9ucyh0aGlzLmVkZ2VzLHNpLGZhbHNlKTt9ZWxzZXtlc2kuY29tcHV0ZUludGVyc2VjdGlvbnModGhpcy5lZGdlcyxzaSx0cnVlKTt9XG50aGlzLmFkZFNlbGZJbnRlcnNlY3Rpb25Ob2Rlcyh0aGlzLmFyZ0luZGV4KTtyZXR1cm4gc2k7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5pbnNlcnRQb2ludD1mdW5jdGlvbihhcmdJbmRleCxjb29yZCxvbkxvY2F0aW9uKXt2YXIgbj10aGlzLm5vZGVzLmFkZE5vZGUoY29vcmQpO3ZhciBsYmw9bi5nZXRMYWJlbCgpO2lmKGxibD09bnVsbCl7bi5sYWJlbD1uZXcganN0cy5nZW9tZ3JhcGguTGFiZWwoYXJnSW5kZXgsb25Mb2NhdGlvbik7fWVsc2VcbmxibC5zZXRMb2NhdGlvbihhcmdJbmRleCxvbkxvY2F0aW9uKTt9O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmluc2VydEJvdW5kYXJ5UG9pbnQ9ZnVuY3Rpb24oYXJnSW5kZXgsY29vcmQpe3ZhciBuPXRoaXMubm9kZXMuYWRkTm9kZShjb29yZCk7dmFyIGxibD1uLmdldExhYmVsKCk7dmFyIGJvdW5kYXJ5Q291bnQ9MTt2YXIgbG9jPUxvY2F0aW9uLk5PTkU7aWYobGJsIT09bnVsbClcbmxvYz1sYmwuZ2V0TG9jYXRpb24oYXJnSW5kZXgsUG9zaXRpb24uT04pO2lmKGxvYz09PUxvY2F0aW9uLkJPVU5EQVJZKVxuYm91bmRhcnlDb3VudCsrO3ZhciBuZXdMb2M9anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5kZXRlcm1pbmVCb3VuZGFyeSh0aGlzLmJvdW5kYXJ5Tm9kZVJ1bGUsYm91bmRhcnlDb3VudCk7bGJsLnNldExvY2F0aW9uKGFyZ0luZGV4LG5ld0xvYyk7fTtqc3RzLmdlb21ncmFwaC5HZW9tZXRyeUdyYXBoLnByb3RvdHlwZS5hZGRTZWxmSW50ZXJzZWN0aW9uTm9kZXM9ZnVuY3Rpb24oYXJnSW5kZXgpe2Zvcih2YXIgaT10aGlzLmVkZ2VzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgZT1pLm5leHQoKTt2YXIgZUxvYz1lLmdldExhYmVsKCkuZ2V0TG9jYXRpb24oYXJnSW5kZXgpO2Zvcih2YXIgZWlJdD1lLmVpTGlzdC5pdGVyYXRvcigpO2VpSXQuaGFzTmV4dCgpOyl7dmFyIGVpPWVpSXQubmV4dCgpO3RoaXMuYWRkU2VsZkludGVyc2VjdGlvbk5vZGUoYXJnSW5kZXgsZWkuY29vcmQsZUxvYyk7fX19O2pzdHMuZ2VvbWdyYXBoLkdlb21ldHJ5R3JhcGgucHJvdG90eXBlLmFkZFNlbGZJbnRlcnNlY3Rpb25Ob2RlPWZ1bmN0aW9uKGFyZ0luZGV4LGNvb3JkLGxvYyl7aWYodGhpcy5pc0JvdW5kYXJ5Tm9kZShhcmdJbmRleCxjb29yZCkpXG5yZXR1cm47aWYobG9jPT09TG9jYXRpb24uQk9VTkRBUlkmJnRoaXMudXNlQm91bmRhcnlEZXRlcm1pbmF0aW9uUnVsZSlcbnRoaXMuaW5zZXJ0Qm91bmRhcnlQb2ludChhcmdJbmRleCxjb29yZCk7ZWxzZVxudGhpcy5pbnNlcnRQb2ludChhcmdJbmRleCxjb29yZCxsb2MpO307anN0cy5nZW9tZ3JhcGguR2VvbWV0cnlHcmFwaC5wcm90b3R5cGUuZ2V0SW52YWxpZFBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW52YWxpZFBvaW50O307fSkoKTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZz1mdW5jdGlvbigpe3RoaXMucHRMaXN0PVtdO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLnB0TGlzdD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5wcmVjaXNpb25Nb2RlbD1udWxsO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5taW5pbWltVmVydGV4RGlzdGFuY2U9MC4wO2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXRQcmVjaXNpb25Nb2RlbD1mdW5jdGlvbihwcmVjaXNpb25Nb2RlbCl7dGhpcy5wcmVjaXNpb25Nb2RlbD1wcmVjaXNpb25Nb2RlbDt9O2pzdHMub3BlcmF0aW9uLmJ1ZmZlci5PZmZzZXRTZWdtZW50U3RyaW5nLnByb3RvdHlwZS5zZXRNaW5pbXVtVmVydGV4RGlzdGFuY2U9ZnVuY3Rpb24obWluaW1pbVZlcnRleERpc3RhbmNlKXt0aGlzLm1pbmltaW1WZXJ0ZXhEaXN0YW5jZT1taW5pbWltVmVydGV4RGlzdGFuY2U7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUuYWRkUHQ9ZnVuY3Rpb24ocHQpe3ZhciBidWZQdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUocHQpO3RoaXMucHJlY2lzaW9uTW9kZWwubWFrZVByZWNpc2UoYnVmUHQpO2lmKHRoaXMuaXNSZWR1bmRhbnQoYnVmUHQpKVxucmV0dXJuO3RoaXMucHRMaXN0LnB1c2goYnVmUHQpO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmFkZFB0cz1mdW5jdGlvbihwdCxpc0ZvcndhcmQpe2lmKGlzRm9yd2FyZCl7Zm9yKHZhciBpPTA7aTxwdC5sZW5ndGg7aSsrKXt0aGlzLmFkZFB0KHB0W2ldKTt9fWVsc2V7Zm9yKHZhciBpPXB0Lmxlbmd0aC0xO2k+PTA7aS0tKXt0aGlzLmFkZFB0KHB0W2ldKTt9fX07anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmlzUmVkdW5kYW50PWZ1bmN0aW9uKHB0KXtpZih0aGlzLnB0TGlzdC5sZW5ndGg8MSlcbnJldHVybiBmYWxzZTt2YXIgbGFzdFB0PXRoaXMucHRMaXN0W3RoaXMucHRMaXN0Lmxlbmd0aC0xXTt2YXIgcHREaXN0PXB0LmRpc3RhbmNlKGxhc3RQdCk7aWYocHREaXN0PHRoaXMubWluaW1pbVZlcnRleERpc3RhbmNlKVxucmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlO307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmNsb3NlUmluZz1mdW5jdGlvbigpe2lmKHRoaXMucHRMaXN0Lmxlbmd0aDwxKVxucmV0dXJuO3ZhciBzdGFydFB0PW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZSh0aGlzLnB0TGlzdFswXSk7dmFyIGxhc3RQdD10aGlzLnB0TGlzdFt0aGlzLnB0TGlzdC5sZW5ndGgtMV07dmFyIGxhc3QyUHQ9bnVsbDtpZih0aGlzLnB0TGlzdC5sZW5ndGg+PTIpXG5sYXN0MlB0PXRoaXMucHRMaXN0W3RoaXMucHRMaXN0Lmxlbmd0aC0yXTtpZihzdGFydFB0LmVxdWFscyhsYXN0UHQpKVxucmV0dXJuO3RoaXMucHRMaXN0LnB1c2goc3RhcnRQdCk7fTtqc3RzLm9wZXJhdGlvbi5idWZmZXIuT2Zmc2V0U2VnbWVudFN0cmluZy5wcm90b3R5cGUucmV2ZXJzZT1mdW5jdGlvbigpe307anN0cy5vcGVyYXRpb24uYnVmZmVyLk9mZnNldFNlZ21lbnRTdHJpbmcucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHRMaXN0O307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2U9ZnVuY3Rpb24oKXt0aGlzLnB0PVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoKV07fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUucHQ9bnVsbDtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuZGlzdGFuY2U9TmFOO2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5pc051bGw9dHJ1ZTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuaW5pdGlhbGl6ZT1mdW5jdGlvbihwMCxwMSxkaXN0YW5jZSl7aWYocDA9PT11bmRlZmluZWQpe3RoaXMuaXNOdWxsPXRydWU7cmV0dXJuO31cbnRoaXMucHRbMF0uc2V0Q29vcmRpbmF0ZShwMCk7dGhpcy5wdFsxXS5zZXRDb29yZGluYXRlKHAxKTt0aGlzLmRpc3RhbmNlPWRpc3RhbmNlIT09dW5kZWZpbmVkP2Rpc3RhbmNlOnAwLmRpc3RhbmNlKHAxKTt0aGlzLmlzTnVsbD1mYWxzZTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5nZXREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3RhbmNlO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLmdldENvb3JkaW5hdGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHQ7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5wdFtpXTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5zZXRNYXhpbXVtPWZ1bmN0aW9uKHB0RGlzdCl7aWYoYXJndW1lbnRzLmxlbmd0aD09PTIpe3RoaXMuc2V0TWF4aW11bTIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybjt9XG50aGlzLnNldE1heGltdW0ocHREaXN0LnB0WzBdLHB0RGlzdC5wdFsxXSk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5Qb2ludFBhaXJEaXN0YW5jZS5wcm90b3R5cGUuc2V0TWF4aW11bTI9ZnVuY3Rpb24ocDAscDEpe2lmKHRoaXMuaXNOdWxsKXt0aGlzLmluaXRpYWxpemUocDAscDEpO3JldHVybjt9XG52YXIgZGlzdD1wMC5kaXN0YW5jZShwMSk7aWYoZGlzdD50aGlzLmRpc3RhbmNlKVxudGhpcy5pbml0aWFsaXplKHAwLHAxLGRpc3QpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UucHJvdG90eXBlLnNldE1pbmltdW09ZnVuY3Rpb24ocHREaXN0KXtpZihhcmd1bWVudHMubGVuZ3RoPT09Mil7dGhpcy5zZXRNaW5pbXVtMi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuO31cbnRoaXMuc2V0TWluaW11bShwdERpc3QucHRbMF0scHREaXN0LnB0WzFdKTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLlBvaW50UGFpckRpc3RhbmNlLnByb3RvdHlwZS5zZXRNaW5pbXVtMj1mdW5jdGlvbihwMCxwMSl7aWYodGhpcy5pc051bGwpe3RoaXMuaW5pdGlhbGl6ZShwMCxwMSk7cmV0dXJuO31cbnZhciBkaXN0PXAwLmRpc3RhbmNlKHAxKTtpZihkaXN0PHRoaXMuZGlzdGFuY2UpXG50aGlzLmluaXRpYWxpemUocDAscDEsZGlzdCk7fTsoZnVuY3Rpb24oKXt2YXIgUG9pbnRQYWlyRGlzdGFuY2U9anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2U7dmFyIERpc3RhbmNlVG9Qb2ludD1qc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXN0YW5jZVRvUG9pbnQ7dmFyIE1heFBvaW50RGlzdGFuY2VGaWx0ZXI9ZnVuY3Rpb24oZ2VvbSl7dGhpcy5tYXhQdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5taW5QdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7dGhpcy5ldWNsaWRlYW5EaXN0PW5ldyBEaXN0YW5jZVRvUG9pbnQoKTt0aGlzLmdlb209Z2VvbTt9O01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlPW5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZUZpbHRlcigpO01heFBvaW50RGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm1heFB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5taW5QdERpc3Q9bmV3IFBvaW50UGFpckRpc3RhbmNlKCk7TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZXVjbGlkZWFuRGlzdD1uZXcgRGlzdGFuY2VUb1BvaW50KCk7TWF4UG9pbnREaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2VvbTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5maWx0ZXI9ZnVuY3Rpb24ocHQpe3RoaXMubWluUHREaXN0LmluaXRpYWxpemUoKTtEaXN0YW5jZVRvUG9pbnQuY29tcHV0ZURpc3RhbmNlKHRoaXMuZ2VvbSxwdCx0aGlzLm1pblB0RGlzdCk7dGhpcy5tYXhQdERpc3Quc2V0TWF4aW11bSh0aGlzLm1pblB0RGlzdCk7fTtNYXhQb2ludERpc3RhbmNlRmlsdGVyLnByb3RvdHlwZS5nZXRNYXhQb2ludERpc3RhbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4UHREaXN0O307dmFyIE1heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlcj1mdW5jdGlvbihnZW9tLGZyYWN0aW9uKXt0aGlzLm1heFB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTt0aGlzLm1pblB0RGlzdD1uZXcgUG9pbnRQYWlyRGlzdGFuY2UoKTt0aGlzLmdlb209Z2VvbTt0aGlzLm51bVN1YlNlZ3M9TWF0aC5yb3VuZCgxLjAvZnJhY3Rpb24pO307TWF4RGVuc2lmaWVkQnlGcmFjdGlvbkRpc3RhbmNlRmlsdGVyLnByb3RvdHlwZT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGVTZXF1ZW5jZUZpbHRlcigpO01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUubWF4UHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUubWluUHREaXN0PW5ldyBQb2ludFBhaXJEaXN0YW5jZSgpO01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2VvbTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLm51bVN1YlNlZ3M9MDtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbihzZXEsaW5kZXgpe2lmKGluZGV4PT0wKVxucmV0dXJuO3ZhciBwMD1zZXFbaW5kZXgtMV07dmFyIHAxPXNlcVtpbmRleF07dmFyIGRlbHg9KHAxLngtcDAueCkvdGhpcy5udW1TdWJTZWdzO3ZhciBkZWx5PShwMS55LXAwLnkpL3RoaXMubnVtU3ViU2Vncztmb3IodmFyIGk9MDtpPHRoaXMubnVtU3ViU2VncztpKyspe3ZhciB4PXAwLngraSpkZWx4O3ZhciB5PXAwLnkraSpkZWx5O3ZhciBwdD1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoeCx5KTt0aGlzLm1pblB0RGlzdC5pbml0aWFsaXplKCk7RGlzdGFuY2VUb1BvaW50LmNvbXB1dGVEaXN0YW5jZSh0aGlzLmdlb20scHQsdGhpcy5taW5QdERpc3QpO3RoaXMubWF4UHREaXN0LnNldE1heGltdW0odGhpcy5taW5QdERpc3QpO319O01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuaXNHZW9tZXRyeUNoYW5nZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fTtNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIucHJvdG90eXBlLmlzRG9uZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O01heERlbnNpZmllZEJ5RnJhY3Rpb25EaXN0YW5jZUZpbHRlci5wcm90b3R5cGUuZ2V0TWF4UG9pbnREaXN0YW5jZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1heFB0RGlzdDt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2U9ZnVuY3Rpb24oZzAsZzEpe3RoaXMuZzA9ZzA7dGhpcy5nMT1nMTt0aGlzLnB0RGlzdD1uZXcganN0cy5hbGdvcml0aG0uZGlzdGFuY2UuUG9pbnRQYWlyRGlzdGFuY2UoKTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmcwPW51bGw7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZzE9bnVsbDtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5wdERpc3Q9bnVsbDtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5kZW5zaWZ5RnJhYz0wLjA7anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5kaXN0YW5jZT1mdW5jdGlvbihnMCxnMSxkZW5zaWZ5RnJhYyl7dmFyIGRpc3Q9bmV3IGpzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UoZzAsZzEpO2lmKGRlbnNpZnlGcmFjIT09dW5kZWZpbmVkKVxuZGlzdC5zZXREZW5zaWZ5RnJhY3Rpb24oZGVuc2lmeUZyYWMpO3JldHVybiBkaXN0LmRpc3RhbmNlKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5zZXREZW5zaWZ5RnJhY3Rpb249ZnVuY3Rpb24oZGVuc2lmeUZyYWMpe2lmKGRlbnNpZnlGcmFjPjEuMHx8ZGVuc2lmeUZyYWM8PTAuMClcbnRocm93IG5ldyBqc3RzLmVycm9yLklsbGVnYWxBcmd1bWVudEVycm9yKCdGcmFjdGlvbiBpcyBub3QgaW4gcmFuZ2UgKDAuMCAtIDEuMF0nKTt0aGlzLmRlbnNpZnlGcmFjPWRlbnNpZnlGcmFjO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZGlzdGFuY2U9ZnVuY3Rpb24oKXt0aGlzLmNvbXB1dGUodGhpcy5nMCx0aGlzLmcxKTtyZXR1cm4gcHREaXN0LmdldERpc3RhbmNlKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5vcmllbnRlZERpc3RhbmNlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlT3JpZW50ZWREaXN0YW5jZSh0aGlzLmcwLHRoaXMuZzEsdGhpcy5wdERpc3QpO3JldHVybiB0aGlzLnB0RGlzdC5nZXREaXN0YW5jZSgpO307anN0cy5hbGdvcml0aG0uZGlzdGFuY2UuRGlzY3JldGVIYXVzZG9yZmZEaXN0YW5jZS5wcm90b3R5cGUuZ2V0Q29vcmRpbmF0ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gcHREaXN0LmdldENvb3JkaW5hdGVzKCk7fTtqc3RzLmFsZ29yaXRobS5kaXN0YW5jZS5EaXNjcmV0ZUhhdXNkb3JmZkRpc3RhbmNlLnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKGcwLGcxKXt0aGlzLmNvbXB1dGVPcmllbnRlZERpc3RhbmNlKGcwLGcxLHRoaXMucHREaXN0KTt0aGlzLmNvbXB1dGVPcmllbnRlZERpc3RhbmNlKGcxLGcwLHRoaXMucHREaXN0KTt9O2pzdHMuYWxnb3JpdGhtLmRpc3RhbmNlLkRpc2NyZXRlSGF1c2RvcmZmRGlzdGFuY2UucHJvdG90eXBlLmNvbXB1dGVPcmllbnRlZERpc3RhbmNlPWZ1bmN0aW9uKGRpc2NyZXRlR2VvbSxnZW9tLHB0RGlzdCl7dmFyIGRpc3RGaWx0ZXI9bmV3IE1heFBvaW50RGlzdGFuY2VGaWx0ZXIoZ2VvbSk7ZGlzY3JldGVHZW9tLmFwcGx5KGRpc3RGaWx0ZXIpO3B0RGlzdC5zZXRNYXhpbXVtKGRpc3RGaWx0ZXIuZ2V0TWF4UG9pbnREaXN0YW5jZSgpKTtpZih0aGlzLmRlbnNpZnlGcmFjPjApe3ZhciBmcmFjRmlsdGVyPW5ldyBNYXhEZW5zaWZpZWRCeUZyYWN0aW9uRGlzdGFuY2VGaWx0ZXIoZ2VvbSx0aGlzLmRlbnNpZnlGcmFjKTtkaXNjcmV0ZUdlb20uYXBwbHkoZnJhY0ZpbHRlcik7cHREaXN0LnNldE1heGltdW0oZnJhY0ZpbHRlci5nZXRNYXhQb2ludERpc3RhbmNlKCkpO319O30pKCk7anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlPWZ1bmN0aW9uKGdlb20pe3RoaXMuaW5wdXQ9bnVsbDt0aGlzLmV4dHJlbWFsUHRzPW51bGw7dGhpcy5jZW50cmU9bnVsbDt0aGlzLnJhZGl1cz0wO3RoaXMuaW5wdXQ9Z2VvbTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuZ2V0Q2lyY2xlPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKCk7aWYodGhpcy5jZW50cmU9PT1udWxsKXtyZXR1cm4gdGhpcy5pbnB1dC5nZXRGYWN0b3J5KCkuY3JlYXRlUG9seWdvbihudWxsLG51bGwpO31cbnZhciBjZW50cmVQb2ludD10aGlzLmlucHV0LmdldEZhY3RvcnkoKS5jcmVhdGVQb2ludCh0aGlzLmNlbnRyZSk7aWYodGhpcy5yYWRpdXM9PT0wKXtyZXR1cm4gY2VudHJlUG9pbnQ7fVxucmV0dXJuIGNlbnRyZVBvaW50LmJ1ZmZlcih0aGlzLnJhZGl1cyk7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldEV4dHJlbWFsUG9pbnRzPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKCk7cmV0dXJuIHRoaXMuZXh0cmVtYWxQdHM7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucHJvdG90eXBlLmdldENlbnRyZT1mdW5jdGlvbigpe3RoaXMuY29tcHV0ZSgpO3JldHVybiB0aGlzLmNlbnRyZTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuZ2V0UmFkaXVzPWZ1bmN0aW9uKCl7dGhpcy5jb21wdXRlKCk7cmV0dXJuIHRoaXMucmFkaXVzO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5jb21wdXRlQ2VudHJlPWZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZXh0cmVtYWxQdHMubGVuZ3RoKXtjYXNlIDA6dGhpcy5jZW50cmU9bnVsbDticmVhaztjYXNlIDE6dGhpcy5jZW50cmU9dGhpcy5leHRyZW1hbFB0c1swXTticmVhaztjYXNlIDI6dGhpcy5jZW50cmU9bmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKCh0aGlzLmV4dHJlbWFsUHRzWzBdLngrdGhpcy5leHRyZW1hbFB0c1sxXS54KS8yLCh0aGlzLmV4dHJlbWFsUHRzWzBdLnkrdGhpcy5leHRyZW1hbFB0c1sxXS55KS8yKTticmVhaztjYXNlIDM6dGhpcy5jZW50cmU9anN0cy5nZW9tLlRyaWFuZ2xlLmNpcmN1bWNlbnRyZSh0aGlzLmV4dHJlbWFsUHRzWzBdLHRoaXMuZXh0cmVtYWxQdHNbMV0sdGhpcy5leHRyZW1hbFB0c1syXSk7YnJlYWs7fX07anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5leHRyZW1hbFB0cyE9PW51bGwpe3JldHVybjt9XG50aGlzLmNvbXB1dGVDaXJjbGVQb2ludHMoKTt0aGlzLmNvbXB1dGVDZW50cmUoKTtpZih0aGlzLmNlbnRyZSE9PW51bGwpe3RoaXMucmFkaXVzPXRoaXMuY2VudHJlLmRpc3RhbmNlKHRoaXMuZXh0cmVtYWxQdHNbMF0pO319O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5wcm90b3R5cGUuY29tcHV0ZUNpcmNsZVBvaW50cz1mdW5jdGlvbigpe2lmKHRoaXMuaW5wdXQuaXNFbXB0eSgpKXt0aGlzLmV4dHJlbWFsUHRzPVtdO3JldHVybjt9XG52YXIgcHRzO2lmKHRoaXMuaW5wdXQuZ2V0TnVtUG9pbnRzKCk9PT0xKXtwdHM9dGhpcy5pbnB1dC5nZXRDb29yZGluYXRlcygpO3RoaXMuZXh0cmVtYWxQdHM9W25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShwdHNbMF0pXTtyZXR1cm47fVxudmFyIGNvbnZleEh1bGw9dGhpcy5pbnB1dC5jb252ZXhIdWxsKCk7dmFyIGh1bGxQdHM9Y29udmV4SHVsbC5nZXRDb29yZGluYXRlcygpO3B0cz1odWxsUHRzO2lmKGh1bGxQdHNbMF0uZXF1YWxzMkQoaHVsbFB0c1todWxsUHRzLmxlbmd0aC0xXSkpe3B0cz1bXTtqc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcChodWxsUHRzLDAscHRzLDAsaHVsbFB0cy5sZW5ndGgtMSk7fVxuaWYocHRzLmxlbmd0aDw9Mil7dGhpcy5leHRyZW1hbFB0cz1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5jb3B5RGVlcChwdHMpO3JldHVybjt9XG52YXIgUD1qc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUubG93ZXN0UG9pbnQocHRzKTt2YXIgUT1qc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucG9pbnRXaXRNaW5BbmdsZVdpdGhYKHB0cyxQKTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXt2YXIgUj1qc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucG9pbnRXaXRoTWluQW5nbGVXaXRoU2VnbWVudChwdHMsUCxRKTtpZihqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZShQLFIsUSkpe3RoaXMuZXh0cmVtYWxQdHM9W25ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShQKSxuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUSldO3JldHVybjt9XG5pZihqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZShSLFAsUSkpe1A9Ujtjb250aW51ZTt9XG5pZihqc3RzLmFsZ29yaXRobS5BbmdsZS5pc09idHVzZShSLFEsUCkpe1E9Ujtjb250aW51ZTt9XG50aGlzLmV4dHJlbWFsUHRzPVtuZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoUCksbmV3IGpzdHMuZ2VvbS5Db29yZGluYXRlKFEpLG5ldyBqc3RzLmdlb20uQ29vcmRpbmF0ZShSKV07cmV0dXJuO31cbnRocm93IG5ldyBFcnJvcihcIkxvZ2ljIGZhaWx1cmUgaW4gTWluaW11bSBCb3VuZGluZyBDaXJjbGUgYWxnb3JpdGhtIVwiKTt9O2pzdHMuYWxnb3JpdGhtLk1pbmltdW1Cb3VuZGluZ0NpcmNsZS5sb3dlc3RQb2ludD1mdW5jdGlvbihwdHMpe3ZhciBtaW49cHRzWzBdO2Zvcih2YXIgaT0xO2k8cHRzLmxlbmd0aDtpKyspe2lmKHB0c1tpXS55PG1pbi55KXttaW49cHRzW2ldO319XG5yZXR1cm4gbWluO307anN0cy5hbGdvcml0aG0uTWluaW11bUJvdW5kaW5nQ2lyY2xlLnBvaW50V2l0TWluQW5nbGVXaXRoWD1mdW5jdGlvbihwdHMsUCl7dmFyIG1pblNpbj1OdW1iZXIuTUFYX1ZBTFVFO3ZhciBtaW5BbmdQdD1udWxsO2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe3ZhciBwPXB0c1tpXTtpZihwPT09UCljb250aW51ZTt2YXIgZHg9cC54LVAueDt2YXIgZHk9cC55LVAueTtpZihkeTwwKWR5PS1keTt2YXIgbGVuPU1hdGguc3FydChkeCpkeCtkeSpkeSk7dmFyIHNpbj1keS9sZW47aWYoc2luPG1pblNpbil7bWluU2luPXNpbjttaW5BbmdQdD1wO319XG5yZXR1cm4gbWluQW5nUHQ7fTtqc3RzLmFsZ29yaXRobS5NaW5pbXVtQm91bmRpbmdDaXJjbGUucG9pbnRXaXRoTWluQW5nbGVXaXRoU2VnbWVudD1mdW5jdGlvbihwdHMsUCxRKXt2YXIgbWluQW5nPU51bWJlci5NQVhfVkFMVUU7dmFyIG1pbkFuZ1B0PW51bGw7Zm9yKHZhciBpPTA7aTxwdHMubGVuZ3RoO2krKyl7dmFyIHA9cHRzW2ldO2lmKHA9PT1QKWNvbnRpbnVlO2lmKHA9PT1RKWNvbnRpbnVlO3ZhciBhbmc9anN0cy5hbGdvcml0aG0uQW5nbGUuYW5nbGVCZXR3ZWVuKFAscCxRKTtpZihhbmc8bWluQW5nKXttaW5Bbmc9YW5nO21pbkFuZ1B0PXA7fX1cbnJldHVybiBtaW5BbmdQdDt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyPWZ1bmN0aW9uKG5vZGVyLHNjYWxlRmFjdG9yLG9mZnNldFgsb2Zmc2V0WSl7dGhpcy5vZmZzZXRYPW9mZnNldFg/b2Zmc2V0WDowO3RoaXMub2Zmc2V0WT1vZmZzZXRZP29mZnNldFk6MDt0aGlzLm5vZGVyPW5vZGVyO3RoaXMuc2NhbGVGYWN0b3I9c2NhbGVGYWN0b3I7dGhpcy5pc1NjYWxlZD0hdGhpcy5pc0ludGVnZXJQcmVjaXNpb24oKTt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZT1uZXcganN0cy5ub2RpbmcuTm9kZXIoKTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5jb25zdHJ1Y3Rvcj1qc3RzLm5vZGluZy5TY2FsZWROb2Rlcjtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUubm9kZXI9bnVsbDtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuc2NhbGVGYWN0b3I9dW5kZWZpbmVkO2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5vZmZzZXRYPXVuZGVmaW5lZDtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUub2Zmc2V0WT11bmRlZmluZWQ7anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLmlzU2NhbGVkPWZhbHNlO2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5pc0ludGVnZXJQcmVjaXNpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY2FsZUZhY3Rvcj09PTEuMDt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5nZXROb2RlZFN1YnN0cmluZ3M9ZnVuY3Rpb24oKXt2YXIgc3BsaXRTUz10aGlzLm5vZGVyLmdldE5vZGVkU3Vic3RyaW5ncygpO2lmKHRoaXMuaXNTY2FsZWQpXG50aGlzLnJlc2NhbGUoc3BsaXRTUyk7cmV0dXJuIHNwbGl0U1M7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUuY29tcHV0ZU5vZGVzPWZ1bmN0aW9uKGlucHV0U2VnU3RyaW5ncyl7dmFyIGludFNlZ1N0cmluZ3M9aW5wdXRTZWdTdHJpbmdzO2lmKHRoaXMuaXNTY2FsZWQpXG5pbnRTZWdTdHJpbmdzPXRoaXMuc2NhbGUoaW5wdXRTZWdTdHJpbmdzKTt0aGlzLm5vZGVyLmNvbXB1dGVOb2RlcyhpbnRTZWdTdHJpbmdzKTt9O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5zY2FsZT1mdW5jdGlvbihzZWdTdHJpbmdzKXtpZihzZWdTdHJpbmdzIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiB0aGlzLnNjYWxlMihzZWdTdHJpbmdzKTt9XG52YXIgdHJhbnNmb3JtZWQ9bmV3IGphdmFzY3JpcHQudXRpbC5BcnJheUxpc3QoKTtmb3IodmFyIGk9c2VnU3RyaW5ncy5pdGVyYXRvcigpO2kuaGFzTmV4dCgpOyl7dmFyIHNzPWkubmV4dCgpO3RyYW5zZm9ybWVkLmFkZChuZXcganN0cy5ub2RpbmcuTm9kZWRTZWdtZW50U3RyaW5nKHRoaXMuc2NhbGUoc3MuZ2V0Q29vcmRpbmF0ZXMoKSksc3MuZ2V0RGF0YSgpKSk7fVxucmV0dXJuIHRyYW5zZm9ybWVkO307anN0cy5ub2RpbmcuU2NhbGVkTm9kZXIucHJvdG90eXBlLnNjYWxlMj1mdW5jdGlvbihwdHMpe3ZhciByb3VuZFB0cz1bXTtmb3IodmFyIGk9MDtpPHB0cy5sZW5ndGg7aSsrKXtyb3VuZFB0c1tpXT1uZXcganN0cy5nZW9tLkNvb3JkaW5hdGUoTWF0aC5yb3VuZCgocHRzW2ldLngtdGhpcy5vZmZzZXRYKSp0aGlzLnNjYWxlRmFjdG9yKSxNYXRoLnJvdW5kKChwdHNbaV0ueS10aGlzLm9mZnNldFkpKnRoaXMuc2NhbGVGYWN0b3IpKTt9XG52YXIgcm91bmRQdHNOb0R1cD1qc3RzLmdlb20uQ29vcmRpbmF0ZUFycmF5cy5yZW1vdmVSZXBlYXRlZFBvaW50cyhyb3VuZFB0cyk7cmV0dXJuIHJvdW5kUHRzTm9EdXA7fTtqc3RzLm5vZGluZy5TY2FsZWROb2Rlci5wcm90b3R5cGUucmVzY2FsZT1mdW5jdGlvbihzZWdTdHJpbmdzKXtpZihzZWdTdHJpbmdzIGluc3RhbmNlb2YgQXJyYXkpe3RoaXMucmVzY2FsZTIoc2VnU3RyaW5ncyk7cmV0dXJuO31cbmZvcih2YXIgaT1zZWdTdHJpbmdzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgc3M9aS5uZXh0KCk7dGhpcy5yZXNjYWxlKHNzLmdldENvb3JkaW5hdGVzKCkpO319O2pzdHMubm9kaW5nLlNjYWxlZE5vZGVyLnByb3RvdHlwZS5yZXNjYWxlMj1mdW5jdGlvbihwdHMpe2Zvcih2YXIgaT0wO2k8cHRzLmxlbmd0aDtpKyspe3B0c1tpXS54PXB0c1tpXS54L3RoaXMuc2NhbGVGYWN0b3IrdGhpcy5vZmZzZXRYO3B0c1tpXS55PXB0c1tpXS55L3RoaXMuc2NhbGVGYWN0b3IrdGhpcy5vZmZzZXRZO319OyhmdW5jdGlvbigpe3ZhciBBcnJheUxpc3Q9amF2YXNjcmlwdC51dGlsLkFycmF5TGlzdDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3I9ZnVuY3Rpb24obGksaW5jbHVkZVByb3BlcixyZWNvcmRJc29sYXRlZCl7dGhpcy5saT1saTt0aGlzLmluY2x1ZGVQcm9wZXI9aW5jbHVkZVByb3Blcjt0aGlzLnJlY29yZElzb2xhdGVkPXJlY29yZElzb2xhdGVkO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLmlzQWRqYWNlbnRTZWdtZW50cz1mdW5jdGlvbihpMSxpMil7cmV0dXJuIE1hdGguYWJzKGkxLWkyKT09PTE7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLl9oYXNJbnRlcnNlY3Rpb249ZmFsc2U7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNQcm9wZXI9ZmFsc2U7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5oYXNQcm9wZXJJbnRlcmlvcj1mYWxzZTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLnByb3BlckludGVyc2VjdGlvblBvaW50PW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5saT1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaW5jbHVkZVByb3Blcj1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUucmVjb3JkSXNvbGF0ZWQ9bnVsbDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmlzU2VsZkludGVyc2VjdGlvbj1udWxsO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUubnVtSW50ZXJzZWN0aW9ucz0wO2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUubnVtVGVzdHM9MDtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmJkeU5vZGVzPW51bGw7anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5zZXRCb3VuZGFyeU5vZGVzPWZ1bmN0aW9uKGJkeU5vZGVzMCxiZHlOb2RlczEpe3RoaXMuYmR5Tm9kZXM9W107dGhpcy5iZHlOb2Rlc1swXT1iZHlOb2RlczA7dGhpcy5iZHlOb2Rlc1sxXT1iZHlOb2RlczE7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmdldFByb3BlckludGVyc2VjdGlvblBvaW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvcGVySW50ZXJzZWN0aW9uUG9pbnQ7fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmhhc0ludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNJbnRlcnNlY3Rpb247fTtqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IucHJvdG90eXBlLmhhc1Byb3BlckludGVyc2VjdGlvbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhhc1Byb3Blcjt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaGFzUHJvcGVySW50ZXJpb3JJbnRlcnNlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oYXNQcm9wZXJJbnRlcmlvcjt9O2pzdHMuZ2VvbWdyYXBoLmluZGV4LlNlZ21lbnRJbnRlcnNlY3Rvci5wcm90b3R5cGUuaXNUcml2aWFsSW50ZXJzZWN0aW9uPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEpe2lmKHRoaXMubGkuZ2V0SW50ZXJzZWN0aW9uTnVtKCk9PT0xKXtpZihqc3RzLmdlb21ncmFwaC5pbmRleC5TZWdtZW50SW50ZXJzZWN0b3IuaXNBZGphY2VudFNlZ21lbnRzKHNlZ0luZGV4MCxzZWdJbmRleDEpKVxucmV0dXJuIHRydWU7aWYoZTAuaXNDbG9zZWQoKSl7dmFyIG1heFNlZ0luZGV4PWUwLmdldE51bVBvaW50cygpLTE7aWYoKHNlZ0luZGV4MD09PTAmJnNlZ0luZGV4MT09PW1heFNlZ0luZGV4KXx8KHNlZ0luZGV4MT09PTAmJnNlZ0luZGV4MD09PW1heFNlZ0luZGV4KSl7cmV0dXJuIHRydWU7fX19fVxucmV0dXJuIGZhbHNlO307anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5hZGRJbnRlcnNlY3Rpb25zPWZ1bmN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpe2lmKGUwPT09ZTEmJnNlZ0luZGV4MD09PXNlZ0luZGV4MSlcbnJldHVybjt0aGlzLm51bVRlc3RzKys7dmFyIHAwMD1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MF07dmFyIHAwMT1lMC5nZXRDb29yZGluYXRlcygpW3NlZ0luZGV4MCsxXTt2YXIgcDEwPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxXTt2YXIgcDExPWUxLmdldENvb3JkaW5hdGVzKClbc2VnSW5kZXgxKzFdO3RoaXMubGkuY29tcHV0ZUludGVyc2VjdGlvbihwMDAscDAxLHAxMCxwMTEpO2lmKHRoaXMubGkuaGFzSW50ZXJzZWN0aW9uKCkpe2lmKHRoaXMucmVjb3JkSXNvbGF0ZWQpe2UwLnNldElzb2xhdGVkKGZhbHNlKTtlMS5zZXRJc29sYXRlZChmYWxzZSk7fVxudGhpcy5udW1JbnRlcnNlY3Rpb25zKys7aWYoIXRoaXMuaXNUcml2aWFsSW50ZXJzZWN0aW9uKGUwLHNlZ0luZGV4MCxlMSxzZWdJbmRleDEpKXt0aGlzLl9oYXNJbnRlcnNlY3Rpb249dHJ1ZTtpZih0aGlzLmluY2x1ZGVQcm9wZXJ8fCF0aGlzLmxpLmlzUHJvcGVyKCkpe2UwLmFkZEludGVyc2VjdGlvbnModGhpcy5saSxzZWdJbmRleDAsMCk7ZTEuYWRkSW50ZXJzZWN0aW9ucyh0aGlzLmxpLHNlZ0luZGV4MSwxKTt9XG5pZih0aGlzLmxpLmlzUHJvcGVyKCkpe3RoaXMucHJvcGVySW50ZXJzZWN0aW9uUG9pbnQ9dGhpcy5saS5nZXRJbnRlcnNlY3Rpb24oMCkuY2xvbmUoKTt0aGlzLmhhc1Byb3Blcj10cnVlO2lmKCF0aGlzLmlzQm91bmRhcnlQb2ludCh0aGlzLmxpLHRoaXMuYmR5Tm9kZXMpKVxudGhpcy5oYXNQcm9wZXJJbnRlcmlvcj10cnVlO319fX07anN0cy5nZW9tZ3JhcGguaW5kZXguU2VnbWVudEludGVyc2VjdG9yLnByb3RvdHlwZS5pc0JvdW5kYXJ5UG9pbnQ9ZnVuY3Rpb24obGksYmR5Tm9kZXMpe2lmKGJkeU5vZGVzPT09bnVsbClcbnJldHVybiBmYWxzZTtpZihiZHlOb2RlcyBpbnN0YW5jZW9mIEFycmF5KXtpZih0aGlzLmlzQm91bmRhcnlQb2ludChsaSxiZHlOb2Rlc1swXSkpXG5yZXR1cm4gdHJ1ZTtpZih0aGlzLmlzQm91bmRhcnlQb2ludChsaSxiZHlOb2Rlc1sxXSkpXG5yZXR1cm4gdHJ1ZTtyZXR1cm4gZmFsc2U7fWVsc2V7Zm9yKHZhciBpPWJkeU5vZGVzLml0ZXJhdG9yKCk7aS5oYXNOZXh0KCk7KXt2YXIgbm9kZT1pLm5leHQoKTt2YXIgcHQ9bm9kZS5nZXRDb29yZGluYXRlKCk7aWYobGkuaXNJbnRlcnNlY3Rpb24ocHQpKVxucmV0dXJuIHRydWU7fVxucmV0dXJuIGZhbHNlO319O30pKCk7IiwiLypcbiAgamF2YXNjcmlwdC51dGlsIGlzIGEgcG9ydCBvZiBzZWxlY3RlZCBwYXJ0cyBvZiBqYXZhLnV0aWwgdG8gSmF2YVNjcmlwdCB3aGljaFxuICBtYWluIHB1cnBvc2UgaXMgdG8gZWFzZSBwb3J0aW5nIEphdmEgY29kZSB0byBKYXZhU2NyaXB0LlxuICBcbiAgVGhlIE1JVCBMaWNlbnNlIChNSVQpXG5cbiAgQ29weXJpZ2h0IChDKSAyMDExLTIwMTQgYnkgVGhlIEF1dGhvcnNcblxuICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG4gIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG4gIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAgVEhFIFNPRlRXQVJFLlxuKi9cbjsoZnVuY3Rpb24oKXt2YXIgZT10aGlzO2Z1bmN0aW9uIGYoYSxiKXt2YXIgYz1hLnNwbGl0KFwiLlwiKSxkPWU7Y1swXWluIGR8fCFkLmV4ZWNTY3JpcHR8fGQuZXhlY1NjcmlwdChcInZhciBcIitjWzBdKTtmb3IodmFyIHQ7Yy5sZW5ndGgmJih0PWMuc2hpZnQoKSk7KWMubGVuZ3RofHx2b2lkIDA9PT1iP2Q9ZFt0XT9kW3RdOmRbdF09e306ZFt0XT1ifWZ1bmN0aW9uIGcoYSxiKXtmdW5jdGlvbiBjKCl7fWMucHJvdG90eXBlPWIucHJvdG90eXBlO2EucT1iLnByb3RvdHlwZTthLnByb3RvdHlwZT1uZXcgYzthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO2EucD1mdW5jdGlvbihhLGMsTyl7dmFyIE09QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBiLnByb3RvdHlwZVtjXS5hcHBseShhLE0pfX07ZnVuY3Rpb24gaChhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKGgsRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuRW1wdHlTdGFja0V4Y2VwdGlvblwiLGgpO2gucHJvdG90eXBlLm5hbWU9XCJFbXB0eVN0YWNrRXhjZXB0aW9uXCI7ZnVuY3Rpb24gayhhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKGssRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiLGspO2sucHJvdG90eXBlLm5hbWU9XCJJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXCI7ZnVuY3Rpb24gbCgpe31mKFwiamF2YXNjcmlwdC51dGlsLkl0ZXJhdG9yXCIsbCk7bC5wcm90b3R5cGUuaGFzTmV4dD1sLnByb3RvdHlwZS5jO2wucHJvdG90eXBlLm5leHQ9bC5wcm90b3R5cGUubmV4dDtsLnByb3RvdHlwZS5yZW1vdmU9bC5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIG0oKXt9ZihcImphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uXCIsbSk7ZnVuY3Rpb24gbigpe31nKG4sbSk7ZihcImphdmFzY3JpcHQudXRpbC5MaXN0XCIsbik7ZnVuY3Rpb24gcCgpe31mKFwiamF2YXNjcmlwdC51dGlsLk1hcFwiLHApO2Z1bmN0aW9uIHEoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhxLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIixxKTtxLnByb3RvdHlwZS5uYW1lPVwiTm9TdWNoRWxlbWVudEV4Y2VwdGlvblwiO2Z1bmN0aW9uIHIoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhyLEVycm9yKTtyLnByb3RvdHlwZS5uYW1lPVwiT3BlcmF0aW9uTm90U3VwcG9ydGVkXCI7ZnVuY3Rpb24gcyhhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKHMsbik7ZihcImphdmFzY3JpcHQudXRpbC5BcnJheUxpc3RcIixzKTtzLnByb3RvdHlwZS5hPW51bGw7cy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtzLnByb3RvdHlwZS5hZGQ9cy5wcm90b3R5cGUuYWRkO3MucHJvdG90eXBlLmU9ZnVuY3Rpb24oYSl7Zm9yKGE9YS5mKCk7YS5jKCk7KXRoaXMuYWRkKGEubmV4dCgpKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkQWxsPXMucHJvdG90eXBlLmU7cy5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5hW2FdO3RoaXMuYVthXT1iO3JldHVybiBjfTtzLnByb3RvdHlwZS5zZXQ9cy5wcm90b3R5cGUuc2V0O3MucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHUodGhpcyl9O3MucHJvdG90eXBlLml0ZXJhdG9yPXMucHJvdG90eXBlLmY7XG5zLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7aWYoMD5hfHxhPj10aGlzLnNpemUoKSl0aHJvdyBuZXcgaztyZXR1cm4gdGhpcy5hW2FdfTtzLnByb3RvdHlwZS5nZXQ9cy5wcm90b3R5cGUuZ2V0O3MucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3MucHJvdG90eXBlLmlzRW1wdHk9cy5wcm90b3R5cGUuZztzLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3MucHJvdG90eXBlLnNpemU9cy5wcm90b3R5cGUuc2l6ZTtzLnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07cy5wcm90b3R5cGUudG9BcnJheT1zLnByb3RvdHlwZS5oO1xucy5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0hMSxjPTAsZD10aGlzLmEubGVuZ3RoO2M8ZDtjKyspaWYodGhpcy5hW2NdPT09YSl7dGhpcy5hLnNwbGljZShjLDEpO2I9ITA7YnJlYWt9cmV0dXJuIGJ9O3MucHJvdG90eXBlLnJlbW92ZT1zLnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdShhKXt0aGlzLmo9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl9cIix1KTt1LnByb3RvdHlwZS5qPW51bGw7dS5wcm90b3R5cGUuYj0wO3UucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmouc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmouZ2V0KHRoaXMuYisrKX07dS5wcm90b3R5cGUubmV4dD11LnByb3RvdHlwZS5uZXh0O3UucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMuai5zaXplKCk/ITA6ITF9O3UucHJvdG90eXBlLmhhc05leHQ9dS5wcm90b3R5cGUuYztcbnUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307dS5wcm90b3R5cGUucmVtb3ZlPXUucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiB2KCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlzXCIsdik7XG52LnNvcnQ9ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHNbMF0sYixjLGQ7aWYoMT09PWFyZ3VtZW50cy5sZW5ndGgpYS5zb3J0KCk7ZWxzZSBpZigyPT09YXJndW1lbnRzLmxlbmd0aCljPWFyZ3VtZW50c1sxXSxkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuY29tcGFyZShhLGIpfSxhLnNvcnQoZCk7ZWxzZSBpZigzPT09YXJndW1lbnRzLmxlbmd0aClmb3IoYj1hLnNsaWNlKGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pLGIuc29ydCgpLGQ9YS5zbGljZSgwLGFyZ3VtZW50c1sxXSkuY29uY2F0KGIsYS5zbGljZShhcmd1bWVudHNbMl0sYS5sZW5ndGgpKSxhLnNwbGljZSgwLGEubGVuZ3RoKSxiPTA7YjxkLmxlbmd0aDtiKyspYS5wdXNoKGRbYl0pO2Vsc2UgaWYoND09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxjPWFyZ3VtZW50c1szXSxkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuY29tcGFyZShhLGIpfSxiLnNvcnQoZCksXG5kPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKX07di5hc0xpc3Q9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPW5ldyBzLGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspYi5hZGQoYVtjXSk7cmV0dXJuIGJ9O2Z1bmN0aW9uIHcoKXt0aGlzLmk9e319Zyh3LHApO2YoXCJqYXZhc2NyaXB0LnV0aWwuSGFzaE1hcFwiLHcpO3cucHJvdG90eXBlLmk9bnVsbDt3LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuaVthXXx8bnVsbH07dy5wcm90b3R5cGUuZ2V0PXcucHJvdG90eXBlLmdldDt3LnByb3RvdHlwZS5wdXQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5pW2FdPWJ9O3cucHJvdG90eXBlLnB1dD13LnByb3RvdHlwZS5wdXQ7dy5wcm90b3R5cGUubT1mdW5jdGlvbigpe3ZhciBhPW5ldyBzLGI7Zm9yKGIgaW4gdGhpcy5pKXRoaXMuaS5oYXNPd25Qcm9wZXJ0eShiKSYmYS5hZGQodGhpcy5pW2JdKTtyZXR1cm4gYX07dy5wcm90b3R5cGUudmFsdWVzPXcucHJvdG90eXBlLm07dy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm0oKS5zaXplKCl9O3cucHJvdG90eXBlLnNpemU9dy5wcm90b3R5cGUuc2l6ZTtmdW5jdGlvbiB4KCl7fWcoeCxtKTtmKFwiamF2YXNjcmlwdC51dGlsLlNldFwiLHgpO2Z1bmN0aW9uIHkoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9Zyh5LHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuSGFzaFNldFwiLHkpO3kucHJvdG90eXBlLmE9bnVsbDt5LnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZih0aGlzLmFbYl09PT1hKXJldHVybiEwO3JldHVybiExfTt5LnByb3RvdHlwZS5jb250YWlucz15LnByb3RvdHlwZS5jb250YWluczt5LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7aWYodGhpcy5jb250YWlucyhhKSlyZXR1cm4hMTt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07eS5wcm90b3R5cGUuYWRkPXkucHJvdG90eXBlLmFkZDt5LnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZEFsbD15LnByb3RvdHlwZS5lO1xueS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt5LnByb3RvdHlwZS5yZW1vdmU9eS5wcm90b3R5cGUucmVtb3ZlO3kucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07eS5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07eS5wcm90b3R5cGUuaXNFbXB0eT15LnByb3RvdHlwZS5nO3kucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTt5LnByb3RvdHlwZS50b0FycmF5PXkucHJvdG90eXBlLmg7eS5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgeih0aGlzKX07eS5wcm90b3R5cGUuaXRlcmF0b3I9eS5wcm90b3R5cGUuZjtmdW5jdGlvbiB6KGEpe3RoaXMuaz1hfWYoXCIkanNjb21wLnNjb3BlLkl0ZXJhdG9yXyQxXCIseik7ei5wcm90b3R5cGUuaz1udWxsO1xuei5wcm90b3R5cGUuYj0wO3oucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmsuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmsuYVt0aGlzLmIrK119O3oucHJvdG90eXBlLm5leHQ9ei5wcm90b3R5cGUubmV4dDt6LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmsuc2l6ZSgpPyEwOiExfTt6LnByb3RvdHlwZS5oYXNOZXh0PXoucHJvdG90eXBlLmM7ei5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt6LnByb3RvdHlwZS5yZW1vdmU9ei5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIEEoKXt9ZyhBLHApO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkTWFwXCIsQSk7ZnVuY3Rpb24gQigpe31nKEIseCk7ZihcImphdmFzY3JpcHQudXRpbC5Tb3J0ZWRTZXRcIixCKTtmdW5jdGlvbiBDKCl7dGhpcy5hPVtdfWcoQyxuKTtmKFwiamF2YXNjcmlwdC51dGlsLlN0YWNrXCIsQyk7Qy5wcm90b3R5cGUuYT1udWxsO0MucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oYSl7dGhpcy5hLnB1c2goYSk7cmV0dXJuIGF9O0MucHJvdG90eXBlLnB1c2g9Qy5wcm90b3R5cGUucHVzaDtDLnByb3RvdHlwZS5wb3A9ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5hLmxlbmd0aCl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5hLnBvcCgpfTtDLnByb3RvdHlwZS5wb3A9Qy5wcm90b3R5cGUucG9wO0MucHJvdG90eXBlLm89ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5hLmxlbmd0aCl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5hW3RoaXMuYS5sZW5ndGgtMV19O0MucHJvdG90eXBlLnBlZWs9Qy5wcm90b3R5cGUubztDLnByb3RvdHlwZS5lbXB0eT1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aD8hMDohMX07Qy5wcm90b3R5cGUuZW1wdHk9Qy5wcm90b3R5cGUuZW1wdHk7XG5DLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW1wdHkoKX07Qy5wcm90b3R5cGUuaXNFbXB0eT1DLnByb3RvdHlwZS5nO0MucHJvdG90eXBlLnNlYXJjaD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hLmluZGV4T2YoYSl9O0MucHJvdG90eXBlLnNlYXJjaD1DLnByb3RvdHlwZS5zZWFyY2g7Qy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtDLnByb3RvdHlwZS5zaXplPUMucHJvdG90eXBlLnNpemU7Qy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O0MucHJvdG90eXBlLnRvQXJyYXk9Qy5wcm90b3R5cGUuaDtmdW5jdGlvbiBEKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5wYXJlbnR9ZnVuY3Rpb24gRShhLGIpe251bGwhPT1hJiYoYS5jb2xvcj1iKX1mdW5jdGlvbiBGKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5sZWZ0fWZ1bmN0aW9uIEcoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLnJpZ2h0fWZ1bmN0aW9uIEgoKXt0aGlzLmQ9bnVsbDt0aGlzLm49MH1nKEgsQSk7ZihcImphdmFzY3JpcHQudXRpbC5UcmVlTWFwXCIsSCk7SC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmQ7bnVsbCE9PWI7KXt2YXIgYz1hLmNvbXBhcmVUbyhiLmtleSk7aWYoMD5jKWI9Yi5sZWZ0O2Vsc2UgaWYoMDxjKWI9Yi5yaWdodDtlbHNlIHJldHVybiBiLnZhbHVlfXJldHVybiBudWxsfTtILnByb3RvdHlwZS5nZXQ9SC5wcm90b3R5cGUuZ2V0O1xuSC5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7aWYobnVsbD09PXRoaXMuZClyZXR1cm4gdGhpcy5kPXtrZXk6YSx2YWx1ZTpiLGxlZnQ6bnVsbCxyaWdodDpudWxsLHBhcmVudDpudWxsLGNvbG9yOjB9LHRoaXMubj0xLG51bGw7dmFyIGM9dGhpcy5kLGQsdDtkbyBpZihkPWMsdD1hLmNvbXBhcmVUbyhjLmtleSksMD50KWM9Yy5sZWZ0O2Vsc2UgaWYoMDx0KWM9Yy5yaWdodDtlbHNlIHJldHVybiBkPWMudmFsdWUsYy52YWx1ZT1iLGQ7d2hpbGUobnVsbCE9PWMpO2M9e2tleTphLGxlZnQ6bnVsbCxyaWdodDpudWxsLHZhbHVlOmIscGFyZW50OmQsY29sb3I6MH07MD50P2QubGVmdD1jOmQucmlnaHQ9Yztmb3IoYy5jb2xvcj0xO251bGwhPWMmJmMhPXRoaXMuZCYmMT09Yy5wYXJlbnQuY29sb3I7KUQoYyk9PUYoRChEKGMpKSk/KGQ9RyhEKEQoYykpKSwxPT0obnVsbD09ZD8wOmQuY29sb3IpPyhFKEQoYyksMCksRShkLDApLEUoRChEKGMpKSwxKSxjPUQoRChjKSkpOihjPT1HKEQoYykpJiZcbihjPUQoYyksSSh0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEoodGhpcyxEKEQoYykpKSkpOihkPUYoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RihEKGMpKSYmKGM9RChjKSxKKHRoaXMsYykpLEUoRChjKSwwKSxFKEQoRChjKSksMSksSSh0aGlzLEQoRChjKSkpKSk7dGhpcy5kLmNvbG9yPTA7dGhpcy5uKys7cmV0dXJuIG51bGx9O0gucHJvdG90eXBlLnB1dD1ILnByb3RvdHlwZS5wdXQ7SC5wcm90b3R5cGUubT1mdW5jdGlvbigpe3ZhciBhPW5ldyBzLGI7Yj10aGlzLmQ7aWYobnVsbCE9Yilmb3IoO251bGwhPWIubGVmdDspYj1iLmxlZnQ7aWYobnVsbCE9PWIpZm9yKGEuYWRkKGIudmFsdWUpO251bGwhPT0oYj1LKGIpKTspYS5hZGQoYi52YWx1ZSk7cmV0dXJuIGF9O0gucHJvdG90eXBlLnZhbHVlcz1ILnByb3RvdHlwZS5tO1xuZnVuY3Rpb24gSShhLGIpe2lmKG51bGwhPWIpe3ZhciBjPWIucmlnaHQ7Yi5yaWdodD1jLmxlZnQ7bnVsbCE9Yy5sZWZ0JiYoYy5sZWZ0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5sZWZ0PT1iP2IucGFyZW50LmxlZnQ9YzpiLnBhcmVudC5yaWdodD1jO2MubGVmdD1iO2IucGFyZW50PWN9fWZ1bmN0aW9uIEooYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLmxlZnQ7Yi5sZWZ0PWMucmlnaHQ7bnVsbCE9Yy5yaWdodCYmKGMucmlnaHQucGFyZW50PWIpO2MucGFyZW50PWIucGFyZW50O251bGw9PWIucGFyZW50P2EuZD1jOmIucGFyZW50LnJpZ2h0PT1iP2IucGFyZW50LnJpZ2h0PWM6Yi5wYXJlbnQubGVmdD1jO2MucmlnaHQ9YjtiLnBhcmVudD1jfX1cbmZ1bmN0aW9uIEsoYSl7aWYobnVsbD09PWEpcmV0dXJuIG51bGw7aWYobnVsbCE9PWEucmlnaHQpZm9yKHZhciBiPWEucmlnaHQ7bnVsbCE9PWIubGVmdDspYj1iLmxlZnQ7ZWxzZSBmb3IoYj1hLnBhcmVudDtudWxsIT09YiYmYT09PWIucmlnaHQ7KWE9YixiPWIucGFyZW50O3JldHVybiBifUgucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ufTtILnByb3RvdHlwZS5zaXplPUgucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24gTChhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKEwsQik7ZihcImphdmFzY3JpcHQudXRpbC5UcmVlU2V0XCIsTCk7TC5wcm90b3R5cGUuYT1udWxsO0wucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWlmKDA9PT10aGlzLmFbYl0uY29tcGFyZVRvKGEpKXJldHVybiEwO3JldHVybiExfTtMLnByb3RvdHlwZS5jb250YWlucz1MLnByb3RvdHlwZS5jb250YWlucztMLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7aWYodGhpcy5jb250YWlucyhhKSlyZXR1cm4hMTtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigxPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4gdGhpcy5hLnNwbGljZShiLDAsYSksITA7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O0wucHJvdG90eXBlLmFkZD1MLnByb3RvdHlwZS5hZGQ7XG5MLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O0wucHJvdG90eXBlLmFkZEFsbD1MLnByb3RvdHlwZS5lO0wucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307TC5wcm90b3R5cGUucmVtb3ZlPUwucHJvdG90eXBlLnJlbW92ZTtMLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O0wucHJvdG90eXBlLnNpemU9TC5wcm90b3R5cGUuc2l6ZTtMLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5pc0VtcHR5PUwucHJvdG90eXBlLmc7TC5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O0wucHJvdG90eXBlLnRvQXJyYXk9TC5wcm90b3R5cGUuaDtMLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBOKHRoaXMpfTtcbkwucHJvdG90eXBlLml0ZXJhdG9yPUwucHJvdG90eXBlLmY7ZnVuY3Rpb24gTihhKXt0aGlzLmw9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMlwiLE4pO04ucHJvdG90eXBlLmw9bnVsbDtOLnByb3RvdHlwZS5iPTA7Ti5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKHRoaXMuYj09PXRoaXMubC5zaXplKCkpdGhyb3cgbmV3IHE7cmV0dXJuIHRoaXMubC5hW3RoaXMuYisrXX07Ti5wcm90b3R5cGUubmV4dD1OLnByb3RvdHlwZS5uZXh0O04ucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMubC5zaXplKCk/ITA6ITF9O04ucHJvdG90eXBlLmhhc05leHQ9Ti5wcm90b3R5cGUuYztOLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O04ucHJvdG90eXBlLnJlbW92ZT1OLnByb3RvdHlwZS5yZW1vdmU7XCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBnbG9iYWwmJihnbG9iYWwuamF2YXNjcmlwdD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsPXt9LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0PXMsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5BcnJheXM9dixnbG9iYWwuamF2YXNjcmlwdC51dGlsLkNvbGxlY3Rpb249bSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb249aCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkhhc2hNYXA9dyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkhhc2hTZXQ9eSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb249ayxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkl0ZXJhdG9yPWwsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5MaXN0PW4sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5NYXA9cCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb249cSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLk9wZXJhdGlvbk5vdFN1cHBvcnRlZD1cbnIsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5TZXQ9eCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcD1BLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0PUIsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5TdGFjaz1DLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcD1ILGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuVHJlZVNldD1MKTt9KS5jYWxsKHRoaXMpO1xuIiwicmVxdWlyZSgnLi9kaXN0L2phdmFzY3JpcHQudXRpbC1ub2RlLm1pbi5qcycpO1xuIiwidmFyIGV4dGVudCA9IHJlcXVpcmUoJ3R1cmYtZXh0ZW50JyksXG4gICAgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIGFueSB0eXBlIGFuZCByZXR1cm5zIHRoZSBhYnNvbHV0ZSBjZW50ZXIgcG9pbnQgb2YgYWxsIGZlYXR1cmVzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9jZW50ZXJcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gZmVhdHVyZXMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBhbnkgdHlwZVxuICogQHJldHVybiB7UG9pbnR9IGEgUG9pbnQgZmVhdHVyZSBhdCB0aGVcbiAqIGFic29sdXRlIGNlbnRlciBwb2ludCBvZiBhbGwgaW5wdXQgZmVhdHVyZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgZmVhdHVyZXMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTIyMjU5LCAzNS40NjkxXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTAyNzU0LCAzNS40NjM0NTVdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny41MDgyNjksIDM1LjQ2MzI0NV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUxNjgwOSwgMzUuNDY1Nzc5XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTE1MzcyLCAzNS40NjcwNzJdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny41MDkzNjMsIDM1LjQ2MzA1M11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUxMTEyMywgMzUuNDY2NjAxXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTE4NTQ3LCAzNS40NjkzMjddXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny41MTk3MDYsIDM1LjQ2OTY1OV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjUxNzgzOSwgMzUuNDY2OTk4XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuNTA4Njc4LCAzNS40NjQ5NDJdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny41MTQ5MTQsIDM1LjQ2MzQ1M11cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGNlbnRlclB0ID0gdHVyZi5jZW50ZXIoZmVhdHVyZXMpO1xuICogY2VudGVyUHQucHJvcGVydGllc1snbWFya2VyLXNpemUnXSA9ICdsYXJnZSc7XG4gKiBjZW50ZXJQdC5wcm9wZXJ0aWVzWydtYXJrZXItY29sb3InXSA9ICcjMDAwJztcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBmZWF0dXJlcy5mZWF0dXJlcy5jb25jYXQoY2VudGVyUHQpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxheWVyLCBkb25lKXtcbiAgdmFyIGV4dCA9IGV4dGVudChsYXllcik7XG4gIHZhciB4ID0gKGV4dFswXSArIGV4dFsyXSkvMjtcbiAgdmFyIHkgPSAoZXh0WzFdICsgZXh0WzNdKS8yO1xuICByZXR1cm4gcG9pbnQoW3gsIHldKTtcbn07XG4iLCJ2YXIgZWFjaCA9IHJlcXVpcmUoJ3R1cmYtbWV0YScpLmNvb3JkRWFjaDtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlfSBvciB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIGFueSB0eXBlIGFuZCBjYWxjdWxhdGVzIHRoZSBjZW50cm9pZCB1c2luZyB0aGUgYXJpdGhtZXRpYyBtZWFuIG9mIGFsbCB2ZXJ0aWNlcy5cbiAqIFRoaXMgbGVzc2VucyB0aGUgZWZmZWN0IG9mIHNtYWxsIGlzbGFuZHMgYW5kIGFydGlmYWN0cyB3aGVuIGNhbGN1bGF0aW5nXG4gKiB0aGUgY2VudHJvaWQgb2YgYSBzZXQgb2YgcG9seWdvbnMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2NlbnRyb2lkXG4gKiBAY2F0ZWdvcnkgbWVhc3VyZW1lbnRcbiAqIEBwYXJhbSB7R2VvSlNPTn0gZmVhdHVyZXMgYSB7QGxpbmsgRmVhdHVyZX0gb3IgRmVhdHVyZUNvbGxlY3Rpb24gb2YgYW55IHR5cGVcbiAqIEByZXR1cm4ge1BvaW50fSBhIFBvaW50IGZlYXR1cmUgYXQgdGhlIGNlbnRyb2lkIG9mIHRoZSBpbnB1dCBmZWF0dXJlKHMpXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHkgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWzEwNS44MTg5MzksMjEuMDA0NzE0XSxcbiAqICAgICAgIFsxMDUuODE4OTM5LDIxLjA2MTc1NF0sXG4gKiAgICAgICBbMTA1Ljg5MDAwNywyMS4wNjE3NTRdLFxuICogICAgICAgWzEwNS44OTAwMDcsMjEuMDA0NzE0XSxcbiAqICAgICAgIFsxMDUuODE4OTM5LDIxLjAwNDcxNF1cbiAqICAgICBdXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBjZW50cm9pZFB0ID0gdHVyZi5jZW50cm9pZChwb2x5KTtcbiAqXG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtwb2x5LCBjZW50cm9pZFB0XVxuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmZWF0dXJlcyl7XG4gIHZhciB4U3VtID0gMCwgeVN1bSA9IDAsIGxlbiA9IDA7XG4gIGVhY2goZmVhdHVyZXMsIGZ1bmN0aW9uKGNvb3JkKSB7XG4gICAgeFN1bSArPSBjb29yZFswXTtcbiAgICB5U3VtICs9IGNvb3JkWzFdO1xuICAgIGxlbisrO1xuICB9LCB0cnVlKTtcbiAgcmV0dXJuIHBvaW50KFt4U3VtIC8gbGVuLCB5U3VtIC8gbGVuXSk7XG59O1xuIiwiLyoqXG4gKiBMYXppbHkgaXRlcmF0ZSBvdmVyIGNvb3JkaW5hdGVzIGluIGFueSBHZW9KU09OIG9iamVjdCwgc2ltaWxhciB0b1xuICogQXJyYXkuZm9yRWFjaC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gbGF5ZXIgYW55IEdlb0pTT04gb2JqZWN0XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBhIG1ldGhvZCB0aGF0IHRha2VzICh2YWx1ZSlcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IGV4Y2x1ZGVXcmFwQ29vcmQgd2hldGhlciBvciBub3QgdG8gaW5jbHVkZVxuICogdGhlIGZpbmFsIGNvb3JkaW5hdGUgb2YgTGluZWFyUmluZ3MgdGhhdCB3cmFwcyB0aGUgcmluZyBpbiBpdHMgaXRlcmF0aW9uLlxuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludCA9IHsgdHlwZTogJ1BvaW50JywgY29vcmRpbmF0ZXM6IFswLCAwXSB9O1xuICogY29vcmRFYWNoKHBvaW50LCBmdW5jdGlvbihjb29yZHMpIHtcbiAqICAgLy8gY29vcmRzIGlzIGVxdWFsIHRvIFswLCAwXVxuICogfSk7XG4gKi9cbmZ1bmN0aW9uIGNvb3JkRWFjaChsYXllciwgY2FsbGJhY2ssIGV4Y2x1ZGVXcmFwQ29vcmQpIHtcbiAgdmFyIGksIGosIGssIGcsIGdlb21ldHJ5LCBzdG9wRywgY29vcmRzLFxuICAgIGdlb21ldHJ5TWF5YmVDb2xsZWN0aW9uLFxuICAgIHdyYXBTaHJpbmsgPSAwLFxuICAgIGlzR2VvbWV0cnlDb2xsZWN0aW9uLFxuICAgIGlzRmVhdHVyZUNvbGxlY3Rpb24gPSBsYXllci50eXBlID09PSAnRmVhdHVyZUNvbGxlY3Rpb24nLFxuICAgIGlzRmVhdHVyZSA9IGxheWVyLnR5cGUgPT09ICdGZWF0dXJlJyxcbiAgICBzdG9wID0gaXNGZWF0dXJlQ29sbGVjdGlvbiA/IGxheWVyLmZlYXR1cmVzLmxlbmd0aCA6IDE7XG5cbiAgLy8gVGhpcyBsb2dpYyBtYXkgbG9vayBhIGxpdHRsZSB3ZWlyZC4gVGhlIHJlYXNvbiB3aHkgaXQgaXMgdGhhdCB3YXlcbiAgLy8gaXMgYmVjYXVzZSBpdCdzIHRyeWluZyB0byBiZSBmYXN0LiBHZW9KU09OIHN1cHBvcnRzIG11bHRpcGxlIGtpbmRzXG4gIC8vIG9mIG9iamVjdHMgYXQgaXRzIHJvb3Q6IEZlYXR1cmVDb2xsZWN0aW9uLCBGZWF0dXJlcywgR2VvbWV0cmllcy5cbiAgLy8gVGhpcyBmdW5jdGlvbiBoYXMgdGhlIHJlc3BvbnNpYmlsaXR5IG9mIGhhbmRsaW5nIGFsbCBvZiB0aGVtLCBhbmQgdGhhdFxuICAvLyBtZWFucyB0aGF0IHNvbWUgb2YgdGhlIGBmb3JgIGxvb3BzIHlvdSBzZWUgYmVsb3cgYWN0dWFsbHkganVzdCBkb24ndCBhcHBseVxuICAvLyB0byBjZXJ0YWluIGlucHV0cy4gRm9yIGluc3RhbmNlLCBpZiB5b3UgZ2l2ZSB0aGlzIGp1c3QgYVxuICAvLyBQb2ludCBnZW9tZXRyeSwgdGhlbiBib3RoIGxvb3BzIGFyZSBzaG9ydC1jaXJjdWl0ZWQgYW5kIGFsbCB3ZSBkb1xuICAvLyBpcyBncmFkdWFsbHkgcmVuYW1lIHRoZSBpbnB1dCB1bnRpbCBpdCdzIGNhbGxlZCAnZ2VvbWV0cnknLlxuICAvL1xuICAvLyBUaGlzIGFsc28gYWltcyB0byBhbGxvY2F0ZSBhcyBmZXcgcmVzb3VyY2VzIGFzIHBvc3NpYmxlOiBqdXN0IGFcbiAgLy8gZmV3IG51bWJlcnMgYW5kIGJvb2xlYW5zLCByYXRoZXIgdGhhbiBhbnkgdGVtcG9yYXJ5IGFycmF5cyBhcyB3b3VsZFxuICAvLyBiZSByZXF1aXJlZCB3aXRoIHRoZSBub3JtYWxpemF0aW9uIGFwcHJvYWNoLlxuICBmb3IgKGkgPSAwOyBpIDwgc3RvcDsgaSsrKSB7XG5cbiAgICBnZW9tZXRyeU1heWJlQ29sbGVjdGlvbiA9IChpc0ZlYXR1cmVDb2xsZWN0aW9uID8gbGF5ZXIuZmVhdHVyZXNbaV0uZ2VvbWV0cnkgOlxuICAgICAgICAoaXNGZWF0dXJlID8gbGF5ZXIuZ2VvbWV0cnkgOiBsYXllcikpO1xuICAgIGlzR2VvbWV0cnlDb2xsZWN0aW9uID0gZ2VvbWV0cnlNYXliZUNvbGxlY3Rpb24udHlwZSA9PT0gJ0dlb21ldHJ5Q29sbGVjdGlvbic7XG4gICAgc3RvcEcgPSBpc0dlb21ldHJ5Q29sbGVjdGlvbiA/IGdlb21ldHJ5TWF5YmVDb2xsZWN0aW9uLmdlb21ldHJpZXMubGVuZ3RoIDogMTtcblxuICAgIGZvciAoZyA9IDA7IGcgPCBzdG9wRzsgZysrKSB7XG5cbiAgICAgIGdlb21ldHJ5ID0gaXNHZW9tZXRyeUNvbGxlY3Rpb24gP1xuICAgICAgICAgIGdlb21ldHJ5TWF5YmVDb2xsZWN0aW9uLmdlb21ldHJpZXNbZ10gOiBnZW9tZXRyeU1heWJlQ29sbGVjdGlvbjtcbiAgICAgIGNvb3JkcyA9IGdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuXG4gICAgICB3cmFwU2hyaW5rID0gKGV4Y2x1ZGVXcmFwQ29vcmQgJiZcbiAgICAgICAgKGdlb21ldHJ5LnR5cGUgPT09ICdQb2x5Z29uJyB8fCBnZW9tZXRyeS50eXBlID09PSAnTXVsdGlQb2x5Z29uJykpID9cbiAgICAgICAgMSA6IDA7XG5cbiAgICAgIGlmIChnZW9tZXRyeS50eXBlID09PSAnUG9pbnQnKSB7XG4gICAgICAgIGNhbGxiYWNrKGNvb3Jkcyk7XG4gICAgICB9IGVsc2UgaWYgKGdlb21ldHJ5LnR5cGUgPT09ICdMaW5lU3RyaW5nJyB8fCBnZW9tZXRyeS50eXBlID09PSAnTXVsdGlQb2ludCcpIHtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGNvb3Jkcy5sZW5ndGg7IGorKykgY2FsbGJhY2soY29vcmRzW2pdKTtcbiAgICAgIH0gZWxzZSBpZiAoZ2VvbWV0cnkudHlwZSA9PT0gJ1BvbHlnb24nIHx8IGdlb21ldHJ5LnR5cGUgPT09ICdNdWx0aUxpbmVTdHJpbmcnKSB7XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBjb29yZHMubGVuZ3RoOyBqKyspXG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IGNvb3Jkc1tqXS5sZW5ndGggLSB3cmFwU2hyaW5rOyBrKyspXG4gICAgICAgICAgICBjYWxsYmFjayhjb29yZHNbal1ba10pO1xuICAgICAgfSBlbHNlIGlmIChnZW9tZXRyeS50eXBlID09PSAnTXVsdGlQb2x5Z29uJykge1xuICAgICAgICBmb3IgKGogPSAwOyBqIDwgY29vcmRzLmxlbmd0aDsgaisrKVxuICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBjb29yZHNbal0ubGVuZ3RoOyBrKyspXG4gICAgICAgICAgICBmb3IgKGwgPSAwOyBsIDwgY29vcmRzW2pdW2tdLmxlbmd0aCAtIHdyYXBTaHJpbms7IGwrKylcbiAgICAgICAgICAgICAgY2FsbGJhY2soY29vcmRzW2pdW2tdW2xdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBHZW9tZXRyeSBUeXBlJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5tb2R1bGUuZXhwb3J0cy5jb29yZEVhY2ggPSBjb29yZEVhY2g7XG5cbi8qKlxuICogTGF6aWx5IHJlZHVjZSBjb29yZGluYXRlcyBpbiBhbnkgR2VvSlNPTiBvYmplY3QgaW50byBhIHNpbmdsZSB2YWx1ZSxcbiAqIHNpbWlsYXIgdG8gaG93IEFycmF5LnJlZHVjZSB3b3Jrcy4gSG93ZXZlciwgaW4gdGhpcyBjYXNlIHdlIGxhemlseSBydW5cbiAqIHRoZSByZWR1Y3Rpb24sIHNvIGFuIGFycmF5IG9mIGFsbCBjb29yZGluYXRlcyBpcyB1bm5lY2Vzc2FyeS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gbGF5ZXIgYW55IEdlb0pTT04gb2JqZWN0XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBhIG1ldGhvZCB0aGF0IHRha2VzIChtZW1vLCB2YWx1ZSkgYW5kIHJldHVybnNcbiAqIGEgbmV3IG1lbW9cbiAqIEBwYXJhbSB7Ym9vbGVhbj19IGV4Y2x1ZGVXcmFwQ29vcmQgd2hldGhlciBvciBub3QgdG8gaW5jbHVkZVxuICogdGhlIGZpbmFsIGNvb3JkaW5hdGUgb2YgTGluZWFyUmluZ3MgdGhhdCB3cmFwcyB0aGUgcmluZyBpbiBpdHMgaXRlcmF0aW9uLlxuICogQHBhcmFtIHsqfSBtZW1vIHRoZSBzdGFydGluZyB2YWx1ZSBvZiBtZW1vOiBjYW4gYmUgYW55IHR5cGUuXG4gKi9cbmZ1bmN0aW9uIGNvb3JkUmVkdWNlKGxheWVyLCBjYWxsYmFjaywgbWVtbywgZXhjbHVkZVdyYXBDb29yZCkge1xuICBjb29yZEVhY2gobGF5ZXIsIGZ1bmN0aW9uKGNvb3JkKSB7XG4gICAgbWVtbyA9IGNhbGxiYWNrKG1lbW8sIGNvb3JkKTtcbiAgfSwgZXhjbHVkZVdyYXBDb29yZCk7XG4gIHJldHVybiBtZW1vO1xufVxubW9kdWxlLmV4cG9ydHMuY29vcmRSZWR1Y2UgPSBjb29yZFJlZHVjZTtcblxuLyoqXG4gKiBMYXppbHkgaXRlcmF0ZSBvdmVyIHByb3BlcnR5IG9iamVjdHMgaW4gYW55IEdlb0pTT04gb2JqZWN0LCBzaW1pbGFyIHRvXG4gKiBBcnJheS5mb3JFYWNoLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBsYXllciBhbnkgR2VvSlNPTiBvYmplY3RcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIGEgbWV0aG9kIHRoYXQgdGFrZXMgKHZhbHVlKVxuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludCA9IHsgdHlwZTogJ0ZlYXR1cmUnLCBnZW9tZXRyeTogbnVsbCwgcHJvcGVydGllczogeyBmb286IDEgfSB9O1xuICogcHJvcEVhY2gocG9pbnQsIGZ1bmN0aW9uKHByb3BzKSB7XG4gKiAgIC8vIHByb3BzIGlzIGVxdWFsIHRvIHsgZm9vOiAxfVxuICogfSk7XG4gKi9cbmZ1bmN0aW9uIHByb3BFYWNoKGxheWVyLCBjYWxsYmFjaykge1xuICB2YXIgaTtcbiAgc3dpdGNoIChsYXllci50eXBlKSB7XG4gICAgICBjYXNlICdGZWF0dXJlQ29sbGVjdGlvbic6XG4gICAgICAgIGZlYXR1cmVzID0gbGF5ZXIuZmVhdHVyZXM7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsYXllci5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY2FsbGJhY2sobGF5ZXIuZmVhdHVyZXNbaV0ucHJvcGVydGllcyk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdGZWF0dXJlJzpcbiAgICAgICAgY2FsbGJhY2sobGF5ZXIucHJvcGVydGllcyk7XG4gICAgICAgIGJyZWFrO1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cy5wcm9wRWFjaCA9IHByb3BFYWNoO1xuXG4vKipcbiAqIExhemlseSByZWR1Y2UgcHJvcGVydGllcyBpbiBhbnkgR2VvSlNPTiBvYmplY3QgaW50byBhIHNpbmdsZSB2YWx1ZSxcbiAqIHNpbWlsYXIgdG8gaG93IEFycmF5LnJlZHVjZSB3b3Jrcy4gSG93ZXZlciwgaW4gdGhpcyBjYXNlIHdlIGxhemlseSBydW5cbiAqIHRoZSByZWR1Y3Rpb24sIHNvIGFuIGFycmF5IG9mIGFsbCBwcm9wZXJ0aWVzIGlzIHVubmVjZXNzYXJ5LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBsYXllciBhbnkgR2VvSlNPTiBvYmplY3RcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIGEgbWV0aG9kIHRoYXQgdGFrZXMgKG1lbW8sIGNvb3JkKSBhbmQgcmV0dXJuc1xuICogYSBuZXcgbWVtb1xuICogQHBhcmFtIHsqfSBtZW1vIHRoZSBzdGFydGluZyB2YWx1ZSBvZiBtZW1vOiBjYW4gYmUgYW55IHR5cGUuXG4gKi9cbmZ1bmN0aW9uIHByb3BSZWR1Y2UobGF5ZXIsIGNhbGxiYWNrLCBtZW1vKSB7XG4gIHByb3BFYWNoKGxheWVyLCBmdW5jdGlvbihwcm9wKSB7XG4gICAgbWVtbyA9IGNhbGxiYWNrKG1lbW8sIHByb3ApO1xuICB9KTtcbiAgcmV0dXJuIG1lbW87XG59XG5tb2R1bGUuZXhwb3J0cy5wcm9wUmVkdWNlID0gcHJvcFJlZHVjZTtcbiIsIi8qKlxuICogQ29tYmluZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0sIHtAbGluayBMaW5lU3RyaW5nfSwgb3Ige0BsaW5rIFBvbHlnb259IGZlYXR1cmVzIGludG8ge0BsaW5rIE11bHRpUG9pbnR9LCB7QGxpbmsgTXVsdGlMaW5lU3RyaW5nfSwgb3Ige0BsaW5rIE11bHRpUG9seWdvbn0gZmVhdHVyZXMuXG4gKlxuICogQG1vZHVsZSB0dXJmL2NvbWJpbmVcbiAqIEBjYXRlZ29yeSBtaXNjXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBmYyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBjb3JyZXNwb25kaW5nIHR5cGUgdG8gaW5wdXRcbiAqIEBleGFtcGxlXG4gKiB2YXIgZmMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxOS4wMjY0MzIsIDQ3LjQ5MTM0XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxOS4wNzQ0OTcsIDQ3LjUwOTU0OF1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGNvbWJpbmVkID0gdHVyZi5jb21iaW5lKGZjKTtcbiAqXG4gKiAvLz1jb21iaW5lZFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmMpIHtcbiAgdmFyIHR5cGUgPSBmYy5mZWF0dXJlc1swXS5nZW9tZXRyeS50eXBlO1xuICB2YXIgZ2VvbWV0cmllcyA9IGZjLmZlYXR1cmVzLm1hcChmdW5jdGlvbihmKSB7XG4gICAgcmV0dXJuIGYuZ2VvbWV0cnk7XG4gIH0pO1xuXG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ1BvaW50JzpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgICAgcHJvcGVydGllczoge30sXG4gICAgICAgIGdlb21ldHJ5OiB7XG4gICAgICAgICAgdHlwZTogJ011bHRpUG9pbnQnLFxuICAgICAgICAgIGNvb3JkaW5hdGVzOiBwbHVja0Nvb2RzKGdlb21ldHJpZXMpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgY2FzZSAnTGluZVN0cmluZyc6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICBnZW9tZXRyeToge1xuICAgICAgICAgIHR5cGU6ICdNdWx0aUxpbmVTdHJpbmcnLFxuICAgICAgICAgIGNvb3JkaW5hdGVzOiBwbHVja0Nvb2RzKGdlb21ldHJpZXMpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgY2FzZSAnUG9seWdvbic6XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgICAgIHByb3BlcnRpZXM6IHt9LFxuICAgICAgICBnZW9tZXRyeToge1xuICAgICAgICAgIHR5cGU6ICdNdWx0aVBvbHlnb24nLFxuICAgICAgICAgIGNvb3JkaW5hdGVzOiBwbHVja0Nvb2RzKGdlb21ldHJpZXMpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYztcbiAgfVxufTtcblxuZnVuY3Rpb24gcGx1Y2tDb29kcyhtdWx0aSl7XG4gIHJldHVybiBtdWx0aS5tYXAoZnVuY3Rpb24oZ2VvbSl7XG4gICAgcmV0dXJuIGdlb20uY29vcmRpbmF0ZXM7XG4gIH0pO1xufVxuIiwiLy8gMS4gcnVuIHRpbiBvbiBwb2ludHNcbi8vIDIuIGNhbGN1bGF0ZSBsZW50aCBvZiBhbGwgZWRnZXMgYW5kIGFyZWEgb2YgYWxsIHRyaWFuZ2xlc1xuLy8gMy4gcmVtb3ZlIHRyaWFuZ2xlcyB0aGF0IGZhaWwgdGhlIG1heCBsZW5ndGggdGVzdFxuLy8gNC4gYnVmZmVyIHRoZSByZXN1bHRzIHNsaWdodGx5XG4vLyA1LiBtZXJnZSB0aGUgcmVzdWx0c1xudmFyIHQgPSB7fTtcbnQudGluID0gcmVxdWlyZSgndHVyZi10aW4nKTtcbnQubWVyZ2UgPSByZXF1aXJlKCd0dXJmLW1lcmdlJyk7XG50LmRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xudC5wb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyBhbmRcbiAqIHJldHVybnMgYSBjb25jYXZlIGh1bGwuXG4gKlxuICogSW50ZXJuYWxseSwgdGhpcyBpbXBsZW1lbnRzXG4gKiBhIFtNb25vdG9uZSBjaGFpbiBhbGdvcml0aG1dKGh0dHA6Ly9lbi53aWtpYm9va3Mub3JnL3dpa2kvQWxnb3JpdGhtX0ltcGxlbWVudGF0aW9uL0dlb21ldHJ5L0NvbnZleF9odWxsL01vbm90b25lX2NoYWluI0phdmFTY3JpcHQpLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9jb25jYXZlXG4gKiBAY2F0ZWdvcnkgdHJhbnNmb3JtYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXhFZGdlIHRoZSBzaXplIG9mIGFuIGVkZ2UgbmVjZXNzYXJ5IGZvciBwYXJ0IG9mIHRoZVxuICogaHVsbCB0byBiZWNvbWUgY29uY2F2ZSAoaW4gbWlsZXMpXG4gKiBAcGFyYW0ge1N0cmluZ30gdW5pdHMgdXNlZCBmb3IgbWF4RWRnZSBkaXN0YW5jZSAobWlsZXMgb3Iga2lsb21ldGVycylcbiAqIEByZXR1cm5zIHtGZWF0dXJlfSBhIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgbWF4RWRnZSBwYXJhbWV0ZXIgaXMgbWlzc2luZ1xuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNjMuNjAxMjI2LCA0NC42NDI2NDNdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy02My41OTE0NDIsIDQ0LjY1MTQzNl1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTYzLjU4MDc5OSwgNDQuNjQ4NzQ5XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNjMuNTczNTg5LCA0NC42NDE3ODhdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy02My41ODc2NjUsIDQ0LjY0NTMzXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNjMuNTk1MjE4LCA0NC42NDc2NV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIGh1bGwgPSB0dXJmLmNvbmNhdmUocG9pbnRzLCAxLCAnbWlsZXMnKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KGh1bGwpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xuXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnRzLCBtYXhFZGdlLCB1bml0cykge1xuICBpZiAodHlwZW9mIG1heEVkZ2UgIT09ICdudW1iZXInKSB0aHJvdyBuZXcgRXJyb3IoJ21heEVkZ2UgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJyk7XG4gIGlmICh0eXBlb2YgdW5pdHMgIT09ICdzdHJpbmcnKSB0aHJvdyBuZXcgRXJyb3IoJ3VuaXRzIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpO1xuXG4gIHZhciB0aW5Qb2x5cyA9IHQudGluKHBvaW50cyk7XG4gIHZhciBmaWx0ZXJlZFBvbHlzID0gdGluUG9seXMuZmVhdHVyZXMuZmlsdGVyKGZpbHRlclRyaWFuZ2xlcyk7XG4gIHRpblBvbHlzLmZlYXR1cmVzID0gZmlsdGVyZWRQb2x5cztcblxuICBmdW5jdGlvbiBmaWx0ZXJUcmlhbmdsZXModHJpYW5nbGUpIHtcbiAgICB2YXIgcHQxID0gdC5wb2ludCh0cmlhbmdsZS5nZW9tZXRyeS5jb29yZGluYXRlc1swXVswXSk7XG4gICAgdmFyIHB0MiA9IHQucG9pbnQodHJpYW5nbGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF1bMV0pO1xuICAgIHZhciBwdDMgPSB0LnBvaW50KHRyaWFuZ2xlLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdWzJdKTtcbiAgICB2YXIgZGlzdDEgPSB0LmRpc3RhbmNlKHB0MSwgcHQyLCB1bml0cyk7XG4gICAgdmFyIGRpc3QyID0gdC5kaXN0YW5jZShwdDIsIHB0MywgdW5pdHMpO1xuICAgIHZhciBkaXN0MyA9IHQuZGlzdGFuY2UocHQxLCBwdDMsIHVuaXRzKTtcbiAgICByZXR1cm4gKGRpc3QxIDw9IG1heEVkZ2UgJiYgZGlzdDIgPD0gbWF4RWRnZSAmJiBkaXN0MyA8PSBtYXhFZGdlKTtcbiAgfVxuXG4gIHJldHVybiB0Lm1lcmdlKHRpblBvbHlzKTtcbn07XG4iLCJ2YXIgZWFjaCA9IHJlcXVpcmUoJ3R1cmYtbWV0YScpLmNvb3JkRWFjaCxcbiAgICBjb252ZXhIdWxsID0gcmVxdWlyZSgnY29udmV4LWh1bGwnKSxcbiAgICBwb2x5Z29uID0gcmVxdWlyZSgndHVyZi1wb2x5Z29uJyk7XG5cbi8qKlxuICogVGFrZXMgYW55IHtAbGluayBHZW9KU09OfSBvYmplY3QgYW5kIHJldHVybnMgYVxuICogW2NvbnZleCBodWxsXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvbnZleF9odWxsKSBwb2x5Z29uLlxuICpcbiAqIEludGVybmFsbHkgdGhpcyB1c2VzXG4gKiB0aGUgW2NvbnZleC1odWxsXShodHRwczovL2dpdGh1Yi5jb20vbWlrb2xhbHlzZW5rby9jb252ZXgtaHVsbCkgbW9kdWxlIHRoYXRcbiAqIGltcGxlbWVudHMgYSBbbW9ub3RvbmUgY2hhaW4gaHVsbF0oaHR0cDovL2VuLndpa2lib29rcy5vcmcvd2lraS9BbGdvcml0aG1fSW1wbGVtZW50YXRpb24vR2VvbWV0cnkvQ29udmV4X2h1bGwvTW9ub3RvbmVfY2hhaW4pLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9jb252ZXhcbiAqIEBjYXRlZ29yeSB0cmFuc2Zvcm1hdGlvblxuICogQHBhcmFtIHtHZW9KU09OfSBpbnB1dCBhbnkgR2VvSlNPTiBvYmplY3RcbiAqIEByZXR1cm5zIHtGZWF0dXJlfSBhIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjE5NTMxMiwgNDMuNzU1MjI1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMC40MDQwNTIsIDQzLjg0MjQ1MTFdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwLjU3OTgzMywgNDMuNjU5OTI0XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMC4zNjAxMDcsIDQzLjUxNjY4OF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAuMTQwMzgsIDQzLjU4ODM0OF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAuMTk1MzEyLCA0My43NTUyMjVdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBodWxsID0gdHVyZi5jb252ZXgocG9pbnRzKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KGh1bGwpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmYykge1xuICB2YXIgcG9pbnRzID0gW107XG4gIGVhY2goZmMsIGZ1bmN0aW9uKGNvb3JkKSB7IHBvaW50cy5wdXNoKGNvb3JkKTsgfSk7XG4gIHZhciBodWxsID0gY29udmV4SHVsbChwb2ludHMpO1xuICB2YXIgcmluZyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGh1bGwubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJpbmcucHVzaChwb2ludHNbaHVsbFtpXVswXV0pO1xuICB9XG4gIHJpbmcucHVzaChwb2ludHNbaHVsbFtodWxsLmxlbmd0aCAtIDFdWzFdXSk7XG4gIHJldHVybiBwb2x5Z29uKFtyaW5nXSk7XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCJcblxudmFyIGNvbnZleEh1bGwxZCA9IHJlcXVpcmUoJy4vbGliL2NoMWQnKVxudmFyIGNvbnZleEh1bGwyZCA9IHJlcXVpcmUoJy4vbGliL2NoMmQnKVxudmFyIGNvbnZleEh1bGxuZCA9IHJlcXVpcmUoJy4vbGliL2NobmQnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNvbnZleEh1bGxcblxuZnVuY3Rpb24gY29udmV4SHVsbChwb2ludHMpIHtcbiAgdmFyIG4gPSBwb2ludHMubGVuZ3RoXG4gIGlmKG4gPT09IDApIHtcbiAgICByZXR1cm4gW11cbiAgfSBlbHNlIGlmKG4gPT09IDEpIHtcbiAgICByZXR1cm4gW1swXV1cbiAgfVxuICB2YXIgZCA9IHBvaW50c1swXS5sZW5ndGhcbiAgaWYoZCA9PT0gMCkge1xuICAgIHJldHVybiBbXVxuICB9IGVsc2UgaWYoZCA9PT0gMSkge1xuICAgIHJldHVybiBjb252ZXhIdWxsMWQocG9pbnRzKVxuICB9IGVsc2UgaWYoZCA9PT0gMikge1xuICAgIHJldHVybiBjb252ZXhIdWxsMmQocG9pbnRzKVxuICB9XG4gIHJldHVybiBjb252ZXhIdWxsbmQocG9pbnRzLCBkKVxufSIsIlwidXNlIHN0cmljdFwiXG5cbm1vZHVsZS5leHBvcnRzID0gY29udmV4SHVsbDFkXG5cbmZ1bmN0aW9uIGNvbnZleEh1bGwxZChwb2ludHMpIHtcbiAgdmFyIGxvID0gMFxuICB2YXIgaGkgPSAwXG4gIGZvcih2YXIgaT0xOyBpPHBvaW50cy5sZW5ndGg7ICsraSkge1xuICAgIGlmKHBvaW50c1tpXVswXSA8IHBvaW50c1tsb11bMF0pIHtcbiAgICAgIGxvID0gaVxuICAgIH1cbiAgICBpZihwb2ludHNbaV1bMF0gPiBwb2ludHNbaGldWzBdKSB7XG4gICAgICBoaSA9IGlcbiAgICB9XG4gIH1cbiAgaWYobG8gPCBoaSkge1xuICAgIHJldHVybiBbW2xvXSwgW2hpXV1cbiAgfSBlbHNlIGlmKGxvID4gaGkpIHtcbiAgICByZXR1cm4gW1toaV0sIFtsb11dXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFtbbG9dXVxuICB9XG59IiwiJ3VzZSBzdHJpY3QnXG5cbm1vZHVsZS5leHBvcnRzID0gY29udmV4SHVsbDJEXG5cbnZhciBtb25vdG9uZUh1bGwgPSByZXF1aXJlKCdtb25vdG9uZS1jb252ZXgtaHVsbC0yZCcpXG5cbmZ1bmN0aW9uIGNvbnZleEh1bGwyRChwb2ludHMpIHtcbiAgdmFyIGh1bGwgPSBtb25vdG9uZUh1bGwocG9pbnRzKVxuICB2YXIgaCA9IGh1bGwubGVuZ3RoXG4gIGlmKGggPD0gMikge1xuICAgIHJldHVybiBbXVxuICB9XG4gIHZhciBlZGdlcyA9IG5ldyBBcnJheShoKVxuICB2YXIgYSA9IGh1bGxbaC0xXVxuICBmb3IodmFyIGk9MDsgaTxoOyArK2kpIHtcbiAgICB2YXIgYiA9IGh1bGxbaV1cbiAgICBlZGdlc1tpXSA9IFthLGJdXG4gICAgYSA9IGJcbiAgfVxuICByZXR1cm4gZWRnZXNcbn1cbiIsIid1c2Ugc3RyaWN0J1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNvbnZleEh1bGxuRFxuXG52YXIgaWNoID0gcmVxdWlyZSgnaW5jcmVtZW50YWwtY29udmV4LWh1bGwnKVxudmFyIGFmZiA9IHJlcXVpcmUoJ2FmZmluZS1odWxsJylcblxuZnVuY3Rpb24gcGVybXV0ZShwb2ludHMsIGZyb250KSB7XG4gIHZhciBuID0gcG9pbnRzLmxlbmd0aFxuICB2YXIgbnBvaW50cyA9IG5ldyBBcnJheShuKVxuICBmb3IodmFyIGk9MDsgaTxmcm9udC5sZW5ndGg7ICsraSkge1xuICAgIG5wb2ludHNbaV0gPSBwb2ludHNbZnJvbnRbaV1dXG4gIH1cbiAgdmFyIHB0ciA9IGZyb250Lmxlbmd0aFxuICBmb3IodmFyIGk9MDsgaTxuOyArK2kpIHtcbiAgICBpZihmcm9udC5pbmRleE9mKGkpIDwgMCkge1xuICAgICAgbnBvaW50c1twdHIrK10gPSBwb2ludHNbaV1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5wb2ludHNcbn1cblxuZnVuY3Rpb24gaW52UGVybXV0ZShjZWxscywgZnJvbnQpIHtcbiAgdmFyIG5jID0gY2VsbHMubGVuZ3RoXG4gIHZhciBuZiA9IGZyb250Lmxlbmd0aFxuICBmb3IodmFyIGk9MDsgaTxuYzsgKytpKSB7XG4gICAgdmFyIGMgPSBjZWxsc1tpXVxuICAgIGZvcih2YXIgaj0wOyBqPGMubGVuZ3RoOyArK2opIHtcbiAgICAgIHZhciB4ID0gY1tqXVxuICAgICAgaWYoeCA8IG5mKSB7XG4gICAgICAgIGNbal0gPSBmcm9udFt4XVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgeCA9IHggLSBuZlxuICAgICAgICBmb3IodmFyIGs9MDsgazxuZjsgKytrKSB7XG4gICAgICAgICAgaWYoeCA+PSBmcm9udFtrXSkge1xuICAgICAgICAgICAgeCArPSAxXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNbal0gPSB4XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBjZWxsc1xufVxuXG5mdW5jdGlvbiBjb252ZXhIdWxsbkQocG9pbnRzLCBkKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGljaChwb2ludHMsIHRydWUpXG4gIH0gY2F0Y2goZSkge1xuICAgIC8vSWYgcG9pbnQgc2V0IGlzIGRlZ2VuZXJhdGUsIHRyeSB0byBmaW5kIGEgYmFzaXMgYW5kIHJlcnVuIGl0XG4gICAgdmFyIGFoID0gYWZmKHBvaW50cylcbiAgICBpZihhaC5sZW5ndGggPD0gZCkge1xuICAgICAgLy9ObyBiYXNpcywgbm8gdHJ5XG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gICAgdmFyIG5wb2ludHMgPSBwZXJtdXRlKHBvaW50cywgYWgpXG4gICAgdmFyIG5odWxsICAgPSBpY2gobnBvaW50cywgdHJ1ZSlcbiAgICByZXR1cm4gaW52UGVybXV0ZShuaHVsbCwgYWgpXG4gIH1cbn0iLCIndXNlIHN0cmljdCdcblxubW9kdWxlLmV4cG9ydHMgPSBhZmZpbmVIdWxsXG5cbnZhciBvcmllbnQgPSByZXF1aXJlKCdyb2J1c3Qtb3JpZW50YXRpb24nKVxuXG5mdW5jdGlvbiBsaW5lYXJseUluZGVwZW5kZW50KHBvaW50cywgZCkge1xuICB2YXIgbmh1bGwgPSBuZXcgQXJyYXkoZCsxKVxuICBmb3IodmFyIGk9MDsgaTxwb2ludHMubGVuZ3RoOyArK2kpIHtcbiAgICBuaHVsbFtpXSA9IHBvaW50c1tpXVxuICB9XG4gIGZvcih2YXIgaT0wOyBpPD1wb2ludHMubGVuZ3RoOyArK2kpIHtcbiAgICBmb3IodmFyIGo9cG9pbnRzLmxlbmd0aDsgajw9ZDsgKytqKSB7XG4gICAgICB2YXIgeCA9IG5ldyBBcnJheShkKVxuICAgICAgZm9yKHZhciBrPTA7IGs8ZDsgKytrKSB7XG4gICAgICAgIHhba10gPSBNYXRoLnBvdyhqKzEtaSwgaylcbiAgICAgIH1cbiAgICAgIG5odWxsW2pdID0geFxuICAgIH1cbiAgICB2YXIgbyA9IG9yaWVudC5hcHBseSh2b2lkIDAsIG5odWxsKVxuICAgIGlmKG8pIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZVxufVxuXG5mdW5jdGlvbiBhZmZpbmVIdWxsKHBvaW50cykge1xuICB2YXIgbiA9IHBvaW50cy5sZW5ndGhcbiAgaWYobiA9PT0gMCkge1xuICAgIHJldHVybiBbXVxuICB9XG4gIGlmKG4gPT09IDEpIHtcbiAgICByZXR1cm4gWzBdXG4gIH1cbiAgdmFyIGQgPSBwb2ludHNbMF0ubGVuZ3RoXG4gIHZhciBmcmFtZSA9IFsgcG9pbnRzWzBdIF1cbiAgdmFyIGluZGV4ID0gWyAwIF1cbiAgZm9yKHZhciBpPTE7IGk8bjsgKytpKSB7XG4gICAgZnJhbWUucHVzaChwb2ludHNbaV0pXG4gICAgaWYoIWxpbmVhcmx5SW5kZXBlbmRlbnQoZnJhbWUsIGQpKSB7XG4gICAgICBmcmFtZS5wb3AoKVxuICAgICAgY29udGludWVcbiAgICB9XG4gICAgaW5kZXgucHVzaChpKVxuICAgIGlmKGluZGV4Lmxlbmd0aCA9PT0gZCsxKSB7XG4gICAgICByZXR1cm4gaW5kZXhcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGluZGV4XG59IiwiXCJ1c2Ugc3RyaWN0XCJcblxubW9kdWxlLmV4cG9ydHMgPSBmYXN0VHdvU3VtXG5cbmZ1bmN0aW9uIGZhc3RUd29TdW0oYSwgYiwgcmVzdWx0KSB7XG5cdHZhciB4ID0gYSArIGJcblx0dmFyIGJ2ID0geCAtIGFcblx0dmFyIGF2ID0geCAtIGJ2XG5cdHZhciBiciA9IGIgLSBidlxuXHR2YXIgYXIgPSBhIC0gYXZcblx0aWYocmVzdWx0KSB7XG5cdFx0cmVzdWx0WzBdID0gYXIgKyBiclxuXHRcdHJlc3VsdFsxXSA9IHhcblx0XHRyZXR1cm4gcmVzdWx0XG5cdH1cblx0cmV0dXJuIFthciticiwgeF1cbn0iLCJcInVzZSBzdHJpY3RcIlxuXG52YXIgdHdvUHJvZHVjdCA9IHJlcXVpcmUoXCJ0d28tcHJvZHVjdFwiKVxudmFyIHR3b1N1bSA9IHJlcXVpcmUoXCJ0d28tc3VtXCIpXG5cbm1vZHVsZS5leHBvcnRzID0gc2NhbGVMaW5lYXJFeHBhbnNpb25cblxuZnVuY3Rpb24gc2NhbGVMaW5lYXJFeHBhbnNpb24oZSwgc2NhbGUpIHtcbiAgdmFyIG4gPSBlLmxlbmd0aFxuICBpZihuID09PSAxKSB7XG4gICAgdmFyIHRzID0gdHdvUHJvZHVjdChlWzBdLCBzY2FsZSlcbiAgICBpZih0c1swXSkge1xuICAgICAgcmV0dXJuIHRzXG4gICAgfVxuICAgIHJldHVybiBbIHRzWzFdIF1cbiAgfVxuICB2YXIgZyA9IG5ldyBBcnJheSgyICogbilcbiAgdmFyIHEgPSBbMC4xLCAwLjFdXG4gIHZhciB0ID0gWzAuMSwgMC4xXVxuICB2YXIgY291bnQgPSAwXG4gIHR3b1Byb2R1Y3QoZVswXSwgc2NhbGUsIHEpXG4gIGlmKHFbMF0pIHtcbiAgICBnW2NvdW50KytdID0gcVswXVxuICB9XG4gIGZvcih2YXIgaT0xOyBpPG47ICsraSkge1xuICAgIHR3b1Byb2R1Y3QoZVtpXSwgc2NhbGUsIHQpXG4gICAgdmFyIHBxID0gcVsxXVxuICAgIHR3b1N1bShwcSwgdFswXSwgcSlcbiAgICBpZihxWzBdKSB7XG4gICAgICBnW2NvdW50KytdID0gcVswXVxuICAgIH1cbiAgICB2YXIgYSA9IHRbMV1cbiAgICB2YXIgYiA9IHFbMV1cbiAgICB2YXIgeCA9IGEgKyBiXG4gICAgdmFyIGJ2ID0geCAtIGFcbiAgICB2YXIgeSA9IGIgLSBidlxuICAgIHFbMV0gPSB4XG4gICAgaWYoeSkge1xuICAgICAgZ1tjb3VudCsrXSA9IHlcbiAgICB9XG4gIH1cbiAgaWYocVsxXSkge1xuICAgIGdbY291bnQrK10gPSBxWzFdXG4gIH1cbiAgaWYoY291bnQgPT09IDApIHtcbiAgICBnW2NvdW50KytdID0gMC4wXG4gIH1cbiAgZy5sZW5ndGggPSBjb3VudFxuICByZXR1cm4gZ1xufSIsIlwidXNlIHN0cmljdFwiXG5cbm1vZHVsZS5leHBvcnRzID0gcm9idXN0U3VidHJhY3RcblxuLy9FYXN5IGNhc2U6IEFkZCB0d28gc2NhbGFyc1xuZnVuY3Rpb24gc2NhbGFyU2NhbGFyKGEsIGIpIHtcbiAgdmFyIHggPSBhICsgYlxuICB2YXIgYnYgPSB4IC0gYVxuICB2YXIgYXYgPSB4IC0gYnZcbiAgdmFyIGJyID0gYiAtIGJ2XG4gIHZhciBhciA9IGEgLSBhdlxuICB2YXIgeSA9IGFyICsgYnJcbiAgaWYoeSkge1xuICAgIHJldHVybiBbeSwgeF1cbiAgfVxuICByZXR1cm4gW3hdXG59XG5cbmZ1bmN0aW9uIHJvYnVzdFN1YnRyYWN0KGUsIGYpIHtcbiAgdmFyIG5lID0gZS5sZW5ndGh8MFxuICB2YXIgbmYgPSBmLmxlbmd0aHwwXG4gIGlmKG5lID09PSAxICYmIG5mID09PSAxKSB7XG4gICAgcmV0dXJuIHNjYWxhclNjYWxhcihlWzBdLCAtZlswXSlcbiAgfVxuICB2YXIgbiA9IG5lICsgbmZcbiAgdmFyIGcgPSBuZXcgQXJyYXkobilcbiAgdmFyIGNvdW50ID0gMFxuICB2YXIgZXB0ciA9IDBcbiAgdmFyIGZwdHIgPSAwXG4gIHZhciBhYnMgPSBNYXRoLmFic1xuICB2YXIgZWkgPSBlW2VwdHJdXG4gIHZhciBlYSA9IGFicyhlaSlcbiAgdmFyIGZpID0gLWZbZnB0cl1cbiAgdmFyIGZhID0gYWJzKGZpKVxuICB2YXIgYSwgYlxuICBpZihlYSA8IGZhKSB7XG4gICAgYiA9IGVpXG4gICAgZXB0ciArPSAxXG4gICAgaWYoZXB0ciA8IG5lKSB7XG4gICAgICBlaSA9IGVbZXB0cl1cbiAgICAgIGVhID0gYWJzKGVpKVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBiID0gZmlcbiAgICBmcHRyICs9IDFcbiAgICBpZihmcHRyIDwgbmYpIHtcbiAgICAgIGZpID0gLWZbZnB0cl1cbiAgICAgIGZhID0gYWJzKGZpKVxuICAgIH1cbiAgfVxuICBpZigoZXB0ciA8IG5lICYmIGVhIDwgZmEpIHx8IChmcHRyID49IG5mKSkge1xuICAgIGEgPSBlaVxuICAgIGVwdHIgKz0gMVxuICAgIGlmKGVwdHIgPCBuZSkge1xuICAgICAgZWkgPSBlW2VwdHJdXG4gICAgICBlYSA9IGFicyhlaSlcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgYSA9IGZpXG4gICAgZnB0ciArPSAxXG4gICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICBmaSA9IC1mW2ZwdHJdXG4gICAgICBmYSA9IGFicyhmaSlcbiAgICB9XG4gIH1cbiAgdmFyIHggPSBhICsgYlxuICB2YXIgYnYgPSB4IC0gYVxuICB2YXIgeSA9IGIgLSBidlxuICB2YXIgcTAgPSB5XG4gIHZhciBxMSA9IHhcbiAgdmFyIF94LCBfYnYsIF9hdiwgX2JyLCBfYXJcbiAgd2hpbGUoZXB0ciA8IG5lICYmIGZwdHIgPCBuZikge1xuICAgIGlmKGVhIDwgZmEpIHtcbiAgICAgIGEgPSBlaVxuICAgICAgZXB0ciArPSAxXG4gICAgICBpZihlcHRyIDwgbmUpIHtcbiAgICAgICAgZWkgPSBlW2VwdHJdXG4gICAgICAgIGVhID0gYWJzKGVpKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhID0gZmlcbiAgICAgIGZwdHIgKz0gMVxuICAgICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICAgIGZpID0gLWZbZnB0cl1cbiAgICAgICAgZmEgPSBhYnMoZmkpXG4gICAgICB9XG4gICAgfVxuICAgIGIgPSBxMFxuICAgIHggPSBhICsgYlxuICAgIGJ2ID0geCAtIGFcbiAgICB5ID0gYiAtIGJ2XG4gICAgaWYoeSkge1xuICAgICAgZ1tjb3VudCsrXSA9IHlcbiAgICB9XG4gICAgX3ggPSBxMSArIHhcbiAgICBfYnYgPSBfeCAtIHExXG4gICAgX2F2ID0gX3ggLSBfYnZcbiAgICBfYnIgPSB4IC0gX2J2XG4gICAgX2FyID0gcTEgLSBfYXZcbiAgICBxMCA9IF9hciArIF9iclxuICAgIHExID0gX3hcbiAgfVxuICB3aGlsZShlcHRyIDwgbmUpIHtcbiAgICBhID0gZWlcbiAgICBiID0gcTBcbiAgICB4ID0gYSArIGJcbiAgICBidiA9IHggLSBhXG4gICAgeSA9IGIgLSBidlxuICAgIGlmKHkpIHtcbiAgICAgIGdbY291bnQrK10gPSB5XG4gICAgfVxuICAgIF94ID0gcTEgKyB4XG4gICAgX2J2ID0gX3ggLSBxMVxuICAgIF9hdiA9IF94IC0gX2J2XG4gICAgX2JyID0geCAtIF9idlxuICAgIF9hciA9IHExIC0gX2F2XG4gICAgcTAgPSBfYXIgKyBfYnJcbiAgICBxMSA9IF94XG4gICAgZXB0ciArPSAxXG4gICAgaWYoZXB0ciA8IG5lKSB7XG4gICAgICBlaSA9IGVbZXB0cl1cbiAgICB9XG4gIH1cbiAgd2hpbGUoZnB0ciA8IG5mKSB7XG4gICAgYSA9IGZpXG4gICAgYiA9IHEwXG4gICAgeCA9IGEgKyBiXG4gICAgYnYgPSB4IC0gYVxuICAgIHkgPSBiIC0gYnZcbiAgICBpZih5KSB7XG4gICAgICBnW2NvdW50KytdID0geVxuICAgIH0gXG4gICAgX3ggPSBxMSArIHhcbiAgICBfYnYgPSBfeCAtIHExXG4gICAgX2F2ID0gX3ggLSBfYnZcbiAgICBfYnIgPSB4IC0gX2J2XG4gICAgX2FyID0gcTEgLSBfYXZcbiAgICBxMCA9IF9hciArIF9iclxuICAgIHExID0gX3hcbiAgICBmcHRyICs9IDFcbiAgICBpZihmcHRyIDwgbmYpIHtcbiAgICAgIGZpID0gLWZbZnB0cl1cbiAgICB9XG4gIH1cbiAgaWYocTApIHtcbiAgICBnW2NvdW50KytdID0gcTBcbiAgfVxuICBpZihxMSkge1xuICAgIGdbY291bnQrK10gPSBxMVxuICB9XG4gIGlmKCFjb3VudCkge1xuICAgIGdbY291bnQrK10gPSAwLjAgIFxuICB9XG4gIGcubGVuZ3RoID0gY291bnRcbiAgcmV0dXJuIGdcbn0iLCJcInVzZSBzdHJpY3RcIlxuXG5tb2R1bGUuZXhwb3J0cyA9IGxpbmVhckV4cGFuc2lvblN1bVxuXG4vL0Vhc3kgY2FzZTogQWRkIHR3byBzY2FsYXJzXG5mdW5jdGlvbiBzY2FsYXJTY2FsYXIoYSwgYikge1xuICB2YXIgeCA9IGEgKyBiXG4gIHZhciBidiA9IHggLSBhXG4gIHZhciBhdiA9IHggLSBidlxuICB2YXIgYnIgPSBiIC0gYnZcbiAgdmFyIGFyID0gYSAtIGF2XG4gIHZhciB5ID0gYXIgKyBiclxuICBpZih5KSB7XG4gICAgcmV0dXJuIFt5LCB4XVxuICB9XG4gIHJldHVybiBbeF1cbn1cblxuZnVuY3Rpb24gbGluZWFyRXhwYW5zaW9uU3VtKGUsIGYpIHtcbiAgdmFyIG5lID0gZS5sZW5ndGh8MFxuICB2YXIgbmYgPSBmLmxlbmd0aHwwXG4gIGlmKG5lID09PSAxICYmIG5mID09PSAxKSB7XG4gICAgcmV0dXJuIHNjYWxhclNjYWxhcihlWzBdLCBmWzBdKVxuICB9XG4gIHZhciBuID0gbmUgKyBuZlxuICB2YXIgZyA9IG5ldyBBcnJheShuKVxuICB2YXIgY291bnQgPSAwXG4gIHZhciBlcHRyID0gMFxuICB2YXIgZnB0ciA9IDBcbiAgdmFyIGFicyA9IE1hdGguYWJzXG4gIHZhciBlaSA9IGVbZXB0cl1cbiAgdmFyIGVhID0gYWJzKGVpKVxuICB2YXIgZmkgPSBmW2ZwdHJdXG4gIHZhciBmYSA9IGFicyhmaSlcbiAgdmFyIGEsIGJcbiAgaWYoZWEgPCBmYSkge1xuICAgIGIgPSBlaVxuICAgIGVwdHIgKz0gMVxuICAgIGlmKGVwdHIgPCBuZSkge1xuICAgICAgZWkgPSBlW2VwdHJdXG4gICAgICBlYSA9IGFicyhlaSlcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgYiA9IGZpXG4gICAgZnB0ciArPSAxXG4gICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICBmaSA9IGZbZnB0cl1cbiAgICAgIGZhID0gYWJzKGZpKVxuICAgIH1cbiAgfVxuICBpZigoZXB0ciA8IG5lICYmIGVhIDwgZmEpIHx8IChmcHRyID49IG5mKSkge1xuICAgIGEgPSBlaVxuICAgIGVwdHIgKz0gMVxuICAgIGlmKGVwdHIgPCBuZSkge1xuICAgICAgZWkgPSBlW2VwdHJdXG4gICAgICBlYSA9IGFicyhlaSlcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgYSA9IGZpXG4gICAgZnB0ciArPSAxXG4gICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICBmaSA9IGZbZnB0cl1cbiAgICAgIGZhID0gYWJzKGZpKVxuICAgIH1cbiAgfVxuICB2YXIgeCA9IGEgKyBiXG4gIHZhciBidiA9IHggLSBhXG4gIHZhciB5ID0gYiAtIGJ2XG4gIHZhciBxMCA9IHlcbiAgdmFyIHExID0geFxuICB2YXIgX3gsIF9idiwgX2F2LCBfYnIsIF9hclxuICB3aGlsZShlcHRyIDwgbmUgJiYgZnB0ciA8IG5mKSB7XG4gICAgaWYoZWEgPCBmYSkge1xuICAgICAgYSA9IGVpXG4gICAgICBlcHRyICs9IDFcbiAgICAgIGlmKGVwdHIgPCBuZSkge1xuICAgICAgICBlaSA9IGVbZXB0cl1cbiAgICAgICAgZWEgPSBhYnMoZWkpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGEgPSBmaVxuICAgICAgZnB0ciArPSAxXG4gICAgICBpZihmcHRyIDwgbmYpIHtcbiAgICAgICAgZmkgPSBmW2ZwdHJdXG4gICAgICAgIGZhID0gYWJzKGZpKVxuICAgICAgfVxuICAgIH1cbiAgICBiID0gcTBcbiAgICB4ID0gYSArIGJcbiAgICBidiA9IHggLSBhXG4gICAgeSA9IGIgLSBidlxuICAgIGlmKHkpIHtcbiAgICAgIGdbY291bnQrK10gPSB5XG4gICAgfVxuICAgIF94ID0gcTEgKyB4XG4gICAgX2J2ID0gX3ggLSBxMVxuICAgIF9hdiA9IF94IC0gX2J2XG4gICAgX2JyID0geCAtIF9idlxuICAgIF9hciA9IHExIC0gX2F2XG4gICAgcTAgPSBfYXIgKyBfYnJcbiAgICBxMSA9IF94XG4gIH1cbiAgd2hpbGUoZXB0ciA8IG5lKSB7XG4gICAgYSA9IGVpXG4gICAgYiA9IHEwXG4gICAgeCA9IGEgKyBiXG4gICAgYnYgPSB4IC0gYVxuICAgIHkgPSBiIC0gYnZcbiAgICBpZih5KSB7XG4gICAgICBnW2NvdW50KytdID0geVxuICAgIH1cbiAgICBfeCA9IHExICsgeFxuICAgIF9idiA9IF94IC0gcTFcbiAgICBfYXYgPSBfeCAtIF9idlxuICAgIF9iciA9IHggLSBfYnZcbiAgICBfYXIgPSBxMSAtIF9hdlxuICAgIHEwID0gX2FyICsgX2JyXG4gICAgcTEgPSBfeFxuICAgIGVwdHIgKz0gMVxuICAgIGlmKGVwdHIgPCBuZSkge1xuICAgICAgZWkgPSBlW2VwdHJdXG4gICAgfVxuICB9XG4gIHdoaWxlKGZwdHIgPCBuZikge1xuICAgIGEgPSBmaVxuICAgIGIgPSBxMFxuICAgIHggPSBhICsgYlxuICAgIGJ2ID0geCAtIGFcbiAgICB5ID0gYiAtIGJ2XG4gICAgaWYoeSkge1xuICAgICAgZ1tjb3VudCsrXSA9IHlcbiAgICB9IFxuICAgIF94ID0gcTEgKyB4XG4gICAgX2J2ID0gX3ggLSBxMVxuICAgIF9hdiA9IF94IC0gX2J2XG4gICAgX2JyID0geCAtIF9idlxuICAgIF9hciA9IHExIC0gX2F2XG4gICAgcTAgPSBfYXIgKyBfYnJcbiAgICBxMSA9IF94XG4gICAgZnB0ciArPSAxXG4gICAgaWYoZnB0ciA8IG5mKSB7XG4gICAgICBmaSA9IGZbZnB0cl1cbiAgICB9XG4gIH1cbiAgaWYocTApIHtcbiAgICBnW2NvdW50KytdID0gcTBcbiAgfVxuICBpZihxMSkge1xuICAgIGdbY291bnQrK10gPSBxMVxuICB9XG4gIGlmKCFjb3VudCkge1xuICAgIGdbY291bnQrK10gPSAwLjAgIFxuICB9XG4gIGcubGVuZ3RoID0gY291bnRcbiAgcmV0dXJuIGdcbn0iLCJcInVzZSBzdHJpY3RcIlxuXG5tb2R1bGUuZXhwb3J0cyA9IHR3b1Byb2R1Y3RcblxudmFyIFNQTElUVEVSID0gKyhNYXRoLnBvdygyLCAyNykgKyAxLjApXG5cbmZ1bmN0aW9uIHR3b1Byb2R1Y3QoYSwgYiwgcmVzdWx0KSB7XG4gIHZhciB4ID0gYSAqIGJcblxuICB2YXIgYyA9IFNQTElUVEVSICogYVxuICB2YXIgYWJpZyA9IGMgLSBhXG4gIHZhciBhaGkgPSBjIC0gYWJpZ1xuICB2YXIgYWxvID0gYSAtIGFoaVxuXG4gIHZhciBkID0gU1BMSVRURVIgKiBiXG4gIHZhciBiYmlnID0gZCAtIGJcbiAgdmFyIGJoaSA9IGQgLSBiYmlnXG4gIHZhciBibG8gPSBiIC0gYmhpXG5cbiAgdmFyIGVycjEgPSB4IC0gKGFoaSAqIGJoaSlcbiAgdmFyIGVycjIgPSBlcnIxIC0gKGFsbyAqIGJoaSlcbiAgdmFyIGVycjMgPSBlcnIyIC0gKGFoaSAqIGJsbylcblxuICB2YXIgeSA9IGFsbyAqIGJsbyAtIGVycjNcblxuICBpZihyZXN1bHQpIHtcbiAgICByZXN1bHRbMF0gPSB5XG4gICAgcmVzdWx0WzFdID0geFxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gIHJldHVybiBbIHksIHggXVxufSIsIlwidXNlIHN0cmljdFwiXG5cbnZhciB0d29Qcm9kdWN0ID0gcmVxdWlyZShcInR3by1wcm9kdWN0XCIpXG52YXIgcm9idXN0U3VtID0gcmVxdWlyZShcInJvYnVzdC1zdW1cIilcbnZhciByb2J1c3RTY2FsZSA9IHJlcXVpcmUoXCJyb2J1c3Qtc2NhbGVcIilcbnZhciByb2J1c3RTdWJ0cmFjdCA9IHJlcXVpcmUoXCJyb2J1c3Qtc3VidHJhY3RcIilcblxudmFyIE5VTV9FWFBBTkQgPSA1XG5cbnZhciBFUFNJTE9OICAgICA9IDEuMTEwMjIzMDI0NjI1MTU2NWUtMTZcbnZhciBFUlJCT1VORDMgICA9ICgzLjAgKyAxNi4wICogRVBTSUxPTikgKiBFUFNJTE9OXG52YXIgRVJSQk9VTkQ0ICAgPSAoNy4wICsgNTYuMCAqIEVQU0lMT04pICogRVBTSUxPTlxuXG5mdW5jdGlvbiBjb2ZhY3RvcihtLCBjKSB7XG4gIHZhciByZXN1bHQgPSBuZXcgQXJyYXkobS5sZW5ndGgtMSlcbiAgZm9yKHZhciBpPTE7IGk8bS5sZW5ndGg7ICsraSkge1xuICAgIHZhciByID0gcmVzdWx0W2ktMV0gPSBuZXcgQXJyYXkobS5sZW5ndGgtMSlcbiAgICBmb3IodmFyIGo9MCxrPTA7IGo8bS5sZW5ndGg7ICsraikge1xuICAgICAgaWYoaiA9PT0gYykge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgcltrKytdID0gbVtpXVtqXVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0XG59XG5cbmZ1bmN0aW9uIG1hdHJpeChuKSB7XG4gIHZhciByZXN1bHQgPSBuZXcgQXJyYXkobilcbiAgZm9yKHZhciBpPTA7IGk8bjsgKytpKSB7XG4gICAgcmVzdWx0W2ldID0gbmV3IEFycmF5KG4pXG4gICAgZm9yKHZhciBqPTA7IGo8bjsgKytqKSB7XG4gICAgICByZXN1bHRbaV1bal0gPSBbXCJtXCIsIGosIFwiW1wiLCAobi1pLTEpLCBcIl1cIl0uam9pbihcIlwiKVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0XG59XG5cbmZ1bmN0aW9uIHNpZ24obikge1xuICBpZihuICYgMSkge1xuICAgIHJldHVybiBcIi1cIlxuICB9XG4gIHJldHVybiBcIlwiXG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU3VtKGV4cHIpIHtcbiAgaWYoZXhwci5sZW5ndGggPT09IDEpIHtcbiAgICByZXR1cm4gZXhwclswXVxuICB9IGVsc2UgaWYoZXhwci5sZW5ndGggPT09IDIpIHtcbiAgICByZXR1cm4gW1wic3VtKFwiLCBleHByWzBdLCBcIixcIiwgZXhwclsxXSwgXCIpXCJdLmpvaW4oXCJcIilcbiAgfSBlbHNlIHtcbiAgICB2YXIgbSA9IGV4cHIubGVuZ3RoPj4xXG4gICAgcmV0dXJuIFtcInN1bShcIiwgZ2VuZXJhdGVTdW0oZXhwci5zbGljZSgwLCBtKSksIFwiLFwiLCBnZW5lcmF0ZVN1bShleHByLnNsaWNlKG0pKSwgXCIpXCJdLmpvaW4oXCJcIilcbiAgfVxufVxuXG5mdW5jdGlvbiBkZXRlcm1pbmFudChtKSB7XG4gIGlmKG0ubGVuZ3RoID09PSAyKSB7XG4gICAgcmV0dXJuIFtbXCJzdW0ocHJvZChcIiwgbVswXVswXSwgXCIsXCIsIG1bMV1bMV0sIFwiKSxwcm9kKC1cIiwgbVswXVsxXSwgXCIsXCIsIG1bMV1bMF0sIFwiKSlcIl0uam9pbihcIlwiKV1cbiAgfSBlbHNlIHtcbiAgICB2YXIgZXhwciA9IFtdXG4gICAgZm9yKHZhciBpPTA7IGk8bS5sZW5ndGg7ICsraSkge1xuICAgICAgZXhwci5wdXNoKFtcInNjYWxlKFwiLCBnZW5lcmF0ZVN1bShkZXRlcm1pbmFudChjb2ZhY3RvcihtLCBpKSkpLCBcIixcIiwgc2lnbihpKSwgbVswXVtpXSwgXCIpXCJdLmpvaW4oXCJcIikpXG4gICAgfVxuICAgIHJldHVybiBleHByXG4gIH1cbn1cblxuZnVuY3Rpb24gb3JpZW50YXRpb24obikge1xuICB2YXIgcG9zID0gW11cbiAgdmFyIG5lZyA9IFtdXG4gIHZhciBtID0gbWF0cml4KG4pXG4gIHZhciBhcmdzID0gW11cbiAgZm9yKHZhciBpPTA7IGk8bjsgKytpKSB7XG4gICAgaWYoKGkmMSk9PT0wKSB7XG4gICAgICBwb3MucHVzaC5hcHBseShwb3MsIGRldGVybWluYW50KGNvZmFjdG9yKG0sIGkpKSlcbiAgICB9IGVsc2Uge1xuICAgICAgbmVnLnB1c2guYXBwbHkobmVnLCBkZXRlcm1pbmFudChjb2ZhY3RvcihtLCBpKSkpXG4gICAgfVxuICAgIGFyZ3MucHVzaChcIm1cIiArIGkpXG4gIH1cbiAgdmFyIHBvc0V4cHIgPSBnZW5lcmF0ZVN1bShwb3MpXG4gIHZhciBuZWdFeHByID0gZ2VuZXJhdGVTdW0obmVnKVxuICB2YXIgZnVuY05hbWUgPSBcIm9yaWVudGF0aW9uXCIgKyBuICsgXCJFeGFjdFwiXG4gIHZhciBjb2RlID0gW1wiZnVuY3Rpb24gXCIsIGZ1bmNOYW1lLCBcIihcIiwgYXJncy5qb2luKCksIFwiKXt2YXIgcD1cIiwgcG9zRXhwciwgXCIsbj1cIiwgbmVnRXhwciwgXCIsZD1zdWIocCxuKTtcXFxucmV0dXJuIGRbZC5sZW5ndGgtMV07fTtyZXR1cm4gXCIsIGZ1bmNOYW1lXS5qb2luKFwiXCIpXG4gIHZhciBwcm9jID0gbmV3IEZ1bmN0aW9uKFwic3VtXCIsIFwicHJvZFwiLCBcInNjYWxlXCIsIFwic3ViXCIsIGNvZGUpXG4gIHJldHVybiBwcm9jKHJvYnVzdFN1bSwgdHdvUHJvZHVjdCwgcm9idXN0U2NhbGUsIHJvYnVzdFN1YnRyYWN0KVxufVxuXG52YXIgb3JpZW50YXRpb24zRXhhY3QgPSBvcmllbnRhdGlvbigzKVxudmFyIG9yaWVudGF0aW9uNEV4YWN0ID0gb3JpZW50YXRpb24oNClcblxudmFyIENBQ0hFRCA9IFtcbiAgZnVuY3Rpb24gb3JpZW50YXRpb24wKCkgeyByZXR1cm4gMCB9LFxuICBmdW5jdGlvbiBvcmllbnRhdGlvbjEoKSB7IHJldHVybiAwIH0sXG4gIGZ1bmN0aW9uIG9yaWVudGF0aW9uMihhLCBiKSB7IFxuICAgIHJldHVybiBiWzBdIC0gYVswXVxuICB9LFxuICBmdW5jdGlvbiBvcmllbnRhdGlvbjMoYSwgYiwgYykge1xuICAgIHZhciBsID0gKGFbMV0gLSBjWzFdKSAqIChiWzBdIC0gY1swXSlcbiAgICB2YXIgciA9IChhWzBdIC0gY1swXSkgKiAoYlsxXSAtIGNbMV0pXG4gICAgdmFyIGRldCA9IGwgLSByXG4gICAgdmFyIHNcbiAgICBpZihsID4gMCkge1xuICAgICAgaWYociA8PSAwKSB7XG4gICAgICAgIHJldHVybiBkZXRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHMgPSBsICsgclxuICAgICAgfVxuICAgIH0gZWxzZSBpZihsIDwgMCkge1xuICAgICAgaWYociA+PSAwKSB7XG4gICAgICAgIHJldHVybiBkZXRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHMgPSAtKGwgKyByKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZGV0XG4gICAgfVxuICAgIHZhciB0b2wgPSBFUlJCT1VORDMgKiBzXG4gICAgaWYoZGV0ID49IHRvbCB8fCBkZXQgPD0gLXRvbCkge1xuICAgICAgcmV0dXJuIGRldFxuICAgIH1cbiAgICByZXR1cm4gb3JpZW50YXRpb24zRXhhY3QoYSwgYiwgYylcbiAgfSxcbiAgZnVuY3Rpb24gb3JpZW50YXRpb240KGEsYixjLGQpIHtcbiAgICB2YXIgYWR4ID0gYVswXSAtIGRbMF1cbiAgICB2YXIgYmR4ID0gYlswXSAtIGRbMF1cbiAgICB2YXIgY2R4ID0gY1swXSAtIGRbMF1cbiAgICB2YXIgYWR5ID0gYVsxXSAtIGRbMV1cbiAgICB2YXIgYmR5ID0gYlsxXSAtIGRbMV1cbiAgICB2YXIgY2R5ID0gY1sxXSAtIGRbMV1cbiAgICB2YXIgYWR6ID0gYVsyXSAtIGRbMl1cbiAgICB2YXIgYmR6ID0gYlsyXSAtIGRbMl1cbiAgICB2YXIgY2R6ID0gY1syXSAtIGRbMl1cbiAgICB2YXIgYmR4Y2R5ID0gYmR4ICogY2R5XG4gICAgdmFyIGNkeGJkeSA9IGNkeCAqIGJkeVxuICAgIHZhciBjZHhhZHkgPSBjZHggKiBhZHlcbiAgICB2YXIgYWR4Y2R5ID0gYWR4ICogY2R5XG4gICAgdmFyIGFkeGJkeSA9IGFkeCAqIGJkeVxuICAgIHZhciBiZHhhZHkgPSBiZHggKiBhZHlcbiAgICB2YXIgZGV0ID0gYWR6ICogKGJkeGNkeSAtIGNkeGJkeSkgXG4gICAgICAgICAgICArIGJkeiAqIChjZHhhZHkgLSBhZHhjZHkpXG4gICAgICAgICAgICArIGNkeiAqIChhZHhiZHkgLSBiZHhhZHkpXG4gICAgdmFyIHBlcm1hbmVudCA9IChNYXRoLmFicyhiZHhjZHkpICsgTWF0aC5hYnMoY2R4YmR5KSkgKiBNYXRoLmFicyhhZHopXG4gICAgICAgICAgICAgICAgICArIChNYXRoLmFicyhjZHhhZHkpICsgTWF0aC5hYnMoYWR4Y2R5KSkgKiBNYXRoLmFicyhiZHopXG4gICAgICAgICAgICAgICAgICArIChNYXRoLmFicyhhZHhiZHkpICsgTWF0aC5hYnMoYmR4YWR5KSkgKiBNYXRoLmFicyhjZHopXG4gICAgdmFyIHRvbCA9IEVSUkJPVU5ENCAqIHBlcm1hbmVudFxuICAgIGlmICgoZGV0ID4gdG9sKSB8fCAoLWRldCA+IHRvbCkpIHtcbiAgICAgIHJldHVybiBkZXRcbiAgICB9XG4gICAgcmV0dXJuIG9yaWVudGF0aW9uNEV4YWN0KGEsYixjLGQpXG4gIH1cbl1cblxuZnVuY3Rpb24gc2xvd09yaWVudChhcmdzKSB7XG4gIHZhciBwcm9jID0gQ0FDSEVEW2FyZ3MubGVuZ3RoXVxuICBpZighcHJvYykge1xuICAgIHByb2MgPSBDQUNIRURbYXJncy5sZW5ndGhdID0gb3JpZW50YXRpb24oYXJncy5sZW5ndGgpXG4gIH1cbiAgcmV0dXJuIHByb2MuYXBwbHkodW5kZWZpbmVkLCBhcmdzKVxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZU9yaWVudGF0aW9uUHJvYygpIHtcbiAgd2hpbGUoQ0FDSEVELmxlbmd0aCA8PSBOVU1fRVhQQU5EKSB7XG4gICAgQ0FDSEVELnB1c2gob3JpZW50YXRpb24oQ0FDSEVELmxlbmd0aCkpXG4gIH1cbiAgdmFyIGFyZ3MgPSBbXVxuICB2YXIgcHJvY0FyZ3MgPSBbXCJzbG93XCJdXG4gIGZvcih2YXIgaT0wOyBpPD1OVU1fRVhQQU5EOyArK2kpIHtcbiAgICBhcmdzLnB1c2goXCJhXCIgKyBpKVxuICAgIHByb2NBcmdzLnB1c2goXCJvXCIgKyBpKVxuICB9XG4gIHZhciBjb2RlID0gW1xuICAgIFwiZnVuY3Rpb24gZ2V0T3JpZW50YXRpb24oXCIsIGFyZ3Muam9pbigpLCBcIil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpjYXNlIDE6cmV0dXJuIDA7XCJcbiAgXVxuICBmb3IodmFyIGk9MjsgaTw9TlVNX0VYUEFORDsgKytpKSB7XG4gICAgY29kZS5wdXNoKFwiY2FzZSBcIiwgaSwgXCI6cmV0dXJuIG9cIiwgaSwgXCIoXCIsIGFyZ3Muc2xpY2UoMCwgaSkuam9pbigpLCBcIik7XCIpXG4gIH1cbiAgY29kZS5wdXNoKFwifXZhciBzPW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKTtmb3IodmFyIGk9MDtpPGFyZ3VtZW50cy5sZW5ndGg7KytpKXtzW2ldPWFyZ3VtZW50c1tpXX07cmV0dXJuIHNsb3cocyk7fXJldHVybiBnZXRPcmllbnRhdGlvblwiKVxuICBwcm9jQXJncy5wdXNoKGNvZGUuam9pbihcIlwiKSlcblxuICB2YXIgcHJvYyA9IEZ1bmN0aW9uLmFwcGx5KHVuZGVmaW5lZCwgcHJvY0FyZ3MpXG4gIG1vZHVsZS5leHBvcnRzID0gcHJvYy5hcHBseSh1bmRlZmluZWQsIFtzbG93T3JpZW50XS5jb25jYXQoQ0FDSEVEKSlcbiAgZm9yKHZhciBpPTA7IGk8PU5VTV9FWFBBTkQ7ICsraSkge1xuICAgIG1vZHVsZS5leHBvcnRzW2ldID0gQ0FDSEVEW2ldXG4gIH1cbn1cblxuZ2VuZXJhdGVPcmllbnRhdGlvblByb2MoKSIsIlwidXNlIHN0cmljdFwiXG5cbi8vSGlnaCBsZXZlbCBpZGVhOlxuLy8gMS4gVXNlIENsYXJrc29uJ3MgaW5jcmVtZW50YWwgY29uc3RydWN0aW9uIHRvIGZpbmQgY29udmV4IGh1bGxcbi8vIDIuIFBvaW50IGxvY2F0aW9uIGluIHRyaWFuZ3VsYXRpb24gYnkganVtcCBhbmQgd2Fsa1xuXG5tb2R1bGUuZXhwb3J0cyA9IGluY3JlbWVudGFsQ29udmV4SHVsbFxuXG52YXIgb3JpZW50ID0gcmVxdWlyZShcInJvYnVzdC1vcmllbnRhdGlvblwiKVxudmFyIGNvbXBhcmVDZWxsID0gcmVxdWlyZShcInNpbXBsaWNpYWwtY29tcGxleFwiKS5jb21wYXJlQ2VsbHNcblxuZnVuY3Rpb24gY29tcGFyZUludChhLCBiKSB7XG4gIHJldHVybiBhIC0gYlxufVxuXG5mdW5jdGlvbiBTaW1wbGV4KHZlcnRpY2VzLCBhZGphY2VudCwgYm91bmRhcnkpIHtcbiAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzXG4gIHRoaXMuYWRqYWNlbnQgPSBhZGphY2VudFxuICB0aGlzLmJvdW5kYXJ5ID0gYm91bmRhcnlcbiAgdGhpcy5sYXN0VmlzaXRlZCA9IC0xXG59XG5cblNpbXBsZXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHQgPSB0aGlzLnZlcnRpY2VzWzBdXG4gIHRoaXMudmVydGljZXNbMF0gPSB0aGlzLnZlcnRpY2VzWzFdXG4gIHRoaXMudmVydGljZXNbMV0gPSB0XG4gIHZhciB1ID0gdGhpcy5hZGphY2VudFswXVxuICB0aGlzLmFkamFjZW50WzBdID0gdGhpcy5hZGphY2VudFsxXVxuICB0aGlzLmFkamFjZW50WzFdID0gdVxufVxuXG5mdW5jdGlvbiBHbHVlRmFjZXQodmVydGljZXMsIGNlbGwsIGluZGV4KSB7XG4gIHRoaXMudmVydGljZXMgPSB2ZXJ0aWNlc1xuICB0aGlzLmNlbGwgPSBjZWxsXG4gIHRoaXMuaW5kZXggPSBpbmRleFxufVxuXG5mdW5jdGlvbiBjb21wYXJlR2x1ZShhLCBiKSB7XG4gIHJldHVybiBjb21wYXJlQ2VsbChhLnZlcnRpY2VzLCBiLnZlcnRpY2VzKVxufVxuXG5mdW5jdGlvbiBiYWtlT3JpZW50KGQpIHtcbiAgdmFyIGNvZGUgPSBbXCJmdW5jdGlvbiBvcmllbnQoKXt2YXIgdHVwbGU9dGhpcy50dXBsZTtyZXR1cm4gdGVzdChcIl1cbiAgZm9yKHZhciBpPTA7IGk8PWQ7ICsraSkge1xuICAgIGlmKGkgPiAwKSB7XG4gICAgICBjb2RlLnB1c2goXCIsXCIpXG4gICAgfVxuICAgIGNvZGUucHVzaChcInR1cGxlW1wiLCBpLCBcIl1cIilcbiAgfVxuICBjb2RlLnB1c2goXCIpfXJldHVybiBvcmllbnRcIilcbiAgdmFyIHByb2MgPSBuZXcgRnVuY3Rpb24oXCJ0ZXN0XCIsIGNvZGUuam9pbihcIlwiKSlcbiAgdmFyIHRlc3QgPSBvcmllbnRbZCsxXVxuICBpZighdGVzdCkge1xuICAgIHRlc3QgPSBvcmllbnRcbiAgfVxuICByZXR1cm4gcHJvYyh0ZXN0KVxufVxuXG52YXIgQkFLRUQgPSBbXVxuXG5mdW5jdGlvbiBUcmlhbmd1bGF0aW9uKGRpbWVuc2lvbiwgdmVydGljZXMsIHNpbXBsaWNlcykge1xuICB0aGlzLmRpbWVuc2lvbiA9IGRpbWVuc2lvblxuICB0aGlzLnZlcnRpY2VzID0gdmVydGljZXNcbiAgdGhpcy5zaW1wbGljZXMgPSBzaW1wbGljZXNcbiAgdGhpcy5pbnRlcmlvciA9IHNpbXBsaWNlcy5maWx0ZXIoZnVuY3Rpb24oYykge1xuICAgIHJldHVybiAhYy5ib3VuZGFyeVxuICB9KVxuXG4gIHRoaXMudHVwbGUgPSBuZXcgQXJyYXkoZGltZW5zaW9uKzEpXG4gIGZvcih2YXIgaT0wOyBpPD1kaW1lbnNpb247ICsraSkge1xuICAgIHRoaXMudHVwbGVbaV0gPSB0aGlzLnZlcnRpY2VzW2ldXG4gIH1cblxuICB2YXIgbyA9IEJBS0VEW2RpbWVuc2lvbl1cbiAgaWYoIW8pIHtcbiAgICBvID0gQkFLRURbZGltZW5zaW9uXSA9IGJha2VPcmllbnQoZGltZW5zaW9uKVxuICB9XG4gIHRoaXMub3JpZW50ID0gb1xufVxuXG52YXIgcHJvdG8gPSBUcmlhbmd1bGF0aW9uLnByb3RvdHlwZVxuXG4vL0RlZ2VuZXJhdGUgc2l0dWF0aW9uIHdoZXJlIHdlIGFyZSBvbiBib3VuZGFyeSwgYnV0IGNvcGxhbmFyIHRvIGZhY2VcbnByb3RvLmhhbmRsZUJvdW5kYXJ5RGVnZW5lcmFjeSA9IGZ1bmN0aW9uKGNlbGwsIHBvaW50KSB7XG4gIHZhciBkID0gdGhpcy5kaW1lbnNpb25cbiAgdmFyIG4gPSB0aGlzLnZlcnRpY2VzLmxlbmd0aCAtIDFcbiAgdmFyIHR1cGxlID0gdGhpcy50dXBsZVxuICB2YXIgdmVydHMgPSB0aGlzLnZlcnRpY2VzXG5cbiAgLy9EdW1iIHNvbHV0aW9uOiBKdXN0IGRvIGRmcyBmcm9tIGJvdW5kYXJ5IGNlbGwgdW50aWwgd2UgZmluZCBhbnkgcGVhaywgb3IgdGVybWluYXRlXG4gIHZhciB0b1Zpc2l0ID0gWyBjZWxsIF1cbiAgY2VsbC5sYXN0VmlzaXRlZCA9IC1uXG4gIHdoaWxlKHRvVmlzaXQubGVuZ3RoID4gMCkge1xuICAgIGNlbGwgPSB0b1Zpc2l0LnBvcCgpXG4gICAgdmFyIGNlbGxWZXJ0cyA9IGNlbGwudmVydGljZXNcbiAgICB2YXIgY2VsbEFkaiA9IGNlbGwuYWRqYWNlbnRcbiAgICBmb3IodmFyIGk9MDsgaTw9ZDsgKytpKSB7XG4gICAgICB2YXIgbmVpZ2hib3IgPSBjZWxsQWRqW2ldXG4gICAgICBpZighbmVpZ2hib3IuYm91bmRhcnkgfHwgbmVpZ2hib3IubGFzdFZpc2l0ZWQgPD0gLW4pIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIHZhciBudiA9IG5laWdoYm9yLnZlcnRpY2VzXG4gICAgICBmb3IodmFyIGo9MDsgajw9ZDsgKytqKSB7XG4gICAgICAgIHZhciB2diA9IG52W2pdXG4gICAgICAgIGlmKHZ2IDwgMCkge1xuICAgICAgICAgIHR1cGxlW2pdID0gcG9pbnRcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0dXBsZVtqXSA9IHZlcnRzW3Z2XVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgbyA9IHRoaXMub3JpZW50KClcbiAgICAgIGlmKG8gPiAwKSB7XG4gICAgICAgIHJldHVybiBuZWlnaGJvclxuICAgICAgfVxuICAgICAgbmVpZ2hib3IubGFzdFZpc2l0ZWQgPSAtblxuICAgICAgaWYobyA9PT0gMCkge1xuICAgICAgICB0b1Zpc2l0LnB1c2gobmVpZ2hib3IpXG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsXG59XG5cbnByb3RvLndhbGsgPSBmdW5jdGlvbihwb2ludCwgcmFuZG9tKSB7XG4gIC8vQWxpYXMgbG9jYWwgcHJvcGVydGllc1xuICB2YXIgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC0gMVxuICB2YXIgZCA9IHRoaXMuZGltZW5zaW9uXG4gIHZhciB2ZXJ0cyA9IHRoaXMudmVydGljZXNcbiAgdmFyIHR1cGxlID0gdGhpcy50dXBsZVxuXG4gIC8vQ29tcHV0ZSBpbml0aWFsIGp1bXAgY2VsbFxuICB2YXIgaW5pdEluZGV4ID0gcmFuZG9tID8gKHRoaXMuaW50ZXJpb3IubGVuZ3RoICogTWF0aC5yYW5kb20oKSl8MCA6ICh0aGlzLmludGVyaW9yLmxlbmd0aC0xKVxuICB2YXIgY2VsbCA9IHRoaXMuaW50ZXJpb3JbIGluaXRJbmRleCBdXG5cbiAgLy9TdGFydCB3YWxraW5nXG5vdXRlckxvb3A6XG4gIHdoaWxlKCFjZWxsLmJvdW5kYXJ5KSB7XG4gICAgdmFyIGNlbGxWZXJ0cyA9IGNlbGwudmVydGljZXNcbiAgICB2YXIgY2VsbEFkaiA9IGNlbGwuYWRqYWNlbnRcblxuICAgIGZvcih2YXIgaT0wOyBpPD1kOyArK2kpIHtcbiAgICAgIHR1cGxlW2ldID0gdmVydHNbY2VsbFZlcnRzW2ldXVxuICAgIH1cbiAgICBjZWxsLmxhc3RWaXNpdGVkID0gblxuXG4gICAgLy9GaW5kIGZhcnRoZXN0IGFkamFjZW50IGNlbGxcbiAgICBmb3IodmFyIGk9MDsgaTw9ZDsgKytpKSB7XG4gICAgICB2YXIgbmVpZ2hib3IgPSBjZWxsQWRqW2ldXG4gICAgICBpZihuZWlnaGJvci5sYXN0VmlzaXRlZCA+PSBuKSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICB2YXIgcHJldiA9IHR1cGxlW2ldXG4gICAgICB0dXBsZVtpXSA9IHBvaW50XG4gICAgICB2YXIgbyA9IHRoaXMub3JpZW50KClcbiAgICAgIHR1cGxlW2ldID0gcHJldlxuICAgICAgaWYobyA8IDApIHtcbiAgICAgICAgY2VsbCA9IG5laWdoYm9yXG4gICAgICAgIGNvbnRpbnVlIG91dGVyTG9vcFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYoIW5laWdoYm9yLmJvdW5kYXJ5KSB7XG4gICAgICAgICAgbmVpZ2hib3IubGFzdFZpc2l0ZWQgPSBuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmVpZ2hib3IubGFzdFZpc2l0ZWQgPSAtblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVyblxuICB9XG5cbiAgcmV0dXJuIGNlbGxcbn1cblxucHJvdG8uYWRkUGVha3MgPSBmdW5jdGlvbihwb2ludCwgY2VsbCkge1xuICB2YXIgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC0gMVxuICB2YXIgZCA9IHRoaXMuZGltZW5zaW9uXG4gIHZhciB2ZXJ0cyA9IHRoaXMudmVydGljZXNcbiAgdmFyIHR1cGxlID0gdGhpcy50dXBsZVxuICB2YXIgaW50ZXJpb3IgPSB0aGlzLmludGVyaW9yXG4gIHZhciBzaW1wbGljZXMgPSB0aGlzLnNpbXBsaWNlc1xuXG4gIC8vV2Fsa2luZyBmaW5pc2hlZCBhdCBib3VuZGFyeSwgdGltZSB0byBhZGQgcGVha3NcbiAgdmFyIHRvdmlzaXQgPSBbIGNlbGwgXVxuXG4gIC8vU3RyZXRjaCBpbml0aWFsIGJvdW5kYXJ5IGNlbGwgaW50byBhIHBlYWtcbiAgY2VsbC5sYXN0VmlzaXRlZCA9IG5cbiAgY2VsbC52ZXJ0aWNlc1tjZWxsLnZlcnRpY2VzLmluZGV4T2YoLTEpXSA9IG5cbiAgY2VsbC5ib3VuZGFyeSA9IGZhbHNlXG4gIGludGVyaW9yLnB1c2goY2VsbClcblxuICAvL1JlY29yZCBhIGxpc3Qgb2YgYWxsIG5ldyBib3VuZGFyaWVzIGNyZWF0ZWQgYnkgYWRkZWQgcGVha3Mgc28gd2UgY2FuIGdsdWUgdGhlbSB0b2dldGhlciB3aGVuIHdlIGFyZSBhbGwgZG9uZVxuICB2YXIgZ2x1ZUZhY2V0cyA9IFtdXG5cbiAgLy9EbyBhIHRyYXZlcnNhbCBvZiB0aGUgYm91bmRhcnkgd2Fsa2luZyBvdXR3YXJkIGZyb20gc3RhcnRpbmcgcGVha1xuICB3aGlsZSh0b3Zpc2l0Lmxlbmd0aCA+IDApIHtcbiAgICAvL1BvcCBvZmYgcGVhayBhbmQgd2FsayBvdmVyIGFkamFjZW50IGNlbGxzXG4gICAgdmFyIGNlbGwgPSB0b3Zpc2l0LnBvcCgpXG4gICAgdmFyIGNlbGxWZXJ0cyA9IGNlbGwudmVydGljZXNcbiAgICB2YXIgY2VsbEFkaiA9IGNlbGwuYWRqYWNlbnRcbiAgICB2YXIgaW5kZXhPZk4gPSBjZWxsVmVydHMuaW5kZXhPZihuKVxuICAgIGlmKGluZGV4T2ZOIDwgMCkge1xuICAgICAgY29udGludWVcbiAgICB9XG5cbiAgICBmb3IodmFyIGk9MDsgaTw9ZDsgKytpKSB7XG4gICAgICBpZihpID09PSBpbmRleE9mTikge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvL0ZvciBlYWNoIGJvdW5kYXJ5IG5laWdoYm9yIG9mIHRoZSBjZWxsXG4gICAgICB2YXIgbmVpZ2hib3IgPSBjZWxsQWRqW2ldXG4gICAgICBpZighbmVpZ2hib3IuYm91bmRhcnkgfHwgbmVpZ2hib3IubGFzdFZpc2l0ZWQgPj0gbikge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICB2YXIgbnYgPSBuZWlnaGJvci52ZXJ0aWNlc1xuXG4gICAgICAvL1Rlc3QgaWYgbmVpZ2hib3IgaXMgYSBwZWFrXG4gICAgICBpZihuZWlnaGJvci5sYXN0VmlzaXRlZCAhPT0gLW4pIHsgICAgICBcbiAgICAgICAgLy9Db21wdXRlIG9yaWVudGF0aW9uIG9mIHAgcmVsYXRpdmUgdG8gZWFjaCBib3VuZGFyeSBwZWFrXG4gICAgICAgIHZhciBpbmRleE9mTmVnMSA9IDBcbiAgICAgICAgZm9yKHZhciBqPTA7IGo8PWQ7ICsraikge1xuICAgICAgICAgIGlmKG52W2pdIDwgMCkge1xuICAgICAgICAgICAgaW5kZXhPZk5lZzEgPSBqXG4gICAgICAgICAgICB0dXBsZVtqXSA9IHBvaW50XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHR1cGxlW2pdID0gdmVydHNbbnZbal1dXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBvID0gdGhpcy5vcmllbnQoKVxuXG4gICAgICAgIC8vVGVzdCBpZiBuZWlnaGJvciBjZWxsIGlzIGFsc28gYSBwZWFrXG4gICAgICAgIGlmKG8gPiAwKSB7XG4gICAgICAgICAgbnZbaW5kZXhPZk5lZzFdID0gblxuICAgICAgICAgIG5laWdoYm9yLmJvdW5kYXJ5ID0gZmFsc2VcbiAgICAgICAgICBpbnRlcmlvci5wdXNoKG5laWdoYm9yKVxuICAgICAgICAgIHRvdmlzaXQucHVzaChuZWlnaGJvcilcbiAgICAgICAgICBuZWlnaGJvci5sYXN0VmlzaXRlZCA9IG5cbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5laWdoYm9yLmxhc3RWaXNpdGVkID0gLW5cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgbmEgPSBuZWlnaGJvci5hZGphY2VudFxuXG4gICAgICAvL090aGVyd2lzZSwgcmVwbGFjZSBuZWlnaGJvciB3aXRoIG5ldyBmYWNlXG4gICAgICB2YXIgdnZlcnRzID0gY2VsbFZlcnRzLnNsaWNlKClcbiAgICAgIHZhciB2YWRqID0gY2VsbEFkai5zbGljZSgpXG4gICAgICB2YXIgbmNlbGwgPSBuZXcgU2ltcGxleCh2dmVydHMsIHZhZGosIHRydWUpXG4gICAgICBzaW1wbGljZXMucHVzaChuY2VsbClcblxuICAgICAgLy9Db25uZWN0IHRvIG5laWdoYm9yXG4gICAgICB2YXIgb3Bwb3NpdGUgPSBuYS5pbmRleE9mKGNlbGwpXG4gICAgICBpZihvcHBvc2l0ZSA8IDApIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIG5hW29wcG9zaXRlXSA9IG5jZWxsXG4gICAgICB2YWRqW2luZGV4T2ZOXSA9IG5laWdoYm9yXG5cbiAgICAgIC8vQ29ubmVjdCB0byBjZWxsXG4gICAgICB2dmVydHNbaV0gPSAtMVxuICAgICAgdmFkaltpXSA9IGNlbGxcbiAgICAgIGNlbGxBZGpbaV0gPSBuY2VsbFxuXG4gICAgICAvL0ZsaXAgZmFjZXRcbiAgICAgIG5jZWxsLmZsaXAoKVxuXG4gICAgICAvL0FkZCB0byBnbHVlIGxpc3RcbiAgICAgIGZvcih2YXIgaj0wOyBqPD1kOyArK2opIHtcbiAgICAgICAgdmFyIHV1ID0gdnZlcnRzW2pdXG4gICAgICAgIGlmKHV1IDwgMCB8fCB1dSA9PT0gbikge1xuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5mYWNlID0gbmV3IEFycmF5KGQtMSlcbiAgICAgICAgdmFyIG5wdHIgPSAwXG4gICAgICAgIGZvcih2YXIgaz0wOyBrPD1kOyArK2spIHtcbiAgICAgICAgICB2YXIgdnYgPSB2dmVydHNba11cbiAgICAgICAgICBpZih2diA8IDAgfHwgayA9PT0gaikge1xuICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgICB9XG4gICAgICAgICAgbmZhY2VbbnB0cisrXSA9IHZ2XG4gICAgICAgIH1cbiAgICAgICAgZ2x1ZUZhY2V0cy5wdXNoKG5ldyBHbHVlRmFjZXQobmZhY2UsIG5jZWxsLCBqKSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvL0dsdWUgYm91bmRhcnkgZmFjZXRzIHRvZ2V0aGVyXG4gIGdsdWVGYWNldHMuc29ydChjb21wYXJlR2x1ZSlcblxuICBmb3IodmFyIGk9MDsgaSsxPGdsdWVGYWNldHMubGVuZ3RoOyBpKz0yKSB7XG4gICAgdmFyIGEgPSBnbHVlRmFjZXRzW2ldXG4gICAgdmFyIGIgPSBnbHVlRmFjZXRzW2krMV1cbiAgICB2YXIgYWkgPSBhLmluZGV4XG4gICAgdmFyIGJpID0gYi5pbmRleFxuICAgIGlmKGFpIDwgMCB8fCBiaSA8IDApIHtcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuICAgIGEuY2VsbC5hZGphY2VudFthLmluZGV4XSA9IGIuY2VsbFxuICAgIGIuY2VsbC5hZGphY2VudFtiLmluZGV4XSA9IGEuY2VsbFxuICB9XG59XG5cbnByb3RvLmluc2VydCA9IGZ1bmN0aW9uKHBvaW50LCByYW5kb20pIHtcbiAgLy9BZGQgcG9pbnRcbiAgdmFyIHZlcnRzID0gdGhpcy52ZXJ0aWNlc1xuICB2ZXJ0cy5wdXNoKHBvaW50KVxuXG4gIHZhciBjZWxsID0gdGhpcy53YWxrKHBvaW50LCByYW5kb20pXG4gIGlmKCFjZWxsKSB7XG4gICAgcmV0dXJuXG4gIH1cblxuICAvL0FsaWFzIGxvY2FsIHByb3BlcnRpZXNcbiAgdmFyIGQgPSB0aGlzLmRpbWVuc2lvblxuICB2YXIgdHVwbGUgPSB0aGlzLnR1cGxlXG5cbiAgLy9EZWdlbmVyYXRlIGNhc2U6IElmIHBvaW50IGlzIGNvcGxhbmFyIHRvIGNlbGwsIHRoZW4gd2FsayB1bnRpbCB3ZSBmaW5kIGEgbm9uLWRlZ2VuZXJhdGUgYm91bmRhcnlcbiAgZm9yKHZhciBpPTA7IGk8PWQ7ICsraSkge1xuICAgIHZhciB2diA9IGNlbGwudmVydGljZXNbaV1cbiAgICBpZih2diA8IDApIHtcbiAgICAgIHR1cGxlW2ldID0gcG9pbnRcbiAgICB9IGVsc2Uge1xuICAgICAgdHVwbGVbaV0gPSB2ZXJ0c1t2dl1cbiAgICB9XG4gIH1cbiAgdmFyIG8gPSB0aGlzLm9yaWVudCh0dXBsZSlcbiAgaWYobyA8IDApIHtcbiAgICByZXR1cm5cbiAgfSBlbHNlIGlmKG8gPT09IDApIHtcbiAgICBjZWxsID0gdGhpcy5oYW5kbGVCb3VuZGFyeURlZ2VuZXJhY3koY2VsbCwgcG9pbnQpXG4gICAgaWYoIWNlbGwpIHtcbiAgICAgIHJldHVyblxuICAgIH1cbiAgfVxuXG4gIC8vQWRkIHBlYWtzXG4gIHRoaXMuYWRkUGVha3MocG9pbnQsIGNlbGwpXG59XG5cbi8vRXh0cmFjdCBhbGwgYm91bmRhcnkgY2VsbHNcbnByb3RvLmJvdW5kYXJ5ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBkID0gdGhpcy5kaW1lbnNpb25cbiAgdmFyIGJvdW5kYXJ5ID0gW11cbiAgdmFyIGNlbGxzID0gdGhpcy5zaW1wbGljZXNcbiAgdmFyIG5jID0gY2VsbHMubGVuZ3RoXG4gIGZvcih2YXIgaT0wOyBpPG5jOyArK2kpIHtcbiAgICB2YXIgYyA9IGNlbGxzW2ldXG4gICAgaWYoYy5ib3VuZGFyeSkge1xuICAgICAgdmFyIGJjZWxsID0gbmV3IEFycmF5KGQpXG4gICAgICB2YXIgY3YgPSBjLnZlcnRpY2VzXG4gICAgICB2YXIgcHRyID0gMFxuICAgICAgdmFyIHBhcml0eSA9IDBcbiAgICAgIGZvcih2YXIgaj0wOyBqPD1kOyArK2opIHtcbiAgICAgICAgaWYoY3Zbal0gPj0gMCkge1xuICAgICAgICAgIGJjZWxsW3B0cisrXSA9IGN2W2pdXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGFyaXR5ID0gaiYxXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmKHBhcml0eSA9PT0gKGQmMSkpIHtcbiAgICAgICAgdmFyIHQgPSBiY2VsbFswXVxuICAgICAgICBiY2VsbFswXSA9IGJjZWxsWzFdXG4gICAgICAgIGJjZWxsWzFdID0gdFxuICAgICAgfVxuICAgICAgYm91bmRhcnkucHVzaChiY2VsbClcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGJvdW5kYXJ5XG59XG5cbmZ1bmN0aW9uIGluY3JlbWVudGFsQ29udmV4SHVsbChwb2ludHMsIHJhbmRvbVNlYXJjaCkge1xuICB2YXIgbiA9IHBvaW50cy5sZW5ndGhcbiAgaWYobiA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk11c3QgaGF2ZSBhdCBsZWFzdCBkKzEgcG9pbnRzXCIpXG4gIH1cbiAgdmFyIGQgPSBwb2ludHNbMF0ubGVuZ3RoXG4gIGlmKG4gPD0gZCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk11c3QgaW5wdXQgYXQgbGVhc3QgZCsxIHBvaW50c1wiKVxuICB9XG5cbiAgLy9GSVhNRTogVGhpcyBjb3VsZCBiZSBkZWdlbmVyYXRlLCBidXQgbmVlZCB0byBzZWxlY3QgZCsxIG5vbi1jb3BsYW5hciBwb2ludHMgdG8gYm9vdHN0cmFwIHByb2Nlc3NcbiAgdmFyIGluaXRpYWxTaW1wbGV4ID0gcG9pbnRzLnNsaWNlKDAsIGQrMSlcblxuICAvL01ha2Ugc3VyZSBpbml0aWFsIHNpbXBsZXggaXMgcG9zaXRpdmVseSBvcmllbnRlZFxuICB2YXIgbyA9IG9yaWVudC5hcHBseSh2b2lkIDAsIGluaXRpYWxTaW1wbGV4KVxuICBpZihvID09PSAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW5wdXQgbm90IGluIGdlbmVyYWwgcG9zaXRpb25cIilcbiAgfVxuICB2YXIgaW5pdGlhbENvb3JkcyA9IG5ldyBBcnJheShkKzEpXG4gIGZvcih2YXIgaT0wOyBpPD1kOyArK2kpIHtcbiAgICBpbml0aWFsQ29vcmRzW2ldID0gaVxuICB9XG4gIGlmKG8gPCAwKSB7XG4gICAgaW5pdGlhbENvb3Jkc1swXSA9IDFcbiAgICBpbml0aWFsQ29vcmRzWzFdID0gMFxuICB9XG5cbiAgLy9DcmVhdGUgaW5pdGlhbCB0b3BvbG9naWNhbCBpbmRleCwgZ2x1ZSBwb2ludGVycyB0b2dldGhlciAoa2luZCBvZiBtZXNzeSlcbiAgdmFyIGluaXRpYWxDZWxsID0gbmV3IFNpbXBsZXgoaW5pdGlhbENvb3JkcywgbmV3IEFycmF5KGQrMSksIGZhbHNlKVxuICB2YXIgYm91bmRhcnkgPSBpbml0aWFsQ2VsbC5hZGphY2VudFxuICB2YXIgbGlzdCA9IG5ldyBBcnJheShkKzIpXG4gIGZvcih2YXIgaT0wOyBpPD1kOyArK2kpIHtcbiAgICB2YXIgdmVydHMgPSBpbml0aWFsQ29vcmRzLnNsaWNlKClcbiAgICBmb3IodmFyIGo9MDsgajw9ZDsgKytqKSB7XG4gICAgICBpZihqID09PSBpKSB7XG4gICAgICAgIHZlcnRzW2pdID0gLTFcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIHQgPSB2ZXJ0c1swXVxuICAgIHZlcnRzWzBdID0gdmVydHNbMV1cbiAgICB2ZXJ0c1sxXSA9IHRcbiAgICB2YXIgY2VsbCA9IG5ldyBTaW1wbGV4KHZlcnRzLCBuZXcgQXJyYXkoZCsxKSwgdHJ1ZSlcbiAgICBib3VuZGFyeVtpXSA9IGNlbGxcbiAgICBsaXN0W2ldID0gY2VsbFxuICB9XG4gIGxpc3RbZCsxXSA9IGluaXRpYWxDZWxsXG4gIGZvcih2YXIgaT0wOyBpPD1kOyArK2kpIHtcbiAgICB2YXIgdmVydHMgPSBib3VuZGFyeVtpXS52ZXJ0aWNlc1xuICAgIHZhciBhZGogPSBib3VuZGFyeVtpXS5hZGphY2VudFxuICAgIGZvcih2YXIgaj0wOyBqPD1kOyArK2opIHtcbiAgICAgIHZhciB2ID0gdmVydHNbal1cbiAgICAgIGlmKHYgPCAwKSB7XG4gICAgICAgIGFkaltqXSA9IGluaXRpYWxDZWxsXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICBmb3IodmFyIGs9MDsgazw9ZDsgKytrKSB7XG4gICAgICAgIGlmKGJvdW5kYXJ5W2tdLnZlcnRpY2VzLmluZGV4T2YodikgPCAwKSB7XG4gICAgICAgICAgYWRqW2pdID0gYm91bmRhcnlba11cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vSW5pdGlhbGl6ZSB0cmlhbmdsZXNcbiAgdmFyIHRyaWFuZ2xlcyA9IG5ldyBUcmlhbmd1bGF0aW9uKGQsIGluaXRpYWxTaW1wbGV4LCBsaXN0KVxuXG4gIC8vSW5zZXJ0IHJlbWFpbmluZyBwb2ludHNcbiAgdmFyIHVzZVJhbmRvbSA9ICEhcmFuZG9tU2VhcmNoXG4gIGZvcih2YXIgaT1kKzE7IGk8bjsgKytpKSB7XG4gICAgdHJpYW5nbGVzLmluc2VydChwb2ludHNbaV0sIHVzZVJhbmRvbSlcbiAgfVxuICBcbiAgLy9FeHRyYWN0IGJvdW5kYXJ5IGNlbGxzXG4gIHJldHVybiB0cmlhbmdsZXMuYm91bmRhcnkoKVxufSIsIi8qKlxuICogQml0IHR3aWRkbGluZyBoYWNrcyBmb3IgSmF2YVNjcmlwdC5cbiAqXG4gKiBBdXRob3I6IE1pa29sYSBMeXNlbmtvXG4gKlxuICogUG9ydGVkIGZyb20gU3RhbmZvcmQgYml0IHR3aWRkbGluZyBoYWNrIGxpYnJhcnk6XG4gKiAgICBodHRwOi8vZ3JhcGhpY3Muc3RhbmZvcmQuZWR1L35zZWFuZGVyL2JpdGhhY2tzLmh0bWxcbiAqL1xuXG5cInVzZSBzdHJpY3RcIjsgXCJ1c2UgcmVzdHJpY3RcIjtcblxuLy9OdW1iZXIgb2YgYml0cyBpbiBhbiBpbnRlZ2VyXG52YXIgSU5UX0JJVFMgPSAzMjtcblxuLy9Db25zdGFudHNcbmV4cG9ydHMuSU5UX0JJVFMgID0gSU5UX0JJVFM7XG5leHBvcnRzLklOVF9NQVggICA9ICAweDdmZmZmZmZmO1xuZXhwb3J0cy5JTlRfTUlOICAgPSAtMTw8KElOVF9CSVRTLTEpO1xuXG4vL1JldHVybnMgLTEsIDAsICsxIGRlcGVuZGluZyBvbiBzaWduIG9mIHhcbmV4cG9ydHMuc2lnbiA9IGZ1bmN0aW9uKHYpIHtcbiAgcmV0dXJuICh2ID4gMCkgLSAodiA8IDApO1xufVxuXG4vL0NvbXB1dGVzIGFic29sdXRlIHZhbHVlIG9mIGludGVnZXJcbmV4cG9ydHMuYWJzID0gZnVuY3Rpb24odikge1xuICB2YXIgbWFzayA9IHYgPj4gKElOVF9CSVRTLTEpO1xuICByZXR1cm4gKHYgXiBtYXNrKSAtIG1hc2s7XG59XG5cbi8vQ29tcHV0ZXMgbWluaW11bSBvZiBpbnRlZ2VycyB4IGFuZCB5XG5leHBvcnRzLm1pbiA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgcmV0dXJuIHkgXiAoKHggXiB5KSAmIC0oeCA8IHkpKTtcbn1cblxuLy9Db21wdXRlcyBtYXhpbXVtIG9mIGludGVnZXJzIHggYW5kIHlcbmV4cG9ydHMubWF4ID0gZnVuY3Rpb24oeCwgeSkge1xuICByZXR1cm4geCBeICgoeCBeIHkpICYgLSh4IDwgeSkpO1xufVxuXG4vL0NoZWNrcyBpZiBhIG51bWJlciBpcyBhIHBvd2VyIG9mIHR3b1xuZXhwb3J0cy5pc1BvdzIgPSBmdW5jdGlvbih2KSB7XG4gIHJldHVybiAhKHYgJiAodi0xKSkgJiYgKCEhdik7XG59XG5cbi8vQ29tcHV0ZXMgbG9nIGJhc2UgMiBvZiB2XG5leHBvcnRzLmxvZzIgPSBmdW5jdGlvbih2KSB7XG4gIHZhciByLCBzaGlmdDtcbiAgciA9ICAgICAodiA+IDB4RkZGRikgPDwgNDsgdiA+Pj49IHI7XG4gIHNoaWZ0ID0gKHYgPiAweEZGICApIDw8IDM7IHYgPj4+PSBzaGlmdDsgciB8PSBzaGlmdDtcbiAgc2hpZnQgPSAodiA+IDB4RiAgICkgPDwgMjsgdiA+Pj49IHNoaWZ0OyByIHw9IHNoaWZ0O1xuICBzaGlmdCA9ICh2ID4gMHgzICAgKSA8PCAxOyB2ID4+Pj0gc2hpZnQ7IHIgfD0gc2hpZnQ7XG4gIHJldHVybiByIHwgKHYgPj4gMSk7XG59XG5cbi8vQ29tcHV0ZXMgbG9nIGJhc2UgMTAgb2YgdlxuZXhwb3J0cy5sb2cxMCA9IGZ1bmN0aW9uKHYpIHtcbiAgcmV0dXJuICAodiA+PSAxMDAwMDAwMDAwKSA/IDkgOiAodiA+PSAxMDAwMDAwMDApID8gOCA6ICh2ID49IDEwMDAwMDAwKSA/IDcgOlxuICAgICAgICAgICh2ID49IDEwMDAwMDApID8gNiA6ICh2ID49IDEwMDAwMCkgPyA1IDogKHYgPj0gMTAwMDApID8gNCA6XG4gICAgICAgICAgKHYgPj0gMTAwMCkgPyAzIDogKHYgPj0gMTAwKSA/IDIgOiAodiA+PSAxMCkgPyAxIDogMDtcbn1cblxuLy9Db3VudHMgbnVtYmVyIG9mIGJpdHNcbmV4cG9ydHMucG9wQ291bnQgPSBmdW5jdGlvbih2KSB7XG4gIHYgPSB2IC0gKCh2ID4+PiAxKSAmIDB4NTU1NTU1NTUpO1xuICB2ID0gKHYgJiAweDMzMzMzMzMzKSArICgodiA+Pj4gMikgJiAweDMzMzMzMzMzKTtcbiAgcmV0dXJuICgodiArICh2ID4+PiA0KSAmIDB4RjBGMEYwRikgKiAweDEwMTAxMDEpID4+PiAyNDtcbn1cblxuLy9Db3VudHMgbnVtYmVyIG9mIHRyYWlsaW5nIHplcm9zXG5mdW5jdGlvbiBjb3VudFRyYWlsaW5nWmVyb3Modikge1xuICB2YXIgYyA9IDMyO1xuICB2ICY9IC12O1xuICBpZiAodikgYy0tO1xuICBpZiAodiAmIDB4MDAwMEZGRkYpIGMgLT0gMTY7XG4gIGlmICh2ICYgMHgwMEZGMDBGRikgYyAtPSA4O1xuICBpZiAodiAmIDB4MEYwRjBGMEYpIGMgLT0gNDtcbiAgaWYgKHYgJiAweDMzMzMzMzMzKSBjIC09IDI7XG4gIGlmICh2ICYgMHg1NTU1NTU1NSkgYyAtPSAxO1xuICByZXR1cm4gYztcbn1cbmV4cG9ydHMuY291bnRUcmFpbGluZ1plcm9zID0gY291bnRUcmFpbGluZ1plcm9zO1xuXG4vL1JvdW5kcyB0byBuZXh0IHBvd2VyIG9mIDJcbmV4cG9ydHMubmV4dFBvdzIgPSBmdW5jdGlvbih2KSB7XG4gIHYgKz0gdiA9PT0gMDtcbiAgLS12O1xuICB2IHw9IHYgPj4+IDE7XG4gIHYgfD0gdiA+Pj4gMjtcbiAgdiB8PSB2ID4+PiA0O1xuICB2IHw9IHYgPj4+IDg7XG4gIHYgfD0gdiA+Pj4gMTY7XG4gIHJldHVybiB2ICsgMTtcbn1cblxuLy9Sb3VuZHMgZG93biB0byBwcmV2aW91cyBwb3dlciBvZiAyXG5leHBvcnRzLnByZXZQb3cyID0gZnVuY3Rpb24odikge1xuICB2IHw9IHYgPj4+IDE7XG4gIHYgfD0gdiA+Pj4gMjtcbiAgdiB8PSB2ID4+PiA0O1xuICB2IHw9IHYgPj4+IDg7XG4gIHYgfD0gdiA+Pj4gMTY7XG4gIHJldHVybiB2IC0gKHY+Pj4xKTtcbn1cblxuLy9Db21wdXRlcyBwYXJpdHkgb2Ygd29yZFxuZXhwb3J0cy5wYXJpdHkgPSBmdW5jdGlvbih2KSB7XG4gIHYgXj0gdiA+Pj4gMTY7XG4gIHYgXj0gdiA+Pj4gODtcbiAgdiBePSB2ID4+PiA0O1xuICB2ICY9IDB4ZjtcbiAgcmV0dXJuICgweDY5OTYgPj4+IHYpICYgMTtcbn1cblxudmFyIFJFVkVSU0VfVEFCTEUgPSBuZXcgQXJyYXkoMjU2KTtcblxuKGZ1bmN0aW9uKHRhYikge1xuICBmb3IodmFyIGk9MDsgaTwyNTY7ICsraSkge1xuICAgIHZhciB2ID0gaSwgciA9IGksIHMgPSA3O1xuICAgIGZvciAodiA+Pj49IDE7IHY7IHYgPj4+PSAxKSB7XG4gICAgICByIDw8PSAxO1xuICAgICAgciB8PSB2ICYgMTtcbiAgICAgIC0tcztcbiAgICB9XG4gICAgdGFiW2ldID0gKHIgPDwgcykgJiAweGZmO1xuICB9XG59KShSRVZFUlNFX1RBQkxFKTtcblxuLy9SZXZlcnNlIGJpdHMgaW4gYSAzMiBiaXQgd29yZFxuZXhwb3J0cy5yZXZlcnNlID0gZnVuY3Rpb24odikge1xuICByZXR1cm4gIChSRVZFUlNFX1RBQkxFWyB2ICAgICAgICAgJiAweGZmXSA8PCAyNCkgfFxuICAgICAgICAgIChSRVZFUlNFX1RBQkxFWyh2ID4+PiA4KSAgJiAweGZmXSA8PCAxNikgfFxuICAgICAgICAgIChSRVZFUlNFX1RBQkxFWyh2ID4+PiAxNikgJiAweGZmXSA8PCA4KSAgfFxuICAgICAgICAgICBSRVZFUlNFX1RBQkxFWyh2ID4+PiAyNCkgJiAweGZmXTtcbn1cblxuLy9JbnRlcmxlYXZlIGJpdHMgb2YgMiBjb29yZGluYXRlcyB3aXRoIDE2IGJpdHMuICBVc2VmdWwgZm9yIGZhc3QgcXVhZHRyZWUgY29kZXNcbmV4cG9ydHMuaW50ZXJsZWF2ZTIgPSBmdW5jdGlvbih4LCB5KSB7XG4gIHggJj0gMHhGRkZGO1xuICB4ID0gKHggfCAoeCA8PCA4KSkgJiAweDAwRkYwMEZGO1xuICB4ID0gKHggfCAoeCA8PCA0KSkgJiAweDBGMEYwRjBGO1xuICB4ID0gKHggfCAoeCA8PCAyKSkgJiAweDMzMzMzMzMzO1xuICB4ID0gKHggfCAoeCA8PCAxKSkgJiAweDU1NTU1NTU1O1xuXG4gIHkgJj0gMHhGRkZGO1xuICB5ID0gKHkgfCAoeSA8PCA4KSkgJiAweDAwRkYwMEZGO1xuICB5ID0gKHkgfCAoeSA8PCA0KSkgJiAweDBGMEYwRjBGO1xuICB5ID0gKHkgfCAoeSA8PCAyKSkgJiAweDMzMzMzMzMzO1xuICB5ID0gKHkgfCAoeSA8PCAxKSkgJiAweDU1NTU1NTU1O1xuXG4gIHJldHVybiB4IHwgKHkgPDwgMSk7XG59XG5cbi8vRXh0cmFjdHMgdGhlIG50aCBpbnRlcmxlYXZlZCBjb21wb25lbnRcbmV4cG9ydHMuZGVpbnRlcmxlYXZlMiA9IGZ1bmN0aW9uKHYsIG4pIHtcbiAgdiA9ICh2ID4+PiBuKSAmIDB4NTU1NTU1NTU7XG4gIHYgPSAodiB8ICh2ID4+PiAxKSkgICYgMHgzMzMzMzMzMztcbiAgdiA9ICh2IHwgKHYgPj4+IDIpKSAgJiAweDBGMEYwRjBGO1xuICB2ID0gKHYgfCAodiA+Pj4gNCkpICAmIDB4MDBGRjAwRkY7XG4gIHYgPSAodiB8ICh2ID4+PiAxNikpICYgMHgwMDBGRkZGO1xuICByZXR1cm4gKHYgPDwgMTYpID4+IDE2O1xufVxuXG5cbi8vSW50ZXJsZWF2ZSBiaXRzIG9mIDMgY29vcmRpbmF0ZXMsIGVhY2ggd2l0aCAxMCBiaXRzLiAgVXNlZnVsIGZvciBmYXN0IG9jdHJlZSBjb2Rlc1xuZXhwb3J0cy5pbnRlcmxlYXZlMyA9IGZ1bmN0aW9uKHgsIHksIHopIHtcbiAgeCAmPSAweDNGRjtcbiAgeCAgPSAoeCB8ICh4PDwxNikpICYgNDI3ODE5MDMzNTtcbiAgeCAgPSAoeCB8ICh4PDw4KSkgICYgMjUxNzE5Njk1O1xuICB4ICA9ICh4IHwgKHg8PDQpKSAgJiAzMjcyMzU2MDM1O1xuICB4ICA9ICh4IHwgKHg8PDIpKSAgJiAxMjI3MTMzNTEzO1xuXG4gIHkgJj0gMHgzRkY7XG4gIHkgID0gKHkgfCAoeTw8MTYpKSAmIDQyNzgxOTAzMzU7XG4gIHkgID0gKHkgfCAoeTw8OCkpICAmIDI1MTcxOTY5NTtcbiAgeSAgPSAoeSB8ICh5PDw0KSkgICYgMzI3MjM1NjAzNTtcbiAgeSAgPSAoeSB8ICh5PDwyKSkgICYgMTIyNzEzMzUxMztcbiAgeCB8PSAoeSA8PCAxKTtcbiAgXG4gIHogJj0gMHgzRkY7XG4gIHogID0gKHogfCAoejw8MTYpKSAmIDQyNzgxOTAzMzU7XG4gIHogID0gKHogfCAoejw8OCkpICAmIDI1MTcxOTY5NTtcbiAgeiAgPSAoeiB8ICh6PDw0KSkgICYgMzI3MjM1NjAzNTtcbiAgeiAgPSAoeiB8ICh6PDwyKSkgICYgMTIyNzEzMzUxMztcbiAgXG4gIHJldHVybiB4IHwgKHogPDwgMik7XG59XG5cbi8vRXh0cmFjdHMgbnRoIGludGVybGVhdmVkIGNvbXBvbmVudCBvZiBhIDMtdHVwbGVcbmV4cG9ydHMuZGVpbnRlcmxlYXZlMyA9IGZ1bmN0aW9uKHYsIG4pIHtcbiAgdiA9ICh2ID4+PiBuKSAgICAgICAmIDEyMjcxMzM1MTM7XG4gIHYgPSAodiB8ICh2Pj4+MikpICAgJiAzMjcyMzU2MDM1O1xuICB2ID0gKHYgfCAodj4+PjQpKSAgICYgMjUxNzE5Njk1O1xuICB2ID0gKHYgfCAodj4+PjgpKSAgICYgNDI3ODE5MDMzNTtcbiAgdiA9ICh2IHwgKHY+Pj4xNikpICAmIDB4M0ZGO1xuICByZXR1cm4gKHY8PDIyKT4+MjI7XG59XG5cbi8vQ29tcHV0ZXMgbmV4dCBjb21iaW5hdGlvbiBpbiBjb2xleGljb2dyYXBoaWMgb3JkZXIgKHRoaXMgaXMgbWlzdGFrZW5seSBjYWxsZWQgbmV4dFBlcm11dGF0aW9uIG9uIHRoZSBiaXQgdHdpZGRsaW5nIGhhY2tzIHBhZ2UpXG5leHBvcnRzLm5leHRDb21iaW5hdGlvbiA9IGZ1bmN0aW9uKHYpIHtcbiAgdmFyIHQgPSB2IHwgKHYgLSAxKTtcbiAgcmV0dXJuICh0ICsgMSkgfCAoKCh+dCAmIC1+dCkgLSAxKSA+Pj4gKGNvdW50VHJhaWxpbmdaZXJvcyh2KSArIDEpKTtcbn1cblxuIiwiXCJ1c2Ugc3RyaWN0XCI7IFwidXNlIHJlc3RyaWN0XCI7XG5cbm1vZHVsZS5leHBvcnRzID0gVW5pb25GaW5kO1xuXG5mdW5jdGlvbiBVbmlvbkZpbmQoY291bnQpIHtcbiAgdGhpcy5yb290cyA9IG5ldyBBcnJheShjb3VudCk7XG4gIHRoaXMucmFua3MgPSBuZXcgQXJyYXkoY291bnQpO1xuICBcbiAgZm9yKHZhciBpPTA7IGk8Y291bnQ7ICsraSkge1xuICAgIHRoaXMucm9vdHNbaV0gPSBpO1xuICAgIHRoaXMucmFua3NbaV0gPSAwO1xuICB9XG59XG5cbnZhciBwcm90byA9IFVuaW9uRmluZC5wcm90b3R5cGVcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvLCBcImxlbmd0aFwiLCB7XG4gIFwiZ2V0XCI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnJvb3RzLmxlbmd0aFxuICB9XG59KVxuXG5wcm90by5tYWtlU2V0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBuID0gdGhpcy5yb290cy5sZW5ndGg7XG4gIHRoaXMucm9vdHMucHVzaChuKTtcbiAgdGhpcy5yYW5rcy5wdXNoKDApO1xuICByZXR1cm4gbjtcbn1cblxucHJvdG8uZmluZCA9IGZ1bmN0aW9uKHgpIHtcbiAgdmFyIHgwID0geFxuICB2YXIgcm9vdHMgPSB0aGlzLnJvb3RzO1xuICB3aGlsZShyb290c1t4XSAhPT0geCkge1xuICAgIHggPSByb290c1t4XVxuICB9XG4gIHdoaWxlKHJvb3RzW3gwXSAhPT0geCkge1xuICAgIHZhciB5ID0gcm9vdHNbeDBdXG4gICAgcm9vdHNbeDBdID0geFxuICAgIHgwID0geVxuICB9XG4gIHJldHVybiB4O1xufVxuXG5wcm90by5saW5rID0gZnVuY3Rpb24oeCwgeSkge1xuICB2YXIgeHIgPSB0aGlzLmZpbmQoeClcbiAgICAsIHlyID0gdGhpcy5maW5kKHkpO1xuICBpZih4ciA9PT0geXIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHJhbmtzID0gdGhpcy5yYW5rc1xuICAgICwgcm9vdHMgPSB0aGlzLnJvb3RzXG4gICAgLCB4ZCAgICA9IHJhbmtzW3hyXVxuICAgICwgeWQgICAgPSByYW5rc1t5cl07XG4gIGlmKHhkIDwgeWQpIHtcbiAgICByb290c1t4cl0gPSB5cjtcbiAgfSBlbHNlIGlmKHlkIDwgeGQpIHtcbiAgICByb290c1t5cl0gPSB4cjtcbiAgfSBlbHNlIHtcbiAgICByb290c1t5cl0gPSB4cjtcbiAgICArK3JhbmtzW3hyXTtcbiAgfVxufSIsIlwidXNlIHN0cmljdFwiOyBcInVzZSByZXN0cmljdFwiO1xuXG52YXIgYml0cyAgICAgID0gcmVxdWlyZShcImJpdC10d2lkZGxlXCIpXG4gICwgVW5pb25GaW5kID0gcmVxdWlyZShcInVuaW9uLWZpbmRcIilcblxuLy9SZXR1cm5zIHRoZSBkaW1lbnNpb24gb2YgYSBjZWxsIGNvbXBsZXhcbmZ1bmN0aW9uIGRpbWVuc2lvbihjZWxscykge1xuICB2YXIgZCA9IDBcbiAgICAsIG1heCA9IE1hdGgubWF4XG4gIGZvcih2YXIgaT0wLCBpbD1jZWxscy5sZW5ndGg7IGk8aWw7ICsraSkge1xuICAgIGQgPSBtYXgoZCwgY2VsbHNbaV0ubGVuZ3RoKVxuICB9XG4gIHJldHVybiBkLTFcbn1cbmV4cG9ydHMuZGltZW5zaW9uID0gZGltZW5zaW9uXG5cbi8vQ291bnRzIHRoZSBudW1iZXIgb2YgdmVydGljZXMgaW4gZmFjZXNcbmZ1bmN0aW9uIGNvdW50VmVydGljZXMoY2VsbHMpIHtcbiAgdmFyIHZjID0gLTFcbiAgICAsIG1heCA9IE1hdGgubWF4XG4gIGZvcih2YXIgaT0wLCBpbD1jZWxscy5sZW5ndGg7IGk8aWw7ICsraSkge1xuICAgIHZhciBjID0gY2VsbHNbaV1cbiAgICBmb3IodmFyIGo9MCwgamw9Yy5sZW5ndGg7IGo8amw7ICsraikge1xuICAgICAgdmMgPSBtYXgodmMsIGNbal0pXG4gICAgfVxuICB9XG4gIHJldHVybiB2YysxXG59XG5leHBvcnRzLmNvdW50VmVydGljZXMgPSBjb3VudFZlcnRpY2VzXG5cbi8vUmV0dXJucyBhIGRlZXAgY29weSBvZiBjZWxsc1xuZnVuY3Rpb24gY2xvbmVDZWxscyhjZWxscykge1xuICB2YXIgbmNlbGxzID0gbmV3IEFycmF5KGNlbGxzLmxlbmd0aClcbiAgZm9yKHZhciBpPTAsIGlsPWNlbGxzLmxlbmd0aDsgaTxpbDsgKytpKSB7XG4gICAgbmNlbGxzW2ldID0gY2VsbHNbaV0uc2xpY2UoMClcbiAgfVxuICByZXR1cm4gbmNlbGxzXG59XG5leHBvcnRzLmNsb25lQ2VsbHMgPSBjbG9uZUNlbGxzXG5cbi8vUmFua3MgYSBwYWlyIG9mIGNlbGxzIHVwIHRvIHBlcm11dGF0aW9uXG5mdW5jdGlvbiBjb21wYXJlQ2VsbHMoYSwgYikge1xuICB2YXIgbiA9IGEubGVuZ3RoXG4gICAgLCB0ID0gYS5sZW5ndGggLSBiLmxlbmd0aFxuICAgICwgbWluID0gTWF0aC5taW5cbiAgaWYodCkge1xuICAgIHJldHVybiB0XG4gIH1cbiAgc3dpdGNoKG4pIHtcbiAgICBjYXNlIDA6XG4gICAgICByZXR1cm4gMDtcbiAgICBjYXNlIDE6XG4gICAgICByZXR1cm4gYVswXSAtIGJbMF07XG4gICAgY2FzZSAyOlxuICAgICAgdmFyIGQgPSBhWzBdK2FbMV0tYlswXS1iWzFdXG4gICAgICBpZihkKSB7XG4gICAgICAgIHJldHVybiBkXG4gICAgICB9XG4gICAgICByZXR1cm4gbWluKGFbMF0sYVsxXSkgLSBtaW4oYlswXSxiWzFdKVxuICAgIGNhc2UgMzpcbiAgICAgIHZhciBsMSA9IGFbMF0rYVsxXVxuICAgICAgICAsIG0xID0gYlswXStiWzFdXG4gICAgICBkID0gbDErYVsyXSAtIChtMStiWzJdKVxuICAgICAgaWYoZCkge1xuICAgICAgICByZXR1cm4gZFxuICAgICAgfVxuICAgICAgdmFyIGwwID0gbWluKGFbMF0sIGFbMV0pXG4gICAgICAgICwgbTAgPSBtaW4oYlswXSwgYlsxXSlcbiAgICAgICAgLCBkICA9IG1pbihsMCwgYVsyXSkgLSBtaW4obTAsIGJbMl0pXG4gICAgICBpZihkKSB7XG4gICAgICAgIHJldHVybiBkXG4gICAgICB9XG4gICAgICByZXR1cm4gbWluKGwwK2FbMl0sIGwxKSAtIG1pbihtMCtiWzJdLCBtMSlcbiAgICBcbiAgICAvL1RPRE86IE1heWJlIG9wdGltaXplIG49NCBhcyB3ZWxsP1xuICAgIFxuICAgIGRlZmF1bHQ6XG4gICAgICB2YXIgYXMgPSBhLnNsaWNlKDApXG4gICAgICBhcy5zb3J0KClcbiAgICAgIHZhciBicyA9IGIuc2xpY2UoMClcbiAgICAgIGJzLnNvcnQoKVxuICAgICAgZm9yKHZhciBpPTA7IGk8bjsgKytpKSB7XG4gICAgICAgIHQgPSBhc1tpXSAtIGJzW2ldXG4gICAgICAgIGlmKHQpIHtcbiAgICAgICAgICByZXR1cm4gdFxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gMFxuICB9XG59XG5leHBvcnRzLmNvbXBhcmVDZWxscyA9IGNvbXBhcmVDZWxsc1xuXG5mdW5jdGlvbiBjb21wYXJlWmlwcGVkKGEsIGIpIHtcbiAgcmV0dXJuIGNvbXBhcmVDZWxscyhhWzBdLCBiWzBdKVxufVxuXG4vL1B1dHMgYSBjZWxsIGNvbXBsZXggaW50byBub3JtYWwgb3JkZXIgZm9yIHRoZSBwdXJwb3NlcyBvZiBmaW5kQ2VsbCBxdWVyaWVzXG5mdW5jdGlvbiBub3JtYWxpemUoY2VsbHMsIGF0dHIpIHtcbiAgaWYoYXR0cikge1xuICAgIHZhciBsZW4gPSBjZWxscy5sZW5ndGhcbiAgICB2YXIgemlwcGVkID0gbmV3IEFycmF5KGxlbilcbiAgICBmb3IodmFyIGk9MDsgaTxsZW47ICsraSkge1xuICAgICAgemlwcGVkW2ldID0gW2NlbGxzW2ldLCBhdHRyW2ldXVxuICAgIH1cbiAgICB6aXBwZWQuc29ydChjb21wYXJlWmlwcGVkKVxuICAgIGZvcih2YXIgaT0wOyBpPGxlbjsgKytpKSB7XG4gICAgICBjZWxsc1tpXSA9IHppcHBlZFtpXVswXVxuICAgICAgYXR0cltpXSA9IHppcHBlZFtpXVsxXVxuICAgIH1cbiAgICByZXR1cm4gY2VsbHNcbiAgfSBlbHNlIHtcbiAgICBjZWxscy5zb3J0KGNvbXBhcmVDZWxscylcbiAgICByZXR1cm4gY2VsbHNcbiAgfVxufVxuZXhwb3J0cy5ub3JtYWxpemUgPSBub3JtYWxpemVcblxuLy9SZW1vdmVzIGFsbCBkdXBsaWNhdGUgY2VsbHMgaW4gdGhlIGNvbXBsZXhcbmZ1bmN0aW9uIHVuaXF1ZShjZWxscykge1xuICBpZihjZWxscy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gW11cbiAgfVxuICB2YXIgcHRyID0gMVxuICAgICwgbGVuID0gY2VsbHMubGVuZ3RoXG4gIGZvcih2YXIgaT0xOyBpPGxlbjsgKytpKSB7XG4gICAgdmFyIGEgPSBjZWxsc1tpXVxuICAgIGlmKGNvbXBhcmVDZWxscyhhLCBjZWxsc1tpLTFdKSkge1xuICAgICAgaWYoaSA9PT0gcHRyKSB7XG4gICAgICAgIHB0cisrXG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICBjZWxsc1twdHIrK10gPSBhXG4gICAgfVxuICB9XG4gIGNlbGxzLmxlbmd0aCA9IHB0clxuICByZXR1cm4gY2VsbHNcbn1cbmV4cG9ydHMudW5pcXVlID0gdW5pcXVlO1xuXG4vL0ZpbmRzIGEgY2VsbCBpbiBhIG5vcm1hbGl6ZWQgY2VsbCBjb21wbGV4XG5mdW5jdGlvbiBmaW5kQ2VsbChjZWxscywgYykge1xuICB2YXIgbG8gPSAwXG4gICAgLCBoaSA9IGNlbGxzLmxlbmd0aC0xXG4gICAgLCByICA9IC0xXG4gIHdoaWxlIChsbyA8PSBoaSkge1xuICAgIHZhciBtaWQgPSAobG8gKyBoaSkgPj4gMVxuICAgICAgLCBzICAgPSBjb21wYXJlQ2VsbHMoY2VsbHNbbWlkXSwgYylcbiAgICBpZihzIDw9IDApIHtcbiAgICAgIGlmKHMgPT09IDApIHtcbiAgICAgICAgciA9IG1pZFxuICAgICAgfVxuICAgICAgbG8gPSBtaWQgKyAxXG4gICAgfSBlbHNlIGlmKHMgPiAwKSB7XG4gICAgICBoaSA9IG1pZCAtIDFcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJcbn1cbmV4cG9ydHMuZmluZENlbGwgPSBmaW5kQ2VsbDtcblxuLy9CdWlsZHMgYW4gaW5kZXggZm9yIGFuIG4tY2VsbC4gIFRoaXMgaXMgbW9yZSBnZW5lcmFsIHRoYW4gZHVhbCwgYnV0IGxlc3MgZWZmaWNpZW50XG5mdW5jdGlvbiBpbmNpZGVuY2UoZnJvbV9jZWxscywgdG9fY2VsbHMpIHtcbiAgdmFyIGluZGV4ID0gbmV3IEFycmF5KGZyb21fY2VsbHMubGVuZ3RoKVxuICBmb3IodmFyIGk9MCwgaWw9aW5kZXgubGVuZ3RoOyBpPGlsOyArK2kpIHtcbiAgICBpbmRleFtpXSA9IFtdXG4gIH1cbiAgdmFyIGIgPSBbXVxuICBmb3IodmFyIGk9MCwgbj10b19jZWxscy5sZW5ndGg7IGk8bjsgKytpKSB7XG4gICAgdmFyIGMgPSB0b19jZWxsc1tpXVxuICAgIHZhciBjbCA9IGMubGVuZ3RoXG4gICAgZm9yKHZhciBrPTEsIGtuPSgxPDxjbCk7IGs8a247ICsraykge1xuICAgICAgYi5sZW5ndGggPSBiaXRzLnBvcENvdW50KGspXG4gICAgICB2YXIgbCA9IDBcbiAgICAgIGZvcih2YXIgaj0wOyBqPGNsOyArK2opIHtcbiAgICAgICAgaWYoayAmICgxPDxqKSkge1xuICAgICAgICAgIGJbbCsrXSA9IGNbal1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIGlkeD1maW5kQ2VsbChmcm9tX2NlbGxzLCBiKVxuICAgICAgaWYoaWR4IDwgMCkge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgd2hpbGUodHJ1ZSkge1xuICAgICAgICBpbmRleFtpZHgrK10ucHVzaChpKVxuICAgICAgICBpZihpZHggPj0gZnJvbV9jZWxscy5sZW5ndGggfHwgY29tcGFyZUNlbGxzKGZyb21fY2VsbHNbaWR4XSwgYikgIT09IDApIHtcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBpbmRleFxufVxuZXhwb3J0cy5pbmNpZGVuY2UgPSBpbmNpZGVuY2VcblxuLy9Db21wdXRlcyB0aGUgZHVhbCBvZiB0aGUgbWVzaC4gIFRoaXMgaXMgYmFzaWNhbGx5IGFuIG9wdGltaXplZCB2ZXJzaW9uIG9mIGJ1aWxkSW5kZXggZm9yIHRoZSBzaXR1YXRpb24gd2hlcmUgZnJvbV9jZWxscyBpcyBqdXN0IHRoZSBsaXN0IG9mIHZlcnRpY2VzXG5mdW5jdGlvbiBkdWFsKGNlbGxzLCB2ZXJ0ZXhfY291bnQpIHtcbiAgaWYoIXZlcnRleF9jb3VudCkge1xuICAgIHJldHVybiBpbmNpZGVuY2UodW5pcXVlKHNrZWxldG9uKGNlbGxzLCAwKSksIGNlbGxzLCAwKVxuICB9XG4gIHZhciByZXMgPSBuZXcgQXJyYXkodmVydGV4X2NvdW50KVxuICBmb3IodmFyIGk9MDsgaTx2ZXJ0ZXhfY291bnQ7ICsraSkge1xuICAgIHJlc1tpXSA9IFtdXG4gIH1cbiAgZm9yKHZhciBpPTAsIGxlbj1jZWxscy5sZW5ndGg7IGk8bGVuOyArK2kpIHtcbiAgICB2YXIgYyA9IGNlbGxzW2ldXG4gICAgZm9yKHZhciBqPTAsIGNsPWMubGVuZ3RoOyBqPGNsOyArK2opIHtcbiAgICAgIHJlc1tjW2pdXS5wdXNoKGkpXG4gICAgfVxuICB9XG4gIHJldHVybiByZXNcbn1cbmV4cG9ydHMuZHVhbCA9IGR1YWxcblxuLy9FbnVtZXJhdGVzIGFsbCBjZWxscyBpbiB0aGUgY29tcGxleFxuZnVuY3Rpb24gZXhwbG9kZShjZWxscykge1xuICB2YXIgcmVzdWx0ID0gW11cbiAgZm9yKHZhciBpPTAsIGlsPWNlbGxzLmxlbmd0aDsgaTxpbDsgKytpKSB7XG4gICAgdmFyIGMgPSBjZWxsc1tpXVxuICAgICAgLCBjbCA9IGMubGVuZ3RofDBcbiAgICBmb3IodmFyIGo9MSwgamw9KDE8PGNsKTsgajxqbDsgKytqKSB7XG4gICAgICB2YXIgYiA9IFtdXG4gICAgICBmb3IodmFyIGs9MDsgazxjbDsgKytrKSB7XG4gICAgICAgIGlmKChqID4+PiBrKSAmIDEpIHtcbiAgICAgICAgICBiLnB1c2goY1trXSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzdWx0LnB1c2goYilcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5vcm1hbGl6ZShyZXN1bHQpXG59XG5leHBvcnRzLmV4cGxvZGUgPSBleHBsb2RlXG5cbi8vRW51bWVyYXRlcyBhbGwgb2YgdGhlIG4tY2VsbHMgb2YgYSBjZWxsIGNvbXBsZXhcbmZ1bmN0aW9uIHNrZWxldG9uKGNlbGxzLCBuKSB7XG4gIGlmKG4gPCAwKSB7XG4gICAgcmV0dXJuIFtdXG4gIH1cbiAgdmFyIHJlc3VsdCA9IFtdXG4gICAgLCBrMCAgICAgPSAoMTw8KG4rMSkpLTFcbiAgZm9yKHZhciBpPTA7IGk8Y2VsbHMubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYyA9IGNlbGxzW2ldXG4gICAgZm9yKHZhciBrPWswOyBrPCgxPDxjLmxlbmd0aCk7IGs9Yml0cy5uZXh0Q29tYmluYXRpb24oaykpIHtcbiAgICAgIHZhciBiID0gbmV3IEFycmF5KG4rMSlcbiAgICAgICAgLCBsID0gMFxuICAgICAgZm9yKHZhciBqPTA7IGo8Yy5sZW5ndGg7ICsraikge1xuICAgICAgICBpZihrICYgKDE8PGopKSB7XG4gICAgICAgICAgYltsKytdID0gY1tqXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXN1bHQucHVzaChiKVxuICAgIH1cbiAgfVxuICByZXR1cm4gbm9ybWFsaXplKHJlc3VsdClcbn1cbmV4cG9ydHMuc2tlbGV0b24gPSBza2VsZXRvbjtcblxuLy9Db21wdXRlcyB0aGUgYm91bmRhcnkgb2YgYWxsIGNlbGxzLCBkb2VzIG5vdCByZW1vdmUgZHVwbGljYXRlc1xuZnVuY3Rpb24gYm91bmRhcnkoY2VsbHMpIHtcbiAgdmFyIHJlcyA9IFtdXG4gIGZvcih2YXIgaT0wLGlsPWNlbGxzLmxlbmd0aDsgaTxpbDsgKytpKSB7XG4gICAgdmFyIGMgPSBjZWxsc1tpXVxuICAgIGZvcih2YXIgaj0wLGNsPWMubGVuZ3RoOyBqPGNsOyArK2opIHtcbiAgICAgIHZhciBiID0gbmV3IEFycmF5KGMubGVuZ3RoLTEpXG4gICAgICBmb3IodmFyIGs9MCwgbD0wOyBrPGNsOyArK2spIHtcbiAgICAgICAgaWYoayAhPT0gaikge1xuICAgICAgICAgIGJbbCsrXSA9IGNba11cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzLnB1c2goYilcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5vcm1hbGl6ZShyZXMpXG59XG5leHBvcnRzLmJvdW5kYXJ5ID0gYm91bmRhcnk7XG5cbi8vQ29tcHV0ZXMgY29ubmVjdGVkIGNvbXBvbmVudHMgZm9yIGEgZGVuc2UgY2VsbCBjb21wbGV4XG5mdW5jdGlvbiBjb25uZWN0ZWRDb21wb25lbnRzX2RlbnNlKGNlbGxzLCB2ZXJ0ZXhfY291bnQpIHtcbiAgdmFyIGxhYmVscyA9IG5ldyBVbmlvbkZpbmQodmVydGV4X2NvdW50KVxuICBmb3IodmFyIGk9MDsgaTxjZWxscy5sZW5ndGg7ICsraSkge1xuICAgIHZhciBjID0gY2VsbHNbaV1cbiAgICBmb3IodmFyIGo9MDsgajxjLmxlbmd0aDsgKytqKSB7XG4gICAgICBmb3IodmFyIGs9aisxOyBrPGMubGVuZ3RoOyArK2spIHtcbiAgICAgICAgbGFiZWxzLmxpbmsoY1tqXSwgY1trXSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgdmFyIGNvbXBvbmVudHMgPSBbXVxuICAgICwgY29tcG9uZW50X2xhYmVscyA9IGxhYmVscy5yYW5rc1xuICBmb3IodmFyIGk9MDsgaTxjb21wb25lbnRfbGFiZWxzLmxlbmd0aDsgKytpKSB7XG4gICAgY29tcG9uZW50X2xhYmVsc1tpXSA9IC0xXG4gIH1cbiAgZm9yKHZhciBpPTA7IGk8Y2VsbHMubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgbCA9IGxhYmVscy5maW5kKGNlbGxzW2ldWzBdKVxuICAgIGlmKGNvbXBvbmVudF9sYWJlbHNbbF0gPCAwKSB7XG4gICAgICBjb21wb25lbnRfbGFiZWxzW2xdID0gY29tcG9uZW50cy5sZW5ndGhcbiAgICAgIGNvbXBvbmVudHMucHVzaChbY2VsbHNbaV0uc2xpY2UoMCldKVxuICAgIH0gZWxzZSB7XG4gICAgICBjb21wb25lbnRzW2NvbXBvbmVudF9sYWJlbHNbbF1dLnB1c2goY2VsbHNbaV0uc2xpY2UoMCkpXG4gICAgfVxuICB9XG4gIHJldHVybiBjb21wb25lbnRzXG59XG5cbi8vQ29tcHV0ZXMgY29ubmVjdGVkIGNvbXBvbmVudHMgZm9yIGEgc3BhcnNlIGdyYXBoXG5mdW5jdGlvbiBjb25uZWN0ZWRDb21wb25lbnRzX3NwYXJzZShjZWxscykge1xuICB2YXIgdmVydGljZXMgID0gdW5pcXVlKG5vcm1hbGl6ZShza2VsZXRvbihjZWxscywgMCkpKVxuICAgICwgbGFiZWxzICAgID0gbmV3IFVuaW9uRmluZCh2ZXJ0aWNlcy5sZW5ndGgpXG4gIGZvcih2YXIgaT0wOyBpPGNlbGxzLmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGMgPSBjZWxsc1tpXVxuICAgIGZvcih2YXIgaj0wOyBqPGMubGVuZ3RoOyArK2opIHtcbiAgICAgIHZhciB2aiA9IGZpbmRDZWxsKHZlcnRpY2VzLCBbY1tqXV0pXG4gICAgICBmb3IodmFyIGs9aisxOyBrPGMubGVuZ3RoOyArK2spIHtcbiAgICAgICAgbGFiZWxzLmxpbmsodmosIGZpbmRDZWxsKHZlcnRpY2VzLCBbY1trXV0pKVxuICAgICAgfVxuICAgIH1cbiAgfVxuICB2YXIgY29tcG9uZW50cyAgICAgICAgPSBbXVxuICAgICwgY29tcG9uZW50X2xhYmVscyAgPSBsYWJlbHMucmFua3NcbiAgZm9yKHZhciBpPTA7IGk8Y29tcG9uZW50X2xhYmVscy5sZW5ndGg7ICsraSkge1xuICAgIGNvbXBvbmVudF9sYWJlbHNbaV0gPSAtMVxuICB9XG4gIGZvcih2YXIgaT0wOyBpPGNlbGxzLmxlbmd0aDsgKytpKSB7XG4gICAgdmFyIGwgPSBsYWJlbHMuZmluZChmaW5kQ2VsbCh2ZXJ0aWNlcywgW2NlbGxzW2ldWzBdXSkpO1xuICAgIGlmKGNvbXBvbmVudF9sYWJlbHNbbF0gPCAwKSB7XG4gICAgICBjb21wb25lbnRfbGFiZWxzW2xdID0gY29tcG9uZW50cy5sZW5ndGhcbiAgICAgIGNvbXBvbmVudHMucHVzaChbY2VsbHNbaV0uc2xpY2UoMCldKVxuICAgIH0gZWxzZSB7XG4gICAgICBjb21wb25lbnRzW2NvbXBvbmVudF9sYWJlbHNbbF1dLnB1c2goY2VsbHNbaV0uc2xpY2UoMCkpXG4gICAgfVxuICB9XG4gIHJldHVybiBjb21wb25lbnRzXG59XG5cbi8vQ29tcHV0ZXMgY29ubmVjdGVkIGNvbXBvbmVudHMgZm9yIGEgY2VsbCBjb21wbGV4XG5mdW5jdGlvbiBjb25uZWN0ZWRDb21wb25lbnRzKGNlbGxzLCB2ZXJ0ZXhfY291bnQpIHtcbiAgaWYodmVydGV4X2NvdW50KSB7XG4gICAgcmV0dXJuIGNvbm5lY3RlZENvbXBvbmVudHNfZGVuc2UoY2VsbHMsIHZlcnRleF9jb3VudClcbiAgfVxuICByZXR1cm4gY29ubmVjdGVkQ29tcG9uZW50c19zcGFyc2UoY2VsbHMpXG59XG5leHBvcnRzLmNvbm5lY3RlZENvbXBvbmVudHMgPSBjb25uZWN0ZWRDb21wb25lbnRzXG4iLCIndXNlIHN0cmljdCdcblxubW9kdWxlLmV4cG9ydHMgPSBtb25vdG9uZUNvbnZleEh1bGwyRFxuXG52YXIgb3JpZW50ID0gcmVxdWlyZSgncm9idXN0LW9yaWVudGF0aW9uJylbM11cblxuZnVuY3Rpb24gbW9ub3RvbmVDb252ZXhIdWxsMkQocG9pbnRzKSB7XG4gIHZhciBuID0gcG9pbnRzLmxlbmd0aFxuXG4gIGlmKG4gPCAzKSB7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheShuKVxuICAgIGZvcih2YXIgaT0wOyBpPG47ICsraSkge1xuICAgICAgcmVzdWx0W2ldID0gaVxuICAgIH1cblxuICAgIGlmKG4gPT09IDIgJiZcbiAgICAgICBwb2ludHNbMF1bMF0gPT09IHBvaW50c1sxXVswXSAmJlxuICAgICAgIHBvaW50c1swXVsxXSA9PT0gcG9pbnRzWzFdWzFdKSB7XG4gICAgICByZXR1cm4gWzBdXG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgLy9Tb3J0IHBvaW50IGluZGljZXMgYWxvbmcgeC1heGlzXG4gIHZhciBzb3J0ZWQgPSBuZXcgQXJyYXkobilcbiAgZm9yKHZhciBpPTA7IGk8bjsgKytpKSB7XG4gICAgc29ydGVkW2ldID0gaVxuICB9XG4gIHNvcnRlZC5zb3J0KGZ1bmN0aW9uKGEsYikge1xuICAgIHZhciBkID0gcG9pbnRzW2FdWzBdLXBvaW50c1tiXVswXVxuICAgIGlmKGQpIHtcbiAgICAgIHJldHVybiBkXG4gICAgfVxuICAgIHJldHVybiBwb2ludHNbYV1bMV0gLSBwb2ludHNbYl1bMV1cbiAgfSlcblxuICAvL0NvbnN0cnVjdCB1cHBlciBhbmQgbG93ZXIgaHVsbHNcbiAgdmFyIGxvd2VyID0gW3NvcnRlZFswXSwgc29ydGVkWzFdXVxuICB2YXIgdXBwZXIgPSBbc29ydGVkWzBdLCBzb3J0ZWRbMV1dXG5cbiAgZm9yKHZhciBpPTI7IGk8bjsgKytpKSB7XG4gICAgdmFyIGlkeCA9IHNvcnRlZFtpXVxuICAgIHZhciBwICAgPSBwb2ludHNbaWR4XVxuXG4gICAgLy9JbnNlcnQgaW50byBsb3dlciBsaXN0XG4gICAgdmFyIG0gPSBsb3dlci5sZW5ndGhcbiAgICB3aGlsZShtID4gMSAmJiBvcmllbnQoXG4gICAgICAgIHBvaW50c1tsb3dlclttLTJdXSwgXG4gICAgICAgIHBvaW50c1tsb3dlclttLTFdXSwgXG4gICAgICAgIHApIDw9IDApIHtcbiAgICAgIG0gLT0gMVxuICAgICAgbG93ZXIucG9wKClcbiAgICB9XG4gICAgbG93ZXIucHVzaChpZHgpXG5cbiAgICAvL0luc2VydCBpbnRvIHVwcGVyIGxpc3RcbiAgICBtID0gdXBwZXIubGVuZ3RoXG4gICAgd2hpbGUobSA+IDEgJiYgb3JpZW50KFxuICAgICAgICBwb2ludHNbdXBwZXJbbS0yXV0sIFxuICAgICAgICBwb2ludHNbdXBwZXJbbS0xXV0sIFxuICAgICAgICBwKSA+PSAwKSB7XG4gICAgICBtIC09IDFcbiAgICAgIHVwcGVyLnBvcCgpXG4gICAgfVxuICAgIHVwcGVyLnB1c2goaWR4KVxuICB9XG5cbiAgLy9NZXJnZSBsaXN0cyB0b2dldGhlclxuICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KHVwcGVyLmxlbmd0aCArIGxvd2VyLmxlbmd0aCAtIDIpXG4gIHZhciBwdHIgICAgPSAwXG4gIGZvcih2YXIgaT0wLCBubD1sb3dlci5sZW5ndGg7IGk8bmw7ICsraSkge1xuICAgIHJlc3VsdFtwdHIrK10gPSBsb3dlcltpXVxuICB9XG4gIGZvcih2YXIgaj11cHBlci5sZW5ndGgtMjsgaj4wOyAtLWopIHtcbiAgICByZXN1bHRbcHRyKytdID0gdXBwZXJbal1cbiAgfVxuXG4gIC8vUmV0dXJuIHJlc3VsdFxuICByZXR1cm4gcmVzdWx0XG59IiwidmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYW5kIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgYW5kIGNhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiBwb2ludHMgdGhhdCBmYWxsIHdpdGhpbiB0aGUgc2V0IG9mIHBvbHlnb25zLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9jb3VudFxuICogQGNhdGVnb3J5IGFnZ3JlZ2F0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtTdHJpbmd9IGNvdW50RmllbGQgYSBmaWVsZCB0byBhcHBlbmQgdG8gdGhlIGF0dHJpYnV0ZXMgb2YgdGhlIFBvbHlnb24gZmVhdHVyZXMgcmVwcmVzZW50aW5nIFBvaW50IGNvdW50c1xuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgUG9seWdvbiBmZWF0dXJlcyB3aXRoIGBjb3VudEZpZWxkYCBhcHBlbmRlZFxuICogQGV4YW1wbGVcbiogdmFyIHBvbHlnb25zID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy0xMTIuMDcyMzkxLDQ2LjU4NjU5MV0sXG4gKiAgICAgICAgICAgWy0xMTIuMDcyMzkxLDQ2LjYxNzYxXSxcbiAqICAgICAgICAgICBbLTExMi4wMjgxMDIsNDYuNjE3NjFdLFxuICogICAgICAgICAgIFstMTEyLjAyODEwMiw0Ni41ODY1OTFdLFxuICogICAgICAgICAgIFstMTEyLjA3MjM5MSw0Ni41ODY1OTFdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstMTEyLjAyMzk4Myw0Ni41NzA0MjZdLFxuICogICAgICAgICAgIFstMTEyLjAyMzk4Myw0Ni42MTUwMTZdLFxuICogICAgICAgICAgIFstMTExLjk2NjEzMyw0Ni42MTUwMTZdLFxuICogICAgICAgICAgIFstMTExLjk2NjEzMyw0Ni41NzA0MjZdLFxuICogICAgICAgICAgIFstMTEyLjAyMzk4Myw0Ni41NzA0MjZdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstMTEyLjAzNzIsIDQ2LjYwODA1OF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy0xMTIuMDQ1OTU1LCA0Ni41OTYyNjRdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBjb3VudGVkID0gdHVyZi5jb3VudChwb2x5Z29ucywgcG9pbnRzLCAncHRfY291bnQnKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KGNvdW50ZWQuZmVhdHVyZXMpO1xuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiByZXN1bHRGZWF0dXJlc1xuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlGQywgcHRGQywgb3V0RmllbGQsIGRvbmUpe1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHBvbHlGQy5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBwb2x5ID0gcG9seUZDLmZlYXR1cmVzW2ldO1xuICAgIGlmKCFwb2x5LnByb3BlcnRpZXMpIHBvbHkucHJvcGVydGllcyA9IHt9O1xuICAgIHZhciB2YWx1ZXMgPSAwO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgcHRGQy5mZWF0dXJlcy5sZW5ndGg7IGorKykge1xuICAgICAgdmFyIHB0ID0gcHRGQy5mZWF0dXJlc1tqXTtcbiAgICAgIGlmIChpbnNpZGUocHQsIHBvbHkpKSB7XG4gICAgICAgIHZhbHVlcysrO1xuICAgICAgfVxuICAgIH1cbiAgICBwb2x5LnByb3BlcnRpZXNbb3V0RmllbGRdID0gdmFsdWVzO1xuICB9XG5cbiAgcmV0dXJuIHBvbHlGQztcbn07XG4iLCIvL2h0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSGF2ZXJzaW5lX2Zvcm11bGFcbi8vaHR0cDovL3d3dy5tb3ZhYmxlLXR5cGUuY28udWsvc2NyaXB0cy9sYXRsb25nLmh0bWxcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBQb2ludH0gZmVhdHVyZSBhbmQgY2FsY3VsYXRlcyB0aGUgbG9jYXRpb24gb2YgYSBkZXN0aW5hdGlvbiBwb2ludCBnaXZlbiBhIGRpc3RhbmNlIGluIGRlZ3JlZXMsIHJhZGlhbnMsIG1pbGVzLCBvciBraWxvbWV0ZXJzOyBhbmQgYmVhcmluZyBpbiBkZWdyZWVzLiBUaGlzIHVzZXMgdGhlIFtIYXZlcnNpbmUgZm9ybXVsYV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9IYXZlcnNpbmVfZm9ybXVsYSkgdG8gYWNjb3VudCBmb3IgZ2xvYmFsIGN1cnZhdHVyZS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZGVzdGluYXRpb25cbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtQb2ludH0gc3RhcnQgYSBQb2ludCBmZWF0dXJlIGF0IHRoZSBzdGFydGluZyBwb2ludFxuICogQHBhcmFtIHtOdW1iZXJ9IGRpc3RhbmNlIGRpc3RhbmNlIGZyb20gdGhlIHN0YXJ0aW5nIHBvaW50XG4gKiBAcGFyYW0ge051bWJlcn0gYmVhcmluZyByYW5naW5nIGZyb20gLTE4MCB0byAxODBcbiAqIEBwYXJhbSB7U3RyaW5nfSB1bml0cyBtaWxlcywga2lsb21ldGVycywgZGVncmVlcywgb3IgcmFkaWFuc1xuICogQHJldHVybnMge1BvaW50fSBhIFBvaW50IGZlYXR1cmUgYXQgdGhlIGRlc3RpbmF0aW9uXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvaW50ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJtYXJrZXItY29sb3JcIjogXCIjMGYwXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzUuMzQzLCAzOS45ODRdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgZGlzdGFuY2UgPSA1MDtcbiAqIHZhciBiZWFyaW5nID0gOTA7XG4gKiB2YXIgdW5pdHMgPSAnbWlsZXMnO1xuICpcbiAqIHZhciBkZXN0aW5hdGlvbiA9IHR1cmYuZGVzdGluYXRpb24ocG9pbnQsIGRpc3RhbmNlLCBiZWFyaW5nLCB1bml0cyk7XG4gKiBkZXN0aW5hdGlvbi5wcm9wZXJ0aWVzWydtYXJrZXItY29sb3InXSA9ICcjZjAwJztcbiAqXG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtwb2ludCwgZGVzdGluYXRpb25dXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChwb2ludDEsIGRpc3RhbmNlLCBiZWFyaW5nLCB1bml0cykge1xuICAgIHZhciBjb29yZGluYXRlczEgPSBwb2ludDEuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gICAgdmFyIGxvbmdpdHVkZTEgPSB0b1JhZChjb29yZGluYXRlczFbMF0pO1xuICAgIHZhciBsYXRpdHVkZTEgPSB0b1JhZChjb29yZGluYXRlczFbMV0pO1xuICAgIHZhciBiZWFyaW5nX3JhZCA9IHRvUmFkKGJlYXJpbmcpO1xuXG4gICAgdmFyIFIgPSAwO1xuICAgIHN3aXRjaCAodW5pdHMpIHtcbiAgICBjYXNlICdtaWxlcyc6XG4gICAgICAgIFIgPSAzOTYwO1xuICAgICAgICBicmVha1xuICAgIGNhc2UgJ2tpbG9tZXRlcnMnOlxuICAgICAgICBSID0gNjM3MztcbiAgICAgICAgYnJlYWtcbiAgICBjYXNlICdkZWdyZWVzJzpcbiAgICAgICAgUiA9IDU3LjI5NTc3OTU7XG4gICAgICAgIGJyZWFrXG4gICAgY2FzZSAncmFkaWFucyc6XG4gICAgICAgIFIgPSAxO1xuICAgICAgICBicmVha1xuICAgIH1cblxuICAgIHZhciBsYXRpdHVkZTIgPSBNYXRoLmFzaW4oTWF0aC5zaW4obGF0aXR1ZGUxKSAqIE1hdGguY29zKGRpc3RhbmNlIC8gUikgK1xuICAgICAgICBNYXRoLmNvcyhsYXRpdHVkZTEpICogTWF0aC5zaW4oZGlzdGFuY2UgLyBSKSAqIE1hdGguY29zKGJlYXJpbmdfcmFkKSk7XG4gICAgdmFyIGxvbmdpdHVkZTIgPSBsb25naXR1ZGUxICsgTWF0aC5hdGFuMihNYXRoLnNpbihiZWFyaW5nX3JhZCkgKiBNYXRoLnNpbihkaXN0YW5jZSAvIFIpICogTWF0aC5jb3MobGF0aXR1ZGUxKSxcbiAgICAgICAgTWF0aC5jb3MoZGlzdGFuY2UgLyBSKSAtIE1hdGguc2luKGxhdGl0dWRlMSkgKiBNYXRoLnNpbihsYXRpdHVkZTIpKTtcblxuICAgIHJldHVybiBwb2ludChbdG9EZWcobG9uZ2l0dWRlMiksIHRvRGVnKGxhdGl0dWRlMildKTtcbn07XG5cbmZ1bmN0aW9uIHRvUmFkKGRlZ3JlZSkge1xuICAgIHJldHVybiBkZWdyZWUgKiBNYXRoLlBJIC8gMTgwO1xufVxuXG5mdW5jdGlvbiB0b0RlZyhyYWQpIHtcbiAgICByZXR1cm4gcmFkICogMTgwIC8gTWF0aC5QSTtcbn1cbiIsInZhciBzcyA9IHJlcXVpcmUoJ3NpbXBsZS1zdGF0aXN0aWNzJyk7XG52YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcblxuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBzdGFuZGFyZCBkZXZpYXRpb24gdmFsdWUgb2YgYSBmaWVsZCBmb3IgcG9pbnRzIHdpdGhpbiBhIHNldCBvZiBwb2x5Z29ucy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZGV2aWF0aW9uXG4gKiBAY2F0ZWdvcnkgYWdncmVnYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAcGFyYW0ge1N0cmluZ30gaW5GaWVsZCB0aGUgZmllbGQgaW4gYHBvaW50c2AgZnJvbSB3aGljaCB0byBhZ2dyZWdhdGVcbiAqIEBwYXJhbSB7U3RyaW5nfSBvdXRGaWVsZCB0aGUgZmllbGQgdG8gYXBwZW5kIHRvIGBwb2x5Z29uc2AgcmVwcmVzZW50aW5nIGRldmlhdGlvblxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgUG9seWdvbiBmZWF0dXJlcyB3aXRoIGFwcGVuZGVkIGZpZWxkIHJlcHJlc2VudGluZyBkZXZpYXRpb25cbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9seWdvbnMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbLTk3LjgwNzE1OSwgMzAuMjcwMzM1XSxcbiAqICAgICAgICAgICBbLTk3LjgwNzE1OSwgMzAuMzY5OTEzXSxcbiAqICAgICAgICAgICBbLTk3LjYxMjgzOCwgMzAuMzY5OTEzXSxcbiAqICAgICAgICAgICBbLTk3LjYxMjgzOCwgMzAuMjcwMzM1XSxcbiAqICAgICAgICAgICBbLTk3LjgwNzE1OSwgMzAuMjcwMzM1XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgICAgICBbLTk3LjgyNTY5OCwgMzAuMTc1NDA1XSxcbiAqICAgICAgICAgICBbLTk3LjgyNTY5OCwgMzAuMjY0NDA0XSxcbiAqICAgICAgICAgICBbLTk3LjYzMDY5MSwgMzAuMjY0NDA0XSxcbiAqICAgICAgICAgICBbLTk3LjYzMDY5MSwgMzAuMTc1NDA1XSxcbiAqICAgICAgICAgICBbLTk3LjgyNTY5OCwgMzAuMTc1NDA1XVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA1MDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjcwOTY1NSwgMzAuMzExMjQ1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA0MDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3Ljc2NjY0NywgMzAuMzQ1MDI4XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA2MDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3Ljc2NTI3NCwgMzAuMjk0NjQ2XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA1MDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3Ljc1MzYwMSwgMzAuMjE2MzU1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjY2NzA4MywgMzAuMjA4MDQ3XVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgaW5GaWVsZCA9IFwicG9wdWxhdGlvblwiO1xuICogdmFyIG91dEZpZWxkID0gXCJwb3BfZGV2aWF0aW9uXCI7XG4gKlxuICogdmFyIGRldmlhdGVkID0gdHVyZi5kZXZpYXRpb24oXG4gKiAgIHBvbHlnb25zLCBwb2ludHMsIGluRmllbGQsIG91dEZpZWxkKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KFxuICogICBkZXZpYXRlZC5mZWF0dXJlcyk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9seUZDLCBwdEZDLCBpbkZpZWxkLCBvdXRGaWVsZCwgZG9uZSl7XG4gIHBvbHlGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHBvbHkpe1xuICAgIGlmKCFwb2x5LnByb3BlcnRpZXMpe1xuICAgICAgcG9seS5wcm9wZXJ0aWVzID0ge307XG4gICAgfVxuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICBwdEZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocHQpe1xuICAgICAgaWYgKGluc2lkZShwdCwgcG9seSkpIHtcbiAgICAgICAgdmFsdWVzLnB1c2gocHQucHJvcGVydGllc1tpbkZpZWxkXSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcG9seS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IHNzLnN0YW5kYXJkX2RldmlhdGlvbih2YWx1ZXMpO1xuICB9KVxuXG4gIHJldHVybiBwb2x5RkM7XG59XG4iLCIvKiBnbG9iYWwgbW9kdWxlICovXG4vLyAjIHNpbXBsZS1zdGF0aXN0aWNzXG4vL1xuLy8gQSBzaW1wbGUsIGxpdGVyYXRlIHN0YXRpc3RpY3Mgc3lzdGVtLiBUaGUgY29kZSBiZWxvdyB1c2VzIHRoZVxuLy8gW0phdmFzY3JpcHQgbW9kdWxlIHBhdHRlcm5dKGh0dHA6Ly93d3cuYWRlcXVhdGVseWdvb2QuY29tLzIwMTAvMy9KYXZhU2NyaXB0LU1vZHVsZS1QYXR0ZXJuLUluLURlcHRoKSxcbi8vIGV2ZW50dWFsbHkgYXNzaWduaW5nIGBzaW1wbGUtc3RhdGlzdGljc2AgdG8gYHNzYCBpbiBicm93c2VycyBvciB0aGVcbi8vIGBleHBvcnRzYCBvYmplY3QgZm9yIG5vZGUuanNcbihmdW5jdGlvbigpIHtcbiAgICB2YXIgc3MgPSB7fTtcblxuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAvLyBBc3NpZ24gdGhlIGBzc2Agb2JqZWN0IHRvIGV4cG9ydHMsIHNvIHRoYXQgeW91IGNhbiByZXF1aXJlXG4gICAgICAgIC8vIGl0IGluIFtub2RlLmpzXShodHRwOi8vbm9kZWpzLm9yZy8pXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gc3M7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCBpbiBhIGJyb3dzZXIsIHdlIGFzc2lnbiBgc3NgIHRvIHRoZSB3aW5kb3cgb2JqZWN0LFxuICAgICAgICAvLyBzbyB5b3UgY2FuIHNpbXBseSByZWZlciB0byBpdCBhcyBgc3NgLlxuICAgICAgICB0aGlzLnNzID0gc3M7XG4gICAgfVxuXG4gICAgLy8gIyBbTGluZWFyIFJlZ3Jlc3Npb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGluZWFyX3JlZ3Jlc3Npb24pXG4gICAgLy9cbiAgICAvLyBbU2ltcGxlIGxpbmVhciByZWdyZXNzaW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1NpbXBsZV9saW5lYXJfcmVncmVzc2lvbilcbiAgICAvLyBpcyBhIHNpbXBsZSB3YXkgdG8gZmluZCBhIGZpdHRlZCBsaW5lXG4gICAgLy8gYmV0d2VlbiBhIHNldCBvZiBjb29yZGluYXRlcy5cbiAgICBmdW5jdGlvbiBsaW5lYXJfcmVncmVzc2lvbigpIHtcbiAgICAgICAgdmFyIGxpbnJlZyA9IHt9LFxuICAgICAgICAgICAgZGF0YSA9IFtdO1xuXG4gICAgICAgIC8vIEFzc2lnbiBkYXRhIHRvIHRoZSBtb2RlbC4gRGF0YSBpcyBhc3N1bWVkIHRvIGJlIGFuIGFycmF5LlxuICAgICAgICBsaW5yZWcuZGF0YSA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICBkYXRhID0geC5zbGljZSgpO1xuICAgICAgICAgICAgcmV0dXJuIGxpbnJlZztcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHNsb3BlIGFuZCB5LWludGVyY2VwdCBvZiB0aGUgcmVncmVzc2lvbiBsaW5lXG4gICAgICAgIC8vIGJ5IGNhbGN1bGF0aW5nIHRoZSBsZWFzdCBzdW0gb2Ygc3F1YXJlc1xuICAgICAgICBsaW5yZWcubWIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtLCBiO1xuXG4gICAgICAgICAgICAvLyBTdG9yZSBkYXRhIGxlbmd0aCBpbiBhIGxvY2FsIHZhcmlhYmxlIHRvIHJlZHVjZVxuICAgICAgICAgICAgLy8gcmVwZWF0ZWQgb2JqZWN0IHByb3BlcnR5IGxvb2t1cHNcbiAgICAgICAgICAgIHZhciBkYXRhX2xlbmd0aCA9IGRhdGEubGVuZ3RoO1xuXG4gICAgICAgICAgICAvL2lmIHRoZXJlJ3Mgb25seSBvbmUgcG9pbnQsIGFyYml0cmFyaWx5IGNob29zZSBhIHNsb3BlIG9mIDBcbiAgICAgICAgICAgIC8vYW5kIGEgeS1pbnRlcmNlcHQgb2Ygd2hhdGV2ZXIgdGhlIHkgb2YgdGhlIGluaXRpYWwgcG9pbnQgaXNcbiAgICAgICAgICAgIGlmIChkYXRhX2xlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIG0gPSAwO1xuICAgICAgICAgICAgICAgIGIgPSBkYXRhWzBdWzFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIG91ciBzdW1zIGFuZCBzY29wZSB0aGUgYG1gIGFuZCBgYmBcbiAgICAgICAgICAgICAgICAvLyB2YXJpYWJsZXMgdGhhdCBkZWZpbmUgdGhlIGxpbmUuXG4gICAgICAgICAgICAgICAgdmFyIHN1bV94ID0gMCwgc3VtX3kgPSAwLFxuICAgICAgICAgICAgICAgICAgICBzdW1feHggPSAwLCBzdW1feHkgPSAwO1xuXG4gICAgICAgICAgICAgICAgLy8gVXNlIGxvY2FsIHZhcmlhYmxlcyB0byBncmFiIHBvaW50IHZhbHVlc1xuICAgICAgICAgICAgICAgIC8vIHdpdGggbWluaW1hbCBvYmplY3QgcHJvcGVydHkgbG9va3Vwc1xuICAgICAgICAgICAgICAgIHZhciBwb2ludCwgeCwgeTtcblxuICAgICAgICAgICAgICAgIC8vIEdhdGhlciB0aGUgc3VtIG9mIGFsbCB4IHZhbHVlcywgdGhlIHN1bSBvZiBhbGxcbiAgICAgICAgICAgICAgICAvLyB5IHZhbHVlcywgYW5kIHRoZSBzdW0gb2YgeF4yIGFuZCAoeCp5KSBmb3IgZWFjaFxuICAgICAgICAgICAgICAgIC8vIHZhbHVlLlxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gSW4gbWF0aCBub3RhdGlvbiwgdGhlc2Ugd291bGQgYmUgU1NfeCwgU1NfeSwgU1NfeHgsIGFuZCBTU194eVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YV9sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBwb2ludCA9IGRhdGFbaV07XG4gICAgICAgICAgICAgICAgICAgIHggPSBwb2ludFswXTtcbiAgICAgICAgICAgICAgICAgICAgeSA9IHBvaW50WzFdO1xuXG4gICAgICAgICAgICAgICAgICAgIHN1bV94ICs9IHg7XG4gICAgICAgICAgICAgICAgICAgIHN1bV95ICs9IHk7XG5cbiAgICAgICAgICAgICAgICAgICAgc3VtX3h4ICs9IHggKiB4O1xuICAgICAgICAgICAgICAgICAgICBzdW1feHkgKz0geCAqIHk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gYG1gIGlzIHRoZSBzbG9wZSBvZiB0aGUgcmVncmVzc2lvbiBsaW5lXG4gICAgICAgICAgICAgICAgbSA9ICgoZGF0YV9sZW5ndGggKiBzdW1feHkpIC0gKHN1bV94ICogc3VtX3kpKSAvXG4gICAgICAgICAgICAgICAgICAgICgoZGF0YV9sZW5ndGggKiBzdW1feHgpIC0gKHN1bV94ICogc3VtX3gpKTtcblxuICAgICAgICAgICAgICAgIC8vIGBiYCBpcyB0aGUgeS1pbnRlcmNlcHQgb2YgdGhlIGxpbmUuXG4gICAgICAgICAgICAgICAgYiA9IChzdW1feSAvIGRhdGFfbGVuZ3RoKSAtICgobSAqIHN1bV94KSAvIGRhdGFfbGVuZ3RoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUmV0dXJuIGJvdGggdmFsdWVzIGFzIGFuIG9iamVjdC5cbiAgICAgICAgICAgIHJldHVybiB7IG06IG0sIGI6IGIgfTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBhIHNob3J0Y3V0IGZvciBzaW1wbHkgZ2V0dGluZyB0aGUgc2xvcGUgb2YgdGhlIHJlZ3Jlc3Npb24gbGluZVxuICAgICAgICBsaW5yZWcubSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpbnJlZy5tYigpLm07XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYSBzaG9ydGN1dCBmb3Igc2ltcGx5IGdldHRpbmcgdGhlIHktaW50ZXJjZXB0IG9mIHRoZSByZWdyZXNzaW9uXG4gICAgICAgIC8vIGxpbmUuXG4gICAgICAgIGxpbnJlZy5iID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbGlucmVnLm1iKCkuYjtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyAjIyBGaXR0aW5nIFRoZSBSZWdyZXNzaW9uIExpbmVcbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhpcyBpcyBjYWxsZWQgYWZ0ZXIgYC5kYXRhKClgIGFuZCByZXR1cm5zIHRoZVxuICAgICAgICAvLyBlcXVhdGlvbiBgeSA9IGYoeClgIHdoaWNoIGdpdmVzIHRoZSBwb3NpdGlvblxuICAgICAgICAvLyBvZiB0aGUgcmVncmVzc2lvbiBsaW5lIGF0IGVhY2ggcG9pbnQgaW4gYHhgLlxuICAgICAgICBsaW5yZWcubGluZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIHNsb3BlLCBgbWAsIGFuZCB5LWludGVyY2VwdCwgYGJgLCBvZiB0aGUgbGluZS5cbiAgICAgICAgICAgIHZhciBtYiA9IGxpbnJlZy5tYigpLFxuICAgICAgICAgICAgICAgIG0gPSBtYi5tLFxuICAgICAgICAgICAgICAgIGIgPSBtYi5iO1xuXG4gICAgICAgICAgICAvLyBSZXR1cm4gYSBmdW5jdGlvbiB0aGF0IGNvbXB1dGVzIGEgYHlgIHZhbHVlIGZvciBlYWNoXG4gICAgICAgICAgICAvLyB4IHZhbHVlIGl0IGlzIGdpdmVuLCBiYXNlZCBvbiB0aGUgdmFsdWVzIG9mIGBiYCBhbmQgYGFgXG4gICAgICAgICAgICAvLyB0aGF0IHdlIGp1c3QgY29tcHV0ZWQuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiICsgKG0gKiB4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGxpbnJlZztcbiAgICB9XG5cbiAgICAvLyAjIFtSIFNxdWFyZWRdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29lZmZpY2llbnRfb2ZfZGV0ZXJtaW5hdGlvbilcbiAgICAvL1xuICAgIC8vIFRoZSByLXNxdWFyZWQgdmFsdWUgb2YgZGF0YSBjb21wYXJlZCB3aXRoIGEgZnVuY3Rpb24gYGZgXG4gICAgLy8gaXMgdGhlIHN1bSBvZiB0aGUgc3F1YXJlZCBkaWZmZXJlbmNlcyBiZXR3ZWVuIHRoZSBwcmVkaWN0aW9uXG4gICAgLy8gYW5kIHRoZSBhY3R1YWwgdmFsdWUuXG4gICAgZnVuY3Rpb24gcl9zcXVhcmVkKGRhdGEsIGYpIHtcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoIDwgMikgcmV0dXJuIDE7XG5cbiAgICAgICAgLy8gQ29tcHV0ZSB0aGUgYXZlcmFnZSB5IHZhbHVlIGZvciB0aGUgYWN0dWFsXG4gICAgICAgIC8vIGRhdGEgc2V0IGluIG9yZGVyIHRvIGNvbXB1dGUgdGhlXG4gICAgICAgIC8vIF90b3RhbCBzdW0gb2Ygc3F1YXJlc19cbiAgICAgICAgdmFyIHN1bSA9IDAsIGF2ZXJhZ2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc3VtICs9IGRhdGFbaV1bMV07XG4gICAgICAgIH1cbiAgICAgICAgYXZlcmFnZSA9IHN1bSAvIGRhdGEubGVuZ3RoO1xuXG4gICAgICAgIC8vIENvbXB1dGUgdGhlIHRvdGFsIHN1bSBvZiBzcXVhcmVzIC0gdGhlXG4gICAgICAgIC8vIHNxdWFyZWQgZGlmZmVyZW5jZSBiZXR3ZWVuIGVhY2ggcG9pbnRcbiAgICAgICAgLy8gYW5kIHRoZSBhdmVyYWdlIG9mIGFsbCBwb2ludHMuXG4gICAgICAgIHZhciBzdW1fb2Zfc3F1YXJlcyA9IDA7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGF0YS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgc3VtX29mX3NxdWFyZXMgKz0gTWF0aC5wb3coYXZlcmFnZSAtIGRhdGFbal1bMV0sIDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmluYWxseSBlc3RpbWF0ZSB0aGUgZXJyb3I6IHRoZSBzcXVhcmVkXG4gICAgICAgIC8vIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgZXN0aW1hdGUgYW5kIHRoZSBhY3R1YWwgZGF0YVxuICAgICAgICAvLyB2YWx1ZSBhdCBlYWNoIHBvaW50LlxuICAgICAgICB2YXIgZXJyID0gMDtcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBkYXRhLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICBlcnIgKz0gTWF0aC5wb3coZGF0YVtrXVsxXSAtIGYoZGF0YVtrXVswXSksIDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQXMgdGhlIGVycm9yIGdyb3dzIGxhcmdlciwgaXRzIHJhdGlvIHRvIHRoZVxuICAgICAgICAvLyBzdW0gb2Ygc3F1YXJlcyBpbmNyZWFzZXMgYW5kIHRoZSByIHNxdWFyZWRcbiAgICAgICAgLy8gdmFsdWUgZ3Jvd3MgbG93ZXIuXG4gICAgICAgIHJldHVybiAxIC0gKGVyciAvIHN1bV9vZl9zcXVhcmVzKTtcbiAgICB9XG5cblxuICAgIC8vICMgW0JheWVzaWFuIENsYXNzaWZpZXJdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTmFpdmVfQmF5ZXNfY2xhc3NpZmllcilcbiAgICAvL1xuICAgIC8vIFRoaXMgaXMgYSBuYcOvdmUgYmF5ZXNpYW4gY2xhc3NpZmllciB0aGF0IHRha2VzXG4gICAgLy8gc2luZ2x5LW5lc3RlZCBvYmplY3RzLlxuICAgIGZ1bmN0aW9uIGJheWVzaWFuKCkge1xuICAgICAgICAvLyBUaGUgYGJheWVzX21vZGVsYCBvYmplY3QgaXMgd2hhdCB3aWxsIGJlIGV4cG9zZWRcbiAgICAgICAgLy8gYnkgdGhpcyBjbG9zdXJlLCB3aXRoIGFsbCBvZiBpdHMgZXh0ZW5kZWQgbWV0aG9kcywgYW5kIHdpbGxcbiAgICAgICAgLy8gaGF2ZSBhY2Nlc3MgdG8gYWxsIHNjb3BlIHZhcmlhYmxlcywgbGlrZSBgdG90YWxfY291bnRgLlxuICAgICAgICB2YXIgYmF5ZXNfbW9kZWwgPSB7fSxcbiAgICAgICAgICAgIC8vIFRoZSBudW1iZXIgb2YgaXRlbXMgdGhhdCBhcmUgY3VycmVudGx5XG4gICAgICAgICAgICAvLyBjbGFzc2lmaWVkIGluIHRoZSBtb2RlbFxuICAgICAgICAgICAgdG90YWxfY291bnQgPSAwLFxuICAgICAgICAgICAgLy8gRXZlcnkgaXRlbSBjbGFzc2lmaWVkIGluIHRoZSBtb2RlbFxuICAgICAgICAgICAgZGF0YSA9IHt9O1xuXG4gICAgICAgIC8vICMjIFRyYWluXG4gICAgICAgIC8vIFRyYWluIHRoZSBjbGFzc2lmaWVyIHdpdGggYSBuZXcgaXRlbSwgd2hpY2ggaGFzIGEgc2luZ2xlXG4gICAgICAgIC8vIGRpbWVuc2lvbiBvZiBKYXZhc2NyaXB0IGxpdGVyYWwga2V5cyBhbmQgdmFsdWVzLlxuICAgICAgICBiYXllc19tb2RlbC50cmFpbiA9IGZ1bmN0aW9uKGl0ZW0sIGNhdGVnb3J5KSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgZGF0YSBvYmplY3QgZG9lc24ndCBoYXZlIGFueSB2YWx1ZXNcbiAgICAgICAgICAgIC8vIGZvciB0aGlzIGNhdGVnb3J5LCBjcmVhdGUgYSBuZXcgb2JqZWN0IGZvciBpdC5cbiAgICAgICAgICAgIGlmICghZGF0YVtjYXRlZ29yeV0pIGRhdGFbY2F0ZWdvcnldID0ge307XG5cbiAgICAgICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBlYWNoIGtleSBpbiB0aGUgaXRlbS5cbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciB2ID0gaXRlbVtrXTtcbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBuZXN0ZWQgb2JqZWN0IGBkYXRhW2NhdGVnb3J5XVtrXVtpdGVtW2tdXWBcbiAgICAgICAgICAgICAgICAvLyB3aXRoIGFuIG9iamVjdCBvZiBrZXlzIHRoYXQgZXF1YWwgMC5cbiAgICAgICAgICAgICAgICBpZiAoZGF0YVtjYXRlZ29yeV1ba10gPT09IHVuZGVmaW5lZCkgZGF0YVtjYXRlZ29yeV1ba10gPSB7fTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVtjYXRlZ29yeV1ba11bdl0gPT09IHVuZGVmaW5lZCkgZGF0YVtjYXRlZ29yeV1ba11bdl0gPSAwO1xuXG4gICAgICAgICAgICAgICAgLy8gQW5kIGluY3JlbWVudCB0aGUga2V5IGZvciB0aGlzIGtleS92YWx1ZSBjb21iaW5hdGlvbi5cbiAgICAgICAgICAgICAgICBkYXRhW2NhdGVnb3J5XVtrXVtpdGVtW2tdXSsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSW5jcmVtZW50IHRoZSBudW1iZXIgb2YgaXRlbXMgY2xhc3NpZmllZFxuICAgICAgICAgICAgdG90YWxfY291bnQrKztcbiAgICAgICAgfTtcblxuICAgICAgICAvLyAjIyBTY29yZVxuICAgICAgICAvLyBHZW5lcmF0ZSBhIHNjb3JlIG9mIGhvdyB3ZWxsIHRoaXMgaXRlbSBtYXRjaGVzIGFsbFxuICAgICAgICAvLyBwb3NzaWJsZSBjYXRlZ29yaWVzIGJhc2VkIG9uIGl0cyBhdHRyaWJ1dGVzXG4gICAgICAgIGJheWVzX21vZGVsLnNjb3JlID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSBhbiBlbXB0eSBhcnJheSBvZiBvZGRzIHBlciBjYXRlZ29yeS5cbiAgICAgICAgICAgIHZhciBvZGRzID0ge30sIGNhdGVnb3J5O1xuICAgICAgICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIGVhY2gga2V5IGluIHRoZSBpdGVtLFxuICAgICAgICAgICAgLy8gdGhlbiBpdGVyYXRlIHRocm91Z2ggZWFjaCBjYXRlZ29yeSB0aGF0IGhhcyBiZWVuIHVzZWRcbiAgICAgICAgICAgIC8vIGluIHByZXZpb3VzIGNhbGxzIHRvIGAudHJhaW4oKWBcbiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciB2ID0gaXRlbVtrXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNhdGVnb3J5IGluIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGFuIGVtcHR5IG9iamVjdCBmb3Igc3RvcmluZyBrZXkgLSB2YWx1ZSBjb21iaW5hdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHRoaXMgY2F0ZWdvcnkuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvZGRzW2NhdGVnb3J5XSA9PT0gdW5kZWZpbmVkKSBvZGRzW2NhdGVnb3J5XSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgaXRlbSBkb2Vzbid0IGV2ZW4gaGF2ZSBhIHByb3BlcnR5LCBpdCBjb3VudHMgZm9yIG5vdGhpbmcsXG4gICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBpZiBpdCBkb2VzIGhhdmUgdGhlIHByb3BlcnR5IHRoYXQgd2UncmUgbG9va2luZyBmb3IgZnJvbVxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgaXRlbSB0byBjYXRlZ29yaXplLCBpdCBjb3VudHMgYmFzZWQgb24gaG93IHBvcHVsYXIgaXQgaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gdmVyc3VzIHRoZSB3aG9sZSBwb3B1bGF0aW9uLlxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtjYXRlZ29yeV1ba10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9kZHNbY2F0ZWdvcnldW2sgKyAnXycgKyB2XSA9IChkYXRhW2NhdGVnb3J5XVtrXVt2XSB8fCAwKSAvIHRvdGFsX2NvdW50O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Rkc1tjYXRlZ29yeV1bayArICdfJyArIHZdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2V0IHVwIGEgbmV3IG9iamVjdCB0aGF0IHdpbGwgY29udGFpbiBzdW1zIG9mIHRoZXNlIG9kZHMgYnkgY2F0ZWdvcnlcbiAgICAgICAgICAgIHZhciBvZGRzX3N1bXMgPSB7fTtcblxuICAgICAgICAgICAgZm9yIChjYXRlZ29yeSBpbiBvZGRzKSB7XG4gICAgICAgICAgICAgICAgLy8gVGFsbHkgYWxsIG9mIHRoZSBvZGRzIGZvciBlYWNoIGNhdGVnb3J5LWNvbWJpbmF0aW9uIHBhaXIgLVxuICAgICAgICAgICAgICAgIC8vIHRoZSBub24tZXhpc3RlbmNlIG9mIGEgY2F0ZWdvcnkgZG9lcyBub3QgYWRkIGFueXRoaW5nIHRvIHRoZVxuICAgICAgICAgICAgICAgIC8vIHNjb3JlLlxuICAgICAgICAgICAgICAgIGZvciAodmFyIGNvbWJpbmF0aW9uIGluIG9kZHNbY2F0ZWdvcnldKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvZGRzX3N1bXNbY2F0ZWdvcnldID09PSB1bmRlZmluZWQpIG9kZHNfc3Vtc1tjYXRlZ29yeV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBvZGRzX3N1bXNbY2F0ZWdvcnldICs9IG9kZHNbY2F0ZWdvcnldW2NvbWJpbmF0aW9uXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBvZGRzX3N1bXM7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gUmV0dXJuIHRoZSBjb21wbGV0ZWQgbW9kZWwuXG4gICAgICAgIHJldHVybiBiYXllc19tb2RlbDtcbiAgICB9XG5cbiAgICAvLyAjIHN1bVxuICAgIC8vXG4gICAgLy8gaXMgc2ltcGx5IHRoZSByZXN1bHQgb2YgYWRkaW5nIGFsbCBudW1iZXJzXG4gICAgLy8gdG9nZXRoZXIsIHN0YXJ0aW5nIGZyb20gemVyby5cbiAgICAvL1xuICAgIC8vIFRoaXMgcnVucyBvbiBgTyhuKWAsIGxpbmVhciB0aW1lIGluIHJlc3BlY3QgdG8gdGhlIGFycmF5XG4gICAgZnVuY3Rpb24gc3VtKHgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YWx1ZSArPSB4W2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICAvLyAjIG1lYW5cbiAgICAvL1xuICAgIC8vIGlzIHRoZSBzdW0gb3ZlciB0aGUgbnVtYmVyIG9mIHZhbHVlc1xuICAgIC8vXG4gICAgLy8gVGhpcyBydW5zIG9uIGBPKG4pYCwgbGluZWFyIHRpbWUgaW4gcmVzcGVjdCB0byB0aGUgYXJyYXlcbiAgICBmdW5jdGlvbiBtZWFuKHgpIHtcbiAgICAgICAgLy8gVGhlIG1lYW4gb2Ygbm8gbnVtYmVycyBpcyBudWxsXG4gICAgICAgIGlmICh4Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgcmV0dXJuIHN1bSh4KSAvIHgubGVuZ3RoO1xuICAgIH1cblxuICAgIC8vICMgZ2VvbWV0cmljIG1lYW5cbiAgICAvL1xuICAgIC8vIGEgbWVhbiBmdW5jdGlvbiB0aGF0IGlzIG1vcmUgdXNlZnVsIGZvciBudW1iZXJzIGluIGRpZmZlcmVudFxuICAgIC8vIHJhbmdlcy5cbiAgICAvL1xuICAgIC8vIHRoaXMgaXMgdGhlIG50aCByb290IG9mIHRoZSBpbnB1dCBudW1iZXJzIG11bHRpcGxpZWQgYnkgZWFjaCBvdGhlclxuICAgIC8vXG4gICAgLy8gVGhpcyBydW5zIG9uIGBPKG4pYCwgbGluZWFyIHRpbWUgaW4gcmVzcGVjdCB0byB0aGUgYXJyYXlcbiAgICBmdW5jdGlvbiBnZW9tZXRyaWNfbWVhbih4KSB7XG4gICAgICAgIC8vIFRoZSBtZWFuIG9mIG5vIG51bWJlcnMgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIC8vIHRoZSBzdGFydGluZyB2YWx1ZS5cbiAgICAgICAgdmFyIHZhbHVlID0gMTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIHRoZSBnZW9tZXRyaWMgbWVhbiBpcyBvbmx5IHZhbGlkIGZvciBwb3NpdGl2ZSBudW1iZXJzXG4gICAgICAgICAgICBpZiAoeFtpXSA8PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgLy8gcmVwZWF0ZWRseSBtdWx0aXBseSB0aGUgdmFsdWUgYnkgZWFjaCBudW1iZXJcbiAgICAgICAgICAgIHZhbHVlICo9IHhbaV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gTWF0aC5wb3codmFsdWUsIDEgLyB4Lmxlbmd0aCk7XG4gICAgfVxuXG5cbiAgICAvLyAjIGhhcm1vbmljIG1lYW5cbiAgICAvL1xuICAgIC8vIGEgbWVhbiBmdW5jdGlvbiB0eXBpY2FsbHkgdXNlZCB0byBmaW5kIHRoZSBhdmVyYWdlIG9mIHJhdGVzXG4gICAgLy9cbiAgICAvLyB0aGlzIGlzIHRoZSByZWNpcHJvY2FsIG9mIHRoZSBhcml0aG1ldGljIG1lYW4gb2YgdGhlIHJlY2lwcm9jYWxzXG4gICAgLy8gb2YgdGhlIGlucHV0IG51bWJlcnNcbiAgICAvL1xuICAgIC8vIFRoaXMgcnVucyBvbiBgTyhuKWAsIGxpbmVhciB0aW1lIGluIHJlc3BlY3QgdG8gdGhlIGFycmF5XG4gICAgZnVuY3Rpb24gaGFybW9uaWNfbWVhbih4KSB7XG4gICAgICAgIC8vIFRoZSBtZWFuIG9mIG5vIG51bWJlcnMgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIHZhciByZWNpcHJvY2FsX3N1bSA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyB0aGUgaGFybW9uaWMgbWVhbiBpcyBvbmx5IHZhbGlkIGZvciBwb3NpdGl2ZSBudW1iZXJzXG4gICAgICAgICAgICBpZiAoeFtpXSA8PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICAgICAgcmVjaXByb2NhbF9zdW0gKz0gMSAvIHhbaV07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkaXZpZGUgbiBieSB0aGUgdGhlIHJlY2lwcm9jYWwgc3VtXG4gICAgICAgIHJldHVybiB4Lmxlbmd0aCAvIHJlY2lwcm9jYWxfc3VtO1xuICAgIH1cblxuICAgIC8vIHJvb3QgbWVhbiBzcXVhcmUgKFJNUylcbiAgICAvL1xuICAgIC8vIGEgbWVhbiBmdW5jdGlvbiB1c2VkIGFzIGEgbWVhc3VyZSBvZiB0aGUgbWFnbml0dWRlIG9mIGEgc2V0XG4gICAgLy8gb2YgbnVtYmVycywgcmVnYXJkbGVzcyBvZiB0aGVpciBzaWduXG4gICAgLy9cbiAgICAvLyB0aGlzIGlzIHRoZSBzcXVhcmUgcm9vdCBvZiB0aGUgbWVhbiBvZiB0aGUgc3F1YXJlcyBvZiB0aGUgXG4gICAgLy8gaW5wdXQgbnVtYmVyc1xuICAgIC8vXG4gICAgLy8gVGhpcyBydW5zIG9uIGBPKG4pYCwgbGluZWFyIHRpbWUgaW4gcmVzcGVjdCB0byB0aGUgYXJyYXlcbiAgICBmdW5jdGlvbiByb290X21lYW5fc3F1YXJlKHgpIHtcbiAgICAgICAgaWYgKHgubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB2YXIgc3VtX29mX3NxdWFyZXMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHN1bV9vZl9zcXVhcmVzICs9IE1hdGgucG93KHhbaV0sIDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIE1hdGguc3FydChzdW1fb2Zfc3F1YXJlcyAvIHgubGVuZ3RoKTtcbiAgICB9XG5cbiAgICAvLyAjIG1pblxuICAgIC8vXG4gICAgLy8gVGhpcyBpcyBzaW1wbHkgdGhlIG1pbmltdW0gbnVtYmVyIGluIHRoZSBzZXQuXG4gICAgLy9cbiAgICAvLyBUaGlzIHJ1bnMgb24gYE8obilgLCBsaW5lYXIgdGltZSBpbiByZXNwZWN0IHRvIHRoZSBhcnJheVxuICAgIGZ1bmN0aW9uIG1pbih4KSB7XG4gICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyBPbiB0aGUgZmlyc3QgaXRlcmF0aW9uIG9mIHRoaXMgbG9vcCwgbWluIGlzXG4gICAgICAgICAgICAvLyB1bmRlZmluZWQgYW5kIGlzIHRodXMgbWFkZSB0aGUgbWluaW11bSBlbGVtZW50IGluIHRoZSBhcnJheVxuICAgICAgICAgICAgaWYgKHhbaV0gPCB2YWx1ZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IHhbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8vICMgbWF4XG4gICAgLy9cbiAgICAvLyBUaGlzIGlzIHNpbXBseSB0aGUgbWF4aW11bSBudW1iZXIgaW4gdGhlIHNldC5cbiAgICAvL1xuICAgIC8vIFRoaXMgcnVucyBvbiBgTyhuKWAsIGxpbmVhciB0aW1lIGluIHJlc3BlY3QgdG8gdGhlIGFycmF5XG4gICAgZnVuY3Rpb24gbWF4KHgpIHtcbiAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIE9uIHRoZSBmaXJzdCBpdGVyYXRpb24gb2YgdGhpcyBsb29wLCBtYXggaXNcbiAgICAgICAgICAgIC8vIHVuZGVmaW5lZCBhbmQgaXMgdGh1cyBtYWRlIHRoZSBtYXhpbXVtIGVsZW1lbnQgaW4gdGhlIGFycmF5XG4gICAgICAgICAgICBpZiAoeFtpXSA+IHZhbHVlIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0geFtpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gIyBbdmFyaWFuY2VdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVmFyaWFuY2UpXG4gICAgLy9cbiAgICAvLyBpcyB0aGUgc3VtIG9mIHNxdWFyZWQgZGV2aWF0aW9ucyBmcm9tIHRoZSBtZWFuXG4gICAgLy9cbiAgICAvLyBkZXBlbmRzIG9uIGBtZWFuKClgXG4gICAgZnVuY3Rpb24gdmFyaWFuY2UoeCkge1xuICAgICAgICAvLyBUaGUgdmFyaWFuY2Ugb2Ygbm8gbnVtYmVycyBpcyBudWxsXG4gICAgICAgIGlmICh4Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgdmFyIG1lYW5fdmFsdWUgPSBtZWFuKHgpLFxuICAgICAgICAgICAgZGV2aWF0aW9ucyA9IFtdO1xuXG4gICAgICAgIC8vIE1ha2UgYSBsaXN0IG9mIHNxdWFyZWQgZGV2aWF0aW9ucyBmcm9tIHRoZSBtZWFuLlxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRldmlhdGlvbnMucHVzaChNYXRoLnBvdyh4W2ldIC0gbWVhbl92YWx1ZSwgMikpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmluZCB0aGUgbWVhbiB2YWx1ZSBvZiB0aGF0IGxpc3RcbiAgICAgICAgcmV0dXJuIG1lYW4oZGV2aWF0aW9ucyk7XG4gICAgfVxuXG4gICAgLy8gIyBbc3RhbmRhcmQgZGV2aWF0aW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1N0YW5kYXJkX2RldmlhdGlvbilcbiAgICAvL1xuICAgIC8vIGlzIGp1c3QgdGhlIHNxdWFyZSByb290IG9mIHRoZSB2YXJpYW5jZS5cbiAgICAvL1xuICAgIC8vIGRlcGVuZHMgb24gYHZhcmlhbmNlKClgXG4gICAgZnVuY3Rpb24gc3RhbmRhcmRfZGV2aWF0aW9uKHgpIHtcbiAgICAgICAgLy8gVGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiBubyBudW1iZXJzIGlzIG51bGxcbiAgICAgICAgaWYgKHgubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHZhcmlhbmNlKHgpKTtcbiAgICB9XG5cbiAgICAvLyBUaGUgc3VtIG9mIGRldmlhdGlvbnMgdG8gdGhlIE50aCBwb3dlci5cbiAgICAvLyBXaGVuIG49MiBpdCdzIHRoZSBzdW0gb2Ygc3F1YXJlZCBkZXZpYXRpb25zLlxuICAgIC8vIFdoZW4gbj0zIGl0J3MgdGhlIHN1bSBvZiBjdWJlZCBkZXZpYXRpb25zLlxuICAgIC8vXG4gICAgLy8gZGVwZW5kcyBvbiBgbWVhbigpYFxuICAgIGZ1bmN0aW9uIHN1bV9udGhfcG93ZXJfZGV2aWF0aW9ucyh4LCBuKSB7XG4gICAgICAgIHZhciBtZWFuX3ZhbHVlID0gbWVhbih4KSxcbiAgICAgICAgICAgIHN1bSA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdW0gKz0gTWF0aC5wb3coeFtpXSAtIG1lYW5fdmFsdWUsIG4pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1bTtcbiAgICB9XG5cbiAgICAvLyAjIFt2YXJpYW5jZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9WYXJpYW5jZSlcbiAgICAvL1xuICAgIC8vIGlzIHRoZSBzdW0gb2Ygc3F1YXJlZCBkZXZpYXRpb25zIGZyb20gdGhlIG1lYW5cbiAgICAvL1xuICAgIC8vIGRlcGVuZHMgb24gYHN1bV9udGhfcG93ZXJfZGV2aWF0aW9uc2BcbiAgICBmdW5jdGlvbiBzYW1wbGVfdmFyaWFuY2UoeCkge1xuICAgICAgICAvLyBUaGUgdmFyaWFuY2Ugb2Ygbm8gbnVtYmVycyBpcyBudWxsXG4gICAgICAgIGlmICh4Lmxlbmd0aCA8PSAxKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB2YXIgc3VtX3NxdWFyZWRfZGV2aWF0aW9uc192YWx1ZSA9IHN1bV9udGhfcG93ZXJfZGV2aWF0aW9ucyh4LCAyKTtcblxuICAgICAgICAvLyBGaW5kIHRoZSBtZWFuIHZhbHVlIG9mIHRoYXQgbGlzdFxuICAgICAgICByZXR1cm4gc3VtX3NxdWFyZWRfZGV2aWF0aW9uc192YWx1ZSAvICh4Lmxlbmd0aCAtIDEpO1xuICAgIH1cblxuICAgIC8vICMgW3N0YW5kYXJkIGRldmlhdGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TdGFuZGFyZF9kZXZpYXRpb24pXG4gICAgLy9cbiAgICAvLyBpcyBqdXN0IHRoZSBzcXVhcmUgcm9vdCBvZiB0aGUgdmFyaWFuY2UuXG4gICAgLy9cbiAgICAvLyBkZXBlbmRzIG9uIGBzYW1wbGVfdmFyaWFuY2UoKWBcbiAgICBmdW5jdGlvbiBzYW1wbGVfc3RhbmRhcmRfZGV2aWF0aW9uKHgpIHtcbiAgICAgICAgLy8gVGhlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiBubyBudW1iZXJzIGlzIG51bGxcbiAgICAgICAgaWYgKHgubGVuZ3RoIDw9IDEpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoc2FtcGxlX3ZhcmlhbmNlKHgpKTtcbiAgICB9XG5cbiAgICAvLyAjIFtjb3ZhcmlhbmNlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvdmFyaWFuY2UpXG4gICAgLy9cbiAgICAvLyBzYW1wbGUgY292YXJpYW5jZSBvZiB0d28gZGF0YXNldHM6XG4gICAgLy8gaG93IG11Y2ggZG8gdGhlIHR3byBkYXRhc2V0cyBtb3ZlIHRvZ2V0aGVyP1xuICAgIC8vIHggYW5kIHkgYXJlIHR3byBkYXRhc2V0cywgcmVwcmVzZW50ZWQgYXMgYXJyYXlzIG9mIG51bWJlcnMuXG4gICAgLy9cbiAgICAvLyBkZXBlbmRzIG9uIGBtZWFuKClgXG4gICAgZnVuY3Rpb24gc2FtcGxlX2NvdmFyaWFuY2UoeCwgeSkge1xuXG4gICAgICAgIC8vIFRoZSB0d28gZGF0YXNldHMgbXVzdCBoYXZlIHRoZSBzYW1lIGxlbmd0aCB3aGljaCBtdXN0IGJlIG1vcmUgdGhhbiAxXG4gICAgICAgIGlmICh4Lmxlbmd0aCA8PSAxIHx8IHgubGVuZ3RoICE9IHkubGVuZ3RoKXtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZGV0ZXJtaW5lIHRoZSBtZWFuIG9mIGVhY2ggZGF0YXNldCBzbyB0aGF0IHdlIGNhbiBqdWRnZSBlYWNoXG4gICAgICAgIC8vIHZhbHVlIG9mIHRoZSBkYXRhc2V0IGZhaXJseSBhcyB0aGUgZGlmZmVyZW5jZSBmcm9tIHRoZSBtZWFuLiB0aGlzXG4gICAgICAgIC8vIHdheSwgaWYgb25lIGRhdGFzZXQgaXMgWzEsIDIsIDNdIGFuZCBbMiwgMywgNF0sIHRoZWlyIGNvdmFyaWFuY2VcbiAgICAgICAgLy8gZG9lcyBub3Qgc3VmZmVyIGJlY2F1c2Ugb2YgdGhlIGRpZmZlcmVuY2UgaW4gYWJzb2x1dGUgdmFsdWVzXG4gICAgICAgIHZhciB4bWVhbiA9IG1lYW4oeCksXG4gICAgICAgICAgICB5bWVhbiA9IG1lYW4oeSksXG4gICAgICAgICAgICBzdW0gPSAwO1xuXG4gICAgICAgIC8vIGZvciBlYWNoIHBhaXIgb2YgdmFsdWVzLCB0aGUgY292YXJpYW5jZSBpbmNyZWFzZXMgd2hlbiB0aGVpclxuICAgICAgICAvLyBkaWZmZXJlbmNlIGZyb20gdGhlIG1lYW4gaXMgYXNzb2NpYXRlZCAtIGlmIGJvdGggYXJlIHdlbGwgYWJvdmVcbiAgICAgICAgLy8gb3IgaWYgYm90aCBhcmUgd2VsbCBiZWxvd1xuICAgICAgICAvLyB0aGUgbWVhbiwgdGhlIGNvdmFyaWFuY2UgaW5jcmVhc2VzIHNpZ25pZmljYW50bHkuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBzdW0gKz0gKHhbaV0gLSB4bWVhbikgKiAoeVtpXSAtIHltZWFuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoZSBjb3ZhcmlhbmNlIGlzIHdlaWdodGVkIGJ5IHRoZSBsZW5ndGggb2YgdGhlIGRhdGFzZXRzLlxuICAgICAgICByZXR1cm4gc3VtIC8gKHgubGVuZ3RoIC0gMSk7XG4gICAgfVxuXG4gICAgLy8gIyBbY29ycmVsYXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29ycmVsYXRpb25fYW5kX2RlcGVuZGVuY2UpXG4gICAgLy9cbiAgICAvLyBHZXRzIGEgbWVhc3VyZSBvZiBob3cgY29ycmVsYXRlZCB0d28gZGF0YXNldHMgYXJlLCBiZXR3ZWVuIC0xIGFuZCAxXG4gICAgLy9cbiAgICAvLyBkZXBlbmRzIG9uIGBzYW1wbGVfc3RhbmRhcmRfZGV2aWF0aW9uKClgIGFuZCBgc2FtcGxlX2NvdmFyaWFuY2UoKWBcbiAgICBmdW5jdGlvbiBzYW1wbGVfY29ycmVsYXRpb24oeCwgeSkge1xuICAgICAgICB2YXIgY292ID0gc2FtcGxlX2NvdmFyaWFuY2UoeCwgeSksXG4gICAgICAgICAgICB4c3RkID0gc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbih4KSxcbiAgICAgICAgICAgIHlzdGQgPSBzYW1wbGVfc3RhbmRhcmRfZGV2aWF0aW9uKHkpO1xuXG4gICAgICAgIGlmIChjb3YgPT09IG51bGwgfHwgeHN0ZCA9PT0gbnVsbCB8fCB5c3RkID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb3YgLyB4c3RkIC8geXN0ZDtcbiAgICB9XG5cbiAgICAvLyAjIFttZWRpYW5dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWVkaWFuKVxuICAgIC8vXG4gICAgLy8gVGhlIG1pZGRsZSBudW1iZXIgb2YgYSBsaXN0LiBUaGlzIGlzIG9mdGVuIGEgZ29vZCBpbmRpY2F0b3Igb2YgJ3RoZSBtaWRkbGUnXG4gICAgLy8gd2hlbiB0aGVyZSBhcmUgb3V0bGllcnMgdGhhdCBza2V3IHRoZSBgbWVhbigpYCB2YWx1ZS5cbiAgICBmdW5jdGlvbiBtZWRpYW4oeCkge1xuICAgICAgICAvLyBUaGUgbWVkaWFuIG9mIGFuIGVtcHR5IGxpc3QgaXMgbnVsbFxuICAgICAgICBpZiAoeC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIC8vIFNvcnRpbmcgdGhlIGFycmF5IG1ha2VzIGl0IGVhc3kgdG8gZmluZCB0aGUgY2VudGVyLCBidXRcbiAgICAgICAgLy8gdXNlIGAuc2xpY2UoKWAgdG8gZW5zdXJlIHRoZSBvcmlnaW5hbCBhcnJheSBgeGAgaXMgbm90IG1vZGlmaWVkXG4gICAgICAgIHZhciBzb3J0ZWQgPSB4LnNsaWNlKCkuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pO1xuXG4gICAgICAgIC8vIElmIHRoZSBsZW5ndGggb2YgdGhlIGxpc3QgaXMgb2RkLCBpdCdzIHRoZSBjZW50cmFsIG51bWJlclxuICAgICAgICBpZiAoc29ydGVkLmxlbmd0aCAlIDIgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBzb3J0ZWRbKHNvcnRlZC5sZW5ndGggLSAxKSAvIDJdO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHRoZSBtZWRpYW4gaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHR3byBudW1iZXJzXG4gICAgICAgIC8vIGF0IHRoZSBjZW50ZXIgb2YgdGhlIGxpc3RcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBhID0gc29ydGVkWyhzb3J0ZWQubGVuZ3RoIC8gMikgLSAxXTtcbiAgICAgICAgICAgIHZhciBiID0gc29ydGVkWyhzb3J0ZWQubGVuZ3RoIC8gMildO1xuICAgICAgICAgICAgcmV0dXJuIChhICsgYikgLyAyO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gIyBbbW9kZV0oaHR0cDovL2JpdC5seS9XNUs0WXQpXG4gICAgLy9cbiAgICAvLyBUaGUgbW9kZSBpcyB0aGUgbnVtYmVyIHRoYXQgYXBwZWFycyBpbiBhIGxpc3QgdGhlIGhpZ2hlc3QgbnVtYmVyIG9mIHRpbWVzLlxuICAgIC8vIFRoZXJlIGNhbiBiZSBtdWx0aXBsZSBtb2RlcyBpbiBhIGxpc3Q6IGluIHRoZSBldmVudCBvZiBhIHRpZSwgdGhpc1xuICAgIC8vIGFsZ29yaXRobSB3aWxsIHJldHVybiB0aGUgbW9zdCByZWNlbnRseSBzZWVuIG1vZGUuXG4gICAgLy9cbiAgICAvLyBUaGlzIGltcGxlbWVudGF0aW9uIGlzIGluc3BpcmVkIGJ5IFtzY2llbmNlLmpzXShodHRwczovL2dpdGh1Yi5jb20vamFzb25kYXZpZXMvc2NpZW5jZS5qcy9ibG9iL21hc3Rlci9zcmMvc3RhdHMvbW9kZS5qcylcbiAgICAvL1xuICAgIC8vIFRoaXMgcnVucyBvbiBgTyhuKWAsIGxpbmVhciB0aW1lIGluIHJlc3BlY3QgdG8gdGhlIGFycmF5XG4gICAgZnVuY3Rpb24gbW9kZSh4KSB7XG5cbiAgICAgICAgLy8gSGFuZGxlIGVkZ2UgY2FzZXM6XG4gICAgICAgIC8vIFRoZSBtZWRpYW4gb2YgYW4gZW1wdHkgbGlzdCBpcyBudWxsXG4gICAgICAgIGlmICh4Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGVsc2UgaWYgKHgubGVuZ3RoID09PSAxKSByZXR1cm4geFswXTtcblxuICAgICAgICAvLyBTb3J0aW5nIHRoZSBhcnJheSBsZXRzIHVzIGl0ZXJhdGUgdGhyb3VnaCBpdCBiZWxvdyBhbmQgYmUgc3VyZVxuICAgICAgICAvLyB0aGF0IGV2ZXJ5IHRpbWUgd2Ugc2VlIGEgbmV3IG51bWJlciBpdCdzIG5ldyBhbmQgd2UnbGwgbmV2ZXJcbiAgICAgICAgLy8gc2VlIHRoZSBzYW1lIG51bWJlciB0d2ljZVxuICAgICAgICB2YXIgc29ydGVkID0geC5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9KTtcblxuICAgICAgICAvLyBUaGlzIGFzc3VtZXMgaXQgaXMgZGVhbGluZyB3aXRoIGFuIGFycmF5IG9mIHNpemUgPiAxLCBzaW5jZSBzaXplXG4gICAgICAgIC8vIDAgYW5kIDEgYXJlIGhhbmRsZWQgaW1tZWRpYXRlbHkuIEhlbmNlIGl0IHN0YXJ0cyBhdCBpbmRleCAxIGluIHRoZVxuICAgICAgICAvLyBhcnJheS5cbiAgICAgICAgdmFyIGxhc3QgPSBzb3J0ZWRbMF0sXG4gICAgICAgICAgICAvLyBzdG9yZSB0aGUgbW9kZSBhcyB3ZSBmaW5kIG5ldyBtb2Rlc1xuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICAvLyBzdG9yZSBob3cgbWFueSB0aW1lcyB3ZSd2ZSBzZWVuIHRoZSBtb2RlXG4gICAgICAgICAgICBtYXhfc2VlbiA9IDAsXG4gICAgICAgICAgICAvLyBob3cgbWFueSB0aW1lcyB0aGUgY3VycmVudCBjYW5kaWRhdGUgZm9yIHRoZSBtb2RlXG4gICAgICAgICAgICAvLyBoYXMgYmVlbiBzZWVuXG4gICAgICAgICAgICBzZWVuX3RoaXMgPSAxO1xuXG4gICAgICAgIC8vIGVuZCBhdCBzb3J0ZWQubGVuZ3RoICsgMSB0byBmaXggdGhlIGNhc2UgaW4gd2hpY2ggdGhlIG1vZGUgaXNcbiAgICAgICAgLy8gdGhlIGhpZ2hlc3QgbnVtYmVyIHRoYXQgb2NjdXJzIGluIHRoZSBzZXF1ZW5jZS4gdGhlIGxhc3QgaXRlcmF0aW9uXG4gICAgICAgIC8vIGNvbXBhcmVzIHNvcnRlZFtpXSwgd2hpY2ggaXMgdW5kZWZpbmVkLCB0byB0aGUgaGlnaGVzdCBudW1iZXJcbiAgICAgICAgLy8gaW4gdGhlIHNlcmllc1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHNvcnRlZC5sZW5ndGggKyAxOyBpKyspIHtcbiAgICAgICAgICAgIC8vIHdlJ3JlIHNlZWluZyBhIG5ldyBudW1iZXIgcGFzcyBieVxuICAgICAgICAgICAgaWYgKHNvcnRlZFtpXSAhPT0gbGFzdCkge1xuICAgICAgICAgICAgICAgIC8vIHRoZSBsYXN0IG51bWJlciBpcyB0aGUgbmV3IG1vZGUgc2luY2Ugd2Ugc2F3IGl0IG1vcmVcbiAgICAgICAgICAgICAgICAvLyBvZnRlbiB0aGFuIHRoZSBvbGQgb25lXG4gICAgICAgICAgICAgICAgaWYgKHNlZW5fdGhpcyA+IG1heF9zZWVuKSB7XG4gICAgICAgICAgICAgICAgICAgIG1heF9zZWVuID0gc2Vlbl90aGlzO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGxhc3Q7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlZW5fdGhpcyA9IDE7XG4gICAgICAgICAgICAgICAgbGFzdCA9IHNvcnRlZFtpXTtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXNuJ3QgYSBuZXcgbnVtYmVyLCBpdCdzIG9uZSBtb3JlIG9jY3VycmVuY2Ugb2ZcbiAgICAgICAgICAgIC8vIHRoZSBwb3RlbnRpYWwgbW9kZVxuICAgICAgICAgICAgfSBlbHNlIHsgc2Vlbl90aGlzKys7IH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gIyBbdC10ZXN0XShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1N0dWRlbnQnc190LXRlc3QpXG4gICAgLy9cbiAgICAvLyBUaGlzIGlzIHRvIGNvbXB1dGUgYSBvbmUtc2FtcGxlIHQtdGVzdCwgY29tcGFyaW5nIHRoZSBtZWFuXG4gICAgLy8gb2YgYSBzYW1wbGUgdG8gYSBrbm93biB2YWx1ZSwgeC5cbiAgICAvL1xuICAgIC8vIGluIHRoaXMgY2FzZSwgd2UncmUgdHJ5aW5nIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZVxuICAgIC8vIHBvcHVsYXRpb24gbWVhbiBpcyBlcXVhbCB0byB0aGUgdmFsdWUgdGhhdCB3ZSBrbm93LCB3aGljaCBpcyBgeGBcbiAgICAvLyBoZXJlLiB1c3VhbGx5IHRoZSByZXN1bHRzIGhlcmUgYXJlIHVzZWQgdG8gbG9vayB1cCBhXG4gICAgLy8gW3AtdmFsdWVdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUC12YWx1ZSksIHdoaWNoLCBmb3JcbiAgICAvLyBhIGNlcnRhaW4gbGV2ZWwgb2Ygc2lnbmlmaWNhbmNlLCB3aWxsIGxldCB5b3UgZGV0ZXJtaW5lIHRoYXQgdGhlXG4gICAgLy8gbnVsbCBoeXBvdGhlc2lzIGNhbiBvciBjYW5ub3QgYmUgcmVqZWN0ZWQuXG4gICAgLy9cbiAgICAvLyBEZXBlbmRzIG9uIGBzdGFuZGFyZF9kZXZpYXRpb24oKWAgYW5kIGBtZWFuKClgXG4gICAgZnVuY3Rpb24gdF90ZXN0KHNhbXBsZSwgeCkge1xuICAgICAgICAvLyBUaGUgbWVhbiBvZiB0aGUgc2FtcGxlXG4gICAgICAgIHZhciBzYW1wbGVfbWVhbiA9IG1lYW4oc2FtcGxlKTtcblxuICAgICAgICAvLyBUaGUgc3RhbmRhcmQgZGV2aWF0aW9uIG9mIHRoZSBzYW1wbGVcbiAgICAgICAgdmFyIHNkID0gc3RhbmRhcmRfZGV2aWF0aW9uKHNhbXBsZSk7XG5cbiAgICAgICAgLy8gU3F1YXJlIHJvb3QgdGhlIGxlbmd0aCBvZiB0aGUgc2FtcGxlXG4gICAgICAgIHZhciByb290TiA9IE1hdGguc3FydChzYW1wbGUubGVuZ3RoKTtcblxuICAgICAgICAvLyBDb21wdXRlIHRoZSBrbm93biB2YWx1ZSBhZ2FpbnN0IHRoZSBzYW1wbGUsXG4gICAgICAgIC8vIHJldHVybmluZyB0aGUgdCB2YWx1ZVxuICAgICAgICByZXR1cm4gKHNhbXBsZV9tZWFuIC0geCkgLyAoc2QgLyByb290Tik7XG4gICAgfVxuXG4gICAgLy8gIyBbMi1zYW1wbGUgdC10ZXN0XShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1N0dWRlbnQnc190LXRlc3QpXG4gICAgLy9cbiAgICAvLyBUaGlzIGlzIHRvIGNvbXB1dGUgdHdvIHNhbXBsZSB0LXRlc3QuXG4gICAgLy8gVGVzdHMgd2hldGhlciBcIm1lYW4oWCktbWVhbihZKSA9IGRpZmZlcmVuY2VcIiwgKFxuICAgIC8vIGluIHRoZSBtb3N0IGNvbW1vbiBjYXNlLCB3ZSBvZnRlbiBoYXZlIGBkaWZmZXJlbmNlID09IDBgIHRvIHRlc3QgaWYgdHdvIHNhbXBsZXNcbiAgICAvLyBhcmUgbGlrZWx5IHRvIGJlIHRha2VuIGZyb20gcG9wdWxhdGlvbnMgd2l0aCB0aGUgc2FtZSBtZWFuIHZhbHVlKSB3aXRoXG4gICAgLy8gbm8gcHJpb3Iga25vd2xlZGdlIG9uIHN0YW5kYXJkIGRldmlhdGlvbnMgb2YgYm90aCBzYW1wbGVzXG4gICAgLy8gb3RoZXIgdGhhbiB0aGUgZmFjdCB0aGF0IHRoZXkgaGF2ZSB0aGUgc2FtZSBzdGFuZGFyZCBkZXZpYXRpb24uXG4gICAgLy9cbiAgICAvLyBVc3VhbGx5IHRoZSByZXN1bHRzIGhlcmUgYXJlIHVzZWQgdG8gbG9vayB1cCBhXG4gICAgLy8gW3AtdmFsdWVdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUC12YWx1ZSksIHdoaWNoLCBmb3JcbiAgICAvLyBhIGNlcnRhaW4gbGV2ZWwgb2Ygc2lnbmlmaWNhbmNlLCB3aWxsIGxldCB5b3UgZGV0ZXJtaW5lIHRoYXQgdGhlXG4gICAgLy8gbnVsbCBoeXBvdGhlc2lzIGNhbiBvciBjYW5ub3QgYmUgcmVqZWN0ZWQuXG4gICAgLy9cbiAgICAvLyBgZGlmZmAgY2FuIGJlIG9taXR0ZWQgaWYgaXQgZXF1YWxzIDAuXG4gICAgLy9cbiAgICAvLyBbVGhpcyBpcyB1c2VkIHRvIGNvbmZpcm0gb3IgZGVueV0oaHR0cDovL3d3dy5tb25hcmNobGFiLm9yZy9MYWIvUmVzZWFyY2gvU3RhdHMvMlNhbXBsZVQuYXNweClcbiAgICAvLyBhIG51bGwgaHlwb3RoZXNpcyB0aGF0IHRoZSB0d28gcG9wdWxhdGlvbnMgdGhhdCBoYXZlIGJlZW4gc2FtcGxlZCBpbnRvXG4gICAgLy8gYHNhbXBsZV94YCBhbmQgYHNhbXBsZV95YCBhcmUgZXF1YWwgdG8gZWFjaCBvdGhlci5cbiAgICAvL1xuICAgIC8vIERlcGVuZHMgb24gYHNhbXBsZV92YXJpYW5jZSgpYCBhbmQgYG1lYW4oKWBcbiAgICBmdW5jdGlvbiB0X3Rlc3RfdHdvX3NhbXBsZShzYW1wbGVfeCwgc2FtcGxlX3ksIGRpZmZlcmVuY2UpIHtcbiAgICAgICAgdmFyIG4gPSBzYW1wbGVfeC5sZW5ndGgsXG4gICAgICAgICAgICBtID0gc2FtcGxlX3kubGVuZ3RoO1xuXG4gICAgICAgIC8vIElmIGVpdGhlciBzYW1wbGUgZG9lc24ndCBhY3R1YWxseSBoYXZlIGFueSB2YWx1ZXMsIHdlIGNhbid0XG4gICAgICAgIC8vIGNvbXB1dGUgdGhpcyBhdCBhbGwsIHNvIHdlIHJldHVybiBgbnVsbGAuXG4gICAgICAgIGlmICghbiB8fCAhbSkgcmV0dXJuIG51bGwgO1xuXG4gICAgICAgIC8vIGRlZmF1bHQgZGlmZmVyZW5jZSAobXUpIGlzIHplcm9cbiAgICAgICAgaWYgKCFkaWZmZXJlbmNlKSBkaWZmZXJlbmNlID0gMDtcblxuICAgICAgICB2YXIgbWVhblggPSBtZWFuKHNhbXBsZV94KSxcbiAgICAgICAgICAgIG1lYW5ZID0gbWVhbihzYW1wbGVfeSk7XG5cbiAgICAgICAgdmFyIHdlaWdodGVkVmFyaWFuY2UgPSAoKG4gLSAxKSAqIHNhbXBsZV92YXJpYW5jZShzYW1wbGVfeCkgK1xuICAgICAgICAgICAgKG0gLSAxKSAqIHNhbXBsZV92YXJpYW5jZShzYW1wbGVfeSkpIC8gKG4gKyBtIC0gMik7XG5cbiAgICAgICAgcmV0dXJuIChtZWFuWCAtIG1lYW5ZIC0gZGlmZmVyZW5jZSkgL1xuICAgICAgICAgICAgTWF0aC5zcXJ0KHdlaWdodGVkVmFyaWFuY2UgKiAoMSAvIG4gKyAxIC8gbSkpO1xuICAgIH1cblxuICAgIC8vICMgY2h1bmtcbiAgICAvL1xuICAgIC8vIFNwbGl0IGFuIGFycmF5IGludG8gY2h1bmtzIG9mIGEgc3BlY2lmaWVkIHNpemUuIFRoaXMgZnVuY3Rpb25cbiAgICAvLyBoYXMgdGhlIHNhbWUgYmVoYXZpb3IgYXMgW1BIUCdzIGFycmF5X2NodW5rXShodHRwOi8vcGhwLm5ldC9tYW51YWwvZW4vZnVuY3Rpb24uYXJyYXktY2h1bmsucGhwKVxuICAgIC8vIGZ1bmN0aW9uLCBhbmQgdGh1cyB3aWxsIGluc2VydCBzbWFsbGVyLXNpemVkIGNodW5rcyBhdCB0aGUgZW5kIGlmXG4gICAgLy8gdGhlIGlucHV0IHNpemUgaXMgbm90IGRpdmlzaWJsZSBieSB0aGUgY2h1bmsgc2l6ZS5cbiAgICAvL1xuICAgIC8vIGBzYW1wbGVgIGlzIGV4cGVjdGVkIHRvIGJlIGFuIGFycmF5LCBhbmQgYGNodW5rU2l6ZWAgYSBudW1iZXIuXG4gICAgLy8gVGhlIGBzYW1wbGVgIGFycmF5IGNhbiBjb250YWluIGFueSBraW5kIG9mIGRhdGEuXG4gICAgZnVuY3Rpb24gY2h1bmsoc2FtcGxlLCBjaHVua1NpemUpIHtcblxuICAgICAgICAvLyBhIGxpc3Qgb2YgcmVzdWx0IGNodW5rcywgYXMgYXJyYXlzIGluIGFuIGFycmF5XG4gICAgICAgIHZhciBvdXRwdXQgPSBbXTtcblxuICAgICAgICAvLyBgY2h1bmtTaXplYCBtdXN0IGJlIHplcm8gb3IgaGlnaGVyIC0gb3RoZXJ3aXNlIHRoZSBsb29wIGJlbG93LFxuICAgICAgICAvLyBpbiB3aGljaCB3ZSBjYWxsIGBzdGFydCArPSBjaHVua1NpemVgLCB3aWxsIGxvb3AgaW5maW5pdGVseS5cbiAgICAgICAgLy8gU28sIHdlJ2xsIGRldGVjdCBhbmQgcmV0dXJuIG51bGwgaW4gdGhhdCBjYXNlIHRvIGluZGljYXRlXG4gICAgICAgIC8vIGludmFsaWQgaW5wdXQuXG4gICAgICAgIGlmIChjaHVua1NpemUgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBgc3RhcnRgIGlzIHRoZSBpbmRleCBhdCB3aGljaCBgLnNsaWNlYCB3aWxsIHN0YXJ0IHNlbGVjdGluZ1xuICAgICAgICAvLyBuZXcgYXJyYXkgZWxlbWVudHNcbiAgICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyBzdGFydCA8IHNhbXBsZS5sZW5ndGg7IHN0YXJ0ICs9IGNodW5rU2l6ZSkge1xuXG4gICAgICAgICAgICAvLyBmb3IgZWFjaCBjaHVuaywgc2xpY2UgdGhhdCBwYXJ0IG9mIHRoZSBhcnJheSBhbmQgYWRkIGl0XG4gICAgICAgICAgICAvLyB0byB0aGUgb3V0cHV0LiBUaGUgYC5zbGljZWAgZnVuY3Rpb24gZG9lcyBub3QgY2hhbmdlXG4gICAgICAgICAgICAvLyB0aGUgb3JpZ2luYWwgYXJyYXkuXG4gICAgICAgICAgICBvdXRwdXQucHVzaChzYW1wbGUuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgY2h1bmtTaXplKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG5cbiAgICAvLyAjIHNodWZmbGVfaW5fcGxhY2VcbiAgICAvL1xuICAgIC8vIEEgW0Zpc2hlci1ZYXRlcyBzaHVmZmxlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Zpc2hlciVFMiU4MCU5M1lhdGVzX3NodWZmbGUpXG4gICAgLy8gaW4tcGxhY2UgLSB3aGljaCBtZWFucyB0aGF0IGl0IHdpbGwgY2hhbmdlIHRoZSBvcmRlciBvZiB0aGUgb3JpZ2luYWxcbiAgICAvLyBhcnJheSBieSByZWZlcmVuY2UuXG4gICAgZnVuY3Rpb24gc2h1ZmZsZV9pbl9wbGFjZShzYW1wbGUsIHJhbmRvbVNvdXJjZSkge1xuXG4gICAgICAgIC8vIGEgY3VzdG9tIHJhbmRvbSBudW1iZXIgc291cmNlIGNhbiBiZSBwcm92aWRlZCBpZiB5b3Ugd2FudCB0byB1c2VcbiAgICAgICAgLy8gYSBmaXhlZCBzZWVkIG9yIGFub3RoZXIgcmFuZG9tIG51bWJlciBnZW5lcmF0b3IsIGxpa2VcbiAgICAgICAgLy8gW3JhbmRvbS1qc10oaHR0cHM6Ly93d3cubnBtanMub3JnL3BhY2thZ2UvcmFuZG9tLWpzKVxuICAgICAgICByYW5kb21Tb3VyY2UgPSByYW5kb21Tb3VyY2UgfHwgTWF0aC5yYW5kb207XG5cbiAgICAgICAgLy8gc3RvcmUgdGhlIGN1cnJlbnQgbGVuZ3RoIG9mIHRoZSBzYW1wbGUgdG8gZGV0ZXJtaW5lXG4gICAgICAgIC8vIHdoZW4gbm8gZWxlbWVudHMgcmVtYWluIHRvIHNodWZmbGUuXG4gICAgICAgIHZhciBsZW5ndGggPSBzYW1wbGUubGVuZ3RoO1xuXG4gICAgICAgIC8vIHRlbXBvcmFyeSBpcyB1c2VkIHRvIGhvbGQgYW4gaXRlbSB3aGVuIGl0IGlzIGJlaW5nXG4gICAgICAgIC8vIHN3YXBwZWQgYmV0d2VlbiBpbmRpY2VzLlxuICAgICAgICB2YXIgdGVtcG9yYXJ5O1xuXG4gICAgICAgIC8vIFRoZSBpbmRleCB0byBzd2FwIGF0IGVhY2ggc3RhZ2UuXG4gICAgICAgIHZhciBpbmRleDtcblxuICAgICAgICAvLyBXaGlsZSB0aGVyZSBhcmUgc3RpbGwgaXRlbXMgdG8gc2h1ZmZsZVxuICAgICAgICB3aGlsZSAobGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gY2hvc2UgYSByYW5kb20gaW5kZXggd2l0aGluIHRoZSBzdWJzZXQgb2YgdGhlIGFycmF5XG4gICAgICAgICAgICAvLyB0aGF0IGlzIG5vdCB5ZXQgc2h1ZmZsZWRcbiAgICAgICAgICAgIGluZGV4ID0gTWF0aC5mbG9vcihyYW5kb21Tb3VyY2UoKSAqIGxlbmd0aC0tKTtcblxuICAgICAgICAgICAgLy8gc3RvcmUgdGhlIHZhbHVlIHRoYXQgd2UnbGwgbW92ZSB0ZW1wb3JhcmlseVxuICAgICAgICAgICAgdGVtcG9yYXJ5ID0gc2FtcGxlW2xlbmd0aF07XG5cbiAgICAgICAgICAgIC8vIHN3YXAgdGhlIHZhbHVlIGF0IGBzYW1wbGVbbGVuZ3RoXWAgd2l0aCBgc2FtcGxlW2luZGV4XWBcbiAgICAgICAgICAgIHNhbXBsZVtsZW5ndGhdID0gc2FtcGxlW2luZGV4XTtcbiAgICAgICAgICAgIHNhbXBsZVtpbmRleF0gPSB0ZW1wb3Jhcnk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2FtcGxlO1xuICAgIH1cblxuICAgIC8vICMgc2h1ZmZsZVxuICAgIC8vXG4gICAgLy8gQSBbRmlzaGVyLVlhdGVzIHNodWZmbGVdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRmlzaGVyJUUyJTgwJTkzWWF0ZXNfc2h1ZmZsZSlcbiAgICAvLyBpcyBhIGZhc3Qgd2F5IHRvIGNyZWF0ZSBhIHJhbmRvbSBwZXJtdXRhdGlvbiBvZiBhIGZpbml0ZSBzZXQuXG4gICAgZnVuY3Rpb24gc2h1ZmZsZShzYW1wbGUsIHJhbmRvbVNvdXJjZSkge1xuICAgICAgICAvLyBzbGljZSB0aGUgb3JpZ2luYWwgYXJyYXkgc28gdGhhdCBpdCBpcyBub3QgbW9kaWZpZWRcbiAgICAgICAgc2FtcGxlID0gc2FtcGxlLnNsaWNlKCk7XG5cbiAgICAgICAgLy8gYW5kIHRoZW4gc2h1ZmZsZSB0aGF0IHNoYWxsb3ctY29waWVkIGFycmF5LCBpbiBwbGFjZVxuICAgICAgICByZXR1cm4gc2h1ZmZsZV9pbl9wbGFjZShzYW1wbGUuc2xpY2UoKSwgcmFuZG9tU291cmNlKTtcbiAgICB9XG5cbiAgICAvLyAjIHNhbXBsZVxuICAgIC8vXG4gICAgLy8gQ3JlYXRlIGEgW3NpbXBsZSByYW5kb20gc2FtcGxlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1NpbXBsZV9yYW5kb21fc2FtcGxlKVxuICAgIC8vIGZyb20gYSBnaXZlbiBhcnJheSBvZiBgbmAgZWxlbWVudHMuXG4gICAgZnVuY3Rpb24gc2FtcGxlKGFycmF5LCBuLCByYW5kb21Tb3VyY2UpIHtcbiAgICAgICAgLy8gc2h1ZmZsZSB0aGUgb3JpZ2luYWwgYXJyYXkgdXNpbmcgYSBmaXNoZXIteWF0ZXMgc2h1ZmZsZVxuICAgICAgICB2YXIgc2h1ZmZsZWQgPSBzaHVmZmxlKGFycmF5LCByYW5kb21Tb3VyY2UpO1xuXG4gICAgICAgIC8vIGFuZCB0aGVuIHJldHVybiBhIHN1YnNldCBvZiBpdCAtIHRoZSBmaXJzdCBgbmAgZWxlbWVudHMuXG4gICAgICAgIHJldHVybiBzaHVmZmxlZC5zbGljZSgwLCBuKTtcbiAgICB9XG5cbiAgICAvLyAjIHF1YW50aWxlXG4gICAgLy9cbiAgICAvLyBUaGlzIGlzIGEgcG9wdWxhdGlvbiBxdWFudGlsZSwgc2luY2Ugd2UgYXNzdW1lIHRvIGtub3cgdGhlIGVudGlyZVxuICAgIC8vIGRhdGFzZXQgaW4gdGhpcyBsaWJyYXJ5LiBUaHVzIEknbSB0cnlpbmcgdG8gZm9sbG93IHRoZVxuICAgIC8vIFtRdWFudGlsZXMgb2YgYSBQb3B1bGF0aW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1F1YW50aWxlI1F1YW50aWxlc19vZl9hX3BvcHVsYXRpb24pXG4gICAgLy8gYWxnb3JpdGhtIGZyb20gd2lraXBlZGlhLlxuICAgIC8vXG4gICAgLy8gU2FtcGxlIGlzIGEgb25lLWRpbWVuc2lvbmFsIGFycmF5IG9mIG51bWJlcnMsXG4gICAgLy8gYW5kIHAgaXMgZWl0aGVyIGEgZGVjaW1hbCBudW1iZXIgZnJvbSAwIHRvIDEgb3IgYW4gYXJyYXkgb2YgZGVjaW1hbFxuICAgIC8vIG51bWJlcnMgZnJvbSAwIHRvIDEuXG4gICAgLy8gSW4gdGVybXMgb2YgYSBrL3EgcXVhbnRpbGUsIHAgPSBrL3EgLSBpdCdzIGp1c3QgZGVhbGluZyB3aXRoIGZyYWN0aW9ucyBvciBkZWFsaW5nXG4gICAgLy8gd2l0aCBkZWNpbWFsIHZhbHVlcy5cbiAgICAvLyBXaGVuIHAgaXMgYW4gYXJyYXksIHRoZSByZXN1bHQgb2YgdGhlIGZ1bmN0aW9uIGlzIGFsc28gYW4gYXJyYXkgY29udGFpbmluZyB0aGUgYXBwcm9wcmlhdGVcbiAgICAvLyBxdWFudGlsZXMgaW4gaW5wdXQgb3JkZXJcbiAgICBmdW5jdGlvbiBxdWFudGlsZShzYW1wbGUsIHApIHtcblxuICAgICAgICAvLyBXZSBjYW4ndCBkZXJpdmUgcXVhbnRpbGVzIGZyb20gYW4gZW1wdHkgbGlzdFxuICAgICAgICBpZiAoc2FtcGxlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgLy8gU29ydCBhIGNvcHkgb2YgdGhlIGFycmF5LiBXZSdsbCBuZWVkIGEgc29ydGVkIGFycmF5IHRvIGluZGV4XG4gICAgICAgIC8vIHRoZSB2YWx1ZXMgaW4gc29ydGVkIG9yZGVyLlxuICAgICAgICB2YXIgc29ydGVkID0gc2FtcGxlLnNsaWNlKCkuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pO1xuXG4gICAgICAgIGlmIChwLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgcmVzdWx0IGFycmF5XG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgICAgICAgICAgLy8gRm9yIGVhY2ggcmVxdWVzdGVkIHF1YW50aWxlXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXN1bHRzW2ldID0gcXVhbnRpbGVfc29ydGVkKHNvcnRlZCwgcFtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBxdWFudGlsZV9zb3J0ZWQoc29ydGVkLCBwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vICMgcXVhbnRpbGVcbiAgICAvL1xuICAgIC8vIFRoaXMgaXMgdGhlIGludGVybmFsIGltcGxlbWVudGF0aW9uIG9mIHF1YW50aWxlczogd2hlbiB5b3Uga25vd1xuICAgIC8vIHRoYXQgdGhlIG9yZGVyIGlzIHNvcnRlZCwgeW91IGRvbid0IG5lZWQgdG8gcmUtc29ydCBpdCwgYW5kIHRoZSBjb21wdXRhdGlvbnNcbiAgICAvLyBhcmUgbXVjaCBmYXN0ZXIuXG4gICAgZnVuY3Rpb24gcXVhbnRpbGVfc29ydGVkKHNhbXBsZSwgcCkge1xuICAgICAgICB2YXIgaWR4ID0gKHNhbXBsZS5sZW5ndGgpICogcDtcbiAgICAgICAgaWYgKHAgPCAwIHx8IHAgPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBlbHNlIGlmIChwID09PSAxKSB7XG4gICAgICAgICAgICAvLyBJZiBwIGlzIDEsIGRpcmVjdGx5IHJldHVybiB0aGUgbGFzdCBlbGVtZW50XG4gICAgICAgICAgICByZXR1cm4gc2FtcGxlW3NhbXBsZS5sZW5ndGggLSAxXTtcbiAgICAgICAgfSBlbHNlIGlmIChwID09PSAwKSB7XG4gICAgICAgICAgICAvLyBJZiBwIGlzIDAsIGRpcmVjdGx5IHJldHVybiB0aGUgZmlyc3QgZWxlbWVudFxuICAgICAgICAgICAgcmV0dXJuIHNhbXBsZVswXTtcbiAgICAgICAgfSBlbHNlIGlmIChpZHggJSAxICE9PSAwKSB7XG4gICAgICAgICAgICAvLyBJZiBwIGlzIG5vdCBpbnRlZ2VyLCByZXR1cm4gdGhlIG5leHQgZWxlbWVudCBpbiBhcnJheVxuICAgICAgICAgICAgcmV0dXJuIHNhbXBsZVtNYXRoLmNlaWwoaWR4KSAtIDFdO1xuICAgICAgICB9IGVsc2UgaWYgKHNhbXBsZS5sZW5ndGggJSAyID09PSAwKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgbGlzdCBoYXMgZXZlbi1sZW5ndGgsIHdlJ2xsIHRha2UgdGhlIGF2ZXJhZ2Ugb2YgdGhpcyBudW1iZXJcbiAgICAgICAgICAgIC8vIGFuZCB0aGUgbmV4dCB2YWx1ZSwgaWYgdGhlcmUgaXMgb25lXG4gICAgICAgICAgICByZXR1cm4gKHNhbXBsZVtpZHggLSAxXSArIHNhbXBsZVtpZHhdKSAvIDI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBGaW5hbGx5LCBpbiB0aGUgc2ltcGxlIGNhc2Ugb2YgYW4gaW50ZWdlciB2YWx1ZVxuICAgICAgICAgICAgLy8gd2l0aCBhbiBvZGQtbGVuZ3RoIGxpc3QsIHJldHVybiB0aGUgc2FtcGxlIHZhbHVlIGF0IHRoZSBpbmRleC5cbiAgICAgICAgICAgIHJldHVybiBzYW1wbGVbaWR4XTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vICMgW0ludGVycXVhcnRpbGUgcmFuZ2VdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSW50ZXJxdWFydGlsZV9yYW5nZSlcbiAgICAvL1xuICAgIC8vIEEgbWVhc3VyZSBvZiBzdGF0aXN0aWNhbCBkaXNwZXJzaW9uLCBvciBob3cgc2NhdHRlcmVkLCBzcHJlYWQsIG9yXG4gICAgLy8gY29uY2VudHJhdGVkIGEgZGlzdHJpYnV0aW9uIGlzLiBJdCdzIGNvbXB1dGVkIGFzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW5cbiAgICAvLyB0aGUgdGhpcmQgcXVhcnRpbGUgYW5kIGZpcnN0IHF1YXJ0aWxlLlxuICAgIGZ1bmN0aW9uIGlxcihzYW1wbGUpIHtcbiAgICAgICAgLy8gV2UgY2FuJ3QgZGVyaXZlIHF1YW50aWxlcyBmcm9tIGFuIGVtcHR5IGxpc3RcbiAgICAgICAgaWYgKHNhbXBsZS5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgICAgIC8vIEludGVycXVhcnRpbGUgcmFuZ2UgaXMgdGhlIHNwYW4gYmV0d2VlbiB0aGUgdXBwZXIgcXVhcnRpbGUsXG4gICAgICAgIC8vIGF0IGAwLjc1YCwgYW5kIGxvd2VyIHF1YXJ0aWxlLCBgMC4yNWBcbiAgICAgICAgcmV0dXJuIHF1YW50aWxlKHNhbXBsZSwgMC43NSkgLSBxdWFudGlsZShzYW1wbGUsIDAuMjUpO1xuICAgIH1cblxuICAgIC8vICMgW01lZGlhbiBBYnNvbHV0ZSBEZXZpYXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTWVkaWFuX2Fic29sdXRlX2RldmlhdGlvbilcbiAgICAvL1xuICAgIC8vIFRoZSBNZWRpYW4gQWJzb2x1dGUgRGV2aWF0aW9uIChNQUQpIGlzIGEgcm9idXN0IG1lYXN1cmUgb2Ygc3RhdGlzdGljYWxcbiAgICAvLyBkaXNwZXJzaW9uLiBJdCBpcyBtb3JlIHJlc2lsaWVudCB0byBvdXRsaWVycyB0aGFuIHRoZSBzdGFuZGFyZCBkZXZpYXRpb24uXG4gICAgZnVuY3Rpb24gbWFkKHgpIHtcbiAgICAgICAgLy8gVGhlIG1hZCBvZiBub3RoaW5nIGlzIG51bGxcbiAgICAgICAgaWYgKCF4IHx8IHgubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICB2YXIgbWVkaWFuX3ZhbHVlID0gbWVkaWFuKHgpLFxuICAgICAgICAgICAgbWVkaWFuX2Fic29sdXRlX2RldmlhdGlvbnMgPSBbXTtcblxuICAgICAgICAvLyBNYWtlIGEgbGlzdCBvZiBhYnNvbHV0ZSBkZXZpYXRpb25zIGZyb20gdGhlIG1lZGlhblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG1lZGlhbl9hYnNvbHV0ZV9kZXZpYXRpb25zLnB1c2goTWF0aC5hYnMoeFtpXSAtIG1lZGlhbl92YWx1ZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmluZCB0aGUgbWVkaWFuIHZhbHVlIG9mIHRoYXQgbGlzdFxuICAgICAgICByZXR1cm4gbWVkaWFuKG1lZGlhbl9hYnNvbHV0ZV9kZXZpYXRpb25zKTtcbiAgICB9XG5cbiAgICAvLyAjIyBDb21wdXRlIE1hdHJpY2VzIGZvciBKZW5rc1xuICAgIC8vXG4gICAgLy8gQ29tcHV0ZSB0aGUgbWF0cmljZXMgcmVxdWlyZWQgZm9yIEplbmtzIGJyZWFrcy4gVGhlc2UgbWF0cmljZXNcbiAgICAvLyBjYW4gYmUgdXNlZCBmb3IgYW55IGNsYXNzaW5nIG9mIGRhdGEgd2l0aCBgY2xhc3NlcyA8PSBuX2NsYXNzZXNgXG4gICAgZnVuY3Rpb24gamVua3NNYXRyaWNlcyhkYXRhLCBuX2NsYXNzZXMpIHtcblxuICAgICAgICAvLyBpbiB0aGUgb3JpZ2luYWwgaW1wbGVtZW50YXRpb24sIHRoZXNlIG1hdHJpY2VzIGFyZSByZWZlcnJlZCB0b1xuICAgICAgICAvLyBhcyBgTENgIGFuZCBgT1BgXG4gICAgICAgIC8vXG4gICAgICAgIC8vICogbG93ZXJfY2xhc3NfbGltaXRzIChMQyk6IG9wdGltYWwgbG93ZXIgY2xhc3MgbGltaXRzXG4gICAgICAgIC8vICogdmFyaWFuY2VfY29tYmluYXRpb25zIChPUCk6IG9wdGltYWwgdmFyaWFuY2UgY29tYmluYXRpb25zIGZvciBhbGwgY2xhc3Nlc1xuICAgICAgICB2YXIgbG93ZXJfY2xhc3NfbGltaXRzID0gW10sXG4gICAgICAgICAgICB2YXJpYW5jZV9jb21iaW5hdGlvbnMgPSBbXSxcbiAgICAgICAgICAgIC8vIGxvb3AgY291bnRlcnNcbiAgICAgICAgICAgIGksIGosXG4gICAgICAgICAgICAvLyB0aGUgdmFyaWFuY2UsIGFzIGNvbXB1dGVkIGF0IGVhY2ggc3RlcCBpbiB0aGUgY2FsY3VsYXRpb25cbiAgICAgICAgICAgIHZhcmlhbmNlID0gMDtcblxuICAgICAgICAvLyBJbml0aWFsaXplIGFuZCBmaWxsIGVhY2ggbWF0cml4IHdpdGggemVyb2VzXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhLmxlbmd0aCArIDE7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRtcDEgPSBbXSwgdG1wMiA9IFtdO1xuICAgICAgICAgICAgLy8gZGVzcGl0ZSB0aGVzZSBhcnJheXMgaGF2aW5nIHRoZSBzYW1lIHZhbHVlcywgd2UgbmVlZFxuICAgICAgICAgICAgLy8gdG8ga2VlcCB0aGVtIHNlcGFyYXRlIHNvIHRoYXQgY2hhbmdpbmcgb25lIGRvZXMgbm90IGNoYW5nZVxuICAgICAgICAgICAgLy8gdGhlIG90aGVyXG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbl9jbGFzc2VzICsgMTsgaisrKSB7XG4gICAgICAgICAgICAgICAgdG1wMS5wdXNoKDApO1xuICAgICAgICAgICAgICAgIHRtcDIucHVzaCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxvd2VyX2NsYXNzX2xpbWl0cy5wdXNoKHRtcDEpO1xuICAgICAgICAgICAgdmFyaWFuY2VfY29tYmluYXRpb25zLnB1c2godG1wMik7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGkgPSAxOyBpIDwgbl9jbGFzc2VzICsgMTsgaSsrKSB7XG4gICAgICAgICAgICBsb3dlcl9jbGFzc19saW1pdHNbMV1baV0gPSAxO1xuICAgICAgICAgICAgdmFyaWFuY2VfY29tYmluYXRpb25zWzFdW2ldID0gMDtcbiAgICAgICAgICAgIC8vIGluIHRoZSBvcmlnaW5hbCBpbXBsZW1lbnRhdGlvbiwgOTk5OTk5OSBpcyB1c2VkIGJ1dFxuICAgICAgICAgICAgLy8gc2luY2UgSmF2YXNjcmlwdCBoYXMgYEluZmluaXR5YCwgd2UgdXNlIHRoYXQuXG4gICAgICAgICAgICBmb3IgKGogPSAyOyBqIDwgZGF0YS5sZW5ndGggKyAxOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXJpYW5jZV9jb21iaW5hdGlvbnNbal1baV0gPSBJbmZpbml0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGwgPSAyOyBsIDwgZGF0YS5sZW5ndGggKyAxOyBsKyspIHtcblxuICAgICAgICAgICAgLy8gYFNaYCBvcmlnaW5hbGx5LiB0aGlzIGlzIHRoZSBzdW0gb2YgdGhlIHZhbHVlcyBzZWVuIHRodXNcbiAgICAgICAgICAgIC8vIGZhciB3aGVuIGNhbGN1bGF0aW5nIHZhcmlhbmNlLlxuICAgICAgICAgICAgdmFyIHN1bSA9IDAsXG4gICAgICAgICAgICAgICAgLy8gYFpTUWAgb3JpZ2luYWxseS4gdGhlIHN1bSBvZiBzcXVhcmVzIG9mIHZhbHVlcyBzZWVuXG4gICAgICAgICAgICAgICAgLy8gdGh1cyBmYXJcbiAgICAgICAgICAgICAgICBzdW1fc3F1YXJlcyA9IDAsXG4gICAgICAgICAgICAgICAgLy8gYFdUYCBvcmlnaW5hbGx5LiBUaGlzIGlzIHRoZSBudW1iZXIgb2ZcbiAgICAgICAgICAgICAgICB3ID0gMCxcbiAgICAgICAgICAgICAgICAvLyBgSVZgIG9yaWdpbmFsbHlcbiAgICAgICAgICAgICAgICBpNCA9IDA7XG5cbiAgICAgICAgICAgIC8vIGluIHNldmVyYWwgaW5zdGFuY2VzLCB5b3UgY291bGQgc2F5IGBNYXRoLnBvdyh4LCAyKWBcbiAgICAgICAgICAgIC8vIGluc3RlYWQgb2YgYHggKiB4YCwgYnV0IHRoaXMgaXMgc2xvd2VyIGluIHNvbWUgYnJvd3NlcnNcbiAgICAgICAgICAgIC8vIGludHJvZHVjZXMgYW4gdW5uZWNlc3NhcnkgY29uY2VwdC5cbiAgICAgICAgICAgIGZvciAodmFyIG0gPSAxOyBtIDwgbCArIDE7IG0rKykge1xuXG4gICAgICAgICAgICAgICAgLy8gYElJSWAgb3JpZ2luYWxseVxuICAgICAgICAgICAgICAgIHZhciBsb3dlcl9jbGFzc19saW1pdCA9IGwgLSBtICsgMSxcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gZGF0YVtsb3dlcl9jbGFzc19saW1pdCAtIDFdO1xuXG4gICAgICAgICAgICAgICAgLy8gaGVyZSB3ZSdyZSBlc3RpbWF0aW5nIHZhcmlhbmNlIGZvciBlYWNoIHBvdGVudGlhbCBjbGFzc2luZ1xuICAgICAgICAgICAgICAgIC8vIG9mIHRoZSBkYXRhLCBmb3IgZWFjaCBwb3RlbnRpYWwgbnVtYmVyIG9mIGNsYXNzZXMuIGB3YFxuICAgICAgICAgICAgICAgIC8vIGlzIHRoZSBudW1iZXIgb2YgZGF0YSBwb2ludHMgY29uc2lkZXJlZCBzbyBmYXIuXG4gICAgICAgICAgICAgICAgdysrO1xuXG4gICAgICAgICAgICAgICAgLy8gaW5jcmVhc2UgdGhlIGN1cnJlbnQgc3VtIGFuZCBzdW0tb2Ytc3F1YXJlc1xuICAgICAgICAgICAgICAgIHN1bSArPSB2YWw7XG4gICAgICAgICAgICAgICAgc3VtX3NxdWFyZXMgKz0gdmFsICogdmFsO1xuXG4gICAgICAgICAgICAgICAgLy8gdGhlIHZhcmlhbmNlIGF0IHRoaXMgcG9pbnQgaW4gdGhlIHNlcXVlbmNlIGlzIHRoZSBkaWZmZXJlbmNlXG4gICAgICAgICAgICAgICAgLy8gYmV0d2VlbiB0aGUgc3VtIG9mIHNxdWFyZXMgYW5kIHRoZSB0b3RhbCB4IDIsIG92ZXIgdGhlIG51bWJlclxuICAgICAgICAgICAgICAgIC8vIG9mIHNhbXBsZXMuXG4gICAgICAgICAgICAgICAgdmFyaWFuY2UgPSBzdW1fc3F1YXJlcyAtIChzdW0gKiBzdW0pIC8gdztcblxuICAgICAgICAgICAgICAgIGk0ID0gbG93ZXJfY2xhc3NfbGltaXQgLSAxO1xuXG4gICAgICAgICAgICAgICAgaWYgKGk0ICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDI7IGogPCBuX2NsYXNzZXMgKyAxOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGFkZGluZyB0aGlzIGVsZW1lbnQgdG8gYW4gZXhpc3RpbmcgY2xhc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpbGwgaW5jcmVhc2UgaXRzIHZhcmlhbmNlIGJleW9uZCB0aGUgbGltaXQsIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgY2xhc3MgYXQgdGhpcyBwb2ludCwgc2V0dGluZyB0aGUgYGxvd2VyX2NsYXNzX2xpbWl0YFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXQgdGhpcyBwb2ludC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYW5jZV9jb21iaW5hdGlvbnNbbF1bal0gPj1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodmFyaWFuY2UgKyB2YXJpYW5jZV9jb21iaW5hdGlvbnNbaTRdW2ogLSAxXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dlcl9jbGFzc19saW1pdHNbbF1bal0gPSBsb3dlcl9jbGFzc19saW1pdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW5jZV9jb21iaW5hdGlvbnNbbF1bal0gPSB2YXJpYW5jZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbmNlX2NvbWJpbmF0aW9uc1tpNF1baiAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsb3dlcl9jbGFzc19saW1pdHNbbF1bMV0gPSAxO1xuICAgICAgICAgICAgdmFyaWFuY2VfY29tYmluYXRpb25zW2xdWzFdID0gdmFyaWFuY2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZXR1cm4gdGhlIHR3byBtYXRyaWNlcy4gZm9yIGp1c3QgcHJvdmlkaW5nIGJyZWFrcywgb25seVxuICAgICAgICAvLyBgbG93ZXJfY2xhc3NfbGltaXRzYCBpcyBuZWVkZWQsIGJ1dCB2YXJpYW5jZXMgY2FuIGJlIHVzZWZ1bCB0b1xuICAgICAgICAvLyBldmFsdWF0ZSBnb29kbmVzcyBvZiBmaXQuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsb3dlcl9jbGFzc19saW1pdHM6IGxvd2VyX2NsYXNzX2xpbWl0cyxcbiAgICAgICAgICAgIHZhcmlhbmNlX2NvbWJpbmF0aW9uczogdmFyaWFuY2VfY29tYmluYXRpb25zXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gIyMgUHVsbCBCcmVha3MgVmFsdWVzIGZvciBKZW5rc1xuICAgIC8vXG4gICAgLy8gdGhlIHNlY29uZCBwYXJ0IG9mIHRoZSBqZW5rcyByZWNpcGU6IHRha2UgdGhlIGNhbGN1bGF0ZWQgbWF0cmljZXNcbiAgICAvLyBhbmQgZGVyaXZlIGFuIGFycmF5IG9mIG4gYnJlYWtzLlxuICAgIGZ1bmN0aW9uIGplbmtzQnJlYWtzKGRhdGEsIGxvd2VyX2NsYXNzX2xpbWl0cywgbl9jbGFzc2VzKSB7XG5cbiAgICAgICAgdmFyIGsgPSBkYXRhLmxlbmd0aCxcbiAgICAgICAgICAgIGtjbGFzcyA9IFtdLFxuICAgICAgICAgICAgY291bnROdW0gPSBuX2NsYXNzZXM7XG5cbiAgICAgICAgLy8gdGhlIGNhbGN1bGF0aW9uIG9mIGNsYXNzZXMgd2lsbCBuZXZlciBpbmNsdWRlIHRoZSB1cHBlclxuICAgICAgICAvLyBib3VuZCwgc28gd2UgbmVlZCB0byBleHBsaWNpdGx5IHNldCBpdFxuICAgICAgICBrY2xhc3Nbbl9jbGFzc2VzXSA9IGRhdGFbZGF0YS5sZW5ndGggLSAxXTtcblxuICAgICAgICAvLyB0aGUgbG93ZXJfY2xhc3NfbGltaXRzIG1hdHJpeCBpcyB1c2VkIGFzIGluZGljZXMgaW50byBpdHNlbGZcbiAgICAgICAgLy8gaGVyZTogdGhlIGBrYCB2YXJpYWJsZSBpcyByZXVzZWQgaW4gZWFjaCBpdGVyYXRpb24uXG4gICAgICAgIHdoaWxlIChjb3VudE51bSA+IDApIHtcbiAgICAgICAgICAgIGtjbGFzc1tjb3VudE51bSAtIDFdID0gZGF0YVtsb3dlcl9jbGFzc19saW1pdHNba11bY291bnROdW1dIC0gMV07XG4gICAgICAgICAgICBrID0gbG93ZXJfY2xhc3NfbGltaXRzW2tdW2NvdW50TnVtXSAtIDE7XG4gICAgICAgICAgICBjb3VudE51bS0tO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGtjbGFzcztcbiAgICB9XG5cbiAgICAvLyAjIFtKZW5rcyBuYXR1cmFsIGJyZWFrcyBvcHRpbWl6YXRpb25dKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSmVua3NfbmF0dXJhbF9icmVha3Nfb3B0aW1pemF0aW9uKVxuICAgIC8vXG4gICAgLy8gSW1wbGVtZW50YXRpb25zOiBbMV0oaHR0cDovL2RhbmllbGpsZXdpcy5vcmcvZmlsZXMvMjAxMC8wNi9KZW5rcy5wZGYpIChweXRob24pLFxuICAgIC8vIFsyXShodHRwczovL2dpdGh1Yi5jb20vdnZvb3Z2L2RqZW8tamVua3MvYmxvYi9tYXN0ZXIvbWFpbi5qcykgKGJ1Z2d5KSxcbiAgICAvLyBbM10oaHR0cHM6Ly9naXRodWIuY29tL3NpbW9nZW8vZ2Vvc3RhdHMvYmxvYi9tYXN0ZXIvbGliL2dlb3N0YXRzLmpzI0w0MDcpICh3b3JrcylcbiAgICAvL1xuICAgIC8vIERlcGVuZHMgb24gYGplbmtzQnJlYWtzKClgIGFuZCBgamVua3NNYXRyaWNlcygpYFxuICAgIGZ1bmN0aW9uIGplbmtzKGRhdGEsIG5fY2xhc3Nlcykge1xuXG4gICAgICAgIGlmIChuX2NsYXNzZXMgPiBkYXRhLmxlbmd0aCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgLy8gc29ydCBkYXRhIGluIG51bWVyaWNhbCBvcmRlciwgc2luY2UgdGhpcyBpcyBleHBlY3RlZFxuICAgICAgICAvLyBieSB0aGUgbWF0cmljZXMgZnVuY3Rpb25cbiAgICAgICAgZGF0YSA9IGRhdGEuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhIC0gYjsgfSk7XG5cbiAgICAgICAgLy8gZ2V0IG91ciBiYXNpYyBtYXRyaWNlc1xuICAgICAgICB2YXIgbWF0cmljZXMgPSBqZW5rc01hdHJpY2VzKGRhdGEsIG5fY2xhc3NlcyksXG4gICAgICAgICAgICAvLyB3ZSBvbmx5IG5lZWQgbG93ZXIgY2xhc3MgbGltaXRzIGhlcmVcbiAgICAgICAgICAgIGxvd2VyX2NsYXNzX2xpbWl0cyA9IG1hdHJpY2VzLmxvd2VyX2NsYXNzX2xpbWl0cztcblxuICAgICAgICAvLyBleHRyYWN0IG5fY2xhc3NlcyBvdXQgb2YgdGhlIGNvbXB1dGVkIG1hdHJpY2VzXG4gICAgICAgIHJldHVybiBqZW5rc0JyZWFrcyhkYXRhLCBsb3dlcl9jbGFzc19saW1pdHMsIG5fY2xhc3Nlcyk7XG5cbiAgICB9XG5cbiAgICAvLyAjIFtTa2V3bmVzc10oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Ta2V3bmVzcylcbiAgICAvL1xuICAgIC8vIEEgbWVhc3VyZSBvZiB0aGUgZXh0ZW50IHRvIHdoaWNoIGEgcHJvYmFiaWxpdHkgZGlzdHJpYnV0aW9uIG9mIGFcbiAgICAvLyByZWFsLXZhbHVlZCByYW5kb20gdmFyaWFibGUgXCJsZWFuc1wiIHRvIG9uZSBzaWRlIG9mIHRoZSBtZWFuLlxuICAgIC8vIFRoZSBza2V3bmVzcyB2YWx1ZSBjYW4gYmUgcG9zaXRpdmUgb3IgbmVnYXRpdmUsIG9yIGV2ZW4gdW5kZWZpbmVkLlxuICAgIC8vXG4gICAgLy8gSW1wbGVtZW50YXRpb24gaXMgYmFzZWQgb24gdGhlIGFkanVzdGVkIEZpc2hlci1QZWFyc29uIHN0YW5kYXJkaXplZFxuICAgIC8vIG1vbWVudCBjb2VmZmljaWVudCwgd2hpY2ggaXMgdGhlIHZlcnNpb24gZm91bmQgaW4gRXhjZWwgYW5kIHNldmVyYWxcbiAgICAvLyBzdGF0aXN0aWNhbCBwYWNrYWdlcyBpbmNsdWRpbmcgTWluaXRhYiwgU0FTIGFuZCBTUFNTLlxuICAgIC8vXG4gICAgLy8gRGVwZW5kcyBvbiBgc3VtX250aF9wb3dlcl9kZXZpYXRpb25zKClgIGFuZCBgc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbmBcbiAgICBmdW5jdGlvbiBzYW1wbGVfc2tld25lc3MoeCkge1xuICAgICAgICAvLyBUaGUgc2tld25lc3Mgb2YgbGVzcyB0aGFuIHRocmVlIGFyZ3VtZW50cyBpcyBudWxsXG4gICAgICAgIGlmICh4Lmxlbmd0aCA8IDMpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHZhciBuID0geC5sZW5ndGgsXG4gICAgICAgICAgICBjdWJlZF9zID0gTWF0aC5wb3coc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbih4KSwgMyksXG4gICAgICAgICAgICBzdW1fY3ViZWRfZGV2aWF0aW9ucyA9IHN1bV9udGhfcG93ZXJfZGV2aWF0aW9ucyh4LCAzKTtcblxuICAgICAgICByZXR1cm4gbiAqIHN1bV9jdWJlZF9kZXZpYXRpb25zIC8gKChuIC0gMSkgKiAobiAtIDIpICogY3ViZWRfcyk7XG4gICAgfVxuXG4gICAgLy8gIyBTdGFuZGFyZCBOb3JtYWwgVGFibGVcbiAgICAvLyBBIHN0YW5kYXJkIG5vcm1hbCB0YWJsZSwgYWxzbyBjYWxsZWQgdGhlIHVuaXQgbm9ybWFsIHRhYmxlIG9yIFogdGFibGUsXG4gICAgLy8gaXMgYSBtYXRoZW1hdGljYWwgdGFibGUgZm9yIHRoZSB2YWx1ZXMgb2YgzqYgKHBoaSksIHdoaWNoIGFyZSB0aGUgdmFsdWVzIG9mXG4gICAgLy8gdGhlIGN1bXVsYXRpdmUgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uIG9mIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uLlxuICAgIC8vIEl0IGlzIHVzZWQgdG8gZmluZCB0aGUgcHJvYmFiaWxpdHkgdGhhdCBhIHN0YXRpc3RpYyBpcyBvYnNlcnZlZCBiZWxvdyxcbiAgICAvLyBhYm92ZSwgb3IgYmV0d2VlbiB2YWx1ZXMgb24gdGhlIHN0YW5kYXJkIG5vcm1hbCBkaXN0cmlidXRpb24sIGFuZCBieVxuICAgIC8vIGV4dGVuc2lvbiwgYW55IG5vcm1hbCBkaXN0cmlidXRpb24uXG4gICAgLy9cbiAgICAvLyBUaGUgcHJvYmFiaWxpdGllcyBhcmUgdGFrZW4gZnJvbSBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1N0YW5kYXJkX25vcm1hbF90YWJsZVxuICAgIC8vIFRoZSB0YWJsZSB1c2VkIGlzIHRoZSBjdW11bGF0aXZlLCBhbmQgbm90IGN1bXVsYXRpdmUgZnJvbSAwIHRvIG1lYW5cbiAgICAvLyAoZXZlbiB0aG91Z2ggdGhlIGxhdHRlciBoYXMgNSBkaWdpdHMgcHJlY2lzaW9uLCBpbnN0ZWFkIG9mIDQpLlxuICAgIHZhciBzdGFuZGFyZF9ub3JtYWxfdGFibGUgPSBbXG4gICAgICAgIC8qICB6ICAgICAgMC4wMCAgICAwLjAxICAgIDAuMDIgICAgMC4wMyAgICAwLjA0ICAgIDAuMDUgICAgMC4wNiAgICAwLjA3ICAgIDAuMDggICAgMC4wOSAqL1xuICAgICAgICAvKiAwLjAgKi9cbiAgICAgICAgMC41MDAwLCAwLjUwNDAsIDAuNTA4MCwgMC41MTIwLCAwLjUxNjAsIDAuNTE5OSwgMC41MjM5LCAwLjUyNzksIDAuNTMxOSwgMC41MzU5LFxuICAgICAgICAvKiAwLjEgKi9cbiAgICAgICAgMC41Mzk4LCAwLjU0MzgsIDAuNTQ3OCwgMC41NTE3LCAwLjU1NTcsIDAuNTU5NiwgMC41NjM2LCAwLjU2NzUsIDAuNTcxNCwgMC41NzUzLFxuICAgICAgICAvKiAwLjIgKi9cbiAgICAgICAgMC41NzkzLCAwLjU4MzIsIDAuNTg3MSwgMC41OTEwLCAwLjU5NDgsIDAuNTk4NywgMC42MDI2LCAwLjYwNjQsIDAuNjEwMywgMC42MTQxLFxuICAgICAgICAvKiAwLjMgKi9cbiAgICAgICAgMC42MTc5LCAwLjYyMTcsIDAuNjI1NSwgMC42MjkzLCAwLjYzMzEsIDAuNjM2OCwgMC42NDA2LCAwLjY0NDMsIDAuNjQ4MCwgMC42NTE3LFxuICAgICAgICAvKiAwLjQgKi9cbiAgICAgICAgMC42NTU0LCAwLjY1OTEsIDAuNjYyOCwgMC42NjY0LCAwLjY3MDAsIDAuNjczNiwgMC42NzcyLCAwLjY4MDgsIDAuNjg0NCwgMC42ODc5LFxuICAgICAgICAvKiAwLjUgKi9cbiAgICAgICAgMC42OTE1LCAwLjY5NTAsIDAuNjk4NSwgMC43MDE5LCAwLjcwNTQsIDAuNzA4OCwgMC43MTIzLCAwLjcxNTcsIDAuNzE5MCwgMC43MjI0LFxuICAgICAgICAvKiAwLjYgKi9cbiAgICAgICAgMC43MjU3LCAwLjcyOTEsIDAuNzMyNCwgMC43MzU3LCAwLjczODksIDAuNzQyMiwgMC43NDU0LCAwLjc0ODYsIDAuNzUxNywgMC43NTQ5LFxuICAgICAgICAvKiAwLjcgKi9cbiAgICAgICAgMC43NTgwLCAwLjc2MTEsIDAuNzY0MiwgMC43NjczLCAwLjc3MDQsIDAuNzczNCwgMC43NzY0LCAwLjc3OTQsIDAuNzgyMywgMC43ODUyLFxuICAgICAgICAvKiAwLjggKi9cbiAgICAgICAgMC43ODgxLCAwLjc5MTAsIDAuNzkzOSwgMC43OTY3LCAwLjc5OTUsIDAuODAyMywgMC44MDUxLCAwLjgwNzgsIDAuODEwNiwgMC44MTMzLFxuICAgICAgICAvKiAwLjkgKi9cbiAgICAgICAgMC44MTU5LCAwLjgxODYsIDAuODIxMiwgMC44MjM4LCAwLjgyNjQsIDAuODI4OSwgMC44MzE1LCAwLjgzNDAsIDAuODM2NSwgMC44Mzg5LFxuICAgICAgICAvKiAxLjAgKi9cbiAgICAgICAgMC44NDEzLCAwLjg0MzgsIDAuODQ2MSwgMC44NDg1LCAwLjg1MDgsIDAuODUzMSwgMC44NTU0LCAwLjg1NzcsIDAuODU5OSwgMC44NjIxLFxuICAgICAgICAvKiAxLjEgKi9cbiAgICAgICAgMC44NjQzLCAwLjg2NjUsIDAuODY4NiwgMC44NzA4LCAwLjg3MjksIDAuODc0OSwgMC44NzcwLCAwLjg3OTAsIDAuODgxMCwgMC44ODMwLFxuICAgICAgICAvKiAxLjIgKi9cbiAgICAgICAgMC44ODQ5LCAwLjg4NjksIDAuODg4OCwgMC44OTA3LCAwLjg5MjUsIDAuODk0NCwgMC44OTYyLCAwLjg5ODAsIDAuODk5NywgMC45MDE1LFxuICAgICAgICAvKiAxLjMgKi9cbiAgICAgICAgMC45MDMyLCAwLjkwNDksIDAuOTA2NiwgMC45MDgyLCAwLjkwOTksIDAuOTExNSwgMC45MTMxLCAwLjkxNDcsIDAuOTE2MiwgMC45MTc3LFxuICAgICAgICAvKiAxLjQgKi9cbiAgICAgICAgMC45MTkyLCAwLjkyMDcsIDAuOTIyMiwgMC45MjM2LCAwLjkyNTEsIDAuOTI2NSwgMC45Mjc5LCAwLjkyOTIsIDAuOTMwNiwgMC45MzE5LFxuICAgICAgICAvKiAxLjUgKi9cbiAgICAgICAgMC45MzMyLCAwLjkzNDUsIDAuOTM1NywgMC45MzcwLCAwLjkzODIsIDAuOTM5NCwgMC45NDA2LCAwLjk0MTgsIDAuOTQyOSwgMC45NDQxLFxuICAgICAgICAvKiAxLjYgKi9cbiAgICAgICAgMC45NDUyLCAwLjk0NjMsIDAuOTQ3NCwgMC45NDg0LCAwLjk0OTUsIDAuOTUwNSwgMC45NTE1LCAwLjk1MjUsIDAuOTUzNSwgMC45NTQ1LFxuICAgICAgICAvKiAxLjcgKi9cbiAgICAgICAgMC45NTU0LCAwLjk1NjQsIDAuOTU3MywgMC45NTgyLCAwLjk1OTEsIDAuOTU5OSwgMC45NjA4LCAwLjk2MTYsIDAuOTYyNSwgMC45NjMzLFxuICAgICAgICAvKiAxLjggKi9cbiAgICAgICAgMC45NjQxLCAwLjk2NDksIDAuOTY1NiwgMC45NjY0LCAwLjk2NzEsIDAuOTY3OCwgMC45Njg2LCAwLjk2OTMsIDAuOTY5OSwgMC45NzA2LFxuICAgICAgICAvKiAxLjkgKi9cbiAgICAgICAgMC45NzEzLCAwLjk3MTksIDAuOTcyNiwgMC45NzMyLCAwLjk3MzgsIDAuOTc0NCwgMC45NzUwLCAwLjk3NTYsIDAuOTc2MSwgMC45NzY3LFxuICAgICAgICAvKiAyLjAgKi9cbiAgICAgICAgMC45NzcyLCAwLjk3NzgsIDAuOTc4MywgMC45Nzg4LCAwLjk3OTMsIDAuOTc5OCwgMC45ODAzLCAwLjk4MDgsIDAuOTgxMiwgMC45ODE3LFxuICAgICAgICAvKiAyLjEgKi9cbiAgICAgICAgMC45ODIxLCAwLjk4MjYsIDAuOTgzMCwgMC45ODM0LCAwLjk4MzgsIDAuOTg0MiwgMC45ODQ2LCAwLjk4NTAsIDAuOTg1NCwgMC45ODU3LFxuICAgICAgICAvKiAyLjIgKi9cbiAgICAgICAgMC45ODYxLCAwLjk4NjQsIDAuOTg2OCwgMC45ODcxLCAwLjk4NzUsIDAuOTg3OCwgMC45ODgxLCAwLjk4ODQsIDAuOTg4NywgMC45ODkwLFxuICAgICAgICAvKiAyLjMgKi9cbiAgICAgICAgMC45ODkzLCAwLjk4OTYsIDAuOTg5OCwgMC45OTAxLCAwLjk5MDQsIDAuOTkwNiwgMC45OTA5LCAwLjk5MTEsIDAuOTkxMywgMC45OTE2LFxuICAgICAgICAvKiAyLjQgKi9cbiAgICAgICAgMC45OTE4LCAwLjk5MjAsIDAuOTkyMiwgMC45OTI1LCAwLjk5MjcsIDAuOTkyOSwgMC45OTMxLCAwLjk5MzIsIDAuOTkzNCwgMC45OTM2LFxuICAgICAgICAvKiAyLjUgKi9cbiAgICAgICAgMC45OTM4LCAwLjk5NDAsIDAuOTk0MSwgMC45OTQzLCAwLjk5NDUsIDAuOTk0NiwgMC45OTQ4LCAwLjk5NDksIDAuOTk1MSwgMC45OTUyLFxuICAgICAgICAvKiAyLjYgKi9cbiAgICAgICAgMC45OTUzLCAwLjk5NTUsIDAuOTk1NiwgMC45OTU3LCAwLjk5NTksIDAuOTk2MCwgMC45OTYxLCAwLjk5NjIsIDAuOTk2MywgMC45OTY0LFxuICAgICAgICAvKiAyLjcgKi9cbiAgICAgICAgMC45OTY1LCAwLjk5NjYsIDAuOTk2NywgMC45OTY4LCAwLjk5NjksIDAuOTk3MCwgMC45OTcxLCAwLjk5NzIsIDAuOTk3MywgMC45OTc0LFxuICAgICAgICAvKiAyLjggKi9cbiAgICAgICAgMC45OTc0LCAwLjk5NzUsIDAuOTk3NiwgMC45OTc3LCAwLjk5NzcsIDAuOTk3OCwgMC45OTc5LCAwLjk5NzksIDAuOTk4MCwgMC45OTgxLFxuICAgICAgICAvKiAyLjkgKi9cbiAgICAgICAgMC45OTgxLCAwLjk5ODIsIDAuOTk4MiwgMC45OTgzLCAwLjk5ODQsIDAuOTk4NCwgMC45OTg1LCAwLjk5ODUsIDAuOTk4NiwgMC45OTg2LFxuICAgICAgICAvKiAzLjAgKi9cbiAgICAgICAgMC45OTg3LCAwLjk5ODcsIDAuOTk4NywgMC45OTg4LCAwLjk5ODgsIDAuOTk4OSwgMC45OTg5LCAwLjk5ODksIDAuOTk5MCwgMC45OTkwXG4gICAgXTtcblxuICAgIC8vICMgW0dhdXNzaWFuIGVycm9yIGZ1bmN0aW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Vycm9yX2Z1bmN0aW9uKVxuICAgIC8vXG4gICAgLy8gVGhlIGVycm9yX2Z1bmN0aW9uKHgvKHNkICogTWF0aC5zcXJ0KDIpKSkgaXMgdGhlIHByb2JhYmlsaXR5IHRoYXQgYSB2YWx1ZSBpbiBhXG4gICAgLy8gbm9ybWFsIGRpc3RyaWJ1dGlvbiB3aXRoIHN0YW5kYXJkIGRldmlhdGlvbiBzZCBpcyB3aXRoaW4geCBvZiB0aGUgbWVhbi5cbiAgICAvL1xuICAgIC8vIFRoaXMgZnVuY3Rpb24gcmV0dXJucyBhIG51bWVyaWNhbCBhcHByb3hpbWF0aW9uIHRvIHRoZSBleGFjdCB2YWx1ZS5cbiAgICBmdW5jdGlvbiBlcnJvcl9mdW5jdGlvbih4KSB7XG4gICAgICAgIHZhciB0ID0gMSAvICgxICsgMC41ICogTWF0aC5hYnMoeCkpO1xuICAgICAgICB2YXIgdGF1ID0gdCAqIE1hdGguZXhwKC1NYXRoLnBvdyh4LCAyKSAtXG4gICAgICAgICAgICAxLjI2NTUxMjIzICtcbiAgICAgICAgICAgIDEuMDAwMDIzNjggKiB0ICtcbiAgICAgICAgICAgIDAuMzc0MDkxOTYgKiBNYXRoLnBvdyh0LCAyKSArXG4gICAgICAgICAgICAwLjA5Njc4NDE4ICogTWF0aC5wb3codCwgMykgLVxuICAgICAgICAgICAgMC4xODYyODgwNiAqIE1hdGgucG93KHQsIDQpICtcbiAgICAgICAgICAgIDAuMjc4ODY4MDcgKiBNYXRoLnBvdyh0LCA1KSAtXG4gICAgICAgICAgICAxLjEzNTIwMzk4ICogTWF0aC5wb3codCwgNikgK1xuICAgICAgICAgICAgMS40ODg1MTU4NyAqIE1hdGgucG93KHQsIDcpIC1cbiAgICAgICAgICAgIDAuODIyMTUyMjMgKiBNYXRoLnBvdyh0LCA4KSArXG4gICAgICAgICAgICAwLjE3MDg3Mjc3ICogTWF0aC5wb3codCwgOSkpO1xuICAgICAgICBpZiAoeCA+PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMSAtIHRhdTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0YXUgLSAxO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gIyBbQ3VtdWxhdGl2ZSBTdGFuZGFyZCBOb3JtYWwgUHJvYmFiaWxpdHldKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU3RhbmRhcmRfbm9ybWFsX3RhYmxlKVxuICAgIC8vXG4gICAgLy8gU2luY2UgcHJvYmFiaWxpdHkgdGFibGVzIGNhbm5vdCBiZVxuICAgIC8vIHByaW50ZWQgZm9yIGV2ZXJ5IG5vcm1hbCBkaXN0cmlidXRpb24sIGFzIHRoZXJlIGFyZSBhbiBpbmZpbml0ZSB2YXJpZXR5XG4gICAgLy8gb2Ygbm9ybWFsIGRpc3RyaWJ1dGlvbnMsIGl0IGlzIGNvbW1vbiBwcmFjdGljZSB0byBjb252ZXJ0IGEgbm9ybWFsIHRvIGFcbiAgICAvLyBzdGFuZGFyZCBub3JtYWwgYW5kIHRoZW4gdXNlIHRoZSBzdGFuZGFyZCBub3JtYWwgdGFibGUgdG8gZmluZCBwcm9iYWJpbGl0aWVzLlxuICAgIC8vXG4gICAgLy8gWW91IGNhbiB1c2UgLjUgKyAuNSAqIGVycm9yX2Z1bmN0aW9uKHggLyBNYXRoLnNxcnQoMikpIHRvIGNhbGN1bGF0ZSB0aGUgcHJvYmFiaWxpdHlcbiAgICAvLyBpbnN0ZWFkIG9mIGxvb2tpbmcgaXQgdXAgaW4gYSB0YWJsZS5cbiAgICBmdW5jdGlvbiBjdW11bGF0aXZlX3N0ZF9ub3JtYWxfcHJvYmFiaWxpdHkoeikge1xuXG4gICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhpcyB2YWx1ZS5cbiAgICAgICAgdmFyIGFic1ogPSBNYXRoLmFicyh6KSxcbiAgICAgICAgICAgIC8vIEVhY2ggcm93IGJlZ2lucyB3aXRoIGEgZGlmZmVyZW50XG4gICAgICAgICAgICAvLyBzaWduaWZpY2FudCBkaWdpdDogMC41LCAwLjYsIDAuNywgYW5kIHNvIG9uLiBFYWNoIHZhbHVlIGluIHRoZSB0YWJsZVxuICAgICAgICAgICAgLy8gY29ycmVzcG9uZHMgdG8gYSByYW5nZSBvZiAwLjAxIGluIHRoZSBpbnB1dCB2YWx1ZXMsIHNvIHRoZSB2YWx1ZSBpc1xuICAgICAgICAgICAgLy8gbXVsdGlwbGllZCBieSAxMDAuXG4gICAgICAgICAgICBpbmRleCA9IE1hdGgubWluKE1hdGgucm91bmQoYWJzWiAqIDEwMCksIHN0YW5kYXJkX25vcm1hbF90YWJsZS5sZW5ndGggLSAxKTtcblxuICAgICAgICAvLyBUaGUgaW5kZXggd2UgY2FsY3VsYXRlIG11c3QgYmUgaW4gdGhlIHRhYmxlIGFzIGEgcG9zaXRpdmUgdmFsdWUsXG4gICAgICAgIC8vIGJ1dCB3ZSBzdGlsbCBwYXkgYXR0ZW50aW9uIHRvIHdoZXRoZXIgdGhlIGlucHV0IGlzIHBvc2l0aXZlXG4gICAgICAgIC8vIG9yIG5lZ2F0aXZlLCBhbmQgZmxpcCB0aGUgb3V0cHV0IHZhbHVlIGFzIGEgbGFzdCBzdGVwLlxuICAgICAgICBpZiAoeiA+PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RhbmRhcmRfbm9ybWFsX3RhYmxlW2luZGV4XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGR1ZSB0byBmbG9hdGluZy1wb2ludCBhcml0aG1ldGljLCB2YWx1ZXMgaW4gdGhlIHRhYmxlIHdpdGhcbiAgICAgICAgICAgIC8vIDQgc2lnbmlmaWNhbnQgZmlndXJlcyBjYW4gbmV2ZXJ0aGVsZXNzIGVuZCB1cCBhcyByZXBlYXRpbmdcbiAgICAgICAgICAgIC8vIGZyYWN0aW9ucyB3aGVuIHRoZXkncmUgY29tcHV0ZWQgaGVyZS5cbiAgICAgICAgICAgIHJldHVybiArKDEgLSBzdGFuZGFyZF9ub3JtYWxfdGFibGVbaW5kZXhdKS50b0ZpeGVkKDQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gIyBbWi1TY29yZSwgb3IgU3RhbmRhcmQgU2NvcmVdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU3RhbmRhcmRfc2NvcmUpXG4gICAgLy9cbiAgICAvLyBUaGUgc3RhbmRhcmQgc2NvcmUgaXMgdGhlIG51bWJlciBvZiBzdGFuZGFyZCBkZXZpYXRpb25zIGFuIG9ic2VydmF0aW9uXG4gICAgLy8gb3IgZGF0dW0gaXMgYWJvdmUgb3IgYmVsb3cgdGhlIG1lYW4uIFRodXMsIGEgcG9zaXRpdmUgc3RhbmRhcmQgc2NvcmVcbiAgICAvLyByZXByZXNlbnRzIGEgZGF0dW0gYWJvdmUgdGhlIG1lYW4sIHdoaWxlIGEgbmVnYXRpdmUgc3RhbmRhcmQgc2NvcmVcbiAgICAvLyByZXByZXNlbnRzIGEgZGF0dW0gYmVsb3cgdGhlIG1lYW4uIEl0IGlzIGEgZGltZW5zaW9ubGVzcyBxdWFudGl0eVxuICAgIC8vIG9idGFpbmVkIGJ5IHN1YnRyYWN0aW5nIHRoZSBwb3B1bGF0aW9uIG1lYW4gZnJvbSBhbiBpbmRpdmlkdWFsIHJhd1xuICAgIC8vIHNjb3JlIGFuZCB0aGVuIGRpdmlkaW5nIHRoZSBkaWZmZXJlbmNlIGJ5IHRoZSBwb3B1bGF0aW9uIHN0YW5kYXJkXG4gICAgLy8gZGV2aWF0aW9uLlxuICAgIC8vXG4gICAgLy8gVGhlIHotc2NvcmUgaXMgb25seSBkZWZpbmVkIGlmIG9uZSBrbm93cyB0aGUgcG9wdWxhdGlvbiBwYXJhbWV0ZXJzO1xuICAgIC8vIGlmIG9uZSBvbmx5IGhhcyBhIHNhbXBsZSBzZXQsIHRoZW4gdGhlIGFuYWxvZ291cyBjb21wdXRhdGlvbiB3aXRoXG4gICAgLy8gc2FtcGxlIG1lYW4gYW5kIHNhbXBsZSBzdGFuZGFyZCBkZXZpYXRpb24geWllbGRzIHRoZVxuICAgIC8vIFN0dWRlbnQncyB0LXN0YXRpc3RpYy5cbiAgICBmdW5jdGlvbiB6X3Njb3JlKHgsIG1lYW4sIHN0YW5kYXJkX2RldmlhdGlvbikge1xuICAgICAgICByZXR1cm4gKHggLSBtZWFuKSAvIHN0YW5kYXJkX2RldmlhdGlvbjtcbiAgICB9XG5cbiAgICAvLyBXZSB1c2UgYM61YCwgZXBzaWxvbiwgYXMgYSBzdG9wcGluZyBjcml0ZXJpb24gd2hlbiB3ZSB3YW50IHRvIGl0ZXJhdGVcbiAgICAvLyB1bnRpbCB3ZSdyZSBcImNsb3NlIGVub3VnaFwiLlxuICAgIHZhciBlcHNpbG9uID0gMC4wMDAxO1xuXG4gICAgLy8gIyBbRmFjdG9yaWFsXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GYWN0b3JpYWwpXG4gICAgLy9cbiAgICAvLyBBIGZhY3RvcmlhbCwgdXN1YWxseSB3cml0dGVuIG4hLCBpcyB0aGUgcHJvZHVjdCBvZiBhbGwgcG9zaXRpdmVcbiAgICAvLyBpbnRlZ2VycyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gbi4gT2Z0ZW4gZmFjdG9yaWFsIGlzIGltcGxlbWVudGVkXG4gICAgLy8gcmVjdXJzaXZlbHksIGJ1dCB0aGlzIGl0ZXJhdGl2ZSBhcHByb2FjaCBpcyBzaWduaWZpY2FudGx5IGZhc3RlclxuICAgIC8vIGFuZCBzaW1wbGVyLlxuICAgIGZ1bmN0aW9uIGZhY3RvcmlhbChuKSB7XG5cbiAgICAgICAgLy8gZmFjdG9yaWFsIGlzIG1hdGhlbWF0aWNhbGx5IHVuZGVmaW5lZCBmb3IgbmVnYXRpdmUgbnVtYmVyc1xuICAgICAgICBpZiAobiA8IDAgKSB7IHJldHVybiBudWxsOyB9XG5cbiAgICAgICAgLy8gdHlwaWNhbGx5IHlvdSdsbCBleHBhbmQgdGhlIGZhY3RvcmlhbCBmdW5jdGlvbiBnb2luZyBkb3duLCBsaWtlXG4gICAgICAgIC8vIDUhID0gNSAqIDQgKiAzICogMiAqIDEuIFRoaXMgaXMgZ29pbmcgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbixcbiAgICAgICAgLy8gY291bnRpbmcgZnJvbSAyIHVwIHRvIHRoZSBudW1iZXIgaW4gcXVlc3Rpb24sIGFuZCBzaW5jZSBhbnl0aGluZ1xuICAgICAgICAvLyBtdWx0aXBsaWVkIGJ5IDEgaXMgaXRzZWxmLCB0aGUgbG9vcCBvbmx5IG5lZWRzIHRvIHN0YXJ0IGF0IDIuXG4gICAgICAgIHZhciBhY2N1bXVsYXRvciA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAyOyBpIDw9IG47IGkrKykge1xuICAgICAgICAgICAgLy8gZm9yIGVhY2ggbnVtYmVyIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhlIG51bWJlciBgbmAsIG11bHRpcGx5XG4gICAgICAgICAgICAvLyB0aGUgYWNjdW11bGF0b3IgbXkgdGhhdCBudW1iZXIuXG4gICAgICAgICAgICBhY2N1bXVsYXRvciAqPSBpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICB9XG5cbiAgICAvLyAjIEJlcm5vdWxsaSBEaXN0cmlidXRpb25cbiAgICAvL1xuICAgIC8vIFRoZSBbQmVybm91bGxpIGRpc3RyaWJ1dGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9CZXJub3VsbGlfZGlzdHJpYnV0aW9uKVxuICAgIC8vIGlzIHRoZSBwcm9iYWJpbGl0eSBkaXNjcmV0ZVxuICAgIC8vIGRpc3RyaWJ1dGlvbiBvZiBhIHJhbmRvbSB2YXJpYWJsZSB3aGljaCB0YWtlcyB2YWx1ZSAxIHdpdGggc3VjY2Vzc1xuICAgIC8vIHByb2JhYmlsaXR5IGBwYCBhbmQgdmFsdWUgMCB3aXRoIGZhaWx1cmVcbiAgICAvLyBwcm9iYWJpbGl0eSBgcWAgPSAxIC0gYHBgLiBJdCBjYW4gYmUgdXNlZCwgZm9yIGV4YW1wbGUsIHRvIHJlcHJlc2VudCB0aGVcbiAgICAvLyB0b3NzIG9mIGEgY29pbiwgd2hlcmUgXCIxXCIgaXMgZGVmaW5lZCB0byBtZWFuIFwiaGVhZHNcIiBhbmQgXCIwXCIgaXMgZGVmaW5lZFxuICAgIC8vIHRvIG1lYW4gXCJ0YWlsc1wiIChvciB2aWNlIHZlcnNhKS4gSXQgaXNcbiAgICAvLyBhIHNwZWNpYWwgY2FzZSBvZiBhIEJpbm9taWFsIERpc3RyaWJ1dGlvblxuICAgIC8vIHdoZXJlIGBuYCA9IDEuXG4gICAgZnVuY3Rpb24gYmVybm91bGxpX2Rpc3RyaWJ1dGlvbihwKSB7XG4gICAgICAgIC8vIENoZWNrIHRoYXQgYHBgIGlzIGEgdmFsaWQgcHJvYmFiaWxpdHkgKDAg4omkIHAg4omkIDEpXG4gICAgICAgIGlmIChwIDwgMCB8fCBwID4gMSApIHsgcmV0dXJuIG51bGw7IH1cblxuICAgICAgICByZXR1cm4gYmlub21pYWxfZGlzdHJpYnV0aW9uKDEsIHApO1xuICAgIH1cblxuICAgIC8vICMgQmlub21pYWwgRGlzdHJpYnV0aW9uXG4gICAgLy9cbiAgICAvLyBUaGUgW0Jpbm9taWFsIERpc3RyaWJ1dGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9CaW5vbWlhbF9kaXN0cmlidXRpb24pIGlzIHRoZSBkaXNjcmV0ZSBwcm9iYWJpbGl0eVxuICAgIC8vIGRpc3RyaWJ1dGlvbiBvZiB0aGUgbnVtYmVyIG9mIHN1Y2Nlc3NlcyBpbiBhIHNlcXVlbmNlIG9mIG4gaW5kZXBlbmRlbnQgeWVzL25vIGV4cGVyaW1lbnRzLCBlYWNoIG9mIHdoaWNoIHlpZWxkc1xuICAgIC8vIHN1Y2Nlc3Mgd2l0aCBwcm9iYWJpbGl0eSBgcHJvYmFiaWxpdHlgLiBTdWNoIGEgc3VjY2Vzcy9mYWlsdXJlIGV4cGVyaW1lbnQgaXMgYWxzbyBjYWxsZWQgYSBCZXJub3VsbGkgZXhwZXJpbWVudCBvclxuICAgIC8vIEJlcm5vdWxsaSB0cmlhbDsgd2hlbiB0cmlhbHMgPSAxLCB0aGUgQmlub21pYWwgRGlzdHJpYnV0aW9uIGlzIGEgQmVybm91bGxpIERpc3RyaWJ1dGlvbi5cbiAgICBmdW5jdGlvbiBiaW5vbWlhbF9kaXN0cmlidXRpb24odHJpYWxzLCBwcm9iYWJpbGl0eSkge1xuICAgICAgICAvLyBDaGVjayB0aGF0IGBwYCBpcyBhIHZhbGlkIHByb2JhYmlsaXR5ICgwIOKJpCBwIOKJpCAxKSxcbiAgICAgICAgLy8gdGhhdCBgbmAgaXMgYW4gaW50ZWdlciwgc3RyaWN0bHkgcG9zaXRpdmUuXG4gICAgICAgIGlmIChwcm9iYWJpbGl0eSA8IDAgfHwgcHJvYmFiaWxpdHkgPiAxIHx8XG4gICAgICAgICAgICB0cmlhbHMgPD0gMCB8fCB0cmlhbHMgJSAxICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGEgW3Byb2JhYmlsaXR5IG1hc3MgZnVuY3Rpb25dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1Byb2JhYmlsaXR5X21hc3NfZnVuY3Rpb24pXG4gICAgICAgIGZ1bmN0aW9uIHByb2JhYmlsaXR5X21hc3MoeCwgdHJpYWxzLCBwcm9iYWJpbGl0eSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhY3RvcmlhbCh0cmlhbHMpIC9cbiAgICAgICAgICAgICAgICAoZmFjdG9yaWFsKHgpICogZmFjdG9yaWFsKHRyaWFscyAtIHgpKSAqXG4gICAgICAgICAgICAgICAgKE1hdGgucG93KHByb2JhYmlsaXR5LCB4KSAqIE1hdGgucG93KDEgLSBwcm9iYWJpbGl0eSwgdHJpYWxzIC0geCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gV2UgaW5pdGlhbGl6ZSBgeGAsIHRoZSByYW5kb20gdmFyaWFibGUsIGFuZCBgYWNjdW11bGF0b3JgLCBhbiBhY2N1bXVsYXRvclxuICAgICAgICAvLyBmb3IgdGhlIGN1bXVsYXRpdmUgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uIHRvIDAuIGBkaXN0cmlidXRpb25fZnVuY3Rpb25zYFxuICAgICAgICAvLyBpcyB0aGUgb2JqZWN0IHdlJ2xsIHJldHVybiB3aXRoIHRoZSBgcHJvYmFiaWxpdHlfb2ZfeGAgYW5kIHRoZVxuICAgICAgICAvLyBgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eV9vZl94YCwgYXMgd2VsbCBhcyB0aGUgY2FsY3VsYXRlZCBtZWFuICZcbiAgICAgICAgLy8gdmFyaWFuY2UuIFdlIGl0ZXJhdGUgdW50aWwgdGhlIGBjdW11bGF0aXZlX3Byb2JhYmlsaXR5X29mX3hgIGlzXG4gICAgICAgIC8vIHdpdGhpbiBgZXBzaWxvbmAgb2YgMS4wLlxuICAgICAgICB2YXIgeCA9IDAsXG4gICAgICAgICAgICBjdW11bGF0aXZlX3Byb2JhYmlsaXR5ID0gMCxcbiAgICAgICAgICAgIGNlbGxzID0ge307XG5cbiAgICAgICAgLy8gVGhpcyBhbGdvcml0aG0gaXRlcmF0ZXMgdGhyb3VnaCBlYWNoIHBvdGVudGlhbCBvdXRjb21lLFxuICAgICAgICAvLyB1bnRpbCB0aGUgYGN1bXVsYXRpdmVfcHJvYmFiaWxpdHlgIGlzIHZlcnkgY2xvc2UgdG8gMSwgYXRcbiAgICAgICAgLy8gd2hpY2ggcG9pbnQgd2UndmUgZGVmaW5lZCB0aGUgdmFzdCBtYWpvcml0eSBvZiBvdXRjb21lc1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBjZWxsc1t4XSA9IHByb2JhYmlsaXR5X21hc3MoeCwgdHJpYWxzLCBwcm9iYWJpbGl0eSk7XG4gICAgICAgICAgICBjdW11bGF0aXZlX3Byb2JhYmlsaXR5ICs9IGNlbGxzW3hdO1xuICAgICAgICAgICAgeCsrO1xuICAgICAgICAvLyB3aGVuIHRoZSBjdW11bGF0aXZlX3Byb2JhYmlsaXR5IGlzIG5lYXJseSAxLCB3ZSd2ZSBjYWxjdWxhdGVkXG4gICAgICAgIC8vIHRoZSB1c2VmdWwgcmFuZ2Ugb2YgdGhpcyBkaXN0cmlidXRpb25cbiAgICAgICAgfSB3aGlsZSAoY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eSA8IDEgLSBlcHNpbG9uKTtcblxuICAgICAgICByZXR1cm4gY2VsbHM7XG4gICAgfVxuXG4gICAgLy8gIyBQb2lzc29uIERpc3RyaWJ1dGlvblxuICAgIC8vXG4gICAgLy8gVGhlIFtQb2lzc29uIERpc3RyaWJ1dGlvbl0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Qb2lzc29uX2Rpc3RyaWJ1dGlvbilcbiAgICAvLyBpcyBhIGRpc2NyZXRlIHByb2JhYmlsaXR5IGRpc3RyaWJ1dGlvbiB0aGF0IGV4cHJlc3NlcyB0aGUgcHJvYmFiaWxpdHlcbiAgICAvLyBvZiBhIGdpdmVuIG51bWJlciBvZiBldmVudHMgb2NjdXJyaW5nIGluIGEgZml4ZWQgaW50ZXJ2YWwgb2YgdGltZVxuICAgIC8vIGFuZC9vciBzcGFjZSBpZiB0aGVzZSBldmVudHMgb2NjdXIgd2l0aCBhIGtub3duIGF2ZXJhZ2UgcmF0ZSBhbmRcbiAgICAvLyBpbmRlcGVuZGVudGx5IG9mIHRoZSB0aW1lIHNpbmNlIHRoZSBsYXN0IGV2ZW50LlxuICAgIC8vXG4gICAgLy8gVGhlIFBvaXNzb24gRGlzdHJpYnV0aW9uIGlzIGNoYXJhY3Rlcml6ZWQgYnkgdGhlIHN0cmljdGx5IHBvc2l0aXZlXG4gICAgLy8gbWVhbiBhcnJpdmFsIG9yIG9jY3VycmVuY2UgcmF0ZSwgYM67YC5cbiAgICBmdW5jdGlvbiBwb2lzc29uX2Rpc3RyaWJ1dGlvbihsYW1iZGEpIHtcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCBsYW1iZGEgaXMgc3RyaWN0bHkgcG9zaXRpdmVcbiAgICAgICAgaWYgKGxhbWJkYSA8PSAwKSB7IHJldHVybiBudWxsOyB9XG5cbiAgICAgICAgLy8gb3VyIGN1cnJlbnQgcGxhY2UgaW4gdGhlIGRpc3RyaWJ1dGlvblxuICAgICAgICB2YXIgeCA9IDAsXG4gICAgICAgICAgICAvLyBhbmQgd2Uga2VlcCB0cmFjayBvZiB0aGUgY3VycmVudCBjdW11bGF0aXZlIHByb2JhYmlsaXR5LCBpblxuICAgICAgICAgICAgLy8gb3JkZXIgdG8ga25vdyB3aGVuIHRvIHN0b3AgY2FsY3VsYXRpbmcgY2hhbmNlcy5cbiAgICAgICAgICAgIGN1bXVsYXRpdmVfcHJvYmFiaWxpdHkgPSAwLFxuICAgICAgICAgICAgLy8gdGhlIGNhbGN1bGF0ZWQgY2VsbHMgdG8gYmUgcmV0dXJuZWRcbiAgICAgICAgICAgIGNlbGxzID0ge307XG5cbiAgICAgICAgLy8gYSBbcHJvYmFiaWxpdHkgbWFzcyBmdW5jdGlvbl0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUHJvYmFiaWxpdHlfbWFzc19mdW5jdGlvbilcbiAgICAgICAgZnVuY3Rpb24gcHJvYmFiaWxpdHlfbWFzcyh4LCBsYW1iZGEpIHtcbiAgICAgICAgICAgIHJldHVybiAoTWF0aC5wb3coTWF0aC5FLCAtbGFtYmRhKSAqIE1hdGgucG93KGxhbWJkYSwgeCkpIC9cbiAgICAgICAgICAgICAgICBmYWN0b3JpYWwoeCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUaGlzIGFsZ29yaXRobSBpdGVyYXRlcyB0aHJvdWdoIGVhY2ggcG90ZW50aWFsIG91dGNvbWUsXG4gICAgICAgIC8vIHVudGlsIHRoZSBgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eWAgaXMgdmVyeSBjbG9zZSB0byAxLCBhdFxuICAgICAgICAvLyB3aGljaCBwb2ludCB3ZSd2ZSBkZWZpbmVkIHRoZSB2YXN0IG1ham9yaXR5IG9mIG91dGNvbWVzXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGNlbGxzW3hdID0gcHJvYmFiaWxpdHlfbWFzcyh4LCBsYW1iZGEpO1xuICAgICAgICAgICAgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eSArPSBjZWxsc1t4XTtcbiAgICAgICAgICAgIHgrKztcbiAgICAgICAgLy8gd2hlbiB0aGUgY3VtdWxhdGl2ZV9wcm9iYWJpbGl0eSBpcyBuZWFybHkgMSwgd2UndmUgY2FsY3VsYXRlZFxuICAgICAgICAvLyB0aGUgdXNlZnVsIHJhbmdlIG9mIHRoaXMgZGlzdHJpYnV0aW9uXG4gICAgICAgIH0gd2hpbGUgKGN1bXVsYXRpdmVfcHJvYmFiaWxpdHkgPCAxIC0gZXBzaWxvbik7XG5cbiAgICAgICAgcmV0dXJuIGNlbGxzO1xuICAgIH1cblxuICAgIC8vICMgUGVyY2VudGFnZSBQb2ludHMgb2YgdGhlIM+HMiAoQ2hpLVNxdWFyZWQpIERpc3RyaWJ1dGlvblxuICAgIC8vIFRoZSBbz4cyIChDaGktU3F1YXJlZCkgRGlzdHJpYnV0aW9uXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NoaS1zcXVhcmVkX2Rpc3RyaWJ1dGlvbikgaXMgdXNlZCBpbiB0aGUgY29tbW9uXG4gICAgLy8gY2hpLXNxdWFyZWQgdGVzdHMgZm9yIGdvb2RuZXNzIG9mIGZpdCBvZiBhbiBvYnNlcnZlZCBkaXN0cmlidXRpb24gdG8gYSB0aGVvcmV0aWNhbCBvbmUsIHRoZSBpbmRlcGVuZGVuY2Ugb2YgdHdvXG4gICAgLy8gY3JpdGVyaWEgb2YgY2xhc3NpZmljYXRpb24gb2YgcXVhbGl0YXRpdmUgZGF0YSwgYW5kIGluIGNvbmZpZGVuY2UgaW50ZXJ2YWwgZXN0aW1hdGlvbiBmb3IgYSBwb3B1bGF0aW9uIHN0YW5kYXJkXG4gICAgLy8gZGV2aWF0aW9uIG9mIGEgbm9ybWFsIGRpc3RyaWJ1dGlvbiBmcm9tIGEgc2FtcGxlIHN0YW5kYXJkIGRldmlhdGlvbi5cbiAgICAvL1xuICAgIC8vIFZhbHVlcyBmcm9tIEFwcGVuZGl4IDEsIFRhYmxlIElJSSBvZiBXaWxsaWFtIFcuIEhpbmVzICYgRG91Z2xhcyBDLiBNb250Z29tZXJ5LCBcIlByb2JhYmlsaXR5IGFuZCBTdGF0aXN0aWNzIGluXG4gICAgLy8gRW5naW5lZXJpbmcgYW5kIE1hbmFnZW1lbnQgU2NpZW5jZVwiLCBXaWxleSAoMTk4MCkuXG4gICAgdmFyIGNoaV9zcXVhcmVkX2Rpc3RyaWJ1dGlvbl90YWJsZSA9IHtcbiAgICAgICAgMTogeyAwLjk5NTogIDAuMDAsIDAuOTk6ICAwLjAwLCAwLjk3NTogIDAuMDAsIDAuOTU6ICAwLjAwLCAwLjk6ICAwLjAyLCAwLjU6ICAwLjQ1LCAwLjE6ICAyLjcxLCAwLjA1OiAgMy44NCwgMC4wMjU6ICA1LjAyLCAwLjAxOiAgNi42MywgMC4wMDU6ICA3Ljg4IH0sXG4gICAgICAgIDI6IHsgMC45OTU6ICAwLjAxLCAwLjk5OiAgMC4wMiwgMC45NzU6ICAwLjA1LCAwLjk1OiAgMC4xMCwgMC45OiAgMC4yMSwgMC41OiAgMS4zOSwgMC4xOiAgNC42MSwgMC4wNTogIDUuOTksIDAuMDI1OiAgNy4zOCwgMC4wMTogIDkuMjEsIDAuMDA1OiAxMC42MCB9LFxuICAgICAgICAzOiB7IDAuOTk1OiAgMC4wNywgMC45OTogIDAuMTEsIDAuOTc1OiAgMC4yMiwgMC45NTogIDAuMzUsIDAuOTogIDAuNTgsIDAuNTogIDIuMzcsIDAuMTogIDYuMjUsIDAuMDU6ICA3LjgxLCAwLjAyNTogIDkuMzUsIDAuMDE6IDExLjM0LCAwLjAwNTogMTIuODQgfSxcbiAgICAgICAgNDogeyAwLjk5NTogIDAuMjEsIDAuOTk6ICAwLjMwLCAwLjk3NTogIDAuNDgsIDAuOTU6ICAwLjcxLCAwLjk6ICAxLjA2LCAwLjU6ICAzLjM2LCAwLjE6ICA3Ljc4LCAwLjA1OiAgOS40OSwgMC4wMjU6IDExLjE0LCAwLjAxOiAxMy4yOCwgMC4wMDU6IDE0Ljg2IH0sXG4gICAgICAgIDU6IHsgMC45OTU6ICAwLjQxLCAwLjk5OiAgMC41NSwgMC45NzU6ICAwLjgzLCAwLjk1OiAgMS4xNSwgMC45OiAgMS42MSwgMC41OiAgNC4zNSwgMC4xOiAgOS4yNCwgMC4wNTogMTEuMDcsIDAuMDI1OiAxMi44MywgMC4wMTogMTUuMDksIDAuMDA1OiAxNi43NSB9LFxuICAgICAgICA2OiB7IDAuOTk1OiAgMC42OCwgMC45OTogIDAuODcsIDAuOTc1OiAgMS4yNCwgMC45NTogIDEuNjQsIDAuOTogIDIuMjAsIDAuNTogIDUuMzUsIDAuMTogMTAuNjUsIDAuMDU6IDEyLjU5LCAwLjAyNTogMTQuNDUsIDAuMDE6IDE2LjgxLCAwLjAwNTogMTguNTUgfSxcbiAgICAgICAgNzogeyAwLjk5NTogIDAuOTksIDAuOTk6ICAxLjI1LCAwLjk3NTogIDEuNjksIDAuOTU6ICAyLjE3LCAwLjk6ICAyLjgzLCAwLjU6ICA2LjM1LCAwLjE6IDEyLjAyLCAwLjA1OiAxNC4wNywgMC4wMjU6IDE2LjAxLCAwLjAxOiAxOC40OCwgMC4wMDU6IDIwLjI4IH0sXG4gICAgICAgIDg6IHsgMC45OTU6ICAxLjM0LCAwLjk5OiAgMS42NSwgMC45NzU6ICAyLjE4LCAwLjk1OiAgMi43MywgMC45OiAgMy40OSwgMC41OiAgNy4zNCwgMC4xOiAxMy4zNiwgMC4wNTogMTUuNTEsIDAuMDI1OiAxNy41MywgMC4wMTogMjAuMDksIDAuMDA1OiAyMS45NiB9LFxuICAgICAgICA5OiB7IDAuOTk1OiAgMS43MywgMC45OTogIDIuMDksIDAuOTc1OiAgMi43MCwgMC45NTogIDMuMzMsIDAuOTogIDQuMTcsIDAuNTogIDguMzQsIDAuMTogMTQuNjgsIDAuMDU6IDE2LjkyLCAwLjAyNTogMTkuMDIsIDAuMDE6IDIxLjY3LCAwLjAwNTogMjMuNTkgfSxcbiAgICAgICAgMTA6IHsgMC45OTU6ICAyLjE2LCAwLjk5OiAgMi41NiwgMC45NzU6ICAzLjI1LCAwLjk1OiAgMy45NCwgMC45OiAgNC44NywgMC41OiAgOS4zNCwgMC4xOiAxNS45OSwgMC4wNTogMTguMzEsIDAuMDI1OiAyMC40OCwgMC4wMTogMjMuMjEsIDAuMDA1OiAyNS4xOSB9LFxuICAgICAgICAxMTogeyAwLjk5NTogIDIuNjAsIDAuOTk6ICAzLjA1LCAwLjk3NTogIDMuODIsIDAuOTU6ICA0LjU3LCAwLjk6ICA1LjU4LCAwLjU6IDEwLjM0LCAwLjE6IDE3LjI4LCAwLjA1OiAxOS42OCwgMC4wMjU6IDIxLjkyLCAwLjAxOiAyNC43MiwgMC4wMDU6IDI2Ljc2IH0sXG4gICAgICAgIDEyOiB7IDAuOTk1OiAgMy4wNywgMC45OTogIDMuNTcsIDAuOTc1OiAgNC40MCwgMC45NTogIDUuMjMsIDAuOTogIDYuMzAsIDAuNTogMTEuMzQsIDAuMTogMTguNTUsIDAuMDU6IDIxLjAzLCAwLjAyNTogMjMuMzQsIDAuMDE6IDI2LjIyLCAwLjAwNTogMjguMzAgfSxcbiAgICAgICAgMTM6IHsgMC45OTU6ICAzLjU3LCAwLjk5OiAgNC4xMSwgMC45NzU6ICA1LjAxLCAwLjk1OiAgNS44OSwgMC45OiAgNy4wNCwgMC41OiAxMi4zNCwgMC4xOiAxOS44MSwgMC4wNTogMjIuMzYsIDAuMDI1OiAyNC43NCwgMC4wMTogMjcuNjksIDAuMDA1OiAyOS44MiB9LFxuICAgICAgICAxNDogeyAwLjk5NTogIDQuMDcsIDAuOTk6ICA0LjY2LCAwLjk3NTogIDUuNjMsIDAuOTU6ICA2LjU3LCAwLjk6ICA3Ljc5LCAwLjU6IDEzLjM0LCAwLjE6IDIxLjA2LCAwLjA1OiAyMy42OCwgMC4wMjU6IDI2LjEyLCAwLjAxOiAyOS4xNCwgMC4wMDU6IDMxLjMyIH0sXG4gICAgICAgIDE1OiB7IDAuOTk1OiAgNC42MCwgMC45OTogIDUuMjMsIDAuOTc1OiAgNi4yNywgMC45NTogIDcuMjYsIDAuOTogIDguNTUsIDAuNTogMTQuMzQsIDAuMTogMjIuMzEsIDAuMDU6IDI1LjAwLCAwLjAyNTogMjcuNDksIDAuMDE6IDMwLjU4LCAwLjAwNTogMzIuODAgfSxcbiAgICAgICAgMTY6IHsgMC45OTU6ICA1LjE0LCAwLjk5OiAgNS44MSwgMC45NzU6ICA2LjkxLCAwLjk1OiAgNy45NiwgMC45OiAgOS4zMSwgMC41OiAxNS4zNCwgMC4xOiAyMy41NCwgMC4wNTogMjYuMzAsIDAuMDI1OiAyOC44NSwgMC4wMTogMzIuMDAsIDAuMDA1OiAzNC4yNyB9LFxuICAgICAgICAxNzogeyAwLjk5NTogIDUuNzAsIDAuOTk6ICA2LjQxLCAwLjk3NTogIDcuNTYsIDAuOTU6ICA4LjY3LCAwLjk6IDEwLjA5LCAwLjU6IDE2LjM0LCAwLjE6IDI0Ljc3LCAwLjA1OiAyNy41OSwgMC4wMjU6IDMwLjE5LCAwLjAxOiAzMy40MSwgMC4wMDU6IDM1LjcyIH0sXG4gICAgICAgIDE4OiB7IDAuOTk1OiAgNi4yNiwgMC45OTogIDcuMDEsIDAuOTc1OiAgOC4yMywgMC45NTogIDkuMzksIDAuOTogMTAuODcsIDAuNTogMTcuMzQsIDAuMTogMjUuOTksIDAuMDU6IDI4Ljg3LCAwLjAyNTogMzEuNTMsIDAuMDE6IDM0LjgxLCAwLjAwNTogMzcuMTYgfSxcbiAgICAgICAgMTk6IHsgMC45OTU6ICA2Ljg0LCAwLjk5OiAgNy42MywgMC45NzU6ICA4LjkxLCAwLjk1OiAxMC4xMiwgMC45OiAxMS42NSwgMC41OiAxOC4zNCwgMC4xOiAyNy4yMCwgMC4wNTogMzAuMTQsIDAuMDI1OiAzMi44NSwgMC4wMTogMzYuMTksIDAuMDA1OiAzOC41OCB9LFxuICAgICAgICAyMDogeyAwLjk5NTogIDcuNDMsIDAuOTk6ICA4LjI2LCAwLjk3NTogIDkuNTksIDAuOTU6IDEwLjg1LCAwLjk6IDEyLjQ0LCAwLjU6IDE5LjM0LCAwLjE6IDI4LjQxLCAwLjA1OiAzMS40MSwgMC4wMjU6IDM0LjE3LCAwLjAxOiAzNy41NywgMC4wMDU6IDQwLjAwIH0sXG4gICAgICAgIDIxOiB7IDAuOTk1OiAgOC4wMywgMC45OTogIDguOTAsIDAuOTc1OiAxMC4yOCwgMC45NTogMTEuNTksIDAuOTogMTMuMjQsIDAuNTogMjAuMzQsIDAuMTogMjkuNjIsIDAuMDU6IDMyLjY3LCAwLjAyNTogMzUuNDgsIDAuMDE6IDM4LjkzLCAwLjAwNTogNDEuNDAgfSxcbiAgICAgICAgMjI6IHsgMC45OTU6ICA4LjY0LCAwLjk5OiAgOS41NCwgMC45NzU6IDEwLjk4LCAwLjk1OiAxMi4zNCwgMC45OiAxNC4wNCwgMC41OiAyMS4zNCwgMC4xOiAzMC44MSwgMC4wNTogMzMuOTIsIDAuMDI1OiAzNi43OCwgMC4wMTogNDAuMjksIDAuMDA1OiA0Mi44MCB9LFxuICAgICAgICAyMzogeyAwLjk5NTogIDkuMjYsIDAuOTk6IDEwLjIwLCAwLjk3NTogMTEuNjksIDAuOTU6IDEzLjA5LCAwLjk6IDE0Ljg1LCAwLjU6IDIyLjM0LCAwLjE6IDMyLjAxLCAwLjA1OiAzNS4xNywgMC4wMjU6IDM4LjA4LCAwLjAxOiA0MS42NCwgMC4wMDU6IDQ0LjE4IH0sXG4gICAgICAgIDI0OiB7IDAuOTk1OiAgOS44OSwgMC45OTogMTAuODYsIDAuOTc1OiAxMi40MCwgMC45NTogMTMuODUsIDAuOTogMTUuNjYsIDAuNTogMjMuMzQsIDAuMTogMzMuMjAsIDAuMDU6IDM2LjQyLCAwLjAyNTogMzkuMzYsIDAuMDE6IDQyLjk4LCAwLjAwNTogNDUuNTYgfSxcbiAgICAgICAgMjU6IHsgMC45OTU6IDEwLjUyLCAwLjk5OiAxMS41MiwgMC45NzU6IDEzLjEyLCAwLjk1OiAxNC42MSwgMC45OiAxNi40NywgMC41OiAyNC4zNCwgMC4xOiAzNC4yOCwgMC4wNTogMzcuNjUsIDAuMDI1OiA0MC42NSwgMC4wMTogNDQuMzEsIDAuMDA1OiA0Ni45MyB9LFxuICAgICAgICAyNjogeyAwLjk5NTogMTEuMTYsIDAuOTk6IDEyLjIwLCAwLjk3NTogMTMuODQsIDAuOTU6IDE1LjM4LCAwLjk6IDE3LjI5LCAwLjU6IDI1LjM0LCAwLjE6IDM1LjU2LCAwLjA1OiAzOC44OSwgMC4wMjU6IDQxLjkyLCAwLjAxOiA0NS42NCwgMC4wMDU6IDQ4LjI5IH0sXG4gICAgICAgIDI3OiB7IDAuOTk1OiAxMS44MSwgMC45OTogMTIuODgsIDAuOTc1OiAxNC41NywgMC45NTogMTYuMTUsIDAuOTogMTguMTEsIDAuNTogMjYuMzQsIDAuMTogMzYuNzQsIDAuMDU6IDQwLjExLCAwLjAyNTogNDMuMTksIDAuMDE6IDQ2Ljk2LCAwLjAwNTogNDkuNjUgfSxcbiAgICAgICAgMjg6IHsgMC45OTU6IDEyLjQ2LCAwLjk5OiAxMy41NywgMC45NzU6IDE1LjMxLCAwLjk1OiAxNi45MywgMC45OiAxOC45NCwgMC41OiAyNy4zNCwgMC4xOiAzNy45MiwgMC4wNTogNDEuMzQsIDAuMDI1OiA0NC40NiwgMC4wMTogNDguMjgsIDAuMDA1OiA1MC45OSB9LFxuICAgICAgICAyOTogeyAwLjk5NTogMTMuMTIsIDAuOTk6IDE0LjI2LCAwLjk3NTogMTYuMDUsIDAuOTU6IDE3LjcxLCAwLjk6IDE5Ljc3LCAwLjU6IDI4LjM0LCAwLjE6IDM5LjA5LCAwLjA1OiA0Mi41NiwgMC4wMjU6IDQ1LjcyLCAwLjAxOiA0OS41OSwgMC4wMDU6IDUyLjM0IH0sXG4gICAgICAgIDMwOiB7IDAuOTk1OiAxMy43OSwgMC45OTogMTQuOTUsIDAuOTc1OiAxNi43OSwgMC45NTogMTguNDksIDAuOTogMjAuNjAsIDAuNTogMjkuMzQsIDAuMTogNDAuMjYsIDAuMDU6IDQzLjc3LCAwLjAyNTogNDYuOTgsIDAuMDE6IDUwLjg5LCAwLjAwNTogNTMuNjcgfSxcbiAgICAgICAgNDA6IHsgMC45OTU6IDIwLjcxLCAwLjk5OiAyMi4xNiwgMC45NzU6IDI0LjQzLCAwLjk1OiAyNi41MSwgMC45OiAyOS4wNSwgMC41OiAzOS4zNCwgMC4xOiA1MS44MSwgMC4wNTogNTUuNzYsIDAuMDI1OiA1OS4zNCwgMC4wMTogNjMuNjksIDAuMDA1OiA2Ni43NyB9LFxuICAgICAgICA1MDogeyAwLjk5NTogMjcuOTksIDAuOTk6IDI5LjcxLCAwLjk3NTogMzIuMzYsIDAuOTU6IDM0Ljc2LCAwLjk6IDM3LjY5LCAwLjU6IDQ5LjMzLCAwLjE6IDYzLjE3LCAwLjA1OiA2Ny41MCwgMC4wMjU6IDcxLjQyLCAwLjAxOiA3Ni4xNSwgMC4wMDU6IDc5LjQ5IH0sXG4gICAgICAgIDYwOiB7IDAuOTk1OiAzNS41MywgMC45OTogMzcuNDgsIDAuOTc1OiA0MC40OCwgMC45NTogNDMuMTksIDAuOTogNDYuNDYsIDAuNTogNTkuMzMsIDAuMTogNzQuNDAsIDAuMDU6IDc5LjA4LCAwLjAyNTogODMuMzAsIDAuMDE6IDg4LjM4LCAwLjAwNTogOTEuOTUgfSxcbiAgICAgICAgNzA6IHsgMC45OTU6IDQzLjI4LCAwLjk5OiA0NS40NCwgMC45NzU6IDQ4Ljc2LCAwLjk1OiA1MS43NCwgMC45OiA1NS4zMywgMC41OiA2OS4zMywgMC4xOiA4NS41MywgMC4wNTogOTAuNTMsIDAuMDI1OiA5NS4wMiwgMC4wMTogMTAwLjQyLCAwLjAwNTogMTA0LjIyIH0sXG4gICAgICAgIDgwOiB7IDAuOTk1OiA1MS4xNywgMC45OTogNTMuNTQsIDAuOTc1OiA1Ny4xNSwgMC45NTogNjAuMzksIDAuOTogNjQuMjgsIDAuNTogNzkuMzMsIDAuMTogOTYuNTgsIDAuMDU6IDEwMS44OCwgMC4wMjU6IDEwNi42MywgMC4wMTogMTEyLjMzLCAwLjAwNTogMTE2LjMyIH0sXG4gICAgICAgIDkwOiB7IDAuOTk1OiA1OS4yMCwgMC45OTogNjEuNzUsIDAuOTc1OiA2NS42NSwgMC45NTogNjkuMTMsIDAuOTogNzMuMjksIDAuNTogODkuMzMsIDAuMTogMTA3LjU3LCAwLjA1OiAxMTMuMTQsIDAuMDI1OiAxMTguMTQsIDAuMDE6IDEyNC4xMiwgMC4wMDU6IDEyOC4zMCB9LFxuICAgICAgICAxMDA6IHsgMC45OTU6IDY3LjMzLCAwLjk5OiA3MC4wNiwgMC45NzU6IDc0LjIyLCAwLjk1OiA3Ny45MywgMC45OiA4Mi4zNiwgMC41OiA5OS4zMywgMC4xOiAxMTguNTAsIDAuMDU6IDEyNC4zNCwgMC4wMjU6IDEyOS41NiwgMC4wMTogMTM1LjgxLCAwLjAwNTogMTQwLjE3IH1cbiAgICB9O1xuXG4gICAgLy8gIyDPhzIgKENoaS1TcXVhcmVkKSBHb29kbmVzcy1vZi1GaXQgVGVzdFxuICAgIC8vXG4gICAgLy8gVGhlIFvPhzIgKENoaS1TcXVhcmVkKSBHb29kbmVzcy1vZi1GaXQgVGVzdF0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Hb29kbmVzc19vZl9maXQjUGVhcnNvbi4yN3NfY2hpLXNxdWFyZWRfdGVzdClcbiAgICAvLyB1c2VzIGEgbWVhc3VyZSBvZiBnb29kbmVzcyBvZiBmaXQgd2hpY2ggaXMgdGhlIHN1bSBvZiBkaWZmZXJlbmNlcyBiZXR3ZWVuIG9ic2VydmVkIGFuZCBleHBlY3RlZCBvdXRjb21lIGZyZXF1ZW5jaWVzXG4gICAgLy8gKHRoYXQgaXMsIGNvdW50cyBvZiBvYnNlcnZhdGlvbnMpLCBlYWNoIHNxdWFyZWQgYW5kIGRpdmlkZWQgYnkgdGhlIG51bWJlciBvZiBvYnNlcnZhdGlvbnMgZXhwZWN0ZWQgZ2l2ZW4gdGhlXG4gICAgLy8gaHlwb3RoZXNpemVkIGRpc3RyaWJ1dGlvbi4gVGhlIHJlc3VsdGluZyDPhzIgc3RhdGlzdGljLCBgY2hpX3NxdWFyZWRgLCBjYW4gYmUgY29tcGFyZWQgdG8gdGhlIGNoaS1zcXVhcmVkIGRpc3RyaWJ1dGlvblxuICAgIC8vIHRvIGRldGVybWluZSB0aGUgZ29vZG5lc3Mgb2YgZml0LiBJbiBvcmRlciB0byBkZXRlcm1pbmUgdGhlIGRlZ3JlZXMgb2YgZnJlZWRvbSBvZiB0aGUgY2hpLXNxdWFyZWQgZGlzdHJpYnV0aW9uLCBvbmVcbiAgICAvLyB0YWtlcyB0aGUgdG90YWwgbnVtYmVyIG9mIG9ic2VydmVkIGZyZXF1ZW5jaWVzIGFuZCBzdWJ0cmFjdHMgdGhlIG51bWJlciBvZiBlc3RpbWF0ZWQgcGFyYW1ldGVycy4gVGhlIHRlc3Qgc3RhdGlzdGljXG4gICAgLy8gZm9sbG93cywgYXBwcm94aW1hdGVseSwgYSBjaGktc3F1YXJlIGRpc3RyaWJ1dGlvbiB3aXRoIChrIOKIkiBjKSBkZWdyZWVzIG9mIGZyZWVkb20gd2hlcmUgYGtgIGlzIHRoZSBudW1iZXIgb2Ygbm9uLWVtcHR5XG4gICAgLy8gY2VsbHMgYW5kIGBjYCBpcyB0aGUgbnVtYmVyIG9mIGVzdGltYXRlZCBwYXJhbWV0ZXJzIGZvciB0aGUgZGlzdHJpYnV0aW9uLlxuICAgIGZ1bmN0aW9uIGNoaV9zcXVhcmVkX2dvb2RuZXNzX29mX2ZpdChkYXRhLCBkaXN0cmlidXRpb25fdHlwZSwgc2lnbmlmaWNhbmNlKSB7XG4gICAgICAgIC8vIEVzdGltYXRlIGZyb20gdGhlIHNhbXBsZSBkYXRhLCBhIHdlaWdodGVkIG1lYW4uXG4gICAgICAgIHZhciBpbnB1dF9tZWFuID0gbWVhbihkYXRhKSxcbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZWQgdmFsdWUgb2YgdGhlIM+HMiBzdGF0aXN0aWMuXG4gICAgICAgICAgICBjaGlfc3F1YXJlZCA9IDAsXG4gICAgICAgICAgICAvLyBEZWdyZWVzIG9mIGZyZWVkb20sIGNhbGN1bGF0ZWQgYXMgKG51bWJlciBvZiBjbGFzcyBpbnRlcnZhbHMgLVxuICAgICAgICAgICAgLy8gbnVtYmVyIG9mIGh5cG90aGVzaXplZCBkaXN0cmlidXRpb24gcGFyYW1ldGVycyBlc3RpbWF0ZWQgLSAxKVxuICAgICAgICAgICAgZGVncmVlc19vZl9mcmVlZG9tLFxuICAgICAgICAgICAgLy8gTnVtYmVyIG9mIGh5cG90aGVzaXplZCBkaXN0cmlidXRpb24gcGFyYW1ldGVycyBlc3RpbWF0ZWQsIGV4cGVjdGVkIHRvIGJlIHN1cHBsaWVkIGluIHRoZSBkaXN0cmlidXRpb24gdGVzdC5cbiAgICAgICAgICAgIC8vIExvc2Ugb25lIGRlZ3JlZSBvZiBmcmVlZG9tIGZvciBlc3RpbWF0aW5nIGBsYW1iZGFgIGZyb20gdGhlIHNhbXBsZSBkYXRhLlxuICAgICAgICAgICAgYyA9IDEsXG4gICAgICAgICAgICAvLyBUaGUgaHlwb3RoZXNpemVkIGRpc3RyaWJ1dGlvbi5cbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHRoZSBoeXBvdGhlc2l6ZWQgZGlzdHJpYnV0aW9uLlxuICAgICAgICAgICAgaHlwb3RoZXNpemVkX2Rpc3RyaWJ1dGlvbiA9IGRpc3RyaWJ1dGlvbl90eXBlKGlucHV0X21lYW4pLFxuICAgICAgICAgICAgb2JzZXJ2ZWRfZnJlcXVlbmNpZXMgPSBbXSxcbiAgICAgICAgICAgIGV4cGVjdGVkX2ZyZXF1ZW5jaWVzID0gW10sXG4gICAgICAgICAgICBrO1xuXG4gICAgICAgIC8vIENyZWF0ZSBhbiBhcnJheSBob2xkaW5nIGEgaGlzdG9ncmFtIGZyb20gdGhlIHNhbXBsZSBkYXRhLCBvZlxuICAgICAgICAvLyB0aGUgZm9ybSBgeyB2YWx1ZTogbnVtYmVyT2ZPY3VycmVuY2VzIH1gXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG9ic2VydmVkX2ZyZXF1ZW5jaWVzW2RhdGFbaV1dID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlZF9mcmVxdWVuY2llc1tkYXRhW2ldXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvYnNlcnZlZF9mcmVxdWVuY2llc1tkYXRhW2ldXSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGhlIGhpc3RvZ3JhbSB3ZSBjcmVhdGVkIG1pZ2h0IGJlIHNwYXJzZSAtIHRoZXJlIG1pZ2h0IGJlIGdhcHNcbiAgICAgICAgLy8gYmV0d2VlbiB2YWx1ZXMuIFNvIHdlIGl0ZXJhdGUgdGhyb3VnaCB0aGUgaGlzdG9ncmFtLCBtYWtpbmdcbiAgICAgICAgLy8gc3VyZSB0aGF0IGluc3RlYWQgb2YgdW5kZWZpbmVkLCBnYXBzIGhhdmUgMCB2YWx1ZXMuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBvYnNlcnZlZF9mcmVxdWVuY2llcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG9ic2VydmVkX2ZyZXF1ZW5jaWVzW2ldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlZF9mcmVxdWVuY2llc1tpXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDcmVhdGUgYW4gYXJyYXkgaG9sZGluZyBhIGhpc3RvZ3JhbSBvZiBleHBlY3RlZCBkYXRhIGdpdmVuIHRoZVxuICAgICAgICAvLyBzYW1wbGUgc2l6ZSBhbmQgaHlwb3RoZXNpemVkIGRpc3RyaWJ1dGlvbi5cbiAgICAgICAgZm9yIChrIGluIGh5cG90aGVzaXplZF9kaXN0cmlidXRpb24pIHtcbiAgICAgICAgICAgIGlmIChrIGluIG9ic2VydmVkX2ZyZXF1ZW5jaWVzKSB7XG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRfZnJlcXVlbmNpZXNba10gPSBoeXBvdGhlc2l6ZWRfZGlzdHJpYnV0aW9uW2tdICogZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBXb3JraW5nIGJhY2t3YXJkIHRocm91Z2ggdGhlIGV4cGVjdGVkIGZyZXF1ZW5jaWVzLCBjb2xsYXBzZSBjbGFzc2VzXG4gICAgICAgIC8vIGlmIGxlc3MgdGhhbiB0aHJlZSBvYnNlcnZhdGlvbnMgYXJlIGV4cGVjdGVkIGZvciBhIGNsYXNzLlxuICAgICAgICAvLyBUaGlzIHRyYW5zZm9ybWF0aW9uIGlzIGFwcGxpZWQgdG8gdGhlIG9ic2VydmVkIGZyZXF1ZW5jaWVzIGFzIHdlbGwuXG4gICAgICAgIGZvciAoayA9IGV4cGVjdGVkX2ZyZXF1ZW5jaWVzLmxlbmd0aCAtIDE7IGsgPj0gMDsgay0tKSB7XG4gICAgICAgICAgICBpZiAoZXhwZWN0ZWRfZnJlcXVlbmNpZXNba10gPCAzKSB7XG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRfZnJlcXVlbmNpZXNbayAtIDFdICs9IGV4cGVjdGVkX2ZyZXF1ZW5jaWVzW2tdO1xuICAgICAgICAgICAgICAgIGV4cGVjdGVkX2ZyZXF1ZW5jaWVzLnBvcCgpO1xuXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZWRfZnJlcXVlbmNpZXNbayAtIDFdICs9IG9ic2VydmVkX2ZyZXF1ZW5jaWVzW2tdO1xuICAgICAgICAgICAgICAgIG9ic2VydmVkX2ZyZXF1ZW5jaWVzLnBvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBzcXVhcmVkIGRpZmZlcmVuY2VzIGJldHdlZW4gb2JzZXJ2ZWQgJiBleHBlY3RlZFxuICAgICAgICAvLyBmcmVxdWVuY2llcywgYWNjdW11bGF0aW5nIHRoZSBgY2hpX3NxdWFyZWRgIHN0YXRpc3RpYy5cbiAgICAgICAgZm9yIChrID0gMDsgayA8IG9ic2VydmVkX2ZyZXF1ZW5jaWVzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICBjaGlfc3F1YXJlZCArPSBNYXRoLnBvdyhcbiAgICAgICAgICAgICAgICBvYnNlcnZlZF9mcmVxdWVuY2llc1trXSAtIGV4cGVjdGVkX2ZyZXF1ZW5jaWVzW2tdLCAyKSAvXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRfZnJlcXVlbmNpZXNba107XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYWxjdWxhdGUgZGVncmVlcyBvZiBmcmVlZG9tIGZvciB0aGlzIHRlc3QgYW5kIGxvb2sgaXQgdXAgaW4gdGhlXG4gICAgICAgIC8vIGBjaGlfc3F1YXJlZF9kaXN0cmlidXRpb25fdGFibGVgIGluIG9yZGVyIHRvXG4gICAgICAgIC8vIGFjY2VwdCBvciByZWplY3QgdGhlIGdvb2RuZXNzLW9mLWZpdCBvZiB0aGUgaHlwb3RoZXNpemVkIGRpc3RyaWJ1dGlvbi5cbiAgICAgICAgZGVncmVlc19vZl9mcmVlZG9tID0gb2JzZXJ2ZWRfZnJlcXVlbmNpZXMubGVuZ3RoIC0gYyAtIDE7XG4gICAgICAgIHJldHVybiBjaGlfc3F1YXJlZF9kaXN0cmlidXRpb25fdGFibGVbZGVncmVlc19vZl9mcmVlZG9tXVtzaWduaWZpY2FuY2VdIDwgY2hpX3NxdWFyZWQ7XG4gICAgfVxuXG4gICAgLy8gIyBNaXhpblxuICAgIC8vXG4gICAgLy8gTWl4aW4gc2ltcGxlX3N0YXRpc3RpY3MgdG8gYSBzaW5nbGUgQXJyYXkgaW5zdGFuY2UgaWYgcHJvdmlkZWRcbiAgICAvLyBvciB0aGUgQXJyYXkgbmF0aXZlIG9iamVjdCBpZiBub3QuIFRoaXMgaXMgYW4gb3B0aW9uYWxcbiAgICAvLyBmZWF0dXJlIHRoYXQgbGV0cyB5b3UgdHJlYXQgc2ltcGxlX3N0YXRpc3RpY3MgYXMgYSBuYXRpdmUgZmVhdHVyZVxuICAgIC8vIG9mIEphdmFzY3JpcHQuXG4gICAgZnVuY3Rpb24gbWl4aW4oYXJyYXkpIHtcbiAgICAgICAgdmFyIHN1cHBvcnQgPSAhIShPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMpO1xuICAgICAgICBpZiAoIXN1cHBvcnQpIHRocm93IG5ldyBFcnJvcignd2l0aG91dCBkZWZpbmVQcm9wZXJ0eSwgc2ltcGxlLXN0YXRpc3RpY3MgY2Fubm90IGJlIG1peGVkIGluJyk7XG5cbiAgICAgICAgLy8gb25seSBtZXRob2RzIHdoaWNoIHdvcmsgb24gYmFzaWMgYXJyYXlzIGluIGEgc2luZ2xlIHN0ZXBcbiAgICAgICAgLy8gYXJlIHN1cHBvcnRlZFxuICAgICAgICB2YXIgYXJyYXlNZXRob2RzID0gWydtZWRpYW4nLCAnc3RhbmRhcmRfZGV2aWF0aW9uJywgJ3N1bScsXG4gICAgICAgICAgICAnc2FtcGxlX3NrZXduZXNzJyxcbiAgICAgICAgICAgICdtZWFuJywgJ21pbicsICdtYXgnLCAncXVhbnRpbGUnLCAnZ2VvbWV0cmljX21lYW4nLFxuICAgICAgICAgICAgJ2hhcm1vbmljX21lYW4nLCAncm9vdF9tZWFuX3NxdWFyZSddO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBhIGNsb3N1cmUgd2l0aCBhIG1ldGhvZCBuYW1lIHNvIHRoYXQgYSByZWZlcmVuY2VcbiAgICAgICAgLy8gbGlrZSBgYXJyYXlNZXRob2RzW2ldYCBkb2Vzbid0IGZvbGxvdyB0aGUgbG9vcCBpbmNyZW1lbnRcbiAgICAgICAgZnVuY3Rpb24gd3JhcChtZXRob2QpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyBjYXN0IGFueSBhcmd1bWVudHMgaW50byBhbiBhcnJheSwgc2luY2UgdGhleSdyZVxuICAgICAgICAgICAgICAgIC8vIG5hdGl2ZWx5IG9iamVjdHNcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIC8vIG1ha2UgdGhlIGZpcnN0IGFyZ3VtZW50IHRoZSBhcnJheSBpdHNlbGZcbiAgICAgICAgICAgICAgICBhcmdzLnVuc2hpZnQodGhpcyk7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHRoZSByZXN1bHQgb2YgdGhlIHNzIG1ldGhvZFxuICAgICAgICAgICAgICAgIHJldHVybiBzc1ttZXRob2RdLmFwcGx5KHNzLCBhcmdzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZWxlY3Qgb2JqZWN0IHRvIGV4dGVuZFxuICAgICAgICB2YXIgZXh0ZW5kaW5nO1xuICAgICAgICBpZiAoYXJyYXkpIHtcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBhIHNoYWxsb3cgY29weSBvZiB0aGUgYXJyYXkgc28gdGhhdCBvdXIgaW50ZXJuYWxcbiAgICAgICAgICAgIC8vIG9wZXJhdGlvbnMgZG8gbm90IGNoYW5nZSBpdCBieSByZWZlcmVuY2VcbiAgICAgICAgICAgIGV4dGVuZGluZyA9IGFycmF5LnNsaWNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBleHRlbmRpbmcgPSBBcnJheS5wcm90b3R5cGU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmb3IgZWFjaCBhcnJheSBmdW5jdGlvbiwgZGVmaW5lIGEgZnVuY3Rpb24gdGhhdCBnZXRzXG4gICAgICAgIC8vIHRoZSBhcnJheSBhcyB0aGUgZmlyc3QgYXJndW1lbnQuXG4gICAgICAgIC8vIFdlIHVzZSBbZGVmaW5lUHJvcGVydHldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2RlZmluZVByb3BlcnR5KVxuICAgICAgICAvLyBiZWNhdXNlIGl0IGFsbG93cyB0aGVzZSBwcm9wZXJ0aWVzIHRvIGJlIG5vbi1lbnVtZXJhYmxlOlxuICAgICAgICAvLyBgZm9yICh2YXIgaW4geClgIGxvb3BzIHdpbGwgbm90IHJ1biBpbnRvIHByb2JsZW1zIHdpdGggdGhpc1xuICAgICAgICAvLyBpbXBsZW1lbnRhdGlvbi5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheU1ldGhvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHRlbmRpbmcsIGFycmF5TWV0aG9kc1tpXSwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB3cmFwKGFycmF5TWV0aG9kc1tpXSksXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHRlbmRpbmc7XG4gICAgfVxuXG4gICAgc3MubGluZWFyX3JlZ3Jlc3Npb24gPSBsaW5lYXJfcmVncmVzc2lvbjtcbiAgICBzcy5zdGFuZGFyZF9kZXZpYXRpb24gPSBzdGFuZGFyZF9kZXZpYXRpb247XG4gICAgc3Mucl9zcXVhcmVkID0gcl9zcXVhcmVkO1xuICAgIHNzLm1lZGlhbiA9IG1lZGlhbjtcbiAgICBzcy5tZWFuID0gbWVhbjtcbiAgICBzcy5tb2RlID0gbW9kZTtcbiAgICBzcy5taW4gPSBtaW47XG4gICAgc3MubWF4ID0gbWF4O1xuICAgIHNzLnN1bSA9IHN1bTtcbiAgICBzcy5xdWFudGlsZSA9IHF1YW50aWxlO1xuICAgIHNzLnF1YW50aWxlX3NvcnRlZCA9IHF1YW50aWxlX3NvcnRlZDtcbiAgICBzcy5pcXIgPSBpcXI7XG4gICAgc3MubWFkID0gbWFkO1xuXG4gICAgc3MuY2h1bmsgPSBjaHVuaztcbiAgICBzcy5zaHVmZmxlID0gc2h1ZmZsZTtcbiAgICBzcy5zaHVmZmxlX2luX3BsYWNlID0gc2h1ZmZsZV9pbl9wbGFjZTtcblxuICAgIHNzLnNhbXBsZSA9IHNhbXBsZTtcblxuICAgIHNzLnNhbXBsZV9jb3ZhcmlhbmNlID0gc2FtcGxlX2NvdmFyaWFuY2U7XG4gICAgc3Muc2FtcGxlX2NvcnJlbGF0aW9uID0gc2FtcGxlX2NvcnJlbGF0aW9uO1xuICAgIHNzLnNhbXBsZV92YXJpYW5jZSA9IHNhbXBsZV92YXJpYW5jZTtcbiAgICBzcy5zYW1wbGVfc3RhbmRhcmRfZGV2aWF0aW9uID0gc2FtcGxlX3N0YW5kYXJkX2RldmlhdGlvbjtcbiAgICBzcy5zYW1wbGVfc2tld25lc3MgPSBzYW1wbGVfc2tld25lc3M7XG5cbiAgICBzcy5nZW9tZXRyaWNfbWVhbiA9IGdlb21ldHJpY19tZWFuO1xuICAgIHNzLmhhcm1vbmljX21lYW4gPSBoYXJtb25pY19tZWFuO1xuICAgIHNzLnJvb3RfbWVhbl9zcXVhcmUgPSByb290X21lYW5fc3F1YXJlO1xuICAgIHNzLnZhcmlhbmNlID0gdmFyaWFuY2U7XG4gICAgc3MudF90ZXN0ID0gdF90ZXN0O1xuICAgIHNzLnRfdGVzdF90d29fc2FtcGxlID0gdF90ZXN0X3R3b19zYW1wbGU7XG5cbiAgICAvLyBqZW5rc1xuICAgIHNzLmplbmtzTWF0cmljZXMgPSBqZW5rc01hdHJpY2VzO1xuICAgIHNzLmplbmtzQnJlYWtzID0gamVua3NCcmVha3M7XG4gICAgc3MuamVua3MgPSBqZW5rcztcblxuICAgIHNzLmJheWVzaWFuID0gYmF5ZXNpYW47XG5cbiAgICAvLyBEaXN0cmlidXRpb24tcmVsYXRlZCBtZXRob2RzXG4gICAgc3MuZXBzaWxvbiA9IGVwc2lsb247IC8vIFdlIG1ha2UgzrUgYXZhaWxhYmxlIHRvIHRoZSB0ZXN0IHN1aXRlLlxuICAgIHNzLmZhY3RvcmlhbCA9IGZhY3RvcmlhbDtcbiAgICBzcy5iZXJub3VsbGlfZGlzdHJpYnV0aW9uID0gYmVybm91bGxpX2Rpc3RyaWJ1dGlvbjtcbiAgICBzcy5iaW5vbWlhbF9kaXN0cmlidXRpb24gPSBiaW5vbWlhbF9kaXN0cmlidXRpb247XG4gICAgc3MucG9pc3Nvbl9kaXN0cmlidXRpb24gPSBwb2lzc29uX2Rpc3RyaWJ1dGlvbjtcbiAgICBzcy5jaGlfc3F1YXJlZF9nb29kbmVzc19vZl9maXQgPSBjaGlfc3F1YXJlZF9nb29kbmVzc19vZl9maXQ7XG5cbiAgICAvLyBOb3JtYWwgZGlzdHJpYnV0aW9uXG4gICAgc3Muel9zY29yZSA9IHpfc2NvcmU7XG4gICAgc3MuY3VtdWxhdGl2ZV9zdGRfbm9ybWFsX3Byb2JhYmlsaXR5ID0gY3VtdWxhdGl2ZV9zdGRfbm9ybWFsX3Byb2JhYmlsaXR5O1xuICAgIHNzLnN0YW5kYXJkX25vcm1hbF90YWJsZSA9IHN0YW5kYXJkX25vcm1hbF90YWJsZTtcbiAgICBzcy5lcnJvcl9mdW5jdGlvbiA9IGVycm9yX2Z1bmN0aW9uO1xuXG4gICAgLy8gQWxpYXMgdGhpcyBpbnRvIGl0cyBjb21tb24gbmFtZVxuICAgIHNzLmF2ZXJhZ2UgPSBtZWFuO1xuICAgIHNzLmludGVycXVhcnRpbGVfcmFuZ2UgPSBpcXI7XG4gICAgc3MubWl4aW4gPSBtaXhpbjtcbiAgICBzcy5tZWRpYW5fYWJzb2x1dGVfZGV2aWF0aW9uID0gbWFkO1xuICAgIHNzLnJtcyA9IHJvb3RfbWVhbl9zcXVhcmU7XG4gICAgc3MuZXJmID0gZXJyb3JfZnVuY3Rpb247XG5cbn0pKHRoaXMpO1xuIiwidmFyIGludmFyaWFudCA9IHJlcXVpcmUoJ3R1cmYtaW52YXJpYW50Jyk7XG4vL2h0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSGF2ZXJzaW5lX2Zvcm11bGFcbi8vaHR0cDovL3d3dy5tb3ZhYmxlLXR5cGUuY28udWsvc2NyaXB0cy9sYXRsb25nLmh0bWxcblxuLyoqXG4gKiBUYWtlcyB0d28ge0BsaW5rIFBvaW50fSBmZWF0dXJlcyBhbmQgY2FsY3VsYXRlc1xuICogdGhlIGRpc3RhbmNlIGJldHdlZW4gdGhlbSBpbiBkZWdyZXNzLCByYWRpYW5zLFxuICogbWlsZXMsIG9yIGtpbG9tZXRlcnMuIFRoaXMgdXNlcyB0aGVcbiAqIFtIYXZlcnNpbmUgZm9ybXVsYV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9IYXZlcnNpbmVfZm9ybXVsYSlcbiAqIHRvIGFjY291bnQgZm9yIGdsb2JhbCBjdXJ2YXR1cmUuXG4gKlxuICogQG1vZHVsZSB0dXJmL2Rpc3RhbmNlXG4gKiBAY2F0ZWdvcnkgbWVhc3VyZW1lbnRcbiAqIEBwYXJhbSB7RmVhdHVyZX0gZnJvbSBvcmlnaW4gcG9pbnRcbiAqIEBwYXJhbSB7RmVhdHVyZX0gdG8gZGVzdGluYXRpb24gcG9pbnRcbiAqIEBwYXJhbSB7U3RyaW5nfSBbdW5pdHM9a2lsb21ldGVyc10gY2FuIGJlIGRlZ3JlZXMsIHJhZGlhbnMsIG1pbGVzLCBvciBraWxvbWV0ZXJzXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IGRpc3RhbmNlIGJldHdlZW4gdGhlIHR3byBwb2ludHNcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9pbnQxID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzUuMzQzLCAzOS45ODRdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcG9pbnQyID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzUuNTM0LCAzOS4xMjNdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgdW5pdHMgPSBcIm1pbGVzXCI7XG4gKlxuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbcG9pbnQxLCBwb2ludDJdXG4gKiB9O1xuICpcbiAqIC8vPXBvaW50c1xuICpcbiAqIHZhciBkaXN0YW5jZSA9IHR1cmYuZGlzdGFuY2UocG9pbnQxLCBwb2ludDIsIHVuaXRzKTtcbiAqXG4gKiAvLz1kaXN0YW5jZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvaW50MSwgcG9pbnQyLCB1bml0cyl7XG4gIGludmFyaWFudC5mZWF0dXJlT2YocG9pbnQxLCAnUG9pbnQnLCAnZGlzdGFuY2UnKTtcbiAgaW52YXJpYW50LmZlYXR1cmVPZihwb2ludDIsICdQb2ludCcsICdkaXN0YW5jZScpO1xuICB2YXIgY29vcmRpbmF0ZXMxID0gcG9pbnQxLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuICB2YXIgY29vcmRpbmF0ZXMyID0gcG9pbnQyLmdlb21ldHJ5LmNvb3JkaW5hdGVzO1xuXG4gIHZhciBkTGF0ID0gdG9SYWQoY29vcmRpbmF0ZXMyWzFdIC0gY29vcmRpbmF0ZXMxWzFdKTtcbiAgdmFyIGRMb24gPSB0b1JhZChjb29yZGluYXRlczJbMF0gLSBjb29yZGluYXRlczFbMF0pO1xuICB2YXIgbGF0MSA9IHRvUmFkKGNvb3JkaW5hdGVzMVsxXSk7XG4gIHZhciBsYXQyID0gdG9SYWQoY29vcmRpbmF0ZXMyWzFdKTtcbiAgdmFyIGEgPSBNYXRoLnNpbihkTGF0LzIpICogTWF0aC5zaW4oZExhdC8yKSArXG4gICAgICAgICAgTWF0aC5zaW4oZExvbi8yKSAqIE1hdGguc2luKGRMb24vMikgKiBNYXRoLmNvcyhsYXQxKSAqIE1hdGguY29zKGxhdDIpO1xuICB2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpO1xuXG4gIHZhciBSO1xuICBzd2l0Y2godW5pdHMpe1xuICAgIGNhc2UgJ21pbGVzJzpcbiAgICAgIFIgPSAzOTYwO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAna2lsb21ldGVycyc6XG4gICAgICBSID0gNjM3MztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2RlZ3JlZXMnOlxuICAgICAgUiA9IDU3LjI5NTc3OTU7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdyYWRpYW5zJzpcbiAgICAgIFIgPSAxO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICBSID0gNjM3MztcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Vua25vd24gb3B0aW9uIGdpdmVuIHRvIFwidW5pdHNcIicpO1xuICB9XG5cbiAgdmFyIGRpc3RhbmNlID0gUiAqIGM7XG4gIHJldHVybiBkaXN0YW5jZTtcbn07XG5cbmZ1bmN0aW9uIHRvUmFkKGRlZ3JlZSkge1xuICByZXR1cm4gZGVncmVlICogTWF0aC5QSSAvIDE4MDtcbn1cbiIsIm1vZHVsZS5leHBvcnRzLmdlb2pzb25UeXBlID0gZ2VvanNvblR5cGU7XG5tb2R1bGUuZXhwb3J0cy5jb2xsZWN0aW9uT2YgPSBjb2xsZWN0aW9uT2Y7XG5tb2R1bGUuZXhwb3J0cy5mZWF0dXJlT2YgPSBmZWF0dXJlT2Y7XG5cbi8qKlxuICogRW5mb3JjZSBleHBlY3RhdGlvbnMgYWJvdXQgdHlwZXMgb2YgR2VvSlNPTiBvYmplY3RzIGZvciBUdXJmLlxuICpcbiAqIEBhbGlhcyBnZW9qc29uVHlwZVxuICogQHBhcmFtIHtHZW9KU09OfSB2YWx1ZSBhbnkgR2VvSlNPTiBvYmplY3RcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIGV4cGVjdGVkIEdlb0pTT04gdHlwZVxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgbmFtZSBvZiBjYWxsaW5nIGZ1bmN0aW9uXG4gKiBAdGhyb3dzIEVycm9yIGlmIHZhbHVlIGlzIG5vdCB0aGUgZXhwZWN0ZWQgdHlwZS5cbiAqL1xuZnVuY3Rpb24gZ2VvanNvblR5cGUodmFsdWUsIHR5cGUsIG5hbWUpIHtcbiAgICBpZiAoIXR5cGUgfHwgIW5hbWUpIHRocm93IG5ldyBFcnJvcigndHlwZSBhbmQgbmFtZSByZXF1aXJlZCcpO1xuXG4gICAgaWYgKCF2YWx1ZSB8fCB2YWx1ZS50eXBlICE9PSB0eXBlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpbnB1dCB0byAnICsgbmFtZSArICc6IG11c3QgYmUgYSAnICsgdHlwZSArICcsIGdpdmVuICcgKyB2YWx1ZS50eXBlKTtcbiAgICB9XG59XG5cbi8qKlxuICogRW5mb3JjZSBleHBlY3RhdGlvbnMgYWJvdXQgdHlwZXMgb2Yge0BsaW5rIEZlYXR1cmV9IGlucHV0cyBmb3IgVHVyZi5cbiAqIEludGVybmFsbHkgdGhpcyB1c2VzIHtAbGluayBnZW9qc29uVHlwZX0gdG8ganVkZ2UgZ2VvbWV0cnkgdHlwZXMuXG4gKlxuICogQGFsaWFzIGZlYXR1cmVPZlxuICogQHBhcmFtIHtGZWF0dXJlfSBmZWF0dXJlIGEgZmVhdHVyZSB3aXRoIGFuIGV4cGVjdGVkIGdlb21ldHJ5IHR5cGVcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIGV4cGVjdGVkIEdlb0pTT04gdHlwZVxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgbmFtZSBvZiBjYWxsaW5nIGZ1bmN0aW9uXG4gKiBAdGhyb3dzIEVycm9yIGlmIHZhbHVlIGlzIG5vdCB0aGUgZXhwZWN0ZWQgdHlwZS5cbiAqL1xuZnVuY3Rpb24gZmVhdHVyZU9mKHZhbHVlLCB0eXBlLCBuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSB0aHJvdyBuZXcgRXJyb3IoJy5mZWF0dXJlT2YoKSByZXF1aXJlcyBhIG5hbWUnKTtcbiAgICBpZiAoIXZhbHVlIHx8IHZhbHVlLnR5cGUgIT09ICdGZWF0dXJlJyB8fCAhdmFsdWUuZ2VvbWV0cnkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGlucHV0IHRvICcgKyBuYW1lICsgJywgRmVhdHVyZSB3aXRoIGdlb21ldHJ5IHJlcXVpcmVkJyk7XG4gICAgfVxuICAgIGlmICghdmFsdWUuZ2VvbWV0cnkgfHwgdmFsdWUuZ2VvbWV0cnkudHlwZSAhPT0gdHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaW5wdXQgdG8gJyArIG5hbWUgKyAnOiBtdXN0IGJlIGEgJyArIHR5cGUgKyAnLCBnaXZlbiAnICsgdmFsdWUuZ2VvbWV0cnkudHlwZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEVuZm9yY2UgZXhwZWN0YXRpb25zIGFib3V0IHR5cGVzIG9mIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gaW5wdXRzIGZvciBUdXJmLlxuICogSW50ZXJuYWxseSB0aGlzIHVzZXMge0BsaW5rIGdlb2pzb25UeXBlfSB0byBqdWRnZSBnZW9tZXRyeSB0eXBlcy5cbiAqXG4gKiBAYWxpYXMgY29sbGVjdGlvbk9mXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBmZWF0dXJlY29sbGVjdGlvbiBhIGZlYXR1cmVjb2xsZWN0aW9uIGZvciB3aGljaCBmZWF0dXJlcyB3aWxsIGJlIGp1ZGdlZFxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgZXhwZWN0ZWQgR2VvSlNPTiB0eXBlXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBuYW1lIG9mIGNhbGxpbmcgZnVuY3Rpb25cbiAqIEB0aHJvd3MgRXJyb3IgaWYgdmFsdWUgaXMgbm90IHRoZSBleHBlY3RlZCB0eXBlLlxuICovXG5mdW5jdGlvbiBjb2xsZWN0aW9uT2YodmFsdWUsIHR5cGUsIG5hbWUpIHtcbiAgICBpZiAoIW5hbWUpIHRocm93IG5ldyBFcnJvcignLmNvbGxlY3Rpb25PZigpIHJlcXVpcmVzIGEgbmFtZScpO1xuICAgIGlmICghdmFsdWUgfHwgdmFsdWUudHlwZSAhPT0gJ0ZlYXR1cmVDb2xsZWN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaW5wdXQgdG8gJyArIG5hbWUgKyAnLCBGZWF0dXJlQ29sbGVjdGlvbiByZXF1aXJlZCcpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBmZWF0dXJlID0gdmFsdWUuZmVhdHVyZXNbaV07XG4gICAgICAgIGlmICghZmVhdHVyZSB8fCBmZWF0dXJlLnR5cGUgIT09ICdGZWF0dXJlJyB8fCAhZmVhdHVyZS5nZW9tZXRyeSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGlucHV0IHRvICcgKyBuYW1lICsgJywgRmVhdHVyZSB3aXRoIGdlb21ldHJ5IHJlcXVpcmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmZWF0dXJlLmdlb21ldHJ5IHx8IGZlYXR1cmUuZ2VvbWV0cnkudHlwZSAhPT0gdHlwZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGlucHV0IHRvICcgKyBuYW1lICsgJzogbXVzdCBiZSBhICcgKyB0eXBlICsgJywgZ2l2ZW4gJyArIGZlYXR1cmUuZ2VvbWV0cnkudHlwZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJ2YXIgZXh0ZW50ID0gcmVxdWlyZSgndHVyZi1leHRlbnQnKTtcbnZhciBiYm94UG9seWdvbiA9IHJlcXVpcmUoJ3R1cmYtYmJveC1wb2x5Z29uJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZX0gb3Ige0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBhbmQgcmV0dXJucyBhIHJlY3Rhbmd1bGFyIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlIHRoYXQgZW5jb21wYXNzZXMgYWxsIHZlcnRpY2VzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9lbnZlbG9wZVxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBmYyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4gKiBAcmV0dXJuIHtQb2x5Z29ufSBhIHJlY3Rhbmd1bGFyIFBvbHlnb24gZmVhdHVyZSB0aGF0IGVuY29tcGFzc2VzIGFsbCB2ZXJ0aWNlc1xuICogQGV4YW1wbGVcbiAqIHZhciBmYyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJuYW1lXCI6IFwiTG9jYXRpb24gQVwiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy03NS4zNDMsIDM5Ljk4NF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcIm5hbWVcIjogXCJMb2NhdGlvbiBCXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjgzMywgMzkuMjg0XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwibmFtZVwiOiBcIkxvY2F0aW9uIENcIlxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzUuNTM0LCAzOS4xMjNdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBlbnZlbG9wZWQgPSB0dXJmLmVudmVsb3BlKGZjKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBmYy5mZWF0dXJlcy5jb25jYXQoZW52ZWxvcGVkKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmZWF0dXJlcywgZG9uZSl7XG4gIHZhciBiYm94ID0gZXh0ZW50KGZlYXR1cmVzKTtcbiAgdmFyIHBvbHkgPSBiYm94UG9seWdvbihiYm94KTtcbiAgcmV0dXJuIHBvbHk7XG59XG4iLCIvLyBkZXBlbmQgb24ganN0cyBmb3Igbm93IGh0dHBzOi8vZ2l0aHViLmNvbS9iam9ybmhhcnJ0ZWxsL2pzdHMvYmxvYi9tYXN0ZXIvZXhhbXBsZXMvb3ZlcmxheS5odG1sXG52YXIganN0cyA9IHJlcXVpcmUoJ2pzdHMnKTtcblxuLyoqXG4gKiBGaW5kcyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHR3byBwb2x5Z29ucyBieSBjbGlwcGluZyB0aGUgc2Vjb25kXG4gKiBwb2x5Z29uIGZyb20gdGhlIGZpcnN0LlxuICpcbiAqIEBtb2R1bGUgdHVyZi9lcmFzZVxuICogQGNhdGVnb3J5IHRyYW5zZm9ybWF0aW9uXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHkxIGlucHV0IFBvbHlnb24gZmVhdXJlXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHkyIFBvbHlnb24gZmVhdHVyZSB0byBlcmFzZSBmcm9tIGBwb2x5MWBcbiAqIEByZXR1cm4ge1BvbHlnb259IGEgUG9seWdvbiBmZWF0dXJlIHNob3dpbmcgdGhlIGFyZWEgb2YgYHBvbHkxYCBleGNsdWRpbmcgdGhlIGFyZWEgb2YgYHBvbHkyYFxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5MSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwiZmlsbFwiOiBcIiMwZjBcIlxuICogICB9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWy00Ni43Mzg1ODYsIC0yMy41OTY3MTFdLFxuICogICAgICAgWy00Ni43Mzg1ODYsIC0yMy40NTgyMDddLFxuICogICAgICAgWy00Ni41NjAwNTgsIC0yMy40NTgyMDddLFxuICogICAgICAgWy00Ni41NjAwNTgsIC0yMy41OTY3MTFdLFxuICogICAgICAgWy00Ni43Mzg1ODYsIC0yMy41OTY3MTFdXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcbiAqIHZhciBwb2x5MiA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwiZmlsbFwiOiBcIiMwMGZcIlxuICogICB9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWy00Ni42NTAwMDksIC0yMy42MzEzMTRdLFxuICogICAgICAgWy00Ni42NTAwMDksIC0yMy41MjM3XSxcbiAqICAgICAgIFstNDYuNTA5MjQ2LCAtMjMuNTIzN10sXG4gKiAgICAgICBbLTQ2LjUwOTI0NiwgLTIzLjYzMTMxNF0sXG4gKiAgICAgICBbLTQ2LjY1MDAwOSwgLTIzLjYzMTMxNF1cbiAqICAgICBdXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBlcmFzZWQgPSB0dXJmLmVyYXNlKHBvbHkxLCBwb2x5Mik7XG4gKiBlcmFzZWQucHJvcGVydGllcy5maWxsID0gJyNmMDAnO1xuICpcbiAqIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbcG9seTEsIHBvbHkyXVxuICogfTtcbiAqXG4gKiAvLz1wb2x5Z29uc1xuICpcbiAqIC8vPWVyYXNlZFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocDEsIHAyLCBkb25lKXtcbiAgdmFyIHBvbHkxID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwMSkpO1xuICB2YXIgcG9seTIgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHAyKSk7XG4gIGlmKHBvbHkxLnR5cGUgIT09ICdGZWF0dXJlJykge1xuICAgIHBvbHkxID0ge1xuICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgcHJvcGVydGllczoge30sXG4gICAgICBnZW9tZXRyeTogcG9seTFcbiAgICB9O1xuICB9XG4gIGlmKHBvbHkyLnR5cGUgIT09ICdGZWF0dXJlJykge1xuICAgIHBvbHkyID0ge1xuICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgcHJvcGVydGllczoge30sXG4gICAgICBnZW9tZXRyeTogcG9seTJcbiAgICB9O1xuICB9XG5cbiAgdmFyIHJlYWRlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05SZWFkZXIoKTtcbiAgdmFyIGEgPSByZWFkZXIucmVhZChKU09OLnN0cmluZ2lmeShwb2x5MS5nZW9tZXRyeSkpO1xuICB2YXIgYiA9IHJlYWRlci5yZWFkKEpTT04uc3RyaW5naWZ5KHBvbHkyLmdlb21ldHJ5KSk7XG4gIHZhciBlcmFzZWQgPSBhLmRpZmZlcmVuY2UoYik7XG4gIHZhciBwYXJzZXIgPSBuZXcganN0cy5pby5HZW9KU09OUGFyc2VyKCk7XG4gIGVyYXNlZCA9IHBhcnNlci53cml0ZShlcmFzZWQpO1xuXG4gIHBvbHkxLmdlb21ldHJ5ID0gZXJhc2VkO1xuXG4gIGlmIChwb2x5MS5nZW9tZXRyeS50eXBlID09PSAnR2VvbWV0cnlDb2xsZWN0aW9uJyAmJiBwb2x5MS5nZW9tZXRyeS5nZW9tZXRyaWVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgcHJvcGVydGllczogcG9seTEucHJvcGVydGllcyxcbiAgICAgIGdlb21ldHJ5OiBlcmFzZWRcbiAgICB9O1xuICB9XG59O1xuIiwiLypcbiAgamF2YXNjcmlwdC51dGlsIGlzIGEgcG9ydCBvZiBzZWxlY3RlZCBwYXJ0cyBvZiBqYXZhLnV0aWwgdG8gSmF2YVNjcmlwdCB3aGljaFxuICBtYWluIHB1cnBvc2UgaXMgdG8gZWFzZSBwb3J0aW5nIEphdmEgY29kZSB0byBKYXZhU2NyaXB0LlxuICBcbiAgVGhlIE1JVCBMaWNlbnNlIChNSVQpXG5cbiAgQ29weXJpZ2h0IChDKSAyMDExLTIwMTQgYnkgVGhlIEF1dGhvcnNcblxuICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG4gIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG4gIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAgVEhFIFNPRlRXQVJFLlxuKi9cbjsoZnVuY3Rpb24oKXt2YXIgZT10aGlzO2Z1bmN0aW9uIGYoYSxiKXt2YXIgYz1hLnNwbGl0KFwiLlwiKSxkPWU7Y1swXWluIGR8fCFkLmV4ZWNTY3JpcHR8fGQuZXhlY1NjcmlwdChcInZhciBcIitjWzBdKTtmb3IodmFyIHQ7Yy5sZW5ndGgmJih0PWMuc2hpZnQoKSk7KWMubGVuZ3RofHx2b2lkIDA9PT1iP2Q9ZFt0XT9kW3RdOmRbdF09e306ZFt0XT1ifWZ1bmN0aW9uIGcoYSxiKXtmdW5jdGlvbiBjKCl7fWMucHJvdG90eXBlPWIucHJvdG90eXBlO2EucT1iLnByb3RvdHlwZTthLnByb3RvdHlwZT1uZXcgYzthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO2EucD1mdW5jdGlvbihhLGMsTyl7dmFyIE09QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBiLnByb3RvdHlwZVtjXS5hcHBseShhLE0pfX07ZnVuY3Rpb24gaChhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKGgsRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuRW1wdHlTdGFja0V4Y2VwdGlvblwiLGgpO2gucHJvdG90eXBlLm5hbWU9XCJFbXB0eVN0YWNrRXhjZXB0aW9uXCI7ZnVuY3Rpb24gayhhKXt0aGlzLm1lc3NhZ2U9YXx8XCJcIn1nKGssRXJyb3IpO2YoXCJqYXZhc2NyaXB0LnV0aWwuSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiLGspO2sucHJvdG90eXBlLm5hbWU9XCJJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXCI7ZnVuY3Rpb24gbCgpe31mKFwiamF2YXNjcmlwdC51dGlsLkl0ZXJhdG9yXCIsbCk7bC5wcm90b3R5cGUuaGFzTmV4dD1sLnByb3RvdHlwZS5jO2wucHJvdG90eXBlLm5leHQ9bC5wcm90b3R5cGUubmV4dDtsLnByb3RvdHlwZS5yZW1vdmU9bC5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIG0oKXt9ZihcImphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uXCIsbSk7ZnVuY3Rpb24gbigpe31nKG4sbSk7ZihcImphdmFzY3JpcHQudXRpbC5MaXN0XCIsbik7ZnVuY3Rpb24gcCgpe31mKFwiamF2YXNjcmlwdC51dGlsLk1hcFwiLHApO2Z1bmN0aW9uIHEoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhxLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIixxKTtxLnByb3RvdHlwZS5uYW1lPVwiTm9TdWNoRWxlbWVudEV4Y2VwdGlvblwiO2Z1bmN0aW9uIHIoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhyLEVycm9yKTtyLnByb3RvdHlwZS5uYW1lPVwiT3BlcmF0aW9uTm90U3VwcG9ydGVkXCI7ZnVuY3Rpb24gcyhhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKHMsbik7ZihcImphdmFzY3JpcHQudXRpbC5BcnJheUxpc3RcIixzKTtzLnByb3RvdHlwZS5hPW51bGw7cy5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtzLnByb3RvdHlwZS5hZGQ9cy5wcm90b3R5cGUuYWRkO3MucHJvdG90eXBlLmU9ZnVuY3Rpb24oYSl7Zm9yKGE9YS5mKCk7YS5jKCk7KXRoaXMuYWRkKGEubmV4dCgpKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkQWxsPXMucHJvdG90eXBlLmU7cy5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5hW2FdO3RoaXMuYVthXT1iO3JldHVybiBjfTtzLnByb3RvdHlwZS5zZXQ9cy5wcm90b3R5cGUuc2V0O3MucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHUodGhpcyl9O3MucHJvdG90eXBlLml0ZXJhdG9yPXMucHJvdG90eXBlLmY7XG5zLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7aWYoMD5hfHxhPj10aGlzLnNpemUoKSl0aHJvdyBuZXcgaztyZXR1cm4gdGhpcy5hW2FdfTtzLnByb3RvdHlwZS5nZXQ9cy5wcm90b3R5cGUuZ2V0O3MucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3MucHJvdG90eXBlLmlzRW1wdHk9cy5wcm90b3R5cGUuZztzLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3MucHJvdG90eXBlLnNpemU9cy5wcm90b3R5cGUuc2l6ZTtzLnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07cy5wcm90b3R5cGUudG9BcnJheT1zLnByb3RvdHlwZS5oO1xucy5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0hMSxjPTAsZD10aGlzLmEubGVuZ3RoO2M8ZDtjKyspaWYodGhpcy5hW2NdPT09YSl7dGhpcy5hLnNwbGljZShjLDEpO2I9ITA7YnJlYWt9cmV0dXJuIGJ9O3MucHJvdG90eXBlLnJlbW92ZT1zLnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdShhKXt0aGlzLmo9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl9cIix1KTt1LnByb3RvdHlwZS5qPW51bGw7dS5wcm90b3R5cGUuYj0wO3UucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmouc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmouZ2V0KHRoaXMuYisrKX07dS5wcm90b3R5cGUubmV4dD11LnByb3RvdHlwZS5uZXh0O3UucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMuai5zaXplKCk/ITA6ITF9O3UucHJvdG90eXBlLmhhc05leHQ9dS5wcm90b3R5cGUuYztcbnUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307dS5wcm90b3R5cGUucmVtb3ZlPXUucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiB2KCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlzXCIsdik7XG52LnNvcnQ9ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHNbMF0sYixjLGQ7aWYoMT09PWFyZ3VtZW50cy5sZW5ndGgpYS5zb3J0KCk7ZWxzZSBpZigyPT09YXJndW1lbnRzLmxlbmd0aCljPWFyZ3VtZW50c1sxXSxkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuY29tcGFyZShhLGIpfSxhLnNvcnQoZCk7ZWxzZSBpZigzPT09YXJndW1lbnRzLmxlbmd0aClmb3IoYj1hLnNsaWNlKGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pLGIuc29ydCgpLGQ9YS5zbGljZSgwLGFyZ3VtZW50c1sxXSkuY29uY2F0KGIsYS5zbGljZShhcmd1bWVudHNbMl0sYS5sZW5ndGgpKSxhLnNwbGljZSgwLGEubGVuZ3RoKSxiPTA7YjxkLmxlbmd0aDtiKyspYS5wdXNoKGRbYl0pO2Vsc2UgaWYoND09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxjPWFyZ3VtZW50c1szXSxkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGMuY29tcGFyZShhLGIpfSxiLnNvcnQoZCksXG5kPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKX07di5hc0xpc3Q9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPW5ldyBzLGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspYi5hZGQoYVtjXSk7cmV0dXJuIGJ9O2Z1bmN0aW9uIHcoKXt0aGlzLmk9e319Zyh3LHApO2YoXCJqYXZhc2NyaXB0LnV0aWwuSGFzaE1hcFwiLHcpO3cucHJvdG90eXBlLmk9bnVsbDt3LnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuaVthXXx8bnVsbH07dy5wcm90b3R5cGUuZ2V0PXcucHJvdG90eXBlLmdldDt3LnByb3RvdHlwZS5wdXQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5pW2FdPWJ9O3cucHJvdG90eXBlLnB1dD13LnByb3RvdHlwZS5wdXQ7dy5wcm90b3R5cGUubT1mdW5jdGlvbigpe3ZhciBhPW5ldyBzLGI7Zm9yKGIgaW4gdGhpcy5pKXRoaXMuaS5oYXNPd25Qcm9wZXJ0eShiKSYmYS5hZGQodGhpcy5pW2JdKTtyZXR1cm4gYX07dy5wcm90b3R5cGUudmFsdWVzPXcucHJvdG90eXBlLm07dy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm0oKS5zaXplKCl9O3cucHJvdG90eXBlLnNpemU9dy5wcm90b3R5cGUuc2l6ZTtmdW5jdGlvbiB4KCl7fWcoeCxtKTtmKFwiamF2YXNjcmlwdC51dGlsLlNldFwiLHgpO2Z1bmN0aW9uIHkoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9Zyh5LHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuSGFzaFNldFwiLHkpO3kucHJvdG90eXBlLmE9bnVsbDt5LnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZih0aGlzLmFbYl09PT1hKXJldHVybiEwO3JldHVybiExfTt5LnByb3RvdHlwZS5jb250YWlucz15LnByb3RvdHlwZS5jb250YWluczt5LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7aWYodGhpcy5jb250YWlucyhhKSlyZXR1cm4hMTt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07eS5wcm90b3R5cGUuYWRkPXkucHJvdG90eXBlLmFkZDt5LnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZEFsbD15LnByb3RvdHlwZS5lO1xueS5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt5LnByb3RvdHlwZS5yZW1vdmU9eS5wcm90b3R5cGUucmVtb3ZlO3kucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07eS5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07eS5wcm90b3R5cGUuaXNFbXB0eT15LnByb3RvdHlwZS5nO3kucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTt5LnByb3RvdHlwZS50b0FycmF5PXkucHJvdG90eXBlLmg7eS5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgeih0aGlzKX07eS5wcm90b3R5cGUuaXRlcmF0b3I9eS5wcm90b3R5cGUuZjtmdW5jdGlvbiB6KGEpe3RoaXMuaz1hfWYoXCIkanNjb21wLnNjb3BlLkl0ZXJhdG9yXyQxXCIseik7ei5wcm90b3R5cGUuaz1udWxsO1xuei5wcm90b3R5cGUuYj0wO3oucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmsuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmsuYVt0aGlzLmIrK119O3oucHJvdG90eXBlLm5leHQ9ei5wcm90b3R5cGUubmV4dDt6LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmsuc2l6ZSgpPyEwOiExfTt6LnByb3RvdHlwZS5oYXNOZXh0PXoucHJvdG90eXBlLmM7ei5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTt6LnByb3RvdHlwZS5yZW1vdmU9ei5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIEEoKXt9ZyhBLHApO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkTWFwXCIsQSk7ZnVuY3Rpb24gQigpe31nKEIseCk7ZihcImphdmFzY3JpcHQudXRpbC5Tb3J0ZWRTZXRcIixCKTtmdW5jdGlvbiBDKCl7dGhpcy5hPVtdfWcoQyxuKTtmKFwiamF2YXNjcmlwdC51dGlsLlN0YWNrXCIsQyk7Qy5wcm90b3R5cGUuYT1udWxsO0MucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oYSl7dGhpcy5hLnB1c2goYSk7cmV0dXJuIGF9O0MucHJvdG90eXBlLnB1c2g9Qy5wcm90b3R5cGUucHVzaDtDLnByb3RvdHlwZS5wb3A9ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5hLmxlbmd0aCl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5hLnBvcCgpfTtDLnByb3RvdHlwZS5wb3A9Qy5wcm90b3R5cGUucG9wO0MucHJvdG90eXBlLm89ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5hLmxlbmd0aCl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5hW3RoaXMuYS5sZW5ndGgtMV19O0MucHJvdG90eXBlLnBlZWs9Qy5wcm90b3R5cGUubztDLnByb3RvdHlwZS5lbXB0eT1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aD8hMDohMX07Qy5wcm90b3R5cGUuZW1wdHk9Qy5wcm90b3R5cGUuZW1wdHk7XG5DLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW1wdHkoKX07Qy5wcm90b3R5cGUuaXNFbXB0eT1DLnByb3RvdHlwZS5nO0MucHJvdG90eXBlLnNlYXJjaD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hLmluZGV4T2YoYSl9O0MucHJvdG90eXBlLnNlYXJjaD1DLnByb3RvdHlwZS5zZWFyY2g7Qy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtDLnByb3RvdHlwZS5zaXplPUMucHJvdG90eXBlLnNpemU7Qy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O0MucHJvdG90eXBlLnRvQXJyYXk9Qy5wcm90b3R5cGUuaDtmdW5jdGlvbiBEKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5wYXJlbnR9ZnVuY3Rpb24gRShhLGIpe251bGwhPT1hJiYoYS5jb2xvcj1iKX1mdW5jdGlvbiBGKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5sZWZ0fWZ1bmN0aW9uIEcoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLnJpZ2h0fWZ1bmN0aW9uIEgoKXt0aGlzLmQ9bnVsbDt0aGlzLm49MH1nKEgsQSk7ZihcImphdmFzY3JpcHQudXRpbC5UcmVlTWFwXCIsSCk7SC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLmQ7bnVsbCE9PWI7KXt2YXIgYz1hLmNvbXBhcmVUbyhiLmtleSk7aWYoMD5jKWI9Yi5sZWZ0O2Vsc2UgaWYoMDxjKWI9Yi5yaWdodDtlbHNlIHJldHVybiBiLnZhbHVlfXJldHVybiBudWxsfTtILnByb3RvdHlwZS5nZXQ9SC5wcm90b3R5cGUuZ2V0O1xuSC5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7aWYobnVsbD09PXRoaXMuZClyZXR1cm4gdGhpcy5kPXtrZXk6YSx2YWx1ZTpiLGxlZnQ6bnVsbCxyaWdodDpudWxsLHBhcmVudDpudWxsLGNvbG9yOjB9LHRoaXMubj0xLG51bGw7dmFyIGM9dGhpcy5kLGQsdDtkbyBpZihkPWMsdD1hLmNvbXBhcmVUbyhjLmtleSksMD50KWM9Yy5sZWZ0O2Vsc2UgaWYoMDx0KWM9Yy5yaWdodDtlbHNlIHJldHVybiBkPWMudmFsdWUsYy52YWx1ZT1iLGQ7d2hpbGUobnVsbCE9PWMpO2M9e2tleTphLGxlZnQ6bnVsbCxyaWdodDpudWxsLHZhbHVlOmIscGFyZW50OmQsY29sb3I6MH07MD50P2QubGVmdD1jOmQucmlnaHQ9Yztmb3IoYy5jb2xvcj0xO251bGwhPWMmJmMhPXRoaXMuZCYmMT09Yy5wYXJlbnQuY29sb3I7KUQoYyk9PUYoRChEKGMpKSk/KGQ9RyhEKEQoYykpKSwxPT0obnVsbD09ZD8wOmQuY29sb3IpPyhFKEQoYyksMCksRShkLDApLEUoRChEKGMpKSwxKSxjPUQoRChjKSkpOihjPT1HKEQoYykpJiZcbihjPUQoYyksSSh0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEoodGhpcyxEKEQoYykpKSkpOihkPUYoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RihEKGMpKSYmKGM9RChjKSxKKHRoaXMsYykpLEUoRChjKSwwKSxFKEQoRChjKSksMSksSSh0aGlzLEQoRChjKSkpKSk7dGhpcy5kLmNvbG9yPTA7dGhpcy5uKys7cmV0dXJuIG51bGx9O0gucHJvdG90eXBlLnB1dD1ILnByb3RvdHlwZS5wdXQ7SC5wcm90b3R5cGUubT1mdW5jdGlvbigpe3ZhciBhPW5ldyBzLGI7Yj10aGlzLmQ7aWYobnVsbCE9Yilmb3IoO251bGwhPWIubGVmdDspYj1iLmxlZnQ7aWYobnVsbCE9PWIpZm9yKGEuYWRkKGIudmFsdWUpO251bGwhPT0oYj1LKGIpKTspYS5hZGQoYi52YWx1ZSk7cmV0dXJuIGF9O0gucHJvdG90eXBlLnZhbHVlcz1ILnByb3RvdHlwZS5tO1xuZnVuY3Rpb24gSShhLGIpe2lmKG51bGwhPWIpe3ZhciBjPWIucmlnaHQ7Yi5yaWdodD1jLmxlZnQ7bnVsbCE9Yy5sZWZ0JiYoYy5sZWZ0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5sZWZ0PT1iP2IucGFyZW50LmxlZnQ9YzpiLnBhcmVudC5yaWdodD1jO2MubGVmdD1iO2IucGFyZW50PWN9fWZ1bmN0aW9uIEooYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLmxlZnQ7Yi5sZWZ0PWMucmlnaHQ7bnVsbCE9Yy5yaWdodCYmKGMucmlnaHQucGFyZW50PWIpO2MucGFyZW50PWIucGFyZW50O251bGw9PWIucGFyZW50P2EuZD1jOmIucGFyZW50LnJpZ2h0PT1iP2IucGFyZW50LnJpZ2h0PWM6Yi5wYXJlbnQubGVmdD1jO2MucmlnaHQ9YjtiLnBhcmVudD1jfX1cbmZ1bmN0aW9uIEsoYSl7aWYobnVsbD09PWEpcmV0dXJuIG51bGw7aWYobnVsbCE9PWEucmlnaHQpZm9yKHZhciBiPWEucmlnaHQ7bnVsbCE9PWIubGVmdDspYj1iLmxlZnQ7ZWxzZSBmb3IoYj1hLnBhcmVudDtudWxsIT09YiYmYT09PWIucmlnaHQ7KWE9YixiPWIucGFyZW50O3JldHVybiBifUgucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ufTtILnByb3RvdHlwZS5zaXplPUgucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24gTChhKXt0aGlzLmE9W107YSBpbnN0YW5jZW9mIG0mJnRoaXMuZShhKX1nKEwsQik7ZihcImphdmFzY3JpcHQudXRpbC5UcmVlU2V0XCIsTCk7TC5wcm90b3R5cGUuYT1udWxsO0wucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWlmKDA9PT10aGlzLmFbYl0uY29tcGFyZVRvKGEpKXJldHVybiEwO3JldHVybiExfTtMLnByb3RvdHlwZS5jb250YWlucz1MLnByb3RvdHlwZS5jb250YWlucztMLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oYSl7aWYodGhpcy5jb250YWlucyhhKSlyZXR1cm4hMTtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigxPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4gdGhpcy5hLnNwbGljZShiLDAsYSksITA7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O0wucHJvdG90eXBlLmFkZD1MLnByb3RvdHlwZS5hZGQ7XG5MLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O0wucHJvdG90eXBlLmFkZEFsbD1MLnByb3RvdHlwZS5lO0wucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307TC5wcm90b3R5cGUucmVtb3ZlPUwucHJvdG90eXBlLnJlbW92ZTtMLnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O0wucHJvdG90eXBlLnNpemU9TC5wcm90b3R5cGUuc2l6ZTtMLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5pc0VtcHR5PUwucHJvdG90eXBlLmc7TC5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O0wucHJvdG90eXBlLnRvQXJyYXk9TC5wcm90b3R5cGUuaDtMLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBOKHRoaXMpfTtcbkwucHJvdG90eXBlLml0ZXJhdG9yPUwucHJvdG90eXBlLmY7ZnVuY3Rpb24gTihhKXt0aGlzLmw9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMlwiLE4pO04ucHJvdG90eXBlLmw9bnVsbDtOLnByb3RvdHlwZS5iPTA7Ti5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKHRoaXMuYj09PXRoaXMubC5zaXplKCkpdGhyb3cgbmV3IHE7cmV0dXJuIHRoaXMubC5hW3RoaXMuYisrXX07Ti5wcm90b3R5cGUubmV4dD1OLnByb3RvdHlwZS5uZXh0O04ucHJvdG90eXBlLmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5iPHRoaXMubC5zaXplKCk/ITA6ITF9O04ucHJvdG90eXBlLmhhc05leHQ9Ti5wcm90b3R5cGUuYztOLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O04ucHJvdG90eXBlLnJlbW92ZT1OLnByb3RvdHlwZS5yZW1vdmU7XCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBnbG9iYWwmJihnbG9iYWwuamF2YXNjcmlwdD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsPXt9LGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0PXMsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5BcnJheXM9dixnbG9iYWwuamF2YXNjcmlwdC51dGlsLkNvbGxlY3Rpb249bSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb249aCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkhhc2hNYXA9dyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkhhc2hTZXQ9eSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb249ayxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkl0ZXJhdG9yPWwsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5MaXN0PW4sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5NYXA9cCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb249cSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLk9wZXJhdGlvbk5vdFN1cHBvcnRlZD1cbnIsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5TZXQ9eCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcD1BLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0PUIsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5TdGFjaz1DLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuVHJlZU1hcD1ILGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuVHJlZVNldD1MKTt9KS5jYWxsKHRoaXMpO1xuIiwidmFyIGZlYXR1cmVDb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xudmFyIGVhY2ggPSByZXF1aXJlKCd0dXJmLW1ldGEnKS5jb29yZEVhY2g7XG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG5cbi8qKlxuICogVGFrZXMgYW55IHtAbGluayBHZW9KU09OfSBvYmplY3QgYW5kIHJldHVybiBhbGwgcG9zaXRpb25zIGFzXG4gKiBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvZXhwbG9kZVxuICogQGNhdGVnb3J5IG1pc2NcbiAqIEBwYXJhbSB7R2VvSlNPTn0gaW5wdXQgaW5wdXQgZmVhdHVyZXNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgcmVwcmVzZW50aW5nIHRoZSBleHBsb2RlZCBpbnB1dCBmZWF0dXJlc1xuICogQHRocm93cyB7RXJyb3J9IGlmIGl0IGVuY291bnRlcnMgYW4gdW5rbm93biBnZW9tZXRyeSB0eXBlXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHkgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWzE3Ny40MzQ2OTIsIC0xNy43NzUxN10sXG4gKiAgICAgICBbMTc3LjQwMjA3NiwgLTE3Ljc3OTA5M10sXG4gKiAgICAgICBbMTc3LjM4MDc5LCAtMTcuODAzOTM3XSxcbiAqICAgICAgIFsxNzcuNDAyNDIsIC0xNy44MjYxNjRdLFxuICogICAgICAgWzE3Ny40Mzg0NjgsIC0xNy44MjQ4NTddLFxuICogICAgICAgWzE3Ny40NTQ5NDgsIC0xNy43OTY3NDZdLFxuICogICAgICAgWzE3Ny40MzQ2OTIsIC0xNy43NzUxN11cbiAqICAgICBdXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBwb2ludHMgPSB0dXJmLmV4cGxvZGUocG9seSk7XG4gKlxuICogLy89cG9seVxuICpcbiAqIC8vPXBvaW50c1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxheWVyKSB7XG4gIHZhciBwb2ludHMgPSBbXTtcbiAgZWFjaChsYXllciwgZnVuY3Rpb24oY29vcmQpIHtcbiAgICBwb2ludHMucHVzaChwb2ludChjb29yZCkpO1xuICB9KTtcbiAgcmV0dXJuIGZlYXR1cmVDb2xsZWN0aW9uKHBvaW50cyk7XG59O1xuIiwidmFyIGVhY2ggPSByZXF1aXJlKCd0dXJmLW1ldGEnKS5jb29yZEVhY2g7XG5cbi8qKlxuICogVGFrZXMgYW55IHtAbGluayBHZW9KU09OfSBvYmplY3QsIGNhbGN1bGF0ZXMgdGhlIGV4dGVudCBvZiBhbGwgaW5wdXQgZmVhdHVyZXMsIGFuZCByZXR1cm5zIGEgYm91bmRpbmcgYm94LlxuICpcbiAqIEBtb2R1bGUgdHVyZi9leHRlbnRcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtHZW9KU09OfSBpbnB1dCBhbnkgdmFsaWQgR2VvSlNPTiBPYmplY3RcbiAqIEByZXR1cm4ge0FycmF5PG51bWJlcj59IHRoZSBib3VuZGluZyBib3ggb2YgYGlucHV0YCBnaXZlblxuICogYXMgYW4gYXJyYXkgaW4gV1NFTiBvcmRlciAod2VzdCwgc291dGgsIGVhc3QsIG5vcnRoKVxuICogQGV4YW1wbGVcbiAqIHZhciBpbnB1dCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzExNC4xNzUzMjksIDIyLjI1MjRdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzExNC4xNzAwMDcsIDIyLjI2Nzk2OV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTE0LjIwMDY0OSwgMjIuMjc0NjQxXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMTQuMTg2NzQ0LCAyMi4yNjU3NDVdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBiYm94ID0gdHVyZi5leHRlbnQoaW5wdXQpO1xuICpcbiAqIHZhciBiYm94UG9seWdvbiA9IHR1cmYuYmJveFBvbHlnb24oYmJveCk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gaW5wdXQuZmVhdHVyZXMuY29uY2F0KGJib3hQb2x5Z29uKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGF5ZXIpIHtcbiAgICB2YXIgZXh0ZW50ID0gW0luZmluaXR5LCBJbmZpbml0eSwgLUluZmluaXR5LCAtSW5maW5pdHldO1xuICAgIGVhY2gobGF5ZXIsIGZ1bmN0aW9uKGNvb3JkKSB7XG4gICAgICBpZiAoZXh0ZW50WzBdID4gY29vcmRbMF0pIGV4dGVudFswXSA9IGNvb3JkWzBdO1xuICAgICAgaWYgKGV4dGVudFsxXSA+IGNvb3JkWzFdKSBleHRlbnRbMV0gPSBjb29yZFsxXTtcbiAgICAgIGlmIChleHRlbnRbMl0gPCBjb29yZFswXSkgZXh0ZW50WzJdID0gY29vcmRbMF07XG4gICAgICBpZiAoZXh0ZW50WzNdIDwgY29vcmRbMV0pIGV4dGVudFszXSA9IGNvb3JkWzFdO1xuICAgIH0pO1xuICAgIHJldHVybiBleHRlbnQ7XG59O1xuIiwiLyoqXG4gKiBUYWtlcyBvbmUgb3IgbW9yZSB7QGxpbmsgRmVhdHVyZXxGZWF0dXJlc30gYW5kIGNyZWF0ZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259XG4gKlxuICogQG1vZHVsZSB0dXJmL2ZlYXR1cmVjb2xsZWN0aW9uXG4gKiBAY2F0ZWdvcnkgaGVscGVyXG4gKiBAcGFyYW0ge0ZlYXR1cmV9IGZlYXR1cmVzIGlucHV0IEZlYXR1cmVzXG4gKiBAcmV0dXJucyB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgaW5wdXQgZmVhdHVyZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgZmVhdHVyZXMgPSBbXG4gKiAgdHVyZi5wb2ludChbLTc1LjM0MywgMzkuOTg0XSwge25hbWU6ICdMb2NhdGlvbiBBJ30pLFxuICogIHR1cmYucG9pbnQoWy03NS44MzMsIDM5LjI4NF0sIHtuYW1lOiAnTG9jYXRpb24gQid9KSxcbiAqICB0dXJmLnBvaW50KFstNzUuNTM0LCAzOS4xMjNdLCB7bmFtZTogJ0xvY2F0aW9uIEMnfSlcbiAqIF07XG4gKlxuICogdmFyIGZjID0gdHVyZi5mZWF0dXJlY29sbGVjdGlvbihmZWF0dXJlcyk7XG4gKlxuICogLy89ZmNcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmZWF0dXJlcyl7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICAgIGZlYXR1cmVzOiBmZWF0dXJlc1xuICB9O1xufTtcbiIsInZhciBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gYW5kIGZpbHRlcnMgaXQgYnkgYSBnaXZlbiBwcm9wZXJ0eSBhbmQgdmFsdWVcbiAqXG4gKiBAbW9kdWxlIHR1cmYvZmlsdGVyXG4gKiBAY2F0ZWdvcnkgZGF0YVxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gZmVhdHVyZXMgaW5wdXQgRmVhdHVyZUNvbGxlY3Rpb24gb2YgYW55IHR5cGVcbiAqIEBwYXJhbSB7U3RyaW5nfSBrZXkgdGhlIHByb3BlcnR5IG9uIHdoaWNoIHRvIGZpbHRlclxuICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlIHRoZSB2YWx1ZSBvZiB0aGF0IHByb3BlcnR5IG9uIHdoaWNoIHRvIGZpbHRlclxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgZmlsdGVyZWQgY29sbGVjdGlvbiB3aXRoIG9ubHkgZmVhdHVyZXMgdGhhdCBtYXRjaCBpbnB1dCBga2V5YCBhbmQgYHZhbHVlYFxuICogQGV4YW1wbGVcbiAqIHZhciBmZWF0dXJlcyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJzcGVjaWVzXCI6IFwib2FrXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTcyLjU4MTc3NywgNDQuMjYwODc1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwic3BlY2llc1wiOiBcImJpcmNoXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTcyLjU3MDAxOCwgNDQuMjYwNjkxXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwic3BlY2llc1wiOiBcIm9ha1wiXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy03Mi41NzYyODQsIDQ0LjI1NzkyNV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInNwZWNpZXNcIjogXCJyZWR3b29kXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTcyLjU2OTE2LCA0NC4yNTQ2MDVdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJzcGVjaWVzXCI6IFwibWFwbGVcIlxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzIuNTgxNjkxLCA0NC4yNDg1OF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInNwZWNpZXNcIjogXCJvYWtcIlxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzIuNTgzODM3LCA0NC4yNTU3NzNdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBrZXkgPSBcInNwZWNpZXNcIjtcbiAqIHZhciB2YWx1ZSA9IFwib2FrXCI7XG4gKlxuICogdmFyIGZpbHRlcmVkID0gdHVyZi5maWx0ZXIoZmVhdHVyZXMsIGtleSwgdmFsdWUpO1xuICpcbiAqIC8vPWZlYXR1cmVzXG4gKlxuICogLy89ZmlsdGVyZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjb2xsZWN0aW9uLCBrZXksIHZhbCkge1xuICB2YXIgbmV3RkMgPSBmZWF0dXJlQ29sbGVjdGlvbihbXSk7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBjb2xsZWN0aW9uLmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYoY29sbGVjdGlvbi5mZWF0dXJlc1tpXS5wcm9wZXJ0aWVzW2tleV0gPT09IHZhbCkge1xuICAgICAgbmV3RkMuZmVhdHVyZXMucHVzaChjb2xsZWN0aW9uLmZlYXR1cmVzW2ldKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5ld0ZDO1xufTtcbiIsIi8qKlxuICogVGFrZXMgYSB7QGxpbmsgR2VvSlNPTn0gb2JqZWN0IG9mIGFueSB0eXBlIGFuZCBmbGlwcyBhbGwgb2YgaXRzIGNvb3JkaW5hdGVzXG4gKiBmcm9tIGBbeCwgeV1gIHRvIGBbeSwgeF1gLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9mbGlwXG4gKiBAY2F0ZWdvcnkgbWlzY1xuICogQHBhcmFtIHtHZW9KU09OfSBpbnB1dCBpbnB1dCBHZW9KU09OIG9iamVjdFxuICogQHJldHVybnMge0dlb0pTT059IGEgR2VvSlNPTiBvYmplY3Qgb2YgdGhlIHNhbWUgdHlwZSBhcyBgaW5wdXRgIHdpdGggZmxpcHBlZCBjb29yZGluYXRlc1xuICogQGV4YW1wbGVcbiAqIHZhciBzZXJiaWEgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogWzIwLjU2NjQwNiwgNDMuNDIxMDA4XVxuICogICB9XG4gKiB9O1xuICpcbiAqIC8vPXNlcmJpYVxuICpcbiAqIHZhciBzYXVkaUFyYWJpYSA9IHR1cmYuZmxpcChzZXJiaWEpO1xuICpcbiAqIC8vPXNhdWRpQXJhYmlhXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZmxpcEFueTtcblxuZnVuY3Rpb24gZmxpcEFueShfKSB7XG4gICAgLy8gZW5zdXJlIHRoYXQgd2UgZG9uJ3QgbW9kaWZ5IGZlYXR1cmVzIGluLXBsYWNlIGFuZCBjaGFuZ2VzIHRvIHRoZVxuICAgIC8vIG91dHB1dCBkbyBub3QgY2hhbmdlIHRoZSBwcmV2aW91cyBmZWF0dXJlLCBpbmNsdWRpbmcgY2hhbmdlcyB0byBuZXN0ZWRcbiAgICAvLyBwcm9wZXJ0aWVzLlxuICAgIHZhciBpbnB1dCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoXykpO1xuICAgIHN3aXRjaCAoaW5wdXQudHlwZSkge1xuICAgICAgICBjYXNlICdGZWF0dXJlQ29sbGVjdGlvbic6XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0LmZlYXR1cmVzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIGZsaXBHZW9tZXRyeShpbnB1dC5mZWF0dXJlc1tpXS5nZW9tZXRyeSk7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgICAgIGNhc2UgJ0ZlYXR1cmUnOlxuICAgICAgICAgICAgZmxpcEdlb21ldHJ5KGlucHV0Lmdlb21ldHJ5KTtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dDtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGZsaXBHZW9tZXRyeShpbnB1dCk7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmbGlwR2VvbWV0cnkoZ2VvbWV0cnkpIHtcbiAgICB2YXIgY29vcmRzID0gZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gICAgc3dpdGNoKGdlb21ldHJ5LnR5cGUpIHtcbiAgICAgIGNhc2UgJ1BvaW50JzpcbiAgICAgICAgZmxpcDAoY29vcmRzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdMaW5lU3RyaW5nJzpcbiAgICAgIGNhc2UgJ011bHRpUG9pbnQnOlxuICAgICAgICBmbGlwMShjb29yZHMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1BvbHlnb24nOlxuICAgICAgY2FzZSAnTXVsdGlMaW5lU3RyaW5nJzpcbiAgICAgICAgZmxpcDIoY29vcmRzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdNdWx0aVBvbHlnb24nOlxuICAgICAgICBmbGlwMyhjb29yZHMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0dlb21ldHJ5Q29sbGVjdGlvbic6XG4gICAgICAgIGdlb21ldHJ5Lmdlb21ldHJpZXMuZm9yRWFjaChmbGlwR2VvbWV0cnkpO1xuICAgICAgICBicmVhaztcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZsaXAwKGNvb3JkKSB7XG4gICAgY29vcmQucmV2ZXJzZSgpO1xufVxuXG5mdW5jdGlvbiBmbGlwMShjb29yZHMpIHtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykgY29vcmRzW2ldLnJldmVyc2UoKTtcbn1cblxuZnVuY3Rpb24gZmxpcDIoY29vcmRzKSB7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspXG4gICAgZm9yKHZhciBqID0gMDsgaiA8IGNvb3Jkc1tpXS5sZW5ndGg7IGorKykgY29vcmRzW2ldW2pdLnJldmVyc2UoKTtcbn1cblxuZnVuY3Rpb24gZmxpcDMoY29vcmRzKSB7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspXG4gICAgZm9yKHZhciBqID0gMDsgaiA8IGNvb3Jkc1tpXS5sZW5ndGg7IGorKylcbiAgICAgIGZvcih2YXIgayA9IDA7IGsgPCBjb29yZHNbaV1bal0ubGVuZ3RoOyBrKyspIGNvb3Jkc1tpXVtqXVtrXS5yZXZlcnNlKCk7XG59XG4iLCJ2YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG52YXIgcG9seWdvbiA9IHJlcXVpcmUoJ3R1cmYtcG9seWdvbicpO1xudmFyIGRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xudmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xuXG4vKipcbiAqIFRha2VzIGEgYm91bmRpbmcgYm94IGFuZCBhIGNlbGwgc2l6ZSBpbiBkZWdyZWVzIGFuZCByZXR1cm5zIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiBmbGF0LXRvcHBlZFxuICogaGV4YWdvbnMgKHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcykgYWxpZ25lZCBpbiBhbiBcIm9kZC1xXCIgdmVydGljYWwgZ3JpZCBhc1xuICogZGVzY3JpYmVkIGluIFtIZXhhZ29uYWwgR3JpZHNdKGh0dHA6Ly93d3cucmVkYmxvYmdhbWVzLmNvbS9ncmlkcy9oZXhhZ29ucy8pXG4gKlxuICogQG1vZHVsZSB0dXJmL2hleC1ncmlkXG4gKiBAY2F0ZWdvcnkgaW50ZXJwb2xhdGlvblxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBiYm94IGJvdW5kaW5nIGJveCBpbiBbbWluWCwgbWluWSwgbWF4WCwgbWF4WV0gb3JkZXJcbiAqIEBwYXJhbSB7TnVtYmVyfSBjZWxsV2lkdGggd2lkdGggb2YgY2VsbCBpbiBzcGVjaWZpZWQgdW5pdHNcbiAqIEBwYXJhbSB7U3RyaW5nfSB1bml0cyB1c2VkIGluIGNhbGN1bGF0aW5nIGNlbGxXaWR0aCAoJ21pbGVzJyBvciAna2lsb21ldGVycycpXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gdW5pdHMgdXNlZCBpbiBjYWxjdWxhdGluZyBjZWxsV2lkdGggKCdtaWxlcycgb3IgJ2tpbG9tZXRlcnMnKVxuICogQGV4YW1wbGVcbiAqIHZhciBiYm94ID0gWy05NiwzMSwtODQsNDBdO1xuICogdmFyIGNlbGxXaWR0aCA9IDUwO1xuICogdmFyIHVuaXRzID0gJ21pbGVzJztcbiAqXG4gKiB2YXIgaGV4Z3JpZCA9IHR1cmYuaGV4R3JpZChiYm94LCBjZWxsV2lkdGgsIHVuaXRzKTtcbiAqXG4gKiAvLz1oZXhncmlkXG4gKi9cblxuLy9QcmVjb21wdXRlIGNvc2luZXMgYW5kIHNpbmVzIG9mIGFuZ2xlcyB1c2VkIGluIGhleGFnb24gY3JlYXRpb25cbi8vIGZvciBwZXJmb3JtYW5jZSBnYWluXG52YXIgY29zaW5lcyA9IFtdO1xudmFyIHNpbmVzID0gW107XG5mb3IgKHZhciBpID0gMDsgaSA8IDY7IGkrKykge1xuICB2YXIgYW5nbGUgPSAyICogTWF0aC5QSS82ICogaTtcbiAgY29zaW5lcy5wdXNoKE1hdGguY29zKGFuZ2xlKSk7XG4gIHNpbmVzLnB1c2goTWF0aC5zaW4oYW5nbGUpKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBoZXhncmlkKGJib3gsIGNlbGwsIHVuaXRzKSB7XG4gIHZhciB4RnJhY3Rpb24gPSBjZWxsIC8gKGRpc3RhbmNlKHBvaW50KFtiYm94WzBdLCBiYm94WzFdXSksIHBvaW50KFtiYm94WzJdLCBiYm94WzFdXSksIHVuaXRzKSk7XG4gIHZhciBjZWxsV2lkdGggPSB4RnJhY3Rpb24gKiAoYmJveFsyXSAtIGJib3hbMF0pO1xuICB2YXIgeUZyYWN0aW9uID0gY2VsbCAvIChkaXN0YW5jZShwb2ludChbYmJveFswXSwgYmJveFsxXV0pLCBwb2ludChbYmJveFswXSwgYmJveFszXV0pLCB1bml0cykpO1xuICB2YXIgY2VsbEhlaWdodCA9IHlGcmFjdGlvbiAqIChiYm94WzNdIC0gYmJveFsxXSk7XG4gIHZhciByYWRpdXMgPSBjZWxsV2lkdGggLyAyO1xuXG4gIHZhciBoZXhfd2lkdGggPSByYWRpdXMgKiAyO1xuICB2YXIgaGV4X2hlaWdodCA9IE1hdGguc3FydCgzKS8yICogaGV4X3dpZHRoO1xuXG4gIHZhciBib3hfd2lkdGggPSBiYm94WzJdIC0gYmJveFswXTtcbiAgdmFyIGJveF9oZWlnaHQgPSBiYm94WzNdIC0gYmJveFsxXTtcblxuICB2YXIgeF9pbnRlcnZhbCA9IDMvNCAqIGhleF93aWR0aDtcbiAgdmFyIHlfaW50ZXJ2YWwgPSBoZXhfaGVpZ2h0O1xuXG4gIHZhciB4X3NwYW4gPSBib3hfd2lkdGggLyAoaGV4X3dpZHRoIC0gcmFkaXVzLzIpO1xuICB2YXIgeF9jb3VudCA9IE1hdGguY2VpbCh4X3NwYW4pO1xuICBpZiAoTWF0aC5yb3VuZCh4X3NwYW4pID09PSB4X2NvdW50KSB7XG4gICAgeF9jb3VudCsrO1xuICB9XG5cbiAgdmFyIHhfYWRqdXN0ID0gKCh4X2NvdW50ICogeF9pbnRlcnZhbCAtIHJhZGl1cy8yKSAtIGJveF93aWR0aCkvMiAtIHJhZGl1cy8yO1xuXG4gIHZhciB5X2NvdW50ID0gTWF0aC5jZWlsKGJveF9oZWlnaHQgLyBoZXhfaGVpZ2h0KTtcblxuICB2YXIgeV9hZGp1c3QgPSAoYm94X2hlaWdodCAtIHlfY291bnQgKiBoZXhfaGVpZ2h0KS8yO1xuXG4gIHZhciBoYXNPZmZzZXRZID0geV9jb3VudCAqIGhleF9oZWlnaHQgLSBib3hfaGVpZ2h0ID4gaGV4X2hlaWdodC8yO1xuICBpZiAoaGFzT2Zmc2V0WSkge1xuICAgIHlfYWRqdXN0IC09IGhleF9oZWlnaHQvNDtcbiAgfVxuXG4gIHZhciBmYyA9IGZlYXR1cmVjb2xsZWN0aW9uKFtdKTtcbiAgZm9yICh2YXIgeCA9IDA7IHggPCB4X2NvdW50OyB4KyspIHtcbiAgICBmb3IgKHZhciB5ID0gMDsgeSA8PSB5X2NvdW50OyB5KyspIHtcblxuICAgICAgdmFyIGlzT2RkID0geCAlIDIgPT09IDE7XG4gICAgICBpZiAoeSA9PT0gMCAmJiBpc09kZCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHkgPT09IDAgJiYgaGFzT2Zmc2V0WSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIGNlbnRlcl94ID0geCAqIHhfaW50ZXJ2YWwgKyBiYm94WzBdIC0geF9hZGp1c3Q7XG4gICAgICB2YXIgY2VudGVyX3kgPSB5ICogeV9pbnRlcnZhbCArIGJib3hbMV0gKyB5X2FkanVzdDtcblxuICAgICAgaWYgKGlzT2RkKSB7XG4gICAgICAgIGNlbnRlcl95IC09IGhleF9oZWlnaHQvMjtcbiAgICAgIH1cbiAgICAgIGZjLmZlYXR1cmVzLnB1c2goaGV4YWdvbihbY2VudGVyX3gsIGNlbnRlcl95XSwgcmFkaXVzKSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZjO1xufTtcblxuLy9DZW50ZXIgc2hvdWxkIGJlIFt4LCB5XVxuZnVuY3Rpb24gaGV4YWdvbihjZW50ZXIsIHJhZGl1cykge1xuICB2YXIgdmVydGljZXMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCA2OyBpKyspIHtcbiAgICB2YXIgeCA9IGNlbnRlclswXSArIHJhZGl1cyAqIGNvc2luZXNbaV07XG4gICAgdmFyIHkgPSBjZW50ZXJbMV0gKyByYWRpdXMgKiBzaW5lc1tpXTtcbiAgICB2ZXJ0aWNlcy5wdXNoKFt4LHldKTtcbiAgfVxuICAvL2ZpcnN0IGFuZCBsYXN0IHZlcnRleCBtdXN0IGJlIHRoZSBzYW1lXG4gIHZlcnRpY2VzLnB1c2godmVydGljZXNbMF0pO1xuICByZXR1cm4gcG9seWdvbihbdmVydGljZXNdKTtcbn0iLCIvLyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0V2ZW4lRTIlODAlOTNvZGRfcnVsZVxuLy8gbW9kaWZpZWQgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL3N1YnN0YWNrL3BvaW50LWluLXBvbHlnb24vYmxvYi9tYXN0ZXIvaW5kZXguanNcbi8vIHdoaWNoIHdhcyBtb2RpZmllZCBmcm9tIGh0dHA6Ly93d3cuZWNzZS5ycGkuZWR1L0hvbWVwYWdlcy93cmYvUmVzZWFyY2gvU2hvcnRfTm90ZXMvcG5wb2x5Lmh0bWxcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBQb2ludH0gZmVhdHVyZSBhbmQgYSB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZSBhbmQgZGV0ZXJtaW5lcyBpZiB0aGUgUG9pbnQgcmVzaWRlcyBpbnNpZGUgdGhlIFBvbHlnb24uIFRoZSBQb2x5Z29uIGNhblxuICogYmUgY29udmV4IG9yIGNvbmNhdmUuIFRoZSBmdW5jdGlvbiBhY2NlcHRzIGFueSB2YWxpZCBQb2x5Z29uIG9yIHtAbGluayBNdWx0aVBvbHlnb259XG4gKiBhbmQgYWNjb3VudHMgZm9yIGhvbGVzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9pbnNpZGVcbiAqIEBjYXRlZ29yeSBqb2luc1xuICogQHBhcmFtIHtQb2ludH0gcG9pbnQgYSBQb2ludCBmZWF0dXJlXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHlnb24gYSBQb2x5Z29uIGZlYXR1cmVcbiAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiB0aGUgUG9pbnQgaXMgaW5zaWRlIHRoZSBQb2x5Z29uOyBgZmFsc2VgIGlmIHRoZSBQb2ludCBpcyBub3QgaW5zaWRlIHRoZSBQb2x5Z29uXG4gKiBAZXhhbXBsZVxuICogdmFyIHB0MSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwibWFya2VyLWNvbG9yXCI6IFwiI2YwMFwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTExMS40NjcyODUsIDQwLjc1NzY2XVxuICogICB9XG4gKiB9O1xuICogdmFyIHB0MiA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwibWFya2VyLWNvbG9yXCI6IFwiIzBmMFwiXG4gKiAgIH0sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTExMS44NzM3NzksIDQwLjY0NzMwM11cbiAqICAgfVxuICogfTtcbiAqIHZhciBwb2x5ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstMTEyLjA3NDI3OSwgNDAuNTIyMTVdLFxuICogICAgICAgWy0xMTIuMDc0Mjc5LCA0MC44NTMyOTNdLFxuICogICAgICAgWy0xMTEuNjEwMTA3LCA0MC44NTMyOTNdLFxuICogICAgICAgWy0xMTEuNjEwMTA3LCA0MC41MjIxNV0sXG4gKiAgICAgICBbLTExMi4wNzQyNzksIDQwLjUyMjE1XVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG4gKlxuICogdmFyIGZlYXR1cmVzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtwdDEsIHB0MiwgcG9seV1cbiAqIH07XG4gKlxuICogLy89ZmVhdHVyZXNcbiAqXG4gKiB2YXIgaXNJbnNpZGUxID0gdHVyZi5pbnNpZGUocHQxLCBwb2x5KTtcbiAqIC8vPWlzSW5zaWRlMVxuICpcbiAqIHZhciBpc0luc2lkZTIgPSB0dXJmLmluc2lkZShwdDIsIHBvbHkpO1xuICogLy89aXNJbnNpZGUyXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnQsIHBvbHlnb24pIHtcbiAgdmFyIHBvbHlzID0gcG9seWdvbi5nZW9tZXRyeS5jb29yZGluYXRlcztcbiAgdmFyIHB0ID0gW3BvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLCBwb2ludC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXV07XG4gIC8vIG5vcm1hbGl6ZSB0byBtdWx0aXBvbHlnb25cbiAgaWYocG9seWdvbi5nZW9tZXRyeS50eXBlID09PSAnUG9seWdvbicpIHBvbHlzID0gW3BvbHlzXTtcblxuICB2YXIgaW5zaWRlUG9seSA9IGZhbHNlO1xuICB2YXIgaSA9IDA7XG4gIHdoaWxlIChpIDwgcG9seXMubGVuZ3RoICYmICFpbnNpZGVQb2x5KSB7XG4gICAgLy8gY2hlY2sgaWYgaXQgaXMgaW4gdGhlIG91dGVyIHJpbmcgZmlyc3RcbiAgICBpZihpblJpbmcocHQsIHBvbHlzW2ldWzBdKSkge1xuICAgICAgdmFyIGluSG9sZSA9IGZhbHNlO1xuICAgICAgdmFyIGsgPSAxO1xuICAgICAgLy8gY2hlY2sgZm9yIHRoZSBwb2ludCBpbiBhbnkgb2YgdGhlIGhvbGVzXG4gICAgICB3aGlsZShrIDwgcG9seXNbaV0ubGVuZ3RoICYmICFpbkhvbGUpIHtcbiAgICAgICAgaWYoaW5SaW5nKHB0LCBwb2x5c1tpXVtrXSkpIHtcbiAgICAgICAgICBpbkhvbGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGsrKztcbiAgICAgIH1cbiAgICAgIGlmKCFpbkhvbGUpIGluc2lkZVBvbHkgPSB0cnVlO1xuICAgIH1cbiAgICBpKys7XG4gIH1cbiAgcmV0dXJuIGluc2lkZVBvbHk7XG59XG5cbi8vIHB0IGlzIFt4LHldIGFuZCByaW5nIGlzIFtbeCx5XSwgW3gseV0sLi5dXG5mdW5jdGlvbiBpblJpbmcgKHB0LCByaW5nKSB7XG4gIHZhciBpc0luc2lkZSA9IGZhbHNlO1xuICBmb3IgKHZhciBpID0gMCwgaiA9IHJpbmcubGVuZ3RoIC0gMTsgaSA8IHJpbmcubGVuZ3RoOyBqID0gaSsrKSB7XG4gICAgdmFyIHhpID0gcmluZ1tpXVswXSwgeWkgPSByaW5nW2ldWzFdO1xuICAgIHZhciB4aiA9IHJpbmdbal1bMF0sIHlqID0gcmluZ1tqXVsxXTtcbiAgICBcbiAgICB2YXIgaW50ZXJzZWN0ID0gKCh5aSA+IHB0WzFdKSAhPSAoeWogPiBwdFsxXSkpXG4gICAgICAgICYmIChwdFswXSA8ICh4aiAtIHhpKSAqIChwdFsxXSAtIHlpKSAvICh5aiAtIHlpKSArIHhpKTtcbiAgICBpZiAoaW50ZXJzZWN0KSBpc0luc2lkZSA9ICFpc0luc2lkZTtcbiAgfVxuICByZXR1cm4gaXNJbnNpZGU7XG59XG5cbiIsIi8vIGRlcGVuZCBvbiBqc3RzIGZvciBub3cgaHR0cHM6Ly9naXRodWIuY29tL2Jqb3JuaGFycnRlbGwvanN0cy9ibG9iL21hc3Rlci9leGFtcGxlcy9vdmVybGF5Lmh0bWxcbnZhciBqc3RzID0gcmVxdWlyZSgnanN0cycpO1xudmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xuXG4vKipcbiAqIFRha2VzIHR3byB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgYW5kIGZpbmRzIHRoZWlyIGludGVyc2VjdGlvbi5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvaW50ZXJzZWN0XG4gKiBAY2F0ZWdvcnkgdHJhbnNmb3JtYXRpb25cbiAqIEBwYXJhbSB7UG9seWdvbn0gcG9seTEgdGhlIGZpcnN0IFBvbHlnb25cbiAqIEBwYXJhbSB7UG9seWdvbn0gcG9seTIgdGhlIHNlY29uZCBQb2x5Z29uXG4gKiBAcmV0dXJuIHtQb2x5Z29ufSBhIFBvbHlnb24gZmVhdHVyZSByZXByZXNlbnRpbmcgdGhlIGFyZWEgd2hlcmUgYHBvbHkxYCBhbmQgYHBvbHkyYCBvdmVybGFwXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHkxID0gdHVyZi5wb2x5Z29uKFtbXG4gKiAgWy0xMjIuODAxNzQyLCA0NS40ODU2NV0sXG4gKiAgWy0xMjIuODAxNzQyLCA0NS42MDQ5MV0sXG4gKiAgWy0xMjIuNTg0NzYyLCA0NS42MDQ5MV0sXG4gKiAgWy0xMjIuNTg0NzYyLCA0NS40ODU2NV0sXG4gKiAgWy0xMjIuODAxNzQyLCA0NS40ODU2NV1cbiAqIF1dKTtcbiAqIHBvbHkxLnByb3BlcnRpZXMuZmlsbCA9ICcjMGYwJztcbiAqIHZhciBwb2x5MiA9IHR1cmYucG9seWdvbihbW1xuICogIFstMTIyLjUyMDIxNywgNDUuNTM1NjkzXSxcbiAqICBbLTEyMi42NDAzOCwgNDUuNTUzOTY3XSxcbiAqICBbLTEyMi43MjAwMzEsIDQ1LjUyNjU1NF0sXG4gKiAgWy0xMjIuNjY5OTA2LCA0NS41MDczMDldLFxuICogIFstMTIyLjcyMzQ2NCwgNDUuNDQ2NjQzXSxcbiAqICBbLTEyMi41MzI1NzcsIDQ1LjQwODU3NF0sXG4gKiAgWy0xMjIuNDg3MjU4LCA0NS40Nzc0NjZdLFxuICogIFstMTIyLjUyMDIxNywgNDUuNTM1NjkzXVxuICogXV0pO1xuICogcG9seTIucHJvcGVydGllcy5maWxsID0gJyMwMGYnO1xuICogdmFyIHBvbHlnb25zID0gdHVyZi5mZWF0dXJlY29sbGVjdGlvbihbcG9seTEsIHBvbHkyXSk7XG4gKlxuICogdmFyIGludGVyc2VjdGlvbiA9IHR1cmYuaW50ZXJzZWN0KHBvbHkxLCBwb2x5Mik7XG4gKlxuICogLy89cG9seWdvbnNcbiAqXG4gKiAvLz1pbnRlcnNlY3Rpb25cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5MSwgcG9seTIpe1xuICB2YXIgZ2VvbTE7XG4gIGlmKHBvbHkxLnR5cGUgPT09ICdGZWF0dXJlJykgZ2VvbTEgPSBwb2x5MS5nZW9tZXRyeTtcbiAgZWxzZSBnZW9tMSA9IHBvbHkxO1xuICBpZihwb2x5Mi50eXBlID09PSAnRmVhdHVyZScpIGdlb20yID0gcG9seTIuZ2VvbWV0cnk7XG4gIGVsc2UgZ2VvbTIgPSBwb2x5MjtcbiAgdmFyIHJlYWRlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05SZWFkZXIoKTtcbiAgdmFyIGEgPSByZWFkZXIucmVhZChKU09OLnN0cmluZ2lmeShnZW9tMSkpO1xuICB2YXIgYiA9IHJlYWRlci5yZWFkKEpTT04uc3RyaW5naWZ5KGdlb20yKSk7XG4gIHZhciBpbnRlcnNlY3Rpb24gPSBhLmludGVyc2VjdGlvbihiKTtcbiAgdmFyIHBhcnNlciA9IG5ldyBqc3RzLmlvLkdlb0pTT05QYXJzZXIoKTtcblxuICBpbnRlcnNlY3Rpb24gPSBwYXJzZXIud3JpdGUoaW50ZXJzZWN0aW9uKTtcbiAgaWYoaW50ZXJzZWN0aW9uLnR5cGUgPT09ICdHZW9tZXRyeUNvbGxlY3Rpb24nICYmIGludGVyc2VjdGlvbi5nZW9tZXRyaWVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgcHJvcGVydGllczoge30sXG4gICAgICBnZW9tZXRyeTogaW50ZXJzZWN0aW9uXG4gICAgfTtcbiAgfVxufTtcbiIsIi8qXG4gIGphdmFzY3JpcHQudXRpbCBpcyBhIHBvcnQgb2Ygc2VsZWN0ZWQgcGFydHMgb2YgamF2YS51dGlsIHRvIEphdmFTY3JpcHQgd2hpY2hcbiAgbWFpbiBwdXJwb3NlIGlzIHRvIGVhc2UgcG9ydGluZyBKYXZhIGNvZGUgdG8gSmF2YVNjcmlwdC5cbiAgXG4gIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG4gIENvcHlyaWdodCAoQykgMjAxMS0yMDE0IGJ5IFRoZSBBdXRob3JzXG5cbiAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIFRIRSBTT0ZUV0FSRS5cbiovXG47KGZ1bmN0aW9uKCl7dmFyIGU9dGhpcztmdW5jdGlvbiBmKGEsYil7dmFyIGM9YS5zcGxpdChcIi5cIiksZD1lO2NbMF1pbiBkfHwhZC5leGVjU2NyaXB0fHxkLmV4ZWNTY3JpcHQoXCJ2YXIgXCIrY1swXSk7Zm9yKHZhciB0O2MubGVuZ3RoJiYodD1jLnNoaWZ0KCkpOyljLmxlbmd0aHx8dm9pZCAwPT09Yj9kPWRbdF0/ZFt0XTpkW3RdPXt9OmRbdF09Yn1mdW5jdGlvbiBnKGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLnE9Yi5wcm90b3R5cGU7YS5wcm90b3R5cGU9bmV3IGM7YS5wcm90b3R5cGUuY29uc3RydWN0b3I9YTthLnA9ZnVuY3Rpb24oYSxjLE8pe3ZhciBNPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gYi5wcm90b3R5cGVbY10uYXBwbHkoYSxNKX19O2Z1bmN0aW9uIGgoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhoLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb25cIixoKTtoLnByb3RvdHlwZS5uYW1lPVwiRW1wdHlTdGFja0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGsoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhrLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25cIixrKTtrLnByb3RvdHlwZS5uYW1lPVwiSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGwoKXt9ZihcImphdmFzY3JpcHQudXRpbC5JdGVyYXRvclwiLGwpO2wucHJvdG90eXBlLmhhc05leHQ9bC5wcm90b3R5cGUuYztsLnByb3RvdHlwZS5uZXh0PWwucHJvdG90eXBlLm5leHQ7bC5wcm90b3R5cGUucmVtb3ZlPWwucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBtKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQ29sbGVjdGlvblwiLG0pO2Z1bmN0aW9uIG4oKXt9ZyhuLG0pO2YoXCJqYXZhc2NyaXB0LnV0aWwuTGlzdFwiLG4pO2Z1bmN0aW9uIHAoKXt9ZihcImphdmFzY3JpcHQudXRpbC5NYXBcIixwKTtmdW5jdGlvbiBxKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocSxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uXCIscSk7cS5wcm90b3R5cGUubmFtZT1cIk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIjtmdW5jdGlvbiByKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocixFcnJvcik7ci5wcm90b3R5cGUubmFtZT1cIk9wZXJhdGlvbk5vdFN1cHBvcnRlZFwiO2Z1bmN0aW9uIHMoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhzLG4pO2YoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0XCIscyk7cy5wcm90b3R5cGUuYT1udWxsO3MucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkPXMucHJvdG90eXBlLmFkZDtzLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3MucHJvdG90eXBlLmFkZEFsbD1zLnByb3RvdHlwZS5lO3MucHJvdG90eXBlLnNldD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYVthXTt0aGlzLmFbYV09YjtyZXR1cm4gY307cy5wcm90b3R5cGUuc2V0PXMucHJvdG90eXBlLnNldDtzLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB1KHRoaXMpfTtzLnByb3RvdHlwZS5pdGVyYXRvcj1zLnByb3RvdHlwZS5mO1xucy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2lmKDA+YXx8YT49dGhpcy5zaXplKCkpdGhyb3cgbmV3IGs7cmV0dXJuIHRoaXMuYVthXX07cy5wcm90b3R5cGUuZ2V0PXMucHJvdG90eXBlLmdldDtzLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5pc0VtcHR5PXMucHJvdG90eXBlLmc7cy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5zaXplPXMucHJvdG90eXBlLnNpemU7cy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O3MucHJvdG90eXBlLnRvQXJyYXk9cy5wcm90b3R5cGUuaDtcbnMucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihhKXtmb3IodmFyIGI9ITEsYz0wLGQ9dGhpcy5hLmxlbmd0aDtjPGQ7YysrKWlmKHRoaXMuYVtjXT09PWEpe3RoaXMuYS5zcGxpY2UoYywxKTtiPSEwO2JyZWFrfXJldHVybiBifTtzLnByb3RvdHlwZS5yZW1vdmU9cy5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIHUoYSl7dGhpcy5qPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfXCIsdSk7dS5wcm90b3R5cGUuaj1udWxsO3UucHJvdG90eXBlLmI9MDt1LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5qLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5qLmdldCh0aGlzLmIrKyl9O3UucHJvdG90eXBlLm5leHQ9dS5wcm90b3R5cGUubmV4dDt1LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmouc2l6ZSgpPyEwOiExfTt1LnByb3RvdHlwZS5oYXNOZXh0PXUucHJvdG90eXBlLmM7XG51LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3UucHJvdG90eXBlLnJlbW92ZT11LnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdigpe31mKFwiamF2YXNjcmlwdC51dGlsLkFycmF5c1wiLHYpO1xudi5zb3J0PWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdLGIsYyxkO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWEuc29ydCgpO2Vsc2UgaWYoMj09PWFyZ3VtZW50cy5sZW5ndGgpYz1hcmd1bWVudHNbMV0sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYS5zb3J0KGQpO2Vsc2UgaWYoMz09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxiLnNvcnQoKSxkPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKTtlbHNlIGlmKDQ9PT1hcmd1bWVudHMubGVuZ3RoKWZvcihiPWEuc2xpY2UoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSksYz1hcmd1bWVudHNbM10sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYi5zb3J0KGQpLFxuZD1hLnNsaWNlKDAsYXJndW1lbnRzWzFdKS5jb25jYXQoYixhLnNsaWNlKGFyZ3VtZW50c1syXSxhLmxlbmd0aCkpLGEuc3BsaWNlKDAsYS5sZW5ndGgpLGI9MDtiPGQubGVuZ3RoO2IrKylhLnB1c2goZFtiXSl9O3YuYXNMaXN0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1uZXcgcyxjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKWIuYWRkKGFbY10pO3JldHVybiBifTtmdW5jdGlvbiB3KCl7dGhpcy5pPXt9fWcodyxwKTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hNYXBcIix3KTt3LnByb3RvdHlwZS5pPW51bGw7dy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmlbYV18fG51bGx9O3cucHJvdG90eXBlLmdldD13LnByb3RvdHlwZS5nZXQ7dy5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaVthXT1ifTt3LnByb3RvdHlwZS5wdXQ9dy5wcm90b3R5cGUucHV0O3cucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2ZvcihiIGluIHRoaXMuaSl0aGlzLmkuaGFzT3duUHJvcGVydHkoYikmJmEuYWRkKHRoaXMuaVtiXSk7cmV0dXJuIGF9O3cucHJvdG90eXBlLnZhbHVlcz13LnByb3RvdHlwZS5tO3cucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tKCkuc2l6ZSgpfTt3LnByb3RvdHlwZS5zaXplPXcucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24geCgpe31nKHgsbSk7ZihcImphdmFzY3JpcHQudXRpbC5TZXRcIix4KTtmdW5jdGlvbiB5KGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcoeSx4KTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hTZXRcIix5KTt5LnByb3RvdHlwZS5hPW51bGw7eS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYodGhpcy5hW2JdPT09YSlyZXR1cm4hMDtyZXR1cm4hMX07eS5wcm90b3R5cGUuY29udGFpbnM9eS5wcm90b3R5cGUuY29udGFpbnM7eS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZD15LnByb3RvdHlwZS5hZGQ7eS5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTt5LnByb3RvdHlwZS5hZGRBbGw9eS5wcm90b3R5cGUuZTtcbnkucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307eS5wcm90b3R5cGUucmVtb3ZlPXkucHJvdG90eXBlLnJlbW92ZTt5LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmlzRW1wdHk9eS5wcm90b3R5cGUuZzt5LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07eS5wcm90b3R5cGUudG9BcnJheT15LnByb3RvdHlwZS5oO3kucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHoodGhpcyl9O3kucHJvdG90eXBlLml0ZXJhdG9yPXkucHJvdG90eXBlLmY7ZnVuY3Rpb24geihhKXt0aGlzLms9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMVwiLHopO3oucHJvdG90eXBlLms9bnVsbDtcbnoucHJvdG90eXBlLmI9MDt6LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5rLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5rLmFbdGhpcy5iKytdfTt6LnByb3RvdHlwZS5uZXh0PXoucHJvdG90eXBlLm5leHQ7ei5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5rLnNpemUoKT8hMDohMX07ei5wcm90b3R5cGUuaGFzTmV4dD16LnByb3RvdHlwZS5jO3oucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307ei5wcm90b3R5cGUucmVtb3ZlPXoucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBBKCl7fWcoQSxwKTtmKFwiamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcFwiLEEpO2Z1bmN0aW9uIEIoKXt9ZyhCLHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0XCIsQik7ZnVuY3Rpb24gQygpe3RoaXMuYT1bXX1nKEMsbik7ZihcImphdmFzY3JpcHQudXRpbC5TdGFja1wiLEMpO0MucHJvdG90eXBlLmE9bnVsbDtDLnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiBhfTtDLnByb3RvdHlwZS5wdXNoPUMucHJvdG90eXBlLnB1c2g7Qy5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYS5wb3AoKX07Qy5wcm90b3R5cGUucG9wPUMucHJvdG90eXBlLnBvcDtDLnByb3RvdHlwZS5vPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYVt0aGlzLmEubGVuZ3RoLTFdfTtDLnByb3RvdHlwZS5wZWVrPUMucHJvdG90eXBlLm87Qy5wcm90b3R5cGUuZW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGg/ITA6ITF9O0MucHJvdG90eXBlLmVtcHR5PUMucHJvdG90eXBlLmVtcHR5O1xuQy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVtcHR5KCl9O0MucHJvdG90eXBlLmlzRW1wdHk9Qy5wcm90b3R5cGUuZztDLnByb3RvdHlwZS5zZWFyY2g9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYS5pbmRleE9mKGEpfTtDLnByb3RvdHlwZS5zZWFyY2g9Qy5wcm90b3R5cGUuc2VhcmNoO0MucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07Qy5wcm90b3R5cGUuc2l6ZT1DLnByb3RvdHlwZS5zaXplO0MucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtDLnByb3RvdHlwZS50b0FycmF5PUMucHJvdG90eXBlLmg7ZnVuY3Rpb24gRChhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEucGFyZW50fWZ1bmN0aW9uIEUoYSxiKXtudWxsIT09YSYmKGEuY29sb3I9Yil9ZnVuY3Rpb24gRihhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEubGVmdH1mdW5jdGlvbiBHKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5yaWdodH1mdW5jdGlvbiBIKCl7dGhpcy5kPW51bGw7dGhpcy5uPTB9ZyhILEEpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcFwiLEgpO0gucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5kO251bGwhPT1iOyl7dmFyIGM9YS5jb21wYXJlVG8oYi5rZXkpO2lmKDA+YyliPWIubGVmdDtlbHNlIGlmKDA8YyliPWIucmlnaHQ7ZWxzZSByZXR1cm4gYi52YWx1ZX1yZXR1cm4gbnVsbH07SC5wcm90b3R5cGUuZ2V0PUgucHJvdG90eXBlLmdldDtcbkgucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhLGIpe2lmKG51bGw9PT10aGlzLmQpcmV0dXJuIHRoaXMuZD17a2V5OmEsdmFsdWU6YixsZWZ0Om51bGwscmlnaHQ6bnVsbCxwYXJlbnQ6bnVsbCxjb2xvcjowfSx0aGlzLm49MSxudWxsO3ZhciBjPXRoaXMuZCxkLHQ7ZG8gaWYoZD1jLHQ9YS5jb21wYXJlVG8oYy5rZXkpLDA+dCljPWMubGVmdDtlbHNlIGlmKDA8dCljPWMucmlnaHQ7ZWxzZSByZXR1cm4gZD1jLnZhbHVlLGMudmFsdWU9YixkO3doaWxlKG51bGwhPT1jKTtjPXtrZXk6YSxsZWZ0Om51bGwscmlnaHQ6bnVsbCx2YWx1ZTpiLHBhcmVudDpkLGNvbG9yOjB9OzA+dD9kLmxlZnQ9YzpkLnJpZ2h0PWM7Zm9yKGMuY29sb3I9MTtudWxsIT1jJiZjIT10aGlzLmQmJjE9PWMucGFyZW50LmNvbG9yOylEKGMpPT1GKEQoRChjKSkpPyhkPUcoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RyhEKGMpKSYmXG4oYz1EKGMpLEkodGhpcyxjKSksRShEKGMpLDApLEUoRChEKGMpKSwxKSxKKHRoaXMsRChEKGMpKSkpKTooZD1GKEQoRChjKSkpLDE9PShudWxsPT1kPzA6ZC5jb2xvcik/KEUoRChjKSwwKSxFKGQsMCksRShEKEQoYykpLDEpLGM9RChEKGMpKSk6KGM9PUYoRChjKSkmJihjPUQoYyksSih0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEkodGhpcyxEKEQoYykpKSkpO3RoaXMuZC5jb2xvcj0wO3RoaXMubisrO3JldHVybiBudWxsfTtILnByb3RvdHlwZS5wdXQ9SC5wcm90b3R5cGUucHV0O0gucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2I9dGhpcy5kO2lmKG51bGwhPWIpZm9yKDtudWxsIT1iLmxlZnQ7KWI9Yi5sZWZ0O2lmKG51bGwhPT1iKWZvcihhLmFkZChiLnZhbHVlKTtudWxsIT09KGI9SyhiKSk7KWEuYWRkKGIudmFsdWUpO3JldHVybiBhfTtILnByb3RvdHlwZS52YWx1ZXM9SC5wcm90b3R5cGUubTtcbmZ1bmN0aW9uIEkoYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLnJpZ2h0O2IucmlnaHQ9Yy5sZWZ0O251bGwhPWMubGVmdCYmKGMubGVmdC5wYXJlbnQ9Yik7Yy5wYXJlbnQ9Yi5wYXJlbnQ7bnVsbD09Yi5wYXJlbnQ/YS5kPWM6Yi5wYXJlbnQubGVmdD09Yj9iLnBhcmVudC5sZWZ0PWM6Yi5wYXJlbnQucmlnaHQ9YztjLmxlZnQ9YjtiLnBhcmVudD1jfX1mdW5jdGlvbiBKKGEsYil7aWYobnVsbCE9Yil7dmFyIGM9Yi5sZWZ0O2IubGVmdD1jLnJpZ2h0O251bGwhPWMucmlnaHQmJihjLnJpZ2h0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5yaWdodD09Yj9iLnBhcmVudC5yaWdodD1jOmIucGFyZW50LmxlZnQ9YztjLnJpZ2h0PWI7Yi5wYXJlbnQ9Y319XG5mdW5jdGlvbiBLKGEpe2lmKG51bGw9PT1hKXJldHVybiBudWxsO2lmKG51bGwhPT1hLnJpZ2h0KWZvcih2YXIgYj1hLnJpZ2h0O251bGwhPT1iLmxlZnQ7KWI9Yi5sZWZ0O2Vsc2UgZm9yKGI9YS5wYXJlbnQ7bnVsbCE9PWImJmE9PT1iLnJpZ2h0OylhPWIsYj1iLnBhcmVudDtyZXR1cm4gYn1ILnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubn07SC5wcm90b3R5cGUuc2l6ZT1ILnByb3RvdHlwZS5zaXplO2Z1bmN0aW9uIEwoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhMLEIpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZVNldFwiLEwpO0wucHJvdG90eXBlLmE9bnVsbDtMLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigwPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4hMDtyZXR1cm4hMX07TC5wcm90b3R5cGUuY29udGFpbnM9TC5wcm90b3R5cGUuY29udGFpbnM7TC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYoMT09PXRoaXMuYVtiXS5jb21wYXJlVG8oYSkpcmV0dXJuIHRoaXMuYS5zcGxpY2UoYiwwLGEpLCEwO3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGQ9TC5wcm90b3R5cGUuYWRkO1xuTC5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGRBbGw9TC5wcm90b3R5cGUuZTtMLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O0wucHJvdG90eXBlLnJlbW92ZT1MLnByb3RvdHlwZS5yZW1vdmU7TC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5zaXplPUwucHJvdG90eXBlLnNpemU7TC5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07TC5wcm90b3R5cGUuaXNFbXB0eT1MLnByb3RvdHlwZS5nO0wucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtMLnByb3RvdHlwZS50b0FycmF5PUwucHJvdG90eXBlLmg7TC5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgTih0aGlzKX07XG5MLnByb3RvdHlwZS5pdGVyYXRvcj1MLnByb3RvdHlwZS5mO2Z1bmN0aW9uIE4oYSl7dGhpcy5sPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfJDJcIixOKTtOLnByb3RvdHlwZS5sPW51bGw7Ti5wcm90b3R5cGUuYj0wO04ucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmwuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmwuYVt0aGlzLmIrK119O04ucHJvdG90eXBlLm5leHQ9Ti5wcm90b3R5cGUubmV4dDtOLnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmwuc2l6ZSgpPyEwOiExfTtOLnByb3RvdHlwZS5oYXNOZXh0PU4ucHJvdG90eXBlLmM7Ti5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTtOLnByb3RvdHlwZS5yZW1vdmU9Ti5wcm90b3R5cGUucmVtb3ZlO1widW5kZWZpbmVkXCIhPT10eXBlb2YgZ2xvYmFsJiYoZ2xvYmFsLmphdmFzY3JpcHQ9e30sZ2xvYmFsLmphdmFzY3JpcHQudXRpbD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdD1zLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlzPXYsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uPW0sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5FbXB0eVN0YWNrRXhjZXB0aW9uPWgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoTWFwPXcsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoU2V0PXksZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JbmRleE91dE9mQm91bmRzRXhjZXB0aW9uPWssZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JdGVyYXRvcj1sLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTGlzdD1uLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTWFwPXAsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uPXEsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5PcGVyYXRpb25Ob3RTdXBwb3J0ZWQ9XG5yLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU2V0PXgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Tb3J0ZWRNYXA9QSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZFNldD1CLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU3RhY2s9QyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVNYXA9SCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVTZXQ9TCk7fSkuY2FsbCh0aGlzKTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEwLCBKYXNvbiBEYXZpZXMuXG4gKlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC4gIFRoaXMgY29kZSBpcyBiYXNlZCBvbiBCcmFkbGV5IFdoaXRlJ3MgSmF2YSB2ZXJzaW9uLFxuICogd2hpY2ggaXMgaW4gdHVybiBiYXNlZCBvbiBOaWNob2xhcyBZdWUncyBDKysgdmVyc2lvbiwgd2hpY2ggaW4gdHVybiBpcyBiYXNlZFxuICogb24gUGF1bCBELiBCb3Vya2UncyBvcmlnaW5hbCBGb3J0cmFuIHZlcnNpb24uICBTZWUgYmVsb3cgZm9yIHRoZSByZXNwZWN0aXZlXG4gKiBjb3B5cmlnaHQgbm90aWNlcy5cbiAqXG4gKiBTZWUgaHR0cDovL2xvY2FsLndhc3AudXdhLmVkdS5hdS9+cGJvdXJrZS9wYXBlcnMvY29ucmVjLyBmb3IgdGhlIG9yaWdpbmFsXG4gKiBwYXBlciBieSBQYXVsIEQuIEJvdXJrZS5cbiAqXG4gKiBUaGUgdmVjdG9yIGNvbnZlcnNpb24gY29kZSBpcyBiYXNlZCBvbiBodHRwOi8vYXBwdHJlZS5uZXQvY29ucmVjLmh0bSBieVxuICogR3JhaGFtIENveC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICogICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHRcbiAqICAgICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqICAgICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0XG4gKiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4gKiAgICAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuICogICAgICogTmVpdGhlciB0aGUgbmFtZSBvZiB0aGUgPG9yZ2FuaXphdGlvbj4gbm9yIHRoZVxuICogICAgICAgbmFtZXMgb2YgaXRzIGNvbnRyaWJ1dG9ycyBtYXkgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHNcbiAqICAgICAgIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLlxuICpcbiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiXG4gKiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFXG4gKiBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRVxuICogQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIDxDT1BZUklHSFQgSE9MREVSPiBCRSBMSUFCTEUgRk9SIEFOWVxuICogRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVNcbiAqIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUztcbiAqIExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORFxuICogT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlRcbiAqIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRlxuICogVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAxOTk2LTE5OTcgTmljaG9sYXMgWXVlXG4gKlxuICogVGhpcyBzb2Z0d2FyZSBpcyBjb3B5cmlnaHRlZCBieSBOaWNob2xhcyBZdWUuIFRoaXMgY29kZSBpcyBiYXNlZCBvbiBQYXVsIEQuXG4gKiBCb3Vya2UncyBDT05SRUMuRiByb3V0aW5lLlxuICpcbiAqIFRoZSBhdXRob3JzIGhlcmVieSBncmFudCBwZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgYW5kIGRpc3RyaWJ1dGUgdGhpc1xuICogc29mdHdhcmUgYW5kIGl0cyBkb2N1bWVudGF0aW9uIGZvciBhbnkgcHVycG9zZSwgcHJvdmlkZWQgdGhhdCBleGlzdGluZ1xuICogY29weXJpZ2h0IG5vdGljZXMgYXJlIHJldGFpbmVkIGluIGFsbCBjb3BpZXMgYW5kIHRoYXQgdGhpcyBub3RpY2UgaXNcbiAqIGluY2x1ZGVkIHZlcmJhdGltIGluIGFueSBkaXN0cmlidXRpb25zLiBBZGRpdGlvbmFsbHksIHRoZSBhdXRob3JzIGdyYW50XG4gKiBwZXJtaXNzaW9uIHRvIG1vZGlmeSB0aGlzIHNvZnR3YXJlIGFuZCBpdHMgZG9jdW1lbnRhdGlvbiBmb3IgYW55IHB1cnBvc2UsXG4gKiBwcm92aWRlZCB0aGF0IHN1Y2ggbW9kaWZpY2F0aW9ucyBhcmUgbm90IGRpc3RyaWJ1dGVkIHdpdGhvdXQgdGhlIGV4cGxpY2l0XG4gKiBjb25zZW50IG9mIHRoZSBhdXRob3JzIGFuZCB0aGF0IGV4aXN0aW5nIGNvcHlyaWdodCBub3RpY2VzIGFyZSByZXRhaW5lZCBpblxuICogYWxsIGNvcGllcy4gU29tZSBvZiB0aGUgYWxnb3JpdGhtcyBpbXBsZW1lbnRlZCBieSB0aGlzIHNvZnR3YXJlIGFyZVxuICogcGF0ZW50ZWQsIG9ic2VydmUgYWxsIGFwcGxpY2FibGUgcGF0ZW50IGxhdy5cbiAqXG4gKiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBESVNUUklCVVRPUlMgQkUgTElBQkxFIFRPIEFOWSBQQVJUWSBGT1JcbiAqIERJUkVDVCwgSU5ESVJFQ1QsIFNQRUNJQUwsIElOQ0lERU5UQUwsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBBUklTSU5HIE9VVFxuICogT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLCBJVFMgRE9DVU1FTlRBVElPTiwgT1IgQU5ZIERFUklWQVRJVkVTIFRIRVJFT0YsXG4gKiBFVkVOIElGIFRIRSBBVVRIT1JTIEhBVkUgQkVFTiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqXG4gKiBUSEUgQVVUSE9SUyBBTkQgRElTVFJJQlVUT1JTIFNQRUNJRklDQUxMWSBESVNDTEFJTSBBTlkgV0FSUkFOVElFUyxcbiAqIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLCBBTkQgTk9OLUlORlJJTkdFTUVOVC4gIFRISVMgU09GVFdBUkUgSVNcbiAqIFBST1ZJREVEIE9OIEFOIFwiQVMgSVNcIiBCQVNJUywgQU5EIFRIRSBBVVRIT1JTIEFORCBESVNUUklCVVRPUlMgSEFWRSBOT1xuICogT0JMSUdBVElPTiBUTyBQUk9WSURFIE1BSU5URU5BTkNFLCBTVVBQT1JULCBVUERBVEVTLCBFTkhBTkNFTUVOVFMsIE9SXG4gKiBNT0RJRklDQVRJT05TLlxuICovXG5cblxuICBtb2R1bGUuZXhwb3J0cyA9IENvbnJlYztcblxuICB2YXIgRVBTSUxPTiA9IDFlLTEwO1xuXG4gIGZ1bmN0aW9uIHBvaW50c0VxdWFsKGEsIGIpIHtcbiAgICB2YXIgeCA9IGEueCAtIGIueCwgeSA9IGEueSAtIGIueTtcbiAgICByZXR1cm4geCAqIHggKyB5ICogeSA8IEVQU0lMT047XG4gIH1cblxuICBmdW5jdGlvbiByZXZlcnNlTGlzdChsaXN0KSB7XG4gICAgdmFyIHBwID0gbGlzdC5oZWFkO1xuXG4gICAgd2hpbGUgKHBwKSB7XG4gICAgICAvLyBzd2FwIHByZXYvbmV4dCBwb2ludGVyc1xuICAgICAgdmFyIHRlbXAgPSBwcC5uZXh0O1xuICAgICAgcHAubmV4dCA9IHBwLnByZXY7XG4gICAgICBwcC5wcmV2ID0gdGVtcDtcblxuICAgICAgLy8gY29udGludWUgdGhyb3VnaCB0aGUgbGlzdFxuICAgICAgcHAgPSB0ZW1wO1xuICAgIH1cblxuICAgIC8vIHN3YXAgaGVhZC90YWlsIHBvaW50ZXJzXG4gICAgdmFyIHRlbXAgPSBsaXN0LmhlYWQ7XG4gICAgbGlzdC5oZWFkID0gbGlzdC50YWlsO1xuICAgIGxpc3QudGFpbCA9IHRlbXA7XG4gIH1cblxuICBmdW5jdGlvbiBDb250b3VyQnVpbGRlcihsZXZlbCkge1xuICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcbiAgICB0aGlzLnMgPSBudWxsO1xuICAgIHRoaXMuY291bnQgPSAwO1xuICB9XG4gIENvbnRvdXJCdWlsZGVyLnByb3RvdHlwZS5yZW1vdmVfc2VxID0gZnVuY3Rpb24obGlzdCkge1xuICAgIC8vIGlmIGxpc3QgaXMgdGhlIGZpcnN0IGl0ZW0sIHN0YXRpYyBwdHIgcyBpcyB1cGRhdGVkXG4gICAgaWYgKGxpc3QucHJldikge1xuICAgICAgbGlzdC5wcmV2Lm5leHQgPSBsaXN0Lm5leHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucyA9IGxpc3QubmV4dDtcbiAgICB9XG5cbiAgICBpZiAobGlzdC5uZXh0KSB7XG4gICAgICBsaXN0Lm5leHQucHJldiA9IGxpc3QucHJldjtcbiAgICB9XG4gICAgLS10aGlzLmNvdW50O1xuICB9XG4gIENvbnRvdXJCdWlsZGVyLnByb3RvdHlwZS5hZGRTZWdtZW50ID0gZnVuY3Rpb24oYSwgYikge1xuICAgIHZhciBzcyA9IHRoaXMucztcbiAgICB2YXIgbWEgPSBudWxsO1xuICAgIHZhciBtYiA9IG51bGw7XG4gICAgdmFyIHByZXBlbmRBID0gZmFsc2U7XG4gICAgdmFyIHByZXBlbmRCID0gZmFsc2U7XG5cbiAgICB3aGlsZSAoc3MpIHtcbiAgICAgIGlmIChtYSA9PSBudWxsKSB7XG4gICAgICAgIC8vIG5vIG1hdGNoIGZvciBhIHlldFxuICAgICAgICBpZiAocG9pbnRzRXF1YWwoYSwgc3MuaGVhZC5wKSkge1xuICAgICAgICAgIG1hID0gc3M7XG4gICAgICAgICAgcHJlcGVuZEEgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHBvaW50c0VxdWFsKGEsIHNzLnRhaWwucCkpIHtcbiAgICAgICAgICBtYSA9IHNzO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAobWIgPT0gbnVsbCkge1xuICAgICAgICAvLyBubyBtYXRjaCBmb3IgYiB5ZXRcbiAgICAgICAgaWYgKHBvaW50c0VxdWFsKGIsIHNzLmhlYWQucCkpIHtcbiAgICAgICAgICBtYiA9IHNzO1xuICAgICAgICAgIHByZXBlbmRCID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChwb2ludHNFcXVhbChiLCBzcy50YWlsLnApKSB7XG4gICAgICAgICAgbWIgPSBzcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gaWYgd2UgbWF0Y2hlZCBib3RoIG5vIG5lZWQgdG8gY29udGludWUgc2VhcmNoaW5nXG4gICAgICBpZiAobWIgIT0gbnVsbCAmJiBtYSAhPSBudWxsKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3MgPSBzcy5uZXh0O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGMgaXMgdGhlIGNhc2Ugc2VsZWN0b3IgYmFzZWQgb24gd2hpY2ggb2YgbWEgYW5kL29yIG1iIGFyZSBzZXRcbiAgICB2YXIgYyA9ICgobWEgIT0gbnVsbCkgPyAxIDogMCkgfCAoKG1iICE9IG51bGwpID8gMiA6IDApO1xuXG4gICAgc3dpdGNoKGMpIHtcbiAgICAgIGNhc2UgMDogICAvLyBib3RoIHVubWF0Y2hlZCwgYWRkIGFzIG5ldyBzZXF1ZW5jZVxuICAgICAgICB2YXIgYWEgPSB7cDogYSwgcHJldjogbnVsbH07XG4gICAgICAgIHZhciBiYiA9IHtwOiBiLCBuZXh0OiBudWxsfTtcbiAgICAgICAgYWEubmV4dCA9IGJiO1xuICAgICAgICBiYi5wcmV2ID0gYWE7XG5cbiAgICAgICAgLy8gY3JlYXRlIHNlcXVlbmNlIGVsZW1lbnQgYW5kIHB1c2ggb250byBoZWFkIG9mIG1haW4gbGlzdC4gVGhlIG9yZGVyXG4gICAgICAgIC8vIG9mIGl0ZW1zIGluIHRoaXMgbGlzdCBpcyB1bmltcG9ydGFudFxuICAgICAgICBtYSA9IHtoZWFkOiBhYSwgdGFpbDogYmIsIG5leHQ6IHRoaXMucywgcHJldjogbnVsbCwgY2xvc2VkOiBmYWxzZX07XG4gICAgICAgIGlmICh0aGlzLnMpIHtcbiAgICAgICAgICB0aGlzLnMucHJldiA9IG1hO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucyA9IG1hO1xuXG4gICAgICAgICsrdGhpcy5jb3VudDsgICAgLy8gbm90IGVzc2VudGlhbCAtIHRyYWNrcyBudW1iZXIgb2YgdW5tZXJnZWQgc2VxdWVuY2VzXG4gICAgICBicmVhaztcblxuICAgICAgY2FzZSAxOiAgIC8vIGEgbWF0Y2hlZCwgYiBkaWQgbm90IC0gdGh1cyBiIGV4dGVuZHMgc2VxdWVuY2UgbWFcbiAgICAgICAgdmFyIHBwID0ge3A6IGJ9O1xuXG4gICAgICAgIGlmIChwcmVwZW5kQSkge1xuICAgICAgICAgIHBwLm5leHQgPSBtYS5oZWFkO1xuICAgICAgICAgIHBwLnByZXYgPSBudWxsO1xuICAgICAgICAgIG1hLmhlYWQucHJldiA9IHBwO1xuICAgICAgICAgIG1hLmhlYWQgPSBwcDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwcC5uZXh0ID0gbnVsbDtcbiAgICAgICAgICBwcC5wcmV2ID0gbWEudGFpbDtcbiAgICAgICAgICBtYS50YWlsLm5leHQgPSBwcDtcbiAgICAgICAgICBtYS50YWlsID0gcHA7XG4gICAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIDI6ICAgLy8gYiBtYXRjaGVkLCBhIGRpZCBub3QgLSB0aHVzIGEgZXh0ZW5kcyBzZXF1ZW5jZSBtYlxuICAgICAgICB2YXIgcHAgPSB7cDogYX07XG5cbiAgICAgICAgaWYgKHByZXBlbmRCKSB7XG4gICAgICAgICAgcHAubmV4dCA9IG1iLmhlYWQ7XG4gICAgICAgICAgcHAucHJldiA9IG51bGw7XG4gICAgICAgICAgbWIuaGVhZC5wcmV2ID0gcHA7XG4gICAgICAgICAgbWIuaGVhZCA9IHBwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBwLm5leHQgPSBudWxsO1xuICAgICAgICAgIHBwLnByZXYgPSBtYi50YWlsO1xuICAgICAgICAgIG1iLnRhaWwubmV4dCA9IHBwO1xuICAgICAgICAgIG1iLnRhaWwgPSBwcDtcbiAgICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgMzogICAvLyBib3RoIG1hdGNoZWQsIGNhbiBtZXJnZSBzZXF1ZW5jZXNcbiAgICAgICAgLy8gaWYgdGhlIHNlcXVlbmNlcyBhcmUgdGhlIHNhbWUsIGRvIG5vdGhpbmcsIGFzIHdlIGFyZSBzaW1wbHkgY2xvc2luZyB0aGlzIHBhdGggKGNvdWxkIHNldCBhIGZsYWcpXG5cbiAgICAgICAgaWYgKG1hID09PSBtYikge1xuICAgICAgICAgIHZhciBwcCA9IHtwOiBtYS50YWlsLnAsIG5leHQ6IG1hLmhlYWQsIHByZXY6IG51bGx9O1xuICAgICAgICAgIG1hLmhlYWQucHJldiA9IHBwO1xuICAgICAgICAgIG1hLmhlYWQgPSBwcDtcbiAgICAgICAgICBtYS5jbG9zZWQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdGhlcmUgYXJlIDQgd2F5cyB0aGUgc2VxdWVuY2UgcGFpciBjYW4gYmUgam9pbmVkLiBUaGUgY3VycmVudCBzZXR0aW5nIG9mIHByZXBlbmRBIGFuZFxuICAgICAgICAvLyBwcmVwZW5kQiB3aWxsIHRlbGwgdXMgd2hpY2ggdHlwZSBvZiBqb2luIGlzIG5lZWRlZC4gRm9yIGhlYWQvaGVhZCBhbmQgdGFpbC90YWlsIGpvaW5zXG4gICAgICAgIC8vIG9uZSBzZXF1ZW5jZSBuZWVkcyB0byBiZSByZXZlcnNlZFxuICAgICAgICBzd2l0Y2goKHByZXBlbmRBID8gMSA6IDApIHwgKHByZXBlbmRCID8gMiA6IDApKSB7XG4gICAgICAgICAgY2FzZSAwOiAgIC8vIHRhaWwtdGFpbFxuICAgICAgICAgICAgLy8gcmV2ZXJzZSBtYSBhbmQgYXBwZW5kIHRvIG1iXG4gICAgICAgICAgICByZXZlcnNlTGlzdChtYSk7XG4gICAgICAgICAgICAvLyBmYWxsIHRocm91Z2ggdG8gaGVhZC90YWlsIGNhc2VcbiAgICAgICAgICBjYXNlIDE6ICAgLy8gaGVhZC10YWlsXG4gICAgICAgICAgICAvLyBtYSBpcyBhcHBlbmRlZCB0byBtYiBhbmQgbWEgZGlzY2FyZGVkXG4gICAgICAgICAgICBtYi50YWlsLm5leHQgPSBtYS5oZWFkO1xuICAgICAgICAgICAgbWEuaGVhZC5wcmV2ID0gbWIudGFpbDtcbiAgICAgICAgICAgIG1iLnRhaWwgPSBtYS50YWlsO1xuXG4gICAgICAgICAgICAvL2Rpc2NhcmQgbWEgc2VxdWVuY2UgcmVjb3JkXG4gICAgICAgICAgICB0aGlzLnJlbW92ZV9zZXEobWEpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAzOiAgIC8vIGhlYWQtaGVhZFxuICAgICAgICAgICAgLy8gcmV2ZXJzZSBtYSBhbmQgYXBwZW5kIG1iIHRvIGl0XG4gICAgICAgICAgICByZXZlcnNlTGlzdChtYSk7XG4gICAgICAgICAgICAvLyBmYWxsIHRocm91Z2ggdG8gdGFpbC9oZWFkIGNhc2VcbiAgICAgICAgICBjYXNlIDI6ICAgLy8gdGFpbC1oZWFkXG4gICAgICAgICAgICAvLyBtYiBpcyBhcHBlbmRlZCB0byBtYSBhbmQgbWIgaXMgZGlzY2FyZGVkXG4gICAgICAgICAgICBtYS50YWlsLm5leHQgPSBtYi5oZWFkO1xuICAgICAgICAgICAgbWIuaGVhZC5wcmV2ID0gbWEudGFpbDtcbiAgICAgICAgICAgIG1hLnRhaWwgPSBtYi50YWlsO1xuXG4gICAgICAgICAgICAvL2Rpc2NhcmQgbWIgc2VxdWVuY2UgcmVjb3JkXG4gICAgICAgICAgICB0aGlzLnJlbW92ZV9zZXEobWIpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW1wbGVtZW50cyBDT05SRUMuXG4gICAqXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGRyYXdDb250b3VyIGZ1bmN0aW9uIGZvciBkcmF3aW5nIGNvbnRvdXIuICBEZWZhdWx0cyB0byBhXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbSBcImNvbnRvdXIgYnVpbGRlclwiLCB3aGljaCBwb3B1bGF0ZXMgdGhlXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRvdXJzIHByb3BlcnR5LlxuICAgKi9cbiAgZnVuY3Rpb24gQ29ucmVjKGRyYXdDb250b3VyKSB7XG4gICAgaWYgKCFkcmF3Q29udG91cikge1xuICAgICAgdmFyIGMgPSB0aGlzO1xuICAgICAgYy5jb250b3VycyA9IHt9O1xuICAgICAgLyoqXG4gICAgICAgKiBkcmF3Q29udG91ciAtIGludGVyZmFjZSBmb3IgaW1wbGVtZW50aW5nIHRoZSB1c2VyIHN1cHBsaWVkIG1ldGhvZCB0b1xuICAgICAgICogcmVuZGVyIHRoZSBjb3VudG91cnMuXG4gICAgICAgKlxuICAgICAgICogRHJhd3MgYSBsaW5lIGJldHdlZW4gdGhlIHN0YXJ0IGFuZCBlbmQgY29vcmRpbmF0ZXMuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHN0YXJ0WCAgICAtIHN0YXJ0IGNvb3JkaW5hdGUgZm9yIFhcbiAgICAgICAqIEBwYXJhbSBzdGFydFkgICAgLSBzdGFydCBjb29yZGluYXRlIGZvciBZXG4gICAgICAgKiBAcGFyYW0gZW5kWCAgICAgIC0gZW5kIGNvb3JkaW5hdGUgZm9yIFhcbiAgICAgICAqIEBwYXJhbSBlbmRZICAgICAgLSBlbmQgY29vcmRpbmF0ZSBmb3IgWVxuICAgICAgICogQHBhcmFtIGNvbnRvdXJMZXZlbCAtIENvbnRvdXIgbGV2ZWwgZm9yIGxpbmUuXG4gICAgICAgKi9cbiAgICAgIHRoaXMuZHJhd0NvbnRvdXIgPSBmdW5jdGlvbihzdGFydFgsIHN0YXJ0WSwgZW5kWCwgZW5kWSwgY29udG91ckxldmVsLCBrKSB7XG4gICAgICAgIHZhciBjYiA9IGMuY29udG91cnNba107XG4gICAgICAgIGlmICghY2IpIHtcbiAgICAgICAgICBjYiA9IGMuY29udG91cnNba10gPSBuZXcgQ29udG91ckJ1aWxkZXIoY29udG91ckxldmVsKTtcbiAgICAgICAgfVxuICAgICAgICBjYi5hZGRTZWdtZW50KHt4OiBzdGFydFgsIHk6IHN0YXJ0WX0sIHt4OiBlbmRYLCB5OiBlbmRZfSk7XG4gICAgICB9XG4gICAgICB0aGlzLmNvbnRvdXJMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBsID0gW107XG4gICAgICAgIHZhciBhID0gYy5jb250b3VycztcbiAgICAgICAgZm9yICh2YXIgayBpbiBhKSB7XG4gICAgICAgICAgdmFyIHMgPSBhW2tdLnM7XG4gICAgICAgICAgdmFyIGxldmVsID0gYVtrXS5sZXZlbDtcbiAgICAgICAgICB3aGlsZSAocykge1xuICAgICAgICAgICAgdmFyIGggPSBzLmhlYWQ7XG4gICAgICAgICAgICB2YXIgbDIgPSBbXTtcbiAgICAgICAgICAgIGwyLmxldmVsID0gbGV2ZWw7XG4gICAgICAgICAgICBsMi5rID0gaztcbiAgICAgICAgICAgIHdoaWxlIChoICYmIGgucCkge1xuICAgICAgICAgICAgICBsMi5wdXNoKGgucCk7XG4gICAgICAgICAgICAgIGggPSBoLm5leHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsLnB1c2gobDIpO1xuICAgICAgICAgICAgcyA9IHMubmV4dDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbC5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEuayAtIGIuayB9KTtcbiAgICAgICAgcmV0dXJuIGw7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZHJhd0NvbnRvdXIgPSBkcmF3Q29udG91cjtcbiAgICB9XG4gICAgdGhpcy5oICA9IG5ldyBBcnJheSg1KTtcbiAgICB0aGlzLnNoID0gbmV3IEFycmF5KDUpO1xuICAgIHRoaXMueGggPSBuZXcgQXJyYXkoNSk7XG4gICAgdGhpcy55aCA9IG5ldyBBcnJheSg1KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBjb250b3VyIGlzIGEgY29udG91cmluZyBzdWJyb3V0aW5lIGZvciByZWN0YW5ndWxhcmlseSBzcGFjZWQgZGF0YVxuICAgKlxuICAgKiBJdCBlbWl0cyBjYWxscyB0byBhIGxpbmUgZHJhd2luZyBzdWJyb3V0aW5lIHN1cHBsaWVkIGJ5IHRoZSB1c2VyIHdoaWNoXG4gICAqIGRyYXdzIGEgY29udG91ciBtYXAgY29ycmVzcG9uZGluZyB0byByZWFsKjRkYXRhIG9uIGEgcmFuZG9tbHkgc3BhY2VkXG4gICAqIHJlY3Rhbmd1bGFyIGdyaWQuIFRoZSBjb29yZGluYXRlcyBlbWl0dGVkIGFyZSBpbiB0aGUgc2FtZSB1bml0cyBnaXZlbiBpblxuICAgKiB0aGUgeCgpIGFuZCB5KCkgYXJyYXlzLlxuICAgKlxuICAgKiBBbnkgbnVtYmVyIG9mIGNvbnRvdXIgbGV2ZWxzIG1heSBiZSBzcGVjaWZpZWQgYnV0IHRoZXkgbXVzdCBiZSBpbiBvcmRlciBvZlxuICAgKiBpbmNyZWFzaW5nIHZhbHVlLlxuICAgKlxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcltdW119IGQgLSBtYXRyaXggb2YgZGF0YSB0byBjb250b3VyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbGIsaXViLGpsYixqdWIgLSBpbmRleCBib3VuZHMgb2YgZGF0YSBtYXRyaXhcbiAgICpcbiAgICogICAgICAgICAgICAgVGhlIGZvbGxvd2luZyB0d28sIG9uZSBkaW1lbnNpb25hbCBhcnJheXMgKHggYW5kIHkpIGNvbnRhaW5cbiAgICogICAgICAgICAgICAgdGhlIGhvcml6b250YWwgYW5kIHZlcnRpY2FsIGNvb3JkaW5hdGVzIG9mIGVhY2ggc2FtcGxlIHBvaW50cy5cbiAgICogQHBhcmFtIHtudW1iZXJbXX0geCAgLSBkYXRhIG1hdHJpeCBjb2x1bW4gY29vcmRpbmF0ZXNcbiAgICogQHBhcmFtIHtudW1iZXJbXX0geSAgLSBkYXRhIG1hdHJpeCByb3cgY29vcmRpbmF0ZXNcbiAgICogQHBhcmFtIHtudW1iZXJ9IG5jICAgLSBudW1iZXIgb2YgY29udG91ciBsZXZlbHNcbiAgICogQHBhcmFtIHtudW1iZXJbXX0geiAgLSBjb250b3VyIGxldmVscyBpbiBpbmNyZWFzaW5nIG9yZGVyLlxuICAgKi9cbiAgQ29ucmVjLnByb3RvdHlwZS5jb250b3VyID0gZnVuY3Rpb24oZCwgaWxiLCBpdWIsIGpsYiwganViLCB4LCB5LCBuYywgeikge1xuICAgIHZhciBoID0gdGhpcy5oLCBzaCA9IHRoaXMuc2gsIHhoID0gdGhpcy54aCwgeWggPSB0aGlzLnloO1xuICAgIHZhciBkcmF3Q29udG91ciA9IHRoaXMuZHJhd0NvbnRvdXI7XG4gICAgdGhpcy5jb250b3VycyA9IHt9O1xuXG4gICAgLyoqIHByaXZhdGUgKi9cbiAgICB2YXIgeHNlY3QgPSBmdW5jdGlvbihwMSwgcDIpe1xuICAgICAgcmV0dXJuIChoW3AyXSp4aFtwMV0taFtwMV0qeGhbcDJdKS8oaFtwMl0taFtwMV0pO1xuICAgIH1cblxuICAgIHZhciB5c2VjdCA9IGZ1bmN0aW9uKHAxLCBwMil7XG4gICAgICByZXR1cm4gKGhbcDJdKnloW3AxXS1oW3AxXSp5aFtwMl0pLyhoW3AyXS1oW3AxXSk7XG4gICAgfVxuICAgIHZhciBtMTtcbiAgICB2YXIgbTI7XG4gICAgdmFyIG0zO1xuICAgIHZhciBjYXNlX3ZhbHVlO1xuICAgIHZhciBkbWluO1xuICAgIHZhciBkbWF4O1xuICAgIHZhciB4MSA9IDAuMDtcbiAgICB2YXIgeDIgPSAwLjA7XG4gICAgdmFyIHkxID0gMC4wO1xuICAgIHZhciB5MiA9IDAuMDtcblxuICAgIC8vIFRoZSBpbmRleGluZyBvZiBpbSBhbmQgam0gc2hvdWxkIGJlIG5vdGVkIGFzIGl0IGhhcyB0byBzdGFydCBmcm9tIHplcm9cbiAgICAvLyB1bmxpa2UgdGhlIGZvcnRyYW4gY291bnRlciBwYXJ0XG4gICAgdmFyIGltID0gWzAsIDEsIDEsIDBdO1xuICAgIHZhciBqbSA9IFswLCAwLCAxLCAxXTtcblxuICAgIC8vIE5vdGUgdGhhdCBjYXN0YWIgaXMgYXJyYW5nZWQgZGlmZmVyZW50bHkgZnJvbSB0aGUgRk9SVFJBTiBjb2RlIGJlY2F1c2VcbiAgICAvLyBGb3J0cmFuIGFuZCBDL0MrKyBhcnJheXMgYXJlIHRyYW5zcG9zZWQgb2YgZWFjaCBvdGhlciwgaW4gdGhpcyBjYXNlXG4gICAgLy8gaXQgaXMgbW9yZSB0cmlja3kgYXMgY2FzdGFiIGlzIGluIDMgZGltZW5zaW9uc1xuICAgIHZhciBjYXN0YWIgPSBbXG4gICAgICBbXG4gICAgICAgIFswLCAwLCA4XSwgWzAsIDIsIDVdLCBbNywgNiwgOV1cbiAgICAgIF0sXG4gICAgICBbXG4gICAgICAgIFswLCAzLCA0XSwgWzEsIDMsIDFdLCBbNCwgMywgMF1cbiAgICAgIF0sXG4gICAgICBbXG4gICAgICAgIFs5LCA2LCA3XSwgWzUsIDIsIDBdLCBbOCwgMCwgMF1cbiAgICAgIF1cbiAgICBdO1xuXG4gICAgZm9yICh2YXIgaj0oanViLTEpO2o+PWpsYjtqLS0pIHtcbiAgICAgIGZvciAodmFyIGk9aWxiO2k8PWl1Yi0xO2krKykge1xuICAgICAgICB2YXIgdGVtcDEsIHRlbXAyO1xuICAgICAgICB0ZW1wMSA9IE1hdGgubWluKGRbaV1bal0sZFtpXVtqKzFdKTtcbiAgICAgICAgdGVtcDIgPSBNYXRoLm1pbihkW2krMV1bal0sZFtpKzFdW2orMV0pO1xuICAgICAgICBkbWluICA9IE1hdGgubWluKHRlbXAxLHRlbXAyKTtcbiAgICAgICAgdGVtcDEgPSBNYXRoLm1heChkW2ldW2pdLGRbaV1baisxXSk7XG4gICAgICAgIHRlbXAyID0gTWF0aC5tYXgoZFtpKzFdW2pdLGRbaSsxXVtqKzFdKTtcbiAgICAgICAgZG1heCAgPSBNYXRoLm1heCh0ZW1wMSx0ZW1wMik7XG5cbiAgICAgICAgaWYgKGRtYXg+PXpbMF0mJmRtaW48PXpbbmMtMV0pIHtcbiAgICAgICAgICBmb3IgKHZhciBrPTA7azxuYztrKyspIHtcbiAgICAgICAgICAgIGlmICh6W2tdPj1kbWluJiZ6W2tdPD1kbWF4KSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIG09NDttPj0wO20tLSkge1xuICAgICAgICAgICAgICAgIGlmIChtPjApIHtcbiAgICAgICAgICAgICAgICAgIC8vIFRoZSBpbmRleGluZyBvZiBpbSBhbmQgam0gc2hvdWxkIGJlIG5vdGVkIGFzIGl0IGhhcyB0b1xuICAgICAgICAgICAgICAgICAgLy8gc3RhcnQgZnJvbSB6ZXJvXG4gICAgICAgICAgICAgICAgICBoW21dID0gZFtpK2ltW20tMV1dW2oram1bbS0xXV0teltrXTtcbiAgICAgICAgICAgICAgICAgIHhoW21dID0geFtpK2ltW20tMV1dO1xuICAgICAgICAgICAgICAgICAgeWhbbV0gPSB5W2oram1bbS0xXV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGhbMF0gPSAwLjI1KihoWzFdK2hbMl0raFszXStoWzRdKTtcbiAgICAgICAgICAgICAgICAgIHhoWzBdPTAuNSooeFtpXSt4W2krMV0pO1xuICAgICAgICAgICAgICAgICAgeWhbMF09MC41Kih5W2pdK3lbaisxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChoW21dPkVQU0lMT04pIHtcbiAgICAgICAgICAgICAgICAgIHNoW21dID0gMTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhbbV08LUVQU0lMT04pIHtcbiAgICAgICAgICAgICAgICAgIHNoW21dID0gLTE7XG4gICAgICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgICBzaFttXSA9IDA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgLy8gTm90ZTogYXQgdGhpcyBzdGFnZSB0aGUgcmVsYXRpdmUgaGVpZ2h0cyBvZiB0aGUgY29ybmVycyBhbmQgdGhlXG4gICAgICAgICAgICAgIC8vIGNlbnRyZSBhcmUgaW4gdGhlIGggYXJyYXksIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjb29yZGluYXRlcyBhcmVcbiAgICAgICAgICAgICAgLy8gaW4gdGhlIHhoIGFuZCB5aCBhcnJheXMuIFRoZSBjZW50cmUgb2YgdGhlIGJveCBpcyBpbmRleGVkIGJ5IDBcbiAgICAgICAgICAgICAgLy8gYW5kIHRoZSA0IGNvcm5lcnMgYnkgMSB0byA0IGFzIHNob3duIGJlbG93LlxuICAgICAgICAgICAgICAvLyBFYWNoIHRyaWFuZ2xlIGlzIHRoZW4gaW5kZXhlZCBieSB0aGUgcGFyYW1ldGVyIG0sIGFuZCB0aGUgM1xuICAgICAgICAgICAgICAvLyB2ZXJ0aWNlcyBvZiBlYWNoIHRyaWFuZ2xlIGFyZSBpbmRleGVkIGJ5IHBhcmFtZXRlcnMgbTEsbTIsYW5kXG4gICAgICAgICAgICAgIC8vIG0zLlxuICAgICAgICAgICAgICAvLyBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIGNlbnRyZSBvZiB0aGUgYm94IGlzIGFsd2F5cyB2ZXJ0ZXggMlxuICAgICAgICAgICAgICAvLyB0aG91Z2ggdGhpcyBpc2ltcG9ydGFudCBvbmx5IHdoZW4gYWxsIDMgdmVydGljZXMgbGllIGV4YWN0bHkgb25cbiAgICAgICAgICAgICAgLy8gdGhlIHNhbWUgY29udG91ciBsZXZlbCwgaW4gd2hpY2ggY2FzZSBvbmx5IHRoZSBzaWRlIG9mIHRoZSBib3hcbiAgICAgICAgICAgICAgLy8gaXMgZHJhd24uXG4gICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgIC8vICAgICAgdmVydGV4IDQgKy0tLS0tLS0tLS0tLS0tLS0tLS0rIHZlcnRleCAzXG4gICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgfCBcXCAgICAgICAgICAgICAgIC8gfFxuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHwgICBcXCAgICBtLTMgICAgLyAgIHxcbiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICB8ICAgICBcXCAgICAgICAvICAgICB8XG4gICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgfCAgICAgICBcXCAgIC8gICAgICAgfFxuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHwgIG09MiAgICBYICAgbT0yICAgfCAgICAgICB0aGUgY2VudHJlIGlzIHZlcnRleCAwXG4gICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgfCAgICAgICAvICAgXFwgICAgICAgfFxuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIHwgICAgIC8gICAgICAgXFwgICAgIHxcbiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICB8ICAgLyAgICBtPTEgICAgXFwgICB8XG4gICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgfCAvICAgICAgICAgICAgICAgXFwgfFxuICAgICAgICAgICAgICAvLyAgICAgIHZlcnRleCAxICstLS0tLS0tLS0tLS0tLS0tLS0tKyB2ZXJ0ZXggMlxuICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgIFNjYW4gZWFjaCB0cmlhbmdsZSBpbiB0aGUgYm94XG4gICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgIGZvciAobT0xO208PTQ7bSsrKSB7XG4gICAgICAgICAgICAgICAgbTEgPSBtO1xuICAgICAgICAgICAgICAgIG0yID0gMDtcbiAgICAgICAgICAgICAgICBpZiAobSE9NCkge1xuICAgICAgICAgICAgICAgICAgICBtMyA9IG0rMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtMyA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2VfdmFsdWUgPSBjYXN0YWJbc2hbbTFdKzFdW3NoW20yXSsxXVtzaFttM10rMV07XG4gICAgICAgICAgICAgICAgaWYgKGNhc2VfdmFsdWUhPTApIHtcbiAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2FzZV92YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IC8vIExpbmUgYmV0d2VlbiB2ZXJ0aWNlcyAxIGFuZCAyXG4gICAgICAgICAgICAgICAgICAgICAgeDE9eGhbbTFdO1xuICAgICAgICAgICAgICAgICAgICAgIHkxPXloW20xXTtcbiAgICAgICAgICAgICAgICAgICAgICB4Mj14aFttMl07XG4gICAgICAgICAgICAgICAgICAgICAgeTI9eWhbbTJdO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IC8vIExpbmUgYmV0d2VlbiB2ZXJ0aWNlcyAyIGFuZCAzXG4gICAgICAgICAgICAgICAgICAgICAgeDE9eGhbbTJdO1xuICAgICAgICAgICAgICAgICAgICAgIHkxPXloW20yXTtcbiAgICAgICAgICAgICAgICAgICAgICB4Mj14aFttM107XG4gICAgICAgICAgICAgICAgICAgICAgeTI9eWhbbTNdO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IC8vIExpbmUgYmV0d2VlbiB2ZXJ0aWNlcyAzIGFuZCAxXG4gICAgICAgICAgICAgICAgICAgICAgeDE9eGhbbTNdO1xuICAgICAgICAgICAgICAgICAgICAgIHkxPXloW20zXTtcbiAgICAgICAgICAgICAgICAgICAgICB4Mj14aFttMV07XG4gICAgICAgICAgICAgICAgICAgICAgeTI9eWhbbTFdO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IC8vIExpbmUgYmV0d2VlbiB2ZXJ0ZXggMSBhbmQgc2lkZSAyLTNcbiAgICAgICAgICAgICAgICAgICAgICB4MT14aFttMV07XG4gICAgICAgICAgICAgICAgICAgICAgeTE9eWhbbTFdO1xuICAgICAgICAgICAgICAgICAgICAgIHgyPXhzZWN0KG0yLG0zKTtcbiAgICAgICAgICAgICAgICAgICAgICB5Mj15c2VjdChtMixtMyk7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogLy8gTGluZSBiZXR3ZWVuIHZlcnRleCAyIGFuZCBzaWRlIDMtMVxuICAgICAgICAgICAgICAgICAgICAgIHgxPXhoW20yXTtcbiAgICAgICAgICAgICAgICAgICAgICB5MT15aFttMl07XG4gICAgICAgICAgICAgICAgICAgICAgeDI9eHNlY3QobTMsbTEpO1xuICAgICAgICAgICAgICAgICAgICAgIHkyPXlzZWN0KG0zLG0xKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiAvLyAgTGluZSBiZXR3ZWVuIHZlcnRleCAzIGFuZCBzaWRlIDEtMlxuICAgICAgICAgICAgICAgICAgICAgIHgxPXhoW20zXTtcbiAgICAgICAgICAgICAgICAgICAgICB5MT15aFttM107XG4gICAgICAgICAgICAgICAgICAgICAgeDI9eHNlY3QobTEsbTIpO1xuICAgICAgICAgICAgICAgICAgICAgIHkyPXlzZWN0KG0xLG0yKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OiAvLyBMaW5lIGJldHdlZW4gc2lkZXMgMS0yIGFuZCAyLTNcbiAgICAgICAgICAgICAgICAgICAgICB4MT14c2VjdChtMSxtMik7XG4gICAgICAgICAgICAgICAgICAgICAgeTE9eXNlY3QobTEsbTIpO1xuICAgICAgICAgICAgICAgICAgICAgIHgyPXhzZWN0KG0yLG0zKTtcbiAgICAgICAgICAgICAgICAgICAgICB5Mj15c2VjdChtMixtMyk7XG4gICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODogLy8gTGluZSBiZXR3ZWVuIHNpZGVzIDItMyBhbmQgMy0xXG4gICAgICAgICAgICAgICAgICAgICAgeDE9eHNlY3QobTIsbTMpO1xuICAgICAgICAgICAgICAgICAgICAgIHkxPXlzZWN0KG0yLG0zKTtcbiAgICAgICAgICAgICAgICAgICAgICB4Mj14c2VjdChtMyxtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgeTI9eXNlY3QobTMsbTEpO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IC8vIExpbmUgYmV0d2VlbiBzaWRlcyAzLTEgYW5kIDEtMlxuICAgICAgICAgICAgICAgICAgICAgIHgxPXhzZWN0KG0zLG0xKTtcbiAgICAgICAgICAgICAgICAgICAgICB5MT15c2VjdChtMyxtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgeDI9eHNlY3QobTEsbTIpO1xuICAgICAgICAgICAgICAgICAgICAgIHkyPXlzZWN0KG0xLG0yKTtcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8vIFB1dCB5b3VyIHByb2Nlc3NpbmcgY29kZSBoZXJlIGFuZCBjb21tZW50IG91dCB0aGUgcHJpbnRmXG4gICAgICAgICAgICAgICAgICAvL3ByaW50ZihcIiVmICVmICVmICVmICVmXFxuXCIseDEseTEseDIseTIseltrXSk7XG4gICAgICAgICAgICAgICAgICBkcmF3Q29udG91cih4MSx5MSx4Mix5Mix6W2tdLGspO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuIiwiLy9odHRwczovL2dpdGh1Yi5jb20vamFzb25kYXZpZXMvY29ucmVjLmpzXG4vL2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjYzMzA1L2RyYXdpbmctYS10b3BvZ3JhcGhpY2FsLW1hcFxudmFyIHRpbiA9IHJlcXVpcmUoJ3R1cmYtdGluJyk7XG52YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcbnZhciBncmlkID0gcmVxdWlyZSgndHVyZi1ncmlkJyk7XG52YXIgZXh0ZW50ID0gcmVxdWlyZSgndHVyZi1leHRlbnQnKTtcbnZhciBwbGFuZXBvaW50ID0gcmVxdWlyZSgndHVyZi1wbGFuZXBvaW50Jyk7XG52YXIgZmVhdHVyZWNvbGxlY3Rpb24gPSByZXF1aXJlKCd0dXJmLWZlYXR1cmVjb2xsZWN0aW9uJyk7XG52YXIgbGluZXN0cmluZyA9IHJlcXVpcmUoJ3R1cmYtbGluZXN0cmluZycpO1xudmFyIHNxdWFyZSA9IHJlcXVpcmUoJ3R1cmYtc3F1YXJlJyk7XG52YXIgQ29ucmVjID0gcmVxdWlyZSgnLi9jb25yZWMnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyB3aXRoIHotdmFsdWVzIGFuZCBhbiBhcnJheSBvZlxuICogdmFsdWUgYnJlYWtzIGFuZCBnZW5lcmF0ZXMgW2lzb2xpbmVzXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0lzb2xpbmUpLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9pc29saW5lc1xuICogQGNhdGVnb3J5IGludGVycG9sYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7c3RyaW5nfSB6IHRoZSBwcm9wZXJ0eSBuYW1lIGluIGBwb2ludHNgIGZyb20gd2hpY2ggei12YWx1ZXMgd2lsbCBiZSBwdWxsZWRcbiAqIEBwYXJhbSB7bnVtYmVyfSByZXNvbHV0aW9uIHJlc29sdXRpb24gb2YgdGhlIHVuZGVybHlpbmcgZ3JpZFxuICogQHBhcmFtIHtudW1iZXJbXX0gYnJlYWtzIHdoZXJlIHRvIGRyYXcgY29udG91cnNcbiAqIEByZXR1cm5zIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgTGluZVN0cmluZ30gZmVhdHVyZXMgcmVwcmVzZW50aW5nIGlzb2xpbmVzXG4gKiBAZXhhbXBsZVxuICogLy8gY3JlYXRlIHJhbmRvbSBwb2ludHMgd2l0aCByYW5kb21cbiAqIC8vIHotdmFsdWVzIGluIHRoZWlyIHByb3BlcnRpZXNcbiAqIHZhciBwb2ludHMgPSB0dXJmLnJhbmRvbSgncG9pbnQnLCAxMDAsIHtcbiAqICAgYmJveDogWzAsIDMwLCAyMCwgNTBdXG4gKiB9KTtcbiAqIGZvciAodmFyIGkgPSAwOyBpIDwgcG9pbnRzLmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gKiAgIHBvaW50cy5mZWF0dXJlc1tpXS5wcm9wZXJ0aWVzLnogPSBNYXRoLnJhbmRvbSgpICogMTA7XG4gKiB9XG4gKiB2YXIgYnJlYWtzID0gWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXTtcbiAqIHZhciBpc29saW5lZCA9IHR1cmYuaXNvbGluZXMocG9pbnRzLCAneicsIDE1LCBicmVha3MpO1xuICogLy89aXNvbGluZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2ludHMsIHosIHJlc29sdXRpb24sIGJyZWFrcywgZG9uZSl7XG4gIHZhciB0aW5SZXN1bHQgPSB0aW4ocG9pbnRzLCB6KTtcbiAgdmFyIGV4dGVudEJCb3ggPSBleHRlbnQocG9pbnRzKTtcbiAgdmFyIHNxdWFyZUJCb3ggPSBzcXVhcmUoZXh0ZW50QkJveCk7XG4gIHZhciBncmlkUmVzdWx0ID0gZ3JpZChzcXVhcmVCQm94LCByZXNvbHV0aW9uKTtcbiAgdmFyIGRhdGEgPSBbXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGdyaWRSZXN1bHQuZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcHQgPSBncmlkUmVzdWx0LmZlYXR1cmVzW2ldO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGluUmVzdWx0LmZlYXR1cmVzLmxlbmd0aDsgaisrKSB7XG4gICAgICB2YXIgdHJpYW5nbGUgPSB0aW5SZXN1bHQuZmVhdHVyZXNbal07XG4gICAgICBpZiAoaW5zaWRlKHB0LCB0cmlhbmdsZSkpIHtcbiAgICAgICAgcHQucHJvcGVydGllcyA9IHt9O1xuICAgICAgICBwdC5wcm9wZXJ0aWVzW3pdID0gcGxhbmVwb2ludChwdCwgdHJpYW5nbGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBkZXB0aCA9IE1hdGguc3FydChncmlkUmVzdWx0LmZlYXR1cmVzLmxlbmd0aCk7XG4gIGZvciAodmFyIHg9MDsgeDxkZXB0aDsgeCsrKXtcbiAgICB2YXIgeEdyb3VwID0gZ3JpZFJlc3VsdC5mZWF0dXJlcy5zbGljZSh4ICogZGVwdGgsICh4ICsgMSkgKiBkZXB0aCk7XG4gICAgdmFyIHhGbGF0ID0gW107XG4gICAgeEdyb3VwLmZvckVhY2goZnVuY3Rpb24odmVydGljYWxQb2ludCl7XG4gICAgICBpZih2ZXJ0aWNhbFBvaW50LnByb3BlcnRpZXMpe1xuICAgICAgICB4RmxhdC5wdXNoKHZlcnRpY2FsUG9pbnQucHJvcGVydGllc1t6XSk7XG4gICAgICB9IGVsc2V7XG4gICAgICAgIHhGbGF0LnB1c2goMCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgZGF0YS5wdXNoKHhGbGF0KTtcbiAgfVxuICB2YXIgaW50ZXJ2YWwgPSAoc3F1YXJlQkJveFsyXSAtIHNxdWFyZUJCb3hbMF0pIC8gZGVwdGg7XG4gIHZhciB4Q29vcmRpbmF0ZXMgPSBbXTtcbiAgdmFyIHlDb29yZGluYXRlcyA9IFtdO1xuICBmb3IgKHZhciB4ID0gMDsgeCA8IGRlcHRoOyB4KyspIHtcbiAgICB4Q29vcmRpbmF0ZXMucHVzaCh4ICogaW50ZXJ2YWwgKyBzcXVhcmVCQm94WzBdKTtcbiAgICB5Q29vcmRpbmF0ZXMucHVzaCh4ICogaW50ZXJ2YWwgKyBzcXVhcmVCQm94WzFdKTtcbiAgfVxuXG4gIHZhciBjID0gbmV3IENvbnJlYygpO1xuICBjLmNvbnRvdXIoZGF0YSwgMCwgcmVzb2x1dGlvbiwgMCwgcmVzb2x1dGlvbiwgeENvb3JkaW5hdGVzLCB5Q29vcmRpbmF0ZXMsIGJyZWFrcy5sZW5ndGgsIGJyZWFrcyk7XG4gIHZhciBjb250b3VyTGlzdCA9IGMuY29udG91ckxpc3QoKTtcblxuICB2YXIgZmMgPSBmZWF0dXJlY29sbGVjdGlvbihbXSk7XG4gIGNvbnRvdXJMaXN0LmZvckVhY2goZnVuY3Rpb24oYyl7XG4gICAgaWYoYy5sZW5ndGggPiAyKXtcbiAgICAgIHZhciBwb2x5Q29vcmRpbmF0ZXMgPSBbXTtcbiAgICAgIGMuZm9yRWFjaChmdW5jdGlvbihjb29yZCl7XG4gICAgICAgIHBvbHlDb29yZGluYXRlcy5wdXNoKFtjb29yZC54LCBjb29yZC55XSk7XG4gICAgICB9KTtcbiAgICAgIHZhciBwb2x5ID0gbGluZXN0cmluZyhwb2x5Q29vcmRpbmF0ZXMpO1xuICAgICAgcG9seS5wcm9wZXJ0aWVzID0ge307XG4gICAgICBwb2x5LnByb3BlcnRpZXNbel0gPSBjLmxldmVsO1xuXG4gICAgICBmYy5mZWF0dXJlcy5wdXNoKHBvbHkpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGZjO1xufVxuXG5cblxuIiwidmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xuXG4vKipcbiAqIFRha2VzIGEgYm91bmRpbmcgYm94IGFuZCBhIGNlbGwgZGVwdGggYW5kIHJldHVybnMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgaW4gYSBncmlkLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9ncmlkXG4gKiBAY2F0ZWdvcnkgaW50ZXJwb2xhdGlvblxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBleHRlbnQgZXh0ZW50IGluIFttaW5YLCBtaW5ZLCBtYXhYLCBtYXhZXSBvcmRlclxuICogQHBhcmFtIHtOdW1iZXJ9IGRlcHRoIGhvdyBtYW55IGNlbGxzIHRvIG91dHB1dFxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGdyaWQgYXMgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aCB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGV4dGVudCA9IFstNzAuODIzMzY0LCAtMzMuNTUzOTg0LCAtNzAuNDczMTc1LCAtMzMuMzAyOTg2XTtcbiAqIHZhciBkZXB0aCA9IDEwO1xuICpcbiAqIHZhciBncmlkID0gdHVyZi5ncmlkKGV4dGVudCwgZGVwdGgpO1xuICpcbiAqIC8vPWdyaWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleHRlbnRzLCBkZXB0aCkge1xuICB2YXIgeG1pbiA9IGV4dGVudHNbMF07XG4gIHZhciB5bWluID0gZXh0ZW50c1sxXTtcbiAgdmFyIHhtYXggPSBleHRlbnRzWzJdO1xuICB2YXIgeW1heCA9IGV4dGVudHNbM107XG4gIHZhciBpbnRlcnZhbCA9ICh4bWF4IC0geG1pbikgLyBkZXB0aDtcbiAgdmFyIGNvb3JkcyA9IFtdO1xuICB2YXIgZmMgPSB7XG4gICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJyxcbiAgICBmZWF0dXJlczogW11cbiAgfTtcblxuICBmb3IgKHZhciB4PTA7IHg8PWRlcHRoOyB4Kyspe1xuICAgIGZvciAodmFyIHk9MDt5PD1kZXB0aDsgeSsrKXtcbiAgICAgIGZjLmZlYXR1cmVzLnB1c2gocG9pbnQoWyh4ICogaW50ZXJ2YWwpICsgeG1pbiwgKHkgKiBpbnRlcnZhbCkgKyB5bWluXSkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmM7XG59XG4iLCJ2YXIgc3MgPSByZXF1aXJlKCdzaW1wbGUtc3RhdGlzdGljcycpO1xuXG4vKipcbiogVGFrZXMgYSB7QEZlYXR1cmVDb2xsZWN0aW9ufSBvZiBhbnkgdHlwZSBhbmQgcmV0dXJucyBhbiBhcnJheSBvZiB0aGUgW0plbmtzIE5hdHVyYWwgYnJlYWtzXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0plbmtzX25hdHVyYWxfYnJlYWtzX29wdGltaXphdGlvbilcbiogZm9yIGEgZ2l2ZW4gcHJvcGVydHlcbiogQG1vZHVsZSB0dXJmL2plbmtzXG4qIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IGlucHV0IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgYW55IHR5cGVcbiogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIHRoZSBwcm9wZXJ0eSBpbiBgaW5wdXRgIG9uIHdoaWNoIHRvIGNhbGN1bGF0ZSBKZW5rcyBuYXR1cmFsIGJyZWFrc1xuKiBAcGFyYW0ge251bWJlcn0gbnVtYmVyT2ZCcmVha3MgbnVtYmVyIG9mIGNsYXNzZXMgaW4gd2hpY2ggdG8gZ3JvdXAgdGhlIGRhdGFcbiogQHJldHVybiB7QXJyYXk8bnVtYmVyPn0gdGhlIGJyZWFrIG51bWJlciBmb3IgZWFjaCBjbGFzcyBwbHVzIHRoZSBtaW5pbXVtIGFuZCBtYXhpbXVtIHZhbHVlc1xuKiBAZXhhbXBsZVxuKiB2YXIgcG9pbnRzID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4qICAgXCJmZWF0dXJlc1wiOiBbXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbNDkuODU5NzMzLCA0MC40MDA0MjRdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA2MDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFs0OS44Mzg3OSwgNDAuNDAxMjA5XVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMTAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbNDkuODE3ODQ4LCA0MC4zNzY4ODldXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFs0OS44NDA1MDcsIDQwLjM4NjA0M11cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDMwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzQ5Ljg1NDU4MywgNDAuMzc1MzJdXG4qICAgICAgIH1cbiogICAgIH1cbiogICBdXG4qIH07XG4qXG4qIHZhciBicmVha3MgPSB0dXJmLmplbmtzKHBvaW50cywgJ3BvcHVsYXRpb24nLCAzKTtcbipcbiogLy89YnJlYWtzXG4qL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmYywgZmllbGQsIG51bSl7XG4gIHZhciB2YWxzID0gW107XG4gIHZhciBicmVha3MgPSBbXTtcblxuICBmYy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgIGlmKGZlYXR1cmUucHJvcGVydGllc1tmaWVsZF0hPT11bmRlZmluZWQpe1xuICAgICAgdmFscy5wdXNoKGZlYXR1cmUucHJvcGVydGllc1tmaWVsZF0pO1xuICAgIH1cbiAgfSk7XG4gIGJyZWFrcyA9IHNzLmplbmtzKHZhbHMsIG51bSk7XG5cbiAgcmV0dXJuIGJyZWFrcztcbn07XG4iLCIvKipcbiAqIFRha2VzIGEge0BsaW5rIFBvbHlnb259IGZlYXR1cmUgYW5kIHJldHVybnMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYXQgYWxsIHNlbGYtaW50ZXJzZWN0aW9ucy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYva2lua3NcbiAqIEBjYXRlZ29yeSBtaXNjXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHlnb24gYSBQb2x5Z29uIGZlYXR1cmVcbiAqIEByZXR1cm5zIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIHJlcHJlc2VudGluZyBzZWxmLWludGVyc2VjdGlvbnNcbiAqIEBleGFtcGxlXG4gKiB2YXIgcG9seSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICBbLTEyLjAzNDgzNSwgOC45MDExODNdLFxuICogICAgICAgWy0xMi4wNjA0MTMsIDguODk5ODI2XSxcbiAqICAgICAgIFstMTIuMDM2MzgsIDguODczMTk5XSxcbiAqICAgICAgIFstMTIuMDU5MzgzLCA4Ljg3MTQxOF0sXG4gKiAgICAgICBbLTEyLjAzNDgzNSwgOC45MDExODNdXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcbiAqIFxuICogdmFyIGtpbmtzID0gdHVyZi5raW5rcyhwb2x5KTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBraW5rcy5pbnRlcnNlY3Rpb25zLmZlYXR1cmVzLmNvbmNhdChwb2x5KTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cblxudmFyIHBvbHlnb24gPSByZXF1aXJlKCd0dXJmLXBvbHlnb24nKTtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcbnZhciBmYyA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5SW4pIHtcbiAgdmFyIHBvbHk7XG4gIHZhciByZXN1bHRzID0ge2ludGVyc2VjdGlvbnM6IGZjKFtdKSwgZml4ZWQ6IG51bGx9O1xuICBpZiAocG9seUluLnR5cGUgPT09ICdGZWF0dXJlJykge1xuICAgIHBvbHkgPSBwb2x5SW4uZ2VvbWV0cnk7XG4gIH0gZWxzZSB7XG4gICAgcG9seSA9IHBvbHlJbjtcbiAgfVxuICB2YXIgaW50ZXJzZWN0aW9uSGFzaCA9IHt9O1xuICBwb2x5LmNvb3JkaW5hdGVzLmZvckVhY2goZnVuY3Rpb24ocmluZzEpe1xuICAgIHBvbHkuY29vcmRpbmF0ZXMuZm9yRWFjaChmdW5jdGlvbihyaW5nMil7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgcmluZzEubGVuZ3RoLTE7IGkrKykge1xuICAgICAgICBmb3IodmFyIGsgPSAwOyBrIDwgcmluZzIubGVuZ3RoLTE7IGsrKykge1xuICAgICAgICAgIHZhciBpbnRlcnNlY3Rpb24gPSBsaW5lSW50ZXJzZWN0cyhyaW5nMVtpXVswXSxyaW5nMVtpXVsxXSxyaW5nMVtpKzFdWzBdLHJpbmcxW2krMV1bMV0sXG4gICAgICAgICAgICByaW5nMltrXVswXSxyaW5nMltrXVsxXSxyaW5nMltrKzFdWzBdLHJpbmcyW2srMV1bMV0pO1xuICAgICAgICAgIGlmKGludGVyc2VjdGlvbikge1xuICAgICAgICAgICAgcmVzdWx0cy5pbnRlcnNlY3Rpb25zLmZlYXR1cmVzLnB1c2gocG9pbnQoW2ludGVyc2VjdGlvblswXSwgaW50ZXJzZWN0aW9uWzFdXSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIH0pXG4gIHJldHVybiByZXN1bHRzO1xufVxuXG5cbi8vIG1vZGlmaWVkIGZyb20gaHR0cDovL2pzZmlkZGxlLm5ldC9qdXN0aW5fY19yb3VuZHMvR2QyUzIvbGlnaHQvXG5mdW5jdGlvbiBsaW5lSW50ZXJzZWN0cyhsaW5lMVN0YXJ0WCwgbGluZTFTdGFydFksIGxpbmUxRW5kWCwgbGluZTFFbmRZLCBsaW5lMlN0YXJ0WCwgbGluZTJTdGFydFksIGxpbmUyRW5kWCwgbGluZTJFbmRZKSB7XG4gIC8vIGlmIHRoZSBsaW5lcyBpbnRlcnNlY3QsIHRoZSByZXN1bHQgY29udGFpbnMgdGhlIHggYW5kIHkgb2YgdGhlIGludGVyc2VjdGlvbiAodHJlYXRpbmcgdGhlIGxpbmVzIGFzIGluZmluaXRlKSBhbmQgYm9vbGVhbnMgZm9yIHdoZXRoZXIgbGluZSBzZWdtZW50IDEgb3IgbGluZSBzZWdtZW50IDIgY29udGFpbiB0aGUgcG9pbnRcbiAgdmFyIGRlbm9taW5hdG9yLCBhLCBiLCBudW1lcmF0b3IxLCBudW1lcmF0b3IyLCByZXN1bHQgPSB7XG4gICAgeDogbnVsbCxcbiAgICB5OiBudWxsLFxuICAgIG9uTGluZTE6IGZhbHNlLFxuICAgIG9uTGluZTI6IGZhbHNlXG4gIH07XG4gIGRlbm9taW5hdG9yID0gKChsaW5lMkVuZFkgLSBsaW5lMlN0YXJ0WSkgKiAobGluZTFFbmRYIC0gbGluZTFTdGFydFgpKSAtICgobGluZTJFbmRYIC0gbGluZTJTdGFydFgpICogKGxpbmUxRW5kWSAtIGxpbmUxU3RhcnRZKSk7XG4gIGlmIChkZW5vbWluYXRvciA9PSAwKSB7XG4gICAgaWYocmVzdWx0LnggIT0gbnVsbCAmJiByZXN1bHQueSAhPSBudWxsKSB7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIGEgPSBsaW5lMVN0YXJ0WSAtIGxpbmUyU3RhcnRZO1xuICBiID0gbGluZTFTdGFydFggLSBsaW5lMlN0YXJ0WDtcbiAgbnVtZXJhdG9yMSA9ICgobGluZTJFbmRYIC0gbGluZTJTdGFydFgpICogYSkgLSAoKGxpbmUyRW5kWSAtIGxpbmUyU3RhcnRZKSAqIGIpO1xuICBudW1lcmF0b3IyID0gKChsaW5lMUVuZFggLSBsaW5lMVN0YXJ0WCkgKiBhKSAtICgobGluZTFFbmRZIC0gbGluZTFTdGFydFkpICogYik7XG4gIGEgPSBudW1lcmF0b3IxIC8gZGVub21pbmF0b3I7XG4gIGIgPSBudW1lcmF0b3IyIC8gZGVub21pbmF0b3I7XG5cbiAgLy8gaWYgd2UgY2FzdCB0aGVzZSBsaW5lcyBpbmZpbml0ZWx5IGluIGJvdGggZGlyZWN0aW9ucywgdGhleSBpbnRlcnNlY3QgaGVyZTpcbiAgcmVzdWx0LnggPSBsaW5lMVN0YXJ0WCArIChhICogKGxpbmUxRW5kWCAtIGxpbmUxU3RhcnRYKSk7XG4gIHJlc3VsdC55ID0gbGluZTFTdGFydFkgKyAoYSAqIChsaW5lMUVuZFkgLSBsaW5lMVN0YXJ0WSkpO1xuXG4gIC8vIGlmIGxpbmUxIGlzIGEgc2VnbWVudCBhbmQgbGluZTIgaXMgaW5maW5pdGUsIHRoZXkgaW50ZXJzZWN0IGlmOlxuICBpZiAoYSA+IDAgJiYgYSA8IDEpIHtcbiAgICByZXN1bHQub25MaW5lMSA9IHRydWU7XG4gIH1cbiAgLy8gaWYgbGluZTIgaXMgYSBzZWdtZW50IGFuZCBsaW5lMSBpcyBpbmZpbml0ZSwgdGhleSBpbnRlcnNlY3QgaWY6XG4gIGlmIChiID4gMCAmJiBiIDwgMSkge1xuICAgIHJlc3VsdC5vbkxpbmUyID0gdHJ1ZTtcbiAgfVxuICAvLyBpZiBsaW5lMSBhbmQgbGluZTIgYXJlIHNlZ21lbnRzLCB0aGV5IGludGVyc2VjdCBpZiBib3RoIG9mIHRoZSBhYm92ZSBhcmUgdHJ1ZVxuICBpZihyZXN1bHQub25MaW5lMSAmJiByZXN1bHQub25MaW5lMil7XG4gICAgcmV0dXJuIFtyZXN1bHQueCwgcmVzdWx0LnldO1xuICB9XG4gIGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIiwidmFyIGRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIExpbmVTdHJpbmd9IGZlYXR1cmUgYW5kIG1lYXN1cmVzIGl0cyBsZW5ndGggaW4gdGhlIHNwZWNpZmllZCB1bml0cy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvbGluZS1kaXN0YW5jZVxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0xpbmVTdHJpbmd9IExpbmUgdG8gbWVhc3VyZVxuICogQHBhcmFtIHtTdHJpbmd9IFt1bml0cz1taWxlc10gY2FuIGJlIGRlZ3JlZXMsIHJhZGlhbnMsIG1pbGVzLCBvciBraWxvbWV0ZXJzXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IGxlbmd0aCBvZiB0aGUgTGluZVN0cmluZ1xuICogQGV4YW1wbGVcbiAqIHZhciBsaW5lID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiTGluZVN0cmluZ1wiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1xuICogICAgICAgWy03Ny4wMzE2NjksIDM4Ljg3ODYwNV0sXG4gKiAgICAgICBbLTc3LjAyOTYwOSwgMzguODgxOTQ2XSxcbiAqICAgICAgIFstNzcuMDIwMzM5LCAzOC44ODQwODRdLFxuICogICAgICAgWy03Ny4wMjU2NjEsIDM4Ljg4NTgyMV0sXG4gKiAgICAgICBbLTc3LjAyMTg4NCwgMzguODg5NTYzXSxcbiAqICAgICAgIFstNzcuMDE5ODI0LCAzOC44OTIzNjhdXG4gKiAgICAgXVxuICogICB9XG4gKiB9O1xuICpcbiAqIHZhciBsZW5ndGggPSB0dXJmLmxpbmVEaXN0YW5jZShsaW5lLCAnbWlsZXMnKTtcbiAqXG4gKiAvLz1saW5lXG4gKlxuICogLy89bGVuZ3RoXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobGluZSwgdW5pdHMpIHtcbiAgdmFyIGNvb3JkcztcbiAgaWYobGluZS50eXBlID09PSAnRmVhdHVyZScpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgaWYobGluZS50eXBlID09PSAnTGluZVN0cmluZycpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgdGhyb3cgbmV3IEVycm9yKCdpbnB1dCBtdXN0IGJlIGEgTGluZVN0cmluZyBGZWF0dXJlIG9yIEdlb21ldHJ5Jyk7XG5cbiAgdmFyIHRyYXZlbGxlZCA9IDA7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgdHJhdmVsbGVkICs9IGRpc3RhbmNlKHBvaW50KGNvb3Jkc1tpXSksIHBvaW50KGNvb3Jkc1tpKzFdKSwgdW5pdHMpO1xuICB9XG4gIHJldHVybiB0cmF2ZWxsZWQ7XG59XG4iLCJ2YXIgZGlzdGFuY2UgPSByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyk7XG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG52YXIgbGluZXN0cmluZyA9IHJlcXVpcmUoJ3R1cmYtbGluZXN0cmluZycpO1xudmFyIGJlYXJpbmcgPSByZXF1aXJlKCd0dXJmLWJlYXJpbmcnKTtcbnZhciBkZXN0aW5hdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZGVzdGluYXRpb24nKTtcblxuLyoqXG4gKiBTbGljZXMgYSBMaW5lU3RyaW5nIGF0IHN0YXJ0IGFuZCBzdG9wIFBvaW50c1xuICpcbiAqIEBtb2R1bGUgdHVyZi9saW5lLXNsaWNlXG4gKlxuICogQHBhcmFtIHtQb2ludH0gUG9pbnQgdG8gc3RhcnQgdGhlIHNsaWNlXG4gKiBAcGFyYW0ge1BvaW50fSBQb2ludCB0byBzdG9wIHRoZSBzbGljZVxuICogQHBhcmFtIHtMaW5lU3RyaW5nfSBMaW5lIHRvIHNsaWNlXG4gKiBAcmV0dXJuIHtMaW5lU3RyaW5nfSBTbGljZWQgTGluZVN0cmluZ1xuICogQGV4YW1wbGVcbiAqIHZhciBsaW5lID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiTGluZVN0cmluZ1wiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1xuICogICAgICAgWy03Ny4wMzE2NjksIDM4Ljg3ODYwNV0sXG4gKiAgICAgICBbLTc3LjAyOTYwOSwgMzguODgxOTQ2XSxcbiAqICAgICAgIFstNzcuMDIwMzM5LCAzOC44ODQwODRdLFxuICogICAgICAgWy03Ny4wMjU2NjEsIDM4Ljg4NTgyMV0sXG4gKiAgICAgICBbLTc3LjAyMTg4NCwgMzguODg5NTYzXSxcbiAqICAgICAgIFstNzcuMDE5ODI0LCAzOC44OTIzNjhdXG4gKiAgICAgXVxuICogICB9XG4gKiB9O1xuICogdmFyIHN0YXJ0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzcuMDI5NjA5LCAzOC44ODE5NDZdXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgc3RvcCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc3LjAyMTg4NCwgMzguODg5NTYzXVxuICogICB9XG4gKiB9O1xuICogXG4gKiB2YXIgc2xpY2VkID0gdHVyZi5saW5lU2xpY2Uoc3RhcnQsIHN0b3AsIGxpbmUpO1xuICpcbiAqIC8vPWxpbmVcbiAqXG4gKiAvLz1zbGljZWRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChzdGFydFB0LCBzdG9wUHQsIGxpbmUpIHsgIFxuICB2YXIgY29vcmRzO1xuICBpZihsaW5lLnR5cGUgPT09ICdGZWF0dXJlJykgY29vcmRzID0gbGluZS5nZW9tZXRyeS5jb29yZGluYXRlcztcbiAgZWxzZSBpZihsaW5lLnR5cGUgPT09ICdMaW5lU3RyaW5nJykgY29vcmRzID0gbGluZS5nZW9tZXRyeS5jb29yZGluYXRlcztcbiAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ2lucHV0IG11c3QgYmUgYSBMaW5lU3RyaW5nIEZlYXR1cmUgb3IgR2VvbWV0cnknKTtcblxuICB2YXIgc3RhcnRWZXJ0ZXggPSBwb2ludE9uTGluZShzdGFydFB0LCBjb29yZHMpO1xuICB2YXIgc3RvcFZlcnRleCA9IHBvaW50T25MaW5lKHN0b3BQdCwgY29vcmRzKTtcbiAgdmFyIGVuZHM7XG4gIGlmKHN0YXJ0VmVydGV4LnByb3BlcnRpZXMuaW5kZXggPD0gc3RvcFZlcnRleC5wcm9wZXJ0aWVzLmluZGV4KSB7XG4gICAgZW5kcyA9IFtzdGFydFZlcnRleCwgc3RvcFZlcnRleF07XG4gIH0gZWxzZSB7XG4gICAgZW5kcyA9IFtzdG9wVmVydGV4LCBzdGFydFZlcnRleF07XG4gIH1cbiAgdmFyIGNsaXBMaW5lID0gbGluZXN0cmluZyhbZW5kc1swXS5nZW9tZXRyeS5jb29yZGluYXRlc10sIHt9KTtcbiAgZm9yKHZhciBpID0gZW5kc1swXS5wcm9wZXJ0aWVzLmluZGV4KzE7IGkgPCBlbmRzWzFdLnByb3BlcnRpZXMuaW5kZXgrMTsgaSsrKSB7XG4gICAgY2xpcExpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMucHVzaChjb29yZHNbaV0pO1xuICB9XG4gIGNsaXBMaW5lLmdlb21ldHJ5LmNvb3JkaW5hdGVzLnB1c2goZW5kc1sxXS5nZW9tZXRyeS5jb29yZGluYXRlcyk7XG4gIHJldHVybiBjbGlwTGluZTtcbn1cblxuZnVuY3Rpb24gcG9pbnRPbkxpbmUgKHB0LCBjb29yZHMpIHtcbiAgdmFyIHVuaXRzID0gJ21pbGVzJ1xuICB2YXIgY2xvc2VzdFB0ID0gcG9pbnQoW0luZmluaXR5LCBJbmZpbml0eV0sIHtkaXN0OiBJbmZpbml0eX0pO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgIHZhciBzdGFydCA9IHBvaW50KGNvb3Jkc1tpXSlcbiAgICB2YXIgc3RvcCA9IHBvaW50KGNvb3Jkc1tpKzFdKVxuICAgIC8vc3RhcnRcbiAgICBzdGFydC5wcm9wZXJ0aWVzLmRpc3QgPSBkaXN0YW5jZShwdCwgc3RhcnQsIHVuaXRzKTtcbiAgICAvL3N0b3BcbiAgICBzdG9wLnByb3BlcnRpZXMuZGlzdCA9IGRpc3RhbmNlKHB0LCBzdG9wLCB1bml0cyk7XG4gICAgLy9wZXJwZW5kaWN1bGFyXG4gICAgdmFyIGRpcmVjdGlvbiA9IGJlYXJpbmcoc3RhcnQsIHN0b3ApXG4gICAgdmFyIHBlcnBlbmRpY3VsYXJQdCA9IGRlc3RpbmF0aW9uKHB0LCAxMDAwICwgZGlyZWN0aW9uICsgOTAsIHVuaXRzKSAvLyAxMDAwID0gZ3Jvc3NcbiAgICB2YXIgaW50ZXJzZWN0ID0gbGluZUludGVyc2VjdHMoXG4gICAgICBwdC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgIHB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgcGVycGVuZGljdWxhclB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgcGVycGVuZGljdWxhclB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgc3RhcnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICBzdGFydC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSxcbiAgICAgIHN0b3AuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICBzdG9wLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdXG4gICAgICApO1xuICAgIGlmKCFpbnRlcnNlY3QpIHtcbiAgICAgIHBlcnBlbmRpY3VsYXJQdCA9IGRlc3RpbmF0aW9uKHB0LCAxMDAwICwgZGlyZWN0aW9uIC0gOTAsIHVuaXRzKSAvLyAxMDAwID0gZ3Jvc3NcbiAgICAgIGludGVyc2VjdCA9IGxpbmVJbnRlcnNlY3RzKFxuICAgICAgICBwdC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgICAgcHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICAgIHBlcnBlbmRpY3VsYXJQdC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgICAgcGVycGVuZGljdWxhclB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgICBzdGFydC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgICAgc3RhcnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICAgIHN0b3AuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICAgIHN0b3AuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV1cbiAgICAgICAgKTtcbiAgICB9XG4gICAgcGVycGVuZGljdWxhclB0LnByb3BlcnRpZXMuZGlzdCA9IEluZmluaXR5O1xuICAgIHZhciBpbnRlcnNlY3RQdDtcbiAgICBpZihpbnRlcnNlY3QpIHtcbiAgICAgIHZhciBpbnRlcnNlY3RQdCA9IHBvaW50KGludGVyc2VjdCk7XG4gICAgICBpbnRlcnNlY3RQdC5wcm9wZXJ0aWVzLmRpc3QgPSBkaXN0YW5jZShwdCwgaW50ZXJzZWN0UHQsIHVuaXRzKTtcbiAgICB9XG4gICAgXG4gICAgaWYoc3RhcnQucHJvcGVydGllcy5kaXN0IDwgY2xvc2VzdFB0LnByb3BlcnRpZXMuZGlzdCkge1xuICAgICAgY2xvc2VzdFB0ID0gc3RhcnQ7XG4gICAgICBjbG9zZXN0UHQucHJvcGVydGllcy5pbmRleCA9IGk7XG4gICAgfVxuICAgIGlmKHN0b3AucHJvcGVydGllcy5kaXN0IDwgY2xvc2VzdFB0LnByb3BlcnRpZXMuZGlzdCkge1xuICAgICBjbG9zZXN0UHQgPSBzdG9wO1xuICAgICBjbG9zZXN0UHQucHJvcGVydGllcy5pbmRleCA9IGk7XG4gICAgfVxuICAgIGlmKGludGVyc2VjdFB0ICYmIGludGVyc2VjdFB0LnByb3BlcnRpZXMuZGlzdCA8IGNsb3Nlc3RQdC5wcm9wZXJ0aWVzLmRpc3QpeyBcbiAgICAgIGNsb3Nlc3RQdCA9IGludGVyc2VjdFB0O1xuICAgICAgY2xvc2VzdFB0LnByb3BlcnRpZXMuaW5kZXggPSBpO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIGNsb3Nlc3RQdDtcbn1cblxuLy8gbW9kaWZpZWQgZnJvbSBodHRwOi8vanNmaWRkbGUubmV0L2p1c3Rpbl9jX3JvdW5kcy9HZDJTMi9saWdodC9cbmZ1bmN0aW9uIGxpbmVJbnRlcnNlY3RzKGxpbmUxU3RhcnRYLCBsaW5lMVN0YXJ0WSwgbGluZTFFbmRYLCBsaW5lMUVuZFksIGxpbmUyU3RhcnRYLCBsaW5lMlN0YXJ0WSwgbGluZTJFbmRYLCBsaW5lMkVuZFkpIHtcbiAgLy8gaWYgdGhlIGxpbmVzIGludGVyc2VjdCwgdGhlIHJlc3VsdCBjb250YWlucyB0aGUgeCBhbmQgeSBvZiB0aGUgaW50ZXJzZWN0aW9uICh0cmVhdGluZyB0aGUgbGluZXMgYXMgaW5maW5pdGUpIGFuZCBib29sZWFucyBmb3Igd2hldGhlciBsaW5lIHNlZ21lbnQgMSBvciBsaW5lIHNlZ21lbnQgMiBjb250YWluIHRoZSBwb2ludFxuICB2YXIgZGVub21pbmF0b3IsIGEsIGIsIG51bWVyYXRvcjEsIG51bWVyYXRvcjIsIHJlc3VsdCA9IHtcbiAgICB4OiBudWxsLFxuICAgIHk6IG51bGwsXG4gICAgb25MaW5lMTogZmFsc2UsXG4gICAgb25MaW5lMjogZmFsc2VcbiAgfTtcbiAgZGVub21pbmF0b3IgPSAoKGxpbmUyRW5kWSAtIGxpbmUyU3RhcnRZKSAqIChsaW5lMUVuZFggLSBsaW5lMVN0YXJ0WCkpIC0gKChsaW5lMkVuZFggLSBsaW5lMlN0YXJ0WCkgKiAobGluZTFFbmRZIC0gbGluZTFTdGFydFkpKTtcbiAgaWYgKGRlbm9taW5hdG9yID09IDApIHtcbiAgICBpZihyZXN1bHQueCAhPSBudWxsICYmIHJlc3VsdC55ICE9IG51bGwpIHtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgYSA9IGxpbmUxU3RhcnRZIC0gbGluZTJTdGFydFk7XG4gIGIgPSBsaW5lMVN0YXJ0WCAtIGxpbmUyU3RhcnRYO1xuICBudW1lcmF0b3IxID0gKChsaW5lMkVuZFggLSBsaW5lMlN0YXJ0WCkgKiBhKSAtICgobGluZTJFbmRZIC0gbGluZTJTdGFydFkpICogYik7XG4gIG51bWVyYXRvcjIgPSAoKGxpbmUxRW5kWCAtIGxpbmUxU3RhcnRYKSAqIGEpIC0gKChsaW5lMUVuZFkgLSBsaW5lMVN0YXJ0WSkgKiBiKTtcbiAgYSA9IG51bWVyYXRvcjEgLyBkZW5vbWluYXRvcjtcbiAgYiA9IG51bWVyYXRvcjIgLyBkZW5vbWluYXRvcjtcblxuICAvLyBpZiB3ZSBjYXN0IHRoZXNlIGxpbmVzIGluZmluaXRlbHkgaW4gYm90aCBkaXJlY3Rpb25zLCB0aGV5IGludGVyc2VjdCBoZXJlOlxuICByZXN1bHQueCA9IGxpbmUxU3RhcnRYICsgKGEgKiAobGluZTFFbmRYIC0gbGluZTFTdGFydFgpKTtcbiAgcmVzdWx0LnkgPSBsaW5lMVN0YXJ0WSArIChhICogKGxpbmUxRW5kWSAtIGxpbmUxU3RhcnRZKSk7XG5cbiAgLy8gaWYgbGluZTEgaXMgYSBzZWdtZW50IGFuZCBsaW5lMiBpcyBpbmZpbml0ZSwgdGhleSBpbnRlcnNlY3QgaWY6XG4gIGlmIChhID4gMCAmJiBhIDwgMSkge1xuICAgIHJlc3VsdC5vbkxpbmUxID0gdHJ1ZTtcbiAgfVxuICAvLyBpZiBsaW5lMiBpcyBhIHNlZ21lbnQgYW5kIGxpbmUxIGlzIGluZmluaXRlLCB0aGV5IGludGVyc2VjdCBpZjpcbiAgaWYgKGIgPiAwICYmIGIgPCAxKSB7XG4gICAgcmVzdWx0Lm9uTGluZTIgPSB0cnVlO1xuICB9XG4gIC8vIGlmIGxpbmUxIGFuZCBsaW5lMiBhcmUgc2VnbWVudHMsIHRoZXkgaW50ZXJzZWN0IGlmIGJvdGggb2YgdGhlIGFib3ZlIGFyZSB0cnVlXG4gIGlmKHJlc3VsdC5vbkxpbmUxICYmIHJlc3VsdC5vbkxpbmUyKXtcbiAgICByZXR1cm4gW3Jlc3VsdC54LCByZXN1bHQueV07XG4gIH1cbiAgZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCIvKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgTGluZVN0cmluZ30ge0BsaW5rIEZlYXR1cmV9IGJhc2VkIG9uIGFcbiAqIGNvb3JkaW5hdGUgYXJyYXkuIFByb3BlcnRpZXMgY2FuIGJlIGFkZGVkIG9wdGlvbmFsbHkuXG4gKlxuICogQG1vZHVsZSB0dXJmL2xpbmVzdHJpbmdcbiAqIEBjYXRlZ29yeSBoZWxwZXJcbiAqIEBwYXJhbSB7QXJyYXk8QXJyYXk8TnVtYmVyPj59IGNvb3JkaW5hdGVzIGFuIGFycmF5IG9mIFBvc2l0aW9uc1xuICogQHBhcmFtIHtPYmplY3R9IHByb3BlcnRpZXMgYW4gT2JqZWN0IG9mIGtleS12YWx1ZSBwYWlycyB0byBhZGQgYXMgcHJvcGVydGllc1xuICogQHJldHVybiB7TGluZVN0cmluZ30gYSBMaW5lU3RyaW5nIGZlYXR1cmVcbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiBubyBjb29yZGluYXRlcyBhcmUgcGFzc2VkXG4gKiBAZXhhbXBsZVxuICogdmFyIGxpbmVzdHJpbmcxID0gdHVyZi5saW5lc3RyaW5nKFtcbiAqXHRbLTIxLjk2NDQxNiwgNjQuMTQ4MjAzXSxcbiAqXHRbLTIxLjk1NjE3NiwgNjQuMTQxMzE2XSxcbiAqXHRbLTIxLjkzOTAxLCA2NC4xMzU5MjRdLFxuICpcdFstMjEuOTI3MzM3LCA2NC4xMzY2NzNdXG4gKiBdKTtcbiAqIHZhciBsaW5lc3RyaW5nMiA9IHR1cmYubGluZXN0cmluZyhbXG4gKlx0Wy0yMS45MjkwNTQsIDY0LjEyNzk4NV0sXG4gKlx0Wy0yMS45MTI5MTgsIDY0LjEzNDcyNl0sXG4gKlx0Wy0yMS45MTYwMDcsIDY0LjE0MTAxNl0sXG4gKiBcdFstMjEuOTMwMDg0LCA2NC4xNDQ0Nl1cbiAqIF0sIHtuYW1lOiAnbGluZSAxJywgZGlzdGFuY2U6IDE0NX0pO1xuICpcbiAqIC8vPWxpbmVzdHJpbmcxXG4gKlxuICogLy89bGluZXN0cmluZzJcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjb29yZGluYXRlcywgcHJvcGVydGllcyl7XG4gIGlmICghY29vcmRpbmF0ZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gY29vcmRpbmF0ZXMgcGFzc2VkJyk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gICAgXCJnZW9tZXRyeVwiOiB7XG4gICAgICBcInR5cGVcIjogXCJMaW5lU3RyaW5nXCIsXG4gICAgICBcImNvb3JkaW5hdGVzXCI6IGNvb3JkaW5hdGVzXG4gICAgfSxcbiAgICBcInByb3BlcnRpZXNcIjogcHJvcGVydGllcyB8fCB7fVxuICB9O1xufTtcbiIsInZhciBpbnNpZGUgPSByZXF1aXJlKCd0dXJmLWluc2lkZScpO1xuXG4vKipcbiAqIENhbGN1bGF0ZXMgdGhlIG1heGltdW0gdmFsdWUgb2YgYSBmaWVsZCBmb3IgYSBzZXQgb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyB3aXRoaW4gYSBzZXQgb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9tYXhcbiAqIEBjYXRlZ29yeSBhZ2dyZWdhdGlvblxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7c3RyaW5nfSBpbkZpZWxkIHRoZSBmaWVsZCBpbiBpbnB1dCBkYXRhIHRvIGFuYWx5emVcbiAqIEBwYXJhbSB7c3RyaW5nfSBvdXRGaWVsZCB0aGUgZmllbGQgaW4gd2hpY2ggdG8gc3RvcmUgcmVzdWx0c1xuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiB3aXRoIHByb3BlcnRpZXMgbGlzdGVkIGFzIGBvdXRGaWVsZGAgdmFsdWVzXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHlnb25zID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWzEwMS41NTE0MzcsIDMuMTUwMTE0XSxcbiAqICAgICAgICAgICBbMTAxLjU1MTQzNywgMy4yNTAyMDhdLFxuICogICAgICAgICAgIFsxMDEuNzQyMzI0LCAzLjI1MDIwOF0sXG4gKiAgICAgICAgICAgWzEwMS43NDIzMjQsIDMuMTUwMTE0XSxcbiAqICAgICAgICAgICBbMTAxLjU1MTQzNywgMy4xNTAxMTRdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFsxMDEuNjU5OTI3LCAzLjAxMTYxMl0sXG4gKiAgICAgICAgICAgWzEwMS42NTk5MjcsIDMuMTQzOTQ0XSxcbiAqICAgICAgICAgICBbMTAxLjkxMzk4NiwgMy4xNDM5NDRdLFxuICogICAgICAgICAgIFsxMDEuOTEzOTg2LCAzLjAxMTYxMl0sXG4gKiAgICAgICAgICAgWzEwMS42NTk5MjcsIDMuMDExNjEyXVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAxLjU2MTA1LCAzLjIxMzg3NF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwMS43MDkzNjUsIDMuMjExODE3XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTAxLjY0NTUwNywgMy4xNjkzMTFdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMDEuNzA4Njc5LCAzLjA3MTI2Nl1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMzAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEwMS44MjY3ODIsIDMuMDgxNTUxXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgYWdncmVnYXRlZCA9IHR1cmYubWF4KFxuICogICBwb2x5Z29ucywgcG9pbnRzLCAncG9wdWxhdGlvbicsICdtYXgnKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KFxuICogICBhZ2dyZWdhdGVkLmZlYXR1cmVzKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9seUZDLCBwdEZDLCBpbkZpZWxkLCBvdXRGaWVsZCl7XG4gIHBvbHlGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHBvbHkpe1xuICAgIGlmKCFwb2x5LnByb3BlcnRpZXMpe1xuICAgICAgcG9seS5wcm9wZXJ0aWVzID0ge307XG4gICAgfVxuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICBwdEZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocHQpe1xuICAgICAgaWYgKGluc2lkZShwdCwgcG9seSkpIHtcbiAgICAgICAgdmFsdWVzLnB1c2gocHQucHJvcGVydGllc1tpbkZpZWxkXSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcG9seS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IG1heCh2YWx1ZXMpO1xuICB9KTtcblxuICByZXR1cm4gcG9seUZDO1xufVxuXG5mdW5jdGlvbiBtYXgoeCkge1xuICAgIHZhciB2YWx1ZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgLy8gT24gdGhlIGZpcnN0IGl0ZXJhdGlvbiBvZiB0aGlzIGxvb3AsIG1heCBpc1xuICAgICAgICAvLyB1bmRlZmluZWQgYW5kIGlzIHRodXMgbWFkZSB0aGUgbWF4aW11bSBlbGVtZW50IGluIHRoZSBhcnJheVxuICAgICAgICBpZiAoeFtpXSA+IHZhbHVlIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0geFtpXTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuIiwidmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0aGUgbWVkaWFuIHZhbHVlIG9mIGEgZmllbGQgZm9yIGEgc2V0IG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXMgd2l0aGluIGEgc2V0IG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvbWVkaWFuXG4gKiBAY2F0ZWdvcnkgYWdncmVnYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAcGFyYW0ge3N0cmluZ30gaW5GaWVsZCB0aGUgZmllbGQgaW4gaW5wdXQgZGF0YSB0byBhbmFseXplXG4gKiBAcGFyYW0ge3N0cmluZ30gb3V0RmllbGQgdGhlIGZpZWxkIGluIHdoaWNoIHRvIHN0b3JlIHJlc3VsdHNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogd2l0aCBwcm9wZXJ0aWVzIGxpc3RlZCBhcyBgb3V0RmllbGRgIHZhbHVlc1xuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFsxOC40MDAwMzksIC0zMy45NzA2OTddLFxuICogICAgICAgICAgIFsxOC40MDAwMzksIC0zMy44MTg1MThdLFxuICogICAgICAgICAgIFsxOC42NjU3NzEsIC0zMy44MTg1MThdLFxuICogICAgICAgICAgIFsxOC42NjU3NzEsIC0zMy45NzA2OTddLFxuICogICAgICAgICAgIFsxOC40MDAwMzksIC0zMy45NzA2OTddXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFsxOC41Mzg3NDIsIC0zNC4wNTAzODNdLFxuICogICAgICAgICAgIFsxOC41Mzg3NDIsIC0zMy45ODcyMV0sXG4gKiAgICAgICAgICAgWzE4LjcwMzUzNiwgLTMzLjk4NzIxXSxcbiAqICAgICAgICAgICBbMTguNzAzNTM2LCAtMzQuMDUwMzgzXSxcbiAqICAgICAgICAgICBbMTguNTM4NzQyLCAtMzQuMDUwMzgzXVxuICogICAgICAgICBdXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqIHZhciBwb2ludHMgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW1xuICogICAgIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTguNTE0MDIyLCAtMzMuODYwMTUyXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA2MDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTguNDg5OTksIC0zMy45MjYyNjldXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDEwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxOC41ODMzNzQsIC0zMy45MDU3NTVdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxOC41OTE2MTMsIC0zNC4wMjQ3NzhdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDMwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxOC42NTM0MTEsIC0zNC4wMTc5NDldXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBtZWRpYW5zID0gdHVyZi5tZWRpYW4oXG4gKiAgcG9seWdvbnMsIHBvaW50cywgJ3BvcHVsYXRpb24nLCAnbWVkaWFuJyk7XG4gKlxuICogdmFyIHJlc3VsdEZlYXR1cmVzID0gcG9pbnRzLmZlYXR1cmVzLmNvbmNhdChcbiAqICAgbWVkaWFucy5mZWF0dXJlcyk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlGQywgcHRGQywgaW5GaWVsZCwgb3V0RmllbGQpe1xuICBwb2x5RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwb2x5KXtcbiAgICBpZighcG9seS5wcm9wZXJ0aWVzKXtcbiAgICAgIHBvbHkucHJvcGVydGllcyA9IHt9O1xuICAgIH1cbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgcHRGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHB0KXtcbiAgICAgIGlmIChpbnNpZGUocHQsIHBvbHkpKSB7XG4gICAgICAgIHZhbHVlcy5wdXNoKHB0LnByb3BlcnRpZXNbaW5GaWVsZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHBvbHkucHJvcGVydGllc1tvdXRGaWVsZF0gPSBtZWRpYW4odmFsdWVzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHBvbHlGQztcbn07XG5cbmZ1bmN0aW9uIG1lZGlhbih4KSB7XG4gICAgLy8gVGhlIG1lZGlhbiBvZiBhbiBlbXB0eSBsaXN0IGlzIG51bGxcbiAgICBpZiAoeC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgLy8gU29ydGluZyB0aGUgYXJyYXkgbWFrZXMgaXQgZWFzeSB0byBmaW5kIHRoZSBjZW50ZXIsIGJ1dFxuICAgIC8vIHVzZSBgLnNsaWNlKClgIHRvIGVuc3VyZSB0aGUgb3JpZ2luYWwgYXJyYXkgYHhgIGlzIG5vdCBtb2RpZmllZFxuICAgIHZhciBzb3J0ZWQgPSB4LnNsaWNlKCkuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSAtIGI7IH0pO1xuXG4gICAgLy8gSWYgdGhlIGxlbmd0aCBvZiB0aGUgbGlzdCBpcyBvZGQsIGl0J3MgdGhlIGNlbnRyYWwgbnVtYmVyXG4gICAgaWYgKHNvcnRlZC5sZW5ndGggJSAyID09PSAxKSB7XG4gICAgICAgIHJldHVybiBzb3J0ZWRbKHNvcnRlZC5sZW5ndGggLSAxKSAvIDJdO1xuICAgIC8vIE90aGVyd2lzZSwgdGhlIG1lZGlhbiBpcyB0aGUgYXZlcmFnZSBvZiB0aGUgdHdvIG51bWJlcnNcbiAgICAvLyBhdCB0aGUgY2VudGVyIG9mIHRoZSBsaXN0XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGEgPSBzb3J0ZWRbKHNvcnRlZC5sZW5ndGggLyAyKSAtIDFdO1xuICAgICAgICB2YXIgYiA9IHNvcnRlZFsoc29ydGVkLmxlbmd0aCAvIDIpXTtcbiAgICAgICAgcmV0dXJuIChhICsgYikgLyAyO1xuICAgIH1cbn1cbiIsInZhciBjbG9uZSA9IHJlcXVpcmUoJ2Nsb25lJyk7XG52YXIgdW5pb24gPSByZXF1aXJlKCd0dXJmLXVuaW9uJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259IG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcyBhbmQgcmV0dXJucyBhIHNpbmdsZSBtZXJnZWRcbiAqIHBvbHlnb24gZmVhdHVyZS4gSWYgdGhlIGlucHV0IFBvbHlnb24gZmVhdHVyZXMgYXJlIG5vdCBjb250aWd1b3VzLCB0aGlzIGZ1bmN0aW9uIHJldHVybnMgYSB7QGxpbmsgTXVsdGlQb2x5Z29ufSBmZWF0dXJlLlxuICogQG1vZHVsZSB0dXJmL21lcmdlXG4gKiBAY2F0ZWdvcnkgdHJhbnNmb3JtYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IGZjIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcmV0dXJuIHtGZWF0dXJlfSBhIHtAbGluayBQb2x5Z29ufSBvciB7QGxpbmsgTXVsdGlQb2x5Z29ufSBmZWF0dXJlXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHlnb25zID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcImZpbGxcIjogXCIjMGYwXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWzkuOTk0ODEyLCA1My41NDk0ODddLFxuICogICAgICAgICAgIFsxMC4wNDY5OTcsIDUzLjU5ODIwOV0sXG4gKiAgICAgICAgICAgWzEwLjExNzcyMSwgNTMuNTMxNzM3XSxcbiAqICAgICAgICAgICBbOS45OTQ4MTIsIDUzLjU0OTQ4N11cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcImZpbGxcIjogXCIjMDBmXCJcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWzEwLjAwMDk5MSwgNTMuNTA0MThdLFxuICogICAgICAgICAgIFsxMC4wMzgwNywgNTMuNTYyNTM5XSxcbiAqICAgICAgICAgICBbOS45MjY4MzQsIDUzLjU1MTczMV0sXG4gKiAgICAgICAgICAgWzEwLjAwMDk5MSwgNTMuNTA0MThdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBtZXJnZWQgPSB0dXJmLm1lcmdlKHBvbHlnb25zKTtcbiAqXG4gKiAvLz1wb2x5Z29uc1xuICpcbiAqIC8vPW1lcmdlZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHlnb25zLCBkb25lKXtcblxuICB2YXIgbWVyZ2VkID0gY2xvbmUocG9seWdvbnMuZmVhdHVyZXNbMF0pLFxuICAgIGZlYXR1cmVzID0gcG9seWdvbnMuZmVhdHVyZXM7XG5cbiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGZlYXR1cmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgdmFyIHBvbHkgPSBmZWF0dXJlc1tpXTtcblxuICAgIGlmKHBvbHkuZ2VvbWV0cnkpe1xuICAgICAgbWVyZ2VkID0gdW5pb24obWVyZ2VkLCBwb2x5KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWVyZ2VkO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gb2JqZWN0VG9TdHJpbmcobykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pO1xufVxuXG4vLyBzaGltIGZvciBOb2RlJ3MgJ3V0aWwnIHBhY2thZ2Vcbi8vIERPIE5PVCBSRU1PVkUgVEhJUyEgSXQgaXMgcmVxdWlyZWQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBFbmRlckpTIChodHRwOi8vZW5kZXJqcy5jb20vKS5cbnZhciB1dGlsID0ge1xuICBpc0FycmF5OiBmdW5jdGlvbiAoYXIpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShhcikgfHwgKHR5cGVvZiBhciA9PT0gJ29iamVjdCcgJiYgb2JqZWN0VG9TdHJpbmcoYXIpID09PSAnW29iamVjdCBBcnJheV0nKTtcbiAgfSxcbiAgaXNEYXRlOiBmdW5jdGlvbiAoZCkge1xuICAgIHJldHVybiB0eXBlb2YgZCA9PT0gJ29iamVjdCcgJiYgb2JqZWN0VG9TdHJpbmcoZCkgPT09ICdbb2JqZWN0IERhdGVdJztcbiAgfSxcbiAgaXNSZWdFeHA6IGZ1bmN0aW9uIChyZSkge1xuICAgIHJldHVybiB0eXBlb2YgcmUgPT09ICdvYmplY3QnICYmIG9iamVjdFRvU3RyaW5nKHJlKSA9PT0gJ1tvYmplY3QgUmVnRXhwXSc7XG4gIH0sXG4gIGdldFJlZ0V4cEZsYWdzOiBmdW5jdGlvbiAocmUpIHtcbiAgICB2YXIgZmxhZ3MgPSAnJztcbiAgICByZS5nbG9iYWwgJiYgKGZsYWdzICs9ICdnJyk7XG4gICAgcmUuaWdub3JlQ2FzZSAmJiAoZmxhZ3MgKz0gJ2knKTtcbiAgICByZS5tdWx0aWxpbmUgJiYgKGZsYWdzICs9ICdtJyk7XG4gICAgcmV0dXJuIGZsYWdzO1xuICB9XG59O1xuXG5cbmlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JylcbiAgbW9kdWxlLmV4cG9ydHMgPSBjbG9uZTtcblxuLyoqXG4gKiBDbG9uZXMgKGNvcGllcykgYW4gT2JqZWN0IHVzaW5nIGRlZXAgY29weWluZy5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIHN1cHBvcnRzIGNpcmN1bGFyIHJlZmVyZW5jZXMgYnkgZGVmYXVsdCwgYnV0IGlmIHlvdSBhcmUgY2VydGFpblxuICogdGhlcmUgYXJlIG5vIGNpcmN1bGFyIHJlZmVyZW5jZXMgaW4geW91ciBvYmplY3QsIHlvdSBjYW4gc2F2ZSBzb21lIENQVSB0aW1lXG4gKiBieSBjYWxsaW5nIGNsb25lKG9iaiwgZmFsc2UpLlxuICpcbiAqIENhdXRpb246IGlmIGBjaXJjdWxhcmAgaXMgZmFsc2UgYW5kIGBwYXJlbnRgIGNvbnRhaW5zIGNpcmN1bGFyIHJlZmVyZW5jZXMsXG4gKiB5b3VyIHByb2dyYW0gbWF5IGVudGVyIGFuIGluZmluaXRlIGxvb3AgYW5kIGNyYXNoLlxuICpcbiAqIEBwYXJhbSBgcGFyZW50YCAtIHRoZSBvYmplY3QgdG8gYmUgY2xvbmVkXG4gKiBAcGFyYW0gYGNpcmN1bGFyYCAtIHNldCB0byB0cnVlIGlmIHRoZSBvYmplY3QgdG8gYmUgY2xvbmVkIG1heSBjb250YWluXG4gKiAgICBjaXJjdWxhciByZWZlcmVuY2VzLiAob3B0aW9uYWwgLSB0cnVlIGJ5IGRlZmF1bHQpXG4gKiBAcGFyYW0gYGRlcHRoYCAtIHNldCB0byBhIG51bWJlciBpZiB0aGUgb2JqZWN0IGlzIG9ubHkgdG8gYmUgY2xvbmVkIHRvXG4gKiAgICBhIHBhcnRpY3VsYXIgZGVwdGguIChvcHRpb25hbCAtIGRlZmF1bHRzIHRvIEluZmluaXR5KVxuICogQHBhcmFtIGBwcm90b3R5cGVgIC0gc2V0cyB0aGUgcHJvdG90eXBlIHRvIGJlIHVzZWQgd2hlbiBjbG9uaW5nIGFuIG9iamVjdC5cbiAqICAgIChvcHRpb25hbCAtIGRlZmF1bHRzIHRvIHBhcmVudCBwcm90b3R5cGUpLlxuKi9cblxuZnVuY3Rpb24gY2xvbmUocGFyZW50LCBjaXJjdWxhciwgZGVwdGgsIHByb3RvdHlwZSkge1xuICAvLyBtYWludGFpbiB0d28gYXJyYXlzIGZvciBjaXJjdWxhciByZWZlcmVuY2VzLCB3aGVyZSBjb3JyZXNwb25kaW5nIHBhcmVudHNcbiAgLy8gYW5kIGNoaWxkcmVuIGhhdmUgdGhlIHNhbWUgaW5kZXhcbiAgdmFyIGFsbFBhcmVudHMgPSBbXTtcbiAgdmFyIGFsbENoaWxkcmVuID0gW107XG5cbiAgdmFyIHVzZUJ1ZmZlciA9IHR5cGVvZiBCdWZmZXIgIT0gJ3VuZGVmaW5lZCc7XG5cbiAgaWYgKHR5cGVvZiBjaXJjdWxhciA9PSAndW5kZWZpbmVkJylcbiAgICBjaXJjdWxhciA9IHRydWU7XG5cbiAgaWYgKHR5cGVvZiBkZXB0aCA9PSAndW5kZWZpbmVkJylcbiAgICBkZXB0aCA9IEluZmluaXR5O1xuXG4gIC8vIHJlY3Vyc2UgdGhpcyBmdW5jdGlvbiBzbyB3ZSBkb24ndCByZXNldCBhbGxQYXJlbnRzIGFuZCBhbGxDaGlsZHJlblxuICBmdW5jdGlvbiBfY2xvbmUocGFyZW50LCBkZXB0aCkge1xuICAgIC8vIGNsb25pbmcgbnVsbCBhbHdheXMgcmV0dXJucyBudWxsXG4gICAgaWYgKHBhcmVudCA9PT0gbnVsbClcbiAgICAgIHJldHVybiBudWxsO1xuXG4gICAgaWYgKGRlcHRoID09IDApXG4gICAgICByZXR1cm4gcGFyZW50O1xuXG4gICAgdmFyIGNoaWxkO1xuICAgIHZhciBwcm90bztcbiAgICBpZiAodHlwZW9mIHBhcmVudCAhPSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIHBhcmVudDtcbiAgICB9XG5cbiAgICBpZiAodXRpbC5pc0FycmF5KHBhcmVudCkpIHtcbiAgICAgIGNoaWxkID0gW107XG4gICAgfSBlbHNlIGlmICh1dGlsLmlzUmVnRXhwKHBhcmVudCkpIHtcbiAgICAgIGNoaWxkID0gbmV3IFJlZ0V4cChwYXJlbnQuc291cmNlLCB1dGlsLmdldFJlZ0V4cEZsYWdzKHBhcmVudCkpO1xuICAgICAgaWYgKHBhcmVudC5sYXN0SW5kZXgpIGNoaWxkLmxhc3RJbmRleCA9IHBhcmVudC5sYXN0SW5kZXg7XG4gICAgfSBlbHNlIGlmICh1dGlsLmlzRGF0ZShwYXJlbnQpKSB7XG4gICAgICBjaGlsZCA9IG5ldyBEYXRlKHBhcmVudC5nZXRUaW1lKCkpO1xuICAgIH0gZWxzZSBpZiAodXNlQnVmZmVyICYmIEJ1ZmZlci5pc0J1ZmZlcihwYXJlbnQpKSB7XG4gICAgICBjaGlsZCA9IG5ldyBCdWZmZXIocGFyZW50Lmxlbmd0aCk7XG4gICAgICBwYXJlbnQuY29weShjaGlsZCk7XG4gICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0eXBlb2YgcHJvdG90eXBlID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHBhcmVudCk7XG4gICAgICAgIGNoaWxkID0gT2JqZWN0LmNyZWF0ZShwcm90byk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgY2hpbGQgPSBPYmplY3QuY3JlYXRlKHByb3RvdHlwZSk7XG4gICAgICAgIHByb3RvID0gcHJvdG90eXBlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjaXJjdWxhcikge1xuICAgICAgdmFyIGluZGV4ID0gYWxsUGFyZW50cy5pbmRleE9mKHBhcmVudCk7XG5cbiAgICAgIGlmIChpbmRleCAhPSAtMSkge1xuICAgICAgICByZXR1cm4gYWxsQ2hpbGRyZW5baW5kZXhdO1xuICAgICAgfVxuICAgICAgYWxsUGFyZW50cy5wdXNoKHBhcmVudCk7XG4gICAgICBhbGxDaGlsZHJlbi5wdXNoKGNoaWxkKTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBpIGluIHBhcmVudCkge1xuICAgICAgdmFyIGF0dHJzO1xuICAgICAgaWYgKHByb3RvKSB7XG4gICAgICAgIGF0dHJzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwcm90bywgaSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChhdHRycyAmJiBhdHRycy5zZXQgPT0gbnVsbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGNoaWxkW2ldID0gX2Nsb25lKHBhcmVudFtpXSwgZGVwdGggLSAxKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2hpbGQ7XG4gIH1cblxuICByZXR1cm4gX2Nsb25lKHBhcmVudCwgZGVwdGgpO1xufVxuXG4vKipcbiAqIFNpbXBsZSBmbGF0IGNsb25lIHVzaW5nIHByb3RvdHlwZSwgYWNjZXB0cyBvbmx5IG9iamVjdHMsIHVzZWZ1bGwgZm9yIHByb3BlcnR5XG4gKiBvdmVycmlkZSBvbiBGTEFUIGNvbmZpZ3VyYXRpb24gb2JqZWN0IChubyBuZXN0ZWQgcHJvcHMpLlxuICpcbiAqIFVTRSBXSVRIIENBVVRJT04hIFRoaXMgbWF5IG5vdCBiZWhhdmUgYXMgeW91IHdpc2ggaWYgeW91IGRvIG5vdCBrbm93IGhvdyB0aGlzXG4gKiB3b3Jrcy5cbiAqL1xuY2xvbmUuY2xvbmVQcm90b3R5cGUgPSBmdW5jdGlvbihwYXJlbnQpIHtcbiAgaWYgKHBhcmVudCA9PT0gbnVsbClcbiAgICByZXR1cm4gbnVsbDtcblxuICB2YXIgYyA9IGZ1bmN0aW9uICgpIHt9O1xuICBjLnByb3RvdHlwZSA9IHBhcmVudDtcbiAgcmV0dXJuIG5ldyBjKCk7XG59O1xuIiwiLy8gaHR0cDovL2NzLnNlbHUuZWR1L35yYnlyZC9tYXRoL21pZHBvaW50L1xuLy8gKCh4MSt4MikvMiksICgoeTEreTIpLzIpXG52YXIgcG9pbnQgPSByZXF1aXJlKCd0dXJmLXBvaW50Jyk7XG5cbi8qKlxuICogVGFrZXMgdHdvIHtAbGluayBQb2ludH0gZmVhdHVyZXMgYW5kIHJldHVybnMgYSBQb2ludCBtaWR3YXkgYmV0d2VlbiB0aGUgdHdvLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9taWRwb2ludFxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge1BvaW50fSBwdDEgZmlyc3QgcG9pbnRcbiAqIEBwYXJhbSB7UG9pbnR9IHB0MiBzZWNvbmQgcG9pbnRcbiAqIEByZXR1cm4ge1BvaW50fSBhIHBvaW50IGJldHdlZW4gdGhlIHR3b1xuICogQGV4YW1wbGVcbiAqIHZhciBwdDEgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogWzE0NC44MzQ4MjMsIC0zNy43NzEyNTddXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcHQyID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFsxNDUuMTQyNDQsIC0zNy44MzA5MzddXG4gKiAgIH1cbiAqIH07XG4gKlxuICogdmFyIG1pZHBvaW50ZWQgPSB0dXJmLm1pZHBvaW50KHB0MSwgcHQyKTtcbiAqIG1pZHBvaW50ZWQucHJvcGVydGllc1snbWFya2VyLWNvbG9yJ10gPSAnI2YwMCc7XG4gKlxuICpcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogW3B0MSwgcHQyLCBtaWRwb2ludGVkXVxuICogfTtcbiAqXG4gKiAvLz1yZXN1bHRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2ludDEsIHBvaW50Mikge1xuICBpZiAocG9pbnQxID09PSBudWxsIHx8IHBvaW50MiA9PT0gbnVsbCl7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdMZXNzIHRoYW4gdHdvIHBvaW50cyBwYXNzZWQuJyk7XG4gIH1cblxuICB2YXIgeDEgPSBwb2ludDEuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF07XG4gIHZhciB4MiA9IHBvaW50Mi5nZW9tZXRyeS5jb29yZGluYXRlc1swXTtcbiAgdmFyIHkxID0gcG9pbnQxLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdO1xuICB2YXIgeTIgPSBwb2ludDIuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV07XG5cbiAgdmFyIHgzID0geDEgKyB4MjtcbiAgdmFyIG1pZFggPSB4My8yO1xuICB2YXIgeTMgPSB5MSArIHkyO1xuICB2YXIgbWlkWSA9IHkzLzI7XG5cbiAgcmV0dXJuIHBvaW50KFttaWRYLCBtaWRZXSk7XG59O1xuIiwidmFyIGluc2lkZSA9IHJlcXVpcmUoJ3R1cmYtaW5zaWRlJyk7XG5cbi8qKlxuKiBDYWxjdWxhdGVzIHRoZSBtaW5pbXVtIHZhbHVlIG9mIGEgZmllbGQgZm9yIHtAbGluayBQb2ludH0gZmVhdHVyZXMgd2l0aGluIGEgc2V0IG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlcy5cbipcbiogQG1vZHVsZSB0dXJmL21pblxuKiBAY2F0ZWdvcnkgYWdncmVnYXRpb25cbiogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuKiBAcGFyYW0ge3N0cmluZ30gaW5GaWVsZCB0aGUgZmllbGQgaW4gaW5wdXQgZGF0YSB0byBhbmFseXplXG4qIEBwYXJhbSB7c3RyaW5nfSBvdXRGaWVsZCB0aGUgZmllbGQgaW4gd2hpY2ggdG8gc3RvcmUgcmVzdWx0c1xuKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiogd2l0aCBwcm9wZXJ0aWVzIGxpc3RlZCBhcyBgb3V0RmllbGRgIHZhbHVlc1xuKiBAZXhhbXBsZVxuKiB2YXIgcG9seWdvbnMgPSB7XG4qICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiogICBcImZlYXR1cmVzXCI6IFtcbiogICAgIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4qICAgICAgICAgICBbNzIuODA5NjU4LCAxOC45NjE4MThdLFxuKiAgICAgICAgICAgWzcyLjgwOTY1OCwgMTguOTc0ODA1XSxcbiogICAgICAgICAgIFs3Mi44MjcxNjcsIDE4Ljk3NDgwNV0sXG4qICAgICAgICAgICBbNzIuODI3MTY3LCAxOC45NjE4MThdLFxuKiAgICAgICAgICAgWzcyLjgwOTY1OCwgMTguOTYxODE4XVxuKiAgICAgICAgIF1dXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4qICAgICAgICAgICBbNzIuODIwOTg3LCAxOC45NDcwNDNdLFxuKiAgICAgICAgICAgWzcyLjgyMDk4NywgMTguOTU5MjJdLFxuKiAgICAgICAgICAgWzcyLjg0MTI0MywgMTguOTU5MjJdLFxuKiAgICAgICAgICAgWzcyLjg0MTI0MywgMTguOTQ3MDQzXSxcbiogICAgICAgICAgIFs3Mi44MjA5ODcsIDE4Ljk0NzA0M11cbiogICAgICAgICBdXVxuKiAgICAgICB9XG4qICAgICB9XG4qICAgXVxuKiB9O1xuKiB2YXIgcG9pbnRzID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4qICAgXCJmZWF0dXJlc1wiOiBbXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbNzIuODE0NDY0LCAxOC45NzEzOTZdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA2MDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFs3Mi44MjAwNDMsIDE4Ljk2OTc3Ml1cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDEwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzcyLjgxNzI5NiwgMTguOTY0MjUzXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbNzIuODM1NzUsIDE4Ljk1NDgzN11cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDMwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzcyLjgyODE5NywgMTguOTUwOTRdXG4qICAgICAgIH1cbiogICAgIH1cbiogICBdXG4qIH07XG4qXG4qIHZhciBtaW5pbXVtcyA9IHR1cmYubWluKFxuKiAgIHBvbHlnb25zLCBwb2ludHMsICdwb3B1bGF0aW9uJywgJ21pbicpO1xuKlxuKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KFxuKiAgIG1pbmltdW1zLmZlYXR1cmVzKTtcbiogdmFyIHJlc3VsdCA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiogfTtcbipcbiogLy89cmVzdWx0XG4qL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2x5RkMsIHB0RkMsIGluRmllbGQsIG91dEZpZWxkKXtcbiAgcG9seUZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocG9seSl7XG4gICAgaWYoIXBvbHkucHJvcGVydGllcyl7XG4gICAgICBwb2x5LnByb3BlcnRpZXMgPSB7fTtcbiAgICB9XG4gICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgIHB0RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwdCl7XG4gICAgICBpZiAoaW5zaWRlKHB0LCBwb2x5KSkge1xuICAgICAgICB2YWx1ZXMucHVzaChwdC5wcm9wZXJ0aWVzW2luRmllbGRdKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBwb2x5LnByb3BlcnRpZXNbb3V0RmllbGRdID0gbWluKHZhbHVlcyk7XG4gIH0pO1xuXG4gIHJldHVybiBwb2x5RkM7XG59O1xuXG5mdW5jdGlvbiBtaW4oeCkge1xuICAgIHZhciB2YWx1ZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgLy8gT24gdGhlIGZpcnN0IGl0ZXJhdGlvbiBvZiB0aGlzIGxvb3AsIG1pbiBpc1xuICAgICAgICAvLyB1bmRlZmluZWQgYW5kIGlzIHRodXMgbWFkZSB0aGUgbWluaW11bSBlbGVtZW50IGluIHRoZSBhcnJheVxuICAgICAgICBpZiAoeFtpXSA8IHZhbHVlIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0geFtpXTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuIiwidmFyIGRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIFBvaW50fSBmZWF0dXJlIGFuZCBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2YgUG9pbnQgZmVhdHVyZXMgYW5kIHJldHVybnMgdGhlIFBvaW50IGZlYXR1cmUgZnJvbSB0aGUgRmVhdHVyZUNvbGxlY3Rpb24gY2xvc2VzdCB0byB0aGUgaW5wdXQgcG9pbnQuXG4gKlxuICogQG1vZHVsZSB0dXJmL25lYXJlc3RcbiAqIEBjYXRlZ29yeSBjbGFzc2lmaWNhdGlvblxuICogQHBhcmFtIHtQb2ludH0gcG9pbnQgdGhlIHJlZmVyZW5jZSBwb2ludFxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gYWdhaW5zdCBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIFBvaW50IGZlYXR1cmVzXG4gKiBAcmV0dXJuIHtGZWF0dXJlfSB0aGUgY2xvc2VzdCBQb2ludCBmZWF0dXJlIGluIGBhZ2FpbnN0YCB0byBgcG9pbnRgXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvaW50ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgXCJtYXJrZXItY29sb3JcIjogXCIjMGYwXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFsyOC45NjU3OTcsIDQxLjAxMDA4Nl1cbiAqICAgfVxuICogfTtcbiAqIHZhciBhZ2FpbnN0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMjguOTczODY1LCA0MS4wMTExMjJdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzI4Ljk0ODQ1OSwgNDEuMDI0MjA0XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsyOC45Mzg2NzQsIDQxLjAxMzMyNF1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogdmFyIG5lYXJlc3QgPSB0dXJmLm5lYXJlc3QocG9pbnQsIGFnYWluc3QpO1xuICogbmVhcmVzdC5wcm9wZXJ0aWVzWydtYXJrZXItY29sb3InXSA9ICcjZjAwJztcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBhZ2FpbnN0LmZlYXR1cmVzLmNvbmNhdChwb2ludCk7XG4gKiB2YXIgcmVzdWx0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldFBvaW50LCBwb2ludHMpe1xuICB2YXIgbmVhcmVzdFBvaW50O1xuICB2YXIgY291bnQgPSAwO1xuICB2YXIgZGlzdCA9IEluZmluaXR5O1xuICBwb2ludHMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwdCl7XG4gICAgaWYoIW5lYXJlc3RQb2ludCl7XG4gICAgICBuZWFyZXN0UG9pbnQgPSBwdDtcbiAgICAgIHZhciBkaXN0ID0gZGlzdGFuY2UodGFyZ2V0UG9pbnQsIHB0LCAnbWlsZXMnKTtcbiAgICAgIG5lYXJlc3RQb2ludC5wcm9wZXJ0aWVzLmRpc3RhbmNlID0gZGlzdDtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHZhciBkaXN0ID0gZGlzdGFuY2UodGFyZ2V0UG9pbnQsIHB0LCAnbWlsZXMnKTtcbiAgICAgIGlmKGRpc3QgPCBuZWFyZXN0UG9pbnQucHJvcGVydGllcy5kaXN0YW5jZSl7XG4gICAgICAgIG5lYXJlc3RQb2ludCA9IHB0O1xuICAgICAgICBuZWFyZXN0UG9pbnQucHJvcGVydGllcy5kaXN0YW5jZSA9IGRpc3Q7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgZGVsZXRlIG5lYXJlc3RQb2ludC5wcm9wZXJ0aWVzLmRpc3RhbmNlO1xuICByZXR1cm4gbmVhcmVzdFBvaW50O1xufVxuIiwiLyoqXG4gKiBUYWtlcyBhIHRyaWFuZ3VsYXIgcGxhbmUgYXMgYSB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZVxuICogYW5kIGEge0BsaW5rIFBvaW50fSBmZWF0dXJlIHdpdGhpbiB0aGF0IHRyaWFuZ2xlIGFuZCByZXR1cm5zIHRoZSB6LXZhbHVlXG4gKiBhdCB0aGF0IHBvaW50LiBUaGUgUG9seWdvbiBuZWVkcyB0byBoYXZlIHByb3BlcnRpZXMgYGFgLCBgYmAsIGFuZCBgY2BcbiAqIHRoYXQgZGVmaW5lIHRoZSB2YWx1ZXMgYXQgaXRzIHRocmVlIGNvcm5lcnMuXG4gKlxuICogQG1vZHVsZSB0dXJmL3BsYW5lcG9pbnRcbiAqIEBjYXRlZ29yeSBpbnRlcnBvbGF0aW9uXG4gKiBAcGFyYW0ge1BvaW50fSBpbnRlcnBvbGF0ZWRQb2ludCB0aGUgUG9pbnQgZm9yIHdoaWNoIGEgei12YWx1ZSB3aWxsIGJlIGNhbGN1bGF0ZWRcbiAqIEBwYXJhbSB7UG9seWdvbn0gdHJpYW5nbGUgYSBQb2x5Z29uIGZlYXR1cmUgd2l0aCB0aHJlZSB2ZXJ0aWNlc1xuICogQHJldHVybiB7bnVtYmVyfSB0aGUgei12YWx1ZSBmb3IgYGludGVycG9sYXRlZFBvaW50YFxuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbLTc1LjMyMjEsIDM5LjUyOV1cbiAqICAgfVxuICogfTtcbiAqIHZhciBwb2ludCA9IHR1cmYucG9pbnQoWy03NS4zMjIxLCAzOS41MjldKTtcbiAqIC8vIHRyaWFuZ2xlIGlzIGEgcG9seWdvbiB3aXRoIFwiYVwiLCBcImJcIixcbiAqIC8vIGFuZCBcImNcIiB2YWx1ZXMgcmVwcmVzZW50aW5nXG4gKiAvLyB0aGUgdmFsdWVzIG9mIHRoZSBjb29yZGluYXRlcyBpbiBvcmRlci5cbiAqIHZhciB0cmlhbmdsZSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwiYVwiOiAxMSxcbiAqICAgICBcImJcIjogMTIyLFxuICogICAgIFwiY1wiOiA0NFxuICogICB9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWy03NS4xMjIxLCAzOS41N10sXG4gKiAgICAgICBbLTc1LjU4LCAzOS4xOF0sXG4gKiAgICAgICBbLTc1Ljk3LCAzOS44Nl0sXG4gKiAgICAgICBbLTc1LjEyMjEsIDM5LjU3XVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG4gKlxuICogdmFyIGZlYXR1cmVzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFt0cmlhbmdsZSwgcG9pbnRdXG4gKiB9O1xuICpcbiAqIHZhciB6VmFsdWUgPSB0dXJmLnBsYW5lcG9pbnQocG9pbnQsIHRyaWFuZ2xlKTtcbiAqXG4gKiAvLz1mZWF0dXJlc1xuICpcbiAqIC8vPXpWYWx1ZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvaW50LCB0cmlhbmdsZSl7XG4gIHZhciB4ID0gcG9pbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICB5ID0gcG9pbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICB4MSA9IHRyaWFuZ2xlLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdWzBdWzBdLFxuICAgICAgeTEgPSB0cmlhbmdsZS5nZW9tZXRyeS5jb29yZGluYXRlc1swXVswXVsxXSxcbiAgICAgIHoxID0gdHJpYW5nbGUucHJvcGVydGllcy5hLFxuICAgICAgeDIgPSB0cmlhbmdsZS5nZW9tZXRyeS5jb29yZGluYXRlc1swXVsxXVswXSxcbiAgICAgIHkyID0gdHJpYW5nbGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF1bMV1bMV0sXG4gICAgICB6MiA9IHRyaWFuZ2xlLnByb3BlcnRpZXMuYixcbiAgICAgIHgzID0gdHJpYW5nbGUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF1bMl1bMF0sXG4gICAgICB5MyA9IHRyaWFuZ2xlLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdWzJdWzFdLFxuICAgICAgejMgPSB0cmlhbmdsZS5wcm9wZXJ0aWVzLmM7XG5cbiAgdmFyIHogPSAoejMgKiAoeC14MSkgKiAoeS15MikgKyB6MSAqICh4LXgyKSAqICh5LXkzKSArIHoyICogKHgteDMpICogKHkteTEpIC1cbiAgICAgIHoyICogKHgteDEpICogKHkteTMpIC0gejMgKiAoeC14MikgKiAoeS15MSkgLSB6MSAqICh4LXgzKSAqICh5LXkyKSkgL1xuICAgICAgKCh4LXgxKSAqICh5LXkyKSArICh4LXgyKSAqICh5LXkzKSArKHgteDMpICogKHkteTEpIC1cbiAgICAgICAoeC14MSkgKiAoeS15MykgLSAoeC14MikgKiAoeS15MSkgLSAoeC14MykgKiAoeS15MikpO1xuXG4gIHJldHVybiB6O1xufTtcbiIsInZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcbnZhciBmZWF0dXJlY29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcbi8qKlxuICogVGFrZXMgYSBib3VuZGluZyBib3ggYW5kIGEgY2VsbCBkZXB0aCBhbmQgcmV0dXJucyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyBpbiBhIGdyaWQuXG4gKlxuICogQG1vZHVsZSB0dXJmL3BvaW50LWdyaWRcbiAqIEBjYXRlZ29yeSBpbnRlcnBvbGF0aW9uXG4gKiBAcGFyYW0ge0FycmF5PG51bWJlcj59IGV4dGVudCBleHRlbnQgaW4gW21pblgsIG1pblksIG1heFgsIG1heFldIG9yZGVyXG4gKiBAcGFyYW0ge051bWJlcn0gZGVwdGggaG93IG1hbnkgY2VsbHMgdG8gb3V0cHV0XG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gZ3JpZCBhcyBGZWF0dXJlQ29sbGVjdGlvbiB3aXRoIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgZXh0ZW50ID0gWy03MC44MjMzNjQsIC0zMy41NTM5ODQsIC03MC40NzMxNzUsIC0zMy4zMDI5ODZdO1xuICogdmFyIGRlcHRoID0gMTA7XG4gKlxuICogdmFyIGdyaWQgPSB0dXJmLnBvaW50R3JpZChleHRlbnQsIGRlcHRoKTtcbiAqXG4gKiAvLz1ncmlkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGJib3gsIGNlbGwsIHVuaXRzKSB7XG4gIHZhciBmYyA9IGZlYXR1cmVjb2xsZWN0aW9uKFtdKTtcbiAgdmFyIHhGcmFjdGlvbiA9IGNlbGwgLyAoZGlzdGFuY2UocG9pbnQoW2Jib3hbMF0sIGJib3hbMV1dKSwgcG9pbnQoW2Jib3hbMl0sIGJib3hbMV1dKSwgdW5pdHMpKTtcbiAgdmFyIGNlbGxXaWR0aCA9IHhGcmFjdGlvbiAqIChiYm94WzJdIC0gYmJveFswXSk7XG4gIHZhciB5RnJhY3Rpb24gPSBjZWxsIC8gKGRpc3RhbmNlKHBvaW50KFtiYm94WzBdLCBiYm94WzFdXSksIHBvaW50KFtiYm94WzBdLCBiYm94WzNdXSksIHVuaXRzKSk7XG4gIHZhciBjZWxsSGVpZ2h0ID0geUZyYWN0aW9uICogKGJib3hbM10gLSBiYm94WzFdKTtcblxuICB2YXIgY3VycmVudFggPSBiYm94WzBdO1xuICB3aGlsZSAoY3VycmVudFggPD0gYmJveFsyXSkge1xuICAgIHZhciBjdXJyZW50WSA9IGJib3hbMV07XG4gICAgd2hpbGUgKGN1cnJlbnRZIDw9IGJib3hbM10pIHtcbiAgICAgIGZjLmZlYXR1cmVzLnB1c2gocG9pbnQoW2N1cnJlbnRYLCBjdXJyZW50WV0pKTtcblxuICAgICAgY3VycmVudFkgKz0gY2VsbEhlaWdodDtcbiAgICB9XG4gICAgY3VycmVudFggKz0gY2VsbFdpZHRoO1xuICB9XG4gIFxuICByZXR1cm4gZmM7XG59IiwidmFyIGRpc3RhbmNlID0gcmVxdWlyZSgndHVyZi1kaXN0YW5jZScpO1xudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xudmFyIGxpbmVzdHJpbmcgPSByZXF1aXJlKCd0dXJmLWxpbmVzdHJpbmcnKTtcbnZhciBiZWFyaW5nID0gcmVxdWlyZSgndHVyZi1iZWFyaW5nJyk7XG52YXIgZGVzdGluYXRpb24gPSByZXF1aXJlKCd0dXJmLWRlc3RpbmF0aW9uJyk7XG5cbi8qKlxuICogVGFrZXMgYSBQb2ludCBhbmQgYSBMaW5lU3RyaW5nIGFuZCBjYWxjdWxhdGVzIHRoZSBjbG9zZXN0IFBvaW50IG9uIHRoZSBMaW5lU3RyaW5nXG4gKlxuICogQG1vZHVsZSB0dXJmL3BvaW50LW9uLWxpbmVcbiAqXG4gKiBAcGFyYW0ge0xpbmVTdHJpbmd9IExpbmUgdG8gc25hcCB0b1xuICogQHBhcmFtIHtQb2ludH0gUG9pbnQgdG8gc25hcCBmcm9tXG4gKiBAcmV0dXJuIHtQb2ludH0gQ2xvc2VzdCBQb2ludCBvbiB0aGUgTGluZVxuICogQGV4YW1wbGVcbiAqIHZhciBsaW5lID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiTGluZVN0cmluZ1wiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1xuICogICAgICAgWy03Ny4wMzE2NjksIDM4Ljg3ODYwNV0sXG4gKiAgICAgICBbLTc3LjAyOTYwOSwgMzguODgxOTQ2XSxcbiAqICAgICAgIFstNzcuMDIwMzM5LCAzOC44ODQwODRdLFxuICogICAgICAgWy03Ny4wMjU2NjEsIDM4Ljg4NTgyMV0sXG4gKiAgICAgICBbLTc3LjAyMTg4NCwgMzguODg5NTYzXSxcbiAqICAgICAgIFstNzcuMDE5ODI0LCAzOC44OTIzNjhdXG4gKiAgICAgXVxuICogICB9XG4gKiB9O1xuICogdmFyIHB0ID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICBcImNvb3JkaW5hdGVzXCI6IFstNzcuMDM3MDc2LCAzOC44ODQwMTddXG4gKiAgIH1cbiAqIH07XG4gKiBcbiAqIHZhciBzbmFwcGVkID0gdHVyZi5wb2ludE9uTGluZShsaW5lLCBwdCk7XG4gKiBzbmFwcGVkLnByb3BlcnRpZXNbJ21hcmtlci1jb2xvciddID0gJyMwMGYnXG4gKlxuICogdmFyIHJlc3VsdCA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbbGluZSwgcHQsIHNuYXBwZWRdXG4gKiB9O1xuICpcbiAqIC8vPXJlc3VsdFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGxpbmUsIHB0KSB7ICBcbiAgdmFyIGNvb3JkcztcbiAgaWYobGluZS50eXBlID09PSAnRmVhdHVyZScpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgaWYobGluZS50eXBlID09PSAnTGluZVN0cmluZycpIGNvb3JkcyA9IGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7XG4gIGVsc2UgdGhyb3cgbmV3IEVycm9yKCdpbnB1dCBtdXN0IGJlIGEgTGluZVN0cmluZyBGZWF0dXJlIG9yIEdlb21ldHJ5Jyk7XG5cbiAgcmV0dXJuIHBvaW50T25MaW5lKHB0LCBjb29yZHMpO1xufVxuXG5mdW5jdGlvbiBwb2ludE9uTGluZSAocHQsIGNvb3Jkcykge1xuICB2YXIgdW5pdHMgPSAnbWlsZXMnXG4gIHZhciBjbG9zZXN0UHQgPSBwb2ludChbSW5maW5pdHksIEluZmluaXR5XSwge2Rpc3Q6IEluZmluaXR5fSk7XG4gIGZvcih2YXIgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgdmFyIHN0YXJ0ID0gcG9pbnQoY29vcmRzW2ldKVxuICAgIHZhciBzdG9wID0gcG9pbnQoY29vcmRzW2krMV0pXG4gICAgLy9zdGFydFxuICAgIHN0YXJ0LnByb3BlcnRpZXMuZGlzdCA9IGRpc3RhbmNlKHB0LCBzdGFydCwgdW5pdHMpO1xuICAgIC8vc3RvcFxuICAgIHN0b3AucHJvcGVydGllcy5kaXN0ID0gZGlzdGFuY2UocHQsIHN0b3AsIHVuaXRzKTtcbiAgICAvL3BlcnBlbmRpY3VsYXJcbiAgICB2YXIgZGlyZWN0aW9uID0gYmVhcmluZyhzdGFydCwgc3RvcClcbiAgICB2YXIgcGVycGVuZGljdWxhclB0ID0gZGVzdGluYXRpb24ocHQsIDEwMDAgLCBkaXJlY3Rpb24gKyA5MCwgdW5pdHMpIC8vIDEwMDAgPSBncm9zc1xuICAgIHZhciBpbnRlcnNlY3QgPSBsaW5lSW50ZXJzZWN0cyhcbiAgICAgIHB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgcHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICBwZXJwZW5kaWN1bGFyUHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICBwZXJwZW5kaWN1bGFyUHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICBzdGFydC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgIHN0YXJ0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLFxuICAgICAgc3RvcC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgIHN0b3AuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV1cbiAgICAgICk7XG4gICAgaWYoIWludGVyc2VjdCkge1xuICAgICAgcGVycGVuZGljdWxhclB0ID0gZGVzdGluYXRpb24ocHQsIDEwMDAgLCBkaXJlY3Rpb24gLSA5MCwgdW5pdHMpIC8vIDEwMDAgPSBncm9zc1xuICAgICAgaW50ZXJzZWN0ID0gbGluZUludGVyc2VjdHMoXG4gICAgICAgIHB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgICBwdC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSxcbiAgICAgICAgcGVycGVuZGljdWxhclB0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgICBwZXJwZW5kaWN1bGFyUHQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0sXG4gICAgICAgIHN0YXJ0Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLFxuICAgICAgICBzdGFydC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSxcbiAgICAgICAgc3RvcC5nZW9tZXRyeS5jb29yZGluYXRlc1swXSxcbiAgICAgICAgc3RvcC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXVxuICAgICAgICApO1xuICAgIH1cbiAgICBwZXJwZW5kaWN1bGFyUHQucHJvcGVydGllcy5kaXN0ID0gSW5maW5pdHk7XG4gICAgdmFyIGludGVyc2VjdFB0O1xuICAgIGlmKGludGVyc2VjdCkge1xuICAgICAgdmFyIGludGVyc2VjdFB0ID0gcG9pbnQoaW50ZXJzZWN0KTtcbiAgICAgIGludGVyc2VjdFB0LnByb3BlcnRpZXMuZGlzdCA9IGRpc3RhbmNlKHB0LCBpbnRlcnNlY3RQdCwgdW5pdHMpO1xuICAgIH1cbiAgICBcbiAgICBpZihzdGFydC5wcm9wZXJ0aWVzLmRpc3QgPCBjbG9zZXN0UHQucHJvcGVydGllcy5kaXN0KSB7XG4gICAgICBjbG9zZXN0UHQgPSBzdGFydDtcbiAgICAgIGNsb3Nlc3RQdC5wcm9wZXJ0aWVzLmluZGV4ID0gaTtcbiAgICB9XG4gICAgaWYoc3RvcC5wcm9wZXJ0aWVzLmRpc3QgPCBjbG9zZXN0UHQucHJvcGVydGllcy5kaXN0KSB7XG4gICAgIGNsb3Nlc3RQdCA9IHN0b3A7XG4gICAgIGNsb3Nlc3RQdC5wcm9wZXJ0aWVzLmluZGV4ID0gaTtcbiAgICB9XG4gICAgaWYoaW50ZXJzZWN0UHQgJiYgaW50ZXJzZWN0UHQucHJvcGVydGllcy5kaXN0IDwgY2xvc2VzdFB0LnByb3BlcnRpZXMuZGlzdCl7IFxuICAgICAgY2xvc2VzdFB0ID0gaW50ZXJzZWN0UHQ7XG4gICAgICBjbG9zZXN0UHQucHJvcGVydGllcy5pbmRleCA9IGk7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gY2xvc2VzdFB0O1xufVxuXG4vLyBtb2RpZmllZCBmcm9tIGh0dHA6Ly9qc2ZpZGRsZS5uZXQvanVzdGluX2Nfcm91bmRzL0dkMlMyL2xpZ2h0L1xuZnVuY3Rpb24gbGluZUludGVyc2VjdHMobGluZTFTdGFydFgsIGxpbmUxU3RhcnRZLCBsaW5lMUVuZFgsIGxpbmUxRW5kWSwgbGluZTJTdGFydFgsIGxpbmUyU3RhcnRZLCBsaW5lMkVuZFgsIGxpbmUyRW5kWSkge1xuICAvLyBpZiB0aGUgbGluZXMgaW50ZXJzZWN0LCB0aGUgcmVzdWx0IGNvbnRhaW5zIHRoZSB4IGFuZCB5IG9mIHRoZSBpbnRlcnNlY3Rpb24gKHRyZWF0aW5nIHRoZSBsaW5lcyBhcyBpbmZpbml0ZSkgYW5kIGJvb2xlYW5zIGZvciB3aGV0aGVyIGxpbmUgc2VnbWVudCAxIG9yIGxpbmUgc2VnbWVudCAyIGNvbnRhaW4gdGhlIHBvaW50XG4gIHZhciBkZW5vbWluYXRvciwgYSwgYiwgbnVtZXJhdG9yMSwgbnVtZXJhdG9yMiwgcmVzdWx0ID0ge1xuICAgIHg6IG51bGwsXG4gICAgeTogbnVsbCxcbiAgICBvbkxpbmUxOiBmYWxzZSxcbiAgICBvbkxpbmUyOiBmYWxzZVxuICB9O1xuICBkZW5vbWluYXRvciA9ICgobGluZTJFbmRZIC0gbGluZTJTdGFydFkpICogKGxpbmUxRW5kWCAtIGxpbmUxU3RhcnRYKSkgLSAoKGxpbmUyRW5kWCAtIGxpbmUyU3RhcnRYKSAqIChsaW5lMUVuZFkgLSBsaW5lMVN0YXJ0WSkpO1xuICBpZiAoZGVub21pbmF0b3IgPT0gMCkge1xuICAgIGlmKHJlc3VsdC54ICE9IG51bGwgJiYgcmVzdWx0LnkgIT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBhID0gbGluZTFTdGFydFkgLSBsaW5lMlN0YXJ0WTtcbiAgYiA9IGxpbmUxU3RhcnRYIC0gbGluZTJTdGFydFg7XG4gIG51bWVyYXRvcjEgPSAoKGxpbmUyRW5kWCAtIGxpbmUyU3RhcnRYKSAqIGEpIC0gKChsaW5lMkVuZFkgLSBsaW5lMlN0YXJ0WSkgKiBiKTtcbiAgbnVtZXJhdG9yMiA9ICgobGluZTFFbmRYIC0gbGluZTFTdGFydFgpICogYSkgLSAoKGxpbmUxRW5kWSAtIGxpbmUxU3RhcnRZKSAqIGIpO1xuICBhID0gbnVtZXJhdG9yMSAvIGRlbm9taW5hdG9yO1xuICBiID0gbnVtZXJhdG9yMiAvIGRlbm9taW5hdG9yO1xuXG4gIC8vIGlmIHdlIGNhc3QgdGhlc2UgbGluZXMgaW5maW5pdGVseSBpbiBib3RoIGRpcmVjdGlvbnMsIHRoZXkgaW50ZXJzZWN0IGhlcmU6XG4gIHJlc3VsdC54ID0gbGluZTFTdGFydFggKyAoYSAqIChsaW5lMUVuZFggLSBsaW5lMVN0YXJ0WCkpO1xuICByZXN1bHQueSA9IGxpbmUxU3RhcnRZICsgKGEgKiAobGluZTFFbmRZIC0gbGluZTFTdGFydFkpKTtcblxuICAvLyBpZiBsaW5lMSBpcyBhIHNlZ21lbnQgYW5kIGxpbmUyIGlzIGluZmluaXRlLCB0aGV5IGludGVyc2VjdCBpZjpcbiAgaWYgKGEgPiAwICYmIGEgPCAxKSB7XG4gICAgcmVzdWx0Lm9uTGluZTEgPSB0cnVlO1xuICB9XG4gIC8vIGlmIGxpbmUyIGlzIGEgc2VnbWVudCBhbmQgbGluZTEgaXMgaW5maW5pdGUsIHRoZXkgaW50ZXJzZWN0IGlmOlxuICBpZiAoYiA+IDAgJiYgYiA8IDEpIHtcbiAgICByZXN1bHQub25MaW5lMiA9IHRydWU7XG4gIH1cbiAgLy8gaWYgbGluZTEgYW5kIGxpbmUyIGFyZSBzZWdtZW50cywgdGhleSBpbnRlcnNlY3QgaWYgYm90aCBvZiB0aGUgYWJvdmUgYXJlIHRydWVcbiAgaWYocmVzdWx0Lm9uTGluZTEgJiYgcmVzdWx0Lm9uTGluZTIpe1xuICAgIHJldHVybiBbcmVzdWx0LngsIHJlc3VsdC55XTtcbiAgfVxuICBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsInZhciBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcbnZhciBjZW50cm9pZCA9IHJlcXVpcmUoJ3R1cmYtY2VudGVyJyk7XG52YXIgZGlzdGFuY2UgPSByZXF1aXJlKCd0dXJmLWRpc3RhbmNlJyk7XG52YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcbnZhciBleHBsb2RlID0gcmVxdWlyZSgndHVyZi1leHBsb2RlJyk7XG5cbi8qKlxuICogRmluZHMgYSB7QGxpbmsgUG9pbnR9IGd1YXJhbnRlZWQgdG8gYmUgb24gdGhlIHN1cmZhY2Ugb2ZcbiAqIHtAbGluayBHZW9KU09OfSBvYmplY3QuXG4gKlxuICogKiBHaXZlbiBhIHtAbGluayBQb2x5Z29ufSwgdGhlIHBvaW50IHdpbGwgYmUgaW4gdGhlIGFyZWEgb2YgdGhlIHBvbHlnb25cbiAqICogR2l2ZW4gYSB7QGxpbmsgTGluZVN0cmluZ30sIHRoZSBwb2ludCB3aWxsIGJlIGFsb25nIHRoZSBzdHJpbmdcbiAqICogR2l2ZW4gYSB7QGxpbmsgUG9pbnR9LCB0aGUgcG9pbnQgd2lsbCB0aGUgc2FtZSBhcyB0aGUgaW5wdXRcbiAqXG4gKiBAbW9kdWxlIHR1cmYvcG9pbnQtb24tc3VyZmFjZVxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0dlb0pTT059IGlucHV0IGFueSBHZW9KU09OIG9iamVjdFxuICogQHJldHVybnMge0ZlYXR1cmV9IGEgcG9pbnQgb24gdGhlIHN1cmZhY2Ugb2YgYGlucHV0YFxuICogQGV4YW1wbGVcbiAqIC8vIGNyZWF0ZSBhIHJhbmRvbSBwb2x5Z29uXG4gKiB2YXIgcG9seWdvbiA9IHR1cmYucmFuZG9tKCdwb2x5Z29uJyk7XG4gKlxuICogLy89cG9seWdvblxuICpcbiAqIHZhciBwb2ludE9uUG9seWdvbiA9IHR1cmYucG9pbnRPblN1cmZhY2UocG9seWdvbik7XG4gKlxuKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2x5Z29uLmZlYXR1cmVzLmNvbmNhdChwb2ludE9uUG9seWdvbik7XG4qIHZhciByZXN1bHQgPSB7XG4qICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiogICBcImZlYXR1cmVzXCI6IHJlc3VsdEZlYXR1cmVzXG4qIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmMpIHtcbiAgLy8gbm9ybWFsaXplXG4gIGlmKGZjLnR5cGUgIT0gJ0ZlYXR1cmVDb2xsZWN0aW9uJykge1xuICAgIGlmKGZjLnR5cGUgIT0gJ0ZlYXR1cmUnKSB7XG4gICAgICBmYyA9IHtcbiAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgICAgICBnZW9tZXRyeTogZmMsXG4gICAgICAgIHByb3BlcnRpZXM6IHt9XG4gICAgICB9O1xuICAgIH1cbiAgICBmYyA9IGZlYXR1cmVDb2xsZWN0aW9uKFtmY10pO1xuICB9XG5cbiAgLy9nZXQgY2VudHJvaWRcbiAgdmFyIGNlbnQgPSBjZW50cm9pZChmYyk7XG5cbiAgLy8gY2hlY2sgdG8gc2VlIGlmIGNlbnRyb2lkIGlzIG9uIHN1cmZhY2VcbiAgdmFyIG9uU3VyZmFjZSA9IGZhbHNlO1xuICB2YXIgaSA9IDA7XG4gIHdoaWxlKCFvblN1cmZhY2UgJiYgaSA8IGZjLmZlYXR1cmVzLmxlbmd0aCkge1xuICAgIHZhciBnZW9tID0gZmMuZmVhdHVyZXNbaV0uZ2VvbWV0cnk7XG4gICAgaWYgKGdlb20udHlwZSA9PT0gJ1BvaW50Jykge1xuICAgICAgaWYgKGNlbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0gPT09IGdlb20uY29vcmRpbmF0ZXNbMF0gJiZcbiAgICAgICAgY2VudC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSA9PT0gZ2VvbS5jb29yZGluYXRlc1sxXSkge1xuICAgICAgICBvblN1cmZhY2UgPSB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZihnZW9tLnR5cGUgPT09ICdNdWx0aVBvaW50Jykge1xuICAgICAgdmFyIG9uTXVsdGlQb2ludCA9IGZhbHNlO1xuICAgICAgdmFyIGsgPSAwO1xuICAgICAgd2hpbGUoIW9uTXVsdGlQb2ludCAmJiBrIDwgZ2VvbS5jb29yZGluYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgaWYgKGNlbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0gPT09IGdlb20uY29vcmRpbmF0ZXNba11bMF0gJiZcbiAgICAgICAgICBjZW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdID09PSBnZW9tLmNvb3JkaW5hdGVzW2tdWzFdKSB7XG4gICAgICAgICAgb25TdXJmYWNlID0gdHJ1ZTtcbiAgICAgICAgICBvbk11bHRpUG9pbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGsrKztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYoZ2VvbS50eXBlID09PSAnTGluZVN0cmluZycpIHtcbiAgICAgIHZhciBvbkxpbmUgPSBmYWxzZTtcbiAgICAgIHZhciBrID0gMDtcbiAgICAgIHdoaWxlKCFvbkxpbmUgJiYgayA8IGdlb20uY29vcmRpbmF0ZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICB2YXIgeCA9IGNlbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF07XG4gICAgICAgIHZhciB5ID0gY2VudC5nZW9tZXRyeS5jb29yZGluYXRlc1sxXTtcbiAgICAgICAgdmFyIHgxID0gZ2VvbS5jb29yZGluYXRlc1trXVswXTtcbiAgICAgICAgdmFyIHkxID0gZ2VvbS5jb29yZGluYXRlc1trXVsxXTtcbiAgICAgICAgdmFyIHgyID0gZ2VvbS5jb29yZGluYXRlc1trKzFdWzBdO1xuICAgICAgICB2YXIgeTIgPSBnZW9tLmNvb3JkaW5hdGVzW2srMV1bMV07XG4gICAgICAgIGlmKHBvaW50T25TZWdtZW50KHgsIHksIHgxLCB5MSwgeDIsIHkyKSkge1xuICAgICAgICAgIG9uTGluZSA9IHRydWU7XG4gICAgICAgICAgb25TdXJmYWNlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBrKys7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmKGdlb20udHlwZSA9PT0gJ011bHRpTGluZVN0cmluZycpIHtcbiAgICAgIHZhciBvbk11bHRpTGluZSA9IGZhbHNlO1xuICAgICAgdmFyIGogPSAwO1xuICAgICAgd2hpbGUoIW9uTXVsdGlMaW5lICYmIGogPCBnZW9tLmNvb3JkaW5hdGVzLmxlbmd0aCkge1xuICAgICAgICB2YXIgb25MaW5lID0gZmFsc2U7XG4gICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgdmFyIGxpbmUgPSBnZW9tLmNvb3JkaW5hdGVzW2pdO1xuICAgICAgICB3aGlsZSghb25MaW5lICYmIGsgPCBsaW5lLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICB2YXIgeCA9IGNlbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF07XG4gICAgICAgICAgdmFyIHkgPSBjZW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdO1xuICAgICAgICAgIHZhciB4MSA9IGxpbmVba11bMF07XG4gICAgICAgICAgdmFyIHkxID0gbGluZVtrXVsxXTtcbiAgICAgICAgICB2YXIgeDIgPSBsaW5lW2srMV1bMF07XG4gICAgICAgICAgdmFyIHkyID0gbGluZVtrKzFdWzFdO1xuICAgICAgICAgIGlmKHBvaW50T25TZWdtZW50KHgsIHksIHgxLCB5MSwgeDIsIHkyKSkge1xuICAgICAgICAgICAgb25MaW5lID0gdHJ1ZTtcbiAgICAgICAgICAgIG9uU3VyZmFjZSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGsrKztcbiAgICAgICAgfVxuICAgICAgICBqKys7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmKGdlb20udHlwZSA9PT0gJ1BvbHlnb24nIHx8IGdlb20udHlwZSA9PT0gJ011bHRpUG9seWdvbicpIHtcbiAgICAgIHZhciBmID0ge1xuICAgICAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgICAgIGdlb21ldHJ5OiBnZW9tLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7fVxuICAgICAgfTtcbiAgICAgIGlmKGluc2lkZShjZW50LCBmKSkge1xuICAgICAgICBvblN1cmZhY2UgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICBpKys7XG4gIH1cbiAgaWYob25TdXJmYWNlKSB7XG4gICAgcmV0dXJuIGNlbnQ7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHZlcnRpY2VzID0gZmVhdHVyZUNvbGxlY3Rpb24oW10pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBmYy5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmVydGljZXMuZmVhdHVyZXMgPSB2ZXJ0aWNlcy5mZWF0dXJlcy5jb25jYXQoZXhwbG9kZShmYy5mZWF0dXJlc1tpXSkuZmVhdHVyZXMpO1xuICAgIH1cbiAgICB2YXIgY2xvc2VzdFZlcnRleDtcbiAgICB2YXIgY2xvc2VzdERpc3RhbmNlID0gSW5maW5pdHk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHZlcnRpY2VzLmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGlzdCA9IGRpc3RhbmNlKGNlbnQsIHZlcnRpY2VzLmZlYXR1cmVzW2ldLCAnbWlsZXMnKTtcbiAgICAgIGlmKGRpc3QgPCBjbG9zZXN0RGlzdGFuY2UpIHtcbiAgICAgICAgY2xvc2VzdERpc3RhbmNlID0gZGlzdDtcbiAgICAgICAgY2xvc2VzdFZlcnRleCA9IHZlcnRpY2VzLmZlYXR1cmVzW2ldO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY2xvc2VzdFZlcnRleDtcbiAgfVxufTtcblxuZnVuY3Rpb24gcG9pbnRPblNlZ21lbnQgKHgsIHksIHgxLCB5MSwgeDIsIHkyKSB7XG4gIHZhciBhYiA9IE1hdGguc3FydCgoeDIteDEpKih4Mi14MSkrKHkyLXkxKSooeTIteTEpKTtcbiAgdmFyIGFwID0gTWF0aC5zcXJ0KCh4LXgxKSooeC14MSkrKHkteTEpKih5LXkxKSk7XG4gIHZhciBwYiA9IE1hdGguc3FydCgoeDIteCkqKHgyLXgpKyh5Mi15KSooeTIteSkpO1xuICBpZihhYiA9PT0gYXAgKyBwYikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG4iLCIvKipcbiAqIFRha2VzIGNvb3JkaW5hdGVzIGFuZCBwcm9wZXJ0aWVzIChvcHRpb25hbCkgYW5kIHJldHVybnMgYSBuZXcge0BsaW5rIFBvaW50fSBmZWF0dXJlLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9wb2ludFxuICogQGNhdGVnb3J5IGhlbHBlclxuICogQHBhcmFtIHtudW1iZXJ9IGxvbmdpdHVkZSBwb3NpdGlvbiB3ZXN0IHRvIGVhc3QgaW4gZGVjaW1hbCBkZWdyZWVzXG4gKiBAcGFyYW0ge251bWJlcn0gbGF0aXR1ZGUgcG9zaXRpb24gc291dGggdG8gbm9ydGggaW4gZGVjaW1hbCBkZWdyZWVzXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcGVydGllcyBhbiBPYmplY3QgdGhhdCBpcyB1c2VkIGFzIHRoZSB7QGxpbmsgRmVhdHVyZX0nc1xuICogcHJvcGVydGllc1xuICogQHJldHVybiB7UG9pbnR9IGEgUG9pbnQgZmVhdHVyZVxuICogQGV4YW1wbGVcbiAqIHZhciBwdDEgPSB0dXJmLnBvaW50KFstNzUuMzQzLCAzOS45ODRdKTtcbiAqXG4gKiAvLz1wdDFcbiAqL1xudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKGFyZykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjb29yZGluYXRlcywgcHJvcGVydGllcykge1xuICBpZiAoIWlzQXJyYXkoY29vcmRpbmF0ZXMpKSB0aHJvdyBuZXcgRXJyb3IoJ0Nvb3JkaW5hdGVzIG11c3QgYmUgYW4gYXJyYXknKTtcbiAgaWYgKGNvb3JkaW5hdGVzLmxlbmd0aCA8IDIpIHRocm93IG5ldyBFcnJvcignQ29vcmRpbmF0ZXMgbXVzdCBiZSBhdCBsZWFzdCAyIG51bWJlcnMgbG9uZycpO1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwiRmVhdHVyZVwiLFxuICAgIGdlb21ldHJ5OiB7XG4gICAgICB0eXBlOiBcIlBvaW50XCIsXG4gICAgICBjb29yZGluYXRlczogY29vcmRpbmF0ZXNcbiAgICB9LFxuICAgIHByb3BlcnRpZXM6IHByb3BlcnRpZXMgfHwge31cbiAgfTtcbn07XG4iLCIvKipcbiAqIFRha2VzIGFuIGFycmF5IG9mIExpbmVhclJpbmdzIGFuZCBvcHRpb25hbGx5IGFuIHtAbGluayBPYmplY3R9IHdpdGggcHJvcGVydGllcyBhbmQgcmV0dXJucyBhIEdlb0pTT04ge0BsaW5rIFBvbHlnb259IGZlYXR1cmUuXG4gKlxuICogQG1vZHVsZSB0dXJmL3BvbHlnb25cbiAqIEBjYXRlZ29yeSBoZWxwZXJcbiAqIEBwYXJhbSB7QXJyYXk8QXJyYXk8TnVtYmVyPj59IHJpbmdzIGFuIGFycmF5IG9mIExpbmVhclJpbmdzXG4gKiBAcGFyYW0ge09iamVjdH0gcHJvcGVydGllcyBhbiBvcHRpb25hbCBwcm9wZXJ0aWVzIG9iamVjdFxuICogQHJldHVybiB7UG9seWdvbn0gYSBQb2x5Z29uIGZlYXR1cmVcbiAqIEB0aHJvd3Mge0Vycm9yfSB0aHJvdyBhbiBlcnJvciBpZiBhIExpbmVhclJpbmcgb2YgdGhlIHBvbHlnb24gaGFzIHRvbyBmZXcgcG9zaXRpb25zXG4gKiBvciBpZiBhIExpbmVhclJpbmcgb2YgdGhlIFBvbHlnb24gZG9lcyBub3QgaGF2ZSBtYXRjaGluZyBQb3NpdGlvbnMgYXQgdGhlXG4gKiBiZWdpbm5pbmcgJiBlbmQuXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHlnb24gPSB0dXJmLnBvbHlnb24oW1tcbiAqICBbLTIuMjc1NTQzLCA1My40NjQ1NDddLFxuICogIFstMi4yNzU1NDMsIDUzLjQ4OTI3MV0sXG4gKiAgWy0yLjIxNTExOCwgNTMuNDg5MjcxXSxcbiAqICBbLTIuMjE1MTE4LCA1My40NjQ1NDddLFxuICogIFstMi4yNzU1NDMsIDUzLjQ2NDU0N11cbiAqIF1dLCB7IG5hbWU6ICdwb2x5MScsIHBvcHVsYXRpb246IDQwMH0pO1xuICpcbiAqIC8vPXBvbHlnb25cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjb29yZGluYXRlcywgcHJvcGVydGllcyl7XG5cbiAgaWYgKGNvb3JkaW5hdGVzID09PSBudWxsKSB0aHJvdyBuZXcgRXJyb3IoJ05vIGNvb3JkaW5hdGVzIHBhc3NlZCcpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRpbmF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcmluZyA9IGNvb3JkaW5hdGVzW2ldO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgcmluZ1tyaW5nLmxlbmd0aCAtIDFdLmxlbmd0aDsgaisrKSB7XG4gICAgICBpZiAocmluZy5sZW5ndGggPCA0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRWFjaCBMaW5lYXJSaW5nIG9mIGEgUG9seWdvbiBtdXN0IGhhdmUgNCBvciBtb3JlIFBvc2l0aW9ucy4nKTtcbiAgICAgIH1cbiAgICAgIGlmIChyaW5nW3JpbmcubGVuZ3RoIC0gMV1bal0gIT09IHJpbmdbMF1bal0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaXJzdCBhbmQgbGFzdCBQb3NpdGlvbiBhcmUgbm90IGVxdWl2YWxlbnQuJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIHBvbHlnb24gPSB7XG4gICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICAgIFwiZ2VvbWV0cnlcIjoge1xuICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICAgICAgXCJjb29yZGluYXRlc1wiOiBjb29yZGluYXRlc1xuICAgIH0sXG4gICAgXCJwcm9wZXJ0aWVzXCI6IHByb3BlcnRpZXNcbiAgfTtcblxuICBpZiAoIXBvbHlnb24ucHJvcGVydGllcykge1xuICAgIHBvbHlnb24ucHJvcGVydGllcyA9IHt9O1xuICB9XG5cbiAgcmV0dXJuIHBvbHlnb247XG59O1xuIiwidmFyIHNzID0gcmVxdWlyZSgnc2ltcGxlLXN0YXRpc3RpY3MnKTtcblxuLyoqXG4qIFRha2VzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSwgYSBwcm9wZXJ0eSBuYW1lLCBhbmQgYSBzZXQgb2YgcGVyY2VudGlsZXMgYW5kIHJldHVybnMgYSBxdWFudGlsZSBhcnJheS5cbiogQG1vZHVsZSB0dXJmL3F1YW50aWxlXG4qIEBjYXRlZ29yeSBjbGFzc2lmaWNhdGlvblxuKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBpbnB1dCBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4qIEBwYXJhbSB7U3RyaW5nfSBmaWVsZCB0aGUgcHJvcGVydHkgaW4gYGlucHV0YCBmcm9tIHdoaWNoIHRvIHJldHJpZXZlIHF1YW50aWxlIHZhbHVlc1xuKiBAcGFyYW0ge0FycmF5PG51bWJlcj59IHBlcmNlbnRpbGVzIGFuIEFycmF5IG9mIHBlcmNlbnRpbGVzIG9uIHdoaWNoIHRvIGNhbGN1bGF0ZSBxdWFudGlsZSB2YWx1ZXNcbiogQHJldHVybiB7QXJyYXk8bnVtYmVyPn0gYW4gYXJyYXkgb2YgdGhlIGJyZWFrIHZhbHVlc1xuKiBAZXhhbXBsZVxuKiB2YXIgcG9pbnRzID0ge1xuKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4qICAgXCJmZWF0dXJlc1wiOiBbXG4qICAgICB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogNVxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzUsIDVdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA0MFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEsIDNdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiA4MFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzE0LCAyXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogOTBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMywgMV1cbiogICAgICAgfVxuKiAgICAgfSwge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDEwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzE5LCA3XVxuKiAgICAgICB9XG4qICAgICB9XG4qICAgXVxuKiB9O1xuKlxuKiB2YXIgYnJlYWtzID0gdHVyZi5xdWFudGlsZShcbiogICBwb2ludHMsICdwb3B1bGF0aW9uJywgWzI1LCA1MCwgNzUsIDk5XSk7XG4qXG4qIC8vPWJyZWFrc1xuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmMsIGZpZWxkLCBwZXJjZW50aWxlcyl7XG4gIHZhciB2YWxzID0gW107XG4gIHZhciBxdWFudGlsZXMgPSBbXTtcblxuICBmYy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKGZlYXR1cmUpe1xuICAgIHZhbHMucHVzaChmZWF0dXJlLnByb3BlcnRpZXNbZmllbGRdKTtcbiAgfSk7XG4gIHBlcmNlbnRpbGVzLmZvckVhY2goZnVuY3Rpb24ocGVyY2VudGlsZSl7XG4gICAgcXVhbnRpbGVzLnB1c2goc3MucXVhbnRpbGUodmFscywgcGVyY2VudGlsZSAqIDAuMDEpKTtcbiAgfSk7XG4gIHJldHVybiBxdWFudGlsZXM7XG59O1xuIiwidmFyIHJhbmRvbSA9IHJlcXVpcmUoJ2dlb2pzb24tcmFuZG9tJyk7XG5cbi8qKlxuICogR2VuZXJhdGVzIHJhbmRvbSB7QGxpbmsgR2VvSlNPTn0gZGF0YSwgaW5jbHVkaW5nIHtAbGluayBQb2ludHxQb2ludHN9IGFuZCB7QGxpbmsgUG9seWdvbnxQb2x5Z29uc30sIGZvciB0ZXN0aW5nXG4gKiBhbmQgZXhwZXJpbWVudGF0aW9uLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9yYW5kb21cbiAqIEBjYXRlZ29yeSBkYXRhXG4gKiBAcGFyYW0ge1N0cmluZ30gW3R5cGU9J3BvaW50J10gdHlwZSBvZiBmZWF0dXJlcyBkZXNpcmVkOiAncG9pbnRzJyBvciAncG9seWdvbnMnXG4gKiBAcGFyYW0ge051bWJlcn0gW2NvdW50PTFdIGhvdyBtYW55IGdlb21ldHJpZXMgc2hvdWxkIGJlIGdlbmVyYXRlZC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIG9wdGlvbnMgcmVsZXZhbnQgdG8gdGhlIGZlYXR1cmUgZGVzaXJlZC4gQ2FuIGluY2x1ZGU6XG4gKiBAcGFyYW0ge0FycmF5PG51bWJlcj59IG9wdGlvbnMuYmJveCBhIGJvdW5kaW5nIGJveCBpbnNpZGUgb2Ygd2hpY2ggZ2VvbWV0cmllc1xuICogYXJlIHBsYWNlZC4gSW4gdGhlIGNhc2Ugb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcywgdGhleSBhcmUgZ3VhcmFudGVlZCB0byBiZSB3aXRoaW4gdGhpcyBib3VuZHMsXG4gKiB3aGlsZSB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgaGF2ZSB0aGVpciBjZW50cm9pZCB3aXRoaW4gdGhlIGJvdW5kcy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5udW1fdmVydGljZXM9MTBdIG9wdGlvbnMudmVydGljZXMgdGhlIG51bWJlciBvZiB2ZXJ0aWNlcyBhZGRlZFxuICogdG8gcG9seWdvbiBmZWF0dXJlcy5cbiAqIEBwYXJhbSB7TnVtYmVyfSBbb3B0aW9ucy5tYXhfcmFkaWFsX2xlbmd0aD0xMF0gdGhlIHRvdGFsIG51bWJlciBvZiBkZWNpbWFsXG4gKiBkZWdyZWVzIGxvbmdpdHVkZSBvciBsYXRpdHVkZSB0aGF0IGEgcG9seWdvbiBjYW4gZXh0ZW50IG91dHdhcmRzIHRvXG4gKiBmcm9tIGl0cyBjZW50ZXIuXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gZ2VuZXJhdGVkIHJhbmRvbSBmZWF0dXJlc1xuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludHMgPSB0dXJmLnJhbmRvbSgncG9pbnRzJywgMTAwLCB7XG4gKiAgIGJib3g6IFstNzAsIDQwLCAtNjAsIDYwXVxuICogfSk7XG4gKlxuICogLy89cG9pbnRzXG4gKlxuICogdmFyIHBvbHlnb25zID0gdHVyZi5yYW5kb20oJ3BvbHlnb25zJywgNCwge1xuICogICBiYm94OiBbLTcwLCA0MCwgLTYwLCA2MF1cbiAqIH0pO1xuICpcbiAqIC8vPXBvbHlnb25zXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odHlwZSwgY291bnQsIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBjb3VudCA9IGNvdW50IHx8IDE7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ3BvaW50JzpcbiAgICAgICAgY2FzZSAncG9pbnRzJzpcbiAgICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgICAgICByZXR1cm4gcmFuZG9tLnBvaW50KGNvdW50LCBvcHRpb25zLmJib3gpO1xuICAgICAgICBjYXNlICdwb2x5Z29uJzpcbiAgICAgICAgY2FzZSAncG9seWdvbnMnOlxuICAgICAgICAgICAgcmV0dXJuIHJhbmRvbS5wb2x5Z29uKFxuICAgICAgICAgICAgICAgIGNvdW50LFxuICAgICAgICAgICAgICAgIG9wdGlvbnMubnVtX3ZlcnRpY2VzLFxuICAgICAgICAgICAgICAgIG9wdGlvbnMubWF4X3JhZGlhbF9sZW5ndGgsXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5iYm94KTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biB0eXBlIGdpdmVuOiB2YWxpZCBvcHRpb25zIGFyZSBwb2ludHMgYW5kIHBvbHlnb25zJyk7XG4gICAgfVxufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjYWxsIC5wb2ludCgpIG9yIC5wb2x5Z29uKCkgaW5zdGVhZCcpO1xufTtcblxuZnVuY3Rpb24gcG9zaXRpb24oYmJveCkge1xuICAgIGlmIChiYm94KSByZXR1cm4gY29vcmRJbkJCQk9YKGJib3gpO1xuICAgIGVsc2UgcmV0dXJuIFtsb24oKSwgbGF0KCldO1xufVxuXG5tb2R1bGUuZXhwb3J0cy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuXG5tb2R1bGUuZXhwb3J0cy5wb2ludCA9IGZ1bmN0aW9uKGNvdW50LCBiYm94KSB7XG4gICAgdmFyIGZlYXR1cmVzID0gW107XG4gICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgZmVhdHVyZXMucHVzaChmZWF0dXJlKGJib3ggPyBwb2ludChwb3NpdGlvbihiYm94KSkgOiBwb2ludCgpKSk7XG4gICAgfVxuICAgIHJldHVybiBjb2xsZWN0aW9uKGZlYXR1cmVzKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzLnBvbHlnb24gPSBmdW5jdGlvbihjb3VudCwgbnVtX3ZlcnRpY2VzLCBtYXhfcmFkaWFsX2xlbmd0aCwgYmJveCkge1xuICAgIGlmICh0eXBlb2YgbnVtX3ZlcnRpY2VzICE9PSAnbnVtYmVyJykgbnVtX3ZlcnRpY2VzID0gMTA7XG4gICAgaWYgKHR5cGVvZiBtYXhfcmFkaWFsX2xlbmd0aCAhPT0gJ251bWJlcicpIG1heF9yYWRpYWxfbGVuZ3RoID0gMTA7XG4gICAgdmFyIGZlYXR1cmVzID0gW107XG4gICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgdmFyIHZlcnRpY2VzID0gW10sXG4gICAgICAgICAgICBjaXJjbGVfb2Zmc2V0cyA9IEFycmF5LmFwcGx5KG51bGwsXG4gICAgICAgICAgICAgICAgbmV3IEFycmF5KG51bV92ZXJ0aWNlcyArIDEpKS5tYXAoTWF0aC5yYW5kb20pO1xuXG4gICAgICAgIGNpcmNsZV9vZmZzZXRzLmZvckVhY2goc3VtT2Zmc2V0cyk7XG4gICAgICAgIGNpcmNsZV9vZmZzZXRzLmZvckVhY2goc2NhbGVPZmZzZXRzKTtcbiAgICAgICAgdmVydGljZXNbdmVydGljZXMubGVuZ3RoIC0gMV0gPSB2ZXJ0aWNlc1swXTsgLy8gY2xvc2UgdGhlIHJpbmdcblxuICAgICAgICAvLyBjZW50ZXIgdGhlIHBvbHlnb24gYXJvdW5kIHNvbWV0aGluZ1xuICAgICAgICB2ZXJ0aWNlcyA9IHZlcnRpY2VzLm1hcCh2ZXJ0ZXhUb0Nvb3JkaW5hdGUocG9zaXRpb24oYmJveCkpKTtcbiAgICAgICAgZmVhdHVyZXMucHVzaChmZWF0dXJlKHBvbHlnb24oW3ZlcnRpY2VzXSkpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdW1PZmZzZXRzKGN1ciwgaW5kZXgsIGFycikge1xuICAgICAgICBhcnJbaW5kZXhdID0gKGluZGV4ID4gMCkgPyBjdXIgKyBhcnJbaW5kZXggLSAxXSA6IGN1cjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY2FsZU9mZnNldHMoY3VyLCBpbmRleCkge1xuICAgICAgICBjdXIgPSBjdXIgKiAyICogTWF0aC5QSSAvIGNpcmNsZV9vZmZzZXRzW2NpcmNsZV9vZmZzZXRzLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgcmFkaWFsX3NjYWxlciA9IE1hdGgucmFuZG9tKCk7XG4gICAgICAgIHZlcnRpY2VzLnB1c2goW1xuICAgICAgICAgICAgcmFkaWFsX3NjYWxlciAqIG1heF9yYWRpYWxfbGVuZ3RoICogTWF0aC5zaW4oY3VyKSxcbiAgICAgICAgICAgIHJhZGlhbF9zY2FsZXIgKiBtYXhfcmFkaWFsX2xlbmd0aCAqIE1hdGguY29zKGN1cilcbiAgICAgICAgXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbGxlY3Rpb24oZmVhdHVyZXMpO1xufTtcblxuXG5mdW5jdGlvbiB2ZXJ0ZXhUb0Nvb3JkaW5hdGUoaHViKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGN1ciwgaW5kZXgpIHsgcmV0dXJuIFtjdXJbMF0gKyBodWJbMF0sIGN1clsxXSArIGh1YlsxXV07IH07XG59XG5cbmZ1bmN0aW9uIHJuZCgpIHsgcmV0dXJuIE1hdGgucmFuZG9tKCkgLSAwLjU7IH1cbmZ1bmN0aW9uIGxvbigpIHsgcmV0dXJuIHJuZCgpICogMzYwOyB9XG5mdW5jdGlvbiBsYXQoKSB7IHJldHVybiBybmQoKSAqIDE4MDsgfVxuXG5mdW5jdGlvbiBwb2ludChjb29yZGluYXRlcykge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdQb2ludCcsXG4gICAgICAgIGNvb3JkaW5hdGVzOiBjb29yZGluYXRlcyB8fCBbbG9uKCksIGxhdCgpXVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGNvb3JkSW5CQkJPWChiYm94KSB7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgKE1hdGgucmFuZG9tKCkgKiAoYmJveFsyXSAtIGJib3hbMF0pKSArIGJib3hbMF0sXG4gICAgICAgIChNYXRoLnJhbmRvbSgpICogKGJib3hbM10gLSBiYm94WzFdKSkgKyBiYm94WzFdXTtcbn1cblxuZnVuY3Rpb24gcG9pbnRJbkJCQk9YKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdQb2ludCcsXG4gICAgICAgIGNvb3JkaW5hdGVzOiBbbG9uKCksIGxhdCgpXVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIHBvbHlnb24oY29vcmRpbmF0ZXMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnUG9seWdvbicsXG4gICAgICAgIGNvb3JkaW5hdGVzOiBjb29yZGluYXRlc1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGZlYXR1cmUoZ2VvbSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdGZWF0dXJlJyxcbiAgICAgICAgZ2VvbWV0cnk6IGdlb20sXG4gICAgICAgIHByb3BlcnRpZXM6IHt9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gY29sbGVjdGlvbihmKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJyxcbiAgICAgICAgZmVhdHVyZXM6IGZcbiAgICB9O1xufVxuIiwidmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xudmFyIHJlY2xhc3MgPSByZXF1aXJlKCcuL2luZGV4LmpzJyk7XG5cbi8qKlxuICogVGFrZXMgYSB7QGxpbmsgRmVhdHVyZUNvbGxlY3Rpb259LCBhbiBpbnB1dCBmaWVsZCwgYW4gb3V0cHV0IGZpZWxkLCBhbmRcbiAqIGFuIGFycmF5IG9mIHRyYW5zbGF0aW9ucyBhbmQgb3V0cHV0cyBhbiBpZGVudGljYWwgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aFxuICogdGhlIG91dHB1dCBmaWVsZCBwcm9wZXJ0eSBwb3B1bGF0ZWQuXG4qIEBtb2R1bGUgdHVyZi9yZWNsYXNzXG4qIEBjYXRlZ29yeSBjbGFzc2lmaWNhdGlvblxuKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBpbnB1dCBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4qIEBwYXJhbSB7c3RyaW5nfSBpbkZpZWxkIHRoZSBmaWVsZCB0byB0cmFuc2xhdGVcbiogQHBhcmFtIHtzdHJpbmd9IG91dEZpZWxkIHRoZSBmaWVsZCBpbiB3aGljaCB0byBzdG9yZSB0cmFuc2xhdGVkIHJlc3VsdHNcbiogQHBhcmFtIHtBcnJheTxudW1iZXI+fSB0cmFuc2xhdGlvbnMgYW4gYXJyYXkgb2YgdHJhbnNsYXRpb25zXG4qIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIHdpdGggaWRlbnRpY2FsIGdlb21ldHJpZXMgdG8gYGlucHV0YCBidXQgd2l0aCBgb3V0RmllbGRgIHBvcHVsYXRlZC5cbiogQGV4YW1wbGVcbiogdmFyIHBvaW50cyA9IHtcbiogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuKiAgIFwiZmVhdHVyZXNcIjogW1xuKiAgICAge1xuKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4qICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4qICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuKiAgICAgICB9LFxuKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWzEzLjE3MDU0NywgMzIuODg4NjY5XVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTMuMTgyMDQ4LCAzMi44ODk1MzNdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAxMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMy4xNzM5OCwgMzIuODgyMTgyXVxuKiAgICAgICB9XG4qICAgICB9LCB7XG4qICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4qICAgICAgIH0sXG4qICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4qICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbMTMuMTc0MzI0LCAzMi44OTUwMTFdXG4qICAgICAgIH1cbiogICAgIH0sIHtcbiogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAzMDBcbiogICAgICAgfSxcbiogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4qICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFsxMy4xODU4MjUsIDMyLjg4NDM0NF1cbiogICAgICAgfVxuKiAgICAgfVxuKiAgIF1cbiogfTtcbiogLy8gMCB0byAyMDAgd2lsbCBtYXAgdG8gXCJzbWFsbFwiLCAyMDAgdG8gNDAwIHdpbGwgbWFwIHRvIFwibWVkaXVtXCIsIDQwMCB0byA2MDAgd2lsbCBtYXAgdG8gXCJsYXJnZVwiXG4qIHZhciB0cmFuc2xhdGlvbnMgPSBbXG4qICAgWzAsIDIwMCwgXCJzbWFsbFwiXSxcbiogICBbMjAwLCA0MDAsIFwibWVkaXVtXCJdLFxuKiAgIFs0MDAsIDYwMCwgXCJsYXJnZVwiXVxuKiBdO1xuKlxuKiB2YXIgcmVjbGFzc2VkID0gdHVyZi5yZWNsYXNzKFxuKiAgIHBvaW50cywgJ3BvcHVsYXRpb24nLCAnc2l6ZScsIHRyYW5zbGF0aW9ucyk7XG4qXG4qIC8vPXJlY2xhc3NlZFxuKlxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmMsIGluRmllbGQsIG91dEZpZWxkLCB0cmFuc2xhdGlvbnMsIGRvbmUpe1xuICB2YXIgcmVjbGFzc2VkID0gZmVhdHVyZWNvbGxlY3Rpb24oW10pO1xuXG4gIGZjLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24oZmVhdHVyZSl7XG4gICAgdmFyIHJlY2xhc3NlZEZlYXR1cmU7XG4gICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHRyYW5zbGF0aW9ucy5sZW5ndGg7IGkrKyl7XG4gICAgICBpZihmZWF0dXJlLnByb3BlcnRpZXNbaW5GaWVsZF0gPj0gdHJhbnNsYXRpb25zW2ldWzBdICYmIGZlYXR1cmUucHJvcGVydGllc1tpbkZpZWxkXSA8PSB0cmFuc2xhdGlvbnNbaV1bMV0pIHtcbiAgICAgICAgZmVhdHVyZS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IHRyYW5zbGF0aW9uc1tpXVsyXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVjbGFzc2VkLmZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gIH0pO1xuXG4gIHJldHVybiByZWNsYXNzZWQ7XG59O1xuIiwidmFyIGZlYXR1cmVDb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiBhbnkgdHlwZSwgYSBwcm9wZXJ0eSwgYW5kIGEgdmFsdWUgYW5kXG4gKiByZXR1cm5zIGEgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aCBmZWF0dXJlcyBtYXRjaGluZyB0aGF0XG4gKiBwcm9wZXJ0eS12YWx1ZSBwYWlyIHJlbW92ZWQuXG4gKlxuICogQG1vZHVsZSB0dXJmL3JlbW92ZVxuICogQGNhdGVnb3J5IGRhdGFcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IGZlYXR1cmVzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2YgYW55IHR5cGVcbiAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eSB0aGUgcHJvcGVydHkgdG8gZmlsdGVyXG4gKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgdGhlIHZhbHVlIHRvIGZpbHRlclxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IHRoZSByZXN1bHRpbmcgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aG91dCBmZWF0dXJlcyB0aGF0IG1hdGNoIHRoZSBwcm9wZXJ0eS12YWx1ZSBwYWlyXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgJ21hcmtlci1jb2xvcic6ICcjMDBmJ1xuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstMC4yMzUwMDQsIDUuNTUxOTE4XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgICdtYXJrZXItY29sb3InOiAnI2YwMCdcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTAuMjA5NTk4LCA1LjU2NDM5XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgICdtYXJrZXItY29sb3InOiAnIzAwZidcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTAuMTk3NzUzLCA1LjU1NjAxOF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICAnbWFya2VyLWNvbG9yJzogJyMwMDAnXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy0wLjIxNzMyMywgNS41NDk1MjZdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgJ21hcmtlci1jb2xvcic6ICcjMGYwJ1xuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstMC4yMTEzMTUsIDUuNTQzODg3XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgICdtYXJrZXItY29sb3InOiAnIzAwZidcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTAuMjAyMjE3LCA1LjU0NzEzNF1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICAnbWFya2VyLWNvbG9yJzogJyMwZjAnXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy0wLjIzMTIyNywgNS41NjY0NF1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKlxuICogLy89cG9pbnRzXG4gKlxuICogdmFyIGZpbHRlcmVkID0gdHVyZi5yZW1vdmUocG9pbnRzLCAnbWFya2VyLWNvbG9yJywgJyMwMGYnKTtcbiAqXG4gKiAvLz1maWx0ZXJlZFxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oY29sbGVjdGlvbiwga2V5LCB2YWwpIHtcbiAgdmFyIG5ld0ZDID0gZmVhdHVyZUNvbGxlY3Rpb24oW10pO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgY29sbGVjdGlvbi5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICAgIGlmKGNvbGxlY3Rpb24uZmVhdHVyZXNbaV0ucHJvcGVydGllc1trZXldICE9IHZhbCkge1xuICAgICAgbmV3RkMuZmVhdHVyZXMucHVzaChjb2xsZWN0aW9uLmZlYXR1cmVzW2ldKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG5ld0ZDO1xufTtcbiIsIi8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTE5MzUxNzUvc2FtcGxpbmctYS1yYW5kb20tc3Vic2V0LWZyb20tYW4tYXJyYXlcbnZhciBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gYW5kIHJldHVybnMgYSBGZWF0dXJlQ29sbGVjdGlvbiB3aXRoIGdpdmVuIG51bWJlciBvZiB7QGxpbmsgRmVhdHVyZXxmZWF0dXJlc30gYXQgcmFuZG9tLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9zYW1wbGVcbiAqIEBjYXRlZ29yeSBkYXRhXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBmZWF0dXJlcyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIGFueSB0eXBlXG4gKiBAcGFyYW0ge251bWJlcn0gbiBudW1iZXIgb2YgZmVhdHVyZXMgdG8gc2VsZWN0XG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiB3aXRoIGBuYCBmZWF0dXJlc1xuICogQGV4YW1wbGVcbiAqIHZhciBwb2ludHMgPSB0dXJmLnJhbmRvbSgncG9pbnRzJywgMTAwMCk7XG4gKlxuICogLy89cG9pbnRzXG4gKlxuICogdmFyIHNhbXBsZSA9IHR1cmYuc2FtcGxlKHBvaW50cywgMTApO1xuICpcbiAqIC8vPXNhbXBsZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZjLCBudW0pe1xuICB2YXIgb3V0RkMgPSBmZWF0dXJlQ29sbGVjdGlvbihnZXRSYW5kb21TdWJhcnJheShmYy5mZWF0dXJlcywgbnVtKSk7XG4gIHJldHVybiBvdXRGQztcbn07XG5cbmZ1bmN0aW9uIGdldFJhbmRvbVN1YmFycmF5KGFyciwgc2l6ZSkge1xuICB2YXIgc2h1ZmZsZWQgPSBhcnIuc2xpY2UoMCksIGkgPSBhcnIubGVuZ3RoLCBtaW4gPSBpIC0gc2l6ZSwgdGVtcCwgaW5kZXg7XG4gIHdoaWxlIChpLS0gPiBtaW4pIHtcbiAgICAgIGluZGV4ID0gTWF0aC5mbG9vcigoaSArIDEpICogTWF0aC5yYW5kb20oKSk7XG4gICAgICB0ZW1wID0gc2h1ZmZsZWRbaW5kZXhdO1xuICAgICAgc2h1ZmZsZWRbaW5kZXhdID0gc2h1ZmZsZWRbaV07XG4gICAgICBzaHVmZmxlZFtpXSA9IHRlbXA7XG4gIH1cbiAgcmV0dXJuIHNodWZmbGVkLnNsaWNlKG1pbik7XG59XG4iLCJ2YXIgc2ltcGxpZnkgPSByZXF1aXJlKCdzaW1wbGlmeS1qcycpO1xuXG4vKipcbiAqIFRha2VzIGEge0BsaW5rIExpbmVTdHJpbmd9IG9yIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlIGFuZCByZXR1cm5zIGEgc2ltcGxpZmllZCB2ZXJzaW9uLiBJbnRlcm5hbGx5IHVzZXMgW3NpbXBsaWZ5LWpzXShodHRwOi8vbW91cm5lci5naXRodWIuaW8vc2ltcGxpZnktanMvKSB0byBwZXJmb3JtIHNpbXBsaWZpY2F0aW9uLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9zaW1wbGlmeVxuICogQGNhdGVnb3J5IHRyYW5zZm9ybWF0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmV9IGZlYXR1cmUgYSB7QGxpbmsgTGluZVN0cmluZ30gb3Ige0BsaW5rIFBvbHlnb259IGZlYXR1cmUgdG8gYmUgc2ltcGxpZmllZFxuICogQHBhcmFtIHtudW1iZXJ9IHRvbGVyYW5jZSBzaW1wbGlmaWNhdGlvbiB0b2xlcmFuY2VcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaGlnaFF1YWxpdHkgd2hldGhlciBvciBub3QgdG8gc3BlbmQgbW9yZSB0aW1lIHRvIGNyZWF0ZVxuICogYSBoaWdoZXItcXVhbGl0eSBzaW1wbGlmaWNhdGlvbiB3aXRoIGEgZGlmZmVyZW50IGFsZ29yaXRobVxuICogQHJldHVybiB7RmVhdHVyZX0gYSBzaW1wbGlmaWVkIGZlYXR1cmVcbiAqIEBleGFtcGxlXG4gICogdmFyIGZlYXR1cmUgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWy03MC42MDM2MzcsIC0zMy4zOTk5MThdLFxuICogICAgICAgWy03MC42MTQ2MjQsIC0zMy4zOTUzMzJdLFxuICogICAgICAgWy03MC42MzkzNDMsIC0zMy4zOTI0NjZdLFxuICogICAgICAgWy03MC42NTk5NDIsIC0zMy4zOTQ3NTldLFxuICogICAgICAgWy03MC42ODM5NzUsIC0zMy40MDQ1MDRdLFxuICogICAgICAgWy03MC42OTcwMjEsIC0zMy40MTk0MDZdLFxuICogICAgICAgWy03MC43MDExNDEsIC0zMy40MzQzMDZdLFxuICogICAgICAgWy03MC43MDA0NTQsIC0zMy40NDYzMzldLFxuICogICAgICAgWy03MC42OTQyNzQsIC0zMy40NTgzNjldLFxuICogICAgICAgWy03MC42ODI2MDEsIC0zMy40NjU4MTZdLFxuICogICAgICAgWy03MC42Njg4NjksIC0zMy40NzIxMTddLFxuICogICAgICAgWy03MC42NDYyMDksIC0zMy40NzM4MzVdLFxuICogICAgICAgWy03MC42MjQ5MjMsIC0zMy40NzIxMTddLFxuICogICAgICAgWy03MC42MDk4MTcsIC0zMy40NjgxMDddLFxuICogICAgICAgWy03MC41OTUzOTcsIC0zMy40NTgzNjldLFxuICogICAgICAgWy03MC41ODcxNTgsIC0zMy40NDI5MDFdLFxuICogICAgICAgWy03MC41ODcxNTgsIC0zMy40MjYyODNdLFxuICogICAgICAgWy03MC41OTA1OTEsIC0zMy40MTQyNDhdLFxuICogICAgICAgWy03MC41OTQ3MTEsIC0zMy40MDYyMjRdLFxuICogICAgICAgWy03MC42MDM2MzcsIC0zMy4zOTk5MThdXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcblxuICogdmFyIHRvbGVyYW5jZSA9IDAuMDE7XG4gKlxuICogdmFyIHNpbXBsaWZpZWQgPSB0dXJmLnNpbXBsaWZ5KFxuICogIGZlYXR1cmUsIHRvbGVyYW5jZSwgZmFsc2UpO1xuICpcbiAqIC8vPWZlYXR1cmVcbiAqXG4gKiAvLz1zaW1wbGlmaWVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZmVhdHVyZSwgdG9sZXJhbmNlLCBoaWdoUXVhbGl0eSl7XG4gIGlmKGZlYXR1cmUuZ2VvbWV0cnkudHlwZSA9PT0gJ0xpbmVTdHJpbmcnKSB7XG4gICAgdmFyIGxpbmUgPSB7XG4gICAgICB0eXBlOiAnTGluZVN0cmluZycsXG4gICAgICBjb29yZGluYXRlczogW11cbiAgICB9O1xuICAgIHZhciBwdHMgPSBmZWF0dXJlLmdlb21ldHJ5LmNvb3JkaW5hdGVzLm1hcChmdW5jdGlvbihjb29yZCkge1xuICAgICAgcmV0dXJuIHt4OiBjb29yZFswXSwgeTogY29vcmRbMV19O1xuICAgIH0pO1xuICAgIGxpbmUuY29vcmRpbmF0ZXMgPSBzaW1wbGlmeShwdHMsIHRvbGVyYW5jZSwgaGlnaFF1YWxpdHkpLm1hcChmdW5jdGlvbihjb29yZHMpe1xuICAgICAgcmV0dXJuIFtjb29yZHMueCwgY29vcmRzLnldO1xuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBzaW1wbGVGZWF0dXJlKGxpbmUsIGZlYXR1cmUucHJvcGVydGllcyk7XG4gIH0gZWxzZSBpZihmZWF0dXJlLmdlb21ldHJ5LnR5cGUgPT09ICdQb2x5Z29uJykge1xuICAgIHZhciBwb2x5ID0ge1xuICAgICAgdHlwZTogJ1BvbHlnb24nLFxuICAgICAgY29vcmRpbmF0ZXM6IFtdXG4gICAgfTtcbiAgICBmZWF0dXJlLmdlb21ldHJ5LmNvb3JkaW5hdGVzLmZvckVhY2goZnVuY3Rpb24ocmluZyl7XG4gICAgICB2YXIgcHRzID0gcmluZy5tYXAoZnVuY3Rpb24oY29vcmQpIHtcbiAgICAgICAgcmV0dXJuIHt4OiBjb29yZFswXSwgeTogY29vcmRbMV19O1xuICAgICAgfSk7XG4gICAgICB2YXIgc2ltcGxlUmluZyA9IHNpbXBsaWZ5KHB0cywgdG9sZXJhbmNlLCBoaWdoUXVhbGl0eSkubWFwKGZ1bmN0aW9uKGNvb3Jkcyl7XG4gICAgICAgIHJldHVybiBbY29vcmRzLngsIGNvb3Jkcy55XTtcbiAgICAgIH0pO1xuICAgICAgcG9seS5jb29yZGluYXRlcy5wdXNoKHNpbXBsZVJpbmcpO1xuICAgIH0pO1xuICAgIHJldHVybiBzaW1wbGVGZWF0dXJlKHBvbHksIGZlYXR1cmUucHJvcGVydGllcylcbiAgfVxufVxuXG5mdW5jdGlvbiBzaW1wbGVGZWF0dXJlIChnZW9tLCBwcm9wZXJ0aWVzKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0ZlYXR1cmUnLFxuICAgIGdlb21ldHJ5OiBnZW9tLFxuICAgIHByb3BlcnRpZXM6IHByb3BlcnRpZXNcbiAgfTtcbn1cbiIsIi8qXG4gKGMpIDIwMTMsIFZsYWRpbWlyIEFnYWZvbmtpblxuIFNpbXBsaWZ5LmpzLCBhIGhpZ2gtcGVyZm9ybWFuY2UgSlMgcG9seWxpbmUgc2ltcGxpZmljYXRpb24gbGlicmFyeVxuIG1vdXJuZXIuZ2l0aHViLmlvL3NpbXBsaWZ5LWpzXG4qL1xuXG4oZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbi8vIHRvIHN1aXQgeW91ciBwb2ludCBmb3JtYXQsIHJ1biBzZWFyY2gvcmVwbGFjZSBmb3IgJy54JyBhbmQgJy55Jztcbi8vIGZvciAzRCB2ZXJzaW9uLCBzZWUgM2QgYnJhbmNoIChjb25maWd1cmFiaWxpdHkgd291bGQgZHJhdyBzaWduaWZpY2FudCBwZXJmb3JtYW5jZSBvdmVyaGVhZClcblxuLy8gc3F1YXJlIGRpc3RhbmNlIGJldHdlZW4gMiBwb2ludHNcbmZ1bmN0aW9uIGdldFNxRGlzdChwMSwgcDIpIHtcblxuICAgIHZhciBkeCA9IHAxLnggLSBwMi54LFxuICAgICAgICBkeSA9IHAxLnkgLSBwMi55O1xuXG4gICAgcmV0dXJuIGR4ICogZHggKyBkeSAqIGR5O1xufVxuXG4vLyBzcXVhcmUgZGlzdGFuY2UgZnJvbSBhIHBvaW50IHRvIGEgc2VnbWVudFxuZnVuY3Rpb24gZ2V0U3FTZWdEaXN0KHAsIHAxLCBwMikge1xuXG4gICAgdmFyIHggPSBwMS54LFxuICAgICAgICB5ID0gcDEueSxcbiAgICAgICAgZHggPSBwMi54IC0geCxcbiAgICAgICAgZHkgPSBwMi55IC0geTtcblxuICAgIGlmIChkeCAhPT0gMCB8fCBkeSAhPT0gMCkge1xuXG4gICAgICAgIHZhciB0ID0gKChwLnggLSB4KSAqIGR4ICsgKHAueSAtIHkpICogZHkpIC8gKGR4ICogZHggKyBkeSAqIGR5KTtcblxuICAgICAgICBpZiAodCA+IDEpIHtcbiAgICAgICAgICAgIHggPSBwMi54O1xuICAgICAgICAgICAgeSA9IHAyLnk7XG5cbiAgICAgICAgfSBlbHNlIGlmICh0ID4gMCkge1xuICAgICAgICAgICAgeCArPSBkeCAqIHQ7XG4gICAgICAgICAgICB5ICs9IGR5ICogdDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGR4ID0gcC54IC0geDtcbiAgICBkeSA9IHAueSAtIHk7XG5cbiAgICByZXR1cm4gZHggKiBkeCArIGR5ICogZHk7XG59XG4vLyByZXN0IG9mIHRoZSBjb2RlIGRvZXNuJ3QgY2FyZSBhYm91dCBwb2ludCBmb3JtYXRcblxuLy8gYmFzaWMgZGlzdGFuY2UtYmFzZWQgc2ltcGxpZmljYXRpb25cbmZ1bmN0aW9uIHNpbXBsaWZ5UmFkaWFsRGlzdChwb2ludHMsIHNxVG9sZXJhbmNlKSB7XG5cbiAgICB2YXIgcHJldlBvaW50ID0gcG9pbnRzWzBdLFxuICAgICAgICBuZXdQb2ludHMgPSBbcHJldlBvaW50XSxcbiAgICAgICAgcG9pbnQ7XG5cbiAgICBmb3IgKHZhciBpID0gMSwgbGVuID0gcG9pbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHBvaW50ID0gcG9pbnRzW2ldO1xuXG4gICAgICAgIGlmIChnZXRTcURpc3QocG9pbnQsIHByZXZQb2ludCkgPiBzcVRvbGVyYW5jZSkge1xuICAgICAgICAgICAgbmV3UG9pbnRzLnB1c2gocG9pbnQpO1xuICAgICAgICAgICAgcHJldlBvaW50ID0gcG9pbnQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocHJldlBvaW50ICE9PSBwb2ludCkgbmV3UG9pbnRzLnB1c2gocG9pbnQpO1xuXG4gICAgcmV0dXJuIG5ld1BvaW50cztcbn1cblxuLy8gc2ltcGxpZmljYXRpb24gdXNpbmcgb3B0aW1pemVkIERvdWdsYXMtUGV1Y2tlciBhbGdvcml0aG0gd2l0aCByZWN1cnNpb24gZWxpbWluYXRpb25cbmZ1bmN0aW9uIHNpbXBsaWZ5RG91Z2xhc1BldWNrZXIocG9pbnRzLCBzcVRvbGVyYW5jZSkge1xuXG4gICAgdmFyIGxlbiA9IHBvaW50cy5sZW5ndGgsXG4gICAgICAgIE1hcmtlckFycmF5ID0gdHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnID8gVWludDhBcnJheSA6IEFycmF5LFxuICAgICAgICBtYXJrZXJzID0gbmV3IE1hcmtlckFycmF5KGxlbiksXG4gICAgICAgIGZpcnN0ID0gMCxcbiAgICAgICAgbGFzdCA9IGxlbiAtIDEsXG4gICAgICAgIHN0YWNrID0gW10sXG4gICAgICAgIG5ld1BvaW50cyA9IFtdLFxuICAgICAgICBpLCBtYXhTcURpc3QsIHNxRGlzdCwgaW5kZXg7XG5cbiAgICBtYXJrZXJzW2ZpcnN0XSA9IG1hcmtlcnNbbGFzdF0gPSAxO1xuXG4gICAgd2hpbGUgKGxhc3QpIHtcblxuICAgICAgICBtYXhTcURpc3QgPSAwO1xuXG4gICAgICAgIGZvciAoaSA9IGZpcnN0ICsgMTsgaSA8IGxhc3Q7IGkrKykge1xuICAgICAgICAgICAgc3FEaXN0ID0gZ2V0U3FTZWdEaXN0KHBvaW50c1tpXSwgcG9pbnRzW2ZpcnN0XSwgcG9pbnRzW2xhc3RdKTtcblxuICAgICAgICAgICAgaWYgKHNxRGlzdCA+IG1heFNxRGlzdCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBtYXhTcURpc3QgPSBzcURpc3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWF4U3FEaXN0ID4gc3FUb2xlcmFuY2UpIHtcbiAgICAgICAgICAgIG1hcmtlcnNbaW5kZXhdID0gMTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2goZmlyc3QsIGluZGV4LCBpbmRleCwgbGFzdCk7XG4gICAgICAgIH1cblxuICAgICAgICBsYXN0ID0gc3RhY2sucG9wKCk7XG4gICAgICAgIGZpcnN0ID0gc3RhY2sucG9wKCk7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChtYXJrZXJzW2ldKSBuZXdQb2ludHMucHVzaChwb2ludHNbaV0pO1xuICAgIH1cblxuICAgIHJldHVybiBuZXdQb2ludHM7XG59XG5cbi8vIGJvdGggYWxnb3JpdGhtcyBjb21iaW5lZCBmb3IgYXdlc29tZSBwZXJmb3JtYW5jZVxuZnVuY3Rpb24gc2ltcGxpZnkocG9pbnRzLCB0b2xlcmFuY2UsIGhpZ2hlc3RRdWFsaXR5KSB7XG5cbiAgICB2YXIgc3FUb2xlcmFuY2UgPSB0b2xlcmFuY2UgIT09IHVuZGVmaW5lZCA/IHRvbGVyYW5jZSAqIHRvbGVyYW5jZSA6IDE7XG5cbiAgICBwb2ludHMgPSBoaWdoZXN0UXVhbGl0eSA/IHBvaW50cyA6IHNpbXBsaWZ5UmFkaWFsRGlzdChwb2ludHMsIHNxVG9sZXJhbmNlKTtcbiAgICBwb2ludHMgPSBzaW1wbGlmeURvdWdsYXNQZXVja2VyKHBvaW50cywgc3FUb2xlcmFuY2UpO1xuXG4gICAgcmV0dXJuIHBvaW50cztcbn1cblxuLy8gZXhwb3J0IGFzIEFNRCBtb2R1bGUgLyBOb2RlIG1vZHVsZSAvIGJyb3dzZXIgb3Igd29ya2VyIHZhcmlhYmxlXG5pZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoZnVuY3Rpb24oKSB7IHJldHVybiBzaW1wbGlmeTsgfSk7XG5lbHNlIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykgbW9kdWxlLmV4cG9ydHMgPSBzaW1wbGlmeTtcbmVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykgc2VsZi5zaW1wbGlmeSA9IHNpbXBsaWZ5O1xuZWxzZSB3aW5kb3cuc2ltcGxpZnkgPSBzaW1wbGlmeTtcblxufSkoKTtcbiIsIi8qKlxuICogVGFrZXMgYSBib3VuZGluZyBib3ggYW5kIHJldHVybnMgYSBuZXcgYm91bmRpbmcgYm94IHdpdGggYSBzaXplIGV4cGFuZGVkIG9yIGNvbnRyYWN0ZWRcbiAqIGJ5IGEgZmFjdG9yIG9mIFguXG4gKlxuICogQG1vZHVsZSB0dXJmL3NpemVcbiAqIEBjYXRlZ29yeSBtZWFzdXJlbWVudFxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBiYm94IGEgYm91bmRpbmcgYm94XG4gKiBAcGFyYW0ge251bWJlcn0gZmFjdG9yIHRoZSByYXRpbyBvZiB0aGUgbmV3IGJib3ggdG8gdGhlIGlucHV0IGJib3hcbiAqIEByZXR1cm4ge0FycmF5PG51bWJlcj59IHRoZSByZXNpemVkIGJib3hcbiAqIEBleGFtcGxlXG4gKiB2YXIgYmJveCA9IFswLCAwLCAxMCwgMTBdXG4gKlxuICogdmFyIHJlc2l6ZWQgPSB0dXJmLnNpemUoYmJveCwgMik7XG4gKlxuICogdmFyIGZlYXR1cmVzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB0dXJmLmJib3hQb2x5Z29uKGJib3gpLFxuICogICAgIHR1cmYuYmJveFBvbHlnb24ocmVzaXplZClcbiAqICAgXVxuICogfTtcbiAqXG4gKiAvLz1mZWF0dXJlc1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGJib3gsIGZhY3Rvcil7XG4gIHZhciBjdXJyZW50WERpc3RhbmNlID0gKGJib3hbMl0gLSBiYm94WzBdKTtcbiAgdmFyIGN1cnJlbnRZRGlzdGFuY2UgPSAoYmJveFszXSAtIGJib3hbMV0pO1xuICB2YXIgbmV3WERpc3RhbmNlID0gY3VycmVudFhEaXN0YW5jZSAqIGZhY3RvcjtcbiAgdmFyIG5ld1lEaXN0YW5jZSA9IGN1cnJlbnRZRGlzdGFuY2UgKiBmYWN0b3I7XG4gIHZhciB4Q2hhbmdlID0gbmV3WERpc3RhbmNlIC0gY3VycmVudFhEaXN0YW5jZTtcbiAgdmFyIHlDaGFuZ2UgPSBuZXdZRGlzdGFuY2UgLSBjdXJyZW50WURpc3RhbmNlO1xuXG4gIHZhciBsb3dYID0gYmJveFswXSAtICh4Q2hhbmdlIC8gMik7XG4gIHZhciBsb3dZID0gYmJveFsxXSAtICh5Q2hhbmdlIC8gMik7XG4gIHZhciBoaWdoWCA9ICh4Q2hhbmdlIC8gMikgKyBiYm94WzJdO1xuICB2YXIgaGlnaFkgPSAoeUNoYW5nZSAvIDIpICsgYmJveFszXTtcblxuICB2YXIgc2l6ZWQgPSBbbG93WCwgbG93WSwgaGlnaFgsIGhpZ2hZXTtcbiAgcmV0dXJuIHNpemVkO1xufVxuIiwidmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xudmFyIHBvbHlnb24gPSByZXF1aXJlKCd0dXJmLXBvbHlnb24nKTtcbnZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcblxuLyoqXG4gKiBUYWtlcyBhIGJvdW5kaW5nIGJveCBhbmQgYSBjZWxsIGRlcHRoIGFuZCByZXR1cm5zIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgaW4gYSBncmlkLlxuICpcbiAqIEBtb2R1bGUgdHVyZi9zcXVhcmUtZ3JpZFxuICogQGNhdGVnb3J5IGludGVycG9sYXRpb25cbiAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyPn0gZXh0ZW50IGV4dGVudCBpbiBbbWluWCwgbWluWSwgbWF4WCwgbWF4WV0gb3JkZXJcbiAqIEBwYXJhbSB7TnVtYmVyfSBjZWxsV2lkdGggd2lkdGggb2YgZWFjaCBjZWxsXG4gKiBAcGFyYW0ge1N0cmluZ30gdW5pdHMgdW5pdHMgdG8gdXNlIGZvciBjZWxsV2lkdGhcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBncmlkIGFzIEZlYXR1cmVDb2xsZWN0aW9uIHdpdGgge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGV4dGVudCA9IFstNzcuMzg3Njk1MzEyNSwzOC43MTk4MDQ3NDI2NDIzOSwtNzYuOTQ4MjQyMTg3NSwzOS4wMjc3MTg4NDAyMTE2MDVdO1xuICogdmFyIGNlbGxXaWR0aCA9IDEwO1xuICogdmFyIHVuaXRzID0gJ21pbGVzJztcbiAqXG4gKiB2YXIgc3F1YXJlR3JpZCA9IHR1cmYuc3F1YXJlR3JpZChleHRlbnQsIGNlbGxXaWR0aCwgdW5pdHMpO1xuICpcbiAqIC8vPXNxdWFyZUdyaWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoYmJveCwgY2VsbCwgdW5pdHMpIHtcbiAgdmFyIGZjID0gZmVhdHVyZWNvbGxlY3Rpb24oW10pO1xuICB2YXIgeEZyYWN0aW9uID0gY2VsbCAvIChkaXN0YW5jZShwb2ludChbYmJveFswXSwgYmJveFsxXV0pLCBwb2ludChbYmJveFsyXSwgYmJveFsxXV0pLCB1bml0cykpO1xuICB2YXIgY2VsbFdpZHRoID0geEZyYWN0aW9uICogKGJib3hbMl0gLSBiYm94WzBdKTtcbiAgdmFyIHlGcmFjdGlvbiA9IGNlbGwgLyAoZGlzdGFuY2UocG9pbnQoW2Jib3hbMF0sIGJib3hbMV1dKSwgcG9pbnQoW2Jib3hbMF0sIGJib3hbM11dKSwgdW5pdHMpKTtcbiAgdmFyIGNlbGxIZWlnaHQgPSB5RnJhY3Rpb24gKiAoYmJveFszXSAtIGJib3hbMV0pO1xuXG4gIHZhciBjdXJyZW50WCA9IGJib3hbMF07XG4gIHdoaWxlIChjdXJyZW50WCA8PSBiYm94WzJdKSB7XG4gICAgdmFyIGN1cnJlbnRZID0gYmJveFsxXTtcbiAgICB3aGlsZSAoY3VycmVudFkgPD0gYmJveFszXSkge1xuICAgICAgdmFyIGNlbGxQb2x5ID0gcG9seWdvbihbW1xuICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldLFxuICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFldLFxuICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldXG4gICAgICAgIF1dKTtcbiAgICAgIGZjLmZlYXR1cmVzLnB1c2goY2VsbFBvbHkpO1xuXG4gICAgICBjdXJyZW50WSArPSBjZWxsSGVpZ2h0O1xuICAgIH1cbiAgICBjdXJyZW50WCArPSBjZWxsV2lkdGg7XG4gIH1cbiAgXG4gIHJldHVybiBmYztcbn1cbiIsInZhciBtaWRwb2ludCA9IHJlcXVpcmUoJ3R1cmYtbWlkcG9pbnQnKTtcbnZhciBwb2ludCA9IHJlcXVpcmUoJ3R1cmYtcG9pbnQnKTtcbnZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcblxuLyoqXG4gKiBUYWtlcyBhIGJvdW5kaW5nIGJveCBhbmQgY2FsY3VsYXRlcyB0aGUgbWluaW11bSBzcXVhcmUgYm91bmRpbmcgYm94IHRoYXQgd291bGQgY29udGFpbiB0aGUgaW5wdXQuXG4gKlxuICogQG1vZHVsZSB0dXJmL3NxdWFyZVxuICogQGNhdGVnb3J5IG1lYXN1cmVtZW50XG4gKiBAcGFyYW0ge0FycmF5PG51bWJlcj59IGJib3ggYSBib3VuZGluZyBib3hcbiAqIEByZXR1cm4ge0FycmF5PG51bWJlcj59IGEgc3F1YXJlIHN1cnJvdW5kaW5nIGBiYm94YFxuICogQGV4YW1wbGVcbiAqIHZhciBiYm94ID0gWy0yMCwtMjAsLTE1LDBdO1xuICpcbiAqIHZhciBzcXVhcmVkID0gdHVyZi5zcXVhcmUoYmJveCk7XG4gKlxuICogdmFyIGZlYXR1cmVzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB0dXJmLmJib3hQb2x5Z29uKGJib3gpLFxuICogICAgIHR1cmYuYmJveFBvbHlnb24oc3F1YXJlZClcbiAqICAgXVxuICogfTtcbiAqXG4gKiAvLz1mZWF0dXJlc1xuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGJib3gpe1xuICB2YXIgc3F1YXJlQmJveCA9IFswLDAsMCwwXTtcbiAgdmFyIGxvd0xlZnQgPSBwb2ludChbYmJveFswXSwgYmJveFsxXV0pO1xuICB2YXIgdG9wTGVmdCA9IHBvaW50KFtiYm94WzBdLCBiYm94WzNdXSk7XG4gIHZhciB0b3BSaWdodCA9IHBvaW50KFtiYm94WzJdLCBiYm94WzNdXSk7XG4gIHZhciBsb3dSaWdodCA9IHBvaW50KFtiYm94WzJdLCBiYm94WzFdXSk7XG5cbiAgdmFyIGhvcml6b250YWxEaXN0YW5jZSA9IGRpc3RhbmNlKGxvd0xlZnQsIGxvd1JpZ2h0LCAnbWlsZXMnKTtcbiAgdmFyIHZlcnRpY2FsRGlzdGFuY2UgPSBkaXN0YW5jZShsb3dMZWZ0LCB0b3BMZWZ0LCAnbWlsZXMnKTtcbiAgaWYoaG9yaXpvbnRhbERpc3RhbmNlID49IHZlcnRpY2FsRGlzdGFuY2Upe1xuICAgIHNxdWFyZUJib3hbMF0gPSBiYm94WzBdO1xuICAgIHNxdWFyZUJib3hbMl0gPSBiYm94WzJdO1xuICAgIHZhciB2ZXJ0aWNhbE1pZHBvaW50ID0gbWlkcG9pbnQobG93TGVmdCwgdG9wTGVmdCk7XG4gICAgc3F1YXJlQmJveFsxXSA9IHZlcnRpY2FsTWlkcG9pbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0gLSAoKGJib3hbMl0gLSBiYm94WzBdKSAvIDIpO1xuICAgIHNxdWFyZUJib3hbM10gPSB2ZXJ0aWNhbE1pZHBvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdICsgKChiYm94WzJdIC0gYmJveFswXSkgLyAyKTtcbiAgICByZXR1cm4gc3F1YXJlQmJveDtcbiAgfVxuICBlbHNlIHtcbiAgICBzcXVhcmVCYm94WzFdID0gYmJveFsxXTtcbiAgICBzcXVhcmVCYm94WzNdID0gYmJveFszXTtcbiAgICB2YXIgaG9yem9udGFsTWlkcG9pbnQgPSBtaWRwb2ludChsb3dMZWZ0LCBsb3dSaWdodCk7XG4gICAgc3F1YXJlQmJveFswXSA9IGhvcnpvbnRhbE1pZHBvaW50Lmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdIC0gKChiYm94WzNdIC0gYmJveFsxXSkgLyAyKTtcbiAgICBzcXVhcmVCYm94WzJdID0gaG9yem9udGFsTWlkcG9pbnQuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0gKyAoKGJib3hbM10gLSBiYm94WzFdKSAvIDIpO1xuICAgIHJldHVybiBzcXVhcmVCYm94O1xuICB9XG59XG5cbiIsInZhciBpbnNpZGUgPSByZXF1aXJlKCd0dXJmLWluc2lkZScpO1xuXG4vKipcbiAqIENhbGN1bGF0ZXMgdGhlIHN1bSBvZiBhIGZpZWxkIGZvciB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIHdpdGhpbiBhIHNldCBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMuXG4gKlxuICogQG1vZHVsZSB0dXJmL3N1bVxuICogQGNhdGVnb3J5IGFnZ3JlZ2F0aW9uXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2x5Z29ucyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtTdHJpbmd9IGluRmllbGQgdGhlIGZpZWxkIGluIGlucHV0IGRhdGEgdG8gYW5hbHl6ZVxuICogQHBhcmFtIHtTdHJpbmd9IG91dEZpZWxkIHRoZSBmaWVsZCBpbiB3aGljaCB0byBzdG9yZSByZXN1bHRzXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIHdpdGggcHJvcGVydGllcyBsaXN0ZWQgYXMgYG91dEZpZWxkYFxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstODcuOTkwMTg4LCA0My4wMjY0ODZdLFxuICogICAgICAgICAgIFstODcuOTkwMTg4LCA0My4wNjIxMTVdLFxuICogICAgICAgICAgIFstODcuOTEzMjg0LCA0My4wNjIxMTVdLFxuICogICAgICAgICAgIFstODcuOTEzMjg0LCA0My4wMjY0ODZdLFxuICogICAgICAgICAgIFstODcuOTkwMTg4LCA0My4wMjY0ODZdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvbHlnb25cIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgICAgIFstODcuOTczNzA5LCA0Mi45NjI0NTJdLFxuICogICAgICAgICAgIFstODcuOTczNzA5LCA0My4wMTQ2ODldLFxuICogICAgICAgICAgIFstODcuOTA0MDE0LCA0My4wMTQ2ODldLFxuICogICAgICAgICAgIFstODcuOTA0MDE0LCA0Mi45NjI0NTJdLFxuICogICAgICAgICAgIFstODcuOTczNzA5LCA0Mi45NjI0NTJdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstODcuOTc0MDUyLCA0My4wNDkzMjFdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDYwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstODcuOTU3MjI5LCA0My4wMzcyNzddXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDEwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstODcuOTMxMTM3LCA0My4wNDg1NjhdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDIwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstODcuOTYzNDA5LCA0Mi45OTYxMV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMzAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy04Ny45NDE3OCwgNDIuOTc0NzYyXVxuICogICAgICAgfVxuICogICAgIH1cbiAqICAgXVxuICogfTtcbiAqXG4gKiB2YXIgYWdncmVnYXRlZCA9IHR1cmYuc3VtKFxuICogICBwb2x5Z29ucywgcG9pbnRzLCAncG9wdWxhdGlvbicsICdzdW0nKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KFxuICogICBhZ2dyZWdhdGVkLmZlYXR1cmVzKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9seUZDLCBwdEZDLCBpbkZpZWxkLCBvdXRGaWVsZCl7XG4gIHBvbHlGQy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHBvbHkpe1xuICAgIGlmKCFwb2x5LnByb3BlcnRpZXMpe1xuICAgICAgcG9seS5wcm9wZXJ0aWVzID0ge307XG4gICAgfVxuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICBwdEZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocHQpe1xuICAgICAgaWYgKGluc2lkZShwdCwgcG9seSkpIHtcbiAgICAgICAgdmFsdWVzLnB1c2gocHQucHJvcGVydGllc1tpbkZpZWxkXSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcG9seS5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IHN1bSh2YWx1ZXMpO1xuICB9KTtcblxuICByZXR1cm4gcG9seUZDO1xufTtcblxuZnVuY3Rpb24gc3VtKHgpIHtcbiAgICB2YXIgdmFsdWUgPSAwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YWx1ZSArPSB4W2ldO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG4iLCJ2YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyBhbmQgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgYW5kIHBlcmZvcm1zIGEgc3BhdGlhbCBqb2luLlxuICpcbiAqIEBtb2R1bGUgdHVyZi90YWdcbiAqIEBjYXRlZ29yeSBqb2luc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlc1xuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9seWdvbnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7U3RyaW5nfSBwb2x5SWQgcHJvcGVydHkgaW4gYHBvbHlnb25zYCB0byBhZGQgdG8gam9pbmVkIFBvaW50IGZlYXR1cmVzXG4gKiBAcGFyYW0ge1N0cmluZ30gY29udGFpbmluZ1BvbHlJZCBwcm9wZXJ0eSBpbiBgcG9pbnRzYCBpbiB3aGljaCB0byBzdG9yZSBqb2luZWQgcHJvcGVydHkgZnJvbSBgcG9seWdvbnNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHBvaW50IGZlYXR1cmVzXG4gKiBAZXhhbXBsZVxuICogdmFyIGJib3ggPSBbMCwgMCwgNTAsIDUwXTtcbiAqIC8vIGNyZWF0ZSBhIHRyaWFuZ3VsYXIgZ3JpZCBvZiBwb2x5Z29uc1xuICogdmFyIHRyaWFuZ2xlR3JpZCA9IHR1cmYudGluKHR1cmYuZ3JpZChiYm94LCAxMCkpO1xuICogdHJpYW5nbGVHcmlkLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24oZikge1xuICogICBmLnByb3BlcnRpZXMuZmlsbCA9ICcjJyArXG4gKiAgICAgKH5+KE1hdGgucmFuZG9tKCkgKiAxNikpLnRvU3RyaW5nKDE2KSArXG4gKiAgICAgKH5+KE1hdGgucmFuZG9tKCkgKiAxNikpLnRvU3RyaW5nKDE2KSArXG4gKiAgICAgKH5+KE1hdGgucmFuZG9tKCkgKiAxNikpLnRvU3RyaW5nKDE2KTtcbiAqICAgZi5wcm9wZXJ0aWVzLnN0cm9rZSA9IDA7XG4gKiAgIGYucHJvcGVydGllc1snZmlsbC1vcGFjaXR5J10gPSAxO1xuICogfSk7XG4gKiB2YXIgcmFuZG9tUG9pbnRzID0gdHVyZi5yYW5kb20oJ3BvaW50JywgMzAsIHtcbiAqICAgYmJveDogYmJveFxuICogfSk7XG4gKiB2YXIgYm90aCA9IHR1cmYuZmVhdHVyZWNvbGxlY3Rpb24oXG4gKiAgIHRyaWFuZ2xlR3JpZC5mZWF0dXJlcy5jb25jYXQocmFuZG9tUG9pbnRzLmZlYXR1cmVzKSk7XG4gKlxuICogLy89Ym90aFxuICpcbiAqIHZhciB0YWdnZWQgPSB0dXJmLnRhZyhyYW5kb21Qb2ludHMsIHRyaWFuZ2xlR3JpZCxcbiAqICAgICAgICAgICAgICAgICAgICAgICAnZmlsbCcsICdtYXJrZXItY29sb3InKTtcbiAqXG4gKiAvLz10YWdnZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwb2ludHMsIHBvbHlnb25zLCBmaWVsZCwgb3V0RmllbGQpe1xuICAvLyBwcmV2ZW50IG11dGF0aW9uc1xuICBwb2ludHMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHBvaW50cykpO1xuICBwb2x5Z29ucyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocG9seWdvbnMpKTtcbiAgcG9pbnRzLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocHQpIHtcbiAgICBpZiAoIXB0LnByb3BlcnRpZXMpIHtcbiAgICAgIHB0LnByb3BlcnRpZXMgPSB7fTtcbiAgICB9XG4gICAgcG9seWdvbnMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwb2x5KSB7XG4gICAgICBpZiAocHQucHJvcGVydGllc1tvdXRGaWVsZF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgaXNJbnNpZGUgPSBpbnNpZGUocHQsIHBvbHkpO1xuICAgICAgICBpZiAoaXNJbnNpZGUpIHtcbiAgICAgICAgICBwdC5wcm9wZXJ0aWVzW291dEZpZWxkXSA9IHBvbHkucHJvcGVydGllc1tmaWVsZF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiBwb2ludHM7XG59O1xuIiwiLy9odHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0RlbGF1bmF5X3RyaWFuZ3VsYXRpb25cbi8vaHR0cHM6Ly9naXRodWIuY29tL2lyb253YWxsYWJ5L2RlbGF1bmF5XG52YXIgcG9seWdvbiA9IHJlcXVpcmUoJ3R1cmYtcG9seWdvbicpO1xudmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xuXG4vKipcbiAqIFRha2VzIGEgc2V0IG9mIHBvaW50cyBhbmQgdGhlIG5hbWUgb2YgYSB6LXZhbHVlIHByb3BlcnR5IGFuZFxuICogY3JlYXRlcyBhIFtUcmlhbmd1bGF0ZWQgSXJyZWd1bGFyIE5ldHdvcmtdKGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVHJpYW5ndWxhdGVkX2lycmVndWxhcl9uZXR3b3JrKSxcbiAqIG9yIGEgVElOIGZvciBzaG9ydCwgcmV0dXJuZWQgYXMgYSBjb2xsZWN0aW9uIG9mIFBvbHlnb25zLiBUaGVzZSBhcmUgb2Z0ZW4gdXNlZFxuICogZm9yIGRldmVsb3BpbmcgZWxldmF0aW9uIGNvbnRvdXIgbWFwcyBvciBzdGVwcGVkIGhlYXQgdmlzdWFsaXphdGlvbnMuXG4gKlxuICogVGhpcyB0cmlhbmd1bGF0ZXMgdGhlIHBvaW50cywgYXMgd2VsbCBhcyBhZGRzIHByb3BlcnRpZXMgY2FsbGVkIGBhYCwgYGJgLFxuICogYW5kIGBjYCByZXByZXNlbnRpbmcgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBgcHJvcGVydHlOYW1lYCBhdCBlYWNoIG9mXG4gKiB0aGUgcG9pbnRzIHRoYXQgcmVwcmVzZW50IHRoZSBjb3JuZXJzIG9mIHRoZSB0cmlhbmdsZS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvdGluXG4gKiBAY2F0ZWdvcnkgaW50ZXJwb2xhdGlvblxuICogQHBhcmFtIHtGZWF0dXJlQ29sbGVjdGlvbn0gcG9pbnRzIC0gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uIGNvbnRhaW5pbmdcbiAqIEZlYXR1cmVzIHdpdGgge0BsaW5rIFBvaW50fSBnZW9tZXRyaWVzXG4gKiBAcGFyYW0ge3N0cmluZz19IHByb3BlcnR5TmFtZSAtIG5hbWUgb2YgdGhlIHByb3BlcnR5IGZyb20gd2hpY2ggdG8gcHVsbCB6IHZhbHVlcy5cbiAqIFRoaXMgaXMgb3B0aW9uYWw6IGlmIG5vdCBnaXZlbiwgdGhlbiB0aGVyZSB3aWxsIGJlIG5vIGV4dHJhIGRhdGEgYWRkZWQgdG8gdGhlIGRlcml2ZWQgdHJpYW5nbGVzLlxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IFRJTiBvdXRwdXRcbiAqIEBleGFtcGxlXG4gKiAvLyBnZW5lcmF0ZSBzb21lIHJhbmRvbSBwb2ludCBkYXRhXG4gKiB2YXIgcG9pbnRzID0gdHVyZi5yYW5kb20oJ3BvaW50cycsIDMwLCB7XG4gKiAgIGJib3g6IFs1MCwgMzAsIDcwLCA1MF1cbiAqIH0pO1xuICogLy89cG9pbnRzXG4gKiAvLyBhZGQgYSByYW5kb20gcHJvcGVydHkgdG8gZWFjaCBwb2ludCBiZXR3ZWVuIDAgYW5kIDlcbiAqIGZvciAodmFyIGkgPSAwOyBpIDwgcG9pbnRzLmZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7XG4gKiAgIHBvaW50cy5mZWF0dXJlc1tpXS5wcm9wZXJ0aWVzLnogPSB+fihNYXRoLnJhbmRvbSgpICogOSk7XG4gKiB9XG4gKiB2YXIgdGluID0gdHVyZi50aW4ocG9pbnRzLCAneicpXG4gKiBmb3IgKHZhciBpID0gMDsgaSA8IHRpbi5mZWF0dXJlcy5sZW5ndGg7IGkrKykge1xuICogICB2YXIgcHJvcGVydGllcyAgPSB0aW4uZmVhdHVyZXNbaV0ucHJvcGVydGllcztcbiAqICAgLy8gcm91Z2hseSB0dXJuIHRoZSBwcm9wZXJ0aWVzIG9mIGVhY2hcbiAqICAgLy8gdHJpYW5nbGUgaW50byBhIGZpbGwgY29sb3JcbiAqICAgLy8gc28gd2UgY2FuIHZpc3VhbGl6ZSB0aGUgcmVzdWx0XG4gKiAgIHByb3BlcnRpZXMuZmlsbCA9ICcjJyArIHByb3BlcnRpZXMuYSArXG4gKiAgICAgcHJvcGVydGllcy5iICsgcHJvcGVydGllcy5jO1xuICogfVxuICogLy89dGluXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocG9pbnRzLCB6KSB7XG4gIC8vYnJlYWsgZG93biBwb2ludHNcbiAgcmV0dXJuIGZlYXR1cmVjb2xsZWN0aW9uKHRyaWFuZ3VsYXRlKHBvaW50cy5mZWF0dXJlcy5tYXAoZnVuY3Rpb24ocCkge1xuICAgIHZhciBwb2ludCA9IHtcbiAgICAgIHg6IHAuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sXG4gICAgICB5OiBwLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdXG4gICAgfTtcbiAgICBpZiAoeikgcG9pbnQueiA9IHAucHJvcGVydGllc1t6XTtcbiAgICByZXR1cm4gcG9pbnQ7XG4gIH0pKS5tYXAoZnVuY3Rpb24odHJpYW5nbGUpIHtcbiAgICByZXR1cm4gcG9seWdvbihbW1xuICAgICAgICBbdHJpYW5nbGUuYS54LCB0cmlhbmdsZS5hLnldLFxuICAgICAgICBbdHJpYW5nbGUuYi54LCB0cmlhbmdsZS5iLnldLFxuICAgICAgICBbdHJpYW5nbGUuYy54LCB0cmlhbmdsZS5jLnldLFxuICAgICAgICBbdHJpYW5nbGUuYS54LCB0cmlhbmdsZS5hLnldXG4gICAgXV0sIHtcbiAgICAgICAgYTogdHJpYW5nbGUuYS56LFxuICAgICAgICBiOiB0cmlhbmdsZS5iLnosXG4gICAgICAgIGM6IHRyaWFuZ2xlLmMuelxuICAgICAgfSk7XG4gIH0pKTtcbn07XG5cbmZ1bmN0aW9uIFRyaWFuZ2xlKGEsIGIsIGMpIHtcbiAgdGhpcy5hID0gYTtcbiAgdGhpcy5iID0gYjtcbiAgdGhpcy5jID0gYztcblxuICB2YXIgQSA9IGIueCAtIGEueCxcbiAgICBCID0gYi55IC0gYS55LFxuICAgIEMgPSBjLnggLSBhLngsXG4gICAgRCA9IGMueSAtIGEueSxcbiAgICBFID0gQSAqIChhLnggKyBiLngpICsgQiAqIChhLnkgKyBiLnkpLFxuICAgIEYgPSBDICogKGEueCArIGMueCkgKyBEICogKGEueSArIGMueSksXG4gICAgRyA9IDIgKiAoQSAqIChjLnkgLSBiLnkpIC0gQiAqIChjLnggLSBiLngpKSxcbiAgICBtaW54LCBtaW55LCBkeCwgZHk7XG5cbiAgLy8gSWYgdGhlIHBvaW50cyBvZiB0aGUgdHJpYW5nbGUgYXJlIGNvbGxpbmVhciwgdGhlbiBqdXN0IGZpbmQgdGhlXG4gIC8vIGV4dHJlbWVzIGFuZCB1c2UgdGhlIG1pZHBvaW50IGFzIHRoZSBjZW50ZXIgb2YgdGhlIGNpcmN1bWNpcmNsZS5cbiAgaWYgKE1hdGguYWJzKEcpIDwgMC4wMDAwMDEpIHtcbiAgICBtaW54ID0gTWF0aC5taW4oYS54LCBiLngsIGMueCk7XG4gICAgbWlueSA9IE1hdGgubWluKGEueSwgYi55LCBjLnkpO1xuICAgIGR4ID0gKE1hdGgubWF4KGEueCwgYi54LCBjLngpIC0gbWlueCkgKiAwLjU7XG4gICAgZHkgPSAoTWF0aC5tYXgoYS55LCBiLnksIGMueSkgLSBtaW55KSAqIDAuNTtcblxuICAgIHRoaXMueCA9IG1pbnggKyBkeDtcbiAgICB0aGlzLnkgPSBtaW55ICsgZHk7XG4gICAgdGhpcy5yID0gZHggKiBkeCArIGR5ICogZHk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy54ID0gKEQgKiBFIC0gQiAqIEYpIC8gRztcbiAgICB0aGlzLnkgPSAoQSAqIEYgLSBDICogRSkgLyBHO1xuICAgIGR4ID0gdGhpcy54IC0gYS54O1xuICAgIGR5ID0gdGhpcy55IC0gYS55O1xuICAgIHRoaXMuciA9IGR4ICogZHggKyBkeSAqIGR5O1xuICB9XG59XG5cbmZ1bmN0aW9uIGJ5WChhLCBiKSB7XG4gIHJldHVybiBiLnggLSBhLng7XG59XG5cbmZ1bmN0aW9uIGRlZHVwKGVkZ2VzKSB7XG4gIHZhciBqID0gZWRnZXMubGVuZ3RoLFxuICAgIGEsIGIsIGksIG0sIG47XG5cbiAgb3V0ZXI6XG4gIHdoaWxlIChqKSB7XG4gICAgYiA9IGVkZ2VzWy0tal07XG4gICAgYSA9IGVkZ2VzWy0tal07XG4gICAgaSA9IGo7XG4gICAgd2hpbGUgKGkpIHtcbiAgICAgIG4gPSBlZGdlc1stLWldO1xuICAgICAgbSA9IGVkZ2VzWy0taV07XG4gICAgICBpZiAoKGEgPT09IG0gJiYgYiA9PT0gbikgfHwgKGEgPT09IG4gJiYgYiA9PT0gbSkpIHtcbiAgICAgICAgZWRnZXMuc3BsaWNlKGosIDIpO1xuICAgICAgICBlZGdlcy5zcGxpY2UoaSwgMik7XG4gICAgICAgIGogLT0gMjtcbiAgICAgICAgY29udGludWUgb3V0ZXI7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHRyaWFuZ3VsYXRlKHZlcnRpY2VzKSB7XG4gIC8vIEJhaWwgaWYgdGhlcmUgYXJlbid0IGVub3VnaCB2ZXJ0aWNlcyB0byBmb3JtIGFueSB0cmlhbmdsZXMuXG4gIGlmICh2ZXJ0aWNlcy5sZW5ndGggPCAzKVxuICAgIHJldHVybiBbXTtcblxuICAgIC8vIEVuc3VyZSB0aGUgdmVydGV4IGFycmF5IGlzIGluIG9yZGVyIG9mIGRlc2NlbmRpbmcgWCBjb29yZGluYXRlXG4gICAgLy8gKHdoaWNoIGlzIG5lZWRlZCB0byBlbnN1cmUgYSBzdWJxdWFkcmF0aWMgcnVudGltZSksIGFuZCB0aGVuIGZpbmRcbiAgICAvLyB0aGUgYm91bmRpbmcgYm94IGFyb3VuZCB0aGUgcG9pbnRzLiBcbiAgdmVydGljZXMuc29ydChieVgpO1xuXG4gIHZhciBpID0gdmVydGljZXMubGVuZ3RoIC0gMSxcbiAgICB4bWluID0gdmVydGljZXNbaV0ueCxcbiAgICB4bWF4ID0gdmVydGljZXNbMF0ueCxcbiAgICB5bWluID0gdmVydGljZXNbaV0ueSxcbiAgICB5bWF4ID0geW1pbjtcblxuICB3aGlsZSAoaS0tKSB7XG4gICAgaWYgKHZlcnRpY2VzW2ldLnkgPCB5bWluKVxuICAgICAgeW1pbiA9IHZlcnRpY2VzW2ldLnk7XG4gICAgaWYgKHZlcnRpY2VzW2ldLnkgPiB5bWF4KVxuICAgICAgeW1heCA9IHZlcnRpY2VzW2ldLnk7XG4gIH1cblxuICAvL0ZpbmQgYSBzdXBlcnRyaWFuZ2xlLCB3aGljaCBpcyBhIHRyaWFuZ2xlIHRoYXQgc3Vycm91bmRzIGFsbCB0aGVcbiAgLy92ZXJ0aWNlcy4gVGhpcyBpcyB1c2VkIGxpa2Ugc29tZXRoaW5nIG9mIGEgc2VudGluZWwgdmFsdWUgdG8gcmVtb3ZlXG4gIC8vY2FzZXMgaW4gdGhlIG1haW4gYWxnb3JpdGhtLCBhbmQgaXMgcmVtb3ZlZCBiZWZvcmUgd2UgcmV0dXJuIGFueVxuICAvLyByZXN1bHRzLlxuIFxuICAvLyBPbmNlIGZvdW5kLCBwdXQgaXQgaW4gdGhlIFwib3BlblwiIGxpc3QuIChUaGUgXCJvcGVuXCIgbGlzdCBpcyBmb3JcbiAgLy8gdHJpYW5nbGVzIHdobyBtYXkgc3RpbGwgbmVlZCB0byBiZSBjb25zaWRlcmVkOyB0aGUgXCJjbG9zZWRcIiBsaXN0IGlzXG4gIC8vIGZvciB0cmlhbmdsZXMgd2hpY2ggZG8gbm90LilcbiAgdmFyIGR4ID0geG1heCAtIHhtaW4sXG4gICAgZHkgPSB5bWF4IC0geW1pbixcbiAgICBkbWF4ID0gKGR4ID4gZHkpID8gZHggOiBkeSxcbiAgICB4bWlkID0gKHhtYXggKyB4bWluKSAqIDAuNSxcbiAgICB5bWlkID0gKHltYXggKyB5bWluKSAqIDAuNSxcbiAgICBvcGVuID0gW1xuICAgICAgbmV3IFRyaWFuZ2xlKHtcbiAgICAgICAgeDogeG1pZCAtIDIwICogZG1heCxcbiAgICAgICAgeTogeW1pZCAtIGRtYXgsXG4gICAgICAgIF9fc2VudGluZWw6IHRydWVcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHg6IHhtaWQsXG4gICAgICAgIHk6IHltaWQgKyAyMCAqIGRtYXgsXG4gICAgICAgIF9fc2VudGluZWw6IHRydWVcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHg6IHhtaWQgKyAyMCAqIGRtYXgsXG4gICAgICAgIHk6IHltaWQgLSBkbWF4LFxuICAgICAgICBfX3NlbnRpbmVsOiB0cnVlXG4gICAgICB9XG4gICAgKV0sXG4gICAgY2xvc2VkID0gW10sXG4gICAgZWRnZXMgPSBbXSxcbiAgICBqLCBhLCBiO1xuXG4gICAgLy8gSW5jcmVtZW50YWxseSBhZGQgZWFjaCB2ZXJ0ZXggdG8gdGhlIG1lc2guXG4gIGkgPSB2ZXJ0aWNlcy5sZW5ndGg7XG4gIHdoaWxlIChpLS0pIHtcbiAgICAvLyBGb3IgZWFjaCBvcGVuIHRyaWFuZ2xlLCBjaGVjayB0byBzZWUgaWYgdGhlIGN1cnJlbnQgcG9pbnQgaXNcbiAgICAvLyBpbnNpZGUgaXQncyBjaXJjdW1jaXJjbGUuIElmIGl0IGlzLCByZW1vdmUgdGhlIHRyaWFuZ2xlIGFuZCBhZGRcbiAgICAvLyBpdCdzIGVkZ2VzIHRvIGFuIGVkZ2UgbGlzdC5cbiAgICBlZGdlcy5sZW5ndGggPSAwO1xuICAgIGogPSBvcGVuLmxlbmd0aDtcbiAgICB3aGlsZSAoai0tKSB7XG4gICAgICAvLyBJZiB0aGlzIHBvaW50IGlzIHRvIHRoZSByaWdodCBvZiB0aGlzIHRyaWFuZ2xlJ3MgY2lyY3VtY2lyY2xlLFxuICAgICAgLy8gdGhlbiB0aGlzIHRyaWFuZ2xlIHNob3VsZCBuZXZlciBnZXQgY2hlY2tlZCBhZ2Fpbi4gUmVtb3ZlIGl0XG4gICAgICAvLyBmcm9tIHRoZSBvcGVuIGxpc3QsIGFkZCBpdCB0byB0aGUgY2xvc2VkIGxpc3QsIGFuZCBza2lwLlxuICAgICAgZHggPSB2ZXJ0aWNlc1tpXS54IC0gb3BlbltqXS54O1xuICAgICAgaWYgKGR4ID4gMCAmJiBkeCAqIGR4ID4gb3BlbltqXS5yKSB7XG4gICAgICAgIGNsb3NlZC5wdXNoKG9wZW5bal0pO1xuICAgICAgICBvcGVuLnNwbGljZShqLCAxKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIG5vdCwgc2tpcCB0aGlzIHRyaWFuZ2xlLlxuICAgICAgZHkgPSB2ZXJ0aWNlc1tpXS55IC0gb3BlbltqXS55O1xuICAgICAgaWYgKGR4ICogZHggKyBkeSAqIGR5ID4gb3BlbltqXS5yKVxuICAgICAgICBjb250aW51ZTtcblxuICAgICAgLy8gUmVtb3ZlIHRoZSB0cmlhbmdsZSBhbmQgYWRkIGl0J3MgZWRnZXMgdG8gdGhlIGVkZ2UgbGlzdC5cbiAgICAgIGVkZ2VzLnB1c2goXG4gICAgICAgIG9wZW5bal0uYSwgb3BlbltqXS5iLFxuICAgICAgICBvcGVuW2pdLmIsIG9wZW5bal0uYyxcbiAgICAgICAgb3BlbltqXS5jLCBvcGVuW2pdLmFcbiAgICAgICk7XG4gICAgICBvcGVuLnNwbGljZShqLCAxKTtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgYW55IGRvdWJsZWQgZWRnZXMuXG4gICAgZGVkdXAoZWRnZXMpO1xuXG4gICAgLy8gQWRkIGEgbmV3IHRyaWFuZ2xlIGZvciBlYWNoIGVkZ2UuXG4gICAgaiA9IGVkZ2VzLmxlbmd0aDtcbiAgICB3aGlsZSAoaikge1xuICAgICAgYiA9IGVkZ2VzWy0tal07XG4gICAgICBhID0gZWRnZXNbLS1qXTtcbiAgICAgIG9wZW4ucHVzaChuZXcgVHJpYW5nbGUoYSwgYiwgdmVydGljZXNbaV0pKTtcbiAgICB9XG4gIH1cblxuICAvLyBDb3B5IGFueSByZW1haW5pbmcgb3BlbiB0cmlhbmdsZXMgdG8gdGhlIGNsb3NlZCBsaXN0LCBhbmQgdGhlblxuICAvLyByZW1vdmUgYW55IHRyaWFuZ2xlcyB0aGF0IHNoYXJlIGEgdmVydGV4IHdpdGggdGhlIHN1cGVydHJpYW5nbGUuXG4gIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGNsb3NlZCwgb3Blbik7XG5cbiAgaSA9IGNsb3NlZC5sZW5ndGg7XG4gIHdoaWxlIChpLS0pXG4gIGlmIChjbG9zZWRbaV0uYS5fX3NlbnRpbmVsIHx8XG4gICAgICBjbG9zZWRbaV0uYi5fX3NlbnRpbmVsIHx8XG4gICAgICBjbG9zZWRbaV0uYy5fX3NlbnRpbmVsKVxuICAgICAgY2xvc2VkLnNwbGljZShpLCAxKTtcblxuICByZXR1cm4gY2xvc2VkO1xufVxuIiwidmFyIGZlYXR1cmVjb2xsZWN0aW9uID0gcmVxdWlyZSgndHVyZi1mZWF0dXJlY29sbGVjdGlvbicpO1xudmFyIHBvaW50ID0gcmVxdWlyZSgndHVyZi1wb2ludCcpO1xudmFyIHBvbHlnb24gPSByZXF1aXJlKCd0dXJmLXBvbHlnb24nKTtcbnZhciBkaXN0YW5jZSA9IHJlcXVpcmUoJ3R1cmYtZGlzdGFuY2UnKTtcblxuLyoqXG4gKiBUYWtlcyBhIGJvdW5kaW5nIGJveCBhbmQgYSBjZWxsIGRlcHRoIGFuZCByZXR1cm5zIGEge0BsaW5rIEZlYXR1cmVDb2xsZWN0aW9ufSBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgaW4gYSBncmlkLlxuICpcbiAqIEBtb2R1bGUgdHVyZi90cmlhbmdsZS1ncmlkXG4gKiBAY2F0ZWdvcnkgaW50ZXJwb2xhdGlvblxuICogQHBhcmFtIHtBcnJheTxudW1iZXI+fSBleHRlbnQgZXh0ZW50IGluIFttaW5YLCBtaW5ZLCBtYXhYLCBtYXhZXSBvcmRlclxuICogQHBhcmFtIHtOdW1iZXJ9IGNlbGxXaWR0aCB3aWR0aCBvZiBlYWNoIGNlbGxcbiAqIEBwYXJhbSB7U3RyaW5nfSB1bml0cyB1bml0cyB0byB1c2UgZm9yIGNlbGxXaWR0aFxuICogQHJldHVybiB7RmVhdHVyZUNvbGxlY3Rpb259IGdyaWQgYXMgRmVhdHVyZUNvbGxlY3Rpb24gd2l0aCB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXNcbiAqIEBleGFtcGxlXG4gKiB2YXIgZXh0ZW50ID0gWy03Ny4zODc2OTUzMTI1LDM4LjcxOTgwNDc0MjY0MjM5LC03Ni45NDgyNDIxODc1LDM5LjAyNzcxODg0MDIxMTYwNV07XG4gKiB2YXIgY2VsbFdpZHRoID0gMTA7XG4gKiB2YXIgdW5pdHMgPSAnbWlsZXMnO1xuICpcbiAqIHZhciB0cmlhbmdsZUdyaWQgPSB0dXJmLnRyaWFuZ2xlR3JpZChleHRlbnQsIGNlbGxXaWR0aCwgdW5pdHMpO1xuICpcbiAqIC8vPXRyaWFuZ2xlR3JpZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChiYm94LCBjZWxsLCB1bml0cykge1xuICB2YXIgZmMgPSBmZWF0dXJlY29sbGVjdGlvbihbXSk7XG4gIHZhciB4RnJhY3Rpb24gPSBjZWxsIC8gKGRpc3RhbmNlKHBvaW50KFtiYm94WzBdLCBiYm94WzFdXSksIHBvaW50KFtiYm94WzJdLCBiYm94WzFdXSksIHVuaXRzKSk7XG4gIHZhciBjZWxsV2lkdGggPSB4RnJhY3Rpb24gKiAoYmJveFsyXSAtIGJib3hbMF0pO1xuICB2YXIgeUZyYWN0aW9uID0gY2VsbCAvIChkaXN0YW5jZShwb2ludChbYmJveFswXSwgYmJveFsxXV0pLCBwb2ludChbYmJveFswXSwgYmJveFszXV0pLCB1bml0cykpO1xuICB2YXIgY2VsbEhlaWdodCA9IHlGcmFjdGlvbiAqIChiYm94WzNdIC0gYmJveFsxXSk7XG5cbiAgdmFyIHhpID0gMDtcbiAgdmFyIGN1cnJlbnRYID0gYmJveFswXTtcbiAgd2hpbGUgKGN1cnJlbnRYIDw9IGJib3hbMl0pIHtcbiAgICB2YXIgeWkgPSAwO1xuICAgIHZhciBjdXJyZW50WSA9IGJib3hbMV07XG4gICAgd2hpbGUgKGN1cnJlbnRZIDw9IGJib3hbM10pIHtcbiAgICAgIGlmKHhpJTI9PT0wICYmIHlpJTI9PT0wKSB7XG4gICAgICAgIHZhciBjZWxsMSA9IHBvbHlnb24oW1tcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZXSxcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldXG4gICAgICAgICAgXV0pO1xuICAgICAgICBmYy5mZWF0dXJlcy5wdXNoKGNlbGwxKTtcbiAgICAgICAgdmFyIGNlbGwyID0gcG9seWdvbihbW1xuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WStjZWxsSGVpZ2h0XVxuICAgICAgICAgIF1dKTtcbiAgICAgICAgZmMuZmVhdHVyZXMucHVzaChjZWxsMik7XG4gICAgICB9IGVsc2UgaWYoeGklMj09PTAgJiYgeWklMj09PTEpIHtcbiAgICAgICAgdmFyIGNlbGwxID0gcG9seWdvbihbW1xuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgrY2VsbFdpZHRoLCBjdXJyZW50WStjZWxsSGVpZ2h0XSxcbiAgICAgICAgICAgIFtjdXJyZW50WCtjZWxsV2lkdGgsIGN1cnJlbnRZXSxcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldXG4gICAgICAgICAgXV0pO1xuICAgICAgICBmYy5mZWF0dXJlcy5wdXNoKGNlbGwxKTtcbiAgICAgICAgdmFyIGNlbGwyID0gcG9seWdvbihbW1xuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXVxuICAgICAgICAgIF1dKTtcbiAgICAgICAgZmMuZmVhdHVyZXMucHVzaChjZWxsMik7XG4gICAgICB9IGVsc2UgaWYoeWklMj09PTAgJiYgeGklMj09PTEpIHtcbiAgICAgICAgdmFyIGNlbGwxID0gcG9seWdvbihbW1xuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXVxuICAgICAgICAgIF1dKTtcbiAgICAgICAgZmMuZmVhdHVyZXMucHVzaChjZWxsMSk7XG4gICAgICAgIHZhciBjZWxsMiA9IHBvbHlnb24oW1tcbiAgICAgICAgICAgIFtjdXJyZW50WCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgICBbY3VycmVudFgrY2VsbFdpZHRoLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZXVxuICAgICAgICAgIF1dKTtcbiAgICAgICAgZmMuZmVhdHVyZXMucHVzaChjZWxsMik7XG4gICAgICB9IGVsc2UgaWYoeWklMj09PTEgJiYgeGklMj09PTEpIHtcbiAgICAgICAgdmFyIGNlbGwxID0gcG9seWdvbihbW1xuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFldLFxuICAgICAgICAgICAgW2N1cnJlbnRYLCBjdXJyZW50WV1cbiAgICAgICAgICBdXSk7XG4gICAgICAgIGZjLmZlYXR1cmVzLnB1c2goY2VsbDEpO1xuICAgICAgICB2YXIgY2VsbDIgPSBwb2x5Z29uKFtbXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdLFxuICAgICAgICAgICAgW2N1cnJlbnRYK2NlbGxXaWR0aCwgY3VycmVudFkrY2VsbEhlaWdodF0sXG4gICAgICAgICAgICBbY3VycmVudFgrY2VsbFdpZHRoLCBjdXJyZW50WV0sXG4gICAgICAgICAgICBbY3VycmVudFgsIGN1cnJlbnRZK2NlbGxIZWlnaHRdXG4gICAgICAgICAgXV0pO1xuICAgICAgICBmYy5mZWF0dXJlcy5wdXNoKGNlbGwyKTtcbiAgICAgIH1cbiAgICAgIGN1cnJlbnRZICs9IGNlbGxIZWlnaHQ7XG4gICAgICB5aSsrO1xuICAgIH1cbiAgICB4aSsrO1xuICAgIGN1cnJlbnRYICs9IGNlbGxXaWR0aDtcbiAgfVxuICByZXR1cm4gZmM7XG59O1xuXG4iLCIvLyBsb29rIGhlcmUgZm9yIGhlbHAgaHR0cDovL3N2bi5vc2dlby5vcmcvZ3Jhc3MvZ3Jhc3MvYnJhbmNoZXMvcmVsZWFzZWJyYW5jaF82XzQvdmVjdG9yL3Yub3ZlcmxheS9tYWluLmNcbi8vbXVzdCBiZSBhcnJheSBvZiBwb2x5Z29uc1xuXG4vLyBkZXBlbmQgb24ganN0cyBmb3Igbm93IGh0dHBzOi8vZ2l0aHViLmNvbS9iam9ybmhhcnJ0ZWxsL2pzdHMvYmxvYi9tYXN0ZXIvZXhhbXBsZXMvb3ZlcmxheS5odG1sXG5cbnZhciBqc3RzID0gcmVxdWlyZSgnanN0cycpO1xuXG4vKipcbiAqIFRha2VzIHR3byB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgYW5kIHJldHVybmVzIGEgY29tYmluZWQge0BsaW5rIFBvbHlnb259IGZlYXR1cmUuIElmIHRoZSBpbnB1dCBQb2x5Z29uIGZlYXR1cmVzIGFyZSBub3QgY29udGlndW91cywgdGhpcyBmdW5jdGlvbiByZXR1cm5zIGEge0BsaW5rIE11bHRpUG9seWdvbn0gZmVhdHVyZS5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvdW5pb25cbiAqIEBjYXRlZ29yeSB0cmFuc2Zvcm1hdGlvblxuICogQHBhcmFtIHtQb2x5Z29ufSBwb2x5MSBhbiBpbnB1dCBQb2x5Z29uXG4gKiBAcGFyYW0ge1BvbHlnb259IHBvbHkyIGFub3RoZXIgaW5wdXQgUG9seWdvblxuICogQHJldHVybiB7RmVhdHVyZX0gYSBjb21iaW5lZCB7QGxpbmsgUG9seWdvbn0gb3Ige0BsaW5rIE11bHRpUG9seWdvbn0gZmVhdHVyZVxuICogQGV4YW1wbGVcbiAqIHZhciBwb2x5MSA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICBcInByb3BlcnRpZXNcIjoge1xuICogICAgIFwiZmlsbFwiOiBcIiMwZjBcIlxuICogICB9LFxuICogICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICBcInR5cGVcIjogXCJQb2x5Z29uXCIsXG4gKiAgICAgXCJjb29yZGluYXRlc1wiOiBbW1xuICogICAgICAgWy04Mi41NzQ3ODcsIDM1LjU5NDA4N10sXG4gKiAgICAgICBbLTgyLjU3NDc4NywgMzUuNjE1NTgxXSxcbiAqICAgICAgIFstODIuNTQ1MjYxLCAzNS42MTU1ODFdLFxuICogICAgICAgWy04Mi41NDUyNjEsIDM1LjU5NDA4N10sXG4gKiAgICAgICBbLTgyLjU3NDc4NywgMzUuNTk0MDg3XVxuICogICAgIF1dXG4gKiAgIH1cbiAqIH07XG4gKiB2YXIgcG9seTIgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICBcImZpbGxcIjogXCIjMDBmXCJcbiAqICAgfSxcbiAqICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgIFwiY29vcmRpbmF0ZXNcIjogW1tcbiAqICAgICAgIFstODIuNTYwMDI0LCAzNS41ODUxNTNdLFxuICogICAgICAgWy04Mi41NjAwMjQsIDM1LjYwMjYwMl0sXG4gKiAgICAgICBbLTgyLjUyOTY0LCAzNS42MDI2MDJdLFxuICogICAgICAgWy04Mi41Mjk2NCwgMzUuNTg1MTUzXSxcbiAqICAgICAgIFstODIuNTYwMDI0LCAzNS41ODUxNTNdXG4gKiAgICAgXV1cbiAqICAgfVxuICogfTtcbiAqIHZhciBwb2x5Z29ucyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbcG9seTEsIHBvbHkyXVxuICogfTtcbiAqXG4gKiB2YXIgdW5pb24gPSB0dXJmLnVuaW9uKHBvbHkxLCBwb2x5Mik7XG4gKlxuICogLy89cG9seWdvbnNcbiAqXG4gKiAvLz11bmlvblxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBvbHkxLCBwb2x5Mil7XG4gIHZhciByZWFkZXIgPSBuZXcganN0cy5pby5HZW9KU09OUmVhZGVyKCk7XG4gIHZhciBhID0gcmVhZGVyLnJlYWQoSlNPTi5zdHJpbmdpZnkocG9seTEuZ2VvbWV0cnkpKTtcbiAgdmFyIGIgPSByZWFkZXIucmVhZChKU09OLnN0cmluZ2lmeShwb2x5Mi5nZW9tZXRyeSkpO1xuICB2YXIgdW5pb24gPSBhLnVuaW9uKGIpO1xuICB2YXIgcGFyc2VyID0gbmV3IGpzdHMuaW8uR2VvSlNPTlBhcnNlcigpO1xuXG4gIHVuaW9uID0gcGFyc2VyLndyaXRlKHVuaW9uKTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnRmVhdHVyZScsXG4gICAgZ2VvbWV0cnk6IHVuaW9uLFxuICAgIHByb3BlcnRpZXM6IHBvbHkxLnByb3BlcnRpZXNcbiAgfTtcbn1cbiIsIi8qXG4gIGphdmFzY3JpcHQudXRpbCBpcyBhIHBvcnQgb2Ygc2VsZWN0ZWQgcGFydHMgb2YgamF2YS51dGlsIHRvIEphdmFTY3JpcHQgd2hpY2hcbiAgbWFpbiBwdXJwb3NlIGlzIHRvIGVhc2UgcG9ydGluZyBKYXZhIGNvZGUgdG8gSmF2YVNjcmlwdC5cbiAgXG4gIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG4gIENvcHlyaWdodCAoQykgMjAxMS0yMDE0IGJ5IFRoZSBBdXRob3JzXG5cbiAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gIFRIRSBTT0ZUV0FSRS5cbiovXG47KGZ1bmN0aW9uKCl7dmFyIGU9dGhpcztmdW5jdGlvbiBmKGEsYil7dmFyIGM9YS5zcGxpdChcIi5cIiksZD1lO2NbMF1pbiBkfHwhZC5leGVjU2NyaXB0fHxkLmV4ZWNTY3JpcHQoXCJ2YXIgXCIrY1swXSk7Zm9yKHZhciB0O2MubGVuZ3RoJiYodD1jLnNoaWZ0KCkpOyljLmxlbmd0aHx8dm9pZCAwPT09Yj9kPWRbdF0/ZFt0XTpkW3RdPXt9OmRbdF09Yn1mdW5jdGlvbiBnKGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLnE9Yi5wcm90b3R5cGU7YS5wcm90b3R5cGU9bmV3IGM7YS5wcm90b3R5cGUuY29uc3RydWN0b3I9YTthLnA9ZnVuY3Rpb24oYSxjLE8pe3ZhciBNPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTtyZXR1cm4gYi5wcm90b3R5cGVbY10uYXBwbHkoYSxNKX19O2Z1bmN0aW9uIGgoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhoLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkVtcHR5U3RhY2tFeGNlcHRpb25cIixoKTtoLnByb3RvdHlwZS5uYW1lPVwiRW1wdHlTdGFja0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGsoYSl7dGhpcy5tZXNzYWdlPWF8fFwiXCJ9ZyhrLEVycm9yKTtmKFwiamF2YXNjcmlwdC51dGlsLkluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25cIixrKTtrLnByb3RvdHlwZS5uYW1lPVwiSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvblwiO2Z1bmN0aW9uIGwoKXt9ZihcImphdmFzY3JpcHQudXRpbC5JdGVyYXRvclwiLGwpO2wucHJvdG90eXBlLmhhc05leHQ9bC5wcm90b3R5cGUuYztsLnByb3RvdHlwZS5uZXh0PWwucHJvdG90eXBlLm5leHQ7bC5wcm90b3R5cGUucmVtb3ZlPWwucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBtKCl7fWYoXCJqYXZhc2NyaXB0LnV0aWwuQ29sbGVjdGlvblwiLG0pO2Z1bmN0aW9uIG4oKXt9ZyhuLG0pO2YoXCJqYXZhc2NyaXB0LnV0aWwuTGlzdFwiLG4pO2Z1bmN0aW9uIHAoKXt9ZihcImphdmFzY3JpcHQudXRpbC5NYXBcIixwKTtmdW5jdGlvbiBxKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocSxFcnJvcik7ZihcImphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uXCIscSk7cS5wcm90b3R5cGUubmFtZT1cIk5vU3VjaEVsZW1lbnRFeGNlcHRpb25cIjtmdW5jdGlvbiByKGEpe3RoaXMubWVzc2FnZT1hfHxcIlwifWcocixFcnJvcik7ci5wcm90b3R5cGUubmFtZT1cIk9wZXJhdGlvbk5vdFN1cHBvcnRlZFwiO2Z1bmN0aW9uIHMoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhzLG4pO2YoXCJqYXZhc2NyaXB0LnV0aWwuQXJyYXlMaXN0XCIscyk7cy5wcm90b3R5cGUuYT1udWxsO3MucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXt0aGlzLmEucHVzaChhKTtyZXR1cm4hMH07cy5wcm90b3R5cGUuYWRkPXMucHJvdG90eXBlLmFkZDtzLnByb3RvdHlwZS5lPWZ1bmN0aW9uKGEpe2ZvcihhPWEuZigpO2EuYygpOyl0aGlzLmFkZChhLm5leHQoKSk7cmV0dXJuITB9O3MucHJvdG90eXBlLmFkZEFsbD1zLnByb3RvdHlwZS5lO3MucHJvdG90eXBlLnNldD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuYVthXTt0aGlzLmFbYV09YjtyZXR1cm4gY307cy5wcm90b3R5cGUuc2V0PXMucHJvdG90eXBlLnNldDtzLnByb3RvdHlwZS5mPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB1KHRoaXMpfTtzLnByb3RvdHlwZS5pdGVyYXRvcj1zLnByb3RvdHlwZS5mO1xucy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe2lmKDA+YXx8YT49dGhpcy5zaXplKCkpdGhyb3cgbmV3IGs7cmV0dXJuIHRoaXMuYVthXX07cy5wcm90b3R5cGUuZ2V0PXMucHJvdG90eXBlLmdldDtzLnByb3RvdHlwZS5nPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5pc0VtcHR5PXMucHJvdG90eXBlLmc7cy5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtzLnByb3RvdHlwZS5zaXplPXMucHJvdG90eXBlLnNpemU7cy5wcm90b3R5cGUuaD1mdW5jdGlvbigpe2Zvcih2YXIgYT1bXSxiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspYS5wdXNoKHRoaXMuYVtiXSk7cmV0dXJuIGF9O3MucHJvdG90eXBlLnRvQXJyYXk9cy5wcm90b3R5cGUuaDtcbnMucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbihhKXtmb3IodmFyIGI9ITEsYz0wLGQ9dGhpcy5hLmxlbmd0aDtjPGQ7YysrKWlmKHRoaXMuYVtjXT09PWEpe3RoaXMuYS5zcGxpY2UoYywxKTtiPSEwO2JyZWFrfXJldHVybiBifTtzLnByb3RvdHlwZS5yZW1vdmU9cy5wcm90b3R5cGUucmVtb3ZlO2Z1bmN0aW9uIHUoYSl7dGhpcy5qPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfXCIsdSk7dS5wcm90b3R5cGUuaj1udWxsO3UucHJvdG90eXBlLmI9MDt1LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5qLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5qLmdldCh0aGlzLmIrKyl9O3UucHJvdG90eXBlLm5leHQ9dS5wcm90b3R5cGUubmV4dDt1LnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmouc2l6ZSgpPyEwOiExfTt1LnByb3RvdHlwZS5oYXNOZXh0PXUucHJvdG90eXBlLmM7XG51LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O3UucHJvdG90eXBlLnJlbW92ZT11LnByb3RvdHlwZS5yZW1vdmU7ZnVuY3Rpb24gdigpe31mKFwiamF2YXNjcmlwdC51dGlsLkFycmF5c1wiLHYpO1xudi5zb3J0PWZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdLGIsYyxkO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWEuc29ydCgpO2Vsc2UgaWYoMj09PWFyZ3VtZW50cy5sZW5ndGgpYz1hcmd1bWVudHNbMV0sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYS5zb3J0KGQpO2Vsc2UgaWYoMz09PWFyZ3VtZW50cy5sZW5ndGgpZm9yKGI9YS5zbGljZShhcmd1bWVudHNbMV0sYXJndW1lbnRzWzJdKSxiLnNvcnQoKSxkPWEuc2xpY2UoMCxhcmd1bWVudHNbMV0pLmNvbmNhdChiLGEuc2xpY2UoYXJndW1lbnRzWzJdLGEubGVuZ3RoKSksYS5zcGxpY2UoMCxhLmxlbmd0aCksYj0wO2I8ZC5sZW5ndGg7YisrKWEucHVzaChkW2JdKTtlbHNlIGlmKDQ9PT1hcmd1bWVudHMubGVuZ3RoKWZvcihiPWEuc2xpY2UoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSksYz1hcmd1bWVudHNbM10sZD1mdW5jdGlvbihhLGIpe3JldHVybiBjLmNvbXBhcmUoYSxiKX0sYi5zb3J0KGQpLFxuZD1hLnNsaWNlKDAsYXJndW1lbnRzWzFdKS5jb25jYXQoYixhLnNsaWNlKGFyZ3VtZW50c1syXSxhLmxlbmd0aCkpLGEuc3BsaWNlKDAsYS5sZW5ndGgpLGI9MDtiPGQubGVuZ3RoO2IrKylhLnB1c2goZFtiXSl9O3YuYXNMaXN0PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1uZXcgcyxjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKWIuYWRkKGFbY10pO3JldHVybiBifTtmdW5jdGlvbiB3KCl7dGhpcy5pPXt9fWcodyxwKTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hNYXBcIix3KTt3LnByb3RvdHlwZS5pPW51bGw7dy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmlbYV18fG51bGx9O3cucHJvdG90eXBlLmdldD13LnByb3RvdHlwZS5nZXQ7dy5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaVthXT1ifTt3LnByb3RvdHlwZS5wdXQ9dy5wcm90b3R5cGUucHV0O3cucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2ZvcihiIGluIHRoaXMuaSl0aGlzLmkuaGFzT3duUHJvcGVydHkoYikmJmEuYWRkKHRoaXMuaVtiXSk7cmV0dXJuIGF9O3cucHJvdG90eXBlLnZhbHVlcz13LnByb3RvdHlwZS5tO3cucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tKCkuc2l6ZSgpfTt3LnByb3RvdHlwZS5zaXplPXcucHJvdG90eXBlLnNpemU7ZnVuY3Rpb24geCgpe31nKHgsbSk7ZihcImphdmFzY3JpcHQudXRpbC5TZXRcIix4KTtmdW5jdGlvbiB5KGEpe3RoaXMuYT1bXTthIGluc3RhbmNlb2YgbSYmdGhpcy5lKGEpfWcoeSx4KTtmKFwiamF2YXNjcmlwdC51dGlsLkhhc2hTZXRcIix5KTt5LnByb3RvdHlwZS5hPW51bGw7eS5wcm90b3R5cGUuY29udGFpbnM9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYodGhpcy5hW2JdPT09YSlyZXR1cm4hMDtyZXR1cm4hMX07eS5wcm90b3R5cGUuY29udGFpbnM9eS5wcm90b3R5cGUuY29udGFpbnM7eS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7dGhpcy5hLnB1c2goYSk7cmV0dXJuITB9O3kucHJvdG90eXBlLmFkZD15LnByb3RvdHlwZS5hZGQ7eS5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTt5LnByb3RvdHlwZS5hZGRBbGw9eS5wcm90b3R5cGUuZTtcbnkucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307eS5wcm90b3R5cGUucmVtb3ZlPXkucHJvdG90eXBlLnJlbW92ZTt5LnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGh9O3kucHJvdG90eXBlLmlzRW1wdHk9eS5wcm90b3R5cGUuZzt5LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdLGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylhLnB1c2godGhpcy5hW2JdKTtyZXR1cm4gYX07eS5wcm90b3R5cGUudG9BcnJheT15LnByb3RvdHlwZS5oO3kucHJvdG90eXBlLmY9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHoodGhpcyl9O3kucHJvdG90eXBlLml0ZXJhdG9yPXkucHJvdG90eXBlLmY7ZnVuY3Rpb24geihhKXt0aGlzLms9YX1mKFwiJGpzY29tcC5zY29wZS5JdGVyYXRvcl8kMVwiLHopO3oucHJvdG90eXBlLms9bnVsbDtcbnoucHJvdG90eXBlLmI9MDt6LnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYodGhpcy5iPT09dGhpcy5rLnNpemUoKSl0aHJvdyBuZXcgcTtyZXR1cm4gdGhpcy5rLmFbdGhpcy5iKytdfTt6LnByb3RvdHlwZS5uZXh0PXoucHJvdG90eXBlLm5leHQ7ei5wcm90b3R5cGUuYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmI8dGhpcy5rLnNpemUoKT8hMDohMX07ei5wcm90b3R5cGUuaGFzTmV4dD16LnByb3RvdHlwZS5jO3oucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3Rocm93IG5ldyByO307ei5wcm90b3R5cGUucmVtb3ZlPXoucHJvdG90eXBlLnJlbW92ZTtmdW5jdGlvbiBBKCl7fWcoQSxwKTtmKFwiamF2YXNjcmlwdC51dGlsLlNvcnRlZE1hcFwiLEEpO2Z1bmN0aW9uIEIoKXt9ZyhCLHgpO2YoXCJqYXZhc2NyaXB0LnV0aWwuU29ydGVkU2V0XCIsQik7ZnVuY3Rpb24gQygpe3RoaXMuYT1bXX1nKEMsbik7ZihcImphdmFzY3JpcHQudXRpbC5TdGFja1wiLEMpO0MucHJvdG90eXBlLmE9bnVsbDtDLnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGEpe3RoaXMuYS5wdXNoKGEpO3JldHVybiBhfTtDLnByb3RvdHlwZS5wdXNoPUMucHJvdG90eXBlLnB1c2g7Qy5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYS5wb3AoKX07Qy5wcm90b3R5cGUucG9wPUMucHJvdG90eXBlLnBvcDtDLnByb3RvdHlwZS5vPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuYS5sZW5ndGgpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMuYVt0aGlzLmEubGVuZ3RoLTFdfTtDLnByb3RvdHlwZS5wZWVrPUMucHJvdG90eXBlLm87Qy5wcm90b3R5cGUuZW1wdHk9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYS5sZW5ndGg/ITA6ITF9O0MucHJvdG90eXBlLmVtcHR5PUMucHJvdG90eXBlLmVtcHR5O1xuQy5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVtcHR5KCl9O0MucHJvdG90eXBlLmlzRW1wdHk9Qy5wcm90b3R5cGUuZztDLnByb3RvdHlwZS5zZWFyY2g9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYS5pbmRleE9mKGEpfTtDLnByb3RvdHlwZS5zZWFyY2g9Qy5wcm90b3R5cGUuc2VhcmNoO0MucHJvdG90eXBlLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hLmxlbmd0aH07Qy5wcm90b3R5cGUuc2l6ZT1DLnByb3RvdHlwZS5zaXplO0MucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtDLnByb3RvdHlwZS50b0FycmF5PUMucHJvdG90eXBlLmg7ZnVuY3Rpb24gRChhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEucGFyZW50fWZ1bmN0aW9uIEUoYSxiKXtudWxsIT09YSYmKGEuY29sb3I9Yil9ZnVuY3Rpb24gRihhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEubGVmdH1mdW5jdGlvbiBHKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5yaWdodH1mdW5jdGlvbiBIKCl7dGhpcy5kPW51bGw7dGhpcy5uPTB9ZyhILEEpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZU1hcFwiLEgpO0gucHJvdG90eXBlLmdldD1mdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcy5kO251bGwhPT1iOyl7dmFyIGM9YS5jb21wYXJlVG8oYi5rZXkpO2lmKDA+YyliPWIubGVmdDtlbHNlIGlmKDA8YyliPWIucmlnaHQ7ZWxzZSByZXR1cm4gYi52YWx1ZX1yZXR1cm4gbnVsbH07SC5wcm90b3R5cGUuZ2V0PUgucHJvdG90eXBlLmdldDtcbkgucHJvdG90eXBlLnB1dD1mdW5jdGlvbihhLGIpe2lmKG51bGw9PT10aGlzLmQpcmV0dXJuIHRoaXMuZD17a2V5OmEsdmFsdWU6YixsZWZ0Om51bGwscmlnaHQ6bnVsbCxwYXJlbnQ6bnVsbCxjb2xvcjowfSx0aGlzLm49MSxudWxsO3ZhciBjPXRoaXMuZCxkLHQ7ZG8gaWYoZD1jLHQ9YS5jb21wYXJlVG8oYy5rZXkpLDA+dCljPWMubGVmdDtlbHNlIGlmKDA8dCljPWMucmlnaHQ7ZWxzZSByZXR1cm4gZD1jLnZhbHVlLGMudmFsdWU9YixkO3doaWxlKG51bGwhPT1jKTtjPXtrZXk6YSxsZWZ0Om51bGwscmlnaHQ6bnVsbCx2YWx1ZTpiLHBhcmVudDpkLGNvbG9yOjB9OzA+dD9kLmxlZnQ9YzpkLnJpZ2h0PWM7Zm9yKGMuY29sb3I9MTtudWxsIT1jJiZjIT10aGlzLmQmJjE9PWMucGFyZW50LmNvbG9yOylEKGMpPT1GKEQoRChjKSkpPyhkPUcoRChEKGMpKSksMT09KG51bGw9PWQ/MDpkLmNvbG9yKT8oRShEKGMpLDApLEUoZCwwKSxFKEQoRChjKSksMSksYz1EKEQoYykpKTooYz09RyhEKGMpKSYmXG4oYz1EKGMpLEkodGhpcyxjKSksRShEKGMpLDApLEUoRChEKGMpKSwxKSxKKHRoaXMsRChEKGMpKSkpKTooZD1GKEQoRChjKSkpLDE9PShudWxsPT1kPzA6ZC5jb2xvcik/KEUoRChjKSwwKSxFKGQsMCksRShEKEQoYykpLDEpLGM9RChEKGMpKSk6KGM9PUYoRChjKSkmJihjPUQoYyksSih0aGlzLGMpKSxFKEQoYyksMCksRShEKEQoYykpLDEpLEkodGhpcyxEKEQoYykpKSkpO3RoaXMuZC5jb2xvcj0wO3RoaXMubisrO3JldHVybiBudWxsfTtILnByb3RvdHlwZS5wdXQ9SC5wcm90b3R5cGUucHV0O0gucHJvdG90eXBlLm09ZnVuY3Rpb24oKXt2YXIgYT1uZXcgcyxiO2I9dGhpcy5kO2lmKG51bGwhPWIpZm9yKDtudWxsIT1iLmxlZnQ7KWI9Yi5sZWZ0O2lmKG51bGwhPT1iKWZvcihhLmFkZChiLnZhbHVlKTtudWxsIT09KGI9SyhiKSk7KWEuYWRkKGIudmFsdWUpO3JldHVybiBhfTtILnByb3RvdHlwZS52YWx1ZXM9SC5wcm90b3R5cGUubTtcbmZ1bmN0aW9uIEkoYSxiKXtpZihudWxsIT1iKXt2YXIgYz1iLnJpZ2h0O2IucmlnaHQ9Yy5sZWZ0O251bGwhPWMubGVmdCYmKGMubGVmdC5wYXJlbnQ9Yik7Yy5wYXJlbnQ9Yi5wYXJlbnQ7bnVsbD09Yi5wYXJlbnQ/YS5kPWM6Yi5wYXJlbnQubGVmdD09Yj9iLnBhcmVudC5sZWZ0PWM6Yi5wYXJlbnQucmlnaHQ9YztjLmxlZnQ9YjtiLnBhcmVudD1jfX1mdW5jdGlvbiBKKGEsYil7aWYobnVsbCE9Yil7dmFyIGM9Yi5sZWZ0O2IubGVmdD1jLnJpZ2h0O251bGwhPWMucmlnaHQmJihjLnJpZ2h0LnBhcmVudD1iKTtjLnBhcmVudD1iLnBhcmVudDtudWxsPT1iLnBhcmVudD9hLmQ9YzpiLnBhcmVudC5yaWdodD09Yj9iLnBhcmVudC5yaWdodD1jOmIucGFyZW50LmxlZnQ9YztjLnJpZ2h0PWI7Yi5wYXJlbnQ9Y319XG5mdW5jdGlvbiBLKGEpe2lmKG51bGw9PT1hKXJldHVybiBudWxsO2lmKG51bGwhPT1hLnJpZ2h0KWZvcih2YXIgYj1hLnJpZ2h0O251bGwhPT1iLmxlZnQ7KWI9Yi5sZWZ0O2Vsc2UgZm9yKGI9YS5wYXJlbnQ7bnVsbCE9PWImJmE9PT1iLnJpZ2h0OylhPWIsYj1iLnBhcmVudDtyZXR1cm4gYn1ILnByb3RvdHlwZS5zaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubn07SC5wcm90b3R5cGUuc2l6ZT1ILnByb3RvdHlwZS5zaXplO2Z1bmN0aW9uIEwoYSl7dGhpcy5hPVtdO2EgaW5zdGFuY2VvZiBtJiZ0aGlzLmUoYSl9ZyhMLEIpO2YoXCJqYXZhc2NyaXB0LnV0aWwuVHJlZVNldFwiLEwpO0wucHJvdG90eXBlLmE9bnVsbDtMLnByb3RvdHlwZS5jb250YWlucz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MCxjPXRoaXMuYS5sZW5ndGg7YjxjO2IrKylpZigwPT09dGhpcy5hW2JdLmNvbXBhcmVUbyhhKSlyZXR1cm4hMDtyZXR1cm4hMX07TC5wcm90b3R5cGUuY29udGFpbnM9TC5wcm90b3R5cGUuY29udGFpbnM7TC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY29udGFpbnMoYSkpcmV0dXJuITE7Zm9yKHZhciBiPTAsYz10aGlzLmEubGVuZ3RoO2I8YztiKyspaWYoMT09PXRoaXMuYVtiXS5jb21wYXJlVG8oYSkpcmV0dXJuIHRoaXMuYS5zcGxpY2UoYiwwLGEpLCEwO3RoaXMuYS5wdXNoKGEpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGQ9TC5wcm90b3R5cGUuYWRkO1xuTC5wcm90b3R5cGUuZT1mdW5jdGlvbihhKXtmb3IoYT1hLmYoKTthLmMoKTspdGhpcy5hZGQoYS5uZXh0KCkpO3JldHVybiEwfTtMLnByb3RvdHlwZS5hZGRBbGw9TC5wcm90b3R5cGUuZTtMLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcjt9O0wucHJvdG90eXBlLnJlbW92ZT1MLnByb3RvdHlwZS5yZW1vdmU7TC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmEubGVuZ3RofTtMLnByb3RvdHlwZS5zaXplPUwucHJvdG90eXBlLnNpemU7TC5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5hLmxlbmd0aH07TC5wcm90b3R5cGUuaXNFbXB0eT1MLnByb3RvdHlwZS5nO0wucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj0wLGM9dGhpcy5hLmxlbmd0aDtiPGM7YisrKWEucHVzaCh0aGlzLmFbYl0pO3JldHVybiBhfTtMLnByb3RvdHlwZS50b0FycmF5PUwucHJvdG90eXBlLmg7TC5wcm90b3R5cGUuZj1mdW5jdGlvbigpe3JldHVybiBuZXcgTih0aGlzKX07XG5MLnByb3RvdHlwZS5pdGVyYXRvcj1MLnByb3RvdHlwZS5mO2Z1bmN0aW9uIE4oYSl7dGhpcy5sPWF9ZihcIiRqc2NvbXAuc2NvcGUuSXRlcmF0b3JfJDJcIixOKTtOLnByb3RvdHlwZS5sPW51bGw7Ti5wcm90b3R5cGUuYj0wO04ucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmI9PT10aGlzLmwuc2l6ZSgpKXRocm93IG5ldyBxO3JldHVybiB0aGlzLmwuYVt0aGlzLmIrK119O04ucHJvdG90eXBlLm5leHQ9Ti5wcm90b3R5cGUubmV4dDtOLnByb3RvdHlwZS5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYjx0aGlzLmwuc2l6ZSgpPyEwOiExfTtOLnByb3RvdHlwZS5oYXNOZXh0PU4ucHJvdG90eXBlLmM7Ti5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IHI7fTtOLnByb3RvdHlwZS5yZW1vdmU9Ti5wcm90b3R5cGUucmVtb3ZlO1widW5kZWZpbmVkXCIhPT10eXBlb2YgZ2xvYmFsJiYoZ2xvYmFsLmphdmFzY3JpcHQ9e30sZ2xvYmFsLmphdmFzY3JpcHQudXRpbD17fSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLkFycmF5TGlzdD1zLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuQXJyYXlzPXYsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Db2xsZWN0aW9uPW0sZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5FbXB0eVN0YWNrRXhjZXB0aW9uPWgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoTWFwPXcsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5IYXNoU2V0PXksZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JbmRleE91dE9mQm91bmRzRXhjZXB0aW9uPWssZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5JdGVyYXRvcj1sLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTGlzdD1uLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuTWFwPXAsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Ob1N1Y2hFbGVtZW50RXhjZXB0aW9uPXEsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5PcGVyYXRpb25Ob3RTdXBwb3J0ZWQ9XG5yLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU2V0PXgsZ2xvYmFsLmphdmFzY3JpcHQudXRpbC5Tb3J0ZWRNYXA9QSxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlNvcnRlZFNldD1CLGdsb2JhbC5qYXZhc2NyaXB0LnV0aWwuU3RhY2s9QyxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVNYXA9SCxnbG9iYWwuamF2YXNjcmlwdC51dGlsLlRyZWVTZXQ9TCk7fSkuY2FsbCh0aGlzKTtcbiIsInZhciBzcyA9IHJlcXVpcmUoJ3NpbXBsZS1zdGF0aXN0aWNzJyk7XG52YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcblxuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSB2YXJpYW5jZSB2YWx1ZSBvZiBhIGZpZWxkIGZvciB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzIHdpdGhpbiBhIHNldCBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMuXG4gKlxuICogQG1vZHVsZSB0dXJmL3ZhcmlhbmNlXG4gKiBAY2F0ZWdvcnkgYWdncmVnYXRpb25cbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcGFyYW0ge0ZlYXR1cmVDb2xsZWN0aW9ufSBwb2ludHMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9pbnR9IGZlYXR1cmVzXG4gKiBAcGFyYW0ge3N0cmluZ30gaW5GaWVsZCB0aGUgZmllbGQgaW4gaW5wdXQgZGF0YSB0byBhbmFseXplXG4gKiBAcGFyYW0ge3N0cmluZ30gb3V0RmllbGQgdGhlIGZpZWxkIGluIHdoaWNoIHRvIHN0b3JlIHJlc3VsdHNcbiAqIEByZXR1cm4ge0ZlYXR1cmVDb2xsZWN0aW9ufSBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2x5Z29ufSBmZWF0dXJlc1xuICogd2l0aCBwcm9wZXJ0aWVzIGxpc3RlZCBhcyBgb3V0RmllbGRgXG4gKiBAZXhhbXBsZVxuICogdmFyIHBvbHlnb25zID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy05Ny40MTQzOTgsIDM3LjY4NDA5Ml0sXG4gKiAgICAgICAgICAgWy05Ny40MTQzOTgsIDM3LjczMTM1M10sXG4gKiAgICAgICAgICAgWy05Ny4zMzIzNDQsIDM3LjczMTM1M10sXG4gKiAgICAgICAgICAgWy05Ny4zMzIzNDQsIDM3LjY4NDA5Ml0sXG4gKiAgICAgICAgICAgWy05Ny40MTQzOTgsIDM3LjY4NDA5Ml1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy05Ny4zMzM3MTcsIDM3LjYwNjA3Ml0sXG4gKiAgICAgICAgICAgWy05Ny4zMzM3MTcsIDM3LjY3NTM5N10sXG4gKiAgICAgICAgICAgWy05Ny4yMzc1ODYsIDM3LjY3NTM5N10sXG4gKiAgICAgICAgICAgWy05Ny4yMzc1ODYsIDM3LjYwNjA3Ml0sXG4gKiAgICAgICAgICAgWy05Ny4zMzM3MTcsIDM3LjYwNjA3Ml1cbiAqICAgICAgICAgXV1cbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKiB2YXIgcG9pbnRzID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny40MDEzNTEsIDM3LjcxOTY3Nl1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogNjAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny4zNTUzNDYsIDM3LjcwNjYzOV1cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge1xuICogICAgICAgICBcInBvcHVsYXRpb25cIjogMTAwXG4gKiAgICAgICB9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy05Ny4zODc5NjIsIDM3LjcwMDEyXVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7XG4gKiAgICAgICAgIFwicG9wdWxhdGlvblwiOiAyMDBcbiAqICAgICAgIH0sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTk3LjMwMTc4OCwgMzcuNjY1MDddXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAqICAgICAgICAgXCJwb3B1bGF0aW9uXCI6IDMwMFxuICogICAgICAgfSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstOTcuMjY1MDUyLCAzNy42NDMzMjVdXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBhZ2dyZWdhdGVkID0gdHVyZi52YXJpYW5jZShcbiAqICAgcG9seWdvbnMsIHBvaW50cywgJ3BvcHVsYXRpb24nLCAndmFyaWFuY2UnKTtcbiAqXG4gKiB2YXIgcmVzdWx0RmVhdHVyZXMgPSBwb2ludHMuZmVhdHVyZXMuY29uY2F0KFxuICogICBhZ2dyZWdhdGVkLmZlYXR1cmVzKTtcbiAqIHZhciByZXN1bHQgPSB7XG4gKiAgIFwidHlwZVwiOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gKiAgIFwiZmVhdHVyZXNcIjogcmVzdWx0RmVhdHVyZXNcbiAqIH07XG4gKlxuICogLy89cmVzdWx0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHBvbHlGQywgcHRGQywgaW5GaWVsZCwgb3V0RmllbGQpIHtcbiAgcG9seUZDLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24ocG9seSl7XG4gICAgaWYoIXBvbHkucHJvcGVydGllcyl7XG4gICAgICBwb2x5LnByb3BlcnRpZXMgPSB7fTtcbiAgICB9XG4gICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgIHB0RkMuZmVhdHVyZXMuZm9yRWFjaChmdW5jdGlvbihwdCl7XG4gICAgICBpZiAoaW5zaWRlKHB0LCBwb2x5KSkge1xuICAgICAgICB2YWx1ZXMucHVzaChwdC5wcm9wZXJ0aWVzW2luRmllbGRdKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBwb2x5LnByb3BlcnRpZXNbb3V0RmllbGRdID0gc3MudmFyaWFuY2UodmFsdWVzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHBvbHlGQztcbn07XG4iLCJ2YXIgaW5zaWRlID0gcmVxdWlyZSgndHVyZi1pbnNpZGUnKTtcbnZhciBmZWF0dXJlQ29sbGVjdGlvbiA9IHJlcXVpcmUoJ3R1cmYtZmVhdHVyZWNvbGxlY3Rpb24nKTtcblxuLyoqXG4gKiBUYWtlcyBhIHtAbGluayBGZWF0dXJlQ29sbGVjdGlvbn0gb2Yge0BsaW5rIFBvaW50fSBmZWF0dXJlcyBhbmQgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiB7QGxpbmsgUG9seWdvbn0gZmVhdHVyZXMgYW5kIHJldHVybnMgYSBGZWF0dXJlQ29sbGVjdGlvbiBvZiBQb2ludCBmZWF0dXJlcyByZXByZXNlbnRpbmcgYWxsIHBvaW50cyB0aGF0IGZhbGwgd2l0aGluIGEgY29sbGVjdGlvbiBvZiBwb2x5Z29ucy5cbiAqXG4gKiBAbW9kdWxlIHR1cmYvd2l0aGluXG4gKiBAY2F0ZWdvcnkgam9pbnNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvaW50cyBhIEZlYXR1cmVDb2xsZWN0aW9uIG9mIHtAbGluayBQb2ludH0gZmVhdHVyZXNcbiAqIEBwYXJhbSB7RmVhdHVyZUNvbGxlY3Rpb259IHBvbHlnb25zIGEgRmVhdHVyZUNvbGxlY3Rpb24gb2Yge0BsaW5rIFBvbHlnb259IGZlYXR1cmVzXG4gKiBAcmV0dXJuIHtGZWF0dXJlQ29sbGVjdGlvbn0gYSBjb2xsZWN0aW9uIG9mIGFsbCBwb2ludHMgdGhhdCBsYW5kXG4gKiB3aXRoaW4gYXQgbGVhc3Qgb25lIHBvbHlnb25cbiAqIEBleGFtcGxlXG4gKiB2YXIgc2VhcmNoV2l0aGluID0ge1xuICogICBcInR5cGVcIjogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICogICBcImZlYXR1cmVzXCI6IFtcbiAqICAgICB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9seWdvblwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFtbXG4gKiAgICAgICAgICAgWy00Ni42NTMsLTIzLjU0M10sXG4gKiAgICAgICAgICAgWy00Ni42MzQsLTIzLjUzNDZdLFxuICogICAgICAgICAgIFstNDYuNjEzLC0yMy41NDNdLFxuICogICAgICAgICAgIFstNDYuNjE0LC0yMy41NTldLFxuICogICAgICAgICAgIFstNDYuNjMxLC0yMy41NjddLFxuICogICAgICAgICAgIFstNDYuNjUzLC0yMy41NjBdLFxuICogICAgICAgICAgIFstNDYuNjUzLC0yMy41NDNdXG4gKiAgICAgICAgIF1dXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICogdmFyIHBvaW50cyA9IHtcbiAqICAgXCJ0eXBlXCI6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAqICAgXCJmZWF0dXJlc1wiOiBbXG4gKiAgICAge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42MzE4LCAtMjMuNTUyM11cbiAqICAgICAgIH1cbiAqICAgICB9LCB7XG4gKiAgICAgICBcInR5cGVcIjogXCJGZWF0dXJlXCIsXG4gKiAgICAgICBcInByb3BlcnRpZXNcIjoge30sXG4gKiAgICAgICBcImdlb21ldHJ5XCI6IHtcbiAqICAgICAgICAgXCJ0eXBlXCI6IFwiUG9pbnRcIixcbiAqICAgICAgICAgXCJjb29yZGluYXRlc1wiOiBbLTQ2LjYyNDYsIC0yMy41MzI1XVxuICogICAgICAgfVxuICogICAgIH0sIHtcbiAqICAgICAgIFwidHlwZVwiOiBcIkZlYXR1cmVcIixcbiAqICAgICAgIFwicHJvcGVydGllc1wiOiB7fSxcbiAqICAgICAgIFwiZ2VvbWV0cnlcIjoge1xuICogICAgICAgICBcInR5cGVcIjogXCJQb2ludFwiLFxuICogICAgICAgICBcImNvb3JkaW5hdGVzXCI6IFstNDYuNjA2MiwgLTIzLjU1MTNdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42NjMsIC0yMy41NTRdXG4gKiAgICAgICB9XG4gKiAgICAgfSwge1xuICogICAgICAgXCJ0eXBlXCI6IFwiRmVhdHVyZVwiLFxuICogICAgICAgXCJwcm9wZXJ0aWVzXCI6IHt9LFxuICogICAgICAgXCJnZW9tZXRyeVwiOiB7XG4gKiAgICAgICAgIFwidHlwZVwiOiBcIlBvaW50XCIsXG4gKiAgICAgICAgIFwiY29vcmRpbmF0ZXNcIjogWy00Ni42NDMsIC0yMy41NTddXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICBdXG4gKiB9O1xuICpcbiAqIHZhciBwdHNXaXRoaW4gPSB0dXJmLndpdGhpbihwb2ludHMsIHNlYXJjaFdpdGhpbik7XG4gKlxuICogLy89cG9pbnRzXG4gKlxuICogLy89c2VhcmNoV2l0aGluXG4gKlxuICogLy89cHRzV2l0aGluXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocHRGQywgcG9seUZDKXtcbiAgdmFyIHBvaW50c1dpdGhpbiA9IGZlYXR1cmVDb2xsZWN0aW9uKFtdKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2x5RkMuZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHB0RkMuZmVhdHVyZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIHZhciBpc0luc2lkZSA9IGluc2lkZShwdEZDLmZlYXR1cmVzW2pdLCBwb2x5RkMuZmVhdHVyZXNbaV0pO1xuICAgICAgaWYoaXNJbnNpZGUpe1xuICAgICAgICBwb2ludHNXaXRoaW4uZmVhdHVyZXMucHVzaChwdEZDLmZlYXR1cmVzW2pdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBvaW50c1dpdGhpbjtcbn07XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciB3aW5kb3cgPSByZXF1aXJlKFwiZ2xvYmFsL3dpbmRvd1wiKVxudmFyIG9uY2UgPSByZXF1aXJlKFwib25jZVwiKVxudmFyIHBhcnNlSGVhZGVycyA9IHJlcXVpcmUoXCJwYXJzZS1oZWFkZXJzXCIpXG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVhIUlxuY3JlYXRlWEhSLlhNTEh0dHBSZXF1ZXN0ID0gd2luZG93LlhNTEh0dHBSZXF1ZXN0IHx8IG5vb3BcbmNyZWF0ZVhIUi5YRG9tYWluUmVxdWVzdCA9IFwid2l0aENyZWRlbnRpYWxzXCIgaW4gKG5ldyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QoKSkgPyBjcmVhdGVYSFIuWE1MSHR0cFJlcXVlc3QgOiB3aW5kb3cuWERvbWFpblJlcXVlc3RcblxuXG5mdW5jdGlvbiBpc0VtcHR5KG9iail7XG4gICAgZm9yKHZhciBpIGluIG9iail7XG4gICAgICAgIGlmKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIHJldHVybiB0cnVlXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVhIUihvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIGZ1bmN0aW9uIHJlYWR5c3RhdGVjaGFuZ2UoKSB7XG4gICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgbG9hZEZ1bmMoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Qm9keSgpIHtcbiAgICAgICAgLy8gQ2hyb21lIHdpdGggcmVxdWVzdFR5cGU9YmxvYiB0aHJvd3MgZXJyb3JzIGFycm91bmQgd2hlbiBldmVuIHRlc3RpbmcgYWNjZXNzIHRvIHJlc3BvbnNlVGV4dFxuICAgICAgICB2YXIgYm9keSA9IHVuZGVmaW5lZFxuXG4gICAgICAgIGlmICh4aHIucmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGJvZHkgPSB4aHIucmVzcG9uc2VcbiAgICAgICAgfSBlbHNlIGlmICh4aHIucmVzcG9uc2VUeXBlID09PSBcInRleHRcIiB8fCAheGhyLnJlc3BvbnNlVHlwZSkge1xuICAgICAgICAgICAgYm9keSA9IHhoci5yZXNwb25zZVRleHQgfHwgeGhyLnJlc3BvbnNlWE1MXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNKc29uKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGJvZHkgPSBKU09OLnBhcnNlKGJvZHkpXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJvZHlcbiAgICB9XG5cbiAgICB2YXIgZmFpbHVyZVJlc3BvbnNlID0ge1xuICAgICAgICAgICAgICAgIGJvZHk6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7fSxcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiAwLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgICAgICAgICAgIHVybDogdXJpLFxuICAgICAgICAgICAgICAgIHJhd1JlcXVlc3Q6IHhoclxuICAgICAgICAgICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3JGdW5jKGV2dCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKVxuICAgICAgICBpZighKGV2dCBpbnN0YW5jZW9mIEVycm9yKSl7XG4gICAgICAgICAgICBldnQgPSBuZXcgRXJyb3IoXCJcIiArIChldnQgfHwgXCJVbmtub3duIFhNTEh0dHBSZXF1ZXN0IEVycm9yXCIpIClcbiAgICAgICAgfVxuICAgICAgICBldnQuc3RhdHVzQ29kZSA9IDBcbiAgICAgICAgY2FsbGJhY2soZXZ0LCBmYWlsdXJlUmVzcG9uc2UpXG4gICAgfVxuXG4gICAgLy8gd2lsbCBsb2FkIHRoZSBkYXRhICYgcHJvY2VzcyB0aGUgcmVzcG9uc2UgaW4gYSBzcGVjaWFsIHJlc3BvbnNlIG9iamVjdFxuICAgIGZ1bmN0aW9uIGxvYWRGdW5jKCkge1xuICAgICAgICBpZiAoYWJvcnRlZCkgcmV0dXJuXG4gICAgICAgIHZhciBzdGF0dXNcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRUaW1lcilcbiAgICAgICAgaWYob3B0aW9ucy51c2VYRFIgJiYgeGhyLnN0YXR1cz09PXVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy9JRTggQ09SUyBHRVQgc3VjY2Vzc2Z1bCByZXNwb25zZSBkb2Vzbid0IGhhdmUgYSBzdGF0dXMgZmllbGQsIGJ1dCBib2R5IGlzIGZpbmVcbiAgICAgICAgICAgIHN0YXR1cyA9IDIwMFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhdHVzID0gKHhoci5zdGF0dXMgPT09IDEyMjMgPyAyMDQgOiB4aHIuc3RhdHVzKVxuICAgICAgICB9XG4gICAgICAgIHZhciByZXNwb25zZSA9IGZhaWx1cmVSZXNwb25zZVxuICAgICAgICB2YXIgZXJyID0gbnVsbFxuXG4gICAgICAgIGlmIChzdGF0dXMgIT09IDApe1xuICAgICAgICAgICAgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgYm9keTogZ2V0Qm9keSgpLFxuICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHN0YXR1cyxcbiAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7fSxcbiAgICAgICAgICAgICAgICB1cmw6IHVyaSxcbiAgICAgICAgICAgICAgICByYXdSZXF1ZXN0OiB4aHJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMpeyAvL3JlbWVtYmVyIHhociBjYW4gaW4gZmFjdCBiZSBYRFIgZm9yIENPUlMgaW4gSUVcbiAgICAgICAgICAgICAgICByZXNwb25zZS5oZWFkZXJzID0gcGFyc2VIZWFkZXJzKHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVyciA9IG5ldyBFcnJvcihcIkludGVybmFsIFhNTEh0dHBSZXF1ZXN0IEVycm9yXCIpXG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2soZXJyLCByZXNwb25zZSwgcmVzcG9uc2UuYm9keSlcblxuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBvcHRpb25zID0geyB1cmk6IG9wdGlvbnMgfVxuICAgIH1cblxuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG4gICAgaWYodHlwZW9mIGNhbGxiYWNrID09PSBcInVuZGVmaW5lZFwiKXtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2FsbGJhY2sgYXJndW1lbnQgbWlzc2luZ1wiKVxuICAgIH1cbiAgICBjYWxsYmFjayA9IG9uY2UoY2FsbGJhY2spXG5cbiAgICB2YXIgeGhyID0gb3B0aW9ucy54aHIgfHwgbnVsbFxuXG4gICAgaWYgKCF4aHIpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuY29ycyB8fCBvcHRpb25zLnVzZVhEUikge1xuICAgICAgICAgICAgeGhyID0gbmV3IGNyZWF0ZVhIUi5YRG9tYWluUmVxdWVzdCgpXG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgeGhyID0gbmV3IGNyZWF0ZVhIUi5YTUxIdHRwUmVxdWVzdCgpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIga2V5XG4gICAgdmFyIGFib3J0ZWRcbiAgICB2YXIgdXJpID0geGhyLnVybCA9IG9wdGlvbnMudXJpIHx8IG9wdGlvbnMudXJsXG4gICAgdmFyIG1ldGhvZCA9IHhoci5tZXRob2QgPSBvcHRpb25zLm1ldGhvZCB8fCBcIkdFVFwiXG4gICAgdmFyIGJvZHkgPSBvcHRpb25zLmJvZHkgfHwgb3B0aW9ucy5kYXRhXG4gICAgdmFyIGhlYWRlcnMgPSB4aHIuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyB8fCB7fVxuICAgIHZhciBzeW5jID0gISFvcHRpb25zLnN5bmNcbiAgICB2YXIgaXNKc29uID0gZmFsc2VcbiAgICB2YXIgdGltZW91dFRpbWVyXG5cbiAgICBpZiAoXCJqc29uXCIgaW4gb3B0aW9ucykge1xuICAgICAgICBpc0pzb24gPSB0cnVlXG4gICAgICAgIGhlYWRlcnNbXCJhY2NlcHRcIl0gfHwgaGVhZGVyc1tcIkFjY2VwdFwiXSB8fCAoaGVhZGVyc1tcIkFjY2VwdFwiXSA9IFwiYXBwbGljYXRpb24vanNvblwiKSAvL0Rvbid0IG92ZXJyaWRlIGV4aXN0aW5nIGFjY2VwdCBoZWFkZXIgZGVjbGFyZWQgYnkgdXNlclxuICAgICAgICBpZiAobWV0aG9kICE9PSBcIkdFVFwiICYmIG1ldGhvZCAhPT0gXCJIRUFEXCIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbXCJjb250ZW50LXR5cGVcIl0gfHwgaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXSB8fCAoaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXSA9IFwiYXBwbGljYXRpb24vanNvblwiKSAvL0Rvbid0IG92ZXJyaWRlIGV4aXN0aW5nIGFjY2VwdCBoZWFkZXIgZGVjbGFyZWQgYnkgdXNlclxuICAgICAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuanNvbilcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSByZWFkeXN0YXRlY2hhbmdlXG4gICAgeGhyLm9ubG9hZCA9IGxvYWRGdW5jXG4gICAgeGhyLm9uZXJyb3IgPSBlcnJvckZ1bmNcbiAgICAvLyBJRTkgbXVzdCBoYXZlIG9ucHJvZ3Jlc3MgYmUgc2V0IHRvIGEgdW5pcXVlIGZ1bmN0aW9uLlxuICAgIHhoci5vbnByb2dyZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBJRSBtdXN0IGRpZVxuICAgIH1cbiAgICB4aHIub250aW1lb3V0ID0gZXJyb3JGdW5jXG4gICAgeGhyLm9wZW4obWV0aG9kLCB1cmksICFzeW5jLCBvcHRpb25zLnVzZXJuYW1lLCBvcHRpb25zLnBhc3N3b3JkKVxuICAgIC8vaGFzIHRvIGJlIGFmdGVyIG9wZW5cbiAgICBpZighc3luYykge1xuICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gISFvcHRpb25zLndpdGhDcmVkZW50aWFsc1xuICAgIH1cbiAgICAvLyBDYW5ub3Qgc2V0IHRpbWVvdXQgd2l0aCBzeW5jIHJlcXVlc3RcbiAgICAvLyBub3Qgc2V0dGluZyB0aW1lb3V0IG9uIHRoZSB4aHIgb2JqZWN0LCBiZWNhdXNlIG9mIG9sZCB3ZWJraXRzIGV0Yy4gbm90IGhhbmRsaW5nIHRoYXQgY29ycmVjdGx5XG4gICAgLy8gYm90aCBucG0ncyByZXF1ZXN0IGFuZCBqcXVlcnkgMS54IHVzZSB0aGlzIGtpbmQgb2YgdGltZW91dCwgc28gdGhpcyBpcyBiZWluZyBjb25zaXN0ZW50XG4gICAgaWYgKCFzeW5jICYmIG9wdGlvbnMudGltZW91dCA+IDAgKSB7XG4gICAgICAgIHRpbWVvdXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGFib3J0ZWQ9dHJ1ZS8vSUU5IG1heSBzdGlsbCBjYWxsIHJlYWR5c3RhdGVjaGFuZ2VcbiAgICAgICAgICAgIHhoci5hYm9ydChcInRpbWVvdXRcIilcbiAgICAgICAgICAgIHZhciBlID0gbmV3IEVycm9yKFwiWE1MSHR0cFJlcXVlc3QgdGltZW91dFwiKVxuICAgICAgICAgICAgZS5jb2RlID0gXCJFVElNRURPVVRcIlxuICAgICAgICAgICAgZXJyb3JGdW5jKGUpXG4gICAgICAgIH0sIG9wdGlvbnMudGltZW91dCApXG4gICAgfVxuXG4gICAgaWYgKHhoci5zZXRSZXF1ZXN0SGVhZGVyKSB7XG4gICAgICAgIGZvcihrZXkgaW4gaGVhZGVycyl7XG4gICAgICAgICAgICBpZihoZWFkZXJzLmhhc093blByb3BlcnR5KGtleSkpe1xuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgaGVhZGVyc1trZXldKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmhlYWRlcnMgJiYgIWlzRW1wdHkob3B0aW9ucy5oZWFkZXJzKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJIZWFkZXJzIGNhbm5vdCBiZSBzZXQgb24gYW4gWERvbWFpblJlcXVlc3Qgb2JqZWN0XCIpXG4gICAgfVxuXG4gICAgaWYgKFwicmVzcG9uc2VUeXBlXCIgaW4gb3B0aW9ucykge1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gb3B0aW9ucy5yZXNwb25zZVR5cGVcbiAgICB9XG5cbiAgICBpZiAoXCJiZWZvcmVTZW5kXCIgaW4gb3B0aW9ucyAmJlxuICAgICAgICB0eXBlb2Ygb3B0aW9ucy5iZWZvcmVTZW5kID09PSBcImZ1bmN0aW9uXCJcbiAgICApIHtcbiAgICAgICAgb3B0aW9ucy5iZWZvcmVTZW5kKHhocilcbiAgICB9XG5cbiAgICB4aHIuc2VuZChib2R5KVxuXG4gICAgcmV0dXJuIHhoclxuXG5cbn1cblxuZnVuY3Rpb24gbm9vcCgpIHt9XG4iLCJpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIG1vZHVsZS5leHBvcnRzID0gd2luZG93O1xufSBlbHNlIGlmICh0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBnbG9iYWw7XG59IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKXtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHNlbGY7XG59IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0ge307XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IG9uY2Vcblxub25jZS5wcm90byA9IG9uY2UoZnVuY3Rpb24gKCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnVuY3Rpb24ucHJvdG90eXBlLCAnb25jZScsIHtcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG9uY2UodGhpcylcbiAgICB9LFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICB9KVxufSlcblxuZnVuY3Rpb24gb25jZSAoZm4pIHtcbiAgdmFyIGNhbGxlZCA9IGZhbHNlXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGNhbGxlZCkgcmV0dXJuXG4gICAgY2FsbGVkID0gdHJ1ZVxuICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gIH1cbn1cbiIsInZhciBpc0Z1bmN0aW9uID0gcmVxdWlyZSgnaXMtZnVuY3Rpb24nKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZvckVhY2hcblxudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZ1xudmFyIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eVxuXG5mdW5jdGlvbiBmb3JFYWNoKGxpc3QsIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgaWYgKCFpc0Z1bmN0aW9uKGl0ZXJhdG9yKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpdGVyYXRvciBtdXN0IGJlIGEgZnVuY3Rpb24nKVxuICAgIH1cblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMykge1xuICAgICAgICBjb250ZXh0ID0gdGhpc1xuICAgIH1cbiAgICBcbiAgICBpZiAodG9TdHJpbmcuY2FsbChsaXN0KSA9PT0gJ1tvYmplY3QgQXJyYXldJylcbiAgICAgICAgZm9yRWFjaEFycmF5KGxpc3QsIGl0ZXJhdG9yLCBjb250ZXh0KVxuICAgIGVsc2UgaWYgKHR5cGVvZiBsaXN0ID09PSAnc3RyaW5nJylcbiAgICAgICAgZm9yRWFjaFN0cmluZyhsaXN0LCBpdGVyYXRvciwgY29udGV4dClcbiAgICBlbHNlXG4gICAgICAgIGZvckVhY2hPYmplY3QobGlzdCwgaXRlcmF0b3IsIGNvbnRleHQpXG59XG5cbmZ1bmN0aW9uIGZvckVhY2hBcnJheShhcnJheSwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyYXkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYXJyYXksIGkpKSB7XG4gICAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGFycmF5W2ldLCBpLCBhcnJheSlcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9yRWFjaFN0cmluZyhzdHJpbmcsIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHN0cmluZy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAvLyBubyBzdWNoIHRoaW5nIGFzIGEgc3BhcnNlIHN0cmluZy5cbiAgICAgICAgaXRlcmF0b3IuY2FsbChjb250ZXh0LCBzdHJpbmcuY2hhckF0KGkpLCBpLCBzdHJpbmcpXG4gICAgfVxufVxuXG5mdW5jdGlvbiBmb3JFYWNoT2JqZWN0KG9iamVjdCwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBmb3IgKHZhciBrIGluIG9iamVjdCkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGspKSB7XG4gICAgICAgICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9iamVjdFtrXSwgaywgb2JqZWN0KVxuICAgICAgICB9XG4gICAgfVxufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBpc0Z1bmN0aW9uXG5cbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdcblxuZnVuY3Rpb24gaXNGdW5jdGlvbiAoZm4pIHtcbiAgdmFyIHN0cmluZyA9IHRvU3RyaW5nLmNhbGwoZm4pXG4gIHJldHVybiBzdHJpbmcgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXScgfHxcbiAgICAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nICYmIHN0cmluZyAhPT0gJ1tvYmplY3QgUmVnRXhwXScpIHx8XG4gICAgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgIC8vIElFOCBhbmQgYmVsb3dcbiAgICAgKGZuID09PSB3aW5kb3cuc2V0VGltZW91dCB8fFxuICAgICAgZm4gPT09IHdpbmRvdy5hbGVydCB8fFxuICAgICAgZm4gPT09IHdpbmRvdy5jb25maXJtIHx8XG4gICAgICBmbiA9PT0gd2luZG93LnByb21wdCkpXG59O1xuIiwiXG5leHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSB0cmltO1xuXG5mdW5jdGlvbiB0cmltKHN0cil7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvXlxccyp8XFxzKiQvZywgJycpO1xufVxuXG5leHBvcnRzLmxlZnQgPSBmdW5jdGlvbihzdHIpe1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMqLywgJycpO1xufTtcblxuZXhwb3J0cy5yaWdodCA9IGZ1bmN0aW9uKHN0cil7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvXFxzKiQvLCAnJyk7XG59O1xuIiwidmFyIHRyaW0gPSByZXF1aXJlKCd0cmltJylcbiAgLCBmb3JFYWNoID0gcmVxdWlyZSgnZm9yLWVhY2gnKVxuICAsIGlzQXJyYXkgPSBmdW5jdGlvbihhcmcpIHtcbiAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJnKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgICB9XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGhlYWRlcnMpIHtcbiAgaWYgKCFoZWFkZXJzKVxuICAgIHJldHVybiB7fVxuXG4gIHZhciByZXN1bHQgPSB7fVxuXG4gIGZvckVhY2goXG4gICAgICB0cmltKGhlYWRlcnMpLnNwbGl0KCdcXG4nKVxuICAgICwgZnVuY3Rpb24gKHJvdykge1xuICAgICAgICB2YXIgaW5kZXggPSByb3cuaW5kZXhPZignOicpXG4gICAgICAgICAgLCBrZXkgPSB0cmltKHJvdy5zbGljZSgwLCBpbmRleCkpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAsIHZhbHVlID0gdHJpbShyb3cuc2xpY2UoaW5kZXggKyAxKSlcblxuICAgICAgICBpZiAodHlwZW9mKHJlc3VsdFtrZXldKSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlXG4gICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheShyZXN1bHRba2V5XSkpIHtcbiAgICAgICAgICByZXN1bHRba2V5XS5wdXNoKHZhbHVlKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdFtrZXldID0gWyByZXN1bHRba2V5XSwgdmFsdWUgXVxuICAgICAgICB9XG4gICAgICB9XG4gIClcblxuICByZXR1cm4gcmVzdWx0XG59IiwiY29uc3QgTCA9IGdsb2JhbC5MIHx8IHJlcXVpcmUoJ2xlYWZsZXQnKTtcblxuaW1wb3J0IHhociBmcm9tICd4aHInO1xuaW1wb3J0ICogYXMgU3Bpbm5lciBmcm9tICdzcGluLmpzJztcbmltcG9ydCAqIGFzIGNvbmZpZyBmcm9tICcuLi9jb25maWcuanNvbic7XG5pbXBvcnQgQ09MT1JTIGZyb20gJy4vY29sb3JzJztcbmltcG9ydCBsZWFmbGV0S25uIGZyb20gJ2xlYWZsZXQta25uJztcbmltcG9ydCB0dXJmIGZyb20gJ3R1cmYnO1xuaW1wb3J0IGdqdXRpbHMgZnJvbSAnZ2VvanNvbi11dGlscyc7XG5pbXBvcnQgZ2VvbSBmcm9tICdsZWFmbGV0LWdlb21ldHJ5dXRpbCc7XG5pbXBvcnQgJ2xlYWZsZXQtaGFzaCc7XG5cbmdsb2JhbC50dXJmID0gdHVyZjtcblxuY29uc3QgTUFQX1NUWUxFID0gJ21hcGJveC5kYXJrJztcbmNvbnN0IExJTkVfV0lEVEggPSA0O1xuXG5jb25zdCBQT1NJVElPTl9TVFlMRSA9IHtcbiAgY29sb3I6ICcjZjUxYTFhJyxcbiAgZmlsbE9wYWNpdHk6IDAuNSxcbiAgd2VpZ2h0OiAyLFxuICByYWRpdXM6IDZcbn1cblxuZnVuY3Rpb24gcmluZ1N0eWxlKGZlYXR1cmUpIHtcbiAgcmV0dXJuIHtcbiAgICBjb2xvcjogQ09MT1JTW2ZlYXR1cmUucHJvcGVydGllcy5pZF0sXG4gICAgd2VpZ2h0OiBMSU5FX1dJRFRIIC8gKGZlYXR1cmUucHJvcGVydGllcy5pZCArIDEpLFxuICAgIGZpbGxPcGFjaXR5OiAwLjEsXG4gICAgY2xpY2thYmxlOiBmYWxzZVxuICB9O1xufVxuXG5mdW5jdGlvbiBidWZmZXJTdHlsZShmZWF0dXJlKSB7XG4gIGNvbnNvbGUubG9nKGZlYXR1cmUpO1xuICByZXR1cm4ge1xuICAgIGNvbG9yOiBDT0xPUlNbZmVhdHVyZS5wcm9wZXJ0aWVzLmlkXSB8fCAnIzAwZicsXG4gICAgd2VpZ2h0OiAxLCAvL0xJTkVfV0lEVEggLyAoZmVhdHVyZS5wcm9wZXJ0aWVzLmlkICsgMSksXG4gICAgZmlsbE9wYWNpdHk6IDAsXG4gICAgZGFzaEFycmF5OiBbNSwgNV0sXG4gICAgY2xpY2thYmxlOiBmYWxzZVxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcHAge1xuXG4gIGNvbnN0cnVjdG9yKG1hcENvbnRhaW5lciwgZGF0YVVybCkge1xuXG4gICAgbGV0IHsgY2VudGVyLCB6b29tIH0gPSBMLkhhc2gucGFyc2VIYXNoKGxvY2F0aW9uLmhhc2gpO1xuXG4gICAgdGhpcy5fbWFwID0gZ2xvYmFsLm1hcCA9IEwubWFwKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobWFwQ29udGFpbmVyKSk7XG5cbiAgICB0aGlzLl9wb3NpdGlvbmVkID0gKGNlbnRlciAmJiB6b29tKVxuICAgIGlmICh0aGlzLl9wb3NpdGlvbmVkKSB7XG4gICAgICB0aGlzLl9tYXAuc2V0VmlldyhjZW50ZXIsIHpvb20pO1xuICAgIH1cblxuICAgIHRoaXMuX2ludGVyc2VjdHMgPSBMLmxheWVyR3JvdXAoKS5hZGRUbyh0aGlzLl9tYXApO1xuXG4gICAgdGhpcy5fYnVmZmVycyA9IEwuZ2VvSnNvbihudWxsLCB7IHN0eWxlOiBidWZmZXJTdHlsZSB9KS5hZGRUbyh0aGlzLl9tYXApO1xuXG4gICAgdGhpcy5faGFzaCA9IEwuaGFzaChtYXApO1xuXG4gICAgdGhpcy5fZGF0YSA9IG51bGw7XG5cbiAgICB0aGlzLl9nZW9qc29uID0gbnVsbDtcblxuICAgIHRoaXMuX2luZGV4ID0gbnVsbDtcblxuICAgIHRoaXMuX21hcmtlciA9IG51bGw7XG5cbiAgICB0aGlzLl9pbmZvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluZm8nKTtcblxuICAgIC8vIHRoaXMuX3RpbGVzID0gTC50aWxlTGF5ZXIoXG4gICAgLy8gICAnaHR0cHM6Ly9hcGkubWFwYm94LmNvbS92NC8nICtcbiAgICAvLyAgIE1BUF9TVFlMRSArXG4gICAgLy8gICAnL3t6fS97eH0ve3l9LnBuZz9hY2Nlc3NfdG9rZW49JyArXG4gICAgLy8gICBjb25maWcuYXBpX3Rva2VuLCB7XG4gICAgLy8gICAgIGF0dHJpYnV0aW9uOiAnTWFwYm94ICZjb3B5OyBPU00gY29udHJpYnV0b3JzJ1xuICAgIC8vIH0pLmFkZFRvKG1hcCk7XG5cbiAgICB0aGlzLl9sb2FkKGRhdGFVcmwpO1xuXG4gICAgdGhpcy5faW5pdCgpO1xuICB9XG5cbiAgX2xvYWQodXJsKSB7XG4gICAgeGhyKHsgdXJsIH0sIHRoaXMuX29uTG9hZC5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIF9vbkxvYWQoZXJyLCByZXEsIGRhdGEpIHtcbiAgICBpZiAoZXJyKSB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBmZXRjaCBkYXRhJyk7XG5cbiAgICB0aGlzLl9kYXRhID0gZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgZGF0YS5mZWF0dXJlcy5mb3JFYWNoKChmKSA9PiB7XG4gICAgICBmLnByb3BlcnRpZXMuY2VudHJvaWQgPVxuICAgICAgICBnanV0aWxzLmNlbnRyb2lkKGYuZ2VvbWV0cnkpLmNvb3JkaW5hdGVzO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZ2VvanNvbiA9IEwuZ2VvSnNvbihkYXRhLCB7IHN0eWxlOiByaW5nU3R5bGUgfSk7XG5cbiAgICBpZighdGhpcy5fcG9zaXRpb25lZCkge1xuICAgICAgbWFwLmZpdEJvdW5kcyh0aGlzLl9nZW9qc29uLmdldEJvdW5kcygpLCB7cGFkZGluZzogWzIwLCAyMF19KTtcbiAgICB9XG4gICAgdGhpcy5fZ2VvanNvbi5hZGRUbyhtYXApO1xuICAgIHRoaXMuX2luZGV4ID0gbGVhZmxldEtubih0aGlzLl9nZW9qc29uKTtcbiAgfVxuXG4gIF9pbml0KCkge1xuICAgIHRoaXMuX21hcC5vbignY2xpY2snLCB0aGlzLl9vbk1hcENsaWNrLCB0aGlzKTtcbiAgICAvLyBsZXQgbmVhcmVzdCA9IGluZGV4Lm5lYXJlc3QoZXZ0LmxhdGxuZyk7XG4gICAgLy8gY29uc29sZS5sb2cobmVhcmVzdCk7XG4gIH1cblxuICBfb25NYXBDbGljayhldnQpIHtcbiAgICBpZiAoIXRoaXMuX21hcmtlcikge1xuICAgICAgdGhpcy5fbWFya2VyID0gTC5jaXJjbGVNYXJrZXIoZXZ0LmxhdGxuZywgUE9TSVRJT05fU1RZTEUpXG4gICAgICAgIC5hZGRUbyh0aGlzLl9tYXApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9tYXJrZXIuc2V0TGF0TG5nKGV2dC5sYXRsbmcpO1xuICAgIH1cbiAgICB0aGlzLl9pbnRlcnNlY3RzLmNsZWFyTGF5ZXJzKCk7XG5cbiAgICBMLlV0aWwucmVxdWVzdEFuaW1GcmFtZSgoKSA9PiB0aGlzLl9jYWxjdWxhdGVEaXN0YW5jZXMoZXZ0LmxhdGxuZyksIHRoaXMpO1xuICB9XG5cbiAgX2NhbGN1bGF0ZURpc3RhbmNlcyhsYXRsbmcpIHtcbiAgICBsZXQgaW50ZXJzZWN0aW9ucyA9IFtdO1xuICAgIGxldCBwb2ludCA9IHR1cmYucG9pbnQoW2xhdGxuZy5sbmcsIGxhdGxuZy5sYXRdKTtcbiAgICB0aGlzLl9nZW9qc29uLmVhY2hMYXllcigobGF5ZXIpID0+IHtcbiAgICAgIGxldCBmID0gbGF5ZXIuZmVhdHVyZTtcbiAgICAgIGxldCBjZW50cm9pZCA9IEwubGF0TG5nKGYucHJvcGVydGllcy5jZW50cm9pZC5zbGljZSgpLnJldmVyc2UoKSk7XG5cbiAgICAgIGxldCBpbnRlcnNlY3RzID0gZ2p1dGlscy5saW5lU3RyaW5nc0ludGVyc2VjdChcbiAgICAgICAgeyBjb29yZGluYXRlczogZi5nZW9tZXRyeS5jb29yZGluYXRlc1swXSB9LFxuICAgICAgICB7IGNvb3JkaW5hdGVzOiBbZi5wcm9wZXJ0aWVzLmNlbnRyb2lkLnNsaWNlKCksIFtsYXRsbmcubG5nLCBsYXRsbmcubGF0XV0gfVxuICAgICAgKTtcblxuICAgICAgaWYoaW50ZXJzZWN0cykge1xuICAgICAgICBpbnRlcnNlY3RzID0gaW50ZXJzZWN0cy5wb3AoKTtcbiAgICAgICAgaW50ZXJzZWN0cy5jb29yZGluYXRlcy5yZXZlcnNlKCk7XG4gICAgICAgIEwuY2lyY2xlTWFya2VyKGludGVyc2VjdHMuY29vcmRpbmF0ZXMuc2xpY2UoKS5yZXZlcnNlKCksIHtcbiAgICAgICAgICByYWRpdXM6IDIsXG4gICAgICAgICAgY29sb3I6IENPTE9SU1tmLnByb3BlcnRpZXMuaWRdXG4gICAgICAgIH0pOyAvLyAuYWRkVG8odGhpcy5faW50ZXJzZWN0cyk7XG4gICAgICAgIGludGVyc2VjdHMgPSB0dXJmLnBvaW50KGludGVyc2VjdHMuY29vcmRpbmF0ZXMsIHsgZmVhdHVyZSA6IGYgfSk7XG4gICAgICAgIC8vIGludGVyc2VjdGlvbnMucHVzaChpbnRlcnNlY3RzKTtcbiAgICAgIH1cblxuICAgICAgbGV0IG5lYXJlc3QgPSB0dXJmLnBvaW50T25MaW5lKFxuICAgICAgICB0dXJmLmxpbmVzdHJpbmcoZi5nZW9tZXRyeS5jb29yZGluYXRlc1swXSksIHBvaW50KTtcbiAgICAgIEwuY2lyY2xlTWFya2VyKG5lYXJlc3QuZ2VvbWV0cnkuY29vcmRpbmF0ZXMuc2xpY2UoKS5yZXZlcnNlKCksIHtcbiAgICAgICAgICByYWRpdXM6IDIsXG4gICAgICAgICAgY29sb3I6IENPTE9SU1tmLnByb3BlcnRpZXMuaWRdXG4gICAgICAgIH0pLmFkZFRvKHRoaXMuX2ludGVyc2VjdHMpO1xuICAgICAgbmVhcmVzdC5wcm9wZXJ0aWVzLmZlYXR1cmUgPSBmO1xuICAgICAgaW50ZXJzZWN0aW9ucy5wdXNoKG5lYXJlc3QpO1xuXG4gICAgICAvLyB2aXN1YWxcbiAgICAgIC8vIEwucG9seWxpbmUoW2xhdGxuZywgY2VudHJvaWRdLCB7XG4gICAgICAvLyAgIHdlaWdodDogMVxuICAgICAgLy8gfSkuYWRkVG8odGhpcy5fbWFwKTtcbiAgICB9LCB0aGlzKTtcblxuICAgIHRoaXMuX2luZm8uaW5uZXJIVE1MID0gJzxwcmU+JyArXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KGludGVyc2VjdGlvbnMubWFwKChpKSA9PiB7XG4gICAgICAgICAgbGV0IGRpc3RhbmNlID0gdHVyZi5kaXN0YW5jZShcbiAgICAgICAgICAgICAgcG9pbnQsIHR1cmYucG9pbnQoaS5nZW9tZXRyeS5jb29yZGluYXRlcy5zbGljZSgpKSxcbiAgICAgICAgICAgICAgXCJraWxvbWV0ZXJzXCJcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICh0dXJmLmluc2lkZShwb2ludCwgaS5wcm9wZXJ0aWVzLmZlYXR1cmUpKSB7XG4gICAgICAgICAgICBkaXN0YW5jZSA9IC1kaXN0YW5jZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaS5wcm9wZXJ0aWVzLmRpc3RhbmNlID0gZGlzdGFuY2U7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIFtpLnByb3BlcnRpZXMuZmVhdHVyZS5wcm9wZXJ0aWVzLm5hbWVdIDpcbiAgICAgICAgICAgICAgZGlzdGFuY2UudG9GaXhlZCgxKSArICcga20nXG4gICAgICAgICAgfVxuICAgICAgICB9KSwgMCwgMikgK1xuICAgICAgJzwvcHJlPic7XG5cbiAgICBMLlV0aWwucmVxdWVzdEFuaW1GcmFtZSgoKSA9PiB0aGlzLl9jYWxjdWxhdGVCdWZmZXJzKGludGVyc2VjdGlvbnMpLCB0aGlzKTtcbiAgfVxuXG4gIF9jYWxjdWxhdGVCdWZmZXJzKGludGVyc2VjdGlvbnMpIHtcbiAgICBsZXQgYnVmZmVycyA9IFtdO1xuICAgIGludGVyc2VjdGlvbnMuZm9yRWFjaCgoaSkgPT4ge1xuICAgICAgaWYgKGkucHJvcGVydGllcy5kaXN0YW5jZSA+IDApIHtcbiAgICAgICAgYnVmZmVycyA9IGJ1ZmZlcnMuY29uY2F0KFxuICAgICAgICAgIHR1cmYuYnVmZmVyKFxuICAgICAgICAgICAgaS5wcm9wZXJ0aWVzLmZlYXR1cmUsXG4gICAgICAgICAgICBpLnByb3BlcnRpZXMuZGlzdGFuY2UsICdraWxvbWV0ZXJzJykuZmVhdHVyZXNcbiAgICAgICAgICAubWFwKChmKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhmKTtcbiAgICAgICAgICAgIGYucHJvcGVydGllcy5pZCA9IGkucHJvcGVydGllcy5mZWF0dXJlLnByb3BlcnRpZXMuaWQ7XG4gICAgICAgICAgICByZXR1cm4gZjtcbiAgICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgYnVmZmVycyA9IHR1cmYuZmVhdHVyZWNvbGxlY3Rpb24oYnVmZmVycyk7XG4gICAgdGhpcy5fYnVmZmVycy5jbGVhckxheWVycygpO1xuICAgIHRoaXMuX2J1ZmZlcnMuYWRkRGF0YShidWZmZXJzKTtcbiAgfVxuXG59XG4iLCJjb25zdCBDT0xPUlMgPSB7XG4gICAgMDogJyNmNTFhMWEnLCAvLyByZWQgc3F1YXJlXG4gICAgMTogJyNhMjFhZmYnLCAvLyBrcmVtbGluLFxuICAgIDI6ICcjYjM0YjAwJywgLy8gYm91bGV2YXJkXG4gICAgMzogJyMxOGRiZmYnLCAvLyBnYXJkZW4gcmluZ1xuICAgIDQ6ICcjZmYxNTE4JywgLy8gdGhpcmQgcmluZ1xuICAgIDU6ICcjODhmYTYwJyAgLy8gTUtBRFxufVxuXG5leHBvcnQgZGVmYXVsdCBDT0xPUlM7XG4iLCJpbXBvcnQgQXBwIGZyb20gJy4vYXBwJztcblxuY29uc3QgYXBwID0gZ2xvYmFsLmFwcCA9IG5ldyBBcHAoJy5tYXAnLCAnZGF0YS9kYXRhLmpzb24nKTtcbiJdfQ==
